import{w as A,n as $,r as p,j as e,F as T,S as P,u as E,o as O,p as V,q as L,a as D,f as I,t as q,x as R,y as z}from"./index-BQoCA6St.js";const B=({items:c,onEdit:j,onDelete:v,canManage:x})=>{const[d,a]=p.useState("name"),[f,t]=p.useState("asc"),b=s=>new Intl.NumberFormat("es-CO").format(s),h=s=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(s),N=s=>{if(!s)return"N/A";const r=new Date;let n;if(s&&typeof s=="object")if(s.seconds)n=new Date(s.seconds*1e3);else if(s.toDate&&typeof s.toDate=="function")n=s.toDate();else if(s instanceof Date)n=s;else return"N/A";else if(typeof s=="string"||typeof s=="number")n=new Date(s);else return"N/A";if(isNaN(n.getTime()))return"N/A";const i=r-n,u=Math.floor(i/(1e3*60*60)),o=Math.floor(u/24);return o>0?`${o}d`:u>0?`${u}h`:"ahora"},l=s=>{d===s?t(f==="asc"?"desc":"asc"):(a(s),t("asc"))},y=[...c].sort((s,r)=>{let n=s[d],i=r[d];if(d==="lastUpdated"){const u=o=>{if(!o)return new Date(0);if(o&&typeof o=="object"){if(o.seconds)return new Date(o.seconds*1e3);if(o.toDate&&typeof o.toDate=="function")return o.toDate();if(o instanceof Date)return o}return new Date(o)};n=u(n),i=u(i)}return n<i?f==="asc"?-1:1:n>i?f==="asc"?1:-1:0}),g=s=>d!==s?"â†•ï¸":f==="asc"?"â†‘":"â†“";return e.jsxs("div",{className:"inventory-table-container",children:[e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"inventory-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{onClick:()=>l("name"),className:"sortable",children:["Combustible ",g("name")]}),e.jsxs("th",{onClick:()=>l("location"),className:"sortable",children:["UbicaciÃ³n ",g("location")]}),e.jsxs("th",{onClick:()=>l("currentStock"),className:"sortable",children:["Stock Actual ",g("currentStock")]}),e.jsxs("th",{onClick:()=>l("stockPercentage"),className:"sortable",children:["Nivel ",g("stockPercentage")]}),e.jsxs("th",{onClick:()=>l("pricePerUnit"),className:"sortable",children:["Precio ",g("pricePerUnit")]}),e.jsx("th",{children:"Valor Total"}),e.jsxs("th",{onClick:()=>l("status"),className:"sortable",children:["Estado ",g("status")]}),e.jsxs("th",{onClick:()=>l("lastUpdated"),className:"sortable",children:["Actualizado ",g("lastUpdated")]}),x&&e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:y.map(s=>{const r=T[s.fuelType],n=P[s.stockLevel],i=parseFloat(s.currentStock)||0,u=parseFloat(s.pricePerUnit)||0,o=parseFloat(s.maxCapacity)||0,k=parseFloat(s.stockPercentage)||0,w=i*u;return e.jsxs("tr",{className:s.needsRestock?"needs-restock":"",children:[e.jsx("td",{className:"fuel-cell",children:e.jsxs("div",{className:"fuel-info",children:[e.jsx("span",{className:"fuel-icon",style:{color:r?.color},children:r?.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"fuel-name",children:r?.name}),e.jsx("div",{className:"fuel-type",children:s.fuelType})]})]})}),e.jsx("td",{children:s.location}),e.jsxs("td",{className:"stock-cell",children:[e.jsxs("div",{className:"stock-info",children:[e.jsx("span",{className:"stock-amount",children:b(i)}),e.jsxs("span",{className:"stock-unit",children:["/ ",b(o)," ",s.unit||"gal"]})]}),s.needsRestock&&e.jsx("div",{className:"restock-indicator",children:"âš ï¸ Bajo mÃ­nimo"})]}),e.jsx("td",{className:"level-cell",children:e.jsxs("div",{className:"level-info",children:[e.jsxs("div",{className:"level-badge",style:{backgroundColor:n?.color,color:"white"},children:[k,"%"]}),e.jsx("div",{className:"level-bar",children:e.jsx("div",{className:"level-fill",style:{width:`${k}%`,backgroundColor:n?.color}})})]})}),e.jsx("td",{className:"price-cell",children:e.jsxs("div",{className:"price-info",children:[e.jsx("span",{className:"price-amount",children:h(u)}),e.jsxs("span",{className:"price-unit",children:["/ ",s.unit||"gal"]})]})}),e.jsx("td",{className:"value-cell",children:e.jsx("span",{className:"total-value",children:h(w)})}),e.jsx("td",{className:"status-cell",children:e.jsxs("span",{className:`status-badge ${s.status}`,children:[e.jsx("span",{className:"status-dot"}),s.status==="active"?"Activo":s.status==="inactive"?"Inactivo":s.status==="maintenance"?"Mantenimiento":s.status]})}),e.jsx("td",{className:"updated-cell",children:e.jsx("span",{className:"time-ago",children:N(s.lastUpdated)})}),x&&e.jsx("td",{className:"actions-cell",children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>j(s),title:"Editar",children:"âœï¸"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>v(s),title:"Eliminar",children:"ðŸ—‘ï¸"})]})})]},s.id)})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:[y.length," items ordenados por ",d,"(",f==="asc"?"ascendente":"descendente",")"]}),e.jsxs("div",{className:"table-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot critical"}),"CrÃ­tico"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot low"}),"Bajo"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot normal"}),"Normal"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},_=A(B,$()),G=({items:c,onEdit:j,onDelete:v,canManage:x})=>{const d=t=>new Intl.NumberFormat("es-CO",{maximumFractionDigits:0}).format(t),a=t=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),f=t=>{if(!t)return"sin fecha";try{const b=new Date,h=t.seconds?new Date(t.seconds*1e3):new Date(t),N=b-h,l=Math.floor(N/36e5),y=Math.floor(l/24);return y>0?`hace ${y} dÃ­a${y>1?"s":""}`:l>0?`hace ${l} hora${l>1?"s":""}`:"hace unos minutos"}catch{return"fecha invÃ¡lida"}};return e.jsx("div",{className:"inventory-cards-grid",children:c.map(t=>{const b=T[t.fuelType]||{},h=parseFloat(t.stockPercentage)||0;let N="medium";h===0||h<=15?N="critical":h<=30?N="low":h>=95?N="full":N="high";const l=P[N]||P.medium,y=parseFloat(t.currentStock)||0,g=parseFloat(t.maxCapacity)||parseFloat(t.capacity)||1,s=parseFloat(t.pricePerUnit)||parseFloat(t.unitPrice)||0,r=y*s;return e.jsxs("div",{className:"inventory-card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("div",{className:"fuel-info",children:[e.jsx("span",{className:"fuel-icon",style:{color:b.color},children:b.icon}),e.jsxs("div",{className:"fuel-details",children:[e.jsx("h3",{children:b.name||t.name}),e.jsx("p",{className:"location",children:t.location})]})]}),e.jsx("div",{className:"stock-status",children:e.jsxs("span",{className:"status-badge",style:{backgroundColor:l.color,color:"white"},children:[l.icon," ",l.label]})})]}),e.jsxs("div",{className:"stock-progress",children:[e.jsxs("div",{className:"progress-header",children:[e.jsxs("span",{className:"stock-text",children:[e.jsx("span",{className:"value",children:d(y)})," / ",d(g)," gal"]}),e.jsxs("span",{className:"percentage",style:{color:l.color},children:[h.toFixed(1),"%"]})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${h}%`,backgroundColor:l.color}})}),t.needsRestock&&e.jsx("div",{className:"restock-warning",children:"âš ï¸ Nivel bajo"})]}),e.jsxs("div",{className:"card-metrics",children:[e.jsxs("div",{className:"metric",children:[e.jsx("span",{className:"metric-label",children:"Precio/gal:"}),e.jsx("span",{className:"metric-value",children:a(s)})]}),e.jsxs("div",{className:"metric",children:[e.jsx("span",{className:"metric-label",children:"Valor Total:"}),e.jsx("span",{className:"metric-value",children:a(r)})]})]}),e.jsxs("div",{className:"card-footer",children:[e.jsxs("div",{className:"last-update",children:["Actualizado ",f(t.updatedAt||t.lastUpdated)]}),x&&e.jsxs("div",{className:"card-actions",children:[e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>j(t),children:"Editar"}),e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>v(t),children:"Eliminar"})]})]})]},t.id)})})},K=({item:c,onClose:j,onSuccess:v})=>{const{userProfile:x}=E(),d=!!c,[a,f]=p.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[t,b]=p.useState({}),[h,N]=p.useState(!1);p.useEffect(()=>{d&&c&&f({fuelType:c.fuelType||"",location:c.location||"",currentStock:c.currentStock||"",maxCapacity:c.maxCapacity||"",minThreshold:c.minThreshold||"",pricePerUnit:c.pricePerUnit||"",supplier:c.supplier||"",description:c.description||"",status:c.status||"active"})},[d,c]),p.useEffect(()=>{if(a.maxCapacity&&!a.minThreshold){const r=Math.round(Number(a.maxCapacity)*.15);f(n=>({...n,minThreshold:r}))}},[a.maxCapacity,a.minThreshold]);const l=r=>{const{name:n,value:i}=r.target;f(u=>({...u,[n]:i})),t[n]&&b(u=>({...u,[n]:null}))},y=()=>{const r={};a.fuelType||(r.fuelType="Tipo de combustible es requerido"),a.location||(r.location="UbicaciÃ³n es requerida"),a.maxCapacity||(r.maxCapacity="Capacidad mÃ¡xima es requerida");const n=Number(a.currentStock),i=Number(a.maxCapacity),u=Number(a.minThreshold),o=Number(a.pricePerUnit);return a.currentStock&&(isNaN(n)||n<0)&&(r.currentStock="Stock actual debe ser un nÃºmero vÃ¡lido mayor o igual a 0"),a.maxCapacity&&(isNaN(i)||i<=0)&&(r.maxCapacity="Capacidad mÃ¡xima debe ser un nÃºmero vÃ¡lido mayor a 0"),a.minThreshold&&(isNaN(u)||u<0)&&(r.minThreshold="Umbral mÃ­nimo debe ser un nÃºmero vÃ¡lido mayor o igual a 0"),a.pricePerUnit&&(isNaN(o)||o<0)&&(r.pricePerUnit="Precio debe ser un nÃºmero vÃ¡lido mayor o igual a 0"),n>i&&(r.currentStock="Stock actual no puede ser mayor a la capacidad mÃ¡xima"),u>i&&(r.minThreshold="Umbral mÃ­nimo no puede ser mayor a la capacidad mÃ¡xima"),b(r),Object.keys(r).length===0},g=async r=>{if(r.preventDefault(),!!y()){N(!0);try{let n;d?n=await V(c.id,{location:a.location,currentStock:Number(a.currentStock)||0,maxCapacity:Number(a.maxCapacity),minThreshold:Number(a.minThreshold)||Number(a.maxCapacity)*.15,pricePerUnit:Number(a.pricePerUnit)||0,supplier:a.supplier,description:a.description,status:a.status},x.uid):n=await L({fuelType:a.fuelType,location:a.location,currentStock:Number(a.currentStock)||0,maxCapacity:Number(a.maxCapacity),minThreshold:Number(a.minThreshold)||Number(a.maxCapacity)*.15,pricePerUnit:Number(a.pricePerUnit)||0,supplier:a.supplier,description:a.description,status:a.status},x.uid),n.success?(alert(n.message),v()):alert(`Error: ${n.error}`)}catch(n){console.error("Error saving inventory item:",n),alert("Error inesperado al guardar el item")}finally{N(!1)}}},s=T[a.fuelType];return e.jsx("div",{className:"modal-overlay",onClick:j,children:e.jsxs("div",{className:"modal-content inventory-modal",onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:d?"âœï¸ Editar Combustible":"âž• Agregar Nuevo Combustible"}),e.jsx("button",{className:"modal-close",onClick:j,children:"âœ•"})]}),e.jsxs("form",{onSubmit:g,className:"modal-form",children:[e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",s&&e.jsxs("span",{className:"fuel-preview",children:[s.icon," ",s.name]})]}),e.jsxs("select",{id:"fuelType",name:"fuelType",value:a.fuelType,onChange:l,disabled:d,className:t.fuelType?"error":"",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(O).map(([r,n])=>{const i=T[n];return e.jsxs("option",{value:n,children:[i.icon," ",i.name," (",i.unit,")"]},r)})]}),t.fuelType&&e.jsx("span",{className:"error-text",children:t.fuelType})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"location",children:"UbicaciÃ³n / Tanque *"}),e.jsx("input",{type:"text",id:"location",name:"location",value:a.location,onChange:l,placeholder:"ej. Tanque Principal, DepÃ³sito A, Bodega Norte",className:t.location?"error":"",required:!0}),t.location&&e.jsx("span",{className:"error-text",children:t.location})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",s&&`(${s.unit})`]}),e.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:a.currentStock,onChange:l,placeholder:"0",min:"0",step:"0.01",className:t.currentStock?"error":""}),t.currentStock&&e.jsx("span",{className:"error-text",children:t.currentStock})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad MÃ¡xima * ",s&&`(${s.unit})`]}),e.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:a.maxCapacity,onChange:l,placeholder:"1000",min:"1",step:"0.01",className:t.maxCapacity?"error":"",required:!0}),t.maxCapacity&&e.jsx("span",{className:"error-text",children:t.maxCapacity})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"minThreshold",children:["Umbral MÃ­nimo ",s&&`(${s.unit})`,e.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),e.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:a.minThreshold,onChange:l,placeholder:"Auto: 15% de capacidad mÃ¡xima",min:"0",step:"0.01",className:t.minThreshold?"error":""}),t.minThreshold&&e.jsx("span",{className:"error-text",children:t.minThreshold}),a.maxCapacity&&e.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(a.maxCapacity)*.15)," ",s?.unit||"unidades"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",s?.unit||"Unidad"]}),e.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:a.pricePerUnit,onChange:l,placeholder:"12000",min:"0",step:"0.01",className:t.pricePerUnit?"error":""}),t.pricePerUnit&&e.jsx("span",{className:"error-text",children:t.pricePerUnit})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),e.jsx("input",{type:"text",id:"supplier",name:"supplier",value:a.supplier,onChange:l,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"status",children:"Estado"}),e.jsxs("select",{id:"status",name:"status",value:a.status,onChange:l,children:[e.jsx("option",{value:"active",children:"Activo"}),e.jsx("option",{value:"inactive",children:"Inactivo"}),e.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{htmlFor:"description",children:"DescripciÃ³n / Notas"}),e.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:l,placeholder:"InformaciÃ³n adicional sobre este combustible...",rows:"3"})]})]}),s&&a.maxCapacity&&e.jsxs("div",{className:"form-preview",children:[e.jsx("h4",{children:"ðŸ“Š Vista Previa"}),e.jsxs("div",{className:"preview-card",children:[e.jsxs("div",{className:"preview-header",children:[e.jsxs("span",{style:{color:s.color},children:[s.icon," ",s.name]}),e.jsx("span",{children:a.location})]}),e.jsxs("div",{className:"preview-capacity",children:[a.currentStock||0," / ",a.maxCapacity," ",s.unit,a.currentStock&&a.maxCapacity&&e.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(a.currentStock)/Number(a.maxCapacity)*100),"%)"]})]}),a.pricePerUnit&&e.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(a.currentStock)||0)*Number(a.pricePerUnit))]})]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",onClick:j,className:"btn btn-secondary",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:h,children:h?"Guardando...":d?"Actualizar":"Crear"})]})]})]})})},Y=({stats:c})=>e.jsxs("div",{className:"inventory-stats",children:[e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card primary",children:[e.jsx("div",{className:"stat-icon",children:"ðŸ’°"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:"Valor Total"}),e.jsx("div",{className:"stat-value",children:D(c.totalValue)}),e.jsxs("div",{className:"stat-subtitle",children:[I(c.totalItems)," tipos de combustible"]})]})]}),e.jsxs("div",{className:"stat-card success",children:[e.jsx("div",{className:"stat-icon",children:"âœ…"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:"Items Activos"}),e.jsx("div",{className:"stat-value",children:c.activeItems}),e.jsxs("div",{className:"stat-subtitle",children:[Math.round(c.activeItems/c.totalItems*100),"% del total"]})]})]}),e.jsxs("div",{className:`stat-card ${c.lowStockItems>0?"warning":"info"}`,children:[e.jsx("div",{className:"stat-icon",children:c.lowStockItems>0?"âš ï¸":"ðŸ“Š"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:"Stock Bajo"}),e.jsx("div",{className:"stat-value",children:c.lowStockItems}),e.jsx("div",{className:"stat-subtitle",children:c.lowStockItems>0?"Requieren atenciÃ³n":"Niveles normales"})]})]}),e.jsxs("div",{className:"stat-card info",children:[e.jsx("div",{className:"stat-icon",children:"ðŸ“ˆ"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:"Nivel Promedio"}),e.jsxs("div",{className:"stat-value",children:[c.averageStockLevel,"%"]}),e.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),e.jsxs("div",{className:"fuel-type-summary",children:[e.jsx("h4",{children:"ðŸ“Š Resumen por Tipo de Combustible"}),e.jsx("div",{className:"fuel-types-grid",children:Object.entries(c.byFuelType).map(([j,v])=>{const x=T[j],d=v.totalCapacity>0?Math.round(v.totalStock/v.totalCapacity*100):0;return e.jsxs("div",{className:"fuel-type-card",children:[e.jsxs("div",{className:"fuel-header",children:[e.jsx("span",{className:"fuel-icon",style:{color:x?.color||"#6b7280"},children:x?.icon||"â›½"}),e.jsxs("div",{className:"fuel-info",children:[e.jsx("h5",{children:x?.name||j}),e.jsxs("span",{className:"fuel-count",children:[v.count," ubicaciones"]})]})]}),e.jsxs("div",{className:"fuel-metrics",children:[e.jsxs("div",{className:"metric",children:[e.jsx("span",{className:"metric-label",children:"Stock Total:"}),e.jsxs("span",{className:"metric-value",children:[I(v.totalStock)," ",x?.unit||"unidades"]})]}),e.jsxs("div",{className:"metric",children:[e.jsx("span",{className:"metric-label",children:"Capacidad:"}),e.jsxs("span",{className:"metric-value",children:[I(v.totalCapacity)," ",x?.unit||"unidades"]})]}),e.jsxs("div",{className:"metric",children:[e.jsx("span",{className:"metric-label",children:"UtilizaciÃ³n:"}),e.jsxs("span",{className:`metric-value ${d<25?"low":d>75?"high":"normal"}`,children:[d,"%"]})]}),e.jsxs("div",{className:"metric",children:[e.jsx("span",{className:"metric-label",children:"Valor:"}),e.jsx("span",{className:"metric-value",children:D(v.totalValue)})]})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${d}%`,backgroundColor:x?.color||"#6b7280"}})})]},j)})}),Object.keys(c.byFuelType).length===0&&e.jsx("div",{className:"empty-fuel-types",children:e.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),J=()=>{const{hasPermission:c}=E(),[j,v]=p.useState([]),[x,d]=p.useState(null),[a,f]=p.useState(!0),[t,b]=p.useState(null),[h,N]=p.useState("cards"),[l,y]=p.useState(!1),[g,s]=p.useState(null),[r,n]=p.useState("all"),[i,u]=p.useState("");p.useEffect(()=>{let m=null;return(()=>{m=q((S,U)=>{if(U){console.error("Error in inventory subscription:",U),b("Error cargando inventario en tiempo real");return}v(S||[]),f(!1)})})(),()=>{m&&m()}},[]),p.useEffect(()=>{(async()=>{const C=await R();C.success&&d(C.data)})()},[j]);const o=j.filter(m=>{if(r==="active"&&m.status!=="active"||r==="low-stock"&&!m.needsRestock)return!1;if(i){const C=i.toLowerCase();return m.name.toLowerCase().includes(C)||m.location.toLowerCase().includes(C)||m.fuelType.toLowerCase().includes(C)}return!0}),k=m=>{if(!c("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}s(m),y(!0)},w=async m=>{if(!c("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`Â¿EstÃ¡s seguro de eliminar ${m.name} de ${m.location}?

Esta acciÃ³n no se puede deshacer.`))return;f(!0);const S=await z(m.id);S.success?alert("Item eliminado exitosamente"):(b(S.error),alert(`Error al eliminar: ${S.error}`)),f(!1)},F=()=>{y(!1),s(null)},M=()=>{F()};return a&&j.length===0?e.jsxs("div",{className:"inventory-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Cargando inventario..."})]}):e.jsxs("div",{className:"inventory-main",children:[e.jsxs("div",{className:"inventory-header",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("h2",{children:"ðŸ›¢ï¸ GestiÃ³n de Inventario"}),e.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),e.jsx("div",{className:"inventory-info",children:e.jsxs("span",{className:"info-text",children:["ðŸ’¡ Los combustibles se agregan automÃ¡ticamente desde la pestaÃ±a ",e.jsx("strong",{children:"Movimientos"})]})})]}),x&&e.jsx(Y,{stats:x}),e.jsxs("div",{className:"inventory-controls",children:[e.jsxs("div",{className:"search-filters",children:[e.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicaciÃ³n o tipo...",value:i,onChange:m=>u(m.target.value),className:"search-input"}),e.jsxs("select",{value:r,onChange:m=>n(m.target.value),className:"filter-select",children:[e.jsx("option",{value:"all",children:"Todos los items"}),e.jsx("option",{value:"active",children:"Solo activos"}),e.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),e.jsxs("div",{className:"view-toggle",children:[e.jsx("button",{className:`toggle-btn ${h==="cards"?"active":""}`,onClick:()=>N("cards"),children:"ðŸ“± Cards"}),e.jsx("button",{className:`toggle-btn ${h==="table"?"active":""}`,onClick:()=>N("table"),children:"ðŸ“Š Tabla"})]})]}),t&&e.jsxs("div",{className:"error-banner",children:[e.jsxs("span",{children:["âš ï¸ ",t]}),e.jsx("button",{onClick:()=>b(null),children:"âœ•"})]}),e.jsx("div",{className:"inventory-content",children:o.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“¦"}),e.jsx("h3",{children:"No hay items de inventario"}),e.jsx("p",{children:i||r!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaÃ±a Movimientos para crear una ENTRADA de combustible"})]}):e.jsx(e.Fragment,{children:h==="cards"?e.jsx(G,{items:o,onEdit:k,onDelete:w,canManage:c("canManageInventory")}):e.jsx(_,{items:o,onEdit:k,onDelete:w,canManage:c("canManageInventory")})})}),o.length>0&&e.jsx("div",{className:"results-footer",children:e.jsxs("p",{children:["Mostrando ",o.length," de ",j.length," items",i&&` Â· Filtro: "${i}"`,r!=="all"&&` Â· Estado: ${r}`]})}),l&&e.jsx(K,{item:g,onClose:F,onSuccess:M})]})};export{J as default};
