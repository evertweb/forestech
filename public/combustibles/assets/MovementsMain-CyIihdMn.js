import{j as e,f as V,a as G,k as o,M as L,r as v,O as z,y as R,z as D,A as J,u as _,B as K,C as Y,D as Z,E as X,G as ee}from"./index-CbuH0zjO.js";import{g as se}from"./productsService-DQLINdS6.js";const ae=({stats:s,filters:h})=>{if(!s)return null;const E=(t,n)=>n===0?t>0?100:0:((t-n)/n*100).toFixed(1),C=t=>{switch(t){case o.ENTRADA:return"#10b981";case o.SALIDA:return"#ef4444";case o.TRANSFERENCIA:return"#3b82f6";case o.AJUSTE:return"#f59e0b";default:return"#6b7280"}},N=t=>{switch(t){case o.ENTRADA:return"üì•";case o.SALIDA:return"üì§";case o.TRANSFERENCIA:return"üîÑ";case o.AJUSTE:return"‚öñÔ∏è";default:return"üìã"}},b=E(s.thisMonth,s.lastMonth);return e.jsxs("div",{className:"movements-stats",children:[e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card primary",children:[e.jsx("div",{className:"stat-icon",children:"üìä"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:V(s.totalMovements)}),e.jsx("div",{className:"stat-label",children:"Total Movimientos"}),e.jsxs("div",{className:"stat-trend",children:[e.jsxs("span",{className:`trend ${b>=0?"positive":"negative"}`,children:[b>=0?"üìà":"üìâ"," ",Math.abs(b),"%"]}),e.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"üí∞"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:G(s.totalValue)}),e.jsx("div",{className:"stat-label",children:"Valor Total"}),e.jsxs("div",{className:"stat-secondary",children:["Promedio: ",G(s.averageValue)]})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"‚õΩ"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:V(s.totalQuantity)}),e.jsx("div",{className:"stat-label",children:"Galones Total"}),e.jsxs("div",{className:"stat-secondary",children:["Promedio: ",V(s.totalQuantity/(s.totalMovements||1))," gal/mov"]})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"üìÖ"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:V(s.thisWeek)}),e.jsx("div",{className:"stat-label",children:"Esta Semana"}),e.jsxs("div",{className:"stat-secondary",children:[V(s.thisMonth)," este mes"]})]})]})]}),e.jsxs("div",{className:"stats-breakdown",children:[e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"üìã Por Tipo de Movimiento"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byType).map(([t,n])=>{const f=(n/s.totalMovements*100).toFixed(1);return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:N(t)}),e.jsx("span",{className:"breakdown-label",children:t.charAt(0).toUpperCase()+t.slice(1)})]}),e.jsx("div",{className:"breakdown-value",children:n}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${f}%`,backgroundColor:C(t)}})}),e.jsxs("div",{className:"breakdown-percentage",children:[f,"%"]})]},t)})})]}),e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"‚ö° Por Estado"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byStatus).map(([t,n])=>{const f=(n/s.totalMovements*100).toFixed(1),g=d=>{switch(d){case L.COMPLETADO:return"#10b981";case L.PENDIENTE:return"#f59e0b";case L.CANCELADO:return"#ef4444";default:return"#6b7280"}},y=d=>{switch(d){case L.COMPLETADO:return"‚úÖ";case L.PENDIENTE:return"‚è≥";case L.CANCELADO:return"‚ùå";default:return"‚ùì"}};return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:y(t)}),e.jsx("span",{className:"breakdown-label",children:t.charAt(0).toUpperCase()+t.slice(1)})]}),e.jsx("div",{className:"breakdown-value",children:n}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${f}%`,backgroundColor:g(t)}})}),e.jsxs("div",{className:"breakdown-percentage",children:[f,"%"]})]},t)})})]}),e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"‚õΩ Por Tipo de Combustible"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byFuelType).map(([t,n])=>{const f=(n/s.totalMovements*100).toFixed(1),g=y=>{switch(y?.toLowerCase()){case"diesel":return"üöõ";case"gasolina":return"üöó";case"acpm":return"üöö";case"lubricante":return"üõ¢Ô∏è";default:return"‚õΩ"}};return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:g(t)}),e.jsx("span",{className:"breakdown-label",children:t})]}),e.jsx("div",{className:"breakdown-value",children:n}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${f}%`,backgroundColor:"#059669"}})}),e.jsxs("div",{className:"breakdown-percentage",children:[f,"%"]})]},t)})})]})]}),(h.type||h.status||h.fuelType||h.vehicleId)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("h4",{children:"üîç Filtros Activos"}),e.jsxs("div",{className:"filters-list",children:[h.type&&e.jsxs("span",{className:"filter-tag",children:["Tipo: ",h.type]}),h.status&&e.jsxs("span",{className:"filter-tag",children:["Estado: ",h.status]}),h.fuelType&&e.jsxs("span",{className:"filter-tag",children:["Combustible: ",h.fuelType]}),h.vehicleId&&e.jsxs("span",{className:"filter-tag",children:["Veh√≠culo: ",h.vehicleId]})]})]})]})},ie=({filters:s,onFilterChange:h,onClearFilters:E,searchTerm:C,onSearchChange:N,totalResults:b})=>{const[t,n]=v.useState(!1),f=[{value:"Diesel",label:"Diesel üöõ"},{value:"Gasolina",label:"Gasolina üöó"},{value:"ACPM",label:"ACPM üöö"},{value:"Lubricante",label:"Lubricante üõ¢Ô∏è"}],g=[{value:"all",label:"Todos los per√≠odos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este a√±o"}],y=Object.values(s).filter(r=>r&&r!==""&&r!=="all").length,d=(r,k)=>{h({[r]:k})},p=r=>{h(r)};return e.jsxs("div",{className:"movements-filters",children:[e.jsxs("div",{className:"filters-main",children:[e.jsx("div",{className:"search-section",children:e.jsxs("div",{className:"search-box",children:[e.jsx("span",{className:"search-icon",children:"üîç"}),e.jsx("input",{type:"text",placeholder:"Buscar por combustible, veh√≠culo, referencia...",value:C,onChange:r=>N(r.target.value),className:"search-input"}),C&&e.jsx("button",{className:"search-clear",onClick:()=>N(""),title:"Limpiar b√∫squeda",children:"‚úï"})]})}),e.jsxs("div",{className:"filters-controls",children:[e.jsxs("div",{className:"quick-filters",children:[e.jsx("button",{className:`quick-filter ${s.type===o.ENTRADA?"active":""}`,onClick:()=>p({type:o.ENTRADA}),children:"üì• Entradas"}),e.jsx("button",{className:`quick-filter ${s.type===o.SALIDA?"active":""}`,onClick:()=>p({type:o.SALIDA}),children:"üì§ Salidas"}),e.jsx("button",{className:`quick-filter ${s.status===L.PENDIENTE?"active":""}`,onClick:()=>p({status:L.PENDIENTE}),children:"‚è≥ Pendientes"})]}),e.jsxs("button",{className:`btn-advanced-filters ${t?"active":""}`,onClick:()=>n(!t),children:["üéõÔ∏è Filtros",y>0&&e.jsx("span",{className:"filters-count",children:y})]}),e.jsx("div",{className:"view-indicator",children:e.jsx("span",{className:"view-info",children:"üìã Vista Tabla"})})]})]}),t&&e.jsxs("div",{className:"filters-advanced",children:[e.jsxs("div",{className:"filters-grid",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Tipo de Movimiento"}),e.jsxs("select",{value:s.type,onChange:r=>d("type",r.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los tipos"}),e.jsx("option",{value:o.ENTRADA,children:"üì• Entrada"}),e.jsx("option",{value:o.SALIDA,children:"üì§ Salida"}),e.jsx("option",{value:o.TRANSFERENCIA,children:"üîÑ Transferencia"}),e.jsx("option",{value:o.AJUSTE,children:"‚öñÔ∏è Ajuste"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Estado"}),e.jsxs("select",{value:s.status,onChange:r=>d("status",r.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los estados"}),e.jsx("option",{value:L.PENDIENTE,children:"‚è≥ Pendiente"}),e.jsx("option",{value:L.COMPLETADO,children:"‚úÖ Completado"}),e.jsx("option",{value:L.CANCELADO,children:"‚ùå Cancelado"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Tipo de Combustible"}),e.jsxs("select",{value:s.fuelType,onChange:r=>d("fuelType",r.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los combustibles"}),f.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Per√≠odo"}),e.jsx("select",{value:s.dateRange,onChange:r=>d("dateRange",r.target.value),className:"filter-select",children:g.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Veh√≠culo/Equipo"}),e.jsx("input",{type:"text",placeholder:"ID del veh√≠culo...",value:s.vehicleId,onChange:r=>d("vehicleId",r.target.value),className:"filter-input"})]})]}),e.jsxs("div",{className:"filters-actions",children:[e.jsx("button",{className:"btn-clear-filters",onClick:E,disabled:y===0,children:"üóëÔ∏è Limpiar Filtros"}),e.jsxs("div",{className:"filters-info",children:[e.jsxs("span",{className:"results-count",children:[b," resultado",b!==1?"s":""]}),y>0&&e.jsxs("span",{className:"active-filters-text",children:["(",y," filtro",y!==1?"s":""," activo",y!==1?"s":"",")"]})]})]})]}),e.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:e.jsx("small",{children:"üí° Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},te=({movements:s,onEdit:h,onView:E,onApprove:C,onReject:N,onDelete:b,userRole:t})=>{const[n,f]=v.useState("createdAt"),[g,y]=v.useState("desc"),d=l=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),p=l=>l?(l instanceof Date?l:new Date(l)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",r=l=>{switch(l){case o.ENTRADA:return"üì•";case o.SALIDA:return"üì§";case o.TRANSFERENCIA:return"üîÑ";case o.AJUSTE:return"‚öñÔ∏è";default:return"üìã"}},k=l=>{switch(l?.toLowerCase()){case"diesel":return"üöõ";case"gasolina":return"üöó";case"acpm":return"üöö";case"lubricante":return"üõ¢Ô∏è";default:return"‚õΩ"}},m=l=>{switch(l){case L.COMPLETADO:return"‚úÖ";case L.PENDIENTE:return"‚è≥";case L.CANCELADO:return"‚ùå";default:return"‚ùì"}},a=l=>{switch(l){case L.COMPLETADO:return"status-completado";case L.PENDIENTE:return"status-pendiente";case L.CANCELADO:return"status-cancelado";default:return"status-default"}},i=l=>{n===l?y(g==="asc"?"desc":"asc"):(f(l),y("asc"))},u=[...s].sort((l,S)=>{let A=l[n],j=S[n];return(n.includes("Date")||n.includes("At"))&&(A=new Date(A),j=new Date(j)),typeof A=="number"&&typeof j=="number"?g==="asc"?A-j:j-A:typeof A=="string"&&typeof j=="string"?g==="asc"?A.localeCompare(j):j.localeCompare(A):A instanceof Date&&j instanceof Date?g==="asc"?A-j:j-A:0}),x=l=>n!==l?"‚ÜïÔ∏è":g==="asc"?"‚Üë":"‚Üì";return e.jsxs("div",{className:"movements-table-container",children:[e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"movements-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"sortable",onClick:()=>i("type"),children:["Tipo ",x("type")]}),e.jsxs("th",{className:"sortable",onClick:()=>i("fuelType"),children:["Combustible ",x("fuelType")]}),e.jsxs("th",{className:"sortable text-right",onClick:()=>i("quantity"),children:["Cantidad ",x("quantity")]}),e.jsxs("th",{className:"sortable text-right",onClick:()=>i("unitPrice"),children:["Precio/Gal ",x("unitPrice")]}),e.jsxs("th",{className:"sortable text-right",onClick:()=>i("totalValue"),children:["Valor Total ",x("totalValue")]}),e.jsx("th",{children:"Veh√≠culo"}),e.jsx("th",{children:"Ubicaci√≥n"}),e.jsxs("th",{className:"sortable",onClick:()=>i("status"),children:["Estado ",x("status")]}),e.jsxs("th",{className:"sortable",onClick:()=>i("createdAt"),children:["Fecha ",x("createdAt")]}),e.jsx("th",{className:"actions-column",children:"Acciones"})]})}),e.jsx("tbody",{children:u.map(l=>e.jsxs("tr",{className:`movement-row ${l.status===L.PENDIENTE?"pending-row":""}`,children:[e.jsx("td",{className:"type-cell",children:e.jsxs("div",{className:"type-content",children:[e.jsx("span",{className:"type-icon",children:r(l.type)}),e.jsx("span",{className:"type-text",children:l.type?l.type.charAt(0).toUpperCase()+l.type.slice(1):"Sin tipo"})]})}),e.jsx("td",{className:"fuel-cell",children:e.jsxs("div",{className:"fuel-content",children:[e.jsx("span",{className:"fuel-icon",children:k(l.fuelType)}),e.jsx("span",{className:"fuel-text",children:l.fuelType})]})}),e.jsxs("td",{className:"quantity-cell text-right",children:[e.jsx("span",{className:"quantity-value",children:l.quantity}),e.jsx("span",{className:"quantity-unit",children:"gal"})]}),e.jsx("td",{className:"price-cell text-right",children:d(l.unitPrice)}),e.jsx("td",{className:"value-cell text-right",children:e.jsx("strong",{children:d(l.totalValue)})}),e.jsx("td",{className:"vehicle-cell",children:l.vehicleId?e.jsxs("span",{className:"vehicle-id",children:["üöú ",l.vehicleId]}):e.jsx("span",{className:"no-vehicle",children:"-"})}),e.jsx("td",{className:"location-cell",children:e.jsxs("span",{className:"location-text",children:["üìç ",l.type===o.ENTRADA?l.destinationLocation||"Sin ubicaci√≥n":l.location||"Principal"]})}),e.jsx("td",{className:"status-cell",children:e.jsxs("div",{className:`status-badge ${a(l.status)}`,children:[e.jsx("span",{className:"status-icon",children:m(l.status)}),e.jsx("span",{className:"status-text",children:l.status?l.status.charAt(0).toUpperCase()+l.status.slice(1):"Sin estado"})]})}),e.jsx("td",{className:"date-cell",children:e.jsxs("div",{className:"date-content",children:[e.jsx("span",{className:"date-value",children:p(l.createdAt)}),l.reference&&e.jsxs("span",{className:"reference-small",children:["#",l.reference]})]})}),e.jsx("td",{className:"actions-cell",children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn-action btn-view",onClick:()=>E(l),title:"Ver detalles",children:"üëÅÔ∏è"}),t==="admin"&&l.status===L.PENDIENTE&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-action btn-approve",onClick:()=>C(l.id),title:"Aprobar movimiento",children:"‚úì"}),e.jsx("button",{className:"btn-action btn-reject",onClick:()=>N(l.id),title:"Rechazar movimiento",children:"‚úó"})]}),h&&l.status===L.PENDIENTE&&e.jsx("button",{className:"btn-action btn-edit",onClick:()=>h(l),title:"Editar movimiento",children:"‚úèÔ∏è"}),t==="admin"&&e.jsx("button",{className:"btn-action btn-delete",onClick:()=>{window.confirm("¬øEst√°s seguro de que deseas eliminar este movimiento? Esta acci√≥n no se puede deshacer.")&&b(l.id)},title:"Eliminar movimiento",children:"üóëÔ∏è"})]})})]},l.id))})]})}),e.jsxs("div",{className:"table-info",children:[e.jsxs("div",{className:"table-summary",children:[e.jsxs("span",{className:"total-rows",children:[s.length," movimiento",s.length!==1?"s":""]}),n&&e.jsxs("span",{className:"sort-info",children:["Ordenado por ",n," (",g==="asc"?"ascendente":"descendente",")"]})]}),e.jsxs("div",{className:"table-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"‚è≥"})," Pendiente"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"‚úÖ"})," Completado"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"‚ùå"})," Cancelado"]})]})]})]})},ne=({movements:s,onEdit:h,onView:E,onApprove:C,onReject:N,onDelete:b,userRole:t})=>e.jsx(te,{movements:s,onEdit:h,onView:E,onApprove:C,onReject:N,onDelete:b,userRole:t}),le=({formData:s,updateFormData:h,setError:E,isActive:C})=>{const N=[{type:o.ENTRADA,icon:"üì•",title:"Entrada",description:"Compra o reabastecimiento de combustible",color:"entrada",details:"Registra combustible que llega desde proveedores"},{type:o.SALIDA,icon:"üì§",title:"Salida",description:"Consumo de combustible por veh√≠culos",color:"salida",details:"Asigna combustible a veh√≠culos y equipos"},{type:o.TRANSFERENCIA,icon:"üîÑ",title:"Transferencia",description:"Movimiento entre ubicaciones",color:"transferencia",details:"Traslada combustible entre tanques o sitios"},{type:o.AJUSTE,icon:"‚öñÔ∏è",title:"Ajuste",description:"Correcci√≥n de inventario",color:"ajuste",details:"Ajusta stock por mermas, p√©rdidas o calibraciones"}],b=t=>{h("type",t),E("")};return e.jsx("div",{className:`wizard-step step-movement-type ${C?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"üçÄ ¬øQu√© tipo de operaci√≥n realizar√°s?"}),e.jsx("p",{children:"Selecciona el tipo de movimiento que necesitas registrar:"})]}),e.jsx("div",{className:"typeform-options",children:N.map(t=>e.jsxs("div",{className:`typeform-option ${s.type===t.type?"selected":""} ${t.color}`,onClick:()=>b(t.type),children:[e.jsx("div",{className:"typeform-option-icon",children:t.icon}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:t.title}),e.jsx("p",{children:t.description})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},t.type))}),s.type&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card",children:[e.jsx("span",{className:"confirmation-icon",children:N.find(t=>t.type===s.type)?.icon}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:"Seleccionado:"})," ",N.find(t=>t.type===s.type)?.title,e.jsx("br",{}),e.jsx("small",{children:N.find(t=>t.type===s.type)?.description})]})]})})]})})},ce=({formData:s,updateFormData:h,systemData:E,setError:C,isActive:N})=>{const[b,t]=v.useState(!1),[n,f]=v.useState(null),{products:g}=E;v.useEffect(()=>{if(s.fuelType&&g.length>0){const d=g.find(p=>p.name===s.fuelType||p.displayName===s.fuelType);f(d),d&&d.defaultPrice&&!s.unitPrice&&h("unitPrice",d.defaultPrice.toString())}},[s.fuelType,s.unitPrice,g,h]);const y=async(d,p)=>{t(!0),C("");try{await new Promise(r=>setTimeout(r,800)),h("fuelType",d),f(p),p.defaultPrice&&h("unitPrice",p.defaultPrice.toString()),console.log("üîÑ [Step2] Combustible seleccionado:",d,"Precio:",p.defaultPrice),console.log("üîç [Step2] FormData despu√©s de actualizaci√≥n:",{fuelType:d,unitPrice:p.defaultPrice})}catch(r){console.error("Error al cargar combustible:",r),C("Error al cargar informaci√≥n del combustible")}finally{t(!1)}};return g.length===0?e.jsx("div",{className:`wizard-step step-fuel-type ${N?"active":""}`,children:e.jsx("div",{className:"typeform-layout",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîÑ Cargando productos disponibles..."})]})})}):e.jsx("div",{className:`wizard-step step-fuel-type ${N?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"‚õΩ ¬øQu√© combustible vas a mover?"}),e.jsx("p",{children:"Selecciona el producto del inventario:"})]}),b&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üì° Solicitando precios actualizados..."})]}),e.jsx("div",{className:"typeform-options",children:g.map(d=>e.jsxs("div",{className:`typeform-option ${s.fuelType===d.name?"selected":""} ${b?"disabled":""}`,onClick:()=>!b&&y(d.name,d),children:[e.jsx("div",{className:"typeform-option-icon",children:d.icon||"üõ¢Ô∏è"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:d.displayName||d.name}),e.jsx("p",{children:d.description||"Combustible"}),d.defaultPrice&&e.jsxs("div",{className:"fuel-price",children:[e.jsx("span",{className:"price-label",children:"Precio actual:"}),e.jsxs("span",{className:"price-value",children:["$",d.defaultPrice.toLocaleString("es-CO")," COP/gal"]})]})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},d.id))}),n&&s.fuelType&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card fuel-confirmation",children:[e.jsxs("div",{className:"confirmation-header",children:[e.jsx("span",{className:"confirmation-icon",children:n.icon||"üõ¢Ô∏è"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:n.displayName||n.name}),e.jsx("br",{}),e.jsx("small",{children:n.description||"Combustible seleccionado"})]})]}),n.defaultPrice&&e.jsxs("div",{className:"price-confirmation",children:[e.jsxs("div",{className:"price-info",children:[e.jsx("span",{className:"price-label",children:"üí∞ Precio por gal√≥n:"}),e.jsxs("span",{className:"price-amount",children:["$",n.defaultPrice.toLocaleString("es-CO")," COP"]})]}),e.jsx("small",{className:"price-note",children:"‚ú® Precio aplicado autom√°ticamente (puedes modificarlo m√°s adelante)"})]})]})})]})})},re=({formData:s,updateFormData:h,systemData:E,setError:C,isActive:N})=>{const[b,t]=v.useState(!1),[n,f]=v.useState({}),[g,y]=v.useState(!1),{suppliers:d,inventory:p}=E,r=s.type===o.ENTRADA;v.useEffect(()=>{(async()=>{if(!r&&s.fuelType&&p.length>0){y(!0),await new Promise(i=>setTimeout(i,600));const a={};console.log("üîç DEBUG Step3 - Datos para validaci√≥n:",{fuelType:s.fuelType,inventoryTotal:p.length,inventarioMuestra:p.slice(0,2),operationalLocations:z}),z.forEach(i=>{const u=p.filter(j=>j.fuelType===s.fuelType&&j.location?.toLowerCase()===i.toLowerCase()&&j.status==="active");console.log(`üîç DEBUG ${i}:`,{itemsEncontrados:u.length,detalles:u.map(j=>({id:j.id,fuelType:j.fuelType,location:j.location,status:j.status,currentStock:j.currentStock,maxCapacity:j.maxCapacity}))});const x=u.reduce((j,q)=>j+(parseFloat(q.currentStock)||0),0),l=p.filter(j=>j.fuelType===s.fuelType&&j.location?.toLowerCase()===i.toLowerCase()&&j.status==="active").reduce((j,q)=>j+(parseFloat(q.maxCapacity)||0),0);let S="available",A=`${x.toFixed(1)} gal disponibles`;x===0?(S="empty",A="Sin stock disponible"):x<l*.2&&(S="low",A=`${x.toFixed(1)} gal (stock bajo)`),a[i]={available:x,maxCapacity:l,status:S,message:A,percentage:l>0?x/l*100:0}}),f(a),y(!1),console.log("üîç Stock validado por ubicaci√≥n:",a)}})()},[s.fuelType,r,p]);const k=async m=>{t(!0),C("");try{await new Promise(a=>setTimeout(a,400)),h(r?"supplierName":"location",m),console.log("üìç Ubicaci√≥n seleccionada:",m)}catch(a){console.error("Error al validar ubicaci√≥n:",a),C("Error al validar la ubicaci√≥n")}finally{t(!1)}};if(r){const m=d.filter(a=>a.status==="active");return e.jsx("div",{className:`wizard-step step-location ${N?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"üè™ ¬øDe qu√© proveedor viene el combustible?"}),e.jsx("p",{children:"Selecciona el proveedor de origen:"})]}),b&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîÑ Validando proveedor..."})]}),e.jsx("div",{className:"typeform-options",children:m.map(a=>e.jsxs("div",{className:`typeform-option ${s.supplierName===a.name?"selected":""} ${b?"disabled":""}`,onClick:()=>!b&&k(a.name),children:[e.jsx("div",{className:"typeform-option-icon",children:"üè™"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:a.name}),e.jsx("p",{children:a.city})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},a.id))}),s.supplierName&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card",children:[e.jsx("span",{className:"confirmation-icon",children:"üè™"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:"Proveedor:"})," ",s.supplierName,e.jsx("br",{}),e.jsx("small",{children:"Origen del combustible confirmado"})]})]})})]})})}return e.jsx("div",{className:`wizard-step step-location ${N?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"üìç ¬øDe qu√© ubicaci√≥n sale el combustible?"}),e.jsx("p",{children:"Selecciona la ubicaci√≥n de origen:"})]}),g&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîç Verificando stock disponible..."})]}),e.jsx("div",{className:"typeform-options",children:z.map(m=>{const a=n[m],i=!a||a.status!=="empty";return e.jsxs("div",{className:`typeform-option ${s.location===m?"selected":""} 
                           ${a?.status||"unknown"} ${!i||b?"disabled":""}`,onClick:()=>i&&!b&&k(m),children:[e.jsx("div",{className:"typeform-option-icon",children:"üìç"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:R(m)}),a&&e.jsxs("div",{className:"stock-info",children:[e.jsx("p",{className:"stock-message",children:a.message}),a.available>0&&e.jsx("div",{className:"stock-bar-mini",children:e.jsx("div",{className:"stock-fill-mini",style:{width:`${Math.min(100,a.percentage)}%`}})})]})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},m)})}),s.location&&n[s.location]&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card location-confirmation",children:[e.jsxs("div",{className:"confirmation-header",children:[e.jsx("span",{className:"confirmation-icon",children:"üìç"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:R(s.location)}),e.jsx("br",{}),e.jsx("small",{children:"Ubicaci√≥n de origen confirmada"})]})]}),e.jsxs("div",{className:"stock-confirmation",children:[e.jsxs("div",{className:"stock-detail",children:[e.jsx("span",{className:"stock-label",children:"üìä Stock disponible:"}),e.jsxs("span",{className:"stock-value",children:[n[s.location].available.toFixed(1)," gal"]})]}),e.jsx("div",{className:"capacity-bar",children:e.jsx("div",{className:"capacity-fill",style:{width:`${n[s.location].percentage}%`}})}),e.jsxs("small",{className:"capacity-text",children:[n[s.location].percentage.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},oe=({formData:s,updateFormData:h,systemData:E,setError:C,isActive:N})=>{const[b,t]=v.useState(!1),[n,f]=v.useState(null),[g,y]=v.useState(""),{inventory:d}=E,p=s.type===o.SALIDA||s.type===o.TRANSFERENCIA;v.useEffect(()=>{(async()=>{if(p&&s.fuelType&&s.location&&d.length>0){t(!0),await new Promise(I=>setTimeout(I,500));const a=d.filter(I=>I.fuelType===s.fuelType&&I.location?.toLowerCase()===s.location?.toLowerCase()&&I.status==="active").reduce((I,M)=>I+(parseFloat(M.currentStock)||0),0),i=d.filter(I=>I.fuelType===s.fuelType&&I.location?.toLowerCase()===s.location?.toLowerCase()&&I.status==="active").reduce((I,M)=>I+(parseFloat(M.maxCapacity)||0),0),u=parseFloat(s.quantity)||0,x=a-u,l=i>0?a/i*100:0;let S="available",A="‚úÖ",j="Stock Suficiente",q="Hay suficiente combustible disponible.";if(u>0&&(a<u?(S="critical",A="üö´",j="Stock Insuficiente",q=`Faltan ${(u-a).toFixed(2)} galones.`):x<a*.2?(S="warning",A="‚ö†Ô∏è",j="Stock Quedar√° Bajo",q=`Despu√©s del movimiento quedar√°n ${x.toFixed(2)} galones.`):q=`Despu√©s del movimiento quedar√°n ${x.toFixed(2)} galones disponibles.`),f({available:a,required:u,remaining:Math.max(0,x),maxCapacity:i,capacityPercentage:l,status:S,icon:A,title:j,message:q,isValid:a>=u}),u>0&&p){const I={type:s.type===o.SALIDA?"outbound":"transfer",fuelType:s.fuelType,quantity:s.quantity,sourceLocation:s.location},M=D(I,d);M.isValid?M.warning?y(`‚ö†Ô∏è ${M.warning}`):y(""):y(`üö´ ${M.error}`)}else p||y("");t(!1)}})()},[s.quantity,s.fuelType,s.location,s.type,p,d]);const r=m=>{const a=parseFloat(m);(m===""||!isNaN(a)&&a>=0)&&(h("quantity",m),C(""))},k=()=>{if(!n||!n.available)return[];const m=n.available;return[{label:"25%",value:(m*.25).toFixed(1)},{label:"50%",value:(m*.5).toFixed(1)},{label:"75%",value:(m*.75).toFixed(1)},{label:"Todo",value:m.toFixed(1)}]};return e.jsx("div",{className:`wizard-step step-quantity ${N?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"üìä ¬øCu√°ntos galones necesitas?"}),e.jsx("p",{children:"Especifica la cantidad de combustible:"})]}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("input",{id:"quantity",type:"number",step:"0.1",min:"0",value:s.quantity,onChange:m=>r(m.target.value),placeholder:"0.0",className:`typeform-input ${g?"error":""}`}),e.jsx("span",{className:"typeform-unit",children:"galones"})]}),n&&n.available>0&&e.jsxs("div",{className:"quantity-suggestions",children:[e.jsx("label",{children:"Cantidades sugeridas:"}),e.jsx("div",{className:"suggestion-buttons",children:k().map((m,a)=>e.jsxs("button",{type:"button",className:"suggestion-btn",onClick:()=>r(m.value),children:[m.label,e.jsx("br",{}),e.jsxs("small",{children:[m.value," gal"]})]},a))})]}),b&&e.jsxs("div",{className:"calculating-indicator",children:[e.jsx("div",{className:"loading-spinner small"}),e.jsx("span",{children:"‚öôÔ∏è Calculando disponibilidad..."})]}),n&&p&&!b&&e.jsxs("div",{className:`stock-info-container ${n.status}`,children:[e.jsxs("div",{className:"stock-info-header",children:[e.jsx("div",{className:"stock-info-icon",children:n.icon}),e.jsx("h4",{className:"stock-info-title",children:n.title})]}),e.jsx("div",{className:"stock-info-message",children:n.message})]}),g&&e.jsx("div",{className:"validation-warning",children:g}),s.quantity&&parseFloat(s.quantity)>0&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card",children:[e.jsx("span",{className:"confirmation-icon",children:"üìä"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:"Cantidad:"})," ",parseFloat(s.quantity).toFixed(2)," galones",e.jsx("br",{}),e.jsx("small",{children:p?`Se restar√° del inventario de ${s.location}`:`Se a√±adir√° al inventario de ${s.destinationLocation||"ubicaci√≥n no especificada"}`})]})]})})]})})},de=({formData:s,updateFormData:h,systemData:E,setError:C,isActive:N})=>{const[b,t]=v.useState(!1),[n,f]=v.useState(null),[g,y]=v.useState(!1),[d,p]=v.useState(""),{vehicles:r}=E;v.useEffect(()=>{if(s.vehicleId&&r.length>0){const i=r.find(x=>x.vehicleId===s.vehicleId);f(i);const u=k(i);y(u)}},[s.vehicleId,r]);const k=i=>{if(!i)return!1;const u=i.fuelType==="diesel"||i.fuelType==="Diesel",x=i.vehicleId?.toUpperCase(),l=x&&(x.includes("TR1")||x.includes("TR2")||x.includes("TR3")||x==="TR1"||x==="TR2"||x==="TR3"),S=i.category==="tractor"||i.type?.toLowerCase().includes("tractor");return u||l||S},m=async i=>{t(!0),C("");try{await new Promise(x=>setTimeout(x,600)),h("vehicleId",i.vehicleId),f(i);const u=k(i);y(u),!u&&s.currentHours&&h("currentHours",""),console.log("‚õΩ [Step5] Veh√≠culo seleccionado:",i.vehicleId,"Requiere hor√≥metro:",u,"Tipo combustible:",i.fuelType),console.log("üîç [Step5] FormData despu√©s de selecci√≥n:",{vehicleId:i.vehicleId,type:s.type,fuelType:s.fuelType,location:s.location})}catch(u){console.error("Error al validar veh√≠culo:",u),C("Error al validar el veh√≠culo")}finally{t(!1)}},a=i=>{const u=parseFloat(i);(i===""||!isNaN(u)&&u>=0)&&(h("currentHours",i),n?.currentHours&&u<parseFloat(n.currentHours)?p(`La lectura debe ser mayor a la anterior: ${n.currentHours} hrs`):p(""))};return s.type!==o.SALIDA?null:r.length===0?e.jsx("div",{className:`wizard-step step-vehicle ${N?"active":""}`,children:e.jsx("div",{className:"typeform-layout",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîÑ Cargando veh√≠culos disponibles..."})]})})}):e.jsx("div",{className:`wizard-step step-vehicle ${N?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"üöú ¬øA qu√© veh√≠culo/equipo va el combustible?"}),e.jsx("p",{children:"Selecciona el veh√≠culo que recibir√° el combustible:"})]}),b&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîÑ Validando veh√≠culo..."})]}),e.jsx("div",{className:"typeform-options",children:r.map(i=>{const u=k(i);return e.jsxs("div",{className:`typeform-option ${s.vehicleId===i.vehicleId?"selected":""} 
                           ${u?"diesel-vehicle":""} ${b?"disabled":""}`,onClick:()=>!b&&m(i),children:[e.jsx("div",{className:"typeform-option-icon",children:u?"‚õΩ":"üöö"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsxs("h4",{children:[i.vehicleId," - ",i.name]}),e.jsx("p",{children:i.type}),i.currentHours&&u&&e.jsxs("small",{className:"vehicle-hours",children:["‚è±Ô∏è Hor√≥metro: ",i.currentHours," hrs"]}),u&&e.jsx("small",{className:"diesel-indicator",children:"‚õΩ Veh√≠culo diesel - Requiere hor√≥metro"})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},i.id)})}),g&&n&&e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"currentHours",children:"Hor√≥metro actual (horas trabajadas) *"}),e.jsx("input",{id:"currentHours",type:"number",step:"0.1",min:"0",value:s.currentHours,onChange:i=>a(i.target.value),placeholder:"0.0",className:`typeform-input ${d?"error":""}`}),e.jsx("span",{className:"typeform-unit",children:"horas"}),n.currentHours&&e.jsxs("small",{className:"hour-meter-hint",children:["üí° √öltima lectura: ",n.currentHours," horas"]}),d&&e.jsx("div",{className:"field-error",children:d})]}),n&&s.vehicleId&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card vehicle-confirmation",children:[e.jsxs("div",{className:"confirmation-header",children:[e.jsx("span",{className:"confirmation-icon",children:k(n)?"‚õΩ":"üöö"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsxs("strong",{children:[n.vehicleId," - ",n.name]}),e.jsx("br",{}),e.jsx("small",{children:n.type})]})]}),e.jsxs("div",{className:"vehicle-details",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"üìã Tipo:"}),e.jsx("span",{className:"detail-value",children:n.type})]}),n.category&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"üè∑Ô∏è Categor√≠a:"}),e.jsx("span",{className:"detail-value",children:n.category})]}),g&&s.currentHours&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"‚è±Ô∏è Hor√≥metro:"}),e.jsxs("span",{className:"detail-value",children:[s.currentHours," hrs"]})]})]}),k(n)&&!s.currentHours&&e.jsx("div",{className:"warning-message",children:"‚ö†Ô∏è Se requiere lectura del hor√≥metro para veh√≠culos diesel"})]})})]})})},Q=({formData:s,updateFormData:h,systemData:E,setError:C,isEntryDestination:N=!1,isActive:b})=>{const[t,n]=v.useState(!1),[f,g]=v.useState({}),[y,d]=v.useState(!1),{inventory:p}=E;v.useEffect(()=>{(async()=>{if(s.fuelType&&s.quantity&&p.length>0&&!N){d(!0),await new Promise(u=>setTimeout(u,700));const a=parseFloat(s.quantity)||0,i={};z.filter(u=>N?!0:u!==s.location).forEach(u=>{const x=p.filter(T=>T.fuelType===s.fuelType&&T.location?.toLowerCase()===u.toLowerCase()&&T.status==="active").reduce((T,w)=>T+(parseFloat(w.currentStock)||0),0),l=p.filter(T=>T.fuelType===s.fuelType&&T.location?.toLowerCase()===u.toLowerCase()&&T.status==="active").reduce((T,w)=>T+(parseFloat(w.maxCapacity)||0),0),S=l-x,A=x+a,j=l>0?A/l*100:0;let q="available",I=`Capacidad: ${S.toFixed(1)} gal libres`,M=S>=a;l===0?(q="no_capacity",I="Sin tanques configurados",M=!1):S<a?(q="insufficient",I=`Insuficiente: faltan ${(a-S).toFixed(1)} gal`,M=!1):j>90&&(q="warning",I=`Quedar√° al ${j.toFixed(1)}% (casi lleno)`),i[u]={currentStock:x,maxCapacity:l,availableCapacity:S,afterTransfer:A,occupancyAfter:j,status:q,message:I,canAcceptTransfer:M}}),g(i),d(!1),console.log("üîç Capacidad validada por destino:",i)}})()},[s.fuelType,s.quantity,s.location,p,N]);const r=async m=>{const a=f[m];if(!N&&!a?.canAcceptTransfer){C("Esta ubicaci√≥n no puede recibir la cantidad solicitada");return}n(!0),C("");try{await new Promise(i=>setTimeout(i,500)),h("destinationLocation",m),console.log("üéØ Destino seleccionado:",m)}catch(i){console.error("Error al validar destino:",i),C("Error al validar el destino")}finally{n(!1)}};if(!N&&s.type!==o.TRANSFERENCIA)return null;const k=N?J:z.filter(m=>m!==s.location);return e.jsx("div",{className:`wizard-step step-destination ${b?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsxs("h3",{children:["üéØ ",N?"¬øA qu√© ubicaci√≥n llegar√° el combustible?":"¬øHacia qu√© ubicaci√≥n se transfiere?"]}),e.jsx("p",{children:"Selecciona la ubicaci√≥n de destino:"})]}),y&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîç Verificando capacidad disponible..."})]}),e.jsx("div",{className:"typeform-options",children:k.map(m=>{const a=f[m],i=!a||a.canAcceptTransfer;return e.jsxs("div",{className:`typeform-option ${s.destinationLocation===m?"selected":""} 
                           ${a?.status||"unknown"} ${!i||t?"disabled":""}`,onClick:()=>i&&!t&&r(m),children:[e.jsx("div",{className:"typeform-option-icon",children:"üéØ"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:R(m)}),a&&e.jsxs("div",{className:"capacity-info",children:[e.jsx("p",{className:"capacity-message",children:a.message}),a.maxCapacity>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"capacity-bar-mini",children:[e.jsx("div",{className:"capacity-current-mini",style:{width:`${Math.min(100,a.currentStock/a.maxCapacity*100)}%`}}),a.canAcceptTransfer&&e.jsx("div",{className:"capacity-after-mini",style:{width:`${Math.min(100,a.occupancyAfter)}%`,left:`${Math.min(100,a.currentStock/a.maxCapacity*100)}%`}})]}),e.jsxs("small",{className:"capacity-details",children:["Actual: ",a.currentStock.toFixed(1),"/",a.maxCapacity.toFixed(1)," gal"]})]})]})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},m)})}),s.location&&s.quantity&&e.jsx("div",{className:"transfer-summary",children:e.jsxs("div",{className:"transfer-flow",children:[e.jsxs("div",{className:"transfer-origin",children:[e.jsx("span",{className:"transfer-icon",children:"üìç"}),e.jsxs("div",{className:"transfer-info",children:[e.jsx("strong",{children:R(s.location)}),e.jsx("small",{children:"Origen"})]})]}),e.jsxs("div",{className:"transfer-arrow",children:[e.jsx("span",{children:"‚Üí"}),e.jsxs("small",{children:[parseFloat(s.quantity).toFixed(1)," gal"]})]}),e.jsxs("div",{className:"transfer-destination",children:[e.jsx("span",{className:"transfer-icon",children:"üéØ"}),e.jsxs("div",{className:"transfer-info",children:[e.jsx("strong",{children:s.destinationLocation?R(s.destinationLocation):"Seleccionar destino"}),e.jsx("small",{children:"Destino"})]})]})]})}),s.destinationLocation&&f[s.destinationLocation]&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card destination-confirmation",children:[e.jsxs("div",{className:"confirmation-header",children:[e.jsx("span",{className:"confirmation-icon",children:"üéØ"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:R(s.destinationLocation)}),e.jsx("br",{}),e.jsx("small",{children:"Ubicaci√≥n de destino confirmada"})]})]}),e.jsxs("div",{className:"capacity-confirmation",children:[e.jsxs("div",{className:"capacity-detail",children:[e.jsx("span",{className:"capacity-label",children:"üìä Despu√©s de transferir:"}),e.jsxs("span",{className:"capacity-value",children:[f[s.destinationLocation].afterTransfer.toFixed(1)," gal"]})]}),e.jsx("div",{className:"occupancy-bar",children:e.jsx("div",{className:"occupancy-fill",style:{width:`${f[s.destinationLocation].occupancyAfter}%`}})}),e.jsxs("small",{className:"occupancy-text",children:[f[s.destinationLocation].occupancyAfter.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},ue=({formData:s,updateFormData:h,systemData:E,error:C,setError:N,isActive:b})=>{const[t,n]=v.useState(!1),[f,g]=v.useState(!1),{products:y}=E;v.useEffect(()=>{if(s.fuelType&&!s.unitPrice&&y.length>0){const i=y.find(u=>u.name===s.fuelType||u.displayName===s.fuelType);i&&i.defaultPrice&&(h("unitPrice",i.defaultPrice.toString()),g(!0))}},[s.fuelType,s.unitPrice,y,h]);const d=async i=>{const u=parseFloat(i);(i===""||!isNaN(u)&&u>=0)&&(n(!0),await new Promise(x=>setTimeout(x,300)),h("unitPrice",i),g(i!==""),N(""),n(!1))},p=i=>{h("effectiveDate",i)},r=i=>{h("description",i)},k=(parseFloat(s.quantity)||0)*(parseFloat(s.unitPrice)||0),m=i=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(i),a=()=>y.find(i=>i.name===s.fuelType||i.displayName===s.fuelType);return e.jsx("div",{className:`wizard-step step-details ${b?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"üìã Informaci√≥n adicional del movimiento"}),e.jsx("p",{children:"Completa los detalles restantes:"})]}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"unitPrice",children:"üí∞ Precio por gal√≥n (COP) *"}),e.jsx("input",{id:"unitPrice",type:"number",step:"1",min:"0",value:s.unitPrice,onChange:i=>d(i.target.value),placeholder:"0",className:`typeform-input ${C?"error":""}`}),e.jsx("span",{className:"typeform-unit",children:"COP"}),t&&e.jsxs("div",{className:"calculating-price",children:[e.jsx("div",{className:"loading-spinner small"}),e.jsx("span",{children:"üí∞ Validando precio..."})]}),a()?.defaultPrice&&e.jsxs("small",{className:"price-suggestion",children:["üí° Precio sugerido: $",a().defaultPrice.toLocaleString("es-CO")," COP"]})]}),s.quantity&&s.unitPrice&&f&&e.jsx("div",{className:"total-value-section",children:e.jsxs("div",{className:"total-value-card",children:[e.jsx("div",{className:"total-icon",children:"üìä"}),e.jsxs("div",{className:"total-content",children:[e.jsx("h4",{children:"Valor Total Calculado"}),e.jsxs("div",{className:"total-calculation",children:[e.jsxs("span",{className:"calculation-details",children:[parseFloat(s.quantity).toFixed(2)," gal √ó $",parseFloat(s.unitPrice).toLocaleString("es-CO")," COP"]}),e.jsx("div",{className:"total-amount",children:m(k)})]})]})]})}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"effectiveDate",children:"üìÖ ¬øCu√°ndo ocurri√≥ este movimiento?"}),e.jsx("input",{id:"effectiveDate",type:"datetime-local",value:s.effectiveDate,onChange:i=>p(i.target.value),className:"typeform-input"}),e.jsx("small",{className:"typeform-unit",children:"üí° Por defecto se usa la fecha y hora actual"})]}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"description",children:"üìù Detalles adicionales del movimiento (opcional)"}),e.jsx("textarea",{id:"description",value:s.description,onChange:i=>r(i.target.value),placeholder:"Ej: Combustible para operaci√≥n en sector norte, mantenimiento programado, etc.",className:"typeform-input",rows:"3",maxLength:"500"}),e.jsxs("div",{className:"description-counter",children:[s.description.length,"/500 caracteres"]})]})]})})},me=({formData:s,systemData:h,isLoading:E,error:C,onCommentsChange:N,confirmChecked:b,onConfirmChange:t})=>{const{vehicles:n,products:f,suppliers:g}=h,y=S=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(S),d=()=>({[o.ENTRADA]:{icon:"üì•",title:"Entrada",color:"entrada"},[o.SALIDA]:{icon:"üì§",title:"Salida",color:"salida"},[o.TRANSFERENCIA]:{icon:"üîÑ",title:"Transferencia",color:"transferencia"},[o.AJUSTE]:{icon:"‚öñÔ∏è",title:"Ajuste",color:"ajuste"}})[s.type]||{icon:"‚ùì",title:"Desconocido",color:"unknown"},p=()=>f.find(S=>S.name===s.fuelType||S.displayName===s.fuelType),r=()=>n.find(S=>S.vehicleId===s.vehicleId),k=()=>{const S=s.type===o.ENTRADA?s.supplierName:s.location;return g.find(A=>A.name===S)},m=(parseFloat(s.quantity)||0)*(parseFloat(s.unitPrice)||0),a=d(),i=p(),u=r(),x=k(),l=S=>{N(S.target.value)};return e.jsx("div",{className:"wizard-step step-summary",children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"‚úÖ Confirma tu movimiento"}),e.jsx("p",{children:"Revisa toda la informaci√≥n antes de crear el movimiento:"})]}),e.jsxs("div",{className:"summary-main",children:[e.jsxs("div",{className:`summary-header ${a.color}`,children:[e.jsx("div",{className:"summary-icon",children:a.icon}),e.jsxs("div",{className:"summary-title",children:[e.jsxs("h4",{children:[a.title," de Combustible"]}),e.jsxs("p",{children:[parseFloat(s.quantity).toFixed(2)," galones de ",i?.displayName||s.fuelType]})]}),e.jsx("div",{className:"summary-value",children:y(m)})]}),e.jsxs("div",{className:"summary-details",children:[e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"‚õΩ"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Combustible:"}),e.jsxs("span",{className:"detail-value",children:[i?.icon," ",i?.displayName||s.fuelType]})]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üìä"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Cantidad:"}),e.jsxs("span",{className:"detail-value",children:[parseFloat(s.quantity).toFixed(2)," gal √ó $",parseFloat(s.unitPrice).toLocaleString("es-CO")," COP"]})]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:s.type===o.ENTRADA?"üè™":"üìç"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:s.type===o.ENTRADA?"Proveedor:":"Origen:"}),e.jsx("span",{className:"detail-value",children:s.type===o.ENTRADA?x?`${x.name} - ${x.city}`:s.location:R(s.location)})]})]}),s.type===o.SALIDA&&u&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üöú"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Veh√≠culo:"}),e.jsxs("span",{className:"detail-value",children:[u.vehicleId," - ",u.name," (",u.type,")"]})]})]}),s.currentHours&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"‚è±Ô∏è"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Hor√≥metro:"}),e.jsxs("span",{className:"detail-value",children:[s.currentHours," horas"]})]})]}),s.type===o.TRANSFERENCIA&&s.destinationLocation&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üéØ"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Destino:"}),e.jsx("span",{className:"detail-value",children:R(s.destinationLocation)})]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üìÖ"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Fecha:"}),e.jsx("span",{className:"detail-value",children:new Date(s.effectiveDate).toLocaleString("es-CO")})]})]}),s.reference&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üìÑ"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Referencia:"}),e.jsx("span",{className:"detail-value",children:s.reference})]})]}),s.description&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üìù"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Descripci√≥n:"}),e.jsx("span",{className:"detail-value description",children:s.description})]})]})]})]}),s.type===o.TRANSFERENCIA&&e.jsxs("div",{className:"transfer-flow-summary",children:[e.jsx("div",{className:"flow-header",children:"üîÑ Flujo de Transferencia"}),e.jsxs("div",{className:"flow-diagram",children:[e.jsxs("div",{className:"flow-location origin",children:[e.jsx("div",{className:"flow-icon",children:"üìç"}),e.jsxs("div",{className:"flow-text",children:[e.jsx("strong",{children:R(s.location)}),e.jsx("small",{children:"Origen"})]})]}),e.jsxs("div",{className:"flow-arrow",children:[e.jsx("div",{className:"arrow-line"}),e.jsx("div",{className:"arrow-head",children:"‚Üí"}),e.jsxs("div",{className:"flow-quantity",children:[parseFloat(s.quantity).toFixed(1)," gal"]})]}),e.jsxs("div",{className:"flow-location destination",children:[e.jsx("div",{className:"flow-icon",children:"üéØ"}),e.jsxs("div",{className:"flow-text",children:[e.jsx("strong",{children:R(s.destinationLocation)}),e.jsx("small",{children:"Destino"})]})]})]})]}),e.jsxs("div",{className:"additional-comments-section",children:[e.jsxs("div",{className:"comments-header",children:[e.jsx("h4",{children:"üí¨ Comentarios Adicionales"}),e.jsx("small",{children:"Opcional - Agrega informaci√≥n adicional sobre este movimiento"})]}),e.jsx("textarea",{className:"comments-textarea",value:s.additionalComments||"",onChange:l,placeholder:"Ejemplo: Combustible entregado por transporte especial, requiere almacenamiento prioritario, etc.",rows:3,maxLength:500}),e.jsxs("div",{className:"comments-counter",children:[(s.additionalComments||"").length,"/500 caracteres"]})]}),e.jsxs("div",{className:"confirmation-section",children:[e.jsxs("div",{className:"confirmation-checkbox",children:[e.jsx("input",{type:"checkbox",id:"confirmMovement",checked:b,onChange:S=>t(S.target.checked)}),e.jsx("label",{htmlFor:"confirmMovement",children:"‚úÖ Confirmo que toda la informaci√≥n es correcta y autorizo crear este movimiento"})]}),e.jsx("div",{className:"confirmation-warning",children:"‚ö†Ô∏è Una vez creado, el movimiento actualizar√° autom√°ticamente el inventario"})]}),C&&e.jsxs("div",{className:"summary-error",children:[e.jsx("span",{className:"error-icon",children:"‚ö†Ô∏è"}),C]})]})})},he=({isOpen:s,onClose:h,onSuccess:E})=>{const{inventory:C,vehicles:N,suppliers:b}=_(),[t,n]=v.useState(1),[f,g]=v.useState(!1),[y,d]=v.useState(!1),[p,r]=v.useState(""),[k,m]=v.useState(!1),[a,i]=v.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""}),[u,x]=v.useState({vehicles:[],inventory:[],suppliers:[],products:[],loadingData:!0}),l=()=>{n(1),r(""),m(!1),i({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""})};v.useEffect(()=>((async()=>{if(s){document.body.style.overflow="hidden",l(),x(F=>({...F,loadingData:!0}));try{console.log("üîÑ Cargando productos y sincronizando datos en tiempo real...");const F=await se();x({vehicles:N||[],inventory:C||[],suppliers:b||[],products:F||[],loadingData:!1}),console.log("‚úÖ Datos sincronizados para wizard - inventario en tiempo real:",C?.length||0,"items")}catch(F){console.error("‚ùå Error al cargar datos del sistema:",F),r("No se pudieron cargar los datos necesarios. Int√©ntalo de nuevo."),x(P=>({...P,loadingData:!1}))}}else document.body.style.overflow="unset"})(),()=>{document.body.style.overflow="unset"}),[s,C,N,b]);const S=()=>{if(!a.type)return 8;let c;return a.type===o.TRANSFERENCIA?c=8:a.type===o.SALIDA||a.type===o.ENTRADA?c=7:c=6,console.log("üîç [TOTAL STEPS]",{type:a.type,totalSteps:c,currentStep:t}),c},A=(c,F)=>{i(P=>({...P,[c]:F})),r("")},j=v.useCallback(()=>{let c=!1;switch(t){case 1:c=!!a.type;break;case 2:c=!!a.fuelType,console.log("üîç [STEP 2 VALIDATION]",{fuelType:a.fuelType,isValid:c,formData:a});break;case 3:a.type===o.ENTRADA?c=!!a.supplierName:c=!!a.location;break;case"3b":c=!!a.destinationLocation;break;case 4:c=a.quantity&&parseFloat(a.quantity)>0,console.log("üîç [DEBUG Step 4] Validaci√≥n cantidad:",{step:t,quantity:a.quantity,parsedQuantity:parseFloat(a.quantity),isQuantityValid:!!a.quantity,isParsedValid:parseFloat(a.quantity)>0,finalValidation:c,formData:a});break;case 5:if(a.type===o.SALIDA){if(c=!!a.vehicleId,c&&a.vehicleId){const F=N.find(P=>P.vehicleId===a.vehicleId);F&&(F.fuelType==="diesel"||F.fuelType==="Diesel")&&(c=!!a.currentHours&&parseFloat(a.currentHours)>=0)}}else c=!0;break;case 6:a.type===o.TRANSFERENCIA?c=!!a.destinationLocation:c=!0;break;case 7:c=!!a.unitPrice&&parseFloat(a.unitPrice)>=0;break;case 8:c=!0;break;default:c=!1}return console.log("üîç [DEBUG General] validateCurrentStep:",{currentStep:t,isValid:c,formDataKeys:Object.keys(a),formData:a}),c},[t,a,N]),q=v.useMemo(()=>j(),[j]),I=()=>{g(!0);const c=j();if(console.log("üîç [DEBUG nextStep] Intentando navegar:",{currentStep:t,isValid:c,formData:a,type:a.type}),c){const F=S();let P=t+1;t===3&&a.type===o.ENTRADA?P="3b":t==="3b"?P=4:t===4&&a.type!==o.SALIDA?a.type===o.TRANSFERENCIA?P=6:(a.type,o.ENTRADA,P=7):t===5&&a.type!==o.TRANSFERENCIA&&(P=7),console.log("üîç [DEBUG Navigation] Navegando:",{from:t,to:P,totalSteps:F}),(O=>a.type===o.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[O]||O:a.type===o.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[O]||O:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[O]||O)(P)<=F&&n(P)}else console.log("‚ùå [DEBUG] Validaci√≥n fall√≥, no se puede navegar"),r("Por favor completa este paso antes de continuar");setTimeout(()=>g(!1),300)},M=()=>{if(g(!0),t>1&&t!=="3b"){let c=t-1;t===4&&a.type===o.ENTRADA?c="3b":(t===7&&a.type===o.ENTRADA||t===7&&a.type!==o.TRANSFERENCIA&&a.type!==o.SALIDA||t===6&&a.type!==o.SALIDA)&&(c=4),n(c)}else t==="3b"&&n(3);setTimeout(()=>g(!1),300)},T=async()=>{d(!0),r("");try{const c={...a};console.log("üîç [SUBMIT] Datos completos antes de crear movimiento:",c);const F={...c,quantity:parseFloat(c.quantity),unitPrice:parseFloat(c.unitPrice),effectiveDate:new Date(c.effectiveDate)};console.log("üîç [SUBMIT] MovementData enviado a createMovement:",F),await K(F),E(),l()}catch(c){console.error("Error al crear movimiento:",c),r(c.message||"Error al crear el movimiento")}finally{d(!1)}},w=()=>{const c={formData:a,updateFormData:A,systemData:u,error:p,setError:r,isActive:!f};return{1:e.jsx(le,{...c}),2:e.jsx(ce,{...c}),3:e.jsx(re,{...c}),"3b":e.jsx(Q,{...c,isEntryDestination:!0}),4:e.jsx(oe,{...c}),5:e.jsx(de,{...c}),6:e.jsx(Q,{...c}),7:e.jsx(ue,{...c}),8:e.jsx(me,{...c,onSubmit:T,isLoading:y,onCommentsChange:P=>A("additionalComments",P),confirmChecked:k,onConfirmChange:m})}[t]||e.jsx("div",{children:"Paso no encontrado"})};if(!s)return null;const $=S(),H=(c=>a.type===o.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[c]||c:a.type===o.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[c]||c:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[c]||c)(t),B=H/$*100,U=H>=$;return console.log("üîç [WIZARD DEBUG]",{type:a.type,currentStep:t,currentLogicalStep:H,totalSteps:$,progress:B,isLastStep:U,formDataKeys:Object.keys(a).filter(c=>a[c]),fuelType:a.fuelType}),e.jsx("div",{className:"modal-overlay wizard-overlay",onClick:h,children:e.jsxs("div",{className:`modal-content wizard-modal typeform-mode ${U?"is-last-step":""}`,onClick:c=>c.stopPropagation(),children:[e.jsx("div",{className:"typeform-progress",children:e.jsx("div",{className:"typeform-progress-fill",style:{width:`${B}%`}})}),e.jsx("div",{className:"wizard-header typeform-mode",children:e.jsxs("div",{className:"wizard-title",children:[e.jsx("h3",{children:"üßô‚Äç‚ôÇÔ∏è Asistente de Movimientos"}),e.jsx("button",{className:"modal-close",onClick:h,children:"‚úï"})]})}),e.jsx("div",{className:"wizard-body typeform-mode",children:u.loadingData?e.jsxs("div",{className:"wizard-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîÑ Cargando datos del sistema..."})]}):e.jsx("div",{className:"wizard-step-container",children:w()})}),p&&e.jsxs("div",{className:"wizard-error",children:[e.jsx("span",{className:"error-icon",children:"‚ö†Ô∏è"}),p]}),e.jsxs("div",{className:"typeform-navigation",children:[t>1&&e.jsx("button",{className:"typeform-nav-btn",onClick:M,disabled:f,"aria-label":"Paso anterior",children:"‚Üê"}),U?e.jsx("button",{className:"typeform-nav-btn",onClick:T,disabled:y||!k||f,"aria-label":"Confirmar movimiento",children:y?e.jsx("span",{className:"loading-spinner small"}):"‚úì"}):e.jsx("button",{className:"typeform-nav-btn",onClick:I,disabled:!q||f,"aria-label":"Siguiente paso",children:"‚Üí"})]})]})})},fe=()=>{const{user:s,userProfile:h,deleteMovement:E}=_(),[C,N]=v.useState([]),[b,t]=v.useState(null),[n,f]=v.useState(!0),[g,y]=v.useState(null),[d,p]=v.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[r,k]=v.useState(""),[m,a]=v.useState(!1);v.useEffect(()=>{if(!s)return;f(!0);const T=Y((w,$)=>{if($){console.error("Error en suscripci√≥n de movimientos:",$),y("Error al cargar movimientos"),f(!1);return}N(w),y(null),f(!1)},d);return()=>T()},[s,d]),v.useEffect(()=>{s&&(async()=>{try{const w=await Z(d);t(w)}catch(w){console.error("Error al cargar estad√≠sticas:",w)}})()},[s,C,d]);const i=C.filter(T=>{if(!r)return!0;const w=r.toLowerCase();return T.fuelType?.toLowerCase().includes(w)||T.type?.toLowerCase().includes(w)||T.location?.toLowerCase().includes(w)||T.vehicleId?.toLowerCase().includes(w)||T.description?.toLowerCase().includes(w)||T.reference?.toLowerCase().includes(w)}),u=()=>{a(!0)},x=T=>{alert(`üìã Detalles del movimiento:

Tipo: ${T.type}
Combustible: ${T.fuelType}
Cantidad: ${T.quantity} gal
Fecha: ${new Date(T.createdAt).toLocaleDateString("es-CO")}`)},l=()=>{a(!1)},S=T=>{p(w=>({...w,...T}))},A=()=>{p({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),k("")},j=async T=>{if(window.confirm("¬øEst√°s seguro de que quieres aprobar este movimiento? Esta acci√≥n actualizar√° el inventario."))try{await ee(T),alert("Movimiento aprobado y stock actualizado.")}catch(w){console.error("Error al aprobar movimiento:",w),alert(`Error al aprobar movimiento: ${w.message}`)}},q=async T=>{if(window.confirm("¬øEst√°s seguro de que quieres rechazar este movimiento?"))try{await X(T,{status:L.CANCELADO}),alert("Movimiento rechazado.")}catch(w){console.error("Error al rechazar movimiento:",w),alert(`Error al rechazar movimiento: ${w.message}`)}},I=async T=>{try{const w=await E(T);if(w.success)alert("Movimiento eliminado exitosamente.");else throw new Error(w.error)}catch(w){console.error("Error al eliminar movimiento:",w),alert(`Error al eliminar movimiento: ${w.message}`)}},M=h?.role==="admin"||h?.role==="contador"||h?.role==="cliente";return n?e.jsx("div",{className:"movements-main",children:e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Cargando movimientos..."})]})}):g?e.jsx("div",{className:"movements-main",children:e.jsxs("div",{className:"error-container",children:[e.jsx("div",{className:"error-icon",children:"‚ö†Ô∏è"}),e.jsx("h3",{children:"Error al cargar movimientos"}),e.jsx("p",{children:g}),e.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):e.jsxs("div",{className:"movements-main",children:[e.jsxs("div",{className:"movements-header",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("h2",{children:"üìä Movimientos de Combustibles"}),e.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),M&&e.jsx("div",{className:"create-movement-options",children:e.jsx("button",{className:"btn-create-movement primary",onClick:u,children:"‚ûï Nuevo Movimiento"})})]}),b&&e.jsx(ae,{stats:b,filters:d}),e.jsx(ie,{filters:d,onFilterChange:S,onClearFilters:A,searchTerm:r,onSearchChange:k,totalResults:i.length}),i.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"üìã"}),e.jsx("h3",{children:C.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),e.jsx("p",{children:C.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de b√∫squeda"}),C.length===0&&M&&e.jsx("div",{className:"create-first-options",children:e.jsx("button",{className:"btn-create-first primary",onClick:u,children:"‚ûï Crear Primer Movimiento"})})]}):e.jsx(ne,{movements:i,onEdit:null,onView:x,onApprove:j,onReject:q,onDelete:I,userRole:h?.role}),m&&e.jsx(he,{isOpen:m,onClose:l,onSuccess:()=>{l()}})]})};export{fe as default};
