import{j as e,f as V,a as B,l as r,M as I,r as x,O as z,z as R,A as D,B as J,u as _,C as K,D as Y,E as Z,G as X,H as ee}from"./index-BDG-TU4r.js";import{g as se}from"./productsService-CslLOo4K.js";const ae=({stats:s,filters:m})=>{if(!s)return null;const E=(t,l)=>l===0?t>0?100:0:((t-l)/l*100).toFixed(1),S=t=>{switch(t){case r.ENTRADA:return"#10b981";case r.SALIDA:return"#ef4444";case r.TRANSFERENCIA:return"#3b82f6";case r.AJUSTE:return"#f59e0b";default:return"#6b7280"}},p=t=>{switch(t){case r.ENTRADA:return"üì•";case r.SALIDA:return"üì§";case r.TRANSFERENCIA:return"üîÑ";case r.AJUSTE:return"‚öñÔ∏è";default:return"üìã"}},C=E(s.thisMonth,s.lastMonth);return e.jsxs("div",{className:"movements-stats",children:[e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card primary",children:[e.jsx("div",{className:"stat-icon",children:"üìä"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:V(s.totalMovements)}),e.jsx("div",{className:"stat-label",children:"Total Movimientos"}),e.jsxs("div",{className:"stat-trend",children:[e.jsxs("span",{className:`trend ${C>=0?"positive":"negative"}`,children:[C>=0?"üìà":"üìâ"," ",Math.abs(C),"%"]}),e.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"üí∞"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:B(s.totalValue)}),e.jsx("div",{className:"stat-label",children:"Valor Total"}),e.jsxs("div",{className:"stat-secondary",children:["Promedio: ",B(s.averageValue)]})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"‚õΩ"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:V(s.totalQuantity)}),e.jsx("div",{className:"stat-label",children:"Galones Total"}),e.jsxs("div",{className:"stat-secondary",children:["Promedio: ",V(s.totalQuantity/(s.totalMovements||1))," gal/mov"]})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"üìÖ"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:V(s.thisWeek)}),e.jsx("div",{className:"stat-label",children:"Esta Semana"}),e.jsxs("div",{className:"stat-secondary",children:[V(s.thisMonth)," este mes"]})]})]})]}),e.jsxs("div",{className:"stats-breakdown",children:[e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"üìã Por Tipo de Movimiento"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byType).map(([t,l])=>{const N=(l/s.totalMovements*100).toFixed(1);return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:p(t)}),e.jsx("span",{className:"breakdown-label",children:t.charAt(0).toUpperCase()+t.slice(1)})]}),e.jsx("div",{className:"breakdown-value",children:l}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${N}%`,backgroundColor:S(t)}})}),e.jsxs("div",{className:"breakdown-percentage",children:[N,"%"]})]},t)})})]}),e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"‚ö° Por Estado"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byStatus).map(([t,l])=>{const N=(l/s.totalMovements*100).toFixed(1),j=u=>{switch(u){case I.COMPLETADO:return"#10b981";case I.PENDIENTE:return"#f59e0b";case I.CANCELADO:return"#ef4444";default:return"#6b7280"}},y=u=>{switch(u){case I.COMPLETADO:return"‚úÖ";case I.PENDIENTE:return"‚è≥";case I.CANCELADO:return"‚ùå";default:return"‚ùì"}};return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:y(t)}),e.jsx("span",{className:"breakdown-label",children:t.charAt(0).toUpperCase()+t.slice(1)})]}),e.jsx("div",{className:"breakdown-value",children:l}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${N}%`,backgroundColor:j(t)}})}),e.jsxs("div",{className:"breakdown-percentage",children:[N,"%"]})]},t)})})]}),e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"‚õΩ Por Tipo de Combustible"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byFuelType).map(([t,l])=>{const N=(l/s.totalMovements*100).toFixed(1),j=y=>{switch(y?.toLowerCase()){case"diesel":return"üöõ";case"gasolina":return"üöó";case"acpm":return"üöö";case"lubricante":return"üõ¢Ô∏è";default:return"‚õΩ"}};return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:j(t)}),e.jsx("span",{className:"breakdown-label",children:t})]}),e.jsx("div",{className:"breakdown-value",children:l}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${N}%`,backgroundColor:"#059669"}})}),e.jsxs("div",{className:"breakdown-percentage",children:[N,"%"]})]},t)})})]})]}),(m.type||m.status||m.fuelType||m.vehicleId)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("h4",{children:"üîç Filtros Activos"}),e.jsxs("div",{className:"filters-list",children:[m.type&&e.jsxs("span",{className:"filter-tag",children:["Tipo: ",m.type]}),m.status&&e.jsxs("span",{className:"filter-tag",children:["Estado: ",m.status]}),m.fuelType&&e.jsxs("span",{className:"filter-tag",children:["Combustible: ",m.fuelType]}),m.vehicleId&&e.jsxs("span",{className:"filter-tag",children:["Veh√≠culo: ",m.vehicleId]})]})]})]})},ie=({filters:s,onFilterChange:m,onClearFilters:E,searchTerm:S,onSearchChange:p,totalResults:C})=>{const[t,l]=x.useState(!1),N=[{value:"Diesel",label:"Diesel üöõ"},{value:"Gasolina",label:"Gasolina üöó"},{value:"ACPM",label:"ACPM üöö"},{value:"Lubricante",label:"Lubricante üõ¢Ô∏è"}],j=[{value:"all",label:"Todos los per√≠odos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este a√±o"}],y=Object.values(s).filter(c=>c&&c!==""&&c!=="all").length,u=(c,w)=>{m({[c]:w})},v=c=>{m(c)};return e.jsxs("div",{className:"movements-filters",children:[e.jsxs("div",{className:"filters-main",children:[e.jsx("div",{className:"search-section",children:e.jsxs("div",{className:"search-box",children:[e.jsx("span",{className:"search-icon",children:"üîç"}),e.jsx("input",{type:"text",placeholder:"Buscar por combustible, veh√≠culo, referencia...",value:S,onChange:c=>p(c.target.value),className:"search-input"}),S&&e.jsx("button",{className:"search-clear",onClick:()=>p(""),title:"Limpiar b√∫squeda",children:"‚úï"})]})}),e.jsxs("div",{className:"filters-controls",children:[e.jsxs("div",{className:"quick-filters",children:[e.jsx("button",{className:`quick-filter ${s.type===r.ENTRADA?"active":""}`,onClick:()=>v({type:r.ENTRADA}),children:"üì• Entradas"}),e.jsx("button",{className:`quick-filter ${s.type===r.SALIDA?"active":""}`,onClick:()=>v({type:r.SALIDA}),children:"üì§ Salidas"}),e.jsx("button",{className:`quick-filter ${s.status===I.PENDIENTE?"active":""}`,onClick:()=>v({status:I.PENDIENTE}),children:"‚è≥ Pendientes"})]}),e.jsxs("button",{className:`btn-advanced-filters ${t?"active":""}`,onClick:()=>l(!t),children:["üéõÔ∏è Filtros",y>0&&e.jsx("span",{className:"filters-count",children:y})]}),e.jsx("div",{className:"view-indicator",children:e.jsx("span",{className:"view-info",children:"üìã Vista Tabla"})})]})]}),t&&e.jsxs("div",{className:"filters-advanced",children:[e.jsxs("div",{className:"filters-grid",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Tipo de Movimiento"}),e.jsxs("select",{value:s.type,onChange:c=>u("type",c.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los tipos"}),e.jsx("option",{value:r.ENTRADA,children:"üì• Entrada"}),e.jsx("option",{value:r.SALIDA,children:"üì§ Salida"}),e.jsx("option",{value:r.TRANSFERENCIA,children:"üîÑ Transferencia"}),e.jsx("option",{value:r.AJUSTE,children:"‚öñÔ∏è Ajuste"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Estado"}),e.jsxs("select",{value:s.status,onChange:c=>u("status",c.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los estados"}),e.jsx("option",{value:I.PENDIENTE,children:"‚è≥ Pendiente"}),e.jsx("option",{value:I.COMPLETADO,children:"‚úÖ Completado"}),e.jsx("option",{value:I.CANCELADO,children:"‚ùå Cancelado"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Tipo de Combustible"}),e.jsxs("select",{value:s.fuelType,onChange:c=>u("fuelType",c.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los combustibles"}),N.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Per√≠odo"}),e.jsx("select",{value:s.dateRange,onChange:c=>u("dateRange",c.target.value),className:"filter-select",children:j.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Veh√≠culo/Equipo"}),e.jsx("input",{type:"text",placeholder:"ID del veh√≠culo...",value:s.vehicleId,onChange:c=>u("vehicleId",c.target.value),className:"filter-input"})]})]}),e.jsxs("div",{className:"filters-actions",children:[e.jsx("button",{className:"btn-clear-filters",onClick:E,disabled:y===0,children:"üóëÔ∏è Limpiar Filtros"}),e.jsxs("div",{className:"filters-info",children:[e.jsxs("span",{className:"results-count",children:[C," resultado",C!==1?"s":""]}),y>0&&e.jsxs("span",{className:"active-filters-text",children:["(",y," filtro",y!==1?"s":""," activo",y!==1?"s":"",")"]})]})]})]}),e.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:e.jsx("small",{children:"üí° Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},te=({movements:s,onEdit:m,onView:E,onApprove:S,onReject:p,onDelete:C,userRole:t})=>{const[l,N]=x.useState("createdAt"),[j,y]=x.useState("desc"),u=n=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),v=n=>n?(n instanceof Date?n:new Date(n)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",c=n=>{switch(n){case r.ENTRADA:return"üì•";case r.SALIDA:return"üì§";case r.TRANSFERENCIA:return"üîÑ";case r.AJUSTE:return"‚öñÔ∏è";default:return"üìã"}},w=n=>{switch(n?.toLowerCase()){case"diesel":return"üöõ";case"gasolina":return"üöó";case"acpm":return"üöö";case"lubricante":return"üõ¢Ô∏è";default:return"‚õΩ"}},b=n=>{switch(n){case I.COMPLETADO:return"‚úÖ";case I.PENDIENTE:return"‚è≥";case I.CANCELADO:return"‚ùå";default:return"‚ùì"}},a=n=>{switch(n){case I.COMPLETADO:return"status-completado";case I.PENDIENTE:return"status-pendiente";case I.CANCELADO:return"status-cancelado";default:return"status-default"}},i=n=>{l===n?y(j==="asc"?"desc":"asc"):(N(n),y("asc"))},d=[...s].sort((n,k)=>{let A=n[l],f=k[l];return(l.includes("Date")||l.includes("At"))&&(A=new Date(A),f=new Date(f)),typeof A=="number"&&typeof f=="number"?j==="asc"?A-f:f-A:typeof A=="string"&&typeof f=="string"?j==="asc"?A.localeCompare(f):f.localeCompare(A):A instanceof Date&&f instanceof Date?j==="asc"?A-f:f-A:0}),h=n=>l!==n?"‚ÜïÔ∏è":j==="asc"?"‚Üë":"‚Üì";return e.jsxs("div",{className:"movements-table-container",children:[e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"movements-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"sortable",onClick:()=>i("type"),children:["Tipo ",h("type")]}),e.jsxs("th",{className:"sortable",onClick:()=>i("fuelType"),children:["Combustible ",h("fuelType")]}),e.jsxs("th",{className:"sortable text-right",onClick:()=>i("quantity"),children:["Cantidad ",h("quantity")]}),e.jsxs("th",{className:"sortable text-right",onClick:()=>i("unitPrice"),children:["Precio/Gal ",h("unitPrice")]}),e.jsxs("th",{className:"sortable text-right",onClick:()=>i("totalValue"),children:["Valor Total ",h("totalValue")]}),e.jsx("th",{children:"Veh√≠culo"}),e.jsx("th",{children:"Ubicaci√≥n"}),e.jsxs("th",{className:"sortable",onClick:()=>i("status"),children:["Estado ",h("status")]}),e.jsxs("th",{className:"sortable",onClick:()=>i("createdAt"),children:["Fecha ",h("createdAt")]}),e.jsx("th",{className:"actions-column",children:"Acciones"})]})}),e.jsx("tbody",{children:d.map(n=>e.jsxs("tr",{className:`movement-row ${n.status===I.PENDIENTE?"pending-row":""}`,children:[e.jsx("td",{className:"type-cell",children:e.jsxs("div",{className:"type-content",children:[e.jsx("span",{className:"type-icon",children:c(n.type)}),e.jsx("span",{className:"type-text",children:n.type?n.type.charAt(0).toUpperCase()+n.type.slice(1):"Sin tipo"})]})}),e.jsx("td",{className:"fuel-cell",children:e.jsxs("div",{className:"fuel-content",children:[e.jsx("span",{className:"fuel-icon",children:w(n.fuelType)}),e.jsx("span",{className:"fuel-text",children:n.fuelType})]})}),e.jsxs("td",{className:"quantity-cell text-right",children:[e.jsx("span",{className:"quantity-value",children:n.quantity}),e.jsx("span",{className:"quantity-unit",children:"gal"})]}),e.jsx("td",{className:"price-cell text-right",children:u(n.unitPrice)}),e.jsx("td",{className:"value-cell text-right",children:e.jsx("strong",{children:u(n.totalValue)})}),e.jsx("td",{className:"vehicle-cell",children:n.vehicleId?e.jsxs("span",{className:"vehicle-id",children:["üöú ",n.vehicleId]}):e.jsx("span",{className:"no-vehicle",children:"-"})}),e.jsx("td",{className:"location-cell",children:e.jsxs("span",{className:"location-text",children:["üìç ",n.type===r.ENTRADA?n.destinationLocation||"Sin ubicaci√≥n":n.location||"Principal"]})}),e.jsx("td",{className:"status-cell",children:e.jsxs("div",{className:`status-badge ${a(n.status)}`,children:[e.jsx("span",{className:"status-icon",children:b(n.status)}),e.jsx("span",{className:"status-text",children:n.status?n.status.charAt(0).toUpperCase()+n.status.slice(1):"Sin estado"})]})}),e.jsx("td",{className:"date-cell",children:e.jsxs("div",{className:"date-content",children:[e.jsx("span",{className:"date-value",children:v(n.createdAt)}),n.reference&&e.jsxs("span",{className:"reference-small",children:["#",n.reference]})]})}),e.jsx("td",{className:"actions-cell",children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn-action btn-view",onClick:()=>E(n),title:"Ver detalles",children:"üëÅÔ∏è"}),t==="admin"&&n.status===I.PENDIENTE&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-action btn-approve",onClick:()=>S(n.id),title:"Aprobar movimiento",children:"‚úì"}),e.jsx("button",{className:"btn-action btn-reject",onClick:()=>p(n.id),title:"Rechazar movimiento",children:"‚úó"})]}),m&&n.status===I.PENDIENTE&&e.jsx("button",{className:"btn-action btn-edit",onClick:()=>m(n),title:"Editar movimiento",children:"‚úèÔ∏è"}),t==="admin"&&e.jsx("button",{className:"btn-action btn-delete",onClick:()=>{window.confirm("¬øEst√°s seguro de que deseas eliminar este movimiento? Esta acci√≥n no se puede deshacer.")&&C(n.id)},title:"Eliminar movimiento",children:"üóëÔ∏è"})]})})]},n.id))})]})}),e.jsxs("div",{className:"table-info",children:[e.jsxs("div",{className:"table-summary",children:[e.jsxs("span",{className:"total-rows",children:[s.length," movimiento",s.length!==1?"s":""]}),l&&e.jsxs("span",{className:"sort-info",children:["Ordenado por ",l," (",j==="asc"?"ascendente":"descendente",")"]})]}),e.jsxs("div",{className:"table-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"‚è≥"})," Pendiente"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"‚úÖ"})," Completado"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"‚ùå"})," Cancelado"]})]})]})]})},ne=({movements:s,onEdit:m,onView:E,onApprove:S,onReject:p,onDelete:C,userRole:t})=>e.jsx(te,{movements:s,onEdit:m,onView:E,onApprove:S,onReject:p,onDelete:C,userRole:t}),le=({formData:s,updateFormData:m,setError:E,isActive:S})=>{const p=[{type:r.ENTRADA,icon:"üì•",title:"Entrada de Combustible",description:"Registrar combustible que llega de proveedores",color:"entrada",details:"Para compras, reabastecimientos y recepciones"},{type:r.SALIDA,icon:"‚õΩ",title:"Salida de Combustible",description:"Asignar combustible a veh√≠culos y equipos",color:"salida",details:"Para consumo y operaciones de campo"},{type:r.TRANSFERENCIA,icon:"üîÑ",title:"Transferencia",description:"Mover combustible entre ubicaciones",color:"transferencia",details:"Entre tanques, sitios o almacenes"},{type:r.AJUSTE,icon:"‚öñÔ∏è",title:"Ajuste de Inventario",description:"Corregir stock por diferencias o calibraciones",color:"ajuste",details:"Para mermas, p√©rdidas o correcciones"}],C=t=>{m("type",t),E("")};return x.useEffect(()=>{if(!S)return;const t=l=>{const N=parseInt(l.key);if(N>=1&&N<=4){const j=p[N-1];C(j.type)}};return window.addEventListener("keypress",t),()=>window.removeEventListener("keypress",t)},[S]),e.jsx("div",{className:`wizard-step step-movement-type ${S?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h2",{children:"üåø ¬°Hola! ¬øQu√© operaci√≥n necesitas registrar hoy?"}),e.jsx("p",{children:"Selecciona el tipo de movimiento que vas a realizar"})]}),e.jsx("div",{className:"typeform-options",children:p.map((t,l)=>e.jsxs("div",{className:`typeform-option ${s.type===t.type?"selected":""} ${t.color}`,onClick:()=>C(t.type),children:[e.jsx("div",{className:"typeform-option-icon",children:t.icon}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:t.title}),e.jsx("p",{children:t.description})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},t.type))}),s.type&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card",children:[e.jsx("span",{className:"confirmation-icon",children:p.find(t=>t.type===s.type)?.icon}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:"Perfecto! Has seleccionado:"})," ",p.find(t=>t.type===s.type)?.title,e.jsx("br",{}),e.jsx("small",{children:p.find(t=>t.type===s.type)?.details})]})]})})]})})},ce=({formData:s,updateFormData:m,systemData:E,setError:S,isActive:p})=>{const[C,t]=x.useState(!1),[l,N]=x.useState(null),{products:j}=E;x.useEffect(()=>{if(s.fuelType&&j.length>0){const u=j.find(v=>v.name===s.fuelType||v.displayName===s.fuelType);N(u),u&&u.defaultPrice&&!s.unitPrice&&m("unitPrice",u.defaultPrice.toString())}},[s.fuelType,s.unitPrice,j,m]),x.useEffect(()=>{if(!p)return;const u=v=>{const c=parseInt(v.key);if(c>=1&&c<=j.length){const w=j[c-1];y(w.name,w)}};return window.addEventListener("keypress",u),()=>window.removeEventListener("keypress",u)},[p,j]);const y=async(u,v)=>{t(!0),S("");try{await new Promise(c=>setTimeout(c,800)),m("fuelType",u),N(v),v.defaultPrice&&m("unitPrice",v.defaultPrice.toString()),console.log("üîÑ [Step2] Combustible seleccionado:",u,"Precio:",v.defaultPrice)}catch(c){console.error("Error al cargar combustible:",c),S("Error al cargar informaci√≥n del combustible")}finally{t(!1)}};return j.length===0?e.jsx("div",{className:`wizard-step step-fuel-type ${p?"active":""}`,children:e.jsx("div",{className:"typeform-layout",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîÑ Cargando productos disponibles..."})]})})}):e.jsx("div",{className:`wizard-step step-fuel-type ${p?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h2",{children:"‚õΩ ¬øQu√© tipo de combustible necesitas?"}),e.jsx("p",{children:"Elige el producto que vas a mover"})]}),C&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üì° Actualizando precios..."})]}),e.jsx("div",{className:"typeform-options",children:j.map((u,v)=>e.jsxs("div",{className:`typeform-option ${s.fuelType===u.name?"selected":""} ${C?"disabled":""}`,onClick:()=>!C&&y(u.name,u),children:[e.jsx("div",{className:"typeform-option-icon",children:u.icon||"üõ¢Ô∏è"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:u.displayName||u.name}),e.jsx("p",{children:u.description||"Combustible premium"}),u.defaultPrice&&e.jsx("div",{className:"fuel-price",children:e.jsxs("span",{className:"price-value",children:["$",u.defaultPrice.toLocaleString("es-CO")," COP/gal√≥n"]})})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},u.id))}),l&&s.fuelType&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card fuel-confirmation",children:[e.jsxs("div",{className:"confirmation-header",children:[e.jsx("span",{className:"confirmation-icon",children:l.icon||"üõ¢Ô∏è"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsxs("strong",{children:["Excelente! Has elegido ",l.displayName||l.name]}),e.jsx("br",{}),e.jsx("small",{children:l.description||"Combustible de calidad premium"})]})]}),l.defaultPrice&&e.jsxs("div",{className:"price-confirmation",children:[e.jsxs("div",{className:"price-info",children:[e.jsx("span",{className:"price-label",children:"üí∞ Precio actual:"}),e.jsxs("span",{className:"price-amount",children:["$",l.defaultPrice.toLocaleString("es-CO")," COP/gal√≥n"]})]}),e.jsx("small",{className:"price-note",children:"‚ú® Aplicamos el precio autom√°ticamente (lo puedes ajustar despu√©s)"})]})]})})]})})},re=({formData:s,updateFormData:m,systemData:E,setError:S,isActive:p})=>{const[C,t]=x.useState(!1),[l,N]=x.useState({}),[j,y]=x.useState(!1),{suppliers:u,inventory:v}=E,c=s.type===r.ENTRADA;x.useEffect(()=>{(async()=>{if(!c&&s.fuelType&&v.length>0){y(!0),await new Promise(i=>setTimeout(i,600));const a={};console.log("üîç DEBUG Step3 - Datos para validaci√≥n:",{fuelType:s.fuelType,inventoryTotal:v.length,inventarioMuestra:v.slice(0,2),operationalLocations:z}),z.forEach(i=>{const d=v.filter(f=>f.fuelType===s.fuelType&&f.location?.toLowerCase()===i.toLowerCase()&&f.status==="active");console.log(`üîç DEBUG ${i}:`,{itemsEncontrados:d.length,detalles:d.map(f=>({id:f.id,fuelType:f.fuelType,location:f.location,status:f.status,currentStock:f.currentStock,maxCapacity:f.maxCapacity}))});const h=d.reduce((f,q)=>f+(parseFloat(q.currentStock)||0),0),n=v.filter(f=>f.fuelType===s.fuelType&&f.location?.toLowerCase()===i.toLowerCase()&&f.status==="active").reduce((f,q)=>f+(parseFloat(q.maxCapacity)||0),0);let k="available",A=`${h.toFixed(1)} gal disponibles`;h===0?(k="empty",A="Sin stock disponible"):h<n*.2&&(k="low",A=`${h.toFixed(1)} gal (stock bajo)`),a[i]={available:h,maxCapacity:n,status:k,message:A,percentage:n>0?h/n*100:0}}),N(a),y(!1),console.log("üîç Stock validado por ubicaci√≥n:",a)}})()},[s.fuelType,c,v]);const w=async b=>{t(!0),S("");try{await new Promise(a=>setTimeout(a,400)),m(c?"supplierName":"location",b),console.log("üìç Ubicaci√≥n seleccionada:",b)}catch(a){console.error("Error al validar ubicaci√≥n:",a),S("Error al validar la ubicaci√≥n")}finally{t(!1)}};if(c){const b=u.filter(a=>a.status==="active");return e.jsx("div",{className:`wizard-step step-location ${p?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"üè™ ¬øDe qu√© proveedor viene el combustible?"}),e.jsx("p",{children:"Selecciona el proveedor de origen:"})]}),C&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîÑ Validando proveedor..."})]}),e.jsx("div",{className:"typeform-options",children:b.map(a=>e.jsxs("div",{className:`typeform-option ${s.supplierName===a.name?"selected":""} ${C?"disabled":""}`,onClick:()=>!C&&w(a.name),children:[e.jsx("div",{className:"typeform-option-icon",children:"üè™"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:a.name}),e.jsx("p",{children:a.city})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},a.id))}),s.supplierName&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card",children:[e.jsx("span",{className:"confirmation-icon",children:"üè™"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:"Proveedor:"})," ",s.supplierName,e.jsx("br",{}),e.jsx("small",{children:"Origen del combustible confirmado"})]})]})})]})})}return e.jsx("div",{className:`wizard-step step-location ${p?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"üìç ¬øDe qu√© ubicaci√≥n sale el combustible?"}),e.jsx("p",{children:"Selecciona la ubicaci√≥n de origen:"})]}),j&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîç Verificando stock disponible..."})]}),e.jsx("div",{className:"typeform-options",children:z.map(b=>{const a=l[b],i=!a||a.status!=="empty";return e.jsxs("div",{className:`typeform-option ${s.location===b?"selected":""} 
                           ${a?.status||"unknown"} ${!i||C?"disabled":""}`,onClick:()=>i&&!C&&w(b),children:[e.jsx("div",{className:"typeform-option-icon",children:"üìç"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:R(b)}),a&&e.jsxs("div",{className:"stock-info",children:[e.jsx("p",{className:"stock-message",children:a.message}),a.available>0&&e.jsx("div",{className:"stock-bar-mini",children:e.jsx("div",{className:"stock-fill-mini",style:{width:`${Math.min(100,a.percentage)}%`}})})]})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},b)})}),s.location&&l[s.location]&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card location-confirmation",children:[e.jsxs("div",{className:"confirmation-header",children:[e.jsx("span",{className:"confirmation-icon",children:"üìç"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:R(s.location)}),e.jsx("br",{}),e.jsx("small",{children:"Ubicaci√≥n de origen confirmada"})]})]}),e.jsxs("div",{className:"stock-confirmation",children:[e.jsxs("div",{className:"stock-detail",children:[e.jsx("span",{className:"stock-label",children:"üìä Stock disponible:"}),e.jsxs("span",{className:"stock-value",children:[l[s.location].available.toFixed(1)," gal"]})]}),e.jsx("div",{className:"capacity-bar",children:e.jsx("div",{className:"capacity-fill",style:{width:`${l[s.location].percentage}%`}})}),e.jsxs("small",{className:"capacity-text",children:[l[s.location].percentage.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},oe=({formData:s,updateFormData:m,systemData:E,setError:S,isActive:p})=>{const[C,t]=x.useState(!1),[l,N]=x.useState(null),[j,y]=x.useState(""),u=x.useRef(null),{inventory:v}=E,c=s.type===r.SALIDA||s.type===r.TRANSFERENCIA;x.useEffect(()=>{p&&u.current&&setTimeout(()=>u.current.focus(),300)},[p]),x.useEffect(()=>{if(!p)return;const d=h=>{h.key==="Enter"&&s.quantity&&parseFloat(s.quantity)>0};return window.addEventListener("keypress",d),()=>window.removeEventListener("keypress",d)},[p,s.quantity]),x.useEffect(()=>{(async()=>{if(c&&s.fuelType&&s.location&&v.length>0){t(!0),await new Promise(F=>setTimeout(F,500));const h=v.filter(F=>F.fuelType===s.fuelType&&F.location?.toLowerCase()===s.location?.toLowerCase()&&F.status==="active").reduce((F,g)=>F+(parseFloat(g.currentStock)||0),0),n=parseFloat(s.quantity)||0,k=h-n;let A="available",f="‚úÖ",q="Stock Disponible",M="Perfecto, hay suficiente combustible.";if(n>0&&(h<n?(A="critical",f="üö´",q="Cantidad No Disponible",M=`Solo hay ${h.toFixed(2)} galones disponibles`):k<h*.2?(A="warning",f="‚ö†Ô∏è",q="Stock Quedar√° Bajo",M=`Quedar√°n solo ${k.toFixed(2)} galones`):M=`Quedar√°n ${k.toFixed(2)} galones en stock`),N({available:h,required:n,remaining:Math.max(0,k),status:A,icon:f,title:q,message:M,isValid:h>=n}),n>0&&c){const F={type:s.type===r.SALIDA?"outbound":"transfer",fuelType:s.fuelType,quantity:s.quantity,sourceLocation:s.location},g=D(F,v);g.isValid?g.warning?y(`‚ö†Ô∏è ${g.warning}`):y(""):y(`üö´ ${g.error}`)}else c||y("");t(!1)}})()},[s.quantity,s.fuelType,s.location,s.type,c,v]);const w=d=>{const h=parseFloat(d);(d===""||!isNaN(h)&&h>=0)&&(m("quantity",d),S(""))},b=()=>{if(!l||!l.available)return[];const d=l.available;return[{label:"25 gal",value:"25"},{label:"50 gal",value:"50"},{label:"100 gal",value:"100"},{label:`${d.toFixed(0)} gal`,value:d.toFixed(1)}]},a=()=>{switch(s.type){case r.ENTRADA:return"üì•";case r.SALIDA:return"‚õΩ";case r.TRANSFERENCIA:return"üîÑ";case r.AJUSTE:return"‚öñÔ∏è";default:return"üìä"}},i=()=>{switch(s.type){case r.ENTRADA:return"¬øCu√°ntos galones est√°s recibiendo?";case r.SALIDA:return"¬øCu√°ntos galones necesitas entregar?";case r.TRANSFERENCIA:return"¬øCu√°ntos galones vas a transferir?";case r.AJUSTE:return"¬øCu√°l es la cantidad del ajuste?";default:return"¬øCu√°ntos galones necesitas?"}};return e.jsx("div",{className:`wizard-step step-quantity ${p?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsxs("h2",{children:[a()," ",i()]}),e.jsx("p",{children:"Ingresa la cantidad en galones"})]}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("input",{ref:u,id:"quantity",type:"number",step:"0.1",min:"0",value:s.quantity,onChange:d=>w(d.target.value),placeholder:"0",className:`typeform-input ${j?"error":""}`,autoComplete:"off"}),e.jsx("span",{className:"typeform-unit",children:"galones"})]}),l&&l.available>0&&e.jsxs("div",{className:"typeform-suggestions",children:[e.jsx("label",{className:"typeform-suggestions-label",children:"Cantidades comunes:"}),e.jsx("div",{className:"typeform-suggestions-buttons",children:b().map((d,h)=>e.jsx("button",{type:"button",className:"typeform-suggestion-btn",onClick:()=>w(d.value),children:d.label},h))})]}),C&&e.jsxs("div",{className:"calculating-indicator",children:[e.jsx("div",{className:"loading-spinner small"}),e.jsx("span",{children:"‚öôÔ∏è Verificando disponibilidad..."})]}),l&&c&&!C&&e.jsxs("div",{className:`stock-info-container ${l.status}`,children:[e.jsxs("div",{className:"stock-info-header",children:[e.jsx("div",{className:"stock-info-icon",children:l.icon}),e.jsx("h4",{className:"stock-info-title",children:l.title})]}),e.jsx("div",{className:"stock-info-message",children:l.message})]}),j&&e.jsx("div",{className:"validation-warning",children:j}),s.quantity&&parseFloat(s.quantity)>0&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card",children:[e.jsx("span",{className:"confirmation-icon",children:a()}),e.jsxs("div",{className:"confirmation-text",children:[e.jsxs("strong",{children:["Perfecto! ",parseFloat(s.quantity).toLocaleString("es-CO")," galones"]}),e.jsx("br",{}),e.jsx("small",{children:c?`Saldr√°n del inventario de ${s.location}`:"Se agregar√°n al inventario"})]})]})})]})})},de=({formData:s,updateFormData:m,systemData:E,setError:S,isActive:p})=>{const[C,t]=x.useState(!1),[l,N]=x.useState(null),[j,y]=x.useState(!1),[u,v]=x.useState(""),{vehicles:c}=E;x.useEffect(()=>{if(s.vehicleId&&c.length>0){const i=c.find(h=>h.vehicleId===s.vehicleId);N(i);const d=w(i);y(d)}},[s.vehicleId,c]);const w=i=>{if(!i)return!1;const d=i.fuelType==="diesel"||i.fuelType==="Diesel",h=i.vehicleId?.toUpperCase(),n=h&&(h.includes("TR1")||h.includes("TR2")||h.includes("TR3")||h==="TR1"||h==="TR2"||h==="TR3"),k=i.category==="tractor"||i.type?.toLowerCase().includes("tractor");return d||n||k},b=async i=>{t(!0),S("");try{await new Promise(h=>setTimeout(h,600)),m("vehicleId",i.vehicleId),N(i);const d=w(i);y(d),!d&&s.currentHours&&m("currentHours",""),console.log("‚õΩ [Step5] Veh√≠culo seleccionado:",i.vehicleId,"Requiere hor√≥metro:",d,"Tipo combustible:",i.fuelType),console.log("üîç [Step5] FormData despu√©s de selecci√≥n:",{vehicleId:i.vehicleId,type:s.type,fuelType:s.fuelType,location:s.location})}catch(d){console.error("Error al validar veh√≠culo:",d),S("Error al validar el veh√≠culo")}finally{t(!1)}},a=i=>{const d=parseFloat(i);(i===""||!isNaN(d)&&d>=0)&&(m("currentHours",i),l?.currentHours&&d<parseFloat(l.currentHours)?v(`La lectura debe ser mayor a la anterior: ${l.currentHours} hrs`):v(""))};return s.type!==r.SALIDA?null:c.length===0?e.jsx("div",{className:`wizard-step step-vehicle ${p?"active":""}`,children:e.jsx("div",{className:"typeform-layout",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîÑ Cargando veh√≠culos disponibles..."})]})})}):e.jsx("div",{className:`wizard-step step-vehicle ${p?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"üöú ¬øA qu√© veh√≠culo/equipo va el combustible?"}),e.jsx("p",{children:"Selecciona el veh√≠culo que recibir√° el combustible:"})]}),C&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîÑ Validando veh√≠culo..."})]}),e.jsx("div",{className:"typeform-options",children:c.map(i=>{const d=w(i);return e.jsxs("div",{className:`typeform-option ${s.vehicleId===i.vehicleId?"selected":""} 
                           ${d?"diesel-vehicle":""} ${C?"disabled":""}`,onClick:()=>!C&&b(i),children:[e.jsx("div",{className:"typeform-option-icon",children:d?"‚õΩ":"üöö"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsxs("h4",{children:[i.vehicleId," - ",i.name]}),e.jsx("p",{children:i.type}),i.currentHours&&d&&e.jsxs("small",{className:"vehicle-hours",children:["‚è±Ô∏è Hor√≥metro: ",i.currentHours," hrs"]}),d&&e.jsx("small",{className:"diesel-indicator",children:"‚õΩ Veh√≠culo diesel - Requiere hor√≥metro"})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},i.id)})}),j&&l&&e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"currentHours",children:"Hor√≥metro actual (horas trabajadas) *"}),e.jsx("input",{id:"currentHours",type:"number",step:"0.1",min:"0",value:s.currentHours,onChange:i=>a(i.target.value),placeholder:"0.0",className:`typeform-input ${u?"error":""}`}),e.jsx("span",{className:"typeform-unit",children:"horas"}),l.currentHours&&e.jsxs("small",{className:"hour-meter-hint",children:["üí° √öltima lectura: ",l.currentHours," horas"]}),u&&e.jsx("div",{className:"field-error",children:u})]}),l&&s.vehicleId&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card vehicle-confirmation",children:[e.jsxs("div",{className:"confirmation-header",children:[e.jsx("span",{className:"confirmation-icon",children:w(l)?"‚õΩ":"üöö"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsxs("strong",{children:[l.vehicleId," - ",l.name]}),e.jsx("br",{}),e.jsx("small",{children:l.type})]})]}),e.jsxs("div",{className:"vehicle-details",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"üìã Tipo:"}),e.jsx("span",{className:"detail-value",children:l.type})]}),l.category&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"üè∑Ô∏è Categor√≠a:"}),e.jsx("span",{className:"detail-value",children:l.category})]}),j&&s.currentHours&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"‚è±Ô∏è Hor√≥metro:"}),e.jsxs("span",{className:"detail-value",children:[s.currentHours," hrs"]})]})]}),w(l)&&!s.currentHours&&e.jsx("div",{className:"warning-message",children:"‚ö†Ô∏è Se requiere lectura del hor√≥metro para veh√≠culos diesel"})]})})]})})},G=({formData:s,updateFormData:m,systemData:E,setError:S,isEntryDestination:p=!1,isActive:C})=>{const[t,l]=x.useState(!1),[N,j]=x.useState({}),[y,u]=x.useState(!1),{inventory:v}=E;x.useEffect(()=>{(async()=>{if(s.fuelType&&s.quantity&&v.length>0&&!p){u(!0),await new Promise(d=>setTimeout(d,700));const a=parseFloat(s.quantity)||0,i={};z.filter(d=>p?!0:d!==s.location).forEach(d=>{const h=v.filter(g=>g.fuelType===s.fuelType&&g.location?.toLowerCase()===d.toLowerCase()&&g.status==="active").reduce((g,T)=>g+(parseFloat(T.currentStock)||0),0),n=v.filter(g=>g.fuelType===s.fuelType&&g.location?.toLowerCase()===d.toLowerCase()&&g.status==="active").reduce((g,T)=>g+(parseFloat(T.maxCapacity)||0),0),k=n-h,A=h+a,f=n>0?A/n*100:0;let q="available",M=`Capacidad: ${k.toFixed(1)} gal libres`,F=k>=a;n===0?(q="no_capacity",M="Sin tanques configurados",F=!1):k<a?(q="insufficient",M=`Insuficiente: faltan ${(a-k).toFixed(1)} gal`,F=!1):f>90&&(q="warning",M=`Quedar√° al ${f.toFixed(1)}% (casi lleno)`),i[d]={currentStock:h,maxCapacity:n,availableCapacity:k,afterTransfer:A,occupancyAfter:f,status:q,message:M,canAcceptTransfer:F}}),j(i),u(!1),console.log("üîç Capacidad validada por destino:",i)}})()},[s.fuelType,s.quantity,s.location,v,p]);const c=async b=>{const a=N[b];if(!p&&!a?.canAcceptTransfer){S("Esta ubicaci√≥n no puede recibir la cantidad solicitada");return}l(!0),S("");try{await new Promise(i=>setTimeout(i,500)),m("destinationLocation",b),console.log("üéØ Destino seleccionado:",b)}catch(i){console.error("Error al validar destino:",i),S("Error al validar el destino")}finally{l(!1)}};if(!p&&s.type!==r.TRANSFERENCIA)return null;const w=p?J:z.filter(b=>b!==s.location);return e.jsx("div",{className:`wizard-step step-destination ${C?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsxs("h3",{children:["üéØ ",p?"¬øA qu√© ubicaci√≥n llegar√° el combustible?":"¬øHacia qu√© ubicaci√≥n se transfiere?"]}),e.jsx("p",{children:"Selecciona la ubicaci√≥n de destino:"})]}),y&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîç Verificando capacidad disponible..."})]}),e.jsx("div",{className:"typeform-options",children:w.map(b=>{const a=N[b],i=!a||a.canAcceptTransfer;return e.jsxs("div",{className:`typeform-option ${s.destinationLocation===b?"selected":""} 
                           ${a?.status||"unknown"} ${!i||t?"disabled":""}`,onClick:()=>i&&!t&&c(b),children:[e.jsx("div",{className:"typeform-option-icon",children:"üéØ"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:R(b)}),a&&e.jsxs("div",{className:"capacity-info",children:[e.jsx("p",{className:"capacity-message",children:a.message}),a.maxCapacity>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"capacity-bar-mini",children:[e.jsx("div",{className:"capacity-current-mini",style:{width:`${Math.min(100,a.currentStock/a.maxCapacity*100)}%`}}),a.canAcceptTransfer&&e.jsx("div",{className:"capacity-after-mini",style:{width:`${Math.min(100,a.occupancyAfter)}%`,left:`${Math.min(100,a.currentStock/a.maxCapacity*100)}%`}})]}),e.jsxs("small",{className:"capacity-details",children:["Actual: ",a.currentStock.toFixed(1),"/",a.maxCapacity.toFixed(1)," gal"]})]})]})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"‚úì"})})})]},b)})}),s.location&&s.quantity&&e.jsx("div",{className:"transfer-summary",children:e.jsxs("div",{className:"transfer-flow",children:[e.jsxs("div",{className:"transfer-origin",children:[e.jsx("span",{className:"transfer-icon",children:"üìç"}),e.jsxs("div",{className:"transfer-info",children:[e.jsx("strong",{children:R(s.location)}),e.jsx("small",{children:"Origen"})]})]}),e.jsxs("div",{className:"transfer-arrow",children:[e.jsx("span",{children:"‚Üí"}),e.jsxs("small",{children:[parseFloat(s.quantity).toFixed(1)," gal"]})]}),e.jsxs("div",{className:"transfer-destination",children:[e.jsx("span",{className:"transfer-icon",children:"üéØ"}),e.jsxs("div",{className:"transfer-info",children:[e.jsx("strong",{children:s.destinationLocation?R(s.destinationLocation):"Seleccionar destino"}),e.jsx("small",{children:"Destino"})]})]})]})}),s.destinationLocation&&N[s.destinationLocation]&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card destination-confirmation",children:[e.jsxs("div",{className:"confirmation-header",children:[e.jsx("span",{className:"confirmation-icon",children:"üéØ"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:R(s.destinationLocation)}),e.jsx("br",{}),e.jsx("small",{children:"Ubicaci√≥n de destino confirmada"})]})]}),e.jsxs("div",{className:"capacity-confirmation",children:[e.jsxs("div",{className:"capacity-detail",children:[e.jsx("span",{className:"capacity-label",children:"üìä Despu√©s de transferir:"}),e.jsxs("span",{className:"capacity-value",children:[N[s.destinationLocation].afterTransfer.toFixed(1)," gal"]})]}),e.jsx("div",{className:"occupancy-bar",children:e.jsx("div",{className:"occupancy-fill",style:{width:`${N[s.destinationLocation].occupancyAfter}%`}})}),e.jsxs("small",{className:"occupancy-text",children:[N[s.destinationLocation].occupancyAfter.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},ue=({formData:s,updateFormData:m,systemData:E,error:S,setError:p,isActive:C})=>{const[t,l]=x.useState(!1),[N,j]=x.useState(!1),{products:y}=E;x.useEffect(()=>{if(s.fuelType&&!s.unitPrice&&y.length>0){const i=y.find(d=>d.name===s.fuelType||d.displayName===s.fuelType);i&&i.defaultPrice&&(m("unitPrice",i.defaultPrice.toString()),j(!0))}},[s.fuelType,s.unitPrice,y,m]);const u=async i=>{const d=parseFloat(i);(i===""||!isNaN(d)&&d>=0)&&(l(!0),await new Promise(h=>setTimeout(h,300)),m("unitPrice",i),j(i!==""),p(""),l(!1))},v=i=>{m("effectiveDate",i)},c=i=>{m("description",i)},w=(parseFloat(s.quantity)||0)*(parseFloat(s.unitPrice)||0),b=i=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(i),a=()=>y.find(i=>i.name===s.fuelType||i.displayName===s.fuelType);return e.jsx("div",{className:`wizard-step step-details ${C?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"üìã Informaci√≥n adicional del movimiento"}),e.jsx("p",{children:"Completa los detalles restantes:"})]}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"unitPrice",children:"üí∞ Precio por gal√≥n (COP) *"}),e.jsx("input",{id:"unitPrice",type:"number",step:"1",min:"0",value:s.unitPrice,onChange:i=>u(i.target.value),placeholder:"0",className:`typeform-input ${S?"error":""}`}),e.jsx("span",{className:"typeform-unit",children:"COP"}),t&&e.jsxs("div",{className:"calculating-price",children:[e.jsx("div",{className:"loading-spinner small"}),e.jsx("span",{children:"üí∞ Validando precio..."})]}),a()?.defaultPrice&&e.jsxs("small",{className:"price-suggestion",children:["üí° Precio sugerido: $",a().defaultPrice.toLocaleString("es-CO")," COP"]})]}),s.quantity&&s.unitPrice&&N&&e.jsx("div",{className:"total-value-section",children:e.jsxs("div",{className:"total-value-card",children:[e.jsx("div",{className:"total-icon",children:"üìä"}),e.jsxs("div",{className:"total-content",children:[e.jsx("h4",{children:"Valor Total Calculado"}),e.jsxs("div",{className:"total-calculation",children:[e.jsxs("span",{className:"calculation-details",children:[parseFloat(s.quantity).toFixed(2)," gal √ó $",parseFloat(s.unitPrice).toLocaleString("es-CO")," COP"]}),e.jsx("div",{className:"total-amount",children:b(w)})]})]})]})}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"effectiveDate",children:"üìÖ ¬øCu√°ndo ocurri√≥ este movimiento?"}),e.jsx("input",{id:"effectiveDate",type:"datetime-local",value:s.effectiveDate,onChange:i=>v(i.target.value),className:"typeform-input"}),e.jsx("small",{className:"typeform-unit",children:"üí° Por defecto se usa la fecha y hora actual"})]}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"description",children:"üìù Detalles adicionales del movimiento (opcional)"}),e.jsx("textarea",{id:"description",value:s.description,onChange:i=>c(i.target.value),placeholder:"Ej: Combustible para operaci√≥n en sector norte, mantenimiento programado, etc.",className:"typeform-input",rows:"3",maxLength:"500"}),e.jsxs("div",{className:"description-counter",children:[s.description.length,"/500 caracteres"]})]})]})})},me=({formData:s,systemData:m,error:E,onCommentsChange:S,confirmChecked:p,onConfirmChange:C})=>{const{vehicles:t,products:l,suppliers:N}=m,j=n=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),y=()=>({[r.ENTRADA]:{icon:"üì•",title:"Entrada",color:"entrada"},[r.SALIDA]:{icon:"üì§",title:"Salida",color:"salida"},[r.TRANSFERENCIA]:{icon:"üîÑ",title:"Transferencia",color:"transferencia"},[r.AJUSTE]:{icon:"‚öñÔ∏è",title:"Ajuste",color:"ajuste"}})[s.type]||{icon:"‚ùì",title:"Desconocido",color:"unknown"},u=()=>l.find(n=>n.name===s.fuelType||n.displayName===s.fuelType),v=()=>t.find(n=>n.vehicleId===s.vehicleId),c=()=>{const n=s.type===r.ENTRADA?s.supplierName:s.location;return N.find(k=>k.name===n)},w=(parseFloat(s.quantity)||0)*(parseFloat(s.unitPrice)||0),b=y(),a=u(),i=v(),d=c(),h=n=>{S(n.target.value)};return e.jsx("div",{className:"wizard-step step-summary",children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"‚úÖ Confirma tu movimiento"}),e.jsx("p",{children:"Revisa toda la informaci√≥n antes de crear el movimiento:"})]}),e.jsxs("div",{className:"summary-main",children:[e.jsxs("div",{className:`summary-header ${b.color}`,children:[e.jsx("div",{className:"summary-icon",children:b.icon}),e.jsxs("div",{className:"summary-title",children:[e.jsxs("h4",{children:[b.title," de Combustible"]}),e.jsxs("p",{children:[parseFloat(s.quantity).toFixed(2)," galones de ",a?.displayName||s.fuelType]})]}),e.jsx("div",{className:"summary-value",children:j(w)})]}),e.jsxs("div",{className:"summary-details",children:[e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"‚õΩ"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Combustible:"}),e.jsxs("span",{className:"detail-value",children:[a?.icon," ",a?.displayName||s.fuelType]})]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üìä"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Cantidad:"}),e.jsxs("span",{className:"detail-value",children:[parseFloat(s.quantity).toFixed(2)," gal √ó $",parseFloat(s.unitPrice).toLocaleString("es-CO")," COP"]})]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:s.type===r.ENTRADA?"üè™":"üìç"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:s.type===r.ENTRADA?"Proveedor:":"Origen:"}),e.jsx("span",{className:"detail-value",children:s.type===r.ENTRADA?d?`${d.name} - ${d.city}`:s.location:R(s.location)})]})]}),s.type===r.SALIDA&&i&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üöú"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Veh√≠culo:"}),e.jsxs("span",{className:"detail-value",children:[i.vehicleId," - ",i.name," (",i.type,")"]})]})]}),s.currentHours&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"‚è±Ô∏è"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Hor√≥metro:"}),e.jsxs("span",{className:"detail-value",children:[s.currentHours," horas"]})]})]}),s.type===r.TRANSFERENCIA&&s.destinationLocation&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üéØ"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Destino:"}),e.jsx("span",{className:"detail-value",children:R(s.destinationLocation)})]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üìÖ"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Fecha:"}),e.jsx("span",{className:"detail-value",children:new Date(s.effectiveDate).toLocaleString("es-CO")})]})]}),s.reference&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üìÑ"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Referencia:"}),e.jsx("span",{className:"detail-value",children:s.reference})]})]}),s.description&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"üìù"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Descripci√≥n:"}),e.jsx("span",{className:"detail-value description",children:s.description})]})]})]})]}),s.type===r.TRANSFERENCIA&&e.jsxs("div",{className:"transfer-flow-summary",children:[e.jsx("div",{className:"flow-header",children:"üîÑ Flujo de Transferencia"}),e.jsxs("div",{className:"flow-diagram",children:[e.jsxs("div",{className:"flow-location origin",children:[e.jsx("div",{className:"flow-icon",children:"üìç"}),e.jsxs("div",{className:"flow-text",children:[e.jsx("strong",{children:R(s.location)}),e.jsx("small",{children:"Origen"})]})]}),e.jsxs("div",{className:"flow-arrow",children:[e.jsx("div",{className:"arrow-line"}),e.jsx("div",{className:"arrow-head",children:"‚Üí"}),e.jsxs("div",{className:"flow-quantity",children:[parseFloat(s.quantity).toFixed(1)," gal"]})]}),e.jsxs("div",{className:"flow-location destination",children:[e.jsx("div",{className:"flow-icon",children:"üéØ"}),e.jsxs("div",{className:"flow-text",children:[e.jsx("strong",{children:R(s.destinationLocation)}),e.jsx("small",{children:"Destino"})]})]})]})]}),e.jsxs("div",{className:"additional-comments-section",children:[e.jsxs("div",{className:"comments-header",children:[e.jsx("h4",{children:"üí¨ Comentarios Adicionales"}),e.jsx("small",{children:"Opcional - Agrega informaci√≥n adicional sobre este movimiento"})]}),e.jsx("textarea",{className:"comments-textarea",value:s.additionalComments||"",onChange:h,placeholder:"Ejemplo: Combustible entregado por transporte especial, requiere almacenamiento prioritario, etc.",rows:3,maxLength:500}),e.jsxs("div",{className:"comments-counter",children:[(s.additionalComments||"").length,"/500 caracteres"]})]}),e.jsxs("div",{className:"confirmation-section",children:[e.jsxs("div",{className:"confirmation-checkbox",children:[e.jsx("input",{type:"checkbox",id:"confirmMovement",checked:p,onChange:n=>C(n.target.checked)}),e.jsx("label",{htmlFor:"confirmMovement",children:"‚úÖ Confirmo que toda la informaci√≥n es correcta y autorizo crear este movimiento"})]}),e.jsx("div",{className:"confirmation-warning",children:"‚ö†Ô∏è Una vez creado, el movimiento actualizar√° autom√°ticamente el inventario"})]}),E&&e.jsxs("div",{className:"summary-error",children:[e.jsx("span",{className:"error-icon",children:"‚ö†Ô∏è"}),E]})]})})},he=({isOpen:s,onClose:m,onSuccess:E})=>{const{inventory:S,vehicles:p,suppliers:C}=_(),[t,l]=x.useState(1),[N,j]=x.useState(!1),[y,u]=x.useState(!1),[v,c]=x.useState(""),[w,b]=x.useState(!1),[a,i]=x.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""}),[d,h]=x.useState({vehicles:[],inventory:[],suppliers:[],products:[],loadingData:!0}),n=()=>{l(1),c(""),b(!1),i({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""})};x.useEffect(()=>((async()=>{if(s){document.body.style.overflow="hidden",n(),h(P=>({...P,loadingData:!0}));try{console.log("üîÑ Cargando productos y sincronizando datos en tiempo real...");const P=await se();h({vehicles:p||[],inventory:S||[],suppliers:C||[],products:P||[],loadingData:!1}),console.log("‚úÖ Datos sincronizados para wizard - inventario en tiempo real:",S?.length||0,"items")}catch(P){console.error("‚ùå Error al cargar datos del sistema:",P),c("No se pudieron cargar los datos necesarios. Int√©ntalo de nuevo."),h(L=>({...L,loadingData:!1}))}}else document.body.style.overflow="unset"})(),()=>{document.body.style.overflow="unset"}),[s,S,p,C]);const k=()=>{if(!a.type)return 8;let o;return a.type===r.TRANSFERENCIA?o=8:a.type===r.SALIDA||a.type===r.ENTRADA?o=7:o=6,console.log("üîç [TOTAL STEPS]",{type:a.type,totalSteps:o,currentStep:t}),o},A=(o,P)=>{i(L=>({...L,[o]:P})),c("")},f=x.useCallback(()=>{let o=!1;switch(t){case 1:o=!!a.type;break;case 2:o=!!a.fuelType,console.log("üîç [STEP 2 VALIDATION]",{fuelType:a.fuelType,isValid:o,formData:a});break;case 3:a.type===r.ENTRADA?o=!!a.supplierName:o=!!a.location;break;case"3b":o=!!a.destinationLocation;break;case 4:o=a.quantity&&parseFloat(a.quantity)>0,console.log("üîç [DEBUG Step 4] Validaci√≥n cantidad:",{step:t,quantity:a.quantity,parsedQuantity:parseFloat(a.quantity),isQuantityValid:!!a.quantity,isParsedValid:parseFloat(a.quantity)>0,finalValidation:o,formData:a});break;case 5:if(a.type===r.SALIDA){if(o=!!a.vehicleId,o&&a.vehicleId){const P=p.find(L=>L.vehicleId===a.vehicleId);P&&(P.fuelType==="diesel"||P.fuelType==="Diesel")&&(o=!!a.currentHours&&parseFloat(a.currentHours)>=0)}}else o=!0;break;case 6:a.type===r.TRANSFERENCIA?o=!!a.destinationLocation:o=!0;break;case 7:o=!!a.unitPrice&&parseFloat(a.unitPrice)>=0;break;case 8:o=!0;break;default:o=!1}return console.log("üîç [DEBUG General] validateCurrentStep:",{currentStep:t,isValid:o,formDataKeys:Object.keys(a),formData:a}),o},[t,a,p]),q=x.useMemo(()=>f(),[f]),M=()=>{j(!0);const o=f();if(console.log("üîç [DEBUG nextStep] Intentando navegar:",{currentStep:t,isValid:o,formData:a,type:a.type}),o){const P=k();let L=t+1;t===3&&a.type===r.ENTRADA?L="3b":t==="3b"?L=4:t===4&&a.type!==r.SALIDA?a.type===r.TRANSFERENCIA?L=6:(a.type,r.ENTRADA,L=7):t===5&&a.type!==r.TRANSFERENCIA&&(L=7),console.log("üîç [DEBUG Navigation] Navegando:",{from:t,to:L,totalSteps:P}),(O=>a.type===r.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[O]||O:a.type===r.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[O]||O:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[O]||O)(L)<=P&&l(L)}else console.log("‚ùå [DEBUG] Validaci√≥n fall√≥, no se puede navegar"),c("Por favor completa este paso antes de continuar");setTimeout(()=>j(!1),300)},F=()=>{if(j(!0),t>1&&t!=="3b"){let o=t-1;t===4&&a.type===r.ENTRADA?o="3b":(t===7&&a.type===r.ENTRADA||t===7&&a.type!==r.TRANSFERENCIA&&a.type!==r.SALIDA||t===6&&a.type!==r.SALIDA)&&(o=4),l(o)}else t==="3b"&&l(3);setTimeout(()=>j(!1),300)},g=async()=>{u(!0),c("");try{const o={...a};console.log("üîç [SUBMIT] Datos completos antes de crear movimiento:",o);const P={...o,quantity:parseFloat(o.quantity),unitPrice:parseFloat(o.unitPrice),effectiveDate:new Date(o.effectiveDate)};console.log("üîç [SUBMIT] MovementData enviado a createMovement:",P),await K(P),E(),n()}catch(o){console.error("Error al crear movimiento:",o),c(o.message||"Error al crear el movimiento")}finally{u(!1)}},T=()=>{const o={formData:a,updateFormData:A,systemData:d,error:v,setError:c,isActive:!N};return{1:e.jsx(le,{...o}),2:e.jsx(ce,{...o}),3:e.jsx(re,{...o}),"3b":e.jsx(G,{...o,isEntryDestination:!0}),4:e.jsx(oe,{...o}),5:e.jsx(de,{...o}),6:e.jsx(G,{...o}),7:e.jsx(ue,{...o}),8:e.jsx(me,{...o,onSubmit:g,isLoading:y,onCommentsChange:L=>A("additionalComments",L),confirmChecked:w,onConfirmChange:b})}[t]||e.jsx("div",{children:"Paso no encontrado"})};if(!s)return null;const $=k(),H=(o=>a.type===r.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[o]||o:a.type===r.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[o]||o:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[o]||o)(t),Q=H/$*100,U=H>=$;return console.log("üîç [WIZARD DEBUG]",{type:a.type,currentStep:t,currentLogicalStep:H,totalSteps:$,progress:Q,isLastStep:U,formDataKeys:Object.keys(a).filter(o=>a[o]),fuelType:a.fuelType}),e.jsx("div",{className:"modal-overlay wizard-overlay",onClick:m,children:e.jsxs("div",{className:`modal-content wizard-modal typeform-mode ${U?"is-last-step":""}`,onClick:o=>o.stopPropagation(),children:[e.jsx("div",{className:"typeform-progress",children:e.jsx("div",{className:"typeform-progress-fill",style:{width:`${Q}%`}})}),e.jsx("div",{className:"wizard-header typeform-mode",children:e.jsxs("div",{className:"wizard-title",children:[e.jsx("h3",{children:"üßô‚Äç‚ôÇÔ∏è Asistente de Movimientos"}),e.jsx("button",{className:"modal-close",onClick:m,children:"‚úï"})]})}),e.jsx("div",{className:"wizard-body typeform-mode",children:d.loadingData?e.jsxs("div",{className:"wizard-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"üîÑ Cargando datos del sistema..."})]}):e.jsx("div",{className:"wizard-step-container",children:T()})}),v&&e.jsxs("div",{className:"wizard-error",children:[e.jsx("span",{className:"error-icon",children:"‚ö†Ô∏è"}),v]}),e.jsxs("div",{className:"typeform-navigation",children:[t>1&&e.jsx("button",{className:"typeform-nav-btn",onClick:F,disabled:N,"aria-label":"Paso anterior",children:"‚Üê"}),U?e.jsx("button",{className:"typeform-nav-btn",onClick:g,disabled:y||!w||N,"aria-label":"Confirmar movimiento",children:y?e.jsx("span",{className:"loading-spinner small"}):"‚úì"}):e.jsx("button",{className:"typeform-nav-btn",onClick:M,disabled:!q||N,"aria-label":"Siguiente paso",children:"‚Üí"})]})]})})},fe=()=>{const{user:s,userProfile:m,deleteMovement:E}=_(),[S,p]=x.useState([]),[C,t]=x.useState(null),[l,N]=x.useState(!0),[j,y]=x.useState(null),[u,v]=x.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[c,w]=x.useState(""),[b,a]=x.useState(!1);x.useEffect(()=>{if(!s)return;N(!0);const g=Y((T,$)=>{if($){console.error("Error en suscripci√≥n de movimientos:",$),y("Error al cargar movimientos"),N(!1);return}p(T),y(null),N(!1)},u);return()=>g()},[s,u]),x.useEffect(()=>{s&&(async()=>{try{const T=await Z(u);t(T)}catch(T){console.error("Error al cargar estad√≠sticas:",T)}})()},[s,S,u]);const i=S.filter(g=>{if(!c)return!0;const T=c.toLowerCase();return g.fuelType?.toLowerCase().includes(T)||g.type?.toLowerCase().includes(T)||g.location?.toLowerCase().includes(T)||g.vehicleId?.toLowerCase().includes(T)||g.description?.toLowerCase().includes(T)||g.reference?.toLowerCase().includes(T)}),d=()=>{a(!0)},h=g=>{alert(`üìã Detalles del movimiento:

Tipo: ${g.type}
Combustible: ${g.fuelType}
Cantidad: ${g.quantity} gal
Fecha: ${new Date(g.createdAt).toLocaleDateString("es-CO")}`)},n=()=>{a(!1)},k=g=>{v(T=>({...T,...g}))},A=()=>{v({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),w("")},f=async g=>{if(window.confirm("¬øEst√°s seguro de que quieres aprobar este movimiento? Esta acci√≥n actualizar√° el inventario."))try{await ee(g),alert("Movimiento aprobado y stock actualizado.")}catch(T){console.error("Error al aprobar movimiento:",T),alert(`Error al aprobar movimiento: ${T.message}`)}},q=async g=>{if(window.confirm("¬øEst√°s seguro de que quieres rechazar este movimiento?"))try{await X(g,{status:I.CANCELADO}),alert("Movimiento rechazado.")}catch(T){console.error("Error al rechazar movimiento:",T),alert(`Error al rechazar movimiento: ${T.message}`)}},M=async g=>{try{const T=await E(g);if(T.success)alert("Movimiento eliminado exitosamente.");else throw new Error(T.error)}catch(T){console.error("Error al eliminar movimiento:",T),alert(`Error al eliminar movimiento: ${T.message}`)}},F=m?.role==="admin"||m?.role==="contador"||m?.role==="cliente";return l?e.jsx("div",{className:"movements-main",children:e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Cargando movimientos..."})]})}):j?e.jsx("div",{className:"movements-main",children:e.jsxs("div",{className:"error-container",children:[e.jsx("div",{className:"error-icon",children:"‚ö†Ô∏è"}),e.jsx("h3",{children:"Error al cargar movimientos"}),e.jsx("p",{children:j}),e.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):e.jsxs("div",{className:"movements-main",children:[e.jsxs("div",{className:"movements-header",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("h2",{children:"üìä Movimientos de Combustibles"}),e.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),F&&e.jsx("div",{className:"create-movement-options",children:e.jsx("button",{className:"btn-create-movement primary",onClick:d,children:"‚ûï Nuevo Movimiento"})})]}),C&&e.jsx(ae,{stats:C,filters:u}),e.jsx(ie,{filters:u,onFilterChange:k,onClearFilters:A,searchTerm:c,onSearchChange:w,totalResults:i.length}),i.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"üìã"}),e.jsx("h3",{children:S.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),e.jsx("p",{children:S.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de b√∫squeda"}),S.length===0&&F&&e.jsx("div",{className:"create-first-options",children:e.jsx("button",{className:"btn-create-first primary",onClick:d,children:"‚ûï Crear Primer Movimiento"})})]}):e.jsx(ne,{movements:i,onEdit:null,onView:h,onApprove:f,onReject:q,onDelete:M,userRole:m?.role}),b&&e.jsx(he,{isOpen:b,onClose:n,onSuccess:()=>{n()}})]})};export{fe as default};
