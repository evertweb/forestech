import{j as e,f as V,a as G,l,M as F,r as x,O,z as $,A as W,B as K,u as _,C as Z,D as Y,E as X,G as ee,H as se}from"./index-xTTnogj4.js";import{g as ae}from"./productsService-D_ViR5qR.js";const te=({stats:s,filters:p})=>{if(!s)return null;const k=(c,t)=>t===0?c>0?100:0:((c-t)/t*100).toFixed(1),E=c=>{switch(c){case l.ENTRADA:return"#10b981";case l.SALIDA:return"#ef4444";case l.TRANSFERENCIA:return"#3b82f6";case l.AJUSTE:return"#f59e0b";default:return"#6b7280"}},m=c=>{switch(c){case l.ENTRADA:return"ğŸ“¥";case l.SALIDA:return"ğŸ“¤";case l.TRANSFERENCIA:return"ğŸ”„";case l.AJUSTE:return"âš–ï¸";default:return"ğŸ“‹"}},g=k(s.thisMonth,s.lastMonth);return e.jsxs("div",{className:"movements-stats",children:[e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card primary",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ“Š"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:V(s.totalMovements)}),e.jsx("div",{className:"stat-label",children:"Total Movimientos"}),e.jsxs("div",{className:"stat-trend",children:[e.jsxs("span",{className:`trend ${g>=0?"positive":"negative"}`,children:[g>=0?"ğŸ“ˆ":"ğŸ“‰"," ",Math.abs(g),"%"]}),e.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ’°"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:G(s.totalValue)}),e.jsx("div",{className:"stat-label",children:"Valor Total"}),e.jsxs("div",{className:"stat-secondary",children:["Promedio: ",G(s.averageValue)]})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"â›½"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:V(s.totalQuantity)}),e.jsx("div",{className:"stat-label",children:"Galones Total"}),e.jsxs("div",{className:"stat-secondary",children:["Promedio: ",V(s.totalQuantity/(s.totalMovements||1))," gal/mov"]})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ“…"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:V(s.thisWeek)}),e.jsx("div",{className:"stat-label",children:"Esta Semana"}),e.jsxs("div",{className:"stat-secondary",children:[V(s.thisMonth)," este mes"]})]})]})]}),e.jsxs("div",{className:"stats-breakdown",children:[e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"ğŸ“‹ Por Tipo de Movimiento"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byType).map(([c,t])=>{const j=(t/s.totalMovements*100).toFixed(1);return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:m(c)}),e.jsx("span",{className:"breakdown-label",children:c.charAt(0).toUpperCase()+c.slice(1)})]}),e.jsx("div",{className:"breakdown-value",children:t}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:E(c)}})}),e.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},c)})})]}),e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"âš¡ Por Estado"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byStatus).map(([c,t])=>{const j=(t/s.totalMovements*100).toFixed(1),N=o=>{switch(o){case F.COMPLETADO:return"#10b981";case F.PENDIENTE:return"#f59e0b";case F.CANCELADO:return"#ef4444";default:return"#6b7280"}},y=o=>{switch(o){case F.COMPLETADO:return"âœ…";case F.PENDIENTE:return"â³";case F.CANCELADO:return"âŒ";default:return"â“"}};return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:y(c)}),e.jsx("span",{className:"breakdown-label",children:c.charAt(0).toUpperCase()+c.slice(1)})]}),e.jsx("div",{className:"breakdown-value",children:t}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:N(c)}})}),e.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},c)})})]}),e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"â›½ Por Tipo de Combustible"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byFuelType).map(([c,t])=>{const j=(t/s.totalMovements*100).toFixed(1),N=y=>{switch(y?.toLowerCase()){case"diesel":return"ğŸš›";case"gasolina":return"ğŸš—";case"acpm":return"ğŸšš";case"lubricante":return"ğŸ›¢ï¸";default:return"â›½"}};return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:N(c)}),e.jsx("span",{className:"breakdown-label",children:c})]}),e.jsx("div",{className:"breakdown-value",children:t}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:"#059669"}})}),e.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},c)})})]})]}),(p.type||p.status||p.fuelType||p.vehicleId)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("h4",{children:"ğŸ” Filtros Activos"}),e.jsxs("div",{className:"filters-list",children:[p.type&&e.jsxs("span",{className:"filter-tag",children:["Tipo: ",p.type]}),p.status&&e.jsxs("span",{className:"filter-tag",children:["Estado: ",p.status]}),p.fuelType&&e.jsxs("span",{className:"filter-tag",children:["Combustible: ",p.fuelType]}),p.vehicleId&&e.jsxs("span",{className:"filter-tag",children:["VehÃ­culo: ",p.vehicleId]})]})]})]})},ie=({filters:s,onFilterChange:p,onClearFilters:k,searchTerm:E,onSearchChange:m,totalResults:g})=>{const[c,t]=x.useState(!1),j=[{value:"Diesel",label:"Diesel ğŸš›"},{value:"Gasolina",label:"Gasolina ğŸš—"},{value:"ACPM",label:"ACPM ğŸšš"},{value:"Lubricante",label:"Lubricante ğŸ›¢ï¸"}],N=[{value:"all",label:"Todos los perÃ­odos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este aÃ±o"}],y=Object.values(s).filter(r=>r&&r!==""&&r!=="all").length,o=(r,w)=>{p({[r]:w})},C=r=>{p(r)};return e.jsxs("div",{className:"movements-filters",children:[e.jsxs("div",{className:"filters-main",children:[e.jsx("div",{className:"search-section",children:e.jsxs("div",{className:"search-box",children:[e.jsx("span",{className:"search-icon",children:"ğŸ”"}),e.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehÃ­culo, referencia...",value:E,onChange:r=>m(r.target.value),className:"search-input"}),E&&e.jsx("button",{className:"search-clear",onClick:()=>m(""),title:"Limpiar bÃºsqueda",children:"âœ•"})]})}),e.jsxs("div",{className:"filters-controls",children:[e.jsxs("div",{className:"quick-filters",children:[e.jsx("button",{className:`quick-filter ${s.type===l.ENTRADA?"active":""}`,onClick:()=>C({type:l.ENTRADA}),children:"ğŸ“¥ Entradas"}),e.jsx("button",{className:`quick-filter ${s.type===l.SALIDA?"active":""}`,onClick:()=>C({type:l.SALIDA}),children:"ğŸ“¤ Salidas"}),e.jsx("button",{className:`quick-filter ${s.status===F.PENDIENTE?"active":""}`,onClick:()=>C({status:F.PENDIENTE}),children:"â³ Pendientes"})]}),e.jsxs("button",{className:`btn-advanced-filters ${c?"active":""}`,onClick:()=>t(!c),children:["ğŸ›ï¸ Filtros",y>0&&e.jsx("span",{className:"filters-count",children:y})]}),e.jsx("div",{className:"view-indicator",children:e.jsx("span",{className:"view-info",children:"ğŸ“‹ Vista Tabla"})})]})]}),c&&e.jsxs("div",{className:"filters-advanced",children:[e.jsxs("div",{className:"filters-grid",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Tipo de Movimiento"}),e.jsxs("select",{value:s.type,onChange:r=>o("type",r.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los tipos"}),e.jsx("option",{value:l.ENTRADA,children:"ğŸ“¥ Entrada"}),e.jsx("option",{value:l.SALIDA,children:"ğŸ“¤ Salida"}),e.jsx("option",{value:l.TRANSFERENCIA,children:"ğŸ”„ Transferencia"}),e.jsx("option",{value:l.AJUSTE,children:"âš–ï¸ Ajuste"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Estado"}),e.jsxs("select",{value:s.status,onChange:r=>o("status",r.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los estados"}),e.jsx("option",{value:F.PENDIENTE,children:"â³ Pendiente"}),e.jsx("option",{value:F.COMPLETADO,children:"âœ… Completado"}),e.jsx("option",{value:F.CANCELADO,children:"âŒ Cancelado"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Tipo de Combustible"}),e.jsxs("select",{value:s.fuelType,onChange:r=>o("fuelType",r.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los combustibles"}),j.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"PerÃ­odo"}),e.jsx("select",{value:s.dateRange,onChange:r=>o("dateRange",r.target.value),className:"filter-select",children:N.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"VehÃ­culo/Equipo"}),e.jsx("input",{type:"text",placeholder:"ID del vehÃ­culo...",value:s.vehicleId,onChange:r=>o("vehicleId",r.target.value),className:"filter-input"})]})]}),e.jsxs("div",{className:"filters-actions",children:[e.jsx("button",{className:"btn-clear-filters",onClick:k,disabled:y===0,children:"ğŸ—‘ï¸ Limpiar Filtros"}),e.jsxs("div",{className:"filters-info",children:[e.jsxs("span",{className:"results-count",children:[g," resultado",g!==1?"s":""]}),y>0&&e.jsxs("span",{className:"active-filters-text",children:["(",y," filtro",y!==1?"s":""," activo",y!==1?"s":"",")"]})]})]})]}),e.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:e.jsx("small",{children:"ğŸ’¡ Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},ne=({movements:s,onEdit:p,onView:k,onApprove:E,onReject:m,onDelete:g,userRole:c})=>{const[t,j]=x.useState("createdAt"),[N,y]=x.useState("desc"),o=i=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(i),C=i=>i?(i instanceof Date?i:new Date(i)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",r=i=>{switch(i){case l.ENTRADA:return"ğŸ“¥";case l.SALIDA:return"ğŸ“¤";case l.TRANSFERENCIA:return"ğŸ”„";case l.AJUSTE:return"âš–ï¸";default:return"ğŸ“‹"}},w=i=>{switch(i?.toLowerCase()){case"diesel":return"ğŸš›";case"gasolina":return"ğŸš—";case"acpm":return"ğŸšš";case"lubricante":return"ğŸ›¢ï¸";default:return"â›½"}},T=i=>{switch(i){case F.COMPLETADO:return"âœ…";case F.PENDIENTE:return"â³";case F.CANCELADO:return"âŒ";default:return"â“"}},b=i=>{switch(i){case F.COMPLETADO:return"status-completado";case F.PENDIENTE:return"status-pendiente";case F.CANCELADO:return"status-cancelado";default:return"status-default"}},a=i=>{t===i?y(N==="asc"?"desc":"asc"):(j(i),y("asc"))},n=[...s].sort((i,u)=>{let v=i[t],f=u[t];return(t.includes("Date")||t.includes("At"))&&(v=new Date(v),f=new Date(f)),typeof v=="number"&&typeof f=="number"?N==="asc"?v-f:f-v:typeof v=="string"&&typeof f=="string"?N==="asc"?v.localeCompare(f):f.localeCompare(v):v instanceof Date&&f instanceof Date?N==="asc"?v-f:f-v:0}),h=i=>t!==i?"â†•ï¸":N==="asc"?"â†‘":"â†“";return e.jsxs("div",{className:"movements-table-container",children:[e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"movements-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"sortable",onClick:()=>a("type"),children:["Tipo ",h("type")]}),e.jsxs("th",{className:"sortable",onClick:()=>a("fuelType"),children:["Combustible ",h("fuelType")]}),e.jsxs("th",{className:"sortable text-right",onClick:()=>a("quantity"),children:["Cantidad ",h("quantity")]}),e.jsxs("th",{className:"sortable text-right",onClick:()=>a("unitPrice"),children:["Precio/Gal ",h("unitPrice")]}),e.jsxs("th",{className:"sortable text-right",onClick:()=>a("totalValue"),children:["Valor Total ",h("totalValue")]}),e.jsx("th",{children:"VehÃ­culo"}),e.jsx("th",{children:"UbicaciÃ³n"}),e.jsxs("th",{className:"sortable",onClick:()=>a("status"),children:["Estado ",h("status")]}),e.jsxs("th",{className:"sortable",onClick:()=>a("createdAt"),children:["Fecha ",h("createdAt")]}),e.jsx("th",{className:"actions-column",children:"Acciones"})]})}),e.jsx("tbody",{children:n.map(i=>e.jsxs("tr",{className:`movement-row ${i.status===F.PENDIENTE?"pending-row":""}`,children:[e.jsx("td",{className:"type-cell",children:e.jsxs("div",{className:"type-content",children:[e.jsx("span",{className:"type-icon",children:r(i.type)}),e.jsx("span",{className:"type-text",children:i.type?i.type.charAt(0).toUpperCase()+i.type.slice(1):"Sin tipo"})]})}),e.jsx("td",{className:"fuel-cell",children:e.jsxs("div",{className:"fuel-content",children:[e.jsx("span",{className:"fuel-icon",children:w(i.fuelType)}),e.jsx("span",{className:"fuel-text",children:i.fuelType})]})}),e.jsxs("td",{className:"quantity-cell text-right",children:[e.jsx("span",{className:"quantity-value",children:i.quantity}),e.jsx("span",{className:"quantity-unit",children:"gal"})]}),e.jsx("td",{className:"price-cell text-right",children:o(i.unitPrice)}),e.jsx("td",{className:"value-cell text-right",children:e.jsx("strong",{children:o(i.totalValue)})}),e.jsx("td",{className:"vehicle-cell",children:i.vehicleId?e.jsxs("span",{className:"vehicle-id",children:["ğŸšœ ",i.vehicleId]}):e.jsx("span",{className:"no-vehicle",children:"-"})}),e.jsx("td",{className:"location-cell",children:e.jsxs("span",{className:"location-text",children:["ğŸ“ ",i.type===l.ENTRADA?i.destinationLocation||"Sin ubicaciÃ³n":i.location||"Principal"]})}),e.jsx("td",{className:"status-cell",children:e.jsxs("div",{className:`status-badge ${b(i.status)}`,children:[e.jsx("span",{className:"status-icon",children:T(i.status)}),e.jsx("span",{className:"status-text",children:i.status?i.status.charAt(0).toUpperCase()+i.status.slice(1):"Sin estado"})]})}),e.jsx("td",{className:"date-cell",children:e.jsxs("div",{className:"date-content",children:[e.jsx("span",{className:"date-value",children:C(i.createdAt)}),i.reference&&e.jsxs("span",{className:"reference-small",children:["#",i.reference]})]})}),e.jsx("td",{className:"actions-cell",children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn-action btn-view",onClick:()=>k(i),title:"Ver detalles",children:"ğŸ‘ï¸"}),c==="admin"&&i.status===F.PENDIENTE&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-action btn-approve",onClick:()=>E(i.id),title:"Aprobar movimiento",children:"âœ“"}),e.jsx("button",{className:"btn-action btn-reject",onClick:()=>m(i.id),title:"Rechazar movimiento",children:"âœ—"})]}),p&&i.status===F.PENDIENTE&&e.jsx("button",{className:"btn-action btn-edit",onClick:()=>p(i),title:"Editar movimiento",children:"âœï¸"}),c==="admin"&&e.jsx("button",{className:"btn-action btn-delete",onClick:()=>{window.confirm("Â¿EstÃ¡s seguro de que deseas eliminar este movimiento? Esta acciÃ³n no se puede deshacer.")&&g(i.id)},title:"Eliminar movimiento",children:"ğŸ—‘ï¸"})]})})]},i.id))})]})}),e.jsxs("div",{className:"table-info",children:[e.jsxs("div",{className:"table-summary",children:[e.jsxs("span",{className:"total-rows",children:[s.length," movimiento",s.length!==1?"s":""]}),t&&e.jsxs("span",{className:"sort-info",children:["Ordenado por ",t," (",N==="asc"?"ascendente":"descendente",")"]})]}),e.jsxs("div",{className:"table-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"â³"})," Pendiente"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"âœ…"})," Completado"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"âŒ"})," Cancelado"]})]})]})]})},le=({movements:s,onEdit:p,onView:k,onApprove:E,onReject:m,onDelete:g,userRole:c})=>e.jsx(ne,{movements:s,onEdit:p,onView:k,onApprove:E,onReject:m,onDelete:g,userRole:c}),ce=({formData:s,updateFormData:p,setError:k,isActive:E})=>{const m=[{type:l.ENTRADA,icon:"ğŸ“¥",title:"Entrada de Combustible",description:"Registrar combustible que llega de proveedores",color:"entrada",details:"Para compras, reabastecimientos y recepciones"},{type:l.SALIDA,icon:"â›½",title:"Salida de Combustible",description:"Asignar combustible a vehÃ­culos y equipos",color:"salida",details:"Para consumo y operaciones de campo"},{type:l.TRANSFERENCIA,icon:"ğŸ”„",title:"Transferencia",description:"Mover combustible entre ubicaciones",color:"transferencia",details:"Entre tanques, sitios o almacenes"},{type:l.AJUSTE,icon:"âš–ï¸",title:"Ajuste de Inventario",description:"Corregir stock por diferencias o calibraciones",color:"ajuste",details:"Para mermas, pÃ©rdidas o correcciones"}],g=c=>{p("type",c),k("")};return x.useEffect(()=>{if(!E)return;const c=t=>{const j=parseInt(t.key);if(j>=1&&j<=4){const N=m[j-1];g(N.type)}};return window.addEventListener("keypress",c),()=>window.removeEventListener("keypress",c)},[E,g,m]),e.jsx("div",{className:`wizard-step step-movement-type ${E?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h2",{children:"ğŸŒ¿ Â¡Hola! Â¿QuÃ© operaciÃ³n necesitas registrar hoy?"}),e.jsx("p",{children:"Selecciona el tipo de movimiento que vas a realizar"})]}),e.jsx("div",{className:"typeform-options",children:m.map(c=>e.jsxs("div",{className:`typeform-option ${s.type===c.type?"selected":""} ${c.color}`,onClick:()=>g(c.type),children:[e.jsx("div",{className:"typeform-option-icon",children:c.icon}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:c.title}),e.jsx("p",{children:c.description})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"âœ“"})})})]},c.type))}),s.type&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card",children:[e.jsx("span",{className:"confirmation-icon",children:m.find(c=>c.type===s.type)?.icon}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:"Perfecto! Has seleccionado:"})," ",m.find(c=>c.type===s.type)?.title,e.jsx("br",{}),e.jsx("small",{children:m.find(c=>c.type===s.type)?.details})]})]})})]})})},re=({formData:s,updateFormData:p,systemData:k,setError:E,isActive:m})=>{const[g,c]=x.useState(!1),[t,j]=x.useState(null),{products:N}=k;x.useEffect(()=>{if(s.fuelType&&N.length>0){const o=N.find(C=>C.name===s.fuelType||C.displayName===s.fuelType);j(o),o&&o.defaultPrice&&!s.unitPrice&&p("unitPrice",o.defaultPrice.toString())}},[s.fuelType,s.unitPrice,N,p]),x.useEffect(()=>{if(!m)return;const o=C=>{const r=parseInt(C.key);if(r>=1&&r<=N.length){const w=N[r-1];y(w.name,w)}};return window.addEventListener("keypress",o),()=>window.removeEventListener("keypress",o)},[m,N,y]);const y=async(o,C)=>{c(!0),E("");try{await new Promise(r=>setTimeout(r,800)),p("fuelType",o),j(C),C.defaultPrice&&p("unitPrice",C.defaultPrice.toString()),console.log("ğŸ”„ [Step2] Combustible seleccionado:",o,"Precio:",C.defaultPrice)}catch(r){console.error("Error al cargar combustible:",r),E("Error al cargar informaciÃ³n del combustible")}finally{c(!1)}};return N.length===0?e.jsx("div",{className:`wizard-step step-fuel-type ${m?"active":""}`,children:e.jsx("div",{className:"typeform-layout",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"ğŸ”„ Cargando productos disponibles..."})]})})}):e.jsx("div",{className:`wizard-step step-fuel-type ${m?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h2",{children:"â›½ Â¿QuÃ© tipo de combustible necesitas?"}),e.jsx("p",{children:"Elige el producto que vas a mover"})]}),g&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"ğŸ“¡ Actualizando precios..."})]}),e.jsx("div",{className:"typeform-options",children:N.map(o=>e.jsxs("div",{className:`typeform-option ${s.fuelType===o.name?"selected":""} ${g?"disabled":""}`,onClick:()=>!g&&y(o.name,o),children:[e.jsx("div",{className:"typeform-option-icon",children:o.icon||"ğŸ›¢ï¸"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:o.displayName||o.name}),e.jsx("p",{children:o.description||"Combustible premium"}),o.defaultPrice&&e.jsx("div",{className:"fuel-price",children:e.jsxs("span",{className:"price-value",children:["$",o.defaultPrice.toLocaleString("es-CO")," COP/galÃ³n"]})})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"âœ“"})})})]},o.id))}),t&&s.fuelType&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card fuel-confirmation",children:[e.jsxs("div",{className:"confirmation-header",children:[e.jsx("span",{className:"confirmation-icon",children:t.icon||"ğŸ›¢ï¸"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsxs("strong",{children:["Excelente! Has elegido ",t.displayName||t.name]}),e.jsx("br",{}),e.jsx("small",{children:t.description||"Combustible de calidad premium"})]})]}),t.defaultPrice&&e.jsxs("div",{className:"price-confirmation",children:[e.jsxs("div",{className:"price-info",children:[e.jsx("span",{className:"price-label",children:"ğŸ’° Precio actual:"}),e.jsxs("span",{className:"price-amount",children:["$",t.defaultPrice.toLocaleString("es-CO")," COP/galÃ³n"]})]}),e.jsx("small",{className:"price-note",children:"âœ¨ Aplicamos el precio automÃ¡ticamente (lo puedes ajustar despuÃ©s)"})]})]})})]})})},oe=({formData:s,updateFormData:p,systemData:k,setError:E,isActive:m})=>{const[g,c]=x.useState(!1),[t,j]=x.useState({}),[N,y]=x.useState(!1),{suppliers:o,inventory:C}=k,r=s.type===l.ENTRADA;x.useEffect(()=>{if(!m)return;const a=n=>{const h=parseInt(n.key);if(r){const i=o.filter(u=>u.status==="active");if(h>=1&&h<=i.length){const u=i[h-1];w(u.name)}}else if(h>=1&&h<=O.length){const i=O[h-1];w(i)}};return window.addEventListener("keypress",a),()=>window.removeEventListener("keypress",a)},[m,o,r,w]),x.useEffect(()=>{(async()=>{if(!r&&s.fuelType&&C.length>0){y(!0),await new Promise(h=>setTimeout(h,600));const n={};O.forEach(h=>{const i=C.filter(I=>I.fuelType===s.fuelType&&I.location?.toLowerCase()===h.toLowerCase()&&I.status==="active"),u=i.reduce((I,P)=>I+(parseFloat(P.currentStock)||0),0),v=i.reduce((I,P)=>I+(parseFloat(P.maxCapacity)||0),0);let f="available",L=`${u.toFixed(0)} galones disponibles`;u===0?(f="empty",L="Sin combustible disponible"):u<v*.2&&(f="low",L=`${u.toFixed(0)} gal (stock bajo)`),n[h]={available:u,maxCapacity:v,status:f,message:L,percentage:v>0?u/v*100:0}}),j(n),y(!1)}})()},[s.fuelType,r,C]);const w=async a=>{c(!0),E("");try{await new Promise(n=>setTimeout(n,400)),p(r?"supplierName":"location",a)}catch{E("Error al validar la ubicaciÃ³n")}finally{c(!1)}},T=a=>{switch(a.toLowerCase()){case"oficina principal":return"ğŸ¢";case"tanque central":return"â›½";case"almacÃ©n norte":return"ğŸ­";case"zona sur":return"ğŸŒ";case"taller mecÃ¡nico":return"ğŸ”§";default:return"ğŸ“"}},b=()=>{switch(s.type){case l.ENTRADA:return"Â¿De dÃ³nde viene el combustible?";case l.SALIDA:return"Â¿De quÃ© ubicaciÃ³n tomarÃ¡s el combustible?";case l.TRANSFERENCIA:return"Â¿Desde dÃ³nde quieres transferir?";case l.AJUSTE:return"Â¿En quÃ© ubicaciÃ³n harÃ¡s el ajuste?";default:return"Â¿CuÃ¡l es la ubicaciÃ³n?"}};if(r){const a=o.filter(n=>n.status==="active");return console.log("ğŸ” [Step3 DEBUG] Suppliers data:",{suppliersLength:o.length,activeSuppliersLength:a.length,suppliers:o}),e.jsx("div",{className:`wizard-step step-location ${m?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsxs("h2",{children:["ğŸª ",b()]}),e.jsx("p",{children:"Selecciona el proveedor que estÃ¡ enviando el combustible"})]}),g&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"ğŸ”„ Validando proveedor..."})]}),o.length===0?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"ğŸ”„ Cargando proveedores..."})]}):a.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ğŸª"}),e.jsx("h3",{children:"No hay proveedores disponibles"}),e.jsx("p",{children:"No se encontraron proveedores activos en el sistema."}),e.jsx("p",{children:"Contacta al administrador para agregar proveedores."})]}):e.jsx("div",{className:"typeform-options",children:a.map(n=>e.jsxs("div",{className:`typeform-option ${s.supplierName===n.name?"selected":""} ${g?"disabled":""}`,onClick:()=>!g&&w(n.name),children:[e.jsx("div",{className:"typeform-option-icon",children:"ğŸª"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:n.name}),e.jsx("p",{children:n.location||"Proveedor de combustibles"}),n.contact&&e.jsxs("small",{className:"supplier-contact",children:["ğŸ“ ",n.contact]})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"âœ“"})})})]},n.id))}),s.supplierName&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card",children:[e.jsx("span",{className:"confirmation-icon",children:"ğŸª"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsxs("strong",{children:["Genial! RecibirÃ¡s combustible de ",s.supplierName]}),e.jsx("br",{}),e.jsx("small",{children:"El combustible serÃ¡ registrado en el inventario"})]})]})})]})})}return e.jsx("div",{className:`wizard-step step-location ${m?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsxs("h2",{children:["ğŸ“ ",b()]}),e.jsx("p",{children:"Elige la ubicaciÃ³n donde estÃ¡ almacenado el combustible"})]}),N&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"âš™ï¸ Verificando stock por ubicaciÃ³n..."})]}),e.jsx("div",{className:"typeform-options",children:O.map(a=>{const n=t[a]||{},h=s.location===a;return e.jsxs("div",{className:`typeform-option ${h?"selected":""} ${n.status||""} ${g?"disabled":""}`,onClick:()=>!g&&w(a),children:[e.jsx("div",{className:"typeform-option-icon",children:T(a)}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:$(a)}),e.jsx("p",{children:n.message||"Verificando disponibilidad..."}),n.available>0&&e.jsx("div",{className:"stock-indicator",children:e.jsx("div",{className:"stock-bar-mini",children:e.jsx("div",{className:"stock-fill-mini",style:{width:`${Math.min(n.percentage,100)}%`}})})})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"âœ“"})})})]},a)})}),s.location&&t[s.location]&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card",children:[e.jsx("span",{className:"confirmation-icon",children:T(s.location)}),e.jsxs("div",{className:"confirmation-text",children:[e.jsxs("strong",{children:["Excelente! UsarÃ¡s ",$(s.location)]}),e.jsx("br",{}),e.jsx("small",{children:t[s.location].message})]})]})})]})})},de=({formData:s,updateFormData:p,systemData:k,setError:E,isActive:m})=>{const[g,c]=x.useState(!1),[t,j]=x.useState(null),[N,y]=x.useState(""),o=x.useRef(null),{inventory:C}=k,r=s.type===l.SALIDA||s.type===l.TRANSFERENCIA;x.useEffect(()=>{m&&o.current&&setTimeout(()=>o.current.focus(),300)},[m]),x.useEffect(()=>{if(!m)return;const n=h=>{h.key==="Enter"&&s.quantity&&parseFloat(s.quantity)>0};return window.addEventListener("keypress",n),()=>window.removeEventListener("keypress",n)},[m,s.quantity]),x.useEffect(()=>{(async()=>{if(r&&s.fuelType&&s.location&&C.length>0){c(!0),await new Promise(P=>setTimeout(P,500));const h=C.filter(P=>P.fuelType===s.fuelType&&P.location?.toLowerCase()===s.location?.toLowerCase()&&P.status==="active").reduce((P,S)=>P+(parseFloat(S.currentStock)||0),0),i=parseFloat(s.quantity)||0,u=h-i;let v="available",f="âœ…",L="Stock Disponible",I="Perfecto, hay suficiente combustible.";if(i>0&&(h<i?(v="critical",f="ğŸš«",L="Cantidad No Disponible",I=`Solo hay ${h.toFixed(2)} galones disponibles`):u<h*.2?(v="warning",f="âš ï¸",L="Stock QuedarÃ¡ Bajo",I=`QuedarÃ¡n solo ${u.toFixed(2)} galones`):I=`QuedarÃ¡n ${u.toFixed(2)} galones en stock`),j({available:h,required:i,remaining:Math.max(0,u),status:v,icon:f,title:L,message:I,isValid:h>=i}),i>0&&r){const P={type:s.type===l.SALIDA?"outbound":"transfer",fuelType:s.fuelType,quantity:s.quantity,sourceLocation:s.location},S=W(P,C);S.isValid?S.warning?y(`âš ï¸ ${S.warning}`):y(""):y(`ğŸš« ${S.error}`)}else r||y("");c(!1)}})()},[s.quantity,s.fuelType,s.location,s.type,r,C]);const w=n=>{const h=parseFloat(n);(n===""||!isNaN(h)&&h>=0)&&(p("quantity",n),E(""))},T=()=>{if(!t||!t.available)return[];const n=t.available;return[{label:"25 gal",value:"25"},{label:"50 gal",value:"50"},{label:"100 gal",value:"100"},{label:`${n.toFixed(0)} gal`,value:n.toFixed(1)}]},b=()=>{switch(s.type){case l.ENTRADA:return"ğŸ“¥";case l.SALIDA:return"â›½";case l.TRANSFERENCIA:return"ğŸ”„";case l.AJUSTE:return"âš–ï¸";default:return"ğŸ“Š"}},a=()=>{switch(s.type){case l.ENTRADA:return"Â¿CuÃ¡ntos galones estÃ¡s recibiendo?";case l.SALIDA:return"Â¿CuÃ¡ntos galones necesitas entregar?";case l.TRANSFERENCIA:return"Â¿CuÃ¡ntos galones vas a transferir?";case l.AJUSTE:return"Â¿CuÃ¡l es la cantidad del ajuste?";default:return"Â¿CuÃ¡ntos galones necesitas?"}};return e.jsx("div",{className:`wizard-step step-quantity ${m?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsxs("h2",{children:[b()," ",a()]}),e.jsx("p",{children:"Ingresa la cantidad en galones"})]}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("input",{ref:o,id:"quantity",type:"number",step:"0.1",min:"0",value:s.quantity,onChange:n=>w(n.target.value),placeholder:"0",className:`typeform-input ${N?"error":""}`,autoComplete:"off"}),e.jsx("span",{className:"typeform-unit",children:"galones"})]}),t&&t.available>0&&e.jsxs("div",{className:"typeform-suggestions",children:[e.jsx("label",{className:"typeform-suggestions-label",children:"Cantidades comunes:"}),e.jsx("div",{className:"typeform-suggestions-buttons",children:T().map((n,h)=>e.jsx("button",{type:"button",className:"typeform-suggestion-btn",onClick:()=>w(n.value),children:n.label},h))})]}),g&&e.jsxs("div",{className:"calculating-indicator",children:[e.jsx("div",{className:"loading-spinner small"}),e.jsx("span",{children:"âš™ï¸ Verificando disponibilidad..."})]}),t&&r&&!g&&e.jsxs("div",{className:`stock-info-container ${t.status}`,children:[e.jsxs("div",{className:"stock-info-header",children:[e.jsx("div",{className:"stock-info-icon",children:t.icon}),e.jsx("h4",{className:"stock-info-title",children:t.title})]}),e.jsx("div",{className:"stock-info-message",children:t.message})]}),N&&e.jsx("div",{className:"validation-warning",children:N}),s.quantity&&parseFloat(s.quantity)>0&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card",children:[e.jsx("span",{className:"confirmation-icon",children:b()}),e.jsxs("div",{className:"confirmation-text",children:[e.jsxs("strong",{children:["Perfecto! ",parseFloat(s.quantity).toLocaleString("es-CO")," galones"]}),e.jsx("br",{}),e.jsx("small",{children:r?`SaldrÃ¡n del inventario de ${s.location}`:"Se agregarÃ¡n al inventario"})]})]})})]})})},ue=({formData:s,updateFormData:p,systemData:k,setError:E,isActive:m})=>{const[g,c]=x.useState(!1),[t,j]=x.useState(null),[N,y]=x.useState(!1),[o,C]=x.useState(""),r=x.useRef(null),{vehicles:w}=k;if(x.useEffect(()=>{if(!m||s.type!==l.SALIDA)return;const u=v=>{const f=b(),L=parseInt(v.key);if(L>=1&&L<=f.length){const I=f[L-1];a(I)}};return window.addEventListener("keypress",u),()=>window.removeEventListener("keypress",u)},[m,w,s.fuelType]),x.useEffect(()=>{if(s.vehicleId&&w.length>0&&s.type===l.SALIDA){const u=w.find(f=>f.vehicleId===s.vehicleId);j(u);const v=T(u);y(v),v&&r.current&&setTimeout(()=>r.current.focus(),500)}},[s.vehicleId,w]),s.type!==l.SALIDA)return null;const T=u=>{if(!u)return!1;const v=u.fuelType==="diesel"||u.fuelType==="Diesel",f=u.category==="tractor"||u.type?.toLowerCase().includes("tractor");return v||f},b=()=>s.fuelType?w.filter(u=>{const v=u.fuelType?.toLowerCase(),f=s.fuelType?.toLowerCase();return v===f||f==="diesel"&&v==="diesel"||f==="gasolina"&&v==="gasolina"}):w,a=async u=>{c(!0),E(""),C("");try{await new Promise(f=>setTimeout(f,400)),p("vehicleId",u.vehicleId),j(u);const v=T(u);y(v),v||p("currentHours","")}catch{E("Error al seleccionar vehÃ­culo")}finally{c(!1)}},n=u=>{const v=parseFloat(u);u===""||!isNaN(v)&&v>=0?(p("currentHours",u),C("")):C("Ingresa un valor vÃ¡lido de horÃ³metro")},h=u=>{const v=u.category?.toLowerCase()||"",f=u.type?.toLowerCase()||"";return v.includes("tractor")||f.includes("tractor")?"ğŸšœ":v.includes("excavadora")||f.includes("excavadora")?"ğŸ¦•":v.includes("volqueta")||f.includes("volqueta")?"ğŸš›":v.includes("moto")||f.includes("moto")?"ğŸï¸":v.includes("carro")||f.includes("carro")?"ğŸš—":"ğŸš™"},i=b();return i.length===0?e.jsx("div",{className:`wizard-step step-vehicle ${m?"active":""}`,children:e.jsx("div",{className:"typeform-layout",children:e.jsxs("div",{className:"typeform-question",children:[e.jsx("h2",{children:"ğŸš« No hay vehÃ­culos compatibles"}),e.jsxs("p",{children:["No se encontraron vehÃ­culos que usen ",s.fuelType]})]})})}):e.jsx("div",{className:`wizard-step step-vehicle ${m?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h2",{children:"ğŸš— Â¿A quÃ© vehÃ­culo le darÃ¡s combustible?"}),e.jsxs("p",{children:["Selecciona el vehÃ­culo o equipo que recibirÃ¡ el ",s.fuelType]})]}),g&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"ğŸ”„ Validando vehÃ­culo..."})]}),e.jsx("div",{className:"typeform-options",children:i.map(u=>e.jsxs("div",{className:`typeform-option ${s.vehicleId===u.vehicleId?"selected":""} ${g?"disabled":""}`,onClick:()=>!g&&a(u),children:[e.jsx("div",{className:"typeform-option-icon",children:h(u)}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsxs("h4",{children:[u.vehicleId," - ",u.brand||"VehÃ­culo"]}),e.jsx("p",{children:u.model||u.type||"Equipo de trabajo"}),u.currentHours&&e.jsxs("small",{className:"vehicle-hours",children:["ğŸ• ",u.currentHours," horas registradas"]})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"âœ“"})})})]},u.id))}),N&&t&&e.jsxs("div",{className:"typeform-input-section",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"ğŸ• Â¿CuÃ¡l es el horÃ³metro actual?"}),e.jsxs("p",{children:["Ingresa las horas actuales de ",t.vehicleId]})]}),e.jsx("input",{ref:r,type:"number",step:"0.1",min:"0",value:s.currentHours||"",onChange:u=>n(u.target.value),placeholder:"0",className:`typeform-input ${o?"error":""}`,autoComplete:"off"}),e.jsx("span",{className:"typeform-unit",children:"horas"}),o&&e.jsx("div",{className:"validation-warning",children:o})]}),t&&s.vehicleId&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card",children:[e.jsx("span",{className:"confirmation-icon",children:h(t)}),e.jsxs("div",{className:"confirmation-text",children:[e.jsxs("strong",{children:["Perfecto! Combustible para ",t.vehicleId]}),e.jsx("br",{}),e.jsxs("small",{children:[t.brand," ",t.model,N&&s.currentHours&&` - HorÃ³metro: ${s.currentHours} horas`]})]})]})})]})})},B=({formData:s,updateFormData:p,systemData:k,setError:E,isEntryDestination:m=!1,isActive:g})=>{const[c,t]=x.useState(!1),[j,N]=x.useState({}),[y,o]=x.useState(!1),{inventory:C}=k;x.useEffect(()=>{(async()=>{if(s.fuelType&&s.quantity&&C.length>0&&!m){o(!0),await new Promise(n=>setTimeout(n,700));const b=parseFloat(s.quantity)||0,a={};O.filter(n=>m?!0:n!==s.location).forEach(n=>{const h=C.filter(S=>S.fuelType===s.fuelType&&S.location?.toLowerCase()===n.toLowerCase()&&S.status==="active").reduce((S,A)=>S+(parseFloat(A.currentStock)||0),0),i=C.filter(S=>S.fuelType===s.fuelType&&S.location?.toLowerCase()===n.toLowerCase()&&S.status==="active").reduce((S,A)=>S+(parseFloat(A.maxCapacity)||0),0),u=i-h,v=h+b,f=i>0?v/i*100:0;let L="available",I=`Capacidad: ${u.toFixed(1)} gal libres`,P=u>=b;i===0?(L="no_capacity",I="Sin tanques configurados",P=!1):u<b?(L="insufficient",I=`Insuficiente: faltan ${(b-u).toFixed(1)} gal`,P=!1):f>90&&(L="warning",I=`QuedarÃ¡ al ${f.toFixed(1)}% (casi lleno)`),a[n]={currentStock:h,maxCapacity:i,availableCapacity:u,afterTransfer:v,occupancyAfter:f,status:L,message:I,canAcceptTransfer:P}}),N(a),o(!1),console.log("ğŸ” Capacidad validada por destino:",a)}})()},[s.fuelType,s.quantity,s.location,C,m]);const r=async T=>{const b=j[T];if(!m&&!b?.canAcceptTransfer){E("Esta ubicaciÃ³n no puede recibir la cantidad solicitada");return}t(!0),E("");try{await new Promise(a=>setTimeout(a,500)),p("destinationLocation",T),console.log("ğŸ¯ Destino seleccionado:",T)}catch(a){console.error("Error al validar destino:",a),E("Error al validar el destino")}finally{t(!1)}};if(!m&&s.type!==l.TRANSFERENCIA)return null;const w=m?K:O.filter(T=>T!==s.location);return e.jsx("div",{className:`wizard-step step-destination ${g?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsxs("h3",{children:["ğŸ¯ ",m?"Â¿A quÃ© ubicaciÃ³n llegarÃ¡ el combustible?":"Â¿Hacia quÃ© ubicaciÃ³n se transfiere?"]}),e.jsx("p",{children:"Selecciona la ubicaciÃ³n de destino:"})]}),y&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"ğŸ” Verificando capacidad disponible..."})]}),e.jsx("div",{className:"typeform-options",children:w.map(T=>{const b=j[T],a=!b||b.canAcceptTransfer;return e.jsxs("div",{className:`typeform-option ${s.destinationLocation===T?"selected":""} 
                           ${b?.status||"unknown"} ${!a||c?"disabled":""}`,onClick:()=>a&&!c&&r(T),children:[e.jsx("div",{className:"typeform-option-icon",children:"ğŸ¯"}),e.jsxs("div",{className:"typeform-option-content",children:[e.jsx("h4",{children:$(T)}),b&&e.jsxs("div",{className:"capacity-info",children:[e.jsx("p",{className:"capacity-message",children:b.message}),b.maxCapacity>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"capacity-bar-mini",children:[e.jsx("div",{className:"capacity-current-mini",style:{width:`${Math.min(100,b.currentStock/b.maxCapacity*100)}%`}}),b.canAcceptTransfer&&e.jsx("div",{className:"capacity-after-mini",style:{width:`${Math.min(100,b.occupancyAfter)}%`,left:`${Math.min(100,b.currentStock/b.maxCapacity*100)}%`}})]}),e.jsxs("small",{className:"capacity-details",children:["Actual: ",b.currentStock.toFixed(1),"/",b.maxCapacity.toFixed(1)," gal"]})]})]})]}),e.jsx("div",{className:"typeform-option-selector",children:e.jsx("div",{className:"typeform-check",children:e.jsx("span",{className:"typeform-check-icon",children:"âœ“"})})})]},T)})}),s.location&&s.quantity&&e.jsx("div",{className:"transfer-summary",children:e.jsxs("div",{className:"transfer-flow",children:[e.jsxs("div",{className:"transfer-origin",children:[e.jsx("span",{className:"transfer-icon",children:"ğŸ“"}),e.jsxs("div",{className:"transfer-info",children:[e.jsx("strong",{children:$(s.location)}),e.jsx("small",{children:"Origen"})]})]}),e.jsxs("div",{className:"transfer-arrow",children:[e.jsx("span",{children:"â†’"}),e.jsxs("small",{children:[parseFloat(s.quantity).toFixed(1)," gal"]})]}),e.jsxs("div",{className:"transfer-destination",children:[e.jsx("span",{className:"transfer-icon",children:"ğŸ¯"}),e.jsxs("div",{className:"transfer-info",children:[e.jsx("strong",{children:s.destinationLocation?$(s.destinationLocation):"Seleccionar destino"}),e.jsx("small",{children:"Destino"})]})]})]})}),s.destinationLocation&&j[s.destinationLocation]&&e.jsx("div",{className:"selection-confirmation",children:e.jsxs("div",{className:"confirmation-card destination-confirmation",children:[e.jsxs("div",{className:"confirmation-header",children:[e.jsx("span",{className:"confirmation-icon",children:"ğŸ¯"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:$(s.destinationLocation)}),e.jsx("br",{}),e.jsx("small",{children:"UbicaciÃ³n de destino confirmada"})]})]}),e.jsxs("div",{className:"capacity-confirmation",children:[e.jsxs("div",{className:"capacity-detail",children:[e.jsx("span",{className:"capacity-label",children:"ğŸ“Š DespuÃ©s de transferir:"}),e.jsxs("span",{className:"capacity-value",children:[j[s.destinationLocation].afterTransfer.toFixed(1)," gal"]})]}),e.jsx("div",{className:"occupancy-bar",children:e.jsx("div",{className:"occupancy-fill",style:{width:`${j[s.destinationLocation].occupancyAfter}%`}})}),e.jsxs("small",{className:"occupancy-text",children:[j[s.destinationLocation].occupancyAfter.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},me=({formData:s,updateFormData:p,systemData:k,error:E,setError:m,isActive:g})=>{const[c,t]=x.useState(!1),[j,N]=x.useState(!1),{products:y}=k;x.useEffect(()=>{if(s.fuelType&&!s.unitPrice&&y.length>0){const a=y.find(n=>n.name===s.fuelType||n.displayName===s.fuelType);a&&a.defaultPrice&&(p("unitPrice",a.defaultPrice.toString()),N(!0))}},[s.fuelType,s.unitPrice,y,p]);const o=async a=>{const n=parseFloat(a);(a===""||!isNaN(n)&&n>=0)&&(t(!0),await new Promise(h=>setTimeout(h,300)),p("unitPrice",a),N(a!==""),m(""),t(!1))},C=a=>{p("effectiveDate",a)},r=a=>{p("description",a)},w=(parseFloat(s.quantity)||0)*(parseFloat(s.unitPrice)||0),T=a=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),b=()=>y.find(a=>a.name===s.fuelType||a.displayName===s.fuelType);return e.jsx("div",{className:`wizard-step step-details ${g?"active":""}`,children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h3",{children:"ğŸ“‹ InformaciÃ³n adicional del movimiento"}),e.jsx("p",{children:"Completa los detalles restantes:"})]}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"unitPrice",children:"ğŸ’° Precio por galÃ³n (COP) *"}),e.jsx("input",{id:"unitPrice",type:"number",step:"1",min:"0",value:s.unitPrice,onChange:a=>o(a.target.value),placeholder:"0",className:`typeform-input ${E?"error":""}`}),e.jsx("span",{className:"typeform-unit",children:"COP"}),c&&e.jsxs("div",{className:"calculating-price",children:[e.jsx("div",{className:"loading-spinner small"}),e.jsx("span",{children:"ğŸ’° Validando precio..."})]}),b()?.defaultPrice&&e.jsxs("small",{className:"price-suggestion",children:["ğŸ’¡ Precio sugerido: $",b().defaultPrice.toLocaleString("es-CO")," COP"]})]}),s.quantity&&s.unitPrice&&j&&e.jsx("div",{className:"total-value-section",children:e.jsxs("div",{className:"total-value-card",children:[e.jsx("div",{className:"total-icon",children:"ğŸ“Š"}),e.jsxs("div",{className:"total-content",children:[e.jsx("h4",{children:"Valor Total Calculado"}),e.jsxs("div",{className:"total-calculation",children:[e.jsxs("span",{className:"calculation-details",children:[parseFloat(s.quantity).toFixed(2)," gal Ã— $",parseFloat(s.unitPrice).toLocaleString("es-CO")," COP"]}),e.jsx("div",{className:"total-amount",children:T(w)})]})]})]})}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"effectiveDate",children:"ğŸ“… Â¿CuÃ¡ndo ocurriÃ³ este movimiento?"}),e.jsx("input",{id:"effectiveDate",type:"datetime-local",value:s.effectiveDate,onChange:a=>C(a.target.value),className:"typeform-input"}),e.jsx("small",{className:"typeform-unit",children:"ğŸ’¡ Por defecto se usa la fecha y hora actual"})]}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"description",children:"ğŸ“ Detalles adicionales del movimiento (opcional)"}),e.jsx("textarea",{id:"description",value:s.description,onChange:a=>r(a.target.value),placeholder:"Ej: Combustible para operaciÃ³n en sector norte, mantenimiento programado, etc.",className:"typeform-input",rows:"3",maxLength:"500"}),e.jsxs("div",{className:"description-counter",children:[s.description.length,"/500 caracteres"]})]})]})})},pe=({formData:s,systemData:p,error:k,onCommentsChange:E,confirmChecked:m,onConfirmChange:g})=>{const{vehicles:c,products:t}=p,j=n=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),N=()=>({[l.ENTRADA]:{icon:"ğŸ“¥",title:"Entrada de Combustible",color:"entrada"},[l.SALIDA]:{icon:"â›½",title:"Salida de Combustible",color:"salida"},[l.TRANSFERENCIA]:{icon:"ğŸ”„",title:"Transferencia",color:"transferencia"},[l.AJUSTE]:{icon:"âš–ï¸",title:"Ajuste de Inventario",color:"ajuste"}})[s.type]||{icon:"â“",title:"OperaciÃ³n",color:"unknown"},y=()=>t.find(n=>n.name===s.fuelType||n.displayName===s.fuelType),o=()=>c.find(n=>n.vehicleId===s.vehicleId),C=()=>{const n=parseFloat(s.quantity).toLocaleString("es-CO"),h=y()?.displayName||s.fuelType,i=o();switch(s.type){case l.ENTRADA:return`Recibir ${n} galones de ${h} de ${s.supplierName}`;case l.SALIDA:return`Entregar ${n} galones de ${h} a ${i?.vehicleId||"vehÃ­culo"}`;case l.TRANSFERENCIA:return`Transferir ${n} galones de ${h} desde ${$(s.location)} hacia ${$(s.destinationLocation)}`;case l.AJUSTE:return`Ajustar ${n} galones de ${h} en ${$(s.location)}`;default:return`Procesar ${n} galones de ${h}`}},r=(parseFloat(s.quantity)||0)*(parseFloat(s.unitPrice)||0),w=N(),T=y(),b=o(),a=n=>{E(n.target.value)};return e.jsx("div",{className:"wizard-step step-summary",children:e.jsxs("div",{className:"typeform-layout",children:[e.jsxs("div",{className:"typeform-question",children:[e.jsx("h2",{children:"ğŸ¯ Â¡Perfecto! Vamos a confirmar"}),e.jsx("p",{children:"Revisa que todo estÃ© correcto antes de procesar tu operaciÃ³n"})]}),e.jsxs("div",{className:"summary-main",children:[e.jsxs("div",{className:`summary-header ${w.color}`,children:[e.jsx("div",{className:"summary-icon",children:w.icon}),e.jsxs("div",{className:"summary-title",children:[e.jsx("h4",{children:w.title}),e.jsx("p",{children:C()})]}),e.jsx("div",{className:"summary-value",children:j(r)})]}),e.jsxs("div",{className:"summary-details",children:[e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"â›½"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Combustible"}),e.jsx("span",{className:"detail-value",children:T?.displayName||s.fuelType})]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"ğŸ“Š"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Cantidad"}),e.jsxs("span",{className:"detail-value",children:[parseFloat(s.quantity).toLocaleString("es-CO")," galones"]})]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"ğŸ’°"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Precio unitario"}),e.jsx("span",{className:"detail-value",children:j(parseFloat(s.unitPrice))})]})]}),s.type===l.ENTRADA&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"ğŸª"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Proveedor"}),e.jsx("span",{className:"detail-value",children:s.supplierName})]})]}),(s.type===l.SALIDA||s.type===l.TRANSFERENCIA)&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"ğŸ“"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"UbicaciÃ³n origen"}),e.jsx("span",{className:"detail-value",children:$(s.location)})]})]}),s.type===l.SALIDA&&b&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"ğŸš—"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"VehÃ­culo"}),e.jsxs("span",{className:"detail-value",children:[b.vehicleId,s.currentHours&&` - ${s.currentHours} hrs`]})]})]}),s.type===l.TRANSFERENCIA&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"ğŸ¯"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"Destino"}),e.jsx("span",{className:"detail-value",children:$(s.destinationLocation)})]})]}),s.description&&e.jsxs("div",{className:"detail-row",children:[e.jsx("div",{className:"detail-icon",children:"ğŸ“"}),e.jsxs("div",{className:"detail-content",children:[e.jsx("span",{className:"detail-label",children:"DescripciÃ³n"}),e.jsx("span",{className:"detail-value description",children:s.description})]})]})]})]}),e.jsxs("div",{className:"typeform-input-section",children:[e.jsx("label",{htmlFor:"additional-comments",children:"ğŸ’¬ Â¿AlgÃºn comentario adicional? (Opcional)"}),e.jsx("textarea",{id:"additional-comments",value:s.additionalComments||"",onChange:a,placeholder:"Escribe cualquier observaciÃ³n o detalle especial...",className:"typeform-textarea",rows:"3"})]}),e.jsxs("div",{className:"confirmation-section",children:[e.jsxs("div",{className:"confirmation-checkbox",children:[e.jsx("input",{type:"checkbox",id:"final-confirm",checked:m,onChange:n=>g(n.target.checked)}),e.jsx("label",{htmlFor:"final-confirm",children:"âœ… Confirmo que toda la informaciÃ³n es correcta y deseo procesar este movimiento"})]}),e.jsx("div",{className:"confirmation-warning",children:"âš ï¸ Este movimiento actualizarÃ¡ automÃ¡ticamente el inventario de combustibles"})]}),k&&e.jsxs("div",{className:"validation-warning",children:["ğŸš« ",k]}),e.jsxs("div",{className:"final-message",children:[e.jsxs("p",{children:["ğŸ‰ ",e.jsx("strong",{children:"Â¡Listo para procesar!"})]}),e.jsx("p",{children:"Tu movimiento serÃ¡ registrado inmediatamente en el sistema."})]})]})})},he=({isOpen:s,onClose:p,onSuccess:k})=>{const{inventory:E,vehicles:m,suppliers:g,subscribeToSuppliers:c}=_(),[t,j]=x.useState(1),[N,y]=x.useState(!1),[o,C]=x.useState(!1),[r,w]=x.useState(""),[T,b]=x.useState(!1),[a,n]=x.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""}),[h,i]=x.useState({vehicles:[],inventory:[],suppliers:[],products:[],loadingData:!0}),u=()=>{j(1),w(""),b(!1),n({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""})};x.useEffect(()=>((async()=>{if(s){document.body.style.overflow="hidden",u(),i(M=>({...M,loadingData:!0}));try{console.log("ğŸ”„ Cargando productos y sincronizando datos en tiempo real..."),g.length===0&&c&&(console.log("ğŸ”„ SuscribiÃ©ndose a suppliers..."),c()),console.log("ğŸ” [WIZARD DEBUG] Datos disponibles:",{vehicles:m?.length||0,inventory:E?.length||0,suppliers:g?.length||0});const M=await ae();i({vehicles:m||[],inventory:E||[],suppliers:g||[],products:M||[],loadingData:!1}),console.log("âœ… Datos sincronizados para wizard - inventario en tiempo real:",E?.length||0,"items"),console.log("âœ… Suppliers cargados:",g?.length||0,"proveedores")}catch(M){console.error("âŒ Error al cargar datos del sistema:",M),w("No se pudieron cargar los datos necesarios. IntÃ©ntalo de nuevo."),i(q=>({...q,loadingData:!1}))}}else document.body.style.overflow="unset"})(),()=>{document.body.style.overflow="unset"}),[s,E,m,g,c]);const v=()=>{if(!a.type)return 8;let d;return a.type===l.TRANSFERENCIA?d=8:a.type===l.SALIDA||a.type===l.ENTRADA?d=7:d=6,console.log("ğŸ” [TOTAL STEPS]",{type:a.type,totalSteps:d,currentStep:t}),d},f=(d,M)=>{n(q=>({...q,[d]:M})),w("")},L=x.useCallback(()=>{let d=!1;switch(t){case 1:d=!!a.type;break;case 2:d=!!a.fuelType,console.log("ğŸ” [STEP 2 VALIDATION]",{fuelType:a.fuelType,isValid:d,formData:a});break;case 3:a.type===l.ENTRADA?d=!!a.supplierName:d=!!a.location;break;case"3b":d=!!a.destinationLocation;break;case 4:d=a.quantity&&parseFloat(a.quantity)>0,console.log("ğŸ” [DEBUG Step 4] ValidaciÃ³n cantidad:",{step:t,quantity:a.quantity,parsedQuantity:parseFloat(a.quantity),isQuantityValid:!!a.quantity,isParsedValid:parseFloat(a.quantity)>0,finalValidation:d,formData:a});break;case 5:if(a.type===l.SALIDA){if(d=!!a.vehicleId,d&&a.vehicleId){const M=m.find(q=>q.vehicleId===a.vehicleId);M&&(M.fuelType==="diesel"||M.fuelType==="Diesel")&&(d=!!a.currentHours&&parseFloat(a.currentHours)>=0)}}else d=!0;break;case 6:a.type===l.TRANSFERENCIA?d=!!a.destinationLocation:d=!0;break;case 7:d=!!a.unitPrice&&parseFloat(a.unitPrice)>=0;break;case 8:d=!0;break;default:d=!1}return console.log("ğŸ” [DEBUG General] validateCurrentStep:",{currentStep:t,isValid:d,formDataKeys:Object.keys(a),formData:a}),d},[t,a,m]),I=x.useMemo(()=>L(),[L]),P=()=>{y(!0);const d=L();if(console.log("ğŸ” [DEBUG nextStep] Intentando navegar:",{currentStep:t,isValid:d,formData:a,type:a.type}),d){const M=v();let q=t+1;t===3&&a.type===l.ENTRADA?q="3b":t==="3b"?q=4:t===4&&a.type!==l.SALIDA?a.type===l.TRANSFERENCIA?q=6:(a.type,l.ENTRADA,q=7):t===5&&a.type!==l.TRANSFERENCIA&&(q=7),console.log("ğŸ” [DEBUG Navigation] Navegando:",{from:t,to:q,totalSteps:M}),(R=>a.type===l.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[R]||R:a.type===l.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[R]||R:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[R]||R)(q)<=M&&j(q)}else console.log("âŒ [DEBUG] ValidaciÃ³n fallÃ³, no se puede navegar"),w("Por favor completa este paso antes de continuar");setTimeout(()=>y(!1),300)},S=()=>{if(y(!0),t>1&&t!=="3b"){let d=t-1;t===4&&a.type===l.ENTRADA?d="3b":(t===7&&a.type===l.ENTRADA||t===7&&a.type!==l.TRANSFERENCIA&&a.type!==l.SALIDA||t===6&&a.type!==l.SALIDA)&&(d=4),j(d)}else t==="3b"&&j(3);setTimeout(()=>y(!1),300)},A=async()=>{C(!0),w("");try{const d={...a};console.log("ğŸ” [SUBMIT] Datos completos antes de crear movimiento:",d);const M={...d,quantity:parseFloat(d.quantity),unitPrice:parseFloat(d.unitPrice),effectiveDate:new Date(d.effectiveDate)};console.log("ğŸ” [SUBMIT] MovementData enviado a createMovement:",M),await Z(M),k(),u()}catch(d){console.error("Error al crear movimiento:",d),w(d.message||"Error al crear el movimiento")}finally{C(!1)}},z=()=>{const d={formData:a,updateFormData:f,systemData:h,error:r,setError:w,isActive:!N};return{1:e.jsx(ce,{...d}),2:e.jsx(re,{...d}),3:e.jsx(oe,{...d}),"3b":e.jsx(B,{...d,isEntryDestination:!0}),4:e.jsx(de,{...d}),5:e.jsx(ue,{...d}),6:e.jsx(B,{...d}),7:e.jsx(me,{...d}),8:e.jsx(pe,{...d,onSubmit:A,isLoading:o,onCommentsChange:q=>f("additionalComments",q),confirmChecked:T,onConfirmChange:b})}[t]||e.jsx("div",{children:"Paso no encontrado"})};if(!s)return null;const U=v(),H=(d=>a.type===l.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[d]||d:a.type===l.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[d]||d:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[d]||d)(t),D=H/U*100,Q=H>=U;return console.log("ğŸ” [WIZARD DEBUG]",{type:a.type,currentStep:t,currentLogicalStep:H,totalSteps:U,progress:D,isLastStep:Q,formDataKeys:Object.keys(a).filter(d=>a[d]),fuelType:a.fuelType}),e.jsx("div",{className:"modal-overlay wizard-overlay",onClick:p,children:e.jsxs("div",{className:`modal-content wizard-modal typeform-mode ${Q?"is-last-step":""}`,onClick:d=>d.stopPropagation(),children:[e.jsx("button",{className:"typeform-escape",onClick:p,"aria-label":"Cerrar wizard",children:"âœ•"}),e.jsx("div",{className:"typeform-progress",children:e.jsx("div",{className:"typeform-progress-fill",style:{width:`${D}%`}})}),e.jsx("div",{className:"wizard-header typeform-mode",children:e.jsxs("div",{className:"wizard-title",children:[e.jsx("h3",{children:"ğŸ§™â€â™‚ï¸ Asistente de Movimientos"}),e.jsx("button",{className:"modal-close",onClick:p,children:"âœ•"})]})}),e.jsx("div",{className:"wizard-body typeform-mode",children:h.loadingData?e.jsxs("div",{className:"wizard-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"ğŸ”„ Cargando datos del sistema..."})]}):e.jsx("div",{className:"wizard-step-container",children:z()})}),r&&e.jsxs("div",{className:"wizard-error",children:[e.jsx("span",{className:"error-icon",children:"âš ï¸"}),r]}),e.jsxs("div",{className:"typeform-navigation",children:[t>1&&e.jsx("button",{className:"typeform-nav-btn",onClick:S,disabled:N,"aria-label":"Paso anterior",children:"â†"}),Q?e.jsx("button",{className:"typeform-nav-btn",onClick:A,disabled:o||!T||N,"aria-label":"Confirmar movimiento",children:o?e.jsx("span",{className:"loading-spinner small"}):"âœ“"}):e.jsx("button",{className:"typeform-nav-btn",onClick:P,disabled:!I||N,"aria-label":"Siguiente paso",children:"â†’"})]}),e.jsxs("div",{className:"typeform-step-indicator",children:[e.jsx("div",{className:"step-number",children:H}),e.jsxs("span",{children:["de ",U]})]})]})})},ge=()=>{const{user:s,userProfile:p,deleteMovement:k}=_(),[E,m]=x.useState([]),[g,c]=x.useState(null),[t,j]=x.useState(!0),[N,y]=x.useState(null),[o,C]=x.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[r,w]=x.useState(""),[T,b]=x.useState(!1);x.useEffect(()=>{if(!s)return;j(!0);const S=Y((A,z)=>{if(z){console.error("Error en suscripciÃ³n de movimientos:",z),y("Error al cargar movimientos"),j(!1);return}m(A),y(null),j(!1)},o);return()=>S()},[s,o]),x.useEffect(()=>{s&&(async()=>{try{const A=await X(o);c(A)}catch(A){console.error("Error al cargar estadÃ­sticas:",A)}})()},[s,E,o]);const a=E.filter(S=>{if(!r)return!0;const A=r.toLowerCase();return S.fuelType?.toLowerCase().includes(A)||S.type?.toLowerCase().includes(A)||S.location?.toLowerCase().includes(A)||S.vehicleId?.toLowerCase().includes(A)||S.description?.toLowerCase().includes(A)||S.reference?.toLowerCase().includes(A)}),n=()=>{b(!0)},h=S=>{alert(`ğŸ“‹ Detalles del movimiento:

Tipo: ${S.type}
Combustible: ${S.fuelType}
Cantidad: ${S.quantity} gal
Fecha: ${new Date(S.createdAt).toLocaleDateString("es-CO")}`)},i=()=>{b(!1)},u=S=>{C(A=>({...A,...S}))},v=()=>{C({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),w("")},f=async S=>{if(window.confirm("Â¿EstÃ¡s seguro de que quieres aprobar este movimiento? Esta acciÃ³n actualizarÃ¡ el inventario."))try{await se(S),alert("Movimiento aprobado y stock actualizado.")}catch(A){console.error("Error al aprobar movimiento:",A),alert(`Error al aprobar movimiento: ${A.message}`)}},L=async S=>{if(window.confirm("Â¿EstÃ¡s seguro de que quieres rechazar este movimiento?"))try{await ee(S,{status:F.CANCELADO}),alert("Movimiento rechazado.")}catch(A){console.error("Error al rechazar movimiento:",A),alert(`Error al rechazar movimiento: ${A.message}`)}},I=async S=>{try{const A=await k(S);if(A.success)alert("Movimiento eliminado exitosamente.");else throw new Error(A.error)}catch(A){console.error("Error al eliminar movimiento:",A),alert(`Error al eliminar movimiento: ${A.message}`)}},P=p?.role==="admin"||p?.role==="contador"||p?.role==="cliente";return t?e.jsx("div",{className:"movements-main",children:e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Cargando movimientos..."})]})}):N?e.jsx("div",{className:"movements-main",children:e.jsxs("div",{className:"error-container",children:[e.jsx("div",{className:"error-icon",children:"âš ï¸"}),e.jsx("h3",{children:"Error al cargar movimientos"}),e.jsx("p",{children:N}),e.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):e.jsxs("div",{className:"movements-main",children:[e.jsxs("div",{className:"movements-header",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("h2",{children:"ğŸ“Š Movimientos de Combustibles"}),e.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),P&&e.jsx("div",{className:"create-movement-options",children:e.jsx("button",{className:"btn-create-movement primary",onClick:n,children:"â• Nuevo Movimiento"})})]}),g&&e.jsx(te,{stats:g,filters:o}),e.jsx(ie,{filters:o,onFilterChange:u,onClearFilters:v,searchTerm:r,onSearchChange:w,totalResults:a.length}),a.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ğŸ“‹"}),e.jsx("h3",{children:E.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),e.jsx("p",{children:E.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de bÃºsqueda"}),E.length===0&&P&&e.jsx("div",{className:"create-first-options",children:e.jsx("button",{className:"btn-create-first primary",onClick:n,children:"â• Crear Primer Movimiento"})})]}):e.jsx(le,{movements:a,onEdit:null,onView:h,onApprove:f,onReject:L,onDelete:I,userRole:p?.role}),T&&e.jsx(he,{isOpen:T,onClose:i,onSuccess:()=>{i()}})]})};export{ge as default};
