const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BQoCA6St.js","assets/index-DtEL_iC7.css"])))=>i.map(i=>d[i]);
import{V as w,j as e,f as X,I as L,r as v,J as re,K,L as ne,k as B,b as z,N as le,P as xe,_ as ce,i as Q,d as ie,Q as pe,T as oe,s as J,e as je,h as Ne,U as de,W as ge,X as ve,Y as se,Z as fe,$ as ae,u as be,a0 as Ce,a1 as ye,a2 as we,a3 as Ee}from"./index-BQoCA6St.js";const De=({stats:s,filters:m})=>{if(!s)return null;const l=p=>`${X(p)} gal`,o=p=>`${X(p)} hrs`,x=p=>`${p.toFixed(2)} gal/hr`,u=p=>{let g=0;for(let j=0;j<p.length;j++)g=(g<<5)-g+p.charCodeAt(j)&4294967295;const E=["#059669","#dc2626","#2563eb","#7c3aed","#ea580c","#16a34a","#ca8a04","#9333ea"];return E[Math.abs(g)%E.length]},T=p=>{if(!p)return"üöó";const g=p.toLowerCase();return g.includes("excavadora")?"üöö":g.includes("bulldozer")?"üöú":g.includes("cargador")?"üèóÔ∏è":g.includes("camion")?"üöõ":g.includes("grua")?"üèóÔ∏è":g.includes("motosierra")?"ü™ö":g.includes("tractor")?"üöú":g.includes("volqueta")?"üöõ":"üöó"},C=p=>{switch(p){case w.ACTIVO:return"#10b981";case w.MANTENIMIENTO:return"#f59e0b";case w.INACTIVO:return"#6b7280";case w.REPARACION:return"#ef4444";default:return"#6b7280"}},c=p=>{switch(p){case w.ACTIVO:return"‚úÖ";case w.MANTENIMIENTO:return"üîß";case w.INACTIVO:return"‚è∏Ô∏è";case w.REPARACION:return"üî¥";default:return"‚ùì"}},S=p=>{switch(p){case L.DIESEL:return"üöõ";case L.GASOLINA:return"üöó";case L.MIXTO:return"‚õΩ";default:return"‚õΩ"}},h=s.totalVehicles>0?((s.byStatus[w.ACTIVO]||0)/s.totalVehicles*100).toFixed(1):0;return e.jsxs("div",{className:"vehicles-stats",children:[e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card primary",children:[e.jsx("div",{className:"stat-icon",children:"üöú"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:X(s.totalVehicles)}),e.jsx("div",{className:"stat-label",children:"Total Veh√≠culos"}),e.jsx("div",{className:"stat-trend",children:e.jsxs("span",{className:`trend ${h>=80?"positive":"warning"}`,children:[h>=80?"üìà":"‚ö†Ô∏è"," ",h,"% activos"]})})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"‚õΩ"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:l(s.totalFuelConsumed)}),e.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),e.jsxs("div",{className:"stat-secondary",children:["Promedio: ",x(s.averageConsumption||0)]})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"‚è∞"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:o(s.totalHoursWorked)}),e.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),e.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(s.totalHoursWorked/(s.totalVehicles||1))]})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"üèÜ"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:s.mostActiveVehicle?s.mostActiveVehicle.vehicleId:"N/A"}),e.jsx("div",{className:"stat-label",children:"M√°s Activo"}),e.jsx("div",{className:"stat-secondary",children:s.mostActiveVehicle?`${s.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),e.jsxs("div",{className:"stats-breakdown",children:[e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"üöú Por Tipo de Veh√≠culo"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byType).map(([p,g])=>{const E=(g/s.totalVehicles*100).toFixed(1);return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:T(p)}),e.jsx("span",{className:"breakdown-label",children:p.charAt(0).toUpperCase()+p.slice(1)})]}),e.jsx("div",{className:"breakdown-value",children:g}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${E}%`,backgroundColor:u(p)}})}),e.jsxs("div",{className:"breakdown-percentage",children:[E,"%"]})]},p)})})]}),e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"‚ö° Por Estado"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byStatus).map(([p,g])=>{const E=(g/s.totalVehicles*100).toFixed(1);return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:c(p)}),e.jsx("span",{className:"breakdown-label",children:p.charAt(0).toUpperCase()+p.slice(1)})]}),e.jsx("div",{className:"breakdown-value",children:g}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${E}%`,backgroundColor:C(p)}})}),e.jsxs("div",{className:"breakdown-percentage",children:[E,"%"]})]},p)})})]}),e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{children:"‚õΩ Por Tipo de Combustible"}),e.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byFuelType).map(([p,g])=>{const E=(g/s.totalVehicles*100).toFixed(1);return e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"breakdown-header",children:[e.jsx("span",{className:"breakdown-icon",children:S(p)}),e.jsx("span",{className:"breakdown-label",children:p})]}),e.jsx("div",{className:"breakdown-value",children:g}),e.jsx("div",{className:"breakdown-bar",children:e.jsx("div",{className:"breakdown-fill",style:{width:`${E}%`,backgroundColor:"#059669"}})}),e.jsxs("div",{className:"breakdown-percentage",children:[E,"%"]})]},p)})})]})]}),(s.totalFuelConsumed>0||s.totalHoursWorked>0)&&e.jsxs("div",{className:"performance-metrics",children:[e.jsx("h4",{children:"üìä M√©tricas de Rendimiento"}),e.jsxs("div",{className:"metrics-grid",children:[e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:"‚ö°"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),e.jsxs("div",{className:"metric-value",children:[h,"%"]}),e.jsxs("div",{className:"metric-description",children:[s.byStatus[w.ACTIVO]||0," de ",s.totalVehicles," activos"]})]})]}),s.averageConsumption>0&&e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:"üìà"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),e.jsx("div",{className:"metric-value",children:x(s.averageConsumption)}),e.jsx("div",{className:"metric-description",children:"Por veh√≠culo por hora trabajada"})]})]}),s.mostActiveVehicle&&e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:"üèÜ"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("div",{className:"metric-label",children:"Mayor Utilizaci√≥n"}),e.jsx("div",{className:"metric-value",children:s.mostActiveVehicle.vehicleId}),e.jsxs("div",{className:"metric-description",children:[l(s.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),s.leastActiveVehicle&&e.jsxs("div",{className:"metric-card",children:[e.jsx("div",{className:"metric-icon",children:"üìâ"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("div",{className:"metric-label",children:"Menor Utilizaci√≥n"}),e.jsx("div",{className:"metric-value",children:s.leastActiveVehicle.vehicleId}),e.jsxs("div",{className:"metric-description",children:[l(s.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(m.type||m.status||m.fuelType||m.location)&&e.jsxs("div",{className:"active-filters",children:[e.jsx("h4",{children:"üîç Filtros Activos"}),e.jsxs("div",{className:"filters-list",children:[m.type&&e.jsxs("span",{className:"filter-tag",children:["Tipo: ",m.type]}),m.status&&e.jsxs("span",{className:"filter-tag",children:["Estado: ",m.status]}),m.fuelType&&e.jsxs("span",{className:"filter-tag",children:["Combustible: ",m.fuelType]}),m.location&&e.jsxs("span",{className:"filter-tag",children:["Ubicaci√≥n: ",m.location]})]})]})]})},Te=({filters:s,onFilterChange:m,onClearFilters:l,searchTerm:o,onSearchChange:x,viewMode:u,onViewModeChange:T,totalResults:C})=>{const[c,S]=v.useState(!1),h=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mec√°nico","Proyecto A","Proyecto B","En Reparaci√≥n","Otros"],p=Object.values(s).filter(j=>j&&j!==""&&j!=="all").length,g=(j,f)=>{m({[j]:f})},E=j=>{m(j)};return e.jsxs("div",{className:"vehicles-filters",children:[e.jsxs("div",{className:"filters-main",children:[e.jsx("div",{className:"search-section",children:e.jsxs("div",{className:"search-box",children:[e.jsx("span",{className:"search-icon",children:"üîç"}),e.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicaci√≥n...",value:o,onChange:j=>x(j.target.value),className:"search-input"}),o&&e.jsx("button",{className:"search-clear",onClick:()=>x(""),title:"Limpiar b√∫squeda",children:"‚úï"})]})}),e.jsxs("div",{className:"filters-controls",children:[e.jsxs("div",{className:"quick-filters",children:[e.jsx("button",{className:`quick-filter ${s.status==="activo"?"active":""}`,onClick:()=>E({status:"activo"}),children:"‚úÖ Activos"}),e.jsx("button",{className:`quick-filter ${s.status==="mantenimiento"?"active":""}`,onClick:()=>E({status:"mantenimiento"}),children:"üîß Mantenimiento"}),e.jsx("button",{className:`quick-filter ${s.type==="excavadora"?"active":""}`,onClick:()=>E({type:"excavadora"}),children:"üöö Excavadoras"}),e.jsx("button",{className:`quick-filter ${s.type==="tractor"?"active":""}`,onClick:()=>E({type:"tractor"}),children:"üöú Tractores"})]}),e.jsxs("button",{className:`btn-advanced-filters ${c?"active":""}`,onClick:()=>S(!c),children:["üéõÔ∏è Filtros",p>0&&e.jsx("span",{className:"filters-count",children:p})]}),e.jsxs("div",{className:"view-modes",children:[e.jsx("button",{className:`view-mode ${u==="cards"?"active":""}`,onClick:()=>T("cards"),title:"Vista en tarjetas",children:"üé¥"}),e.jsx("button",{className:`view-mode ${u==="table"?"active":""}`,onClick:()=>T("table"),title:"Vista en tabla",children:"üìã"})]})]})]}),c&&e.jsxs("div",{className:"filters-advanced",children:[e.jsxs("div",{className:"filters-grid",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Tipo de Veh√≠culo"}),e.jsxs("select",{value:s.type,onChange:j=>g("type",j.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los tipos"}),e.jsx("option",{value:"excavadora",children:"üöö Excavadora"}),e.jsx("option",{value:"bulldozer",children:"üöú Bulldozer"}),e.jsx("option",{value:"cargador",children:"üèóÔ∏è Cargador"}),e.jsx("option",{value:"camion",children:"üöõ Cami√≥n"}),e.jsx("option",{value:"grua",children:"üèóÔ∏è Gr√∫a"}),e.jsx("option",{value:"motosierra",children:"ü™ö Motosierra"}),e.jsx("option",{value:"tractor",children:"üöú Tractor"}),e.jsx("option",{value:"volqueta",children:"üöõ Volqueta"}),e.jsx("option",{value:"otros",children:"üöó Otros"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Estado"}),e.jsxs("select",{value:s.status,onChange:j=>g("status",j.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los estados"}),e.jsx("option",{value:w.ACTIVO,children:"‚úÖ Activo"}),e.jsx("option",{value:w.MANTENIMIENTO,children:"üîß Mantenimiento"}),e.jsx("option",{value:w.INACTIVO,children:"‚è∏Ô∏è Inactivo"}),e.jsx("option",{value:w.REPARACION,children:"üî¥ Reparaci√≥n"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Tipo de Combustible"}),e.jsxs("select",{value:s.fuelType,onChange:j=>g("fuelType",j.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todos los combustibles"}),e.jsx("option",{value:L.DIESEL,children:"üöõ Diesel"}),e.jsx("option",{value:L.GASOLINA,children:"üöó Gasolina"}),e.jsx("option",{value:L.MIXTO,children:"‚õΩ Mixto"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Ubicaci√≥n Actual"}),e.jsxs("select",{value:s.location,onChange:j=>g("location",j.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"Todas las ubicaciones"}),h.map(j=>e.jsxs("option",{value:j,children:["üìç ",j]},j))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Mantenimiento"}),e.jsxs("select",{value:s.maintenance,onChange:j=>g("maintenance",j.target.value),className:"filter-select",children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"due",children:"Mantenimiento debido"}),e.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),e.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),e.jsxs("div",{className:"filters-actions",children:[e.jsx("button",{className:"btn-clear-filters",onClick:l,disabled:p===0,children:"üóëÔ∏è Limpiar Filtros"}),e.jsxs("div",{className:"filters-info",children:[e.jsxs("span",{className:"results-count",children:[C," resultado",C!==1?"s":""]}),p>0&&e.jsxs("span",{className:"active-filters-text",children:["(",p," filtro",p!==1?"s":""," activo",p!==1?"s":"",")"]})]})]})]}),p>0&&e.jsx("div",{className:"active-filters-summary",children:e.jsxs("div",{className:"summary-content",children:[e.jsx("span",{className:"summary-label",children:"Filtros activos:"}),e.jsxs("div",{className:"summary-tags",children:[s.type&&e.jsxs("span",{className:"summary-tag",onClick:()=>g("type",""),children:["Tipo: ",s.type," ‚úï"]}),s.status&&e.jsxs("span",{className:"summary-tag",onClick:()=>g("status",""),children:["Estado: ",s.status," ‚úï"]}),s.fuelType&&e.jsxs("span",{className:"summary-tag",onClick:()=>g("fuelType",""),children:["Combustible: ",s.fuelType," ‚úï"]}),s.location&&e.jsxs("span",{className:"summary-tag",onClick:()=>g("location",""),children:["Ubicaci√≥n: ",s.location," ‚úï"]}),s.maintenance!=="all"&&e.jsxs("span",{className:"summary-tag",onClick:()=>g("maintenance","all"),children:["Mantenimiento: ",s.maintenance," ‚úï"]})]})]})}),e.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:e.jsx("small",{children:"üí° Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},Ae=({vehicles:s,onEdit:m,onView:l,onMaintenance:o})=>{const x=a=>new Intl.NumberFormat("es-CO").format(a),u=a=>`${x(a)} gal`,T=a=>`${x(a)} hrs`,C=a=>a?(a instanceof Date?a:new Date(a)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",c=a=>{if(!a)return"";const y=new Date,d=a instanceof Date?a:new Date(a),F=Math.abs(y-d),D=Math.ceil(F/(1e3*60*60*24));return D===1?"hace 1 d√≠a":D<7?`hace ${D} d√≠as`:D<30?`hace ${Math.ceil(D/7)} semanas`:D<365?`hace ${Math.ceil(D/30)} meses`:`hace ${Math.ceil(D/365)} a√±os`},S=a=>{if(!a)return"vehicle-default";const y=a.toLowerCase();return y.includes("excavadora")?"vehicle-excavadora":y.includes("bulldozer")?"vehicle-bulldozer":y.includes("cargador")?"vehicle-cargador":y.includes("camion")?"vehicle-camion":y.includes("grua")?"vehicle-grua":y.includes("motosierra")?"vehicle-motosierra":y.includes("tractor")?"vehicle-tractor":y.includes("volqueta")?"vehicle-volqueta":"vehicle-default"},h=a=>{switch(a){case w.ACTIVO:return"status-activo";case w.MANTENIMIENTO:return"status-mantenimiento";case w.INACTIVO:return"status-inactivo";case w.REPARACION:return"status-reparacion";default:return"status-default"}},p=a=>{if(!a)return"üöó";const y=a.toLowerCase();return y.includes("excavadora")?"üöö":y.includes("bulldozer")?"üöú":y.includes("cargador")?"üèóÔ∏è":y.includes("camion")?"üöõ":y.includes("grua")?"üèóÔ∏è":y.includes("motosierra")?"ü™ö":y.includes("tractor")?"üöú":y.includes("volqueta")?"üöõ":"üöó"},g=a=>{switch(a){case L.DIESEL:return"üöõ";case L.GASOLINA:return"üöó";case L.MIXTO:return"‚õΩ";default:return"‚õΩ"}},E=a=>{switch(a){case w.ACTIVO:return"‚úÖ";case w.MANTENIMIENTO:return"üîß";case w.INACTIVO:return"‚è∏Ô∏è";case w.REPARACION:return"üî¥";default:return"‚ùì"}},j=a=>!a.totalHoursWorked||a.totalHoursWorked===0?a.estimatedConsumptionPerHour||0:a.totalFuelConsumed/a.totalHoursWorked,f=a=>a.lastMaintenanceDate?Math.floor((new Date-new Date(a.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return e.jsx("div",{className:"vehicles-cards",children:s.map(a=>e.jsxs("div",{className:`vehicle-card ${S(a.type)}`,children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"vehicle-info",children:[e.jsxs("div",{className:"vehicle-id-section",children:[e.jsx("span",{className:"vehicle-icon",children:p(a.type)}),e.jsxs("div",{className:"vehicle-details",children:[e.jsx("span",{className:"vehicle-id",children:a.vehicleId}),e.jsx("span",{className:"vehicle-name",children:a.name})]})]}),e.jsxs("div",{className:`status-badge ${h(a.status)}`,children:[e.jsx("span",{className:"status-icon",children:E(a.status)}),e.jsx("span",{className:"status-label",children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})]})]})}),e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"basic-info",children:[e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Tipo:"}),e.jsxs("span",{className:"info-value",children:[p(a.type)," ",a.type.charAt(0).toUpperCase()+a.type.slice(1)]})]}),a.brand&&a.model&&e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),e.jsxs("span",{className:"info-value",children:[a.brand," ",a.model]})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Combustible:"}),e.jsxs("span",{className:"info-value",children:[g(a.fuelType)," ",a.fuelType]})]}),a.currentLocation&&e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Ubicaci√≥n:"}),e.jsxs("span",{className:"info-value",children:["üìç ",a.currentLocation]})]})]}),e.jsxs("div",{className:"consumption-metrics",children:[e.jsxs("div",{className:"metric-item",children:[e.jsx("div",{className:"metric-icon",children:"‚õΩ"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("div",{className:"metric-value",children:u(a.totalFuelConsumed||0)}),e.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),e.jsxs("div",{className:"metric-item",children:[e.jsx("div",{className:"metric-icon",children:"‚è∞"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("div",{className:"metric-value",children:T(a.totalHoursWorked||0)}),e.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),e.jsxs("div",{className:"metric-item",children:[e.jsx("div",{className:"metric-icon",children:"üìä"}),e.jsxs("div",{className:"metric-content",children:[e.jsxs("div",{className:"metric-value",children:[j(a).toFixed(1)," gal/hr"]}),e.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),e.jsxs("div",{className:"metric-item",children:[e.jsx("div",{className:"metric-icon",children:"üîÑ"}),e.jsxs("div",{className:"metric-content",children:[e.jsx("div",{className:"metric-value",children:a.totalMovements||0}),e.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(a.enginePower||a.fuelCapacity||a.year)&&e.jsxs("div",{className:"technical-specs",children:[a.enginePower&&e.jsxs("div",{className:"spec-item",children:[e.jsx("span",{className:"spec-icon",children:"‚ö°"}),e.jsxs("span",{className:"spec-value",children:[a.enginePower," HP"]})]}),a.fuelCapacity&&e.jsxs("div",{className:"spec-item",children:[e.jsx("span",{className:"spec-icon",children:"üõ¢Ô∏è"}),e.jsxs("span",{className:"spec-value",children:[a.fuelCapacity," gal"]})]}),a.year&&e.jsxs("div",{className:"spec-item",children:[e.jsx("span",{className:"spec-icon",children:"üìÖ"}),e.jsx("span",{className:"spec-value",children:a.year})]})]}),a.description&&e.jsx("div",{className:"description",children:e.jsx("p",{children:a.description})})]}),e.jsxs("div",{className:"card-footer",children:[e.jsxs("div",{className:"date-info",children:[a.lastMovementDate&&e.jsxs("div",{className:"date-item",children:[e.jsx("span",{className:"date-label",children:"√öltimo movimiento:"}),e.jsx("span",{className:"date-value",children:C(a.lastMovementDate)}),e.jsx("span",{className:"date-relative",children:c(a.lastMovementDate)})]}),a.lastMaintenanceDate&&e.jsxs("div",{className:"date-item",children:[e.jsx("span",{className:"date-label",children:"√öltimo mantenimiento:"}),e.jsx("span",{className:"date-value",children:C(a.lastMaintenanceDate)}),e.jsx("span",{className:"date-relative",children:c(a.lastMaintenanceDate)})]})]}),e.jsxs("div",{className:"card-actions",children:[e.jsx("button",{className:"btn-view",onClick:()=>l(a),title:"Ver detalles",children:"üëÅÔ∏è"}),m&&a.status!==w.REPARACION&&e.jsx("button",{className:"btn-edit",onClick:()=>m(a),title:"Editar veh√≠culo",children:"‚úèÔ∏è"}),o&&e.jsx("button",{className:"btn-maintenance",onClick:()=>o(a),title:"Registrar mantenimiento",children:"üîß"})]})]}),a.status===w.MANTENIMIENTO&&e.jsx("div",{className:"maintenance-indicator",children:e.jsx("div",{className:"maintenance-pulse"})}),f(a)&&a.status===w.ACTIVO&&e.jsx("div",{className:"maintenance-due-badge",children:e.jsx("span",{children:"Mantenimiento Debido"})}),a.status===w.REPARACION&&e.jsx("div",{className:"repair-badge",children:e.jsx("span",{children:"En Reparaci√≥n"})}),a.totalHoursWorked>0&&e.jsxs("div",{className:"efficiency-indicator",children:[e.jsx("div",{className:"efficiency-bar",children:e.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(a.totalHoursWorked/2e3*100,100)}%`}})}),e.jsxs("span",{className:"efficiency-label",children:[(a.totalHoursWorked/2e3*100).toFixed(1),"% utilizaci√≥n anual"]})]})]},a.id))})},Ie=({vehicles:s,onEdit:m,onView:l,onMaintenance:o})=>{const[x,u]=v.useState("vehicleId"),[T,C]=v.useState("asc"),c=i=>new Intl.NumberFormat("es-CO").format(i),S=i=>`${c(i)} gal`,h=i=>`${c(i)} hrs`,p=i=>i?(i instanceof Date?i:new Date(i)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",g=i=>{if(!i)return"üöó";const A=i.toLowerCase();return A.includes("excavadora")?"üöö":A.includes("bulldozer")?"üöú":A.includes("cargador")?"üèóÔ∏è":A.includes("camion")?"üöõ":A.includes("grua")?"üèóÔ∏è":A.includes("motosierra")?"ü™ö":A.includes("tractor")?"üöú":A.includes("volqueta")?"üöõ":"üöó"},E=i=>{switch(i){case L.DIESEL:return"üöõ";case L.GASOLINA:return"üöó";case L.MIXTO:return"‚õΩ";default:return"‚õΩ"}},j=i=>{switch(i){case w.ACTIVO:return"‚úÖ";case w.MANTENIMIENTO:return"üîß";case w.INACTIVO:return"‚è∏Ô∏è";case w.REPARACION:return"üî¥";default:return"‚ùì"}},f=i=>{switch(i){case w.ACTIVO:return"status-activo";case w.MANTENIMIENTO:return"status-mantenimiento";case w.INACTIVO:return"status-inactivo";case w.REPARACION:return"status-reparacion";default:return"status-default"}},a=i=>{x===i?C(T==="asc"?"desc":"asc"):(u(i),C("asc"))},y=[...s].sort((i,A)=>{let M=i[x],k=A[x];return(x.includes("Date")||x.includes("At"))&&(M=new Date(M||0),k=new Date(k||0)),typeof M=="number"&&typeof k=="number"?T==="asc"?M-k:k-M:typeof M=="string"&&typeof k=="string"?T==="asc"?M.localeCompare(k):k.localeCompare(M):M instanceof Date&&k instanceof Date?T==="asc"?M-k:k-M:!M&&!k?0:M?k?0:T==="asc"?-1:1:T==="asc"?1:-1}),d=i=>x!==i?"‚ÜïÔ∏è":T==="asc"?"‚Üë":"‚Üì",F=i=>!i.totalHoursWorked||i.totalHoursWorked===0?i.estimatedConsumptionPerHour||0:i.totalFuelConsumed/i.totalHoursWorked,D=i=>i.lastMaintenanceDate?Math.floor((new Date-new Date(i.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return e.jsxs("div",{className:"vehicles-table-container",children:[e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"vehicles-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"sortable",onClick:()=>a("vehicleId"),children:["ID Veh√≠culo ",d("vehicleId")]}),e.jsxs("th",{className:"sortable",onClick:()=>a("name"),children:["Nombre ",d("name")]}),e.jsxs("th",{className:"sortable",onClick:()=>a("type"),children:["Tipo ",d("type")]}),e.jsx("th",{children:"Marca/Modelo"}),e.jsxs("th",{className:"sortable",onClick:()=>a("fuelType"),children:["Combustible ",d("fuelType")]}),e.jsxs("th",{className:"sortable text-right",onClick:()=>a("totalFuelConsumed"),children:["Consumido ",d("totalFuelConsumed")]}),e.jsxs("th",{className:"sortable text-right",onClick:()=>a("totalHoursWorked"),children:["Horas ",d("totalHoursWorked")]}),e.jsx("th",{className:"text-right",children:"Consumo/Hr"}),e.jsx("th",{children:"Ubicaci√≥n"}),e.jsxs("th",{className:"sortable",onClick:()=>a("status"),children:["Estado ",d("status")]}),e.jsxs("th",{className:"sortable",onClick:()=>a("lastMovementDate"),children:["√öltimo Mov. ",d("lastMovementDate")]}),e.jsx("th",{className:"actions-column",children:"Acciones"})]})}),e.jsx("tbody",{children:y.map(i=>e.jsxs("tr",{className:`vehicle-row ${i.status===w.MANTENIMIENTO?"maintenance-row":""} ${D(i)?"needs-maintenance":""}`,children:[e.jsx("td",{className:"vehicle-id-cell",children:e.jsxs("div",{className:"id-content",children:[e.jsx("span",{className:"vehicle-icon",children:g(i.type)}),e.jsx("span",{className:"vehicle-id",children:i.vehicleId})]})}),e.jsx("td",{className:"name-cell",children:e.jsx("span",{className:"vehicle-name",children:i.name})}),e.jsx("td",{className:"type-cell",children:e.jsx("span",{className:"type-text",children:i.type.charAt(0).toUpperCase()+i.type.slice(1)})}),e.jsx("td",{className:"brand-model-cell",children:i.brand&&i.model?e.jsxs("span",{className:"brand-model",children:[i.brand," ",i.model]}):e.jsx("span",{className:"no-data",children:"-"})}),e.jsx("td",{className:"fuel-cell",children:e.jsxs("div",{className:"fuel-content",children:[e.jsx("span",{className:"fuel-icon",children:E(i.fuelType)}),e.jsx("span",{className:"fuel-text",children:i.fuelType})]})}),e.jsx("td",{className:"consumption-cell text-right",children:e.jsx("span",{className:"consumption-value",children:S(i.totalFuelConsumed||0)})}),e.jsx("td",{className:"hours-cell text-right",children:e.jsx("span",{className:"hours-value",children:h(i.totalHoursWorked||0)})}),e.jsx("td",{className:"rate-cell text-right",children:e.jsxs("span",{className:"rate-value",children:[F(i).toFixed(1)," gal/hr"]})}),e.jsx("td",{className:"location-cell",children:e.jsxs("span",{className:"location-text",children:["üìç ",i.currentLocation||"Sin ubicaci√≥n"]})}),e.jsx("td",{className:"status-cell",children:e.jsxs("div",{className:`status-badge ${f(i.status)}`,children:[e.jsx("span",{className:"status-icon",children:j(i.status)}),e.jsx("span",{className:"status-text",children:i.status.charAt(0).toUpperCase()+i.status.slice(1)})]})}),e.jsx("td",{className:"date-cell",children:e.jsxs("div",{className:"date-content",children:[e.jsx("span",{className:"date-value",children:p(i.lastMovementDate)}),D(i)&&e.jsx("span",{className:"maintenance-warning",children:"‚ö†Ô∏è"})]})}),e.jsx("td",{className:"actions-cell",children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn-action btn-view",onClick:()=>l(i),title:"Ver detalles",children:"üëÅÔ∏è"}),m&&i.status!==w.REPARACION&&e.jsx("button",{className:"btn-action btn-edit",onClick:()=>m(i),title:"Editar veh√≠culo",children:"‚úèÔ∏è"}),o&&e.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>o(i),title:"Registrar mantenimiento",children:"üîß"})]})})]},i.id))})]})}),e.jsxs("div",{className:"table-info",children:[e.jsxs("div",{className:"table-summary",children:[e.jsxs("span",{className:"total-rows",children:[s.length," veh√≠culo",s.length!==1?"s":""]}),x&&e.jsxs("span",{className:"sort-info",children:["Ordenado por ",x," (",T==="asc"?"ascendente":"descendente",")"]})]}),e.jsxs("div",{className:"table-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"‚úÖ"})," Activo"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"üîß"})," Mantenimiento"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"‚è∏Ô∏è"})," Inactivo"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"üî¥"})," Reparaci√≥n"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-icon",children:"‚ö†Ô∏è"})," Mantto. Debido"]})]})]})]})},Me=({vehicles:s,viewMode:m,onEdit:l,onView:o,onMaintenance:x})=>m==="table"?e.jsx(Ie,{vehicles:s,onEdit:l,onView:o,onMaintenance:x}):e.jsx(Ae,{vehicles:s,onEdit:l,onView:o,onMaintenance:x}),Y="combustibles_vehicle_categories",Se=async s=>{try{const m=oe(s);if(!m.isValid)throw new Error(`Datos inv√°lidos: ${m.errors.join(", ")}`);const l=await me();if(l.some(T=>T.id===s.id||T.name.toLowerCase()===s.name.toLowerCase()))throw new Error("Ya existe una categor√≠a con ese nombre o ID");s.id||(s.id=de(s.name,l));const x={...s,createdAt:J(),updatedAt:J(),isCustom:!0,vehicleCount:0},u=await ge(B(z,Y),x);return console.log("‚úÖ Categor√≠a creada:",s.name),{id:u.id,...x,createdAt:new Date,updatedAt:new Date}}catch(m){throw console.error("‚ùå Error al crear categor√≠a:",m),new Error(`Error al crear categor√≠a: ${m.message}`)}},me=async()=>{try{const s=ne(B(z,Y),le("name","asc")),m=await Q(s),l=[];return m.forEach(o=>{l.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt})}),l}catch(s){throw console.error("‚ùå Error al obtener categor√≠as personalizadas:",s),new Error(`Error al obtener categor√≠as: ${s.message}`)}},Z=async()=>{try{const s=await me();return re(s)}catch(s){return console.error("‚ùå Error al obtener todas las categor√≠as:",s),K}},ke=async(s,m)=>{try{if(!s)throw new Error("ID de categor√≠a requerido");if(m.name||m.fuelTypes||m.fields){const u=oe({...m,id:s});if(!u.isValid)throw new Error(`Datos inv√°lidos: ${u.errors.join(", ")}`)}const l={...m,updatedAt:J()},o=ie(z,Y,s);await je(o,l),console.log("‚úÖ Categor√≠a actualizada:",s);const x=await Ne(o);return{id:x.id,...x.data(),createdAt:x.data().createdAt?.toDate?.()||x.data().createdAt,updatedAt:x.data().updatedAt?.toDate?.()||x.data().updatedAt}}catch(l){throw console.error("‚ùå Error al actualizar categor√≠a:",l),new Error(`Error al actualizar categor√≠a: ${l.message}`)}},Oe=async s=>{try{if(!s)throw new Error("ID de categor√≠a requerido");const{countVehiclesByCategory:m}=await ce(async()=>{const{countVehiclesByCategory:x}=await import("./index-BQoCA6St.js").then(u=>u.as);return{countVehiclesByCategory:x}},__vite__mapDeps([0,1])),l=await m(s);if(l>0)throw new Error(`No se puede eliminar la categor√≠a porque tiene ${l} veh√≠culo(s) asignado(s)`);const o=ie(z,Y,s);return await pe(o),console.log("‚úÖ Categor√≠a eliminada:",s),!0}catch(m){throw console.error("‚ùå Error al eliminar categor√≠a:",m),new Error(`Error al eliminar categor√≠a: ${m.message}`)}},Ve=s=>{try{const m=ne(B(z,Y),le("name","asc"));return xe(m,l=>{const o=[];l.forEach(u=>{o.push({id:u.id,...u.data(),createdAt:u.data().createdAt?.toDate?.()||u.data().createdAt,updatedAt:u.data().updatedAt?.toDate?.()||u.data().updatedAt})});const x=re(o);s(x)},l=>{console.error("‚ùå Error en suscripci√≥n a categor√≠as:",l),s(K)})}catch(m){return console.error("‚ùå Error al suscribirse a categor√≠as:",m),s(K),()=>{}}},te=async()=>{try{const{getAllVehicles:s}=await ce(async()=>{const{getAllVehicles:o}=await import("./index-BQoCA6St.js").then(x=>x.as);return{getAllVehicles:o}},__vite__mapDeps([0,1])),m=await s();return(await Z()).map(o=>{const x=m.filter(u=>u.category===o.id);return{...o,vehicleCount:x.length,activeVehicles:x.filter(u=>u.status==="activo").length,totalFuelCapacity:x.reduce((u,T)=>u+(T.fuelCapacity||0),0),avgEnginepower:x.length>0?x.reduce((u,T)=>u+(T.enginePower||0),0)/x.length:0}}).sort((o,x)=>x.vehicleCount-o.vehicleCount)}catch(s){return console.error("‚ùå Error al obtener estad√≠sticas de categor√≠as:",s),[]}},ue="combustibles_vehicle_categories",Fe=async()=>{try{console.log("üîÑ Iniciando reset completo de categor√≠as de veh√≠culos...");const s=await Q(B(z,ue));if(s.empty)return console.log("‚ÑπÔ∏è No hay categor√≠as para eliminar"),{success:!0,deletedCount:0,message:"No hab√≠a categor√≠as para eliminar"};const m=ve(z);return s.docs.forEach(l=>{m.delete(l.ref)}),await m.commit(),console.log(`‚úÖ Eliminadas ${s.size} categor√≠as`),{success:!0,deletedCount:s.size,message:`Se eliminaron ${s.size} categor√≠as`}}catch(s){throw console.error("‚ùå Error reseteando categor√≠as de veh√≠culos:",s),new Error("Error al resetear categor√≠as de veh√≠culos: "+s.message)}},Pe=async()=>{try{return!(await Q(B(z,ue))).empty}catch(s){return console.error("Error verificando categor√≠as:",s),!1}},he=({onClose:s,onCategoryCreated:m})=>{const[l,o]=v.useState([]),[x,u]=v.useState([]),[T,C]=v.useState(!0),[c,S]=v.useState(!1),[h,p]=v.useState(null),[g,E]=v.useState(!1),[j,f]=v.useState(""),[a,y]=v.useState(!1),[d,F]=v.useState(!1),[D,i]=v.useState({name:"",description:"",icon:"üöó",color:"#2E86AB",fuelTypes:[],fields:[]});v.useEffect(()=>{A(),k();const n=Ve(b=>{o(b),M(),k()});return()=>n&&n()},[]);const A=async()=>{try{C(!0);const[n,b]=await Promise.all([Z(),te()]);o(n),u(b)}catch(n){console.error("Error cargando categor√≠as:",n),f("Error al cargar categor√≠as")}finally{C(!1)}},M=async()=>{try{const n=await te();u(n)}catch(n){console.error("Error cargando estad√≠sticas:",n)}},k=async()=>{try{const n=await Pe();F(n)}catch(n){console.error("Error verificando categor√≠as personalizadas:",n)}},$=()=>{p(null),i({name:"",description:"",icon:"üöó",color:"#2E86AB",fuelTypes:[],fields:[]}),E(!0)},I=n=>{p(n),i({name:n.name||"",description:n.description||"",icon:n.icon||"üöó",color:n.color||"#2E86AB",fuelTypes:n.fuelTypes||[],fields:n.fields||[]}),E(!0)},t=async n=>{if(window.confirm(`¬øEst√° seguro de eliminar la categor√≠a "${n.name}"?

Esta acci√≥n no se puede deshacer.`))try{S(!0),await Oe(n.id),f("")}catch(P){console.error("Error eliminando categor√≠a:",P),f(P.message)}finally{S(!1)}},r=async n=>{if(n.preventDefault(),!D.name.trim()){f("El nombre de la categor√≠a es requerido");return}try{S(!0),f("");const b={...D,name:D.name.trim(),description:D.description.trim()};if(h)await ke(h.id,b);else{b.id=de(b.name,l);const P=await Se(b);m&&m(P)}E(!1)}catch(b){console.error("Error guardando categor√≠a:",b),f(b.message)}finally{S(!1)}},N=n=>{i(b=>({...b,fields:b.fields.includes(n)?b.fields.filter(P=>P!==n):[...b.fields,n]}))},V=n=>{i(b=>({...b,fuelTypes:b.fuelTypes.includes(n)?b.fuelTypes.filter(P=>P!==n):[...b.fuelTypes,n]}))},R=async()=>{try{S(!0),f("");const n=await Fe();n.success?(y(!1),f(""),alert(`‚úÖ ${n.message}`)):f("Error al resetear categor√≠as")}catch(n){console.error("Error reseteando categor√≠as:",n),f(n.message)}finally{S(!1)}},q=n=>x.find(b=>b.id===n)||{vehicleCount:0,activeVehicles:0};return T?e.jsx("div",{className:"categories-manager",children:e.jsxs("div",{className:"loading",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Cargando categor√≠as..."})]})}):e.jsxs("div",{className:"categories-manager",children:[e.jsxs("div",{className:"categories-header",children:[e.jsx("h3",{children:"üìã Gesti√≥n de Categor√≠as"}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{className:"btn-primary",onClick:$,disabled:c,children:"‚ûï Nueva Categor√≠a"}),d&&e.jsx("button",{className:"btn-warning",onClick:()=>y(!0),disabled:c,children:"üóëÔ∏è Eliminar Todas"}),e.jsx("button",{className:"btn-secondary",onClick:s,children:"‚úï Cerrar"})]})]}),j&&e.jsxs("div",{className:"error-message",children:[e.jsxs("span",{children:["‚ö†Ô∏è ",j]}),e.jsx("button",{onClick:()=>f(""),children:"‚úï"})]}),e.jsx("div",{className:"categories-grid",children:l.map(n=>{const b=q(n.id);return e.jsxs("div",{className:"category-card custom",style:{"--category-color":n.color},children:[e.jsxs("div",{className:"category-header",children:[e.jsx("div",{className:"category-icon",style:{color:n.color},children:n.icon}),e.jsxs("div",{className:"category-info",children:[e.jsx("h4",{children:n.name}),e.jsx("p",{children:n.description})]})]}),e.jsxs("div",{className:"category-stats",children:[e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-value",children:b.vehicleCount}),e.jsx("span",{className:"stat-label",children:"Veh√≠culos"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-value",children:b.activeVehicles}),e.jsx("span",{className:"stat-label",children:"Activos"})]})]}),e.jsxs("div",{className:"category-details",children:[e.jsxs("div",{className:"fuel-types",children:[e.jsx("strong",{children:"Combustibles:"}),e.jsx("div",{className:"fuel-list",children:(n.fuelTypes||[]).map(P=>e.jsx("span",{className:"fuel-tag",children:P},P))})]}),e.jsxs("div",{className:"fields",children:[e.jsx("strong",{children:"Campos:"}),e.jsxs("div",{className:"fields-list",children:[(n.fields||[]).slice(0,3).map(P=>{const G=se.find(O=>O.key===P);return G?e.jsxs("span",{className:"field-tag",children:[G.icon," ",G.label]},P):null}),(n.fields||[]).length>3&&e.jsxs("span",{className:"more-fields",children:["+",(n.fields||[]).length-3," m√°s"]})]})]})]}),e.jsxs("div",{className:"category-actions",children:[e.jsx("button",{className:"btn-edit",onClick:()=>I(n),disabled:c,title:"Editar categor√≠a",children:"‚úèÔ∏è Editar"}),e.jsx("button",{className:"btn-delete",onClick:()=>t(n),disabled:c||b.vehicleCount>0,title:b.vehicleCount>0?"No se puede eliminar una categor√≠a con veh√≠culos asignados":"Eliminar categor√≠a",children:"üóëÔ∏è Eliminar"})]})]},n.id)})}),g&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:h?"‚úèÔ∏è Editar Categor√≠a":"‚ûï Nueva Categor√≠a"}),e.jsx("button",{onClick:()=>E(!1),children:"‚úï"})]}),e.jsxs("form",{onSubmit:r,className:"category-form",children:[e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{children:"Informaci√≥n B√°sica"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nombre *"}),e.jsx("input",{type:"text",value:D.name,onChange:n=>i(b=>({...b,name:n.target.value})),placeholder:"Ej: Maquinaria Pesada",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Descripci√≥n"}),e.jsx("textarea",{value:D.description,onChange:n=>i(b=>({...b,description:n.target.value})),placeholder:"Describe el tipo de veh√≠culos que incluye esta categor√≠a",rows:"2"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Icono"}),e.jsx("input",{type:"text",value:D.icon,onChange:n=>i(b=>({...b,icon:n.target.value})),placeholder:"üöó",className:"icon-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Color"}),e.jsx("input",{type:"color",value:D.color,onChange:n=>i(b=>({...b,color:n.target.value})),className:"color-input"})]})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{children:"Tipos de Combustible Compatibles"}),e.jsx("div",{className:"fuel-types-grid",children:Object.values(fe).map(n=>e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:D.fuelTypes.includes(n),onChange:()=>V(n)}),e.jsx("span",{children:n})]},n))})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{children:"Campos Espec√≠ficos"}),e.jsx("p",{className:"section-description",children:"Selecciona los campos que ser√°n relevantes para esta categor√≠a"}),e.jsx("div",{className:"fields-grid",children:se.map(n=>e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:D.fields.includes(n.key),onChange:()=>N(n.key)}),e.jsxs("span",{children:[n.icon," ",n.label]})]},n.key))})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{children:"Vista Previa"}),e.jsx("div",{className:"category-preview",style:{"--category-color":D.color},children:e.jsxs("div",{className:"category-header",children:[e.jsx("div",{className:"category-icon",style:{color:D.color},children:D.icon}),e.jsxs("div",{className:"category-info",children:[e.jsx("h4",{children:D.name||"Nombre de la categor√≠a"}),e.jsx("p",{children:D.description||"Descripci√≥n de la categor√≠a"})]})]})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>E(!1),disabled:c,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:c||!D.name.trim(),children:c?"Guardando...":h?"Actualizar":"Crear"})]})]})]})}),a&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"üóëÔ∏è Confirmar Eliminaci√≥n"}),e.jsx("button",{onClick:()=>y(!1),children:"‚úï"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{children:e.jsx("strong",{children:"¬øEst√°s seguro de que deseas eliminar todas las categor√≠as?"})}),e.jsx("p",{children:"Esta acci√≥n eliminar√° todas las categor√≠as de veh√≠culos de la aplicaci√≥n."}),e.jsx("p",{className:"warning",children:"‚ö†Ô∏è Esta acci√≥n no se puede deshacer."})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"btn-secondary",onClick:()=>y(!1),disabled:c,children:"Cancelar"}),e.jsx("button",{className:"btn-danger",onClick:R,disabled:c,children:c?"Eliminando...":"Eliminar Todas"})]})]})})]})},Le=({isOpen:s,onClose:m,vehicle:l,onSave:o,mode:x="create"})=>{const[u,T]=v.useState([]),[C,c]=v.useState(null),[S,h]=v.useState(!1),[p,g]=v.useState(!1),[E,j]=v.useState(!1),[f,a]=v.useState({}),y=v.useCallback(()=>({vehicleId:l?.vehicleId||"",name:l?.name||"",category:l?.category||"",brand:l?.brand||"",model:l?.model||"",year:l?.year||new Date().getFullYear(),fuelType:l?.fuelType||L.DIESEL,status:l?.status||w.ACTIVO,currentLocation:l?.currentLocation||"",description:l?.description||"",plateNumber:l?.plateNumber||"",enginePower:l?.enginePower||"",fuelCapacity:l?.fuelCapacity||"",operatingWeight:l?.operatingWeight||"",loadCapacity:l?.loadCapacity||"",bucketCapacity:l?.bucketCapacity||"",hasHourMeter:l?.hasHourMeter||!1,currentHours:l?.currentHours||"",implementType:l?.implementType||"",flow:l?.flow||"",pressure:l?.pressure||"",weight:l?.weight||"",lastMaintenanceDate:l?.lastMaintenanceDate?new Date(l.lastMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:l?.purchaseDate?new Date(l.purchaseDate).toISOString().split("T")[0]:""}),[l]),[d,F]=v.useState(y()),D=v.useCallback(async()=>{try{j(!0);const t=await Z();if(T(t),x==="create"&&t.length>0){const r=t[0];c(r),F(N=>({...N,category:r.id}))}}catch(t){console.error("Error cargando categor√≠as:",t)}finally{j(!1)}},[x]);v.useEffect(()=>(s?(D(),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s,D]),v.useEffect(()=>{if(l&&u.length>0){const t=ae(l.category,u);c(t),F(y())}},[l,u,y]);const i=t=>{const r=ae(t,u);c(r),F(N=>{const V=x==="create"&&N.name&&r?M(N.name,r):N.vehicleId;return{...N,category:t,vehicleId:V,fuelType:r?.fuelTypes?.includes(N.fuelType)?N.fuelType:r?.fuelTypes?.[0]||L.DIESEL}}),a({})},A=(t,r)=>{if(F(N=>({...N,[t]:r})),f[t]&&a(N=>({...N,[t]:null})),t==="name"&&x==="create"){const N=M(r,C);F(V=>({...V,vehicleId:N}))}if(t==="category"&&x==="create"&&d.name){const N=C;if(N){const V=M(d.name,N);F(R=>({...R,vehicleId:V}))}}},M=(t,r)=>{if(!t||!r)return"";const N=r.name.split(" ").map(n=>n.charAt(0).toUpperCase()).join("").substring(0,3),V=t.replace(/[^a-zA-Z0-9]/g,"").substring(0,4).toUpperCase(),q=Date.now().toString().slice(-3);return`${N}${V}${q}`},k=()=>{const t={};return d.vehicleId?.trim()||(t.vehicleId="C√≥digo del veh√≠culo es requerido"),d.name?.trim()||(t.name="Nombre del veh√≠culo es requerido"),d.category||(t.category="Categor√≠a es requerida"),d.fuelType||(t.fuelType="Tipo de combustible es requerido"),C&&d.fuelType&&(C.fuelTypes?.includes(d.fuelType)||(t.fuelType=`Este combustible no es compatible con la categor√≠a ${C.name}`)),["enginePower","fuelCapacity","operatingWeight","loadCapacity","bucketCapacity","flow","pressure","weight"].forEach(N=>{d[N]&&(isNaN(d[N])||Number(d[N])<0)&&(t[N]="Debe ser un n√∫mero v√°lido mayor o igual a 0")}),d.year&&(d.year<1900||d.year>new Date().getFullYear()+1)&&(t.year=`A√±o debe estar entre 1900 y ${new Date().getFullYear()+1}`),d.hasHourMeter&&d.currentHours&&(isNaN(d.currentHours)||Number(d.currentHours)<0)&&(t.currentHours="Horas actuales debe ser un n√∫mero v√°lido mayor o igual a 0"),a(t),Object.keys(t).length===0},$=async t=>{if(t.preventDefault(),!!k())try{j(!0);const r={...d,type:C?.name||d.category||"Otro",enginePower:d.enginePower?Number(d.enginePower):null,fuelCapacity:d.fuelCapacity?Number(d.fuelCapacity):null,operatingWeight:d.operatingWeight?Number(d.operatingWeight):null,loadCapacity:d.loadCapacity?Number(d.loadCapacity):null,bucketCapacity:d.bucketCapacity?Number(d.bucketCapacity):null,currentHours:d.currentHours?Number(d.currentHours):null,flow:d.flow?Number(d.flow):null,pressure:d.pressure?Number(d.pressure):null,weight:d.weight?Number(d.weight):null,year:Number(d.year),lastMaintenanceDate:d.lastMaintenanceDate?new Date(d.lastMaintenanceDate):null,purchaseDate:d.purchaseDate?new Date(d.purchaseDate):null,categoryName:C?.name,categoryIcon:C?.icon,categoryColor:C?.color};await o(r),m()}catch(r){console.error("Error guardando veh√≠culo:",r),a({submit:r.message})}finally{j(!1)}},I=()=>C?C.fuelTypes||Object.values(L):Object.values(L);return s?e.jsxs("div",{className:"modal-overlay",children:[e.jsxs("div",{className:"modal-container",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:x==="create"?"üöó Nuevo Veh√≠culo":"‚úèÔ∏è Editar Veh√≠culo"}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>h(!0),disabled:E,children:"üìã Gestionar Categor√≠as"}),e.jsx("button",{type:"button",className:"btn-close",onClick:m,children:"‚úï"})]})]}),e.jsxs("form",{onSubmit:$,className:"modal-body",children:[f.submit&&e.jsxs("div",{className:"error-banner",children:["‚ö†Ô∏è ",f.submit]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"üìÇ Categor√≠a del Veh√≠culo"}),E?e.jsxs("div",{className:"loading-categories",children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Cargando categor√≠as..."})]}):e.jsxs("div",{className:"categories-selector",children:[e.jsxs("select",{value:d.category,onChange:t=>i(t.target.value),className:`category-select ${f.category?"error":""}`,children:[e.jsx("option",{value:"",children:"Seleccionar categor√≠a del veh√≠culo..."}),u.map(t=>e.jsxs("option",{value:t.id,children:[t.icon," ",t.name,K.some(r=>r.id===t.id)&&" (Predeterminada)"]},t.id))]}),C&&e.jsx(Re,{category:C,isExpanded:p,onToggle:()=>g(!p)})]}),f.category&&e.jsx("span",{className:"field-error",children:f.category})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"üìù Informaci√≥n B√°sica"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"vehicleId",className:"form-label",children:"üè∑Ô∏è C√≥digo del Veh√≠culo *"}),e.jsx("input",{type:"text",id:"vehicleId",value:d.vehicleId,className:`form-input ${f.vehicleId?"error":""} ${x==="create"?"readonly":""}`,placeholder:"Se genera autom√°ticamente",readOnly:x==="create",onChange:x==="edit"?t=>A("vehicleId",t.target.value):void 0,required:!0}),f.vehicleId&&e.jsx("span",{className:"field-error",children:f.vehicleId})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",className:"form-label",children:"üìõ Nombre del Veh√≠culo *"}),e.jsx("input",{type:"text",id:"name",value:d.name,onChange:t=>A("name",t.target.value),className:`form-input ${f.name?"error":""}`,placeholder:"Ej: Excavadora Principal, Tractor TR1",required:!0}),f.name&&e.jsx("span",{className:"field-error",children:f.name})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"brand",className:"form-label",children:"üè≠ Marca"}),e.jsx("input",{type:"text",id:"brand",value:d.brand,onChange:t=>A("brand",t.target.value),className:"form-input",placeholder:"Ej: Caterpillar, John Deere"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"year",className:"form-label",children:"üìÖ A√±o"}),e.jsx("input",{type:"number",id:"year",value:d.year,onChange:t=>A("year",t.target.value),className:`form-input ${f.year?"error":""}`,min:"1900",max:new Date().getFullYear()+1}),f.year&&e.jsx("span",{className:"field-error",children:f.year})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"fuelType",className:"form-label",children:"‚õΩ Tipo de Combustible *"}),e.jsx("select",{id:"fuelType",value:d.fuelType,onChange:t=>A("fuelType",t.target.value),className:`form-input ${f.fuelType?"error":""}`,required:!0,children:I().map(t=>e.jsx("option",{value:t,children:t},t))}),f.fuelType&&e.jsx("span",{className:"field-error",children:f.fuelType})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"status",className:"form-label",children:"üö¶ Estado"}),e.jsx("select",{id:"status",value:d.status,onChange:t=>A("status",t.target.value),className:"form-input",children:Object.entries(w).map(([t,r])=>e.jsx("option",{value:r,children:r.charAt(0).toUpperCase()+r.slice(1)},t))})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"currentLocation",className:"form-label",children:"üìç Ubicaci√≥n Actual"}),e.jsx("input",{type:"text",id:"currentLocation",value:d.currentLocation,onChange:t=>A("currentLocation",t.target.value),className:"form-input",placeholder:"Ej: Sector Norte, Patio Principal"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"description",className:"form-label",children:"üìÑ Descripci√≥n"}),e.jsx("textarea",{id:"description",value:d.description,onChange:t=>A("description",t.target.value),className:"form-input",rows:"3",placeholder:"Descripci√≥n adicional del veh√≠culo, caracter√≠sticas especiales, etc."})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"üìÖ Fechas Importantes"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"purchaseDate",className:"form-label",children:"üí∞ Fecha de Compra"}),e.jsx("input",{type:"date",id:"purchaseDate",value:d.purchaseDate,onChange:t=>A("purchaseDate",t.target.value),className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"lastMaintenanceDate",className:"form-label",children:"üîß √öltimo Mantenimiento"}),e.jsx("input",{type:"date",id:"lastMaintenanceDate",value:d.lastMaintenanceDate,onChange:t=>A("lastMaintenanceDate",t.target.value),className:"form-input"})]})]})]}),C&&e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"üëÅÔ∏è Vista Previa"}),e.jsx("div",{className:"vehicle-preview",style:{"--category-color":C.color},children:e.jsxs("div",{className:"preview-header",children:[e.jsx("div",{className:"preview-icon",style:{color:C.color},children:C.icon}),e.jsxs("div",{className:"preview-info",children:[e.jsx("h4",{children:d.name||"Nombre del veh√≠culo"}),e.jsxs("p",{children:[d.vehicleId||"C√≥digo del veh√≠culo"," ‚Ä¢ ",C.name]}),e.jsxs("p",{children:[d.brand," ",d.year]})]})]})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:m,disabled:E,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:E||!C,children:E?"Guardando...":x==="create"?"Crear Veh√≠culo":"Actualizar Veh√≠culo"})]})]})]}),S&&e.jsx(he,{onClose:()=>h(!1),onCategoryCreated:t=>{T(r=>[...r,t]),h(!1)}})]}):null},Re=({category:s,isExpanded:m,onToggle:l})=>s?e.jsxs("div",{className:"category-info-panel",children:[e.jsxs("div",{className:"category-compact",children:[e.jsxs("div",{className:"category-summary",children:[e.jsx("span",{className:"category-icon",style:{color:s.color},children:s.icon}),e.jsxs("div",{className:"category-basic-info",children:[e.jsx("span",{className:"category-name",children:s.name}),e.jsx("span",{className:"category-short-desc",children:s.description?.length>50?s.description.substring(0,50)+"...":s.description})]})]}),e.jsx("button",{type:"button",className:"category-toggle-btn",onClick:l,"aria-label":m?"Contraer informaci√≥n":"Expandir informaci√≥n",children:m?"‚ñ≤":"‚ñº"})]}),m&&e.jsxs("div",{className:"category-expanded",children:[e.jsxs("div",{className:"category-detail-section",children:[e.jsx("h4",{children:"üìã Descripci√≥n Completa"}),e.jsx("p",{children:s.description})]}),s.fuelTypes&&s.fuelTypes.length>0&&e.jsxs("div",{className:"category-detail-section",children:[e.jsx("h4",{children:"‚õΩ Combustibles Compatibles"}),e.jsx("div",{className:"fuel-types-list",children:s.fuelTypes.map(o=>e.jsx("span",{className:"fuel-type-badge",children:o},o))})]}),s.fields&&s.fields.length>0&&e.jsxs("div",{className:"category-detail-section",children:[e.jsx("h4",{children:"üîß Campos Espec√≠ficos"}),e.jsx("div",{className:"fields-list",children:s.fields.map(o=>e.jsx("span",{className:"field-badge",children:o},o))})]}),s.isCustom&&e.jsx("div",{className:"category-detail-section",children:e.jsx("span",{className:"custom-badge",children:"‚ú® Categor√≠a Personalizada"})})]})]}):null,U={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},_={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},W={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},He=({isOpen:s,onClose:m,vehicle:l,maintenance:o,onSave:x,mode:u="create",userRole:T})=>{const C=v.useCallback(()=>({vehicleId:l?.vehicleId||"",vehicleName:l?.name||"",type:o?.type||U.PREVENTIVO,title:o?.title||"",description:o?.description||"",priority:o?.priority||W.MEDIA,status:o?.status||_.PROGRAMADO,scheduledDate:o?.scheduledDate?new Date(o.scheduledDate).toISOString().split("T")[0]:"",startDate:o?.startDate?new Date(o.startDate).toISOString().split("T")[0]:"",completedDate:o?.completedDate?new Date(o.completedDate).toISOString().split("T")[0]:"",estimatedHours:o?.estimatedHours||0,actualHours:o?.actualHours||0,estimatedCost:o?.estimatedCost||0,actualCost:o?.actualCost||0,technician:o?.technician||"",workshop:o?.workshop||"",parts:o?.parts||[],notes:o?.notes||"",nextMaintenanceKm:o?.nextMaintenanceKm||0,nextMaintenanceHours:o?.nextMaintenanceHours||0,nextMaintenanceDate:o?.nextMaintenanceDate?new Date(o.nextMaintenanceDate).toISOString().split("T")[0]:""}),[o,l]),[c,S]=v.useState(C()),[h,p]=v.useState({}),[g,E]=v.useState(!1),[j,f]=v.useState({name:"",quantity:1,cost:0});v.useEffect(()=>{s&&(S(C()),p({}))},[s,o,l,C]);const a=r=>{const{name:N,value:V,type:R}=r.target,q=R==="number"?parseFloat(V)||0:V;S(n=>({...n,[N]:q})),h[N]&&p(n=>({...n,[N]:null}))},y=r=>{const{name:N,value:V,type:R}=r.target,q=R==="number"?parseFloat(V)||0:V;f(n=>({...n,[N]:q}))},d=()=>{if(!j.name.trim())return;const r={id:Date.now().toString(),name:j.name.trim(),quantity:j.quantity,cost:j.cost,total:j.quantity*j.cost};S(N=>({...N,parts:[...N.parts,r]})),f({name:"",quantity:1,cost:0})},F=r=>{S(N=>({...N,parts:N.parts.filter(V=>V.id!==r)}))},D=()=>{const r={};if(c.title.trim()||(r.title="El t√≠tulo del mantenimiento es obligatorio"),c.description.trim()||(r.description="La descripci√≥n es obligatoria"),c.scheduledDate||(r.scheduledDate="La fecha programada es obligatoria"),c.startDate&&c.completedDate){const N=new Date(c.startDate);new Date(c.completedDate)<N&&(r.completedDate="La fecha de finalizaci√≥n debe ser posterior al inicio")}return c.scheduledDate&&c.startDate&&(new Date(c.scheduledDate),new Date(c.startDate)),c.estimatedHours<0&&(r.estimatedHours="Las horas estimadas no pueden ser negativas"),c.actualHours<0&&(r.actualHours="Las horas reales no pueden ser negativas"),c.estimatedCost<0&&(r.estimatedCost="El costo estimado no puede ser negativo"),c.actualCost<0&&(r.actualCost="El costo real no puede ser negativo"),c.status===_.COMPLETADO&&!c.completedDate&&(r.completedDate="La fecha de finalizaci√≥n es obligatoria para mantenimientos completados"),c.status===_.EN_PROCESO&&!c.startDate&&(r.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),p(r),Object.keys(r).length===0},i=async r=>{if(r.preventDefault(),!!D()){E(!0);try{const N=c.parts.reduce((n,b)=>n+b.total,0),V=c.estimatedCost+N,R=c.actualCost+N,q={...c,vehicleId:l.id,vehicleName:l.name,totalPartsCost:N,totalEstimatedCost:V,totalActualCost:R,scheduledDate:c.scheduledDate||null,startDate:c.startDate||null,completedDate:c.completedDate||null,nextMaintenanceDate:c.nextMaintenanceDate||null,createdAt:o?.createdAt||new Date,updatedAt:new Date};await x(q),m()}catch(N){console.error("Error guardando mantenimiento:",N),p({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{E(!1)}}},A=r=>{switch(r){case U.PREVENTIVO:return"üîß";case U.CORRECTIVO:return"üõ†Ô∏è";case U.PREDICTIVO:return"üìä";case U.EMERGENCIA:return"üö®";default:return"‚öôÔ∏è"}},M=r=>{switch(r){case W.BAJA:return"priority-low";case W.MEDIA:return"priority-medium";case W.ALTA:return"priority-high";case W.CRITICA:return"priority-critical";default:return"priority-medium"}},k=r=>{switch(r){case _.PROGRAMADO:return"status-scheduled";case _.EN_PROCESO:return"status-in-progress";case _.COMPLETADO:return"status-completed";case _.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},$=()=>c.parts.reduce((r,N)=>r+N.total,0),I=u==="view",t=T==="admin"||T==="supervisor";return s?e.jsx("div",{className:"modal-overlay",onClick:m,children:e.jsxs("div",{className:"modal-content maintenance-modal",onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"modal-title",children:[e.jsx("span",{className:"title-icon",children:u==="create"?"‚ûï":u==="edit"?"‚úèÔ∏è":"üëÅÔ∏è"}),e.jsxs("div",{className:"title-text",children:[e.jsxs("h3",{children:[u==="create"&&"Registrar Mantenimiento",u==="edit"&&"Editar Mantenimiento",u==="view"&&"Detalles del Mantenimiento"]}),e.jsxs("p",{children:["Veh√≠culo: ",l?.vehicleId," - ",l?.name]})]})]}),e.jsx("button",{className:"btn-close",onClick:m,type:"button",children:"‚úï"})]}),e.jsxs("form",{onSubmit:i,className:"modal-form",children:[e.jsxs("div",{className:"form-content",children:[h.general&&e.jsxs("div",{className:"error-message general-error",children:["‚ö†Ô∏è ",h.general]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{className:"section-title",children:"üìã Informaci√≥n del Mantenimiento"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),e.jsx("select",{id:"type",name:"type",value:c.type,onChange:a,disabled:I||u==="edit"&&!t,children:Object.values(U).map(r=>e.jsxs("option",{value:r,children:[A(r)," ",r.charAt(0).toUpperCase()+r.slice(1)]},r))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"priority",children:"Prioridad"}),e.jsx("select",{id:"priority",name:"priority",value:c.priority,onChange:a,className:M(c.priority),disabled:I||u==="edit"&&!t,children:Object.values(W).map(r=>e.jsx("option",{value:r,children:r.charAt(0).toUpperCase()+r.slice(1)},r))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"status",children:"Estado"}),e.jsx("select",{id:"status",name:"status",value:c.status,onChange:a,className:k(c.status),disabled:I||u==="edit"&&!t,children:Object.values(_).map(r=>e.jsx("option",{value:r,children:r.charAt(0).toUpperCase()+r.slice(1).replace("_"," ")},r))})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{htmlFor:"title",children:"T√≠tulo del Mantenimiento *"}),e.jsx("input",{type:"text",id:"title",name:"title",value:c.title,onChange:a,placeholder:"Ej: Cambio de aceite y filtros",className:h.title?"error":"",disabled:I||u==="edit"&&!t,maxLength:100}),h.title&&e.jsx("span",{className:"error-text",children:h.title})]})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{className:"section-title",children:"üìÖ Programaci√≥n"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),e.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:c.scheduledDate,onChange:a,className:h.scheduledDate?"error":"",disabled:I||u==="edit"&&!t}),h.scheduledDate&&e.jsx("span",{className:"error-text",children:h.scheduledDate})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),e.jsx("input",{type:"date",id:"startDate",name:"startDate",value:c.startDate,onChange:a,className:h.startDate?"error":"",disabled:I||u==="edit"&&!t}),h.startDate&&e.jsx("span",{className:"error-text",children:h.startDate})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalizaci√≥n"}),e.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:c.completedDate,onChange:a,className:h.completedDate?"error":"",disabled:I||u==="edit"&&!t}),h.completedDate&&e.jsx("span",{className:"error-text",children:h.completedDate})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Pr√≥ximo Mantenimiento"}),e.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:c.nextMaintenanceDate,onChange:a,disabled:I||u==="edit"&&!t})]})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{className:"section-title",children:"üí∞ Recursos y Costos"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"technician",children:"T√©cnico Responsable"}),e.jsx("input",{type:"text",id:"technician",name:"technician",value:c.technician,onChange:a,placeholder:"Nombre del t√©cnico",disabled:I||u==="edit"&&!t,maxLength:100})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicaci√≥n"}),e.jsx("input",{type:"text",id:"workshop",name:"workshop",value:c.workshop,onChange:a,placeholder:"Taller donde se realiza",disabled:I||u==="edit"&&!t,maxLength:100})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),e.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:c.estimatedHours,onChange:a,min:"0",step:"0.5",className:h.estimatedHours?"error":"",disabled:I||u==="edit"&&!t}),h.estimatedHours&&e.jsx("span",{className:"error-text",children:h.estimatedHours})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),e.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:c.actualHours,onChange:a,min:"0",step:"0.5",className:h.actualHours?"error":"",disabled:I||u==="edit"&&!t}),h.actualHours&&e.jsx("span",{className:"error-text",children:h.actualHours})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),e.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:c.estimatedCost,onChange:a,min:"0",step:"1000",className:h.estimatedCost?"error":"",disabled:I||u==="edit"&&!t}),h.estimatedCost&&e.jsx("span",{className:"error-text",children:h.estimatedCost})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),e.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:c.actualCost,onChange:a,min:"0",step:"1000",className:h.actualCost?"error":"",disabled:I||u==="edit"&&!t}),h.actualCost&&e.jsx("span",{className:"error-text",children:h.actualCost})]})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{className:"section-title",children:"üîß Partes y Repuestos"}),!I&&t&&e.jsx("div",{className:"parts-form",children:e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),e.jsx("input",{type:"text",id:"partName",name:"name",value:j.name,onChange:y,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),e.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:j.quantity,onChange:y,min:"1",step:"1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),e.jsx("input",{type:"number",id:"partCost",name:"cost",value:j.cost,onChange:y,min:"0",step:"1000"})]}),e.jsx("div",{className:"form-group",children:e.jsx("button",{type:"button",className:"btn-add-part",onClick:d,disabled:!j.name.trim(),children:"‚ûï Agregar"})})]})}),c.parts.length>0&&e.jsx("div",{className:"parts-list",children:e.jsxs("table",{className:"parts-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Parte"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Costo Unit."}),e.jsx("th",{children:"Total"}),!I&&t&&e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:c.parts.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.name}),e.jsx("td",{children:r.quantity}),e.jsxs("td",{children:["$",r.cost.toLocaleString("es-CO")]}),e.jsxs("td",{children:["$",r.total.toLocaleString("es-CO")]}),!I&&t&&e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>F(r.id),title:"Eliminar parte",children:"üóëÔ∏è"})})]},r.id))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"total-row",children:[e.jsx("td",{colSpan:"3",children:e.jsx("strong",{children:"Total Partes:"})}),e.jsx("td",{children:e.jsxs("strong",{children:["$",$().toLocaleString("es-CO")]})}),!I&&t&&e.jsx("td",{})]})})]})})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{className:"section-title",children:"üîÑ Pr√≥ximo Mantenimiento"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Pr√≥ximo Mantenimiento (Km)"}),e.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:c.nextMaintenanceKm,onChange:a,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:I||u==="edit"&&!t})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Pr√≥ximo Mantenimiento (Horas)"}),e.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:c.nextMaintenanceHours,onChange:a,min:"0",step:"100",placeholder:"0 = No aplica",disabled:I||u==="edit"&&!t})]})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{className:"section-title",children:"üìù Descripci√≥n y Notas"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"description",children:"Descripci√≥n del Trabajo *"}),e.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:a,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:h.description?"error":"",disabled:I||u==="edit"&&!t}),h.description&&e.jsx("span",{className:"error-text",children:h.description})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),e.jsx("textarea",{id:"notes",name:"notes",value:c.notes,onChange:a,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:I||u==="edit"&&!t}),e.jsxs("span",{className:"char-count",children:[c.notes.length,"/500 caracteres"]})]})]}),e.jsxs("div",{className:"cost-summary",children:[e.jsx("h4",{children:"üí∞ Resumen de Costos"}),e.jsxs("div",{className:"cost-grid",children:[e.jsxs("div",{className:"cost-item",children:[e.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),e.jsxs("span",{className:"cost-value",children:["$",c.actualCost.toLocaleString("es-CO")]})]}),e.jsxs("div",{className:"cost-item",children:[e.jsx("span",{className:"cost-label",children:"Partes:"}),e.jsxs("span",{className:"cost-value",children:["$",$().toLocaleString("es-CO")]})]}),e.jsxs("div",{className:"cost-item total-cost",children:[e.jsx("span",{className:"cost-label",children:"Total:"}),e.jsxs("span",{className:"cost-value",children:["$",(c.actualCost+$()).toLocaleString("es-CO")]})]})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:m,disabled:g,children:u==="view"?"Cerrar":"Cancelar"}),!I&&t&&e.jsx("button",{type:"submit",className:"btn-primary",disabled:g,children:g?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):e.jsx(e.Fragment,{children:u==="create"?"‚ûï Registrar Mantenimiento":"üíæ Guardar Cambios"})})]})]})]})}):null},qe=()=>{const{user:s,userProfile:m}=be(),[l,o]=v.useState([]),[x,u]=v.useState(null),[T,C]=v.useState(!0),[c,S]=v.useState(null),[h,p]=v.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[g,E]=v.useState("cards"),[j,f]=v.useState(""),[a,y]=v.useState(!1),[d,F]=v.useState(!1),[D,i]=v.useState(!1),[A,M]=v.useState(null),[k,$]=v.useState("create");v.useEffect(()=>{if(!s)return;C(!0);const O=Ce((H,ee)=>{if(ee){console.error("Error en suscripci√≥n de veh√≠culos:",ee),S("Error al cargar veh√≠culos"),C(!1);return}o(H),S(null),C(!1)},h);return()=>O()},[s,h.type,h.status,h.fuelType,h.location,h.maintenance]),v.useEffect(()=>{s&&(async()=>{try{const H=await Ee(h);u(H)}catch(H){console.error("Error al cargar estad√≠sticas:",H)}})()},[s,l,h.type,h.status,h.fuelType,h.location,h.maintenance]);const I=l.filter(O=>{if(!j)return!0;const H=j.toLowerCase();return O.vehicleId?.toLowerCase().includes(H)||O.name?.toLowerCase().includes(H)||O.type?.toLowerCase().includes(H)||O.brand?.toLowerCase().includes(H)||O.model?.toLowerCase().includes(H)||O.currentLocation?.toLowerCase().includes(H)||O.description?.toLowerCase().includes(H)}),t=()=>{M(null),$("create"),y(!0)},r=O=>{M(O),$("edit"),y(!0)},N=O=>{M(O),$("view"),y(!0)},V=O=>{M(O),F(!0)},R=()=>{y(!1),F(!1),M(null)},q=O=>{p(H=>({...H,...O}))},n=()=>{p({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),f("")},b=m?.role==="admin"||m?.role==="contador"||m?.role==="cliente",P=m?.role==="admin",G=m?.role==="admin"||m?.role==="contador";return T?e.jsx("div",{className:"vehicles-main",children:e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Cargando veh√≠culos..."})]})}):c?e.jsx("div",{className:"vehicles-main",children:e.jsxs("div",{className:"error-container",children:[e.jsx("div",{className:"error-icon",children:"‚ö†Ô∏è"}),e.jsx("h3",{children:"Error al cargar veh√≠culos"}),e.jsx("p",{children:c}),e.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):e.jsxs("div",{className:"vehicles-main",children:[e.jsxs("div",{className:"vehicles-header",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("h2",{children:"üöú Gesti√≥n de Veh√≠culos"}),e.jsx("p",{children:"Administra la maquinaria y veh√≠culos forestales"})]}),b&&e.jsx("button",{className:"btn-create-vehicle",onClick:t,children:"‚ûï Nuevo Veh√≠culo"})]}),x&&e.jsx(De,{stats:x,filters:h}),e.jsx(Te,{filters:h,onFilterChange:q,onClearFilters:n,searchTerm:j,onSearchChange:f,viewMode:g,onViewModeChange:E,totalResults:I.length}),I.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"üöú"}),e.jsx("h3",{children:l.length===0?"No hay veh√≠culos registrados":"No se encontraron veh√≠culos"}),e.jsx("p",{children:l.length===0?"Comienza registrando tu primer veh√≠culo o maquinaria forestal":"Intenta ajustar los filtros de b√∫squeda"}),l.length===0&&b&&e.jsx("button",{className:"btn-create-first",onClick:t,children:"‚ûï Registrar Primer Veh√≠culo"})]}):e.jsx(Me,{vehicles:I,viewMode:g,onEdit:P?r:null,onView:N,onMaintenance:G?V:null,userRole:s?.role}),a&&e.jsx(Le,{isOpen:a,onClose:R,vehicle:A,mode:k,onSave:async O=>{k==="create"?await ye(O):await we(A.id,O),R()},userRole:m?.role}),D&&e.jsx(he,{onClose:()=>i(!1),onCategoryCreated:()=>{}}),d&&e.jsx(He,{isOpen:d,onClose:R,vehicle:A,onSuccess:()=>{R()}})]})};export{qe as default};
