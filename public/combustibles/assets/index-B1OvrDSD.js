(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var Ep={exports:{}},jc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ib;function nS(){if(ib)return jc;ib=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var f in o)f!=="key"&&(c[f]=o[f])}else c=o;return o=c.ref,{$$typeof:n,type:a,key:d,ref:o!==void 0?o:null,props:c}}return jc.Fragment=e,jc.jsx=t,jc.jsxs=t,jc}var rb;function sS(){return rb||(rb=1,Ep.exports=nS()),Ep.exports}var r=sS(),bp={exports:{}},ke={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ob;function aS(){if(ob)return ke;ob=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),N=Symbol.iterator;function C(H){return H===null||typeof H!="object"?null:(H=N&&H[N]||H["@@iterator"],typeof H=="function"?H:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,M={};function x(H,ne,he){this.props=H,this.context=ne,this.refs=M,this.updater=he||j}x.prototype.isReactComponent={},x.prototype.setState=function(H,ne){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ne,"setState")},x.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function V(){}V.prototype=x.prototype;function $(H,ne,he){this.props=H,this.context=ne,this.refs=M,this.updater=he||j}var O=$.prototype=new V;O.constructor=$,b(O,x.prototype),O.isPureReactComponent=!0;var U=Array.isArray,q={H:null,A:null,T:null,S:null,V:null},K=Object.prototype.hasOwnProperty;function w(H,ne,he,ue,Te,Ue){return he=Ue.ref,{$$typeof:n,type:H,key:ne,ref:he!==void 0?he:null,props:Ue}}function A(H,ne){return w(H.type,ne,void 0,void 0,void 0,H.props)}function R(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function I(H){var ne={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(he){return ne[he]})}var L=/\/+/g;function P(H,ne){return typeof H=="object"&&H!==null&&H.key!=null?I(""+H.key):ne.toString(36)}function k(){}function Pe(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(k,k):(H.status="pending",H.then(function(ne){H.status==="pending"&&(H.status="fulfilled",H.value=ne)},function(ne){H.status==="pending"&&(H.status="rejected",H.reason=ne)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function ae(H,ne,he,ue,Te){var Ue=typeof H;(Ue==="undefined"||Ue==="boolean")&&(H=null);var Ie=!1;if(H===null)Ie=!0;else switch(Ue){case"bigint":case"string":case"number":Ie=!0;break;case"object":switch(H.$$typeof){case n:case e:Ie=!0;break;case _:return Ie=H._init,ae(Ie(H._payload),ne,he,ue,Te)}}if(Ie)return Te=Te(H),Ie=ue===""?"."+P(H,0):ue,U(Te)?(he="",Ie!=null&&(he=Ie.replace(L,"$&/")+"/"),ae(Te,ne,he,"",function(js){return js})):Te!=null&&(R(Te)&&(Te=A(Te,he+(Te.key==null||H&&H.key===Te.key?"":(""+Te.key).replace(L,"$&/")+"/")+Ie)),ne.push(Te)),1;Ie=0;var Yt=ue===""?".":ue+":";if(U(H))for(var ft=0;ft<H.length;ft++)ue=H[ft],Ue=Yt+P(ue,ft),Ie+=ae(ue,ne,he,Ue,Te);else if(ft=C(H),typeof ft=="function")for(H=ft.call(H),ft=0;!(ue=H.next()).done;)ue=ue.value,Ue=Yt+P(ue,ft++),Ie+=ae(ue,ne,he,Ue,Te);else if(Ue==="object"){if(typeof H.then=="function")return ae(Pe(H),ne,he,ue,Te);throw ne=String(H),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return Ie}function B(H,ne,he){if(H==null)return H;var ue=[],Te=0;return ae(H,ue,"","",function(Ue){return ne.call(he,Ue,Te++)}),ue}function J(H){if(H._status===-1){var ne=H._result;ne=ne(),ne.then(function(he){(H._status===0||H._status===-1)&&(H._status=1,H._result=he)},function(he){(H._status===0||H._status===-1)&&(H._status=2,H._result=he)}),H._status===-1&&(H._status=0,H._result=ne)}if(H._status===1)return H._result.default;throw H._result}var ce=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)};function ve(){}return ke.Children={map:B,forEach:function(H,ne,he){B(H,function(){ne.apply(this,arguments)},he)},count:function(H){var ne=0;return B(H,function(){ne++}),ne},toArray:function(H){return B(H,function(ne){return ne})||[]},only:function(H){if(!R(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},ke.Component=x,ke.Fragment=t,ke.Profiler=o,ke.PureComponent=$,ke.StrictMode=a,ke.Suspense=p,ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=q,ke.__COMPILER_RUNTIME={__proto__:null,c:function(H){return q.H.useMemoCache(H)}},ke.cache=function(H){return function(){return H.apply(null,arguments)}},ke.cloneElement=function(H,ne,he){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var ue=b({},H.props),Te=H.key,Ue=void 0;if(ne!=null)for(Ie in ne.ref!==void 0&&(Ue=void 0),ne.key!==void 0&&(Te=""+ne.key),ne)!K.call(ne,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&ne.ref===void 0||(ue[Ie]=ne[Ie]);var Ie=arguments.length-2;if(Ie===1)ue.children=he;else if(1<Ie){for(var Yt=Array(Ie),ft=0;ft<Ie;ft++)Yt[ft]=arguments[ft+2];ue.children=Yt}return w(H.type,Te,void 0,void 0,Ue,ue)},ke.createContext=function(H){return H={$$typeof:d,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:c,_context:H},H},ke.createElement=function(H,ne,he){var ue,Te={},Ue=null;if(ne!=null)for(ue in ne.key!==void 0&&(Ue=""+ne.key),ne)K.call(ne,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(Te[ue]=ne[ue]);var Ie=arguments.length-2;if(Ie===1)Te.children=he;else if(1<Ie){for(var Yt=Array(Ie),ft=0;ft<Ie;ft++)Yt[ft]=arguments[ft+2];Te.children=Yt}if(H&&H.defaultProps)for(ue in Ie=H.defaultProps,Ie)Te[ue]===void 0&&(Te[ue]=Ie[ue]);return w(H,Ue,void 0,void 0,null,Te)},ke.createRef=function(){return{current:null}},ke.forwardRef=function(H){return{$$typeof:f,render:H}},ke.isValidElement=R,ke.lazy=function(H){return{$$typeof:_,_payload:{_status:-1,_result:H},_init:J}},ke.memo=function(H,ne){return{$$typeof:v,type:H,compare:ne===void 0?null:ne}},ke.startTransition=function(H){var ne=q.T,he={};q.T=he;try{var ue=H(),Te=q.S;Te!==null&&Te(he,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(ve,ce)}catch(Ue){ce(Ue)}finally{q.T=ne}},ke.unstable_useCacheRefresh=function(){return q.H.useCacheRefresh()},ke.use=function(H){return q.H.use(H)},ke.useActionState=function(H,ne,he){return q.H.useActionState(H,ne,he)},ke.useCallback=function(H,ne){return q.H.useCallback(H,ne)},ke.useContext=function(H){return q.H.useContext(H)},ke.useDebugValue=function(){},ke.useDeferredValue=function(H,ne){return q.H.useDeferredValue(H,ne)},ke.useEffect=function(H,ne,he){var ue=q.H;if(typeof he=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ue.useEffect(H,ne)},ke.useId=function(){return q.H.useId()},ke.useImperativeHandle=function(H,ne,he){return q.H.useImperativeHandle(H,ne,he)},ke.useInsertionEffect=function(H,ne){return q.H.useInsertionEffect(H,ne)},ke.useLayoutEffect=function(H,ne){return q.H.useLayoutEffect(H,ne)},ke.useMemo=function(H,ne){return q.H.useMemo(H,ne)},ke.useOptimistic=function(H,ne){return q.H.useOptimistic(H,ne)},ke.useReducer=function(H,ne,he){return q.H.useReducer(H,ne,he)},ke.useRef=function(H){return q.H.useRef(H)},ke.useState=function(H){return q.H.useState(H)},ke.useSyncExternalStore=function(H,ne,he){return q.H.useSyncExternalStore(H,ne,he)},ke.useTransition=function(){return q.H.useTransition()},ke.version="19.1.0",ke}var lb;function Ag(){return lb||(lb=1,bp.exports=aS()),bp.exports}var Y=Ag(),Np={exports:{}},Sc={},Tp={exports:{}},xp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cb;function iS(){return cb||(cb=1,function(n){function e(B,J){var ce=B.length;B.push(J);e:for(;0<ce;){var ve=ce-1>>>1,H=B[ve];if(0<o(H,J))B[ve]=J,B[ce]=H,ce=ve;else break e}}function t(B){return B.length===0?null:B[0]}function a(B){if(B.length===0)return null;var J=B[0],ce=B.pop();if(ce!==J){B[0]=ce;e:for(var ve=0,H=B.length,ne=H>>>1;ve<ne;){var he=2*(ve+1)-1,ue=B[he],Te=he+1,Ue=B[Te];if(0>o(ue,ce))Te<H&&0>o(Ue,ue)?(B[ve]=Ue,B[Te]=ce,ve=Te):(B[ve]=ue,B[he]=ce,ve=he);else if(Te<H&&0>o(Ue,ce))B[ve]=Ue,B[Te]=ce,ve=Te;else break e}}return J}function o(B,J){var ce=B.sortIndex-J.sortIndex;return ce!==0?ce:B.id-J.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var p=[],v=[],_=1,N=null,C=3,j=!1,b=!1,M=!1,x=!1,V=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function U(B){for(var J=t(v);J!==null;){if(J.callback===null)a(v);else if(J.startTime<=B)a(v),J.sortIndex=J.expirationTime,e(p,J);else break;J=t(v)}}function q(B){if(M=!1,U(B),!b)if(t(p)!==null)b=!0,K||(K=!0,P());else{var J=t(v);J!==null&&ae(q,J.startTime-B)}}var K=!1,w=-1,A=5,R=-1;function I(){return x?!0:!(n.unstable_now()-R<A)}function L(){if(x=!1,K){var B=n.unstable_now();R=B;var J=!0;try{e:{b=!1,M&&(M=!1,$(w),w=-1),j=!0;var ce=C;try{t:{for(U(B),N=t(p);N!==null&&!(N.expirationTime>B&&I());){var ve=N.callback;if(typeof ve=="function"){N.callback=null,C=N.priorityLevel;var H=ve(N.expirationTime<=B);if(B=n.unstable_now(),typeof H=="function"){N.callback=H,U(B),J=!0;break t}N===t(p)&&a(p),U(B)}else a(p);N=t(p)}if(N!==null)J=!0;else{var ne=t(v);ne!==null&&ae(q,ne.startTime-B),J=!1}}break e}finally{N=null,C=ce,j=!1}J=void 0}}finally{J?P():K=!1}}}var P;if(typeof O=="function")P=function(){O(L)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,Pe=k.port2;k.port1.onmessage=L,P=function(){Pe.postMessage(null)}}else P=function(){V(L,0)};function ae(B,J){w=V(function(){B(n.unstable_now())},J)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_next=function(B){switch(C){case 1:case 2:case 3:var J=3;break;default:J=C}var ce=C;C=J;try{return B()}finally{C=ce}},n.unstable_requestPaint=function(){x=!0},n.unstable_runWithPriority=function(B,J){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var ce=C;C=B;try{return J()}finally{C=ce}},n.unstable_scheduleCallback=function(B,J,ce){var ve=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ve+ce:ve):ce=ve,B){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=ce+H,B={id:_++,callback:J,priorityLevel:B,startTime:ce,expirationTime:H,sortIndex:-1},ce>ve?(B.sortIndex=ce,e(v,B),t(p)===null&&B===t(v)&&(M?($(w),w=-1):M=!0,ae(q,ce-ve))):(B.sortIndex=H,e(p,B),b||j||(b=!0,K||(K=!0,P()))),B},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(B){var J=C;return function(){var ce=C;C=J;try{return B.apply(this,arguments)}finally{C=ce}}}}(xp)),xp}var ub;function rS(){return ub||(ub=1,Tp.exports=iS()),Tp.exports}var Ap={exports:{}},gn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var db;function oS(){if(db)return gn;db=1;var n=Ag();function e(p){var v="https://react.dev/errors/"+p;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)v+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,v,_){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:N==null?null:""+N,children:p,containerInfo:v,implementation:_}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,v){if(p==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return gn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,gn.createPortal=function(p,v){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(e(299));return c(p,v,null,_)},gn.flushSync=function(p){var v=d.T,_=a.p;try{if(d.T=null,a.p=2,p)return p()}finally{d.T=v,a.p=_,a.d.f()}},gn.preconnect=function(p,v){typeof p=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,a.d.C(p,v))},gn.prefetchDNS=function(p){typeof p=="string"&&a.d.D(p)},gn.preinit=function(p,v){if(typeof p=="string"&&v&&typeof v.as=="string"){var _=v.as,N=f(_,v.crossOrigin),C=typeof v.integrity=="string"?v.integrity:void 0,j=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;_==="style"?a.d.S(p,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:N,integrity:C,fetchPriority:j}):_==="script"&&a.d.X(p,{crossOrigin:N,integrity:C,fetchPriority:j,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},gn.preinitModule=function(p,v){if(typeof p=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var _=f(v.as,v.crossOrigin);a.d.M(p,{crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&a.d.M(p)},gn.preload=function(p,v){if(typeof p=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var _=v.as,N=f(_,v.crossOrigin);a.d.L(p,_,{crossOrigin:N,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},gn.preloadModule=function(p,v){if(typeof p=="string")if(v){var _=f(v.as,v.crossOrigin);a.d.m(p,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else a.d.m(p)},gn.requestFormReset=function(p){a.d.r(p)},gn.unstable_batchedUpdates=function(p,v){return p(v)},gn.useFormState=function(p,v,_){return d.H.useFormState(p,v,_)},gn.useFormStatus=function(){return d.H.useHostTransitionStatus()},gn.version="19.1.0",gn}var hb;function lS(){if(hb)return Ap.exports;hb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ap.exports=oS(),Ap.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fb;function cS(){if(fb)return Sc;fb=1;var n=rS(),e=Ag(),t=lS();function a(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var i=s,l=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(l=i.return),s=i.return;while(s)}return i.tag===3?l:null}function d(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function f(s){if(c(s)!==s)throw Error(a(188))}function p(s){var i=s.alternate;if(!i){if(i=c(s),i===null)throw Error(a(188));return i!==s?null:s}for(var l=s,u=i;;){var m=l.return;if(m===null)break;var g=m.alternate;if(g===null){if(u=m.return,u!==null){l=u;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===l)return f(m),s;if(g===u)return f(m),i;g=g.sibling}throw Error(a(188))}if(l.return!==u.return)l=m,u=g;else{for(var T=!1,S=m.child;S;){if(S===l){T=!0,l=m,u=g;break}if(S===u){T=!0,u=m,l=g;break}S=S.sibling}if(!T){for(S=g.child;S;){if(S===l){T=!0,l=g,u=m;break}if(S===u){T=!0,u=g,l=m;break}S=S.sibling}if(!T)throw Error(a(189))}}if(l.alternate!==u)throw Error(a(190))}if(l.tag!==3)throw Error(a(188));return l.stateNode.current===l?s:i}function v(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=v(s),i!==null)return i;s=s.sibling}return null}var _=Object.assign,N=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),$=Symbol.for("react.consumer"),O=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function P(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var k=Symbol.for("react.client.reference");function Pe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===k?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case x:return"Profiler";case M:return"StrictMode";case q:return"Suspense";case K:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case j:return"Portal";case O:return(s.displayName||"Context")+".Provider";case $:return(s._context.displayName||"Context")+".Consumer";case U:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case w:return i=s.displayName||null,i!==null?i:Pe(s.type)||"Memo";case A:i=s._payload,s=s._init;try{return Pe(s(i))}catch{}}return null}var ae=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},ve=[],H=-1;function ne(s){return{current:s}}function he(s){0>H||(s.current=ve[H],ve[H]=null,H--)}function ue(s,i){H++,ve[H]=s.current,s.current=i}var Te=ne(null),Ue=ne(null),Ie=ne(null),Yt=ne(null);function ft(s,i){switch(ue(Ie,i),ue(Ue,s),ue(Te,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?OE(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=OE(i),s=ME(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}he(Te),ue(Te,s)}function js(){he(Te),he(Ue),he(Ie)}function Ua(s){s.memoizedState!==null&&ue(Yt,s);var i=Te.current,l=ME(i,s.type);i!==l&&(ue(Ue,s),ue(Te,l))}function ta(s){Ue.current===s&&(he(Te),he(Ue)),Yt.current===s&&(he(Yt),Nc._currentValue=ce)}var qi=Object.prototype.hasOwnProperty,Bi=n.unstable_scheduleCallback,zi=n.unstable_cancelCallback,_l=n.unstable_shouldYield,Tu=n.unstable_requestPaint,Zn=n.unstable_now,Ef=n.unstable_getCurrentPriorityLevel,El=n.unstable_ImmediatePriority,Br=n.unstable_UserBlockingPriority,Gi=n.unstable_NormalPriority,bf=n.unstable_LowPriority,zr=n.unstable_IdlePriority,bl=n.log,xu=n.unstable_setDisableYieldValue,Nt=null,st=null;function Ln(s){if(typeof bl=="function"&&xu(s),st&&typeof st.setStrictMode=="function")try{st.setStrictMode(Nt,s)}catch{}}var mn=Math.clz32?Math.clz32:$i,Au=Math.log,Nf=Math.LN2;function $i(s){return s>>>=0,s===0?32:31-(Au(s)/Nf|0)|0}var Yi=256,Ki=4194304;function ms(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Gr(s,i,l){var u=s.pendingLanes;if(u===0)return 0;var m=0,g=s.suspendedLanes,T=s.pingedLanes;s=s.warmLanes;var S=u&134217727;return S!==0?(u=S&~g,u!==0?m=ms(u):(T&=S,T!==0?m=ms(T):l||(l=S&~s,l!==0&&(m=ms(l))))):(S=u&~g,S!==0?m=ms(S):T!==0?m=ms(T):l||(l=u&~s,l!==0&&(m=ms(l)))),m===0?0:i!==0&&i!==m&&(i&g)===0&&(g=m&-m,l=i&-i,g>=l||g===32&&(l&4194048)!==0)?i:m}function Qi(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function Nl(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tl(){var s=Yi;return Yi<<=1,(Yi&4194048)===0&&(Yi=256),s}function xl(){var s=Ki;return Ki<<=1,(Ki&62914560)===0&&(Ki=4194304),s}function na(s){for(var i=[],l=0;31>l;l++)i.push(s);return i}function sa(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Al(s,i,l,u,m,g){var T=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var S=s.entanglements,F=s.expirationTimes,W=s.hiddenUpdates;for(l=T&~l;0<l;){var se=31-mn(l),oe=1<<se;S[se]=0,F[se]=-1;var Z=W[se];if(Z!==null)for(W[se]=null,se=0;se<Z.length;se++){var ee=Z[se];ee!==null&&(ee.lane&=-536870913)}l&=~oe}u!==0&&Ss(s,u,0),g!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=g&~(T&~i))}function Ss(s,i,l){s.pendingLanes|=i,s.suspendedLanes&=~i;var u=31-mn(i);s.entangledLanes|=i,s.entanglements[u]=s.entanglements[u]|1073741824|l&4194090}function Cl(s,i){var l=s.entangledLanes|=i;for(s=s.entanglements;l;){var u=31-mn(l),m=1<<u;m&i|s[u]&i&&(s[u]|=i),l&=~m}}function Fa(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function $r(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ha(){var s=J.p;return s!==0?s:(s=window.event,s===void 0?32:JE(s.type))}function Cu(s,i){var l=J.p;try{return J.p=s,i()}finally{J.p=l}}var yt=Math.random().toString(36).slice(2),Ut="__reactFiber$"+yt,Dt="__reactProps$"+yt,Jn="__reactContainer$"+yt,jl="__reactEvents$"+yt,Tf="__reactListeners$"+yt,qa="__reactHandles$"+yt,ju="__reactResources$"+yt,Xi="__reactMarker$"+yt;function Ba(s){delete s[Ut],delete s[Dt],delete s[jl],delete s[Tf],delete s[qa]}function aa(s){var i=s[Ut];if(i)return i;for(var l=s.parentNode;l;){if(i=l[Jn]||l[Ut]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(s=VE(s);s!==null;){if(l=s[Ut])return l;s=VE(s)}return i}s=l,l=s.parentNode}return null}function ws(s){if(s=s[Ut]||s[Jn]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function Is(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(a(33))}function Nn(s){var i=s[ju];return i||(i=s[ju]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function jt(s){s[Xi]=!0}var Sl=new Set,Yr={};function ps(s,i){ia(s,i),ia(s+"Capture",i)}function ia(s,i){for(Yr[s]=i,s=0;s<i.length;s++)Sl.add(i[s])}var Su=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wu={},Wi={};function Iu(s){return qi.call(Wi,s)?!0:qi.call(wu,s)?!1:Su.test(s)?Wi[s]=!0:(wu[s]=!0,!1)}function za(s,i,l){if(Iu(i))if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+l)}}function Rs(s,i,l){if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+l)}}function tn(s,i,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(i,l,""+u)}}var Zi,Ru;function ra(s){if(Zi===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);Zi=i&&i[1]||"",Ru=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Zi+s+Ru}var Kr=!1;function Qr(s,i){if(!s||Kr)return"";Kr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(ee){var Z=ee}Reflect.construct(s,[],oe)}else{try{oe.call()}catch(ee){Z=ee}s.call(oe.prototype)}}else{try{throw Error()}catch(ee){Z=ee}(oe=s())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(ee){if(ee&&Z&&typeof ee.stack=="string")return[ee.stack,Z.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),T=g[0],S=g[1];if(T&&S){var F=T.split(`
`),W=S.split(`
`);for(m=u=0;u<F.length&&!F[u].includes("DetermineComponentFrameRoot");)u++;for(;m<W.length&&!W[m].includes("DetermineComponentFrameRoot");)m++;if(u===F.length||m===W.length)for(u=F.length-1,m=W.length-1;1<=u&&0<=m&&F[u]!==W[m];)m--;for(;1<=u&&0<=m;u--,m--)if(F[u]!==W[m]){if(u!==1||m!==1)do if(u--,m--,0>m||F[u]!==W[m]){var se=`
`+F[u].replace(" at new "," at ");return s.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",s.displayName)),se}while(1<=u&&0<=m);break}}}finally{Kr=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?ra(l):""}function wl(s){switch(s.tag){case 26:case 27:case 5:return ra(s.type);case 16:return ra("Lazy");case 13:return ra("Suspense");case 19:return ra("SuspenseList");case 0:case 15:return Qr(s.type,!1);case 11:return Qr(s.type.render,!1);case 1:return Qr(s.type,!0);case 31:return ra("Activity");default:return""}}function Xr(s){try{var i="";do i+=wl(s),s=s.return;while(s);return i}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function Tn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Il(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function xf(s){var i=Il(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),u=""+s[i];if(!s.hasOwnProperty(i)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,g=l.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return m.call(this)},set:function(T){u=""+T,g.call(this,T)}}),Object.defineProperty(s,i,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Wr(s){s._valueTracker||(s._valueTracker=xf(s))}function Rl(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var l=i.getValue(),u="";return s&&(u=Il(s)?s.checked?"true":"false":s.value),s=u,s!==l?(i.setValue(s),!0):!1}function Ji(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Af=/[\n"\\]/g;function Ot(s){return s.replace(Af,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Vn(s,i,l,u,m,g,T,S){s.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?s.type=T:s.removeAttribute("type"),i!=null?T==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+Tn(i)):s.value!==""+Tn(i)&&(s.value=""+Tn(i)):T!=="submit"&&T!=="reset"||s.removeAttribute("value"),i!=null?Ga(s,T,Tn(i)):l!=null?Ga(s,T,Tn(l)):u!=null&&s.removeAttribute("value"),m==null&&g!=null&&(s.defaultChecked=!!g),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+Tn(S):s.removeAttribute("name")}function er(s,i,l,u,m,g,T,S){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(s.type=g),i!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||i!=null))return;l=l!=null?""+Tn(l):"",i=i!=null?""+Tn(i):l,S||i===s.value||(s.value=i),s.defaultValue=i}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=S?s.checked:!!u,s.defaultChecked=!!u,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(s.name=T)}function Ga(s,i,l){i==="number"&&Ji(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function oa(s,i,l,u){if(s=s.options,i){i={};for(var m=0;m<l.length;m++)i["$"+l[m]]=!0;for(l=0;l<s.length;l++)m=i.hasOwnProperty("$"+s[l].value),s[l].selected!==m&&(s[l].selected=m),m&&u&&(s[l].defaultSelected=!0)}else{for(l=""+Tn(l),i=null,m=0;m<s.length;m++){if(s[m].value===l){s[m].selected=!0,u&&(s[m].defaultSelected=!0);return}i!==null||s[m].disabled||(i=s[m])}i!==null&&(i.selected=!0)}}function rt(s,i,l){if(i!=null&&(i=""+Tn(i),i!==s.value&&(s.value=i),l==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=l!=null?""+Tn(l):""}function tr(s,i,l,u){if(i==null){if(u!=null){if(l!=null)throw Error(a(92));if(ae(u)){if(1<u.length)throw Error(a(93));u=u[0]}l=u}l==null&&(l=""),i=l}l=Tn(i),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u)}function es(s,i){if(i){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=i;return}}s.textContent=i}var nr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Du(s,i,l){var u=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":u?s.setProperty(i,l):typeof l!="number"||l===0||nr.has(i)?i==="float"?s.cssFloat=l:s[i]=(""+l).trim():s[i]=l+"px"}function Dl(s,i,l){if(i!=null&&typeof i!="object")throw Error(a(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var m in i)u=i[m],i.hasOwnProperty(m)&&l[m]!==u&&Du(s,m,u)}else for(var g in i)i.hasOwnProperty(g)&&Du(s,g,i[g])}function Ol(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zr(s){return jf.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var la=null;function ts(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ca=null,ua=null;function Ml(s){var i=ws(s);if(i&&(s=i.stateNode)){var l=s[Dt]||null;e:switch(s=i.stateNode,i.type){case"input":if(Vn(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ot(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var u=l[i];if(u!==s&&u.form===s.form){var m=u[Dt]||null;if(!m)throw Error(a(90));Vn(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<l.length;i++)u=l[i],u.form===s.form&&Rl(u)}break e;case"textarea":rt(s,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&oa(s,!!l.multiple,i,!1)}}}var Ds=!1;function Ou(s,i,l){if(Ds)return s(i,l);Ds=!0;try{var u=s(i);return u}finally{if(Ds=!1,(ca!==null||ua!==null)&&(Cd(),ca&&(i=ca,s=ua,ua=ca=null,Ml(i),s)))for(i=0;i<s.length;i++)Ml(s[i])}}function sr(s,i){var l=s.stateNode;if(l===null)return null;var u=l[Dt]||null;if(u===null)return null;l=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(a(231,i,typeof l));return l}var gs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ns=!1;if(gs)try{var ar={};Object.defineProperty(ar,"passive",{get:function(){ns=!0}}),window.addEventListener("test",ar,ar),window.removeEventListener("test",ar,ar)}catch{ns=!1}var Os=null,$a=null,da=null;function Pl(){if(da)return da;var s,i=$a,l=i.length,u,m="value"in Os?Os.value:Os.textContent,g=m.length;for(s=0;s<l&&i[s]===m[s];s++);var T=l-s;for(u=1;u<=T&&i[l-u]===m[g-u];u++);return da=m.slice(s,1<u?1-u:void 0)}function Ms(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Ps(){return!0}function kl(){return!1}function Kt(s){function i(l,u,m,g,T){this._reactName=l,this._targetInst=m,this.type=u,this.nativeEvent=g,this.target=T,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(l=s[S],this[S]=l?l(g):g[S]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Ps:kl,this.isPropagationStopped=kl,this}return _(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ps)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ps)},persist:function(){},isPersistent:Ps}),i}var nt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jr=Kt(nt),ir=_({},nt,{view:0,detail:0}),Mu=Kt(ir),eo,to,ks,rr=_({},ir,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ks&&(ks&&s.type==="mousemove"?(eo=s.screenX-ks.screenX,to=s.screenY-ks.screenY):to=eo=0,ks=s),eo)},movementY:function(s){return"movementY"in s?s.movementY:to}}),ss=Kt(rr),Pu=_({},rr,{dataTransfer:0}),Sf=Kt(Pu),or=_({},ir,{relatedTarget:0}),no=Kt(or),Ll=_({},nt,{animationName:0,elapsedTime:0,pseudoElement:0}),so=Kt(Ll),ku=_({},nt,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ao=Kt(ku),wf=_({},nt,{data:0}),Vl=Kt(wf),lr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ul(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Vu[s])?!!i[s]:!1}function cr(){return Ul}var Uu=_({},ir,{key:function(s){if(s.key){var i=lr[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ms(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Lu[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cr,charCode:function(s){return s.type==="keypress"?Ms(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ms(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),io=Kt(Uu),Fu=_({},rr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fl=Kt(Fu),ha=_({},ir,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cr}),Hu=Kt(ha),qu=_({},nt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bu=Kt(qu),zu=_({},rr,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ro=Kt(zu),xn=_({},nt,{newState:0,oldState:0}),Gu=Kt(xn),$u=[9,13,27,32],Ls=gs&&"CompositionEvent"in window,h=null;gs&&"documentMode"in document&&(h=document.documentMode);var y=gs&&"TextEvent"in window&&!h,E=gs&&(!Ls||h&&8<h&&11>=h),D=" ",Q=!1;function te(s,i){switch(s){case"keyup":return $u.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function de(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ke=!1;function Ft(s,i){switch(s){case"compositionend":return de(i);case"keypress":return i.which!==32?null:(Q=!0,D);case"textInput":return s=i.data,s===D&&Q?null:s;default:return null}}function Qe(s,i){if(Ke)return s==="compositionend"||!Ls&&te(s,i)?(s=Pl(),da=$a=Os=null,Ke=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return E&&i.locale!=="ko"?null:i.data;default:return null}}var Qt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ht(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!Qt[s.type]:i==="textarea"}function fa(s,i,l,u){ca?ua?ua.push(u):ua=[u]:ca=u,i=Dd(i,"onChange"),0<i.length&&(l=new Jr("onChange","change",null,l,u),s.push({event:l,listeners:i}))}var nn=null,Vs=null;function Hl(s){SE(s,0)}function Yu(s){var i=Is(s);if(Rl(i))return s}function Qv(s,i){if(s==="change")return i}var Xv=!1;if(gs){var If;if(gs){var Rf="oninput"in document;if(!Rf){var Wv=document.createElement("div");Wv.setAttribute("oninput","return;"),Rf=typeof Wv.oninput=="function"}If=Rf}else If=!1;Xv=If&&(!document.documentMode||9<document.documentMode)}function Zv(){nn&&(nn.detachEvent("onpropertychange",Jv),Vs=nn=null)}function Jv(s){if(s.propertyName==="value"&&Yu(Vs)){var i=[];fa(i,Vs,s,ts(s)),Ou(Hl,i)}}function DC(s,i,l){s==="focusin"?(Zv(),nn=i,Vs=l,nn.attachEvent("onpropertychange",Jv)):s==="focusout"&&Zv()}function OC(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Yu(Vs)}function MC(s,i){if(s==="click")return Yu(i)}function PC(s,i){if(s==="input"||s==="change")return Yu(i)}function kC(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Un=typeof Object.is=="function"?Object.is:kC;function ql(s,i){if(Un(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var l=Object.keys(s),u=Object.keys(i);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var m=l[u];if(!qi.call(i,m)||!Un(s[m],i[m]))return!1}return!0}function ey(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ty(s,i){var l=ey(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=i&&u>=i)return{node:l,offset:i-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=ey(l)}}function ny(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?ny(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function sy(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Ji(s.document);i instanceof s.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)s=i.contentWindow;else break;i=Ji(s.document)}return i}function Df(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var LC=gs&&"documentMode"in document&&11>=document.documentMode,oo=null,Of=null,Bl=null,Mf=!1;function ay(s,i,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Mf||oo==null||oo!==Ji(u)||(u=oo,"selectionStart"in u&&Df(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Bl&&ql(Bl,u)||(Bl=u,u=Dd(Of,"onSelect"),0<u.length&&(i=new Jr("onSelect","select",null,i,l),s.push({event:i,listeners:u}),i.target=oo)))}function ur(s,i){var l={};return l[s.toLowerCase()]=i.toLowerCase(),l["Webkit"+s]="webkit"+i,l["Moz"+s]="moz"+i,l}var lo={animationend:ur("Animation","AnimationEnd"),animationiteration:ur("Animation","AnimationIteration"),animationstart:ur("Animation","AnimationStart"),transitionrun:ur("Transition","TransitionRun"),transitionstart:ur("Transition","TransitionStart"),transitioncancel:ur("Transition","TransitionCancel"),transitionend:ur("Transition","TransitionEnd")},Pf={},iy={};gs&&(iy=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function dr(s){if(Pf[s])return Pf[s];if(!lo[s])return s;var i=lo[s],l;for(l in i)if(i.hasOwnProperty(l)&&l in iy)return Pf[s]=i[l];return s}var ry=dr("animationend"),oy=dr("animationiteration"),ly=dr("animationstart"),VC=dr("transitionrun"),UC=dr("transitionstart"),FC=dr("transitioncancel"),cy=dr("transitionend"),uy=new Map,kf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");kf.push("scrollEnd");function vs(s,i){uy.set(s,i),ps(i,[s])}var dy=new WeakMap;function as(s,i){if(typeof s=="object"&&s!==null){var l=dy.get(s);return l!==void 0?l:(i={value:s,source:i,stack:Xr(i)},dy.set(s,i),i)}return{value:s,source:i,stack:Xr(i)}}var is=[],co=0,Lf=0;function Ku(){for(var s=co,i=Lf=co=0;i<s;){var l=is[i];is[i++]=null;var u=is[i];is[i++]=null;var m=is[i];is[i++]=null;var g=is[i];if(is[i++]=null,u!==null&&m!==null){var T=u.pending;T===null?m.next=m:(m.next=T.next,T.next=m),u.pending=m}g!==0&&hy(l,m,g)}}function Qu(s,i,l,u){is[co++]=s,is[co++]=i,is[co++]=l,is[co++]=u,Lf|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function Vf(s,i,l,u){return Qu(s,i,l,u),Xu(s)}function uo(s,i){return Qu(s,null,null,i),Xu(s)}function hy(s,i,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var m=!1,g=s.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(s=g.stateNode,s===null||s._visibility&1||(m=!0)),s=g,g=g.return;return s.tag===3?(g=s.stateNode,m&&i!==null&&(m=31-mn(l),s=g.hiddenUpdates,u=s[m],u===null?s[m]=[i]:u.push(i),i.lane=l|536870912),g):null}function Xu(s){if(50<mc)throw mc=0,zm=null,Error(a(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var ho={};function HC(s,i,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(s,i,l,u){return new HC(s,i,l,u)}function Uf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ma(s,i){var l=s.alternate;return l===null?(l=Fn(s.tag,i,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=i,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,i=s.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function fy(s,i){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,i=l.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Wu(s,i,l,u,m,g){var T=0;if(u=s,typeof s=="function")Uf(s)&&(T=1);else if(typeof s=="string")T=Bj(s,l,Te.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=Fn(31,l,i,m),s.elementType=R,s.lanes=g,s;case b:return hr(l.children,m,g,i);case M:T=8,m|=24;break;case x:return s=Fn(12,l,i,m|2),s.elementType=x,s.lanes=g,s;case q:return s=Fn(13,l,i,m),s.elementType=q,s.lanes=g,s;case K:return s=Fn(19,l,i,m),s.elementType=K,s.lanes=g,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case V:case O:T=10;break e;case $:T=9;break e;case U:T=11;break e;case w:T=14;break e;case A:T=16,u=null;break e}T=29,l=Error(a(130,s===null?"null":typeof s,"")),u=null}return i=Fn(T,l,i,m),i.elementType=s,i.type=u,i.lanes=g,i}function hr(s,i,l,u){return s=Fn(7,s,u,i),s.lanes=l,s}function Ff(s,i,l){return s=Fn(6,s,null,i),s.lanes=l,s}function Hf(s,i,l){return i=Fn(4,s.children!==null?s.children:[],s.key,i),i.lanes=l,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var fo=[],mo=0,Zu=null,Ju=0,rs=[],os=0,fr=null,pa=1,ga="";function mr(s,i){fo[mo++]=Ju,fo[mo++]=Zu,Zu=s,Ju=i}function my(s,i,l){rs[os++]=pa,rs[os++]=ga,rs[os++]=fr,fr=s;var u=pa;s=ga;var m=32-mn(u)-1;u&=~(1<<m),l+=1;var g=32-mn(i)+m;if(30<g){var T=m-m%5;g=(u&(1<<T)-1).toString(32),u>>=T,m-=T,pa=1<<32-mn(i)+m|l<<m|u,ga=g+s}else pa=1<<g|l<<m|u,ga=s}function qf(s){s.return!==null&&(mr(s,1),my(s,1,0))}function Bf(s){for(;s===Zu;)Zu=fo[--mo],fo[mo]=null,Ju=fo[--mo],fo[mo]=null;for(;s===fr;)fr=rs[--os],rs[os]=null,ga=rs[--os],rs[os]=null,pa=rs[--os],rs[os]=null}var An=null,Tt=null,tt=!1,pr=null,Us=!1,zf=Error(a(519));function gr(s){var i=Error(a(418,""));throw $l(as(i,s)),zf}function py(s){var i=s.stateNode,l=s.type,u=s.memoizedProps;switch(i[Ut]=s,i[Dt]=u,l){case"dialog":qe("cancel",i),qe("close",i);break;case"iframe":case"object":case"embed":qe("load",i);break;case"video":case"audio":for(l=0;l<gc.length;l++)qe(gc[l],i);break;case"source":qe("error",i);break;case"img":case"image":case"link":qe("error",i),qe("load",i);break;case"details":qe("toggle",i);break;case"input":qe("invalid",i),er(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Wr(i);break;case"select":qe("invalid",i);break;case"textarea":qe("invalid",i),tr(i,u.value,u.defaultValue,u.children),Wr(i)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||u.suppressHydrationWarning===!0||DE(i.textContent,l)?(u.popover!=null&&(qe("beforetoggle",i),qe("toggle",i)),u.onScroll!=null&&qe("scroll",i),u.onScrollEnd!=null&&qe("scrollend",i),u.onClick!=null&&(i.onclick=Od),i=!0):i=!1,i||gr(s)}function gy(s){for(An=s.return;An;)switch(An.tag){case 5:case 13:Us=!1;return;case 27:case 3:Us=!0;return;default:An=An.return}}function zl(s){if(s!==An)return!1;if(!tt)return gy(s),tt=!0,!1;var i=s.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||rp(s.type,s.memoizedProps)),l=!l),l&&Tt&&gr(s),gy(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(i===0){Tt=_s(s.nextSibling);break e}i--}else l!=="$"&&l!=="$!"&&l!=="$?"||i++;s=s.nextSibling}Tt=null}}else i===27?(i=Tt,li(s.type)?(s=up,up=null,Tt=s):Tt=i):Tt=An?_s(s.stateNode.nextSibling):null;return!0}function Gl(){Tt=An=null,tt=!1}function vy(){var s=pr;return s!==null&&(Dn===null?Dn=s:Dn.push.apply(Dn,s),pr=null),s}function $l(s){pr===null?pr=[s]:pr.push(s)}var Gf=ne(null),vr=null,va=null;function Ya(s,i,l){ue(Gf,i._currentValue),i._currentValue=l}function ya(s){s._currentValue=Gf.current,he(Gf)}function $f(s,i,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),s===l)break;s=s.return}}function Yf(s,i,l,u){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var g=m.dependencies;if(g!==null){var T=m.child;g=g.firstContext;e:for(;g!==null;){var S=g;g=m;for(var F=0;F<i.length;F++)if(S.context===i[F]){g.lanes|=l,S=g.alternate,S!==null&&(S.lanes|=l),$f(g.return,l,s),u||(T=null);break e}g=S.next}}else if(m.tag===18){if(T=m.return,T===null)throw Error(a(341));T.lanes|=l,g=T.alternate,g!==null&&(g.lanes|=l),$f(T,l,s),T=null}else T=m.child;if(T!==null)T.return=m;else for(T=m;T!==null;){if(T===s){T=null;break}if(m=T.sibling,m!==null){m.return=T.return,T=m;break}T=T.return}m=T}}function Yl(s,i,l,u){s=null;for(var m=i,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var T=m.alternate;if(T===null)throw Error(a(387));if(T=T.memoizedProps,T!==null){var S=m.type;Un(m.pendingProps.value,T.value)||(s!==null?s.push(S):s=[S])}}else if(m===Yt.current){if(T=m.alternate,T===null)throw Error(a(387));T.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Nc):s=[Nc])}m=m.return}s!==null&&Yf(i,s,l,u),i.flags|=262144}function ed(s){for(s=s.firstContext;s!==null;){if(!Un(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function yr(s){vr=s,va=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function pn(s){return yy(vr,s)}function td(s,i){return vr===null&&yr(s),yy(s,i)}function yy(s,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},va===null){if(s===null)throw Error(a(308));va=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else va=va.next=i;return l}var qC=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){i.aborted=!0,s.forEach(function(l){return l()})}},BC=n.unstable_scheduleCallback,zC=n.unstable_NormalPriority,qt={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kf(){return{controller:new qC,data:new Map,refCount:0}}function Kl(s){s.refCount--,s.refCount===0&&BC(zC,function(){s.controller.abort()})}var Ql=null,Qf=0,po=0,go=null;function GC(s,i){if(Ql===null){var l=Ql=[];Qf=0,po=Wm(),go={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Qf++,i.then(_y,_y),i}function _y(){if(--Qf===0&&Ql!==null){go!==null&&(go.status="fulfilled");var s=Ql;Ql=null,po=0,go=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function $C(s,i){var l=[],u={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return s.then(function(){u.status="fulfilled",u.value=i;for(var m=0;m<l.length;m++)(0,l[m])(i)},function(m){for(u.status="rejected",u.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),u}var Ey=B.S;B.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&GC(s,i),Ey!==null&&Ey(s,i)};var _r=ne(null);function Xf(){var s=_r.current;return s!==null?s:mt.pooledCache}function nd(s,i){i===null?ue(_r,_r.current):ue(_r,i.pool)}function by(){var s=Xf();return s===null?null:{parent:qt._currentValue,pool:s}}var Xl=Error(a(460)),Ny=Error(a(474)),sd=Error(a(542)),Wf={then:function(){}};function Ty(s){return s=s.status,s==="fulfilled"||s==="rejected"}function ad(){}function xy(s,i,l){switch(l=s[l],l===void 0?s.push(i):l!==i&&(i.then(ad,ad),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Cy(s),s;default:if(typeof i.status=="string")i.then(ad,ad);else{if(s=mt,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=i,s.status="pending",s.then(function(u){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=u}},function(u){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Cy(s),s}throw Wl=i,Xl}}var Wl=null;function Ay(){if(Wl===null)throw Error(a(459));var s=Wl;return Wl=null,s}function Cy(s){if(s===Xl||s===sd)throw Error(a(483))}var Ka=!1;function Zf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jf(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Qa(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Xa(s,i,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(at&2)!==0){var m=u.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),u.pending=i,i=Xu(s),hy(s,null,l),i}return Qu(s,u,i,l),Xu(s)}function Zl(s,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,Cl(s,l)}}function em(s,i){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var m=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var T={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?m=g=T:g=g.next=T,l=l.next}while(l!==null);g===null?m=g=i:g=g.next=i}else m=g=i;l={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=i:s.next=i,l.lastBaseUpdate=i}var tm=!1;function Jl(){if(tm){var s=go;if(s!==null)throw s}}function ec(s,i,l,u){tm=!1;var m=s.updateQueue;Ka=!1;var g=m.firstBaseUpdate,T=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var F=S,W=F.next;F.next=null,T===null?g=W:T.next=W,T=F;var se=s.alternate;se!==null&&(se=se.updateQueue,S=se.lastBaseUpdate,S!==T&&(S===null?se.firstBaseUpdate=W:S.next=W,se.lastBaseUpdate=F))}if(g!==null){var oe=m.baseState;T=0,se=W=F=null,S=g;do{var Z=S.lane&-536870913,ee=Z!==S.lane;if(ee?(Xe&Z)===Z:(u&Z)===Z){Z!==0&&Z===po&&(tm=!0),se!==null&&(se=se.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var we=s,Ae=S;Z=i;var ct=l;switch(Ae.tag){case 1:if(we=Ae.payload,typeof we=="function"){oe=we.call(ct,oe,Z);break e}oe=we;break e;case 3:we.flags=we.flags&-65537|128;case 0:if(we=Ae.payload,Z=typeof we=="function"?we.call(ct,oe,Z):we,Z==null)break e;oe=_({},oe,Z);break e;case 2:Ka=!0}}Z=S.callback,Z!==null&&(s.flags|=64,ee&&(s.flags|=8192),ee=m.callbacks,ee===null?m.callbacks=[Z]:ee.push(Z))}else ee={lane:Z,tag:S.tag,payload:S.payload,callback:S.callback,next:null},se===null?(W=se=ee,F=oe):se=se.next=ee,T|=Z;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;ee=S,S=ee.next,ee.next=null,m.lastBaseUpdate=ee,m.shared.pending=null}}while(!0);se===null&&(F=oe),m.baseState=F,m.firstBaseUpdate=W,m.lastBaseUpdate=se,g===null&&(m.shared.lanes=0),ai|=T,s.lanes=T,s.memoizedState=oe}}function jy(s,i){if(typeof s!="function")throw Error(a(191,s));s.call(i)}function Sy(s,i){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)jy(l[s],i)}var vo=ne(null),id=ne(0);function wy(s,i){s=Aa,ue(id,s),ue(vo,i),Aa=s|i.baseLanes}function nm(){ue(id,Aa),ue(vo,vo.current)}function sm(){Aa=id.current,he(vo),he(id)}var Wa=0,Le=null,ot=null,Mt=null,rd=!1,yo=!1,Er=!1,od=0,tc=0,_o=null,YC=0;function St(){throw Error(a(321))}function am(s,i){if(i===null)return!1;for(var l=0;l<i.length&&l<s.length;l++)if(!Un(s[l],i[l]))return!1;return!0}function im(s,i,l,u,m,g){return Wa=g,Le=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,B.H=s===null||s.memoizedState===null?h_:f_,Er=!1,g=l(u,m),Er=!1,yo&&(g=Ry(i,l,u,m)),Iy(s),g}function Iy(s){B.H=fd;var i=ot!==null&&ot.next!==null;if(Wa=0,Mt=ot=Le=null,rd=!1,tc=0,_o=null,i)throw Error(a(300));s===null||Xt||(s=s.dependencies,s!==null&&ed(s)&&(Xt=!0))}function Ry(s,i,l,u){Le=s;var m=0;do{if(yo&&(_o=null),tc=0,yo=!1,25<=m)throw Error(a(301));if(m+=1,Mt=ot=null,s.updateQueue!=null){var g=s.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}B.H=ej,g=i(l,u)}while(yo);return g}function KC(){var s=B.H,i=s.useState()[0];return i=typeof i.then=="function"?nc(i):i,s=s.useState()[0],(ot!==null?ot.memoizedState:null)!==s&&(Le.flags|=1024),i}function rm(){var s=od!==0;return od=0,s}function om(s,i,l){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~l}function lm(s){if(rd){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}rd=!1}Wa=0,Mt=ot=Le=null,yo=!1,tc=od=0,_o=null}function In(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?Le.memoizedState=Mt=s:Mt=Mt.next=s,Mt}function Pt(){if(ot===null){var s=Le.alternate;s=s!==null?s.memoizedState:null}else s=ot.next;var i=Mt===null?Le.memoizedState:Mt.next;if(i!==null)Mt=i,ot=s;else{if(s===null)throw Le.alternate===null?Error(a(467)):Error(a(310));ot=s,s={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},Mt===null?Le.memoizedState=Mt=s:Mt=Mt.next=s}return Mt}function cm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function nc(s){var i=tc;return tc+=1,_o===null&&(_o=[]),s=xy(_o,s,i),i=Le,(Mt===null?i.memoizedState:Mt.next)===null&&(i=i.alternate,B.H=i===null||i.memoizedState===null?h_:f_),s}function ld(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return nc(s);if(s.$$typeof===O)return pn(s)}throw Error(a(438,String(s)))}function um(s){var i=null,l=Le.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var u=Le.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=cm(),Le.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(s),u=0;u<s;u++)l[u]=I;return i.index++,l}function _a(s,i){return typeof i=="function"?i(s):i}function cd(s){var i=Pt();return dm(i,ot,s)}function dm(s,i,l){var u=s.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=l;var m=s.baseQueue,g=u.pending;if(g!==null){if(m!==null){var T=m.next;m.next=g.next,g.next=T}i.baseQueue=m=g,u.pending=null}if(g=s.baseState,m===null)s.memoizedState=g;else{i=m.next;var S=T=null,F=null,W=i,se=!1;do{var oe=W.lane&-536870913;if(oe!==W.lane?(Xe&oe)===oe:(Wa&oe)===oe){var Z=W.revertLane;if(Z===0)F!==null&&(F=F.next={lane:0,revertLane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),oe===po&&(se=!0);else if((Wa&Z)===Z){W=W.next,Z===po&&(se=!0);continue}else oe={lane:0,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},F===null?(S=F=oe,T=g):F=F.next=oe,Le.lanes|=Z,ai|=Z;oe=W.action,Er&&l(g,oe),g=W.hasEagerState?W.eagerState:l(g,oe)}else Z={lane:oe,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},F===null?(S=F=Z,T=g):F=F.next=Z,Le.lanes|=oe,ai|=oe;W=W.next}while(W!==null&&W!==i);if(F===null?T=g:F.next=S,!Un(g,s.memoizedState)&&(Xt=!0,se&&(l=go,l!==null)))throw l;s.memoizedState=g,s.baseState=T,s.baseQueue=F,u.lastRenderedState=g}return m===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function hm(s){var i=Pt(),l=i.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=s;var u=l.dispatch,m=l.pending,g=i.memoizedState;if(m!==null){l.pending=null;var T=m=m.next;do g=s(g,T.action),T=T.next;while(T!==m);Un(g,i.memoizedState)||(Xt=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),l.lastRenderedState=g}return[g,u]}function Dy(s,i,l){var u=Le,m=Pt(),g=tt;if(g){if(l===void 0)throw Error(a(407));l=l()}else l=i();var T=!Un((ot||m).memoizedState,l);T&&(m.memoizedState=l,Xt=!0),m=m.queue;var S=Py.bind(null,u,m,s);if(sc(2048,8,S,[s]),m.getSnapshot!==i||T||Mt!==null&&Mt.memoizedState.tag&1){if(u.flags|=2048,Eo(9,ud(),My.bind(null,u,m,l,i),null),mt===null)throw Error(a(349));g||(Wa&124)!==0||Oy(u,i,l)}return l}function Oy(s,i,l){s.flags|=16384,s={getSnapshot:i,value:l},i=Le.updateQueue,i===null?(i=cm(),Le.updateQueue=i,i.stores=[s]):(l=i.stores,l===null?i.stores=[s]:l.push(s))}function My(s,i,l,u){i.value=l,i.getSnapshot=u,ky(i)&&Ly(s)}function Py(s,i,l){return l(function(){ky(i)&&Ly(s)})}function ky(s){var i=s.getSnapshot;s=s.value;try{var l=i();return!Un(s,l)}catch{return!0}}function Ly(s){var i=uo(s,2);i!==null&&Gn(i,s,2)}function fm(s){var i=In();if(typeof s=="function"){var l=s;if(s=l(),Er){Ln(!0);try{l()}finally{Ln(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:s},i}function Vy(s,i,l,u){return s.baseState=l,dm(s,ot,typeof u=="function"?u:_a)}function QC(s,i,l,u,m){if(hd(s))throw Error(a(485));if(s=i.action,s!==null){var g={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){g.listeners.push(T)}};B.T!==null?l(!0):g.isTransition=!1,u(g),l=i.pending,l===null?(g.next=i.pending=g,Uy(i,g)):(g.next=l.next,i.pending=l.next=g)}}function Uy(s,i){var l=i.action,u=i.payload,m=s.state;if(i.isTransition){var g=B.T,T={};B.T=T;try{var S=l(m,u),F=B.S;F!==null&&F(T,S),Fy(s,i,S)}catch(W){mm(s,i,W)}finally{B.T=g}}else try{g=l(m,u),Fy(s,i,g)}catch(W){mm(s,i,W)}}function Fy(s,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Hy(s,i,u)},function(u){return mm(s,i,u)}):Hy(s,i,l)}function Hy(s,i,l){i.status="fulfilled",i.value=l,qy(i),s.state=l,i=s.pending,i!==null&&(l=i.next,l===i?s.pending=null:(l=l.next,i.next=l,Uy(s,l)))}function mm(s,i,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=l,qy(i),i=i.next;while(i!==u)}s.action=null}function qy(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function By(s,i){return i}function zy(s,i){if(tt){var l=mt.formState;if(l!==null){e:{var u=Le;if(tt){if(Tt){t:{for(var m=Tt,g=Us;m.nodeType!==8;){if(!g){m=null;break t}if(m=_s(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){Tt=_s(m.nextSibling),u=m.data==="F!";break e}}gr(u)}u=!1}u&&(i=l[0])}}return l=In(),l.memoizedState=l.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:By,lastRenderedState:i},l.queue=u,l=c_.bind(null,Le,u),u.dispatch=l,u=fm(!1),g=_m.bind(null,Le,!1,u.queue),u=In(),m={state:i,dispatch:null,action:s,pending:null},u.queue=m,l=QC.bind(null,Le,m,g,l),m.dispatch=l,u.memoizedState=s,[i,l,!1]}function Gy(s){var i=Pt();return $y(i,ot,s)}function $y(s,i,l){if(i=dm(s,i,By)[0],s=cd(_a)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=nc(i)}catch(T){throw T===Xl?sd:T}else u=i;i=Pt();var m=i.queue,g=m.dispatch;return l!==i.memoizedState&&(Le.flags|=2048,Eo(9,ud(),XC.bind(null,m,l),null)),[u,g,s]}function XC(s,i){s.action=i}function Yy(s){var i=Pt(),l=ot;if(l!==null)return $y(i,l,s);Pt(),i=i.memoizedState,l=Pt();var u=l.queue.dispatch;return l.memoizedState=s,[i,u,!1]}function Eo(s,i,l,u){return s={tag:s,create:l,deps:u,inst:i,next:null},i=Le.updateQueue,i===null&&(i=cm(),Le.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,i.lastEffect=s),s}function ud(){return{destroy:void 0,resource:void 0}}function Ky(){return Pt().memoizedState}function dd(s,i,l,u){var m=In();u=u===void 0?null:u,Le.flags|=s,m.memoizedState=Eo(1|i,ud(),l,u)}function sc(s,i,l,u){var m=Pt();u=u===void 0?null:u;var g=m.memoizedState.inst;ot!==null&&u!==null&&am(u,ot.memoizedState.deps)?m.memoizedState=Eo(i,g,l,u):(Le.flags|=s,m.memoizedState=Eo(1|i,g,l,u))}function Qy(s,i){dd(8390656,8,s,i)}function Xy(s,i){sc(2048,8,s,i)}function Wy(s,i){return sc(4,2,s,i)}function Zy(s,i){return sc(4,4,s,i)}function Jy(s,i){if(typeof i=="function"){s=s();var l=i(s);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function e_(s,i,l){l=l!=null?l.concat([s]):null,sc(4,4,Jy.bind(null,i,s),l)}function pm(){}function t_(s,i){var l=Pt();i=i===void 0?null:i;var u=l.memoizedState;return i!==null&&am(i,u[1])?u[0]:(l.memoizedState=[s,i],s)}function n_(s,i){var l=Pt();i=i===void 0?null:i;var u=l.memoizedState;if(i!==null&&am(i,u[1]))return u[0];if(u=s(),Er){Ln(!0);try{s()}finally{Ln(!1)}}return l.memoizedState=[u,i],u}function gm(s,i,l){return l===void 0||(Wa&1073741824)!==0?s.memoizedState=i:(s.memoizedState=l,s=iE(),Le.lanes|=s,ai|=s,l)}function s_(s,i,l,u){return Un(l,i)?l:vo.current!==null?(s=gm(s,l,u),Un(s,i)||(Xt=!0),s):(Wa&42)===0?(Xt=!0,s.memoizedState=l):(s=iE(),Le.lanes|=s,ai|=s,i)}function a_(s,i,l,u,m){var g=J.p;J.p=g!==0&&8>g?g:8;var T=B.T,S={};B.T=S,_m(s,!1,i,l);try{var F=m(),W=B.S;if(W!==null&&W(S,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var se=$C(F,u);ac(s,i,se,zn(s))}else ac(s,i,u,zn(s))}catch(oe){ac(s,i,{then:function(){},status:"rejected",reason:oe},zn())}finally{J.p=g,B.T=T}}function WC(){}function vm(s,i,l,u){if(s.tag!==5)throw Error(a(476));var m=i_(s).queue;a_(s,m,i,ce,l===null?WC:function(){return r_(s),l(u)})}function i_(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:ce},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:l},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function r_(s){var i=i_(s).next.queue;ac(s,i,{},zn())}function ym(){return pn(Nc)}function o_(){return Pt().memoizedState}function l_(){return Pt().memoizedState}function ZC(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var l=zn();s=Qa(l);var u=Xa(i,s,l);u!==null&&(Gn(u,i,l),Zl(u,i,l)),i={cache:Kf()},s.payload=i;return}i=i.return}}function JC(s,i,l){var u=zn();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},hd(s)?u_(i,l):(l=Vf(s,i,l,u),l!==null&&(Gn(l,s,u),d_(l,i,u)))}function c_(s,i,l){var u=zn();ac(s,i,l,u)}function ac(s,i,l,u){var m={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(hd(s))u_(i,m);else{var g=s.alternate;if(s.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var T=i.lastRenderedState,S=g(T,l);if(m.hasEagerState=!0,m.eagerState=S,Un(S,T))return Qu(s,i,m,0),mt===null&&Ku(),!1}catch{}finally{}if(l=Vf(s,i,m,u),l!==null)return Gn(l,s,u),d_(l,i,u),!0}return!1}function _m(s,i,l,u){if(u={lane:2,revertLane:Wm(),action:u,hasEagerState:!1,eagerState:null,next:null},hd(s)){if(i)throw Error(a(479))}else i=Vf(s,l,u,2),i!==null&&Gn(i,s,2)}function hd(s){var i=s.alternate;return s===Le||i!==null&&i===Le}function u_(s,i){yo=rd=!0;var l=s.pending;l===null?i.next=i:(i.next=l.next,l.next=i),s.pending=i}function d_(s,i,l){if((l&4194048)!==0){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,Cl(s,l)}}var fd={readContext:pn,use:ld,useCallback:St,useContext:St,useEffect:St,useImperativeHandle:St,useLayoutEffect:St,useInsertionEffect:St,useMemo:St,useReducer:St,useRef:St,useState:St,useDebugValue:St,useDeferredValue:St,useTransition:St,useSyncExternalStore:St,useId:St,useHostTransitionStatus:St,useFormState:St,useActionState:St,useOptimistic:St,useMemoCache:St,useCacheRefresh:St},h_={readContext:pn,use:ld,useCallback:function(s,i){return In().memoizedState=[s,i===void 0?null:i],s},useContext:pn,useEffect:Qy,useImperativeHandle:function(s,i,l){l=l!=null?l.concat([s]):null,dd(4194308,4,Jy.bind(null,i,s),l)},useLayoutEffect:function(s,i){return dd(4194308,4,s,i)},useInsertionEffect:function(s,i){dd(4,2,s,i)},useMemo:function(s,i){var l=In();i=i===void 0?null:i;var u=s();if(Er){Ln(!0);try{s()}finally{Ln(!1)}}return l.memoizedState=[u,i],u},useReducer:function(s,i,l){var u=In();if(l!==void 0){var m=l(i);if(Er){Ln(!0);try{l(i)}finally{Ln(!1)}}}else m=i;return u.memoizedState=u.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},u.queue=s,s=s.dispatch=JC.bind(null,Le,s),[u.memoizedState,s]},useRef:function(s){var i=In();return s={current:s},i.memoizedState=s},useState:function(s){s=fm(s);var i=s.queue,l=c_.bind(null,Le,i);return i.dispatch=l,[s.memoizedState,l]},useDebugValue:pm,useDeferredValue:function(s,i){var l=In();return gm(l,s,i)},useTransition:function(){var s=fm(!1);return s=a_.bind(null,Le,s.queue,!0,!1),In().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,l){var u=Le,m=In();if(tt){if(l===void 0)throw Error(a(407));l=l()}else{if(l=i(),mt===null)throw Error(a(349));(Xe&124)!==0||Oy(u,i,l)}m.memoizedState=l;var g={value:l,getSnapshot:i};return m.queue=g,Qy(Py.bind(null,u,g,s),[s]),u.flags|=2048,Eo(9,ud(),My.bind(null,u,g,l,i),null),l},useId:function(){var s=In(),i=mt.identifierPrefix;if(tt){var l=ga,u=pa;l=(u&~(1<<32-mn(u)-1)).toString(32)+l,i="«"+i+"R"+l,l=od++,0<l&&(i+="H"+l.toString(32)),i+="»"}else l=YC++,i="«"+i+"r"+l.toString(32)+"»";return s.memoizedState=i},useHostTransitionStatus:ym,useFormState:zy,useActionState:zy,useOptimistic:function(s){var i=In();i.memoizedState=i.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=_m.bind(null,Le,!0,l),l.dispatch=i,[s,i]},useMemoCache:um,useCacheRefresh:function(){return In().memoizedState=ZC.bind(null,Le)}},f_={readContext:pn,use:ld,useCallback:t_,useContext:pn,useEffect:Xy,useImperativeHandle:e_,useInsertionEffect:Wy,useLayoutEffect:Zy,useMemo:n_,useReducer:cd,useRef:Ky,useState:function(){return cd(_a)},useDebugValue:pm,useDeferredValue:function(s,i){var l=Pt();return s_(l,ot.memoizedState,s,i)},useTransition:function(){var s=cd(_a)[0],i=Pt().memoizedState;return[typeof s=="boolean"?s:nc(s),i]},useSyncExternalStore:Dy,useId:o_,useHostTransitionStatus:ym,useFormState:Gy,useActionState:Gy,useOptimistic:function(s,i){var l=Pt();return Vy(l,ot,s,i)},useMemoCache:um,useCacheRefresh:l_},ej={readContext:pn,use:ld,useCallback:t_,useContext:pn,useEffect:Xy,useImperativeHandle:e_,useInsertionEffect:Wy,useLayoutEffect:Zy,useMemo:n_,useReducer:hm,useRef:Ky,useState:function(){return hm(_a)},useDebugValue:pm,useDeferredValue:function(s,i){var l=Pt();return ot===null?gm(l,s,i):s_(l,ot.memoizedState,s,i)},useTransition:function(){var s=hm(_a)[0],i=Pt().memoizedState;return[typeof s=="boolean"?s:nc(s),i]},useSyncExternalStore:Dy,useId:o_,useHostTransitionStatus:ym,useFormState:Yy,useActionState:Yy,useOptimistic:function(s,i){var l=Pt();return ot!==null?Vy(l,ot,s,i):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:um,useCacheRefresh:l_},bo=null,ic=0;function md(s){var i=ic;return ic+=1,bo===null&&(bo=[]),xy(bo,s,i)}function rc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function pd(s,i){throw i.$$typeof===N?Error(a(525)):(s=Object.prototype.toString.call(i),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function m_(s){var i=s._init;return i(s._payload)}function p_(s){function i(G,z){if(s){var X=G.deletions;X===null?(G.deletions=[z],G.flags|=16):X.push(z)}}function l(G,z){if(!s)return null;for(;z!==null;)i(G,z),z=z.sibling;return null}function u(G){for(var z=new Map;G!==null;)G.key!==null?z.set(G.key,G):z.set(G.index,G),G=G.sibling;return z}function m(G,z){return G=ma(G,z),G.index=0,G.sibling=null,G}function g(G,z,X){return G.index=X,s?(X=G.alternate,X!==null?(X=X.index,X<z?(G.flags|=67108866,z):X):(G.flags|=67108866,z)):(G.flags|=1048576,z)}function T(G){return s&&G.alternate===null&&(G.flags|=67108866),G}function S(G,z,X,ie){return z===null||z.tag!==6?(z=Ff(X,G.mode,ie),z.return=G,z):(z=m(z,X),z.return=G,z)}function F(G,z,X,ie){var ye=X.type;return ye===b?se(G,z,X.props.children,ie,X.key):z!==null&&(z.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===A&&m_(ye)===z.type)?(z=m(z,X.props),rc(z,X),z.return=G,z):(z=Wu(X.type,X.key,X.props,null,G.mode,ie),rc(z,X),z.return=G,z)}function W(G,z,X,ie){return z===null||z.tag!==4||z.stateNode.containerInfo!==X.containerInfo||z.stateNode.implementation!==X.implementation?(z=Hf(X,G.mode,ie),z.return=G,z):(z=m(z,X.children||[]),z.return=G,z)}function se(G,z,X,ie,ye){return z===null||z.tag!==7?(z=hr(X,G.mode,ie,ye),z.return=G,z):(z=m(z,X),z.return=G,z)}function oe(G,z,X){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Ff(""+z,G.mode,X),z.return=G,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case C:return X=Wu(z.type,z.key,z.props,null,G.mode,X),rc(X,z),X.return=G,X;case j:return z=Hf(z,G.mode,X),z.return=G,z;case A:var ie=z._init;return z=ie(z._payload),oe(G,z,X)}if(ae(z)||P(z))return z=hr(z,G.mode,X,null),z.return=G,z;if(typeof z.then=="function")return oe(G,md(z),X);if(z.$$typeof===O)return oe(G,td(G,z),X);pd(G,z)}return null}function Z(G,z,X,ie){var ye=z!==null?z.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return ye!==null?null:S(G,z,""+X,ie);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case C:return X.key===ye?F(G,z,X,ie):null;case j:return X.key===ye?W(G,z,X,ie):null;case A:return ye=X._init,X=ye(X._payload),Z(G,z,X,ie)}if(ae(X)||P(X))return ye!==null?null:se(G,z,X,ie,null);if(typeof X.then=="function")return Z(G,z,md(X),ie);if(X.$$typeof===O)return Z(G,z,td(G,X),ie);pd(G,X)}return null}function ee(G,z,X,ie,ye){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return G=G.get(X)||null,S(z,G,""+ie,ye);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case C:return G=G.get(ie.key===null?X:ie.key)||null,F(z,G,ie,ye);case j:return G=G.get(ie.key===null?X:ie.key)||null,W(z,G,ie,ye);case A:var Fe=ie._init;return ie=Fe(ie._payload),ee(G,z,X,ie,ye)}if(ae(ie)||P(ie))return G=G.get(X)||null,se(z,G,ie,ye,null);if(typeof ie.then=="function")return ee(G,z,X,md(ie),ye);if(ie.$$typeof===O)return ee(G,z,X,td(z,ie),ye);pd(z,ie)}return null}function we(G,z,X,ie){for(var ye=null,Fe=null,_e=z,Ce=z=0,Zt=null;_e!==null&&Ce<X.length;Ce++){_e.index>Ce?(Zt=_e,_e=null):Zt=_e.sibling;var et=Z(G,_e,X[Ce],ie);if(et===null){_e===null&&(_e=Zt);break}s&&_e&&et.alternate===null&&i(G,_e),z=g(et,z,Ce),Fe===null?ye=et:Fe.sibling=et,Fe=et,_e=Zt}if(Ce===X.length)return l(G,_e),tt&&mr(G,Ce),ye;if(_e===null){for(;Ce<X.length;Ce++)_e=oe(G,X[Ce],ie),_e!==null&&(z=g(_e,z,Ce),Fe===null?ye=_e:Fe.sibling=_e,Fe=_e);return tt&&mr(G,Ce),ye}for(_e=u(_e);Ce<X.length;Ce++)Zt=ee(_e,G,Ce,X[Ce],ie),Zt!==null&&(s&&Zt.alternate!==null&&_e.delete(Zt.key===null?Ce:Zt.key),z=g(Zt,z,Ce),Fe===null?ye=Zt:Fe.sibling=Zt,Fe=Zt);return s&&_e.forEach(function(fi){return i(G,fi)}),tt&&mr(G,Ce),ye}function Ae(G,z,X,ie){if(X==null)throw Error(a(151));for(var ye=null,Fe=null,_e=z,Ce=z=0,Zt=null,et=X.next();_e!==null&&!et.done;Ce++,et=X.next()){_e.index>Ce?(Zt=_e,_e=null):Zt=_e.sibling;var fi=Z(G,_e,et.value,ie);if(fi===null){_e===null&&(_e=Zt);break}s&&_e&&fi.alternate===null&&i(G,_e),z=g(fi,z,Ce),Fe===null?ye=fi:Fe.sibling=fi,Fe=fi,_e=Zt}if(et.done)return l(G,_e),tt&&mr(G,Ce),ye;if(_e===null){for(;!et.done;Ce++,et=X.next())et=oe(G,et.value,ie),et!==null&&(z=g(et,z,Ce),Fe===null?ye=et:Fe.sibling=et,Fe=et);return tt&&mr(G,Ce),ye}for(_e=u(_e);!et.done;Ce++,et=X.next())et=ee(_e,G,Ce,et.value,ie),et!==null&&(s&&et.alternate!==null&&_e.delete(et.key===null?Ce:et.key),z=g(et,z,Ce),Fe===null?ye=et:Fe.sibling=et,Fe=et);return s&&_e.forEach(function(tS){return i(G,tS)}),tt&&mr(G,Ce),ye}function ct(G,z,X,ie){if(typeof X=="object"&&X!==null&&X.type===b&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case C:e:{for(var ye=X.key;z!==null;){if(z.key===ye){if(ye=X.type,ye===b){if(z.tag===7){l(G,z.sibling),ie=m(z,X.props.children),ie.return=G,G=ie;break e}}else if(z.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===A&&m_(ye)===z.type){l(G,z.sibling),ie=m(z,X.props),rc(ie,X),ie.return=G,G=ie;break e}l(G,z);break}else i(G,z);z=z.sibling}X.type===b?(ie=hr(X.props.children,G.mode,ie,X.key),ie.return=G,G=ie):(ie=Wu(X.type,X.key,X.props,null,G.mode,ie),rc(ie,X),ie.return=G,G=ie)}return T(G);case j:e:{for(ye=X.key;z!==null;){if(z.key===ye)if(z.tag===4&&z.stateNode.containerInfo===X.containerInfo&&z.stateNode.implementation===X.implementation){l(G,z.sibling),ie=m(z,X.children||[]),ie.return=G,G=ie;break e}else{l(G,z);break}else i(G,z);z=z.sibling}ie=Hf(X,G.mode,ie),ie.return=G,G=ie}return T(G);case A:return ye=X._init,X=ye(X._payload),ct(G,z,X,ie)}if(ae(X))return we(G,z,X,ie);if(P(X)){if(ye=P(X),typeof ye!="function")throw Error(a(150));return X=ye.call(X),Ae(G,z,X,ie)}if(typeof X.then=="function")return ct(G,z,md(X),ie);if(X.$$typeof===O)return ct(G,z,td(G,X),ie);pd(G,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,z!==null&&z.tag===6?(l(G,z.sibling),ie=m(z,X),ie.return=G,G=ie):(l(G,z),ie=Ff(X,G.mode,ie),ie.return=G,G=ie),T(G)):l(G,z)}return function(G,z,X,ie){try{ic=0;var ye=ct(G,z,X,ie);return bo=null,ye}catch(_e){if(_e===Xl||_e===sd)throw _e;var Fe=Fn(29,_e,null,G.mode);return Fe.lanes=ie,Fe.return=G,Fe}finally{}}}var No=p_(!0),g_=p_(!1),ls=ne(null),Fs=null;function Za(s){var i=s.alternate;ue(Bt,Bt.current&1),ue(ls,s),Fs===null&&(i===null||vo.current!==null||i.memoizedState!==null)&&(Fs=s)}function v_(s){if(s.tag===22){if(ue(Bt,Bt.current),ue(ls,s),Fs===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(Fs=s)}}else Ja()}function Ja(){ue(Bt,Bt.current),ue(ls,ls.current)}function Ea(s){he(ls),Fs===s&&(Fs=null),he(Bt)}var Bt=ne(0);function gd(s){for(var i=s;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||cp(l)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function Em(s,i,l,u){i=s.memoizedState,l=l(u,i),l=l==null?i:_({},i,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var bm={enqueueSetState:function(s,i,l){s=s._reactInternals;var u=zn(),m=Qa(u);m.payload=i,l!=null&&(m.callback=l),i=Xa(s,m,u),i!==null&&(Gn(i,s,u),Zl(i,s,u))},enqueueReplaceState:function(s,i,l){s=s._reactInternals;var u=zn(),m=Qa(u);m.tag=1,m.payload=i,l!=null&&(m.callback=l),i=Xa(s,m,u),i!==null&&(Gn(i,s,u),Zl(i,s,u))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var l=zn(),u=Qa(l);u.tag=2,i!=null&&(u.callback=i),i=Xa(s,u,l),i!==null&&(Gn(i,s,l),Zl(i,s,l))}};function y_(s,i,l,u,m,g,T){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,g,T):i.prototype&&i.prototype.isPureReactComponent?!ql(l,u)||!ql(m,g):!0}function __(s,i,l,u){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,u),i.state!==s&&bm.enqueueReplaceState(i,i.state,null)}function br(s,i){var l=i;if("ref"in i){l={};for(var u in i)u!=="ref"&&(l[u]=i[u])}if(s=s.defaultProps){l===i&&(l=_({},l));for(var m in s)l[m]===void 0&&(l[m]=s[m])}return l}var vd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function E_(s){vd(s)}function b_(s){console.error(s)}function N_(s){vd(s)}function yd(s,i){try{var l=s.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function T_(s,i,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Nm(s,i,l){return l=Qa(l),l.tag=3,l.payload={element:null},l.callback=function(){yd(s,i)},l}function x_(s){return s=Qa(s),s.tag=3,s}function A_(s,i,l,u){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var g=u.value;s.payload=function(){return m(g)},s.callback=function(){T_(i,l,u)}}var T=l.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(s.callback=function(){T_(i,l,u),typeof m!="function"&&(ii===null?ii=new Set([this]):ii.add(this));var S=u.stack;this.componentDidCatch(u.value,{componentStack:S!==null?S:""})})}function tj(s,i,l,u,m){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=l.alternate,i!==null&&Yl(i,l,m,!0),l=ls.current,l!==null){switch(l.tag){case 13:return Fs===null?$m():l.alternate===null&&xt===0&&(xt=3),l.flags&=-257,l.flags|=65536,l.lanes=m,u===Wf?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([u]):i.add(u),Km(s,u,m)),!1;case 22:return l.flags|=65536,u===Wf?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([u]):l.add(u)),Km(s,u,m)),!1}throw Error(a(435,l.tag))}return Km(s,u,m),$m(),!1}if(tt)return i=ls.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,u!==zf&&(s=Error(a(422),{cause:u}),$l(as(s,l)))):(u!==zf&&(i=Error(a(423),{cause:u}),$l(as(i,l))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,u=as(u,l),m=Nm(s.stateNode,u,m),em(s,m),xt!==4&&(xt=2)),!1;var g=Error(a(520),{cause:u});if(g=as(g,l),fc===null?fc=[g]:fc.push(g),xt!==4&&(xt=2),i===null)return!0;u=as(u,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,s=m&-m,l.lanes|=s,s=Nm(l.stateNode,u,s),em(l,s),!1;case 1:if(i=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(ii===null||!ii.has(g))))return l.flags|=65536,m&=-m,l.lanes|=m,m=x_(m),A_(m,s,l,u),em(l,m),!1}l=l.return}while(l!==null);return!1}var C_=Error(a(461)),Xt=!1;function sn(s,i,l,u){i.child=s===null?g_(i,null,l,u):No(i,s.child,l,u)}function j_(s,i,l,u,m){l=l.render;var g=i.ref;if("ref"in u){var T={};for(var S in u)S!=="ref"&&(T[S]=u[S])}else T=u;return yr(i),u=im(s,i,l,T,g,m),S=rm(),s!==null&&!Xt?(om(s,i,m),ba(s,i,m)):(tt&&S&&qf(i),i.flags|=1,sn(s,i,u,m),i.child)}function S_(s,i,l,u,m){if(s===null){var g=l.type;return typeof g=="function"&&!Uf(g)&&g.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=g,w_(s,i,g,u,m)):(s=Wu(l.type,null,u,i,i.mode,m),s.ref=i.ref,s.return=i,i.child=s)}if(g=s.child,!Im(s,m)){var T=g.memoizedProps;if(l=l.compare,l=l!==null?l:ql,l(T,u)&&s.ref===i.ref)return ba(s,i,m)}return i.flags|=1,s=ma(g,u),s.ref=i.ref,s.return=i,i.child=s}function w_(s,i,l,u,m){if(s!==null){var g=s.memoizedProps;if(ql(g,u)&&s.ref===i.ref)if(Xt=!1,i.pendingProps=u=g,Im(s,m))(s.flags&131072)!==0&&(Xt=!0);else return i.lanes=s.lanes,ba(s,i,m)}return Tm(s,i,l,u,m)}function I_(s,i,l){var u=i.pendingProps,m=u.children,g=s!==null?s.memoizedState:null;if(u.mode==="hidden"){if((i.flags&128)!==0){if(u=g!==null?g.baseLanes|l:l,s!==null){for(m=i.child=s.child,g=0;m!==null;)g=g|m.lanes|m.childLanes,m=m.sibling;i.childLanes=g&~u}else i.childLanes=0,i.child=null;return R_(s,i,u,l)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&nd(i,g!==null?g.cachePool:null),g!==null?wy(i,g):nm(),v_(i);else return i.lanes=i.childLanes=536870912,R_(s,i,g!==null?g.baseLanes|l:l,l)}else g!==null?(nd(i,g.cachePool),wy(i,g),Ja(),i.memoizedState=null):(s!==null&&nd(i,null),nm(),Ja());return sn(s,i,m,l),i.child}function R_(s,i,l,u){var m=Xf();return m=m===null?null:{parent:qt._currentValue,pool:m},i.memoizedState={baseLanes:l,cachePool:m},s!==null&&nd(i,null),nm(),v_(i),s!==null&&Yl(s,i,u,!0),null}function _d(s,i){var l=i.ref;if(l===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(a(284));(s===null||s.ref!==l)&&(i.flags|=4194816)}}function Tm(s,i,l,u,m){return yr(i),l=im(s,i,l,u,void 0,m),u=rm(),s!==null&&!Xt?(om(s,i,m),ba(s,i,m)):(tt&&u&&qf(i),i.flags|=1,sn(s,i,l,m),i.child)}function D_(s,i,l,u,m,g){return yr(i),i.updateQueue=null,l=Ry(i,u,l,m),Iy(s),u=rm(),s!==null&&!Xt?(om(s,i,g),ba(s,i,g)):(tt&&u&&qf(i),i.flags|=1,sn(s,i,l,g),i.child)}function O_(s,i,l,u,m){if(yr(i),i.stateNode===null){var g=ho,T=l.contextType;typeof T=="object"&&T!==null&&(g=pn(T)),g=new l(u,g),i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=bm,i.stateNode=g,g._reactInternals=i,g=i.stateNode,g.props=u,g.state=i.memoizedState,g.refs={},Zf(i),T=l.contextType,g.context=typeof T=="object"&&T!==null?pn(T):ho,g.state=i.memoizedState,T=l.getDerivedStateFromProps,typeof T=="function"&&(Em(i,l,T,u),g.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(T=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),T!==g.state&&bm.enqueueReplaceState(g,g.state,null),ec(i,u,g,m),Jl(),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(s===null){g=i.stateNode;var S=i.memoizedProps,F=br(l,S);g.props=F;var W=g.context,se=l.contextType;T=ho,typeof se=="object"&&se!==null&&(T=pn(se));var oe=l.getDerivedStateFromProps;se=typeof oe=="function"||typeof g.getSnapshotBeforeUpdate=="function",S=i.pendingProps!==S,se||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(S||W!==T)&&__(i,g,u,T),Ka=!1;var Z=i.memoizedState;g.state=Z,ec(i,u,g,m),Jl(),W=i.memoizedState,S||Z!==W||Ka?(typeof oe=="function"&&(Em(i,l,oe,u),W=i.memoizedState),(F=Ka||y_(i,l,F,u,Z,W,T))?(se||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=W),g.props=u,g.state=W,g.context=T,u=F):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{g=i.stateNode,Jf(s,i),T=i.memoizedProps,se=br(l,T),g.props=se,oe=i.pendingProps,Z=g.context,W=l.contextType,F=ho,typeof W=="object"&&W!==null&&(F=pn(W)),S=l.getDerivedStateFromProps,(W=typeof S=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T!==oe||Z!==F)&&__(i,g,u,F),Ka=!1,Z=i.memoizedState,g.state=Z,ec(i,u,g,m),Jl();var ee=i.memoizedState;T!==oe||Z!==ee||Ka||s!==null&&s.dependencies!==null&&ed(s.dependencies)?(typeof S=="function"&&(Em(i,l,S,u),ee=i.memoizedState),(se=Ka||y_(i,l,se,u,Z,ee,F)||s!==null&&s.dependencies!==null&&ed(s.dependencies))?(W||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,ee,F),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,ee,F)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=ee),g.props=u,g.state=ee,g.context=F,u=se):(typeof g.componentDidUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(i.flags|=1024),u=!1)}return g=u,_d(s,i),u=(i.flags&128)!==0,g||u?(g=i.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),i.flags|=1,s!==null&&u?(i.child=No(i,s.child,null,m),i.child=No(i,null,l,m)):sn(s,i,l,m),i.memoizedState=g.state,s=i.child):s=ba(s,i,m),s}function M_(s,i,l,u){return Gl(),i.flags|=256,sn(s,i,l,u),i.child}var xm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Am(s){return{baseLanes:s,cachePool:by()}}function Cm(s,i,l){return s=s!==null?s.childLanes&~l:0,i&&(s|=cs),s}function P_(s,i,l){var u=i.pendingProps,m=!1,g=(i.flags&128)!==0,T;if((T=g)||(T=s!==null&&s.memoizedState===null?!1:(Bt.current&2)!==0),T&&(m=!0,i.flags&=-129),T=(i.flags&32)!==0,i.flags&=-33,s===null){if(tt){if(m?Za(i):Ja(),tt){var S=Tt,F;if(F=S){e:{for(F=S,S=Us;F.nodeType!==8;){if(!S){S=null;break e}if(F=_s(F.nextSibling),F===null){S=null;break e}}S=F}S!==null?(i.memoizedState={dehydrated:S,treeContext:fr!==null?{id:pa,overflow:ga}:null,retryLane:536870912,hydrationErrors:null},F=Fn(18,null,null,0),F.stateNode=S,F.return=i,i.child=F,An=i,Tt=null,F=!0):F=!1}F||gr(i)}if(S=i.memoizedState,S!==null&&(S=S.dehydrated,S!==null))return cp(S)?i.lanes=32:i.lanes=536870912,null;Ea(i)}return S=u.children,u=u.fallback,m?(Ja(),m=i.mode,S=Ed({mode:"hidden",children:S},m),u=hr(u,m,l,null),S.return=i,u.return=i,S.sibling=u,i.child=S,m=i.child,m.memoizedState=Am(l),m.childLanes=Cm(s,T,l),i.memoizedState=xm,u):(Za(i),jm(i,S))}if(F=s.memoizedState,F!==null&&(S=F.dehydrated,S!==null)){if(g)i.flags&256?(Za(i),i.flags&=-257,i=Sm(s,i,l)):i.memoizedState!==null?(Ja(),i.child=s.child,i.flags|=128,i=null):(Ja(),m=u.fallback,S=i.mode,u=Ed({mode:"visible",children:u.children},S),m=hr(m,S,l,null),m.flags|=2,u.return=i,m.return=i,u.sibling=m,i.child=u,No(i,s.child,null,l),u=i.child,u.memoizedState=Am(l),u.childLanes=Cm(s,T,l),i.memoizedState=xm,i=m);else if(Za(i),cp(S)){if(T=S.nextSibling&&S.nextSibling.dataset,T)var W=T.dgst;T=W,u=Error(a(419)),u.stack="",u.digest=T,$l({value:u,source:null,stack:null}),i=Sm(s,i,l)}else if(Xt||Yl(s,i,l,!1),T=(l&s.childLanes)!==0,Xt||T){if(T=mt,T!==null&&(u=l&-l,u=(u&42)!==0?1:Fa(u),u=(u&(T.suspendedLanes|l))!==0?0:u,u!==0&&u!==F.retryLane))throw F.retryLane=u,uo(s,u),Gn(T,s,u),C_;S.data==="$?"||$m(),i=Sm(s,i,l)}else S.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=F.treeContext,Tt=_s(S.nextSibling),An=i,tt=!0,pr=null,Us=!1,s!==null&&(rs[os++]=pa,rs[os++]=ga,rs[os++]=fr,pa=s.id,ga=s.overflow,fr=i),i=jm(i,u.children),i.flags|=4096);return i}return m?(Ja(),m=u.fallback,S=i.mode,F=s.child,W=F.sibling,u=ma(F,{mode:"hidden",children:u.children}),u.subtreeFlags=F.subtreeFlags&65011712,W!==null?m=ma(W,m):(m=hr(m,S,l,null),m.flags|=2),m.return=i,u.return=i,u.sibling=m,i.child=u,u=m,m=i.child,S=s.child.memoizedState,S===null?S=Am(l):(F=S.cachePool,F!==null?(W=qt._currentValue,F=F.parent!==W?{parent:W,pool:W}:F):F=by(),S={baseLanes:S.baseLanes|l,cachePool:F}),m.memoizedState=S,m.childLanes=Cm(s,T,l),i.memoizedState=xm,u):(Za(i),l=s.child,s=l.sibling,l=ma(l,{mode:"visible",children:u.children}),l.return=i,l.sibling=null,s!==null&&(T=i.deletions,T===null?(i.deletions=[s],i.flags|=16):T.push(s)),i.child=l,i.memoizedState=null,l)}function jm(s,i){return i=Ed({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function Ed(s,i){return s=Fn(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Sm(s,i,l){return No(i,s.child,null,l),s=jm(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function k_(s,i,l){s.lanes|=i;var u=s.alternate;u!==null&&(u.lanes|=i),$f(s.return,i,l)}function wm(s,i,l,u,m){var g=s.memoizedState;g===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:m}:(g.isBackwards=i,g.rendering=null,g.renderingStartTime=0,g.last=u,g.tail=l,g.tailMode=m)}function L_(s,i,l){var u=i.pendingProps,m=u.revealOrder,g=u.tail;if(sn(s,i,u.children,l),u=Bt.current,(u&2)!==0)u=u&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&k_(s,l,i);else if(s.tag===19)k_(s,l,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}u&=1}switch(ue(Bt,u),m){case"forwards":for(l=i.child,m=null;l!==null;)s=l.alternate,s!==null&&gd(s)===null&&(m=l),l=l.sibling;l=m,l===null?(m=i.child,i.child=null):(m=l.sibling,l.sibling=null),wm(i,!1,m,l,g);break;case"backwards":for(l=null,m=i.child,i.child=null;m!==null;){if(s=m.alternate,s!==null&&gd(s)===null){i.child=m;break}s=m.sibling,m.sibling=l,l=m,m=s}wm(i,!0,l,null,g);break;case"together":wm(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ba(s,i,l){if(s!==null&&(i.dependencies=s.dependencies),ai|=i.lanes,(l&i.childLanes)===0)if(s!==null){if(Yl(s,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(a(153));if(i.child!==null){for(s=i.child,l=ma(s,s.pendingProps),i.child=l,l.return=i;s.sibling!==null;)s=s.sibling,l=l.sibling=ma(s,s.pendingProps),l.return=i;l.sibling=null}return i.child}function Im(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&ed(s)))}function nj(s,i,l){switch(i.tag){case 3:ft(i,i.stateNode.containerInfo),Ya(i,qt,s.memoizedState.cache),Gl();break;case 27:case 5:Ua(i);break;case 4:ft(i,i.stateNode.containerInfo);break;case 10:Ya(i,i.type,i.memoizedProps.value);break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(Za(i),i.flags|=128,null):(l&i.child.childLanes)!==0?P_(s,i,l):(Za(i),s=ba(s,i,l),s!==null?s.sibling:null);Za(i);break;case 19:var m=(s.flags&128)!==0;if(u=(l&i.childLanes)!==0,u||(Yl(s,i,l,!1),u=(l&i.childLanes)!==0),m){if(u)return L_(s,i,l);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ue(Bt,Bt.current),u)break;return null;case 22:case 23:return i.lanes=0,I_(s,i,l);case 24:Ya(i,qt,s.memoizedState.cache)}return ba(s,i,l)}function V_(s,i,l){if(s!==null)if(s.memoizedProps!==i.pendingProps)Xt=!0;else{if(!Im(s,l)&&(i.flags&128)===0)return Xt=!1,nj(s,i,l);Xt=(s.flags&131072)!==0}else Xt=!1,tt&&(i.flags&1048576)!==0&&my(i,Ju,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var u=i.elementType,m=u._init;if(u=m(u._payload),i.type=u,typeof u=="function")Uf(u)?(s=br(u,s),i.tag=1,i=O_(null,i,u,s,l)):(i.tag=0,i=Tm(null,i,u,s,l));else{if(u!=null){if(m=u.$$typeof,m===U){i.tag=11,i=j_(null,i,u,s,l);break e}else if(m===w){i.tag=14,i=S_(null,i,u,s,l);break e}}throw i=Pe(u)||u,Error(a(306,i,""))}}return i;case 0:return Tm(s,i,i.type,i.pendingProps,l);case 1:return u=i.type,m=br(u,i.pendingProps),O_(s,i,u,m,l);case 3:e:{if(ft(i,i.stateNode.containerInfo),s===null)throw Error(a(387));u=i.pendingProps;var g=i.memoizedState;m=g.element,Jf(s,i),ec(i,u,null,l);var T=i.memoizedState;if(u=T.cache,Ya(i,qt,u),u!==g.cache&&Yf(i,[qt],l,!0),Jl(),u=T.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:T.cache},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){i=M_(s,i,u,l);break e}else if(u!==m){m=as(Error(a(424)),i),$l(m),i=M_(s,i,u,l);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Tt=_s(s.firstChild),An=i,tt=!0,pr=null,Us=!0,l=g_(i,null,u,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Gl(),u===m){i=ba(s,i,l);break e}sn(s,i,u,l)}i=i.child}return i;case 26:return _d(s,i),s===null?(l=qE(i.type,null,i.pendingProps,null))?i.memoizedState=l:tt||(l=i.type,s=i.pendingProps,u=Md(Ie.current).createElement(l),u[Ut]=i,u[Dt]=s,rn(u,l,s),jt(u),i.stateNode=u):i.memoizedState=qE(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return Ua(i),s===null&&tt&&(u=i.stateNode=UE(i.type,i.pendingProps,Ie.current),An=i,Us=!0,m=Tt,li(i.type)?(up=m,Tt=_s(u.firstChild)):Tt=m),sn(s,i,i.pendingProps.children,l),_d(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&tt&&((m=u=Tt)&&(u=Ij(u,i.type,i.pendingProps,Us),u!==null?(i.stateNode=u,An=i,Tt=_s(u.firstChild),Us=!1,m=!0):m=!1),m||gr(i)),Ua(i),m=i.type,g=i.pendingProps,T=s!==null?s.memoizedProps:null,u=g.children,rp(m,g)?u=null:T!==null&&rp(m,T)&&(i.flags|=32),i.memoizedState!==null&&(m=im(s,i,KC,null,null,l),Nc._currentValue=m),_d(s,i),sn(s,i,u,l),i.child;case 6:return s===null&&tt&&((s=l=Tt)&&(l=Rj(l,i.pendingProps,Us),l!==null?(i.stateNode=l,An=i,Tt=null,s=!0):s=!1),s||gr(i)),null;case 13:return P_(s,i,l);case 4:return ft(i,i.stateNode.containerInfo),u=i.pendingProps,s===null?i.child=No(i,null,u,l):sn(s,i,u,l),i.child;case 11:return j_(s,i,i.type,i.pendingProps,l);case 7:return sn(s,i,i.pendingProps,l),i.child;case 8:return sn(s,i,i.pendingProps.children,l),i.child;case 12:return sn(s,i,i.pendingProps.children,l),i.child;case 10:return u=i.pendingProps,Ya(i,i.type,u.value),sn(s,i,u.children,l),i.child;case 9:return m=i.type._context,u=i.pendingProps.children,yr(i),m=pn(m),u=u(m),i.flags|=1,sn(s,i,u,l),i.child;case 14:return S_(s,i,i.type,i.pendingProps,l);case 15:return w_(s,i,i.type,i.pendingProps,l);case 19:return L_(s,i,l);case 31:return u=i.pendingProps,l=i.mode,u={mode:u.mode,children:u.children},s===null?(l=Ed(u,l),l.ref=i.ref,i.child=l,l.return=i,i=l):(l=ma(s.child,u),l.ref=i.ref,i.child=l,l.return=i,i=l),i;case 22:return I_(s,i,l);case 24:return yr(i),u=pn(qt),s===null?(m=Xf(),m===null&&(m=mt,g=Kf(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=l),m=g),i.memoizedState={parent:u,cache:m},Zf(i),Ya(i,qt,m)):((s.lanes&l)!==0&&(Jf(s,i),ec(i,null,null,l),Jl()),m=s.memoizedState,g=i.memoizedState,m.parent!==u?(m={parent:u,cache:u},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),Ya(i,qt,u)):(u=g.cache,Ya(i,qt,u),u!==m.cache&&Yf(i,[qt],l,!0))),sn(s,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function Na(s){s.flags|=4}function U_(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!YE(i)){if(i=ls.current,i!==null&&((Xe&4194048)===Xe?Fs!==null:(Xe&62914560)!==Xe&&(Xe&536870912)===0||i!==Fs))throw Wl=Wf,Ny;s.flags|=8192}}function bd(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?xl():536870912,s.lanes|=i,Co|=i)}function oc(s,i){if(!tt)switch(s.tailMode){case"hidden":i=s.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function Et(s){var i=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(i)for(var m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=u,s.childLanes=l,i}function sj(s,i,l){var u=i.pendingProps;switch(Bf(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(i),null;case 1:return Et(i),null;case 3:return l=i.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),ya(qt),js(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(zl(i)?Na(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,vy())),Et(i),null;case 26:return l=i.memoizedState,s===null?(Na(i),l!==null?(Et(i),U_(i,l)):(Et(i),i.flags&=-16777217)):l?l!==s.memoizedState?(Na(i),Et(i),U_(i,l)):(Et(i),i.flags&=-16777217):(s.memoizedProps!==u&&Na(i),Et(i),i.flags&=-16777217),null;case 27:ta(i),l=Ie.current;var m=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==u&&Na(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return Et(i),null}s=Te.current,zl(i)?py(i):(s=UE(m,u,l),i.stateNode=s,Na(i))}return Et(i),null;case 5:if(ta(i),l=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==u&&Na(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return Et(i),null}if(s=Te.current,zl(i))py(i);else{switch(m=Md(Ie.current),s){case 1:s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=m.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof u.is=="string"?m.createElement("select",{is:u.is}):m.createElement("select"),u.multiple?s.multiple=!0:u.size&&(s.size=u.size);break;default:s=typeof u.is=="string"?m.createElement(l,{is:u.is}):m.createElement(l)}}s[Ut]=i,s[Dt]=u;e:for(m=i.child;m!==null;){if(m.tag===5||m.tag===6)s.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===i)break e;for(;m.sibling===null;){if(m.return===null||m.return===i)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}i.stateNode=s;e:switch(rn(s,l,u),l){case"button":case"input":case"select":case"textarea":s=!!u.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Na(i)}}return Et(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==u&&Na(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(a(166));if(s=Ie.current,zl(i)){if(s=i.stateNode,l=i.memoizedProps,u=null,m=An,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}s[Ut]=i,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||DE(s.nodeValue,l)),s||gr(i)}else s=Md(s).createTextNode(u),s[Ut]=i,i.stateNode=s}return Et(i),null;case 13:if(u=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=zl(i),u!==null&&u.dehydrated!==null){if(s===null){if(!m)throw Error(a(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(a(317));m[Ut]=i}else Gl(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Et(i),m=!1}else m=vy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(Ea(i),i):(Ea(i),null)}if(Ea(i),(i.flags&128)!==0)return i.lanes=l,i;if(l=u!==null,s=s!==null&&s.memoizedState!==null,l){u=i.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool);var g=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==m&&(u.flags|=2048)}return l!==s&&l&&(i.child.flags|=8192),bd(i,i.updateQueue),Et(i),null;case 4:return js(),s===null&&tp(i.stateNode.containerInfo),Et(i),null;case 10:return ya(i.type),Et(i),null;case 19:if(he(Bt),m=i.memoizedState,m===null)return Et(i),null;if(u=(i.flags&128)!==0,g=m.rendering,g===null)if(u)oc(m,!1);else{if(xt!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(g=gd(s),g!==null){for(i.flags|=128,oc(m,!1),s=g.updateQueue,i.updateQueue=s,bd(i,s),i.subtreeFlags=0,s=l,l=i.child;l!==null;)fy(l,s),l=l.sibling;return ue(Bt,Bt.current&1|2),i.child}s=s.sibling}m.tail!==null&&Zn()>xd&&(i.flags|=128,u=!0,oc(m,!1),i.lanes=4194304)}else{if(!u)if(s=gd(g),s!==null){if(i.flags|=128,u=!0,s=s.updateQueue,i.updateQueue=s,bd(i,s),oc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!g.alternate&&!tt)return Et(i),null}else 2*Zn()-m.renderingStartTime>xd&&l!==536870912&&(i.flags|=128,u=!0,oc(m,!1),i.lanes=4194304);m.isBackwards?(g.sibling=i.child,i.child=g):(s=m.last,s!==null?s.sibling=g:i.child=g,m.last=g)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=Zn(),i.sibling=null,s=Bt.current,ue(Bt,u?s&1|2:s&1),i):(Et(i),null);case 22:case 23:return Ea(i),sm(),u=i.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(l&536870912)!==0&&(i.flags&128)===0&&(Et(i),i.subtreeFlags&6&&(i.flags|=8192)):Et(i),l=i.updateQueue,l!==null&&bd(i,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==l&&(i.flags|=2048),s!==null&&he(_r),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),ya(qt),Et(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function aj(s,i){switch(Bf(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return ya(qt),js(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return ta(i),null;case 13:if(Ea(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(a(340));Gl()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return he(Bt),null;case 4:return js(),null;case 10:return ya(i.type),null;case 22:case 23:return Ea(i),sm(),s!==null&&he(_r),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return ya(qt),null;case 25:return null;default:return null}}function F_(s,i){switch(Bf(i),i.tag){case 3:ya(qt),js();break;case 26:case 27:case 5:ta(i);break;case 4:js();break;case 13:Ea(i);break;case 19:he(Bt);break;case 10:ya(i.type);break;case 22:case 23:Ea(i),sm(),s!==null&&he(_r);break;case 24:ya(qt)}}function lc(s,i){try{var l=i.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var m=u.next;l=m;do{if((l.tag&s)===s){u=void 0;var g=l.create,T=l.inst;u=g(),T.destroy=u}l=l.next}while(l!==m)}}catch(S){ut(i,i.return,S)}}function ei(s,i,l){try{var u=i.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var g=m.next;u=g;do{if((u.tag&s)===s){var T=u.inst,S=T.destroy;if(S!==void 0){T.destroy=void 0,m=i;var F=l,W=S;try{W()}catch(se){ut(m,F,se)}}}u=u.next}while(u!==g)}}catch(se){ut(i,i.return,se)}}function H_(s){var i=s.updateQueue;if(i!==null){var l=s.stateNode;try{Sy(i,l)}catch(u){ut(s,s.return,u)}}}function q_(s,i,l){l.props=br(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){ut(s,i,u)}}function cc(s,i){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(m){ut(s,i,m)}}function Hs(s,i){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(m){ut(s,i,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){ut(s,i,m)}else l.current=null}function B_(s){var i=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(m){ut(s,s.return,m)}}function Rm(s,i,l){try{var u=s.stateNode;Aj(u,s.type,l,i),u[Dt]=i}catch(m){ut(s,s.return,m)}}function z_(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&li(s.type)||s.tag===4}function Dm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||z_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&li(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Om(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(s),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=Od));else if(u!==4&&(u===27&&li(s.type)&&(l=s.stateNode,i=null),s=s.child,s!==null))for(Om(s,i,l),s=s.sibling;s!==null;)Om(s,i,l),s=s.sibling}function Nd(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?l.insertBefore(s,i):l.appendChild(s);else if(u!==4&&(u===27&&li(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(Nd(s,i,l),s=s.sibling;s!==null;)Nd(s,i,l),s=s.sibling}function G_(s){var i=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);rn(i,u,l),i[Ut]=s,i[Dt]=l}catch(g){ut(s,s.return,g)}}var Ta=!1,wt=!1,Mm=!1,$_=typeof WeakSet=="function"?WeakSet:Set,Wt=null;function ij(s,i){if(s=s.containerInfo,ap=Fd,s=sy(s),Df(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var m=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var T=0,S=-1,F=-1,W=0,se=0,oe=s,Z=null;t:for(;;){for(var ee;oe!==l||m!==0&&oe.nodeType!==3||(S=T+m),oe!==g||u!==0&&oe.nodeType!==3||(F=T+u),oe.nodeType===3&&(T+=oe.nodeValue.length),(ee=oe.firstChild)!==null;)Z=oe,oe=ee;for(;;){if(oe===s)break t;if(Z===l&&++W===m&&(S=T),Z===g&&++se===u&&(F=T),(ee=oe.nextSibling)!==null)break;oe=Z,Z=oe.parentNode}oe=ee}l=S===-1||F===-1?null:{start:S,end:F}}else l=null}l=l||{start:0,end:0}}else l=null;for(ip={focusedElem:s,selectionRange:l},Fd=!1,Wt=i;Wt!==null;)if(i=Wt,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,Wt=s;else for(;Wt!==null;){switch(i=Wt,g=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&g!==null){s=void 0,l=i,m=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var we=br(l.type,m,l.elementType===l.type);s=u.getSnapshotBeforeUpdate(we,g),u.__reactInternalSnapshotBeforeUpdate=s}catch(Ae){ut(l,l.return,Ae)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,l=s.nodeType,l===9)lp(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":lp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=i.sibling,s!==null){s.return=i.return,Wt=s;break}Wt=i.return}}function Y_(s,i,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:ti(s,l),u&4&&lc(5,l);break;case 1:if(ti(s,l),u&4)if(s=l.stateNode,i===null)try{s.componentDidMount()}catch(T){ut(l,l.return,T)}else{var m=br(l.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(m,i,s.__reactInternalSnapshotBeforeUpdate)}catch(T){ut(l,l.return,T)}}u&64&&H_(l),u&512&&cc(l,l.return);break;case 3:if(ti(s,l),u&64&&(s=l.updateQueue,s!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{Sy(s,i)}catch(T){ut(l,l.return,T)}}break;case 27:i===null&&u&4&&G_(l);case 26:case 5:ti(s,l),i===null&&u&4&&B_(l),u&512&&cc(l,l.return);break;case 12:ti(s,l);break;case 13:ti(s,l),u&4&&X_(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=mj.bind(null,l),Dj(s,l))));break;case 22:if(u=l.memoizedState!==null||Ta,!u){i=i!==null&&i.memoizedState!==null||wt,m=Ta;var g=wt;Ta=u,(wt=i)&&!g?ni(s,l,(l.subtreeFlags&8772)!==0):ti(s,l),Ta=m,wt=g}break;case 30:break;default:ti(s,l)}}function K_(s){var i=s.alternate;i!==null&&(s.alternate=null,K_(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&Ba(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var _t=null,Rn=!1;function xa(s,i,l){for(l=l.child;l!==null;)Q_(s,i,l),l=l.sibling}function Q_(s,i,l){if(st&&typeof st.onCommitFiberUnmount=="function")try{st.onCommitFiberUnmount(Nt,l)}catch{}switch(l.tag){case 26:wt||Hs(l,i),xa(s,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:wt||Hs(l,i);var u=_t,m=Rn;li(l.type)&&(_t=l.stateNode,Rn=!1),xa(s,i,l),yc(l.stateNode),_t=u,Rn=m;break;case 5:wt||Hs(l,i);case 6:if(u=_t,m=Rn,_t=null,xa(s,i,l),_t=u,Rn=m,_t!==null)if(Rn)try{(_t.nodeType===9?_t.body:_t.nodeName==="HTML"?_t.ownerDocument.body:_t).removeChild(l.stateNode)}catch(g){ut(l,i,g)}else try{_t.removeChild(l.stateNode)}catch(g){ut(l,i,g)}break;case 18:_t!==null&&(Rn?(s=_t,LE(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Cc(s)):LE(_t,l.stateNode));break;case 4:u=_t,m=Rn,_t=l.stateNode.containerInfo,Rn=!0,xa(s,i,l),_t=u,Rn=m;break;case 0:case 11:case 14:case 15:wt||ei(2,l,i),wt||ei(4,l,i),xa(s,i,l);break;case 1:wt||(Hs(l,i),u=l.stateNode,typeof u.componentWillUnmount=="function"&&q_(l,i,u)),xa(s,i,l);break;case 21:xa(s,i,l);break;case 22:wt=(u=wt)||l.memoizedState!==null,xa(s,i,l),wt=u;break;default:xa(s,i,l)}}function X_(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Cc(s)}catch(l){ut(i,i.return,l)}}function rj(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new $_),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new $_),i;default:throw Error(a(435,s.tag))}}function Pm(s,i){var l=rj(s);i.forEach(function(u){var m=pj.bind(null,s,u);l.has(u)||(l.add(u),u.then(m,m))})}function Hn(s,i){var l=i.deletions;if(l!==null)for(var u=0;u<l.length;u++){var m=l[u],g=s,T=i,S=T;e:for(;S!==null;){switch(S.tag){case 27:if(li(S.type)){_t=S.stateNode,Rn=!1;break e}break;case 5:_t=S.stateNode,Rn=!1;break e;case 3:case 4:_t=S.stateNode.containerInfo,Rn=!0;break e}S=S.return}if(_t===null)throw Error(a(160));Q_(g,T,m),_t=null,Rn=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)W_(i,s),i=i.sibling}var ys=null;function W_(s,i){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Hn(i,s),qn(s),u&4&&(ei(3,s,s.return),lc(3,s),ei(5,s,s.return));break;case 1:Hn(i,s),qn(s),u&512&&(wt||l===null||Hs(l,l.return)),u&64&&Ta&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var m=ys;if(Hn(i,s),qn(s),u&512&&(wt||l===null||Hs(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":g=m.getElementsByTagName("title")[0],(!g||g[Xi]||g[Ut]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(u),m.head.insertBefore(g,m.querySelector("head > title"))),rn(g,u,l),g[Ut]=s,jt(g),u=g;break e;case"link":var T=GE("link","href",m).get(u+(l.href||""));if(T){for(var S=0;S<T.length;S++)if(g=T[S],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){T.splice(S,1);break t}}g=m.createElement(u),rn(g,u,l),m.head.appendChild(g);break;case"meta":if(T=GE("meta","content",m).get(u+(l.content||""))){for(S=0;S<T.length;S++)if(g=T[S],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){T.splice(S,1);break t}}g=m.createElement(u),rn(g,u,l),m.head.appendChild(g);break;default:throw Error(a(468,u))}g[Ut]=s,jt(g),u=g}s.stateNode=u}else $E(m,s.type,s.stateNode);else s.stateNode=zE(m,u,s.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?$E(m,s.type,s.stateNode):zE(m,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Rm(s,s.memoizedProps,l.memoizedProps)}break;case 27:Hn(i,s),qn(s),u&512&&(wt||l===null||Hs(l,l.return)),l!==null&&u&4&&Rm(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Hn(i,s),qn(s),u&512&&(wt||l===null||Hs(l,l.return)),s.flags&32){m=s.stateNode;try{es(m,"")}catch(ee){ut(s,s.return,ee)}}u&4&&s.stateNode!=null&&(m=s.memoizedProps,Rm(s,m,l!==null?l.memoizedProps:m)),u&1024&&(Mm=!0);break;case 6:if(Hn(i,s),qn(s),u&4){if(s.stateNode===null)throw Error(a(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(ee){ut(s,s.return,ee)}}break;case 3:if(Ld=null,m=ys,ys=Pd(i.containerInfo),Hn(i,s),ys=m,qn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Cc(i.containerInfo)}catch(ee){ut(s,s.return,ee)}Mm&&(Mm=!1,Z_(s));break;case 4:u=ys,ys=Pd(s.stateNode.containerInfo),Hn(i,s),qn(s),ys=u;break;case 12:Hn(i,s),qn(s);break;case 13:Hn(i,s),qn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Hm=Zn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Pm(s,u)));break;case 22:m=s.memoizedState!==null;var F=l!==null&&l.memoizedState!==null,W=Ta,se=wt;if(Ta=W||m,wt=se||F,Hn(i,s),wt=se,Ta=W,qn(s),u&8192)e:for(i=s.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(l===null||F||Ta||wt||Nr(s)),l=null,i=s;;){if(i.tag===5||i.tag===26){if(l===null){F=l=i;try{if(g=F.stateNode,m)T=g.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{S=F.stateNode;var oe=F.memoizedProps.style,Z=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;S.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(ee){ut(F,F.return,ee)}}}else if(i.tag===6){if(l===null){F=i;try{F.stateNode.nodeValue=m?"":F.memoizedProps}catch(ee){ut(F,F.return,ee)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Pm(s,l))));break;case 19:Hn(i,s),qn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Pm(s,u)));break;case 30:break;case 21:break;default:Hn(i,s),qn(s)}}function qn(s){var i=s.flags;if(i&2){try{for(var l,u=s.return;u!==null;){if(z_(u)){l=u;break}u=u.return}if(l==null)throw Error(a(160));switch(l.tag){case 27:var m=l.stateNode,g=Dm(s);Nd(s,g,m);break;case 5:var T=l.stateNode;l.flags&32&&(es(T,""),l.flags&=-33);var S=Dm(s);Nd(s,S,T);break;case 3:case 4:var F=l.stateNode.containerInfo,W=Dm(s);Om(s,W,F);break;default:throw Error(a(161))}}catch(se){ut(s,s.return,se)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Z_(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;Z_(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function ti(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Y_(s,i.alternate,i),i=i.sibling}function Nr(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:ei(4,i,i.return),Nr(i);break;case 1:Hs(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&q_(i,i.return,l),Nr(i);break;case 27:yc(i.stateNode);case 26:case 5:Hs(i,i.return),Nr(i);break;case 22:i.memoizedState===null&&Nr(i);break;case 30:Nr(i);break;default:Nr(i)}s=s.sibling}}function ni(s,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,m=s,g=i,T=g.flags;switch(g.tag){case 0:case 11:case 15:ni(m,g,l),lc(4,g);break;case 1:if(ni(m,g,l),u=g,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(W){ut(u,u.return,W)}if(u=g,m=u.updateQueue,m!==null){var S=u.stateNode;try{var F=m.shared.hiddenCallbacks;if(F!==null)for(m.shared.hiddenCallbacks=null,m=0;m<F.length;m++)jy(F[m],S)}catch(W){ut(u,u.return,W)}}l&&T&64&&H_(g),cc(g,g.return);break;case 27:G_(g);case 26:case 5:ni(m,g,l),l&&u===null&&T&4&&B_(g),cc(g,g.return);break;case 12:ni(m,g,l);break;case 13:ni(m,g,l),l&&T&4&&X_(m,g);break;case 22:g.memoizedState===null&&ni(m,g,l),cc(g,g.return);break;case 30:break;default:ni(m,g,l)}i=i.sibling}}function km(s,i){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Kl(l))}function Lm(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Kl(s))}function qs(s,i,l,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)J_(s,i,l,u),i=i.sibling}function J_(s,i,l,u){var m=i.flags;switch(i.tag){case 0:case 11:case 15:qs(s,i,l,u),m&2048&&lc(9,i);break;case 1:qs(s,i,l,u);break;case 3:qs(s,i,l,u),m&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Kl(s)));break;case 12:if(m&2048){qs(s,i,l,u),s=i.stateNode;try{var g=i.memoizedProps,T=g.id,S=g.onPostCommit;typeof S=="function"&&S(T,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(F){ut(i,i.return,F)}}else qs(s,i,l,u);break;case 13:qs(s,i,l,u);break;case 23:break;case 22:g=i.stateNode,T=i.alternate,i.memoizedState!==null?g._visibility&2?qs(s,i,l,u):uc(s,i):g._visibility&2?qs(s,i,l,u):(g._visibility|=2,To(s,i,l,u,(i.subtreeFlags&10256)!==0)),m&2048&&km(T,i);break;case 24:qs(s,i,l,u),m&2048&&Lm(i.alternate,i);break;default:qs(s,i,l,u)}}function To(s,i,l,u,m){for(m=m&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var g=s,T=i,S=l,F=u,W=T.flags;switch(T.tag){case 0:case 11:case 15:To(g,T,S,F,m),lc(8,T);break;case 23:break;case 22:var se=T.stateNode;T.memoizedState!==null?se._visibility&2?To(g,T,S,F,m):uc(g,T):(se._visibility|=2,To(g,T,S,F,m)),m&&W&2048&&km(T.alternate,T);break;case 24:To(g,T,S,F,m),m&&W&2048&&Lm(T.alternate,T);break;default:To(g,T,S,F,m)}i=i.sibling}}function uc(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=s,u=i,m=u.flags;switch(u.tag){case 22:uc(l,u),m&2048&&km(u.alternate,u);break;case 24:uc(l,u),m&2048&&Lm(u.alternate,u);break;default:uc(l,u)}i=i.sibling}}var dc=8192;function xo(s){if(s.subtreeFlags&dc)for(s=s.child;s!==null;)eE(s),s=s.sibling}function eE(s){switch(s.tag){case 26:xo(s),s.flags&dc&&s.memoizedState!==null&&Gj(ys,s.memoizedState,s.memoizedProps);break;case 5:xo(s);break;case 3:case 4:var i=ys;ys=Pd(s.stateNode.containerInfo),xo(s),ys=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=dc,dc=16777216,xo(s),dc=i):xo(s));break;default:xo(s)}}function tE(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function hc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];Wt=u,sE(u,s)}tE(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)nE(s),s=s.sibling}function nE(s){switch(s.tag){case 0:case 11:case 15:hc(s),s.flags&2048&&ei(9,s,s.return);break;case 3:hc(s);break;case 12:hc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,Td(s)):hc(s);break;default:hc(s)}}function Td(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];Wt=u,sE(u,s)}tE(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:ei(8,i,i.return),Td(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,Td(i));break;default:Td(i)}s=s.sibling}}function sE(s,i){for(;Wt!==null;){var l=Wt;switch(l.tag){case 0:case 11:case 15:ei(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Kl(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Wt=u;else e:for(l=s;Wt!==null;){u=Wt;var m=u.sibling,g=u.return;if(K_(u),u===l){Wt=null;break e}if(m!==null){m.return=g,Wt=m;break e}Wt=g}}}var oj={getCacheForType:function(s){var i=pn(qt),l=i.data.get(s);return l===void 0&&(l=s(),i.data.set(s,l)),l}},lj=typeof WeakMap=="function"?WeakMap:Map,at=0,mt=null,He=null,Xe=0,it=0,Bn=null,si=!1,Ao=!1,Vm=!1,Aa=0,xt=0,ai=0,Tr=0,Um=0,cs=0,Co=0,fc=null,Dn=null,Fm=!1,Hm=0,xd=1/0,Ad=null,ii=null,an=0,ri=null,jo=null,So=0,qm=0,Bm=null,aE=null,mc=0,zm=null;function zn(){if((at&2)!==0&&Xe!==0)return Xe&-Xe;if(B.T!==null){var s=po;return s!==0?s:Wm()}return Ha()}function iE(){cs===0&&(cs=(Xe&536870912)===0||tt?Tl():536870912);var s=ls.current;return s!==null&&(s.flags|=32),cs}function Gn(s,i,l){(s===mt&&(it===2||it===9)||s.cancelPendingCommit!==null)&&(wo(s,0),oi(s,Xe,cs,!1)),sa(s,l),((at&2)===0||s!==mt)&&(s===mt&&((at&2)===0&&(Tr|=l),xt===4&&oi(s,Xe,cs,!1)),Bs(s))}function rE(s,i,l){if((at&6)!==0)throw Error(a(327));var u=!l&&(i&124)===0&&(i&s.expiredLanes)===0||Qi(s,i),m=u?dj(s,i):Ym(s,i,!0),g=u;do{if(m===0){Ao&&!u&&oi(s,i,0,!1);break}else{if(l=s.current.alternate,g&&!cj(l)){m=Ym(s,i,!1),g=!1;continue}if(m===2){if(g=i,s.errorRecoveryDisabledLanes&g)var T=0;else T=s.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){i=T;e:{var S=s;m=fc;var F=S.current.memoizedState.isDehydrated;if(F&&(wo(S,T).flags|=256),T=Ym(S,T,!1),T!==2){if(Vm&&!F){S.errorRecoveryDisabledLanes|=g,Tr|=g,m=4;break e}g=Dn,Dn=m,g!==null&&(Dn===null?Dn=g:Dn.push.apply(Dn,g))}m=T}if(g=!1,m!==2)continue}}if(m===1){wo(s,0),oi(s,i,0,!0);break}e:{switch(u=s,g=m,g){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:oi(u,i,cs,!si);break e;case 2:Dn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(m=Hm+300-Zn(),10<m)){if(oi(u,i,cs,!si),Gr(u,0,!0)!==0)break e;u.timeoutHandle=PE(oE.bind(null,u,l,Dn,Ad,Fm,i,cs,Tr,Co,si,g,2,-0,0),m);break e}oE(u,l,Dn,Ad,Fm,i,cs,Tr,Co,si,g,0,-0,0)}}break}while(!0);Bs(s)}function oE(s,i,l,u,m,g,T,S,F,W,se,oe,Z,ee){if(s.timeoutHandle=-1,oe=i.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(bc={stylesheets:null,count:0,unsuspend:zj},eE(i),oe=$j(),oe!==null)){s.cancelPendingCommit=oe(mE.bind(null,s,i,g,l,u,m,T,S,F,se,1,Z,ee)),oi(s,g,T,!W);return}mE(s,i,g,l,u,m,T,S,F)}function cj(s){for(var i=s;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var m=l[u],g=m.getSnapshot;m=m.value;try{if(!Un(g(),m))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function oi(s,i,l,u){i&=~Um,i&=~Tr,s.suspendedLanes|=i,s.pingedLanes&=~i,u&&(s.warmLanes|=i),u=s.expirationTimes;for(var m=i;0<m;){var g=31-mn(m),T=1<<g;u[g]=-1,m&=~T}l!==0&&Ss(s,l,i)}function Cd(){return(at&6)===0?(pc(0),!1):!0}function Gm(){if(He!==null){if(it===0)var s=He.return;else s=He,va=vr=null,lm(s),bo=null,ic=0,s=He;for(;s!==null;)F_(s.alternate,s),s=s.return;He=null}}function wo(s,i){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,jj(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Gm(),mt=s,He=l=ma(s.current,null),Xe=i,it=0,Bn=null,si=!1,Ao=Qi(s,i),Vm=!1,Co=cs=Um=Tr=ai=xt=0,Dn=fc=null,Fm=!1,(i&8)!==0&&(i|=i&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=i;0<u;){var m=31-mn(u),g=1<<m;i|=s[m],u&=~g}return Aa=i,Ku(),l}function lE(s,i){Le=null,B.H=fd,i===Xl||i===sd?(i=Ay(),it=3):i===Ny?(i=Ay(),it=4):it=i===C_?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Bn=i,He===null&&(xt=1,yd(s,as(i,s.current)))}function cE(){var s=B.H;return B.H=fd,s===null?fd:s}function uE(){var s=B.A;return B.A=oj,s}function $m(){xt=4,si||(Xe&4194048)!==Xe&&ls.current!==null||(Ao=!0),(ai&134217727)===0&&(Tr&134217727)===0||mt===null||oi(mt,Xe,cs,!1)}function Ym(s,i,l){var u=at;at|=2;var m=cE(),g=uE();(mt!==s||Xe!==i)&&(Ad=null,wo(s,i)),i=!1;var T=xt;e:do try{if(it!==0&&He!==null){var S=He,F=Bn;switch(it){case 8:Gm(),T=6;break e;case 3:case 2:case 9:case 6:ls.current===null&&(i=!0);var W=it;if(it=0,Bn=null,Io(s,S,F,W),l&&Ao){T=0;break e}break;default:W=it,it=0,Bn=null,Io(s,S,F,W)}}uj(),T=xt;break}catch(se){lE(s,se)}while(!0);return i&&s.shellSuspendCounter++,va=vr=null,at=u,B.H=m,B.A=g,He===null&&(mt=null,Xe=0,Ku()),T}function uj(){for(;He!==null;)dE(He)}function dj(s,i){var l=at;at|=2;var u=cE(),m=uE();mt!==s||Xe!==i?(Ad=null,xd=Zn()+500,wo(s,i)):Ao=Qi(s,i);e:do try{if(it!==0&&He!==null){i=He;var g=Bn;t:switch(it){case 1:it=0,Bn=null,Io(s,i,g,1);break;case 2:case 9:if(Ty(g)){it=0,Bn=null,hE(i);break}i=function(){it!==2&&it!==9||mt!==s||(it=7),Bs(s)},g.then(i,i);break e;case 3:it=7;break e;case 4:it=5;break e;case 7:Ty(g)?(it=0,Bn=null,hE(i)):(it=0,Bn=null,Io(s,i,g,7));break;case 5:var T=null;switch(He.tag){case 26:T=He.memoizedState;case 5:case 27:var S=He;if(!T||YE(T)){it=0,Bn=null;var F=S.sibling;if(F!==null)He=F;else{var W=S.return;W!==null?(He=W,jd(W)):He=null}break t}}it=0,Bn=null,Io(s,i,g,5);break;case 6:it=0,Bn=null,Io(s,i,g,6);break;case 8:Gm(),xt=6;break e;default:throw Error(a(462))}}hj();break}catch(se){lE(s,se)}while(!0);return va=vr=null,B.H=u,B.A=m,at=l,He!==null?0:(mt=null,Xe=0,Ku(),xt)}function hj(){for(;He!==null&&!_l();)dE(He)}function dE(s){var i=V_(s.alternate,s,Aa);s.memoizedProps=s.pendingProps,i===null?jd(s):He=i}function hE(s){var i=s,l=i.alternate;switch(i.tag){case 15:case 0:i=D_(l,i,i.pendingProps,i.type,void 0,Xe);break;case 11:i=D_(l,i,i.pendingProps,i.type.render,i.ref,Xe);break;case 5:lm(i);default:F_(l,i),i=He=fy(i,Aa),i=V_(l,i,Aa)}s.memoizedProps=s.pendingProps,i===null?jd(s):He=i}function Io(s,i,l,u){va=vr=null,lm(i),bo=null,ic=0;var m=i.return;try{if(tj(s,m,i,l,Xe)){xt=1,yd(s,as(l,s.current)),He=null;return}}catch(g){if(m!==null)throw He=m,g;xt=1,yd(s,as(l,s.current)),He=null;return}i.flags&32768?(tt||u===1?s=!0:Ao||(Xe&536870912)!==0?s=!1:(si=s=!0,(u===2||u===9||u===3||u===6)&&(u=ls.current,u!==null&&u.tag===13&&(u.flags|=16384))),fE(i,s)):jd(i)}function jd(s){var i=s;do{if((i.flags&32768)!==0){fE(i,si);return}s=i.return;var l=sj(i.alternate,i,Aa);if(l!==null){He=l;return}if(i=i.sibling,i!==null){He=i;return}He=i=s}while(i!==null);xt===0&&(xt=5)}function fE(s,i){do{var l=aj(s.alternate,s);if(l!==null){l.flags&=32767,He=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(s=s.sibling,s!==null)){He=s;return}He=s=l}while(s!==null);xt=6,He=null}function mE(s,i,l,u,m,g,T,S,F){s.cancelPendingCommit=null;do Sd();while(an!==0);if((at&6)!==0)throw Error(a(327));if(i!==null){if(i===s.current)throw Error(a(177));if(g=i.lanes|i.childLanes,g|=Lf,Al(s,l,g,T,S,F),s===mt&&(He=mt=null,Xe=0),jo=i,ri=s,So=l,qm=g,Bm=m,aE=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,gj(Gi,function(){return _E(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=B.T,B.T=null,m=J.p,J.p=2,T=at,at|=4;try{ij(s,i,l)}finally{at=T,J.p=m,B.T=u}}an=1,pE(),gE(),vE()}}function pE(){if(an===1){an=0;var s=ri,i=jo,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=B.T,B.T=null;var u=J.p;J.p=2;var m=at;at|=4;try{W_(i,s);var g=ip,T=sy(s.containerInfo),S=g.focusedElem,F=g.selectionRange;if(T!==S&&S&&S.ownerDocument&&ny(S.ownerDocument.documentElement,S)){if(F!==null&&Df(S)){var W=F.start,se=F.end;if(se===void 0&&(se=W),"selectionStart"in S)S.selectionStart=W,S.selectionEnd=Math.min(se,S.value.length);else{var oe=S.ownerDocument||document,Z=oe&&oe.defaultView||window;if(Z.getSelection){var ee=Z.getSelection(),we=S.textContent.length,Ae=Math.min(F.start,we),ct=F.end===void 0?Ae:Math.min(F.end,we);!ee.extend&&Ae>ct&&(T=ct,ct=Ae,Ae=T);var G=ty(S,Ae),z=ty(S,ct);if(G&&z&&(ee.rangeCount!==1||ee.anchorNode!==G.node||ee.anchorOffset!==G.offset||ee.focusNode!==z.node||ee.focusOffset!==z.offset)){var X=oe.createRange();X.setStart(G.node,G.offset),ee.removeAllRanges(),Ae>ct?(ee.addRange(X),ee.extend(z.node,z.offset)):(X.setEnd(z.node,z.offset),ee.addRange(X))}}}}for(oe=[],ee=S;ee=ee.parentNode;)ee.nodeType===1&&oe.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<oe.length;S++){var ie=oe[S];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Fd=!!ap,ip=ap=null}finally{at=m,J.p=u,B.T=l}}s.current=i,an=2}}function gE(){if(an===2){an=0;var s=ri,i=jo,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=B.T,B.T=null;var u=J.p;J.p=2;var m=at;at|=4;try{Y_(s,i.alternate,i)}finally{at=m,J.p=u,B.T=l}}an=3}}function vE(){if(an===4||an===3){an=0,Tu();var s=ri,i=jo,l=So,u=aE;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?an=5:(an=0,jo=ri=null,yE(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(ii=null),$r(l),i=i.stateNode,st&&typeof st.onCommitFiberRoot=="function")try{st.onCommitFiberRoot(Nt,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=B.T,m=J.p,J.p=2,B.T=null;try{for(var g=s.onRecoverableError,T=0;T<u.length;T++){var S=u[T];g(S.value,{componentStack:S.stack})}}finally{B.T=i,J.p=m}}(So&3)!==0&&Sd(),Bs(s),m=s.pendingLanes,(l&4194090)!==0&&(m&42)!==0?s===zm?mc++:(mc=0,zm=s):mc=0,pc(0)}}function yE(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,Kl(i)))}function Sd(s){return pE(),gE(),vE(),_E()}function _E(){if(an!==5)return!1;var s=ri,i=qm;qm=0;var l=$r(So),u=B.T,m=J.p;try{J.p=32>l?32:l,B.T=null,l=Bm,Bm=null;var g=ri,T=So;if(an=0,jo=ri=null,So=0,(at&6)!==0)throw Error(a(331));var S=at;if(at|=4,nE(g.current),J_(g,g.current,T,l),at=S,pc(0,!1),st&&typeof st.onPostCommitFiberRoot=="function")try{st.onPostCommitFiberRoot(Nt,g)}catch{}return!0}finally{J.p=m,B.T=u,yE(s,i)}}function EE(s,i,l){i=as(l,i),i=Nm(s.stateNode,i,2),s=Xa(s,i,2),s!==null&&(sa(s,2),Bs(s))}function ut(s,i,l){if(s.tag===3)EE(s,s,l);else for(;i!==null;){if(i.tag===3){EE(i,s,l);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ii===null||!ii.has(u))){s=as(l,s),l=x_(2),u=Xa(i,l,2),u!==null&&(A_(l,u,i,s),sa(u,2),Bs(u));break}}i=i.return}}function Km(s,i,l){var u=s.pingCache;if(u===null){u=s.pingCache=new lj;var m=new Set;u.set(i,m)}else m=u.get(i),m===void 0&&(m=new Set,u.set(i,m));m.has(l)||(Vm=!0,m.add(l),s=fj.bind(null,s,i,l),i.then(s,s))}function fj(s,i,l){var u=s.pingCache;u!==null&&u.delete(i),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,mt===s&&(Xe&l)===l&&(xt===4||xt===3&&(Xe&62914560)===Xe&&300>Zn()-Hm?(at&2)===0&&wo(s,0):Um|=l,Co===Xe&&(Co=0)),Bs(s)}function bE(s,i){i===0&&(i=xl()),s=uo(s,i),s!==null&&(sa(s,i),Bs(s))}function mj(s){var i=s.memoizedState,l=0;i!==null&&(l=i.retryLane),bE(s,l)}function pj(s,i){var l=0;switch(s.tag){case 13:var u=s.stateNode,m=s.memoizedState;m!==null&&(l=m.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(i),bE(s,l)}function gj(s,i){return Bi(s,i)}var wd=null,Ro=null,Qm=!1,Id=!1,Xm=!1,xr=0;function Bs(s){s!==Ro&&s.next===null&&(Ro===null?wd=Ro=s:Ro=Ro.next=s),Id=!0,Qm||(Qm=!0,yj())}function pc(s,i){if(!Xm&&Id){Xm=!0;do for(var l=!1,u=wd;u!==null;){if(s!==0){var m=u.pendingLanes;if(m===0)var g=0;else{var T=u.suspendedLanes,S=u.pingedLanes;g=(1<<31-mn(42|s)+1)-1,g&=m&~(T&~S),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,AE(u,g))}else g=Xe,g=Gr(u,u===mt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||Qi(u,g)||(l=!0,AE(u,g));u=u.next}while(l);Xm=!1}}function vj(){NE()}function NE(){Id=Qm=!1;var s=0;xr!==0&&(Cj()&&(s=xr),xr=0);for(var i=Zn(),l=null,u=wd;u!==null;){var m=u.next,g=TE(u,i);g===0?(u.next=null,l===null?wd=m:l.next=m,m===null&&(Ro=l)):(l=u,(s!==0||(g&3)!==0)&&(Id=!0)),u=m}pc(s)}function TE(s,i){for(var l=s.suspendedLanes,u=s.pingedLanes,m=s.expirationTimes,g=s.pendingLanes&-62914561;0<g;){var T=31-mn(g),S=1<<T,F=m[T];F===-1?((S&l)===0||(S&u)!==0)&&(m[T]=Nl(S,i)):F<=i&&(s.expiredLanes|=S),g&=~S}if(i=mt,l=Xe,l=Gr(s,s===i?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===i&&(it===2||it===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&zi(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Qi(s,l)){if(i=l&-l,i===s.callbackPriority)return i;switch(u!==null&&zi(u),$r(l)){case 2:case 8:l=Br;break;case 32:l=Gi;break;case 268435456:l=zr;break;default:l=Gi}return u=xE.bind(null,s),l=Bi(l,u),s.callbackPriority=i,s.callbackNode=l,i}return u!==null&&u!==null&&zi(u),s.callbackPriority=2,s.callbackNode=null,2}function xE(s,i){if(an!==0&&an!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Sd()&&s.callbackNode!==l)return null;var u=Xe;return u=Gr(s,s===mt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(rE(s,u,i),TE(s,Zn()),s.callbackNode!=null&&s.callbackNode===l?xE.bind(null,s):null)}function AE(s,i){if(Sd())return null;rE(s,i,!0)}function yj(){Sj(function(){(at&6)!==0?Bi(El,vj):NE()})}function Wm(){return xr===0&&(xr=Tl()),xr}function CE(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Zr(""+s)}function jE(s,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,s.id&&l.setAttribute("form",s.id),i.parentNode.insertBefore(l,i),s=new FormData(s),l.parentNode.removeChild(l),s}function _j(s,i,l,u,m){if(i==="submit"&&l&&l.stateNode===m){var g=CE((m[Dt]||null).action),T=u.submitter;T&&(i=(i=T[Dt]||null)?CE(i.formAction):T.getAttribute("formAction"),i!==null&&(g=i,T=null));var S=new Jr("action","action",null,u,m);s.push({event:S,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(xr!==0){var F=T?jE(m,T):new FormData(m);vm(l,{pending:!0,data:F,method:m.method,action:g},null,F)}}else typeof g=="function"&&(S.preventDefault(),F=T?jE(m,T):new FormData(m),vm(l,{pending:!0,data:F,method:m.method,action:g},g,F))},currentTarget:m}]})}}for(var Zm=0;Zm<kf.length;Zm++){var Jm=kf[Zm],Ej=Jm.toLowerCase(),bj=Jm[0].toUpperCase()+Jm.slice(1);vs(Ej,"on"+bj)}vs(ry,"onAnimationEnd"),vs(oy,"onAnimationIteration"),vs(ly,"onAnimationStart"),vs("dblclick","onDoubleClick"),vs("focusin","onFocus"),vs("focusout","onBlur"),vs(VC,"onTransitionRun"),vs(UC,"onTransitionStart"),vs(FC,"onTransitionCancel"),vs(cy,"onTransitionEnd"),ia("onMouseEnter",["mouseout","mouseover"]),ia("onMouseLeave",["mouseout","mouseover"]),ia("onPointerEnter",["pointerout","pointerover"]),ia("onPointerLeave",["pointerout","pointerover"]),ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ps("onBeforeInput",["compositionend","keypress","textInput","paste"]),ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gc));function SE(s,i){i=(i&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],m=u.event;u=u.listeners;e:{var g=void 0;if(i)for(var T=u.length-1;0<=T;T--){var S=u[T],F=S.instance,W=S.currentTarget;if(S=S.listener,F!==g&&m.isPropagationStopped())break e;g=S,m.currentTarget=W;try{g(m)}catch(se){vd(se)}m.currentTarget=null,g=F}else for(T=0;T<u.length;T++){if(S=u[T],F=S.instance,W=S.currentTarget,S=S.listener,F!==g&&m.isPropagationStopped())break e;g=S,m.currentTarget=W;try{g(m)}catch(se){vd(se)}m.currentTarget=null,g=F}}}}function qe(s,i){var l=i[jl];l===void 0&&(l=i[jl]=new Set);var u=s+"__bubble";l.has(u)||(wE(i,s,2,!1),l.add(u))}function ep(s,i,l){var u=0;i&&(u|=4),wE(l,s,u,i)}var Rd="_reactListening"+Math.random().toString(36).slice(2);function tp(s){if(!s[Rd]){s[Rd]=!0,Sl.forEach(function(l){l!=="selectionchange"&&(Nj.has(l)||ep(l,!1,s),ep(l,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Rd]||(i[Rd]=!0,ep("selectionchange",!1,i))}}function wE(s,i,l,u){switch(JE(i)){case 2:var m=Qj;break;case 8:m=Xj;break;default:m=pp}l=m.bind(null,i,l,s),m=void 0,!ns||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),u?m!==void 0?s.addEventListener(i,l,{capture:!0,passive:m}):s.addEventListener(i,l,!0):m!==void 0?s.addEventListener(i,l,{passive:m}):s.addEventListener(i,l,!1)}function np(s,i,l,u,m){var g=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var T=u.tag;if(T===3||T===4){var S=u.stateNode.containerInfo;if(S===m)break;if(T===4)for(T=u.return;T!==null;){var F=T.tag;if((F===3||F===4)&&T.stateNode.containerInfo===m)return;T=T.return}for(;S!==null;){if(T=aa(S),T===null)return;if(F=T.tag,F===5||F===6||F===26||F===27){u=g=T;continue e}S=S.parentNode}}u=u.return}Ou(function(){var W=g,se=ts(l),oe=[];e:{var Z=uy.get(s);if(Z!==void 0){var ee=Jr,we=s;switch(s){case"keypress":if(Ms(l)===0)break e;case"keydown":case"keyup":ee=io;break;case"focusin":we="focus",ee=no;break;case"focusout":we="blur",ee=no;break;case"beforeblur":case"afterblur":ee=no;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=ss;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=Sf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=Hu;break;case ry:case oy:case ly:ee=so;break;case cy:ee=Bu;break;case"scroll":case"scrollend":ee=Mu;break;case"wheel":ee=ro;break;case"copy":case"cut":case"paste":ee=ao;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=Fl;break;case"toggle":case"beforetoggle":ee=Gu}var Ae=(i&4)!==0,ct=!Ae&&(s==="scroll"||s==="scrollend"),G=Ae?Z!==null?Z+"Capture":null:Z;Ae=[];for(var z=W,X;z!==null;){var ie=z;if(X=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||X===null||G===null||(ie=sr(z,G),ie!=null&&Ae.push(vc(z,ie,X))),ct)break;z=z.return}0<Ae.length&&(Z=new ee(Z,we,null,l,se),oe.push({event:Z,listeners:Ae}))}}if((i&7)===0){e:{if(Z=s==="mouseover"||s==="pointerover",ee=s==="mouseout"||s==="pointerout",Z&&l!==la&&(we=l.relatedTarget||l.fromElement)&&(aa(we)||we[Jn]))break e;if((ee||Z)&&(Z=se.window===se?se:(Z=se.ownerDocument)?Z.defaultView||Z.parentWindow:window,ee?(we=l.relatedTarget||l.toElement,ee=W,we=we?aa(we):null,we!==null&&(ct=c(we),Ae=we.tag,we!==ct||Ae!==5&&Ae!==27&&Ae!==6)&&(we=null)):(ee=null,we=W),ee!==we)){if(Ae=ss,ie="onMouseLeave",G="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(Ae=Fl,ie="onPointerLeave",G="onPointerEnter",z="pointer"),ct=ee==null?Z:Is(ee),X=we==null?Z:Is(we),Z=new Ae(ie,z+"leave",ee,l,se),Z.target=ct,Z.relatedTarget=X,ie=null,aa(se)===W&&(Ae=new Ae(G,z+"enter",we,l,se),Ae.target=X,Ae.relatedTarget=ct,ie=Ae),ct=ie,ee&&we)t:{for(Ae=ee,G=we,z=0,X=Ae;X;X=Do(X))z++;for(X=0,ie=G;ie;ie=Do(ie))X++;for(;0<z-X;)Ae=Do(Ae),z--;for(;0<X-z;)G=Do(G),X--;for(;z--;){if(Ae===G||G!==null&&Ae===G.alternate)break t;Ae=Do(Ae),G=Do(G)}Ae=null}else Ae=null;ee!==null&&IE(oe,Z,ee,Ae,!1),we!==null&&ct!==null&&IE(oe,ct,we,Ae,!0)}}e:{if(Z=W?Is(W):window,ee=Z.nodeName&&Z.nodeName.toLowerCase(),ee==="select"||ee==="input"&&Z.type==="file")var ye=Qv;else if(Ht(Z))if(Xv)ye=PC;else{ye=OC;var Fe=DC}else ee=Z.nodeName,!ee||ee.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?W&&Ol(W.elementType)&&(ye=Qv):ye=MC;if(ye&&(ye=ye(s,W))){fa(oe,ye,l,se);break e}Fe&&Fe(s,Z,W),s==="focusout"&&W&&Z.type==="number"&&W.memoizedProps.value!=null&&Ga(Z,"number",Z.value)}switch(Fe=W?Is(W):window,s){case"focusin":(Ht(Fe)||Fe.contentEditable==="true")&&(oo=Fe,Of=W,Bl=null);break;case"focusout":Bl=Of=oo=null;break;case"mousedown":Mf=!0;break;case"contextmenu":case"mouseup":case"dragend":Mf=!1,ay(oe,l,se);break;case"selectionchange":if(LC)break;case"keydown":case"keyup":ay(oe,l,se)}var _e;if(Ls)e:{switch(s){case"compositionstart":var Ce="onCompositionStart";break e;case"compositionend":Ce="onCompositionEnd";break e;case"compositionupdate":Ce="onCompositionUpdate";break e}Ce=void 0}else Ke?te(s,l)&&(Ce="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Ce="onCompositionStart");Ce&&(E&&l.locale!=="ko"&&(Ke||Ce!=="onCompositionStart"?Ce==="onCompositionEnd"&&Ke&&(_e=Pl()):(Os=se,$a="value"in Os?Os.value:Os.textContent,Ke=!0)),Fe=Dd(W,Ce),0<Fe.length&&(Ce=new Vl(Ce,s,null,l,se),oe.push({event:Ce,listeners:Fe}),_e?Ce.data=_e:(_e=de(l),_e!==null&&(Ce.data=_e)))),(_e=y?Ft(s,l):Qe(s,l))&&(Ce=Dd(W,"onBeforeInput"),0<Ce.length&&(Fe=new Vl("onBeforeInput","beforeinput",null,l,se),oe.push({event:Fe,listeners:Ce}),Fe.data=_e)),_j(oe,s,W,l,se)}SE(oe,i)})}function vc(s,i,l){return{instance:s,listener:i,currentTarget:l}}function Dd(s,i){for(var l=i+"Capture",u=[];s!==null;){var m=s,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=sr(s,l),m!=null&&u.unshift(vc(s,m,g)),m=sr(s,i),m!=null&&u.push(vc(s,m,g))),s.tag===3)return u;s=s.return}return[]}function Do(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function IE(s,i,l,u,m){for(var g=i._reactName,T=[];l!==null&&l!==u;){var S=l,F=S.alternate,W=S.stateNode;if(S=S.tag,F!==null&&F===u)break;S!==5&&S!==26&&S!==27||W===null||(F=W,m?(W=sr(l,g),W!=null&&T.unshift(vc(l,W,F))):m||(W=sr(l,g),W!=null&&T.push(vc(l,W,F)))),l=l.return}T.length!==0&&s.push({event:i,listeners:T})}var Tj=/\r\n?/g,xj=/\u0000|\uFFFD/g;function RE(s){return(typeof s=="string"?s:""+s).replace(Tj,`
`).replace(xj,"")}function DE(s,i){return i=RE(i),RE(s)===i}function Od(){}function lt(s,i,l,u,m,g){switch(l){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||es(s,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&es(s,""+u);break;case"className":Rs(s,"class",u);break;case"tabIndex":Rs(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Rs(s,l,u);break;case"style":Dl(s,u,g);break;case"data":if(i!=="object"){Rs(s,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Zr(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(i!=="input"&&lt(s,i,"name",m.name,m,null),lt(s,i,"formEncType",m.formEncType,m,null),lt(s,i,"formMethod",m.formMethod,m,null),lt(s,i,"formTarget",m.formTarget,m,null)):(lt(s,i,"encType",m.encType,m,null),lt(s,i,"method",m.method,m,null),lt(s,i,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Zr(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=Od);break;case"onScroll":u!=null&&qe("scroll",s);break;case"onScrollEnd":u!=null&&qe("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Zr(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":qe("beforetoggle",s),qe("toggle",s),za(s,"popover",u);break;case"xlinkActuate":tn(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":tn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":tn(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":tn(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":tn(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":tn(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":tn(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":tn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":tn(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":za(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Cf.get(l)||l,za(s,l,u))}}function sp(s,i,l,u,m,g){switch(l){case"style":Dl(s,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"children":typeof u=="string"?es(s,u):(typeof u=="number"||typeof u=="bigint")&&es(s,""+u);break;case"onScroll":u!=null&&qe("scroll",s);break;case"onScrollEnd":u!=null&&qe("scrollend",s);break;case"onClick":u!=null&&(s.onclick=Od);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yr.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),i=l.slice(2,m?l.length-7:void 0),g=s[Dt]||null,g=g!=null?g[l]:null,typeof g=="function"&&s.removeEventListener(i,g,m),typeof u=="function")){typeof g!="function"&&g!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(i,u,m);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):za(s,l,u)}}}function rn(s,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qe("error",s),qe("load",s);var u=!1,m=!1,g;for(g in l)if(l.hasOwnProperty(g)){var T=l[g];if(T!=null)switch(g){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:lt(s,i,g,T,l,null)}}m&&lt(s,i,"srcSet",l.srcSet,l,null),u&&lt(s,i,"src",l.src,l,null);return;case"input":qe("invalid",s);var S=g=T=m=null,F=null,W=null;for(u in l)if(l.hasOwnProperty(u)){var se=l[u];if(se!=null)switch(u){case"name":m=se;break;case"type":T=se;break;case"checked":F=se;break;case"defaultChecked":W=se;break;case"value":g=se;break;case"defaultValue":S=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(a(137,i));break;default:lt(s,i,u,se,l,null)}}er(s,g,S,F,W,T,m,!1),Wr(s);return;case"select":qe("invalid",s),u=T=g=null;for(m in l)if(l.hasOwnProperty(m)&&(S=l[m],S!=null))switch(m){case"value":g=S;break;case"defaultValue":T=S;break;case"multiple":u=S;default:lt(s,i,m,S,l,null)}i=g,l=T,s.multiple=!!u,i!=null?oa(s,!!u,i,!1):l!=null&&oa(s,!!u,l,!0);return;case"textarea":qe("invalid",s),g=m=u=null;for(T in l)if(l.hasOwnProperty(T)&&(S=l[T],S!=null))switch(T){case"value":u=S;break;case"defaultValue":m=S;break;case"children":g=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(a(91));break;default:lt(s,i,T,S,l,null)}tr(s,u,m,g),Wr(s);return;case"option":for(F in l)if(l.hasOwnProperty(F)&&(u=l[F],u!=null))switch(F){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:lt(s,i,F,u,l,null)}return;case"dialog":qe("beforetoggle",s),qe("toggle",s),qe("cancel",s),qe("close",s);break;case"iframe":case"object":qe("load",s);break;case"video":case"audio":for(u=0;u<gc.length;u++)qe(gc[u],s);break;case"image":qe("error",s),qe("load",s);break;case"details":qe("toggle",s);break;case"embed":case"source":case"link":qe("error",s),qe("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in l)if(l.hasOwnProperty(W)&&(u=l[W],u!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:lt(s,i,W,u,l,null)}return;default:if(Ol(i)){for(se in l)l.hasOwnProperty(se)&&(u=l[se],u!==void 0&&sp(s,i,se,u,l,void 0));return}}for(S in l)l.hasOwnProperty(S)&&(u=l[S],u!=null&&lt(s,i,S,u,l,null))}function Aj(s,i,l,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,T=null,S=null,F=null,W=null,se=null;for(ee in l){var oe=l[ee];if(l.hasOwnProperty(ee)&&oe!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":F=oe;default:u.hasOwnProperty(ee)||lt(s,i,ee,null,u,oe)}}for(var Z in u){var ee=u[Z];if(oe=l[Z],u.hasOwnProperty(Z)&&(ee!=null||oe!=null))switch(Z){case"type":g=ee;break;case"name":m=ee;break;case"checked":W=ee;break;case"defaultChecked":se=ee;break;case"value":T=ee;break;case"defaultValue":S=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(a(137,i));break;default:ee!==oe&&lt(s,i,Z,ee,u,oe)}}Vn(s,T,S,F,W,se,g,m);return;case"select":ee=T=S=Z=null;for(g in l)if(F=l[g],l.hasOwnProperty(g)&&F!=null)switch(g){case"value":break;case"multiple":ee=F;default:u.hasOwnProperty(g)||lt(s,i,g,null,u,F)}for(m in u)if(g=u[m],F=l[m],u.hasOwnProperty(m)&&(g!=null||F!=null))switch(m){case"value":Z=g;break;case"defaultValue":S=g;break;case"multiple":T=g;default:g!==F&&lt(s,i,m,g,u,F)}i=S,l=T,u=ee,Z!=null?oa(s,!!l,Z,!1):!!u!=!!l&&(i!=null?oa(s,!!l,i,!0):oa(s,!!l,l?[]:"",!1));return;case"textarea":ee=Z=null;for(S in l)if(m=l[S],l.hasOwnProperty(S)&&m!=null&&!u.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:lt(s,i,S,null,u,m)}for(T in u)if(m=u[T],g=l[T],u.hasOwnProperty(T)&&(m!=null||g!=null))switch(T){case"value":Z=m;break;case"defaultValue":ee=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(a(91));break;default:m!==g&&lt(s,i,T,m,u,g)}rt(s,Z,ee);return;case"option":for(var we in l)if(Z=l[we],l.hasOwnProperty(we)&&Z!=null&&!u.hasOwnProperty(we))switch(we){case"selected":s.selected=!1;break;default:lt(s,i,we,null,u,Z)}for(F in u)if(Z=u[F],ee=l[F],u.hasOwnProperty(F)&&Z!==ee&&(Z!=null||ee!=null))switch(F){case"selected":s.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:lt(s,i,F,Z,u,ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in l)Z=l[Ae],l.hasOwnProperty(Ae)&&Z!=null&&!u.hasOwnProperty(Ae)&&lt(s,i,Ae,null,u,Z);for(W in u)if(Z=u[W],ee=l[W],u.hasOwnProperty(W)&&Z!==ee&&(Z!=null||ee!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(a(137,i));break;default:lt(s,i,W,Z,u,ee)}return;default:if(Ol(i)){for(var ct in l)Z=l[ct],l.hasOwnProperty(ct)&&Z!==void 0&&!u.hasOwnProperty(ct)&&sp(s,i,ct,void 0,u,Z);for(se in u)Z=u[se],ee=l[se],!u.hasOwnProperty(se)||Z===ee||Z===void 0&&ee===void 0||sp(s,i,se,Z,u,ee);return}}for(var G in l)Z=l[G],l.hasOwnProperty(G)&&Z!=null&&!u.hasOwnProperty(G)&&lt(s,i,G,null,u,Z);for(oe in u)Z=u[oe],ee=l[oe],!u.hasOwnProperty(oe)||Z===ee||Z==null&&ee==null||lt(s,i,oe,Z,u,ee)}var ap=null,ip=null;function Md(s){return s.nodeType===9?s:s.ownerDocument}function OE(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ME(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function rp(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var op=null;function Cj(){var s=window.event;return s&&s.type==="popstate"?s===op?!1:(op=s,!0):(op=null,!1)}var PE=typeof setTimeout=="function"?setTimeout:void 0,jj=typeof clearTimeout=="function"?clearTimeout:void 0,kE=typeof Promise=="function"?Promise:void 0,Sj=typeof queueMicrotask=="function"?queueMicrotask:typeof kE<"u"?function(s){return kE.resolve(null).then(s).catch(wj)}:PE;function wj(s){setTimeout(function(){throw s})}function li(s){return s==="head"}function LE(s,i){var l=i,u=0,m=0;do{var g=l.nextSibling;if(s.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(0<u&&8>u){l=u;var T=s.ownerDocument;if(l&1&&yc(T.documentElement),l&2&&yc(T.body),l&4)for(l=T.head,yc(l),T=l.firstChild;T;){var S=T.nextSibling,F=T.nodeName;T[Xi]||F==="SCRIPT"||F==="STYLE"||F==="LINK"&&T.rel.toLowerCase()==="stylesheet"||l.removeChild(T),T=S}}if(m===0){s.removeChild(g),Cc(i);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:u=l.charCodeAt(0)-48;else u=0;l=g}while(l);Cc(i)}function lp(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":lp(l),Ba(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function Ij(s,i,l,u){for(;s.nodeType===1;){var m=l;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Xi])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(g=s.getAttribute("rel"),g==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(g!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(g=s.getAttribute("src"),(g!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===g)return s}else return s;if(s=_s(s.nextSibling),s===null)break}return null}function Rj(s,i,l){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=_s(s.nextSibling),s===null))return null;return s}function cp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Dj(s,i){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")i();else{var u=function(){i(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function _s(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var up=null;function VE(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(i===0)return s;i--}else l==="/$"&&i++}s=s.previousSibling}return null}function UE(s,i,l){switch(i=Md(l),s){case"html":if(s=i.documentElement,!s)throw Error(a(452));return s;case"head":if(s=i.head,!s)throw Error(a(453));return s;case"body":if(s=i.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function yc(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);Ba(s)}var us=new Map,FE=new Set;function Pd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ca=J.d;J.d={f:Oj,r:Mj,D:Pj,C:kj,L:Lj,m:Vj,X:Fj,S:Uj,M:Hj};function Oj(){var s=Ca.f(),i=Cd();return s||i}function Mj(s){var i=ws(s);i!==null&&i.tag===5&&i.type==="form"?r_(i):Ca.r(s)}var Oo=typeof document>"u"?null:document;function HE(s,i,l){var u=Oo;if(u&&typeof i=="string"&&i){var m=Ot(i);m='link[rel="'+s+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),FE.has(m)||(FE.add(m),s={rel:s,crossOrigin:l,href:i},u.querySelector(m)===null&&(i=u.createElement("link"),rn(i,"link",s),jt(i),u.head.appendChild(i)))}}function Pj(s){Ca.D(s),HE("dns-prefetch",s,null)}function kj(s,i){Ca.C(s,i),HE("preconnect",s,i)}function Lj(s,i,l){Ca.L(s,i,l);var u=Oo;if(u&&s&&i){var m='link[rel="preload"][as="'+Ot(i)+'"]';i==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+Ot(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+Ot(l.imageSizes)+'"]')):m+='[href="'+Ot(s)+'"]';var g=m;switch(i){case"style":g=Mo(s);break;case"script":g=Po(s)}us.has(g)||(s=_({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:s,as:i},l),us.set(g,s),u.querySelector(m)!==null||i==="style"&&u.querySelector(_c(g))||i==="script"&&u.querySelector(Ec(g))||(i=u.createElement("link"),rn(i,"link",s),jt(i),u.head.appendChild(i)))}}function Vj(s,i){Ca.m(s,i);var l=Oo;if(l&&s){var u=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+Ot(u)+'"][href="'+Ot(s)+'"]',g=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Po(s)}if(!us.has(g)&&(s=_({rel:"modulepreload",href:s},i),us.set(g,s),l.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Ec(g)))return}u=l.createElement("link"),rn(u,"link",s),jt(u),l.head.appendChild(u)}}}function Uj(s,i,l){Ca.S(s,i,l);var u=Oo;if(u&&s){var m=Nn(u).hoistableStyles,g=Mo(s);i=i||"default";var T=m.get(g);if(!T){var S={loading:0,preload:null};if(T=u.querySelector(_c(g)))S.loading=5;else{s=_({rel:"stylesheet",href:s,"data-precedence":i},l),(l=us.get(g))&&dp(s,l);var F=T=u.createElement("link");jt(F),rn(F,"link",s),F._p=new Promise(function(W,se){F.onload=W,F.onerror=se}),F.addEventListener("load",function(){S.loading|=1}),F.addEventListener("error",function(){S.loading|=2}),S.loading|=4,kd(T,i,u)}T={type:"stylesheet",instance:T,count:1,state:S},m.set(g,T)}}}function Fj(s,i){Ca.X(s,i);var l=Oo;if(l&&s){var u=Nn(l).hoistableScripts,m=Po(s),g=u.get(m);g||(g=l.querySelector(Ec(m)),g||(s=_({src:s,async:!0},i),(i=us.get(m))&&hp(s,i),g=l.createElement("script"),jt(g),rn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function Hj(s,i){Ca.M(s,i);var l=Oo;if(l&&s){var u=Nn(l).hoistableScripts,m=Po(s),g=u.get(m);g||(g=l.querySelector(Ec(m)),g||(s=_({src:s,async:!0,type:"module"},i),(i=us.get(m))&&hp(s,i),g=l.createElement("script"),jt(g),rn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function qE(s,i,l,u){var m=(m=Ie.current)?Pd(m):null;if(!m)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=Mo(l.href),l=Nn(m).hoistableStyles,u=l.get(i),u||(u={type:"style",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Mo(l.href);var g=Nn(m).hoistableStyles,T=g.get(s);if(T||(m=m.ownerDocument||m,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(s,T),(g=m.querySelector(_c(s)))&&!g._p&&(T.instance=g,T.state.loading=5),us.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},us.set(s,l),g||qj(m,s,l,T.state))),i&&u===null)throw Error(a(528,""));return T}if(i&&u!==null)throw Error(a(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Po(l),l=Nn(m).hoistableScripts,u=l.get(i),u||(u={type:"script",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Mo(s){return'href="'+Ot(s)+'"'}function _c(s){return'link[rel="stylesheet"]['+s+"]"}function BE(s){return _({},s,{"data-precedence":s.precedence,precedence:null})}function qj(s,i,l,u){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=s.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),rn(i,"link",l),jt(i),s.head.appendChild(i))}function Po(s){return'[src="'+Ot(s)+'"]'}function Ec(s){return"script[async]"+s}function zE(s,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var u=s.querySelector('style[data-href~="'+Ot(l.href)+'"]');if(u)return i.instance=u,jt(u),u;var m=_({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),jt(u),rn(u,"style",m),kd(u,l.precedence,s),i.instance=u;case"stylesheet":m=Mo(l.href);var g=s.querySelector(_c(m));if(g)return i.state.loading|=4,i.instance=g,jt(g),g;u=BE(l),(m=us.get(m))&&dp(u,m),g=(s.ownerDocument||s).createElement("link"),jt(g);var T=g;return T._p=new Promise(function(S,F){T.onload=S,T.onerror=F}),rn(g,"link",u),i.state.loading|=4,kd(g,l.precedence,s),i.instance=g;case"script":return g=Po(l.src),(m=s.querySelector(Ec(g)))?(i.instance=m,jt(m),m):(u=l,(m=us.get(g))&&(u=_({},l),hp(u,m)),s=s.ownerDocument||s,m=s.createElement("script"),jt(m),rn(m,"link",u),s.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,kd(u,l.precedence,s));return i.instance}function kd(s,i,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,g=m,T=0;T<u.length;T++){var S=u[T];if(S.dataset.precedence===i)g=S;else if(g!==m)break}g?g.parentNode.insertBefore(s,g.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(s,i.firstChild))}function dp(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function hp(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var Ld=null;function GE(s,i,l){if(Ld===null){var u=new Map,m=Ld=new Map;m.set(l,u)}else m=Ld,u=m.get(l),u||(u=new Map,m.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),m=0;m<l.length;m++){var g=l[m];if(!(g[Xi]||g[Ut]||s==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var T=g.getAttribute(i)||"";T=s+T;var S=u.get(T);S?S.push(g):u.set(T,[g])}}return u}function $E(s,i,l){s=s.ownerDocument||s,s.head.insertBefore(l,i==="title"?s.querySelector("head > title"):null)}function Bj(s,i,l){if(l===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function YE(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var bc=null;function zj(){}function Gj(s,i,l){if(bc===null)throw Error(a(475));var u=bc;if(i.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var m=Mo(l.href),g=s.querySelector(_c(m));if(g){s=g._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(u.count++,u=Vd.bind(u),s.then(u,u)),i.state.loading|=4,i.instance=g,jt(g);return}g=s.ownerDocument||s,l=BE(l),(m=us.get(m))&&dp(l,m),g=g.createElement("link"),jt(g);var T=g;T._p=new Promise(function(S,F){T.onload=S,T.onerror=F}),rn(g,"link",l),i.instance=g}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(u.count++,i=Vd.bind(u),s.addEventListener("load",i),s.addEventListener("error",i))}}function $j(){if(bc===null)throw Error(a(475));var s=bc;return s.stylesheets&&s.count===0&&fp(s,s.stylesheets),0<s.count?function(i){var l=setTimeout(function(){if(s.stylesheets&&fp(s,s.stylesheets),s.unsuspend){var u=s.unsuspend;s.unsuspend=null,u()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(l)}}:null}function Vd(){if(this.count--,this.count===0){if(this.stylesheets)fp(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Ud=null;function fp(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Ud=new Map,i.forEach(Yj,s),Ud=null,Vd.call(s))}function Yj(s,i){if(!(i.state.loading&4)){var l=Ud.get(s);if(l)var u=l.get(null);else{l=new Map,Ud.set(s,l);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var T=m[g];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(l.set(T.dataset.precedence,T),u=T)}u&&l.set(null,u)}m=i.instance,T=m.getAttribute("data-precedence"),g=l.get(T)||u,g===u&&l.set(null,m),l.set(T,m),this.count++,u=Vd.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),g?g.parentNode.insertBefore(m,g.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),i.state.loading|=4}}var Nc={$$typeof:O,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function Kj(s,i,l,u,m,g,T,S){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=na(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=na(0),this.hiddenUpdates=na(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=S,this.incompleteTransitions=new Map}function KE(s,i,l,u,m,g,T,S,F,W,se,oe){return s=new Kj(s,i,l,T,S,F,W,oe),i=1,g===!0&&(i|=24),g=Fn(3,null,null,i),s.current=g,g.stateNode=s,i=Kf(),i.refCount++,s.pooledCache=i,i.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:i},Zf(g),s}function QE(s){return s?(s=ho,s):ho}function XE(s,i,l,u,m,g){m=QE(m),u.context===null?u.context=m:u.pendingContext=m,u=Qa(i),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=Xa(s,u,i),l!==null&&(Gn(l,s,i),Zl(l,s,i))}function WE(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<i?l:i}}function mp(s,i){WE(s,i),(s=s.alternate)&&WE(s,i)}function ZE(s){if(s.tag===13){var i=uo(s,67108864);i!==null&&Gn(i,s,67108864),mp(s,67108864)}}var Fd=!0;function Qj(s,i,l,u){var m=B.T;B.T=null;var g=J.p;try{J.p=2,pp(s,i,l,u)}finally{J.p=g,B.T=m}}function Xj(s,i,l,u){var m=B.T;B.T=null;var g=J.p;try{J.p=8,pp(s,i,l,u)}finally{J.p=g,B.T=m}}function pp(s,i,l,u){if(Fd){var m=gp(u);if(m===null)np(s,i,u,Hd,l),eb(s,u);else if(Zj(m,s,i,l,u))u.stopPropagation();else if(eb(s,u),i&4&&-1<Wj.indexOf(s)){for(;m!==null;){var g=ws(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var T=ms(g.pendingLanes);if(T!==0){var S=g;for(S.pendingLanes|=2,S.entangledLanes|=2;T;){var F=1<<31-mn(T);S.entanglements[1]|=F,T&=~F}Bs(g),(at&6)===0&&(xd=Zn()+500,pc(0))}}break;case 13:S=uo(g,2),S!==null&&Gn(S,g,2),Cd(),mp(g,2)}if(g=gp(u),g===null&&np(s,i,u,Hd,l),g===m)break;m=g}m!==null&&u.stopPropagation()}else np(s,i,u,null,l)}}function gp(s){return s=ts(s),vp(s)}var Hd=null;function vp(s){if(Hd=null,s=aa(s),s!==null){var i=c(s);if(i===null)s=null;else{var l=i.tag;if(l===13){if(s=d(i),s!==null)return s;s=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Hd=s,null}function JE(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ef()){case El:return 2;case Br:return 8;case Gi:case bf:return 32;case zr:return 268435456;default:return 32}default:return 32}}var yp=!1,ci=null,ui=null,di=null,Tc=new Map,xc=new Map,hi=[],Wj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function eb(s,i){switch(s){case"focusin":case"focusout":ci=null;break;case"dragenter":case"dragleave":ui=null;break;case"mouseover":case"mouseout":di=null;break;case"pointerover":case"pointerout":Tc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":xc.delete(i.pointerId)}}function Ac(s,i,l,u,m,g){return s===null||s.nativeEvent!==g?(s={blockedOn:i,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[m]},i!==null&&(i=ws(i),i!==null&&ZE(i)),s):(s.eventSystemFlags|=u,i=s.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),s)}function Zj(s,i,l,u,m){switch(i){case"focusin":return ci=Ac(ci,s,i,l,u,m),!0;case"dragenter":return ui=Ac(ui,s,i,l,u,m),!0;case"mouseover":return di=Ac(di,s,i,l,u,m),!0;case"pointerover":var g=m.pointerId;return Tc.set(g,Ac(Tc.get(g)||null,s,i,l,u,m)),!0;case"gotpointercapture":return g=m.pointerId,xc.set(g,Ac(xc.get(g)||null,s,i,l,u,m)),!0}return!1}function tb(s){var i=aa(s.target);if(i!==null){var l=c(i);if(l!==null){if(i=l.tag,i===13){if(i=d(l),i!==null){s.blockedOn=i,Cu(s.priority,function(){if(l.tag===13){var u=zn();u=Fa(u);var m=uo(l,u);m!==null&&Gn(m,l,u),mp(l,u)}});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function qd(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var l=gp(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);la=u,l.target.dispatchEvent(u),la=null}else return i=ws(l),i!==null&&ZE(i),s.blockedOn=l,!1;i.shift()}return!0}function nb(s,i,l){qd(s)&&l.delete(i)}function Jj(){yp=!1,ci!==null&&qd(ci)&&(ci=null),ui!==null&&qd(ui)&&(ui=null),di!==null&&qd(di)&&(di=null),Tc.forEach(nb),xc.forEach(nb)}function Bd(s,i){s.blockedOn===i&&(s.blockedOn=null,yp||(yp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Jj)))}var zd=null;function sb(s){zd!==s&&(zd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){zd===s&&(zd=null);for(var i=0;i<s.length;i+=3){var l=s[i],u=s[i+1],m=s[i+2];if(typeof u!="function"){if(vp(u||l)===null)continue;break}var g=ws(l);g!==null&&(s.splice(i,3),i-=3,vm(g,{pending:!0,data:m,method:l.method,action:u},u,m))}}))}function Cc(s){function i(F){return Bd(F,s)}ci!==null&&Bd(ci,s),ui!==null&&Bd(ui,s),di!==null&&Bd(di,s),Tc.forEach(i),xc.forEach(i);for(var l=0;l<hi.length;l++){var u=hi[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<hi.length&&(l=hi[0],l.blockedOn===null);)tb(l),l.blockedOn===null&&hi.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var m=l[u],g=l[u+1],T=m[Dt]||null;if(typeof g=="function")T||sb(l);else if(T){var S=null;if(g&&g.hasAttribute("formAction")){if(m=g,T=g[Dt]||null)S=T.formAction;else if(vp(m)!==null)continue}else S=T.action;typeof S=="function"?l[u+1]=S:(l.splice(u,3),u-=3),sb(l)}}}function _p(s){this._internalRoot=s}Gd.prototype.render=_p.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(a(409));var l=i.current,u=zn();XE(l,u,s,i,null,null)},Gd.prototype.unmount=_p.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;XE(s.current,2,null,s,null,null),Cd(),i[Jn]=null}};function Gd(s){this._internalRoot=s}Gd.prototype.unstable_scheduleHydration=function(s){if(s){var i=Ha();s={blockedOn:null,target:s,priority:i};for(var l=0;l<hi.length&&i!==0&&i<hi[l].priority;l++);hi.splice(l,0,s),l===0&&tb(s)}};var ab=e.version;if(ab!=="19.1.0")throw Error(a(527,ab,"19.1.0"));J.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=p(i),s=s!==null?v(s):null,s=s===null?null:s.stateNode,s};var eS={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $d=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$d.isDisabled&&$d.supportsFiber)try{Nt=$d.inject(eS),st=$d}catch{}}return Sc.createRoot=function(s,i){if(!o(s))throw Error(a(299));var l=!1,u="",m=E_,g=b_,T=N_,S=null;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(g=i.onCaughtError),i.onRecoverableError!==void 0&&(T=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(S=i.unstable_transitionCallbacks)),i=KE(s,1,!1,null,null,l,u,m,g,T,S,null),s[Jn]=i.current,tp(s),new _p(i)},Sc.hydrateRoot=function(s,i,l){if(!o(s))throw Error(a(299));var u=!1,m="",g=E_,T=b_,S=N_,F=null,W=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(T=l.onCaughtError),l.onRecoverableError!==void 0&&(S=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(F=l.unstable_transitionCallbacks),l.formState!==void 0&&(W=l.formState)),i=KE(s,1,!0,i,l??null,u,m,g,T,S,F,W),i.context=QE(null),l=i.current,u=zn(),u=Fa(u),m=Qa(u),m.callback=null,Xa(l,m,u),l=u,i.current.lanes=l,sa(i,l),Bs(i),s[Jn]=i.current,tp(s),new Gd(i)},Sc.version="19.1.0",Sc}var mb;function uS(){if(mb)return Np.exports;mb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Np.exports=cS(),Np.exports}var dS=uS();const hS=()=>{};var pb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT=function(n){const e=[];let t=0;for(let a=0;a<n.length;a++){let o=n.charCodeAt(a);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&a+1<n.length&&(n.charCodeAt(a+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++a)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},fS=function(n){const e=[];let t=0,a=0;for(;t<n.length;){const o=n[t++];if(o<128)e[a++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[a++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],f=n[t++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|f&63)-65536;e[a++]=String.fromCharCode(55296+(p>>10)),e[a++]=String.fromCharCode(56320+(p&1023))}else{const c=n[t++],d=n[t++];e[a++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},RT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,f=d?n[o+1]:0,p=o+2<n.length,v=p?n[o+2]:0,_=c>>2,N=(c&3)<<4|f>>4;let C=(f&15)<<2|v>>6,j=v&63;p||(j=64,d||(C=64)),a.push(t[_],t[N],t[C],t[j])}return a.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(IT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):fS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],f=o<n.length?t[n.charAt(o)]:0;++o;const v=o<n.length?t[n.charAt(o)]:64;++o;const N=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||f==null||v==null||N==null)throw new mS;const C=c<<2|f>>4;if(a.push(C),v!==64){const j=f<<4&240|v>>2;if(a.push(j),N!==64){const b=v<<6&192|N;a.push(b)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class mS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pS=function(n){const e=IT(n);return RT.encodeByteArray(e,!0)},mh=function(n){return pS(n).replace(/\./g,"")},DT=function(n){try{return RT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS=()=>gS().__FIREBASE_DEFAULTS__,yS=()=>{if(typeof process>"u"||typeof pb>"u")return;const n=pb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},_S=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&DT(n[1]);return e&&JSON.parse(e)},qh=()=>{try{return hS()||vS()||yS()||_S()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},OT=n=>{var e,t;return(t=(e=qh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},MT=n=>{const e=OT(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},PT=()=>{var n;return(n=qh())===null||n===void 0?void 0:n.config},kT=n=>{var e;return(e=qh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(n){return n.endsWith(".cloudworkstations.dev")}async function Cg(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${a}`,aud:a,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},n);return[mh(JSON.stringify(t)),mh(JSON.stringify(d)),""].join(".")}const Pc={};function bS(){const n={prod:[],emulator:[]};for(const e of Object.keys(Pc))Pc[e]?n.emulator.push(e):n.prod.push(e);return n}function NS(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let gb=!1;function jg(n,e){if(typeof window>"u"||typeof document>"u"||!Vr(window.location.host)||Pc[n]===e||Pc[n]||gb)return;Pc[n]=e;function t(C){return`__firebase__banner__${C}`}const a="__firebase__banner",c=bS().prod.length>0;function d(){const C=document.getElementById(a);C&&C.remove()}function f(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function p(C,j){C.setAttribute("width","24"),C.setAttribute("id",j),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function v(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{gb=!0,d()},C}function _(C,j){C.setAttribute("id",j),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function N(){const C=NS(a),j=t("text"),b=document.getElementById(j)||document.createElement("span"),M=t("learnmore"),x=document.getElementById(M)||document.createElement("a"),V=t("preprendIcon"),$=document.getElementById(V)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const O=C.element;f(O),_(x,M);const U=v();p($,V),O.append($,b,x,U),document.body.appendChild(O)}c?(b.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",j)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",N):N()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function TS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(bn())}function xS(){var n;const e=(n=qh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function AS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function VT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function CS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jS(){const n=bn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function SS(){return!xS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Sg(){try{return typeof indexedDB=="object"}catch{return!1}}function wg(){return new Promise((n,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(a);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(a),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}function UT(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS="FirebaseError";class fs extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=wS,Object.setPrototypeOf(this,fs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ki.prototype.create)}}class ki{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?IS(c,a):"Error",f=`${this.serviceName}: ${d} (${o}).`;return new fs(o,f,a)}}function IS(n,e){return n.replace(RS,(t,a)=>{const o=e[a];return o!=null?String(o):`<${a}?>`})}const RS=/\{\$([^}]+)}/g;function DS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ci(n,e){if(n===e)return!0;const t=Object.keys(n),a=Object.keys(e);for(const o of t){if(!a.includes(o))return!1;const c=n[o],d=e[o];if(vb(c)&&vb(d)){if(!Ci(c,d))return!1}else if(c!==d)return!1}for(const o of a)if(!t.includes(o))return!1;return!0}function vb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(n){const e=[];for(const[t,a]of Object.entries(n))Array.isArray(a)?a.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function wc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[o,c]=a.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Ic(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function OS(n,e){const t=new MS(n,e);return t.subscribe.bind(t)}class MS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let o;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");PS(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:a},o.next===void 0&&(o.next=Cp),o.error===void 0&&(o.error=Cp),o.complete===void 0&&(o.complete=Cp);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function PS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Cp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kS=1e3,LS=2,VS=4*60*60*1e3,US=.5;function yb(n,e=kS,t=LS){const a=e*Math.pow(t,n),o=Math.round(US*a*(Math.random()-.5)*2);return Math.min(VS,a+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(n){return n&&n._delegate?n._delegate:n}class Xn{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new ES;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&a.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const a=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(a)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:a})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qS(e))try{this.getOrInitializeService({instanceIdentifier:Cr})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});a.resolve(c)}catch{}}}}clearInstance(e=Cr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Cr){return this.instances.has(e)}getOptions(e=Cr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[c,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(c);a===f&&d.resolve(o)}return o}onInit(e,t){var a;const o=this.normalizeInstanceIdentifier(t),c=(a=this.onInitCallbacks.get(o))!==null&&a!==void 0?a:new Set;c.add(e),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&e(d,o),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const o of a)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:HS(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=Cr){return this.component?this.component.multipleInstances?e:Cr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function HS(n){return n===Cr?void 0:n}function qS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new FS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Be;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Be||(Be={}));const zS={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},GS=Be.INFO,$S={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},YS=(n,e,...t)=>{if(e<n.logLevel)return;const a=new Date().toISOString(),o=$S[e];if(o)console[o](`[${a}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class iu{constructor(e){this.name=e,this._logLevel=GS,this._logHandler=YS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?zS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}const KS=(n,e)=>e.some(t=>n instanceof t);let _b,Eb;function QS(){return _b||(_b=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function XS(){return Eb||(Eb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const FT=new WeakMap,Kp=new WeakMap,HT=new WeakMap,jp=new WeakMap,Ig=new WeakMap;function WS(n){const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(Ni(n.result)),o()},d=()=>{a(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&FT.set(t,n)}).catch(()=>{}),Ig.set(e,n),e}function ZS(n){if(Kp.has(n))return;const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{a(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});Kp.set(n,e)}let Qp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Kp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||HT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ni(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function JS(n){Qp=n(Qp)}function ew(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=n.call(Sp(this),e,...t);return HT.set(a,e.sort?e.sort():[e]),Ni(a)}:XS().includes(n)?function(...e){return n.apply(Sp(this),e),Ni(FT.get(this))}:function(...e){return Ni(n.apply(Sp(this),e))}}function tw(n){return typeof n=="function"?ew(n):(n instanceof IDBTransaction&&ZS(n),KS(n,QS())?new Proxy(n,Qp):n)}function Ni(n){if(n instanceof IDBRequest)return WS(n);if(jp.has(n))return jp.get(n);const e=tw(n);return e!==n&&(jp.set(n,e),Ig.set(e,n)),e}const Sp=n=>Ig.get(n);function qT(n,e,{blocked:t,upgrade:a,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),f=Ni(d);return a&&d.addEventListener("upgradeneeded",p=>{a(Ni(d.result),p.oldVersion,p.newVersion,Ni(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),f.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",v=>o(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const nw=["get","getKey","getAll","getAllKeys","count"],sw=["put","add","delete","clear"],wp=new Map;function bb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(wp.get(e))return wp.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,o=sw.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(o||nw.includes(t)))return;const c=async function(d,...f){const p=this.transaction(d,o?"readwrite":"readonly");let v=p.store;return a&&(v=v.index(f.shift())),(await Promise.all([v[t](...f),o&&p.done]))[0]};return wp.set(e,c),c}JS(n=>({...n,get:(e,t,a)=>bb(e,t)||n.get(e,t,a),has:(e,t)=>!!bb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(iw(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function iw(n){const e=n.getComponent();return e?.type==="VERSION"}const Xp="@firebase/app",Nb="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Da=new iu("@firebase/app"),rw="@firebase/app-compat",ow="@firebase/analytics-compat",lw="@firebase/analytics",cw="@firebase/app-check-compat",uw="@firebase/app-check",dw="@firebase/auth",hw="@firebase/auth-compat",fw="@firebase/database",mw="@firebase/data-connect",pw="@firebase/database-compat",gw="@firebase/functions",vw="@firebase/functions-compat",yw="@firebase/installations",_w="@firebase/installations-compat",Ew="@firebase/messaging",bw="@firebase/messaging-compat",Nw="@firebase/performance",Tw="@firebase/performance-compat",xw="@firebase/remote-config",Aw="@firebase/remote-config-compat",Cw="@firebase/storage",jw="@firebase/storage-compat",Sw="@firebase/firestore",ww="@firebase/ai",Iw="@firebase/firestore-compat",Rw="firebase",Dw="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp="[DEFAULT]",Ow={[Xp]:"fire-core",[rw]:"fire-core-compat",[lw]:"fire-analytics",[ow]:"fire-analytics-compat",[uw]:"fire-app-check",[cw]:"fire-app-check-compat",[dw]:"fire-auth",[hw]:"fire-auth-compat",[fw]:"fire-rtdb",[mw]:"fire-data-connect",[pw]:"fire-rtdb-compat",[gw]:"fire-fn",[vw]:"fire-fn-compat",[yw]:"fire-iid",[_w]:"fire-iid-compat",[Ew]:"fire-fcm",[bw]:"fire-fcm-compat",[Nw]:"fire-perf",[Tw]:"fire-perf-compat",[xw]:"fire-rc",[Aw]:"fire-rc-compat",[Cw]:"fire-gcs",[jw]:"fire-gcs-compat",[Sw]:"fire-fst",[Iw]:"fire-fst-compat",[ww]:"fire-vertex","fire-js":"fire-js",[Rw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ph=new Map,Mw=new Map,Zp=new Map;function Tb(n,e){try{n.container.addComponent(e)}catch(t){Da.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ds(n){const e=n.name;if(Zp.has(e))return Da.debug(`There were multiple attempts to register component ${e}.`),!1;Zp.set(e,n);for(const t of ph.values())Tb(t,n);for(const t of Mw.values())Tb(t,n);return!0}function ka(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Mn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ti=new ki("app","Firebase",Pw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(e,t,a){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new Xn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ti.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ur=Dw;function BT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const a=Object.assign({name:Wp,automaticDataCollectionEnabled:!0},e),o=a.name;if(typeof o!="string"||!o)throw Ti.create("bad-app-name",{appName:String(o)});if(t||(t=PT()),!t)throw Ti.create("no-options");const c=ph.get(o);if(c){if(Ci(t,c.options)&&Ci(a,c.config))return c;throw Ti.create("duplicate-app",{appName:o})}const d=new BS(o);for(const p of Zp.values())d.addComponent(p);const f=new kw(t,a,d);return ph.set(o,f),f}function ru(n=Wp){const e=ph.get(n);if(!e&&n===Wp&&PT())return BT();if(!e)throw Ti.create("no-app",{appName:n});return e}function En(n,e,t){var a;let o=(a=Ow[n])!==null&&a!==void 0?a:n;t&&(o+=`-${t}`);const c=o.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const f=[`Unable to register library "${o}" with version "${e}":`];c&&f.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Da.warn(f.join(" "));return}ds(new Xn(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lw="firebase-heartbeat-database",Vw=1,$c="firebase-heartbeat-store";let Ip=null;function zT(){return Ip||(Ip=qT(Lw,Vw,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore($c)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ti.create("idb-open",{originalErrorMessage:n.message})})),Ip}async function Uw(n){try{const t=(await zT()).transaction($c),a=await t.objectStore($c).get(GT(n));return await t.done,a}catch(e){if(e instanceof fs)Da.warn(e.message);else{const t=Ti.create("idb-get",{originalErrorMessage:e?.message});Da.warn(t.message)}}}async function xb(n,e){try{const a=(await zT()).transaction($c,"readwrite");await a.objectStore($c).put(e,GT(n)),await a.done}catch(t){if(t instanceof fs)Da.warn(t.message);else{const a=Ti.create("idb-set",{originalErrorMessage:t?.message});Da.warn(a.message)}}}function GT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw=1024,Hw=30;class qw{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new zw(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=Ab();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>Hw){const d=Gw(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){Da.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Ab(),{heartbeatsToSend:a,unsentEntries:o}=Bw(this._heartbeatsCache.heartbeats),c=mh(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Da.warn(t),""}}}function Ab(){return new Date().toISOString().substring(0,10)}function Bw(n,e=Fw){const t=[];let a=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),Cb(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Cb(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class zw{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Sg()?wg().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Uw(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return xb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return xb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function Cb(n){return mh(JSON.stringify({version:2,heartbeats:n})).length}function Gw(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let a=1;a<n.length;a++)n[a].date<t&&(t=n[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(n){ds(new Xn("platform-logger",e=>new aw(e),"PRIVATE")),ds(new Xn("heartbeat",e=>new qw(e),"PRIVATE")),En(Xp,Nb,n),En(Xp,Nb,"esm2017"),En("fire-js","")}$w("");function Rg(n,e){var t={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&e.indexOf(a)<0&&(t[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(n);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(n,a[o])&&(t[a[o]]=n[a[o]]);return t}function $T(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Yw=$T,YT=new ki("auth","Firebase",$T());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh=new iu("@firebase/auth");function Kw(n,...e){gh.logLevel<=Be.WARN&&gh.warn(`Auth (${Ur}): ${n}`,...e)}function nh(n,...e){gh.logLevel<=Be.ERROR&&gh.error(`Auth (${Ur}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hs(n,...e){throw Og(n,...e)}function As(n,...e){return Og(n,...e)}function Dg(n,e,t){const a=Object.assign(Object.assign({},Yw()),{[e]:t});return new ki("auth","Firebase",a).create(e,{appName:n.name})}function Ra(n){return Dg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qw(n,e,t){const a=t;if(!(e instanceof a))throw a.name!==e.constructor.name&&hs(n,"argument-error"),Dg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Og(n,...e){if(typeof n!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=n.name),n._errorFactory.create(t,...a)}return YT.create(n,...e)}function Se(n,e,...t){if(!n)throw Og(e,...t)}function wa(n){const e="INTERNAL ASSERTION FAILED: "+n;throw nh(e),new Error(e)}function Oa(n,e){n||wa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jp(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Xw(){return jb()==="http:"||jb()==="https:"}function jb(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ww(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Xw()||VT()||"connection"in navigator)?navigator.onLine:!0}function Zw(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,t){this.shortDelay=e,this.longDelay=t,Oa(t>e,"Short delay should be less than long delay!"),this.isMobile=TS()||CS()}get(){return Ww()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mg(n,e){Oa(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],tI=new ou(3e4,6e4);function Li(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Vi(n,e,t,a,o={}){return QT(n,o,async()=>{let c={},d={};a&&(e==="GET"?d=a:c={body:JSON.stringify(a)});const f=au(Object.assign({key:n.config.apiKey},d)).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:p},c);return AS()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&Vr(n.emulatorConfig.host)&&(v.credentials="include"),KT.fetch()(await XT(n,n.config.apiHost,t,f),v)})}async function QT(n,e,t){n._canInitEmulator=!1;const a=Object.assign(Object.assign({},Jw),e);try{const o=new sI(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw Yd(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const f=c.ok?d.errorMessage:d.error.message,[p,v]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yd(n,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw Yd(n,"email-already-in-use",d);if(p==="USER_DISABLED")throw Yd(n,"user-disabled",d);const _=a[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw Dg(n,_,v);hs(n,_)}}catch(o){if(o instanceof fs)throw o;hs(n,"network-request-failed",{message:String(o)})}}async function lu(n,e,t,a,o={}){const c=await Vi(n,e,t,a,o);return"mfaPendingCredential"in c&&hs(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function XT(n,e,t,a){const o=`${e}${t}?${a}`,c=n,d=c.config.emulator?Mg(n.config,o):`${n.config.apiScheme}://${o}`;return eI.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function nI(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class sI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(As(this.auth,"network-request-failed")),tI.get())})}}function Yd(n,e,t){const a={appName:n.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const o=As(n,e,a);return o.customData._tokenResponse=t,o}function Sb(n){return n!==void 0&&n.enterprise!==void 0}class aI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return nI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function iI(n,e){return Vi(n,"GET","/v2/recaptchaConfig",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rI(n,e){return Vi(n,"POST","/v1/accounts:delete",e)}async function vh(n,e){return Vi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oI(n,e=!1){const t=vt(n),a=await t.getIdToken(e),o=Pg(a);Se(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:a,authTime:kc(Rp(o.auth_time)),issuedAtTime:kc(Rp(o.iat)),expirationTime:kc(Rp(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Rp(n){return Number(n)*1e3}function Pg(n){const[e,t,a]=n.split(".");if(e===void 0||t===void 0||a===void 0)return nh("JWT malformed, contained fewer than 3 sections"),null;try{const o=DT(t);return o?JSON.parse(o):(nh("Failed to decode base64 JWT payload"),null)}catch(o){return nh("Caught error parsing JWT payload as JSON",o?.toString()),null}}function wb(n){const e=Pg(n);return Se(e,"internal-error"),Se(typeof e.exp<"u","internal-error"),Se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yc(n,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof fs&&lI(a)&&n.auth.currentUser===n&&await n.auth.signOut(),a}}function lI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const a=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),a}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=kc(this.lastLoginAt),this.creationTime=kc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yh(n){var e;const t=n.auth,a=await n.getIdToken(),o=await Yc(n,vh(t,{idToken:a}));Se(o?.users.length,t,"internal-error");const c=o.users[0];n._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?WT(c.providerUserInfo):[],f=dI(n.providerData,d),p=n.isAnonymous,v=!(n.email&&c.passwordHash)&&!f?.length,_=p?v:!1,N={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:f,metadata:new eg(c.createdAt,c.lastLoginAt),isAnonymous:_};Object.assign(n,N)}async function uI(n){const e=vt(n);await yh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function dI(n,e){return[...n.filter(a=>!e.some(o=>o.providerId===a.providerId)),...e]}function WT(n){return n.map(e=>{var{providerId:t}=e,a=Rg(e,["providerId"]);return{providerId:t,uid:a.rawId||"",displayName:a.displayName||null,email:a.email||null,phoneNumber:a.phoneNumber||null,photoURL:a.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hI(n,e){const t=await QT(n,{},async()=>{const a=au({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await XT(n,o,"/v1/token",`key=${c}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:a};return n.emulatorConfig&&Vr(n.emulatorConfig.host)&&(p.credentials="include"),KT.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function fI(n,e){return Vi(n,"POST","/v2/accounts:revokeToken",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Se(e.idToken,"internal-error"),Se(typeof e.idToken<"u","internal-error"),Se(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):wb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Se(e.length!==0,"internal-error");const t=wb(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:o,expiresIn:c}=await hI(e,t);this.updateTokensAndExpiration(a,o,Number(c))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:o,expirationTime:c}=t,d=new Yo;return a&&(Se(typeof a=="string","internal-error",{appName:e}),d.refreshToken=a),o&&(Se(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(Se(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yo,this.toJSON())}_performRefresh(){return wa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mi(n,e){Se(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ts{constructor(e){var{uid:t,auth:a,stsTokenManager:o}=e,c=Rg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new cI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=a,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new eg(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await Yc(this,this.stsTokenManager.getToken(this.auth,e));return Se(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return oI(this,e)}reload(){return uI(this)}_assign(e){this!==e&&(Se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ts(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await yh(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mn(this.auth.app))return Promise.reject(Ra(this.auth));const e=await this.getIdToken();return await Yc(this,rI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var a,o,c,d,f,p,v,_;const N=(a=t.displayName)!==null&&a!==void 0?a:void 0,C=(o=t.email)!==null&&o!==void 0?o:void 0,j=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,b=(d=t.photoURL)!==null&&d!==void 0?d:void 0,M=(f=t.tenantId)!==null&&f!==void 0?f:void 0,x=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,V=(v=t.createdAt)!==null&&v!==void 0?v:void 0,$=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:O,emailVerified:U,isAnonymous:q,providerData:K,stsTokenManager:w}=t;Se(O&&w,e,"internal-error");const A=Yo.fromJSON(this.name,w);Se(typeof O=="string",e,"internal-error"),mi(N,e.name),mi(C,e.name),Se(typeof U=="boolean",e,"internal-error"),Se(typeof q=="boolean",e,"internal-error"),mi(j,e.name),mi(b,e.name),mi(M,e.name),mi(x,e.name),mi(V,e.name),mi($,e.name);const R=new Ts({uid:O,auth:e,email:C,emailVerified:U,displayName:N,isAnonymous:q,photoURL:b,phoneNumber:j,tenantId:M,stsTokenManager:A,createdAt:V,lastLoginAt:$});return K&&Array.isArray(K)&&(R.providerData=K.map(I=>Object.assign({},I))),x&&(R._redirectEventId=x),R}static async _fromIdTokenResponse(e,t,a=!1){const o=new Yo;o.updateFromServerResponse(t);const c=new Ts({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:a});return await yh(c),c}static async _fromGetAccountInfoResponse(e,t,a){const o=t.users[0];Se(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?WT(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,f=new Yo;f.updateFromIdToken(a);const p=new Ts({uid:o.localId,auth:e,stsTokenManager:f,isAnonymous:d}),v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new eg(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,v),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib=new Map;function Ia(n){Oa(n instanceof Function,"Expected a class definition");let e=Ib.get(n);return e?(Oa(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Ib.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ZT.type="NONE";const Rb=ZT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(n,e,t){return`firebase:${n}:${e}:${t}`}class Ko{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:o,name:c}=this.auth;this.fullUserKey=sh(this.userKey,o.apiKey,c),this.fullPersistenceKey=sh("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await vh(this.auth,{idToken:e}).catch(()=>{});return t?Ts._fromGetAccountInfoResponse(this.auth,t,e):null}return Ts._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new Ko(Ia(Rb),e,a);const o=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let c=o[0]||Ia(Rb);const d=sh(a,e.config.apiKey,e.name);let f=null;for(const v of t)try{const _=await v._get(d);if(_){let N;if(typeof _=="string"){const C=await vh(e,{idToken:_}).catch(()=>{});if(!C)break;N=await Ts._fromGetAccountInfoResponse(e,C,_)}else N=Ts._fromJSON(e,_);v!==c&&(f=N),c=v;break}}catch{}const p=o.filter(v=>v._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new Ko(c,e,a):(c=p[0],f&&await c._set(d,f.toJSON()),await Promise.all(t.map(async v=>{if(v!==c)try{await v._remove(d)}catch{}})),new Ko(c,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Db(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(JT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ax(e))return"Blackberry";if(ix(e))return"Webos";if(ex(e))return"Safari";if((e.includes("chrome/")||tx(e))&&!e.includes("edge/"))return"Chrome";if(sx(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=n.match(t);if(a?.length===2)return a[1]}return"Other"}function JT(n=bn()){return/firefox\//i.test(n)}function ex(n=bn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tx(n=bn()){return/crios\//i.test(n)}function nx(n=bn()){return/iemobile/i.test(n)}function sx(n=bn()){return/android/i.test(n)}function ax(n=bn()){return/blackberry/i.test(n)}function ix(n=bn()){return/webos/i.test(n)}function kg(n=bn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function mI(n=bn()){var e;return kg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function pI(){return jS()&&document.documentMode===10}function rx(n=bn()){return kg(n)||sx(n)||ix(n)||ax(n)||/windows phone/i.test(n)||nx(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(n,e=[]){let t;switch(n){case"Browser":t=Db(bn());break;case"Worker":t=`${Db(bn())}-${n}`;break;default:t=n}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ur}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=c=>new Promise((d,f)=>{try{const p=e(c);d(p)}catch(p){f(p)}});a.onAbort=t,this.queue.push(a);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vI(n,e={}){return Vi(n,"GET","/v2/passwordPolicy",Li(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI=6;class _I{constructor(e){var t,a,o,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:yI,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(a=e.allowedNonAlphanumericCharacters)===null||a===void 0?void 0:a.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,a,o,c,d,f;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(a=p.meetsMaxPasswordLength)!==null&&a!==void 0?a:!0),p.isValid&&(p.isValid=(o=p.containsLowercaseLetter)!==null&&o!==void 0?o:!0),p.isValid&&(p.isValid=(c=p.containsUppercaseLetter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(d=p.containsNumericCharacter)!==null&&d!==void 0?d:!0),p.isValid&&(p.isValid=(f=p.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),p}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let o=0;o<e.length;o++)a=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(e,t,a,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ob(this),this.idTokenSubscription=new Ob(this),this.beforeStateQueue=new gI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=YT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ia(t)),this._initializationPromise=this.queue(async()=>{var a,o,c;if(!this._deleted&&(this.persistenceManager=await Ko.create(this,e),(a=this._resolvePersistenceManagerAvailable)===null||a===void 0||a.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await vh(this,{idToken:e}),a=await Ts._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Mn(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const a=await this.assertedPersistence.getCurrentUser();let o=a,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=o?._redirectEventId,p=await this.tryRedirectSignIn(e);(!d||d===f)&&p?.user&&(o=p.user,c=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(o)}catch(d){o=a,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return Se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await yh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Zw()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mn(this.app))return Promise.reject(Ra(this));const t=e?vt(e):null;return t&&Se(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mn(this.app)?Promise.reject(Ra(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mn(this.app)?Promise.reject(Ra(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ia(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vI(this),t=new _I(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ki("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await fI(this,a)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ia(e)||this._popupRedirectResolver;Se(t,this,"argument-error"),this.redirectPersistenceManager=await Ko.create(this,[Ia(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,a;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((a=this.redirectUser)===null||a===void 0?void 0:a._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const a=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==a&&(this.lastNotifiedUid=a,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Se(f,this,"internal-error"),f.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,a,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ox(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const a=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());a&&(t["X-Firebase-Client"]=a);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(Mn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&Kw(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Ui(n){return vt(n)}class Ob{constructor(e){this.auth=e,this.observer=null,this.addObserver=OS(t=>this.observer=t)}get next(){return Se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bI(n){Bh=n}function lx(n){return Bh.loadJS(n)}function NI(){return Bh.recaptchaEnterpriseScript}function TI(){return Bh.gapiScript}function xI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class AI{constructor(){this.enterprise=new CI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class CI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const jI="recaptcha-enterprise",cx="NO_RECAPTCHA";class SI{constructor(e){this.type=jI,this.auth=Ui(e)}async verify(e="verify",t=!1){async function a(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,f)=>{iI(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const v=new aI(p);return c.tenantId==null?c._agentRecaptchaConfig=v:c._tenantRecaptchaConfigs[c.tenantId]=v,d(v.siteKey)}}).catch(p=>{f(p)})})}function o(c,d,f){const p=window.grecaptcha;Sb(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(v=>{d(v)}).catch(()=>{d(cx)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new AI().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{a(this.auth).then(f=>{if(!t&&Sb(window.grecaptcha))o(f,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=NI();p.length!==0&&(p+=f),lx(p).then(()=>{o(f,c,d)}).catch(v=>{d(v)})}}).catch(f=>{d(f)})})}}async function Mb(n,e,t,a=!1,o=!1){const c=new SI(n);let d;if(o)d=cx;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,v=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return a?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function tg(n,e,t,a,o){var c;if(!((c=n._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Mb(n,e,t,t==="getOobCode");return a(n,d)}else return a(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Mb(n,e,t,t==="getOobCode");return a(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(n,e){const t=ka(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Ci(c,e??{}))return o;hs(o,"already-initialized")}return t.initialize({options:e})}function II(n,e){const t=e?.persistence||[],a=(Array.isArray(t)?t:[t]).map(Ia);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(a,e?.popupRedirectResolver)}function RI(n,e,t){const a=Ui(n);Se(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const o=!1,c=ux(e),{host:d,port:f}=DI(e),p=f===null?"":`:${f}`,v={url:`${c}//${d}${p}/`},_=Object.freeze({host:d,port:f,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!a._canInitEmulator){Se(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),Se(Ci(v,a.config.emulator)&&Ci(_,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=v,a.emulatorConfig=_,a.settings.appVerificationDisabledForTesting=!0,Vr(d)?(Cg(`${c}//${d}${p}`),jg("Auth",!0)):OI()}function ux(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function DI(n){const e=ux(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(a);if(o){const c=o[1];return{host:c,port:Pb(a.substr(c.length+1))}}else{const[c,d]=a.split(":");return{host:c,port:Pb(d)}}}function Pb(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function OI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return wa("not implemented")}_getIdTokenResponse(e){return wa("not implemented")}_linkToIdToken(e,t){return wa("not implemented")}_getReauthenticationResolver(e){return wa("not implemented")}}async function MI(n,e){return Vi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PI(n,e){return lu(n,"POST","/v1/accounts:signInWithPassword",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kI(n,e){return lu(n,"POST","/v1/accounts:signInWithEmailLink",Li(n,e))}async function LI(n,e){return lu(n,"POST","/v1/accounts:signInWithEmailLink",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc extends Lg{constructor(e,t,a,o=null){super("password",a),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Kc(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new Kc(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tg(e,t,"signInWithPassword",PI);case"emailLink":return kI(e,{email:this._email,oobCode:this._password});default:hs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tg(e,a,"signUpPassword",MI);case"emailLink":return LI(e,{idToken:t,email:this._email,oobCode:this._password});default:hs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qo(n,e){return lu(n,"POST","/v1/accounts:signInWithIdp",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI="http://localhost";class Rr extends Lg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Rr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):hs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:o}=t,c=Rg(t,["providerId","signInMethod"]);if(!a||!o)return null;const d=new Rr(a,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Qo(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,Qo(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qo(e,t)}buildRequest(){const e={requestUri:VI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=au(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UI(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function FI(n){const e=wc(Ic(n)).link,t=e?wc(Ic(e)).deep_link_id:null,a=wc(Ic(n)).deep_link_id;return(a?wc(Ic(a)).link:null)||a||t||e||n}class Vg{constructor(e){var t,a,o,c,d,f;const p=wc(Ic(e)),v=(t=p.apiKey)!==null&&t!==void 0?t:null,_=(a=p.oobCode)!==null&&a!==void 0?a:null,N=UI((o=p.mode)!==null&&o!==void 0?o:null);Se(v&&_&&N,"argument-error"),this.apiKey=v,this.operation=N,this.code=_,this.continueUrl=(c=p.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=p.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=p.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=FI(e);try{return new Vg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(){this.providerId=ul.PROVIDER_ID}static credential(e,t){return Kc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=Vg.parseLink(t);return Se(a,"argument-error"),Kc._fromEmailAndCode(e,a.code,a.tenantId)}}ul.PROVIDER_ID="password";ul.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ul.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu extends Ug{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends cu{constructor(){super("facebook.com")}static credential(e){return Rr._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vi.credential(e.oauthAccessToken)}catch{return null}}}vi.FACEBOOK_SIGN_IN_METHOD="facebook.com";vi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa extends cu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Rr._fromParams({providerId:Sa.PROVIDER_ID,signInMethod:Sa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Sa.credentialFromTaggedObject(e)}static credentialFromError(e){return Sa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return Sa.credential(t,a)}catch{return null}}}Sa.GOOGLE_SIGN_IN_METHOD="google.com";Sa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi extends cu{constructor(){super("github.com")}static credential(e){return Rr._fromParams({providerId:yi.PROVIDER_ID,signInMethod:yi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yi.credentialFromTaggedObject(e)}static credentialFromError(e){return yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yi.credential(e.oauthAccessToken)}catch{return null}}}yi.GITHUB_SIGN_IN_METHOD="github.com";yi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends cu{constructor(){super("twitter.com")}static credential(e,t){return Rr._fromParams({providerId:_i.PROVIDER_ID,signInMethod:_i.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return _i.credentialFromTaggedObject(e)}static credentialFromError(e){return _i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return _i.credential(t,a)}catch{return null}}}_i.TWITTER_SIGN_IN_METHOD="twitter.com";_i.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HI(n,e){return lu(n,"POST","/v1/accounts:signUp",Li(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,o=!1){const c=await Ts._fromIdTokenResponse(e,a,o),d=kb(a);return new Dr({user:c,providerId:d,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const o=kb(a);return new Dr({user:e,providerId:o,_tokenResponse:a,operationType:t})}}function kb(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h extends fs{constructor(e,t,a,o){var c;super(t.code,t.message),this.operationType=a,this.user=o,Object.setPrototypeOf(this,_h.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,o){return new _h(e,t,a,o)}}function dx(n,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?_h._fromErrorAndOperation(n,c,e,a):c})}async function qI(n,e,t=!1){const a=await Yc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Dr._forOperation(n,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BI(n,e,t=!1){const{auth:a}=n;if(Mn(a.app))return Promise.reject(Ra(a));const o="reauthenticate";try{const c=await Yc(n,dx(a,o,e,n),t);Se(c.idToken,a,"internal-error");const d=Pg(c.idToken);Se(d,a,"internal-error");const{sub:f}=d;return Se(n.uid===f,a,"user-mismatch"),Dr._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&hs(a,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hx(n,e,t=!1){if(Mn(n.app))return Promise.reject(Ra(n));const a="signIn",o=await dx(n,a,e),c=await Dr._fromIdTokenResponse(n,a,o);return t||await n._updateCurrentUser(c.user),c}async function zI(n,e){return hx(Ui(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fx(n){const e=Ui(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function GI(n,e,t){if(Mn(n.app))return Promise.reject(Ra(n));const a=Ui(n),d=await tg(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",HI).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&fx(n),p}),f=await Dr._fromIdTokenResponse(a,"signIn",d);return await a._updateCurrentUser(f.user),f}function $I(n,e,t){return Mn(n.app)?Promise.reject(Ra(n)):zI(vt(n),ul.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&fx(n),a})}function YI(n,e,t,a){return vt(n).onIdTokenChanged(e,t,a)}function KI(n,e,t){return vt(n).beforeAuthStateChanged(e,t)}function QI(n,e,t,a){return vt(n).onAuthStateChanged(e,t,a)}function XI(n){return vt(n).signOut()}const Eh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Eh,"1"),this.storage.removeItem(Eh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI=1e3,ZI=10;class px extends mx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),o=this.localCache[t];a!==o&&e(t,o,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,p)=>{this.notifyListeners(d,p)});return}const a=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(a);!t&&this.localCache[a]===d||this.notifyListeners(a,d)},c=this.storage.getItem(a);pI()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,ZI):o()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},WI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}px.type="LOCAL";const JI=px;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx extends mx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}gx.type="SESSION";const vx=gx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eR(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const a=new zh(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:o});const f=Array.from(d).map(async v=>v(t.origin,c)),p=await eR(f);t.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}zh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(n="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((f,p)=>{const v=Fg("",20);o.port1.start();const _=setTimeout(()=>{p(new Error("unsupported_event"))},a);d={messageChannel:o,onMessage(N){const C=N;if(C.data.eventId===v)switch(C.data.status){case"ack":clearTimeout(_),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),f(C.data.response);break;default:clearTimeout(_),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(){return window}function nR(n){Ys().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yx(){return typeof Ys().WorkerGlobalScope<"u"&&typeof Ys().importScripts=="function"}async function sR(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function aR(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function iR(){return yx()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _x="firebaseLocalStorageDb",rR=1,bh="firebaseLocalStorage",Ex="fbase_key";class uu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Gh(n,e){return n.transaction([bh],e?"readwrite":"readonly").objectStore(bh)}function oR(){const n=indexedDB.deleteDatabase(_x);return new uu(n).toPromise()}function ng(){const n=indexedDB.open(_x,rR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const a=n.result;try{a.createObjectStore(bh,{keyPath:Ex})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const a=n.result;a.objectStoreNames.contains(bh)?e(a):(a.close(),await oR(),e(await ng()))})})}async function Lb(n,e,t){const a=Gh(n,!0).put({[Ex]:e,value:t});return new uu(a).toPromise()}async function lR(n,e){const t=Gh(n,!1).get(e),a=await new uu(t).toPromise();return a===void 0?null:a.value}function Vb(n,e){const t=Gh(n,!0).delete(e);return new uu(t).toPromise()}const cR=800,uR=3;class bx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ng(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>uR)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return yx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=zh._getInstance(iR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await sR(),!this.activeServiceWorker)return;this.sender=new tR(this.activeServiceWorker);const a=await this.sender._send("ping",{},800);a&&!((e=a[0])===null||e===void 0)&&e.fulfilled&&!((t=a[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||aR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ng();return await Lb(e,Eh,"1"),await Vb(e,Eh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>Lb(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>lR(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Vb(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Gh(o,!1).getAll();return new uu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)a.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!a.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),cR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}bx.type="LOCAL";const dR=bx;new ou(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nx(n,e){return e?Ia(e):(Se(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg extends Lg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function hR(n){return hx(n.auth,new Hg(n),n.bypassAuthState)}function fR(n){const{auth:e,user:t}=n;return Se(t,e,"internal-error"),BI(t,new Hg(n),n.bypassAuthState)}async function mR(n){const{auth:e,user:t}=n;return Se(t,e,"internal-error"),qI(t,new Hg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(e,t,a,o,c=!1){this.auth=e,this.resolver=a,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:o,tenantId:c,error:d,type:f}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:a,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return hR;case"linkViaPopup":case"linkViaRedirect":return mR;case"reauthViaPopup":case"reauthViaRedirect":return fR;default:hs(this.auth,"internal-error")}}resolve(e){Oa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Oa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pR=new ou(2e3,1e4);async function gR(n,e,t){if(Mn(n.app))return Promise.reject(As(n,"operation-not-supported-in-this-environment"));const a=Ui(n);Qw(n,e,Ug);const o=Nx(a,t);return new jr(a,"signInViaPopup",e,o).executeNotNull()}class jr extends Tx{constructor(e,t,a,o,c){super(e,t,o,c),this.provider=a,this.authWindow=null,this.pollId=null,jr.currentPopupAction&&jr.currentPopupAction.cancel(),jr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Se(e,this.auth,"internal-error"),e}async onExecution(){Oa(this.filter.length===1,"Popup operations only handle one event");const e=Fg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(As(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(As(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,jr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,a;if(!((a=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||a===void 0)&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(As(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,pR.get())};e()}}jr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR="pendingRedirect",ah=new Map;class yR extends Tx{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=ah.get(this.auth._key());if(!e){try{const a=await _R(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}ah.set(this.auth._key(),e)}return this.bypassAuthState||ah.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _R(n,e){const t=NR(e),a=bR(n);if(!await a._isAvailable())return!1;const o=await a._get(t)==="true";return await a._remove(t),o}function ER(n,e){ah.set(n._key(),e)}function bR(n){return Ia(n._redirectPersistence)}function NR(n){return sh(vR,n.config.apiKey,n.name)}async function TR(n,e,t=!1){if(Mn(n.app))return Promise.reject(Ra(n));const a=Ui(n),o=Nx(a,e),d=await new yR(a,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await a._persistUserIfCurrent(d.user),await a._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xR=10*60*1e3;class AR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!CR(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var a;if(e.error&&!xx(e)){const o=((a=e.error.code)===null||a===void 0?void 0:a.split("auth/")[1])||"internal-error";t.onError(As(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=xR&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ub(e))}saveEventToCache(e){this.cachedEventUids.add(Ub(e)),this.lastProcessedEventTime=Date.now()}}function Ub(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function xx({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function CR(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xx(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jR(n,e={}){return Vi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wR=/^https?/;async function IR(n){if(n.config.emulator)return;const{authorizedDomains:e}=await jR(n);for(const t of e)try{if(RR(t))return}catch{}hs(n,"unauthorized-domain")}function RR(n){const e=Jp(),{protocol:t,hostname:a}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&a===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===a}if(!wR.test(t))return!1;if(SR.test(n))return a===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR=new ou(3e4,6e4);function Fb(){const n=Ys().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function OR(n){return new Promise((e,t)=>{var a,o,c;function d(){Fb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Fb(),t(As(n,"network-request-failed"))},timeout:DR.get()})}if(!((o=(a=Ys().gapi)===null||a===void 0?void 0:a.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((c=Ys().gapi)===null||c===void 0)&&c.load)d();else{const f=xI("iframefcb");return Ys()[f]=()=>{gapi.load?d():t(As(n,"network-request-failed"))},lx(`${TI()}?onload=${f}`).catch(p=>t(p))}}).catch(e=>{throw ih=null,e})}let ih=null;function MR(n){return ih=ih||OR(n),ih}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PR=new ou(5e3,15e3),kR="__/auth/iframe",LR="emulator/auth/iframe",VR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},UR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function FR(n){const e=n.config;Se(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Mg(e,LR):`https://${n.config.authDomain}/${kR}`,a={apiKey:e.apiKey,appName:n.name,v:Ur},o=UR.get(n.config.apiHost);o&&(a.eid=o);const c=n._getFrameworks();return c.length&&(a.fw=c.join(",")),`${t}?${au(a).slice(1)}`}async function HR(n){const e=await MR(n),t=Ys().gapi;return Se(t,n,"internal-error"),e.open({where:document.body,url:FR(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:VR,dontclear:!0},a=>new Promise(async(o,c)=>{await a.restyle({setHideOnLeave:!1});const d=As(n,"network-request-failed"),f=Ys().setTimeout(()=>{c(d)},PR.get());function p(){Ys().clearTimeout(f),o(a)}a.ping(p).then(p,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},BR=500,zR=600,GR="_blank",$R="http://localhost";class Hb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function YR(n,e,t,a=BR,o=zR){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-a)/2,0).toString();let f="";const p=Object.assign(Object.assign({},qR),{width:a.toString(),height:o.toString(),top:c,left:d}),v=bn().toLowerCase();t&&(f=tx(v)?GR:t),JT(v)&&(e=e||$R,p.scrollbars="yes");const _=Object.entries(p).reduce((C,[j,b])=>`${C}${j}=${b},`,"");if(mI(v)&&f!=="_self")return KR(e||"",f),new Hb(null);const N=window.open(e||"",f,_);Se(N,n,"popup-blocked");try{N.focus()}catch{}return new Hb(N)}function KR(n,e){const t=document.createElement("a");t.href=n,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR="__/auth/handler",XR="emulator/auth/handler",WR=encodeURIComponent("fac");async function qb(n,e,t,a,o,c){Se(n.config.authDomain,n,"auth-domain-config-required"),Se(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:a,v:Ur,eventId:o};if(e instanceof Ug){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",DS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,N]of Object.entries({}))d[_]=N}if(e instanceof cu){const _=e.getScopes().filter(N=>N!=="");_.length>0&&(d.scopes=_.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const _ of Object.keys(f))f[_]===void 0&&delete f[_];const p=await n._getAppCheckToken(),v=p?`#${WR}=${encodeURIComponent(p)}`:"";return`${ZR(n)}?${au(f).slice(1)}${v}`}function ZR({config:n}){return n.emulator?Mg(n,XR):`https://${n.authDomain}/${QR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp="webStorageSupport";class JR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vx,this._completeRedirectFn=TR,this._overrideRedirectResult=ER}async _openPopup(e,t,a,o){var c;Oa((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await qb(e,t,a,Jp(),o);return YR(e,d,Fg())}async _openRedirect(e,t,a,o){await this._originValidation(e);const c=await qb(e,t,a,Jp(),o);return nR(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Oa(c,"If manager is not set, promise should be"),c)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await HR(e),a=new AR(e);return t.register("authEvent",o=>(Se(o?.authEvent,e,"invalid-auth-event"),{status:a.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Dp,{type:Dp},o=>{var c;const d=(c=o?.[0])===null||c===void 0?void 0:c[Dp];d!==void 0&&t(!!d),hs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=IR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rx()||ex()||kg()}}const e1=JR;var Bb="@firebase/auth",zb="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e(a?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n1(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function s1(n){ds(new Xn("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=a.options;Se(d&&!d.includes(":"),"invalid-api-key",{appName:a.name});const p={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ox(n)},v=new EI(a,o,c,p);return II(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),ds(new Xn("auth-internal",e=>{const t=Ui(e.getProvider("auth").getImmediate());return(a=>new t1(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),En(Bb,zb,n1(n)),En(Bb,zb,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1=5*60,i1=kT("authIdTokenMaxAge")||a1;let Gb=null;const r1=n=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>i1)return;const o=t?.token;Gb!==o&&(Gb=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function o1(n=ru()){const e=ka(n,"auth");if(e.isInitialized())return e.getImmediate();const t=wI(n,{popupRedirectResolver:e1,persistence:[dR,JI,vx]}),a=kT("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(a,location.origin);if(location.origin===c.origin){const d=r1(c.toString());KI(t,d,()=>d(t.currentUser)),YI(t,f=>d(f))}}const o=OT("auth");return o&&RI(t,`http://${o}`),t}function l1(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}bI({loadJS(n){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",n),a.onload=e,a.onerror=o=>{const c=As("internal-error");c.customData=o,t(c)},a.type="text/javascript",a.charset="UTF-8",l1().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});s1("Browser");var c1="firebase",u1="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */En(c1,u1,"app");var $b=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xi,Ax;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,A){function R(){}R.prototype=A.prototype,w.D=A.prototype,w.prototype=new R,w.prototype.constructor=w,w.C=function(I,L,P){for(var k=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)k[Pe-2]=arguments[Pe];return A.prototype[L].apply(I,k)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(a,t),a.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(w,A,R){R||(R=0);var I=Array(16);if(typeof A=="string")for(var L=0;16>L;++L)I[L]=A.charCodeAt(R++)|A.charCodeAt(R++)<<8|A.charCodeAt(R++)<<16|A.charCodeAt(R++)<<24;else for(L=0;16>L;++L)I[L]=A[R++]|A[R++]<<8|A[R++]<<16|A[R++]<<24;A=w.g[0],R=w.g[1],L=w.g[2];var P=w.g[3],k=A+(P^R&(L^P))+I[0]+3614090360&4294967295;A=R+(k<<7&4294967295|k>>>25),k=P+(L^A&(R^L))+I[1]+3905402710&4294967295,P=A+(k<<12&4294967295|k>>>20),k=L+(R^P&(A^R))+I[2]+606105819&4294967295,L=P+(k<<17&4294967295|k>>>15),k=R+(A^L&(P^A))+I[3]+3250441966&4294967295,R=L+(k<<22&4294967295|k>>>10),k=A+(P^R&(L^P))+I[4]+4118548399&4294967295,A=R+(k<<7&4294967295|k>>>25),k=P+(L^A&(R^L))+I[5]+1200080426&4294967295,P=A+(k<<12&4294967295|k>>>20),k=L+(R^P&(A^R))+I[6]+2821735955&4294967295,L=P+(k<<17&4294967295|k>>>15),k=R+(A^L&(P^A))+I[7]+4249261313&4294967295,R=L+(k<<22&4294967295|k>>>10),k=A+(P^R&(L^P))+I[8]+1770035416&4294967295,A=R+(k<<7&4294967295|k>>>25),k=P+(L^A&(R^L))+I[9]+2336552879&4294967295,P=A+(k<<12&4294967295|k>>>20),k=L+(R^P&(A^R))+I[10]+4294925233&4294967295,L=P+(k<<17&4294967295|k>>>15),k=R+(A^L&(P^A))+I[11]+2304563134&4294967295,R=L+(k<<22&4294967295|k>>>10),k=A+(P^R&(L^P))+I[12]+1804603682&4294967295,A=R+(k<<7&4294967295|k>>>25),k=P+(L^A&(R^L))+I[13]+4254626195&4294967295,P=A+(k<<12&4294967295|k>>>20),k=L+(R^P&(A^R))+I[14]+2792965006&4294967295,L=P+(k<<17&4294967295|k>>>15),k=R+(A^L&(P^A))+I[15]+1236535329&4294967295,R=L+(k<<22&4294967295|k>>>10),k=A+(L^P&(R^L))+I[1]+4129170786&4294967295,A=R+(k<<5&4294967295|k>>>27),k=P+(R^L&(A^R))+I[6]+3225465664&4294967295,P=A+(k<<9&4294967295|k>>>23),k=L+(A^R&(P^A))+I[11]+643717713&4294967295,L=P+(k<<14&4294967295|k>>>18),k=R+(P^A&(L^P))+I[0]+3921069994&4294967295,R=L+(k<<20&4294967295|k>>>12),k=A+(L^P&(R^L))+I[5]+3593408605&4294967295,A=R+(k<<5&4294967295|k>>>27),k=P+(R^L&(A^R))+I[10]+38016083&4294967295,P=A+(k<<9&4294967295|k>>>23),k=L+(A^R&(P^A))+I[15]+3634488961&4294967295,L=P+(k<<14&4294967295|k>>>18),k=R+(P^A&(L^P))+I[4]+3889429448&4294967295,R=L+(k<<20&4294967295|k>>>12),k=A+(L^P&(R^L))+I[9]+568446438&4294967295,A=R+(k<<5&4294967295|k>>>27),k=P+(R^L&(A^R))+I[14]+3275163606&4294967295,P=A+(k<<9&4294967295|k>>>23),k=L+(A^R&(P^A))+I[3]+4107603335&4294967295,L=P+(k<<14&4294967295|k>>>18),k=R+(P^A&(L^P))+I[8]+1163531501&4294967295,R=L+(k<<20&4294967295|k>>>12),k=A+(L^P&(R^L))+I[13]+2850285829&4294967295,A=R+(k<<5&4294967295|k>>>27),k=P+(R^L&(A^R))+I[2]+4243563512&4294967295,P=A+(k<<9&4294967295|k>>>23),k=L+(A^R&(P^A))+I[7]+1735328473&4294967295,L=P+(k<<14&4294967295|k>>>18),k=R+(P^A&(L^P))+I[12]+2368359562&4294967295,R=L+(k<<20&4294967295|k>>>12),k=A+(R^L^P)+I[5]+4294588738&4294967295,A=R+(k<<4&4294967295|k>>>28),k=P+(A^R^L)+I[8]+2272392833&4294967295,P=A+(k<<11&4294967295|k>>>21),k=L+(P^A^R)+I[11]+1839030562&4294967295,L=P+(k<<16&4294967295|k>>>16),k=R+(L^P^A)+I[14]+4259657740&4294967295,R=L+(k<<23&4294967295|k>>>9),k=A+(R^L^P)+I[1]+2763975236&4294967295,A=R+(k<<4&4294967295|k>>>28),k=P+(A^R^L)+I[4]+1272893353&4294967295,P=A+(k<<11&4294967295|k>>>21),k=L+(P^A^R)+I[7]+4139469664&4294967295,L=P+(k<<16&4294967295|k>>>16),k=R+(L^P^A)+I[10]+3200236656&4294967295,R=L+(k<<23&4294967295|k>>>9),k=A+(R^L^P)+I[13]+681279174&4294967295,A=R+(k<<4&4294967295|k>>>28),k=P+(A^R^L)+I[0]+3936430074&4294967295,P=A+(k<<11&4294967295|k>>>21),k=L+(P^A^R)+I[3]+3572445317&4294967295,L=P+(k<<16&4294967295|k>>>16),k=R+(L^P^A)+I[6]+76029189&4294967295,R=L+(k<<23&4294967295|k>>>9),k=A+(R^L^P)+I[9]+3654602809&4294967295,A=R+(k<<4&4294967295|k>>>28),k=P+(A^R^L)+I[12]+3873151461&4294967295,P=A+(k<<11&4294967295|k>>>21),k=L+(P^A^R)+I[15]+530742520&4294967295,L=P+(k<<16&4294967295|k>>>16),k=R+(L^P^A)+I[2]+3299628645&4294967295,R=L+(k<<23&4294967295|k>>>9),k=A+(L^(R|~P))+I[0]+4096336452&4294967295,A=R+(k<<6&4294967295|k>>>26),k=P+(R^(A|~L))+I[7]+1126891415&4294967295,P=A+(k<<10&4294967295|k>>>22),k=L+(A^(P|~R))+I[14]+2878612391&4294967295,L=P+(k<<15&4294967295|k>>>17),k=R+(P^(L|~A))+I[5]+4237533241&4294967295,R=L+(k<<21&4294967295|k>>>11),k=A+(L^(R|~P))+I[12]+1700485571&4294967295,A=R+(k<<6&4294967295|k>>>26),k=P+(R^(A|~L))+I[3]+2399980690&4294967295,P=A+(k<<10&4294967295|k>>>22),k=L+(A^(P|~R))+I[10]+4293915773&4294967295,L=P+(k<<15&4294967295|k>>>17),k=R+(P^(L|~A))+I[1]+2240044497&4294967295,R=L+(k<<21&4294967295|k>>>11),k=A+(L^(R|~P))+I[8]+1873313359&4294967295,A=R+(k<<6&4294967295|k>>>26),k=P+(R^(A|~L))+I[15]+4264355552&4294967295,P=A+(k<<10&4294967295|k>>>22),k=L+(A^(P|~R))+I[6]+2734768916&4294967295,L=P+(k<<15&4294967295|k>>>17),k=R+(P^(L|~A))+I[13]+1309151649&4294967295,R=L+(k<<21&4294967295|k>>>11),k=A+(L^(R|~P))+I[4]+4149444226&4294967295,A=R+(k<<6&4294967295|k>>>26),k=P+(R^(A|~L))+I[11]+3174756917&4294967295,P=A+(k<<10&4294967295|k>>>22),k=L+(A^(P|~R))+I[2]+718787259&4294967295,L=P+(k<<15&4294967295|k>>>17),k=R+(P^(L|~A))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+A&4294967295,w.g[1]=w.g[1]+(L+(k<<21&4294967295|k>>>11))&4294967295,w.g[2]=w.g[2]+L&4294967295,w.g[3]=w.g[3]+P&4294967295}a.prototype.u=function(w,A){A===void 0&&(A=w.length);for(var R=A-this.blockSize,I=this.B,L=this.h,P=0;P<A;){if(L==0)for(;P<=R;)o(this,w,P),P+=this.blockSize;if(typeof w=="string"){for(;P<A;)if(I[L++]=w.charCodeAt(P++),L==this.blockSize){o(this,I),L=0;break}}else for(;P<A;)if(I[L++]=w[P++],L==this.blockSize){o(this,I),L=0;break}}this.h=L,this.o+=A},a.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var A=1;A<w.length-8;++A)w[A]=0;var R=8*this.o;for(A=w.length-8;A<w.length;++A)w[A]=R&255,R/=256;for(this.u(w),w=Array(16),A=R=0;4>A;++A)for(var I=0;32>I;I+=8)w[R++]=this.g[A]>>>I&255;return w};function c(w,A){var R=f;return Object.prototype.hasOwnProperty.call(R,w)?R[w]:R[w]=A(w)}function d(w,A){this.h=A;for(var R=[],I=!0,L=w.length-1;0<=L;L--){var P=w[L]|0;I&&P==A||(R[L]=P,I=!1)}this.g=R}var f={};function p(w){return-128<=w&&128>w?c(w,function(A){return new d([A|0],0>A?-1:0)}):new d([w|0],0>w?-1:0)}function v(w){if(isNaN(w)||!isFinite(w))return N;if(0>w)return x(v(-w));for(var A=[],R=1,I=0;w>=R;I++)A[I]=w/R|0,R*=4294967296;return new d(A,0)}function _(w,A){if(w.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(w.charAt(0)=="-")return x(_(w.substring(1),A));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=v(Math.pow(A,8)),I=N,L=0;L<w.length;L+=8){var P=Math.min(8,w.length-L),k=parseInt(w.substring(L,L+P),A);8>P?(P=v(Math.pow(A,P)),I=I.j(P).add(v(k))):(I=I.j(R),I=I.add(v(k)))}return I}var N=p(0),C=p(1),j=p(16777216);n=d.prototype,n.m=function(){if(M(this))return-x(this).m();for(var w=0,A=1,R=0;R<this.g.length;R++){var I=this.i(R);w+=(0<=I?I:4294967296+I)*A,A*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(b(this))return"0";if(M(this))return"-"+x(this).toString(w);for(var A=v(Math.pow(w,6)),R=this,I="";;){var L=U(R,A).g;R=V(R,L.j(A));var P=((0<R.g.length?R.g[0]:R.h)>>>0).toString(w);if(R=L,b(R))return P+I;for(;6>P.length;)P="0"+P;I=P+I}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function b(w){if(w.h!=0)return!1;for(var A=0;A<w.g.length;A++)if(w.g[A]!=0)return!1;return!0}function M(w){return w.h==-1}n.l=function(w){return w=V(this,w),M(w)?-1:b(w)?0:1};function x(w){for(var A=w.g.length,R=[],I=0;I<A;I++)R[I]=~w.g[I];return new d(R,~w.h).add(C)}n.abs=function(){return M(this)?x(this):this},n.add=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0,L=0;L<=A;L++){var P=I+(this.i(L)&65535)+(w.i(L)&65535),k=(P>>>16)+(this.i(L)>>>16)+(w.i(L)>>>16);I=k>>>16,P&=65535,k&=65535,R[L]=k<<16|P}return new d(R,R[R.length-1]&-2147483648?-1:0)};function V(w,A){return w.add(x(A))}n.j=function(w){if(b(this)||b(w))return N;if(M(this))return M(w)?x(this).j(x(w)):x(x(this).j(w));if(M(w))return x(this.j(x(w)));if(0>this.l(j)&&0>w.l(j))return v(this.m()*w.m());for(var A=this.g.length+w.g.length,R=[],I=0;I<2*A;I++)R[I]=0;for(I=0;I<this.g.length;I++)for(var L=0;L<w.g.length;L++){var P=this.i(I)>>>16,k=this.i(I)&65535,Pe=w.i(L)>>>16,ae=w.i(L)&65535;R[2*I+2*L]+=k*ae,$(R,2*I+2*L),R[2*I+2*L+1]+=P*ae,$(R,2*I+2*L+1),R[2*I+2*L+1]+=k*Pe,$(R,2*I+2*L+1),R[2*I+2*L+2]+=P*Pe,$(R,2*I+2*L+2)}for(I=0;I<A;I++)R[I]=R[2*I+1]<<16|R[2*I];for(I=A;I<2*A;I++)R[I]=0;return new d(R,0)};function $(w,A){for(;(w[A]&65535)!=w[A];)w[A+1]+=w[A]>>>16,w[A]&=65535,A++}function O(w,A){this.g=w,this.h=A}function U(w,A){if(b(A))throw Error("division by zero");if(b(w))return new O(N,N);if(M(w))return A=U(x(w),A),new O(x(A.g),x(A.h));if(M(A))return A=U(w,x(A)),new O(x(A.g),A.h);if(30<w.g.length){if(M(w)||M(A))throw Error("slowDivide_ only works with positive integers.");for(var R=C,I=A;0>=I.l(w);)R=q(R),I=q(I);var L=K(R,1),P=K(I,1);for(I=K(I,2),R=K(R,2);!b(I);){var k=P.add(I);0>=k.l(w)&&(L=L.add(R),P=k),I=K(I,1),R=K(R,1)}return A=V(w,L.j(A)),new O(L,A)}for(L=N;0<=w.l(A);){for(R=Math.max(1,Math.floor(w.m()/A.m())),I=Math.ceil(Math.log(R)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),P=v(R),k=P.j(A);M(k)||0<k.l(w);)R-=I,P=v(R),k=P.j(A);b(P)&&(P=C),L=L.add(P),w=V(w,k)}return new O(L,w)}n.A=function(w){return U(this,w).h},n.and=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)&w.i(I);return new d(R,this.h&w.h)},n.or=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)|w.i(I);return new d(R,this.h|w.h)},n.xor=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)^w.i(I);return new d(R,this.h^w.h)};function q(w){for(var A=w.g.length+1,R=[],I=0;I<A;I++)R[I]=w.i(I)<<1|w.i(I-1)>>>31;return new d(R,w.h)}function K(w,A){var R=A>>5;A%=32;for(var I=w.g.length-R,L=[],P=0;P<I;P++)L[P]=0<A?w.i(P+R)>>>A|w.i(P+R+1)<<32-A:w.i(P+R);return new d(L,w.h)}a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,Ax=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=_,xi=d}).apply(typeof $b<"u"?$b:typeof self<"u"?self:typeof window<"u"?window:{});var Kd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cx,Rc,jx,rh,sg,Sx,wx,Ix;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,E){return h==Array.prototype||h==Object.prototype||(h[y]=E.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Kd=="object"&&Kd];for(var y=0;y<h.length;++y){var E=h[y];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var a=t(this);function o(h,y){if(y)e:{var E=a;h=h.split(".");for(var D=0;D<h.length-1;D++){var Q=h[D];if(!(Q in E))break e;E=E[Q]}h=h[h.length-1],D=E[h],y=y(D),y!=D&&y!=null&&e(E,h,{configurable:!0,writable:!0,value:y})}}function c(h,y){h instanceof String&&(h+="");var E=0,D=!1,Q={next:function(){if(!D&&E<h.length){var te=E++;return{value:y(te,h[te]),done:!1}}return D=!0,{done:!0,value:void 0}}};return Q[Symbol.iterator]=function(){return Q},Q}o("Array.prototype.values",function(h){return h||function(){return c(this,function(y,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function p(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function v(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function _(h,y,E){return h.call.apply(h.bind,arguments)}function N(h,y,E){if(!h)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var Q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Q,D),h.apply(y,Q)}}return function(){return h.apply(y,arguments)}}function C(h,y,E){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:N,C.apply(null,arguments)}function j(h,y){var E=Array.prototype.slice.call(arguments,1);return function(){var D=E.slice();return D.push.apply(D,arguments),h.apply(this,D)}}function b(h,y){function E(){}E.prototype=y.prototype,h.aa=y.prototype,h.prototype=new E,h.prototype.constructor=h,h.Qb=function(D,Q,te){for(var de=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)de[Ke-2]=arguments[Ke];return y.prototype[Q].apply(D,de)}}function M(h){const y=h.length;if(0<y){const E=Array(y);for(let D=0;D<y;D++)E[D]=h[D];return E}return[]}function x(h,y){for(let E=1;E<arguments.length;E++){const D=arguments[E];if(p(D)){const Q=h.length||0,te=D.length||0;h.length=Q+te;for(let de=0;de<te;de++)h[Q+de]=D[de]}else h.push(D)}}class V{constructor(y,E){this.i=y,this.j=E,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function $(h){return/^[\s\xa0]*$/.test(h)}function O(){var h=f.navigator;return h&&(h=h.userAgent)?h:""}function U(h){return U[" "](h),h}U[" "]=function(){};var q=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function K(h,y,E){for(const D in h)y.call(E,h[D],D,h)}function w(h,y){for(const E in h)y.call(void 0,h[E],E,h)}function A(h){const y={};for(const E in h)y[E]=h[E];return y}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(h,y){let E,D;for(let Q=1;Q<arguments.length;Q++){D=arguments[Q];for(E in D)h[E]=D[E];for(let te=0;te<R.length;te++)E=R[te],Object.prototype.hasOwnProperty.call(D,E)&&(h[E]=D[E])}}function L(h){var y=1;h=h.split(":");const E=[];for(;0<y&&h.length;)E.push(h.shift()),y--;return h.length&&E.push(h.join(":")),E}function P(h){f.setTimeout(()=>{throw h},0)}function k(){var h=ve;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class Pe{constructor(){this.h=this.g=null}add(y,E){const D=ae.get();D.set(y,E),this.h?this.h.next=D:this.g=D,this.h=D}}var ae=new V(()=>new B,h=>h.reset());class B{constructor(){this.next=this.g=this.h=null}set(y,E){this.h=y,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let J,ce=!1,ve=new Pe,H=()=>{const h=f.Promise.resolve(void 0);J=()=>{h.then(ne)}};var ne=()=>{for(var h;h=k();){try{h.h.call(h.g)}catch(E){P(E)}var y=ae;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}ce=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var Te=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};f.addEventListener("test",E,y),f.removeEventListener("test",E,y)}catch{}return h}();function Ue(h,y){if(ue.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var E=this.type=h.type,D=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(q){e:{try{U(y.nodeName);var Q=!0;break e}catch{}Q=!1}Q||(y=null)}}else E=="mouseover"?y=h.fromElement:E=="mouseout"&&(y=h.toElement);this.relatedTarget=y,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Ie[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Ue.aa.h.call(this)}}b(Ue,ue);var Ie={2:"touch",3:"pen",4:"mouse"};Ue.prototype.h=function(){Ue.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Yt="closure_listenable_"+(1e6*Math.random()|0),ft=0;function js(h,y,E,D,Q){this.listener=h,this.proxy=null,this.src=y,this.type=E,this.capture=!!D,this.ha=Q,this.key=++ft,this.da=this.fa=!1}function Ua(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function ta(h){this.src=h,this.g={},this.h=0}ta.prototype.add=function(h,y,E,D,Q){var te=h.toString();h=this.g[te],h||(h=this.g[te]=[],this.h++);var de=Bi(h,y,D,Q);return-1<de?(y=h[de],E||(y.fa=!1)):(y=new js(y,this.src,te,!!D,Q),y.fa=E,h.push(y)),y};function qi(h,y){var E=y.type;if(E in h.g){var D=h.g[E],Q=Array.prototype.indexOf.call(D,y,void 0),te;(te=0<=Q)&&Array.prototype.splice.call(D,Q,1),te&&(Ua(y),h.g[E].length==0&&(delete h.g[E],h.h--))}}function Bi(h,y,E,D){for(var Q=0;Q<h.length;++Q){var te=h[Q];if(!te.da&&te.listener==y&&te.capture==!!E&&te.ha==D)return Q}return-1}var zi="closure_lm_"+(1e6*Math.random()|0),_l={};function Tu(h,y,E,D,Q){if(Array.isArray(y)){for(var te=0;te<y.length;te++)Tu(h,y[te],E,D,Q);return null}return E=xu(E),h&&h[Yt]?h.K(y,E,v(D)?!!D.capture:!1,Q):Zn(h,y,E,!1,D,Q)}function Zn(h,y,E,D,Q,te){if(!y)throw Error("Invalid event type");var de=v(Q)?!!Q.capture:!!Q,Ke=zr(h);if(Ke||(h[zi]=Ke=new ta(h)),E=Ke.add(y,E,D,de,te),E.proxy)return E;if(D=Ef(),E.proxy=D,D.src=h,D.listener=E,h.addEventListener)Te||(Q=de),Q===void 0&&(Q=!1),h.addEventListener(y.toString(),D,Q);else if(h.attachEvent)h.attachEvent(Gi(y.toString()),D);else if(h.addListener&&h.removeListener)h.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Ef(){function h(E){return y.call(h.src,h.listener,E)}const y=bf;return h}function El(h,y,E,D,Q){if(Array.isArray(y))for(var te=0;te<y.length;te++)El(h,y[te],E,D,Q);else D=v(D)?!!D.capture:!!D,E=xu(E),h&&h[Yt]?(h=h.i,y=String(y).toString(),y in h.g&&(te=h.g[y],E=Bi(te,E,D,Q),-1<E&&(Ua(te[E]),Array.prototype.splice.call(te,E,1),te.length==0&&(delete h.g[y],h.h--)))):h&&(h=zr(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Bi(y,E,D,Q)),(E=-1<h?y[h]:null)&&Br(E))}function Br(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[Yt])qi(y.i,h);else{var E=h.type,D=h.proxy;y.removeEventListener?y.removeEventListener(E,D,h.capture):y.detachEvent?y.detachEvent(Gi(E),D):y.addListener&&y.removeListener&&y.removeListener(D),(E=zr(y))?(qi(E,h),E.h==0&&(E.src=null,y[zi]=null)):Ua(h)}}}function Gi(h){return h in _l?_l[h]:_l[h]="on"+h}function bf(h,y){if(h.da)h=!0;else{y=new Ue(y,this);var E=h.listener,D=h.ha||h.src;h.fa&&Br(h),h=E.call(D,y)}return h}function zr(h){return h=h[zi],h instanceof ta?h:null}var bl="__closure_events_fn_"+(1e9*Math.random()>>>0);function xu(h){return typeof h=="function"?h:(h[bl]||(h[bl]=function(y){return h.handleEvent(y)}),h[bl])}function Nt(){he.call(this),this.i=new ta(this),this.M=this,this.F=null}b(Nt,he),Nt.prototype[Yt]=!0,Nt.prototype.removeEventListener=function(h,y,E,D){El(this,h,y,E,D)};function st(h,y){var E,D=h.F;if(D)for(E=[];D;D=D.F)E.push(D);if(h=h.M,D=y.type||y,typeof y=="string")y=new ue(y,h);else if(y instanceof ue)y.target=y.target||h;else{var Q=y;y=new ue(D,h),I(y,Q)}if(Q=!0,E)for(var te=E.length-1;0<=te;te--){var de=y.g=E[te];Q=Ln(de,D,!0,y)&&Q}if(de=y.g=h,Q=Ln(de,D,!0,y)&&Q,Q=Ln(de,D,!1,y)&&Q,E)for(te=0;te<E.length;te++)de=y.g=E[te],Q=Ln(de,D,!1,y)&&Q}Nt.prototype.N=function(){if(Nt.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var E=h.g[y],D=0;D<E.length;D++)Ua(E[D]);delete h.g[y],h.h--}}this.F=null},Nt.prototype.K=function(h,y,E,D){return this.i.add(String(h),y,!1,E,D)},Nt.prototype.L=function(h,y,E,D){return this.i.add(String(h),y,!0,E,D)};function Ln(h,y,E,D){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var Q=!0,te=0;te<y.length;++te){var de=y[te];if(de&&!de.da&&de.capture==E){var Ke=de.listener,Ft=de.ha||de.src;de.fa&&qi(h.i,de),Q=Ke.call(Ft,D)!==!1&&Q}}return Q&&!D.defaultPrevented}function mn(h,y,E){if(typeof h=="function")E&&(h=C(h,E));else if(h&&typeof h.handleEvent=="function")h=C(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:f.setTimeout(h,y||0)}function Au(h){h.g=mn(()=>{h.g=null,h.i&&(h.i=!1,Au(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class Nf extends he{constructor(y,E){super(),this.m=y,this.l=E,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Au(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $i(h){he.call(this),this.h=h,this.g={}}b($i,he);var Yi=[];function Ki(h){K(h.g,function(y,E){this.g.hasOwnProperty(E)&&Br(y)},h),h.g={}}$i.prototype.N=function(){$i.aa.N.call(this),Ki(this)},$i.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ms=f.JSON.stringify,Gr=f.JSON.parse,Qi=class{stringify(h){return f.JSON.stringify(h,void 0)}parse(h){return f.JSON.parse(h,void 0)}};function Nl(){}Nl.prototype.h=null;function Tl(h){return h.h||(h.h=h.i())}function xl(){}var na={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function sa(){ue.call(this,"d")}b(sa,ue);function Al(){ue.call(this,"c")}b(Al,ue);var Ss={},Cl=null;function Fa(){return Cl=Cl||new Nt}Ss.La="serverreachability";function $r(h){ue.call(this,Ss.La,h)}b($r,ue);function Ha(h){const y=Fa();st(y,new $r(y))}Ss.STAT_EVENT="statevent";function Cu(h,y){ue.call(this,Ss.STAT_EVENT,h),this.stat=y}b(Cu,ue);function yt(h){const y=Fa();st(y,new Cu(y,h))}Ss.Ma="timingevent";function Ut(h,y){ue.call(this,Ss.Ma,h),this.size=y}b(Ut,ue);function Dt(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){h()},y)}function Jn(){this.g=!0}Jn.prototype.xa=function(){this.g=!1};function jl(h,y,E,D,Q,te){h.info(function(){if(h.g)if(te)for(var de="",Ke=te.split("&"),Ft=0;Ft<Ke.length;Ft++){var Qe=Ke[Ft].split("=");if(1<Qe.length){var Qt=Qe[0];Qe=Qe[1];var Ht=Qt.split("_");de=2<=Ht.length&&Ht[1]=="type"?de+(Qt+"="+Qe+"&"):de+(Qt+"=redacted&")}}else de=null;else de=te;return"XMLHTTP REQ ("+D+") [attempt "+Q+"]: "+y+`
`+E+`
`+de})}function Tf(h,y,E,D,Q,te,de){h.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+Q+"]: "+y+`
`+E+`
`+te+" "+de})}function qa(h,y,E,D){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+Xi(h,E)+(D?" "+D:"")})}function ju(h,y){h.info(function(){return"TIMEOUT: "+y})}Jn.prototype.info=function(){};function Xi(h,y){if(!h.g)return y;if(!y)return null;try{var E=JSON.parse(y);if(E){for(h=0;h<E.length;h++)if(Array.isArray(E[h])){var D=E[h];if(!(2>D.length)){var Q=D[1];if(Array.isArray(Q)&&!(1>Q.length)){var te=Q[0];if(te!="noop"&&te!="stop"&&te!="close")for(var de=1;de<Q.length;de++)Q[de]=""}}}}return ms(E)}catch{return y}}var Ba={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},aa={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ws;function Is(){}b(Is,Nl),Is.prototype.g=function(){return new XMLHttpRequest},Is.prototype.i=function(){return{}},ws=new Is;function Nn(h,y,E,D){this.j=h,this.i=y,this.l=E,this.R=D||1,this.U=new $i(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new jt}function jt(){this.i=null,this.g="",this.h=!1}var Sl={},Yr={};function ps(h,y,E){h.L=1,h.v=tr(Vn(y)),h.m=E,h.P=!0,ia(h,null)}function ia(h,y){h.F=Date.now(),Wi(h),h.A=Vn(h.v);var E=h.A,D=h.R;Array.isArray(D)||(D=[String(D)]),Ml(E.i,"t",D),h.C=0,E=h.j.J,h.h=new jt,h.g=Bu(h.j,E?y:null,!h.m),0<h.O&&(h.M=new Nf(C(h.Y,h,h.g),h.O)),y=h.U,E=h.g,D=h.ca;var Q="readystatechange";Array.isArray(Q)||(Q&&(Yi[0]=Q.toString()),Q=Yi);for(var te=0;te<Q.length;te++){var de=Tu(E,Q[te],D||y.handleEvent,!1,y.h||y);if(!de)break;y.g[de.key]=de}y=h.H?A(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),Ha(),jl(h.i,h.u,h.A,h.l,h.R,h.m)}Nn.prototype.ca=function(h){h=h.target;const y=this.M;y&&ss(h)==3?y.j():this.Y(h)},Nn.prototype.Y=function(h){try{if(h==this.g)e:{const Ht=ss(this.g);var y=this.g.Ba();const fa=this.g.Z();if(!(3>Ht)&&(Ht!=3||this.g&&(this.h.h||this.g.oa()||Pu(this.g)))){this.J||Ht!=4||y==7||(y==8||0>=fa?Ha(3):Ha(2)),za(this);var E=this.g.Z();this.X=E;t:if(Su(this)){var D=Pu(this.g);h="";var Q=D.length,te=ss(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){tn(this),Rs(this);var de="";break t}this.h.i=new f.TextDecoder}for(y=0;y<Q;y++)this.h.h=!0,h+=this.h.i.decode(D[y],{stream:!(te&&y==Q-1)});D.length=0,this.h.g+=h,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=E==200,Tf(this.i,this.u,this.A,this.l,this.R,Ht,E),this.o){if(this.T&&!this.K){t:{if(this.g){var Ke,Ft=this.g;if((Ke=Ft.g?Ft.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(Ke)){var Qe=Ke;break t}}Qe=null}if(E=Qe)qa(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Zi(this,E);else{this.o=!1,this.s=3,yt(12),tn(this),Rs(this);break e}}if(this.P){E=!0;let nn;for(;!this.J&&this.C<de.length;)if(nn=wu(this,de),nn==Yr){Ht==4&&(this.s=4,yt(14),E=!1),qa(this.i,this.l,null,"[Incomplete Response]");break}else if(nn==Sl){this.s=4,yt(15),qa(this.i,this.l,de,"[Invalid Chunk]"),E=!1;break}else qa(this.i,this.l,nn,null),Zi(this,nn);if(Su(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ht!=4||de.length!=0||this.h.h||(this.s=1,yt(16),E=!1),this.o=this.o&&E,!E)qa(this.i,this.l,de,"[Invalid Chunked Response]"),tn(this),Rs(this);else if(0<de.length&&!this.W){this.W=!0;var Qt=this.j;Qt.g==this&&Qt.ba&&!Qt.M&&(Qt.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),cr(Qt),Qt.M=!0,yt(11))}}else qa(this.i,this.l,de,null),Zi(this,de);Ht==4&&tn(this),this.o&&!this.J&&(Ht==4?Fu(this.j,this):(this.o=!1,Wi(this)))}else Sf(this.g),E==400&&0<de.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),tn(this),Rs(this)}}}catch{}finally{}};function Su(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function wu(h,y){var E=h.C,D=y.indexOf(`
`,E);return D==-1?Yr:(E=Number(y.substring(E,D)),isNaN(E)?Sl:(D+=1,D+E>y.length?Yr:(y=y.slice(D,D+E),h.C=D+E,y)))}Nn.prototype.cancel=function(){this.J=!0,tn(this)};function Wi(h){h.S=Date.now()+h.I,Iu(h,h.I)}function Iu(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Dt(C(h.ba,h),y)}function za(h){h.B&&(f.clearTimeout(h.B),h.B=null)}Nn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(ju(this.i,this.A),this.L!=2&&(Ha(),yt(17)),tn(this),this.s=2,Rs(this)):Iu(this,this.S-h)};function Rs(h){h.j.G==0||h.J||Fu(h.j,h)}function tn(h){za(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,Ki(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Zi(h,y){try{var E=h.j;if(E.G!=0&&(E.g==h||wl(E.h,h))){if(!h.K&&wl(E.h,h)&&E.G==3){try{var D=E.Da.g.parse(y)}catch{D=null}if(Array.isArray(D)&&D.length==3){var Q=D;if(Q[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<h.F)io(E),so(E);else break e;Ul(E),yt(18)}}else E.za=Q[1],0<E.za-E.T&&37500>Q[2]&&E.F&&E.v==0&&!E.C&&(E.C=Dt(C(E.Za,E),6e3));if(1>=Qr(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else ha(E,11)}else if((h.K||E.g==h)&&io(E),!$(y))for(Q=E.Da.g.parse(y),y=0;y<Q.length;y++){let Qe=Q[y];if(E.T=Qe[0],Qe=Qe[1],E.G==2)if(Qe[0]=="c"){E.K=Qe[1],E.ia=Qe[2];const Qt=Qe[3];Qt!=null&&(E.la=Qt,E.j.info("VER="+E.la));const Ht=Qe[4];Ht!=null&&(E.Aa=Ht,E.j.info("SVER="+E.Aa));const fa=Qe[5];fa!=null&&typeof fa=="number"&&0<fa&&(D=1.5*fa,E.L=D,E.j.info("backChannelRequestTimeoutMs_="+D)),D=E;const nn=h.g;if(nn){const Vs=nn.g?nn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vs){var te=D.h;te.g||Vs.indexOf("spdy")==-1&&Vs.indexOf("quic")==-1&&Vs.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Xr(te,te.h),te.h=null))}if(D.D){const Hl=nn.g?nn.g.getResponseHeader("X-HTTP-Session-Id"):null;Hl&&(D.ya=Hl,rt(D.I,D.D,Hl))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-h.F,E.j.info("Handshake RTT: "+E.R+"ms")),D=E;var de=h;if(D.qa=qu(D,D.J?D.ia:null,D.W),de.K){Tn(D.h,de);var Ke=de,Ft=D.L;Ft&&(Ke.I=Ft),Ke.B&&(za(Ke),Wi(Ke)),D.g=de}else Vu(D);0<E.i.length&&ao(E)}else Qe[0]!="stop"&&Qe[0]!="close"||ha(E,7);else E.G==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?ha(E,7):Ll(E):Qe[0]!="noop"&&E.l&&E.l.ta(Qe),E.v=0)}}Ha(4)}catch{}}var Ru=class{constructor(h,y){this.g=h,this.map=y}};function ra(h){this.l=h||10,f.PerformanceNavigationTiming?(h=f.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Kr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Qr(h){return h.h?1:h.g?h.g.size:0}function wl(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function Xr(h,y){h.g?h.g.add(y):h.h=y}function Tn(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}ra.prototype.cancel=function(){if(this.i=Il(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Il(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const E of h.g.values())y=y.concat(E.D);return y}return M(h.i)}function xf(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var y=[],E=h.length,D=0;D<E;D++)y.push(h[D]);return y}y=[],E=0;for(D in h)y[E++]=h[D];return y}function Wr(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var y=[];h=h.length;for(var E=0;E<h;E++)y.push(E);return y}y=[],E=0;for(const D in h)y[E++]=D;return y}}}function Rl(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var E=Wr(h),D=xf(h),Q=D.length,te=0;te<Q;te++)y.call(void 0,D[te],E&&E[te],h)}var Ji=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Af(h,y){if(h){h=h.split("&");for(var E=0;E<h.length;E++){var D=h[E].indexOf("="),Q=null;if(0<=D){var te=h[E].substring(0,D);Q=h[E].substring(D+1)}else te=h[E];y(te,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function Ot(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Ot){this.h=h.h,er(this,h.j),this.o=h.o,this.g=h.g,Ga(this,h.s),this.l=h.l;var y=h.i,E=new la;E.i=y.i,y.g&&(E.g=new Map(y.g),E.h=y.h),oa(this,E),this.m=h.m}else h&&(y=String(h).match(Ji))?(this.h=!1,er(this,y[1]||"",!0),this.o=es(y[2]||""),this.g=es(y[3]||"",!0),Ga(this,y[4]),this.l=es(y[5]||"",!0),oa(this,y[6]||"",!0),this.m=es(y[7]||"")):(this.h=!1,this.i=new la(null,this.h))}Ot.prototype.toString=function(){var h=[],y=this.j;y&&h.push(nr(y,Dl,!0),":");var E=this.g;return(E||y=="file")&&(h.push("//"),(y=this.o)&&h.push(nr(y,Dl,!0),"@"),h.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&h.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(nr(E,E.charAt(0)=="/"?Cf:Ol,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",nr(E,Zr)),h.join("")};function Vn(h){return new Ot(h)}function er(h,y,E){h.j=E?es(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Ga(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function oa(h,y,E){y instanceof la?(h.i=y,Ou(h.i,h.h)):(E||(y=nr(y,jf)),h.i=new la(y,h.h))}function rt(h,y,E){h.i.set(y,E)}function tr(h){return rt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function es(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function nr(h,y,E){return typeof h=="string"?(h=encodeURI(h).replace(y,Du),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Du(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Dl=/[#\/\?@]/g,Ol=/[#\?:]/g,Cf=/[#\?]/g,jf=/[#\?@]/g,Zr=/#/g;function la(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function ts(h){h.g||(h.g=new Map,h.h=0,h.i&&Af(h.i,function(y,E){h.add(decodeURIComponent(y.replace(/\+/g," ")),E)}))}n=la.prototype,n.add=function(h,y){ts(this),this.i=null,h=Ds(this,h);var E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(y),this.h+=1,this};function ca(h,y){ts(h),y=Ds(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function ua(h,y){return ts(h),y=Ds(h,y),h.g.has(y)}n.forEach=function(h,y){ts(this),this.g.forEach(function(E,D){E.forEach(function(Q){h.call(y,Q,D,this)},this)},this)},n.na=function(){ts(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),E=[];for(let D=0;D<y.length;D++){const Q=h[D];for(let te=0;te<Q.length;te++)E.push(y[D])}return E},n.V=function(h){ts(this);let y=[];if(typeof h=="string")ua(this,h)&&(y=y.concat(this.g.get(Ds(this,h))));else{h=Array.from(this.g.values());for(let E=0;E<h.length;E++)y=y.concat(h[E])}return y},n.set=function(h,y){return ts(this),this.i=null,h=Ds(this,h),ua(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},n.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function Ml(h,y,E){ca(h,y),0<E.length&&(h.i=null,h.g.set(Ds(h,y),M(E)),h.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var E=0;E<y.length;E++){var D=y[E];const te=encodeURIComponent(String(D)),de=this.V(D);for(D=0;D<de.length;D++){var Q=te;de[D]!==""&&(Q+="="+encodeURIComponent(String(de[D]))),h.push(Q)}}return this.i=h.join("&")};function Ds(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Ou(h,y){y&&!h.j&&(ts(h),h.i=null,h.g.forEach(function(E,D){var Q=D.toLowerCase();D!=Q&&(ca(this,D),Ml(this,Q,E))},h)),h.j=y}function sr(h,y){const E=new Jn;if(f.Image){const D=new Image;D.onload=j(ns,E,"TestLoadImage: loaded",!0,y,D),D.onerror=j(ns,E,"TestLoadImage: error",!1,y,D),D.onabort=j(ns,E,"TestLoadImage: abort",!1,y,D),D.ontimeout=j(ns,E,"TestLoadImage: timeout",!1,y,D),f.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=h}else y(!1)}function gs(h,y){const E=new Jn,D=new AbortController,Q=setTimeout(()=>{D.abort(),ns(E,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:D.signal}).then(te=>{clearTimeout(Q),te.ok?ns(E,"TestPingServer: ok",!0,y):ns(E,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(Q),ns(E,"TestPingServer: error",!1,y)})}function ns(h,y,E,D,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),D(E)}catch{}}function ar(){this.g=new Qi}function Os(h,y,E){const D=E||"";try{Rl(h,function(Q,te){let de=Q;v(Q)&&(de=ms(Q)),y.push(D+te+"="+encodeURIComponent(de))})}catch(Q){throw y.push(D+"type="+encodeURIComponent("_badmap")),Q}}function $a(h){this.l=h.Ub||null,this.j=h.eb||!1}b($a,Nl),$a.prototype.g=function(){return new da(this.l,this.j)},$a.prototype.i=function(h){return function(){return h}}({});function da(h,y){Nt.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(da,Nt),n=da.prototype,n.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,Ps(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||f).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ms(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Ps(this)),this.g&&(this.readyState=3,Ps(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Pl(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Pl(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Ms(this):Ps(this),this.readyState==3&&Pl(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Ms(this))},n.Qa=function(h){this.g&&(this.response=h,Ms(this))},n.ga=function(){this.g&&Ms(this)};function Ms(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Ps(h)}n.setRequestHeader=function(h,y){this.u.append(h,y)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var E=y.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=y.next();return h.join(`\r
`)};function Ps(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(da.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function kl(h){let y="";return K(h,function(E,D){y+=D,y+=":",y+=E,y+=`\r
`}),y}function Kt(h,y,E){e:{for(D in E){var D=!1;break e}D=!0}D||(E=kl(E),typeof h=="string"?E!=null&&encodeURIComponent(String(E)):rt(h,y,E))}function nt(h){Nt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(nt,Nt);var Jr=/^https?$/i,ir=["POST","PUT"];n=nt.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,y,E,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ws.g(),this.v=this.o?Tl(this.o):Tl(ws),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(te){Mu(this,te);return}if(h=E||"",E=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var Q in D)E.set(Q,D[Q]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const te of D.keys())E.set(te,D.get(te));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(E.keys()).find(te=>te.toLowerCase()=="content-type"),Q=f.FormData&&h instanceof f.FormData,!(0<=Array.prototype.indexOf.call(ir,y,void 0))||D||Q||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,de]of E)this.g.setRequestHeader(te,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{rr(this),this.u=!0,this.g.send(h),this.u=!1}catch(te){Mu(this,te)}};function Mu(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,eo(h),ks(h)}function eo(h){h.A||(h.A=!0,st(h,"complete"),st(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,st(this,"complete"),st(this,"abort"),ks(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ks(this,!0)),nt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?to(this):this.bb())},n.bb=function(){to(this)};function to(h){if(h.h&&typeof d<"u"&&(!h.v[1]||ss(h)!=4||h.Z()!=2)){if(h.u&&ss(h)==4)mn(h.Ea,0,h);else if(st(h,"readystatechange"),ss(h)==4){h.h=!1;try{const de=h.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var E;if(!(E=y)){var D;if(D=de===0){var Q=String(h.D).match(Ji)[1]||null;!Q&&f.self&&f.self.location&&(Q=f.self.location.protocol.slice(0,-1)),D=!Jr.test(Q?Q.toLowerCase():"")}E=D}if(E)st(h,"complete"),st(h,"success");else{h.m=6;try{var te=2<ss(h)?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.Z()+"]",eo(h)}}finally{ks(h)}}}}function ks(h,y){if(h.g){rr(h);const E=h.g,D=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||st(h,"ready");try{E.onreadystatechange=D}catch{}}}function rr(h){h.I&&(f.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function ss(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<ss(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),Gr(y)}};function Pu(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Sf(h){const y={};h=(h.g&&2<=ss(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<h.length;D++){if($(h[D]))continue;var E=L(h[D]);const Q=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const te=y[Q]||[];y[Q]=te,te.push(E)}w(y,function(D){return D.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function or(h,y,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||y}function no(h){this.Aa=0,this.i=[],this.j=new Jn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=or("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=or("baseRetryDelayMs",5e3,h),this.cb=or("retryDelaySeedMs",1e4,h),this.Wa=or("forwardChannelMaxRetries",2,h),this.wa=or("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ra(h&&h.concurrentRequestLimit),this.Da=new ar,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=no.prototype,n.la=8,n.G=1,n.connect=function(h,y,E,D){yt(0),this.W=h,this.H=y||{},E&&D!==void 0&&(this.H.OSID=E,this.H.OAID=D),this.F=this.X,this.I=qu(this,null,this.W),ao(this)};function Ll(h){if(ku(h),h.G==3){var y=h.U++,E=Vn(h.I);if(rt(E,"SID",h.K),rt(E,"RID",y),rt(E,"TYPE","terminate"),lr(h,E),y=new Nn(h,h.j,y),y.L=2,y.v=tr(Vn(E)),E=!1,f.navigator&&f.navigator.sendBeacon)try{E=f.navigator.sendBeacon(y.v.toString(),"")}catch{}!E&&f.Image&&(new Image().src=y.v,E=!0),E||(y.g=Bu(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Wi(y)}Hu(h)}function so(h){h.g&&(cr(h),h.g.cancel(),h.g=null)}function ku(h){so(h),h.u&&(f.clearTimeout(h.u),h.u=null),io(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&f.clearTimeout(h.s),h.s=null)}function ao(h){if(!Kr(h.h)&&!h.s){h.s=!0;var y=h.Ga;J||H(),ce||(J(),ce=!0),ve.add(y,h),h.B=0}}function wf(h,y){return Qr(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Dt(C(h.Ga,h,y),Fl(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const Q=new Nn(this,this.j,h);let te=this.o;if(this.S&&(te?(te=A(te),I(te,this.S)):te=this.S),this.m!==null||this.O||(Q.H=te,te=null),this.P)e:{for(var y=0,E=0;E<this.i.length;E++){t:{var D=this.i[E];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(y+=D,4096<y){y=E;break e}if(y===4096||E===this.i.length-1){y=E+1;break e}}y=1e3}else y=1e3;y=Lu(this,Q,y),E=Vn(this.I),rt(E,"RID",h),rt(E,"CVER",22),this.D&&rt(E,"X-HTTP-Session-Id",this.D),lr(this,E),te&&(this.O?y="headers="+encodeURIComponent(String(kl(te)))+"&"+y:this.m&&Kt(E,this.m,te)),Xr(this.h,Q),this.Ua&&rt(E,"TYPE","init"),this.P?(rt(E,"$req",y),rt(E,"SID","null"),Q.T=!0,ps(Q,E,null)):ps(Q,E,y),this.G=2}}else this.G==3&&(h?Vl(this,h):this.i.length==0||Kr(this.h)||Vl(this))};function Vl(h,y){var E;y?E=y.l:E=h.U++;const D=Vn(h.I);rt(D,"SID",h.K),rt(D,"RID",E),rt(D,"AID",h.T),lr(h,D),h.m&&h.o&&Kt(D,h.m,h.o),E=new Nn(h,h.j,E,h.B+1),h.m===null&&(E.H=h.o),y&&(h.i=y.D.concat(h.i)),y=Lu(h,E,1e3),E.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Xr(h.h,E),ps(E,D,y)}function lr(h,y){h.H&&K(h.H,function(E,D){rt(y,D,E)}),h.l&&Rl({},function(E,D){rt(y,D,E)})}function Lu(h,y,E){E=Math.min(h.i.length,E);var D=h.l?C(h.l.Na,h.l,h):null;e:{var Q=h.i;let te=-1;for(;;){const de=["count="+E];te==-1?0<E?(te=Q[0].g,de.push("ofs="+te)):te=0:de.push("ofs="+te);let Ke=!0;for(let Ft=0;Ft<E;Ft++){let Qe=Q[Ft].g;const Qt=Q[Ft].map;if(Qe-=te,0>Qe)te=Math.max(0,Q[Ft].g-100),Ke=!1;else try{Os(Qt,de,"req"+Qe+"_")}catch{D&&D(Qt)}}if(Ke){D=de.join("&");break e}}}return h=h.i.splice(0,E),y.D=h,D}function Vu(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;J||H(),ce||(J(),ce=!0),ve.add(y,h),h.v=0}}function Ul(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Dt(C(h.Fa,h),Fl(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,Uu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Dt(C(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),so(this),Uu(this))};function cr(h){h.A!=null&&(f.clearTimeout(h.A),h.A=null)}function Uu(h){h.g=new Nn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=Vn(h.qa);rt(y,"RID","rpc"),rt(y,"SID",h.K),rt(y,"AID",h.T),rt(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&rt(y,"TO",h.ja),rt(y,"TYPE","xmlhttp"),lr(h,y),h.m&&h.o&&Kt(y,h.m,h.o),h.L&&(h.g.I=h.L);var E=h.g;h=h.ia,E.L=1,E.v=tr(Vn(y)),E.m=null,E.P=!0,ia(E,h)}n.Za=function(){this.C!=null&&(this.C=null,so(this),Ul(this),yt(19))};function io(h){h.C!=null&&(f.clearTimeout(h.C),h.C=null)}function Fu(h,y){var E=null;if(h.g==y){io(h),cr(h),h.g=null;var D=2}else if(wl(h.h,y))E=y.D,Tn(h.h,y),D=1;else return;if(h.G!=0){if(y.o)if(D==1){E=y.m?y.m.length:0,y=Date.now()-y.F;var Q=h.B;D=Fa(),st(D,new Ut(D,E)),ao(h)}else Vu(h);else if(Q=y.s,Q==3||Q==0&&0<y.X||!(D==1&&wf(h,y)||D==2&&Ul(h)))switch(E&&0<E.length&&(y=h.h,y.i=y.i.concat(E)),Q){case 1:ha(h,5);break;case 4:ha(h,10);break;case 3:ha(h,6);break;default:ha(h,2)}}}function Fl(h,y){let E=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(E*=2),E*y}function ha(h,y){if(h.j.info("Error code "+y),y==2){var E=C(h.fb,h),D=h.Xa;const Q=!D;D=new Ot(D||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||er(D,"https"),tr(D),Q?sr(D.toString(),E):gs(D.toString(),E)}else yt(2);h.G=0,h.l&&h.l.sa(y),Hu(h),ku(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function Hu(h){if(h.G=0,h.ka=[],h.l){const y=Il(h.h);(y.length!=0||h.i.length!=0)&&(x(h.ka,y),x(h.ka,h.i),h.h.i.length=0,M(h.i),h.i.length=0),h.l.ra()}}function qu(h,y,E){var D=E instanceof Ot?Vn(E):new Ot(E);if(D.g!="")y&&(D.g=y+"."+D.g),Ga(D,D.s);else{var Q=f.location;D=Q.protocol,y=y?y+"."+Q.hostname:Q.hostname,Q=+Q.port;var te=new Ot(null);D&&er(te,D),y&&(te.g=y),Q&&Ga(te,Q),E&&(te.l=E),D=te}return E=h.D,y=h.ya,E&&y&&rt(D,E,y),rt(D,"VER",h.la),lr(h,D),D}function Bu(h,y,E){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new nt(new $a({eb:E})):new nt(h.pa),y.Ha(h.J),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function zu(){}n=zu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ro(){}ro.prototype.g=function(h,y){return new xn(h,y)};function xn(h,y){Nt.call(this),this.g=new no(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!$(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!$(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new Ls(this)}b(xn,Nt),xn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){Ll(this.g)},xn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.u&&(E={},E.__data__=ms(h),h=E);y.i.push(new Ru(y.Ya++,h)),y.G==3&&ao(y)},xn.prototype.N=function(){this.g.l=null,delete this.j,Ll(this.g),delete this.g,xn.aa.N.call(this)};function Gu(h){sa.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const E in y){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}b(Gu,sa);function $u(){Al.call(this),this.status=1}b($u,Al);function Ls(h){this.g=h}b(Ls,zu),Ls.prototype.ua=function(){st(this.g,"a")},Ls.prototype.ta=function(h){st(this.g,new Gu(h))},Ls.prototype.sa=function(h){st(this.g,new $u)},Ls.prototype.ra=function(){st(this.g,"b")},ro.prototype.createWebChannel=ro.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,Ix=function(){return new ro},wx=function(){return Fa()},Sx=Ss,sg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ba.NO_ERROR=0,Ba.TIMEOUT=8,Ba.HTTP_ERROR=6,rh=Ba,aa.COMPLETE="complete",jx=aa,xl.EventType=na,na.OPEN="a",na.CLOSE="b",na.ERROR="c",na.MESSAGE="d",Nt.prototype.listen=Nt.prototype.K,Rc=xl,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,Cx=nt}).apply(typeof Kd<"u"?Kd:typeof self<"u"?self:typeof window<"u"?window:{});const Yb="@firebase/firestore",Kb="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yn.UNAUTHENTICATED=new yn(null),yn.GOOGLE_CREDENTIALS=new yn("google-credentials-uid"),yn.FIRST_PARTY=new yn("first-party-uid"),yn.MOCK_USER=new yn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dl="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or=new iu("@firebase/firestore");function Uo(){return Or.logLevel}function pe(n,...e){if(Or.logLevel<=Be.DEBUG){const t=e.map(qg);Or.debug(`Firestore (${dl}): ${n}`,...t)}}function Ma(n,...e){if(Or.logLevel<=Be.ERROR){const t=e.map(qg);Or.error(`Firestore (${dl}): ${n}`,...t)}}function el(n,...e){if(Or.logLevel<=Be.WARN){const t=e.map(qg);Or.warn(`Firestore (${dl}): ${n}`,...t)}}function qg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(n,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,Rx(n,a,t)}function Rx(n,e,t){let a=`FIRESTORE (${dl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw Ma(a),new Error(a)}function Ze(n,e,t,a){let o="Unexpected state";typeof t=="string"?o=t:a=t,n||Rx(e,o,a)}function De(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends fs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class d1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(yn.UNAUTHENTICATED))}shutdown(){}}class h1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class f1{constructor(e){this.t=e,this.currentUser=yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0,42304);let a=this.i;const o=p=>this.i!==a?(a=this.i,t(p)):Promise.resolve();let c=new Ks;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Ks,e.enqueueRetryable(()=>o(this.currentUser))};const d=()=>{const p=c;e.enqueueRetryable(async()=>{await p.promise,await o(this.currentUser)})},f=p=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit(p=>f(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Ks)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(a=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Ze(typeof a.accessToken=="string",31837,{l:a}),new Dx(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new yn(e)}}class m1{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=yn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class p1{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new m1(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(yn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class g1{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ze(this.o===void 0,3512);const a=c=>{c.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,pe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>a(c))};const o=c=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>o(c)),setTimeout(()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Qb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Qb(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<n;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const o=v1(40);for(let c=0;c<o.length;++c)a.length<20&&o[c]<t&&(a+=e.charAt(o[c]%62))}return a}}function Ve(n,e){return n<e?-1:n>e?1:0}function ag(n,e){let t=0;for(;t<n.length&&t<e.length;){const a=n.codePointAt(t),o=e.codePointAt(t);if(a!==o){if(a<128&&o<128)return Ve(a,o);{const c=Ox(),d=y1(c.encode(Xb(n,t)),c.encode(Xb(e,t)));return d!==0?d:Ve(a,o)}}t+=a>65535?2:1}return Ve(n.length,e.length)}function Xb(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function y1(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Ve(n[t],e[t]);return Ve(n.length,e.length)}function tl(n,e,t){return n.length===e.length&&n.every((a,o)=>t(a,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb=-62135596800,Zb=1e6;class zt{static now(){return zt.fromMillis(Date.now())}static fromDate(e){return zt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*Zb);return new zt(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Wb)throw new me(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Zb}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Wb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{static fromTimestamp(e){return new je(e)}static min(){return new je(new zt(0,0))}static max(){return new je(new zt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jb="__name__";class Gs{constructor(e,t,a){t===void 0?t=0:t>e.length&&xe(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&xe(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return Gs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Gs?e.forEach(a=>{t.push(a)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let o=0;o<a;o++){const c=Gs.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Ve(e.length,t.length)}static compareSegments(e,t){const a=Gs.isNumericId(e),o=Gs.isNumericId(t);return a&&!o?-1:!a&&o?1:a&&o?Gs.extractNumericId(e).compare(Gs.extractNumericId(t)):ag(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return xi.fromString(e.substring(4,e.length-2))}}class ht extends Gs{construct(e,t,a){return new ht(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new me(re.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter(o=>o.length>0))}return new ht(t)}static emptyPath(){return new ht([])}}const _1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class un extends Gs{construct(e,t,a){return new un(e,t,a)}static isValidIdentifier(e){return _1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),un.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Jb}static keyField(){return new un([Jb])}static fromServerFormat(e){const t=[];let a="",o=0;const c=()=>{if(a.length===0)throw new me(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let d=!1;for(;o<e.length;){const f=e[o];if(f==="\\"){if(o+1===e.length)throw new me(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new me(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=p,o+=2}else f==="`"?(d=!d,o++):f!=="."||d?(a+=f,o++):(c(),o++)}if(c(),d)throw new me(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new un(t)}static emptyPath(){return new un([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.path=e}static fromPath(e){return new be(ht.fromString(e))}static fromName(e){return new be(ht.fromString(e).popFirst(5))}static empty(){return new be(ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ht.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new ht(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qc=-1;function E1(n,e){const t=n.toTimestamp().seconds,a=n.toTimestamp().nanoseconds+1,o=je.fromTimestamp(a===1e9?new zt(t+1,0):new zt(t,a));return new ji(o,be.empty(),e)}function b1(n){return new ji(n.readTime,n.key,Qc)}class ji{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new ji(je.min(),be.empty(),Qc)}static max(){return new ji(je.max(),be.empty(),Qc)}}function N1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=be.comparator(n.documentKey,e.documentKey),t!==0?t:Ve(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class x1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hl(n){if(n.code!==re.FAILED_PRECONDITION||n.message!==T1)throw n;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&xe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le((a,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(a,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(a,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):le.reject(t)}static resolve(e){return new le((t,a)=>{t(e)})}static reject(e){return new le((t,a)=>{a(e)})}static waitFor(e){return new le((t,a)=>{let o=0,c=0,d=!1;e.forEach(f=>{++o,f.next(()=>{++c,d&&c===o&&t()},p=>a(p))}),d=!0,c===o&&t()})}static or(e){let t=le.resolve(!1);for(const a of e)t=t.next(o=>o?le.resolve(o):a());return t}static forEach(e,t){const a=[];return e.forEach((o,c)=>{a.push(t.call(this,o,c))}),this.waitFor(a)}static mapArray(e,t){return new le((a,o)=>{const c=e.length,d=new Array(c);let f=0;for(let p=0;p<c;p++){const v=p;t(e[v]).next(_=>{d[v]=_,++f,f===c&&a(d)},_=>o(_))}})}static doWhile(e,t){return new le((a,o)=>{const c=()=>{e()===!0?t().next(()=>{c()},o):a()};c()})}}function A1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function fl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ue(a),this.ce=a=>t.writeSequenceNumber(a))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}$h.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bg=-1;function du(n){return n==null}function Nh(n){return n===0&&1/n==-1/0}function C1(n){return typeof n=="number"&&Number.isInteger(n)&&!Nh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Px="";function j1(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=eN(e)),e=S1(n.get(t),e);return eN(e)}function S1(n,e){let t=e;const a=n.length;for(let o=0;o<a;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case Px:t+="";break;default:t+=c}}return t}function eN(n){return n+Px+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Fi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function kx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e,t){this.comparator=e,this.root=t||cn.EMPTY}insert(e,t){return new bt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cn.BLACK,null,null))}remove(e){return new bt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const o=this.comparator(e,a.key);if(o===0)return t+a.left.size;o<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,a)=>(e(t,a),!1))}toString(){const e=[];return this.inorderTraversal((t,a)=>(e.push(`${t}:${a}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qd(this.root,e,this.comparator,!0)}}class Qd{constructor(e,t,a,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?a(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cn{constructor(e,t,a,o,c){this.key=e,this.value=t,this.color=a??cn.RED,this.left=o??cn.EMPTY,this.right=c??cn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,o,c){return new cn(e??this.key,t??this.value,a??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let o=this;const c=a(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,a),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,a)),o.fixUp()}removeMin(){if(this.left.isEmpty())return cn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return cn.EMPTY;a=o.right.min(),o=o.copy(a.key,a.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw xe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw xe(27949);return e+(this.isRed()?0:1)}}cn.EMPTY=null,cn.RED=!0,cn.BLACK=!1;cn.EMPTY=new class{constructor(){this.size=0}get key(){throw xe(57766)}get value(){throw xe(16141)}get color(){throw xe(16727)}get left(){throw xe(29726)}get right(){throw xe(36894)}copy(e,t,a,o,c){return this}insert(e,t,a){return new cn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.comparator=e,this.data=new bt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,a)=>(e(t),!1))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const o=a.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nN(this.data.getIterator())}getIteratorFrom(e){return new nN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(a=>{t=t.add(a)}),t}isEqual(e){if(!(e instanceof Gt)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Gt(this.comparator);return t.data=e,t}}class nN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.fields=e,e.sort(un.comparator)}static empty(){return new $n([])}unionWith(e){let t=new Gt(un.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new $n(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tl(this.fields,e.fields,(t,a)=>t.isEqual(a))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new Lx("Invalid base64 string: "+c):c}}(e);return new fn(t)}static fromUint8Array(e){const t=function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c}(e);return new fn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const a=new Uint8Array(t.length);for(let o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return a}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fn.EMPTY_BYTE_STRING=new fn("");const w1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Si(n){if(Ze(!!n,39018),typeof n=="string"){let e=0;const t=w1.exec(n);if(Ze(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const a=new Date(n);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:It(n.seconds),nanos:It(n.nanos)}}function It(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wi(n){return typeof n=="string"?fn.fromBase64String(n):fn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx="server_timestamp",Ux="__type__",Fx="__previous_value__",Hx="__local_write_time__";function zg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Ux])===null||t===void 0?void 0:t.stringValue)===Vx}function Yh(n){const e=n.mapValue.fields[Fx];return zg(e)?Yh(e):e}function Xc(n){const e=Si(n.mapValue.fields[Hx].timestampValue);return new zt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(e,t,a,o,c,d,f,p,v,_){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=v,this.isUsingEmulator=_}}const Th="(default)";class Wc{constructor(e,t){this.projectId=e,this.database=t||Th}static empty(){return new Wc("","")}get isDefaultDatabase(){return this.database===Th}isEqual(e){return e instanceof Wc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx="__type__",R1="__max__",Xd={mapValue:{}},Bx="__vector__",xh="value";function Ii(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?zg(n)?4:O1(n)?9007199254740991:D1(n)?10:11:xe(28295,{value:n})}function Xs(n,e){if(n===e)return!0;const t=Ii(n);if(t!==Ii(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Xc(n).isEqual(Xc(e));case 3:return function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=Si(o.timestampValue),f=Si(c.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,c){return wi(o.bytesValue).isEqual(wi(c.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,c){return It(o.geoPointValue.latitude)===It(c.geoPointValue.latitude)&&It(o.geoPointValue.longitude)===It(c.geoPointValue.longitude)}(n,e);case 2:return function(o,c){if("integerValue"in o&&"integerValue"in c)return It(o.integerValue)===It(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=It(o.doubleValue),f=It(c.doubleValue);return d===f?Nh(d)===Nh(f):isNaN(d)&&isNaN(f)}return!1}(n,e);case 9:return tl(n.arrayValue.values||[],e.arrayValue.values||[],Xs);case 10:case 11:return function(o,c){const d=o.mapValue.fields||{},f=c.mapValue.fields||{};if(tN(d)!==tN(f))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(f[p]===void 0||!Xs(d[p],f[p])))return!1;return!0}(n,e);default:return xe(52216,{left:n})}}function Zc(n,e){return(n.values||[]).find(t=>Xs(t,e))!==void 0}function nl(n,e){if(n===e)return 0;const t=Ii(n),a=Ii(e);if(t!==a)return Ve(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ve(n.booleanValue,e.booleanValue);case 2:return function(c,d){const f=It(c.integerValue||c.doubleValue),p=It(d.integerValue||d.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1}(n,e);case 3:return sN(n.timestampValue,e.timestampValue);case 4:return sN(Xc(n),Xc(e));case 5:return ag(n.stringValue,e.stringValue);case 6:return function(c,d){const f=wi(c),p=wi(d);return f.compareTo(p)}(n.bytesValue,e.bytesValue);case 7:return function(c,d){const f=c.split("/"),p=d.split("/");for(let v=0;v<f.length&&v<p.length;v++){const _=Ve(f[v],p[v]);if(_!==0)return _}return Ve(f.length,p.length)}(n.referenceValue,e.referenceValue);case 8:return function(c,d){const f=Ve(It(c.latitude),It(d.latitude));return f!==0?f:Ve(It(c.longitude),It(d.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return aN(n.arrayValue,e.arrayValue);case 10:return function(c,d){var f,p,v,_;const N=c.fields||{},C=d.fields||{},j=(f=N[xh])===null||f===void 0?void 0:f.arrayValue,b=(p=C[xh])===null||p===void 0?void 0:p.arrayValue,M=Ve(((v=j?.values)===null||v===void 0?void 0:v.length)||0,((_=b?.values)===null||_===void 0?void 0:_.length)||0);return M!==0?M:aN(j,b)}(n.mapValue,e.mapValue);case 11:return function(c,d){if(c===Xd.mapValue&&d===Xd.mapValue)return 0;if(c===Xd.mapValue)return 1;if(d===Xd.mapValue)return-1;const f=c.fields||{},p=Object.keys(f),v=d.fields||{},_=Object.keys(v);p.sort(),_.sort();for(let N=0;N<p.length&&N<_.length;++N){const C=ag(p[N],_[N]);if(C!==0)return C;const j=nl(f[p[N]],v[_[N]]);if(j!==0)return j}return Ve(p.length,_.length)}(n.mapValue,e.mapValue);default:throw xe(23264,{Pe:t})}}function sN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ve(n,e);const t=Si(n),a=Si(e),o=Ve(t.seconds,a.seconds);return o!==0?o:Ve(t.nanos,a.nanos)}function aN(n,e){const t=n.values||[],a=e.values||[];for(let o=0;o<t.length&&o<a.length;++o){const c=nl(t[o],a[o]);if(c)return c}return Ve(t.length,a.length)}function sl(n){return ig(n)}function ig(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const a=Si(t);return`time(${a.seconds},${a.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return wi(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return be.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let a="[",o=!0;for(const c of t.values||[])o?o=!1:a+=",",a+=ig(c);return a+"]"}(n.arrayValue):"mapValue"in n?function(t){const a=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of a)c?c=!1:o+=",",o+=`${d}:${ig(t.fields[d])}`;return o+"}"}(n.mapValue):xe(61005,{value:n})}function oh(n){switch(Ii(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Yh(n);return e?16+oh(e):16;case 5:return 2*n.stringValue.length;case 6:return wi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(a){return(a.values||[]).reduce((o,c)=>o+oh(c),0)}(n.arrayValue);case 10:case 11:return function(a){let o=0;return Fi(a.fields,(c,d)=>{o+=c.length+oh(d)}),o}(n.mapValue);default:throw xe(13486,{value:n})}}function iN(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function rg(n){return!!n&&"integerValue"in n}function Gg(n){return!!n&&"arrayValue"in n}function rN(n){return!!n&&"nullValue"in n}function oN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function lh(n){return!!n&&"mapValue"in n}function D1(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[qx])===null||t===void 0?void 0:t.stringValue)===Bx}function Lc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Fi(n.mapValue.fields,(t,a)=>e.mapValue.fields[t]=Lc(a)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Lc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function O1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===R1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.value=e}static empty(){return new Sn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!lh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lc(t)}setAll(e){let t=un.emptyPath(),a={},o=[];e.forEach((d,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,a,o),a={},o=[],t=f.popLast()}d?a[f.lastSegment()]=Lc(d):o.push(f.lastSegment())});const c=this.getFieldsMap(t);this.applyChanges(c,a,o)}delete(e){const t=this.field(e.popLast());lh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let o=t.mapValue.fields[e.get(a)];lh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,a){Fi(t,(o,c)=>e[o]=c);for(const o of a)delete e[o]}clone(){return new Sn(Lc(this.value))}}function zx(n){const e=[];return Fi(n.fields,(t,a)=>{const o=new un([t]);if(lh(a)){const c=zx(a.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)}),new $n(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,t,a,o,c,d,f){this.key=e,this.documentType=t,this.version=a,this.readTime=o,this.createTime=c,this.data=d,this.documentState=f}static newInvalidDocument(e){return new en(e,0,je.min(),je.min(),je.min(),Sn.empty(),0)}static newFoundDocument(e,t,a,o){return new en(e,1,t,je.min(),a,o,0)}static newNoDocument(e,t){return new en(e,2,t,je.min(),je.min(),Sn.empty(),0)}static newUnknownDocument(e,t){return new en(e,3,t,je.min(),je.min(),Sn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Sn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof en&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new en(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e,t){this.position=e,this.inclusive=t}}function lN(n,e,t){let a=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?a=be.comparator(be.fromName(d.referenceValue),t.key):a=nl(d,t.data.field(c.field)),c.dir==="desc"&&(a*=-1),a!==0)break}return a}function cN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Xs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,t="asc"){this.field=e,this.dir=t}}function M1(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{}class Lt extends Gx{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new k1(e,t,a):t==="array-contains"?new U1(e,a):t==="in"?new F1(e,a):t==="not-in"?new H1(e,a):t==="array-contains-any"?new q1(e,a):new Lt(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new L1(e,a):new V1(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(nl(t,this.value)):t!==null&&Ii(this.value)===Ii(t)&&this.matchesComparison(nl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Cs extends Gx{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Cs(e,t)}matches(e){return $x(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function $x(n){return n.op==="and"}function Yx(n){return P1(n)&&$x(n)}function P1(n){for(const e of n.filters)if(e instanceof Cs)return!1;return!0}function og(n){if(n instanceof Lt)return n.field.canonicalString()+n.op.toString()+sl(n.value);if(Yx(n))return n.filters.map(e=>og(e)).join(",");{const e=n.filters.map(t=>og(t)).join(",");return`${n.op}(${e})`}}function Kx(n,e){return n instanceof Lt?function(a,o){return o instanceof Lt&&a.op===o.op&&a.field.isEqual(o.field)&&Xs(a.value,o.value)}(n,e):n instanceof Cs?function(a,o){return o instanceof Cs&&a.op===o.op&&a.filters.length===o.filters.length?a.filters.reduce((c,d,f)=>c&&Kx(d,o.filters[f]),!0):!1}(n,e):void xe(19439)}function Qx(n){return n instanceof Lt?function(t){return`${t.field.canonicalString()} ${t.op} ${sl(t.value)}`}(n):n instanceof Cs?function(t){return t.op.toString()+" {"+t.getFilters().map(Qx).join(" ,")+"}"}(n):"Filter"}class k1 extends Lt{constructor(e,t,a){super(e,t,a),this.key=be.fromName(a.referenceValue)}matches(e){const t=be.comparator(e.key,this.key);return this.matchesComparison(t)}}class L1 extends Lt{constructor(e,t){super(e,"in",t),this.keys=Xx("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class V1 extends Lt{constructor(e,t){super(e,"not-in",t),this.keys=Xx("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Xx(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(a=>be.fromName(a.referenceValue))}class U1 extends Lt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Gg(t)&&Zc(t.arrayValue,this.value)}}class F1 extends Lt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Zc(this.value.arrayValue,t)}}class H1 extends Lt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Zc(this.value.arrayValue,t)}}class q1 extends Lt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Gg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(a=>Zc(this.value.arrayValue,a))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(e,t=null,a=[],o=[],c=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=o,this.limit=c,this.startAt=d,this.endAt=f,this.Ie=null}}function uN(n,e=null,t=[],a=[],o=null,c=null,d=null){return new B1(n,e,t,a,o,c,d)}function $g(n){const e=De(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(a=>og(a)).join(","),t+="|ob:",t+=e.orderBy.map(a=>function(c){return c.field.canonicalString()+c.dir}(a)).join(","),du(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(a=>sl(a)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(a=>sl(a)).join(",")),e.Ie=t}return e.Ie}function Yg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!M1(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Kx(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!cN(n.startAt,e.startAt)&&cN(n.endAt,e.endAt)}function lg(n){return be.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,t=null,a=[],o=[],c=null,d="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=o,this.limit=c,this.limitType=d,this.startAt=f,this.endAt=p,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function z1(n,e,t,a,o,c,d,f){return new ml(n,e,t,a,o,c,d,f)}function Kh(n){return new ml(n)}function dN(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Wx(n){return n.collectionGroup!==null}function Vc(n){const e=De(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ee.push(c),t.add(c.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new Gt(un.comparator);return d.filters.forEach(p=>{p.getFlattenedFilters().forEach(v=>{v.isInequality()&&(f=f.add(v.field))})}),f})(e).forEach(c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ee.push(new Jc(c,a))}),t.has(un.keyField().canonicalString())||e.Ee.push(new Jc(un.keyField(),a))}return e.Ee}function Qs(n){const e=De(n);return e.de||(e.de=G1(e,Vc(n))),e.de}function G1(n,e){if(n.limitType==="F")return uN(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const c=o.dir==="desc"?"asc":"desc";return new Jc(o.field,c)});const t=n.endAt?new Ah(n.endAt.position,n.endAt.inclusive):null,a=n.startAt?new Ah(n.startAt.position,n.startAt.inclusive):null;return uN(n.path,n.collectionGroup,e,n.filters,n.limit,t,a)}}function cg(n,e){const t=n.filters.concat([e]);return new ml(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Ch(n,e,t){return new ml(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Qh(n,e){return Yg(Qs(n),Qs(e))&&n.limitType===e.limitType}function Zx(n){return`${$g(Qs(n))}|lt:${n.limitType}`}function Fo(n){return`Query(target=${function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map(o=>Qx(o)).join(", ")}]`),du(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map(o=>function(d){return`${d.field.canonicalString()} (${d.dir})`}(o)).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map(o=>sl(o)).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map(o=>sl(o)).join(",")),`Target(${a})`}(Qs(n))}; limitType=${n.limitType})`}function Xh(n,e){return e.isFoundDocument()&&function(a,o){const c=o.key.path;return a.collectionGroup!==null?o.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):be.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)}(n,e)&&function(a,o){for(const c of Vc(a))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0}(n,e)&&function(a,o){for(const c of a.filters)if(!c.matches(o))return!1;return!0}(n,e)&&function(a,o){return!(a.startAt&&!function(d,f,p){const v=lN(d,f,p);return d.inclusive?v<=0:v<0}(a.startAt,Vc(a),o)||a.endAt&&!function(d,f,p){const v=lN(d,f,p);return d.inclusive?v>=0:v>0}(a.endAt,Vc(a),o))}(n,e)}function $1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Jx(n){return(e,t)=>{let a=!1;for(const o of Vc(n)){const c=Y1(o,e,t);if(c!==0)return c;a=a||o.field.isKeyField()}return 0}}function Y1(n,e,t){const a=n.field.isKeyField()?be.comparator(e.key,t.key):function(c,d,f){const p=d.data.field(c),v=f.data.field(c);return p!==null&&v!==null?nl(p,v):xe(42886)}(n.field,e,t);switch(n.dir){case"asc":return a;case"desc":return-1*a;default:return xe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[o,c]of a)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),o=this.inner[a];if(o===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return a.length===1?delete this.inner[t]:a.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Fi(this.inner,(t,a)=>{for(const[o,c]of a)e(o,c)})}isEmpty(){return kx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K1=new bt(be.comparator);function Pa(){return K1}const e0=new bt(be.comparator);function Dc(...n){let e=e0;for(const t of n)e=e.insert(t.key,t);return e}function t0(n){let e=e0;return n.forEach((t,a)=>e=e.insert(t,a.overlayedDocument)),e}function Sr(){return Uc()}function n0(){return Uc()}function Uc(){return new Fr(n=>n.toString(),(n,e)=>n.isEqual(e))}const Q1=new bt(be.comparator),X1=new Gt(be.comparator);function $e(...n){let e=X1;for(const t of n)e=e.add(t);return e}const W1=new Gt(Ve);function Z1(){return W1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nh(e)?"-0":e}}function s0(n){return{integerValue:""+n}}function J1(n,e){return C1(e)?s0(e):Kg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(){this._=void 0}}function eD(n,e,t){return n instanceof eu?function(o,c){const d={fields:{[Ux]:{stringValue:Vx},[Hx]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&zg(c)&&(c=Yh(c)),c&&(d.fields[Fx]=c),{mapValue:d}}(t,e):n instanceof tu?i0(n,e):n instanceof nu?r0(n,e):function(o,c){const d=a0(o,c),f=hN(d)+hN(o.Re);return rg(d)&&rg(o.Re)?s0(f):Kg(o.serializer,f)}(n,e)}function tD(n,e,t){return n instanceof tu?i0(n,e):n instanceof nu?r0(n,e):t}function a0(n,e){return n instanceof jh?function(a){return rg(a)||function(c){return!!c&&"doubleValue"in c}(a)}(e)?e:{integerValue:0}:null}class eu extends Wh{}class tu extends Wh{constructor(e){super(),this.elements=e}}function i0(n,e){const t=o0(e);for(const a of n.elements)t.some(o=>Xs(o,a))||t.push(a);return{arrayValue:{values:t}}}class nu extends Wh{constructor(e){super(),this.elements=e}}function r0(n,e){let t=o0(e);for(const a of n.elements)t=t.filter(o=>!Xs(o,a));return{arrayValue:{values:t}}}class jh extends Wh{constructor(e,t){super(),this.serializer=e,this.Re=t}}function hN(n){return It(n.integerValue||n.doubleValue)}function o0(n){return Gg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e,t){this.field=e,this.transform=t}}function sD(n,e){return n.field.isEqual(e.field)&&function(a,o){return a instanceof tu&&o instanceof tu||a instanceof nu&&o instanceof nu?tl(a.elements,o.elements,Xs):a instanceof jh&&o instanceof jh?Xs(a.Re,o.Re):a instanceof eu&&o instanceof eu}(n.transform,e.transform)}class aD{constructor(e,t){this.version=e,this.transformResults=t}}class dn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new dn}static exists(e){return new dn(void 0,e)}static updateTime(e){return new dn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ch(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Zh{}function l0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Jh(n.key,dn.none()):new hu(n.key,n.data,dn.none());{const t=n.data,a=Sn.empty();let o=new Gt(un.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?a.delete(c):a.set(c,d),o=o.add(c)}return new Hi(n.key,a,new $n(o.toArray()),dn.none())}}function iD(n,e,t){n instanceof hu?function(o,c,d){const f=o.value.clone(),p=mN(o.fieldTransforms,c,d.transformResults);f.setAll(p),c.convertToFoundDocument(d.version,f).setHasCommittedMutations()}(n,e,t):n instanceof Hi?function(o,c,d){if(!ch(o.precondition,c))return void c.convertToUnknownDocument(d.version);const f=mN(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(c0(o)),p.setAll(f),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()}(n,e,t):function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()}(0,e,t)}function Fc(n,e,t,a){return n instanceof hu?function(c,d,f,p){if(!ch(c.precondition,d))return f;const v=c.value.clone(),_=pN(c.fieldTransforms,p,d);return v.setAll(_),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null}(n,e,t,a):n instanceof Hi?function(c,d,f,p){if(!ch(c.precondition,d))return f;const v=pN(c.fieldTransforms,p,d),_=d.data;return _.setAll(c0(c)),_.setAll(v),d.convertToFoundDocument(d.version,_).setHasLocalMutations(),f===null?null:f.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(N=>N.field))}(n,e,t,a):function(c,d,f){return ch(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f}(n,e,t)}function rD(n,e){let t=null;for(const a of n.fieldTransforms){const o=e.data.field(a.field),c=a0(a.transform,o||null);c!=null&&(t===null&&(t=Sn.empty()),t.set(a.field,c))}return t||null}function fN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(a,o){return a===void 0&&o===void 0||!(!a||!o)&&tl(a,o,(c,d)=>sD(c,d))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class hu extends Zh{constructor(e,t,a,o=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Hi extends Zh{constructor(e,t,a,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function c0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const a=n.data.field(t);e.set(t,a)}}),e}function mN(n,e,t){const a=new Map;Ze(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,f=e.data.field(c.field);a.set(c.field,tD(d,f,t[o]))}return a}function pN(n,e,t){const a=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);a.set(o.field,eD(c,d,e))}return a}class Jh extends Zh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class u0 extends Zh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e,t,a,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=o}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&iD(c,e,a[o])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=Fc(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=Fc(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=n0();return this.mutations.forEach(o=>{const c=e.get(o.key),d=c.overlayedDocument;let f=this.applyToLocalView(d,c.mutatedFields);f=t.has(o.key)?null:f;const p=l0(d,f);p!==null&&a.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(je.min())}),a}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),$e())}isEqual(e){return this.batchId===e.batchId&&tl(this.mutations,e.mutations,(t,a)=>fN(t,a))&&tl(this.baseMutations,e.baseMutations,(t,a)=>fN(t,a))}}class Qg{constructor(e,t,a,o){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=o}static from(e,t,a){Ze(e.mutations.length===a.length,58842,{fe:e.mutations.length,ge:a.length});let o=function(){return Q1}();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,a[d].version);return new Qg(e,t,a,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kt,We;function d0(n){switch(n){case re.OK:return xe(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return xe(15467,{code:n})}}function h0(n){if(n===void 0)return Ma("GRPC error has no .code"),re.UNKNOWN;switch(n){case kt.OK:return re.OK;case kt.CANCELLED:return re.CANCELLED;case kt.UNKNOWN:return re.UNKNOWN;case kt.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case kt.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case kt.INTERNAL:return re.INTERNAL;case kt.UNAVAILABLE:return re.UNAVAILABLE;case kt.UNAUTHENTICATED:return re.UNAUTHENTICATED;case kt.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case kt.NOT_FOUND:return re.NOT_FOUND;case kt.ALREADY_EXISTS:return re.ALREADY_EXISTS;case kt.PERMISSION_DENIED:return re.PERMISSION_DENIED;case kt.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case kt.ABORTED:return re.ABORTED;case kt.OUT_OF_RANGE:return re.OUT_OF_RANGE;case kt.UNIMPLEMENTED:return re.UNIMPLEMENTED;case kt.DATA_LOSS:return re.DATA_LOSS;default:return xe(39323,{code:n})}}(We=kt||(kt={}))[We.OK=0]="OK",We[We.CANCELLED=1]="CANCELLED",We[We.UNKNOWN=2]="UNKNOWN",We[We.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",We[We.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",We[We.NOT_FOUND=5]="NOT_FOUND",We[We.ALREADY_EXISTS=6]="ALREADY_EXISTS",We[We.PERMISSION_DENIED=7]="PERMISSION_DENIED",We[We.UNAUTHENTICATED=16]="UNAUTHENTICATED",We[We.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",We[We.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",We[We.ABORTED=10]="ABORTED",We[We.OUT_OF_RANGE=11]="OUT_OF_RANGE",We[We.UNIMPLEMENTED=12]="UNIMPLEMENTED",We[We.INTERNAL=13]="INTERNAL",We[We.UNAVAILABLE=14]="UNAVAILABLE",We[We.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uD=new xi([4294967295,4294967295],0);function gN(n){const e=Ox().encode(n),t=new Ax;return t.update(e),new Uint8Array(t.digest())}function vN(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new xi([t,a],0),new xi([o,c],0)]}class Xg{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new Oc(`Invalid padding: ${t}`);if(a<0)throw new Oc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new Oc(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new Oc(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=xi.fromNumber(this.pe)}we(e,t,a){let o=e.add(t.multiply(xi.fromNumber(a)));return o.compare(uD)===1&&(o=new xi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=gN(e),[a,o]=vN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);if(!this.be(d))return!1}return!0}static create(e,t,a){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new Xg(c,o,t);return a.forEach(f=>d.insert(f)),d}insert(e){if(this.pe===0)return;const t=gN(e),[a,o]=vN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);this.Se(d)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class Oc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,t,a,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const o=new Map;return o.set(e,fu.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new ef(je.min(),o,new bt(Ve),Pa(),$e())}}class fu{constructor(e,t,a,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new fu(a,t,$e(),$e(),$e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh{constructor(e,t,a,o){this.De=e,this.removedTargetIds=t,this.key=a,this.ve=o}}class f0{constructor(e,t){this.targetId=e,this.Ce=t}}class m0{constructor(e,t,a=fn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=o}}class yN{constructor(){this.Fe=0,this.Me=_N(),this.xe=fn.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=$e(),t=$e(),a=$e();return this.Me.forEach((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:a=a.add(o);break;default:xe(38017,{changeType:c})}}),new fu(this.xe,this.Oe,e,t,a)}Qe(){this.Ne=!1,this.Me=_N()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Ze(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class dD{constructor(e){this.ze=e,this.je=new Map,this.He=Pa(),this.Je=Wd(),this.Ye=Wd(),this.Ze=new bt(Ve)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const a=this.rt(t);switch(e.state){case 0:this.it(t)&&a.ke(e.resumeToken);break;case 1:a.We(),a.Be||a.Qe(),a.ke(e.resumeToken);break;case 2:a.We(),a.Be||this.removeTarget(t);break;case 3:this.it(t)&&(a.Ge(),a.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),a.ke(e.resumeToken));break;default:xe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((a,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,a=e.Ce.count,o=this._t(t);if(o){const c=o.target;if(lg(c))if(a===0){const d=new be(c.path);this.tt(t,d,en.newNoDocument(d,je.min()))}else Ze(a===1,20013,{expectedCount:a});else{const d=this.ut(t);if(d!==a){const f=this.ct(e),p=f?this.lt(f,e,d):1;if(p!==0){this.st(t);const v=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,v)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:o=0},hashCount:c=0}=t;let d,f;try{d=wi(a).toUint8Array()}catch(p){if(p instanceof Lx)return el("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new Xg(d,o,c)}catch(p){return el(p instanceof Oc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.pe===0?null:f}lt(e,t,a){return t.Ce.count===a-this.Tt(e,t.targetId)?0:2}Tt(e,t){const a=this.ze.getRemoteKeysForTarget(t);let o=0;return a.forEach(c=>{const d=this.ze.Pt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(f)||(this.tt(t,c,null),o++)}),o}It(e){const t=new Map;this.je.forEach((c,d)=>{const f=this._t(d);if(f){if(c.current&&lg(f.target)){const p=new be(f.target.path);this.Et(p).has(d)||this.dt(d,p)||this.tt(d,p,en.newNoDocument(p,e))}c.Le&&(t.set(d,c.qe()),c.Qe())}});let a=$e();this.Ye.forEach((c,d)=>{let f=!0;d.forEachWhile(p=>{const v=this._t(p);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)}),f&&(a=a.add(c))}),this.He.forEach((c,d)=>d.setReadTime(e));const o=new ef(e,t,this.Ze,this.He,a);return this.He=Pa(),this.Je=Wd(),this.Ye=Wd(),this.Ze=new bt(Ve),o}et(e,t){if(!this.it(e))return;const a=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,a),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,a){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),a&&(this.He=this.He.insert(t,a))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new yN,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Gt(Ve),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Gt(Ve),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||pe("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new yN),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Wd(){return new bt(be.comparator)}function _N(){return new bt(be.comparator)}const hD={asc:"ASCENDING",desc:"DESCENDING"},fD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mD={and:"AND",or:"OR"};class pD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ug(n,e){return n.useProto3Json||du(e)?e:{value:e}}function Sh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function p0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function gD(n,e){return Sh(n,e.toTimestamp())}function Kn(n){return Ze(!!n,49232),je.fromTimestamp(function(t){const a=Si(t);return new zt(a.seconds,a.nanos)}(n))}function Wg(n,e){return dg(n,e).canonicalString()}function dg(n,e){const t=function(o){return new ht(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function g0(n){const e=ht.fromString(n);return Ze(N0(e),10190,{key:e.toString()}),e}function wh(n,e){return Wg(n.databaseId,e.path)}function Hc(n,e){const t=g0(e);if(t.get(1)!==n.databaseId.projectId)throw new me(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new be(y0(t))}function v0(n,e){return Wg(n.databaseId,e)}function vD(n){const e=g0(n);return e.length===4?ht.emptyPath():y0(e)}function hg(n){return new ht(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function y0(n){return Ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function EN(n,e,t){return{name:wh(n,e),fields:t.value.mapValue.fields}}function yD(n,e){return"found"in e?function(a,o){Ze(!!o.found,43571),o.found.name,o.found.updateTime;const c=Hc(a,o.found.name),d=Kn(o.found.updateTime),f=o.found.createTime?Kn(o.found.createTime):je.min(),p=new Sn({mapValue:{fields:o.found.fields}});return en.newFoundDocument(c,d,f,p)}(n,e):"missing"in e?function(a,o){Ze(!!o.missing,3894),Ze(!!o.readTime,22933);const c=Hc(a,o.missing),d=Kn(o.readTime);return en.newNoDocument(c,d)}(n,e):xe(7234,{result:e})}function _D(n,e){let t;if("targetChange"in e){e.targetChange;const a=function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:xe(39313,{state:v})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=function(v,_){return v.useProto3Json?(Ze(_===void 0||typeof _=="string",58123),fn.fromBase64String(_||"")):(Ze(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),fn.fromUint8Array(_||new Uint8Array))}(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&function(v){const _=v.code===void 0?re.UNKNOWN:h0(v.code);return new me(_,v.message||"")}(d);t=new m0(a,o,c,f||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const o=Hc(n,a.document.name),c=Kn(a.document.updateTime),d=a.document.createTime?Kn(a.document.createTime):je.min(),f=new Sn({mapValue:{fields:a.document.fields}}),p=en.newFoundDocument(o,c,d,f),v=a.targetIds||[],_=a.removedTargetIds||[];t=new uh(v,_,p.key,p)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const o=Hc(n,a.document),c=a.readTime?Kn(a.readTime):je.min(),d=en.newNoDocument(o,c),f=a.removedTargetIds||[];t=new uh([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const o=Hc(n,a.document),c=a.removedTargetIds||[];t=new uh([],c,o,null)}else{if(!("filter"in e))return xe(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:o=0,unchangedNames:c}=a,d=new cD(o,c),f=a.targetId;t=new f0(f,d)}}return t}function _0(n,e){let t;if(e instanceof hu)t={update:EN(n,e.key,e.value)};else if(e instanceof Jh)t={delete:wh(n,e.key)};else if(e instanceof Hi)t={update:EN(n,e.key,e.data),updateMask:SD(e.fieldMask)};else{if(!(e instanceof u0))return xe(16599,{ft:e.type});t={verify:wh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(a=>function(c,d){const f=d.transform;if(f instanceof eu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof tu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof nu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof jh)return{fieldPath:d.field.canonicalString(),increment:f.Re};throw xe(20930,{transform:d.transform})}(0,a))),e.precondition.isNone||(t.currentDocument=function(o,c){return c.updateTime!==void 0?{updateTime:gD(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:xe(27497)}(n,e.precondition)),t}function ED(n,e){return n&&n.length>0?(Ze(e!==void 0,14353),n.map(t=>function(o,c){let d=o.updateTime?Kn(o.updateTime):Kn(c);return d.isEqual(je.min())&&(d=Kn(c)),new aD(d,o.transformResults||[])}(t,e))):[]}function bD(n,e){return{documents:[v0(n,e.path)]}}function ND(n,e){const t={structuredQuery:{}},a=e.path;let o;e.collectionGroup!==null?(o=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=v0(n,o);const c=function(v){if(v.length!==0)return b0(Cs.create(v,"and"))}(e.filters);c&&(t.structuredQuery.where=c);const d=function(v){if(v.length!==0)return v.map(_=>function(C){return{field:Ho(C.field),direction:AD(C.dir)}}(_))}(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=ug(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=function(v){return{before:v.inclusive,values:v.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(v){return{before:!v.inclusive,values:v.position}}(e.endAt)),{gt:t,parent:o}}function TD(n){let e=vD(n.parent);const t=n.structuredQuery,a=t.from?t.from.length:0;let o=null;if(a>0){Ze(a===1,65062);const _=t.from[0];_.allDescendants?o=_.collectionId:e=e.child(_.collectionId)}let c=[];t.where&&(c=function(N){const C=E0(N);return C instanceof Cs&&Yx(C)?C.getFilters():[C]}(t.where));let d=[];t.orderBy&&(d=function(N){return N.map(C=>function(b){return new Jc(qo(b.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(C))}(t.orderBy));let f=null;t.limit&&(f=function(N){let C;return C=typeof N=="object"?N.value:N,du(C)?null:C}(t.limit));let p=null;t.startAt&&(p=function(N){const C=!!N.before,j=N.values||[];return new Ah(j,C)}(t.startAt));let v=null;return t.endAt&&(v=function(N){const C=!N.before,j=N.values||[];return new Ah(j,C)}(t.endAt)),z1(e,o,d,c,f,"F",p,v)}function xD(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xe(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function E0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=qo(t.unaryFilter.field);return Lt.create(a,"==",{doubleValue:NaN});case"IS_NULL":const o=qo(t.unaryFilter.field);return Lt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=qo(t.unaryFilter.field);return Lt.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=qo(t.unaryFilter.field);return Lt.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xe(61313);default:return xe(60726)}}(n):n.fieldFilter!==void 0?function(t){return Lt.create(qo(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xe(58110);default:return xe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Cs.create(t.compositeFilter.filters.map(a=>E0(a)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return xe(1026)}}(t.compositeFilter.op))}(n):xe(30097,{filter:n})}function AD(n){return hD[n]}function CD(n){return fD[n]}function jD(n){return mD[n]}function Ho(n){return{fieldPath:n.canonicalString()}}function qo(n){return un.fromServerFormat(n.fieldPath)}function b0(n){return n instanceof Lt?function(t){if(t.op==="=="){if(oN(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NAN"}};if(rN(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(oN(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NOT_NAN"}};if(rN(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ho(t.field),op:CD(t.op),value:t.value}}}(n):n instanceof Cs?function(t){const a=t.getFilters().map(o=>b0(o));return a.length===1?a[0]:{compositeFilter:{op:jD(t.op),filters:a}}}(n):xe(54877,{filter:n})}function SD(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function N0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,t,a,o,c=je.min(),d=je.min(),f=fn.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new bi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e){this.wt=e}}function ID(n){const e=TD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ch(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(){this.Cn=new DD}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(ji.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(ji.min())}updateCollectionGroup(e,t,a){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class DD{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t]||new Gt(ht.comparator),c=!o.has(a);return this.index[t]=o.add(a),c}has(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t];return o&&o.has(a)}getEntries(e){return(this.index[e]||new Gt(ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},T0=41943040;class On{static withCacheSize(e){return new On(e,On.DEFAULT_COLLECTION_PERCENTILE,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */On.DEFAULT_COLLECTION_PERCENTILE=10,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,On.DEFAULT=new On(T0,On.DEFAULT_COLLECTION_PERCENTILE,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),On.DISABLED=new On(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new al(0)}static lr(){return new al(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN="LruGarbageCollector",OD=1048576;function TN([n,e],[t,a]){const o=Ve(n,t);return o===0?Ve(e,a):o}class MD{constructor(e){this.Er=e,this.buffer=new Gt(TN),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();TN(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class PD{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){pe(NN,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){fl(t)?pe(NN,"Ignoring IndexedDB error during garbage collection: ",t):await hl(t)}await this.mr(3e5)})}}class kD{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(a=>Math.floor(t/100*a))}nthSequenceNumber(e,t){if(t===0)return le.resolve($h.le);const a=new MD(t);return this.gr.forEachTarget(e,o=>a.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>a.Rr(o))).next(()=>a.maxValue)}removeTargets(e,t,a){return this.gr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(bN)):this.getCacheSize(e).next(a=>a<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bN):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let a,o,c,d,f,p,v;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(N=>(N>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${N}`),o=this.params.maximumSequenceNumbersToCollect):o=N,d=Date.now(),this.nthSequenceNumber(e,o))).next(N=>(a=N,f=Date.now(),this.removeTargets(e,a,t))).next(N=>(c=N,p=Date.now(),this.removeOrphanedDocuments(e,a))).next(N=>(v=Date.now(),Uo()<=Be.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-_}ms
	Determined least recently used ${o} in `+(f-d)+`ms
	Removed ${c} targets in `+(p-f)+`ms
	Removed ${N} documents in `+(v-p)+`ms
Total Duration: ${v-_}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:N})))}}function LD(n,e){return new kD(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(){this.changes=new Fr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,en.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?le.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(e,t,a,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=o}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(a=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(a!==null&&Fc(a.mutation,o,$n.empty(),zt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.getLocalViewOfDocuments(e,a,$e()).next(()=>a))}getLocalViewOfDocuments(e,t,a=$e()){const o=Sr();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,a).next(c=>{let d=Dc();return c.forEach((f,p)=>{d=d.insert(f,p.overlayedDocument)}),d}))}getOverlayedDocuments(e,t){const a=Sr();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,$e()))}populateOverlays(e,t,a){const o=[];return a.forEach(c=>{t.has(c)||o.push(c)}),this.documentOverlayCache.getOverlays(e,o).next(c=>{c.forEach((d,f)=>{t.set(d,f)})})}computeViews(e,t,a,o){let c=Pa();const d=Uc(),f=function(){return Uc()}();return t.forEach((p,v)=>{const _=a.get(v.key);o.has(v.key)&&(_===void 0||_.mutation instanceof Hi)?c=c.insert(v.key,v):_!==void 0?(d.set(v.key,_.mutation.getFieldMask()),Fc(_.mutation,v,_.mutation.getFieldMask(),zt.now())):d.set(v.key,$n.empty())}),this.recalculateAndSaveOverlays(e,c).next(p=>(p.forEach((v,_)=>d.set(v,_)),t.forEach((v,_)=>{var N;return f.set(v,new UD(_,(N=d.get(v))!==null&&N!==void 0?N:null))}),f))}recalculateAndSaveOverlays(e,t){const a=Uc();let o=new bt((d,f)=>d-f),c=$e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(d=>{for(const f of d)f.keys().forEach(p=>{const v=t.get(p);if(v===null)return;let _=a.get(p)||$n.empty();_=f.applyToLocalView(v,_),a.set(p,_);const N=(o.get(f.batchId)||$e()).add(p);o=o.insert(f.batchId,N)})}).next(()=>{const d=[],f=o.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),v=p.key,_=p.value,N=n0();_.forEach(C=>{if(!c.has(C)){const j=l0(t.get(C),a.get(C));j!==null&&N.set(C,j),c=c.add(C)}}),d.push(this.documentOverlayCache.saveOverlays(e,v,N))}return le.waitFor(d)}).next(()=>a)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.recalculateAndSaveOverlays(e,a))}getDocumentsMatchingQuery(e,t,a,o){return function(d){return be.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Wx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,o):this.getDocumentsMatchingCollectionQuery(e,t,a,o)}getNextDocuments(e,t,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,o).next(c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,o-c.size):le.resolve(Sr());let f=Qc,p=c;return d.next(v=>le.forEach(v,(_,N)=>(f<N.largestBatchId&&(f=N.largestBatchId),c.get(_)?le.resolve():this.remoteDocumentCache.getEntry(e,_).next(C=>{p=p.insert(_,C)}))).next(()=>this.populateOverlays(e,v,c)).next(()=>this.computeViews(e,p,v,$e())).next(_=>({batchId:f,changes:t0(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new be(t)).next(a=>{let o=Dc();return a.isFoundDocument()&&(o=o.insert(a.key,a)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,a,o){const c=t.collectionGroup;let d=Dc();return this.indexManager.getCollectionParents(e,c).next(f=>le.forEach(f,p=>{const v=function(N,C){return new ml(C,null,N.explicitOrderBy.slice(),N.filters.slice(),N.limit,N.limitType,N.startAt,N.endAt)}(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,v,a,o).next(_=>{_.forEach((N,C)=>{d=d.insert(N,C)})})}).next(()=>d))}getDocumentsMatchingCollectionQuery(e,t,a,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next(d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,c,o))).next(d=>{c.forEach((p,v)=>{const _=v.getKey();d.get(_)===null&&(d=d.insert(_,en.newInvalidDocument(_)))});let f=Dc();return d.forEach((p,v)=>{const _=c.get(p);_!==void 0&&Fc(_.mutation,v,$n.empty(),zt.now()),Xh(t,v)&&(f=f.insert(p,v))}),f})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return le.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:Kn(o.createTime)}}(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:ID(o.bundledQuery),readTime:Kn(o.readTime)}}(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qD{constructor(){this.overlays=new bt(be.comparator),this.Qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const a=Sr();return le.forEach(t,o=>this.getOverlay(e,o).next(c=>{c!==null&&a.set(o,c)})).next(()=>a)}saveOverlays(e,t,a){return a.forEach((o,c)=>{this.St(e,t,c)}),le.resolve()}removeOverlaysForBatchId(e,t,a){const o=this.Qr.get(a);return o!==void 0&&(o.forEach(c=>this.overlays=this.overlays.remove(c)),this.Qr.delete(a)),le.resolve()}getOverlaysForCollection(e,t,a){const o=Sr(),c=t.length+1,d=new be(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const p=f.getNext().value,v=p.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===c&&p.largestBatchId>a&&o.set(p.getKey(),p)}return le.resolve(o)}getOverlaysForCollectionGroup(e,t,a,o){let c=new bt((v,_)=>v-_);const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>a){let _=c.get(v.largestBatchId);_===null&&(_=Sr(),c=c.insert(v.largestBatchId,_)),_.set(v.getKey(),v)}}const f=Sr(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((v,_)=>f.set(v,_)),!(f.size()>=o)););return le.resolve(f)}St(e,t,a){const o=this.overlays.get(a.key);if(o!==null){const d=this.Qr.get(o.largestBatchId).delete(a.key);this.Qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(a.key,new lD(t,a));let c=this.Qr.get(t);c===void 0&&(c=$e(),this.Qr.set(t,c)),this.Qr.set(t,c.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(){this.sessionToken=fn.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(){this.$r=new Gt(Jt.Ur),this.Kr=new Gt(Jt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const a=new Jt(e,t);this.$r=this.$r.add(a),this.Kr=this.Kr.add(a)}Gr(e,t){e.forEach(a=>this.addReference(a,t))}removeReference(e,t){this.zr(new Jt(e,t))}jr(e,t){e.forEach(a=>this.removeReference(a,t))}Hr(e){const t=new be(new ht([])),a=new Jt(t,e),o=new Jt(t,e+1),c=[];return this.Kr.forEachInRange([a,o],d=>{this.zr(d),c.push(d.key)}),c}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new be(new ht([])),a=new Jt(t,e),o=new Jt(t,e+1);let c=$e();return this.Kr.forEachInRange([a,o],d=>{c=c.add(d.key)}),c}containsKey(e){const t=new Jt(e,0),a=this.$r.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class Jt{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return be.comparator(e.key,t.key)||Ve(e.Zr,t.Zr)}static Wr(e,t){return Ve(e.Zr,t.Zr)||be.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Gt(Jt.Ur)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,o){const c=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new oD(c,t,a,o);this.mutationQueue.push(d);for(const f of o)this.Xr=this.Xr.add(new Jt(f.key,c)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return le.resolve(d)}lookupMutationBatch(e,t){return le.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,o=this.ti(a),c=o<0?0:o;return le.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?Bg:this.nr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new Jt(t,0),o=new Jt(t,Number.POSITIVE_INFINITY),c=[];return this.Xr.forEachInRange([a,o],d=>{const f=this.ei(d.Zr);c.push(f)}),le.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new Gt(Ve);return t.forEach(o=>{const c=new Jt(o,0),d=new Jt(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([c,d],f=>{a=a.add(f.Zr)})}),le.resolve(this.ni(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,o=a.length+1;let c=a;be.isDocumentKey(c)||(c=c.child(""));const d=new Jt(new be(c),0);let f=new Gt(Ve);return this.Xr.forEachWhile(p=>{const v=p.key.path;return!!a.isPrefixOf(v)&&(v.length===o&&(f=f.add(p.Zr)),!0)},d),le.resolve(this.ni(f))}ni(e){const t=[];return e.forEach(a=>{const o=this.ei(a);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Ze(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Xr;return le.forEach(t.mutations,o=>{const c=new Jt(o.key,t.batchId);return a=a.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=a})}sr(e){}containsKey(e,t){const a=new Jt(t,0),o=this.Xr.firstAfterOrEqual(a);return le.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e){this.ii=e,this.docs=function(){return new bt(be.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,o=this.docs.get(a),c=o?o.size:0,d=this.ii(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return le.resolve(a?a.document.mutableCopy():en.newInvalidDocument(t))}getEntries(e,t){let a=Pa();return t.forEach(o=>{const c=this.docs.get(o);a=a.insert(o,c?c.document.mutableCopy():en.newInvalidDocument(o))}),le.resolve(a)}getDocumentsMatchingQuery(e,t,a,o){let c=Pa();const d=t.path,f=new be(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:v,value:{document:_}}=p.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||N1(b1(_),a)<=0||(o.has(_.key)||Xh(t,_))&&(c=c.insert(_.key,_.mutableCopy()))}return le.resolve(c)}getAllFromCollectionGroup(e,t,a,o){xe(9500)}si(e,t){return le.forEach(this.docs,a=>t(a))}newChangeBuffer(e){return new $D(this)}getSize(e){return le.resolve(this.size)}}class $D extends VD{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((a,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(a)}),le.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(e){this.persistence=e,this.oi=new Fr(t=>$g(t),Yg),this.lastRemoteSnapshotVersion=je.min(),this.highestTargetId=0,this._i=0,this.ai=new Zg,this.targetCount=0,this.ui=al.cr()}forEachTarget(e,t){return this.oi.forEach((a,o)=>t(o)),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this._i&&(this._i=t),le.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new al(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Tr(t),le.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,a){let o=0;const c=[];return this.oi.forEach((d,f)=>{f.sequenceNumber<=t&&a.get(f.targetId)===null&&(this.oi.delete(d),c.push(this.removeMatchingKeysForTargetId(e,f.targetId)),o++)}),le.waitFor(c).next(()=>o)}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const a=this.oi.get(t)||null;return le.resolve(a)}addMatchingKeys(e,t,a){return this.ai.Gr(t,a),le.resolve()}removeMatchingKeys(e,t,a){this.ai.jr(t,a);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach(d=>{c.push(o.markPotentiallyOrphaned(e,d))}),le.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const a=this.ai.Yr(t);return le.resolve(a)}containsKey(e,t){return le.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e,t){this.ci={},this.overlays={},this.li=new $h(0),this.hi=!1,this.hi=!0,this.Pi=new BD,this.referenceDelegate=e(this),this.Ti=new YD(this),this.indexManager=new RD,this.remoteDocumentCache=function(o){return new GD(o)}(a=>this.referenceDelegate.Ii(a)),this.serializer=new wD(t),this.Ei=new HD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new qD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ci[e.toKey()];return a||(a=new zD(t,this.referenceDelegate),this.ci[e.toKey()]=a),a}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,a){pe("MemoryPersistence","Starting transaction:",e);const o=new KD(this.li.next());return this.referenceDelegate.di(),a(o).next(c=>this.referenceDelegate.Ai(o).next(()=>c)).toPromise().then(c=>(o.raiseOnCommittedEvent(),c))}Ri(e,t){return le.or(Object.values(this.ci).map(a=>()=>a.containsKey(e,t)))}}class KD extends x1{constructor(e){super(),this.currentSequenceNumber=e}}class Jg{constructor(e){this.persistence=e,this.Vi=new Zg,this.mi=null}static fi(e){return new Jg(e)}get gi(){if(this.mi)return this.mi;throw xe(60996)}addReference(e,t,a){return this.Vi.addReference(a,t),this.gi.delete(a.toString()),le.resolve()}removeReference(e,t,a){return this.Vi.removeReference(a,t),this.gi.add(a.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(c=>this.gi.add(c.toString()))}).next(()=>a.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.gi,a=>{const o=be.fromPath(a);return this.pi(e,o).next(c=>{c||t.removeEntry(o,je.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(a=>{a?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return le.or([()=>le.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Ih{constructor(e,t){this.persistence=e,this.yi=new Fr(a=>j1(a.path),(a,o)=>a.isEqual(o)),this.garbageCollector=LD(this,t)}static fi(e,t){return new Ih(e,t)}di(){}Ai(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(a=>t.next(o=>a+o))}br(e){let t=0;return this.yr(e,a=>{t++}).next(()=>t)}yr(e,t){return le.forEach(this.yi,(a,o)=>this.Dr(e,a,o).next(c=>c?le.resolve():t(o)))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.si(e,d=>this.Dr(e,d,t).next(f=>{f||(a++,c.removeEntry(d,je.min()))})).next(()=>c.apply(e)).next(()=>a)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}removeReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=oh(e.data.value)),t}Dr(e,t,a){return le.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return le.resolve(o!==void 0&&o>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(e,t,a,o){this.targetId=e,this.fromCache=t,this.ds=a,this.As=o}static Rs(e,t){let a=$e(),o=$e();for(const c of t.docChanges)switch(c.type){case 0:a=a.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new ev(e,t.fromCache,a,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return SS()?8:A1(bn())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,a,o){const c={result:null};return this.ws(e,t).next(d=>{c.result=d}).next(()=>{if(!c.result)return this.bs(e,t,o,a).next(d=>{c.result=d})}).next(()=>{if(c.result)return;const d=new QD;return this.Ss(e,t,d).next(f=>{if(c.result=f,this.fs)return this.Ds(e,t,d,f.size)})}).next(()=>c.result)}Ds(e,t,a,o){return a.documentReadCount<this.gs?(Uo()<=Be.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",Fo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),le.resolve()):(Uo()<=Be.DEBUG&&pe("QueryEngine","Query:",Fo(t),"scans",a.documentReadCount,"local documents and returns",o,"documents as results."),a.documentReadCount>this.ps*o?(Uo()<=Be.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",Fo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qs(t))):le.resolve())}ws(e,t){if(dN(t))return le.resolve(null);let a=Qs(t);return this.indexManager.getIndexType(e,a).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Ch(t,null,"F"),a=Qs(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next(c=>{const d=$e(...c);return this.ys.getDocuments(e,d).next(f=>this.indexManager.getMinOffset(e,a).next(p=>{const v=this.vs(t,f);return this.Cs(t,v,d,p.readTime)?this.ws(e,Ch(t,null,"F")):this.Fs(e,v,t,p)}))})))}bs(e,t,a,o){return dN(t)||o.isEqual(je.min())?le.resolve(null):this.ys.getDocuments(e,a).next(c=>{const d=this.vs(t,c);return this.Cs(t,d,a,o)?le.resolve(null):(Uo()<=Be.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Fo(t)),this.Fs(e,d,t,E1(o,Qc)).next(f=>f))})}vs(e,t){let a=new Gt(Jx(e));return t.forEach((o,c)=>{Xh(e,c)&&(a=a.add(c))}),a}Cs(e,t,a,o){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,a){return Uo()<=Be.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",Fo(t)),this.ys.getDocumentsMatchingQuery(e,t,ji.min(),a)}Fs(e,t,a,o){return this.ys.getDocumentsMatchingQuery(e,a,o).next(c=>(t.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tv="LocalStore",WD=3e8;class ZD{constructor(e,t,a,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new bt(Ve),this.Os=new Fr(c=>$g(c),Yg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(a)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new FD(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function JD(n,e,t,a){return new ZD(n,e,t,a)}async function A0(n,e){const t=De(n);return await t.persistence.runTransaction("Handle user change","readonly",a=>{let o;return t.mutationQueue.getAllMutationBatches(a).next(c=>(o=c,t.Ls(e),t.mutationQueue.getAllMutationBatches(a))).next(c=>{const d=[],f=[];let p=$e();for(const v of o){d.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}for(const v of c){f.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}return t.localDocuments.getDocuments(a,p).next(v=>({ks:v,removedBatchIds:d,addedBatchIds:f}))})})}function eO(n,e){const t=De(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const o=e.batch.keys(),c=t.Bs.newChangeBuffer({trackRemovals:!0});return function(f,p,v,_){const N=v.batch,C=N.keys();let j=le.resolve();return C.forEach(b=>{j=j.next(()=>_.getEntry(p,b)).next(M=>{const x=v.docVersions.get(b);Ze(x!==null,48541),M.version.compareTo(x)<0&&(N.applyToRemoteDocument(M,v),M.isValidDocument()&&(M.setReadTime(v.commitVersion),_.addEntry(M)))})}),j.next(()=>f.mutationQueue.removeMutationBatch(p,N))}(t,a,e,c).next(()=>c.apply(a)).next(()=>t.mutationQueue.performConsistencyCheck(a)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(a,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,function(f){let p=$e();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(p=p.add(f.batch.mutations[v].key));return p}(e))).next(()=>t.localDocuments.getDocuments(a,o))})}function C0(n){const e=De(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function tO(n,e){const t=De(n),a=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const f=[];e.targetChanges.forEach((_,N)=>{const C=o.get(N);if(!C)return;f.push(t.Ti.removeMatchingKeys(c,_.removedDocuments,N).next(()=>t.Ti.addMatchingKeys(c,_.addedDocuments,N)));let j=C.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(N)!==null?j=j.withResumeToken(fn.EMPTY_BYTE_STRING,je.min()).withLastLimboFreeSnapshotVersion(je.min()):_.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(_.resumeToken,a)),o=o.insert(N,j),function(M,x,V){return M.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=WD?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(C,j,_)&&f.push(t.Ti.updateTargetData(c,j))});let p=Pa(),v=$e();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(c,_))}),f.push(nO(c,d,e.documentUpdates).next(_=>{p=_.qs,v=_.Qs})),!a.isEqual(je.min())){const _=t.Ti.getLastRemoteSnapshotVersion(c).next(N=>t.Ti.setTargetsMetadata(c,c.currentSequenceNumber,a));f.push(_)}return le.waitFor(f).next(()=>d.apply(c)).next(()=>t.localDocuments.getLocalViewOfDocuments(c,p,v)).next(()=>p)}).then(c=>(t.xs=o,c))}function nO(n,e,t){let a=$e(),o=$e();return t.forEach(c=>a=a.add(c)),e.getEntries(n,a).next(c=>{let d=Pa();return t.forEach((f,p)=>{const v=c.get(f);p.isFoundDocument()!==v.isFoundDocument()&&(o=o.add(f)),p.isNoDocument()&&p.version.isEqual(je.min())?(e.removeEntry(f,p.readTime),d=d.insert(f,p)):!v.isValidDocument()||p.version.compareTo(v.version)>0||p.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(p),d=d.insert(f,p)):pe(tv,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",p.version)}),{qs:d,Qs:o}})}function sO(n,e){const t=De(n);return t.persistence.runTransaction("Get next mutation batch","readonly",a=>(e===void 0&&(e=Bg),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e)))}function aO(n,e){const t=De(n);return t.persistence.runTransaction("Allocate target","readwrite",a=>{let o;return t.Ti.getTargetData(a,e).next(c=>c?(o=c,le.resolve(o)):t.Ti.allocateTargetId(a).next(d=>(o=new bi(e,d,"TargetPurposeListen",a.currentSequenceNumber),t.Ti.addTargetData(a,o).next(()=>o))))}).then(a=>{const o=t.xs.get(a.targetId);return(o===null||a.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(a.targetId,a),t.Os.set(e,a.targetId)),a})}async function fg(n,e,t){const a=De(n),o=a.xs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",c,d=>a.persistence.referenceDelegate.removeTarget(d,o))}catch(d){if(!fl(d))throw d;pe(tv,`Failed to update sequence numbers for target ${e}: ${d}`)}a.xs=a.xs.remove(e),a.Os.delete(o.target)}function xN(n,e,t){const a=De(n);let o=je.min(),c=$e();return a.persistence.runTransaction("Execute query","readwrite",d=>function(p,v,_){const N=De(p),C=N.Os.get(_);return C!==void 0?le.resolve(N.xs.get(C)):N.Ti.getTargetData(v,_)}(a,d,Qs(e)).next(f=>{if(f)return o=f.lastLimboFreeSnapshotVersion,a.Ti.getMatchingKeysForTargetId(d,f.targetId).next(p=>{c=p})}).next(()=>a.Ms.getDocumentsMatchingQuery(d,e,t?o:je.min(),t?c:$e())).next(f=>(iO(a,$1(e),f),{documents:f,$s:c})))}function iO(n,e,t){let a=n.Ns.get(e)||je.min();t.forEach((o,c)=>{c.readTime.compareTo(a)>0&&(a=c.readTime)}),n.Ns.set(e,a)}class AN{constructor(){this.activeTargetIds=Z1()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rO{constructor(){this.xo=new AN,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,a){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new AN,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN="ConnectivityMonitor";class jN{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){pe(CN,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){pe(CN,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zd=null;function mg(){return Zd===null?Zd=function(){return 268435456+Math.round(2147483648*Math.random())}():Zd++,"0x"+Zd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Op="RestConnection",lO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cO{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${a}/databases/${o}`,this.Go=this.databaseId.database===Th?`project_id=${a}`:`project_id=${a}&database_id=${o}`}zo(e,t,a,o,c){const d=mg(),f=this.jo(e,t.toUriEncodedString());pe(Op,`Sending RPC '${e}' ${d}:`,f,a);const p={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(p,o,c);const{host:v}=new URL(f),_=Vr(v);return this.Jo(e,f,p,a,_).then(N=>(pe(Op,`Received RPC '${e}' ${d}: `,N),N),N=>{throw el(Op,`RPC '${e}' ${d} failed with error: `,N,"url: ",f,"request:",a),N})}Yo(e,t,a,o,c,d){return this.zo(e,t,a,o,c)}Ho(e,t,a){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+dl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,c)=>e[c]=o),a&&a.headers.forEach((o,c)=>e[c]=o)}jo(e,t){const a=lO[e];return`${this.Ko}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vn="WebChannelConnection";class dO extends cO{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,o,c){const d=mg();return new Promise((f,p)=>{const v=new Cx;v.setWithCredentials(!0),v.listenOnce(jx.COMPLETE,()=>{try{switch(v.getLastErrorCode()){case rh.NO_ERROR:const N=v.getResponseJson();pe(vn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(N)),f(N);break;case rh.TIMEOUT:pe(vn,`RPC '${e}' ${d} timed out`),p(new me(re.DEADLINE_EXCEEDED,"Request time out"));break;case rh.HTTP_ERROR:const C=v.getStatus();if(pe(vn,`RPC '${e}' ${d} failed with status:`,C,"response text:",v.getResponseText()),C>0){let j=v.getResponseJson();Array.isArray(j)&&(j=j[0]);const b=j?.error;if(b&&b.status&&b.message){const M=function(V){const $=V.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf($)>=0?$:re.UNKNOWN}(b.status);p(new me(M,b.message))}else p(new me(re.UNKNOWN,"Server responded with status "+v.getStatus()))}else p(new me(re.UNAVAILABLE,"Connection failed."));break;default:xe(9055,{h_:e,streamId:d,P_:v.getLastErrorCode(),T_:v.getLastError()})}}finally{pe(vn,`RPC '${e}' ${d} completed.`)}});const _=JSON.stringify(o);pe(vn,`RPC '${e}' ${d} sending request:`,o),v.send(t,"POST",_,a,15)})}I_(e,t,a){const o=mg(),c=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=Ix(),f=wx(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(p.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Ho(p.initMessageHeaders,t,a),p.encodeInitMessageHeaders=!0;const _=c.join("");pe(vn,`Creating RPC '${e}' stream ${o}: ${_}`,p);const N=d.createWebChannel(_,p);this.E_(N);let C=!1,j=!1;const b=new uO({Zo:x=>{j?pe(vn,`Not sending because RPC '${e}' stream ${o} is closed:`,x):(C||(pe(vn,`Opening RPC '${e}' stream ${o} transport.`),N.open(),C=!0),pe(vn,`RPC '${e}' stream ${o} sending:`,x),N.send(x))},Xo:()=>N.close()}),M=(x,V,$)=>{x.listen(V,O=>{try{$(O)}catch(U){setTimeout(()=>{throw U},0)}})};return M(N,Rc.EventType.OPEN,()=>{j||(pe(vn,`RPC '${e}' stream ${o} transport opened.`),b.__())}),M(N,Rc.EventType.CLOSE,()=>{j||(j=!0,pe(vn,`RPC '${e}' stream ${o} transport closed`),b.u_(),this.d_(N))}),M(N,Rc.EventType.ERROR,x=>{j||(j=!0,el(vn,`RPC '${e}' stream ${o} transport errored. Name:`,x.name,"Message:",x.message),b.u_(new me(re.UNAVAILABLE,"The operation could not be completed")))}),M(N,Rc.EventType.MESSAGE,x=>{var V;if(!j){const $=x.data[0];Ze(!!$,16349);const O=$,U=O?.error||((V=O[0])===null||V===void 0?void 0:V.error);if(U){pe(vn,`RPC '${e}' stream ${o} received error:`,U);const q=U.status;let K=function(R){const I=kt[R];if(I!==void 0)return h0(I)}(q),w=U.message;K===void 0&&(K=re.INTERNAL,w="Unknown error status: "+q+" with message "+U.message),j=!0,b.u_(new me(K,w)),N.close()}else pe(vn,`RPC '${e}' stream ${o} received:`,$),b.c_($)}}),M(f,Sx.STAT_EVENT,x=>{x.stat===sg.PROXY?pe(vn,`RPC '${e}' stream ${o} detected buffering proxy`):x.stat===sg.NOPROXY&&pe(vn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{b.a_()},0),b}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function Mp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(n){return new pD(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,t,a=1e3,o=1.5,c=6e4){this.xi=e,this.timerId=t,this.A_=a,this.R_=o,this.V_=c,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),a=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-a);o>0&&pe("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN="PersistentStream";class j0{constructor(e,t,a,o,c,d,f,p){this.xi=e,this.S_=a,this.D_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new nv(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(Ma(t.toString()),Ma("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,o])=>{this.v_===t&&this.z_(a,o)},a=>{e(()=>{const o=new me(re.UNKNOWN,"Fetching auth token failed: "+a.message);return this.j_(o)})})}z_(e,t){const a=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{a(()=>this.listener.e_())}),this.stream.n_(()=>{a(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{a(()=>this.j_(o))}),this.stream.onMessage(o=>{a(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return pe(SN,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(pe(SN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class hO extends j0{constructor(e,t,a,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=_D(this.serializer,e),a=function(c){if(!("targetChange"in c))return je.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?je.min():d.readTime?Kn(d.readTime):je.min()}(e);return this.listener.Y_(t,a)}Z_(e){const t={};t.database=hg(this.serializer),t.addTarget=function(c,d){let f;const p=d.target;if(f=lg(p)?{documents:bD(c,p)}:{query:ND(c,p).gt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=p0(c,d.resumeToken);const v=ug(c,d.expectedCount);v!==null&&(f.expectedCount=v)}else if(d.snapshotVersion.compareTo(je.min())>0){f.readTime=Sh(c,d.snapshotVersion.toTimestamp());const v=ug(c,d.expectedCount);v!==null&&(f.expectedCount=v)}return f}(this.serializer,e);const a=xD(this.serializer,e);a&&(t.labels=a),this.Q_(t)}X_(e){const t={};t.database=hg(this.serializer),t.removeTarget=e,this.Q_(t)}}class fO extends j0{constructor(e,t,a,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=ED(e.writeResults,e.commitTime),a=Kn(e.commitTime);return this.listener.ra(a,t)}ia(){const e={};e.database=hg(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(a=>_0(this.serializer,a))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{}class pO extends mO{constructor(e,t,a,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new me(re.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,a,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.zo(e,dg(t,a),o,c,d)).catch(c=>{throw c.name==="FirebaseError"?(c.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new me(re.UNKNOWN,c.toString())})}Yo(e,t,a,o,c){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,f])=>this.connection.Yo(e,dg(t,a),o,d,f,c)).catch(d=>{throw d.name==="FirebaseError"?(d.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new me(re.UNKNOWN,d.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class gO{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Ma(t),this.ua=!1):pe("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="RemoteStore";class vO{constructor(e,t,a,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=c,this.Ra.No(d=>{a.enqueueAndForget(async()=>{Hr(this)&&(pe(Mr,"Restarting streams for network reachability change."),await async function(p){const v=De(p);v.da.add(4),await mu(v),v.Va.set("Unknown"),v.da.delete(4),await nf(v)}(this))})}),this.Va=new gO(a,o)}}async function nf(n){if(Hr(n))for(const e of n.Aa)await e(!0)}async function mu(n){for(const e of n.Aa)await e(!1)}function S0(n,e){const t=De(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),rv(t)?iv(t):pl(t).N_()&&av(t,e))}function sv(n,e){const t=De(n),a=pl(t);t.Ea.delete(e),a.N_()&&w0(t,e),t.Ea.size===0&&(a.N_()?a.k_():Hr(t)&&t.Va.set("Unknown"))}function av(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(je.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}pl(n).Z_(e)}function w0(n,e){n.ma.Ke(e),pl(n).X_(e)}function iv(n){n.ma=new dD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),pl(n).start(),n.Va.ca()}function rv(n){return Hr(n)&&!pl(n).O_()&&n.Ea.size>0}function Hr(n){return De(n).da.size===0}function I0(n){n.ma=void 0}async function yO(n){n.Va.set("Online")}async function _O(n){n.Ea.forEach((e,t)=>{av(n,e)})}async function EO(n,e){I0(n),rv(n)?(n.Va.Pa(e),iv(n)):n.Va.set("Unknown")}async function bO(n,e,t){if(n.Va.set("Online"),e instanceof m0&&e.state===2&&e.cause)try{await async function(o,c){const d=c.cause;for(const f of c.targetIds)o.Ea.has(f)&&(await o.remoteSyncer.rejectListen(f,d),o.Ea.delete(f),o.ma.removeTarget(f))}(n,e)}catch(a){pe(Mr,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await Rh(n,a)}else if(e instanceof uh?n.ma.Xe(e):e instanceof f0?n.ma.ot(e):n.ma.nt(e),!t.isEqual(je.min()))try{const a=await C0(n.localStore);t.compareTo(a)>=0&&await function(c,d){const f=c.ma.It(d);return f.targetChanges.forEach((p,v)=>{if(p.resumeToken.approximateByteSize()>0){const _=c.Ea.get(v);_&&c.Ea.set(v,_.withResumeToken(p.resumeToken,d))}}),f.targetMismatches.forEach((p,v)=>{const _=c.Ea.get(p);if(!_)return;c.Ea.set(p,_.withResumeToken(fn.EMPTY_BYTE_STRING,_.snapshotVersion)),w0(c,p);const N=new bi(_.target,p,v,_.sequenceNumber);av(c,N)}),c.remoteSyncer.applyRemoteEvent(f)}(n,t)}catch(a){pe(Mr,"Failed to raise snapshot:",a),await Rh(n,a)}}async function Rh(n,e,t){if(!fl(e))throw e;n.da.add(1),await mu(n),n.Va.set("Offline"),t||(t=()=>C0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{pe(Mr,"Retrying IndexedDB access"),await t(),n.da.delete(1),await nf(n)})}function R0(n,e){return e().catch(t=>Rh(n,t,e))}async function sf(n){const e=De(n),t=Ri(e);let a=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Bg;for(;NO(e);)try{const o=await sO(e.localStore,a);if(o===null){e.Ia.length===0&&t.k_();break}a=o.batchId,TO(e,o)}catch(o){await Rh(e,o)}D0(e)&&O0(e)}function NO(n){return Hr(n)&&n.Ia.length<10}function TO(n,e){n.Ia.push(e);const t=Ri(n);t.N_()&&t.ea&&t.ta(e.mutations)}function D0(n){return Hr(n)&&!Ri(n).O_()&&n.Ia.length>0}function O0(n){Ri(n).start()}async function xO(n){Ri(n).ia()}async function AO(n){const e=Ri(n);for(const t of n.Ia)e.ta(t.mutations)}async function CO(n,e,t){const a=n.Ia.shift(),o=Qg.from(a,e,t);await R0(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await sf(n)}async function jO(n,e){e&&Ri(n).ea&&await async function(a,o){if(function(d){return d0(d)&&d!==re.ABORTED}(o.code)){const c=a.Ia.shift();Ri(a).L_(),await R0(a,()=>a.remoteSyncer.rejectFailedWrite(c.batchId,o)),await sf(a)}}(n,e),D0(n)&&O0(n)}async function wN(n,e){const t=De(n);t.asyncQueue.verifyOperationInProgress(),pe(Mr,"RemoteStore received new credentials");const a=Hr(t);t.da.add(3),await mu(t),a&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await nf(t)}async function SO(n,e){const t=De(n);e?(t.da.delete(2),await nf(t)):e||(t.da.add(2),await mu(t),t.Va.set("Unknown"))}function pl(n){return n.fa||(n.fa=function(t,a,o){const c=De(t);return c.oa(),new hO(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:yO.bind(null,n),n_:_O.bind(null,n),i_:EO.bind(null,n),Y_:bO.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),rv(n)?iv(n):n.Va.set("Unknown")):(await n.fa.stop(),I0(n))})),n.fa}function Ri(n){return n.ga||(n.ga=function(t,a,o){const c=De(t);return c.oa(),new fO(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:xO.bind(null,n),i_:jO.bind(null,n),na:AO.bind(null,n),ra:CO.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await sf(n)):(await n.ga.stop(),n.Ia.length>0&&(pe(Mr,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,t,a,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=o,this.removalCallback=c,this.deferred=new Ks,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,o,c){const d=Date.now()+a,f=new ov(e,t,d,o,c);return f.start(a),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function lv(n,e){if(Ma("AsyncQueue",`${e}: ${n}`),fl(n))return new me(re.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{static emptySet(e){return new Xo(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||be.comparator(t.key,a.key):(t,a)=>be.comparator(t.key,a.key),this.keyedMap=Dc(),this.sortedSet=new bt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,a)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Xo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new Xo;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(){this.pa=new bt(be.comparator)}track(e){const t=e.doc.key,a=this.pa.get(t);a?e.type!==0&&a.type===3?this.pa=this.pa.insert(t,e):e.type===3&&a.type!==1?this.pa=this.pa.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.pa=this.pa.remove(t):e.type===1&&a.type===2?this.pa=this.pa.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):xe(63341,{Vt:e,ya:a}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,a)=>{e.push(a)}),e}}class il{constructor(e,t,a,o,c,d,f,p,v){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=v}static fromInitialDocuments(e,t,a,o,c){const d=[];return t.forEach(f=>{d.push({type:0,doc:f})}),new il(e,t,Xo.emptySet(t),d,a,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==a[o].type||!t[o].doc.isEqual(a[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class IO{constructor(){this.queries=RN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const o=De(t),c=o.queries;o.queries=RN(),c.forEach((d,f)=>{for(const p of f.Sa)p.onError(a)})})(this,new me(re.ABORTED,"Firestore shutting down"))}}function RN(){return new Fr(n=>Zx(n),Qh)}async function cv(n,e){const t=De(n);let a=3;const o=e.query;let c=t.queries.get(o);c?!c.Da()&&e.va()&&(a=2):(c=new wO,a=e.va()?0:1);try{switch(a){case 0:c.ba=await t.onListen(o,!0);break;case 1:c.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const f=lv(d,`Initialization of query '${Fo(e.query)}' failed`);return void e.onError(f)}t.queries.set(o,c),c.Sa.push(e),e.Fa(t.onlineState),c.ba&&e.Ma(c.ba)&&dv(t)}async function uv(n,e){const t=De(n),a=e.query;let o=3;const c=t.queries.get(a);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.va()?0:1:!c.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function RO(n,e){const t=De(n);let a=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const f of d.Sa)f.Ma(o)&&(a=!0);d.ba=o}}a&&dv(t)}function DO(n,e,t){const a=De(n),o=a.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);a.queries.delete(e)}function dv(n){n.Ca.forEach(e=>{e.next()})}var pg,DN;(DN=pg||(pg={})).xa="default",DN.Cache="cache";class hv{constructor(e,t,a){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=a||{}}Ma(e){if(!this.options.includeMetadataChanges){const a=[];for(const o of e.docChanges)o.type!==3&&a.push(o);e=new il(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const a=t!=="Offline";return(!this.options.Qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=il.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==pg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e){this.key=e}}class P0{constructor(e){this.key=e}}class OO{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=$e(),this.mutatedKeys=$e(),this.Za=Jx(e),this.Xa=new Xo(this.Za)}get eu(){return this.Ha}tu(e,t){const a=t?t.nu:new IN,o=t?t.Xa:this.Xa;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,f=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,v=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((_,N)=>{const C=o.get(_),j=Xh(this.query,N)?N:null,b=!!C&&this.mutatedKeys.has(C.key),M=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let x=!1;C&&j?C.data.isEqual(j.data)?b!==M&&(a.track({type:3,doc:j}),x=!0):this.ru(C,j)||(a.track({type:2,doc:j}),x=!0,(p&&this.Za(j,p)>0||v&&this.Za(j,v)<0)&&(f=!0)):!C&&j?(a.track({type:0,doc:j}),x=!0):C&&!j&&(a.track({type:1,doc:C}),x=!0,(p||v)&&(f=!0)),x&&(j?(d=d.add(j),c=M?c.add(_):c.delete(_)):(d=d.delete(_),c=c.delete(_)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const _=this.query.limitType==="F"?d.last():d.first();d=d.delete(_.key),c=c.delete(_.key),a.track({type:1,doc:_})}return{Xa:d,nu:a,Cs:f,mutatedKeys:c}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,o){const c=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const d=e.nu.wa();d.sort((_,N)=>function(j,b){const M=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xe(20277,{Vt:x})}};return M(j)-M(b)}(_.type,N.type)||this.Za(_.doc,N.doc)),this.iu(a),o=o!=null&&o;const f=t&&!o?this.su():[],p=this.Ya.size===0&&this.current&&!o?1:0,v=p!==this.Ja;return this.Ja=p,d.length!==0||v?{snapshot:new il(this.query,e.Xa,c,d,e.mutatedKeys,p===0,v,!1,!!a&&a.resumeToken.approximateByteSize()>0),ou:f}:{ou:f}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new IN,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=$e(),this.Xa.forEach(a=>{this._u(a.key)&&(this.Ya=this.Ya.add(a.key))});const t=[];return e.forEach(a=>{this.Ya.has(a)||t.push(new P0(a))}),this.Ya.forEach(a=>{e.has(a)||t.push(new M0(a))}),t}au(e){this.Ha=e.$s,this.Ya=$e();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return il.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const fv="SyncEngine";class MO{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class PO{constructor(e){this.key=e,this.cu=!1}}class kO{constructor(e,t,a,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.lu={},this.hu=new Fr(f=>Zx(f),Qh),this.Pu=new Map,this.Tu=new Set,this.Iu=new bt(be.comparator),this.Eu=new Map,this.du=new Zg,this.Au={},this.Ru=new Map,this.Vu=al.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function LO(n,e,t=!0){const a=H0(n);let o;const c=a.hu.get(e);return c?(a.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.uu()):o=await k0(a,e,t,!0),o}async function VO(n,e){const t=H0(n);await k0(t,e,!0,!1)}async function k0(n,e,t,a){const o=await aO(n.localStore,Qs(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let f;return a&&(f=await UO(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&S0(n.remoteStore,o),f}async function UO(n,e,t,a,o){n.fu=(N,C,j)=>async function(M,x,V,$){let O=x.view.tu(V);O.Cs&&(O=await xN(M.localStore,x.query,!1).then(({documents:w})=>x.view.tu(w,O)));const U=$&&$.targetChanges.get(x.targetId),q=$&&$.targetMismatches.get(x.targetId)!=null,K=x.view.applyChanges(O,M.isPrimaryClient,U,q);return MN(M,x.targetId,K.ou),K.snapshot}(n,N,C,j);const c=await xN(n.localStore,e,!0),d=new OO(e,c.$s),f=d.tu(c.documents),p=fu.createSynthesizedTargetChangeForCurrentChange(t,a&&n.onlineState!=="Offline",o),v=d.applyChanges(f,n.isPrimaryClient,p);MN(n,t,v.ou);const _=new MO(e,t,d);return n.hu.set(e,_),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),v.snapshot}async function FO(n,e,t){const a=De(n),o=a.hu.get(e),c=a.Pu.get(o.targetId);if(c.length>1)return a.Pu.set(o.targetId,c.filter(d=>!Qh(d,e))),void a.hu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(o.targetId),a.sharedClientState.isActiveQueryTarget(o.targetId)||await fg(a.localStore,o.targetId,!1).then(()=>{a.sharedClientState.clearQueryState(o.targetId),t&&sv(a.remoteStore,o.targetId),gg(a,o.targetId)}).catch(hl)):(gg(a,o.targetId),await fg(a.localStore,o.targetId,!0))}async function HO(n,e){const t=De(n),a=t.hu.get(e),o=t.Pu.get(a.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),sv(t.remoteStore,a.targetId))}async function qO(n,e,t){const a=QO(n);try{const o=await function(d,f){const p=De(d),v=zt.now(),_=f.reduce((j,b)=>j.add(b.key),$e());let N,C;return p.persistence.runTransaction("Locally write mutations","readwrite",j=>{let b=Pa(),M=$e();return p.Bs.getEntries(j,_).next(x=>{b=x,b.forEach((V,$)=>{$.isValidDocument()||(M=M.add(V))})}).next(()=>p.localDocuments.getOverlayedDocuments(j,b)).next(x=>{N=x;const V=[];for(const $ of f){const O=rD($,N.get($.key).overlayedDocument);O!=null&&V.push(new Hi($.key,O,zx(O.value.mapValue),dn.exists(!0)))}return p.mutationQueue.addMutationBatch(j,v,V,f)}).next(x=>{C=x;const V=x.applyToLocalDocumentSet(N,M);return p.documentOverlayCache.saveOverlays(j,x.batchId,V)})}).then(()=>({batchId:C.batchId,changes:t0(N)}))}(a.localStore,e);a.sharedClientState.addPendingMutation(o.batchId),function(d,f,p){let v=d.Au[d.currentUser.toKey()];v||(v=new bt(Ve)),v=v.insert(f,p),d.Au[d.currentUser.toKey()]=v}(a,o.batchId,t),await pu(a,o.changes),await sf(a.remoteStore)}catch(o){const c=lv(o,"Failed to persist write");t.reject(c)}}async function L0(n,e){const t=De(n);try{const a=await tO(t.localStore,e);e.targetChanges.forEach((o,c)=>{const d=t.Eu.get(c);d&&(Ze(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.cu=!0:o.modifiedDocuments.size>0?Ze(d.cu,14607):o.removedDocuments.size>0&&(Ze(d.cu,42227),d.cu=!1))}),await pu(t,a,e)}catch(a){await hl(a)}}function ON(n,e,t){const a=De(n);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const o=[];a.hu.forEach((c,d)=>{const f=d.view.Fa(e);f.snapshot&&o.push(f.snapshot)}),function(d,f){const p=De(d);p.onlineState=f;let v=!1;p.queries.forEach((_,N)=>{for(const C of N.Sa)C.Fa(f)&&(v=!0)}),v&&dv(p)}(a.eventManager,e),o.length&&a.lu.Y_(o),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function BO(n,e,t){const a=De(n);a.sharedClientState.updateQueryState(e,"rejected",t);const o=a.Eu.get(e),c=o&&o.key;if(c){let d=new bt(be.comparator);d=d.insert(c,en.newNoDocument(c,je.min()));const f=$e().add(c),p=new ef(je.min(),new Map,new bt(Ve),d,f);await L0(a,p),a.Iu=a.Iu.remove(c),a.Eu.delete(e),mv(a)}else await fg(a.localStore,e,!1).then(()=>gg(a,e,t)).catch(hl)}async function zO(n,e){const t=De(n),a=e.batch.batchId;try{const o=await eO(t.localStore,e);U0(t,a,null),V0(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await pu(t,o)}catch(o){await hl(o)}}async function GO(n,e,t){const a=De(n);try{const o=await function(d,f){const p=De(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",v=>{let _;return p.mutationQueue.lookupMutationBatch(v,f).next(N=>(Ze(N!==null,37113),_=N.keys(),p.mutationQueue.removeMutationBatch(v,N))).next(()=>p.mutationQueue.performConsistencyCheck(v)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(v,_,f)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,_)).next(()=>p.localDocuments.getDocuments(v,_))})}(a.localStore,e);U0(a,e,t),V0(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await pu(a,o)}catch(o){await hl(o)}}function V0(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function U0(n,e,t){const a=De(n);let o=a.Au[a.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),a.Au[a.currentUser.toKey()]=o}}function gg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const a of n.Pu.get(e))n.hu.delete(a),t&&n.lu.gu(a,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(a=>{n.du.containsKey(a)||F0(n,a)})}function F0(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(sv(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),mv(n))}function MN(n,e,t){for(const a of t)a instanceof M0?(n.du.addReference(a.key,e),$O(n,a)):a instanceof P0?(pe(fv,"Document no longer in limbo: "+a.key),n.du.removeReference(a.key,e),n.du.containsKey(a.key)||F0(n,a.key)):xe(19791,{pu:a})}function $O(n,e){const t=e.key,a=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(a)||(pe(fv,"New document in limbo: "+t),n.Tu.add(a),mv(n))}function mv(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new be(ht.fromString(e)),a=n.Vu.next();n.Eu.set(a,new PO(t)),n.Iu=n.Iu.insert(t,a),S0(n.remoteStore,new bi(Qs(Kh(t.path)),a,"TargetPurposeLimboResolution",$h.le))}}async function pu(n,e,t){const a=De(n),o=[],c=[],d=[];a.hu.isEmpty()||(a.hu.forEach((f,p)=>{d.push(a.fu(p,e,t).then(v=>{var _;if((v||t)&&a.isPrimaryClient){const N=v?!v.fromCache:(_=t?.targetChanges.get(p.targetId))===null||_===void 0?void 0:_.current;a.sharedClientState.updateQueryState(p.targetId,N?"current":"not-current")}if(v){o.push(v);const N=ev.Rs(p.targetId,v);c.push(N)}}))}),await Promise.all(d),a.lu.Y_(o),await async function(p,v){const _=De(p);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",N=>le.forEach(v,C=>le.forEach(C.ds,j=>_.persistence.referenceDelegate.addReference(N,C.targetId,j)).next(()=>le.forEach(C.As,j=>_.persistence.referenceDelegate.removeReference(N,C.targetId,j)))))}catch(N){if(!fl(N))throw N;pe(tv,"Failed to update sequence numbers: "+N)}for(const N of v){const C=N.targetId;if(!N.fromCache){const j=_.xs.get(C),b=j.snapshotVersion,M=j.withLastLimboFreeSnapshotVersion(b);_.xs=_.xs.insert(C,M)}}}(a.localStore,c))}async function YO(n,e){const t=De(n);if(!t.currentUser.isEqual(e)){pe(fv,"User change. New user:",e.toKey());const a=await A0(t.localStore,e);t.currentUser=e,function(c,d){c.Ru.forEach(f=>{f.forEach(p=>{p.reject(new me(re.CANCELLED,d))})}),c.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await pu(t,a.ks)}}function KO(n,e){const t=De(n),a=t.Eu.get(e);if(a&&a.cu)return $e().add(a.key);{let o=$e();const c=t.Pu.get(e);if(!c)return o;for(const d of c){const f=t.hu.get(d);o=o.unionWith(f.view.eu)}return o}}function H0(n){const e=De(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=L0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=BO.bind(null,e),e.lu.Y_=RO.bind(null,e.eventManager),e.lu.gu=DO.bind(null,e.eventManager),e}function QO(n){const e=De(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=GO.bind(null,e),e}class Dh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=tf(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return JD(this.persistence,new XD,e.initialUser,this.serializer)}Su(e){return new x0(Jg.fi,this.serializer)}bu(e){return new rO}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Dh.provider={build:()=>new Dh};class XO extends Dh{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Ze(this.persistence.referenceDelegate instanceof Ih,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new PD(a,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?On.withCacheSize(this.cacheSizeBytes):On.DEFAULT;return new x0(a=>Ih.fi(a,t),this.serializer)}}class vg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>ON(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=YO.bind(null,this.syncEngine),await SO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new IO}()}createDatastore(e){const t=tf(e.databaseInfo.databaseId),a=function(c){return new dO(c)}(e.databaseInfo);return function(c,d,f,p){return new pO(c,d,f,p)}(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return function(a,o,c,d,f){return new vO(a,o,c,d,f)}(this.localStore,this.datastore,e.asyncQueue,t=>ON(this.syncEngine,t,0),function(){return jN.C()?new jN:new oO}())}createSyncEngine(e,t){return function(o,c,d,f,p,v,_){const N=new kO(o,c,d,f,p,v);return _&&(N.mu=!0),N}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const c=De(o);pe(Mr,"RemoteStore shutting down."),c.da.add(5),await mu(c),c.Ra.shutdown(),c.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}vg.provider={build:()=>new vg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Ma("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new me(re.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,c){const d=De(o),f={documents:c.map(N=>wh(d.serializer,N))},p=await d.Yo("BatchGetDocuments",d.serializer.databaseId,ht.emptyPath(),f,c.length),v=new Map;p.forEach(N=>{const C=yD(d.serializer,N);v.set(C.key.toString(),C)});const _=[];return c.forEach(N=>{const C=v.get(N.toString());Ze(!!C,55234,{key:N}),_.push(C)}),_}(this.datastore,e);return t.forEach(a=>this.recordVersion(a)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(a){this.lastTransactionError=a}this.writtenDocs.add(e.toString())}delete(e){this.write(new Jh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,a)=>{const o=be.fromPath(a);this.mutations.push(new u0(o,this.precondition(o)))}),await async function(a,o){const c=De(a),d={writes:o.map(f=>_0(c.serializer,f))};await c.zo("Commit",c.serializer.databaseId,ht.emptyPath(),d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw xe(50498,{Uu:e.constructor.name});t=je.min()}const a=this.readVersions.get(e.key.toString());if(a){if(!t.isEqual(a))throw new me(re.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(je.min())?dn.exists(!1):dn.updateTime(t):dn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(je.min()))throw new me(re.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return dn.updateTime(t)}return dn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e,t,a,o,c){this.asyncQueue=e,this.datastore=t,this.options=a,this.updateFunction=o,this.deferred=c,this.Ku=a.maxAttempts,this.x_=new nv(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new WO(this.datastore),t=this.zu(e);t&&t.then(a=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(a)}).catch(o=>{this.ju(o)}))}).catch(a=>{this.ju(a)})})}zu(e){try{const t=this.updateFunction(e);return!du(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!d0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di="FirestoreClient";class JO{constructor(e,t,a,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=o,this.user=yn.UNAUTHENTICATED,this.clientId=Mx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(a,async d=>{pe(Di,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(a,d=>(pe(Di,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ks;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=lv(t,"Failed to shutdown persistence");e.reject(a)}}),e.promise}}async function Pp(n,e){n.asyncQueue.verifyOperationInProgress(),pe(Di,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let a=t.initialUser;n.setCredentialChangeListener(async o=>{a.isEqual(o)||(await A0(e.localStore,o),a=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function PN(n,e){n.asyncQueue.verifyOperationInProgress();const t=await eM(n);pe(Di,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(a=>wN(e.remoteStore,a)),n.setAppCheckTokenChangeListener((a,o)=>wN(e.remoteStore,o)),n._onlineComponents=e}async function eM(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){pe(Di,"Using user provided OfflineComponentProvider");try{await Pp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===re.FAILED_PRECONDITION||o.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;el("Error using user provided cache. Falling back to memory cache: "+t),await Pp(n,new Dh)}}else pe(Di,"Using default OfflineComponentProvider"),await Pp(n,new XO(void 0));return n._offlineComponents}async function gv(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(pe(Di,"Using user provided OnlineComponentProvider"),await PN(n,n._uninitializedComponentsProvider._online)):(pe(Di,"Using default OnlineComponentProvider"),await PN(n,new vg))),n._onlineComponents}function tM(n){return gv(n).then(e=>e.syncEngine)}function nM(n){return gv(n).then(e=>e.datastore)}async function Oh(n){const e=await gv(n),t=e.eventManager;return t.onListen=LO.bind(null,e.syncEngine),t.onUnlisten=FO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=VO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=HO.bind(null,e.syncEngine),t}function sM(n,e,t={}){const a=new Ks;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,v){const _=new pv({next:C=>{_.xu(),d.enqueueAndForget(()=>uv(c,N));const j=C.docs.has(f);!j&&C.fromCache?v.reject(new me(re.UNAVAILABLE,"Failed to get document because the client is offline.")):j&&C.fromCache&&p&&p.source==="server"?v.reject(new me(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(C)},error:C=>v.reject(C)}),N=new hv(Kh(f.path),_,{includeMetadataChanges:!0,Qa:!0});return cv(c,N)}(await Oh(n),n.asyncQueue,e,t,a)),a.promise}function aM(n,e,t={}){const a=new Ks;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,v){const _=new pv({next:C=>{_.xu(),d.enqueueAndForget(()=>uv(c,N)),C.fromCache&&p.source==="server"?v.reject(new me(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(C)},error:C=>v.reject(C)}),N=new hv(f,_,{includeMetadataChanges:!0,Qa:!0});return cv(c,N)}(await Oh(n),n.asyncQueue,e,t,a)),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B0(n,e,t){if(!t)throw new me(re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function iM(n,e,t,a){if(e===!0&&a===!0)throw new me(re.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function LN(n){if(!be.isDocumentKey(n))throw new me(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function VN(n){if(be.isDocumentKey(n))throw new me(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function af(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(a){return a.constructor?a.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":xe(12329,{type:typeof n})}function wn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=af(n);throw new me(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0="firestore.googleapis.com",UN=!0;class FN{constructor(e){var t,a;if(e.host===void 0){if(e.ssl!==void 0)throw new me(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=z0,this.ssl=UN}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:UN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=T0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<OD)throw new me(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=q0((a=e.experimentalLongPollingOptions)!==null&&a!==void 0?a:{}),function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(a,o){return a.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rf{constructor(e,t,a,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FN(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(a){if(!a)return new d1;switch(a.type){case"firstParty":return new p1(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new me(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const a=kN.get(t);a&&(pe("ComponentProvider","Removing Datastore"),kN.delete(t),a.terminate())}(this),Promise.resolve()}}function rM(n,e,t,a={}){var o;n=wn(n,rf);const c=Vr(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),p=`${e}:${t}`;c&&(Cg(`https://${p}`),jg("Firestore",!0)),d.host!==z0&&d.host!==p&&el("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:p,ssl:c,emulatorOptions:a});if(!Ci(v,f)&&(n._setSettings(v),a.mockUserToken)){let _,N;if(typeof a.mockUserToken=="string")_=a.mockUserToken,N=yn.MOCK_USER;else{_=LT(a.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const C=a.mockUserToken.sub||a.mockUserToken.user_id;if(!C)throw new me(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");N=new yn(C)}n._authCredentials=new h1(new Dx(_,N))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new La(this.firestore,e,this._query)}}class hn{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ai(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hn(this.firestore,e,this._key)}}class Ai extends La{constructor(e,t,a){super(e,t,Kh(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hn(this.firestore,null,new be(e))}withConverter(e){return new Ai(this.firestore,e,this._path)}}function Je(n,e,...t){if(n=vt(n),B0("collection","path",e),n instanceof rf){const a=ht.fromString(e,...t);return VN(a),new Ai(n,null,a)}{if(!(n instanceof hn||n instanceof Ai))throw new me(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ht.fromString(e,...t));return VN(a),new Ai(n.firestore,null,a)}}function Ct(n,e,...t){if(n=vt(n),arguments.length===1&&(e=Mx.newId()),B0("doc","path",e),n instanceof rf){const a=ht.fromString(e,...t);return LN(a),new hn(n,null,new be(a))}{if(!(n instanceof hn||n instanceof Ai))throw new me(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ht.fromString(e,...t));return LN(a),new hn(n.firestore,n instanceof Ai?n.converter:null,new be(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN="AsyncQueue";class qN{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new nv(this,"async_queue_retry"),this.rc=()=>{const a=Mp();a&&pe(HN,"Visibility state changed to "+a.visibilityState),this.x_.b_()},this.sc=e;const t=Mp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Mp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Ks;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!fl(e))throw e;pe(HN,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(a=>{throw this.Xu=a,this.ec=!1,Ma("INTERNAL UNHANDLED ERROR: ",BN(a)),a}).then(a=>(this.ec=!1,a))));return this.sc=t,t}enqueueAfterDelay(e,t,a){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=ov.createAndSchedule(this,e,t,a,c=>this.uc(c));return this.Zu.push(o),o}oc(){this.Xu&&xe(47125,{cc:BN(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,a)=>t.targetTimeMs-a.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function BN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zN(n){return function(t,a){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of a)if(c in o&&typeof o[c]=="function")return!0;return!1}(n,["next","error","complete"])}class Ws extends rf{constructor(e,t,a,o){super(e,t,a,o),this.type="firestore",this._queue=new qN,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qN(e),this._firestoreClient=void 0,await e}}}function oM(n,e){const t=typeof n=="object"?n:ru(),a=typeof n=="string"?n:Th,o=ka(t,"firestore").getImmediate({identifier:a});if(!o._initialized){const c=MT("firestore");c&&rM(o,...c)}return o}function gu(n){if(n._terminated)throw new me(re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||lM(n),n._firestoreClient}function lM(n){var e,t,a;const o=n._freezeSettings(),c=function(f,p,v,_){return new I1(f,p,v,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,q0(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((a=o.localCache)===null||a===void 0)&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new JO(n._authCredentials,n._appCheckCredentials,n._queue,c,n._componentsProvider&&function(f){const p=f?._online.build();return{_offline:f?._offline.build(p),_online:p}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pr(fn.fromBase64String(e))}catch(t){throw new me(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Pr(fn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(a,o){if(a.length!==o.length)return!1;for(let c=0;c<a.length;++c)if(a[c]!==o[c])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM=/^__.*__$/;class uM{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new Hi(e,this.data,this.fieldMask,t,this.fieldTransforms):new hu(e,this.data,t,this.fieldTransforms)}}class G0{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return new Hi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function $0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xe(40011,{Ic:n})}}class _v{constructor(e,t,a,o,c,d){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=o,c===void 0&&this.Ec(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new _v(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Vc(e),o}mc(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Mh(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if($0(this.Ic)&&cM.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class dM{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||tf(e)}bc(e,t,a,o=!1){return new _v({Ic:e,methodName:t,wc:a,path:un.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yu(n){const e=n._freezeSettings(),t=tf(n._databaseId);return new dM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ev(n,e,t,a,o,c={}){const d=n.bc(c.merge||c.mergeFields?2:0,e,t,o);Nv("Data must be an object, but it was:",d,a);const f=Q0(a,d);let p,v;if(c.merge)p=new $n(d.fieldMask),v=d.fieldTransforms;else if(c.mergeFields){const _=[];for(const N of c.mergeFields){const C=yg(e,N,t);if(!d.contains(C))throw new me(re.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);W0(_,C)||_.push(C)}p=new $n(_),v=d.fieldTransforms.filter(N=>p.covers(N.field))}else p=null,v=d.fieldTransforms;return new uM(new Sn(f),p,v)}class lf extends of{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lf}}class bv extends of{_toFieldTransform(e){return new nD(e.path,new eu)}isEqual(e){return e instanceof bv}}function Y0(n,e,t,a){const o=n.bc(1,e,t);Nv("Data must be an object, but it was:",o,a);const c=[],d=Sn.empty();Fi(a,(p,v)=>{const _=Tv(e,p,t);v=vt(v);const N=o.mc(_);if(v instanceof lf)c.push(_);else{const C=_u(v,N);C!=null&&(c.push(_),d.set(_,C))}});const f=new $n(c);return new G0(d,f,o.fieldTransforms)}function K0(n,e,t,a,o,c){const d=n.bc(1,e,t),f=[yg(e,a,t)],p=[o];if(c.length%2!=0)throw new me(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<c.length;C+=2)f.push(yg(e,c[C])),p.push(c[C+1]);const v=[],_=Sn.empty();for(let C=f.length-1;C>=0;--C)if(!W0(v,f[C])){const j=f[C];let b=p[C];b=vt(b);const M=d.mc(j);if(b instanceof lf)v.push(j);else{const x=_u(b,M);x!=null&&(v.push(j),_.set(j,x))}}const N=new $n(v);return new G0(_,N,d.fieldTransforms)}function hM(n,e,t,a=!1){return _u(t,n.bc(a?4:3,e))}function _u(n,e){if(X0(n=vt(n)))return Nv("Unsupported field value:",e,n),Q0(n,e);if(n instanceof of)return function(a,o){if(!$0(o.Ic))throw o.gc(`${a._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${a._methodName}() is not currently supported inside arrays`);const c=a._toFieldTransform(o);c&&o.fieldTransforms.push(c)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(a,o){const c=[];let d=0;for(const f of a){let p=_u(f,o.fc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}}(n,e)}return function(a,o){if((a=vt(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return J1(o.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const c=zt.fromDate(a);return{timestampValue:Sh(o.serializer,c)}}if(a instanceof zt){const c=new zt(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:Sh(o.serializer,c)}}if(a instanceof vv)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof Pr)return{bytesValue:p0(o.serializer,a._byteString)};if(a instanceof hn){const c=o.databaseId,d=a.firestore._databaseId;if(!d.isEqual(c))throw o.gc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Wg(a.firestore._databaseId||o.databaseId,a._key.path)}}if(a instanceof yv)return function(d,f){return{mapValue:{fields:{[qx]:{stringValue:Bx},[xh]:{arrayValue:{values:d.toArray().map(v=>{if(typeof v!="number")throw f.gc("VectorValues must only contain numeric values.");return Kg(f.serializer,v)})}}}}}}(a,o);throw o.gc(`Unsupported field value: ${af(a)}`)}(n,e)}function Q0(n,e){const t={};return kx(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fi(n,(a,o)=>{const c=_u(o,e.Ac(a));c!=null&&(t[a]=c)}),{mapValue:{fields:t}}}function X0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof zt||n instanceof vv||n instanceof Pr||n instanceof hn||n instanceof of||n instanceof yv)}function Nv(n,e,t){if(!X0(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const a=af(t);throw a==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+a)}}function yg(n,e,t){if((e=vt(e))instanceof vu)return e._internalPath;if(typeof e=="string")return Tv(n,e);throw Mh("Field path arguments must be of type string or ",n,!1,void 0,t)}const fM=new RegExp("[~\\*/\\[\\]]");function Tv(n,e,t){if(e.search(fM)>=0)throw Mh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new vu(...e.split("."))._internalPath}catch{throw Mh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Mh(n,e,t,a,o){const c=a&&!a.isEmpty(),d=o!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${a}`),d&&(p+=` in document ${o}`),p+=")"),new me(re.INVALID_ARGUMENT,f+n+p)}function W0(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e,t,a,o,c){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new hn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new mM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(cf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class mM extends Ph{data(){return super.data()}}function cf(n,e){return typeof e=="string"?Tv(n,e):e instanceof vu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class xv{}class Av extends xv{}function Re(n,e,...t){let a=[];e instanceof xv&&a.push(e),a=a.concat(t),function(c){const d=c.filter(p=>p instanceof Cv).length,f=c.filter(p=>p instanceof uf).length;if(d>1||d>0&&f>0)throw new me(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a);for(const o of a)n=o._apply(n);return n}class uf extends Av{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new uf(e,t,a)}_apply(e){const t=this._parse(e);return eA(e._query,t),new La(e.firestore,e.converter,cg(e._query,t))}_parse(e){const t=yu(e.firestore);return function(c,d,f,p,v,_,N){let C;if(v.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new me(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){$N(N,_);const b=[];for(const M of N)b.push(GN(p,c,M));C={arrayValue:{values:b}}}else C=GN(p,c,N)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||$N(N,_),C=hM(f,d,N,_==="in"||_==="not-in");return Lt.create(v,_,C)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ye(n,e,t){const a=e,o=cf("where",n);return uf._create(o,a,t)}class Cv extends xv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Cv(e,t)}_parse(e){const t=this._queryConstraints.map(a=>a._parse(e)).filter(a=>a.getFilters().length>0);return t.length===1?t[0]:Cs.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,c){let d=o;const f=c.getFlattenedFilters();for(const p of f)eA(d,p),d=cg(d,p)}(e._query,t),new La(e.firestore,e.converter,cg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class jv extends Av{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new jv(e,t)}_apply(e){const t=function(o,c,d){if(o.startAt!==null)throw new me(re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new me(re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jc(c,d)}(e._query,this._field,this._direction);return new La(e.firestore,e.converter,function(o,c){const d=o.explicitOrderBy.concat([c]);return new ml(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function Wn(n,e="asc"){const t=e,a=cf("orderBy",n);return jv._create(a,t)}class Sv extends Av{constructor(e,t,a){super(),this.type=e,this._limit=t,this._limitType=a}static _create(e,t,a){return new Sv(e,t,a)}_apply(e){return new La(e.firestore,e.converter,Ch(e._query,this._limit,this._limitType))}}function J0(n){return Sv._create("limit",n,"F")}function GN(n,e,t){if(typeof(t=vt(t))=="string"){if(t==="")throw new me(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Wx(e)&&t.indexOf("/")!==-1)throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(ht.fromString(t));if(!be.isDocumentKey(a))throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return iN(n,new be(a))}if(t instanceof hn)return iN(n,t._key);throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${af(t)}.`)}function $N(n,e){if(!Array.isArray(n)||n.length===0)throw new me(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function eA(n,e){const t=function(o,c){for(const d of o)for(const f of d.getFlattenedFilters())if(c.indexOf(f.op)>=0)return f.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new me(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class tA{convertValue(e,t="none"){switch(Ii(e)){case 0:return null;case 1:return e.booleanValue;case 2:return It(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(wi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw xe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return Fi(e,(o,c)=>{a[o]=this.convertValue(c,t)}),a}convertVectorValue(e){var t,a,o;const c=(o=(a=(t=e.fields)===null||t===void 0?void 0:t[xh].arrayValue)===null||a===void 0?void 0:a.values)===null||o===void 0?void 0:o.map(d=>It(d.doubleValue));return new yv(c)}convertGeoPoint(e){return new vv(It(e.latitude),It(e.longitude))}convertArray(e,t){return(e.values||[]).map(a=>this.convertValue(a,t))}convertServerTimestamp(e,t){switch(t){case"previous":const a=Yh(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp(Xc(e));default:return null}}convertTimestamp(e){const t=Si(e);return new zt(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=ht.fromString(e);Ze(N0(a),9688,{name:e});const o=new Wc(a.get(1),a.get(3)),c=new be(a.popFirst(5));return o.isEqual(t)||Ma(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(n,e,t){let a;return a=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,a}class pM extends tA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new hn(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Iv extends Ph{constructor(e,t,a,o,c,d){super(e,t,a,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new dh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(cf("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}}class dh extends Iv{data(e={}){return super.data(e)}}class nA{constructor(e,t,a,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Bo(o.hasPendingWrites,o.fromCache),this.query=a}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(a=>{e.call(t,new dh(this._firestore,this._userDataWriter,a.key,a,new Bo(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map(f=>{const p=new dh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Bo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}})}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(f=>c||f.type!==3).map(f=>{const p=new dh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Bo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);let v=-1,_=-1;return f.type!==0&&(v=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),_=d.indexOf(f.doc.key)),{type:gM(f.type),doc:p,oldIndex:v,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function gM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xe(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(n){n=wn(n,hn);const e=wn(n.firestore,Ws);return sM(gu(e),n._key).then(t=>sA(e,n,t))}class df extends tA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new hn(this.firestore,null,t)}}function Vt(n){n=wn(n,La);const e=wn(n.firestore,Ws),t=gu(e),a=new df(e);return Z0(n._query),aM(t,n._query).then(o=>new nA(e,a,n,o))}function hf(n,e,t){n=wn(n,hn);const a=wn(n.firestore,Ws),o=wv(n.converter,e,t);return ff(a,[Ev(yu(a),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,dn.none())])}function Va(n,e,t,...a){n=wn(n,hn);const o=wn(n.firestore,Ws),c=yu(o);let d;return d=typeof(e=vt(e))=="string"||e instanceof vu?K0(c,"updateDoc",n._key,e,t,a):Y0(c,"updateDoc",n._key,e),ff(o,[d.toMutation(n._key,dn.exists(!0))])}function Rv(n){return ff(wn(n.firestore,Ws),[new Jh(n._key,dn.none())])}function Eu(n,e){const t=wn(n.firestore,Ws),a=Ct(n),o=wv(n.converter,e);return ff(t,[Ev(yu(n.firestore),"addDoc",a._key,o,n.converter!==null,{}).toMutation(a._key,dn.exists(!1))]).then(()=>a)}function gl(n,...e){var t,a,o;n=vt(n);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||zN(e[d])||(c=e[d],d++);const f={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(zN(e[d])){const N=e[d];e[d]=(t=N.next)===null||t===void 0?void 0:t.bind(N),e[d+1]=(a=N.error)===null||a===void 0?void 0:a.bind(N),e[d+2]=(o=N.complete)===null||o===void 0?void 0:o.bind(N)}let p,v,_;if(n instanceof hn)v=wn(n.firestore,Ws),_=Kh(n._key.path),p={next:N=>{e[d]&&e[d](sA(v,n,N))},error:e[d+1],complete:e[d+2]};else{const N=wn(n,La);v=wn(N.firestore,Ws),_=N._query;const C=new df(v);p={next:j=>{e[d]&&e[d](new nA(v,C,N,j))},error:e[d+1],complete:e[d+2]},Z0(n._query)}return function(C,j,b,M){const x=new pv(M),V=new hv(j,x,b);return C.asyncQueue.enqueueAndForget(async()=>cv(await Oh(C),V)),()=>{x.xu(),C.asyncQueue.enqueueAndForget(async()=>uv(await Oh(C),V))}}(gu(v),_,f,p)}function ff(n,e){return function(a,o){const c=new Ks;return a.asyncQueue.enqueueAndForget(async()=>qO(await tM(a),o,c)),c.promise}(gu(n),e)}function sA(n,e,t){const a=t.docs.get(e._key),o=new df(n);return new Iv(n,o,e._key,a,new Bo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vM={maxAttempts:5};function Mc(n,e){if((n=vt(n)).firestore!==e)throw new me(re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=yu(e)}get(e){const t=Mc(e,this._firestore),a=new pM(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return xe(24041);const c=o[0];if(c.isFoundDocument())return new Ph(this._firestore,a,c.key,c,t.converter);if(c.isNoDocument())return new Ph(this._firestore,a,t._key,null,t.converter);throw xe(18433,{doc:c})})}set(e,t,a){const o=Mc(e,this._firestore),c=wv(o.converter,t,a),d=Ev(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,a);return this._transaction.set(o._key,d),this}update(e,t,a,...o){const c=Mc(e,this._firestore);let d;return d=typeof(t=vt(t))=="string"||t instanceof vu?K0(this._dataReader,"Transaction.update",c._key,t,a,o):Y0(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,d),this}delete(e){const t=Mc(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M extends yM{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Mc(e,this._firestore),a=new df(this._firestore);return super.get(e).then(o=>new Iv(this._firestore,a,t._key,o._document,new Bo(!1,!1),t.converter))}}function aA(n,e,t){n=wn(n,Ws);const a=Object.assign(Object.assign({},vM),t);return function(c){if(c.maxAttempts<1)throw new me(re.INVALID_ARGUMENT,"Max attempts must be at least 1")}(a),function(c,d,f){const p=new Ks;return c.asyncQueue.enqueueAndForget(async()=>{const v=await nM(c);new ZO(c.asyncQueue,v,f,d,p).Wu()}),p.promise}(gu(n),o=>e(new _M(n,o)),a)}function Rt(){return new bv("serverTimestamp")}(function(e,t=!0){(function(o){dl=o})(Ur),ds(new Xn("firestore",(a,{instanceIdentifier:o,options:c})=>{const d=a.getProvider("app").getImmediate(),f=new Ws(new f1(a.getProvider("auth-internal")),new g1(d,a.getProvider("app-check-internal")),function(v,_){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new me(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wc(v.options.projectId,_)}(d,o),d);return c=Object.assign({useFetchStreams:t},c),f._setSettings(c),f},"PUBLIC").setMultipleInstances(!0)),En(Yb,Kb,e),En(Yb,Kb,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA="firebasestorage.googleapis.com",EM="storageBucket",bM=2*60*1e3,NM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js extends fs{constructor(e,t,a=0){super(kp(e),`Firebase Storage: ${t} (${kp(e)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Js.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return kp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Zs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Zs||(Zs={}));function kp(n){return"storage/"+n}function TM(){const n="An unknown error occurred, please check the error payload for server response.";return new Js(Zs.UNKNOWN,n)}function xM(){return new Js(Zs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function AM(){return new Js(Zs.CANCELED,"User canceled the upload/download.")}function CM(n){return new Js(Zs.INVALID_URL,"Invalid URL '"+n+"'.")}function jM(n){return new Js(Zs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function YN(n){return new Js(Zs.INVALID_ARGUMENT,n)}function rA(){return new Js(Zs.APP_DELETED,"The Firebase app was deleted.")}function SM(n){return new Js(Zs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let a;try{a=xs.makeFromUrl(e,t)}catch{return new xs(e,"")}if(a.path==="")return a;throw jM(e)}static makeFromUrl(e,t){let a=null;const o="([A-Za-z0-9.\\-_]+)";function c(U){U.path.charAt(U.path.length-1)==="/"&&(U.path_=U.path_.slice(0,-1))}const d="(/(.*))?$",f=new RegExp("^gs://"+o+d,"i"),p={bucket:1,path:3};function v(U){U.path_=decodeURIComponent(U.path)}const _="v[A-Za-z0-9_]+",N=t.replace(/[.]/g,"\\."),C="(/([^?#]*).*)?$",j=new RegExp(`^https?://${N}/${_}/b/${o}/o${C}`,"i"),b={bucket:1,path:3},M=t===iA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",V=new RegExp(`^https?://${M}/${o}/${x}`,"i"),O=[{regex:f,indices:p,postModify:c},{regex:j,indices:b,postModify:v},{regex:V,indices:{bucket:1,path:2},postModify:v}];for(let U=0;U<O.length;U++){const q=O[U],K=q.regex.exec(e);if(K){const w=K[q.indices.bucket];let A=K[q.indices.path];A||(A=""),a=new xs(w,A),q.postModify(a);break}}if(a==null)throw CM(e);return a}}class wM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IM(n,e,t){let a=1,o=null,c=null,d=!1,f=0;function p(){return f===2}let v=!1;function _(...x){v||(v=!0,e.apply(null,x))}function N(x){o=setTimeout(()=>{o=null,n(j,p())},x)}function C(){c&&clearTimeout(c)}function j(x,...V){if(v){C();return}if(x){C(),_.call(null,x,...V);return}if(p()||d){C(),_.call(null,x,...V);return}a<64&&(a*=2);let O;f===1?(f=2,O=0):O=(a+Math.random())*1e3,N(O)}let b=!1;function M(x){b||(b=!0,C(),!v&&(o!==null?(x||(f=2),clearTimeout(o),N(0)):x||(f=1)))}return N(0),c=setTimeout(()=>{d=!0,M(!0)},t),M}function RM(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DM(n){return n!==void 0}function KN(n,e,t,a){if(a<e)throw YN(`Invalid value for '${n}'. Expected ${e} or greater.`);if(a>t)throw YN(`Invalid value for '${n}'. Expected ${t} or less.`)}function OM(n){const e=encodeURIComponent;let t="?";for(const a in n)if(n.hasOwnProperty(a)){const o=e(a)+"="+e(n[a]);t=t+o+"&"}return t=t.slice(0,-1),t}var kh;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(kh||(kh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MM(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{constructor(e,t,a,o,c,d,f,p,v,_,N,C=!0,j=!1){this.url_=e,this.method_=t,this.headers_=a,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=f,this.errorCallback_=p,this.timeout_=v,this.progressCallback_=_,this.connectionFactory_=N,this.retry=C,this.isUsingEmulator=j,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,M)=>{this.resolve_=b,this.reject_=M,this.start_()})}start_(){const e=(a,o)=>{if(o){a(!1,new Jd(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=f=>{const p=f.loaded,v=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,v)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const f=c.getErrorCode()===kh.NO_ERROR,p=c.getStatus();if(!f||MM(p,this.additionalRetryCodes_)&&this.retry){const _=c.getErrorCode()===kh.ABORT;a(!1,new Jd(!1,null,_));return}const v=this.successCodes_.indexOf(p)!==-1;a(!0,new Jd(v,c))})},t=(a,o)=>{const c=this.resolve_,d=this.reject_,f=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(f,f.getResponse());DM(p)?c(p):c()}catch(p){d(p)}else if(f!==null){const p=TM();p.serverResponse=f.getErrorText(),this.errorCallback_?d(this.errorCallback_(f,p)):d(p)}else if(o.canceled){const p=this.appDelete_?rA():AM();d(p)}else{const p=xM();d(p)}};this.canceled_?t(!1,new Jd(!1,null,!0)):this.backoffId_=IM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&RM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Jd{constructor(e,t,a){this.wasSuccessCode=e,this.connection=t,this.canceled=!!a}}function kM(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function LM(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function VM(n,e){e&&(n["X-Firebase-GMPID"]=e)}function UM(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function FM(n,e,t,a,o,c,d=!0,f=!1){const p=OM(n.urlParams),v=n.url+p,_=Object.assign({},n.headers);return VM(_,e),kM(_,t),LM(_,c),UM(_,a),new PM(v,n.method,_,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,f)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HM(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function qM(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e,t){this._service=e,t instanceof xs?this._location=t:this._location=xs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Lh(e,t)}get root(){const e=new xs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return qM(this._location.path)}get storage(){return this._service}get parent(){const e=HM(this._location.path);if(e===null)return null;const t=new xs(this._location.bucket,e);return new Lh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw SM(e)}}function QN(n,e){const t=e?.[EM];return t==null?null:xs.makeFromBucketSpec(t,n)}function BM(n,e,t,a={}){n.host=`${e}:${t}`;const o=Vr(e);o&&(Cg(`https://${n.host}/b`),jg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=a;c&&(n._overrideAuthToken=typeof c=="string"?c:LT(c,n.app.options.projectId))}class zM{constructor(e,t,a,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=a,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=iA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=bM,this._maxUploadRetryTime=NM,this._requests=new Set,o!=null?this._bucket=xs.makeFromBucketSpec(o,this._host):this._bucket=QN(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=xs.makeFromBucketSpec(this._url,e):this._bucket=QN(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){KN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){KN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Mn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Lh(this,e)}_makeRequest(e,t,a,o,c=!0){if(this._deleted)return new wM(rA());{const d=FM(e,this._appId,a,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[a,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,a,o).getPromise()}}const XN="@firebase/storage",WN="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA="storage";function GM(n=ru(),e){n=vt(n);const a=ka(n,oA).getImmediate({identifier:e}),o=MT("storage");return o&&$M(a,...o),a}function $M(n,e,t,a={}){BM(n,e,t,a)}function YM(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new zM(t,a,o,e,Ur)}function KM(){ds(new Xn(oA,YM,"PUBLIC").setMultipleInstances(!0)),En(XN,WN,""),En(XN,WN,"esm2017")}KM();const lA="@firebase/installations",Dv="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA=1e4,uA=`w:${Dv}`,dA="FIS_v2",QM="https://firebaseinstallations.googleapis.com/v1",XM=60*60*1e3,WM="installations",ZM="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JM={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},kr=new ki(WM,ZM,JM);function hA(n){return n instanceof fs&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA({projectId:n}){return`${QM}/projects/${n}/installations`}function mA(n){return{token:n.token,requestStatus:2,expiresIn:tP(n.expiresIn),creationTime:Date.now()}}async function pA(n,e){const a=(await e.json()).error;return kr.create("request-failed",{requestName:n,serverCode:a.code,serverMessage:a.message,serverStatus:a.status})}function gA({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function eP(n,{refreshToken:e}){const t=gA(n);return t.append("Authorization",nP(e)),t}async function vA(n){const e=await n();return e.status>=500&&e.status<600?n():e}function tP(n){return Number(n.replace("s","000"))}function nP(n){return`${dA} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sP({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const a=fA(n),o=gA(n),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={fid:t,authVersion:dA,appId:n.appId,sdkVersion:uA},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await vA(()=>fetch(a,f));if(p.ok){const v=await p.json();return{fid:v.fid||t,registrationStatus:2,refreshToken:v.refreshToken,authToken:mA(v.authToken)}}else throw await pA("Create Installation",p)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aP(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP=/^[cdef][\w-]{21}$/,_g="";function rP(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=oP(n);return iP.test(t)?t:_g}catch{return _g}}function oP(n){return aP(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A=new Map;function EA(n,e){const t=mf(n);bA(t,e),lP(t,e)}function bA(n,e){const t=_A.get(n);if(t)for(const a of t)a(e)}function lP(n,e){const t=cP();t&&t.postMessage({key:n,fid:e}),uP()}let wr=null;function cP(){return!wr&&"BroadcastChannel"in self&&(wr=new BroadcastChannel("[Firebase] FID Change"),wr.onmessage=n=>{bA(n.data.key,n.data.fid)}),wr}function uP(){_A.size===0&&wr&&(wr.close(),wr=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dP="firebase-installations-database",hP=1,Lr="firebase-installations-store";let Lp=null;function Ov(){return Lp||(Lp=qT(dP,hP,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Lr)}}})),Lp}async function Vh(n,e){const t=mf(n),o=(await Ov()).transaction(Lr,"readwrite"),c=o.objectStore(Lr),d=await c.get(t);return await c.put(e,t),await o.done,(!d||d.fid!==e.fid)&&EA(n,e.fid),e}async function NA(n){const e=mf(n),a=(await Ov()).transaction(Lr,"readwrite");await a.objectStore(Lr).delete(e),await a.done}async function pf(n,e){const t=mf(n),o=(await Ov()).transaction(Lr,"readwrite"),c=o.objectStore(Lr),d=await c.get(t),f=e(d);return f===void 0?await c.delete(t):await c.put(f,t),await o.done,f&&(!d||d.fid!==f.fid)&&EA(n,f.fid),f}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mv(n){let e;const t=await pf(n.appConfig,a=>{const o=fP(a),c=mP(n,o);return e=c.registrationPromise,c.installationEntry});return t.fid===_g?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function fP(n){const e=n||{fid:rP(),registrationStatus:0};return TA(e)}function mP(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject(kr.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},a=pP(n,t);return{installationEntry:t,registrationPromise:a}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:gP(n)}:{installationEntry:e}}async function pP(n,e){try{const t=await sP(n,e);return Vh(n.appConfig,t)}catch(t){throw hA(t)&&t.customData.serverCode===409?await NA(n.appConfig):await Vh(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function gP(n){let e=await ZN(n.appConfig);for(;e.registrationStatus===1;)await yA(100),e=await ZN(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:a}=await Mv(n);return a||t}return e}function ZN(n){return pf(n,e=>{if(!e)throw kr.create("installation-not-found");return TA(e)})}function TA(n){return vP(n)?{fid:n.fid,registrationStatus:0}:n}function vP(n){return n.registrationStatus===1&&n.registrationTime+cA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yP({appConfig:n,heartbeatServiceProvider:e},t){const a=_P(n,t),o=eP(n,t),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={installation:{sdkVersion:uA,appId:n.appId}},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await vA(()=>fetch(a,f));if(p.ok){const v=await p.json();return mA(v)}else throw await pA("Generate Auth Token",p)}function _P(n,{fid:e}){return`${fA(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pv(n,e=!1){let t;const a=await pf(n.appConfig,c=>{if(!xA(c))throw kr.create("not-registered");const d=c.authToken;if(!e&&NP(d))return c;if(d.requestStatus===1)return t=EP(n,e),c;{if(!navigator.onLine)throw kr.create("app-offline");const f=xP(c);return t=bP(n,f),f}});return t?await t:a.authToken}async function EP(n,e){let t=await JN(n.appConfig);for(;t.authToken.requestStatus===1;)await yA(100),t=await JN(n.appConfig);const a=t.authToken;return a.requestStatus===0?Pv(n,e):a}function JN(n){return pf(n,e=>{if(!xA(e))throw kr.create("not-registered");const t=e.authToken;return AP(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function bP(n,e){try{const t=await yP(n,e),a=Object.assign(Object.assign({},e),{authToken:t});return await Vh(n.appConfig,a),t}catch(t){if(hA(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await NA(n.appConfig);else{const a=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Vh(n.appConfig,a)}throw t}}function xA(n){return n!==void 0&&n.registrationStatus===2}function NP(n){return n.requestStatus===2&&!TP(n)}function TP(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+XM}function xP(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function AP(n){return n.requestStatus===1&&n.requestTime+cA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CP(n){const e=n,{installationEntry:t,registrationPromise:a}=await Mv(e);return a?a.catch(console.error):Pv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jP(n,e=!1){const t=n;return await SP(t),(await Pv(t,e)).token}async function SP(n){const{registrationPromise:e}=await Mv(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(n){if(!n||!n.options)throw Vp("App Configuration");if(!n.name)throw Vp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Vp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Vp(n){return kr.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA="installations",IP="installations-internal",RP=n=>{const e=n.getProvider("app").getImmediate(),t=wP(e),a=ka(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:a,_delete:()=>Promise.resolve()}},DP=n=>{const e=n.getProvider("app").getImmediate(),t=ka(e,AA).getImmediate();return{getId:()=>CP(t),getToken:o=>jP(t,o)}};function OP(){ds(new Xn(AA,RP,"PUBLIC")),ds(new Xn(IP,DP,"PRIVATE"))}OP();En(lA,Dv);En(lA,Dv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh="analytics",MP="firebase_id",PP="origin",kP=60*1e3,LP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",kv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pn=new iu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Qn=new ki("analytics","Analytics",VP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UP(n){if(!n.startsWith(kv)){const e=Qn.create("invalid-gtag-resource",{gtagURL:n});return Pn.warn(e.message),""}return n}function CA(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function FP(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function HP(n,e){const t=FP("firebase-js-sdk-policy",{createScriptURL:UP}),a=document.createElement("script"),o=`${kv}?l=${n}&id=${e}`;a.src=t?t?.createScriptURL(o):o,a.async=!0,document.head.appendChild(a)}function qP(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function BP(n,e,t,a,o,c){const d=a[o];try{if(d)await e[d];else{const p=(await CA(t)).find(v=>v.measurementId===o);p&&await e[p.appId]}}catch(f){Pn.error(f)}n("config",o,c)}async function zP(n,e,t,a,o){try{let c=[];if(o&&o.send_to){let d=o.send_to;Array.isArray(d)||(d=[d]);const f=await CA(t);for(const p of d){const v=f.find(N=>N.measurementId===p),_=v&&e[v.appId];if(_)c.push(_);else{c=[];break}}}c.length===0&&(c=Object.values(e)),await Promise.all(c),n("event",a,o||{})}catch(c){Pn.error(c)}}function GP(n,e,t,a){async function o(c,...d){try{if(c==="event"){const[f,p]=d;await zP(n,e,t,f,p)}else if(c==="config"){const[f,p]=d;await BP(n,e,t,a,f,p)}else if(c==="consent"){const[f,p]=d;n("consent",f,p)}else if(c==="get"){const[f,p,v]=d;n("get",f,p,v)}else if(c==="set"){const[f]=d;n("set",f)}else n(c,...d)}catch(f){Pn.error(f)}}return o}function $P(n,e,t,a,o){let c=function(...d){window[a].push(arguments)};return window[o]&&typeof window[o]=="function"&&(c=window[o]),window[o]=GP(c,n,e,t),{gtagCore:c,wrappedGtag:window[o]}}function YP(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(kv)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KP=30,QP=1e3;class XP{constructor(e={},t=QP){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const jA=new XP;function WP(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function ZP(n){var e;const{appId:t,apiKey:a}=n,o={method:"GET",headers:WP(a)},c=LP.replace("{app-id}",t),d=await fetch(c,o);if(d.status!==200&&d.status!==304){let f="";try{const p=await d.json();!((e=p.error)===null||e===void 0)&&e.message&&(f=p.error.message)}catch{}throw Qn.create("config-fetch-failed",{httpStatus:d.status,responseMessage:f})}return d.json()}async function JP(n,e=jA,t){const{appId:a,apiKey:o,measurementId:c}=n.options;if(!a)throw Qn.create("no-app-id");if(!o){if(c)return{measurementId:c,appId:a};throw Qn.create("no-api-key")}const d=e.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},f=new nk;return setTimeout(async()=>{f.abort()},kP),SA({appId:a,apiKey:o,measurementId:c},d,f,e)}async function SA(n,{throttleEndTimeMillis:e,backoffCount:t},a,o=jA){var c;const{appId:d,measurementId:f}=n;try{await ek(a,e)}catch(p){if(f)return Pn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:d,measurementId:f};throw p}try{const p=await ZP(n);return o.deleteThrottleMetadata(d),p}catch(p){const v=p;if(!tk(v)){if(o.deleteThrottleMetadata(d),f)return Pn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${v?.message}]`),{appId:d,measurementId:f};throw p}const _=Number((c=v?.customData)===null||c===void 0?void 0:c.httpStatus)===503?yb(t,o.intervalMillis,KP):yb(t,o.intervalMillis),N={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return o.setThrottleMetadata(d,N),Pn.debug(`Calling attemptFetch again in ${_} millis`),SA(n,N,a,o)}}function ek(n,e){return new Promise((t,a)=>{const o=Math.max(e-Date.now(),0),c=setTimeout(t,o);n.addEventListener(()=>{clearTimeout(c),a(Qn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function tk(n){if(!(n instanceof fs)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class nk{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function sk(n,e,t,a,o){if(o&&o.global){n("event",t,a);return}else{const c=await e,d=Object.assign(Object.assign({},a),{send_to:c});n("event",t,d)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ak(){if(Sg())try{await wg()}catch(n){return Pn.warn(Qn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Pn.warn(Qn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function ik(n,e,t,a,o,c,d){var f;const p=JP(n);p.then(j=>{t[j.measurementId]=j.appId,n.options.measurementId&&j.measurementId!==n.options.measurementId&&Pn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${j.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(j=>Pn.error(j)),e.push(p);const v=ak().then(j=>{if(j)return a.getId()}),[_,N]=await Promise.all([p,v]);YP(c)||HP(c,_.measurementId),o("js",new Date);const C=(f=d?.config)!==null&&f!==void 0?f:{};return C[PP]="firebase",C.update=!0,N!=null&&(C[MP]=N),o("config",_.measurementId,C),_.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e){this.app=e}_delete(){return delete qc[this.app.options.appId],Promise.resolve()}}let qc={},eT=[];const tT={};let Up="dataLayer",ok="gtag",nT,wA,sT=!1;function lk(){const n=[];if(VT()&&n.push("This is a browser extension environment."),UT()||n.push("Cookies are not available."),n.length>0){const e=n.map((a,o)=>`(${o+1}) ${a}`).join(" "),t=Qn.create("invalid-analytics-context",{errorInfo:e});Pn.warn(t.message)}}function ck(n,e,t){lk();const a=n.options.appId;if(!a)throw Qn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Pn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Qn.create("no-api-key");if(qc[a]!=null)throw Qn.create("already-exists",{id:a});if(!sT){qP(Up);const{wrappedGtag:c,gtagCore:d}=$P(qc,eT,tT,Up,ok);wA=c,nT=d,sT=!0}return qc[a]=ik(n,eT,tT,e,nT,Up,t),new rk(n)}function uk(n=ru()){n=vt(n);const e=ka(n,Uh);return e.isInitialized()?e.getImmediate():dk(n)}function dk(n,e={}){const t=ka(n,Uh);if(t.isInitialized()){const o=t.getImmediate();if(Ci(e,t.getOptions()))return o;throw Qn.create("already-initialized")}return t.initialize({options:e})}function hk(n,e,t,a){n=vt(n),sk(wA,qc[n.app.options.appId],e,t,a).catch(o=>Pn.error(o))}const aT="@firebase/analytics",iT="0.10.16";function fk(){ds(new Xn(Uh,(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return ck(a,o,t)},"PUBLIC")),ds(new Xn("analytics-internal",n,"PRIVATE")),En(aT,iT),En(aT,iT,"esm2017");function n(e){try{const t=e.getProvider(Uh).getImmediate();return{logEvent:(a,o,c)=>hk(t,a,o,c)}}catch(t){throw Qn.create("interop-component-reg-failed",{reason:t})}}}fk();var Eg,rT,gf=function(){var n=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(n&&n.responseStart>0&&n.responseStart<performance.now())return n},IA=function(n){if(document.readyState==="loading")return"loading";var e=gf();if(e){if(n<e.domInteractive)return"loading";if(e.domContentLoadedEventStart===0||n<e.domContentLoadedEventStart)return"dom-interactive";if(e.domComplete===0||n<e.domComplete)return"dom-content-loaded"}return"complete"},mk=function(n){var e=n.nodeName;return n.nodeType===1?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},Lv=function(n,e){var t="";try{for(;n&&n.nodeType!==9;){var a=n,o=a.id?"#"+a.id:mk(a)+(a.classList&&a.classList.value&&a.classList.value.trim()&&a.classList.value.trim().length?"."+a.classList.value.trim().replace(/\s+/g,"."):"");if(t.length+o.length>(e||100)-1)return t||o;if(t=t?o+">"+t:o,a.id)break;n=a.parentNode}}catch{}return t},RA=-1,pk=function(){return RA},bu=function(n){addEventListener("pageshow",function(e){e.persisted&&(RA=e.timeStamp,n(e))},!0)},Vv=function(){var n=gf();return n&&n.activationStart||0},Oi=function(n,e){var t=gf(),a="navigate";return pk()>=0?a="back-forward-cache":t&&(document.prerendering||Vv()>0?a="prerender":document.wasDiscarded?a="restore":t.type&&(a=t.type.replace(/_/g,"-"))),{name:n,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:a}},vl=function(n,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(n)){var a=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return a.observe(Object.assign({type:n,buffered:!0},t||{})),a}}catch{}},Mi=function(n,e,t,a){var o,c;return function(d){e.value>=0&&(d||a)&&((c=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=c,e.rating=function(f,p){return f>p[1]?"poor":f>p[0]?"needs-improvement":"good"}(e.value,t),n(e))}},Uv=function(n){requestAnimationFrame(function(){return requestAnimationFrame(function(){return n()})})},vf=function(n){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&n()})},Fv=function(n){var e=!1;return function(){e||(n(),e=!0)}},zo=-1,oT=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},Fh=function(n){document.visibilityState==="hidden"&&zo>-1&&(zo=n.type==="visibilitychange"?n.timeStamp:0,gk())},lT=function(){addEventListener("visibilitychange",Fh,!0),addEventListener("prerenderingchange",Fh,!0)},gk=function(){removeEventListener("visibilitychange",Fh,!0),removeEventListener("prerenderingchange",Fh,!0)},DA=function(){return zo<0&&(zo=oT(),lT(),bu(function(){setTimeout(function(){zo=oT(),lT()},0)})),{get firstHiddenTime(){return zo}}},Hv=function(n){document.prerendering?addEventListener("prerenderingchange",function(){return n()},!0):n()},cT=[1800,3e3],vk=function(n,e){e=e||{},Hv(function(){var t,a=DA(),o=Oi("FCP"),c=vl("paint",function(d){d.forEach(function(f){f.name==="first-contentful-paint"&&(c.disconnect(),f.startTime<a.firstHiddenTime&&(o.value=Math.max(f.startTime-Vv(),0),o.entries.push(f),t(!0)))})});c&&(t=Mi(n,o,cT,e.reportAllChanges),bu(function(d){o=Oi("FCP"),t=Mi(n,o,cT,e.reportAllChanges),Uv(function(){o.value=performance.now()-d.timeStamp,t(!0)})}))})},uT=[.1,.25],yk=function(n,e){(function(t,a){a=a||{},vk(Fv(function(){var o,c=Oi("CLS",0),d=0,f=[],p=function(_){_.forEach(function(N){if(!N.hadRecentInput){var C=f[0],j=f[f.length-1];d&&N.startTime-j.startTime<1e3&&N.startTime-C.startTime<5e3?(d+=N.value,f.push(N)):(d=N.value,f=[N])}}),d>c.value&&(c.value=d,c.entries=f,o())},v=vl("layout-shift",p);v&&(o=Mi(t,c,uT,a.reportAllChanges),vf(function(){p(v.takeRecords()),o(!0)}),bu(function(){d=0,c=Oi("CLS",0),o=Mi(t,c,uT,a.reportAllChanges),Uv(function(){return o()})}),setTimeout(o,0))}))})(function(t){var a=function(o){var c,d={};if(o.entries.length){var f=o.entries.reduce(function(v,_){return v&&v.value>_.value?v:_});if(f&&f.sources&&f.sources.length){var p=(c=f.sources).find(function(v){return v.node&&v.node.nodeType===1})||c[0];p&&(d={largestShiftTarget:Lv(p.node),largestShiftTime:f.startTime,largestShiftValue:f.value,largestShiftSource:p,largestShiftEntry:f,loadState:IA(f.startTime)})}}return Object.assign(o,{attribution:d})}(t);n(a)},e)},OA=0,Fp=1/0,eh=0,_k=function(n){n.forEach(function(e){e.interactionId&&(Fp=Math.min(Fp,e.interactionId),eh=Math.max(eh,e.interactionId),OA=eh?(eh-Fp)/7+1:0)})},MA=function(){return Eg?OA:performance.interactionCount||0},Ek=function(){"interactionCount"in performance||Eg||(Eg=vl("event",_k,{type:"event",buffered:!0,durationThreshold:0}))},bs=[],Bc=new Map,PA=0,bk=function(){var n=Math.min(bs.length-1,Math.floor((MA()-PA)/50));return bs[n]},kA=[],Nk=function(n){if(kA.forEach(function(o){return o(n)}),n.interactionId||n.entryType==="first-input"){var e=bs[bs.length-1],t=Bc.get(n.interactionId);if(t||bs.length<10||n.duration>e.latency){if(t)n.duration>t.latency?(t.entries=[n],t.latency=n.duration):n.duration===t.latency&&n.startTime===t.entries[0].startTime&&t.entries.push(n);else{var a={id:n.interactionId,latency:n.duration,entries:[n]};Bc.set(a.id,a),bs.push(a)}bs.sort(function(o,c){return c.latency-o.latency}),bs.length>10&&bs.splice(10).forEach(function(o){return Bc.delete(o.id)})}}},qv=function(n){var e=self.requestIdleCallback||self.setTimeout,t=-1;return n=Fv(n),document.visibilityState==="hidden"?n():(t=e(n),vf(n)),t},dT=[200,500],Tk=function(n,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},Hv(function(){var t;Ek();var a,o=Oi("INP"),c=function(f){qv(function(){f.forEach(Nk);var p=bk();p&&p.latency!==o.value&&(o.value=p.latency,o.entries=p.entries,a())})},d=vl("event",c,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});a=Mi(n,o,dT,e.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),vf(function(){c(d.takeRecords()),a(!0)}),bu(function(){PA=MA(),bs.length=0,Bc.clear(),o=Oi("INP"),a=Mi(n,o,dT,e.reportAllChanges)}))}))},Wo=[],Ei=[],bg=0,Bv=new WeakMap,Zo=new Map,Ng=-1,xk=function(n){Wo=Wo.concat(n),LA()},LA=function(){Ng<0&&(Ng=qv(Ak))},Ak=function(){Zo.size>10&&Zo.forEach(function(d,f){Bc.has(f)||Zo.delete(f)});var n=bs.map(function(d){return Bv.get(d.entries[0])}),e=Ei.length-50;Ei=Ei.filter(function(d,f){return f>=e||n.includes(d)});for(var t=new Set,a=0;a<Ei.length;a++){var o=Ei[a];VA(o.startTime,o.processingEnd).forEach(function(d){t.add(d)})}var c=Wo.length-1-50;Wo=Wo.filter(function(d,f){return d.startTime>bg&&f>c||t.has(d)}),Ng=-1};kA.push(function(n){n.interactionId&&n.target&&!Zo.has(n.interactionId)&&Zo.set(n.interactionId,n.target)},function(n){var e,t=n.startTime+n.duration;bg=Math.max(bg,n.processingEnd);for(var a=Ei.length-1;a>=0;a--){var o=Ei[a];if(Math.abs(t-o.renderTime)<=8){(e=o).startTime=Math.min(n.startTime,e.startTime),e.processingStart=Math.min(n.processingStart,e.processingStart),e.processingEnd=Math.max(n.processingEnd,e.processingEnd),e.entries.push(n);break}}e||(e={startTime:n.startTime,processingStart:n.processingStart,processingEnd:n.processingEnd,renderTime:t,entries:[n]},Ei.push(e)),(n.interactionId||n.entryType==="first-input")&&Bv.set(n,e),LA()});var VA=function(n,e){for(var t,a=[],o=0;t=Wo[o];o++)if(!(t.startTime+t.duration<n)){if(t.startTime>e)break;a.push(t)}return a},Ck=function(n,e){rT||(rT=vl("long-animation-frame",xk)),Tk(function(t){var a=function(o){var c=o.entries[0],d=Bv.get(c),f=c.processingStart,p=d.processingEnd,v=d.entries.sort(function(x,V){return x.processingStart-V.processingStart}),_=VA(c.startTime,p),N=o.entries.find(function(x){return x.target}),C=N&&N.target||Zo.get(c.interactionId),j=[c.startTime+c.duration,p].concat(_.map(function(x){return x.startTime+x.duration})),b=Math.max.apply(Math,j),M={interactionTarget:Lv(C),interactionTargetElement:C,interactionType:c.name.startsWith("key")?"keyboard":"pointer",interactionTime:c.startTime,nextPaintTime:b,processedEventEntries:v,longAnimationFrameEntries:_,inputDelay:f-c.startTime,processingDuration:p-f,presentationDelay:Math.max(b-p,0),loadState:IA(c.startTime)};return Object.assign(o,{attribution:M})}(t);n(a)},e)},hT=[2500,4e3],Hp={},jk=function(n,e){(function(t,a){a=a||{},Hv(function(){var o,c=DA(),d=Oi("LCP"),f=function(_){a.reportAllChanges||(_=_.slice(-1)),_.forEach(function(N){N.startTime<c.firstHiddenTime&&(d.value=Math.max(N.startTime-Vv(),0),d.entries=[N],o())})},p=vl("largest-contentful-paint",f);if(p){o=Mi(t,d,hT,a.reportAllChanges);var v=Fv(function(){Hp[d.id]||(f(p.takeRecords()),p.disconnect(),Hp[d.id]=!0,o(!0))});["keydown","click"].forEach(function(_){addEventListener(_,function(){return qv(v)},{once:!0,capture:!0})}),vf(v),bu(function(_){d=Oi("LCP"),o=Mi(t,d,hT,a.reportAllChanges),Uv(function(){d.value=performance.now()-_.timeStamp,Hp[d.id]=!0,o(!0)})})}})})(function(t){var a=function(o){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:o.value};if(o.entries.length){var d=gf();if(d){var f=d.activationStart||0,p=o.entries[o.entries.length-1],v=p.url&&performance.getEntriesByType("resource").filter(function(b){return b.name===p.url})[0],_=Math.max(0,d.responseStart-f),N=Math.max(_,v?(v.requestStart||v.startTime)-f:0),C=Math.max(N,v?v.responseEnd-f:0),j=Math.max(C,p.startTime-f);c={element:Lv(p.element),timeToFirstByte:_,resourceLoadDelay:N-_,resourceLoadDuration:C-N,elementRenderDelay:j-C,navigationEntry:d,lcpEntry:p},p.url&&(c.url=p.url),v&&(c.lcpResourceEntry=v)}}return Object.assign(o,{attribution:c})}(t);n(a)},e)};const fT="@firebase/performance",Tg="0.7.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UA=Tg,Sk="FB-PERF-TRACE-START",wk="FB-PERF-TRACE-STOP",xg="FB-PERF-TRACE-MEASURE",FA="_wt_",HA="_fp",qA="_fcp",BA="_fid",zA="_lcp",Ik="lcp_element",GA="_inp",Rk="inp_interactionTarget",$A="_cls",Dk="cls_largestShiftTarget",YA="@firebase/performance/config",KA="@firebase/performance/configexpire",Ok="performance",QA="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},_n=new ki(Ok,QA,Mk);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi=new iu(QA);Pi.logLevel=Be.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qp,XA;class $t{constructor(e){if(this.window=e,!e)throw _n.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=jk,this.onINP=Ck,this.onCLS=yk}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,t,a){!this.performance||!this.performance.measure||this.performance.measure(e,t,a)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!UT()?(Pi.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):Sg()?!0:(Pi.info("IndexedDB is not supported by current browser"),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(o=>{for(const c of o.getEntries())t(c)}).observe({entryTypes:[e]})}static getInstance(){return qp===void 0&&(qp=new $t(XA)),qp}}function Pk(n){XA=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let WA;function kk(n){const e=n.getId();return e.then(t=>{WA=t}),e}function zv(){return WA}function Lk(n){const e=n.getToken();return e.then(t=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(n,e){const t=n.length-e.length;if(t<0||t>1)throw _n.create("invalid String merger input");const a=[];for(let o=0;o<n.length;o++)a.push(n.charAt(o)),e.length>o&&a.push(e.charAt(o));return a.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bp;class Yn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=mT("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=mT("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Bp===void 0&&(Bp=new Yn),Bp}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zc;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.VISIBLE=1]="VISIBLE",n[n.HIDDEN=2]="HIDDEN"})(zc||(zc={}));const Vk=["firebase_","google_","ga_"],Uk=new RegExp("^[a-zA-Z]\\w*$"),Fk=40,Hk=100;function qk(){const n=$t.getInstance().navigator;return n?.serviceWorker?n.serviceWorker.controller?2:3:1}function Bk(){switch($t.getInstance().document.visibilityState){case"visible":return zc.VISIBLE;case"hidden":return zc.HIDDEN;default:return zc.UNKNOWN}}function zk(){const e=$t.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function Gk(n){return n.length===0||n.length>Fk?!1:!Vk.some(t=>n.startsWith(t))&&!!n.match(Uk)}function $k(n){return n.length!==0&&n.length<=Hk}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.appId;if(!t)throw _n.create("no app id");return t}function Yk(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.projectId;if(!t)throw _n.create("no project id");return t}function Kk(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.apiKey;if(!t)throw _n.create("no api key");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qk="0.0.1",Es={loggingEnabled:!0},Xk="FIREBASE_INSTALLATIONS_AUTH";function Wk(n,e){const t=Zk();return t?(pT(t),Promise.resolve()):t2(n,e).then(pT).then(a=>Jk(a),()=>{})}function Zk(){const n=$t.getInstance().localStorage;if(!n)return;const e=n.getItem(KA);if(!e||!n2(e))return;const t=n.getItem(YA);if(t)try{return JSON.parse(t)}catch{return}}function Jk(n){const e=$t.getInstance().localStorage;!n||!e||(e.setItem(YA,JSON.stringify(n)),e.setItem(KA,String(Date.now()+Yn.getInstance().configTimeToLive*60*60*1e3)))}const e2="Could not fetch config, will use default configs";function t2(n,e){return Lk(n.installations).then(t=>{const a=Yk(n.app),o=Kk(n.app),c=`https://firebaseremoteconfig.googleapis.com/v1/projects/${a}/namespaces/fireperf:fetch?key=${o}`,d=new Request(c,{method:"POST",headers:{Authorization:`${Xk} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:ZA(n.app),app_version:UA,sdk_version:Qk})});return fetch(d).then(f=>{if(f.ok)return f.json();throw _n.create("RC response not ok")})}).catch(()=>{Pi.info(e2)})}function pT(n){if(!n)return n;const e=Yn.getInstance(),t=n.entries||{};return t.fpr_enabled!==void 0?e.loggingEnabled=String(t.fpr_enabled)==="true":e.loggingEnabled=Es.loggingEnabled,t.fpr_log_source?e.logSource=Number(t.fpr_log_source):Es.logSource&&(e.logSource=Es.logSource),t.fpr_log_endpoint_url?e.logEndPointUrl=t.fpr_log_endpoint_url:Es.logEndPointUrl&&(e.logEndPointUrl=Es.logEndPointUrl),t.fpr_log_transport_key?e.transportKey=t.fpr_log_transport_key:Es.transportKey&&(e.transportKey=Es.transportKey),t.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(t.fpr_vc_network_request_sampling_rate):Es.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=Es.networkRequestsSamplingRate),t.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(t.fpr_vc_trace_sampling_rate):Es.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=Es.tracesSamplingRate),e.logTraceAfterSampling=gT(e.tracesSamplingRate),e.logNetworkAfterSampling=gT(e.networkRequestsSamplingRate),n}function n2(n){return Number(n)>Date.now()}function gT(n){return Math.random()<=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gv=1,zp;function JA(n){return Gv=2,zp=zp||a2(n),zp}function s2(){return Gv===3}function a2(n){return i2().then(()=>kk(n.installations)).then(e=>Wk(n,e)).then(()=>vT(),()=>vT())}function i2(){const n=$t.getInstance().document;return new Promise(e=>{if(n&&n.readyState!=="complete"){const t=()=>{n.readyState==="complete"&&(n.removeEventListener("readystatechange",t),e())};n.addEventListener("readystatechange",t)}else e()})}function vT(){Gv=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC=10*1e3,r2=5.5*1e3,o2=1e3,tC=3;let hh=tC,Ir=[],yT=!1;function l2(){yT||($v(r2),yT=!0)}function $v(n){setTimeout(()=>{hh<=0||(Ir.length>0&&nC(),$v(eC))},n)}function nC(){const n=Ir.splice(0,o2),e=n.map(a=>({source_extension_json_proto3:a.message,event_time_ms:String(a.eventTime)})),t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Yn.getInstance().logSource,log_event:e};c2(t).then(()=>{hh=tC}).catch(()=>{Ir=[...n,...Ir],hh--,Pi.info(`Tries left: ${hh}.`),$v(eC)})}function c2(n){const e=Yn.getInstance().getFlTransportFullUrl(),t=JSON.stringify(n);return navigator.sendBeacon&&navigator.sendBeacon(e,t)?Promise.resolve():fetch(e,{method:"POST",body:t,keepalive:!0}).then()}function u2(n){if(!n.eventTime||!n.message)throw _n.create("invalid cc log");Ir=[...Ir,n]}function d2(n){return(...e)=>{const t=n(...e);u2({message:t,eventTime:Date.now()})}}function h2(){for(;Ir.length>0;)nC()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gc;function sC(n,e){Gc||(Gc={send:d2(p2),flush:h2}),Gc.send(n,e)}function th(n){const e=Yn.getInstance();!e.instrumentationEnabled&&n.isAuto||!e.dataCollectionEnabled&&!n.isAuto||$t.getInstance().requiredApisAvailable()&&(s2()?Gp(n):JA(n.performanceController).then(()=>Gp(n),()=>Gp(n)))}function f2(){Gc&&Gc.flush()}function Gp(n){if(!zv())return;const e=Yn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||sC(n,1)}function m2(n){const e=Yn.getInstance();if(!e.instrumentationEnabled)return;const t=n.url,a=e.logEndPointUrl.split("?")[0],o=e.flTransportEndpointUrl.split("?")[0];t===a||t===o||!e.loggingEnabled||!e.logNetworkAfterSampling||sC(n,0)}function p2(n,e){return e===0?g2(n):v2(n)}function g2(n){const e={url:n.url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},t={application_info:aC(n.performanceController.app),network_request_metric:e};return JSON.stringify(t)}function v2(n){const e={name:n.name,is_auto:n.isAuto,client_start_time_us:n.startTimeUs,duration_us:n.durationUs};Object.keys(n.counters).length!==0&&(e.counters=n.counters);const t=n.getAttributes();Object.keys(t).length!==0&&(e.custom_attributes=t);const a={application_info:aC(n.performanceController.app),trace_metric:e};return JSON.stringify(a)}function aC(n){return{google_app_id:ZA(n),app_instance_id:zv(),web_app_info:{sdk_version:UA,page_url:$t.getInstance().getUrl(),service_worker_status:qk(),visibility_state:Bk(),effective_connection_type:zk()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(n,e){const t=e;if(!t||t.responseStart===void 0)return;const a=$t.getInstance().getTimeOrigin(),o=Math.floor((t.startTime+a)*1e3),c=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,d=Math.floor((t.responseEnd-t.startTime)*1e3),f=t.name&&t.name.split("?")[0],p={performanceController:n,url:f,responsePayloadBytes:t.transferSize,startTimeUs:o,timeToResponseInitiatedUs:c,timeToResponseCompletedUs:d};m2(p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2=100,_2="_",E2=[HA,qA,BA,zA,$A,GA];function b2(n,e){return n.length===0||n.length>y2?!1:e&&e.startsWith(FA)&&E2.indexOf(n)>-1||!n.startsWith(_2)}function N2(n){const e=Math.floor(n);return e<n&&Pi.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,t,a=!1,o){this.performanceController=e,this.name=t,this.isAuto=a,this.state=1,this.customAttributes={},this.counters={},this.api=$t.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${Sk}-${this.randomId}-${this.name}`,this.traceStopMark=`${wk}-${this.randomId}-${this.name}`,this.traceMeasure=o||`${xg}-${this.randomId}-${this.name}`,o&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw _n.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw _n.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),th(this)}record(e,t,a){if(e<=0)throw _n.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw _n.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(t*1e3),this.startTimeUs=Math.floor(e*1e3),a&&a.attributes&&(this.customAttributes=Object.assign({},a.attributes)),a&&a.metrics)for(const o of Object.keys(a.metrics))isNaN(Number(a.metrics[o]))||(this.counters[o]=Math.floor(Number(a.metrics[o])));th(this)}incrementMetric(e,t=1){this.counters[e]===void 0?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(b2(e,this.name))this.counters[e]=N2(t??0);else throw _n.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const a=Gk(e),o=$k(t);if(a&&o){this.customAttributes[e]=t;return}if(!a)throw _n.create("invalid attribute name",{attributeName:e});if(!o)throw _n.create("invalid attribute value",{attributeValue:t})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(t.duration*1e3),this.startTimeUs=Math.floor((t.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,t,a,o,c){const d=$t.getInstance().getUrl();if(!d)return;const f=new su(e,FA+d,!0),p=Math.floor($t.getInstance().getTimeOrigin()*1e3);f.setStartTime(p),t&&t[0]&&(f.setDuration(Math.floor(t[0].duration*1e3)),f.putMetric("domInteractive",Math.floor(t[0].domInteractive*1e3)),f.putMetric("domContentLoadedEventEnd",Math.floor(t[0].domContentLoadedEventEnd*1e3)),f.putMetric("loadEventEnd",Math.floor(t[0].loadEventEnd*1e3)));const v="first-paint",_="first-contentful-paint";if(a){const N=a.find(j=>j.name===v);N&&N.startTime&&f.putMetric(HA,Math.floor(N.startTime*1e3));const C=a.find(j=>j.name===_);C&&C.startTime&&f.putMetric(qA,Math.floor(C.startTime*1e3)),c&&f.putMetric(BA,Math.floor(c*1e3))}this.addWebVitalMetric(f,zA,Ik,o.lcp),this.addWebVitalMetric(f,$A,Dk,o.cls),this.addWebVitalMetric(f,GA,Rk,o.inp),th(f),f2()}static addWebVitalMetric(e,t,a,o){o&&(e.putMetric(t,Math.floor(o.value*1e3)),o.elementAttribution&&e.putAttribute(a,o.elementAttribution))}static createUserTimingTrace(e,t){const a=new su(e,t,!1,t);th(a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fh={},ET=!1,iC;function bT(n){zv()&&(setTimeout(()=>x2(n),0),setTimeout(()=>T2(n),0),setTimeout(()=>A2(n),0))}function T2(n){const e=$t.getInstance(),t=e.getEntriesByType("resource");for(const a of t)_T(n,a);e.setupObserver("resource",a=>_T(n,a))}function x2(n){const e=$t.getInstance();"onpagehide"in window?e.document.addEventListener("pagehide",()=>$p(n)):e.document.addEventListener("unload",()=>$p(n)),e.document.addEventListener("visibilitychange",()=>{e.document.visibilityState==="hidden"&&$p(n)}),e.onFirstInputDelay&&e.onFirstInputDelay(t=>{iC=t}),e.onLCP(t=>{var a;fh.lcp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.element}}),e.onCLS(t=>{var a;fh.cls={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.largestShiftTarget}}),e.onINP(t=>{var a;fh.inp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.interactionTarget}})}function A2(n){const e=$t.getInstance(),t=e.getEntriesByType("measure");for(const a of t)NT(n,a);e.setupObserver("measure",a=>NT(n,a))}function NT(n,e){const t=e.name;t.substring(0,xg.length)!==xg&&su.createUserTimingTrace(n,t)}function $p(n){if(!ET){ET=!0;const e=$t.getInstance(),t=e.getEntriesByType("navigation"),a=e.getEntriesByType("paint");setTimeout(()=>{su.createOobTrace(n,t,a,fh,iC)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(e?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),e?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),$t.getInstance().requiredApisAvailable()?wg().then(t=>{t&&(l2(),JA(this).then(()=>bT(this),()=>bT(this)),this.initialized=!0)}).catch(t=>{Pi.info(`Environment doesn't support IndexedDB: ${t}`)}):Pi.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Yn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Yn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Yn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Yn.getInstance().dataCollectionEnabled}}const j2="[DEFAULT]";function S2(n=ru()){return n=vt(n),ka(n,"performance").getImmediate()}const w2=(n,{options:e})=>{const t=n.getProvider("app").getImmediate(),a=n.getProvider("installations-internal").getImmediate();if(t.name!==j2)throw _n.create("FB not default");if(typeof window>"u")throw _n.create("no window");Pk(window);const o=new C2(t,a);return o._init(e),o};function I2(){ds(new Xn("performance",w2,"PUBLIC")),En(fT,Tg),En(fT,Tg,"esm2017")}I2();const R2="AIzaSyCbU834quCY8hjSffRwljJLgZrcxK8i2F4",D2="1:851382130132:web:eaba38fab449f14fb5b241VITE_FIREBASE_APP_ID=1:851382130132:web:8c8c8c8c8c8c8c8c8c8c8c",O2={apiKey:R2,authDomain:"liquidacionapp-62962.firebaseapp.com",projectId:"liquidacionapp-62962",storageBucket:"liquidacionapp-62962.firebasestorage.app",messagingSenderId:"851382130132",appId:D2};let ko,Jo,Ne,M2,P2=null,k2=null;try{if(ko=BT(O2),Jo=o1(ko),Ne=oM(ko),M2=GM(ko),typeof window<"u"){try{P2=uk(ko)}catch(n){console.warn("⚠️ No se pudo inicializar Analytics:",n.message)}try{k2=S2(ko)}catch(n){console.warn("⚠️ No se pudo inicializar Performance:",n.message)}}console.log("✅ Firebase inicializado correctamente")}catch(n){throw console.error("❌ Error al inicializar Firebase:",n),new Error(`Error al inicializar Firebase: ${n.message}`)}const Ns={ADMIN:"admin",CONTADOR:"contador",CLIENTE:"cliente"},dt={MANAGE_INVENTORY:"canManageInventory",CREATE_MOVEMENTS:"canCreateMovements",VIEW_ALL_MOVEMENTS:"canViewAllMovements",MANAGE_VEHICLES:"canManageVehicles",MANAGE_MAINTENANCE:"canManageMaintenance",MANAGE_SUPPLIERS:"canManageSuppliers",VIEW_REPORTS:"canViewReports",EXPORT_REPORTS:"canExportReports",MODIFY_SETTINGS:"canModifySettings"},L2="contacto.evert@gmail.com",rC=n=>{switch(n){case Ns.ADMIN:return{[dt.MANAGE_INVENTORY]:!0,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!0,[dt.MANAGE_VEHICLES]:!0,[dt.MANAGE_MAINTENANCE]:!0,[dt.MANAGE_SUPPLIERS]:!0,[dt.VIEW_REPORTS]:!0,[dt.EXPORT_REPORTS]:!0,[dt.MODIFY_SETTINGS]:!0};case Ns.CONTADOR:return{[dt.MANAGE_INVENTORY]:!0,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!0,[dt.MANAGE_VEHICLES]:!1,[dt.MANAGE_MAINTENANCE]:!0,[dt.MANAGE_SUPPLIERS]:!1,[dt.VIEW_REPORTS]:!0,[dt.EXPORT_REPORTS]:!0,[dt.MODIFY_SETTINGS]:!1};case Ns.CLIENTE:default:return{[dt.MANAGE_INVENTORY]:!1,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!1,[dt.MANAGE_VEHICLES]:!1,[dt.MANAGE_MAINTENANCE]:!1,[dt.MANAGE_SUPPLIERS]:!1,[dt.VIEW_REPORTS]:!1,[dt.EXPORT_REPORTS]:!1,[dt.MODIFY_SETTINGS]:!1}}},V2=n=>n===L2?Ns.ADMIN:Ns.CLIENTE,rl=()=>"artifacts/1:851382130132:web:eaba38fab449f14fb5b241VITE_FIREBASE_APP_ID=1:851382130132:web:8c8c8c8c8c8c8c8c8c8c8c/invitations",U2=()=>{const n="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let e="";for(let t=0;t<8;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},F2=async(n,e)=>{try{const t=await yf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden crear invitaciones"};let a,o=!1,c=0;for(;!o&&c<10;){a=U2();const p=Re(Je(Ne,rl()),Ye("code","==",a));(await Vt(p)).empty&&(o=!0),c++}if(!o)return{success:!1,error:"No se pudo generar un código único"};const d=Ct(Je(Ne,rl())),f={code:a,targetEmail:n.email.toLowerCase(),targetRole:n.role||Ns.CLIENTE,targetName:n.name||"",status:"pending",appContext:"combustibles",expiresAt:new Date(Date.now()+7*24*60*60*1e3),createdAt:Rt(),createdBy:e,usedAt:null,usedBy:null};return await hf(d,f),console.log("🎫 Invitación creada:",{code:a,email:n.email,role:n.role}),{success:!0,invitation:{id:d.id,code:a,...f}}}catch(t){return console.error("Error creating invitation:",t),{success:!1,error:t.message}}},oC=async n=>{try{const e=Re(Je(Ne,rl()),Ye("code","==",n.toUpperCase()),Ye("status","==","pending")),t=await Vt(e);if(t.empty)return{success:!1,error:"Código de invitación inválido o expirado"};const a=t.docs[0],o=a.data(),c=new Date,d=o.expiresAt.toDate();return c>d?{success:!1,error:"Código de invitación expirado"}:{success:!0,invitation:{id:a.id,...o}}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},H2=async(n,e)=>{try{const t=Ct(Ne,rl(),n);return await Va(t,{status:"used",usedAt:Rt(),usedBy:e}),{success:!0}}catch(t){return console.error("Error marking invitation as used:",t),{success:!1,error:t.message}}},q2=async n=>{try{const e=await yf(n);if(!e.success||e.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden ver invitaciones"};const t=Re(Je(Ne,rl())),a=await Vt(t),o=[];return a.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,d)=>{const f=c.createdAt?.toDate()||new Date(0);return(d.createdAt?.toDate()||new Date(0))-f}),{success:!0,invitations:o}}catch(e){return console.error("Error getting invitations:",e),{success:!1,error:e.message}}},B2=async(n,e)=>{try{const t=await yf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden cancelar invitaciones"};const a=Ct(Ne,rl(),n);return await Va(a,{status:"cancelled",cancelledAt:Rt(),cancelledBy:e}),{success:!0}}catch(t){return console.error("Error cancelling invitation:",t),{success:!1,error:t.message}}},z2=n=>rC(n.targetRole),lC=async(n,e={})=>{const t=Ct(Ne,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241VITE_FIREBASE_APP_ID=1:851382130132:web:8c8c8c8c8c8c8c8c8c8c8c/users",n.uid);try{const a=await qr(t);if(a.exists())return{success:!0,userData:a.data(),isNewUser:!1};{const o=V2(n.email),c={uid:n.uid,email:n.email,displayName:n.displayName||"",photoURL:n.photoURL||"",role:o,emailVerified:n.emailVerified,combustiblesPermissions:rC(o),createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...e};return await hf(t,c),{success:!0,userData:c,isNewUser:!0}}}catch(a){return console.error("Error creating/updating user profile:",a),{success:!1,error:a.message}}},TT=async(n,e,t={})=>{const a=Ct(Ne,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241VITE_FIREBASE_APP_ID=1:851382130132:web:8c8c8c8c8c8c8c8c8c8c8c/users",n.uid);try{const o=await qr(a);if(o.exists())return{success:!0,userData:o.data(),isNewUser:!1};const c=await oC(e);if(!c.success)return c;const d=c.invitation;if(d.targetEmail!==n.email.toLowerCase())return{success:!1,error:"El código de invitación no corresponde a este email"};const f={uid:n.uid,email:n.email,displayName:n.displayName||d.targetName||"",photoURL:n.photoURL||"",role:d.targetRole,emailVerified:n.emailVerified,combustiblesPermissions:z2(d),invitationUsed:d.id,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...t};return await hf(a,f),await H2(d.id,n.uid),console.log("👤 Usuario creado con invitación:",{email:n.email,role:d.targetRole,invitationCode:d.code}),{success:!0,userData:f,isNewUser:!0}}catch(o){return console.error("Error creating user profile with invitation:",o),{success:!1,error:o.message}}},yf=async n=>{try{const e=Ct(Ne,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241VITE_FIREBASE_APP_ID=1:851382130132:web:8c8c8c8c8c8c8c8c8c8c8c/users",n),t=await qr(e);return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"Usuario no encontrado"}}catch(e){return console.error("Error fetching user profile:",e),{success:!1,error:e.message}}},cC=Y.createContext(),ea=()=>{const n=Y.useContext(cC);if(n===void 0)throw new Error("useCombustibles must be used within a CombustiblesProvider");return n},G2=({children:n})=>{const[e,t]=Y.useState(null),[a,o]=Y.useState(null),[c,d]=Y.useState(!0),[f,p]=Y.useState(null),[v,_]=Y.useState([]),[N,C]=Y.useState([]),[j,b]=Y.useState([]),[M,x]=Y.useState([]);Y.useEffect(()=>{const R=QI(Jo,async I=>{try{if(d(!0),I){t(I);let L=await yf(I.uid);L.success||(L=await lC(I,{provider:"existing_account",appContext:"combustibles"})),L.success?o(L.userData):p("Error cargando perfil de usuario")}else t(null),o(null),_([]),C([]),b([]),x([])}catch(L){console.error("Error en autenticación:",L),p("Error de autenticación")}finally{d(!1)}});return()=>R()},[]);const A={user:e,userProfile:a,loading:c,error:f,hasPermission:R=>a?.combustiblesPermissions?.[R]||!1,isAdmin:()=>a?.role==="admin",isCounterOrAbove:()=>a?.role==="admin"||a?.role==="contador",inventory:v,movements:N,vehicles:j,suppliers:M,setInventory:_,setMovements:C,setVehicles:b,setSuppliers:x,refreshInventory:async()=>{console.log("Refrescando inventario...")},refreshMovements:async()=>{console.log("Refrescando movimientos...")},refreshVehicles:async()=>{console.log("Refrescando vehículos...")},refreshSuppliers:async()=>{console.log("Refrescando proveedores...")}};return r.jsx(cC.Provider,{value:A,children:n})},$2=({children:n,currentView:e,onViewChange:t})=>{const{userProfile:a,isAdmin:o,isCounterOrAbove:c}=ea(),[d,f]=Y.useState(!1),p=[{id:"dashboard",name:"Dashboard",icon:"📊",description:"Vista general",requiredPermission:null},{id:"inventory",name:"Inventario",icon:"🛢️",description:"Gestión de stock",requiredPermission:"canManageInventory"},{id:"movements",name:"Movimientos",icon:"📈",description:"Entradas y salidas",requiredPermission:"canCreateMovements"},{id:"vehicles",name:"Vehículos",icon:"🚜",description:"Maquinaria forestal",requiredPermission:null},{id:"maintenance",name:"Mantenimiento",icon:"🔧",description:"Cambios de aceite y baterías",requiredPermission:"canManageMaintenance"},{id:"products",name:"Productos",icon:"🛢️",description:"Tipos de combustibles",requiredPermission:null},{id:"suppliers",name:"Proveedores",icon:"🏪",description:"Gestión de proveedores",requiredPermission:"canManageSuppliers"},{id:"reports",name:"Reportes",icon:"📋",description:"Análisis y reportes",requiredPermission:"canViewReports"},{id:"admin",name:"Administración",icon:"⚙️",description:"Gestión de usuarios",requiredPermission:"admin"}],v=j=>{t(j),f(!1)},_=j=>j?j==="admin"?o():a?.combustiblesPermissions?.[j]||!1:!0,N=p.filter(j=>_(j.requiredPermission)),C=async()=>{try{await XI(Jo)}catch(j){console.error("Error al cerrar sesión:",j)}};return r.jsxs("div",{className:"dashboard-layout",children:[r.jsx("header",{className:"dashboard-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"sidebar-toggle",onClick:()=>f(!d),children:"☰"}),r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:"⛽ Gestión de Combustibles"}),r.jsx("span",{className:"subtitle",children:"Forestech Colombia"})]}),r.jsxs("div",{className:"header-user",children:[r.jsxs("div",{className:"user-info",children:[r.jsx("span",{className:"user-name",children:a?.displayName||a?.email}),r.jsx("span",{className:"user-role",children:a?.role})]}),r.jsx("div",{className:"user-avatar",children:a?.photoURL?r.jsx("img",{src:a.photoURL,alt:"Avatar"}):r.jsx("div",{className:"avatar-placeholder",children:(a?.displayName||a?.email||"U").charAt(0).toUpperCase()})}),r.jsx("button",{className:"logout-button",onClick:C,title:"Cerrar sesión",children:"🚪"})]})]})}),r.jsxs("div",{className:"dashboard-body",children:[r.jsxs("aside",{className:`dashboard-sidebar ${d?"open":""}`,children:[r.jsx("nav",{className:"sidebar-nav",children:N.map(j=>r.jsxs("button",{className:`nav-item ${e===j.id?"active":""}`,onClick:()=>v(j.id),children:[r.jsx("span",{className:"nav-icon",children:j.icon}),r.jsxs("div",{className:"nav-content",children:[r.jsx("span",{className:"nav-name",children:j.name}),r.jsx("span",{className:"nav-description",children:j.description})]})]},j.id))}),r.jsx("div",{className:"sidebar-footer",children:r.jsxs("div",{className:"user-permissions",children:[r.jsx("h4",{children:"Permisos Activos:"}),r.jsxs("div",{className:"permission-list",children:[o()&&r.jsx("span",{className:"permission admin",children:"👑 Administrador"}),c()&&r.jsx("span",{className:"permission counter",children:"📊 Gestión Operativa"}),_("canManageInventory")&&r.jsx("span",{className:"permission",children:"🛢️ Inventario"}),_("canManageVehicles")&&r.jsx("span",{className:"permission",children:"🚜 Vehículos"})]})]})})]}),r.jsx("main",{className:"dashboard-main",children:r.jsx("div",{className:"main-content",children:n})})]}),d&&r.jsx("div",{className:"sidebar-overlay",onClick:()=>f(!1)})]})},Y2="modulepreload",K2=function(n){return"/combustibles/"+n},xT={},uC=function(e,t,a){let o=Promise.resolve();if(t&&t.length>0){let v=function(_){return Promise.all(_.map(N=>Promise.resolve(N).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};var d=v;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");o=v(t.map(_=>{if(_=K2(_),_ in xT)return;xT[_]=!0;const N=_.endsWith(".css"),C=N?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${C}`))return;const j=document.createElement("link");if(j.rel=N?"stylesheet":Y2,N||(j.as="script"),j.crossOrigin="",j.href=_,p&&j.setAttribute("nonce",p),document.head.appendChild(j),N)return new Promise((b,M)=>{j.addEventListener("load",b),j.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${_}`)))})}))}function c(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return o.then(f=>{for(const p of f||[])p.status==="rejected"&&c(p.reason);return e().catch(c)})},jn={DIESEL:"diesel",GASOLINE:"gasoline",ACPM:"acpm",LUBRICANTS:"lubricants",TWO_STROKE:"two_stroke",MIXED:"mixed"},ol={[jn.DIESEL]:{name:"Diésel",description:"Combustible para maquinaria pesada",unit:"galones",category:"Combustible",color:"#fbbf24",icon:"🚛",density:.85,priceUnit:"COP/galón"},[jn.GASOLINE]:{name:"Gasolina",description:"Combustible para vehículos livianos",unit:"galones",category:"Combustible",color:"#ef4444",icon:"⛽",density:.75,priceUnit:"COP/galón"},[jn.ACPM]:{name:"ACPM",description:"Aceite Combustible Para Motor",unit:"galones",category:"Combustible",color:"#8b5cf6",icon:"🚜",density:.85,priceUnit:"COP/galón"},[jn.LUBRICANTS]:{name:"Lubricantes",description:"Aceites y lubricantes para mantenimiento",unit:"litros",category:"Mantenimiento",color:"#06b6d4",icon:"🛢️",density:.9,priceUnit:"COP/litro"},[jn.TWO_STROKE]:{name:"Mezcla 2T",description:"Mezcla para motores de 2 tiempos (motosierras)",unit:"litros",category:"Especializado",color:"#10b981",icon:"🪚",density:.78,priceUnit:"COP/litro"},[jn.MIXED]:{name:"Mixto",description:"Compatible con múltiples tipos de combustible",unit:"galones",category:"Flexible",color:"#64748b",icon:"🔄",density:.8,priceUnit:"COP/galón"}},Cn={CRITICAL:"critical",LOW:"low",MEDIUM:"medium",HIGH:"high",FULL:"full"},Go={[Cn.CRITICAL]:{label:"Crítico",color:"#dc2626",icon:"🚨",threshold:.1},[Cn.LOW]:{label:"Bajo",color:"#ea580c",icon:"⚠️",threshold:.25},[Cn.MEDIUM]:{label:"Medio",color:"#ca8a04",icon:"📊",threshold:.5},[Cn.HIGH]:{label:"Alto",color:"#16a34a",icon:"✅",threshold:.75},[Cn.FULL]:{label:"Completo",color:"#059669",icon:"🟢",threshold:1}},dC=(n,e)=>{if(e===0)return Cn.CRITICAL;const t=n/e;return t<Go[Cn.CRITICAL].threshold?Cn.CRITICAL:t<Go[Cn.LOW].threshold?Cn.LOW:t<Go[Cn.MEDIUM].threshold?Cn.MEDIUM:t<Go[Cn.HIGH].threshold?Cn.HIGH:Cn.FULL},ll="combustibles_inventory",Q2=async(n,e)=>{try{const t=ol[n.fuelType];if(!t)return{success:!1,error:"Tipo de combustible no válido"};const a=Re(Je(Ne,ll),Ye("fuelType","==",n.fuelType),Ye("location","==",n.location));if(!(await Vt(a)).empty)return{success:!1,error:`Ya existe ${t.name} en ${n.location}`};const c={fuelType:n.fuelType,name:t.name,description:n.description||t.description,currentStock:Number(n.currentStock)||0,maxCapacity:Number(n.maxCapacity),minThreshold:Number(n.minThreshold)||n.maxCapacity*.15,unit:t.unit,location:n.location,pricePerUnit:Number(n.pricePerUnit)||0,supplier:n.supplier||"",status:n.status||"active",createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await Eu(Je(Ne,ll),c)).id,...c},message:`${t.name} agregado al inventario exitosamente`}}catch(t){return console.error("Error creating inventory item:",t),{success:!1,error:t.message}}},hC=async()=>{try{const n=Re(Je(Ne,ll),Wn("fuelType","asc")),e=await Vt(n),t=[];return e.forEach(a=>{const o=a.data();t.push({id:a.id,...o,stockLevel:dC(o.currentStock,o.maxCapacity),stockPercentage:Math.round(o.currentStock/o.maxCapacity*100),needsRestock:o.currentStock<=o.minThreshold})}),{success:!0,data:t}}catch(n){return console.error("Error fetching inventory items:",n),{success:!1,error:n.message}}},X2=async(n,e,t)=>{try{const a=Ct(Ne,ll,n);if(!(await qr(a)).exists())return{success:!1,error:"Item no encontrado"};const c={...e,lastUpdated:new Date,updatedBy:t};return delete c.id,delete c.createdAt,delete c.createdBy,await Va(a,c),{success:!0,message:"Item actualizado exitosamente",data:{id:n,...c}}}catch(a){return console.error("Error updating inventory item:",a),{success:!1,error:a.message}}},W2=async n=>{try{const e=Ct(Ne,ll,n);return(await qr(e)).exists()?(await Rv(e),{success:!0,message:"Item eliminado exitosamente"}):{success:!1,error:"Item no encontrado"}}catch(e){return console.error("Error deleting inventory item:",e),{success:!1,error:e.message}}},fC=n=>{const e=Re(Je(Ne,ll),Wn("fuelType","asc"));return gl(e,t=>{const a=[];t.forEach(o=>{const c=o.data();a.push({id:o.id,...c,stockLevel:dC(c.currentStock,c.maxCapacity),stockPercentage:Math.round(c.currentStock/c.maxCapacity*100),needsRestock:c.currentStock<=c.minThreshold})}),n(a)},t=>{console.error("Error in inventory subscription:",t),n(null,t)})},Z2=async()=>{try{const n=await hC();if(!n.success)return n;const e=n.data,t={totalItems:e.length,activeItems:e.filter(a=>a.status==="active").length,lowStockItems:e.filter(a=>a.needsRestock).length,totalValue:e.reduce((a,o)=>a+o.currentStock*o.pricePerUnit,0),averageStockLevel:e.length>0?Math.round(e.reduce((a,o)=>a+o.stockPercentage,0)/e.length):0,byFuelType:{}};return e.forEach(a=>{t.byFuelType[a.fuelType]||(t.byFuelType[a.fuelType]={count:0,totalStock:0,totalCapacity:0,totalValue:0}),t.byFuelType[a.fuelType].count++,t.byFuelType[a.fuelType].totalStock+=a.currentStock,t.byFuelType[a.fuelType].totalCapacity+=a.maxCapacity,t.byFuelType[a.fuelType].totalValue+=a.currentStock*a.pricePerUnit}),{success:!0,data:t}}catch(n){return console.error("Error calculating inventory stats:",n),{success:!1,error:n.message}}},yl="combustibles_movements",AT="combustibles_inventory",Ee={ENTRADA:"entrada",SALIDA:"salida",TRANSFERENCIA:"transferencia",AJUSTE:"ajuste"},Ge={PENDIENTE:"pendiente",COMPLETADO:"completado",CANCELADO:"cancelado"},J2=async n=>{try{aL(n);const e={...n,createdAt:Rt(),updatedAt:Rt(),status:Ge.PENDIENTE,totalValue:pC(n),effectiveDate:n.effectiveDate||Rt()},t=await aA(Ne,async a=>{const o=Ct(Je(Ne,yl));return a.set(o,e),await gC(a,e,o.id),o.id});return console.log("✅ Movimiento creado exitosamente:",t),t}catch(e){throw console.error("❌ Error al crear movimiento:",e),new Error(`Error al crear movimiento: ${e.message}`)}},eL=async(n={})=>{try{let e=Je(Ne,yl);n.type&&(e=Re(e,Ye("type","==",n.type))),n.status&&(e=Re(e,Ye("status","==",n.status))),n.fuelType&&(e=Re(e,Ye("fuelType","==",n.fuelType))),n.vehicleId&&(e=Re(e,Ye("vehicleId","==",n.vehicleId))),e=Re(e,Wn("createdAt","desc"));const t=await Vt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,effectiveDate:o.data().effectiveDate?.toDate?.()||o.data().effectiveDate})}),a}catch(e){throw console.error("❌ Error al obtener movimientos:",e),new Error(`Error al obtener movimientos: ${e.message}`)}},tL=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=Ct(Ne,yl,n),t=await qr(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate?.()||t.data().createdAt,updatedAt:t.data().updatedAt?.toDate?.()||t.data().updatedAt,effectiveDate:t.data().effectiveDate?.toDate?.()||t.data().effectiveDate}:null}catch(e){throw console.error("❌ Error al obtener movimiento:",e),new Error(`Error al obtener movimiento: ${e.message}`)}},mC=async(n,e)=>{try{if(!n)throw new Error("ID de movimiento requerido");const t={...e,updatedAt:Rt(),...e.quantity||e.unitPrice?{totalValue:pC(e)}:{}},a=Ct(Ne,yl,n);await Va(a,t),console.log("✅ Movimiento actualizado exitosamente")}catch(t){throw console.error("❌ Error al actualizar movimiento:",t),new Error(`Error al actualizar movimiento: ${t.message}`)}},Yv=(n,e={})=>{try{let t=Je(Ne,yl);return e.type&&(t=Re(t,Ye("type","==",e.type))),e.status&&(t=Re(t,Ye("status","==",e.status))),t=Re(t,Wn("createdAt","desc")),gl(t,a=>{const o=[];a.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,effectiveDate:c.data().effectiveDate?.toDate?.()||c.data().effectiveDate})}),n(o)},a=>{console.error("❌ Error en suscripción de movimientos:",a),n([],a)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},nL=async n=>{try{const e=await tL(n);if(!e)throw new Error("Movimiento no encontrado");if(e.status!==Ge.PENDIENTE)throw new Error("Solo se pueden aprobar movimientos pendientes");await aA(Ne,async t=>{const a=Ct(Ne,yl,n);t.update(a,{status:Ge.COMPLETADO,approvedAt:Rt(),updatedAt:Rt()}),await gC(t,e,n)}),console.log("✅ Movimiento aprobado exitosamente")}catch(e){throw console.error("❌ Error al aprobar movimiento:",e),new Error(`Error al aprobar movimiento: ${e.message}`)}},sL=async(n={})=>{try{const e=await eL(n),t={totalMovements:e.length,byType:{},byStatus:{},byFuelType:{},totalValue:0,totalQuantity:0,averageValue:0,thisMonth:0,lastMonth:0,thisWeek:0},a=new Date,o=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()-1,1),d=new Date(a.setDate(a.getDate()-a.getDay()));return e.forEach(f=>{t.byType[f.type]=(t.byType[f.type]||0)+1,t.byStatus[f.status]=(t.byStatus[f.status]||0)+1,t.byFuelType[f.fuelType]=(t.byFuelType[f.fuelType]||0)+1,t.totalValue+=f.totalValue||0,t.totalQuantity+=f.quantity||0;const p=new Date(f.createdAt);p>=o&&t.thisMonth++,p>=c&&p<o&&t.lastMonth++,p>=d&&t.thisWeek++}),t.averageValue=t.totalMovements>0?t.totalValue/t.totalMovements:0,t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},aL=n=>{const e=["type","fuelType","quantity","unitPrice"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!Object.values(Ee).includes(n.type))throw new Error("Tipo de movimiento inválido");if(n.quantity<=0)throw new Error("La cantidad debe ser mayor a cero");if(n.unitPrice<0)throw new Error("El precio unitario no puede ser negativo");if(n.type===Ee.SALIDA&&!n.vehicleId)throw new Error("Las salidas deben tener un vehículo asociado");if(n.type===Ee.TRANSFERENCIA&&!n.destinationLocation)throw new Error("Las transferencias deben tener una ubicación destino")},pC=n=>(n.quantity||0)*(n.unitPrice||0),gC=async(n,e,t)=>{try{const a=Re(Je(Ne,AT),Ye("fuelType","==",e.fuelType),Ye("location","==",e.location||"principal")),o=await Vt(a);if(o.empty)throw new Error(`No se encontró inventario para ${e.fuelType} en ${e.location||"ubicación principal"}`);const c=o.docs[0],d=c.data(),f=Ct(Ne,AT,c.id);let p=d.currentStock;switch(e.type){case Ee.ENTRADA:p+=e.quantity;break;case Ee.SALIDA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la salida");break;case Ee.AJUSTE:p+=e.quantity,p<0&&(p=0);break;case Ee.TRANSFERENCIA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la transferencia");break}n.update(f,{currentStock:p,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:Rt()},updatedAt:Rt()})}catch(a){throw console.error("❌ Error al actualizar inventario:",a),a}},pi={CAMION:"camion",MOTOSIERRA:"motosierra",TRACTOR:"tractor",VOLQUETA:"volqueta"},pt={ACTIVO:"activo"},gt={DIESEL:"Diesel",GASOLINA:"Gasolina"},iL=[{vehicleId:"AL-001",name:"Apoyo Logístico",type:"apoyo_logistico",brand:"Forestech",model:"Logística",year:2023,fuelType:gt.DIESEL,fuelCapacity:80,enginePower:150,status:pt.ACTIVO,currentLocation:"Base Central",description:"Vehículo para apoyo logístico general",estimatedConsumptionPerHour:4.5},{vehicleId:"ASP-001",name:"Asperjadora",type:"asperjadora",brand:"Jacto",model:"PJ600",year:2022,fuelType:gt.GASOLINA,fuelCapacity:25,enginePower:80,status:pt.ACTIVO,currentLocation:"Sector Fumigación",description:"Asperjadora para control fitosanitario",estimatedConsumptionPerHour:2.8},{vehicleId:"MB-AUS-001",name:"Motobomba Austria-Casino",type:"motobomba",brand:"Honda",model:"WB30X",year:2021,fuelType:gt.GASOLINA,fuelCapacity:15,enginePower:120,status:pt.ACTIVO,currentLocation:"Campamento Austria-Casino",description:"Motobomba para sector Austria-Casino",estimatedConsumptionPerHour:3.2},{vehicleId:"CAM-AM-001",name:"Camioneta Toyota Amarilla",type:pi.CAMION,brand:"Toyota",model:"Hilux",year:2020,fuelType:gt.DIESEL,fuelCapacity:80,enginePower:150,status:pt.ACTIVO,currentLocation:"Área Administrativa",description:"Camioneta Toyota color amarillo para transporte",plateNumber:"FOR-001",estimatedConsumptionPerHour:5},{vehicleId:"CAM-AZ-001",name:"Camioneta Toyota Azul",type:pi.CAMION,brand:"Toyota",model:"Hilux",year:2019,fuelType:gt.DIESEL,fuelCapacity:80,enginePower:150,status:pt.ACTIVO,currentLocation:"Sector Norte",description:"Camioneta Toyota color azul para transporte",plateNumber:"FOR-002",estimatedConsumptionPerHour:5},{vehicleId:"CAM-GR-001",name:"Camioneta Toyota Gris",type:pi.CAMION,brand:"Toyota",model:"Hilux",year:2021,fuelType:gt.DIESEL,fuelCapacity:80,enginePower:150,status:pt.ACTIVO,currentLocation:"Sector Sur",description:"Camioneta Toyota color gris para transporte",plateNumber:"FOR-003",estimatedConsumptionPerHour:5},{vehicleId:"MB-ATA-001",name:"Motobomba Campamento Atabapo",type:"motobomba",brand:"Honda",model:"WB20X",year:2022,fuelType:gt.GASOLINA,fuelCapacity:12,enginePower:100,status:pt.ACTIVO,currentLocation:"Campamento Atabapo",description:"Motobomba para suministro de agua - Atabapo",estimatedConsumptionPerHour:2.8},{vehicleId:"MB-ILU-001",name:"Motobomba Campamento Ilusión",type:"motobomba",brand:"Honda",model:"WB20X",year:2022,fuelType:gt.GASOLINA,fuelCapacity:12,enginePower:100,status:pt.ACTIVO,currentLocation:"Campamento Ilusión",description:"Motobomba para suministro de agua - Ilusión",estimatedConsumptionPerHour:2.8},{vehicleId:"MB-VIV-001",name:"Motobomba Riego Vivero",type:"motobomba",brand:"Honda",model:"WB15X",year:2023,fuelType:gt.GASOLINA,fuelCapacity:10,enginePower:80,status:pt.ACTIVO,currentLocation:"Vivero Principal",description:"Motobomba dedicada al riego del vivero",estimatedConsumptionPerHour:2.4},{vehicleId:"MB-TER-001",name:"Motobomba Campamento Terquedad",type:"motobomba",brand:"Honda",model:"WB20X",year:2021,fuelType:gt.GASOLINA,fuelCapacity:12,enginePower:100,status:pt.ACTIVO,currentLocation:"Campamento Terquedad",description:"Motobomba para suministro de agua - Terquedad",estimatedConsumptionPerHour:2.8},{vehicleId:"MB-BAR-001",name:"Motobomba Campamento Barquereña",type:"motobomba",brand:"Honda",model:"WB30X",year:2022,fuelType:gt.GASOLINA,fuelCapacity:15,enginePower:120,status:pt.ACTIVO,currentLocation:"Campamento Barquereña",description:"Motobomba para suministro de agua - Barquereña",estimatedConsumptionPerHour:3.2},{vehicleId:"FUM-001",name:"Fumigadoras Motorizadas",type:"fumigadora",brand:"Stihl",model:"SR450",year:2022,fuelType:gt.GASOLINA,fuelCapacity:5,enginePower:45,status:pt.ACTIVO,currentLocation:"Almacén Fitosanitario",description:"Fumigadoras motorizadas para aplicación de productos",estimatedConsumptionPerHour:1.5},{vehicleId:"CQ-001",name:"Control Químico",type:"control_quimico",brand:"Jacto",model:"PJH",year:2023,fuelType:gt.GASOLINA,fuelCapacity:20,enginePower:60,status:pt.ACTIVO,currentLocation:"Sector Control",description:"Equipo especializado para control químico",estimatedConsumptionPerHour:2},{vehicleId:"GUA-001",name:"Guadañas",type:"guadana",brand:"Stihl",model:"FS250",year:2022,fuelType:gt.GASOLINA,fuelCapacity:2,enginePower:25,status:pt.ACTIVO,currentLocation:"Almacén Herramientas",description:"Guadañas para mantenimiento y limpieza",estimatedConsumptionPerHour:.8},{vehicleId:"HID-001",name:"Hidrolavadora",type:"hidrolavadora",brand:"Karcher",model:"HD7/18",year:2021,fuelType:gt.GASOLINA,fuelCapacity:8,enginePower:70,status:pt.ACTIVO,currentLocation:"Taller Principal",description:"Hidrolavadora para limpieza de equipos",estimatedConsumptionPerHour:2.2},{vehicleId:"MOT-HON-001",name:"Moto Honda XTZ 150",type:"motocicleta",brand:"Honda",model:"XTZ150",year:2020,fuelType:gt.GASOLINA,fuelCapacity:12,enginePower:15,status:pt.ACTIVO,currentLocation:"Base Central",description:"Motocicleta Honda para transporte rápido",plateNumber:"MOT-001",estimatedConsumptionPerHour:1.2},{vehicleId:"MOT-YAM-001",name:"Moto XTZ Yamaha 125",type:"motocicleta",brand:"Yamaha",model:"XTZ125",year:2021,fuelType:gt.GASOLINA,fuelCapacity:10,enginePower:12,status:pt.ACTIVO,currentLocation:"Sector Este",description:"Motocicleta Yamaha para supervisión",plateNumber:"MOT-002",estimatedConsumptionPerHour:1},{vehicleId:"MB-EST-001",name:"Motobomba Estacionaria",type:"motobomba",brand:"Honda",model:"WB40X",year:2022,fuelType:gt.DIESEL,fuelCapacity:25,enginePower:200,status:pt.ACTIVO,currentLocation:"Planta de Tratamiento",description:"Motobomba estacionaria de alta capacidad",estimatedConsumptionPerHour:4.8},{vehicleId:"MS-001",name:"Motosierra",type:pi.MOTOSIERRA,brand:"Stihl",model:"MS361",year:2023,fuelType:gt.GASOLINA,fuelCapacity:1.5,enginePower:35,status:pt.ACTIVO,currentLocation:"Almacén Forestal",description:"Motosierra profesional para actividades forestales",estimatedConsumptionPerHour:1.2},{vehicleId:"PE-001",name:"Planta Eléctrica",type:"planta_electrica",brand:"Caterpillar",model:"C15",year:2020,fuelType:gt.DIESEL,fuelCapacity:200,enginePower:400,status:pt.ACTIVO,currentLocation:"Subestación Principal",description:"Planta eléctrica de respaldo principal",estimatedConsumptionPerHour:12},{vehicleId:"CRH-001",name:"Control Rodamiento Hormigas",type:"control_hormigas",brand:"Forestech",model:"CRH-Pro",year:2023,fuelType:gt.GASOLINA,fuelCapacity:15,enginePower:50,status:pt.ACTIVO,currentLocation:"Sector Protección",description:"Equipo especializado para control de hormigas cortadoras",estimatedConsumptionPerHour:1.8},{vehicleId:"TR1",name:"Tractor TR1",type:pi.TRACTOR,brand:"John Deere",model:"6120M",year:2021,fuelType:gt.DIESEL,fuelCapacity:280,enginePower:120,status:pt.ACTIVO,currentLocation:"Sector Norte",description:"Tractor principal para trabajos pesados",estimatedConsumptionPerHour:8.5,hasHourMeter:!0,currentHours:1250,lastHourMeterReading:1250,lastHourMeterDate:new Date().toISOString()},{vehicleId:"TR2",name:"Tractor TR2",type:pi.TRACTOR,brand:"John Deere",model:"6130M",year:2022,fuelType:gt.DIESEL,fuelCapacity:280,enginePower:130,status:pt.ACTIVO,currentLocation:"Sector Central",description:"Tractor secundario para trabajos medianos",estimatedConsumptionPerHour:9,hasHourMeter:!0,currentHours:950,lastHourMeterReading:950,lastHourMeterDate:new Date().toISOString()},{vehicleId:"TR3",name:"Tractor TR3",type:pi.TRACTOR,brand:"John Deere",model:"6110M",year:2020,fuelType:gt.DIESEL,fuelCapacity:260,enginePower:110,status:pt.ACTIVO,currentLocation:"Sector Sur",description:"Tractor de apoyo para trabajos livianos",estimatedConsumptionPerHour:7.8,hasHourMeter:!0,currentHours:1580,lastHourMeterReading:1580,lastHourMeterDate:new Date().toISOString()},{vehicleId:"VOL-001",name:"Volqueta",type:pi.VOLQUETA,brand:"Chevrolet",model:"NPR",year:2019,fuelType:gt.DIESEL,fuelCapacity:120,enginePower:180,status:pt.ACTIVO,currentLocation:"Patio de Materiales",description:"Volqueta para transporte de materiales",plateNumber:"VOL-001",estimatedConsumptionPerHour:6.5}],rL=()=>iL.map(n=>({...n,createdAt:new Date,updatedAt:new Date,totalFuelConsumed:0,totalHoursWorked:n.hasHourMeter?n.currentHours:0,totalMovements:0,lastMovementDate:null})),Hh="combustibles_vehicles",ge={EXCAVADORA:"excavadora",BULLDOZER:"bulldozer",CARGADOR:"cargador",CAMION:"camion",GRUA:"grua",MOTOSIERRA:"motosierra",TRACTOR:"tractor",VOLQUETA:"volqueta",OTROS:"otros"},Oe={ACTIVO:"activo",MANTENIMIENTO:"mantenimiento",INACTIVO:"inactivo",REPARACION:"reparacion"},At={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},vC=async(n={})=>{try{await lL();let e=Je(Ne,Hh);n.type&&(e=Re(e,Ye("type","==",n.type))),n.status&&(e=Re(e,Ye("status","==",n.status))),n.fuelType&&(e=Re(e,Ye("fuelType","==",n.fuelType))),n.location&&(e=Re(e,Ye("currentLocation","==",n.location))),e=Re(e,Wn("vehicleId","asc"));const t=await Vt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,lastMovementDate:o.data().lastMovementDate?.toDate?.()||o.data().lastMovementDate,lastMaintenanceDate:o.data().lastMaintenanceDate?.toDate?.()||o.data().lastMaintenanceDate})}),a}catch(e){throw console.error("❌ Error al obtener vehículos:",e),new Error(`Error al obtener vehículos: ${e.message}`)}},yC=(n,e={})=>{try{let t=Je(Ne,Hh);return e.type&&(t=Re(t,Ye("type","==",e.type))),e.status&&(t=Re(t,Ye("status","==",e.status))),t=Re(t,Wn("vehicleId","asc")),gl(t,a=>{const o=[];a.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,lastMovementDate:c.data().lastMovementDate?.toDate?.()||c.data().lastMovementDate,lastMaintenanceDate:c.data().lastMaintenanceDate?.toDate?.()||c.data().lastMaintenanceDate})}),n(o)},a=>{console.error("❌ Error en suscripción de vehículos:",a),n([],a)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},oL=async(n={})=>{try{const e=await vC(n),t={totalVehicles:e.length,byType:{},byStatus:{},byFuelType:{},totalFuelConsumed:0,totalHoursWorked:0,averageConsumption:0,mostActiveVehicle:null,leastActiveVehicle:null};let a=0,o=1/0;return e.forEach(c=>{t.byType[c.type]=(t.byType[c.type]||0)+1,t.byStatus[c.status]=(t.byStatus[c.status]||0)+1,t.byFuelType[c.fuelType]=(t.byFuelType[c.fuelType]||0)+1,t.totalFuelConsumed+=c.totalFuelConsumed||0,t.totalHoursWorked+=c.totalHoursWorked||0;const d=c.totalMovements||0;d>a&&(a=d,t.mostActiveVehicle=c),d<o&&d>0&&(o=d,t.leastActiveVehicle=c)}),t.totalHoursWorked>0&&(t.averageConsumption=t.totalFuelConsumed/t.totalHoursWorked),t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},lL=async()=>{try{const n=Re(Je(Ne,Hh),J0(1));if(!(await Vt(n)).empty)return console.log("✅ Vehículos ya existen en Firebase"),{success:!0,created:0,message:"Vehículos ya inicializados"};console.log("🚀 Inicializando vehículos predefinidos...");const t=rL();let a=0,o=0;for(const c of t)try{const d={...c,createdAt:Rt(),updatedAt:Rt(),totalFuelConsumed:0,totalHoursWorked:0,totalMovements:0,lastMovementDate:null};await Eu(Je(Ne,Hh),d),a++,console.log(`✅ Creado: ${c.vehicleId} - ${c.name}`)}catch(d){o++,console.error(`❌ Error creando ${c.vehicleId}:`,d.message)}return console.log(`🎉 Inicialización completada: ${a} creados, ${o} errores`),{success:o===0,created:a,errors:o,total:t.length}}catch(n){return console.error("❌ Error en inicialización de vehículos:",n),{success:!1,error:n.message}}},ja={ACPM:"ACPM",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},_C={[ja.ACPM]:{name:"ACPM",displayName:"ACPM 🚛",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"🚛",description:"Combustible diesel para vehículos pesados"},[ja.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina 🚗",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"🚗",description:"Gasolina corriente para vehículos livianos"},[ja.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidráulico 🔧",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"🔧",description:"Aceite hidráulico para sistemas de maquinaria"},[ja.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 🛢️",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"🛢️",description:"Aceite multigrado para motores"},[ja.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja 🟥",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"🟥",description:"Grasa lubricante multipropósito"},[ja.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ⚙️",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"⚙️",description:"Aceite para transmisiones y diferenciales"},[ja.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Líquido para Frenos 🛑",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"🛑",description:"Líquido de frenos DOT 3/4"},[ja.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga 🌿",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"🌿",description:"Mezcla de combustible para equipos menores"},[ja.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 🚜",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"🚜",description:"Aceite especializado para tractores"}},zs={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},CT=()=>Object.values(_C),jT="combustibles_products",cL=async()=>{try{console.log("🔄 Verificando productos existentes...");const n=Re(Je(Ne,jT),J0(1));if(!(await Vt(n)).empty){console.log("✅ Productos ya existen en Firebase");return}console.log("📦 Creando productos predefinidos...");const t=Object.values(_C).map(async o=>{const c={name:o.name,displayName:o.displayName,category:o.category,unit:o.unit,defaultPrice:o.defaultPrice,color:o.color,icon:o.icon,description:o.description,isActive:!0,createdAt:new Date,updatedAt:new Date,createdBy:"system-initialization"},d=Ct(Je(Ne,jT));return await hf(d,c),console.log(`✅ Producto creado: ${o.displayName}`),{id:d.id,...c}}),a=await Promise.all(t);return console.log(`🎉 ${a.length} productos inicializados correctamente`),a}catch(n){throw console.error("❌ Error inicializando productos:",n),n}},uL=async()=>{try{await cL()}catch(n){console.error("❌ Error en inicialización automática:",n)}},cl="combustibles_products",Yp=async n=>{try{const e={...n,createdAt:Rt(),updatedAt:Rt()},t=await Eu(Je(Ne,cl),e);return console.log("Product created with ID:",t.id),t.id}catch(e){throw console.error("Error creating product:",e),e}},dL=async(n,e)=>{try{const t=Ct(Ne,cl,n);await Va(t,{...e,updatedAt:Rt()}),console.log("Product updated successfully")}catch(t){throw console.error("Error updating product:",t),t}},hL=async n=>{try{await Rv(Ct(Ne,cl,n)),console.log("Product deleted successfully")}catch(e){throw console.error("Error deleting product:",e),e}},fL=async()=>{try{await uL(),console.log("🔍 Obteniendo productos activos...");const n=Re(Je(Ne,cl),Ye("isActive","==",!0),Wn("name")),t=(await Vt(n)).docs.map(a=>({id:a.id,...a.data()}));return console.log(`✅ Productos activos obtenidos: ${t.length}`),t}catch(n){if(console.error("❌ Error obteniendo productos activos:",n),n.code==="failed-precondition"||n.message.includes("index")){console.warn("⚠️ Índice no disponible, usando consulta alternativa...");try{const e=Re(Je(Ne,cl),Ye("isActive","==",!0)),o=(await Vt(e)).docs.map(c=>({id:c.id,...c.data()})).sort((c,d)=>(c.name||"").localeCompare(d.name||""));return console.log(`✅ Productos activos obtenidos (ordenamiento en cliente): ${o.length}`),o}catch(e){throw console.error("❌ Error en consulta alternativa:",e),e}}throw n}},EC=(n,e)=>{try{const t=Re(Je(Ne,cl),Wn("name"));return gl(t,a=>{const o=a.docs.map(c=>({id:c.id,...c.data()}));n(o)},a=>{console.error("Error in products subscription:",a),e(a)})}catch(t){return console.error("Error setting up products subscription:",t),e(t),()=>{}}},ST=()=>{const[n,e]=Y.useState({totalFuel:0,activeVehicles:0,pendingMovements:0,lowStockAlerts:0,totalProducts:0,totalMaintenance:0,upcomingMaintenance:0,overdueMaintenance:0}),[t,a]=Y.useState([]),[o,c]=Y.useState([]),[d,f]=Y.useState([]),[p,v]=Y.useState(!0),[_,N]=Y.useState(null),[C,j]=Y.useState({inventory:!1,movements:!1,vehicles:!1,products:!1,maintenance:!0});Y.useEffect(()=>{v(!0),N(null);const x=fC(K=>{const w=K.reduce((R,I)=>R+(I.currentStock||0),0),A=K.filter(R=>(R.currentStock||0)<(R.minThreshold||0)).length;e(R=>({...R,totalFuel:w,lowStockAlerts:A})),j(R=>({...R,inventory:!0}))}),V=Yv(K=>{const w=K.filter(R=>R.status==="pending").length,A=K.sort((R,I)=>I.date.toMillis()-R.date.toMillis()).slice(0,5);e(R=>({...R,pendingMovements:w})),a(A),j(R=>({...R,movements:!0}))},K=>{console.error("Error loading movements:",K),N("Error cargando movimientos")}),$=yC(K=>{const w=K.filter(A=>A.status==="active").length;e(A=>({...A,activeVehicles:w})),j(A=>({...A,vehicles:!0}))},K=>{console.error("Error loading vehicles:",K),N("Error cargando vehículos")}),O=EC(K=>{const w=K.length;c(K),e(A=>({...A,totalProducts:w})),j(A=>({...A,products:!0}))},K=>{console.error("Error loading products:",K),j(w=>({...w,products:!0}))}),U=async()=>{try{const{subscribeToMaintenance:K}=await uC(async()=>{const{subscribeToMaintenance:A}=await Promise.resolve().then(()=>RC);return{subscribeToMaintenance:A}},void 0);return K(A=>{const R=A.length,I=A.filter(P=>P.nextChangeDate?new Date(P.nextChangeDate)>new Date:!1).length,L=A.filter(P=>P.nextChangeDate?new Date(P.nextChangeDate)<new Date:!1).length;f(A),e(P=>({...P,totalMaintenance:R,upcomingMaintenance:I,overdueMaintenance:L})),j(P=>({...P,maintenance:!0}))},A=>{console.error("Error loading maintenance:",A),j(R=>({...R,maintenance:!0}))})}catch(K){return console.error("Error loading maintenance service:",K),j(w=>({...w,maintenance:!0})),()=>{}}};let q=()=>{};return setTimeout(async()=>{q=await U()},100),()=>{x(),V(),$(),O(),q()}},[]),Y.useEffect(()=>{Object.values(C).every(V=>V)&&v(!1)},[C]);const b=Y.useMemo(()=>x=>new Intl.NumberFormat("es-CO").format(x),[]),M=x=>{switch(x.type){case"entry":return`Entrada de ${x.quantity} ${x.unit} de ${x.fuelType}.`;case"exit":return`Salida de ${x.quantity} ${x.unit} para vehículo ${x.vehicleId||"N/A"}.`;case"transfer":return`Transferencia de ${x.quantity} ${x.unit} de ${x.fromLocation} a ${x.toLocation}.`;case"adjustment":return`Ajuste de inventario: ${x.quantity} ${x.unit} de ${x.fuelType}.`;default:return"Movimiento registrado."}};return p?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Cargando datos en tiempo real..."}),r.jsx("div",{className:"loading-spinner-container",children:r.jsx("div",{className:"loading-spinner"})})]}):_?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsxs("div",{className:"error-message",children:[r.jsxs("p",{children:["⚠️ ",_]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})]}):r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del estado de combustibles y maquinaria."}),r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon fuel-icon",children:"🛢️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Combustible Total"}),r.jsxs("h2",{children:[b(n.totalFuel)," gal"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon vehicle-icon",children:"🚜"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Vehículos Activos"}),r.jsx("h2",{children:b(n.activeVehicles)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon movement-icon",children:"🔄"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Movimientos Pendientes"}),r.jsx("h2",{children:b(n.pendingMovements)})]})]}),r.jsxs("div",{className:`stat-card ${n.lowStockAlerts>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon alert-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Alertas de Stock"}),r.jsx("h2",{children:b(n.lowStockAlerts)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon maintenance-icon",children:"🔧"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Mantenimientos"}),r.jsx("h2",{children:b(n.totalMaintenance)})]})]}),r.jsxs("div",{className:`stat-card ${n.overdueMaintenance>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon maintenance-alert-icon",children:"⏰"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Mantenimientos Vencidos"}),r.jsx("h2",{children:b(n.overdueMaintenance)})]})]})]}),r.jsxs("div",{className:"dashboard-content",children:[r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"Actividad Reciente"}),t.length>0?r.jsx("ul",{children:t.map(x=>r.jsxs("li",{children:[r.jsx("span",{className:`movement-type-badge ${x.type}`,children:x.type}),M(x),r.jsx("span",{className:"movement-date",children:x.date.toDate().toLocaleDateString()})]},x.id))}):r.jsx("p",{children:"No hay movimientos recientes."})]}),r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"🔧 Mantenimientos Recientes"}),d.length>0?r.jsx("ul",{children:d.slice(0,5).map(x=>r.jsxs("li",{children:[r.jsx("span",{className:`maintenance-type-badge ${x.type}`,children:x.type==="oil_change"?"🛢️":x.type==="battery_change"?"🔋":x.type==="filter_change"?"🔧":"⚙️"}),r.jsxs("span",{className:"maintenance-description",children:[x.type==="oil_change"?"Cambio de aceite":x.type==="battery_change"?"Cambio de batería":x.type==="filter_change"?"Cambio de filtros":"Mantenimiento general"," para ",x.vehicleName]}),r.jsx("span",{className:"maintenance-date",children:x.date?new Date(x.date).toLocaleDateString():"N/A"})]},x.id))}):r.jsx("p",{children:"No hay mantenimientos registrados."})]}),r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"📦 Stock por Tipo de Producto"}),o.length>0?r.jsxs("div",{className:"products-summary",children:[o.slice(0,6).map(x=>r.jsxs("div",{className:"product-summary-item",children:[r.jsx("div",{className:"product-icon",style:{color:x.color},children:x.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:x.displayName}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("span",{className:"stock-value",children:[b(x.currentStock||0)," ",x.unit]}),r.jsx("span",{className:`stock-status ${(x.currentStock||0)===0?"empty":(x.currentStock||0)<=(x.minThreshold||0)?"low":"normal"}`,children:(x.currentStock||0)===0?"🔴 Sin stock":(x.currentStock||0)<=(x.minThreshold||0)?"🟡 Stock bajo":"🟢 Normal"})]})]})]},x.id)),o.length>6&&r.jsx("div",{className:"view-all-products",children:r.jsxs("span",{children:["+",o.length-6," productos más"]})})]}):r.jsxs("div",{className:"no-products",children:[r.jsx("p",{children:"No hay productos registrados."}),r.jsx("small",{children:"Ve a la sección Productos para crear los primeros tipos de combustible."})]})]})]})]})},mL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const[o,c]=Y.useState("name"),[d,f]=Y.useState("asc"),p=b=>new Intl.NumberFormat("es-CO").format(b),v=b=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(b),_=b=>{const x=new Date-new Date(b.seconds?b.seconds*1e3:b),V=Math.floor(x/(1e3*60*60)),$=Math.floor(V/24);return $>0?`${$}d`:V>0?`${V}h`:"ahora"},N=b=>{o===b?f(d==="asc"?"desc":"asc"):(c(b),f("asc"))},C=[...n].sort((b,M)=>{let x=b[o],V=M[o];return o==="lastUpdated"&&(x=new Date(x.seconds?x.seconds*1e3:x),V=new Date(V.seconds?V.seconds*1e3:V)),x<V?d==="asc"?-1:1:x>V?d==="asc"?1:-1:0}),j=b=>o!==b?"↕️":d==="asc"?"↑":"↓";return r.jsxs("div",{className:"inventory-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{onClick:()=>N("name"),className:"sortable",children:["Combustible ",j("name")]}),r.jsxs("th",{onClick:()=>N("location"),className:"sortable",children:["Ubicación ",j("location")]}),r.jsxs("th",{onClick:()=>N("currentStock"),className:"sortable",children:["Stock Actual ",j("currentStock")]}),r.jsxs("th",{onClick:()=>N("stockPercentage"),className:"sortable",children:["Nivel ",j("stockPercentage")]}),r.jsxs("th",{onClick:()=>N("pricePerUnit"),className:"sortable",children:["Precio ",j("pricePerUnit")]}),r.jsx("th",{children:"Valor Total"}),r.jsxs("th",{onClick:()=>N("status"),className:"sortable",children:["Estado ",j("status")]}),r.jsxs("th",{onClick:()=>N("lastUpdated"),className:"sortable",children:["Actualizado ",j("lastUpdated")]}),a&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:C.map(b=>{const M=ol[b.fuelType],x=Go[b.stockLevel],V=b.currentStock*b.pricePerUnit;return r.jsxs("tr",{className:b.needsRestock?"needs-restock":"",children:[r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:M?.color},children:M?.icon}),r.jsxs("div",{children:[r.jsx("div",{className:"fuel-name",children:M?.name}),r.jsx("div",{className:"fuel-type",children:b.fuelType})]})]})}),r.jsx("td",{children:b.location}),r.jsxs("td",{className:"stock-cell",children:[r.jsxs("div",{className:"stock-info",children:[r.jsx("span",{className:"stock-amount",children:p(b.currentStock)}),r.jsxs("span",{className:"stock-unit",children:["/ ",p(b.maxCapacity)," ",b.unit]})]}),b.needsRestock&&r.jsx("div",{className:"restock-indicator",children:"⚠️ Bajo mínimo"})]}),r.jsx("td",{className:"level-cell",children:r.jsxs("div",{className:"level-info",children:[r.jsxs("div",{className:"level-badge",style:{backgroundColor:x?.color,color:"white"},children:[b.stockPercentage,"%"]}),r.jsx("div",{className:"level-bar",children:r.jsx("div",{className:"level-fill",style:{width:`${b.stockPercentage}%`,backgroundColor:x?.color}})})]})}),r.jsx("td",{className:"price-cell",children:r.jsxs("div",{className:"price-info",children:[r.jsx("span",{className:"price-amount",children:v(b.pricePerUnit)}),r.jsxs("span",{className:"price-unit",children:["/ ",b.unit]})]})}),r.jsx("td",{className:"value-cell",children:r.jsx("span",{className:"total-value",children:v(V)})}),r.jsx("td",{className:"status-cell",children:r.jsxs("span",{className:`status-badge ${b.status}`,children:[r.jsx("span",{className:"status-dot"}),b.status==="active"?"Activo":b.status==="inactive"?"Inactivo":b.status==="maintenance"?"Mantenimiento":b.status]})}),r.jsx("td",{className:"updated-cell",children:r.jsx("span",{className:"time-ago",children:_(b.lastUpdated)})}),a&&r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(b),title:"Editar",children:"✏️"}),r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(b),title:"Eliminar",children:"🗑️"})]})})]},b.id)})})]})}),r.jsxs("div",{className:"table-footer",children:[r.jsxs("div",{className:"table-info",children:[C.length," items ordenados por ",o,"(",d==="asc"?"ascendente":"descendente",")"]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot critical"}),"Crítico"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot low"}),"Bajo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot normal"}),"Normal"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},pL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const o=f=>new Intl.NumberFormat("es-CO").format(f),c=f=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(f),d=f=>{const v=new Date-new Date(f.seconds?f.seconds*1e3:f),_=Math.floor(v/(1e3*60*60)),N=Math.floor(_/24);return N>0?`hace ${N} día${N>1?"s":""}`:_>0?`hace ${_} hora${_>1?"s":""}`:"hace unos minutos"};return r.jsx("div",{className:"inventory-cards-grid",children:n.map(f=>{const p=ol[f.fuelType],v=Go[f.stockLevel],_=f.currentStock*f.pricePerUnit;return r.jsxs("div",{className:"inventory-card",children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:p?.color},children:p?.icon}),r.jsxs("div",{className:"fuel-details",children:[r.jsx("h3",{children:p?.name}),r.jsx("p",{className:"location",children:f.location})]})]}),r.jsx("div",{className:"stock-status",children:r.jsxs("span",{className:"status-badge",style:{backgroundColor:v?.color,color:"white"},children:[v?.icon," ",v?.label]})})]}),r.jsxs("div",{className:"stock-progress",children:[r.jsxs("div",{className:"progress-header",children:[r.jsxs("span",{className:"stock-text",children:[o(f.currentStock)," / ",o(f.maxCapacity)," ",f.unit]}),r.jsxs("span",{className:"percentage",children:[f.stockPercentage,"%"]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${f.stockPercentage}%`,backgroundColor:v?.color}})}),f.needsRestock&&r.jsxs("div",{className:"restock-warning",children:["⚠️ Bajo nivel mínimo (",o(f.minThreshold)," ",f.unit,")"]})]}),r.jsxs("div",{className:"card-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsxs("span",{className:"metric-label",children:["Precio por ",f.unit,":"]}),r.jsx("span",{className:"metric-value",children:c(f.pricePerUnit)})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor total:"}),r.jsx("span",{className:"metric-value",children:c(_)})]}),f.supplier&&r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Proveedor:"}),r.jsx("span",{className:"metric-value",children:f.supplier})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"status-info",children:[r.jsx("span",{className:`status-dot ${f.status}`}),r.jsx("span",{className:"status-text",children:f.status==="active"?"Activo":f.status==="inactive"?"Inactivo":f.status==="maintenance"?"Mantenimiento":f.status})]}),r.jsxs("div",{className:"last-update",children:["Actualizado ",d(f.lastUpdated)]})]}),a&&r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>e(f),title:"Editar combustible",children:"✏️ Editar"}),r.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>t(f),title:"Eliminar combustible",children:"🗑️ Eliminar"})]}),f.description&&f.description!==p?.description&&r.jsx("div",{className:"card-description",children:r.jsx("p",{children:f.description})})]},f.id)})})},gL=({item:n,onClose:e,onSuccess:t})=>{const{userProfile:a}=ea(),o=!!n,[c,d]=Y.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[f,p]=Y.useState({}),[v,_]=Y.useState(!1);Y.useEffect(()=>{o&&n&&d({fuelType:n.fuelType||"",location:n.location||"",currentStock:n.currentStock||"",maxCapacity:n.maxCapacity||"",minThreshold:n.minThreshold||"",pricePerUnit:n.pricePerUnit||"",supplier:n.supplier||"",description:n.description||"",status:n.status||"active"})},[o,n]),Y.useEffect(()=>{if(c.maxCapacity&&!c.minThreshold){const M=Math.round(Number(c.maxCapacity)*.15);d(x=>({...x,minThreshold:M}))}},[c.maxCapacity]);const N=M=>{const{name:x,value:V}=M.target;d($=>({...$,[x]:V})),f[x]&&p($=>({...$,[x]:null}))},C=()=>{const M={};c.fuelType||(M.fuelType="Tipo de combustible es requerido"),c.location||(M.location="Ubicación es requerida"),c.maxCapacity||(M.maxCapacity="Capacidad máxima es requerida");const x=Number(c.currentStock),V=Number(c.maxCapacity),$=Number(c.minThreshold),O=Number(c.pricePerUnit);return c.currentStock&&(isNaN(x)||x<0)&&(M.currentStock="Stock actual debe ser un número válido mayor o igual a 0"),c.maxCapacity&&(isNaN(V)||V<=0)&&(M.maxCapacity="Capacidad máxima debe ser un número válido mayor a 0"),c.minThreshold&&(isNaN($)||$<0)&&(M.minThreshold="Umbral mínimo debe ser un número válido mayor o igual a 0"),c.pricePerUnit&&(isNaN(O)||O<0)&&(M.pricePerUnit="Precio debe ser un número válido mayor o igual a 0"),x>V&&(M.currentStock="Stock actual no puede ser mayor a la capacidad máxima"),$>V&&(M.minThreshold="Umbral mínimo no puede ser mayor a la capacidad máxima"),p(M),Object.keys(M).length===0},j=async M=>{if(M.preventDefault(),!!C()){_(!0);try{let x;o?x=await X2(n.id,{location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid):x=await Q2({fuelType:c.fuelType,location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid),x.success?(alert(x.message),t()):alert(`Error: ${x.error}`)}catch(x){console.error("Error saving inventory item:",x),alert("Error inesperado al guardar el item")}finally{_(!1)}}},b=ol[c.fuelType];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content inventory-modal",onClick:M=>M.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:o?"✏️ Editar Combustible":"➕ Agregar Nuevo Combustible"}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),r.jsxs("form",{onSubmit:j,className:"modal-form",children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",b&&r.jsxs("span",{className:"fuel-preview",children:[b.icon," ",b.name]})]}),r.jsxs("select",{id:"fuelType",name:"fuelType",value:c.fuelType,onChange:N,disabled:o,className:f.fuelType?"error":"",required:!0,children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(jn).map(([M,x])=>{const V=ol[x];return r.jsxs("option",{value:x,children:[V.icon," ",V.name," (",V.unit,")"]},M)})]}),f.fuelType&&r.jsx("span",{className:"error-text",children:f.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"location",children:"Ubicación / Tanque *"}),r.jsx("input",{type:"text",id:"location",name:"location",value:c.location,onChange:N,placeholder:"ej. Tanque Principal, Depósito A, Bodega Norte",className:f.location?"error":"",required:!0}),f.location&&r.jsx("span",{className:"error-text",children:f.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",b&&`(${b.unit})`]}),r.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:c.currentStock,onChange:N,placeholder:"0",min:"0",step:"0.01",className:f.currentStock?"error":""}),f.currentStock&&r.jsx("span",{className:"error-text",children:f.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad Máxima * ",b&&`(${b.unit})`]}),r.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:c.maxCapacity,onChange:N,placeholder:"1000",min:"1",step:"0.01",className:f.maxCapacity?"error":"",required:!0}),f.maxCapacity&&r.jsx("span",{className:"error-text",children:f.maxCapacity})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"minThreshold",children:["Umbral Mínimo ",b&&`(${b.unit})`,r.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),r.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:c.minThreshold,onChange:N,placeholder:"Auto: 15% de capacidad máxima",min:"0",step:"0.01",className:f.minThreshold?"error":""}),f.minThreshold&&r.jsx("span",{className:"error-text",children:f.minThreshold}),c.maxCapacity&&r.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(c.maxCapacity)*.15)," ",b?.unit||"unidades"]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",b?.unit||"Unidad"]}),r.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:c.pricePerUnit,onChange:N,placeholder:"12000",min:"0",step:"0.01",className:f.pricePerUnit?"error":""}),f.pricePerUnit&&r.jsx("span",{className:"error-text",children:f.pricePerUnit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),r.jsx("input",{type:"text",id:"supplier",name:"supplier",value:c.supplier,onChange:N,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsxs("select",{id:"status",name:"status",value:c.status,onChange:N,children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"description",children:"Descripción / Notas"}),r.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:N,placeholder:"Información adicional sobre este combustible...",rows:"3"})]})]}),b&&c.maxCapacity&&r.jsxs("div",{className:"form-preview",children:[r.jsx("h4",{children:"📊 Vista Previa"}),r.jsxs("div",{className:"preview-card",children:[r.jsxs("div",{className:"preview-header",children:[r.jsxs("span",{style:{color:b.color},children:[b.icon," ",b.name]}),r.jsx("span",{children:c.location})]}),r.jsxs("div",{className:"preview-capacity",children:[c.currentStock||0," / ",c.maxCapacity," ",b.unit,c.currentStock&&c.maxCapacity&&r.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(c.currentStock)/Number(c.maxCapacity)*100),"%)"]})]}),c.pricePerUnit&&r.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(c.currentStock)||0)*Number(c.pricePerUnit))]})]})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v,children:v?"Guardando...":o?"Actualizar":"Crear"})]})]})]})})},wT=(n,e=[])=>{if(!n||!n.fuelType||!n.quantity)return{isValid:!1,error:"Datos de movimiento incompletos",availableStock:0,requiredStock:0};const{fuelType:t,quantity:a,type:o,sourceLocation:c}=n,d=parseFloat(a)||0;if(o!=="outbound"&&o!=="transfer")return{isValid:!0,message:"Movimiento no requiere validación de stock",availableStock:0,requiredStock:d};const f=e.filter(_=>_.fuelType===t&&_.location===c&&_.status==="active").reduce((_,N)=>_+(parseFloat(N.quantity)||0),0),p=f>=d,v=f-d;return{isValid:p,availableStock:f,requiredStock:d,remainingStock:v,fuelType:t,location:c,error:p?null:`Stock insuficiente. Disponible: ${f}, Requerido: ${d}`,warning:v<f*.2&&v>=0?"Stock quedará bajo después del movimiento":null}},kn=n=>typeof n!="number"||isNaN(n)?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),ze=(n,e=2)=>typeof n!="number"||isNaN(n)?"0":new Intl.NumberFormat("es-CO",{minimumFractionDigits:e,maximumFractionDigits:e}).format(n),Ar=(n,e=1)=>typeof n!="number"||isNaN(n)?"0%":`${(n*100).toFixed(e)}%`,vL=({stats:n})=>r.jsxs("div",{className:"inventory-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Valor Total"}),r.jsx("div",{className:"stat-value",children:kn(n.totalValue)}),r.jsxs("div",{className:"stat-subtitle",children:[ze(n.totalItems)," tipos de combustible"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:"✅"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Items Activos"}),r.jsx("div",{className:"stat-value",children:n.activeItems}),r.jsxs("div",{className:"stat-subtitle",children:[Math.round(n.activeItems/n.totalItems*100),"% del total"]})]})]}),r.jsxs("div",{className:`stat-card ${n.lowStockItems>0?"warning":"info"}`,children:[r.jsx("div",{className:"stat-icon",children:n.lowStockItems>0?"⚠️":"📊"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Stock Bajo"}),r.jsx("div",{className:"stat-value",children:n.lowStockItems}),r.jsx("div",{className:"stat-subtitle",children:n.lowStockItems>0?"Requieren atención":"Niveles normales"})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:"📈"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Nivel Promedio"}),r.jsxs("div",{className:"stat-value",children:[n.averageStockLevel,"%"]}),r.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),r.jsxs("div",{className:"fuel-type-summary",children:[r.jsx("h4",{children:"📊 Resumen por Tipo de Combustible"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(n.byFuelType).map(([e,t])=>{const a=ol[e],o=t.totalCapacity>0?Math.round(t.totalStock/t.totalCapacity*100):0;return r.jsxs("div",{className:"fuel-type-card",children:[r.jsxs("div",{className:"fuel-header",children:[r.jsx("span",{className:"fuel-icon",style:{color:a?.color||"#6b7280"},children:a?.icon||"⛽"}),r.jsxs("div",{className:"fuel-info",children:[r.jsx("h5",{children:a?.name||e}),r.jsxs("span",{className:"fuel-count",children:[t.count," ubicaciones"]})]})]}),r.jsxs("div",{className:"fuel-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Stock Total:"}),r.jsxs("span",{className:"metric-value",children:[ze(t.totalStock)," ",a?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Capacidad:"}),r.jsxs("span",{className:"metric-value",children:[ze(t.totalCapacity)," ",a?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Utilización:"}),r.jsxs("span",{className:`metric-value ${o<25?"low":o>75?"high":"normal"}`,children:[o,"%"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor:"}),r.jsx("span",{className:"metric-value",children:kn(t.totalValue)})]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${o}%`,backgroundColor:a?.color||"#6b7280"}})})]},e)})}),Object.keys(n.byFuelType).length===0&&r.jsx("div",{className:"empty-fuel-types",children:r.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),yL=()=>{const{hasPermission:n}=ea(),[e,t]=Y.useState([]),[a,o]=Y.useState(null),[c,d]=Y.useState(!0),[f,p]=Y.useState(null),[v,_]=Y.useState("cards"),[N,C]=Y.useState(!1),[j,b]=Y.useState(null),[M,x]=Y.useState("all"),[V,$]=Y.useState("");Y.useEffect(()=>{let A=null;return(()=>{A=fC((I,L)=>{if(L){console.error("Error in inventory subscription:",L),p("Error cargando inventario en tiempo real");return}t(I||[]),d(!1)})})(),()=>{A&&A()}},[]),Y.useEffect(()=>{(async()=>{const R=await Z2();R.success&&o(R.data)})()},[e]);const O=e.filter(A=>{if(M==="active"&&A.status!=="active"||M==="low-stock"&&!A.needsRestock)return!1;if(V){const R=V.toLowerCase();return A.name.toLowerCase().includes(R)||A.location.toLowerCase().includes(R)||A.fuelType.toLowerCase().includes(R)}return!0}),U=A=>{if(!n("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}b(A),C(!0)},q=async A=>{if(!n("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`¿Estás seguro de eliminar ${A.name} de ${A.location}?

Esta acción no se puede deshacer.`))return;d(!0);const I=await W2(A.id);I.success?alert("Item eliminado exitosamente"):(p(I.error),alert(`Error al eliminar: ${I.error}`)),d(!1)},K=()=>{C(!1),b(null)},w=()=>{K()};return c&&e.length===0?r.jsxs("div",{className:"inventory-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando inventario..."})]}):r.jsxs("div",{className:"inventory-main",children:[r.jsxs("div",{className:"inventory-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🛢️ Gestión de Inventario"}),r.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),r.jsx("div",{className:"inventory-info",children:r.jsxs("span",{className:"info-text",children:["💡 Los combustibles se agregan automáticamente desde la pestaña ",r.jsx("strong",{children:"Movimientos"})]})})]}),a&&r.jsx(vL,{stats:a}),r.jsxs("div",{className:"inventory-controls",children:[r.jsxs("div",{className:"search-filters",children:[r.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicación o tipo...",value:V,onChange:A=>$(A.target.value),className:"search-input"}),r.jsxs("select",{value:M,onChange:A=>x(A.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos los items"}),r.jsx("option",{value:"active",children:"Solo activos"}),r.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),r.jsxs("div",{className:"view-toggle",children:[r.jsx("button",{className:`toggle-btn ${v==="cards"?"active":""}`,onClick:()=>_("cards"),children:"📱 Cards"}),r.jsx("button",{className:`toggle-btn ${v==="table"?"active":""}`,onClick:()=>_("table"),children:"📊 Tabla"})]})]}),f&&r.jsxs("div",{className:"error-banner",children:[r.jsxs("span",{children:["⚠️ ",f]}),r.jsx("button",{onClick:()=>p(null),children:"✕"})]}),r.jsx("div",{className:"inventory-content",children:O.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📦"}),r.jsx("h3",{children:"No hay items de inventario"}),r.jsx("p",{children:V||M!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaña Movimientos para crear una ENTRADA de combustible"})]}):r.jsx(r.Fragment,{children:v==="cards"?r.jsx(pL,{items:O,onEdit:U,onDelete:q,canManage:n("canManageInventory")}):r.jsx(mL,{items:O,onEdit:U,onDelete:q,canManage:n("canManageInventory")})})}),O.length>0&&r.jsx("div",{className:"results-footer",children:r.jsxs("p",{children:["Mostrando ",O.length," de ",e.length," items",V&&` · Filtro: "${V}"`,M!=="all"&&` · Estado: ${M}`]})}),N&&r.jsx(gL,{item:j,onClose:K,onSuccess:w})]})},_L=({stats:n,filters:e})=>{if(!n)return null;const t=(d,f)=>f===0?d>0?100:0:((d-f)/f*100).toFixed(1),a=d=>{switch(d){case Ee.ENTRADA:return"#10b981";case Ee.SALIDA:return"#ef4444";case Ee.TRANSFERENCIA:return"#3b82f6";case Ee.AJUSTE:return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case Ee.ENTRADA:return"📥";case Ee.SALIDA:return"📤";case Ee.TRANSFERENCIA:return"🔄";case Ee.AJUSTE:return"⚖️";default:return"📋"}},c=t(n.thisMonth,n.lastMonth);return r.jsxs("div",{className:"movements-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"📊"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.totalMovements)}),r.jsx("div",{className:"stat-label",children:"Total Movimientos"}),r.jsxs("div",{className:"stat-trend",children:[r.jsxs("span",{className:`trend ${c>=0?"positive":"negative"}`,children:[c>=0?"📈":"📉"," ",Math.abs(c),"%"]}),r.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:kn(n.totalValue)}),r.jsx("div",{className:"stat-label",children:"Valor Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",kn(n.averageValue)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⛽"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.totalQuantity)}),r.jsx("div",{className:"stat-label",children:"Galones Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",ze(n.totalQuantity/(n.totalMovements||1))," gal/mov"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"📅"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.thisWeek)}),r.jsx("div",{className:"stat-label",children:"Esta Semana"}),r.jsxs("div",{className:"stat-secondary",children:[ze(n.thisMonth)," este mes"]})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"📋 Por Tipo de Movimiento"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:o(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:a(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⚡ Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),v=N=>{switch(N){case Ge.COMPLETADO:return"#10b981";case Ge.PENDIENTE:return"#f59e0b";case Ge.CANCELADO:return"#ef4444";default:return"#6b7280"}},_=N=>{switch(N){case Ge.COMPLETADO:return"✅";case Ge.PENDIENTE:return"⏳";case Ge.CANCELADO:return"❌";default:return"❓"}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:_(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:v(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),v=_=>{switch(_?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(d)}),r.jsx("span",{className:"breakdown-label",children:d})]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]})]}),(e.type||e.status||e.fuelType||e.vehicleId)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:"🔍 Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.vehicleId&&r.jsxs("span",{className:"filter-tag",children:["Vehículo: ",e.vehicleId]})]})]})]})},EL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const[p,v]=Y.useState(!1),_=[{value:"Diesel",label:"Diesel 🚛"},{value:"Gasolina",label:"Gasolina 🚗"},{value:"ACPM",label:"ACPM 🚚"},{value:"Lubricante",label:"Lubricante 🛢️"}],N=[{value:"all",label:"Todos los períodos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este año"}],C=Object.values(n).filter(M=>M&&M!==""&&M!=="all").length,j=(M,x)=>{e({[M]:x})},b=M=>{e(M)};return r.jsxs("div",{className:"movements-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehículo, referencia...",value:a,onChange:M=>o(M.target.value),className:"search-input"}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${n.type===Ee.ENTRADA?"active":""}`,onClick:()=>b({type:Ee.ENTRADA}),children:"📥 Entradas"}),r.jsx("button",{className:`quick-filter ${n.type===Ee.SALIDA?"active":""}`,onClick:()=>b({type:Ee.SALIDA}),children:"📤 Salidas"}),r.jsx("button",{className:`quick-filter ${n.status===Ge.PENDIENTE?"active":""}`,onClick:()=>b({status:Ge.PENDIENTE}),children:"⏳ Pendientes"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:["🎛️ Filtros",C>0&&r.jsx("span",{className:"filters-count",children:C})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Movimiento"}),r.jsxs("select",{value:n.type,onChange:M=>j("type",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:Ee.ENTRADA,children:"📥 Entrada"}),r.jsx("option",{value:Ee.SALIDA,children:"📤 Salida"}),r.jsx("option",{value:Ee.TRANSFERENCIA,children:"🔄 Transferencia"}),r.jsx("option",{value:Ee.AJUSTE,children:"⚖️ Ajuste"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:M=>j("status",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:Ge.PENDIENTE,children:"⏳ Pendiente"}),r.jsx("option",{value:Ge.COMPLETADO,children:"✅ Completado"}),r.jsx("option",{value:Ge.CANCELADO,children:"❌ Cancelado"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:n.fuelType,onChange:M=>j("fuelType",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),_.map(M=>r.jsx("option",{value:M.value,children:M.label},M.value))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Período"}),r.jsx("select",{value:n.dateRange,onChange:M=>j("dateRange",M.target.value),className:"filter-select",children:N.map(M=>r.jsx("option",{value:M.value,children:M.label},M.value))})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Vehículo/Equipo"}),r.jsx("input",{type:"text",placeholder:"ID del vehículo...",value:n.vehicleId,onChange:M=>j("vehicleId",M.target.value),className:"filter-input"})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:C===0,children:"🗑️ Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[f," resultado",f!==1?"s":""]}),C>0&&r.jsxs("span",{className:"active-filters-text",children:["(",C," filtro",C!==1?"s":""," activo",C!==1?"s":"",")"]})]})]})]}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},bL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,userRole:c})=>{const d=b=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),f=b=>b?(b instanceof Date?b:new Date(b)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Sin fecha",p=b=>{if(!b)return"";const M=new Date,x=b instanceof Date?b:new Date(b),V=Math.abs(M-x),$=Math.ceil(V/(1e3*60*60*24));return $===1?"hace 1 día":$<7?`hace ${$} días`:$<30?`hace ${Math.ceil($/7)} semanas`:$<365?`hace ${Math.ceil($/30)} meses`:`hace ${Math.ceil($/365)} años`},v=b=>{switch(b){case Ee.ENTRADA:return"movement-entrada";case Ee.SALIDA:return"movement-salida";case Ee.TRANSFERENCIA:return"movement-transferencia";case Ee.AJUSTE:return"movement-ajuste";default:return"movement-default"}},_=b=>{switch(b){case Ge.COMPLETADO:return"status-completado";case Ge.PENDIENTE:return"status-pendiente";case Ge.CANCELADO:return"status-cancelado";default:return"status-default"}},N=b=>{switch(b){case Ee.ENTRADA:return"📥";case Ee.SALIDA:return"📤";case Ee.TRANSFERENCIA:return"🔄";case Ee.AJUSTE:return"⚖️";default:return"📋"}},C=b=>{switch(b?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},j=b=>{switch(b){case Ge.COMPLETADO:return"✅";case Ge.PENDIENTE:return"⏳";case Ge.CANCELADO:return"❌";default:return"❓"}};return r.jsx("div",{className:"movements-cards",children:n.map(b=>r.jsxs("div",{className:`movement-card ${v(b.type)}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"movement-type",children:[r.jsx("span",{className:"type-icon",children:N(b.type)}),r.jsx("span",{className:"type-label",children:b.type.charAt(0).toUpperCase()+b.type.slice(1)})]}),r.jsxs("div",{className:`status-badge ${_(b.status)}`,children:[r.jsx("span",{className:"status-icon",children:j(b.status)}),r.jsx("span",{className:"status-label",children:b.status.charAt(0).toUpperCase()+b.status.slice(1)})]})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",children:C(b.fuelType)}),r.jsx("span",{className:"fuel-type",children:b.fuelType}),r.jsxs("span",{className:"quantity",children:[b.quantity," galones"]})]}),r.jsxs("div",{className:"value-info",children:[r.jsx("div",{className:"total-value",children:d(b.totalValue)}),r.jsxs("div",{className:"unit-price",children:[d(b.unitPrice),"/galón"]})]}),b.vehicleId&&r.jsxs("div",{className:"vehicle-info",children:[r.jsx("span",{className:"vehicle-icon",children:"🚜"}),r.jsxs("span",{className:"vehicle-id",children:["Vehículo: ",b.vehicleId]})]}),b.location&&r.jsxs("div",{className:"location-info",children:[r.jsx("span",{className:"location-icon",children:"📍"}),r.jsx("span",{className:"location",children:b.location})]}),b.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:b.description})}),b.reference&&r.jsxs("div",{className:"reference",children:[r.jsx("span",{className:"reference-label",children:"Ref:"}),r.jsx("span",{className:"reference-value",children:b.reference})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[r.jsx("div",{className:"created-date",children:f(b.createdAt)}),r.jsx("div",{className:"relative-time",children:p(b.createdAt)})]}),r.jsxs("div",{className:"card-actions",children:[c==="admin"&&b.status===Ge.PENDIENTE&&r.jsxs("div",{className:"admin-actions",children:[r.jsx("button",{className:"btn-approve",onClick:()=>a(b.id),title:"Aprobar movimiento",children:"✓ Aprobar"}),r.jsx("button",{className:"btn-reject",onClick:()=>o(b.id),title:"Rechazar movimiento",children:"✗ Rechazar"})]}),r.jsxs("div",{className:"user-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(b),title:"Ver detalles",children:"👁️ Ver"}),e&&b.status===Ge.PENDIENTE&&r.jsx("button",{className:"btn-edit",onClick:()=>e(b),title:"Editar movimiento",children:"✏️ Editar"})]})]})]}),b.status===Ge.PENDIENTE&&r.jsx("div",{className:"urgency-indicator",children:r.jsx("div",{className:"urgency-pulse"})}),b.type===Ee.AJUSTE&&r.jsx("div",{className:"adjustment-badge",children:r.jsx("span",{children:"Ajuste"})}),b.type===Ee.TRANSFERENCIA&&b.destinationLocation&&r.jsxs("div",{className:"transfer-info",children:[r.jsx("span",{className:"transfer-arrow",children:"→"}),r.jsx("span",{className:"destination",children:b.destinationLocation})]})]},b.id))})},NL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,userRole:c})=>{const[d,f]=Y.useState("createdAt"),[p,v]=Y.useState("desc"),_=O=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(O),N=O=>O?(O instanceof Date?O:new Date(O)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",C=O=>{switch(O){case Ee.ENTRADA:return"📥";case Ee.SALIDA:return"📤";case Ee.TRANSFERENCIA:return"🔄";case Ee.AJUSTE:return"⚖️";default:return"📋"}},j=O=>{switch(O?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},b=O=>{switch(O){case Ge.COMPLETADO:return"✅";case Ge.PENDIENTE:return"⏳";case Ge.CANCELADO:return"❌";default:return"❓"}},M=O=>{switch(O){case Ge.COMPLETADO:return"status-completado";case Ge.PENDIENTE:return"status-pendiente";case Ge.CANCELADO:return"status-cancelado";default:return"status-default"}},x=O=>{d===O?v(p==="asc"?"desc":"asc"):(f(O),v("asc"))},V=[...n].sort((O,U)=>{let q=O[d],K=U[d];return(d.includes("Date")||d.includes("At"))&&(q=new Date(q),K=new Date(K)),typeof q=="number"&&typeof K=="number"?p==="asc"?q-K:K-q:typeof q=="string"&&typeof K=="string"?p==="asc"?q.localeCompare(K):K.localeCompare(q):q instanceof Date&&K instanceof Date?p==="asc"?q-K:K-q:0}),$=O=>d!==O?"↕️":p==="asc"?"↑":"↓";return r.jsxs("div",{className:"movements-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"movements-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>x("type"),children:["Tipo ",$("type")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("fuelType"),children:["Combustible ",$("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("quantity"),children:["Cantidad ",$("quantity")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("unitPrice"),children:["Precio/Gal ",$("unitPrice")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("totalValue"),children:["Valor Total ",$("totalValue")]}),r.jsx("th",{children:"Vehículo"}),r.jsx("th",{children:"Ubicación"}),r.jsxs("th",{className:"sortable",onClick:()=>x("status"),children:["Estado ",$("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("createdAt"),children:["Fecha ",$("createdAt")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:V.map(O=>r.jsxs("tr",{className:`movement-row ${O.status===Ge.PENDIENTE?"pending-row":""}`,children:[r.jsx("td",{className:"type-cell",children:r.jsxs("div",{className:"type-content",children:[r.jsx("span",{className:"type-icon",children:C(O.type)}),r.jsx("span",{className:"type-text",children:O.type.charAt(0).toUpperCase()+O.type.slice(1)})]})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:j(O.fuelType)}),r.jsx("span",{className:"fuel-text",children:O.fuelType})]})}),r.jsxs("td",{className:"quantity-cell text-right",children:[r.jsx("span",{className:"quantity-value",children:O.quantity}),r.jsx("span",{className:"quantity-unit",children:"gal"})]}),r.jsx("td",{className:"price-cell text-right",children:_(O.unitPrice)}),r.jsx("td",{className:"value-cell text-right",children:r.jsx("strong",{children:_(O.totalValue)})}),r.jsx("td",{className:"vehicle-cell",children:O.vehicleId?r.jsxs("span",{className:"vehicle-id",children:["🚜 ",O.vehicleId]}):r.jsx("span",{className:"no-vehicle",children:"-"})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:["📍 ",O.location||"Principal"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${M(O.status)}`,children:[r.jsx("span",{className:"status-icon",children:b(O.status)}),r.jsx("span",{className:"status-text",children:O.status.charAt(0).toUpperCase()+O.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:N(O.createdAt)}),O.reference&&r.jsxs("span",{className:"reference-small",children:["#",O.reference]})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(O),title:"Ver detalles",children:"👁️"}),c==="admin"&&O.status===Ge.PENDIENTE&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-action btn-approve",onClick:()=>a(O.id),title:"Aprobar movimiento",children:"✓"}),r.jsx("button",{className:"btn-action btn-reject",onClick:()=>o(O.id),title:"Rechazar movimiento",children:"✗"})]}),e&&O.status===Ge.PENDIENTE&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(O),title:"Editar movimiento",children:"✏️"})]})})]},O.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[n.length," movimiento",n.length!==1?"s":""]}),d&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",d," (",p==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⏳"})," Pendiente"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"✅"})," Completado"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"❌"})," Cancelado"]})]})]})]})},TL=({movements:n,viewMode:e,onEdit:t,onView:a,userRole:o})=>e==="table"?r.jsx(NL,{movements:n,onEdit:t,onView:a,userRole:o}):r.jsx(bL,{movements:n,onEdit:t,onView:a,userRole:o}),$s="combustibles_suppliers",xL=async(n,e)=>{try{const t=Re(Je(Ne,$s),Ye("name","==",n.name.trim()));if(!(await Vt(t)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${n.name}"`};if(n.taxId){const d=Re(Je(Ne,$s),Ye("taxId","==",n.taxId.trim()));if(!(await Vt(d)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${n.taxId}"`}}const o={name:n.name.trim(),taxId:n.taxId?.trim()||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson?.trim()||"",phone:n.phone?.trim()||"",email:n.email?.trim()||"",address:n.address?.trim()||"",city:n.city?.trim()||"",state:n.state?.trim()||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:Number(n.creditLimit)||0,priceList:n.priceList||{},rating:Number(n.rating)||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1,totalOrders:0,totalPurchased:0,lastOrderDate:null,averageDeliveryTime:0,createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await Eu(Je(Ne,$s),o)).id,...o},message:`Proveedor "${o.name}" creado exitosamente`}}catch(t){return console.error("Error creating supplier:",t),{success:!1,error:t.message}}},bC=async()=>{try{const n=Re(Je(Ne,$s),Wn("name","asc"));return{success:!0,data:(await Vt(n)).docs.map(a=>({id:a.id,...a.data()}))}}catch(n){return console.error("Error getting suppliers:",n),{success:!1,error:n.message}}},AL=n=>{const e=Re(Je(Ne,$s),Wn("name","asc"));return gl(e,t=>{const a=t.docs.map(o=>({id:o.id,...o.data()}));n(a)})},CL=async(n,e,t)=>{try{const a=await qr(Ct(Ne,$s,n));if(!a.exists())return{success:!1,error:"Proveedor no encontrado"};if(e.name&&e.name.trim()!==a.data().name){const c=Re(Je(Ne,$s),Ye("name","==",e.name.trim()));if(!(await Vt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${e.name}"`}}if(e.taxId&&e.taxId.trim()!==a.data().taxId){const c=Re(Je(Ne,$s),Ye("taxId","==",e.taxId.trim()));if(!(await Vt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${e.taxId}"`}}const o={...e,lastUpdated:new Date,updatedBy:t};return o.name&&(o.name=o.name.trim()),o.taxId&&(o.taxId=o.taxId.trim()),o.contactPerson&&(o.contactPerson=o.contactPerson.trim()),o.phone&&(o.phone=o.phone.trim()),o.email&&(o.email=o.email.trim()),await Va(Ct(Ne,$s,n),o),{success:!0,message:"Proveedor actualizado exitosamente"}}catch(a){return console.error("Error updating supplier:",a),{success:!1,error:a.message}}},jL=async(n,e)=>{try{return await Va(Ct(Ne,$s,n),{status:"inactive",lastUpdated:new Date,updatedBy:e}),{success:!0,message:"Proveedor desactivado exitosamente"}}catch(t){return console.error("Error deleting supplier:",t),{success:!1,error:t.message}}},SL=async()=>{try{const n=await bC();if(!n.success)return n;const e=n.data,t={total:e.length,active:e.filter(a=>a.status==="active").length,inactive:e.filter(a=>a.status==="inactive").length,suspended:e.filter(a=>a.status==="suspended").length,preferred:e.filter(a=>a.isPreferred).length,averageRating:e.length>0?e.reduce((a,o)=>a+(o.rating||0),0)/e.length:0,byCategory:{},byType:{}};return e.forEach(a=>{const o=a.category||"sin_categoria";t.byCategory[o]=(t.byCategory[o]||0)+1}),e.forEach(a=>{const o=a.type||"sin_tipo";t.byType[o]=(t.byType[o]||0)+1}),{success:!0,data:t}}catch(n){return console.error("Error getting suppliers stats:",n),{success:!1,error:n.message}}},wL=({isOpen:n,onClose:e,movement:t,mode:a,onSuccess:o})=>{const[c,d]=Y.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),[f,p]=Y.useState(!1),[v,_]=Y.useState(""),[N,C]=Y.useState({}),[j,b]=Y.useState([]),[M,x]=Y.useState(!1),[V,$]=Y.useState([]),[O,U]=Y.useState(""),[q,K]=Y.useState([]),[w,A]=Y.useState([]),R=["Principal","Bodega Norte","Bodega Sur","Campo Operativo","Estación Móvil"];Y.useEffect(()=>{(async()=>{if(n){x(!0);try{console.log("🔄 Cargando datos para formulario de movimientos...");const[B,J,ce,ve]=await Promise.all([vC(),hC(),bC(),fL()]);console.log("📊 Datos cargados:",{vehicles:B?.length||0,inventory:J?.success?J.data?.length||0:"Error",suppliers:ce?.success?ce.data?.length||0:"Error",products:ve?.length||0}),b(B),$(J.success?J.data:[]),K(ce.success?ce.data:[]),A(ve),console.log("✅ Datos cargados exitosamente")}catch(B){console.error("❌ Error al cargar datos:",B)}finally{x(!1)}}})()},[n]),Y.useEffect(()=>{t&&(a==="edit"||a==="view")?d({type:t.type||"",fuelType:t.fuelType||"",quantity:t.quantity?.toString()||"",unitPrice:t.unitPrice?.toString()||"",location:t.location||"Principal",vehicleId:t.vehicleId||"",destinationLocation:t.destinationLocation||"",description:t.description||"",reference:t.reference||"",effectiveDate:t.effectiveDate?new Date(t.effectiveDate).toISOString().slice(0,16):new Date().toISOString().slice(0,16)}):a==="create"&&d({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),_(""),C({})},[t,a,n]),Y.useEffect(()=>{if(c.fuelType&&!c.unitPrice&&w.length>0){const ae=w.find(B=>B.name===c.fuelType||B.displayName===c.fuelType);ae&&ae.defaultPrice&&d(B=>({...B,unitPrice:ae.defaultPrice.toString()}))}},[c.fuelType,w]),Y.useEffect(()=>{if(U(""),(c.type===Ee.SALIDA||c.type===Ee.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&V.length>0){const ae={type:c.type===Ee.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},B=wT(ae,V);B.isValid?B.warning&&U(`⚠️ ${B.warning}`):U(`🚫 ${B.error}`)}},[c.type,c.fuelType,c.location,c.quantity,V]);const I=(ae,B)=>{d(ae==="type"?J=>({...J,[ae]:B,location:B===Ee.ENTRADA?"":"Principal"}):J=>({...J,[ae]:B})),N[ae]&&C(J=>({...J,[ae]:""}))},L=()=>{const ae={};if(c.type||(ae.type="Tipo de movimiento requerido"),c.fuelType||(ae.fuelType="Tipo de combustible requerido"),c.quantity?parseFloat(c.quantity)<=0&&(ae.quantity="La cantidad debe ser mayor a cero"):ae.quantity="Cantidad requerida",c.unitPrice?parseFloat(c.unitPrice)<0&&(ae.unitPrice="El precio no puede ser negativo"):ae.unitPrice="Precio unitario requerido",c.type===Ee.ENTRADA&&!c.location&&(ae.location="Las entradas requieren un proveedor"),c.type===Ee.SALIDA&&!c.vehicleId&&(ae.vehicleId="Las salidas requieren un vehículo"),c.type===Ee.TRANSFERENCIA&&!c.destinationLocation&&(ae.destinationLocation="Las transferencias requieren una ubicación destino"),(c.type===Ee.SALIDA||c.type===Ee.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&V.length>0){const B={type:c.type===Ee.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},J=wT(B,V);J.isValid||(ae.quantity=J.error)}return C(ae),Object.keys(ae).length===0},P=async ae=>{if(ae.preventDefault(),!L()){_("Por favor corrige los errores en el formulario");return}p(!0),_("");try{const B={...c,quantity:parseFloat(c.quantity),unitPrice:parseFloat(c.unitPrice),effectiveDate:new Date(c.effectiveDate)};a==="create"?await J2(B):a==="edit"&&await mC(t.id,B),o()}catch(B){console.error("Error al guardar movimiento:",B),_(B.message||"Error al guardar el movimiento")}finally{p(!1)}},k=(parseFloat(c.quantity)||0)*(parseFloat(c.unitPrice)||0),Pe=()=>{switch(a){case"create":return"➕ Nuevo Movimiento";case"edit":return"✏️ Editar Movimiento";case"view":return"👁️ Detalles del Movimiento";default:return"Movimiento"}};return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content movement-modal",onClick:ae=>ae.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:Pe()}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),a==="create"&&r.jsx("div",{style:{padding:"10px",background:"#f0f0f0",borderBottom:"1px solid #ddd"},children:r.jsx("button",{onClick:()=>{console.log("🔍 Debug - Estado actual:",{products:w.length,vehicles:j.length,suppliers:q.length,inventory:V.length,loadingVehicles:M}),alert(`Productos: ${w.length}, Vehículos: ${j.length}, Proveedores: ${q.length}`)},style:{background:"#007bff",color:"white",border:"none",padding:"5px 10px",borderRadius:"4px",cursor:"pointer"},children:"🔍 Debug Datos"})}),r.jsxs("div",{className:"modal-body",children:[v&&r.jsxs("div",{className:"error-message",children:[r.jsx("span",{className:"error-icon",children:"⚠️"}),v]}),r.jsxs("form",{onSubmit:P,className:"movement-form",children:[r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Movimiento *"}),r.jsxs("select",{value:c.type,onChange:ae=>I("type",ae.target.value),disabled:a==="view",className:N.type?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),r.jsx("option",{value:Ee.ENTRADA,children:"📥 Entrada"}),r.jsx("option",{value:Ee.SALIDA,children:"📤 Salida"}),r.jsx("option",{value:Ee.TRANSFERENCIA,children:"🔄 Transferencia"}),r.jsx("option",{value:Ee.AJUSTE,children:"⚖️ Ajuste"})]}),N.type&&r.jsx("span",{className:"field-error",children:N.type})]}),a==="view"&&t&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsx("div",{className:"status-display",children:r.jsxs("span",{className:`status-badge status-${t.status}`,children:[t.status===Ge.COMPLETADO&&"✅",t.status===Ge.PENDIENTE&&"⏳",t.status===Ge.CANCELADO&&"❌",t.status.charAt(0).toUpperCase()+t.status.slice(1)]})})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Combustible *"}),r.jsxs("select",{value:c.fuelType,onChange:ae=>I("fuelType",ae.target.value),disabled:a==="view",className:N.fuelType?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar producto/combustible..."}),w.map(ae=>r.jsxs("option",{value:ae.name,children:[ae.icon," ",ae.displayName]},ae.id))]}),N.fuelType&&r.jsx("span",{className:"field-error",children:N.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cantidad (galones) *"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:c.quantity,onChange:ae=>I("quantity",ae.target.value),disabled:a==="view",placeholder:"0.00",className:N.quantity?"error":""}),N.quantity&&r.jsx("span",{className:"field-error",children:N.quantity}),O&&!N.quantity&&r.jsx("div",{className:"stock-warning",children:O})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio Unitario (COP) *"}),r.jsx("input",{type:"number",step:"1",min:"0",value:c.unitPrice,onChange:ae=>I("unitPrice",ae.target.value),disabled:a==="view",placeholder:"0",className:N.unitPrice?"error":""}),N.unitPrice&&r.jsx("span",{className:"field-error",children:N.unitPrice})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Valor Total"}),r.jsx("div",{className:"total-value-display",children:kn(k)})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:c.type===Ee.ENTRADA?"Proveedor *":"Ubicación"}),c.type===Ee.ENTRADA?r.jsxs("select",{value:c.location,onChange:ae=>I("location",ae.target.value),disabled:a==="view",className:N.location?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar proveedor..."}),q.filter(ae=>ae.status==="active").map(ae=>r.jsxs("option",{value:ae.name,children:["🏪 ",ae.name," - ",ae.city]},ae.id))]}):r.jsx("select",{value:c.location,onChange:ae=>I("location",ae.target.value),disabled:a==="view",children:R.map(ae=>r.jsxs("option",{value:ae,children:["📍 ",ae]},ae))}),N.location&&r.jsx("span",{className:"field-error",children:N.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Vehículo/Equipo ",c.type===Ee.SALIDA&&"*"]}),c.type===Ee.SALIDA?M?r.jsxs("div",{className:"loading-vehicles",children:[r.jsx("span",{className:"loading-spinner small"}),"Cargando vehículos..."]}):r.jsxs("select",{value:c.vehicleId,onChange:ae=>I("vehicleId",ae.target.value),disabled:a==="view",className:N.vehicleId?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar vehículo destino..."}),j.map(ae=>r.jsxs("option",{value:ae.vehicleId,children:["🚜 ",ae.vehicleId," - ",ae.name," (",ae.type,")"]},ae.id))]}):r.jsx("input",{type:"text",value:c.vehicleId,onChange:ae=>I("vehicleId",ae.target.value),disabled:a==="view",placeholder:"ID del vehículo o equipo",className:N.vehicleId?"error":""}),N.vehicleId&&r.jsx("span",{className:"field-error",children:N.vehicleId})]})]}),c.type===Ee.TRANSFERENCIA&&r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ubicación Destino *"}),r.jsxs("select",{value:c.destinationLocation,onChange:ae=>I("destinationLocation",ae.target.value),disabled:a==="view",className:N.destinationLocation?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar destino..."}),R.filter(ae=>ae!==c.location).map(ae=>r.jsxs("option",{value:ae,children:["📍 ",ae]},ae))]}),N.destinationLocation&&r.jsx("span",{className:"field-error",children:N.destinationLocation})]})}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Fecha Efectiva"}),r.jsx("input",{type:"datetime-local",value:c.effectiveDate,onChange:ae=>I("effectiveDate",ae.target.value),disabled:a==="view"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Referencia"}),r.jsx("input",{type:"text",value:c.reference,onChange:ae=>I("reference",ae.target.value),disabled:a==="view",placeholder:"Factura, orden, etc."})]})]}),r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Descripción"}),r.jsx("textarea",{value:c.description,onChange:ae=>I("description",ae.target.value),disabled:a==="view",placeholder:"Detalles adicionales del movimiento...",rows:"3"})]})}),a==="view"&&t&&r.jsx("div",{className:"movement-details",children:r.jsxs("div",{className:"details-section",children:[r.jsx("h4",{children:"📋 Información del Sistema"}),r.jsxs("div",{className:"details-grid",children:[r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"ID:"}),r.jsx("span",{children:t.id})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Creado:"}),r.jsx("span",{children:new Date(t.createdAt).toLocaleString("es-CO")})]}),t.updatedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Actualizado:"}),r.jsx("span",{children:new Date(t.updatedAt).toLocaleString("es-CO")})]}),t.approvedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Aprobado:"}),r.jsx("span",{children:new Date(t.approvedAt).toLocaleString("es-CO")})]})]})]})})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-cancel",onClick:e,children:a==="view"?"Cerrar":"Cancelar"}),a!=="view"&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:P,disabled:f,children:f?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner small"}),"Guardando..."]}):a==="create"?"Crear Movimiento":"Actualizar Movimiento"})]})]})}):null},IL=()=>{const{user:n,userProfile:e}=ea(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[C,j]=Y.useState("cards"),[b,M]=Y.useState(""),[x,V]=Y.useState(!1),[$,O]=Y.useState(null),[U,q]=Y.useState("create");Y.useEffect(()=>{if(!n)return;f(!0);const J=Yv((ce,ve)=>{if(ve){console.error("Error en suscripción de movimientos:",ve),v("Error al cargar movimientos"),f(!1);return}a(ce),v(null),f(!1)},_);return()=>J()},[n,_]),Y.useEffect(()=>{n&&(async()=>{try{const ce=await sL(_);c(ce)}catch(ce){console.error("Error al cargar estadísticas:",ce)}})()},[n,t,_]);const K=t.filter(J=>{if(!b)return!0;const ce=b.toLowerCase();return J.fuelType?.toLowerCase().includes(ce)||J.type?.toLowerCase().includes(ce)||J.location?.toLowerCase().includes(ce)||J.vehicleId?.toLowerCase().includes(ce)||J.description?.toLowerCase().includes(ce)||J.reference?.toLowerCase().includes(ce)}),w=()=>{O(null),q("create"),V(!0)},A=J=>{O(J),q("edit"),V(!0)},R=J=>{O(J),q("view"),V(!0)},I=()=>{V(!1),O(null)},L=J=>{N(ce=>({...ce,...J}))},P=()=>{N({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),M("")},k=async J=>{if(window.confirm("¿Estás seguro de que quieres aprobar este movimiento? Esta acción actualizará el inventario."))try{await nL(J),alert("Movimiento aprobado y stock actualizado.")}catch(ce){console.error("Error al aprobar movimiento:",ce),alert(`Error al aprobar movimiento: ${ce.message}`)}},Pe=async J=>{if(window.confirm("¿Estás seguro de que quieres rechazar este movimiento?"))try{await mC(J,{status:Ge.CANCELADO}),alert("Movimiento rechazado.")}catch(ce){console.error("Error al rechazar movimiento:",ce),alert(`Error al rechazar movimiento: ${ce.message}`)}},ae=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",B=e?.role==="admin";return d?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando movimientos..."})]})}):p?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:"⚠️"}),r.jsx("h3",{children:"Error al cargar movimientos"}),r.jsx("p",{children:p}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"movements-main",children:[r.jsxs("div",{className:"movements-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"📊 Movimientos de Combustibles"}),r.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),ae&&r.jsx("button",{className:"btn-create-movement",onClick:w,children:"➕ Nuevo Movimiento"})]}),o&&r.jsx(_L,{stats:o,filters:_}),r.jsx(EL,{filters:_,onFilterChange:L,onClearFilters:P,searchTerm:b,onSearchChange:M,viewMode:C,onViewModeChange:j,totalResults:K.length}),K.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📋"}),r.jsx("h3",{children:t.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),r.jsx("p",{children:t.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&ae&&r.jsx("button",{className:"btn-create-first",onClick:w,children:"➕ Crear Primer Movimiento"})]}):r.jsx(TL,{movements:K,viewMode:C,onEdit:B?A:null,onView:R,onApprove:k,onReject:Pe,userRole:n?.role}),x&&r.jsx(wL,{isOpen:x,onClose:I,movement:$,mode:U,onSuccess:()=>{I()}})]})},RL=({stats:n,filters:e})=>{if(!n)return null;const t=N=>`${ze(N)} gal`,a=N=>`${ze(N)} hrs`,o=N=>`${N.toFixed(2)} gal/hr`,c=N=>{switch(N){case ge.EXCAVADORA:return"#059669";case ge.BULLDOZER:return"#dc2626";case ge.CARGADOR:return"#2563eb";case ge.CAMION:return"#7c3aed";case ge.GRUA:return"#ea580c";case ge.MOTOSIERRA:return"#16a34a";case ge.TRACTOR:return"#ca8a04";case ge.VOLQUETA:return"#9333ea";default:return"#6b7280"}},d=N=>{switch(N){case ge.EXCAVADORA:return"🚚";case ge.BULLDOZER:return"🚜";case ge.CARGADOR:return"🏗️";case ge.CAMION:return"🚛";case ge.GRUA:return"🏗️";case ge.MOTOSIERRA:return"🪚";case ge.TRACTOR:return"🚜";case ge.VOLQUETA:return"🚛";default:return"🚗"}},f=N=>{switch(N){case Oe.ACTIVO:return"#10b981";case Oe.MANTENIMIENTO:return"#f59e0b";case Oe.INACTIVO:return"#6b7280";case Oe.REPARACION:return"#ef4444";default:return"#6b7280"}},p=N=>{switch(N){case Oe.ACTIVO:return"✅";case Oe.MANTENIMIENTO:return"🔧";case Oe.INACTIVO:return"⏸️";case Oe.REPARACION:return"🔴";default:return"❓"}},v=N=>{switch(N){case At.DIESEL:return"🚛";case At.GASOLINA:return"🚗";case At.ACPM:return"🚚";case At.MIXTO:return"⛽";default:return"⛽"}},_=n.totalVehicles>0?((n.byStatus[Oe.ACTIVO]||0)/n.totalVehicles*100).toFixed(1):0;return r.jsxs("div",{className:"vehicles-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"🚜"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.totalVehicles)}),r.jsx("div",{className:"stat-label",children:"Total Vehículos"}),r.jsx("div",{className:"stat-trend",children:r.jsxs("span",{className:`trend ${_>=80?"positive":"warning"}`,children:[_>=80?"📈":"⚠️"," ",_,"% activos"]})})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⛽"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:t(n.totalFuelConsumed)}),r.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(n.averageConsumption||0)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⏰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:a(n.totalHoursWorked)}),r.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",a(n.totalHoursWorked/(n.totalVehicles||1))]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"🏆"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:n.mostActiveVehicle?n.mostActiveVehicle.vehicleId:"N/A"}),r.jsx("div",{className:"stat-label",children:"Más Activo"}),r.jsx("div",{className:"stat-secondary",children:n.mostActiveVehicle?`${n.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"🚜 Por Tipo de Vehículo"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([N,C])=>{const j=(C/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:d(N)}),r.jsx("span",{className:"breakdown-label",children:N.charAt(0).toUpperCase()+N.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:C}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:c(N)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},N)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⚡ Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([N,C])=>{const j=(C/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:p(N)}),r.jsx("span",{className:"breakdown-label",children:N.charAt(0).toUpperCase()+N.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:C}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:f(N)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},N)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([N,C])=>{const j=(C/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(N)}),r.jsx("span",{className:"breakdown-label",children:N})]}),r.jsx("div",{className:"breakdown-value",children:C}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},N)})})]})]}),(n.totalFuelConsumed>0||n.totalHoursWorked>0)&&r.jsxs("div",{className:"performance-metrics",children:[r.jsx("h4",{children:"📊 Métricas de Rendimiento"}),r.jsxs("div",{className:"metrics-grid",children:[r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"⚡"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),r.jsxs("div",{className:"metric-value",children:[_,"%"]}),r.jsxs("div",{className:"metric-description",children:[n.byStatus[Oe.ACTIVO]||0," de ",n.totalVehicles," activos"]})]})]}),n.averageConsumption>0&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"📈"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),r.jsx("div",{className:"metric-value",children:o(n.averageConsumption)}),r.jsx("div",{className:"metric-description",children:"Por vehículo por hora trabajada"})]})]}),n.mostActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"🏆"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Mayor Utilización"}),r.jsx("div",{className:"metric-value",children:n.mostActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(n.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),n.leastActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"📉"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Menor Utilización"}),r.jsx("div",{className:"metric-value",children:n.leastActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(n.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(e.type||e.status||e.fuelType||e.location)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:"🔍 Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.location&&r.jsxs("span",{className:"filter-tag",children:["Ubicación: ",e.location]})]})]})]})},DL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const[p,v]=Y.useState(!1),_=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mecánico","Proyecto A","Proyecto B","En Reparación","Otros"],N=Object.values(n).filter(b=>b&&b!==""&&b!=="all").length,C=(b,M)=>{e({[b]:M})},j=b=>{e(b)};return r.jsxs("div",{className:"vehicles-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicación...",value:a,onChange:b=>o(b.target.value),className:"search-input"}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${n.status===Oe.ACTIVO?"active":""}`,onClick:()=>j({status:Oe.ACTIVO}),children:"✅ Activos"}),r.jsx("button",{className:`quick-filter ${n.status===Oe.MANTENIMIENTO?"active":""}`,onClick:()=>j({status:Oe.MANTENIMIENTO}),children:"🔧 Mantenimiento"}),r.jsx("button",{className:`quick-filter ${n.type===ge.EXCAVADORA?"active":""}`,onClick:()=>j({type:ge.EXCAVADORA}),children:"🚚 Excavadoras"}),r.jsx("button",{className:`quick-filter ${n.type===ge.TRACTOR?"active":""}`,onClick:()=>j({type:ge.TRACTOR}),children:"🚜 Tractores"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:["🎛️ Filtros",N>0&&r.jsx("span",{className:"filters-count",children:N})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Vehículo"}),r.jsxs("select",{value:n.type,onChange:b=>C("type",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:ge.EXCAVADORA,children:"🚚 Excavadora"}),r.jsx("option",{value:ge.BULLDOZER,children:"🚜 Bulldozer"}),r.jsx("option",{value:ge.CARGADOR,children:"🏗️ Cargador"}),r.jsx("option",{value:ge.CAMION,children:"🚛 Camión"}),r.jsx("option",{value:ge.GRUA,children:"🏗️ Grúa"}),r.jsx("option",{value:ge.MOTOSIERRA,children:"🪚 Motosierra"}),r.jsx("option",{value:ge.TRACTOR,children:"🚜 Tractor"}),r.jsx("option",{value:ge.VOLQUETA,children:"🚛 Volqueta"}),r.jsx("option",{value:ge.OTROS,children:"🚗 Otros"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:b=>C("status",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:Oe.ACTIVO,children:"✅ Activo"}),r.jsx("option",{value:Oe.MANTENIMIENTO,children:"🔧 Mantenimiento"}),r.jsx("option",{value:Oe.INACTIVO,children:"⏸️ Inactivo"}),r.jsx("option",{value:Oe.REPARACION,children:"🔴 Reparación"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:n.fuelType,onChange:b=>C("fuelType",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),r.jsx("option",{value:At.DIESEL,children:"🚛 Diesel"}),r.jsx("option",{value:At.GASOLINA,children:"🚗 Gasolina"}),r.jsx("option",{value:At.ACPM,children:"🚚 ACPM"}),r.jsx("option",{value:At.MIXTO,children:"⛽ Mixto"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Ubicación Actual"}),r.jsxs("select",{value:n.location,onChange:b=>C("location",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todas las ubicaciones"}),_.map(b=>r.jsxs("option",{value:b,children:["📍 ",b]},b))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Mantenimiento"}),r.jsxs("select",{value:n.maintenance,onChange:b=>C("maintenance",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos"}),r.jsx("option",{value:"due",children:"Mantenimiento debido"}),r.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),r.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:N===0,children:"🗑️ Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[f," resultado",f!==1?"s":""]}),N>0&&r.jsxs("span",{className:"active-filters-text",children:["(",N," filtro",N!==1?"s":""," activo",N!==1?"s":"",")"]})]})]})]}),N>0&&r.jsx("div",{className:"active-filters-summary",children:r.jsxs("div",{className:"summary-content",children:[r.jsx("span",{className:"summary-label",children:"Filtros activos:"}),r.jsxs("div",{className:"summary-tags",children:[n.type&&r.jsxs("span",{className:"summary-tag",onClick:()=>C("type",""),children:["Tipo: ",n.type," ✕"]}),n.status&&r.jsxs("span",{className:"summary-tag",onClick:()=>C("status",""),children:["Estado: ",n.status," ✕"]}),n.fuelType&&r.jsxs("span",{className:"summary-tag",onClick:()=>C("fuelType",""),children:["Combustible: ",n.fuelType," ✕"]}),n.location&&r.jsxs("span",{className:"summary-tag",onClick:()=>C("location",""),children:["Ubicación: ",n.location," ✕"]}),n.maintenance!=="all"&&r.jsxs("span",{className:"summary-tag",onClick:()=>C("maintenance","all"),children:["Mantenimiento: ",n.maintenance," ✕"]})]})]})}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},OL=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const o=x=>new Intl.NumberFormat("es-CO").format(x),c=x=>`${o(x)} gal`,d=x=>`${o(x)} hrs`,f=x=>x?(x instanceof Date?x:new Date(x)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",p=x=>{if(!x)return"";const V=new Date,$=x instanceof Date?x:new Date(x),O=Math.abs(V-$),U=Math.ceil(O/(1e3*60*60*24));return U===1?"hace 1 día":U<7?`hace ${U} días`:U<30?`hace ${Math.ceil(U/7)} semanas`:U<365?`hace ${Math.ceil(U/30)} meses`:`hace ${Math.ceil(U/365)} años`},v=x=>{switch(x){case ge.EXCAVADORA:return"vehicle-excavadora";case ge.BULLDOZER:return"vehicle-bulldozer";case ge.CARGADOR:return"vehicle-cargador";case ge.CAMION:return"vehicle-camion";case ge.GRUA:return"vehicle-grua";case ge.MOTOSIERRA:return"vehicle-motosierra";case ge.TRACTOR:return"vehicle-tractor";case ge.VOLQUETA:return"vehicle-volqueta";default:return"vehicle-default"}},_=x=>{switch(x){case Oe.ACTIVO:return"status-activo";case Oe.MANTENIMIENTO:return"status-mantenimiento";case Oe.INACTIVO:return"status-inactivo";case Oe.REPARACION:return"status-reparacion";default:return"status-default"}},N=x=>{switch(x){case ge.EXCAVADORA:return"🚚";case ge.BULLDOZER:return"🚜";case ge.CARGADOR:return"🏗️";case ge.CAMION:return"🚛";case ge.GRUA:return"🏗️";case ge.MOTOSIERRA:return"🪚";case ge.TRACTOR:return"🚜";case ge.VOLQUETA:return"🚛";default:return"🚗"}},C=x=>{switch(x){case At.DIESEL:return"🚛";case At.GASOLINA:return"🚗";case At.ACPM:return"🚚";case At.MIXTO:return"⛽";default:return"⛽"}},j=x=>{switch(x){case Oe.ACTIVO:return"✅";case Oe.MANTENIMIENTO:return"🔧";case Oe.INACTIVO:return"⏸️";case Oe.REPARACION:return"🔴";default:return"❓"}},b=x=>!x.totalHoursWorked||x.totalHoursWorked===0?x.estimatedConsumptionPerHour||0:x.totalFuelConsumed/x.totalHoursWorked,M=x=>x.lastMaintenanceDate?Math.floor((new Date-new Date(x.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsx("div",{className:"vehicles-cards",children:n.map(x=>r.jsxs("div",{className:`vehicle-card ${v(x.type)}`,children:[r.jsx("div",{className:"card-header",children:r.jsxs("div",{className:"vehicle-info",children:[r.jsxs("div",{className:"vehicle-id-section",children:[r.jsx("span",{className:"vehicle-icon",children:N(x.type)}),r.jsxs("div",{className:"vehicle-details",children:[r.jsx("span",{className:"vehicle-id",children:x.vehicleId}),r.jsx("span",{className:"vehicle-name",children:x.name})]})]}),r.jsxs("div",{className:`status-badge ${_(x.status)}`,children:[r.jsx("span",{className:"status-icon",children:j(x.status)}),r.jsx("span",{className:"status-label",children:x.status.charAt(0).toUpperCase()+x.status.slice(1)})]})]})}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"basic-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Tipo:"}),r.jsxs("span",{className:"info-value",children:[N(x.type)," ",x.type.charAt(0).toUpperCase()+x.type.slice(1)]})]}),x.brand&&x.model&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),r.jsxs("span",{className:"info-value",children:[x.brand," ",x.model]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Combustible:"}),r.jsxs("span",{className:"info-value",children:[C(x.fuelType)," ",x.fuelType]})]}),x.currentLocation&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Ubicación:"}),r.jsxs("span",{className:"info-value",children:["📍 ",x.currentLocation]})]})]}),r.jsxs("div",{className:"consumption-metrics",children:[r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"⛽"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:c(x.totalFuelConsumed||0)}),r.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"⏰"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:d(x.totalHoursWorked||0)}),r.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"📊"}),r.jsxs("div",{className:"metric-content",children:[r.jsxs("div",{className:"metric-value",children:[b(x).toFixed(1)," gal/hr"]}),r.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"🔄"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:x.totalMovements||0}),r.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(x.enginePower||x.fuelCapacity||x.year)&&r.jsxs("div",{className:"technical-specs",children:[x.enginePower&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"⚡"}),r.jsxs("span",{className:"spec-value",children:[x.enginePower," HP"]})]}),x.fuelCapacity&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"🛢️"}),r.jsxs("span",{className:"spec-value",children:[x.fuelCapacity," gal"]})]}),x.year&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"📅"}),r.jsx("span",{className:"spec-value",children:x.year})]})]}),x.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:x.description})})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[x.lastMovementDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"Último movimiento:"}),r.jsx("span",{className:"date-value",children:f(x.lastMovementDate)}),r.jsx("span",{className:"date-relative",children:p(x.lastMovementDate)})]}),x.lastMaintenanceDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"Último mantenimiento:"}),r.jsx("span",{className:"date-value",children:f(x.lastMaintenanceDate)}),r.jsx("span",{className:"date-relative",children:p(x.lastMaintenanceDate)})]})]}),r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(x),title:"Ver detalles",children:"👁️"}),e&&x.status!==Oe.REPARACION&&r.jsx("button",{className:"btn-edit",onClick:()=>e(x),title:"Editar vehículo",children:"✏️"}),a&&r.jsx("button",{className:"btn-maintenance",onClick:()=>a(x),title:"Registrar mantenimiento",children:"🔧"})]})]}),x.status===Oe.MANTENIMIENTO&&r.jsx("div",{className:"maintenance-indicator",children:r.jsx("div",{className:"maintenance-pulse"})}),M(x)&&x.status===Oe.ACTIVO&&r.jsx("div",{className:"maintenance-due-badge",children:r.jsx("span",{children:"Mantenimiento Debido"})}),x.status===Oe.REPARACION&&r.jsx("div",{className:"repair-badge",children:r.jsx("span",{children:"En Reparación"})}),x.totalHoursWorked>0&&r.jsxs("div",{className:"efficiency-indicator",children:[r.jsx("div",{className:"efficiency-bar",children:r.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(x.totalHoursWorked/2e3*100,100)}%`}})}),r.jsxs("span",{className:"efficiency-label",children:[(x.totalHoursWorked/2e3*100).toFixed(1),"% utilización anual"]})]})]},x.id))})},ML=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const[o,c]=Y.useState("vehicleId"),[d,f]=Y.useState("asc"),p=q=>new Intl.NumberFormat("es-CO").format(q),v=q=>`${p(q)} gal`,_=q=>`${p(q)} hrs`,N=q=>q?(q instanceof Date?q:new Date(q)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",C=q=>{switch(q){case ge.EXCAVADORA:return"🚚";case ge.BULLDOZER:return"🚜";case ge.CARGADOR:return"🏗️";case ge.CAMION:return"🚛";case ge.GRUA:return"🏗️";case ge.MOTOSIERRA:return"🪚";case ge.TRACTOR:return"🚜";case ge.VOLQUETA:return"🚛";default:return"🚗"}},j=q=>{switch(q){case At.DIESEL:return"🚛";case At.GASOLINA:return"🚗";case At.ACPM:return"🚚";case At.MIXTO:return"⛽";default:return"⛽"}},b=q=>{switch(q){case Oe.ACTIVO:return"✅";case Oe.MANTENIMIENTO:return"🔧";case Oe.INACTIVO:return"⏸️";case Oe.REPARACION:return"🔴";default:return"❓"}},M=q=>{switch(q){case Oe.ACTIVO:return"status-activo";case Oe.MANTENIMIENTO:return"status-mantenimiento";case Oe.INACTIVO:return"status-inactivo";case Oe.REPARACION:return"status-reparacion";default:return"status-default"}},x=q=>{o===q?f(d==="asc"?"desc":"asc"):(c(q),f("asc"))},V=[...n].sort((q,K)=>{let w=q[o],A=K[o];return(o.includes("Date")||o.includes("At"))&&(w=new Date(w||0),A=new Date(A||0)),typeof w=="number"&&typeof A=="number"?d==="asc"?w-A:A-w:typeof w=="string"&&typeof A=="string"?d==="asc"?w.localeCompare(A):A.localeCompare(w):w instanceof Date&&A instanceof Date?d==="asc"?w-A:A-w:!w&&!A?0:w?A?0:d==="asc"?-1:1:d==="asc"?1:-1}),$=q=>o!==q?"↕️":d==="asc"?"↑":"↓",O=q=>!q.totalHoursWorked||q.totalHoursWorked===0?q.estimatedConsumptionPerHour||0:q.totalFuelConsumed/q.totalHoursWorked,U=q=>q.lastMaintenanceDate?Math.floor((new Date-new Date(q.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsxs("div",{className:"vehicles-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"vehicles-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>x("vehicleId"),children:["ID Vehículo ",$("vehicleId")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("name"),children:["Nombre ",$("name")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("type"),children:["Tipo ",$("type")]}),r.jsx("th",{children:"Marca/Modelo"}),r.jsxs("th",{className:"sortable",onClick:()=>x("fuelType"),children:["Combustible ",$("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("totalFuelConsumed"),children:["Consumido ",$("totalFuelConsumed")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("totalHoursWorked"),children:["Horas ",$("totalHoursWorked")]}),r.jsx("th",{className:"text-right",children:"Consumo/Hr"}),r.jsx("th",{children:"Ubicación"}),r.jsxs("th",{className:"sortable",onClick:()=>x("status"),children:["Estado ",$("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("lastMovementDate"),children:["Último Mov. ",$("lastMovementDate")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:V.map(q=>r.jsxs("tr",{className:`vehicle-row ${q.status===Oe.MANTENIMIENTO?"maintenance-row":""} ${U(q)?"needs-maintenance":""}`,children:[r.jsx("td",{className:"vehicle-id-cell",children:r.jsxs("div",{className:"id-content",children:[r.jsx("span",{className:"vehicle-icon",children:C(q.type)}),r.jsx("span",{className:"vehicle-id",children:q.vehicleId})]})}),r.jsx("td",{className:"name-cell",children:r.jsx("span",{className:"vehicle-name",children:q.name})}),r.jsx("td",{className:"type-cell",children:r.jsx("span",{className:"type-text",children:q.type.charAt(0).toUpperCase()+q.type.slice(1)})}),r.jsx("td",{className:"brand-model-cell",children:q.brand&&q.model?r.jsxs("span",{className:"brand-model",children:[q.brand," ",q.model]}):r.jsx("span",{className:"no-data",children:"-"})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:j(q.fuelType)}),r.jsx("span",{className:"fuel-text",children:q.fuelType})]})}),r.jsx("td",{className:"consumption-cell text-right",children:r.jsx("span",{className:"consumption-value",children:v(q.totalFuelConsumed||0)})}),r.jsx("td",{className:"hours-cell text-right",children:r.jsx("span",{className:"hours-value",children:_(q.totalHoursWorked||0)})}),r.jsx("td",{className:"rate-cell text-right",children:r.jsxs("span",{className:"rate-value",children:[O(q).toFixed(1)," gal/hr"]})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:["📍 ",q.currentLocation||"Sin ubicación"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${M(q.status)}`,children:[r.jsx("span",{className:"status-icon",children:b(q.status)}),r.jsx("span",{className:"status-text",children:q.status.charAt(0).toUpperCase()+q.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:N(q.lastMovementDate)}),U(q)&&r.jsx("span",{className:"maintenance-warning",children:"⚠️"})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(q),title:"Ver detalles",children:"👁️"}),e&&q.status!==Oe.REPARACION&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(q),title:"Editar vehículo",children:"✏️"}),a&&r.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>a(q),title:"Registrar mantenimiento",children:"🔧"})]})})]},q.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[n.length," vehículo",n.length!==1?"s":""]}),o&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",o," (",d==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"✅"})," Activo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"🔧"})," Mantenimiento"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⏸️"})," Inactivo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"🔴"})," Reparación"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⚠️"})," Mantto. Debido"]})]})]})]})},PL=({vehicles:n,viewMode:e,onEdit:t,onView:a,onMaintenance:o})=>e==="table"?r.jsx(ML,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}):r.jsx(OL,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}),on={HARVESTING:"harvesting",TRANSPORT:"transport",MAINTENANCE:"maintenance",SUPPORT:"support"},ln={CHAINSAW:"chainsaw",HARVESTER:"harvester",FORWARDER:"forwarder",SKIDDER:"skidder",LOG_TRUCK:"log_truck",PICKUP_TRUCK:"pickup_truck",CAR:"car",MOTORCYCLE:"motorcycle",ATV:"atv",BULLDOZER:"bulldozer",EXCAVATOR:"excavator",GRADER:"grader",LOADER:"loader",WATER_PUMP:"water_pump",FIRE_PUMP:"fire_pump",GENERATOR:"generator",COMPRESSOR:"compressor"},kL={[ln.CHAINSAW]:{name:"Motosierra",category:on.HARVESTING,fuelType:"two_stroke",avgConsumption:2.5,icon:"🪚",color:"#dc2626",description:"Herramienta para corte de árboles"},[ln.HARVESTER]:{name:"Cosechadora Forestal",category:on.HARVESTING,fuelType:"diesel",avgConsumption:25,icon:"🚜",color:"#059669",description:"Máquina para corte y procesamiento de árboles"},[ln.FORWARDER]:{name:"Forwarder",category:on.HARVESTING,fuelType:"diesel",avgConsumption:20,icon:"🚚",color:"#0891b2",description:"Transporte de troncos dentro del bosque"},[ln.LOG_TRUCK]:{name:"Camión Maderero",category:on.TRANSPORT,fuelType:"acpm",avgConsumption:3.5,icon:"🚚",color:"#ea580c",description:"Transporte de madera a destino"},[ln.PICKUP_TRUCK]:{name:"Camioneta",category:on.TRANSPORT,fuelType:"gasoline",avgConsumption:8,icon:"🚐",color:"#2563eb",description:"Transporte de personal y herramientas"},[ln.CAR]:{name:"Automóvil",category:on.TRANSPORT,fuelType:"gasoline",avgConsumption:12,icon:"🚗",color:"#3b82f6",description:"Vehículo liviano para transporte ejecutivo"},[ln.MOTORCYCLE]:{name:"Motocicleta",category:on.TRANSPORT,fuelType:"gasoline",avgConsumption:25,icon:"🏍️",color:"#6366f1",description:"Transporte ágil para terrenos difíciles"},[ln.ATV]:{name:"Cuatrimoto",category:on.TRANSPORT,fuelType:"gasoline",avgConsumption:15,icon:"🏍️",color:"#84cc16",description:"Vehículo todo terreno para supervisión"},[ln.SKIDDER]:{name:"Skidder",category:on.HARVESTING,fuelType:"diesel",avgConsumption:22,icon:"🚜",color:"#f59e0b",description:"Arrastre de troncos desde el lugar de corte"},[ln.BULLDOZER]:{name:"Bulldozer",category:on.MAINTENANCE,fuelType:"diesel",avgConsumption:30,icon:"🚜",color:"#f97316",description:"Construcción y mantenimiento de caminos"},[ln.EXCAVATOR]:{name:"Excavadora",category:on.MAINTENANCE,fuelType:"diesel",avgConsumption:28,icon:"🏗️",color:"#eab308",description:"Excavación y movimiento de tierra"},[ln.GRADER]:{name:"Motoniveladora",category:on.MAINTENANCE,fuelType:"diesel",avgConsumption:25,icon:"🚜",color:"#a3a3a3",description:"Nivelación y mantenimiento de vías"},[ln.LOADER]:{name:"Cargador Frontal",category:on.MAINTENANCE,fuelType:"diesel",avgConsumption:24,icon:"🚜",color:"#71717a",description:"Carga y descarga de materiales"},[ln.WATER_PUMP]:{name:"Motobomba de Agua",category:on.SUPPORT,fuelType:"gasoline",avgConsumption:3.5,icon:"💧",color:"#0891b2",description:"Bombeo de agua para operaciones"},[ln.FIRE_PUMP]:{name:"Motobomba Contra Incendios",category:on.SUPPORT,fuelType:"gasoline",avgConsumption:4.2,icon:"🔥",color:"#dc2626",description:"Equipo de emergencia contra incendios"},[ln.GENERATOR]:{name:"Generador Eléctrico",category:on.SUPPORT,fuelType:"gasoline",avgConsumption:2.8,icon:"⚡",color:"#7c3aed",description:"Suministro de energía eléctrica"},[ln.COMPRESSOR]:{name:"Compresor de Aire",category:on.SUPPORT,fuelType:"gasoline",avgConsumption:2.5,icon:"💨",color:"#64748b",description:"Suministro de aire comprimido"}},LL=({isOpen:n,onClose:e,vehicle:t,onSave:a,mode:o="create",userRole:c})=>{const d=()=>({vehicleId:t?.vehicleId||"",name:t?.name||"",type:t?.type||ge.EXCAVADORA,brand:t?.brand||"",model:t?.model||"",year:t?.year||new Date().getFullYear(),fuelType:t?.fuelType||At.DIESEL,fuelCapacity:t?.fuelCapacity||0,enginePower:t?.enginePower||0,status:t?.status||Oe.ACTIVO,currentLocation:t?.currentLocation||"",description:t?.description||"",estimatedConsumptionPerHour:t?.estimatedConsumptionPerHour||0,serialNumber:t?.serialNumber||"",plateNumber:t?.plateNumber||"",hasHourMeter:t?.hasHourMeter||!1,currentHours:t?.currentHours||0,lastMaintenanceDate:t?.lastMaintenanceDate?new Date(t.lastMaintenanceDate).toISOString().split("T")[0]:"",nextMaintenanceDate:t?.nextMaintenanceDate?new Date(t.nextMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:t?.purchaseDate?new Date(t.purchaseDate).toISOString().split("T")[0]:"",warrantyExpiration:t?.warrantyExpiration?new Date(t.warrantyExpiration).toISOString().split("T")[0]:""}),[f,p]=Y.useState(d()),[v,_]=Y.useState({}),[N,C]=Y.useState(!1),[j,b]=Y.useState(""),[M,x]=Y.useState(!1);Y.useEffect(()=>{n&&(p(d()),_({}))},[n,t]);const V=A=>{const{name:R,value:I,type:L}=A.target,P=L==="number"?parseFloat(I)||0:I;p(k=>({...k,[R]:P})),v[R]&&_(k=>({...k,[R]:null}))},$=()=>{const A={};f.vehicleId.trim()?f.vehicleId.length<3&&(A.vehicleId="El ID debe tener al menos 3 caracteres"):A.vehicleId="El ID del vehículo es obligatorio",f.name.trim()?f.name.length<2&&(A.name="El nombre debe tener al menos 2 caracteres"):A.name="El nombre del vehículo es obligatorio",f.fuelCapacity<=0?A.fuelCapacity="La capacidad de combustible debe ser mayor a 0":f.fuelCapacity>1e3&&(A.fuelCapacity="La capacidad no puede ser mayor a 1000 galones"),f.enginePower<0?A.enginePower="La potencia no puede ser negativa":f.enginePower>1e3&&(A.enginePower="La potencia no puede ser mayor a 1000 HP"),f.estimatedConsumptionPerHour<0?A.estimatedConsumptionPerHour="El consumo no puede ser negativo":f.estimatedConsumptionPerHour>50&&(A.estimatedConsumptionPerHour="El consumo no puede ser mayor a 50 gal/hr");const R=new Date().getFullYear();if(f.year<1990?A.year="El año no puede ser anterior a 1990":f.year>R+1&&(A.year=`El año no puede ser mayor a ${R+1}`),f.lastMaintenanceDate&&f.nextMaintenanceDate){const I=new Date(f.lastMaintenanceDate);new Date(f.nextMaintenanceDate)<=I&&(A.nextMaintenanceDate="La próxima fecha debe ser posterior al último mantenimiento")}return f.purchaseDate&&new Date(f.purchaseDate)>new Date&&(A.purchaseDate="La fecha de compra no puede ser futura"),_(A),Object.keys(A).length===0},O=async A=>{if(A.preventDefault(),!!$()){C(!0);try{const R={...f,lastMaintenanceDate:f.lastMaintenanceDate||null,nextMaintenanceDate:f.nextMaintenanceDate||null,purchaseDate:f.purchaseDate||null,warrantyExpiration:f.warrantyExpiration||null};await a(R),e()}catch(R){console.error("Error guardando vehículo:",R),_({general:"Error al guardar el vehículo. Intenta nuevamente."})}finally{C(!1)}}},U=A=>{switch(A){case ge.EXCAVADORA:return"🚚";case ge.BULLDOZER:return"🚜";case ge.CARGADOR:return"🏗️";case ge.CAMION:return"🚛";case ge.GRUA:return"🏗️";case ge.MOTOSIERRA:return"🪚";case ge.TRACTOR:return"🚜";case ge.VOLQUETA:return"🚛";default:return"🚗"}},q=A=>{switch(A){case At.DIESEL:return"🚛";case At.GASOLINA:return"🚗";case At.ACPM:return"🚚";case At.MIXTO:return"⛽";default:return"⛽"}},K=o==="view",w=c==="admin"||c==="supervisor";return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content vehicle-modal",onClick:A=>A.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("div",{className:"modal-title",children:[r.jsx("span",{className:"title-icon",children:o==="create"?"➕":o==="edit"?"✏️":"👁️"}),r.jsxs("div",{className:"title-text",children:[r.jsxs("h3",{children:[o==="create"&&"Crear Nuevo Vehículo",o==="edit"&&"Editar Vehículo",o==="view"&&"Detalles del Vehículo"]}),r.jsxs("p",{children:[o==="create"&&"Registra un nuevo vehículo en la flota",o==="edit"&&"Modifica la información del vehículo",o==="view"&&"Información completa del vehículo"]})]})]}),r.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),r.jsxs("form",{onSubmit:O,className:"modal-form",children:[r.jsxs("div",{className:"form-content",children:[r.jsxs("div",{className:"vehicle-preview",children:[r.jsxs("div",{className:"preview-header",children:[r.jsx("span",{className:"preview-icon",children:U(f.type)}),r.jsxs("div",{className:"preview-info",children:[r.jsx("span",{className:"preview-id",children:f.vehicleId||"ID-000"}),r.jsx("span",{className:"preview-name",children:f.name||"Nombre del vehículo"})]}),r.jsxs("div",{className:"preview-fuel",children:[r.jsx("span",{className:"fuel-icon",children:q(f.fuelType)}),r.jsx("span",{className:"fuel-text",children:f.fuelType})]})]}),r.jsxs("div",{className:"preview-specs",children:[f.enginePower>0&&r.jsxs("span",{className:"spec",children:["⚡ ",f.enginePower," HP"]}),f.fuelCapacity>0&&r.jsxs("span",{className:"spec",children:["🛢️ ",f.fuelCapacity," gal"]}),f.year&&r.jsxs("span",{className:"spec",children:["📅 ",f.year]})]})]}),v.general&&r.jsxs("div",{className:"error-message general-error",children:["⚠️ ",v.general]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📋 Información Básica"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"vehicleId",children:"ID del Vehículo *"}),r.jsx("input",{type:"text",id:"vehicleId",name:"vehicleId",value:f.vehicleId,onChange:V,placeholder:"Ej: EXC-001",className:v.vehicleId?"error":"",disabled:K||o==="edit"&&!w,maxLength:20}),v.vehicleId&&r.jsx("span",{className:"error-text",children:v.vehicleId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Nombre del Vehículo *"}),r.jsx("input",{type:"text",id:"name",name:"name",value:f.name,onChange:V,placeholder:"Ej: Excavadora Principal",className:v.name?"error":"",disabled:K||o==="edit"&&!w,maxLength:100}),v.name&&r.jsx("span",{className:"error-text",children:v.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"type",children:"Tipo de Vehículo"}),M?r.jsxs("div",{className:"custom-type-input",children:[r.jsx("input",{type:"text",placeholder:"Ej: Montacargas, Grúa Torre, etc.",value:j,onChange:A=>b(A.target.value),onKeyDown:A=>{A.key==="Enter"?(A.preventDefault(),j.trim()&&(p(R=>({...R,type:j.trim()})),x(!1),b(""))):A.key==="Escape"&&(x(!1),b(""))},autoFocus:!0}),r.jsx("button",{type:"button",className:"btn-confirm-custom",onClick:()=>{j.trim()&&(p(A=>({...A,type:j.trim()})),x(!1),b(""))},title:"Confirmar tipo personalizado",children:"✓"}),r.jsx("button",{type:"button",className:"btn-cancel-custom",onClick:()=>{x(!1),b("")},title:"Cancelar",children:"✕"})]}):r.jsxs("div",{className:"select-with-button",children:[r.jsx("select",{id:"type",name:"type",value:f.type,onChange:V,disabled:K||o==="edit"&&!w,children:Object.entries(kL).map(([A,R])=>r.jsxs("option",{value:A,children:[R.icon," ",R.name]},A))}),r.jsx("button",{type:"button",className:"btn-add-custom",onClick:()=>x(!0),disabled:K||o==="edit"&&!w,title:"Agregar tipo personalizado",children:"➕"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsx("select",{id:"status",name:"status",value:f.status,onChange:V,disabled:K||o==="edit"&&!w,children:Object.values(Oe).map(A=>r.jsx("option",{value:A,children:A.charAt(0).toUpperCase()+A.slice(1)},A))})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔧 Especificaciones Técnicas"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"brand",children:"Marca"}),r.jsx("input",{type:"text",id:"brand",name:"brand",value:f.brand,onChange:V,placeholder:"Ej: Caterpillar",disabled:K||o==="edit"&&!w,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"model",children:"Modelo"}),r.jsx("input",{type:"text",id:"model",name:"model",value:f.model,onChange:V,placeholder:"Ej: 320D",disabled:K||o==="edit"&&!w,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"year",children:"Año"}),r.jsx("input",{type:"number",id:"year",name:"year",value:f.year,onChange:V,min:"1990",max:new Date().getFullYear()+1,className:v.year?"error":"",disabled:K||o==="edit"&&!w}),v.year&&r.jsx("span",{className:"error-text",children:v.year})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"serialNumber",children:"Número de Serie"}),r.jsx("input",{type:"text",id:"serialNumber",name:"serialNumber",value:f.serialNumber,onChange:V,placeholder:"Ej: ABC123456789",disabled:K||o==="edit"&&!w,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"plateNumber",children:"Placa"}),r.jsx("input",{type:"text",id:"plateNumber",name:"plateNumber",value:f.plateNumber,onChange:V,placeholder:"Ej: ABC123",disabled:K||o==="edit"&&!w,maxLength:10})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"enginePower",children:"Potencia del Motor (HP)"}),r.jsx("input",{type:"number",id:"enginePower",name:"enginePower",value:f.enginePower,onChange:V,min:"0",max:"1000",step:"0.1",className:v.enginePower?"error":"",disabled:K||o==="edit"&&!w}),v.enginePower&&r.jsx("span",{className:"error-text",children:v.enginePower})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"⛽ Información de Combustible"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"fuelType",children:"Tipo de Combustible"}),r.jsx("select",{id:"fuelType",name:"fuelType",value:f.fuelType,onChange:V,disabled:K||o==="edit"&&!w,children:Object.values(At).map(A=>r.jsxs("option",{value:A,children:[q(A)," ",A.charAt(0).toUpperCase()+A.slice(1)]},A))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"fuelCapacity",children:"Capacidad de Combustible (gal) *"}),r.jsx("input",{type:"number",id:"fuelCapacity",name:"fuelCapacity",value:f.fuelCapacity,onChange:V,min:"0",max:"1000",step:"0.1",className:v.fuelCapacity?"error":"",disabled:K||o==="edit"&&!w}),v.fuelCapacity&&r.jsx("span",{className:"error-text",children:v.fuelCapacity})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedConsumptionPerHour",children:"Consumo Estimado (gal/hr)"}),r.jsx("input",{type:"number",id:"estimatedConsumptionPerHour",name:"estimatedConsumptionPerHour",value:f.estimatedConsumptionPerHour,onChange:V,min:"0",max:"50",step:"0.1",className:v.estimatedConsumptionPerHour?"error":"",disabled:K||o==="edit"&&!w}),v.estimatedConsumptionPerHour&&r.jsx("span",{className:"error-text",children:v.estimatedConsumptionPerHour})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"currentLocation",children:"Ubicación Actual"}),r.jsx("input",{type:"text",id:"currentLocation",name:"currentLocation",value:f.currentLocation,onChange:V,placeholder:"Ej: Sector Norte - Lote 15",disabled:K||o==="edit"&&!w,maxLength:100})]})]})]}),(f.type===ge.TRACTOR||f.hasHourMeter)&&r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"⏰ Sistema de Horómetro"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"hasHourMeter",children:[r.jsx("input",{type:"checkbox",id:"hasHourMeter",name:"hasHourMeter",checked:f.hasHourMeter,onChange:A=>p(R=>({...R,hasHourMeter:A.target.checked,...f.type===ge.TRACTOR?{hasHourMeter:!0}:{}})),disabled:K||o==="edit"&&!w||f.type===ge.TRACTOR})," ","Tiene Sistema de Horómetro",f.type===ge.TRACTOR&&r.jsx("span",{className:"auto-enabled",children:" (Automático para tractores)"})]}),r.jsx("small",{className:"field-help",children:"Los tractores TR1, TR2, TR3 requieren control de horómetro para reportes de consumo"})]}),f.hasHourMeter&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"currentHours",children:"Lectura Actual del Horómetro (horas)"}),r.jsx("input",{type:"number",id:"currentHours",name:"currentHours",value:f.currentHours,onChange:V,min:"0",max:"50000",step:"0.1",placeholder:"Ej: 1250.5",disabled:K||o==="edit"&&!w}),r.jsx("small",{className:"field-help",children:"Ingrese la lectura actual mostrada en el horómetro del vehículo"})]}),f.currentHours>0&&r.jsx("div",{className:"form-group",children:r.jsxs("div",{className:"hour-meter-info",children:[r.jsx("h5",{children:"📊 Información del Horómetro"}),r.jsxs("div",{className:"info-grid",children:[r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Lectura actual:"}),r.jsxs("span",{className:"info-value",children:[f.currentHours," horas"]})]}),o==="edit"&&t?.totalHoursWorked&&r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Horas trabajadas totales:"}),r.jsxs("span",{className:"info-value",children:[t.totalHoursWorked," horas"]})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Próximo mantenimiento:"}),r.jsxs("span",{className:"info-value",children:[250-f.currentHours%250," horas (",(f.currentHours+(250-f.currentHours%250)).toFixed(1),"h)"]})]})]})]})})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📅 Fechas Importantes"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"purchaseDate",children:"Fecha de Compra"}),r.jsx("input",{type:"date",id:"purchaseDate",name:"purchaseDate",value:f.purchaseDate,onChange:V,max:new Date().toISOString().split("T")[0],className:v.purchaseDate?"error":"",disabled:K||o==="edit"&&!w}),v.purchaseDate&&r.jsx("span",{className:"error-text",children:v.purchaseDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"warrantyExpiration",children:"Vencimiento de Garantía"}),r.jsx("input",{type:"date",id:"warrantyExpiration",name:"warrantyExpiration",value:f.warrantyExpiration,onChange:V,disabled:K||o==="edit"&&!w})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastMaintenanceDate",children:"Último Mantenimiento"}),r.jsx("input",{type:"date",id:"lastMaintenanceDate",name:"lastMaintenanceDate",value:f.lastMaintenanceDate,onChange:V,disabled:K||o==="edit"&&!w})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),r.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:f.nextMaintenanceDate,onChange:V,className:v.nextMaintenanceDate?"error":"",disabled:K||o==="edit"&&!w}),v.nextMaintenanceDate&&r.jsx("span",{className:"error-text",children:v.nextMaintenanceDate})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Descripción"}),r.jsx("textarea",{id:"description",name:"description",value:f.description,onChange:V,placeholder:"Información adicional sobre el vehículo...",rows:"3",maxLength:"500",disabled:K||o==="edit"&&!w}),r.jsxs("span",{className:"char-count",children:[f.description.length,"/500 caracteres"]})]})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:N,children:o==="view"?"Cerrar":"Cancelar"}),!K&&w&&r.jsx("button",{type:"submit",className:"btn-primary",disabled:N,children:N?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):r.jsx(r.Fragment,{children:o==="create"?"➕ Crear Vehículo":"💾 Guardar Cambios"})})]})]})]})}):null},Lo={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},gi={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},Vo={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},VL=({isOpen:n,onClose:e,vehicle:t,maintenance:a,onSave:o,mode:c="create",userRole:d})=>{const f=()=>({vehicleId:t?.vehicleId||"",vehicleName:t?.name||"",type:a?.type||Lo.PREVENTIVO,title:a?.title||"",description:a?.description||"",priority:a?.priority||Vo.MEDIA,status:a?.status||gi.PROGRAMADO,scheduledDate:a?.scheduledDate?new Date(a.scheduledDate).toISOString().split("T")[0]:"",startDate:a?.startDate?new Date(a.startDate).toISOString().split("T")[0]:"",completedDate:a?.completedDate?new Date(a.completedDate).toISOString().split("T")[0]:"",estimatedHours:a?.estimatedHours||0,actualHours:a?.actualHours||0,estimatedCost:a?.estimatedCost||0,actualCost:a?.actualCost||0,technician:a?.technician||"",workshop:a?.workshop||"",parts:a?.parts||[],notes:a?.notes||"",nextMaintenanceKm:a?.nextMaintenanceKm||0,nextMaintenanceHours:a?.nextMaintenanceHours||0,nextMaintenanceDate:a?.nextMaintenanceDate?new Date(a.nextMaintenanceDate).toISOString().split("T")[0]:""}),[p,v]=Y.useState(f()),[_,N]=Y.useState({}),[C,j]=Y.useState(!1),[b,M]=Y.useState({name:"",quantity:1,cost:0});Y.useEffect(()=>{n&&(v(f()),N({}))},[n,a,t]);const x=P=>{const{name:k,value:Pe,type:ae}=P.target,B=ae==="number"?parseFloat(Pe)||0:Pe;v(J=>({...J,[k]:B})),_[k]&&N(J=>({...J,[k]:null}))},V=P=>{const{name:k,value:Pe,type:ae}=P.target,B=ae==="number"?parseFloat(Pe)||0:Pe;M(J=>({...J,[k]:B}))},$=()=>{if(!b.name.trim())return;const P={id:Date.now().toString(),name:b.name.trim(),quantity:b.quantity,cost:b.cost,total:b.quantity*b.cost};v(k=>({...k,parts:[...k.parts,P]})),M({name:"",quantity:1,cost:0})},O=P=>{v(k=>({...k,parts:k.parts.filter(Pe=>Pe.id!==P)}))},U=()=>{const P={};if(p.title.trim()||(P.title="El título del mantenimiento es obligatorio"),p.description.trim()||(P.description="La descripción es obligatoria"),p.scheduledDate||(P.scheduledDate="La fecha programada es obligatoria"),p.startDate&&p.completedDate){const k=new Date(p.startDate);new Date(p.completedDate)<k&&(P.completedDate="La fecha de finalización debe ser posterior al inicio")}return p.scheduledDate&&p.startDate&&(new Date(p.scheduledDate),new Date(p.startDate)),p.estimatedHours<0&&(P.estimatedHours="Las horas estimadas no pueden ser negativas"),p.actualHours<0&&(P.actualHours="Las horas reales no pueden ser negativas"),p.estimatedCost<0&&(P.estimatedCost="El costo estimado no puede ser negativo"),p.actualCost<0&&(P.actualCost="El costo real no puede ser negativo"),p.status===gi.COMPLETADO&&!p.completedDate&&(P.completedDate="La fecha de finalización es obligatoria para mantenimientos completados"),p.status===gi.EN_PROCESO&&!p.startDate&&(P.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),N(P),Object.keys(P).length===0},q=async P=>{if(P.preventDefault(),!!U()){j(!0);try{const k=p.parts.reduce((J,ce)=>J+ce.total,0),Pe=p.estimatedCost+k,ae=p.actualCost+k,B={...p,vehicleId:t.id,vehicleName:t.name,totalPartsCost:k,totalEstimatedCost:Pe,totalActualCost:ae,scheduledDate:p.scheduledDate||null,startDate:p.startDate||null,completedDate:p.completedDate||null,nextMaintenanceDate:p.nextMaintenanceDate||null,createdAt:a?.createdAt||new Date,updatedAt:new Date};await o(B),e()}catch(k){console.error("Error guardando mantenimiento:",k),N({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{j(!1)}}},K=P=>{switch(P){case Lo.PREVENTIVO:return"🔧";case Lo.CORRECTIVO:return"🛠️";case Lo.PREDICTIVO:return"📊";case Lo.EMERGENCIA:return"🚨";default:return"⚙️"}},w=P=>{switch(P){case Vo.BAJA:return"priority-low";case Vo.MEDIA:return"priority-medium";case Vo.ALTA:return"priority-high";case Vo.CRITICA:return"priority-critical";default:return"priority-medium"}},A=P=>{switch(P){case gi.PROGRAMADO:return"status-scheduled";case gi.EN_PROCESO:return"status-in-progress";case gi.COMPLETADO:return"status-completed";case gi.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},R=()=>p.parts.reduce((P,k)=>P+k.total,0),I=c==="view",L=d==="admin"||d==="supervisor";return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content maintenance-modal",onClick:P=>P.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("div",{className:"modal-title",children:[r.jsx("span",{className:"title-icon",children:c==="create"?"➕":c==="edit"?"✏️":"👁️"}),r.jsxs("div",{className:"title-text",children:[r.jsxs("h3",{children:[c==="create"&&"Registrar Mantenimiento",c==="edit"&&"Editar Mantenimiento",c==="view"&&"Detalles del Mantenimiento"]}),r.jsxs("p",{children:["Vehículo: ",t?.vehicleId," - ",t?.name]})]})]}),r.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),r.jsxs("form",{onSubmit:q,className:"modal-form",children:[r.jsxs("div",{className:"form-content",children:[_.general&&r.jsxs("div",{className:"error-message general-error",children:["⚠️ ",_.general]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📋 Información del Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),r.jsx("select",{id:"type",name:"type",value:p.type,onChange:x,disabled:I||c==="edit"&&!L,children:Object.values(Lo).map(P=>r.jsxs("option",{value:P,children:[K(P)," ",P.charAt(0).toUpperCase()+P.slice(1)]},P))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"priority",children:"Prioridad"}),r.jsx("select",{id:"priority",name:"priority",value:p.priority,onChange:x,className:w(p.priority),disabled:I||c==="edit"&&!L,children:Object.values(Vo).map(P=>r.jsx("option",{value:P,children:P.charAt(0).toUpperCase()+P.slice(1)},P))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsx("select",{id:"status",name:"status",value:p.status,onChange:x,className:A(p.status),disabled:I||c==="edit"&&!L,children:Object.values(gi).map(P=>r.jsx("option",{value:P,children:P.charAt(0).toUpperCase()+P.slice(1).replace("_"," ")},P))})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"title",children:"Título del Mantenimiento *"}),r.jsx("input",{type:"text",id:"title",name:"title",value:p.title,onChange:x,placeholder:"Ej: Cambio de aceite y filtros",className:_.title?"error":"",disabled:I||c==="edit"&&!L,maxLength:100}),_.title&&r.jsx("span",{className:"error-text",children:_.title})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📅 Programación"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),r.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:p.scheduledDate,onChange:x,className:_.scheduledDate?"error":"",disabled:I||c==="edit"&&!L}),_.scheduledDate&&r.jsx("span",{className:"error-text",children:_.scheduledDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),r.jsx("input",{type:"date",id:"startDate",name:"startDate",value:p.startDate,onChange:x,className:_.startDate?"error":"",disabled:I||c==="edit"&&!L}),_.startDate&&r.jsx("span",{className:"error-text",children:_.startDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalización"}),r.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:p.completedDate,onChange:x,className:_.completedDate?"error":"",disabled:I||c==="edit"&&!L}),_.completedDate&&r.jsx("span",{className:"error-text",children:_.completedDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),r.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:p.nextMaintenanceDate,onChange:x,disabled:I||c==="edit"&&!L})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"💰 Recursos y Costos"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"technician",children:"Técnico Responsable"}),r.jsx("input",{type:"text",id:"technician",name:"technician",value:p.technician,onChange:x,placeholder:"Nombre del técnico",disabled:I||c==="edit"&&!L,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicación"}),r.jsx("input",{type:"text",id:"workshop",name:"workshop",value:p.workshop,onChange:x,placeholder:"Taller donde se realiza",disabled:I||c==="edit"&&!L,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),r.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:p.estimatedHours,onChange:x,min:"0",step:"0.5",className:_.estimatedHours?"error":"",disabled:I||c==="edit"&&!L}),_.estimatedHours&&r.jsx("span",{className:"error-text",children:_.estimatedHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),r.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:p.actualHours,onChange:x,min:"0",step:"0.5",className:_.actualHours?"error":"",disabled:I||c==="edit"&&!L}),_.actualHours&&r.jsx("span",{className:"error-text",children:_.actualHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),r.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:p.estimatedCost,onChange:x,min:"0",step:"1000",className:_.estimatedCost?"error":"",disabled:I||c==="edit"&&!L}),_.estimatedCost&&r.jsx("span",{className:"error-text",children:_.estimatedCost})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),r.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:p.actualCost,onChange:x,min:"0",step:"1000",className:_.actualCost?"error":"",disabled:I||c==="edit"&&!L}),_.actualCost&&r.jsx("span",{className:"error-text",children:_.actualCost})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔧 Partes y Repuestos"}),!I&&L&&r.jsx("div",{className:"parts-form",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),r.jsx("input",{type:"text",id:"partName",name:"name",value:b.name,onChange:V,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),r.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:b.quantity,onChange:V,min:"1",step:"1"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),r.jsx("input",{type:"number",id:"partCost",name:"cost",value:b.cost,onChange:V,min:"0",step:"1000"})]}),r.jsx("div",{className:"form-group",children:r.jsx("button",{type:"button",className:"btn-add-part",onClick:$,disabled:!b.name.trim(),children:"➕ Agregar"})})]})}),p.parts.length>0&&r.jsx("div",{className:"parts-list",children:r.jsxs("table",{className:"parts-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Parte"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo Unit."}),r.jsx("th",{children:"Total"}),!I&&L&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:p.parts.map(P=>r.jsxs("tr",{children:[r.jsx("td",{children:P.name}),r.jsx("td",{children:P.quantity}),r.jsxs("td",{children:["$",P.cost.toLocaleString("es-CO")]}),r.jsxs("td",{children:["$",P.total.toLocaleString("es-CO")]}),!I&&L&&r.jsx("td",{children:r.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>O(P.id),title:"Eliminar parte",children:"🗑️"})})]},P.id))}),r.jsx("tfoot",{children:r.jsxs("tr",{className:"total-row",children:[r.jsx("td",{colSpan:"3",children:r.jsx("strong",{children:"Total Partes:"})}),r.jsx("td",{children:r.jsxs("strong",{children:["$",R().toLocaleString("es-CO")]})}),!I&&L&&r.jsx("td",{})]})})]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔄 Próximo Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Próximo Mantenimiento (Km)"}),r.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:p.nextMaintenanceKm,onChange:x,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:I||c==="edit"&&!L})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Próximo Mantenimiento (Horas)"}),r.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:p.nextMaintenanceHours,onChange:x,min:"0",step:"100",placeholder:"0 = No aplica",disabled:I||c==="edit"&&!L})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Descripción del Trabajo *"}),r.jsx("textarea",{id:"description",name:"description",value:p.description,onChange:x,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:_.description?"error":"",disabled:I||c==="edit"&&!L}),_.description&&r.jsx("span",{className:"error-text",children:_.description})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),r.jsx("textarea",{id:"notes",name:"notes",value:p.notes,onChange:x,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:I||c==="edit"&&!L}),r.jsxs("span",{className:"char-count",children:[p.notes.length,"/500 caracteres"]})]})]}),r.jsxs("div",{className:"cost-summary",children:[r.jsx("h4",{children:"💰 Resumen de Costos"}),r.jsxs("div",{className:"cost-grid",children:[r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),r.jsxs("span",{className:"cost-value",children:["$",p.actualCost.toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Partes:"}),r.jsxs("span",{className:"cost-value",children:["$",R().toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item total-cost",children:[r.jsx("span",{className:"cost-label",children:"Total:"}),r.jsxs("span",{className:"cost-value",children:["$",(p.actualCost+R()).toLocaleString("es-CO")]})]})]})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:C,children:c==="view"?"Cerrar":"Cancelar"}),!I&&L&&r.jsx("button",{type:"submit",className:"btn-primary",disabled:C,children:C?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):r.jsx(r.Fragment,{children:c==="create"?"➕ Registrar Mantenimiento":"💾 Guardar Cambios"})})]})]})]})}):null},UL=()=>{const{user:n,userProfile:e}=ea(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[C,j]=Y.useState("cards"),[b,M]=Y.useState(""),[x,V]=Y.useState(!1),[$,O]=Y.useState(!1),[U,q]=Y.useState(null),[K,w]=Y.useState("create");Y.useEffect(()=>{if(!n)return;f(!0);const ve=yC((H,ne)=>{if(ne){console.error("Error en suscripción de vehículos:",ne),v("Error al cargar vehículos"),f(!1);return}a(H),v(null),f(!1)},_);return()=>ve()},[n,_]),Y.useEffect(()=>{n&&(async()=>{try{const H=await oL(_);c(H)}catch(H){console.error("Error al cargar estadísticas:",H)}})()},[n,t,_]);const A=t.filter(ve=>{if(!b)return!0;const H=b.toLowerCase();return ve.vehicleId?.toLowerCase().includes(H)||ve.name?.toLowerCase().includes(H)||ve.type?.toLowerCase().includes(H)||ve.brand?.toLowerCase().includes(H)||ve.model?.toLowerCase().includes(H)||ve.currentLocation?.toLowerCase().includes(H)||ve.description?.toLowerCase().includes(H)}),R=()=>{q(null),w("create"),V(!0)},I=ve=>{q(ve),w("edit"),V(!0)},L=ve=>{q(ve),w("view"),V(!0)},P=ve=>{q(ve),O(!0)},k=()=>{V(!1),O(!1),q(null)},Pe=ve=>{N(H=>({...H,...ve}))},ae=()=>{N({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),M("")},B=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",J=e?.role==="admin",ce=e?.role==="admin"||e?.role==="contador";return d?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando vehículos..."})]})}):p?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:"⚠️"}),r.jsx("h3",{children:"Error al cargar vehículos"}),r.jsx("p",{children:p}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"vehicles-main",children:[r.jsxs("div",{className:"vehicles-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🚜 Gestión de Vehículos"}),r.jsx("p",{children:"Administra la maquinaria y vehículos forestales"})]}),B&&r.jsx("button",{className:"btn-create-vehicle",onClick:R,children:"➕ Nuevo Vehículo"})]}),o&&r.jsx(RL,{stats:o,filters:_}),r.jsx(DL,{filters:_,onFilterChange:Pe,onClearFilters:ae,searchTerm:b,onSearchChange:M,viewMode:C,onViewModeChange:j,totalResults:A.length}),A.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"🚜"}),r.jsx("h3",{children:t.length===0?"No hay vehículos registrados":"No se encontraron vehículos"}),r.jsx("p",{children:t.length===0?"Comienza registrando tu primer vehículo o maquinaria forestal":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&B&&r.jsx("button",{className:"btn-create-first",onClick:R,children:"➕ Registrar Primer Vehículo"})]}):r.jsx(PL,{vehicles:A,viewMode:C,onEdit:J?I:null,onView:L,onMaintenance:ce?P:null,userRole:n?.role}),x&&r.jsx(LL,{isOpen:x,onClose:k,vehicle:U,mode:K,onSuccess:()=>{k()}}),$&&r.jsx(VL,{isOpen:$,onClose:k,vehicle:U,onSuccess:()=>{k()}})]})},Nu="combustibles_maintenance",NC="combustibles_vehicles",fe={OIL_CHANGE:"oil_change",BATTERY_CHANGE:"battery_change",FILTER_CHANGE:"filter_change",GENERAL_MAINTENANCE:"general_maintenance"},Me={COMPLETED:"completado",PENDING:"pendiente",CANCELLED:"cancelado"},$o={NEW:"nueva",USED:"usada",REPAIRED:"reparada"},Kv={OIL_CHANGE_HOURS:250,BATTERY_LIFETIME_MONTHS:24},TC=async n=>{try{HL(n);const e={...n,createdAt:Rt(),updatedAt:Rt(),status:n.status||Me.COMPLETED,createdBy:n.createdBy||"system"};n.type===fe.OIL_CHANGE&&(e.nextChangeHours=_f(n.currentHours)),n.type===fe.BATTERY_CHANGE&&(e.nextBatteryChange=wC(n.date));const t=await Eu(Je(Ne,Nu),e);return n.vehicleId&&n.currentHours&&await IC(n.vehicleId,n.currentHours),console.log("✅ Mantenimiento creado exitosamente:",t.id),t.id}catch(e){throw console.error("❌ Error al crear mantenimiento:",e),new Error(`Error al crear mantenimiento: ${e.message}`)}},xC=async(n={})=>{try{let e=Je(Ne,Nu);n.type&&(e=Re(e,Ye("type","==",n.type))),n.vehicleId&&(e=Re(e,Ye("vehicleId","==",n.vehicleId))),n.status&&(e=Re(e,Ye("status","==",n.status))),n.dateFrom&&(e=Re(e,Ye("date",">=",new Date(n.dateFrom)))),n.dateTo&&(e=Re(e,Ye("date","<=",new Date(n.dateTo)))),e=Re(e,Wn("date","desc"));const t=await Vt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data()})}),a}catch(e){throw console.error("❌ Error al obtener mantenimientos:",e),new Error(`Error al obtener mantenimientos: ${e.message}`)}},AC=async(n,e)=>{try{qL(e);const t=Ct(Ne,Nu,n),a={...e,updatedAt:Rt()};e.currentHours&&e.type===fe.OIL_CHANGE&&(a.nextChangeHours=_f(e.currentHours)),await Va(t,a),e.vehicleId&&e.currentHours&&await IC(e.vehicleId,e.currentHours),console.log("✅ Mantenimiento actualizado exitosamente:",n)}catch(t){throw console.error("❌ Error al actualizar mantenimiento:",t),new Error(`Error al actualizar mantenimiento: ${t.message}`)}},FL=async n=>{try{const e=Ct(Ne,Nu,n);await Rv(e),console.log("✅ Mantenimiento eliminado exitosamente:",n)}catch(e){throw console.error("❌ Error al eliminar mantenimiento:",e),new Error(`Error al eliminar mantenimiento: ${e.message}`)}},CC=async(n={})=>{try{const e=await xC(n),t={total:e.length,byType:{},byStatus:{},byVehicle:{},totalCost:0,averageCost:0,upcomingCount:0,overdueCount:0};let a=0;return e.forEach(o=>{t.byType[o.type]=(t.byType[o.type]||0)+1,t.byStatus[o.status]=(t.byStatus[o.status]||0)+1,t.byVehicle[o.vehicleId]=(t.byVehicle[o.vehicleId]||0)+1,o.cost&&(a+=parseFloat(o.cost)),o.nextChangeDate&&(new Date(o.nextChangeDate)>new Date?t.upcomingCount++:t.overdueCount++)}),t.totalCost=a,t.averageCost=t.total>0?a/t.total:0,t}catch(e){throw console.error("❌ Error al obtener estadísticas de mantenimiento:",e),new Error(`Error al obtener estadísticas de mantenimiento: ${e.message}`)}},jC=(n,e={})=>{try{let t=Je(Ne,Nu);return e.type&&(t=Re(t,Ye("type","==",e.type))),e.vehicleId&&(t=Re(t,Ye("vehicleId","==",e.vehicleId))),e.status&&(t=Re(t,Ye("status","==",e.status))),t=Re(t,Wn("date","desc")),gl(t,o=>{const c=[];o.forEach(d=>{c.push({id:d.id,...d.data()})}),n(c,null)},o=>{console.error("❌ Error en suscripción de mantenimientos:",o),n([],o)})}catch(t){return console.error("❌ Error al suscribirse a mantenimientos:",t),n([],t),()=>{}}},SC=async()=>{try{const n=Re(Je(Ne,NC),Ye("status","in",["activo","mantenimiento"]),Wn("name","asc")),e=await Vt(n),t=[];return e.forEach(a=>{t.push({id:a.id,...a.data()})}),t}catch(n){throw console.error("❌ Error al obtener vehículos para mantenimiento:",n),new Error(`Error al obtener vehículos para mantenimiento: ${n.message}`)}},_f=n=>parseInt(n)+Kv.OIL_CHANGE_HOURS,wC=n=>{const e=new Date(n);return e.setMonth(e.getMonth()+Kv.BATTERY_LIFETIME_MONTHS),e},IC=async(n,e)=>{try{const t=Re(Je(Ne,NC),Ye("vehicleId","==",n)),a=await Vt(t);if(!a.empty){const o=a.docs[0],c=o.data();if(c.hasHourMeter&&c.type==="tractor"){const d=parseInt(c.currentHours)||0,f=parseInt(e)||0;f>d&&(await Va(o.ref,{currentHours:f,lastHourMeterDate:Rt(),updatedAt:Rt()}),console.log(`✅ Horómetro actualizado para ${n}: ${d} → ${f}`))}}}catch(t){console.error("❌ Error al actualizar horómetro del vehículo:",t)}},HL=n=>{const e=[];if(n.type||e.push("El tipo de mantenimiento es obligatorio"),n.vehicleId||e.push("El vehículo es obligatorio"),n.date||e.push("La fecha es obligatoria"),n.type===fe.OIL_CHANGE&&((!n.quantity||n.quantity<=0)&&e.push("La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!n.currentHours||n.currentHours<0)&&e.push("La lectura del horómetro es obligatoria")),n.type===fe.BATTERY_CHANGE&&(n.batteryType||e.push("El tipo de batería es obligatorio"),(!n.cost||n.cost<=0)&&e.push("El costo de la batería es obligatorio")),e.length>0)throw new Error(e.join(", "))},qL=n=>{const e=[];if(n.type&&!Object.values(fe).includes(n.type)&&e.push("Tipo de mantenimiento inválido"),n.status&&!Object.values(Me).includes(n.status)&&e.push("Estado de mantenimiento inválido"),n.batteryStatus&&!Object.values($o).includes(n.batteryStatus)&&e.push("Estado de batería inválido"),e.length>0)throw new Error(e.join(", "))},RC=Object.freeze(Object.defineProperty({__proto__:null,BATTERY_STATUS:$o,MAINTENANCE_CONSTANTS:Kv,MAINTENANCE_STATUS:Me,MAINTENANCE_TYPES:fe,calculateNextBatteryChange:wC,calculateNextOilChange:_f,createMaintenanceRecord:TC,deleteMaintenanceRecord:FL,getAllMaintenanceRecords:xC,getMaintenanceStats:CC,getVehiclesForMaintenance:SC,subscribeToMaintenance:jC,updateMaintenanceRecord:AC},Symbol.toStringTag,{value:"Module"})),BL=({stats:n})=>{if(!n)return null;const e=c=>{switch(c){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},t=c=>{switch(c){case fe.OIL_CHANGE:return"Cambios de Aceite";case fe.BATTERY_CHANGE:return"Cambios de Batería";case fe.FILTER_CHANGE:return"Cambios de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimientos Generales";default:return c}},a=c=>{switch(c){case Me.COMPLETED:return"#10b981";case Me.PENDING:return"#f59e0b";case Me.CANCELLED:return"#ef4444";default:return"#6b7280"}},o=c=>{switch(c){case Me.COMPLETED:return"Completados";case Me.PENDING:return"Pendientes";case Me.CANCELLED:return"Cancelados";default:return c}};return r.jsxs("div",{className:"maintenance-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"🔧"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:ze(n.total)}),r.jsx("p",{children:"Total Mantenimientos"})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:kn(n.totalCost)}),r.jsx("p",{children:"Costo Total"})]})]}),r.jsxs("div",{className:"stat-card warning",children:[r.jsx("div",{className:"stat-icon",children:"⏰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:ze(n.upcomingCount)}),r.jsx("p",{children:"Próximos"})]})]}),r.jsxs("div",{className:"stat-card danger",children:[r.jsx("div",{className:"stat-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:ze(n.overdueCount)}),r.jsx("p",{children:"Vencidos"})]})]})]}),Object.keys(n.byType).length>0&&r.jsxs("div",{className:"stats-breakdown",children:[r.jsx("h3",{children:"📊 Desglose por Tipo"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([c,d])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:e(c)}),r.jsx("span",{className:"breakdown-label",children:t(c)})]}),r.jsx("div",{className:"breakdown-value",children:ze(d)}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:"#3b82f6"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),Object.keys(n.byStatus).length>0&&r.jsxs("div",{className:"stats-breakdown",children:[r.jsx("h3",{children:"📈 Desglose por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([c,d])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a(c)}}),r.jsx("span",{className:"breakdown-label",children:o(c)})]}),r.jsx("div",{className:"breakdown-value",children:ze(d)}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:a(c)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),r.jsxs("div",{className:"stats-insights",children:[r.jsx("h3",{children:"💡 Insights"}),r.jsxs("div",{className:"insights-grid",children:[r.jsxs("div",{className:"insight-item",children:[r.jsx("span",{className:"insight-label",children:"Costo Promedio:"}),r.jsx("span",{className:"insight-value",children:kn(n.averageCost)})]}),n.overdueCount>0&&r.jsxs("div",{className:"insight-item alert",children:[r.jsx("span",{className:"insight-label",children:"⚠️ Mantenimientos Vencidos:"}),r.jsxs("span",{className:"insight-value",children:[ze(n.overdueCount)," requieren atención"]})]}),n.upcomingCount>0&&r.jsxs("div",{className:"insight-item info",children:[r.jsx("span",{className:"insight-label",children:"⏰ Próximos Mantenimientos:"}),r.jsxs("span",{className:"insight-value",children:[ze(n.upcomingCount)," programados"]})]})]})]})]})},zL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const p=j=>{switch(j){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batería";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return j}},v=j=>{switch(j){case Me.COMPLETED:return"Completado";case Me.PENDING:return"Pendiente";case Me.CANCELLED:return"Cancelado";default:return j}},_=(j,b)=>{e({[j]:b})},N=j=>{e(j)},C=()=>Object.values(n).some(j=>j!=="")||a;return r.jsx("div",{className:"maintenance-filters",children:r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar mantenimientos...",value:a,onChange:j=>o(j.target.value)}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),children:"×"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${C()?"":"active"}`,onClick:()=>t(),children:"Todos"}),r.jsx("button",{className:`quick-filter ${n.type===fe.OIL_CHANGE?"active":""}`,onClick:()=>N({type:fe.OIL_CHANGE}),children:"🛢️ Aceite"}),r.jsx("button",{className:`quick-filter ${n.type===fe.BATTERY_CHANGE?"active":""}`,onClick:()=>N({type:fe.BATTERY_CHANGE}),children:"🔋 Baterías"}),r.jsx("button",{className:`quick-filter ${n.status===Me.PENDING?"active":""}`,onClick:()=>N({status:Me.PENDING}),children:"⏰ Pendientes"})]}),r.jsxs("button",{className:`btn-advanced-filters ${C()?"active":""}`,onClick:()=>document.querySelector(".filters-advanced").classList.toggle("show"),children:["🔧 Filtros Avanzados",C()&&r.jsx("span",{className:"filters-count",children:Object.values(n).filter(j=>j!=="").length})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),children:"📋 Cards"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),children:"📊 Tabla"})]})]}),r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Mantenimiento"}),r.jsxs("select",{value:n.type,onChange:j=>_("type",j.target.value),children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:fe.OIL_CHANGE,children:p(fe.OIL_CHANGE)}),r.jsx("option",{value:fe.BATTERY_CHANGE,children:p(fe.BATTERY_CHANGE)}),r.jsx("option",{value:fe.FILTER_CHANGE,children:p(fe.FILTER_CHANGE)}),r.jsx("option",{value:fe.GENERAL_MAINTENANCE,children:p(fe.GENERAL_MAINTENANCE)})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:j=>_("status",j.target.value),children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:Me.COMPLETED,children:v(Me.COMPLETED)}),r.jsx("option",{value:Me.PENDING,children:v(Me.PENDING)}),r.jsx("option",{value:Me.CANCELLED,children:v(Me.CANCELLED)})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Fecha Desde"}),r.jsx("input",{type:"date",value:n.dateFrom,onChange:j=>_("dateFrom",j.target.value)})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Fecha Hasta"}),r.jsx("input",{type:"date",value:n.dateTo,onChange:j=>_("dateTo",j.target.value)})]})]}),r.jsx("div",{className:"filters-actions",children:r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:!C(),children:"🗑️ Limpiar Filtros"})})]}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("div",{className:"results-count",children:[f," mantenimiento",f!==1?"s":""," encontrado",f!==1?"s":""]}),C()&&r.jsxs("div",{className:"active-filters",children:[r.jsx("span",{className:"filters-label",children:"Filtros activos:"}),r.jsxs("div",{className:"filter-tags",children:[n.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",p(n.type),r.jsx("button",{onClick:()=>_("type",""),children:"×"})]}),n.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",v(n.status),r.jsx("button",{onClick:()=>_("status",""),children:"×"})]}),n.dateFrom&&r.jsxs("span",{className:"filter-tag",children:["Desde: ",n.dateFrom,r.jsx("button",{onClick:()=>_("dateFrom",""),children:"×"})]}),n.dateTo&&r.jsxs("span",{className:"filter-tag",children:["Hasta: ",n.dateTo,r.jsx("button",{onClick:()=>_("dateTo",""),children:"×"})]}),a&&r.jsxs("span",{className:"filter-tag",children:['Búsqueda: "',a,'"',r.jsx("button",{onClick:()=>o(""),children:"×"})]})]})]})]})]})})},GL=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const c=b=>b?new Date(b).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"N/A",d=b=>{if(!b)return"";const M=new Date,x=new Date(b),V=Math.abs(M-x),$=Math.ceil(V/(1e3*60*60*24));return $===0?"Hoy":$===1?"Ayer":$<7?`Hace ${$} días`:$<30?`Hace ${Math.floor($/7)} semanas`:`Hace ${Math.floor($/30)} meses`},f=b=>{switch(b){case fe.OIL_CHANGE:return"maintenance-oil-change";case fe.BATTERY_CHANGE:return"maintenance-battery-change";case fe.FILTER_CHANGE:return"maintenance-filter-change";case fe.GENERAL_MAINTENANCE:return"maintenance-general";default:return"maintenance-general"}},p=b=>{switch(b){case Me.COMPLETED:return"status-completado";case Me.PENDING:return"status-pendiente";case Me.CANCELLED:return"status-cancelado";default:return"status-unknown"}},v=b=>{switch(b){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},_=b=>{switch(b){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batería";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return b}},N=b=>{switch(b){case Me.COMPLETED:return"✅";case Me.PENDING:return"⏰";case Me.CANCELLED:return"❌";default:return"❓"}},C=b=>{switch(b){case Me.COMPLETED:return"Completado";case Me.PENDING:return"Pendiente";case Me.CANCELLED:return"Cancelado";default:return b}},j=o==="admin"||o==="supervisor";return r.jsx("div",{className:"maintenance-cards",children:n.map(b=>r.jsxs("div",{className:`maintenance-card ${f(b.type)}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"maintenance-type",children:[r.jsx("span",{className:"type-icon",children:v(b.type)}),r.jsx("span",{className:"type-label",children:_(b.type)})]}),r.jsxs("div",{className:`status-badge ${p(b.status)}`,children:[N(b.status)," ",C(b.status)]})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"vehicle-info",children:[r.jsx("span",{className:"vehicle-icon",children:"🚜"}),r.jsxs("div",{className:"vehicle-details",children:[r.jsx("div",{className:"vehicle-name",children:b.vehicleName}),r.jsx("div",{className:"vehicle-id",children:b.vehicleId})]})]}),r.jsxs("div",{className:"date-info",children:[r.jsx("div",{className:"created-date",children:c(b.date)}),r.jsx("div",{className:"relative-time",children:d(b.date)})]}),b.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"oil-change-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Cantidad:"}),r.jsxs("span",{className:"info-value",children:[ze(b.quantity)," galones"]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Horómetro:"}),r.jsxs("span",{className:"info-value",children:[ze(b.currentHours)," horas"]})]}),b.nextChangeHours&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Próximo cambio:"}),r.jsxs("span",{className:"info-value",children:[ze(b.nextChangeHours)," horas"]})]}),b.filters&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Filtros:"}),r.jsx("span",{className:"info-value",children:b.filters})]})]}),b.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"battery-change-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Tipo:"}),r.jsx("span",{className:"info-value",children:b.batteryType})]}),b.brand&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Marca:"}),r.jsx("span",{className:"info-value",children:b.brand})]}),b.model&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Modelo:"}),r.jsx("span",{className:"info-value",children:b.model})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Estado:"}),r.jsx("span",{className:"info-value",children:b.batteryStatus})]}),b.cost&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Costo:"}),r.jsx("span",{className:"info-value",children:kn(b.cost)})]})]}),b.notes&&r.jsxs("div",{className:"notes-section",children:[r.jsx("span",{className:"notes-label",children:"Notas:"}),r.jsx("p",{className:"notes-text",children:b.notes})]})]}),r.jsx("div",{className:"card-footer",children:r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(b),title:"Ver detalles",children:"👁️ Ver"}),j&&e&&r.jsx("button",{className:"btn-edit",onClick:()=>e(b),title:"Editar",children:"✏️ Editar"}),j&&a&&r.jsx("button",{className:"btn-delete",onClick:()=>a(b.id),title:"Eliminar",children:"🗑️ Eliminar"})]})})]},b.id))})},$L=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const[c,d]=Y.useState("date"),[f,p]=Y.useState("desc"),v=O=>O?new Date(O).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",_=O=>{switch(O){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},N=O=>{switch(O){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batería";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return O}},C=O=>{switch(O){case Me.COMPLETED:return"✅";case Me.PENDING:return"⏰";case Me.CANCELLED:return"❌";default:return"❓"}},j=O=>{switch(O){case Me.COMPLETED:return"Completado";case Me.PENDING:return"Pendiente";case Me.CANCELLED:return"Cancelado";default:return O}},b=O=>{switch(O){case Me.COMPLETED:return"status-completado";case Me.PENDING:return"status-pendiente";case Me.CANCELLED:return"status-cancelado";default:return"status-unknown"}},M=O=>{c===O?p(f==="asc"?"desc":"asc"):(d(O),p("asc"))},x=O=>c!==O?"↕️":f==="asc"?"↑":"↓",V=[...n].sort((O,U)=>{let q=O[c],K=U[c];return c==="date"&&(q=new Date(q),K=new Date(K)),["quantity","currentHours","nextChangeHours","cost"].includes(c)&&(q=parseFloat(q)||0,K=parseFloat(K)||0),typeof q=="string"&&(q=q.toLowerCase(),K=K.toLowerCase()),f==="asc"?q>K?1:-1:q<K?1:-1}),$=o==="admin"||o==="supervisor";return r.jsxs("div",{className:"maintenance-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"maintenance-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>M("type"),children:["Tipo ",x("type")]}),r.jsxs("th",{className:"sortable",onClick:()=>M("vehicleName"),children:["Vehículo ",x("vehicleName")]}),r.jsxs("th",{className:"sortable",onClick:()=>M("date"),children:["Fecha ",x("date")]}),r.jsx("th",{children:"Detalles"}),r.jsxs("th",{className:"sortable",onClick:()=>M("status"),children:["Estado ",x("status")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>M("cost"),children:["Costo ",x("cost")]}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:V.map(O=>r.jsxs("tr",{className:"maintenance-row",children:[r.jsx("td",{className:"type-cell",children:r.jsxs("div",{className:"type-content",children:[r.jsx("span",{className:"type-icon",children:_(O.type)}),r.jsx("span",{className:"type-name",children:N(O.type)})]})}),r.jsx("td",{className:"vehicle-cell",children:r.jsxs("div",{className:"vehicle-info",children:[r.jsx("div",{className:"vehicle-name",children:O.vehicleName}),r.jsx("div",{className:"vehicle-id",children:O.vehicleId})]})}),r.jsx("td",{className:"date-cell",children:r.jsx("div",{className:"date-content",children:r.jsx("div",{className:"date-value",children:v(O.date)})})}),r.jsxs("td",{className:"details-cell",children:[O.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"oil-details",children:[r.jsxs("div",{children:["Qty: ",ze(O.quantity)," gal"]}),r.jsxs("div",{children:["Hrs: ",ze(O.currentHours)]}),O.filters&&r.jsxs("div",{children:["Filtros: ",O.filters]})]}),O.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"battery-details",children:[r.jsx("div",{children:O.batteryType}),O.brand&&r.jsx("div",{children:O.brand}),r.jsxs("div",{children:["Estado: ",O.batteryStatus]})]}),O.notes&&r.jsx("div",{className:"notes-small",children:O.notes})]}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${b(O.status)}`,children:[C(O.status)," ",j(O.status)]})}),r.jsx("td",{className:"cost-cell text-right",children:O.cost?kn(O.cost):"N/A"}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(O),title:"Ver detalles",children:"👁️"}),$&&e&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(O),title:"Editar",children:"✏️"}),$&&a&&r.jsx("button",{className:"btn-action btn-delete",onClick:()=>a(O.id),title:"Eliminar",children:"🗑️"})]})})]},O.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsx("div",{className:"table-summary",children:r.jsxs("span",{className:"total-rows",children:[n.length," mantenimiento",n.length!==1?"s":""," en total"]})}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot oil-change"}),r.jsx("span",{children:"Cambio de Aceite"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot battery-change"}),r.jsx("span",{children:"Cambio de Batería"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot filter-change"}),r.jsx("span",{children:"Cambio de Filtros"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot general"}),r.jsx("span",{children:"Mantenimiento General"})]})]})]})]})},YL=({maintenanceRecords:n,viewMode:e,onEdit:t,onView:a,onDelete:o,userRole:c})=>!n||n.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"🔧"}),r.jsx("h3",{children:"No hay mantenimientos registrados"}),r.jsx("p",{children:"Comienza creando el primer mantenimiento para tu flota de vehículos."})]}):r.jsx("div",{className:"maintenance-list",children:e==="cards"?r.jsx(GL,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c}):r.jsx($L,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c})}),KL=({isOpen:n,onClose:e,onSuccess:t,maintenance:a,mode:o="create",userRole:c})=>{const d=()=>({type:a?.type||fe.OIL_CHANGE,vehicleId:a?.vehicleId||"",vehicleName:a?.vehicleName||"",date:a?.date?new Date(a.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:a?.status||Me.COMPLETED,quantity:a?.quantity||0,currentHours:a?.currentHours||0,nextChangeHours:a?.nextChangeHours||0,filters:a?.filters||"",batteryType:a?.batteryType||"",brand:a?.brand||"",model:a?.model||"",batteryStatus:a?.batteryStatus||$o.NEW,notes:a?.notes||"",cost:a?.cost||0}),[f,p]=Y.useState(d()),[v,_]=Y.useState({}),[N,C]=Y.useState(!1),[j,b]=Y.useState([]),[M,x]=Y.useState(null);Y.useEffect(()=>{n&&(async()=>{try{const A=await SC();b(A)}catch(A){console.error("Error al cargar vehículos:",A)}})()},[n]),Y.useEffect(()=>{if(n&&(p(d()),_({}),a?.vehicleId)){const w=j.find(A=>A.vehicleId===a.vehicleId);x(w)}},[n,a,j]),Y.useEffect(()=>{if(f.type===fe.OIL_CHANGE&&f.currentHours>0){const w=_f(f.currentHours);p(A=>({...A,nextChangeHours:w}))}},[f.currentHours,f.type]);const V=(w,A)=>{const R=typeof A=="number"?parseFloat(A)||0:A;p(I=>({...I,[w]:R})),v[w]&&_(I=>({...I,[w]:null}))},$=w=>{const A=j.find(R=>R.vehicleId===w);x(A),p(R=>({...R,vehicleId:w,vehicleName:A?A.name:""})),A&&A.hasHourMeter&&A.currentHours&&p(R=>({...R,currentHours:A.currentHours}))},O=()=>{const w={};return f.type||(w.type="El tipo de mantenimiento es obligatorio"),f.vehicleId||(w.vehicleId="El vehículo es obligatorio"),f.date||(w.date="La fecha es obligatoria"),f.type===fe.OIL_CHANGE&&((!f.quantity||f.quantity<=0)&&(w.quantity="La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!f.currentHours||f.currentHours<0)&&(w.currentHours="La lectura del horómetro es obligatoria")),f.type===fe.BATTERY_CHANGE&&(f.batteryType||(w.batteryType="El tipo de batería es obligatorio"),(!f.cost||f.cost<=0)&&(w.cost="El costo de la batería es obligatorio")),_(w),Object.keys(w).length===0},U=async w=>{if(w.preventDefault(),!!O()){C(!0);try{const A={...f,date:new Date(f.date),createdBy:c||"user"};o==="create"?(await TC(A),console.log("✅ Mantenimiento creado exitosamente")):o==="edit"&&(await AC(a.id,A),console.log("✅ Mantenimiento actualizado exitosamente")),t()}catch(A){console.error("❌ Error al guardar mantenimiento:",A),alert("Error al guardar mantenimiento: "+A.message)}finally{C(!1)}}},q=()=>{switch(o){case"create":return"Crear Mantenimiento";case"edit":return"Editar Mantenimiento";case"view":return"Ver Mantenimiento";default:return"Mantenimiento"}},K=w=>{switch(w){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}};return n?r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content maintenance-modal",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:q()}),r.jsx("button",{className:"modal-close",onClick:e,children:"×"})]}),r.jsx("div",{className:"modal-body",children:r.jsxs("form",{onSubmit:U,className:"maintenance-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Mantenimiento *"}),r.jsxs("select",{value:f.type,onChange:w=>V("type",w.target.value),disabled:o==="view",children:[r.jsxs("option",{value:fe.OIL_CHANGE,children:[K(fe.OIL_CHANGE)," Cambio de Aceite"]}),r.jsxs("option",{value:fe.BATTERY_CHANGE,children:[K(fe.BATTERY_CHANGE)," Cambio de Batería"]}),r.jsxs("option",{value:fe.FILTER_CHANGE,children:[K(fe.FILTER_CHANGE)," Cambio de Filtros"]}),r.jsxs("option",{value:fe.GENERAL_MAINTENANCE,children:[K(fe.GENERAL_MAINTENANCE)," Mantenimiento General"]})]}),v.type&&r.jsx("span",{className:"error-text",children:v.type})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Vehículo *"}),r.jsxs("select",{value:f.vehicleId,onChange:w=>$(w.target.value),disabled:o==="view",children:[r.jsx("option",{value:"",children:"Seleccionar vehículo"}),j.map(w=>r.jsxs("option",{value:w.vehicleId,children:[w.vehicleId," - ",w.name," (",w.type,")"]},w.vehicleId))]}),v.vehicleId&&r.jsx("span",{className:"error-text",children:v.vehicleId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Fecha *"}),r.jsx("input",{type:"date",value:f.date,onChange:w=>V("date",w.target.value),disabled:o==="view"}),v.date&&r.jsx("span",{className:"error-text",children:v.date})]}),f.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"maintenance-section",children:[r.jsx("h3",{children:"🛢️ Información del Cambio de Aceite"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cantidad (galones) *"}),r.jsx("input",{type:"number",step:"0.1",value:f.quantity,onChange:w=>V("quantity",w.target.value),disabled:o==="view"}),v.quantity&&r.jsx("span",{className:"error-text",children:v.quantity})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Horómetro Actual *"}),r.jsx("input",{type:"number",value:f.currentHours,onChange:w=>V("currentHours",w.target.value),disabled:o==="view"}),v.currentHours&&r.jsx("span",{className:"error-text",children:v.currentHours})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Próximo Cambio (horas)"}),r.jsx("input",{type:"number",value:f.nextChangeHours,disabled:!0,className:"readonly-input"}),r.jsx("small",{children:"Calculado automáticamente: actual + 250 horas"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Filtros o Extras"}),r.jsx("textarea",{value:f.filters,onChange:w=>V("filters",w.target.value),disabled:o==="view",placeholder:"Especificar filtros cambiados o extras..."})]})]}),f.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"maintenance-section",children:[r.jsx("h3",{children:"🔋 Información del Cambio de Batería"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Batería *"}),r.jsx("input",{type:"text",value:f.batteryType,onChange:w=>V("batteryType",w.target.value),disabled:o==="view",placeholder:"Ej: 12V 60Ah"}),v.batteryType&&r.jsx("span",{className:"error-text",children:v.batteryType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado *"}),r.jsxs("select",{value:f.batteryStatus,onChange:w=>V("batteryStatus",w.target.value),disabled:o==="view",children:[r.jsx("option",{value:$o.NEW,children:"Nueva"}),r.jsx("option",{value:$o.USED,children:"Usada"}),r.jsx("option",{value:$o.REPAIRED,children:"Reparada"})]})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Marca"}),r.jsx("input",{type:"text",value:f.brand,onChange:w=>V("brand",w.target.value),disabled:o==="view",placeholder:"Ej: Bosch, Exide"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Modelo"}),r.jsx("input",{type:"text",value:f.model,onChange:w=>V("model",w.target.value),disabled:o==="view",placeholder:"Ej: S4 005"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Costo *"}),r.jsx("input",{type:"number",step:"1000",value:f.cost,onChange:w=>V("cost",w.target.value),disabled:o==="view",placeholder:"0"}),v.cost&&r.jsx("span",{className:"error-text",children:v.cost})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Notas Adicionales"}),r.jsx("textarea",{value:f.notes,onChange:w=>V("notes",w.target.value),disabled:o==="view",placeholder:"Observaciones adicionales...",rows:"3"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:f.status,onChange:w=>V("status",w.target.value),disabled:o==="view",children:[r.jsx("option",{value:Me.COMPLETED,children:"Completado"}),r.jsx("option",{value:Me.PENDING,children:"Pendiente"}),r.jsx("option",{value:Me.CANCELLED,children:"Cancelado"})]})]})]})}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:N,children:"Cancelar"}),o!=="view"&&r.jsx("button",{type:"submit",className:"btn btn-primary",onClick:U,disabled:N,children:N?"Guardando...":o==="create"?"Crear":"Actualizar"})]})]})}):null},QL=()=>{const{user:n,userProfile:e}=ea(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),[C,j]=Y.useState("cards"),[b,M]=Y.useState(""),[x,V]=Y.useState(!1),[$,O]=Y.useState(null),[U,q]=Y.useState("create");Y.useEffect(()=>{if(!n)return;f(!0);const B=jC((J,ce)=>{if(ce){console.error("Error en suscripción de mantenimientos:",ce),v("Error al cargar mantenimientos"),f(!1);return}a(J),v(null),f(!1)},_);return()=>B()},[n,_]),Y.useEffect(()=>{n&&(async()=>{try{const J=await CC(_);c(J)}catch(J){console.error("Error al cargar estadísticas:",J)}})()},[n,t,_]);const K=t.filter(B=>{if(!b)return!0;const J=b.toLowerCase();return B.vehicleName?.toLowerCase().includes(J)||B.type?.toLowerCase().includes(J)||B.status?.toLowerCase().includes(J)||B.notes?.toLowerCase().includes(J)}),w=e?.combustiblesPermissions?.canManageMaintenance||!1,A=()=>{O(null),q("create"),V(!0)},R=B=>{O(B),q("edit"),V(!0)},I=B=>{O(B),q("view"),V(!0)},L=()=>{V(!1),O(null)},P=()=>{V(!1),O(null)},k=B=>{N(J=>({...J,...B}))},Pe=()=>{N({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),M("")},ae=async B=>{if(!w){alert("No tienes permisos para eliminar mantenimientos");return}if(window.confirm("¿Estás seguro de que quieres eliminar este mantenimiento?"))try{const{deleteMaintenanceRecord:J}=await uC(async()=>{const{deleteMaintenanceRecord:ce}=await Promise.resolve().then(()=>RC);return{deleteMaintenanceRecord:ce}},void 0);await J(B),console.log("✅ Mantenimiento eliminado exitosamente")}catch(J){console.error("❌ Error al eliminar mantenimiento:",J),alert("Error al eliminar mantenimiento: "+J.message)}};return n?r.jsxs("div",{className:"maintenance-main",children:[r.jsxs("div",{className:"maintenance-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🔧 Mantenimiento de Vehículos"}),r.jsx("p",{children:"Gestión de cambios de aceite, filtros y baterías"})]}),r.jsx("div",{className:"header-actions",children:w&&r.jsx("button",{className:"btn-create-maintenance",onClick:A,children:"➕ Crear Mantenimiento"})})]}),d&&r.jsxs("div",{className:"maintenance-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando mantenimientos..."})]}),p&&r.jsxs("div",{className:"error-banner",children:[r.jsxs("span",{children:["❌ ",p]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]}),o&&r.jsx(BL,{stats:o}),r.jsx(zL,{filters:_,onFilterChange:k,onClearFilters:Pe,searchTerm:b,onSearchChange:M,viewMode:C,onViewModeChange:j,totalResults:K.length}),!d&&!p&&r.jsx(YL,{maintenanceRecords:K,viewMode:C,onEdit:w?R:null,onView:I,onDelete:w?ae:null,userRole:e?.role}),x&&r.jsx(KL,{isOpen:x,onClose:L,onSuccess:P,maintenance:$,mode:U,userRole:e?.role})]}):r.jsx("div",{className:"maintenance-main",children:r.jsxs("div",{className:"auth-required",children:[r.jsx("h2",{children:"🔐 Autenticación Requerida"}),r.jsx("p",{children:"Debes iniciar sesión para acceder al módulo de mantenimiento."})]})})},XL=({isOpen:n,onClose:e,product:t,mode:a="create",onSave:o,userRole:c})=>{const[d,f]=Y.useState({name:"",displayName:"",category:zs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),[p,v]=Y.useState({}),[_,N]=Y.useState(!1),C=[{value:"gal",label:"Galones (gal)"},{value:"L",label:"Litros (L)"},{value:"kg",label:"Kilogramos (kg)"},{value:"und",label:"Unidades (und)"}],j={[zs.COMBUSTIBLE]:["🛢️","🚛","🚗","⛽","🌿"],[zs.ACEITE]:["🛢️","⚙️","🔧","🚜","🏭"],[zs.LUBRICANTE]:["🟥","🟡","🔵","⚫","🟤"],[zs.FLUIDO]:["🛑","💧","🔴","🟢","🔵"]},b=["#FF6B35","#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#E91E63","#795548","#607D8B","#3F51B5"];Y.useEffect(()=>{f(t&&(a==="edit"||a==="view")?{name:t.name||"",displayName:t.displayName||"",category:t.category||zs.COMBUSTIBLE,unit:t.unit||"gal",defaultPrice:t.defaultPrice||0,color:t.color||"#FF6B35",icon:t.icon||"🛢️",description:t.description||"",isActive:t.isActive!==void 0?t.isActive:!0,currentStock:t.currentStock||0,minThreshold:t.minThreshold||10,maxCapacity:t.maxCapacity||1e3}:{name:"",displayName:"",category:zs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),v({})},[t,a,n]);const M=O=>{const{name:U,value:q,type:K,checked:w}=O.target;f(A=>({...A,[U]:K==="checkbox"?w:q})),p[U]&&v(A=>({...A,[U]:""}))},x=()=>{const O={};return d.name.trim()||(O.name="El nombre es requerido"),d.displayName.trim()||(O.displayName="El nombre de visualización es requerido"),d.category||(O.category="La categoría es requerida"),d.unit||(O.unit="La unidad es requerida"),d.defaultPrice<0&&(O.defaultPrice="El precio debe ser mayor o igual a 0"),d.currentStock<0&&(O.currentStock="El stock debe ser mayor o igual a 0"),d.minThreshold<0&&(O.minThreshold="El umbral mínimo debe ser mayor o igual a 0"),d.maxCapacity<=0&&(O.maxCapacity="La capacidad máxima debe ser mayor a 0"),d.minThreshold>=d.maxCapacity&&(O.minThreshold="El umbral mínimo debe ser menor que la capacidad máxima"),v(O),Object.keys(O).length===0},V=async O=>{if(O.preventDefault(),!!x()){N(!0);try{await o({...d,defaultPrice:parseFloat(d.defaultPrice),currentStock:parseFloat(d.currentStock),minThreshold:parseFloat(d.minThreshold),maxCapacity:parseFloat(d.maxCapacity)}),e()}catch(U){console.error("Error saving product:",U),v({submit:"Error al guardar el producto"})}finally{N(!1)}}};if(!n)return null;const $=["admin","supervisor"].includes(c)&&a!=="view";return r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content product-modal",children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[a==="create"&&"➕ Crear Producto",a==="edit"&&"✏️ Editar Producto",a==="view"&&"👁️ Ver Producto"]}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),r.jsxs("form",{onSubmit:V,className:"modal-body",children:[r.jsx("div",{className:"product-preview",children:r.jsxs("div",{className:"preview-card",children:[r.jsx("div",{className:"preview-icon",style:{color:d.color},children:d.icon}),r.jsxs("div",{className:"preview-info",children:[r.jsx("h3",{children:d.displayName||"Nombre del producto"}),r.jsx("p",{className:"preview-category",children:d.category}),r.jsx("p",{className:"preview-description",children:d.description}),r.jsxs("div",{className:"preview-price",children:["$",new Intl.NumberFormat("es-CO").format(d.defaultPrice)," / ",d.unit]})]})]})}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📝 Información Básica"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre Interno *"}),r.jsx("input",{type:"text",name:"name",value:d.name,onChange:M,disabled:!$,placeholder:"Ej: ACPM, GASOLINA"}),p.name&&r.jsx("span",{className:"error",children:p.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre de Visualización *"}),r.jsx("input",{type:"text",name:"displayName",value:d.displayName,onChange:M,disabled:!$,placeholder:"Ej: ACPM 🚛, Gasolina 🚗"}),p.displayName&&r.jsx("span",{className:"error",children:p.displayName})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Categoría *"}),r.jsx("select",{name:"category",value:d.category,onChange:M,disabled:!$,children:Object.values(zs).map(O=>r.jsx("option",{value:O,children:O},O))}),p.category&&r.jsx("span",{className:"error",children:p.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Descripción"}),r.jsx("textarea",{name:"description",value:d.description,onChange:M,disabled:!$,placeholder:"Descripción del producto...",rows:"3"})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"⚙️ Configuración"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Unidad de Medida *"}),r.jsx("select",{name:"unit",value:d.unit,onChange:M,disabled:!$,children:C.map(O=>r.jsx("option",{value:O.value,children:O.label},O.value))}),p.unit&&r.jsx("span",{className:"error",children:p.unit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio por Defecto"}),r.jsx("input",{type:"number",name:"defaultPrice",value:d.defaultPrice,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.defaultPrice&&r.jsx("span",{className:"error",children:p.defaultPrice})]}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",name:"isActive",checked:d.isActive,onChange:M,disabled:!$}),"Producto Activo"]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📊 Stock y Umbrales"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Stock Actual"}),r.jsx("input",{type:"number",name:"currentStock",value:d.currentStock,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.currentStock&&r.jsx("span",{className:"error",children:p.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Umbral Mínimo"}),r.jsx("input",{type:"number",name:"minThreshold",value:d.minThreshold,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.minThreshold&&r.jsx("span",{className:"error",children:p.minThreshold})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Capacidad Máxima"}),r.jsx("input",{type:"number",name:"maxCapacity",value:d.maxCapacity,onChange:M,disabled:!$,min:"1",step:"0.01"}),p.maxCapacity&&r.jsx("span",{className:"error",children:p.maxCapacity})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"🎨 Apariencia"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Icono"}),r.jsx("div",{className:"icon-selector",children:j[d.category]?.map(O=>r.jsx("button",{type:"button",className:`icon-option ${d.icon===O?"selected":""}`,onClick:()=>f(U=>({...U,icon:O})),disabled:!$,children:O},O))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Color"}),r.jsx("div",{className:"color-selector",children:b.map(O=>r.jsx("button",{type:"button",className:`color-option ${d.color===O?"selected":""}`,style:{backgroundColor:O},onClick:()=>f(U=>({...U,color:O})),disabled:!$},O))})]})]})]}),p.submit&&r.jsx("div",{className:"error-message",children:p.submit})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:_,children:a==="view"?"Cerrar":"Cancelar"}),$&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:V,disabled:_,children:_?"Guardando...":"Guardar"})]})]})})},WL=({products:n})=>{const[e,t]=Y.useState([]),[a,o]=Y.useState(!0);Y.useEffect(()=>{const b=Yv(M=>{t(M),o(!1)},M=>{console.error("Error loading movements for stats:",M),o(!1)});return()=>b()},[]);const c=()=>n.map(M=>{const x=e.filter(K=>K.fuelType===M.name||K.fuelType===M.displayName),V=x.filter(K=>K.type==="entrada"),$=x.filter(K=>K.type==="salida"),O=V.reduce((K,w)=>K+(w.quantity||0),0),U=$.reduce((K,w)=>K+(w.quantity||0),0),q=(M.currentStock||0)*(M.defaultPrice||0);return{...M,totalEntries:O,totalExits:U,totalValue:q,entriesCount:V.length,exitsCount:$.length,stockStatus:d(M)}}),d=b=>{const M=b.currentStock||0,x=b.minThreshold||0,V=b.maxCapacity||1e3;return M===0?"empty":M<=x?"low":M>=V*.9?"high":"normal"},f=b=>{const M={};return Object.values(zs).forEach(x=>{const V=b.filter($=>$.category===x);M[x]={totalProducts:V.length,totalStock:V.reduce(($,O)=>$+(O.currentStock||0),0),totalValue:V.reduce(($,O)=>$+O.totalValue,0),totalEntries:V.reduce(($,O)=>$+O.totalEntries,0),totalExits:V.reduce(($,O)=>$+O.totalExits,0),lowStockCount:V.filter($=>$.stockStatus==="low"||$.stockStatus==="empty").length}}),M};if(a)return r.jsxs("div",{className:"products-stats loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando estadísticas..."})]});const p=c(),v=f(p),_=n.length,N=n.filter(b=>b.isActive).length,C=p.reduce((b,M)=>b+M.totalValue,0),j=p.filter(b=>b.stockStatus==="low"||b.stockStatus==="empty").length;return r.jsxs("div",{className:"products-stats",children:[r.jsx("h2",{children:"📊 Estadísticas de Productos"}),r.jsxs("div",{className:"stats-general",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"📦"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:ze(_)}),r.jsx("p",{children:"Total Productos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"✅"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:ze(N)}),r.jsx("p",{children:"Productos Activos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:kn(C)}),r.jsx("p",{children:"Valor Total Stock"})]})]}),r.jsxs("div",{className:`stat-card ${j>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:ze(j)}),r.jsx("p",{children:"Stock Bajo"})]})]})]}),r.jsxs("div",{className:"stats-categories",children:[r.jsx("h3",{children:"📈 Por Categoría"}),r.jsx("div",{className:"categories-grid",children:Object.entries(v).map(([b,M])=>r.jsxs("div",{className:"category-card",children:[r.jsx("h4",{children:b}),r.jsxs("div",{className:"category-stats",children:[r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Productos:"}),r.jsx("span",{children:ze(M.totalProducts)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Stock Total:"}),r.jsxs("span",{children:[ze(M.totalStock)," unidades"]})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Valor:"}),r.jsx("span",{children:kn(M.totalValue)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Entradas:"}),r.jsx("span",{className:"positive",children:ze(M.totalEntries)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Salidas:"}),r.jsx("span",{className:"negative",children:ze(M.totalExits)})]}),M.lowStockCount>0&&r.jsxs("div",{className:"stat-row alert",children:[r.jsx("span",{children:"Stock Bajo:"}),r.jsx("span",{children:ze(M.lowStockCount)})]})]})]},b))})]}),r.jsxs("div",{className:"stats-top-products",children:[r.jsx("h3",{children:"🏆 Top Productos por Stock"}),r.jsx("div",{className:"top-products-list",children:p.sort((b,M)=>(M.currentStock||0)-(b.currentStock||0)).slice(0,5).map((b,M)=>r.jsxs("div",{className:"top-product-item",children:[r.jsxs("div",{className:"rank",children:["#",M+1]}),r.jsx("div",{className:"product-icon",style:{color:b.color},children:b.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:b.displayName}),r.jsxs("span",{className:"product-stock",children:[ze(b.currentStock||0)," ",b.unit]})]}),r.jsx("div",{className:"product-value",children:kn(b.totalValue)})]},b.id))})]}),j>0&&r.jsxs("div",{className:"stats-alerts",children:[r.jsx("h3",{children:"⚠️ Alertas de Stock"}),r.jsx("div",{className:"alerts-list",children:p.filter(b=>b.stockStatus==="low"||b.stockStatus==="empty").map(b=>r.jsxs("div",{className:`alert-item ${b.stockStatus}`,children:[r.jsx("div",{className:"alert-icon",children:b.stockStatus==="empty"?"🔴":"🟡"}),r.jsxs("div",{className:"alert-info",children:[r.jsx("span",{className:"alert-product",children:b.displayName}),r.jsxs("span",{className:"alert-stock",children:["Stock: ",ze(b.currentStock||0)," ",b.unit,b.stockStatus==="empty"&&" - ¡SIN STOCK!",b.stockStatus==="low"&&` - Mínimo: ${b.minThreshold}`]})]})]},b.id))})]})]})},ZL=({userProfile:n})=>{const[e,t]=Y.useState([]),[a,o]=Y.useState(!0),[c,d]=Y.useState(null),[f,p]=Y.useState(!1),[v,_]=Y.useState(null),[N,C]=Y.useState("create"),[j,b]=Y.useState(""),[M,x]=Y.useState(""),[V,$]=Y.useState(!0),O=["admin","supervisor"].includes(n?.role);Y.useEffect(()=>{o(!0);const I=EC(L=>{t(L),o(!1),d(null)},L=>{console.error("Error loading products:",L),d("Error cargando productos"),o(!1)});return()=>I()},[]),Y.useEffect(()=>{(async()=>{if(console.log("🔍 Debug - Inicializando productos:",{productsLength:e.length,loading:a,canManageProducts:O}),e.length===0&&!a&&O)try{console.log("🚀 Creando productos predefinidos...");const L=CT();console.log("📦 Productos predefinidos:",L);for(const P of L)console.log("➕ Creando producto:",P.name),await Yp({name:P.name,displayName:P.displayName,category:P.category,unit:P.unit,defaultPrice:P.defaultPrice,color:P.color,icon:P.icon,description:P.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});console.log("✅ Productos predefinidos creados exitosamente")}catch(L){console.error("❌ Error inicializando productos:",L)}else console.log("ℹ️ No se inicializan productos:",{reason:e.length>0?"Ya existen productos":a?"Está cargando":O?"Otra razón":"Sin permisos"})})()},[e.length,a,O]);const U=()=>{_(null),C("create"),p(!0)},q=I=>{_(I),C("edit"),p(!0)},K=I=>{_(I),C("view"),p(!0)},w=async I=>{if(window.confirm("¿Estás seguro de que deseas eliminar este producto?"))try{await hL(I)}catch(L){console.error("Error deleting product:",L),alert("Error al eliminar el producto")}},A=async I=>{try{N==="create"?await Yp(I):N==="edit"&&await dL(v.id,I),p(!1)}catch(L){throw console.error("Error saving product:",L),L}},R=e.filter(I=>{const L=I.displayName?.toLowerCase().includes(j.toLowerCase())||I.name?.toLowerCase().includes(j.toLowerCase()),P=!M||I.category===M;return L&&P});return a?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando productos..."})]})}):c?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"error-container",children:[r.jsxs("p",{children:["⚠️ ",c]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"products-main",children:[r.jsxs("div",{className:"products-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:"🛢️ Gestión de Productos"}),r.jsx("p",{children:"Administra los tipos de combustibles y productos disponibles"})]}),O&&r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{className:"btn-primary",onClick:U,children:"➕ Agregar Producto"}),r.jsx("button",{className:"btn-secondary",onClick:async()=>{try{console.log("🧪 Forzando creación de productos predefinidos...");const I=CT();for(const L of I)await Yp({name:L.name,displayName:L.displayName,category:L.category,unit:L.unit,defaultPrice:L.defaultPrice,color:L.color,icon:L.icon,description:L.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});alert("Productos predefinidos creados exitosamente")}catch(I){console.error("Error:",I),alert("Error creando productos: "+I.message)}},style:{marginLeft:"10px"},children:"🧪 Crear Predefinidos"})]})]}),V&&r.jsx(WL,{products:e}),r.jsxs("div",{className:"products-filters",children:[r.jsx("div",{className:"filter-group",children:r.jsx("input",{type:"text",placeholder:"🔍 Buscar productos...",value:j,onChange:I=>b(I.target.value),className:"search-input"})}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:M,onChange:I=>x(I.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"🏷️ Todas las categorías"}),Object.values(zs).map(I=>r.jsx("option",{value:I,children:I},I))]})}),r.jsx("div",{className:"filter-group",children:r.jsx("button",{className:`toggle-btn ${V?"active":""}`,onClick:()=>$(!V),children:"📊 Estadísticas"})})]}),r.jsx("div",{className:"products-grid",children:R.map(I=>r.jsxs("div",{className:"product-card",children:[r.jsx("div",{className:"product-icon",style:{color:I.color},children:I.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("h3",{children:I.displayName}),r.jsx("p",{className:"product-category",children:I.category}),r.jsx("p",{className:"product-description",children:I.description}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Stock:"}),r.jsxs("span",{className:"stat-value",children:[I.currentStock||0," ",I.unit]})]}),r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Precio:"}),r.jsxs("span",{className:"stat-value",children:["$",new Intl.NumberFormat("es-CO").format(I.defaultPrice||0)]})]})]}),r.jsx("div",{className:`product-status ${I.isActive?"active":"inactive"}`,children:I.isActive?"✅ Activo":"❌ Inactivo"})]}),r.jsxs("div",{className:"product-actions",children:[r.jsx("button",{className:"btn-secondary",onClick:()=>K(I),children:"👁️ Ver"}),O&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-primary",onClick:()=>q(I),children:"✏️ Editar"}),r.jsx("button",{className:"btn-danger",onClick:()=>w(I.id),children:"🗑️ Eliminar"})]})]})]},I.id))}),R.length===0&&r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📦"}),r.jsx("h3",{children:"No hay productos"}),r.jsx("p",{children:j||M?"No se encontraron productos con los filtros aplicados.":"Aún no hay productos registrados."}),O&&!j&&!M&&r.jsx("button",{className:"btn-primary",onClick:U,children:"➕ Crear primer producto"})]}),r.jsx(XL,{isOpen:f,onClose:()=>p(!1),product:v,mode:N,onSave:A,userRole:n?.role})]})},JL=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const[c,d]=Y.useState("name"),[f,p]=Y.useState("asc"),v=V=>{c===V?p(f==="asc"?"desc":"asc"):(d(V),p("asc"))},_=[...n].sort((V,$)=>{let O=V[c],U=$[c];switch(c){case"rating":O=O||0,U=U||0;break;case"totalOrders":case"totalPurchased":O=O||0,U=U||0;break;case"createdAt":case"lastOrderDate":O=O?O.toDate?O.toDate():new Date(O):new Date(0),U=U?U.toDate?U.toDate():new Date(U):new Date(0);break;default:O=(O||"").toString().toLowerCase(),U=(U||"").toString().toLowerCase()}return O<U?f==="asc"?-1:1:O>U?f==="asc"?1:-1:0}),N=V=>{switch(V){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},C=V=>{switch(V){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},j=V=>V?(V.toDate?V.toDate():new Date(V)).toLocaleDateString("es-CO"):"-",b=V=>{const $=[];for(let O=1;O<=5;O++)$.push(r.jsx("span",{className:`star ${O<=V?"filled":""}`,children:"★"},O));return r.jsx("div",{className:"rating-stars",children:$})},M=V=>!V||V.length===0?r.jsx("span",{className:"no-data",children:"-"}):r.jsxs("div",{className:"fuel-types-cell",children:[V.slice(0,2).map($=>r.jsx("span",{className:"fuel-badge-sm",children:jn[$]||$},$)),V.length>2&&r.jsxs("span",{className:"fuel-badge-sm more",title:V.slice(2).map($=>jn[$]||$).join(", "),children:["+",V.length-2]})]}),x=V=>c!==V?"icon-chevrons-up-down":f==="asc"?"icon-chevron-up":"icon-chevron-down";return r.jsxs("div",{className:"suppliers-table-container",children:[r.jsxs("div",{className:"table-wrapper",children:[r.jsxs("table",{className:"suppliers-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:`sortable ${c==="name"?"active":""}`,onClick:()=>v("name"),children:[r.jsx("span",{children:"Proveedor"}),r.jsx("i",{className:x("name")})]}),r.jsxs("th",{className:`sortable ${c==="status"?"active":""}`,onClick:()=>v("status"),children:[r.jsx("span",{children:"Estado"}),r.jsx("i",{className:x("status")})]}),r.jsxs("th",{className:`sortable ${c==="category"?"active":""}`,onClick:()=>v("category"),children:[r.jsx("span",{children:"Categoría"}),r.jsx("i",{className:x("category")})]}),r.jsx("th",{children:r.jsx("span",{children:"Combustibles"})}),r.jsx("th",{children:r.jsx("span",{children:"Contacto"})}),r.jsxs("th",{className:`sortable ${c==="rating"?"active":""}`,onClick:()=>v("rating"),children:[r.jsx("span",{children:"Rating"}),r.jsx("i",{className:x("rating")})]}),r.jsxs("th",{className:`sortable ${c==="totalOrders"?"active":""}`,onClick:()=>v("totalOrders"),children:[r.jsx("span",{children:"Órdenes"}),r.jsx("i",{className:x("totalOrders")})]}),r.jsxs("th",{className:`sortable ${c==="totalPurchased"?"active":""}`,onClick:()=>v("totalPurchased"),children:[r.jsx("span",{children:"Total Comprado"}),r.jsx("i",{className:x("totalPurchased")})]}),r.jsxs("th",{className:`sortable ${c==="createdAt"?"active":""}`,onClick:()=>v("createdAt"),children:[r.jsx("span",{children:"Creado"}),r.jsx("i",{className:x("createdAt")})]}),r.jsx("th",{className:"actions-column",children:r.jsx("span",{children:"Acciones"})})]})}),r.jsx("tbody",{children:_.map(V=>r.jsxs("tr",{className:`supplier-row ${V.status}`,children:[r.jsx("td",{className:"supplier-info-cell",children:r.jsxs("div",{className:"supplier-main-info",children:[r.jsxs("div",{className:"supplier-name",children:[V.name,V.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),V.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",V.taxId]}),V.type&&r.jsx("div",{className:"supplier-type",children:V.type.charAt(0).toUpperCase()+V.type.slice(1)})]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:"status-display",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:N(V.status)}}),r.jsx("span",{className:"status-label",children:C(V.status)})]})}),r.jsx("td",{className:"category-cell",children:r.jsx("span",{className:"category-label",children:V.category?.charAt(0).toUpperCase()+V.category?.slice(1)||"-"})}),r.jsx("td",{className:"fuel-types-cell",children:M(V.fuelTypes)}),r.jsx("td",{className:"contact-cell",children:r.jsxs("div",{className:"contact-info",children:[V.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:V.contactPerson})]}),V.phone&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("a",{href:`tel:${V.phone}`,children:V.phone})]}),V.email&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("a",{href:`mailto:${V.email}`,children:V.email})]}),V.city&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:V.city})]})]})}),r.jsx("td",{className:"rating-cell",children:r.jsxs("div",{className:"rating-display",children:[b(V.rating||0),r.jsx("span",{className:"rating-value",children:(V.rating||0).toFixed(1)})]})}),r.jsx("td",{className:"orders-cell",children:r.jsx("span",{className:"orders-count",children:V.totalOrders||0})}),r.jsx("td",{className:"purchased-cell",children:r.jsx("span",{className:"purchased-amount",children:kn(V.totalPurchased||0)})}),r.jsx("td",{className:"date-cell",children:r.jsx("span",{className:"date-value",children:j(V.createdAt)})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[a&&r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(V),title:"Editar proveedor",children:r.jsx("i",{className:"icon-edit"})}),o&&V.status==="active"&&r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(V.id,V.name),title:"Desactivar proveedor",children:r.jsx("i",{className:"icon-x-circle"})}),r.jsxs("div",{className:"quick-actions",children:[V.phone&&r.jsx("a",{href:`tel:${V.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),V.email&&r.jsx("a",{href:`mailto:${V.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})})]},V.id))})]}),_.length===0&&r.jsxs("div",{className:"table-empty-state",children:[r.jsx("i",{className:"icon-truck"}),r.jsx("p",{children:"No hay proveedores para mostrar"})]})]}),r.jsxs("div",{className:"table-footer",children:[r.jsx("div",{className:"table-info",children:r.jsxs("span",{children:["Mostrando ",_.length," proveedor",_.length!==1?"es":""]})}),r.jsx("div",{className:"table-actions",children:r.jsxs("span",{className:"sort-info",children:["Ordenado por: ",c==="name"?"Nombre":c==="status"?"Estado":c==="category"?"Categoría":c==="rating"?"Rating":c==="totalOrders"?"Órdenes":c==="totalPurchased"?"Total Comprado":c==="createdAt"?"Fecha de Creación":c," (",f==="asc"?"Ascendente":"Descendente",")"]})})]})]})},eV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const c=j=>{switch(j){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},d=j=>{switch(j){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},f=j=>{switch(j){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},p=j=>{switch(j){case"proveedor":return"Proveedor";case"distribuidor":return"Distribuidor";case"mayorista":return"Mayorista";default:return"Sin especificar"}},v=j=>j?(j.toDate?j.toDate():new Date(j)).toLocaleDateString("es-CO"):"No disponible",_=j=>{const b=[];for(let M=1;M<=5;M++)b.push(r.jsx("span",{className:`star ${M<=j?"filled":""}`,children:"★"},M));return r.jsx("div",{className:"rating-stars",children:b})},N=j=>!j||j.length===0?r.jsx("span",{className:"no-fuels",children:"Sin combustibles especificados"}):r.jsxs("div",{className:"fuel-types",children:[j.slice(0,3).map(b=>r.jsx("span",{className:"fuel-badge",title:jn[b],children:jn[b]||b},b)),j.length>3&&r.jsxs("span",{className:"fuel-badge more",title:`+${j.length-3} más`,children:["+",j.length-3]})]}),C=j=>{const b=[];return j.phone&&b.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("span",{children:j.phone})]},"phone")),j.email&&b.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("span",{children:j.email})]},"email")),j.city&&b.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:j.city})]},"city")),b.length>0?b:r.jsxs("div",{className:"contact-item no-contact",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:"Sin información de contacto"})]})};return r.jsx("div",{className:"suppliers-cards",children:n.map(j=>r.jsxs("div",{className:`supplier-card ${j.status}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsx("div",{className:"header-left",children:r.jsxs("div",{className:"supplier-info",children:[r.jsxs("h3",{className:"supplier-name",children:[j.name,j.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),j.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",j.taxId]})]})}),r.jsx("div",{className:"header-right",children:r.jsxs("div",{className:"supplier-status",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:c(j.status)}}),r.jsx("span",{className:"status-label",children:d(j.status)})]})})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"supplier-meta",children:[r.jsxs("div",{className:"meta-item",children:[r.jsx("span",{className:"meta-icon",children:f(j.category)}),r.jsx("span",{className:"meta-label",children:j.category?.charAt(0).toUpperCase()+j.category?.slice(1)||"Sin categoría"})]}),r.jsxs("div",{className:"meta-item",children:[r.jsx("i",{className:"icon-building meta-icon"}),r.jsx("span",{className:"meta-label",children:p(j.type)})]})]}),j.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:j.contactPerson})]}),r.jsx("div",{className:"contact-info",children:C(j)}),r.jsxs("div",{className:"fuel-types-section",children:[r.jsx("div",{className:"section-label",children:"Combustibles Suministrados:"}),N(j.fuelTypes)]}),r.jsxs("div",{className:"rating-section",children:[r.jsxs("div",{className:"rating-display",children:[_(j.rating||0),r.jsxs("span",{className:"rating-value",children:[(j.rating||0).toFixed(1),"/5"]})]}),j.evaluationNotes&&r.jsxs("div",{className:"evaluation-notes",title:j.evaluationNotes,children:[r.jsx("i",{className:"icon-message-square"}),r.jsx("span",{children:"Con evaluación"})]})]}),j.paymentTerms&&r.jsxs("div",{className:"payment-terms",children:[r.jsx("i",{className:"icon-credit-card"}),r.jsxs("span",{children:["Términos: ",j.paymentTerms==="contado"?"Contado":j.paymentTerms==="30dias"?"30 días":j.paymentTerms==="60dias"?"60 días":j.paymentTerms==="90dias"?"90 días":j.paymentTerms]})]}),r.jsxs("div",{className:"supplier-stats",children:[r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Órdenes:"}),r.jsx("span",{className:"stat-value",children:j.totalOrders||0})]}),r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Total Comprado:"}),r.jsx("span",{className:"stat-value",children:kn(j.totalPurchased||0)})]}),j.lastOrderDate&&r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Última Orden:"}),r.jsx("span",{className:"stat-value",children:v(j.lastOrderDate)})]})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsx("div",{className:"footer-info",children:r.jsxs("span",{className:"created-date",children:["Creado: ",v(j.createdAt)]})}),r.jsxs("div",{className:"card-actions",children:[a&&r.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(j),title:"Editar proveedor",children:[r.jsx("i",{className:"icon-edit"}),"Editar"]}),o&&j.status==="active"&&r.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>t(j.id,j.name),title:"Desactivar proveedor",children:[r.jsx("i",{className:"icon-x-circle"}),"Desactivar"]}),r.jsxs("div",{className:"quick-actions",children:[j.phone&&r.jsx("a",{href:`tel:${j.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),j.email&&r.jsx("a",{href:`mailto:${j.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})]})]},j.id))})},tV=({supplier:n,onClose:e,onSuccess:t,onError:a})=>{const{userProfile:o}=ea(),c=!!n,[d,f]=Y.useState({name:"",taxId:"",type:"proveedor",category:"combustibles",contactPerson:"",phone:"",email:"",address:"",city:"",state:"Colombia",fuelTypes:[],paymentTerms:"contado",creditLimit:"",priceList:{},rating:5,evaluationNotes:"",status:"active",isPreferred:!1}),[p,v]=Y.useState(!1),[_,N]=Y.useState({}),[C,j]=Y.useState("basic");Y.useEffect(()=>{c&&n&&f({name:n.name||"",taxId:n.taxId||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson||"",phone:n.phone||"",email:n.email||"",address:n.address||"",city:n.city||"",state:n.state||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:n.creditLimit||"",priceList:n.priceList||{},rating:n.rating||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1})},[c,n]);const b=(U,q)=>{f(K=>({...K,[U]:q})),_[U]&&N(K=>({...K,[U]:null}))},M=U=>{f(q=>({...q,fuelTypes:q.fuelTypes.includes(U)?q.fuelTypes.filter(K=>K!==U):[...q.fuelTypes,U]}))},x=(U,q)=>{f(K=>({...K,priceList:{...K.priceList,[U]:parseFloat(q)||0}}))},V=()=>{const U={};return d.name.trim()||(U.name="El nombre del proveedor es requerido"),d.category||(U.category="La categoría es requerida"),d.type||(U.type="El tipo de proveedor es requerido"),d.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)&&(U.email="El formato del email no es válido"),d.phone&&!/^[\d\s\-+()]+$/.test(d.phone)&&(U.phone="El formato del teléfono no es válido"),d.creditLimit&&(isNaN(d.creditLimit)||parseFloat(d.creditLimit)<0)&&(U.creditLimit="El límite de crédito debe ser un número positivo"),(d.rating<1||d.rating>5)&&(U.rating="El rating debe estar entre 1 y 5"),d.fuelTypes.forEach(q=>{d.priceList[q]&&(isNaN(d.priceList[q])||parseFloat(d.priceList[q])<0)&&(U[`price_${q}`]=`El precio de ${jn[q]} debe ser un número positivo`)}),N(U),Object.keys(U).length===0},$=async U=>{if(U.preventDefault(),!!V()){v(!0);try{const q={...d,creditLimit:parseFloat(d.creditLimit)||0,rating:parseFloat(d.rating)||5,priceList:Object.fromEntries(Object.entries(d.priceList).filter(([w,A])=>d.fuelTypes.includes(w)&&A>0))};let K;c?K=await CL(n.id,q,o?.email):K=await xL(q,o?.email),K.success?t():a(K.error||"Error al guardar proveedor")}catch(q){console.error("Error saving supplier:",q),a("Error inesperado al guardar proveedor")}finally{v(!1)}}},O=[{id:"basic",label:"Información Básica",icon:"icon-info"},{id:"contact",label:"Contacto",icon:"icon-phone"},{id:"products",label:"Productos",icon:"icon-package"},{id:"commercial",label:"Comercial",icon:"icon-credit-card"}];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-container large",onClick:U=>U.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[r.jsx("i",{className:"icon-truck"}),c?"Editar Proveedor":"Nuevo Proveedor"]}),r.jsx("button",{className:"modal-close",onClick:e,children:r.jsx("i",{className:"icon-x"})})]}),r.jsxs("form",{onSubmit:$,children:[r.jsx("div",{className:"modal-tabs",children:O.map(U=>r.jsxs("button",{type:"button",className:`tab-button ${C===U.id?"active":""}`,onClick:()=>j(U.id),children:[r.jsx("i",{className:U.icon}),U.label]},U.id))}),r.jsxs("div",{className:"modal-body",children:[C==="basic"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Nombre del Proveedor"}),r.jsx("input",{type:"text",value:d.name,onChange:U=>b("name",U.target.value),placeholder:"Ingresa el nombre del proveedor",className:_.name?"error":""}),_.name&&r.jsx("span",{className:"error-message",children:_.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"NIT / Documento"}),r.jsx("input",{type:"text",value:d.taxId,onChange:U=>b("taxId",U.target.value),placeholder:"123456789-0",className:_.taxId?"error":""}),_.taxId&&r.jsx("span",{className:"error-message",children:_.taxId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Tipo de Proveedor"}),r.jsxs("select",{value:d.type,onChange:U=>b("type",U.target.value),className:_.type?"error":"",children:[r.jsx("option",{value:"proveedor",children:"Proveedor"}),r.jsx("option",{value:"distribuidor",children:"Distribuidor"}),r.jsx("option",{value:"mayorista",children:"Mayorista"})]}),_.type&&r.jsx("span",{className:"error-message",children:_.type})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Categoría"}),r.jsxs("select",{value:d.category,onChange:U=>b("category",U.target.value),className:_.category?"error":"",children:[r.jsx("option",{value:"combustibles",children:"Combustibles"}),r.jsx("option",{value:"lubricantes",children:"Lubricantes"}),r.jsx("option",{value:"aditivos",children:"Aditivos"})]}),_.category&&r.jsx("span",{className:"error-message",children:_.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:d.status,onChange:U=>b("status",U.target.value),children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"suspended",children:"Suspendido"})]})]}),r.jsx("div",{className:"form-group checkbox",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.isPreferred,onChange:U=>b("isPreferred",U.target.checked)}),r.jsx("span",{className:"checkbox-mark"}),"Proveedor Preferido"]})})]})}),C==="contact"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Persona de Contacto"}),r.jsx("input",{type:"text",value:d.contactPerson,onChange:U=>b("contactPerson",U.target.value),placeholder:"Nombre del contacto principal"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Teléfono"}),r.jsx("input",{type:"tel",value:d.phone,onChange:U=>b("phone",U.target.value),placeholder:"+57 300 123 4567",className:_.phone?"error":""}),_.phone&&r.jsx("span",{className:"error-message",children:_.phone})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{type:"email",value:d.email,onChange:U=>b("email",U.target.value),placeholder:"contacto@proveedor.com",className:_.email?"error":""}),_.email&&r.jsx("span",{className:"error-message",children:_.email})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ciudad"}),r.jsx("input",{type:"text",value:d.city,onChange:U=>b("city",U.target.value),placeholder:"Bogotá"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado/País"}),r.jsx("input",{type:"text",value:d.state,onChange:U=>b("state",U.target.value),placeholder:"Colombia"})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Dirección"}),r.jsx("textarea",{value:d.address,onChange:U=>b("address",U.target.value),placeholder:"Dirección completa del proveedor",rows:"3"})]})]})}),C==="products"&&r.jsxs("div",{className:"tab-content",children:[r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Tipos de Combustible que Suministra"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(jn).map(([U,q])=>r.jsx("div",{className:"fuel-type-item",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.fuelTypes.includes(U),onChange:()=>M(U)}),r.jsx("span",{className:"checkbox-mark"}),q]})},U))})]}),d.fuelTypes.length>0&&r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Precios por Litro (Opcional)"}),r.jsx("div",{className:"prices-grid",children:d.fuelTypes.map(U=>r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:jn[U]}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.priceList[U]||"",onChange:q=>x(U,q.target.value),placeholder:"0.00",className:_[`price_${U}`]?"error":""})]}),_[`price_${U}`]&&r.jsx("span",{className:"error-message",children:_[`price_${U}`]})]},U))})]})]}),C==="commercial"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Términos de Pago"}),r.jsxs("select",{value:d.paymentTerms,onChange:U=>b("paymentTerms",U.target.value),children:[r.jsx("option",{value:"contado",children:"Contado"}),r.jsx("option",{value:"30dias",children:"30 días"}),r.jsx("option",{value:"60dias",children:"60 días"}),r.jsx("option",{value:"90dias",children:"90 días"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Límite de Crédito"}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.creditLimit,onChange:U=>b("creditLimit",U.target.value),placeholder:"0.00",className:_.creditLimit?"error":""})]}),_.creditLimit&&r.jsx("span",{className:"error-message",children:_.creditLimit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Rating"}),r.jsxs("div",{className:"rating-input",children:[r.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:d.rating,onChange:U=>b("rating",parseFloat(U.target.value)),className:_.rating?"error":""}),r.jsxs("div",{className:"rating-display",children:[r.jsx("span",{className:"rating-value",children:d.rating.toFixed(1)}),r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(U=>r.jsx("span",{className:`star ${U<=Math.round(d.rating)?"filled":""}`,children:"★"},U))})]})]}),_.rating&&r.jsx("span",{className:"error-message",children:_.rating})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Notas de Evaluación"}),r.jsx("textarea",{value:d.evaluationNotes,onChange:U=>b("evaluationNotes",U.target.value),placeholder:"Comentarios sobre el desempeño del proveedor...",rows:"4"})]})]})})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"loading-spinner small"}),c?"Actualizando...":"Creando..."]}):r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"icon-save"}),c?"Actualizar Proveedor":"Crear Proveedor"]})})]})]})]})})},nV=({stats:n,suppliersCount:e,totalSuppliers:t})=>{if(!n)return null;const a=d=>{switch(d){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},c=d=>{switch(d){case"proveedor":return"🏪";case"distribuidor":return"🚛";case"mayorista":return"🏭";default:return"🏢"}};return r.jsxs("div",{className:"suppliers-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.total)}),r.jsx("div",{className:"stat-label",children:"Total Proveedores"}),t!==e&&r.jsxs("div",{className:"stat-sublabel",children:[ze(e)," mostrados"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-check-circle"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.active)}),r.jsx("div",{className:"stat-label",children:"Activos"}),r.jsx("div",{className:"stat-sublabel",children:Ar(n.total>0?n.active/n.total:0)})]})]}),r.jsxs("div",{className:"stat-card warning",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-star"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.preferred)}),r.jsx("div",{className:"stat-label",children:"Preferidos"}),r.jsx("div",{className:"stat-sublabel",children:Ar(n.active>0?n.preferred/n.active:0)})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-award"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:n.averageRating.toFixed(1)}),r.jsx("div",{className:"stat-label",children:"Rating Promedio"}),r.jsx("div",{className:"stat-sublabel",children:r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(d=>r.jsx("span",{className:`star ${d<=Math.round(n.averageRating)?"filled":""}`,children:"★"},d))})})]})]})]}),r.jsxs("div",{className:"stats-details",children:[r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Estado de Proveedores"}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("active")}}),"Activos"]}),r.jsx("div",{className:"breakdown-value",children:n.active}),r.jsx("div",{className:"breakdown-percentage",children:Ar(n.total>0?n.active/n.total:0)})]}),n.inactive>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("inactive")}}),"Inactivos"]}),r.jsx("div",{className:"breakdown-value",children:n.inactive}),r.jsx("div",{className:"breakdown-percentage",children:Ar(n.total>0?n.inactive/n.total:0)})]}),n.suspended>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("suspended")}}),"Suspendidos"]}),r.jsx("div",{className:"breakdown-value",children:n.suspended}),r.jsx("div",{className:"breakdown-percentage",children:Ar(n.total>0?n.suspended/n.total:0)})]})]})]}),Object.keys(n.byCategory).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Categoría"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byCategory).sort(([,d],[,f])=>f-d).map(([d,f])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"category-icon",children:o(d)}),d.charAt(0).toUpperCase()+d.slice(1).replace("_"," ")]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-percentage",children:Ar(n.total>0?f/n.total:0)})]},d))})]}),Object.keys(n.byType).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Tipo"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byType).sort(([,d],[,f])=>f-d).map(([d,f])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"type-icon",children:c(d)}),d.charAt(0).toUpperCase()+d.slice(1)]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-percentage",children:Ar(n.total>0?f/n.total:0)})]},d))})]})]}),r.jsxs("div",{className:"stats-insights",children:[r.jsx("h3",{children:"Información Rápida"}),r.jsxs("div",{className:"insights-grid",children:[r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Nivel de Satisfacción"}),r.jsx("div",{className:"insight-value",children:n.averageRating>=4.5?"Excelente":n.averageRating>=4?"Muy Bueno":n.averageRating>=3.5?"Bueno":n.averageRating>=3?"Regular":"Necesita Mejora"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Estado General"}),r.jsx("div",{className:"insight-value",children:n.active/n.total>=.9?"Excelente":n.active/n.total>=.8?"Bueno":n.active/n.total>=.7?"Regular":"Revisar"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Proveedores Preferidos"}),r.jsx("div",{className:"insight-value",children:n.preferred===0?"Ninguno":n.preferred/n.active>=.3?"Suficientes":n.preferred/n.active>=.2?"Buenos":"Pocos"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Diversificación"}),r.jsx("div",{className:"insight-value",children:Object.keys(n.byCategory).length>=3?"Alta":Object.keys(n.byCategory).length>=2?"Media":"Baja"})]})]})]})]})},sV=({searchTerm:n,setSearchTerm:e,filterStatus:t,setFilterStatus:a,filterCategory:o,setFilterCategory:c,filterFuelType:d,setFilterFuelType:f,viewMode:p,setViewMode:v,onClearFilters:_,resultsCount:N})=>{const C=[{value:"all",label:"Todos los Estados",icon:"list"},{value:"active",label:"Activos",icon:"check-circle"},{value:"inactive",label:"Inactivos",icon:"x-circle"},{value:"suspended",label:"Suspendidos",icon:"alert-circle"},{value:"preferred",label:"Preferidos",icon:"star"}],j=[{value:"all",label:"Todas las Categorías",icon:"grid"},{value:"combustibles",label:"Combustibles",icon:"fuel"},{value:"lubricantes",label:"Lubricantes",icon:"droplets"},{value:"aditivos",label:"Aditivos",icon:"flask"}],b=[{value:"all",label:"Todos los Combustibles",icon:"fuel"},...Object.entries(jn).map(([x,V])=>({value:x,label:V,icon:"droplet"}))],M=n||t!=="all"||o!=="all"||d!=="all";return r.jsxs("div",{className:"suppliers-filters",children:[r.jsxs("div",{className:"filters-top",children:[r.jsx("div",{className:"search-container",children:r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx("i",{className:"icon-search search-icon"}),r.jsx("input",{type:"text",placeholder:"Buscar por nombre, NIT, contacto, ciudad...",value:n,onChange:x=>e(x.target.value),className:"search-input"}),n&&r.jsx("button",{className:"search-clear",onClick:()=>e(""),title:"Limpiar búsqueda",children:r.jsx("i",{className:"icon-x"})})]})}),r.jsxs("div",{className:"view-controls",children:[r.jsxs("div",{className:"view-mode-toggle",children:[r.jsx("button",{className:`view-btn ${p==="cards"?"active":""}`,onClick:()=>v("cards"),title:"Vista de tarjetas",children:r.jsx("i",{className:"icon-grid"})}),r.jsx("button",{className:`view-btn ${p==="table"?"active":""}`,onClick:()=>v("table"),title:"Vista de tabla",children:r.jsx("i",{className:"icon-list"})})]}),M&&r.jsxs("button",{className:"btn btn-secondary clear-filters",onClick:_,title:"Limpiar todos los filtros",children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar"]})]})]}),r.jsxs("div",{className:"filters-dropdowns",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Estado"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:t,onChange:x=>a(x.target.value),className:"filter-select",children:C.map(x=>r.jsx("option",{value:x.value,children:x.label},x.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Categoría"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:o,onChange:x=>c(x.target.value),className:"filter-select",children:j.map(x=>r.jsx("option",{value:x.value,children:x.label},x.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:d,onChange:x=>f(x.target.value),className:"filter-select",children:b.map(x=>r.jsx("option",{value:x.value,children:x.label},x.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]})]}),r.jsxs("div",{className:"filters-summary",children:[r.jsxs("div",{className:"results-count",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:N===0?"No se encontraron proveedores":`Mostrando ${N} proveedor${N!==1?"es":""}`})]}),M&&r.jsxs("div",{className:"active-filters",children:[r.jsx("span",{className:"filters-label",children:"Filtros activos:"}),r.jsxs("div",{className:"filter-tags",children:[n&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-search"}),n,r.jsx("button",{onClick:()=>e(""),children:r.jsx("i",{className:"icon-x"})})]}),t!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-filter"}),C.find(x=>x.value===t)?.label,r.jsx("button",{onClick:()=>a("all"),children:r.jsx("i",{className:"icon-x"})})]}),o!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-tag"}),j.find(x=>x.value===o)?.label,r.jsx("button",{onClick:()=>c("all"),children:r.jsx("i",{className:"icon-x"})})]}),d!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-droplet"}),b.find(x=>x.value===d)?.label,r.jsx("button",{onClick:()=>f("all"),children:r.jsx("i",{className:"icon-x"})})]})]})]})]}),r.jsxs("div",{className:"quick-filters",children:[r.jsx("span",{className:"quick-filters-label",children:"Acceso rápido:"}),r.jsxs("div",{className:"quick-filter-buttons",children:[r.jsxs("button",{className:`quick-filter-btn ${t==="preferred"?"active":""}`,onClick:()=>a(t==="preferred"?"all":"preferred"),children:[r.jsx("i",{className:"icon-star"}),"Preferidos"]}),r.jsxs("button",{className:`quick-filter-btn ${t==="active"?"active":""}`,onClick:()=>a(t==="active"?"all":"active"),children:[r.jsx("i",{className:"icon-check-circle"}),"Activos"]}),r.jsxs("button",{className:`quick-filter-btn ${o==="combustibles"?"active":""}`,onClick:()=>c(o==="combustibles"?"all":"combustibles"),children:[r.jsx("i",{className:"icon-fuel"}),"Combustibles"]}),r.jsxs("button",{className:`quick-filter-btn ${d==="diesel"?"active":""}`,onClick:()=>f(d==="diesel"?"all":"diesel"),children:[r.jsx("i",{className:"icon-droplet"}),"Diésel"]})]})]})]})},aV=()=>{const{hasPermission:n,userProfile:e}=ea(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState("cards"),[C,j]=Y.useState(!1),[b,M]=Y.useState(null),[x,V]=Y.useState("all"),[$,O]=Y.useState("all"),[U,q]=Y.useState("all"),[K,w]=Y.useState("");Y.useEffect(()=>{let B=null;return(()=>{B=AL(ce=>{a(ce||[]),f(!1)})})(),()=>{B&&B()}},[]),Y.useEffect(()=>{const B=async()=>{const J=await SL();J.success&&c(J.data)};t.length>0&&B()},[t]);const A=t.filter(B=>{const J=!K||B.name?.toLowerCase().includes(K.toLowerCase())||B.taxId?.toLowerCase().includes(K.toLowerCase())||B.contactPerson?.toLowerCase().includes(K.toLowerCase())||B.city?.toLowerCase().includes(K.toLowerCase()),ce=x==="all"||(x==="preferred"?B.isPreferred:B.status===x),ve=$==="all"||B.category===$,H=U==="all"||B.fuelTypes&&B.fuelTypes.includes(U);return J&&ce&&ve&&H}),R=()=>{if(!n("canManageSuppliers")){v("No tienes permisos para agregar proveedores");return}M(null),j(!0)},I=B=>{if(!n("canManageSuppliers")){v("No tienes permisos para editar proveedores");return}M(B),j(!0)},L=async(B,J)=>{if(!n("canManageSuppliers")){v("No tienes permisos para eliminar proveedores");return}if(window.confirm(`¿Estás seguro de que deseas desactivar el proveedor "${J}"?

Esta acción se puede revertir cambiando su estado a activo.`))try{const ce=await jL(B,e?.email);ce.success?v(null):v(ce.error||"Error al desactivar proveedor")}catch(ce){console.error("Error deleting supplier:",ce),v("Error inesperado al eliminar proveedor")}},P=()=>{j(!1),M(null),v(null)},k=()=>{j(!1),M(null),v(null)},Pe=()=>{V("all"),O("all"),q("all"),w("")},ae=()=>{if(!n("canExportReports")){v("No tienes permisos para exportar datos");return}try{const B=A.map(ne=>({Nombre:ne.name,"NIT/Documento":ne.taxId,Tipo:ne.type,Categoría:ne.category,"Persona de Contacto":ne.contactPerson,Teléfono:ne.phone,Email:ne.email,Ciudad:ne.city,Combustibles:ne.fuelTypes?.join(", "),Rating:ne.rating,Estado:ne.status,Preferido:ne.isPreferred?"Sí":"No","Fecha Creación":ne.createdAt?.toDate?.()?.toLocaleDateString()||"N/A"})),J=[Object.keys(B[0]).join(","),...B.map(ne=>Object.values(ne).map(he=>`"${he||""}"`).join(","))].join(`
`),ce=new Blob([J],{type:"text/csv;charset=utf-8;"}),ve=document.createElement("a"),H=URL.createObjectURL(ce);ve.setAttribute("href",H),ve.setAttribute("download",`proveedores_${new Date().toISOString().split("T")[0]}.csv`),ve.style.visibility="hidden",document.body.appendChild(ve),ve.click(),document.body.removeChild(ve)}catch(B){console.error("Error exporting suppliers:",B),v("Error al exportar proveedores")}};return d?r.jsx("div",{className:"suppliers-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando proveedores..."})]})}):r.jsxs("div",{className:"suppliers-main",children:[r.jsxs("div",{className:"suppliers-header",children:[r.jsxs("div",{className:"header-content",children:[r.jsx("h1",{children:"Gestión de Proveedores"}),r.jsx("p",{className:"header-subtitle",children:"Administra los proveedores de combustibles y materiales"})]}),r.jsxs("div",{className:"header-actions",children:[n("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:R,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Proveedor"]}),n("canExportReports")&&r.jsxs("button",{className:"btn btn-secondary",onClick:ae,disabled:A.length===0,children:[r.jsx("i",{className:"icon-download"}),"Exportar"]})]})]}),p&&r.jsxs("div",{className:"alert alert-error",children:[r.jsx("i",{className:"icon-alert-circle"}),r.jsx("span",{children:p}),r.jsx("button",{onClick:()=>v(null),className:"alert-close",children:r.jsx("i",{className:"icon-x"})})]}),o&&r.jsx(nV,{stats:o,suppliersCount:A.length,totalSuppliers:t.length}),r.jsx(sV,{searchTerm:K,setSearchTerm:w,filterStatus:x,setFilterStatus:V,filterCategory:$,setFilterCategory:O,filterFuelType:U,setFilterFuelType:q,viewMode:_,setViewMode:N,onClearFilters:Pe,resultsCount:A.length}),A.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsx("h3",{children:"No hay proveedores"}),r.jsx("p",{children:t.length===0?"Comienza agregando tu primer proveedor de combustibles.":"No se encontraron proveedores que coincidan con los filtros aplicados."}),t.length===0&&n("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:R,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Primer Proveedor"]}),t.length>0&&r.jsxs("button",{className:"btn btn-secondary",onClick:Pe,children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar Filtros"]})]}):r.jsx("div",{className:"suppliers-content",children:_==="cards"?r.jsx(eV,{suppliers:A,onEdit:I,onDelete:L,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")}):r.jsx(JL,{suppliers:A,onEdit:I,onDelete:L,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")})}),C&&r.jsx(tV,{supplier:b,onClose:P,onSuccess:k,onError:v})]})},iV=()=>{const{user:n,userProfile:e}=ea(),[t,a]=Y.useState("invitations"),[o,c]=Y.useState([]),[d,f]=Y.useState(!1),[p,v]=Y.useState(!1),[_,N]=Y.useState(!1),[C,j]=Y.useState({email:"",name:"",role:Ns.CLIENTE});Y.useEffect(()=>{n&&e?.role==="admin"&&b()},[n,e]);const b=async()=>{f(!0);try{const U=await q2(n.uid);U.success?c(U.invitations):console.error("Error loading invitations:",U.error)}catch(U){console.error("Error loading invitations:",U)}finally{f(!1)}},M=async U=>{U.preventDefault(),N(!0);try{const q=await F2(C,n.uid);q.success?(j({email:"",name:"",role:Ns.CLIENTE}),v(!1),await b(),alert(`Invitación creada exitosamente!
Código: ${q.invitation.code}`)):alert(`Error: ${q.error}`)}catch(q){console.error("Error creating invitation:",q),alert("Error creando invitación")}finally{N(!1)}},x=async U=>{if(confirm("¿Estás seguro de cancelar esta invitación?"))try{const q=await B2(U,n.uid);q.success?(await b(),alert("Invitación cancelada exitosamente")):alert(`Error: ${q.error}`)}catch(q){console.error("Error cancelling invitation:",q),alert("Error cancelando invitación")}},V=U=>({pending:{text:"Pendiente",class:"status-pending"},used:{text:"Usada",class:"status-used"},cancelled:{text:"Cancelada",class:"status-cancelled"},expired:{text:"Expirada",class:"status-expired"}})[U]||{text:U,class:"status-unknown"},$=U=>({admin:"Administrador",contador:"Contador",cliente:"Cliente"})[U]||U,O=U=>U?(U.toDate?U.toDate():new Date(U)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e?.role!=="admin"?r.jsxs("div",{className:"admin-unauthorized",children:[r.jsx("h2",{children:"⛔ Acceso Denegado"}),r.jsx("p",{children:"Solo los administradores pueden acceder a esta sección."})]}):r.jsxs("div",{className:"admin-main",children:[r.jsxs("div",{className:"admin-header",children:[r.jsx("h1",{children:"⚙️ Administración del Sistema"}),r.jsx("p",{children:"Gestión de usuarios y configuraciones"})]}),r.jsxs("div",{className:"admin-tabs",children:[r.jsx("button",{className:`tab-button ${t==="invitations"?"active":""}`,onClick:()=>a("invitations"),children:"🎫 Invitaciones"}),r.jsx("button",{className:`tab-button ${t==="users"?"active":""}`,onClick:()=>a("users"),children:"👥 Usuarios"}),r.jsx("button",{className:`tab-button ${t==="settings"?"active":""}`,onClick:()=>a("settings"),children:"⚙️ Configuración"})]}),r.jsxs("div",{className:"admin-content",children:[t==="invitations"&&r.jsxs("div",{className:"invitations-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h2",{children:"Gestión de Invitaciones"}),r.jsx("button",{className:"create-button",onClick:()=>v(!0),children:"+ Crear Invitación"})]}),d?r.jsx("div",{className:"loading",children:"Cargando invitaciones..."}):r.jsxs("div",{className:"invitations-table",children:[r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Código"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Rol"}),r.jsx("th",{children:"Estado"}),r.jsx("th",{children:"Creada"}),r.jsx("th",{children:"Expira"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(U=>{const q=V(U.status);return r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("code",{className:"invitation-code",children:U.code})}),r.jsx("td",{children:U.targetEmail}),r.jsx("td",{children:U.targetName||"-"}),r.jsx("td",{children:$(U.targetRole)}),r.jsx("td",{children:r.jsx("span",{className:`status-badge ${q.class}`,children:q.text})}),r.jsx("td",{children:O(U.createdAt)}),r.jsx("td",{children:O(U.expiresAt)}),r.jsx("td",{children:U.status==="pending"&&r.jsx("button",{className:"cancel-button",onClick:()=>x(U.id),children:"Cancelar"})})]},U.id)})})]}),o.length===0&&r.jsx("div",{className:"empty-state",children:r.jsx("p",{children:"No hay invitaciones creadas"})})]})]}),t==="users"&&r.jsxs("div",{className:"users-section",children:[r.jsx("h2",{children:"👥 Usuarios del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Lista de usuarios registrados, edición de permisos, y estadísticas."})]})]}),t==="settings"&&r.jsxs("div",{className:"settings-section",children:[r.jsx("h2",{children:"⚙️ Configuración del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Configuraciones generales, notificaciones, y parámetros del sistema."})]})]})]}),p&&r.jsx("div",{className:"modal-overlay",onClick:()=>v(!1),children:r.jsxs("div",{className:"modal-content",onClick:U=>U.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Crear Nueva Invitación"}),r.jsx("button",{className:"modal-close",onClick:()=>v(!1),children:"×"})]}),r.jsxs("form",{onSubmit:M,className:"invitation-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email del usuario:"}),r.jsx("input",{id:"email",type:"email",required:!0,value:C.email,onChange:U=>j({...C,email:U.target.value}),placeholder:"usuario@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Nombre (opcional):"}),r.jsx("input",{id:"name",type:"text",value:C.name,onChange:U=>j({...C,name:U.target.value}),placeholder:"Nombre del usuario"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"role",children:"Rol:"}),r.jsxs("select",{id:"role",value:C.role,onChange:U=>j({...C,role:U.target.value}),children:[r.jsx("option",{value:Ns.CLIENTE,children:"Cliente"}),r.jsx("option",{value:Ns.CONTADOR,children:"Contador"}),r.jsx("option",{value:Ns.ADMIN,children:"Administrador"})]})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"cancel-button",onClick:()=>v(!1),children:"Cancelar"}),r.jsx("button",{type:"submit",className:"create-button",disabled:_,children:_?"Creando...":"Crear Invitación"})]})]})]})})]})},rV=()=>r.jsxs("div",{className:"module-placeholder",children:[r.jsx("h2",{children:"📋 Módulo de Reportes"}),r.jsx("p",{children:"Análisis y reportes de combustibles"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Reportes personalizables, gráficos interactivos, y exportación."})]})]}),oV=()=>{const[n,e]=Y.useState("dashboard"),t=()=>{switch(n){case"dashboard":return r.jsx(ST,{});case"inventory":return r.jsx(yL,{});case"movements":return r.jsx(IL,{});case"vehicles":return r.jsx(UL,{});case"maintenance":return r.jsx(QL,{});case"products":return r.jsx(ZL,{});case"suppliers":return r.jsx(aV,{});case"reports":return r.jsx(rV,{});case"admin":return r.jsx(iV,{});default:return r.jsx(ST,{})}};return r.jsx($2,{currentView:n,onViewChange:e,children:t()})},lV=()=>{const[n,e]=Y.useState("login"),[t,a]=Y.useState(!1),[o,c]=Y.useState(""),[d,f]=Y.useState(""),[p,v]=Y.useState(""),[_,N]=Y.useState(""),[C,j]=Y.useState({email:"",password:"",confirmPassword:"",invitationCode:""}),[b,M]=Y.useState(""),[x,V]=Y.useState(null),$=async R=>{R.preventDefault(),a(!0),c("");try{await $I(Jo,p,_)}catch(I){console.error("Error en login:",I),c(K(I.code))}finally{a(!1)}},O=async()=>{a(!0),c("");try{const R=new Sa,I=await gR(Jo,R);x?await TT(I.user,x.code):await lC(I.user)}catch(R){console.error("Error en login con Google:",R),c("Error al iniciar sesión con Google")}finally{a(!1)}},U=async R=>{R.preventDefault(),a(!0),c(""),f("");try{const I=await oC(b);I.success?(V(I.invitation),f(`Invitación válida para: ${I.invitation.targetEmail}`),e("register"),j({...C,email:I.invitation.targetEmail,invitationCode:b})):c(I.error)}catch(I){console.error("Error validando invitación:",I),c("Error validando código de invitación")}finally{a(!1)}},q=async R=>{if(R.preventDefault(),a(!0),c(""),C.password!==C.confirmPassword){c("Las contraseñas no coinciden"),a(!1);return}if(C.password.length<6){c("La contraseña debe tener al menos 6 caracteres"),a(!1);return}try{const I=await GI(Jo,C.email,C.password),L=await TT(I.user,C.invitationCode);L.success?f("¡Registro exitoso! Bienvenido al sistema."):c(L.error)}catch(I){console.error("Error en registro:",I),c(K(I.code))}finally{a(!1)}},K=R=>{switch(R){case"auth/invalid-email":return"El formato del email es inválido";case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contraseña incorrecta";case"auth/invalid-credential":return"Email o contraseña incorrectos";case"auth/email-already-in-use":return"Este email ya está registrado";case"auth/weak-password":return"La contraseña es muy débil";default:return"Error de autenticación. Inténtalo de nuevo."}},w=()=>{c(""),f(""),v(""),N(""),M(""),V(null),j({email:"",password:"",confirmPassword:"",invitationCode:""})},A=()=>{switch(n){case"login":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:$,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email:"}),r.jsx("input",{id:"email",type:"email",value:p,onChange:R=>v(R.target.value),required:!0,disabled:t,placeholder:"tu-email@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Contraseña:"}),r.jsx("input",{id:"password",type:"password",value:_,onChange:R=>N(R.target.value),required:!0,disabled:t,placeholder:"Tu contraseña"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Iniciando sesión...":"Iniciar Sesión"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:O,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:"🔗"}),"Continuar con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{w(),e("invite")},children:"¿Tienes un código de invitación? Regístrate aquí"})})]});case"invite":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:U,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"inviteCode",children:"Código de invitación:"}),r.jsx("input",{id:"inviteCode",type:"text",value:b,onChange:R=>M(R.target.value.toUpperCase()),required:!0,disabled:t,placeholder:"XXXXXXXX",maxLength:8,style:{textTransform:"uppercase",fontFamily:"monospace"}}),r.jsx("small",{children:"Ingresa el código de 8 caracteres que recibiste"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Validando...":"Validar Código"})]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{w(),e("login")},children:"Volver al inicio de sesión"})})]});case"register":return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"invitation-info",children:r.jsxs("div",{className:"success-message",children:["✅ Código válido para: ",x?.targetEmail]})}),r.jsxs("form",{onSubmit:q,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerEmail",children:"Email:"}),r.jsx("input",{id:"registerEmail",type:"email",value:C.email,disabled:!0,className:"disabled-input"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerPassword",children:"Contraseña:"}),r.jsx("input",{id:"registerPassword",type:"password",value:C.password,onChange:R=>j({...C,password:R.target.value}),required:!0,disabled:t,placeholder:"Mínimo 6 caracteres",minLength:6})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar contraseña:"}),r.jsx("input",{id:"confirmPassword",type:"password",value:C.confirmPassword,onChange:R=>j({...C,confirmPassword:R.target.value}),required:!0,disabled:t,placeholder:"Repite tu contraseña"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Registrando...":"Crear Cuenta"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:O,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:"🔗"}),"Registrarse con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{w(),e("invite")},children:"Usar otro código de invitación"})})]});default:return null}};return r.jsx("div",{className:"auth-container",children:r.jsxs("div",{className:"auth-card",children:[r.jsxs("div",{className:"auth-header",children:[r.jsx("h1",{children:"⛽ Combustibles"}),r.jsx("h2",{children:"Forestech Colombia"}),r.jsxs("p",{children:[n==="login"&&"Sistema de gestión de combustibles",n==="invite"&&"Validar código de invitación",n==="register"&&"Crear nueva cuenta"]})]}),r.jsxs("div",{className:"auth-form",children:[o&&r.jsx("div",{className:"error-message",children:o}),d&&r.jsx("div",{className:"success-message",children:d}),A(),r.jsx("div",{className:"auth-footer",children:r.jsx("p",{children:r.jsxs("small",{children:["Solo usuarios autorizados pueden acceder al sistema.",r.jsx("br",{}),n==="login"?"Contacta al administrador para obtener un código de invitación.":"Si no tienes código, contacta al administrador."]})})})]})]})})};function cV(){return r.jsx(G2,{children:r.jsx(uV,{})})}function uV(){const{user:n,loading:e}=ea();return e?r.jsx("div",{className:"loading-container",children:r.jsxs("div",{className:"loader",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Cargando..."})]})}):r.jsxs("div",{className:"App",children:[!n&&r.jsx(lV,{}),n&&r.jsx(oV,{})]})}dS.createRoot(document.getElementById("root")).render(r.jsx(Y.StrictMode,{children:r.jsx(cV,{})}));
