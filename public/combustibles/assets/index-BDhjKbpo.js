(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var kp={exports:{}},kc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ab;function Uw(){if(Ab)return kc;Ab=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var f in o)f!=="key"&&(c[f]=o[f])}else c=o;return o=c.ref,{$$typeof:n,type:i,key:d,ref:o!==void 0?o:null,props:c}}return kc.Fragment=e,kc.jsx=t,kc.jsxs=t,kc}var Cb;function Fw(){return Cb||(Cb=1,kp.exports=Uw()),kp.exports}var s=Fw(),Op={exports:{}},Ve={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wb;function qw(){if(wb)return Ve;wb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),N=Symbol.iterator;function E(G){return G===null||typeof G!="object"?null:(G=N&&G[N]||G["@@iterator"],typeof G=="function"?G:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,R={};function b(G,te,he){this.props=G,this.context=te,this.refs=R,this.updater=he||A}b.prototype.isReactComponent={},b.prototype.setState=function(G,te){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,te,"setState")},b.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function k(){}k.prototype=b.prototype;function _(G,te,he){this.props=G,this.context=te,this.refs=R,this.updater=he||A}var j=_.prototype=new k;j.constructor=_,T(j,b.prototype),j.isPureReactComponent=!0;var S=Array.isArray,O={H:null,A:null,T:null,S:null,V:null},B=Object.prototype.hasOwnProperty;function L(G,te,he,de,Ee,Fe){return he=Fe.ref,{$$typeof:n,type:G,key:te,ref:he!==void 0?he:null,props:Fe}}function M(G,te){return L(G.type,te,void 0,void 0,void 0,G.props)}function V(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function U(G){var te={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(he){return te[he]})}var I=/\/+/g;function D(G,te){return typeof G=="object"&&G!==null&&G.key!=null?U(""+G.key):te.toString(36)}function q(){}function be(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(q,q):(G.status="pending",G.then(function(te){G.status==="pending"&&(G.status="fulfilled",G.value=te)},function(te){G.status==="pending"&&(G.status="rejected",G.reason=te)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function Ie(G,te,he,de,Ee){var Fe=typeof G;(Fe==="undefined"||Fe==="boolean")&&(G=null);var ke=!1;if(G===null)ke=!0;else switch(Fe){case"bigint":case"string":case"number":ke=!0;break;case"object":switch(G.$$typeof){case n:case e:ke=!0;break;case y:return ke=G._init,Ie(ke(G._payload),te,he,de,Ee)}}if(ke)return Ee=Ee(G),ke=de===""?"."+D(G,0):de,S(Ee)?(he="",ke!=null&&(he=ke.replace(I,"$&/")+"/"),Ie(Ee,te,he,"",function(Ms){return Ms})):Ee!=null&&(V(Ee)&&(Ee=M(Ee,he+(Ee.key==null||G&&G.key===Ee.key?"":(""+Ee.key).replace(I,"$&/")+"/")+ke)),te.push(Ee)),1;ke=0;var Yt=de===""?".":de+":";if(S(G))for(var pt=0;pt<G.length;pt++)de=G[pt],Fe=Yt+D(de,pt),ke+=Ie(de,te,he,Fe,Ee);else if(pt=E(G),typeof pt=="function")for(G=pt.call(G),pt=0;!(de=G.next()).done;)de=de.value,Fe=Yt+D(de,pt++),ke+=Ie(de,te,he,Fe,Ee);else if(Fe==="object"){if(typeof G.then=="function")return Ie(be(G),te,he,de,Ee);throw te=String(G),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return ke}function Y(G,te,he){if(G==null)return G;var de=[],Ee=0;return Ie(G,de,"","",function(Fe){return te.call(he,Fe,Ee++)}),de}function ie(G){if(G._status===-1){var te=G._result;te=te(),te.then(function(he){(G._status===0||G._status===-1)&&(G._status=1,G._result=he)},function(he){(G._status===0||G._status===-1)&&(G._status=2,G._result=he)}),G._status===-1&&(G._status=0,G._result=te)}if(G._status===1)return G._result.default;throw G._result}var ee=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)};function xe(){}return Ve.Children={map:Y,forEach:function(G,te,he){Y(G,function(){te.apply(this,arguments)},he)},count:function(G){var te=0;return Y(G,function(){te++}),te},toArray:function(G){return Y(G,function(te){return te})||[]},only:function(G){if(!V(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},Ve.Component=b,Ve.Fragment=t,Ve.Profiler=o,Ve.PureComponent=_,Ve.StrictMode=i,Ve.Suspense=p,Ve.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Ve.__COMPILER_RUNTIME={__proto__:null,c:function(G){return O.H.useMemoCache(G)}},Ve.cache=function(G){return function(){return G.apply(null,arguments)}},Ve.cloneElement=function(G,te,he){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var de=T({},G.props),Ee=G.key,Fe=void 0;if(te!=null)for(ke in te.ref!==void 0&&(Fe=void 0),te.key!==void 0&&(Ee=""+te.key),te)!B.call(te,ke)||ke==="key"||ke==="__self"||ke==="__source"||ke==="ref"&&te.ref===void 0||(de[ke]=te[ke]);var ke=arguments.length-2;if(ke===1)de.children=he;else if(1<ke){for(var Yt=Array(ke),pt=0;pt<ke;pt++)Yt[pt]=arguments[pt+2];de.children=Yt}return L(G.type,Ee,void 0,void 0,Fe,de)},Ve.createContext=function(G){return G={$$typeof:d,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:c,_context:G},G},Ve.createElement=function(G,te,he){var de,Ee={},Fe=null;if(te!=null)for(de in te.key!==void 0&&(Fe=""+te.key),te)B.call(te,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(Ee[de]=te[de]);var ke=arguments.length-2;if(ke===1)Ee.children=he;else if(1<ke){for(var Yt=Array(ke),pt=0;pt<ke;pt++)Yt[pt]=arguments[pt+2];Ee.children=Yt}if(G&&G.defaultProps)for(de in ke=G.defaultProps,ke)Ee[de]===void 0&&(Ee[de]=ke[de]);return L(G,Fe,void 0,void 0,null,Ee)},Ve.createRef=function(){return{current:null}},Ve.forwardRef=function(G){return{$$typeof:f,render:G}},Ve.isValidElement=V,Ve.lazy=function(G){return{$$typeof:y,_payload:{_status:-1,_result:G},_init:ie}},Ve.memo=function(G,te){return{$$typeof:g,type:G,compare:te===void 0?null:te}},Ve.startTransition=function(G){var te=O.T,he={};O.T=he;try{var de=G(),Ee=O.S;Ee!==null&&Ee(he,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(xe,ee)}catch(Fe){ee(Fe)}finally{O.T=te}},Ve.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Ve.use=function(G){return O.H.use(G)},Ve.useActionState=function(G,te,he){return O.H.useActionState(G,te,he)},Ve.useCallback=function(G,te){return O.H.useCallback(G,te)},Ve.useContext=function(G){return O.H.useContext(G)},Ve.useDebugValue=function(){},Ve.useDeferredValue=function(G,te){return O.H.useDeferredValue(G,te)},Ve.useEffect=function(G,te,he){var de=O.H;if(typeof he=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return de.useEffect(G,te)},Ve.useId=function(){return O.H.useId()},Ve.useImperativeHandle=function(G,te,he){return O.H.useImperativeHandle(G,te,he)},Ve.useInsertionEffect=function(G,te){return O.H.useInsertionEffect(G,te)},Ve.useLayoutEffect=function(G,te){return O.H.useLayoutEffect(G,te)},Ve.useMemo=function(G,te){return O.H.useMemo(G,te)},Ve.useOptimistic=function(G,te){return O.H.useOptimistic(G,te)},Ve.useReducer=function(G,te,he){return O.H.useReducer(G,te,he)},Ve.useRef=function(G){return O.H.useRef(G)},Ve.useState=function(G){return O.H.useState(G)},Ve.useSyncExternalStore=function(G,te,he){return O.H.useSyncExternalStore(G,te,he)},Ve.useTransition=function(){return O.H.useTransition()},Ve.version="19.1.0",Ve}var Sb;function Ug(){return Sb||(Sb=1,Op.exports=qw()),Op.exports}var H=Ug(),Pp={exports:{}},Oc={},Lp={exports:{}},Vp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ib;function Hw(){return Ib||(Ib=1,function(n){function e(Y,ie){var ee=Y.length;Y.push(ie);e:for(;0<ee;){var xe=ee-1>>>1,G=Y[xe];if(0<o(G,ie))Y[xe]=ie,Y[ee]=G,ee=xe;else break e}}function t(Y){return Y.length===0?null:Y[0]}function i(Y){if(Y.length===0)return null;var ie=Y[0],ee=Y.pop();if(ee!==ie){Y[0]=ee;e:for(var xe=0,G=Y.length,te=G>>>1;xe<te;){var he=2*(xe+1)-1,de=Y[he],Ee=he+1,Fe=Y[Ee];if(0>o(de,ee))Ee<G&&0>o(Fe,de)?(Y[xe]=Fe,Y[Ee]=ee,xe=Ee):(Y[xe]=de,Y[he]=ee,xe=he);else if(Ee<G&&0>o(Fe,ee))Y[xe]=Fe,Y[Ee]=ee,xe=Ee;else break e}}return ie}function o(Y,ie){var ee=Y.sortIndex-ie.sortIndex;return ee!==0?ee:Y.id-ie.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var p=[],g=[],y=1,N=null,E=3,A=!1,T=!1,R=!1,b=!1,k=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;function S(Y){for(var ie=t(g);ie!==null;){if(ie.callback===null)i(g);else if(ie.startTime<=Y)i(g),ie.sortIndex=ie.expirationTime,e(p,ie);else break;ie=t(g)}}function O(Y){if(R=!1,S(Y),!T)if(t(p)!==null)T=!0,B||(B=!0,D());else{var ie=t(g);ie!==null&&Ie(O,ie.startTime-Y)}}var B=!1,L=-1,M=5,V=-1;function U(){return b?!0:!(n.unstable_now()-V<M)}function I(){if(b=!1,B){var Y=n.unstable_now();V=Y;var ie=!0;try{e:{T=!1,R&&(R=!1,_(L),L=-1),A=!0;var ee=E;try{t:{for(S(Y),N=t(p);N!==null&&!(N.expirationTime>Y&&U());){var xe=N.callback;if(typeof xe=="function"){N.callback=null,E=N.priorityLevel;var G=xe(N.expirationTime<=Y);if(Y=n.unstable_now(),typeof G=="function"){N.callback=G,S(Y),ie=!0;break t}N===t(p)&&i(p),S(Y)}else i(p);N=t(p)}if(N!==null)ie=!0;else{var te=t(g);te!==null&&Ie(O,te.startTime-Y),ie=!1}}break e}finally{N=null,E=ee,A=!1}ie=void 0}}finally{ie?D():B=!1}}}var D;if(typeof j=="function")D=function(){j(I)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,be=q.port2;q.port1.onmessage=I,D=function(){be.postMessage(null)}}else D=function(){k(I,0)};function Ie(Y,ie){L=k(function(){Y(n.unstable_now())},ie)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_next=function(Y){switch(E){case 1:case 2:case 3:var ie=3;break;default:ie=E}var ee=E;E=ie;try{return Y()}finally{E=ee}},n.unstable_requestPaint=function(){b=!0},n.unstable_runWithPriority=function(Y,ie){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var ee=E;E=Y;try{return ie()}finally{E=ee}},n.unstable_scheduleCallback=function(Y,ie,ee){var xe=n.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?xe+ee:xe):ee=xe,Y){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=ee+G,Y={id:y++,callback:ie,priorityLevel:Y,startTime:ee,expirationTime:G,sortIndex:-1},ee>xe?(Y.sortIndex=ee,e(g,Y),t(p)===null&&Y===t(g)&&(R?(_(L),L=-1):R=!0,Ie(O,ee-xe))):(Y.sortIndex=G,e(p,Y),T||A||(T=!0,B||(B=!0,D()))),Y},n.unstable_shouldYield=U,n.unstable_wrapCallback=function(Y){var ie=E;return function(){var ee=E;E=ie;try{return Y.apply(this,arguments)}finally{E=ee}}}}(Vp)),Vp}var Rb;function Bw(){return Rb||(Rb=1,Lp.exports=Hw()),Lp.exports}var Up={exports:{}},pn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mb;function zw(){if(Mb)return pn;Mb=1;var n=Ug();function e(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)g+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,g,y){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:N==null?null:""+N,children:p,containerInfo:g,implementation:y}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return pn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,pn.createPortal=function(p,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return c(p,g,null,y)},pn.flushSync=function(p){var g=d.T,y=i.p;try{if(d.T=null,i.p=2,p)return p()}finally{d.T=g,i.p=y,i.d.f()}},pn.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(p,g))},pn.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},pn.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var y=g.as,N=f(y,g.crossOrigin),E=typeof g.integrity=="string"?g.integrity:void 0,A=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;y==="style"?i.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:N,integrity:E,fetchPriority:A}):y==="script"&&i.d.X(p,{crossOrigin:N,integrity:E,fetchPriority:A,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},pn.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var y=f(g.as,g.crossOrigin);i.d.M(p,{crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(p)},pn.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var y=g.as,N=f(y,g.crossOrigin);i.d.L(p,y,{crossOrigin:N,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},pn.preloadModule=function(p,g){if(typeof p=="string")if(g){var y=f(g.as,g.crossOrigin);i.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(p)},pn.requestFormReset=function(p){i.d.r(p)},pn.unstable_batchedUpdates=function(p,g){return p(g)},pn.useFormState=function(p,g,y){return d.H.useFormState(p,g,y)},pn.useFormStatus=function(){return d.H.useHostTransitionStatus()},pn.version="19.1.0",pn}var Db;function Gw(){if(Db)return Up.exports;Db=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Up.exports=zw(),Up.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kb;function $w(){if(kb)return Oc;kb=1;var n=Bw(),e=Ug(),t=Gw();function i(a){var r="https://react.dev/errors/"+a;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+a+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function c(a){var r=a,l=a;if(a.alternate)for(;r.return;)r=r.return;else{a=r;do r=a,(r.flags&4098)!==0&&(l=r.return),a=r.return;while(a)}return r.tag===3?l:null}function d(a){if(a.tag===13){var r=a.memoizedState;if(r===null&&(a=a.alternate,a!==null&&(r=a.memoizedState)),r!==null)return r.dehydrated}return null}function f(a){if(c(a)!==a)throw Error(i(188))}function p(a){var r=a.alternate;if(!r){if(r=c(a),r===null)throw Error(i(188));return r!==a?null:a}for(var l=a,u=r;;){var m=l.return;if(m===null)break;var v=m.alternate;if(v===null){if(u=m.return,u!==null){l=u;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===l)return f(m),a;if(v===u)return f(m),r;v=v.sibling}throw Error(i(188))}if(l.return!==u.return)l=m,u=v;else{for(var w=!1,P=m.child;P;){if(P===l){w=!0,l=m,u=v;break}if(P===u){w=!0,u=m,l=v;break}P=P.sibling}if(!w){for(P=v.child;P;){if(P===l){w=!0,l=v,u=m;break}if(P===u){w=!0,u=v,l=m;break}P=P.sibling}if(!w)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?a:r}function g(a){var r=a.tag;if(r===5||r===26||r===27||r===6)return a;for(a=a.child;a!==null;){if(r=g(a),r!==null)return r;a=a.sibling}return null}var y=Object.assign,N=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),j=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function D(a){return a===null||typeof a!="object"?null:(a=I&&a[I]||a["@@iterator"],typeof a=="function"?a:null)}var q=Symbol.for("react.client.reference");function be(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===q?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case T:return"Fragment";case b:return"Profiler";case R:return"StrictMode";case O:return"Suspense";case B:return"SuspenseList";case V:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case A:return"Portal";case j:return(a.displayName||"Context")+".Provider";case _:return(a._context.displayName||"Context")+".Consumer";case S:var r=a.render;return a=a.displayName,a||(a=r.displayName||r.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case L:return r=a.displayName||null,r!==null?r:be(a.type)||"Memo";case M:r=a._payload,a=a._init;try{return be(a(r))}catch{}}return null}var Ie=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},xe=[],G=-1;function te(a){return{current:a}}function he(a){0>G||(a.current=xe[G],xe[G]=null,G--)}function de(a,r){G++,xe[G]=a.current,a.current=r}var Ee=te(null),Fe=te(null),ke=te(null),Yt=te(null);function pt(a,r){switch(de(ke,r),de(Fe,a),de(Ee,null),r.nodeType){case 9:case 11:a=(a=r.documentElement)&&(a=a.namespaceURI)?eb(a):0;break;default:if(a=r.tagName,r=r.namespaceURI)r=eb(r),a=tb(r,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}he(Ee),de(Ee,a)}function Ms(){he(Ee),he(Fe),he(ke)}function Ga(a){a.memoizedState!==null&&de(Yt,a);var r=Ee.current,l=tb(r,a.type);r!==l&&(de(Fe,a),de(Ee,l))}function la(a){Fe.current===a&&(he(Ee),he(Fe)),Yt.current===a&&(he(Yt),Sc._currentValue=ee)}var Wi=Object.prototype.hasOwnProperty,Zi=n.unstable_scheduleCallback,Ji=n.unstable_cancelCallback,Al=n.unstable_shouldYield,Ou=n.unstable_requestPaint,Jn=n.unstable_now,kf=n.unstable_getCurrentPriorityLevel,Cl=n.unstable_ImmediatePriority,eo=n.unstable_UserBlockingPriority,er=n.unstable_NormalPriority,Of=n.unstable_LowPriority,to=n.unstable_IdlePriority,wl=n.log,Pu=n.unstable_setDisableYieldValue,At=null,at=null;function Ln(a){if(typeof wl=="function"&&Pu(a),at&&typeof at.setStrictMode=="function")try{at.setStrictMode(At,a)}catch{}}var fn=Math.clz32?Math.clz32:tr,Lu=Math.log,Pf=Math.LN2;function tr(a){return a>>>=0,a===0?32:31-(Lu(a)/Pf|0)|0}var nr=256,sr=4194304;function vs(a){var r=a&42;if(r!==0)return r;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function no(a,r,l){var u=a.pendingLanes;if(u===0)return 0;var m=0,v=a.suspendedLanes,w=a.pingedLanes;a=a.warmLanes;var P=u&134217727;return P!==0?(u=P&~v,u!==0?m=vs(u):(w&=P,w!==0?m=vs(w):l||(l=P&~a,l!==0&&(m=vs(l))))):(P=u&~v,P!==0?m=vs(P):w!==0?m=vs(w):l||(l=u&~a,l!==0&&(m=vs(l)))),m===0?0:r!==0&&r!==m&&(r&v)===0&&(v=m&-m,l=r&-r,v>=l||v===32&&(l&4194048)!==0)?r:m}function ar(a,r){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&r)===0}function Sl(a,r){switch(a){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Il(){var a=nr;return nr<<=1,(nr&4194048)===0&&(nr=256),a}function Rl(){var a=sr;return sr<<=1,(sr&62914560)===0&&(sr=4194304),a}function ca(a){for(var r=[],l=0;31>l;l++)r.push(a);return r}function ua(a,r){a.pendingLanes|=r,r!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Ml(a,r,l,u,m,v){var w=a.pendingLanes;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=l,a.entangledLanes&=l,a.errorRecoveryDisabledLanes&=l,a.shellSuspendCounter=0;var P=a.entanglements,z=a.expirationTimes,W=a.hiddenUpdates;for(l=w&~l;0<l;){var se=31-fn(l),oe=1<<se;P[se]=0,z[se]=-1;var Z=W[se];if(Z!==null)for(W[se]=null,se=0;se<Z.length;se++){var J=Z[se];J!==null&&(J.lane&=-536870913)}l&=~oe}u!==0&&Ds(a,u,0),v!==0&&m===0&&a.tag!==0&&(a.suspendedLanes|=v&~(w&~r))}function Ds(a,r,l){a.pendingLanes|=r,a.suspendedLanes&=~r;var u=31-fn(r);a.entangledLanes|=r,a.entanglements[u]=a.entanglements[u]|1073741824|l&4194090}function Dl(a,r){var l=a.entangledLanes|=r;for(a=a.entanglements;l;){var u=31-fn(l),m=1<<u;m&r|a[u]&r&&(a[u]|=r),l&=~m}}function $a(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function so(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Ya(){var a=ie.p;return a!==0?a:(a=window.event,a===void 0?32:Nb(a.type))}function Vu(a,r){var l=ie.p;try{return ie.p=a,r()}finally{ie.p=l}}var bt=Math.random().toString(36).slice(2),Ft="__reactFiber$"+bt,Dt="__reactProps$"+bt,es="__reactContainer$"+bt,kl="__reactEvents$"+bt,Lf="__reactListeners$"+bt,Qa="__reactHandles$"+bt,Uu="__reactResources$"+bt,ir="__reactMarker$"+bt;function Ka(a){delete a[Ft],delete a[Dt],delete a[kl],delete a[Lf],delete a[Qa]}function da(a){var r=a[Ft];if(r)return r;for(var l=a.parentNode;l;){if(r=l[es]||l[Ft]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(a=ib(a);a!==null;){if(l=a[Ft])return l;a=ib(a)}return r}a=l,l=a.parentNode}return null}function ks(a){if(a=a[Ft]||a[es]){var r=a.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return a}return null}function Os(a){var r=a.tag;if(r===5||r===26||r===27||r===6)return a.stateNode;throw Error(i(33))}function En(a){var r=a[Uu];return r||(r=a[Uu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function St(a){a[ir]=!0}var Ol=new Set,ao={};function ys(a,r){ha(a,r),ha(a+"Capture",r)}function ha(a,r){for(ao[a]=r,a=0;a<r.length;a++)Ol.add(r[a])}var Fu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qu={},rr={};function Hu(a){return Wi.call(rr,a)?!0:Wi.call(qu,a)?!1:Fu.test(a)?rr[a]=!0:(qu[a]=!0,!1)}function Xa(a,r,l){if(Hu(r))if(l===null)a.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":a.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){a.removeAttribute(r);return}}a.setAttribute(r,""+l)}}function Ps(a,r,l){if(l===null)a.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(r);return}a.setAttribute(r,""+l)}}function tn(a,r,l,u){if(u===null)a.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttributeNS(r,l,""+u)}}var or,Bu;function fa(a){if(or===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);or=r&&r[1]||"",Bu=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+or+a+Bu}var io=!1;function ro(a,r){if(!a||io)return"";io=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(J){var Z=J}Reflect.construct(a,[],oe)}else{try{oe.call()}catch(J){Z=J}a.call(oe.prototype)}}else{try{throw Error()}catch(J){Z=J}(oe=a())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(J){if(J&&Z&&typeof J.stack=="string")return[J.stack,Z.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=u.DetermineComponentFrameRoot(),w=v[0],P=v[1];if(w&&P){var z=w.split(`
`),W=P.split(`
`);for(m=u=0;u<z.length&&!z[u].includes("DetermineComponentFrameRoot");)u++;for(;m<W.length&&!W[m].includes("DetermineComponentFrameRoot");)m++;if(u===z.length||m===W.length)for(u=z.length-1,m=W.length-1;1<=u&&0<=m&&z[u]!==W[m];)m--;for(;1<=u&&0<=m;u--,m--)if(z[u]!==W[m]){if(u!==1||m!==1)do if(u--,m--,0>m||z[u]!==W[m]){var se=`
`+z[u].replace(" at new "," at ");return a.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",a.displayName)),se}while(1<=u&&0<=m);break}}}finally{io=!1,Error.prepareStackTrace=l}return(l=a?a.displayName||a.name:"")?fa(l):""}function Pl(a){switch(a.tag){case 26:case 27:case 5:return fa(a.type);case 16:return fa("Lazy");case 13:return fa("Suspense");case 19:return fa("SuspenseList");case 0:case 15:return ro(a.type,!1);case 11:return ro(a.type.render,!1);case 1:return ro(a.type,!0);case 31:return fa("Activity");default:return""}}function oo(a){try{var r="";do r+=Pl(a),a=a.return;while(a);return r}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function jn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ll(a){var r=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Vf(a){var r=Ll(a)?"checked":"value",l=Object.getOwnPropertyDescriptor(a.constructor.prototype,r),u=""+a[r];if(!a.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,v=l.set;return Object.defineProperty(a,r,{configurable:!0,get:function(){return m.call(this)},set:function(w){u=""+w,v.call(this,w)}}),Object.defineProperty(a,r,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(w){u=""+w},stopTracking:function(){a._valueTracker=null,delete a[r]}}}}function lo(a){a._valueTracker||(a._valueTracker=Vf(a))}function Vl(a){if(!a)return!1;var r=a._valueTracker;if(!r)return!0;var l=r.getValue(),u="";return a&&(u=Ll(a)?a.checked?"true":"false":a.value),a=u,a!==l?(r.setValue(a),!0):!1}function lr(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Uf=/[\n"\\]/g;function kt(a){return a.replace(Uf,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Vn(a,r,l,u,m,v,w,P){a.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?a.type=w:a.removeAttribute("type"),r!=null?w==="number"?(r===0&&a.value===""||a.value!=r)&&(a.value=""+jn(r)):a.value!==""+jn(r)&&(a.value=""+jn(r)):w!=="submit"&&w!=="reset"||a.removeAttribute("value"),r!=null?Wa(a,w,jn(r)):l!=null?Wa(a,w,jn(l)):u!=null&&a.removeAttribute("value"),m==null&&v!=null&&(a.defaultChecked=!!v),m!=null&&(a.checked=m&&typeof m!="function"&&typeof m!="symbol"),P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?a.name=""+jn(P):a.removeAttribute("name")}function cr(a,r,l,u,m,v,w,P){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(a.type=v),r!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||r!=null))return;l=l!=null?""+jn(l):"",r=r!=null?""+jn(r):l,P||r===a.value||(a.value=r),a.defaultValue=r}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,a.checked=P?a.checked:!!u,a.defaultChecked=!!u,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(a.name=w)}function Wa(a,r,l){r==="number"&&lr(a.ownerDocument)===a||a.defaultValue===""+l||(a.defaultValue=""+l)}function ma(a,r,l,u){if(a=a.options,r){r={};for(var m=0;m<l.length;m++)r["$"+l[m]]=!0;for(l=0;l<a.length;l++)m=r.hasOwnProperty("$"+a[l].value),a[l].selected!==m&&(a[l].selected=m),m&&u&&(a[l].defaultSelected=!0)}else{for(l=""+jn(l),r=null,m=0;m<a.length;m++){if(a[m].value===l){a[m].selected=!0,u&&(a[m].defaultSelected=!0);return}r!==null||a[m].disabled||(r=a[m])}r!==null&&(r.selected=!0)}}function ot(a,r,l){if(r!=null&&(r=""+jn(r),r!==a.value&&(a.value=r),l==null)){a.defaultValue!==r&&(a.defaultValue=r);return}a.defaultValue=l!=null?""+jn(l):""}function ur(a,r,l,u){if(r==null){if(u!=null){if(l!=null)throw Error(i(92));if(Ie(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),r=l}l=jn(r),a.defaultValue=l,u=a.textContent,u===l&&u!==""&&u!==null&&(a.value=u)}function ts(a,r){if(r){var l=a.firstChild;if(l&&l===a.lastChild&&l.nodeType===3){l.nodeValue=r;return}}a.textContent=r}var dr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zu(a,r,l){var u=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?a.setProperty(r,""):r==="float"?a.cssFloat="":a[r]="":u?a.setProperty(r,l):typeof l!="number"||l===0||dr.has(r)?r==="float"?a.cssFloat=l:a[r]=(""+l).trim():a[r]=l+"px"}function Ul(a,r,l){if(r!=null&&typeof r!="object")throw Error(i(62));if(a=a.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?a.setProperty(u,""):u==="float"?a.cssFloat="":a[u]="");for(var m in r)u=r[m],r.hasOwnProperty(m)&&l[m]!==u&&zu(a,m,u)}else for(var v in r)r.hasOwnProperty(v)&&zu(a,v,r[v])}function Fl(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ff=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function co(a){return qf.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var pa=null;function ns(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var ga=null,va=null;function ql(a){var r=ks(a);if(r&&(a=r.stateNode)){var l=a[Dt]||null;e:switch(a=r.stateNode,r.type){case"input":if(Vn(a,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=a;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+kt(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var u=l[r];if(u!==a&&u.form===a.form){var m=u[Dt]||null;if(!m)throw Error(i(90));Vn(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(r=0;r<l.length;r++)u=l[r],u.form===a.form&&Vl(u)}break e;case"textarea":ot(a,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&ma(a,!!l.multiple,r,!1)}}}var Ls=!1;function Gu(a,r,l){if(Ls)return a(r,l);Ls=!0;try{var u=a(r);return u}finally{if(Ls=!1,(ga!==null||va!==null)&&(Vd(),ga&&(r=ga,a=va,va=ga=null,ql(r),a)))for(r=0;r<a.length;r++)ql(a[r])}}function hr(a,r){var l=a.stateNode;if(l===null)return null;var u=l[Dt]||null;if(u===null)return null;l=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(a=a.type,u=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!u;break e;default:a=!1}if(a)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var xs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ss=!1;if(xs)try{var fr={};Object.defineProperty(fr,"passive",{get:function(){ss=!0}}),window.addEventListener("test",fr,fr),window.removeEventListener("test",fr,fr)}catch{ss=!1}var Vs=null,Za=null,ya=null;function Hl(){if(ya)return ya;var a,r=Za,l=r.length,u,m="value"in Vs?Vs.value:Vs.textContent,v=m.length;for(a=0;a<l&&r[a]===m[a];a++);var w=l-a;for(u=1;u<=w&&r[l-u]===m[v-u];u++);return ya=m.slice(a,1<u?1-u:void 0)}function Us(a){var r=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&r===13&&(a=13)):a=r,a===10&&(a=13),32<=a||a===13?a:0}function Fs(){return!0}function Bl(){return!1}function Qt(a){function r(l,u,m,v,w){this._reactName=l,this._targetInst=m,this.type=u,this.nativeEvent=v,this.target=w,this.currentTarget=null;for(var P in a)a.hasOwnProperty(P)&&(l=a[P],this[P]=l?l(v):v[P]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Fs:Bl,this.isPropagationStopped=Bl,this}return y(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Fs)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Fs)},persist:function(){},isPersistent:Fs}),r}var st={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uo=Qt(st),mr=y({},st,{view:0,detail:0}),$u=Qt(mr),ho,fo,qs,pr=y({},mr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yr,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==qs&&(qs&&a.type==="mousemove"?(ho=a.screenX-qs.screenX,fo=a.screenY-qs.screenY):fo=ho=0,qs=a),ho)},movementY:function(a){return"movementY"in a?a.movementY:fo}}),as=Qt(pr),Yu=y({},pr,{dataTransfer:0}),Hf=Qt(Yu),gr=y({},mr,{relatedTarget:0}),mo=Qt(gr),zl=y({},st,{animationName:0,elapsedTime:0,pseudoElement:0}),po=Qt(zl),Qu=y({},st,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),go=Qt(Qu),Bf=y({},st,{data:0}),Gl=Qt(Bf),vr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ku={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $l(a){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(a):(a=Xu[a])?!!r[a]:!1}function yr(){return $l}var Wu=y({},mr,{key:function(a){if(a.key){var r=vr[a.key]||a.key;if(r!=="Unidentified")return r}return a.type==="keypress"?(a=Us(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Ku[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yr,charCode:function(a){return a.type==="keypress"?Us(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Us(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),vo=Qt(Wu),Zu=y({},pr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yl=Qt(Zu),xa=y({},mr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yr}),Ju=Qt(xa),ed=y({},st,{propertyName:0,elapsedTime:0,pseudoElement:0}),td=Qt(ed),nd=y({},pr,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),yo=Qt(nd),Tn=y({},st,{newState:0,oldState:0}),sd=Qt(Tn),ad=[9,13,27,32],Hs=xs&&"CompositionEvent"in window,h=null;xs&&"documentMode"in document&&(h=document.documentMode);var x=xs&&"TextEvent"in window&&!h,C=xs&&(!Hs||h&&8<h&&11>=h),F=" ",K=!1;function ne(a,r){switch(a){case"keyup":return ad.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fe(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ke=!1;function qt(a,r){switch(a){case"compositionend":return fe(r);case"keypress":return r.which!==32?null:(K=!0,F);case"textInput":return a=r.data,a===F&&K?null:a;default:return null}}function Xe(a,r){if(Ke)return a==="compositionend"||!Hs&&ne(a,r)?(a=Hl(),ya=Za=Vs=null,Ke=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return C&&r.locale!=="ko"?null:r.data;default:return null}}var Kt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ht(a){var r=a&&a.nodeName&&a.nodeName.toLowerCase();return r==="input"?!!Kt[a.type]:r==="textarea"}function Na(a,r,l,u){ga?va?va.push(u):va=[u]:ga=u,r=zd(r,"onChange"),0<r.length&&(l=new uo("onChange","change",null,l,u),a.push({event:l,listeners:r}))}var nn=null,Bs=null;function Ql(a){KN(a,0)}function id(a){var r=Os(a);if(Vl(r))return a}function gy(a,r){if(a==="change")return r}var vy=!1;if(xs){var zf;if(xs){var Gf="oninput"in document;if(!Gf){var yy=document.createElement("div");yy.setAttribute("oninput","return;"),Gf=typeof yy.oninput=="function"}zf=Gf}else zf=!1;vy=zf&&(!document.documentMode||9<document.documentMode)}function xy(){nn&&(nn.detachEvent("onpropertychange",Ny),Bs=nn=null)}function Ny(a){if(a.propertyName==="value"&&id(Bs)){var r=[];Na(r,Bs,a,ns(a)),Gu(Ql,r)}}function pC(a,r,l){a==="focusin"?(xy(),nn=r,Bs=l,nn.attachEvent("onpropertychange",Ny)):a==="focusout"&&xy()}function gC(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return id(Bs)}function vC(a,r){if(a==="click")return id(r)}function yC(a,r){if(a==="input"||a==="change")return id(r)}function xC(a,r){return a===r&&(a!==0||1/a===1/r)||a!==a&&r!==r}var Un=typeof Object.is=="function"?Object.is:xC;function Kl(a,r){if(Un(a,r))return!0;if(typeof a!="object"||a===null||typeof r!="object"||r===null)return!1;var l=Object.keys(a),u=Object.keys(r);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var m=l[u];if(!Wi.call(r,m)||!Un(a[m],r[m]))return!1}return!0}function by(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function _y(a,r){var l=by(a);a=0;for(var u;l;){if(l.nodeType===3){if(u=a+l.textContent.length,a<=r&&u>=r)return{node:l,offset:r-a};a=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=by(l)}}function Ey(a,r){return a&&r?a===r?!0:a&&a.nodeType===3?!1:r&&r.nodeType===3?Ey(a,r.parentNode):"contains"in a?a.contains(r):a.compareDocumentPosition?!!(a.compareDocumentPosition(r)&16):!1:!1}function jy(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var r=lr(a.document);r instanceof a.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)a=r.contentWindow;else break;r=lr(a.document)}return r}function $f(a){var r=a&&a.nodeName&&a.nodeName.toLowerCase();return r&&(r==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||r==="textarea"||a.contentEditable==="true")}var NC=xs&&"documentMode"in document&&11>=document.documentMode,xo=null,Yf=null,Xl=null,Qf=!1;function Ty(a,r,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Qf||xo==null||xo!==lr(u)||(u=xo,"selectionStart"in u&&$f(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Xl&&Kl(Xl,u)||(Xl=u,u=zd(Yf,"onSelect"),0<u.length&&(r=new uo("onSelect","select",null,r,l),a.push({event:r,listeners:u}),r.target=xo)))}function xr(a,r){var l={};return l[a.toLowerCase()]=r.toLowerCase(),l["Webkit"+a]="webkit"+r,l["Moz"+a]="moz"+r,l}var No={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionrun:xr("Transition","TransitionRun"),transitionstart:xr("Transition","TransitionStart"),transitioncancel:xr("Transition","TransitionCancel"),transitionend:xr("Transition","TransitionEnd")},Kf={},Ay={};xs&&(Ay=document.createElement("div").style,"AnimationEvent"in window||(delete No.animationend.animation,delete No.animationiteration.animation,delete No.animationstart.animation),"TransitionEvent"in window||delete No.transitionend.transition);function Nr(a){if(Kf[a])return Kf[a];if(!No[a])return a;var r=No[a],l;for(l in r)if(r.hasOwnProperty(l)&&l in Ay)return Kf[a]=r[l];return a}var Cy=Nr("animationend"),wy=Nr("animationiteration"),Sy=Nr("animationstart"),bC=Nr("transitionrun"),_C=Nr("transitionstart"),EC=Nr("transitioncancel"),Iy=Nr("transitionend"),Ry=new Map,Xf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Xf.push("scrollEnd");function Ns(a,r){Ry.set(a,r),ys(r,[a])}var My=new WeakMap;function is(a,r){if(typeof a=="object"&&a!==null){var l=My.get(a);return l!==void 0?l:(r={value:a,source:r,stack:oo(r)},My.set(a,r),r)}return{value:a,source:r,stack:oo(r)}}var rs=[],bo=0,Wf=0;function rd(){for(var a=bo,r=Wf=bo=0;r<a;){var l=rs[r];rs[r++]=null;var u=rs[r];rs[r++]=null;var m=rs[r];rs[r++]=null;var v=rs[r];if(rs[r++]=null,u!==null&&m!==null){var w=u.pending;w===null?m.next=m:(m.next=w.next,w.next=m),u.pending=m}v!==0&&Dy(l,m,v)}}function od(a,r,l,u){rs[bo++]=a,rs[bo++]=r,rs[bo++]=l,rs[bo++]=u,Wf|=u,a.lanes|=u,a=a.alternate,a!==null&&(a.lanes|=u)}function Zf(a,r,l,u){return od(a,r,l,u),ld(a)}function _o(a,r){return od(a,null,null,r),ld(a)}function Dy(a,r,l){a.lanes|=l;var u=a.alternate;u!==null&&(u.lanes|=l);for(var m=!1,v=a.return;v!==null;)v.childLanes|=l,u=v.alternate,u!==null&&(u.childLanes|=l),v.tag===22&&(a=v.stateNode,a===null||a._visibility&1||(m=!0)),a=v,v=v.return;return a.tag===3?(v=a.stateNode,m&&r!==null&&(m=31-fn(l),a=v.hiddenUpdates,u=a[m],u===null?a[m]=[r]:u.push(r),r.lane=l|536870912),v):null}function ld(a){if(50<bc)throw bc=0,ap=null,Error(i(185));for(var r=a.return;r!==null;)a=r,r=a.return;return a.tag===3?a.stateNode:null}var Eo={};function jC(a,r,l,u){this.tag=a,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(a,r,l,u){return new jC(a,r,l,u)}function Jf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function ba(a,r){var l=a.alternate;return l===null?(l=Fn(a.tag,r,a.key,a.mode),l.elementType=a.elementType,l.type=a.type,l.stateNode=a.stateNode,l.alternate=a,a.alternate=l):(l.pendingProps=r,l.type=a.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=a.flags&65011712,l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,r=a.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=a.sibling,l.index=a.index,l.ref=a.ref,l.refCleanup=a.refCleanup,l}function ky(a,r){a.flags&=65011714;var l=a.alternate;return l===null?(a.childLanes=0,a.lanes=r,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,r=l.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),a}function cd(a,r,l,u,m,v){var w=0;if(u=a,typeof a=="function")Jf(a)&&(w=1);else if(typeof a=="string")w=Aw(a,l,Ee.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case V:return a=Fn(31,l,r,m),a.elementType=V,a.lanes=v,a;case T:return br(l.children,m,v,r);case R:w=8,m|=24;break;case b:return a=Fn(12,l,r,m|2),a.elementType=b,a.lanes=v,a;case O:return a=Fn(13,l,r,m),a.elementType=O,a.lanes=v,a;case B:return a=Fn(19,l,r,m),a.elementType=B,a.lanes=v,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case k:case j:w=10;break e;case _:w=9;break e;case S:w=11;break e;case L:w=14;break e;case M:w=16,u=null;break e}w=29,l=Error(i(130,a===null?"null":typeof a,"")),u=null}return r=Fn(w,l,r,m),r.elementType=a,r.type=u,r.lanes=v,r}function br(a,r,l,u){return a=Fn(7,a,u,r),a.lanes=l,a}function em(a,r,l){return a=Fn(6,a,null,r),a.lanes=l,a}function tm(a,r,l){return r=Fn(4,a.children!==null?a.children:[],a.key,r),r.lanes=l,r.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},r}var jo=[],To=0,ud=null,dd=0,os=[],ls=0,_r=null,_a=1,Ea="";function Er(a,r){jo[To++]=dd,jo[To++]=ud,ud=a,dd=r}function Oy(a,r,l){os[ls++]=_a,os[ls++]=Ea,os[ls++]=_r,_r=a;var u=_a;a=Ea;var m=32-fn(u)-1;u&=~(1<<m),l+=1;var v=32-fn(r)+m;if(30<v){var w=m-m%5;v=(u&(1<<w)-1).toString(32),u>>=w,m-=w,_a=1<<32-fn(r)+m|l<<m|u,Ea=v+a}else _a=1<<v|l<<m|u,Ea=a}function nm(a){a.return!==null&&(Er(a,1),Oy(a,1,0))}function sm(a){for(;a===ud;)ud=jo[--To],jo[To]=null,dd=jo[--To],jo[To]=null;for(;a===_r;)_r=os[--ls],os[ls]=null,Ea=os[--ls],os[ls]=null,_a=os[--ls],os[ls]=null}var An=null,Ct=null,nt=!1,jr=null,zs=!1,am=Error(i(519));function Tr(a){var r=Error(i(418,""));throw Jl(is(r,a)),am}function Py(a){var r=a.stateNode,l=a.type,u=a.memoizedProps;switch(r[Ft]=a,r[Dt]=u,l){case"dialog":$e("cancel",r),$e("close",r);break;case"iframe":case"object":case"embed":$e("load",r);break;case"video":case"audio":for(l=0;l<Ec.length;l++)$e(Ec[l],r);break;case"source":$e("error",r);break;case"img":case"image":case"link":$e("error",r),$e("load",r);break;case"details":$e("toggle",r);break;case"input":$e("invalid",r),cr(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),lo(r);break;case"select":$e("invalid",r);break;case"textarea":$e("invalid",r),ur(r,u.value,u.defaultValue,u.children),lo(r)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||u.suppressHydrationWarning===!0||JN(r.textContent,l)?(u.popover!=null&&($e("beforetoggle",r),$e("toggle",r)),u.onScroll!=null&&$e("scroll",r),u.onScrollEnd!=null&&$e("scrollend",r),u.onClick!=null&&(r.onclick=Gd),r=!0):r=!1,r||Tr(a)}function Ly(a){for(An=a.return;An;)switch(An.tag){case 5:case 13:zs=!1;return;case 27:case 3:zs=!0;return;default:An=An.return}}function Wl(a){if(a!==An)return!1;if(!nt)return Ly(a),nt=!0,!1;var r=a.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=a.type,l=!(l!=="form"&&l!=="button")||Np(a.type,a.memoizedProps)),l=!l),l&&Ct&&Tr(a),Ly(a),r===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(317));e:{for(a=a.nextSibling,r=0;a;){if(a.nodeType===8)if(l=a.data,l==="/$"){if(r===0){Ct=_s(a.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++;a=a.nextSibling}Ct=null}}else r===27?(r=Ct,mi(a.type)?(a=jp,jp=null,Ct=a):Ct=r):Ct=An?_s(a.stateNode.nextSibling):null;return!0}function Zl(){Ct=An=null,nt=!1}function Vy(){var a=jr;return a!==null&&(Dn===null?Dn=a:Dn.push.apply(Dn,a),jr=null),a}function Jl(a){jr===null?jr=[a]:jr.push(a)}var im=te(null),Ar=null,ja=null;function Ja(a,r,l){de(im,r._currentValue),r._currentValue=l}function Ta(a){a._currentValue=im.current,he(im)}function rm(a,r,l){for(;a!==null;){var u=a.alternate;if((a.childLanes&r)!==r?(a.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),a===l)break;a=a.return}}function om(a,r,l,u){var m=a.child;for(m!==null&&(m.return=a);m!==null;){var v=m.dependencies;if(v!==null){var w=m.child;v=v.firstContext;e:for(;v!==null;){var P=v;v=m;for(var z=0;z<r.length;z++)if(P.context===r[z]){v.lanes|=l,P=v.alternate,P!==null&&(P.lanes|=l),rm(v.return,l,a),u||(w=null);break e}v=P.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(i(341));w.lanes|=l,v=w.alternate,v!==null&&(v.lanes|=l),rm(w,l,a),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===a){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function ec(a,r,l,u){a=null;for(var m=r,v=!1;m!==null;){if(!v){if((m.flags&524288)!==0)v=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var P=m.type;Un(m.pendingProps.value,w.value)||(a!==null?a.push(P):a=[P])}}else if(m===Yt.current){if(w=m.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(a!==null?a.push(Sc):a=[Sc])}m=m.return}a!==null&&om(r,a,l,u),r.flags|=262144}function hd(a){for(a=a.firstContext;a!==null;){if(!Un(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Cr(a){Ar=a,ja=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function mn(a){return Uy(Ar,a)}function fd(a,r){return Ar===null&&Cr(a),Uy(a,r)}function Uy(a,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},ja===null){if(a===null)throw Error(i(308));ja=r,a.dependencies={lanes:0,firstContext:r},a.flags|=524288}else ja=ja.next=r;return l}var TC=typeof AbortController<"u"?AbortController:function(){var a=[],r=this.signal={aborted:!1,addEventListener:function(l,u){a.push(u)}};this.abort=function(){r.aborted=!0,a.forEach(function(l){return l()})}},AC=n.unstable_scheduleCallback,CC=n.unstable_NormalPriority,Bt={$$typeof:j,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lm(){return{controller:new TC,data:new Map,refCount:0}}function tc(a){a.refCount--,a.refCount===0&&AC(CC,function(){a.controller.abort()})}var nc=null,cm=0,Ao=0,Co=null;function wC(a,r){if(nc===null){var l=nc=[];cm=0,Ao=dp(),Co={status:"pending",value:void 0,then:function(u){l.push(u)}}}return cm++,r.then(Fy,Fy),r}function Fy(){if(--cm===0&&nc!==null){Co!==null&&(Co.status="fulfilled");var a=nc;nc=null,Ao=0,Co=null;for(var r=0;r<a.length;r++)(0,a[r])()}}function SC(a,r){var l=[],u={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return a.then(function(){u.status="fulfilled",u.value=r;for(var m=0;m<l.length;m++)(0,l[m])(r)},function(m){for(u.status="rejected",u.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),u}var qy=Y.S;Y.S=function(a,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&wC(a,r),qy!==null&&qy(a,r)};var wr=te(null);function um(){var a=wr.current;return a!==null?a:gt.pooledCache}function md(a,r){r===null?de(wr,wr.current):de(wr,r.pool)}function Hy(){var a=um();return a===null?null:{parent:Bt._currentValue,pool:a}}var sc=Error(i(460)),By=Error(i(474)),pd=Error(i(542)),dm={then:function(){}};function zy(a){return a=a.status,a==="fulfilled"||a==="rejected"}function gd(){}function Gy(a,r,l){switch(l=a[l],l===void 0?a.push(r):l!==r&&(r.then(gd,gd),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw a=r.reason,Yy(a),a;default:if(typeof r.status=="string")r.then(gd,gd);else{if(a=gt,a!==null&&100<a.shellSuspendCounter)throw Error(i(482));a=r,a.status="pending",a.then(function(u){if(r.status==="pending"){var m=r;m.status="fulfilled",m.value=u}},function(u){if(r.status==="pending"){var m=r;m.status="rejected",m.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw a=r.reason,Yy(a),a}throw ac=r,sc}}var ac=null;function $y(){if(ac===null)throw Error(i(459));var a=ac;return ac=null,a}function Yy(a){if(a===sc||a===pd)throw Error(i(483))}var ei=!1;function hm(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function fm(a,r){a=a.updateQueue,r.updateQueue===a&&(r.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function ti(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function ni(a,r,l){var u=a.updateQueue;if(u===null)return null;if(u=u.shared,(it&2)!==0){var m=u.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),u.pending=r,r=ld(a),Dy(a,null,l),r}return od(a,u,r,l),ld(a)}function ic(a,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var u=r.lanes;u&=a.pendingLanes,l|=u,r.lanes=l,Dl(a,l)}}function mm(a,r){var l=a.updateQueue,u=a.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var m=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?m=v=w:v=v.next=w,l=l.next}while(l!==null);v===null?m=v=r:v=v.next=r}else m=v=r;l={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:u.shared,callbacks:u.callbacks},a.updateQueue=l;return}a=l.lastBaseUpdate,a===null?l.firstBaseUpdate=r:a.next=r,l.lastBaseUpdate=r}var pm=!1;function rc(){if(pm){var a=Co;if(a!==null)throw a}}function oc(a,r,l,u){pm=!1;var m=a.updateQueue;ei=!1;var v=m.firstBaseUpdate,w=m.lastBaseUpdate,P=m.shared.pending;if(P!==null){m.shared.pending=null;var z=P,W=z.next;z.next=null,w===null?v=W:w.next=W,w=z;var se=a.alternate;se!==null&&(se=se.updateQueue,P=se.lastBaseUpdate,P!==w&&(P===null?se.firstBaseUpdate=W:P.next=W,se.lastBaseUpdate=z))}if(v!==null){var oe=m.baseState;w=0,se=W=z=null,P=v;do{var Z=P.lane&-536870913,J=Z!==P.lane;if(J?(We&Z)===Z:(u&Z)===Z){Z!==0&&Z===Ao&&(pm=!0),se!==null&&(se=se.next={lane:0,tag:P.tag,payload:P.payload,callback:null,next:null});e:{var Re=a,Ae=P;Z=r;var ut=l;switch(Ae.tag){case 1:if(Re=Ae.payload,typeof Re=="function"){oe=Re.call(ut,oe,Z);break e}oe=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Ae.payload,Z=typeof Re=="function"?Re.call(ut,oe,Z):Re,Z==null)break e;oe=y({},oe,Z);break e;case 2:ei=!0}}Z=P.callback,Z!==null&&(a.flags|=64,J&&(a.flags|=8192),J=m.callbacks,J===null?m.callbacks=[Z]:J.push(Z))}else J={lane:Z,tag:P.tag,payload:P.payload,callback:P.callback,next:null},se===null?(W=se=J,z=oe):se=se.next=J,w|=Z;if(P=P.next,P===null){if(P=m.shared.pending,P===null)break;J=P,P=J.next,J.next=null,m.lastBaseUpdate=J,m.shared.pending=null}}while(!0);se===null&&(z=oe),m.baseState=z,m.firstBaseUpdate=W,m.lastBaseUpdate=se,v===null&&(m.shared.lanes=0),ui|=w,a.lanes=w,a.memoizedState=oe}}function Qy(a,r){if(typeof a!="function")throw Error(i(191,a));a.call(r)}function Ky(a,r){var l=a.callbacks;if(l!==null)for(a.callbacks=null,a=0;a<l.length;a++)Qy(l[a],r)}var wo=te(null),vd=te(0);function Xy(a,r){a=Ma,de(vd,a),de(wo,r),Ma=a|r.baseLanes}function gm(){de(vd,Ma),de(wo,wo.current)}function vm(){Ma=vd.current,he(wo),he(vd)}var si=0,He=null,lt=null,Ot=null,yd=!1,So=!1,Sr=!1,xd=0,lc=0,Io=null,IC=0;function It(){throw Error(i(321))}function ym(a,r){if(r===null)return!1;for(var l=0;l<r.length&&l<a.length;l++)if(!Un(a[l],r[l]))return!1;return!0}function xm(a,r,l,u,m,v){return si=v,He=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Y.H=a===null||a.memoizedState===null?Dx:kx,Sr=!1,v=l(u,m),Sr=!1,So&&(v=Zy(r,l,u,m)),Wy(a),v}function Wy(a){Y.H=Td;var r=lt!==null&&lt.next!==null;if(si=0,Ot=lt=He=null,yd=!1,lc=0,Io=null,r)throw Error(i(300));a===null||Xt||(a=a.dependencies,a!==null&&hd(a)&&(Xt=!0))}function Zy(a,r,l,u){He=a;var m=0;do{if(So&&(Io=null),lc=0,So=!1,25<=m)throw Error(i(301));if(m+=1,Ot=lt=null,a.updateQueue!=null){var v=a.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}Y.H=LC,v=r(l,u)}while(So);return v}function RC(){var a=Y.H,r=a.useState()[0];return r=typeof r.then=="function"?cc(r):r,a=a.useState()[0],(lt!==null?lt.memoizedState:null)!==a&&(He.flags|=1024),r}function Nm(){var a=xd!==0;return xd=0,a}function bm(a,r,l){r.updateQueue=a.updateQueue,r.flags&=-2053,a.lanes&=~l}function _m(a){if(yd){for(a=a.memoizedState;a!==null;){var r=a.queue;r!==null&&(r.pending=null),a=a.next}yd=!1}si=0,Ot=lt=He=null,So=!1,lc=xd=0,Io=null}function Rn(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?He.memoizedState=Ot=a:Ot=Ot.next=a,Ot}function Pt(){if(lt===null){var a=He.alternate;a=a!==null?a.memoizedState:null}else a=lt.next;var r=Ot===null?He.memoizedState:Ot.next;if(r!==null)Ot=r,lt=a;else{if(a===null)throw He.alternate===null?Error(i(467)):Error(i(310));lt=a,a={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},Ot===null?He.memoizedState=Ot=a:Ot=Ot.next=a}return Ot}function Em(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function cc(a){var r=lc;return lc+=1,Io===null&&(Io=[]),a=Gy(Io,a,r),r=He,(Ot===null?r.memoizedState:Ot.next)===null&&(r=r.alternate,Y.H=r===null||r.memoizedState===null?Dx:kx),a}function Nd(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return cc(a);if(a.$$typeof===j)return mn(a)}throw Error(i(438,String(a)))}function jm(a){var r=null,l=He.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var u=He.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(m){return m.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=Em(),He.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(a),u=0;u<a;u++)l[u]=U;return r.index++,l}function Aa(a,r){return typeof r=="function"?r(a):r}function bd(a){var r=Pt();return Tm(r,lt,a)}function Tm(a,r,l){var u=a.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var m=a.baseQueue,v=u.pending;if(v!==null){if(m!==null){var w=m.next;m.next=v.next,v.next=w}r.baseQueue=m=v,u.pending=null}if(v=a.baseState,m===null)a.memoizedState=v;else{r=m.next;var P=w=null,z=null,W=r,se=!1;do{var oe=W.lane&-536870913;if(oe!==W.lane?(We&oe)===oe:(si&oe)===oe){var Z=W.revertLane;if(Z===0)z!==null&&(z=z.next={lane:0,revertLane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),oe===Ao&&(se=!0);else if((si&Z)===Z){W=W.next,Z===Ao&&(se=!0);continue}else oe={lane:0,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},z===null?(P=z=oe,w=v):z=z.next=oe,He.lanes|=Z,ui|=Z;oe=W.action,Sr&&l(v,oe),v=W.hasEagerState?W.eagerState:l(v,oe)}else Z={lane:oe,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},z===null?(P=z=Z,w=v):z=z.next=Z,He.lanes|=oe,ui|=oe;W=W.next}while(W!==null&&W!==r);if(z===null?w=v:z.next=P,!Un(v,a.memoizedState)&&(Xt=!0,se&&(l=Co,l!==null)))throw l;a.memoizedState=v,a.baseState=w,a.baseQueue=z,u.lastRenderedState=v}return m===null&&(u.lanes=0),[a.memoizedState,u.dispatch]}function Am(a){var r=Pt(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=a;var u=l.dispatch,m=l.pending,v=r.memoizedState;if(m!==null){l.pending=null;var w=m=m.next;do v=a(v,w.action),w=w.next;while(w!==m);Un(v,r.memoizedState)||(Xt=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),l.lastRenderedState=v}return[v,u]}function Jy(a,r,l){var u=He,m=Pt(),v=nt;if(v){if(l===void 0)throw Error(i(407));l=l()}else l=r();var w=!Un((lt||m).memoizedState,l);w&&(m.memoizedState=l,Xt=!0),m=m.queue;var P=nx.bind(null,u,m,a);if(uc(2048,8,P,[a]),m.getSnapshot!==r||w||Ot!==null&&Ot.memoizedState.tag&1){if(u.flags|=2048,Ro(9,_d(),tx.bind(null,u,m,l,r),null),gt===null)throw Error(i(349));v||(si&124)!==0||ex(u,r,l)}return l}function ex(a,r,l){a.flags|=16384,a={getSnapshot:r,value:l},r=He.updateQueue,r===null?(r=Em(),He.updateQueue=r,r.stores=[a]):(l=r.stores,l===null?r.stores=[a]:l.push(a))}function tx(a,r,l,u){r.value=l,r.getSnapshot=u,sx(r)&&ax(a)}function nx(a,r,l){return l(function(){sx(r)&&ax(a)})}function sx(a){var r=a.getSnapshot;a=a.value;try{var l=r();return!Un(a,l)}catch{return!0}}function ax(a){var r=_o(a,2);r!==null&&Gn(r,a,2)}function Cm(a){var r=Rn();if(typeof a=="function"){var l=a;if(a=l(),Sr){Ln(!0);try{l()}finally{Ln(!1)}}}return r.memoizedState=r.baseState=a,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:a},r}function ix(a,r,l,u){return a.baseState=l,Tm(a,lt,typeof u=="function"?u:Aa)}function MC(a,r,l,u,m){if(jd(a))throw Error(i(485));if(a=r.action,a!==null){var v={payload:m,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){v.listeners.push(w)}};Y.T!==null?l(!0):v.isTransition=!1,u(v),l=r.pending,l===null?(v.next=r.pending=v,rx(r,v)):(v.next=l.next,r.pending=l.next=v)}}function rx(a,r){var l=r.action,u=r.payload,m=a.state;if(r.isTransition){var v=Y.T,w={};Y.T=w;try{var P=l(m,u),z=Y.S;z!==null&&z(w,P),ox(a,r,P)}catch(W){wm(a,r,W)}finally{Y.T=v}}else try{v=l(m,u),ox(a,r,v)}catch(W){wm(a,r,W)}}function ox(a,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){lx(a,r,u)},function(u){return wm(a,r,u)}):lx(a,r,l)}function lx(a,r,l){r.status="fulfilled",r.value=l,cx(r),a.state=l,r=a.pending,r!==null&&(l=r.next,l===r?a.pending=null:(l=l.next,r.next=l,rx(a,l)))}function wm(a,r,l){var u=a.pending;if(a.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=l,cx(r),r=r.next;while(r!==u)}a.action=null}function cx(a){a=a.listeners;for(var r=0;r<a.length;r++)(0,a[r])()}function ux(a,r){return r}function dx(a,r){if(nt){var l=gt.formState;if(l!==null){e:{var u=He;if(nt){if(Ct){t:{for(var m=Ct,v=zs;m.nodeType!==8;){if(!v){m=null;break t}if(m=_s(m.nextSibling),m===null){m=null;break t}}v=m.data,m=v==="F!"||v==="F"?m:null}if(m){Ct=_s(m.nextSibling),u=m.data==="F!";break e}}Tr(u)}u=!1}u&&(r=l[0])}}return l=Rn(),l.memoizedState=l.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ux,lastRenderedState:r},l.queue=u,l=Ix.bind(null,He,u),u.dispatch=l,u=Cm(!1),v=Dm.bind(null,He,!1,u.queue),u=Rn(),m={state:r,dispatch:null,action:a,pending:null},u.queue=m,l=MC.bind(null,He,m,v,l),m.dispatch=l,u.memoizedState=a,[r,l,!1]}function hx(a){var r=Pt();return fx(r,lt,a)}function fx(a,r,l){if(r=Tm(a,r,ux)[0],a=bd(Aa)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=cc(r)}catch(w){throw w===sc?pd:w}else u=r;r=Pt();var m=r.queue,v=m.dispatch;return l!==r.memoizedState&&(He.flags|=2048,Ro(9,_d(),DC.bind(null,m,l),null)),[u,v,a]}function DC(a,r){a.action=r}function mx(a){var r=Pt(),l=lt;if(l!==null)return fx(r,l,a);Pt(),r=r.memoizedState,l=Pt();var u=l.queue.dispatch;return l.memoizedState=a,[r,u,!1]}function Ro(a,r,l,u){return a={tag:a,create:l,deps:u,inst:r,next:null},r=He.updateQueue,r===null&&(r=Em(),He.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=a.next=a:(u=l.next,l.next=a,a.next=u,r.lastEffect=a),a}function _d(){return{destroy:void 0,resource:void 0}}function px(){return Pt().memoizedState}function Ed(a,r,l,u){var m=Rn();u=u===void 0?null:u,He.flags|=a,m.memoizedState=Ro(1|r,_d(),l,u)}function uc(a,r,l,u){var m=Pt();u=u===void 0?null:u;var v=m.memoizedState.inst;lt!==null&&u!==null&&ym(u,lt.memoizedState.deps)?m.memoizedState=Ro(r,v,l,u):(He.flags|=a,m.memoizedState=Ro(1|r,v,l,u))}function gx(a,r){Ed(8390656,8,a,r)}function vx(a,r){uc(2048,8,a,r)}function yx(a,r){return uc(4,2,a,r)}function xx(a,r){return uc(4,4,a,r)}function Nx(a,r){if(typeof r=="function"){a=a();var l=r(a);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return a=a(),r.current=a,function(){r.current=null}}function bx(a,r,l){l=l!=null?l.concat([a]):null,uc(4,4,Nx.bind(null,r,a),l)}function Sm(){}function _x(a,r){var l=Pt();r=r===void 0?null:r;var u=l.memoizedState;return r!==null&&ym(r,u[1])?u[0]:(l.memoizedState=[a,r],a)}function Ex(a,r){var l=Pt();r=r===void 0?null:r;var u=l.memoizedState;if(r!==null&&ym(r,u[1]))return u[0];if(u=a(),Sr){Ln(!0);try{a()}finally{Ln(!1)}}return l.memoizedState=[u,r],u}function Im(a,r,l){return l===void 0||(si&1073741824)!==0?a.memoizedState=r:(a.memoizedState=l,a=AN(),He.lanes|=a,ui|=a,l)}function jx(a,r,l,u){return Un(l,r)?l:wo.current!==null?(a=Im(a,l,u),Un(a,r)||(Xt=!0),a):(si&42)===0?(Xt=!0,a.memoizedState=l):(a=AN(),He.lanes|=a,ui|=a,r)}function Tx(a,r,l,u,m){var v=ie.p;ie.p=v!==0&&8>v?v:8;var w=Y.T,P={};Y.T=P,Dm(a,!1,r,l);try{var z=m(),W=Y.S;if(W!==null&&W(P,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var se=SC(z,u);dc(a,r,se,zn(a))}else dc(a,r,u,zn(a))}catch(oe){dc(a,r,{then:function(){},status:"rejected",reason:oe},zn())}finally{ie.p=v,Y.T=w}}function kC(){}function Rm(a,r,l,u){if(a.tag!==5)throw Error(i(476));var m=Ax(a).queue;Tx(a,m,r,ee,l===null?kC:function(){return Cx(a),l(u)})}function Ax(a){var r=a.memoizedState;if(r!==null)return r;r={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:ee},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:l},next:null},a.memoizedState=r,a=a.alternate,a!==null&&(a.memoizedState=r),r}function Cx(a){var r=Ax(a).next.queue;dc(a,r,{},zn())}function Mm(){return mn(Sc)}function wx(){return Pt().memoizedState}function Sx(){return Pt().memoizedState}function OC(a){for(var r=a.return;r!==null;){switch(r.tag){case 24:case 3:var l=zn();a=ti(l);var u=ni(r,a,l);u!==null&&(Gn(u,r,l),ic(u,r,l)),r={cache:lm()},a.payload=r;return}r=r.return}}function PC(a,r,l){var u=zn();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},jd(a)?Rx(r,l):(l=Zf(a,r,l,u),l!==null&&(Gn(l,a,u),Mx(l,r,u)))}function Ix(a,r,l){var u=zn();dc(a,r,l,u)}function dc(a,r,l,u){var m={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(jd(a))Rx(r,m);else{var v=a.alternate;if(a.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var w=r.lastRenderedState,P=v(w,l);if(m.hasEagerState=!0,m.eagerState=P,Un(P,w))return od(a,r,m,0),gt===null&&rd(),!1}catch{}finally{}if(l=Zf(a,r,m,u),l!==null)return Gn(l,a,u),Mx(l,r,u),!0}return!1}function Dm(a,r,l,u){if(u={lane:2,revertLane:dp(),action:u,hasEagerState:!1,eagerState:null,next:null},jd(a)){if(r)throw Error(i(479))}else r=Zf(a,l,u,2),r!==null&&Gn(r,a,2)}function jd(a){var r=a.alternate;return a===He||r!==null&&r===He}function Rx(a,r){So=yd=!0;var l=a.pending;l===null?r.next=r:(r.next=l.next,l.next=r),a.pending=r}function Mx(a,r,l){if((l&4194048)!==0){var u=r.lanes;u&=a.pendingLanes,l|=u,r.lanes=l,Dl(a,l)}}var Td={readContext:mn,use:Nd,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useLayoutEffect:It,useInsertionEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useSyncExternalStore:It,useId:It,useHostTransitionStatus:It,useFormState:It,useActionState:It,useOptimistic:It,useMemoCache:It,useCacheRefresh:It},Dx={readContext:mn,use:Nd,useCallback:function(a,r){return Rn().memoizedState=[a,r===void 0?null:r],a},useContext:mn,useEffect:gx,useImperativeHandle:function(a,r,l){l=l!=null?l.concat([a]):null,Ed(4194308,4,Nx.bind(null,r,a),l)},useLayoutEffect:function(a,r){return Ed(4194308,4,a,r)},useInsertionEffect:function(a,r){Ed(4,2,a,r)},useMemo:function(a,r){var l=Rn();r=r===void 0?null:r;var u=a();if(Sr){Ln(!0);try{a()}finally{Ln(!1)}}return l.memoizedState=[u,r],u},useReducer:function(a,r,l){var u=Rn();if(l!==void 0){var m=l(r);if(Sr){Ln(!0);try{l(r)}finally{Ln(!1)}}}else m=r;return u.memoizedState=u.baseState=m,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:m},u.queue=a,a=a.dispatch=PC.bind(null,He,a),[u.memoizedState,a]},useRef:function(a){var r=Rn();return a={current:a},r.memoizedState=a},useState:function(a){a=Cm(a);var r=a.queue,l=Ix.bind(null,He,r);return r.dispatch=l,[a.memoizedState,l]},useDebugValue:Sm,useDeferredValue:function(a,r){var l=Rn();return Im(l,a,r)},useTransition:function(){var a=Cm(!1);return a=Tx.bind(null,He,a.queue,!0,!1),Rn().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,r,l){var u=He,m=Rn();if(nt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),gt===null)throw Error(i(349));(We&124)!==0||ex(u,r,l)}m.memoizedState=l;var v={value:l,getSnapshot:r};return m.queue=v,gx(nx.bind(null,u,v,a),[a]),u.flags|=2048,Ro(9,_d(),tx.bind(null,u,v,l,r),null),l},useId:function(){var a=Rn(),r=gt.identifierPrefix;if(nt){var l=Ea,u=_a;l=(u&~(1<<32-fn(u)-1)).toString(32)+l,r=""+r+"R"+l,l=xd++,0<l&&(r+="H"+l.toString(32)),r+=""}else l=IC++,r=""+r+"r"+l.toString(32)+"";return a.memoizedState=r},useHostTransitionStatus:Mm,useFormState:dx,useActionState:dx,useOptimistic:function(a){var r=Rn();r.memoizedState=r.baseState=a;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=Dm.bind(null,He,!0,l),l.dispatch=r,[a,r]},useMemoCache:jm,useCacheRefresh:function(){return Rn().memoizedState=OC.bind(null,He)}},kx={readContext:mn,use:Nd,useCallback:_x,useContext:mn,useEffect:vx,useImperativeHandle:bx,useInsertionEffect:yx,useLayoutEffect:xx,useMemo:Ex,useReducer:bd,useRef:px,useState:function(){return bd(Aa)},useDebugValue:Sm,useDeferredValue:function(a,r){var l=Pt();return jx(l,lt.memoizedState,a,r)},useTransition:function(){var a=bd(Aa)[0],r=Pt().memoizedState;return[typeof a=="boolean"?a:cc(a),r]},useSyncExternalStore:Jy,useId:wx,useHostTransitionStatus:Mm,useFormState:hx,useActionState:hx,useOptimistic:function(a,r){var l=Pt();return ix(l,lt,a,r)},useMemoCache:jm,useCacheRefresh:Sx},LC={readContext:mn,use:Nd,useCallback:_x,useContext:mn,useEffect:vx,useImperativeHandle:bx,useInsertionEffect:yx,useLayoutEffect:xx,useMemo:Ex,useReducer:Am,useRef:px,useState:function(){return Am(Aa)},useDebugValue:Sm,useDeferredValue:function(a,r){var l=Pt();return lt===null?Im(l,a,r):jx(l,lt.memoizedState,a,r)},useTransition:function(){var a=Am(Aa)[0],r=Pt().memoizedState;return[typeof a=="boolean"?a:cc(a),r]},useSyncExternalStore:Jy,useId:wx,useHostTransitionStatus:Mm,useFormState:mx,useActionState:mx,useOptimistic:function(a,r){var l=Pt();return lt!==null?ix(l,lt,a,r):(l.baseState=a,[a,l.queue.dispatch])},useMemoCache:jm,useCacheRefresh:Sx},Mo=null,hc=0;function Ad(a){var r=hc;return hc+=1,Mo===null&&(Mo=[]),Gy(Mo,a,r)}function fc(a,r){r=r.props.ref,a.ref=r!==void 0?r:null}function Cd(a,r){throw r.$$typeof===N?Error(i(525)):(a=Object.prototype.toString.call(r),Error(i(31,a==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":a)))}function Ox(a){var r=a._init;return r(a._payload)}function Px(a){function r(Q,$){if(a){var X=Q.deletions;X===null?(Q.deletions=[$],Q.flags|=16):X.push($)}}function l(Q,$){if(!a)return null;for(;$!==null;)r(Q,$),$=$.sibling;return null}function u(Q){for(var $=new Map;Q!==null;)Q.key!==null?$.set(Q.key,Q):$.set(Q.index,Q),Q=Q.sibling;return $}function m(Q,$){return Q=ba(Q,$),Q.index=0,Q.sibling=null,Q}function v(Q,$,X){return Q.index=X,a?(X=Q.alternate,X!==null?(X=X.index,X<$?(Q.flags|=67108866,$):X):(Q.flags|=67108866,$)):(Q.flags|=1048576,$)}function w(Q){return a&&Q.alternate===null&&(Q.flags|=67108866),Q}function P(Q,$,X,re){return $===null||$.tag!==6?($=em(X,Q.mode,re),$.return=Q,$):($=m($,X),$.return=Q,$)}function z(Q,$,X,re){var ye=X.type;return ye===T?se(Q,$,X.props.children,re,X.key):$!==null&&($.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===M&&Ox(ye)===$.type)?($=m($,X.props),fc($,X),$.return=Q,$):($=cd(X.type,X.key,X.props,null,Q.mode,re),fc($,X),$.return=Q,$)}function W(Q,$,X,re){return $===null||$.tag!==4||$.stateNode.containerInfo!==X.containerInfo||$.stateNode.implementation!==X.implementation?($=tm(X,Q.mode,re),$.return=Q,$):($=m($,X.children||[]),$.return=Q,$)}function se(Q,$,X,re,ye){return $===null||$.tag!==7?($=br(X,Q.mode,re,ye),$.return=Q,$):($=m($,X),$.return=Q,$)}function oe(Q,$,X){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=em(""+$,Q.mode,X),$.return=Q,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case E:return X=cd($.type,$.key,$.props,null,Q.mode,X),fc(X,$),X.return=Q,X;case A:return $=tm($,Q.mode,X),$.return=Q,$;case M:var re=$._init;return $=re($._payload),oe(Q,$,X)}if(Ie($)||D($))return $=br($,Q.mode,X,null),$.return=Q,$;if(typeof $.then=="function")return oe(Q,Ad($),X);if($.$$typeof===j)return oe(Q,fd(Q,$),X);Cd(Q,$)}return null}function Z(Q,$,X,re){var ye=$!==null?$.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return ye!==null?null:P(Q,$,""+X,re);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case E:return X.key===ye?z(Q,$,X,re):null;case A:return X.key===ye?W(Q,$,X,re):null;case M:return ye=X._init,X=ye(X._payload),Z(Q,$,X,re)}if(Ie(X)||D(X))return ye!==null?null:se(Q,$,X,re,null);if(typeof X.then=="function")return Z(Q,$,Ad(X),re);if(X.$$typeof===j)return Z(Q,$,fd(Q,X),re);Cd(Q,X)}return null}function J(Q,$,X,re,ye){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return Q=Q.get(X)||null,P($,Q,""+re,ye);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case E:return Q=Q.get(re.key===null?X:re.key)||null,z($,Q,re,ye);case A:return Q=Q.get(re.key===null?X:re.key)||null,W($,Q,re,ye);case M:var ze=re._init;return re=ze(re._payload),J(Q,$,X,re,ye)}if(Ie(re)||D(re))return Q=Q.get(X)||null,se($,Q,re,ye,null);if(typeof re.then=="function")return J(Q,$,X,Ad(re),ye);if(re.$$typeof===j)return J(Q,$,X,fd($,re),ye);Cd($,re)}return null}function Re(Q,$,X,re){for(var ye=null,ze=null,Ne=$,Ce=$=0,Zt=null;Ne!==null&&Ce<X.length;Ce++){Ne.index>Ce?(Zt=Ne,Ne=null):Zt=Ne.sibling;var tt=Z(Q,Ne,X[Ce],re);if(tt===null){Ne===null&&(Ne=Zt);break}a&&Ne&&tt.alternate===null&&r(Q,Ne),$=v(tt,$,Ce),ze===null?ye=tt:ze.sibling=tt,ze=tt,Ne=Zt}if(Ce===X.length)return l(Q,Ne),nt&&Er(Q,Ce),ye;if(Ne===null){for(;Ce<X.length;Ce++)Ne=oe(Q,X[Ce],re),Ne!==null&&($=v(Ne,$,Ce),ze===null?ye=Ne:ze.sibling=Ne,ze=Ne);return nt&&Er(Q,Ce),ye}for(Ne=u(Ne);Ce<X.length;Ce++)Zt=J(Ne,Q,Ce,X[Ce],re),Zt!==null&&(a&&Zt.alternate!==null&&Ne.delete(Zt.key===null?Ce:Zt.key),$=v(Zt,$,Ce),ze===null?ye=Zt:ze.sibling=Zt,ze=Zt);return a&&Ne.forEach(function(xi){return r(Q,xi)}),nt&&Er(Q,Ce),ye}function Ae(Q,$,X,re){if(X==null)throw Error(i(151));for(var ye=null,ze=null,Ne=$,Ce=$=0,Zt=null,tt=X.next();Ne!==null&&!tt.done;Ce++,tt=X.next()){Ne.index>Ce?(Zt=Ne,Ne=null):Zt=Ne.sibling;var xi=Z(Q,Ne,tt.value,re);if(xi===null){Ne===null&&(Ne=Zt);break}a&&Ne&&xi.alternate===null&&r(Q,Ne),$=v(xi,$,Ce),ze===null?ye=xi:ze.sibling=xi,ze=xi,Ne=Zt}if(tt.done)return l(Q,Ne),nt&&Er(Q,Ce),ye;if(Ne===null){for(;!tt.done;Ce++,tt=X.next())tt=oe(Q,tt.value,re),tt!==null&&($=v(tt,$,Ce),ze===null?ye=tt:ze.sibling=tt,ze=tt);return nt&&Er(Q,Ce),ye}for(Ne=u(Ne);!tt.done;Ce++,tt=X.next())tt=J(Ne,Q,Ce,tt.value,re),tt!==null&&(a&&tt.alternate!==null&&Ne.delete(tt.key===null?Ce:tt.key),$=v(tt,$,Ce),ze===null?ye=tt:ze.sibling=tt,ze=tt);return a&&Ne.forEach(function(Vw){return r(Q,Vw)}),nt&&Er(Q,Ce),ye}function ut(Q,$,X,re){if(typeof X=="object"&&X!==null&&X.type===T&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case E:e:{for(var ye=X.key;$!==null;){if($.key===ye){if(ye=X.type,ye===T){if($.tag===7){l(Q,$.sibling),re=m($,X.props.children),re.return=Q,Q=re;break e}}else if($.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===M&&Ox(ye)===$.type){l(Q,$.sibling),re=m($,X.props),fc(re,X),re.return=Q,Q=re;break e}l(Q,$);break}else r(Q,$);$=$.sibling}X.type===T?(re=br(X.props.children,Q.mode,re,X.key),re.return=Q,Q=re):(re=cd(X.type,X.key,X.props,null,Q.mode,re),fc(re,X),re.return=Q,Q=re)}return w(Q);case A:e:{for(ye=X.key;$!==null;){if($.key===ye)if($.tag===4&&$.stateNode.containerInfo===X.containerInfo&&$.stateNode.implementation===X.implementation){l(Q,$.sibling),re=m($,X.children||[]),re.return=Q,Q=re;break e}else{l(Q,$);break}else r(Q,$);$=$.sibling}re=tm(X,Q.mode,re),re.return=Q,Q=re}return w(Q);case M:return ye=X._init,X=ye(X._payload),ut(Q,$,X,re)}if(Ie(X))return Re(Q,$,X,re);if(D(X)){if(ye=D(X),typeof ye!="function")throw Error(i(150));return X=ye.call(X),Ae(Q,$,X,re)}if(typeof X.then=="function")return ut(Q,$,Ad(X),re);if(X.$$typeof===j)return ut(Q,$,fd(Q,X),re);Cd(Q,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,$!==null&&$.tag===6?(l(Q,$.sibling),re=m($,X),re.return=Q,Q=re):(l(Q,$),re=em(X,Q.mode,re),re.return=Q,Q=re),w(Q)):l(Q,$)}return function(Q,$,X,re){try{hc=0;var ye=ut(Q,$,X,re);return Mo=null,ye}catch(Ne){if(Ne===sc||Ne===pd)throw Ne;var ze=Fn(29,Ne,null,Q.mode);return ze.lanes=re,ze.return=Q,ze}finally{}}}var Do=Px(!0),Lx=Px(!1),cs=te(null),Gs=null;function ai(a){var r=a.alternate;de(zt,zt.current&1),de(cs,a),Gs===null&&(r===null||wo.current!==null||r.memoizedState!==null)&&(Gs=a)}function Vx(a){if(a.tag===22){if(de(zt,zt.current),de(cs,a),Gs===null){var r=a.alternate;r!==null&&r.memoizedState!==null&&(Gs=a)}}else ii()}function ii(){de(zt,zt.current),de(cs,cs.current)}function Ca(a){he(cs),Gs===a&&(Gs=null),he(zt)}var zt=te(0);function wd(a){for(var r=a;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||Ep(l)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break;for(;r.sibling===null;){if(r.return===null||r.return===a)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function km(a,r,l,u){r=a.memoizedState,l=l(u,r),l=l==null?r:y({},r,l),a.memoizedState=l,a.lanes===0&&(a.updateQueue.baseState=l)}var Om={enqueueSetState:function(a,r,l){a=a._reactInternals;var u=zn(),m=ti(u);m.payload=r,l!=null&&(m.callback=l),r=ni(a,m,u),r!==null&&(Gn(r,a,u),ic(r,a,u))},enqueueReplaceState:function(a,r,l){a=a._reactInternals;var u=zn(),m=ti(u);m.tag=1,m.payload=r,l!=null&&(m.callback=l),r=ni(a,m,u),r!==null&&(Gn(r,a,u),ic(r,a,u))},enqueueForceUpdate:function(a,r){a=a._reactInternals;var l=zn(),u=ti(l);u.tag=2,r!=null&&(u.callback=r),r=ni(a,u,l),r!==null&&(Gn(r,a,l),ic(r,a,l))}};function Ux(a,r,l,u,m,v,w){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(u,v,w):r.prototype&&r.prototype.isPureReactComponent?!Kl(l,u)||!Kl(m,v):!0}function Fx(a,r,l,u){a=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,u),r.state!==a&&Om.enqueueReplaceState(r,r.state,null)}function Ir(a,r){var l=r;if("ref"in r){l={};for(var u in r)u!=="ref"&&(l[u]=r[u])}if(a=a.defaultProps){l===r&&(l=y({},l));for(var m in a)l[m]===void 0&&(l[m]=a[m])}return l}var Sd=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function qx(a){Sd(a)}function Hx(a){console.error(a)}function Bx(a){Sd(a)}function Id(a,r){try{var l=a.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function zx(a,r,l){try{var u=a.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Pm(a,r,l){return l=ti(l),l.tag=3,l.payload={element:null},l.callback=function(){Id(a,r)},l}function Gx(a){return a=ti(a),a.tag=3,a}function $x(a,r,l,u){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var v=u.value;a.payload=function(){return m(v)},a.callback=function(){zx(r,l,u)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(a.callback=function(){zx(r,l,u),typeof m!="function"&&(di===null?di=new Set([this]):di.add(this));var P=u.stack;this.componentDidCatch(u.value,{componentStack:P!==null?P:""})})}function VC(a,r,l,u,m){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=l.alternate,r!==null&&ec(r,l,m,!0),l=cs.current,l!==null){switch(l.tag){case 13:return Gs===null?rp():l.alternate===null&&wt===0&&(wt=3),l.flags&=-257,l.flags|=65536,l.lanes=m,u===dm?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([u]):r.add(u),lp(a,u,m)),!1;case 22:return l.flags|=65536,u===dm?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([u]):l.add(u)),lp(a,u,m)),!1}throw Error(i(435,l.tag))}return lp(a,u,m),rp(),!1}if(nt)return r=cs.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=m,u!==am&&(a=Error(i(422),{cause:u}),Jl(is(a,l)))):(u!==am&&(r=Error(i(423),{cause:u}),Jl(is(r,l))),a=a.current.alternate,a.flags|=65536,m&=-m,a.lanes|=m,u=is(u,l),m=Pm(a.stateNode,u,m),mm(a,m),wt!==4&&(wt=2)),!1;var v=Error(i(520),{cause:u});if(v=is(v,l),Nc===null?Nc=[v]:Nc.push(v),wt!==4&&(wt=2),r===null)return!0;u=is(u,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,a=m&-m,l.lanes|=a,a=Pm(l.stateNode,u,a),mm(l,a),!1;case 1:if(r=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(di===null||!di.has(v))))return l.flags|=65536,m&=-m,l.lanes|=m,m=Gx(m),$x(m,a,l,u),mm(l,m),!1}l=l.return}while(l!==null);return!1}var Yx=Error(i(461)),Xt=!1;function sn(a,r,l,u){r.child=a===null?Lx(r,null,l,u):Do(r,a.child,l,u)}function Qx(a,r,l,u,m){l=l.render;var v=r.ref;if("ref"in u){var w={};for(var P in u)P!=="ref"&&(w[P]=u[P])}else w=u;return Cr(r),u=xm(a,r,l,w,v,m),P=Nm(),a!==null&&!Xt?(bm(a,r,m),wa(a,r,m)):(nt&&P&&nm(r),r.flags|=1,sn(a,r,u,m),r.child)}function Kx(a,r,l,u,m){if(a===null){var v=l.type;return typeof v=="function"&&!Jf(v)&&v.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=v,Xx(a,r,v,u,m)):(a=cd(l.type,null,u,r,r.mode,m),a.ref=r.ref,a.return=r,r.child=a)}if(v=a.child,!zm(a,m)){var w=v.memoizedProps;if(l=l.compare,l=l!==null?l:Kl,l(w,u)&&a.ref===r.ref)return wa(a,r,m)}return r.flags|=1,a=ba(v,u),a.ref=r.ref,a.return=r,r.child=a}function Xx(a,r,l,u,m){if(a!==null){var v=a.memoizedProps;if(Kl(v,u)&&a.ref===r.ref)if(Xt=!1,r.pendingProps=u=v,zm(a,m))(a.flags&131072)!==0&&(Xt=!0);else return r.lanes=a.lanes,wa(a,r,m)}return Lm(a,r,l,u,m)}function Wx(a,r,l){var u=r.pendingProps,m=u.children,v=a!==null?a.memoizedState:null;if(u.mode==="hidden"){if((r.flags&128)!==0){if(u=v!==null?v.baseLanes|l:l,a!==null){for(m=r.child=a.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;r.childLanes=v&~u}else r.childLanes=0,r.child=null;return Zx(a,r,u,l)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},a!==null&&md(r,v!==null?v.cachePool:null),v!==null?Xy(r,v):gm(),Vx(r);else return r.lanes=r.childLanes=536870912,Zx(a,r,v!==null?v.baseLanes|l:l,l)}else v!==null?(md(r,v.cachePool),Xy(r,v),ii(),r.memoizedState=null):(a!==null&&md(r,null),gm(),ii());return sn(a,r,m,l),r.child}function Zx(a,r,l,u){var m=um();return m=m===null?null:{parent:Bt._currentValue,pool:m},r.memoizedState={baseLanes:l,cachePool:m},a!==null&&md(r,null),gm(),Vx(r),a!==null&&ec(a,r,u,!0),null}function Rd(a,r){var l=r.ref;if(l===null)a!==null&&a.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(a===null||a.ref!==l)&&(r.flags|=4194816)}}function Lm(a,r,l,u,m){return Cr(r),l=xm(a,r,l,u,void 0,m),u=Nm(),a!==null&&!Xt?(bm(a,r,m),wa(a,r,m)):(nt&&u&&nm(r),r.flags|=1,sn(a,r,l,m),r.child)}function Jx(a,r,l,u,m,v){return Cr(r),r.updateQueue=null,l=Zy(r,u,l,m),Wy(a),u=Nm(),a!==null&&!Xt?(bm(a,r,v),wa(a,r,v)):(nt&&u&&nm(r),r.flags|=1,sn(a,r,l,v),r.child)}function eN(a,r,l,u,m){if(Cr(r),r.stateNode===null){var v=Eo,w=l.contextType;typeof w=="object"&&w!==null&&(v=mn(w)),v=new l(u,v),r.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Om,r.stateNode=v,v._reactInternals=r,v=r.stateNode,v.props=u,v.state=r.memoizedState,v.refs={},hm(r),w=l.contextType,v.context=typeof w=="object"&&w!==null?mn(w):Eo,v.state=r.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(km(r,l,w,u),v.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(w=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),w!==v.state&&Om.enqueueReplaceState(v,v.state,null),oc(r,u,v,m),rc(),v.state=r.memoizedState),typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(a===null){v=r.stateNode;var P=r.memoizedProps,z=Ir(l,P);v.props=z;var W=v.context,se=l.contextType;w=Eo,typeof se=="object"&&se!==null&&(w=mn(se));var oe=l.getDerivedStateFromProps;se=typeof oe=="function"||typeof v.getSnapshotBeforeUpdate=="function",P=r.pendingProps!==P,se||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(P||W!==w)&&Fx(r,v,u,w),ei=!1;var Z=r.memoizedState;v.state=Z,oc(r,u,v,m),rc(),W=r.memoizedState,P||Z!==W||ei?(typeof oe=="function"&&(km(r,l,oe,u),W=r.memoizedState),(z=ei||Ux(r,l,z,u,Z,W,w))?(se||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=W),v.props=u,v.state=W,v.context=w,u=z):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{v=r.stateNode,fm(a,r),w=r.memoizedProps,se=Ir(l,w),v.props=se,oe=r.pendingProps,Z=v.context,W=l.contextType,z=Eo,typeof W=="object"&&W!==null&&(z=mn(W)),P=l.getDerivedStateFromProps,(W=typeof P=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(w!==oe||Z!==z)&&Fx(r,v,u,z),ei=!1,Z=r.memoizedState,v.state=Z,oc(r,u,v,m),rc();var J=r.memoizedState;w!==oe||Z!==J||ei||a!==null&&a.dependencies!==null&&hd(a.dependencies)?(typeof P=="function"&&(km(r,l,P,u),J=r.memoizedState),(se=ei||Ux(r,l,se,u,Z,J,z)||a!==null&&a.dependencies!==null&&hd(a.dependencies))?(W||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,J,z),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,J,z)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||w===a.memoizedProps&&Z===a.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||w===a.memoizedProps&&Z===a.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=J),v.props=u,v.state=J,v.context=z,u=se):(typeof v.componentDidUpdate!="function"||w===a.memoizedProps&&Z===a.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||w===a.memoizedProps&&Z===a.memoizedState||(r.flags|=1024),u=!1)}return v=u,Rd(a,r),u=(r.flags&128)!==0,v||u?(v=r.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:v.render(),r.flags|=1,a!==null&&u?(r.child=Do(r,a.child,null,m),r.child=Do(r,null,l,m)):sn(a,r,l,m),r.memoizedState=v.state,a=r.child):a=wa(a,r,m),a}function tN(a,r,l,u){return Zl(),r.flags|=256,sn(a,r,l,u),r.child}var Vm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Um(a){return{baseLanes:a,cachePool:Hy()}}function Fm(a,r,l){return a=a!==null?a.childLanes&~l:0,r&&(a|=us),a}function nN(a,r,l){var u=r.pendingProps,m=!1,v=(r.flags&128)!==0,w;if((w=v)||(w=a!==null&&a.memoizedState===null?!1:(zt.current&2)!==0),w&&(m=!0,r.flags&=-129),w=(r.flags&32)!==0,r.flags&=-33,a===null){if(nt){if(m?ai(r):ii(),nt){var P=Ct,z;if(z=P){e:{for(z=P,P=zs;z.nodeType!==8;){if(!P){P=null;break e}if(z=_s(z.nextSibling),z===null){P=null;break e}}P=z}P!==null?(r.memoizedState={dehydrated:P,treeContext:_r!==null?{id:_a,overflow:Ea}:null,retryLane:536870912,hydrationErrors:null},z=Fn(18,null,null,0),z.stateNode=P,z.return=r,r.child=z,An=r,Ct=null,z=!0):z=!1}z||Tr(r)}if(P=r.memoizedState,P!==null&&(P=P.dehydrated,P!==null))return Ep(P)?r.lanes=32:r.lanes=536870912,null;Ca(r)}return P=u.children,u=u.fallback,m?(ii(),m=r.mode,P=Md({mode:"hidden",children:P},m),u=br(u,m,l,null),P.return=r,u.return=r,P.sibling=u,r.child=P,m=r.child,m.memoizedState=Um(l),m.childLanes=Fm(a,w,l),r.memoizedState=Vm,u):(ai(r),qm(r,P))}if(z=a.memoizedState,z!==null&&(P=z.dehydrated,P!==null)){if(v)r.flags&256?(ai(r),r.flags&=-257,r=Hm(a,r,l)):r.memoizedState!==null?(ii(),r.child=a.child,r.flags|=128,r=null):(ii(),m=u.fallback,P=r.mode,u=Md({mode:"visible",children:u.children},P),m=br(m,P,l,null),m.flags|=2,u.return=r,m.return=r,u.sibling=m,r.child=u,Do(r,a.child,null,l),u=r.child,u.memoizedState=Um(l),u.childLanes=Fm(a,w,l),r.memoizedState=Vm,r=m);else if(ai(r),Ep(P)){if(w=P.nextSibling&&P.nextSibling.dataset,w)var W=w.dgst;w=W,u=Error(i(419)),u.stack="",u.digest=w,Jl({value:u,source:null,stack:null}),r=Hm(a,r,l)}else if(Xt||ec(a,r,l,!1),w=(l&a.childLanes)!==0,Xt||w){if(w=gt,w!==null&&(u=l&-l,u=(u&42)!==0?1:$a(u),u=(u&(w.suspendedLanes|l))!==0?0:u,u!==0&&u!==z.retryLane))throw z.retryLane=u,_o(a,u),Gn(w,a,u),Yx;P.data==="$?"||rp(),r=Hm(a,r,l)}else P.data==="$?"?(r.flags|=192,r.child=a.child,r=null):(a=z.treeContext,Ct=_s(P.nextSibling),An=r,nt=!0,jr=null,zs=!1,a!==null&&(os[ls++]=_a,os[ls++]=Ea,os[ls++]=_r,_a=a.id,Ea=a.overflow,_r=r),r=qm(r,u.children),r.flags|=4096);return r}return m?(ii(),m=u.fallback,P=r.mode,z=a.child,W=z.sibling,u=ba(z,{mode:"hidden",children:u.children}),u.subtreeFlags=z.subtreeFlags&65011712,W!==null?m=ba(W,m):(m=br(m,P,l,null),m.flags|=2),m.return=r,u.return=r,u.sibling=m,r.child=u,u=m,m=r.child,P=a.child.memoizedState,P===null?P=Um(l):(z=P.cachePool,z!==null?(W=Bt._currentValue,z=z.parent!==W?{parent:W,pool:W}:z):z=Hy(),P={baseLanes:P.baseLanes|l,cachePool:z}),m.memoizedState=P,m.childLanes=Fm(a,w,l),r.memoizedState=Vm,u):(ai(r),l=a.child,a=l.sibling,l=ba(l,{mode:"visible",children:u.children}),l.return=r,l.sibling=null,a!==null&&(w=r.deletions,w===null?(r.deletions=[a],r.flags|=16):w.push(a)),r.child=l,r.memoizedState=null,l)}function qm(a,r){return r=Md({mode:"visible",children:r},a.mode),r.return=a,a.child=r}function Md(a,r){return a=Fn(22,a,null,r),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function Hm(a,r,l){return Do(r,a.child,null,l),a=qm(r,r.pendingProps.children),a.flags|=2,r.memoizedState=null,a}function sN(a,r,l){a.lanes|=r;var u=a.alternate;u!==null&&(u.lanes|=r),rm(a.return,r,l)}function Bm(a,r,l,u,m){var v=a.memoizedState;v===null?a.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:m}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=l,v.tailMode=m)}function aN(a,r,l){var u=r.pendingProps,m=u.revealOrder,v=u.tail;if(sn(a,r,u.children,l),u=zt.current,(u&2)!==0)u=u&1|2,r.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=r.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&sN(a,l,r);else if(a.tag===19)sN(a,l,r);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}u&=1}switch(de(zt,u),m){case"forwards":for(l=r.child,m=null;l!==null;)a=l.alternate,a!==null&&wd(a)===null&&(m=l),l=l.sibling;l=m,l===null?(m=r.child,r.child=null):(m=l.sibling,l.sibling=null),Bm(r,!1,m,l,v);break;case"backwards":for(l=null,m=r.child,r.child=null;m!==null;){if(a=m.alternate,a!==null&&wd(a)===null){r.child=m;break}a=m.sibling,m.sibling=l,l=m,m=a}Bm(r,!0,l,null,v);break;case"together":Bm(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function wa(a,r,l){if(a!==null&&(r.dependencies=a.dependencies),ui|=r.lanes,(l&r.childLanes)===0)if(a!==null){if(ec(a,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(a!==null&&r.child!==a.child)throw Error(i(153));if(r.child!==null){for(a=r.child,l=ba(a,a.pendingProps),r.child=l,l.return=r;a.sibling!==null;)a=a.sibling,l=l.sibling=ba(a,a.pendingProps),l.return=r;l.sibling=null}return r.child}function zm(a,r){return(a.lanes&r)!==0?!0:(a=a.dependencies,!!(a!==null&&hd(a)))}function UC(a,r,l){switch(r.tag){case 3:pt(r,r.stateNode.containerInfo),Ja(r,Bt,a.memoizedState.cache),Zl();break;case 27:case 5:Ga(r);break;case 4:pt(r,r.stateNode.containerInfo);break;case 10:Ja(r,r.type,r.memoizedProps.value);break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(ai(r),r.flags|=128,null):(l&r.child.childLanes)!==0?nN(a,r,l):(ai(r),a=wa(a,r,l),a!==null?a.sibling:null);ai(r);break;case 19:var m=(a.flags&128)!==0;if(u=(l&r.childLanes)!==0,u||(ec(a,r,l,!1),u=(l&r.childLanes)!==0),m){if(u)return aN(a,r,l);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),de(zt,zt.current),u)break;return null;case 22:case 23:return r.lanes=0,Wx(a,r,l);case 24:Ja(r,Bt,a.memoizedState.cache)}return wa(a,r,l)}function iN(a,r,l){if(a!==null)if(a.memoizedProps!==r.pendingProps)Xt=!0;else{if(!zm(a,l)&&(r.flags&128)===0)return Xt=!1,UC(a,r,l);Xt=(a.flags&131072)!==0}else Xt=!1,nt&&(r.flags&1048576)!==0&&Oy(r,dd,r.index);switch(r.lanes=0,r.tag){case 16:e:{a=r.pendingProps;var u=r.elementType,m=u._init;if(u=m(u._payload),r.type=u,typeof u=="function")Jf(u)?(a=Ir(u,a),r.tag=1,r=eN(null,r,u,a,l)):(r.tag=0,r=Lm(null,r,u,a,l));else{if(u!=null){if(m=u.$$typeof,m===S){r.tag=11,r=Qx(null,r,u,a,l);break e}else if(m===L){r.tag=14,r=Kx(null,r,u,a,l);break e}}throw r=be(u)||u,Error(i(306,r,""))}}return r;case 0:return Lm(a,r,r.type,r.pendingProps,l);case 1:return u=r.type,m=Ir(u,r.pendingProps),eN(a,r,u,m,l);case 3:e:{if(pt(r,r.stateNode.containerInfo),a===null)throw Error(i(387));u=r.pendingProps;var v=r.memoizedState;m=v.element,fm(a,r),oc(r,u,null,l);var w=r.memoizedState;if(u=w.cache,Ja(r,Bt,u),u!==v.cache&&om(r,[Bt],l,!0),rc(),u=w.element,v.isDehydrated)if(v={element:u,isDehydrated:!1,cache:w.cache},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){r=tN(a,r,u,l);break e}else if(u!==m){m=is(Error(i(424)),r),Jl(m),r=tN(a,r,u,l);break e}else{switch(a=r.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Ct=_s(a.firstChild),An=r,nt=!0,jr=null,zs=!0,l=Lx(r,null,u,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Zl(),u===m){r=wa(a,r,l);break e}sn(a,r,u,l)}r=r.child}return r;case 26:return Rd(a,r),a===null?(l=cb(r.type,null,r.pendingProps,null))?r.memoizedState=l:nt||(l=r.type,a=r.pendingProps,u=$d(ke.current).createElement(l),u[Ft]=r,u[Dt]=a,rn(u,l,a),St(u),r.stateNode=u):r.memoizedState=cb(r.type,a.memoizedProps,r.pendingProps,a.memoizedState),null;case 27:return Ga(r),a===null&&nt&&(u=r.stateNode=rb(r.type,r.pendingProps,ke.current),An=r,zs=!0,m=Ct,mi(r.type)?(jp=m,Ct=_s(u.firstChild)):Ct=m),sn(a,r,r.pendingProps.children,l),Rd(a,r),a===null&&(r.flags|=4194304),r.child;case 5:return a===null&&nt&&((m=u=Ct)&&(u=fw(u,r.type,r.pendingProps,zs),u!==null?(r.stateNode=u,An=r,Ct=_s(u.firstChild),zs=!1,m=!0):m=!1),m||Tr(r)),Ga(r),m=r.type,v=r.pendingProps,w=a!==null?a.memoizedProps:null,u=v.children,Np(m,v)?u=null:w!==null&&Np(m,w)&&(r.flags|=32),r.memoizedState!==null&&(m=xm(a,r,RC,null,null,l),Sc._currentValue=m),Rd(a,r),sn(a,r,u,l),r.child;case 6:return a===null&&nt&&((a=l=Ct)&&(l=mw(l,r.pendingProps,zs),l!==null?(r.stateNode=l,An=r,Ct=null,a=!0):a=!1),a||Tr(r)),null;case 13:return nN(a,r,l);case 4:return pt(r,r.stateNode.containerInfo),u=r.pendingProps,a===null?r.child=Do(r,null,u,l):sn(a,r,u,l),r.child;case 11:return Qx(a,r,r.type,r.pendingProps,l);case 7:return sn(a,r,r.pendingProps,l),r.child;case 8:return sn(a,r,r.pendingProps.children,l),r.child;case 12:return sn(a,r,r.pendingProps.children,l),r.child;case 10:return u=r.pendingProps,Ja(r,r.type,u.value),sn(a,r,u.children,l),r.child;case 9:return m=r.type._context,u=r.pendingProps.children,Cr(r),m=mn(m),u=u(m),r.flags|=1,sn(a,r,u,l),r.child;case 14:return Kx(a,r,r.type,r.pendingProps,l);case 15:return Xx(a,r,r.type,r.pendingProps,l);case 19:return aN(a,r,l);case 31:return u=r.pendingProps,l=r.mode,u={mode:u.mode,children:u.children},a===null?(l=Md(u,l),l.ref=r.ref,r.child=l,l.return=r,r=l):(l=ba(a.child,u),l.ref=r.ref,r.child=l,l.return=r,r=l),r;case 22:return Wx(a,r,l);case 24:return Cr(r),u=mn(Bt),a===null?(m=um(),m===null&&(m=gt,v=lm(),m.pooledCache=v,v.refCount++,v!==null&&(m.pooledCacheLanes|=l),m=v),r.memoizedState={parent:u,cache:m},hm(r),Ja(r,Bt,m)):((a.lanes&l)!==0&&(fm(a,r),oc(r,null,null,l),rc()),m=a.memoizedState,v=r.memoizedState,m.parent!==u?(m={parent:u,cache:u},r.memoizedState=m,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=m),Ja(r,Bt,u)):(u=v.cache,Ja(r,Bt,u),u!==m.cache&&om(r,[Bt],l,!0))),sn(a,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Sa(a){a.flags|=4}function rN(a,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!mb(r)){if(r=cs.current,r!==null&&((We&4194048)===We?Gs!==null:(We&62914560)!==We&&(We&536870912)===0||r!==Gs))throw ac=dm,By;a.flags|=8192}}function Dd(a,r){r!==null&&(a.flags|=4),a.flags&16384&&(r=a.tag!==22?Rl():536870912,a.lanes|=r,Lo|=r)}function mc(a,r){if(!nt)switch(a.tailMode){case"hidden":r=a.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?a.tail=null:l.sibling=null;break;case"collapsed":l=a.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r||a.tail===null?a.tail=null:a.tail.sibling=null:u.sibling=null}}function Et(a){var r=a.alternate!==null&&a.alternate.child===a.child,l=0,u=0;if(r)for(var m=a.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=a,m=m.sibling;else for(m=a.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=a,m=m.sibling;return a.subtreeFlags|=u,a.childLanes=l,r}function FC(a,r,l){var u=r.pendingProps;switch(sm(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(r),null;case 1:return Et(r),null;case 3:return l=r.stateNode,u=null,a!==null&&(u=a.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),Ta(Bt),Ms(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(a===null||a.child===null)&&(Wl(r)?Sa(r):a===null||a.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Vy())),Et(r),null;case 26:return l=r.memoizedState,a===null?(Sa(r),l!==null?(Et(r),rN(r,l)):(Et(r),r.flags&=-16777217)):l?l!==a.memoizedState?(Sa(r),Et(r),rN(r,l)):(Et(r),r.flags&=-16777217):(a.memoizedProps!==u&&Sa(r),Et(r),r.flags&=-16777217),null;case 27:la(r),l=ke.current;var m=r.type;if(a!==null&&r.stateNode!=null)a.memoizedProps!==u&&Sa(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Et(r),null}a=Ee.current,Wl(r)?Py(r):(a=rb(m,u,l),r.stateNode=a,Sa(r))}return Et(r),null;case 5:if(la(r),l=r.type,a!==null&&r.stateNode!=null)a.memoizedProps!==u&&Sa(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Et(r),null}if(a=Ee.current,Wl(r))Py(r);else{switch(m=$d(ke.current),a){case 1:a=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:a=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":a=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":a=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":a=m.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof u.is=="string"?m.createElement("select",{is:u.is}):m.createElement("select"),u.multiple?a.multiple=!0:u.size&&(a.size=u.size);break;default:a=typeof u.is=="string"?m.createElement(l,{is:u.is}):m.createElement(l)}}a[Ft]=r,a[Dt]=u;e:for(m=r.child;m!==null;){if(m.tag===5||m.tag===6)a.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===r)break e;for(;m.sibling===null;){if(m.return===null||m.return===r)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}r.stateNode=a;e:switch(rn(a,l,u),l){case"button":case"input":case"select":case"textarea":a=!!u.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Sa(r)}}return Et(r),r.flags&=-16777217,null;case 6:if(a&&r.stateNode!=null)a.memoizedProps!==u&&Sa(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(a=ke.current,Wl(r)){if(a=r.stateNode,l=r.memoizedProps,u=null,m=An,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}a[Ft]=r,a=!!(a.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||JN(a.nodeValue,l)),a||Tr(r)}else a=$d(a).createTextNode(u),a[Ft]=r,r.stateNode=a}return Et(r),null;case 13:if(u=r.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(m=Wl(r),u!==null&&u.dehydrated!==null){if(a===null){if(!m)throw Error(i(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[Ft]=r}else Zl(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Et(r),m=!1}else m=Vy(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=m),m=!0;if(!m)return r.flags&256?(Ca(r),r):(Ca(r),null)}if(Ca(r),(r.flags&128)!==0)return r.lanes=l,r;if(l=u!==null,a=a!==null&&a.memoizedState!==null,l){u=r.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool);var v=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),v!==m&&(u.flags|=2048)}return l!==a&&l&&(r.child.flags|=8192),Dd(r,r.updateQueue),Et(r),null;case 4:return Ms(),a===null&&pp(r.stateNode.containerInfo),Et(r),null;case 10:return Ta(r.type),Et(r),null;case 19:if(he(zt),m=r.memoizedState,m===null)return Et(r),null;if(u=(r.flags&128)!==0,v=m.rendering,v===null)if(u)mc(m,!1);else{if(wt!==0||a!==null&&(a.flags&128)!==0)for(a=r.child;a!==null;){if(v=wd(a),v!==null){for(r.flags|=128,mc(m,!1),a=v.updateQueue,r.updateQueue=a,Dd(r,a),r.subtreeFlags=0,a=l,l=r.child;l!==null;)ky(l,a),l=l.sibling;return de(zt,zt.current&1|2),r.child}a=a.sibling}m.tail!==null&&Jn()>Pd&&(r.flags|=128,u=!0,mc(m,!1),r.lanes=4194304)}else{if(!u)if(a=wd(v),a!==null){if(r.flags|=128,u=!0,a=a.updateQueue,r.updateQueue=a,Dd(r,a),mc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!nt)return Et(r),null}else 2*Jn()-m.renderingStartTime>Pd&&l!==536870912&&(r.flags|=128,u=!0,mc(m,!1),r.lanes=4194304);m.isBackwards?(v.sibling=r.child,r.child=v):(a=m.last,a!==null?a.sibling=v:r.child=v,m.last=v)}return m.tail!==null?(r=m.tail,m.rendering=r,m.tail=r.sibling,m.renderingStartTime=Jn(),r.sibling=null,a=zt.current,de(zt,u?a&1|2:a&1),r):(Et(r),null);case 22:case 23:return Ca(r),vm(),u=r.memoizedState!==null,a!==null?a.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(l&536870912)!==0&&(r.flags&128)===0&&(Et(r),r.subtreeFlags&6&&(r.flags|=8192)):Et(r),l=r.updateQueue,l!==null&&Dd(r,l.retryQueue),l=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==l&&(r.flags|=2048),a!==null&&he(wr),null;case 24:return l=null,a!==null&&(l=a.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),Ta(Bt),Et(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function qC(a,r){switch(sm(r),r.tag){case 1:return a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 3:return Ta(Bt),Ms(),a=r.flags,(a&65536)!==0&&(a&128)===0?(r.flags=a&-65537|128,r):null;case 26:case 27:case 5:return la(r),null;case 13:if(Ca(r),a=r.memoizedState,a!==null&&a.dehydrated!==null){if(r.alternate===null)throw Error(i(340));Zl()}return a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 19:return he(zt),null;case 4:return Ms(),null;case 10:return Ta(r.type),null;case 22:case 23:return Ca(r),vm(),a!==null&&he(wr),a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 24:return Ta(Bt),null;case 25:return null;default:return null}}function oN(a,r){switch(sm(r),r.tag){case 3:Ta(Bt),Ms();break;case 26:case 27:case 5:la(r);break;case 4:Ms();break;case 13:Ca(r);break;case 19:he(zt);break;case 10:Ta(r.type);break;case 22:case 23:Ca(r),vm(),a!==null&&he(wr);break;case 24:Ta(Bt)}}function pc(a,r){try{var l=r.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var m=u.next;l=m;do{if((l.tag&a)===a){u=void 0;var v=l.create,w=l.inst;u=v(),w.destroy=u}l=l.next}while(l!==m)}}catch(P){ht(r,r.return,P)}}function ri(a,r,l){try{var u=r.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var v=m.next;u=v;do{if((u.tag&a)===a){var w=u.inst,P=w.destroy;if(P!==void 0){w.destroy=void 0,m=r;var z=l,W=P;try{W()}catch(se){ht(m,z,se)}}}u=u.next}while(u!==v)}}catch(se){ht(r,r.return,se)}}function lN(a){var r=a.updateQueue;if(r!==null){var l=a.stateNode;try{Ky(r,l)}catch(u){ht(a,a.return,u)}}}function cN(a,r,l){l.props=Ir(a.type,a.memoizedProps),l.state=a.memoizedState;try{l.componentWillUnmount()}catch(u){ht(a,r,u)}}function gc(a,r){try{var l=a.ref;if(l!==null){switch(a.tag){case 26:case 27:case 5:var u=a.stateNode;break;case 30:u=a.stateNode;break;default:u=a.stateNode}typeof l=="function"?a.refCleanup=l(u):l.current=u}}catch(m){ht(a,r,m)}}function $s(a,r){var l=a.ref,u=a.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(m){ht(a,r,m)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){ht(a,r,m)}else l.current=null}function uN(a){var r=a.type,l=a.memoizedProps,u=a.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(m){ht(a,a.return,m)}}function Gm(a,r,l){try{var u=a.stateNode;lw(u,a.type,l,r),u[Dt]=r}catch(m){ht(a,a.return,m)}}function dN(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&mi(a.type)||a.tag===4}function $m(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||dN(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&mi(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Ym(a,r,l){var u=a.tag;if(u===5||u===6)a=a.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(a,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(a),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Gd));else if(u!==4&&(u===27&&mi(a.type)&&(l=a.stateNode,r=null),a=a.child,a!==null))for(Ym(a,r,l),a=a.sibling;a!==null;)Ym(a,r,l),a=a.sibling}function kd(a,r,l){var u=a.tag;if(u===5||u===6)a=a.stateNode,r?l.insertBefore(a,r):l.appendChild(a);else if(u!==4&&(u===27&&mi(a.type)&&(l=a.stateNode),a=a.child,a!==null))for(kd(a,r,l),a=a.sibling;a!==null;)kd(a,r,l),a=a.sibling}function hN(a){var r=a.stateNode,l=a.memoizedProps;try{for(var u=a.type,m=r.attributes;m.length;)r.removeAttributeNode(m[0]);rn(r,u,l),r[Ft]=a,r[Dt]=l}catch(v){ht(a,a.return,v)}}var Ia=!1,Rt=!1,Qm=!1,fN=typeof WeakSet=="function"?WeakSet:Set,Wt=null;function HC(a,r){if(a=a.containerInfo,yp=Zd,a=jy(a),$f(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else e:{l=(l=a.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var m=u.anchorOffset,v=u.focusNode;u=u.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var w=0,P=-1,z=-1,W=0,se=0,oe=a,Z=null;t:for(;;){for(var J;oe!==l||m!==0&&oe.nodeType!==3||(P=w+m),oe!==v||u!==0&&oe.nodeType!==3||(z=w+u),oe.nodeType===3&&(w+=oe.nodeValue.length),(J=oe.firstChild)!==null;)Z=oe,oe=J;for(;;){if(oe===a)break t;if(Z===l&&++W===m&&(P=w),Z===v&&++se===u&&(z=w),(J=oe.nextSibling)!==null)break;oe=Z,Z=oe.parentNode}oe=J}l=P===-1||z===-1?null:{start:P,end:z}}else l=null}l=l||{start:0,end:0}}else l=null;for(xp={focusedElem:a,selectionRange:l},Zd=!1,Wt=r;Wt!==null;)if(r=Wt,a=r.child,(r.subtreeFlags&1024)!==0&&a!==null)a.return=r,Wt=a;else for(;Wt!==null;){switch(r=Wt,v=r.alternate,a=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&v!==null){a=void 0,l=r,m=v.memoizedProps,v=v.memoizedState,u=l.stateNode;try{var Re=Ir(l.type,m,l.elementType===l.type);a=u.getSnapshotBeforeUpdate(Re,v),u.__reactInternalSnapshotBeforeUpdate=a}catch(Ae){ht(l,l.return,Ae)}}break;case 3:if((a&1024)!==0){if(a=r.stateNode.containerInfo,l=a.nodeType,l===9)_p(a);else if(l===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":_p(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(i(163))}if(a=r.sibling,a!==null){a.return=r.return,Wt=a;break}Wt=r.return}}function mN(a,r,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:oi(a,l),u&4&&pc(5,l);break;case 1:if(oi(a,l),u&4)if(a=l.stateNode,r===null)try{a.componentDidMount()}catch(w){ht(l,l.return,w)}else{var m=Ir(l.type,r.memoizedProps);r=r.memoizedState;try{a.componentDidUpdate(m,r,a.__reactInternalSnapshotBeforeUpdate)}catch(w){ht(l,l.return,w)}}u&64&&lN(l),u&512&&gc(l,l.return);break;case 3:if(oi(a,l),u&64&&(a=l.updateQueue,a!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Ky(a,r)}catch(w){ht(l,l.return,w)}}break;case 27:r===null&&u&4&&hN(l);case 26:case 5:oi(a,l),r===null&&u&4&&uN(l),u&512&&gc(l,l.return);break;case 12:oi(a,l);break;case 13:oi(a,l),u&4&&vN(a,l),u&64&&(a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(l=WC.bind(null,l),pw(a,l))));break;case 22:if(u=l.memoizedState!==null||Ia,!u){r=r!==null&&r.memoizedState!==null||Rt,m=Ia;var v=Rt;Ia=u,(Rt=r)&&!v?li(a,l,(l.subtreeFlags&8772)!==0):oi(a,l),Ia=m,Rt=v}break;case 30:break;default:oi(a,l)}}function pN(a){var r=a.alternate;r!==null&&(a.alternate=null,pN(r)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(r=a.stateNode,r!==null&&Ka(r)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var _t=null,Mn=!1;function Ra(a,r,l){for(l=l.child;l!==null;)gN(a,r,l),l=l.sibling}function gN(a,r,l){if(at&&typeof at.onCommitFiberUnmount=="function")try{at.onCommitFiberUnmount(At,l)}catch{}switch(l.tag){case 26:Rt||$s(l,r),Ra(a,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Rt||$s(l,r);var u=_t,m=Mn;mi(l.type)&&(_t=l.stateNode,Mn=!1),Ra(a,r,l),Tc(l.stateNode),_t=u,Mn=m;break;case 5:Rt||$s(l,r);case 6:if(u=_t,m=Mn,_t=null,Ra(a,r,l),_t=u,Mn=m,_t!==null)if(Mn)try{(_t.nodeType===9?_t.body:_t.nodeName==="HTML"?_t.ownerDocument.body:_t).removeChild(l.stateNode)}catch(v){ht(l,r,v)}else try{_t.removeChild(l.stateNode)}catch(v){ht(l,r,v)}break;case 18:_t!==null&&(Mn?(a=_t,ab(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,l.stateNode),Dc(a)):ab(_t,l.stateNode));break;case 4:u=_t,m=Mn,_t=l.stateNode.containerInfo,Mn=!0,Ra(a,r,l),_t=u,Mn=m;break;case 0:case 11:case 14:case 15:Rt||ri(2,l,r),Rt||ri(4,l,r),Ra(a,r,l);break;case 1:Rt||($s(l,r),u=l.stateNode,typeof u.componentWillUnmount=="function"&&cN(l,r,u)),Ra(a,r,l);break;case 21:Ra(a,r,l);break;case 22:Rt=(u=Rt)||l.memoizedState!==null,Ra(a,r,l),Rt=u;break;default:Ra(a,r,l)}}function vN(a,r){if(r.memoizedState===null&&(a=r.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Dc(a)}catch(l){ht(r,r.return,l)}}function BC(a){switch(a.tag){case 13:case 19:var r=a.stateNode;return r===null&&(r=a.stateNode=new fN),r;case 22:return a=a.stateNode,r=a._retryCache,r===null&&(r=a._retryCache=new fN),r;default:throw Error(i(435,a.tag))}}function Km(a,r){var l=BC(a);r.forEach(function(u){var m=ZC.bind(null,a,u);l.has(u)||(l.add(u),u.then(m,m))})}function qn(a,r){var l=r.deletions;if(l!==null)for(var u=0;u<l.length;u++){var m=l[u],v=a,w=r,P=w;e:for(;P!==null;){switch(P.tag){case 27:if(mi(P.type)){_t=P.stateNode,Mn=!1;break e}break;case 5:_t=P.stateNode,Mn=!1;break e;case 3:case 4:_t=P.stateNode.containerInfo,Mn=!0;break e}P=P.return}if(_t===null)throw Error(i(160));gN(v,w,m),_t=null,Mn=!1,v=m.alternate,v!==null&&(v.return=null),m.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)yN(r,a),r=r.sibling}var bs=null;function yN(a,r){var l=a.alternate,u=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:qn(r,a),Hn(a),u&4&&(ri(3,a,a.return),pc(3,a),ri(5,a,a.return));break;case 1:qn(r,a),Hn(a),u&512&&(Rt||l===null||$s(l,l.return)),u&64&&Ia&&(a=a.updateQueue,a!==null&&(u=a.callbacks,u!==null&&(l=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var m=bs;if(qn(r,a),Hn(a),u&512&&(Rt||l===null||$s(l,l.return)),u&4){var v=l!==null?l.memoizedState:null;if(u=a.memoizedState,l===null)if(u===null)if(a.stateNode===null){e:{u=a.type,l=a.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":v=m.getElementsByTagName("title")[0],(!v||v[ir]||v[Ft]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=m.createElement(u),m.head.insertBefore(v,m.querySelector("head > title"))),rn(v,u,l),v[Ft]=a,St(v),u=v;break e;case"link":var w=hb("link","href",m).get(u+(l.href||""));if(w){for(var P=0;P<w.length;P++)if(v=w[P],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(P,1);break t}}v=m.createElement(u),rn(v,u,l),m.head.appendChild(v);break;case"meta":if(w=hb("meta","content",m).get(u+(l.content||""))){for(P=0;P<w.length;P++)if(v=w[P],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(P,1);break t}}v=m.createElement(u),rn(v,u,l),m.head.appendChild(v);break;default:throw Error(i(468,u))}v[Ft]=a,St(v),u=v}a.stateNode=u}else fb(m,a.type,a.stateNode);else a.stateNode=db(m,u,a.memoizedProps);else v!==u?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,u===null?fb(m,a.type,a.stateNode):db(m,u,a.memoizedProps)):u===null&&a.stateNode!==null&&Gm(a,a.memoizedProps,l.memoizedProps)}break;case 27:qn(r,a),Hn(a),u&512&&(Rt||l===null||$s(l,l.return)),l!==null&&u&4&&Gm(a,a.memoizedProps,l.memoizedProps);break;case 5:if(qn(r,a),Hn(a),u&512&&(Rt||l===null||$s(l,l.return)),a.flags&32){m=a.stateNode;try{ts(m,"")}catch(J){ht(a,a.return,J)}}u&4&&a.stateNode!=null&&(m=a.memoizedProps,Gm(a,m,l!==null?l.memoizedProps:m)),u&1024&&(Qm=!0);break;case 6:if(qn(r,a),Hn(a),u&4){if(a.stateNode===null)throw Error(i(162));u=a.memoizedProps,l=a.stateNode;try{l.nodeValue=u}catch(J){ht(a,a.return,J)}}break;case 3:if(Kd=null,m=bs,bs=Yd(r.containerInfo),qn(r,a),bs=m,Hn(a),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Dc(r.containerInfo)}catch(J){ht(a,a.return,J)}Qm&&(Qm=!1,xN(a));break;case 4:u=bs,bs=Yd(a.stateNode.containerInfo),qn(r,a),Hn(a),bs=u;break;case 12:qn(r,a),Hn(a);break;case 13:qn(r,a),Hn(a),a.child.flags&8192&&a.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(tp=Jn()),u&4&&(u=a.updateQueue,u!==null&&(a.updateQueue=null,Km(a,u)));break;case 22:m=a.memoizedState!==null;var z=l!==null&&l.memoizedState!==null,W=Ia,se=Rt;if(Ia=W||m,Rt=se||z,qn(r,a),Rt=se,Ia=W,Hn(a),u&8192)e:for(r=a.stateNode,r._visibility=m?r._visibility&-2:r._visibility|1,m&&(l===null||z||Ia||Rt||Rr(a)),l=null,r=a;;){if(r.tag===5||r.tag===26){if(l===null){z=l=r;try{if(v=z.stateNode,m)w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{P=z.stateNode;var oe=z.memoizedProps.style,Z=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;P.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(J){ht(z,z.return,J)}}}else if(r.tag===6){if(l===null){z=r;try{z.stateNode.nodeValue=m?"":z.memoizedProps}catch(J){ht(z,z.return,J)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===a)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=a.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Km(a,l))));break;case 19:qn(r,a),Hn(a),u&4&&(u=a.updateQueue,u!==null&&(a.updateQueue=null,Km(a,u)));break;case 30:break;case 21:break;default:qn(r,a),Hn(a)}}function Hn(a){var r=a.flags;if(r&2){try{for(var l,u=a.return;u!==null;){if(dN(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var m=l.stateNode,v=$m(a);kd(a,v,m);break;case 5:var w=l.stateNode;l.flags&32&&(ts(w,""),l.flags&=-33);var P=$m(a);kd(a,P,w);break;case 3:case 4:var z=l.stateNode.containerInfo,W=$m(a);Ym(a,W,z);break;default:throw Error(i(161))}}catch(se){ht(a,a.return,se)}a.flags&=-3}r&4096&&(a.flags&=-4097)}function xN(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var r=a;xN(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),a=a.sibling}}function oi(a,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)mN(a,r.alternate,r),r=r.sibling}function Rr(a){for(a=a.child;a!==null;){var r=a;switch(r.tag){case 0:case 11:case 14:case 15:ri(4,r,r.return),Rr(r);break;case 1:$s(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&cN(r,r.return,l),Rr(r);break;case 27:Tc(r.stateNode);case 26:case 5:$s(r,r.return),Rr(r);break;case 22:r.memoizedState===null&&Rr(r);break;case 30:Rr(r);break;default:Rr(r)}a=a.sibling}}function li(a,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,m=a,v=r,w=v.flags;switch(v.tag){case 0:case 11:case 15:li(m,v,l),pc(4,v);break;case 1:if(li(m,v,l),u=v,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(W){ht(u,u.return,W)}if(u=v,m=u.updateQueue,m!==null){var P=u.stateNode;try{var z=m.shared.hiddenCallbacks;if(z!==null)for(m.shared.hiddenCallbacks=null,m=0;m<z.length;m++)Qy(z[m],P)}catch(W){ht(u,u.return,W)}}l&&w&64&&lN(v),gc(v,v.return);break;case 27:hN(v);case 26:case 5:li(m,v,l),l&&u===null&&w&4&&uN(v),gc(v,v.return);break;case 12:li(m,v,l);break;case 13:li(m,v,l),l&&w&4&&vN(m,v);break;case 22:v.memoizedState===null&&li(m,v,l),gc(v,v.return);break;case 30:break;default:li(m,v,l)}r=r.sibling}}function Xm(a,r){var l=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),a=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(a=r.memoizedState.cachePool.pool),a!==l&&(a!=null&&a.refCount++,l!=null&&tc(l))}function Wm(a,r){a=null,r.alternate!==null&&(a=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==a&&(r.refCount++,a!=null&&tc(a))}function Ys(a,r,l,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)NN(a,r,l,u),r=r.sibling}function NN(a,r,l,u){var m=r.flags;switch(r.tag){case 0:case 11:case 15:Ys(a,r,l,u),m&2048&&pc(9,r);break;case 1:Ys(a,r,l,u);break;case 3:Ys(a,r,l,u),m&2048&&(a=null,r.alternate!==null&&(a=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==a&&(r.refCount++,a!=null&&tc(a)));break;case 12:if(m&2048){Ys(a,r,l,u),a=r.stateNode;try{var v=r.memoizedProps,w=v.id,P=v.onPostCommit;typeof P=="function"&&P(w,r.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(z){ht(r,r.return,z)}}else Ys(a,r,l,u);break;case 13:Ys(a,r,l,u);break;case 23:break;case 22:v=r.stateNode,w=r.alternate,r.memoizedState!==null?v._visibility&2?Ys(a,r,l,u):vc(a,r):v._visibility&2?Ys(a,r,l,u):(v._visibility|=2,ko(a,r,l,u,(r.subtreeFlags&10256)!==0)),m&2048&&Xm(w,r);break;case 24:Ys(a,r,l,u),m&2048&&Wm(r.alternate,r);break;default:Ys(a,r,l,u)}}function ko(a,r,l,u,m){for(m=m&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var v=a,w=r,P=l,z=u,W=w.flags;switch(w.tag){case 0:case 11:case 15:ko(v,w,P,z,m),pc(8,w);break;case 23:break;case 22:var se=w.stateNode;w.memoizedState!==null?se._visibility&2?ko(v,w,P,z,m):vc(v,w):(se._visibility|=2,ko(v,w,P,z,m)),m&&W&2048&&Xm(w.alternate,w);break;case 24:ko(v,w,P,z,m),m&&W&2048&&Wm(w.alternate,w);break;default:ko(v,w,P,z,m)}r=r.sibling}}function vc(a,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=a,u=r,m=u.flags;switch(u.tag){case 22:vc(l,u),m&2048&&Xm(u.alternate,u);break;case 24:vc(l,u),m&2048&&Wm(u.alternate,u);break;default:vc(l,u)}r=r.sibling}}var yc=8192;function Oo(a){if(a.subtreeFlags&yc)for(a=a.child;a!==null;)bN(a),a=a.sibling}function bN(a){switch(a.tag){case 26:Oo(a),a.flags&yc&&a.memoizedState!==null&&ww(bs,a.memoizedState,a.memoizedProps);break;case 5:Oo(a);break;case 3:case 4:var r=bs;bs=Yd(a.stateNode.containerInfo),Oo(a),bs=r;break;case 22:a.memoizedState===null&&(r=a.alternate,r!==null&&r.memoizedState!==null?(r=yc,yc=16777216,Oo(a),yc=r):Oo(a));break;default:Oo(a)}}function _N(a){var r=a.alternate;if(r!==null&&(a=r.child,a!==null)){r.child=null;do r=a.sibling,a.sibling=null,a=r;while(a!==null)}}function xc(a){var r=a.deletions;if((a.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Wt=u,jN(u,a)}_N(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)EN(a),a=a.sibling}function EN(a){switch(a.tag){case 0:case 11:case 15:xc(a),a.flags&2048&&ri(9,a,a.return);break;case 3:xc(a);break;case 12:xc(a);break;case 22:var r=a.stateNode;a.memoizedState!==null&&r._visibility&2&&(a.return===null||a.return.tag!==13)?(r._visibility&=-3,Od(a)):xc(a);break;default:xc(a)}}function Od(a){var r=a.deletions;if((a.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Wt=u,jN(u,a)}_N(a)}for(a=a.child;a!==null;){switch(r=a,r.tag){case 0:case 11:case 15:ri(8,r,r.return),Od(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,Od(r));break;default:Od(r)}a=a.sibling}}function jN(a,r){for(;Wt!==null;){var l=Wt;switch(l.tag){case 0:case 11:case 15:ri(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:tc(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Wt=u;else e:for(l=a;Wt!==null;){u=Wt;var m=u.sibling,v=u.return;if(pN(u),u===l){Wt=null;break e}if(m!==null){m.return=v,Wt=m;break e}Wt=v}}}var zC={getCacheForType:function(a){var r=mn(Bt),l=r.data.get(a);return l===void 0&&(l=a(),r.data.set(a,l)),l}},GC=typeof WeakMap=="function"?WeakMap:Map,it=0,gt=null,Ge=null,We=0,rt=0,Bn=null,ci=!1,Po=!1,Zm=!1,Ma=0,wt=0,ui=0,Mr=0,Jm=0,us=0,Lo=0,Nc=null,Dn=null,ep=!1,tp=0,Pd=1/0,Ld=null,di=null,an=0,hi=null,Vo=null,Uo=0,np=0,sp=null,TN=null,bc=0,ap=null;function zn(){if((it&2)!==0&&We!==0)return We&-We;if(Y.T!==null){var a=Ao;return a!==0?a:dp()}return Ya()}function AN(){us===0&&(us=(We&536870912)===0||nt?Il():536870912);var a=cs.current;return a!==null&&(a.flags|=32),us}function Gn(a,r,l){(a===gt&&(rt===2||rt===9)||a.cancelPendingCommit!==null)&&(Fo(a,0),fi(a,We,us,!1)),ua(a,l),((it&2)===0||a!==gt)&&(a===gt&&((it&2)===0&&(Mr|=l),wt===4&&fi(a,We,us,!1)),Qs(a))}function CN(a,r,l){if((it&6)!==0)throw Error(i(327));var u=!l&&(r&124)===0&&(r&a.expiredLanes)===0||ar(a,r),m=u?QC(a,r):op(a,r,!0),v=u;do{if(m===0){Po&&!u&&fi(a,r,0,!1);break}else{if(l=a.current.alternate,v&&!$C(l)){m=op(a,r,!1),v=!1;continue}if(m===2){if(v=r,a.errorRecoveryDisabledLanes&v)var w=0;else w=a.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){r=w;e:{var P=a;m=Nc;var z=P.current.memoizedState.isDehydrated;if(z&&(Fo(P,w).flags|=256),w=op(P,w,!1),w!==2){if(Zm&&!z){P.errorRecoveryDisabledLanes|=v,Mr|=v,m=4;break e}v=Dn,Dn=m,v!==null&&(Dn===null?Dn=v:Dn.push.apply(Dn,v))}m=w}if(v=!1,m!==2)continue}}if(m===1){Fo(a,0),fi(a,r,0,!0);break}e:{switch(u=a,v=m,v){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:fi(u,r,us,!ci);break e;case 2:Dn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(m=tp+300-Jn(),10<m)){if(fi(u,r,us,!ci),no(u,0,!0)!==0)break e;u.timeoutHandle=nb(wN.bind(null,u,l,Dn,Ld,ep,r,us,Mr,Lo,ci,v,2,-0,0),m);break e}wN(u,l,Dn,Ld,ep,r,us,Mr,Lo,ci,v,0,-0,0)}}break}while(!0);Qs(a)}function wN(a,r,l,u,m,v,w,P,z,W,se,oe,Z,J){if(a.timeoutHandle=-1,oe=r.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(wc={stylesheets:null,count:0,unsuspend:Cw},bN(r),oe=Sw(),oe!==null)){a.cancelPendingCommit=oe(ON.bind(null,a,r,v,l,u,m,w,P,z,se,1,Z,J)),fi(a,v,w,!W);return}ON(a,r,v,l,u,m,w,P,z)}function $C(a){for(var r=a;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var m=l[u],v=m.getSnapshot;m=m.value;try{if(!Un(v(),m))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===a)break;for(;r.sibling===null;){if(r.return===null||r.return===a)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function fi(a,r,l,u){r&=~Jm,r&=~Mr,a.suspendedLanes|=r,a.pingedLanes&=~r,u&&(a.warmLanes|=r),u=a.expirationTimes;for(var m=r;0<m;){var v=31-fn(m),w=1<<v;u[v]=-1,m&=~w}l!==0&&Ds(a,l,r)}function Vd(){return(it&6)===0?(_c(0),!1):!0}function ip(){if(Ge!==null){if(rt===0)var a=Ge.return;else a=Ge,ja=Ar=null,_m(a),Mo=null,hc=0,a=Ge;for(;a!==null;)oN(a.alternate,a),a=a.return;Ge=null}}function Fo(a,r){var l=a.timeoutHandle;l!==-1&&(a.timeoutHandle=-1,uw(l)),l=a.cancelPendingCommit,l!==null&&(a.cancelPendingCommit=null,l()),ip(),gt=a,Ge=l=ba(a.current,null),We=r,rt=0,Bn=null,ci=!1,Po=ar(a,r),Zm=!1,Lo=us=Jm=Mr=ui=wt=0,Dn=Nc=null,ep=!1,(r&8)!==0&&(r|=r&32);var u=a.entangledLanes;if(u!==0)for(a=a.entanglements,u&=r;0<u;){var m=31-fn(u),v=1<<m;r|=a[m],u&=~v}return Ma=r,rd(),l}function SN(a,r){He=null,Y.H=Td,r===sc||r===pd?(r=$y(),rt=3):r===By?(r=$y(),rt=4):rt=r===Yx?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Bn=r,Ge===null&&(wt=1,Id(a,is(r,a.current)))}function IN(){var a=Y.H;return Y.H=Td,a===null?Td:a}function RN(){var a=Y.A;return Y.A=zC,a}function rp(){wt=4,ci||(We&4194048)!==We&&cs.current!==null||(Po=!0),(ui&134217727)===0&&(Mr&134217727)===0||gt===null||fi(gt,We,us,!1)}function op(a,r,l){var u=it;it|=2;var m=IN(),v=RN();(gt!==a||We!==r)&&(Ld=null,Fo(a,r)),r=!1;var w=wt;e:do try{if(rt!==0&&Ge!==null){var P=Ge,z=Bn;switch(rt){case 8:ip(),w=6;break e;case 3:case 2:case 9:case 6:cs.current===null&&(r=!0);var W=rt;if(rt=0,Bn=null,qo(a,P,z,W),l&&Po){w=0;break e}break;default:W=rt,rt=0,Bn=null,qo(a,P,z,W)}}YC(),w=wt;break}catch(se){SN(a,se)}while(!0);return r&&a.shellSuspendCounter++,ja=Ar=null,it=u,Y.H=m,Y.A=v,Ge===null&&(gt=null,We=0,rd()),w}function YC(){for(;Ge!==null;)MN(Ge)}function QC(a,r){var l=it;it|=2;var u=IN(),m=RN();gt!==a||We!==r?(Ld=null,Pd=Jn()+500,Fo(a,r)):Po=ar(a,r);e:do try{if(rt!==0&&Ge!==null){r=Ge;var v=Bn;t:switch(rt){case 1:rt=0,Bn=null,qo(a,r,v,1);break;case 2:case 9:if(zy(v)){rt=0,Bn=null,DN(r);break}r=function(){rt!==2&&rt!==9||gt!==a||(rt=7),Qs(a)},v.then(r,r);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:zy(v)?(rt=0,Bn=null,DN(r)):(rt=0,Bn=null,qo(a,r,v,7));break;case 5:var w=null;switch(Ge.tag){case 26:w=Ge.memoizedState;case 5:case 27:var P=Ge;if(!w||mb(w)){rt=0,Bn=null;var z=P.sibling;if(z!==null)Ge=z;else{var W=P.return;W!==null?(Ge=W,Ud(W)):Ge=null}break t}}rt=0,Bn=null,qo(a,r,v,5);break;case 6:rt=0,Bn=null,qo(a,r,v,6);break;case 8:ip(),wt=6;break e;default:throw Error(i(462))}}KC();break}catch(se){SN(a,se)}while(!0);return ja=Ar=null,Y.H=u,Y.A=m,it=l,Ge!==null?0:(gt=null,We=0,rd(),wt)}function KC(){for(;Ge!==null&&!Al();)MN(Ge)}function MN(a){var r=iN(a.alternate,a,Ma);a.memoizedProps=a.pendingProps,r===null?Ud(a):Ge=r}function DN(a){var r=a,l=r.alternate;switch(r.tag){case 15:case 0:r=Jx(l,r,r.pendingProps,r.type,void 0,We);break;case 11:r=Jx(l,r,r.pendingProps,r.type.render,r.ref,We);break;case 5:_m(r);default:oN(l,r),r=Ge=ky(r,Ma),r=iN(l,r,Ma)}a.memoizedProps=a.pendingProps,r===null?Ud(a):Ge=r}function qo(a,r,l,u){ja=Ar=null,_m(r),Mo=null,hc=0;var m=r.return;try{if(VC(a,m,r,l,We)){wt=1,Id(a,is(l,a.current)),Ge=null;return}}catch(v){if(m!==null)throw Ge=m,v;wt=1,Id(a,is(l,a.current)),Ge=null;return}r.flags&32768?(nt||u===1?a=!0:Po||(We&536870912)!==0?a=!1:(ci=a=!0,(u===2||u===9||u===3||u===6)&&(u=cs.current,u!==null&&u.tag===13&&(u.flags|=16384))),kN(r,a)):Ud(r)}function Ud(a){var r=a;do{if((r.flags&32768)!==0){kN(r,ci);return}a=r.return;var l=FC(r.alternate,r,Ma);if(l!==null){Ge=l;return}if(r=r.sibling,r!==null){Ge=r;return}Ge=r=a}while(r!==null);wt===0&&(wt=5)}function kN(a,r){do{var l=qC(a.alternate,a);if(l!==null){l.flags&=32767,Ge=l;return}if(l=a.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(a=a.sibling,a!==null)){Ge=a;return}Ge=a=l}while(a!==null);wt=6,Ge=null}function ON(a,r,l,u,m,v,w,P,z){a.cancelPendingCommit=null;do Fd();while(an!==0);if((it&6)!==0)throw Error(i(327));if(r!==null){if(r===a.current)throw Error(i(177));if(v=r.lanes|r.childLanes,v|=Wf,Ml(a,l,v,w,P,z),a===gt&&(Ge=gt=null,We=0),Vo=r,hi=a,Uo=l,np=v,sp=m,TN=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,JC(er,function(){return FN(),null})):(a.callbackNode=null,a.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=Y.T,Y.T=null,m=ie.p,ie.p=2,w=it,it|=4;try{HC(a,r,l)}finally{it=w,ie.p=m,Y.T=u}}an=1,PN(),LN(),VN()}}function PN(){if(an===1){an=0;var a=hi,r=Vo,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=Y.T,Y.T=null;var u=ie.p;ie.p=2;var m=it;it|=4;try{yN(r,a);var v=xp,w=jy(a.containerInfo),P=v.focusedElem,z=v.selectionRange;if(w!==P&&P&&P.ownerDocument&&Ey(P.ownerDocument.documentElement,P)){if(z!==null&&$f(P)){var W=z.start,se=z.end;if(se===void 0&&(se=W),"selectionStart"in P)P.selectionStart=W,P.selectionEnd=Math.min(se,P.value.length);else{var oe=P.ownerDocument||document,Z=oe&&oe.defaultView||window;if(Z.getSelection){var J=Z.getSelection(),Re=P.textContent.length,Ae=Math.min(z.start,Re),ut=z.end===void 0?Ae:Math.min(z.end,Re);!J.extend&&Ae>ut&&(w=ut,ut=Ae,Ae=w);var Q=_y(P,Ae),$=_y(P,ut);if(Q&&$&&(J.rangeCount!==1||J.anchorNode!==Q.node||J.anchorOffset!==Q.offset||J.focusNode!==$.node||J.focusOffset!==$.offset)){var X=oe.createRange();X.setStart(Q.node,Q.offset),J.removeAllRanges(),Ae>ut?(J.addRange(X),J.extend($.node,$.offset)):(X.setEnd($.node,$.offset),J.addRange(X))}}}}for(oe=[],J=P;J=J.parentNode;)J.nodeType===1&&oe.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof P.focus=="function"&&P.focus(),P=0;P<oe.length;P++){var re=oe[P];re.element.scrollLeft=re.left,re.element.scrollTop=re.top}}Zd=!!yp,xp=yp=null}finally{it=m,ie.p=u,Y.T=l}}a.current=r,an=2}}function LN(){if(an===2){an=0;var a=hi,r=Vo,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=Y.T,Y.T=null;var u=ie.p;ie.p=2;var m=it;it|=4;try{mN(a,r.alternate,r)}finally{it=m,ie.p=u,Y.T=l}}an=3}}function VN(){if(an===4||an===3){an=0,Ou();var a=hi,r=Vo,l=Uo,u=TN;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?an=5:(an=0,Vo=hi=null,UN(a,a.pendingLanes));var m=a.pendingLanes;if(m===0&&(di=null),so(l),r=r.stateNode,at&&typeof at.onCommitFiberRoot=="function")try{at.onCommitFiberRoot(At,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=Y.T,m=ie.p,ie.p=2,Y.T=null;try{for(var v=a.onRecoverableError,w=0;w<u.length;w++){var P=u[w];v(P.value,{componentStack:P.stack})}}finally{Y.T=r,ie.p=m}}(Uo&3)!==0&&Fd(),Qs(a),m=a.pendingLanes,(l&4194090)!==0&&(m&42)!==0?a===ap?bc++:(bc=0,ap=a):bc=0,_c(0)}}function UN(a,r){(a.pooledCacheLanes&=r)===0&&(r=a.pooledCache,r!=null&&(a.pooledCache=null,tc(r)))}function Fd(a){return PN(),LN(),VN(),FN()}function FN(){if(an!==5)return!1;var a=hi,r=np;np=0;var l=so(Uo),u=Y.T,m=ie.p;try{ie.p=32>l?32:l,Y.T=null,l=sp,sp=null;var v=hi,w=Uo;if(an=0,Vo=hi=null,Uo=0,(it&6)!==0)throw Error(i(331));var P=it;if(it|=4,EN(v.current),NN(v,v.current,w,l),it=P,_c(0,!1),at&&typeof at.onPostCommitFiberRoot=="function")try{at.onPostCommitFiberRoot(At,v)}catch{}return!0}finally{ie.p=m,Y.T=u,UN(a,r)}}function qN(a,r,l){r=is(l,r),r=Pm(a.stateNode,r,2),a=ni(a,r,2),a!==null&&(ua(a,2),Qs(a))}function ht(a,r,l){if(a.tag===3)qN(a,a,l);else for(;r!==null;){if(r.tag===3){qN(r,a,l);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(di===null||!di.has(u))){a=is(l,a),l=Gx(2),u=ni(r,l,2),u!==null&&($x(l,u,r,a),ua(u,2),Qs(u));break}}r=r.return}}function lp(a,r,l){var u=a.pingCache;if(u===null){u=a.pingCache=new GC;var m=new Set;u.set(r,m)}else m=u.get(r),m===void 0&&(m=new Set,u.set(r,m));m.has(l)||(Zm=!0,m.add(l),a=XC.bind(null,a,r,l),r.then(a,a))}function XC(a,r,l){var u=a.pingCache;u!==null&&u.delete(r),a.pingedLanes|=a.suspendedLanes&l,a.warmLanes&=~l,gt===a&&(We&l)===l&&(wt===4||wt===3&&(We&62914560)===We&&300>Jn()-tp?(it&2)===0&&Fo(a,0):Jm|=l,Lo===We&&(Lo=0)),Qs(a)}function HN(a,r){r===0&&(r=Rl()),a=_o(a,r),a!==null&&(ua(a,r),Qs(a))}function WC(a){var r=a.memoizedState,l=0;r!==null&&(l=r.retryLane),HN(a,l)}function ZC(a,r){var l=0;switch(a.tag){case 13:var u=a.stateNode,m=a.memoizedState;m!==null&&(l=m.retryLane);break;case 19:u=a.stateNode;break;case 22:u=a.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),HN(a,l)}function JC(a,r){return Zi(a,r)}var qd=null,Ho=null,cp=!1,Hd=!1,up=!1,Dr=0;function Qs(a){a!==Ho&&a.next===null&&(Ho===null?qd=Ho=a:Ho=Ho.next=a),Hd=!0,cp||(cp=!0,tw())}function _c(a,r){if(!up&&Hd){up=!0;do for(var l=!1,u=qd;u!==null;){if(a!==0){var m=u.pendingLanes;if(m===0)var v=0;else{var w=u.suspendedLanes,P=u.pingedLanes;v=(1<<31-fn(42|a)+1)-1,v&=m&~(w&~P),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,$N(u,v))}else v=We,v=no(u,u===gt?v:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(v&3)===0||ar(u,v)||(l=!0,$N(u,v));u=u.next}while(l);up=!1}}function ew(){BN()}function BN(){Hd=cp=!1;var a=0;Dr!==0&&(cw()&&(a=Dr),Dr=0);for(var r=Jn(),l=null,u=qd;u!==null;){var m=u.next,v=zN(u,r);v===0?(u.next=null,l===null?qd=m:l.next=m,m===null&&(Ho=l)):(l=u,(a!==0||(v&3)!==0)&&(Hd=!0)),u=m}_c(a)}function zN(a,r){for(var l=a.suspendedLanes,u=a.pingedLanes,m=a.expirationTimes,v=a.pendingLanes&-62914561;0<v;){var w=31-fn(v),P=1<<w,z=m[w];z===-1?((P&l)===0||(P&u)!==0)&&(m[w]=Sl(P,r)):z<=r&&(a.expiredLanes|=P),v&=~P}if(r=gt,l=We,l=no(a,a===r?l:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),u=a.callbackNode,l===0||a===r&&(rt===2||rt===9)||a.cancelPendingCommit!==null)return u!==null&&u!==null&&Ji(u),a.callbackNode=null,a.callbackPriority=0;if((l&3)===0||ar(a,l)){if(r=l&-l,r===a.callbackPriority)return r;switch(u!==null&&Ji(u),so(l)){case 2:case 8:l=eo;break;case 32:l=er;break;case 268435456:l=to;break;default:l=er}return u=GN.bind(null,a),l=Zi(l,u),a.callbackPriority=r,a.callbackNode=l,r}return u!==null&&u!==null&&Ji(u),a.callbackPriority=2,a.callbackNode=null,2}function GN(a,r){if(an!==0&&an!==5)return a.callbackNode=null,a.callbackPriority=0,null;var l=a.callbackNode;if(Fd()&&a.callbackNode!==l)return null;var u=We;return u=no(a,a===gt?u:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),u===0?null:(CN(a,u,r),zN(a,Jn()),a.callbackNode!=null&&a.callbackNode===l?GN.bind(null,a):null)}function $N(a,r){if(Fd())return null;CN(a,r,!0)}function tw(){dw(function(){(it&6)!==0?Zi(Cl,ew):BN()})}function dp(){return Dr===0&&(Dr=Il()),Dr}function YN(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:co(""+a)}function QN(a,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,a.id&&l.setAttribute("form",a.id),r.parentNode.insertBefore(l,r),a=new FormData(a),l.parentNode.removeChild(l),a}function nw(a,r,l,u,m){if(r==="submit"&&l&&l.stateNode===m){var v=YN((m[Dt]||null).action),w=u.submitter;w&&(r=(r=w[Dt]||null)?YN(r.formAction):w.getAttribute("formAction"),r!==null&&(v=r,w=null));var P=new uo("action","action",null,u,m);a.push({event:P,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Dr!==0){var z=w?QN(m,w):new FormData(m);Rm(l,{pending:!0,data:z,method:m.method,action:v},null,z)}}else typeof v=="function"&&(P.preventDefault(),z=w?QN(m,w):new FormData(m),Rm(l,{pending:!0,data:z,method:m.method,action:v},v,z))},currentTarget:m}]})}}for(var hp=0;hp<Xf.length;hp++){var fp=Xf[hp],sw=fp.toLowerCase(),aw=fp[0].toUpperCase()+fp.slice(1);Ns(sw,"on"+aw)}Ns(Cy,"onAnimationEnd"),Ns(wy,"onAnimationIteration"),Ns(Sy,"onAnimationStart"),Ns("dblclick","onDoubleClick"),Ns("focusin","onFocus"),Ns("focusout","onBlur"),Ns(bC,"onTransitionRun"),Ns(_C,"onTransitionStart"),Ns(EC,"onTransitionCancel"),Ns(Iy,"onTransitionEnd"),ha("onMouseEnter",["mouseout","mouseover"]),ha("onMouseLeave",["mouseout","mouseover"]),ha("onPointerEnter",["pointerout","pointerover"]),ha("onPointerLeave",["pointerout","pointerover"]),ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ys("onBeforeInput",["compositionend","keypress","textInput","paste"]),ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ec="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ec));function KN(a,r){r=(r&4)!==0;for(var l=0;l<a.length;l++){var u=a[l],m=u.event;u=u.listeners;e:{var v=void 0;if(r)for(var w=u.length-1;0<=w;w--){var P=u[w],z=P.instance,W=P.currentTarget;if(P=P.listener,z!==v&&m.isPropagationStopped())break e;v=P,m.currentTarget=W;try{v(m)}catch(se){Sd(se)}m.currentTarget=null,v=z}else for(w=0;w<u.length;w++){if(P=u[w],z=P.instance,W=P.currentTarget,P=P.listener,z!==v&&m.isPropagationStopped())break e;v=P,m.currentTarget=W;try{v(m)}catch(se){Sd(se)}m.currentTarget=null,v=z}}}}function $e(a,r){var l=r[kl];l===void 0&&(l=r[kl]=new Set);var u=a+"__bubble";l.has(u)||(XN(r,a,2,!1),l.add(u))}function mp(a,r,l){var u=0;r&&(u|=4),XN(l,a,u,r)}var Bd="_reactListening"+Math.random().toString(36).slice(2);function pp(a){if(!a[Bd]){a[Bd]=!0,Ol.forEach(function(l){l!=="selectionchange"&&(iw.has(l)||mp(l,!1,a),mp(l,!0,a))});var r=a.nodeType===9?a:a.ownerDocument;r===null||r[Bd]||(r[Bd]=!0,mp("selectionchange",!1,r))}}function XN(a,r,l,u){switch(Nb(r)){case 2:var m=Mw;break;case 8:m=Dw;break;default:m=Sp}l=m.bind(null,r,l,a),m=void 0,!ss||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),u?m!==void 0?a.addEventListener(r,l,{capture:!0,passive:m}):a.addEventListener(r,l,!0):m!==void 0?a.addEventListener(r,l,{passive:m}):a.addEventListener(r,l,!1)}function gp(a,r,l,u,m){var v=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var w=u.tag;if(w===3||w===4){var P=u.stateNode.containerInfo;if(P===m)break;if(w===4)for(w=u.return;w!==null;){var z=w.tag;if((z===3||z===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;P!==null;){if(w=da(P),w===null)return;if(z=w.tag,z===5||z===6||z===26||z===27){u=v=w;continue e}P=P.parentNode}}u=u.return}Gu(function(){var W=v,se=ns(l),oe=[];e:{var Z=Ry.get(a);if(Z!==void 0){var J=uo,Re=a;switch(a){case"keypress":if(Us(l)===0)break e;case"keydown":case"keyup":J=vo;break;case"focusin":Re="focus",J=mo;break;case"focusout":Re="blur",J=mo;break;case"beforeblur":case"afterblur":J=mo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=as;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=Hf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=Ju;break;case Cy:case wy:case Sy:J=po;break;case Iy:J=td;break;case"scroll":case"scrollend":J=$u;break;case"wheel":J=yo;break;case"copy":case"cut":case"paste":J=go;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=Yl;break;case"toggle":case"beforetoggle":J=sd}var Ae=(r&4)!==0,ut=!Ae&&(a==="scroll"||a==="scrollend"),Q=Ae?Z!==null?Z+"Capture":null:Z;Ae=[];for(var $=W,X;$!==null;){var re=$;if(X=re.stateNode,re=re.tag,re!==5&&re!==26&&re!==27||X===null||Q===null||(re=hr($,Q),re!=null&&Ae.push(jc($,re,X))),ut)break;$=$.return}0<Ae.length&&(Z=new J(Z,Re,null,l,se),oe.push({event:Z,listeners:Ae}))}}if((r&7)===0){e:{if(Z=a==="mouseover"||a==="pointerover",J=a==="mouseout"||a==="pointerout",Z&&l!==pa&&(Re=l.relatedTarget||l.fromElement)&&(da(Re)||Re[es]))break e;if((J||Z)&&(Z=se.window===se?se:(Z=se.ownerDocument)?Z.defaultView||Z.parentWindow:window,J?(Re=l.relatedTarget||l.toElement,J=W,Re=Re?da(Re):null,Re!==null&&(ut=c(Re),Ae=Re.tag,Re!==ut||Ae!==5&&Ae!==27&&Ae!==6)&&(Re=null)):(J=null,Re=W),J!==Re)){if(Ae=as,re="onMouseLeave",Q="onMouseEnter",$="mouse",(a==="pointerout"||a==="pointerover")&&(Ae=Yl,re="onPointerLeave",Q="onPointerEnter",$="pointer"),ut=J==null?Z:Os(J),X=Re==null?Z:Os(Re),Z=new Ae(re,$+"leave",J,l,se),Z.target=ut,Z.relatedTarget=X,re=null,da(se)===W&&(Ae=new Ae(Q,$+"enter",Re,l,se),Ae.target=X,Ae.relatedTarget=ut,re=Ae),ut=re,J&&Re)t:{for(Ae=J,Q=Re,$=0,X=Ae;X;X=Bo(X))$++;for(X=0,re=Q;re;re=Bo(re))X++;for(;0<$-X;)Ae=Bo(Ae),$--;for(;0<X-$;)Q=Bo(Q),X--;for(;$--;){if(Ae===Q||Q!==null&&Ae===Q.alternate)break t;Ae=Bo(Ae),Q=Bo(Q)}Ae=null}else Ae=null;J!==null&&WN(oe,Z,J,Ae,!1),Re!==null&&ut!==null&&WN(oe,ut,Re,Ae,!0)}}e:{if(Z=W?Os(W):window,J=Z.nodeName&&Z.nodeName.toLowerCase(),J==="select"||J==="input"&&Z.type==="file")var ye=gy;else if(Ht(Z))if(vy)ye=yC;else{ye=gC;var ze=pC}else J=Z.nodeName,!J||J.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?W&&Fl(W.elementType)&&(ye=gy):ye=vC;if(ye&&(ye=ye(a,W))){Na(oe,ye,l,se);break e}ze&&ze(a,Z,W),a==="focusout"&&W&&Z.type==="number"&&W.memoizedProps.value!=null&&Wa(Z,"number",Z.value)}switch(ze=W?Os(W):window,a){case"focusin":(Ht(ze)||ze.contentEditable==="true")&&(xo=ze,Yf=W,Xl=null);break;case"focusout":Xl=Yf=xo=null;break;case"mousedown":Qf=!0;break;case"contextmenu":case"mouseup":case"dragend":Qf=!1,Ty(oe,l,se);break;case"selectionchange":if(NC)break;case"keydown":case"keyup":Ty(oe,l,se)}var Ne;if(Hs)e:{switch(a){case"compositionstart":var Ce="onCompositionStart";break e;case"compositionend":Ce="onCompositionEnd";break e;case"compositionupdate":Ce="onCompositionUpdate";break e}Ce=void 0}else Ke?ne(a,l)&&(Ce="onCompositionEnd"):a==="keydown"&&l.keyCode===229&&(Ce="onCompositionStart");Ce&&(C&&l.locale!=="ko"&&(Ke||Ce!=="onCompositionStart"?Ce==="onCompositionEnd"&&Ke&&(Ne=Hl()):(Vs=se,Za="value"in Vs?Vs.value:Vs.textContent,Ke=!0)),ze=zd(W,Ce),0<ze.length&&(Ce=new Gl(Ce,a,null,l,se),oe.push({event:Ce,listeners:ze}),Ne?Ce.data=Ne:(Ne=fe(l),Ne!==null&&(Ce.data=Ne)))),(Ne=x?qt(a,l):Xe(a,l))&&(Ce=zd(W,"onBeforeInput"),0<Ce.length&&(ze=new Gl("onBeforeInput","beforeinput",null,l,se),oe.push({event:ze,listeners:Ce}),ze.data=Ne)),nw(oe,a,W,l,se)}KN(oe,r)})}function jc(a,r,l){return{instance:a,listener:r,currentTarget:l}}function zd(a,r){for(var l=r+"Capture",u=[];a!==null;){var m=a,v=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||v===null||(m=hr(a,l),m!=null&&u.unshift(jc(a,m,v)),m=hr(a,r),m!=null&&u.push(jc(a,m,v))),a.tag===3)return u;a=a.return}return[]}function Bo(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function WN(a,r,l,u,m){for(var v=r._reactName,w=[];l!==null&&l!==u;){var P=l,z=P.alternate,W=P.stateNode;if(P=P.tag,z!==null&&z===u)break;P!==5&&P!==26&&P!==27||W===null||(z=W,m?(W=hr(l,v),W!=null&&w.unshift(jc(l,W,z))):m||(W=hr(l,v),W!=null&&w.push(jc(l,W,z)))),l=l.return}w.length!==0&&a.push({event:r,listeners:w})}var rw=/\r\n?/g,ow=/\u0000|\uFFFD/g;function ZN(a){return(typeof a=="string"?a:""+a).replace(rw,`
`).replace(ow,"")}function JN(a,r){return r=ZN(r),ZN(a)===r}function Gd(){}function ct(a,r,l,u,m,v){switch(l){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||ts(a,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&ts(a,""+u);break;case"className":Ps(a,"class",u);break;case"tabIndex":Ps(a,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ps(a,l,u);break;case"style":Ul(a,u,v);break;case"data":if(r!=="object"){Ps(a,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||l!=="href")){a.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){a.removeAttribute(l);break}u=co(""+u),a.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){a.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(r!=="input"&&ct(a,r,"name",m.name,m,null),ct(a,r,"formEncType",m.formEncType,m,null),ct(a,r,"formMethod",m.formMethod,m,null),ct(a,r,"formTarget",m.formTarget,m,null)):(ct(a,r,"encType",m.encType,m,null),ct(a,r,"method",m.method,m,null),ct(a,r,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){a.removeAttribute(l);break}u=co(""+u),a.setAttribute(l,u);break;case"onClick":u!=null&&(a.onclick=Gd);break;case"onScroll":u!=null&&$e("scroll",a);break;case"onScrollEnd":u!=null&&$e("scrollend",a);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(i(60));a.innerHTML=l}}break;case"multiple":a.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":a.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){a.removeAttribute("xlink:href");break}l=co(""+u),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(l,""+u):a.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(l,""):a.removeAttribute(l);break;case"capture":case"download":u===!0?a.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(l,u):a.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?a.setAttribute(l,u):a.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?a.removeAttribute(l):a.setAttribute(l,u);break;case"popover":$e("beforetoggle",a),$e("toggle",a),Xa(a,"popover",u);break;case"xlinkActuate":tn(a,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":tn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":tn(a,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":tn(a,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":tn(a,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":tn(a,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":tn(a,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":tn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":tn(a,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Xa(a,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Ff.get(l)||l,Xa(a,l,u))}}function vp(a,r,l,u,m,v){switch(l){case"style":Ul(a,u,v);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(i(60));a.innerHTML=l}}break;case"children":typeof u=="string"?ts(a,u):(typeof u=="number"||typeof u=="bigint")&&ts(a,""+u);break;case"onScroll":u!=null&&$e("scroll",a);break;case"onScrollEnd":u!=null&&$e("scrollend",a);break;case"onClick":u!=null&&(a.onclick=Gd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ao.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),r=l.slice(2,m?l.length-7:void 0),v=a[Dt]||null,v=v!=null?v[l]:null,typeof v=="function"&&a.removeEventListener(r,v,m),typeof u=="function")){typeof v!="function"&&v!==null&&(l in a?a[l]=null:a.hasAttribute(l)&&a.removeAttribute(l)),a.addEventListener(r,u,m);break e}l in a?a[l]=u:u===!0?a.setAttribute(l,""):Xa(a,l,u)}}}function rn(a,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$e("error",a),$e("load",a);var u=!1,m=!1,v;for(v in l)if(l.hasOwnProperty(v)){var w=l[v];if(w!=null)switch(v){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:ct(a,r,v,w,l,null)}}m&&ct(a,r,"srcSet",l.srcSet,l,null),u&&ct(a,r,"src",l.src,l,null);return;case"input":$e("invalid",a);var P=v=w=m=null,z=null,W=null;for(u in l)if(l.hasOwnProperty(u)){var se=l[u];if(se!=null)switch(u){case"name":m=se;break;case"type":w=se;break;case"checked":z=se;break;case"defaultChecked":W=se;break;case"value":v=se;break;case"defaultValue":P=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,r));break;default:ct(a,r,u,se,l,null)}}cr(a,v,P,z,W,w,m,!1),lo(a);return;case"select":$e("invalid",a),u=w=v=null;for(m in l)if(l.hasOwnProperty(m)&&(P=l[m],P!=null))switch(m){case"value":v=P;break;case"defaultValue":w=P;break;case"multiple":u=P;default:ct(a,r,m,P,l,null)}r=v,l=w,a.multiple=!!u,r!=null?ma(a,!!u,r,!1):l!=null&&ma(a,!!u,l,!0);return;case"textarea":$e("invalid",a),v=m=u=null;for(w in l)if(l.hasOwnProperty(w)&&(P=l[w],P!=null))switch(w){case"value":u=P;break;case"defaultValue":m=P;break;case"children":v=P;break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(i(91));break;default:ct(a,r,w,P,l,null)}ur(a,u,m,v),lo(a);return;case"option":for(z in l)if(l.hasOwnProperty(z)&&(u=l[z],u!=null))switch(z){case"selected":a.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:ct(a,r,z,u,l,null)}return;case"dialog":$e("beforetoggle",a),$e("toggle",a),$e("cancel",a),$e("close",a);break;case"iframe":case"object":$e("load",a);break;case"video":case"audio":for(u=0;u<Ec.length;u++)$e(Ec[u],a);break;case"image":$e("error",a),$e("load",a);break;case"details":$e("toggle",a);break;case"embed":case"source":case"link":$e("error",a),$e("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in l)if(l.hasOwnProperty(W)&&(u=l[W],u!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:ct(a,r,W,u,l,null)}return;default:if(Fl(r)){for(se in l)l.hasOwnProperty(se)&&(u=l[se],u!==void 0&&vp(a,r,se,u,l,void 0));return}}for(P in l)l.hasOwnProperty(P)&&(u=l[P],u!=null&&ct(a,r,P,u,l,null))}function lw(a,r,l,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,v=null,w=null,P=null,z=null,W=null,se=null;for(J in l){var oe=l[J];if(l.hasOwnProperty(J)&&oe!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":z=oe;default:u.hasOwnProperty(J)||ct(a,r,J,null,u,oe)}}for(var Z in u){var J=u[Z];if(oe=l[Z],u.hasOwnProperty(Z)&&(J!=null||oe!=null))switch(Z){case"type":v=J;break;case"name":m=J;break;case"checked":W=J;break;case"defaultChecked":se=J;break;case"value":w=J;break;case"defaultValue":P=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,r));break;default:J!==oe&&ct(a,r,Z,J,u,oe)}}Vn(a,w,P,z,W,se,v,m);return;case"select":J=w=P=Z=null;for(v in l)if(z=l[v],l.hasOwnProperty(v)&&z!=null)switch(v){case"value":break;case"multiple":J=z;default:u.hasOwnProperty(v)||ct(a,r,v,null,u,z)}for(m in u)if(v=u[m],z=l[m],u.hasOwnProperty(m)&&(v!=null||z!=null))switch(m){case"value":Z=v;break;case"defaultValue":P=v;break;case"multiple":w=v;default:v!==z&&ct(a,r,m,v,u,z)}r=P,l=w,u=J,Z!=null?ma(a,!!l,Z,!1):!!u!=!!l&&(r!=null?ma(a,!!l,r,!0):ma(a,!!l,l?[]:"",!1));return;case"textarea":J=Z=null;for(P in l)if(m=l[P],l.hasOwnProperty(P)&&m!=null&&!u.hasOwnProperty(P))switch(P){case"value":break;case"children":break;default:ct(a,r,P,null,u,m)}for(w in u)if(m=u[w],v=l[w],u.hasOwnProperty(w)&&(m!=null||v!=null))switch(w){case"value":Z=m;break;case"defaultValue":J=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==v&&ct(a,r,w,m,u,v)}ot(a,Z,J);return;case"option":for(var Re in l)if(Z=l[Re],l.hasOwnProperty(Re)&&Z!=null&&!u.hasOwnProperty(Re))switch(Re){case"selected":a.selected=!1;break;default:ct(a,r,Re,null,u,Z)}for(z in u)if(Z=u[z],J=l[z],u.hasOwnProperty(z)&&Z!==J&&(Z!=null||J!=null))switch(z){case"selected":a.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:ct(a,r,z,Z,u,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in l)Z=l[Ae],l.hasOwnProperty(Ae)&&Z!=null&&!u.hasOwnProperty(Ae)&&ct(a,r,Ae,null,u,Z);for(W in u)if(Z=u[W],J=l[W],u.hasOwnProperty(W)&&Z!==J&&(Z!=null||J!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,r));break;default:ct(a,r,W,Z,u,J)}return;default:if(Fl(r)){for(var ut in l)Z=l[ut],l.hasOwnProperty(ut)&&Z!==void 0&&!u.hasOwnProperty(ut)&&vp(a,r,ut,void 0,u,Z);for(se in u)Z=u[se],J=l[se],!u.hasOwnProperty(se)||Z===J||Z===void 0&&J===void 0||vp(a,r,se,Z,u,J);return}}for(var Q in l)Z=l[Q],l.hasOwnProperty(Q)&&Z!=null&&!u.hasOwnProperty(Q)&&ct(a,r,Q,null,u,Z);for(oe in u)Z=u[oe],J=l[oe],!u.hasOwnProperty(oe)||Z===J||Z==null&&J==null||ct(a,r,oe,Z,u,J)}var yp=null,xp=null;function $d(a){return a.nodeType===9?a:a.ownerDocument}function eb(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function tb(a,r){if(a===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&r==="foreignObject"?0:a}function Np(a,r){return a==="textarea"||a==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var bp=null;function cw(){var a=window.event;return a&&a.type==="popstate"?a===bp?!1:(bp=a,!0):(bp=null,!1)}var nb=typeof setTimeout=="function"?setTimeout:void 0,uw=typeof clearTimeout=="function"?clearTimeout:void 0,sb=typeof Promise=="function"?Promise:void 0,dw=typeof queueMicrotask=="function"?queueMicrotask:typeof sb<"u"?function(a){return sb.resolve(null).then(a).catch(hw)}:nb;function hw(a){setTimeout(function(){throw a})}function mi(a){return a==="head"}function ab(a,r){var l=r,u=0,m=0;do{var v=l.nextSibling;if(a.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<u&&8>u){l=u;var w=a.ownerDocument;if(l&1&&Tc(w.documentElement),l&2&&Tc(w.body),l&4)for(l=w.head,Tc(l),w=l.firstChild;w;){var P=w.nextSibling,z=w.nodeName;w[ir]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&w.rel.toLowerCase()==="stylesheet"||l.removeChild(w),w=P}}if(m===0){a.removeChild(v),Dc(r);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:u=l.charCodeAt(0)-48;else u=0;l=v}while(l);Dc(r)}function _p(a){var r=a.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":_p(l),Ka(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}a.removeChild(l)}}function fw(a,r,l,u){for(;a.nodeType===1;){var m=l;if(a.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(u){if(!a[ir])switch(r){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(v=a.getAttribute("rel"),v==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(v!==m.rel||a.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||a.getAttribute("title")!==(m.title==null?null:m.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(v=a.getAttribute("src"),(v!==(m.src==null?null:m.src)||a.getAttribute("type")!==(m.type==null?null:m.type)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&v&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(r==="input"&&a.type==="hidden"){var v=m.name==null?null:""+m.name;if(m.type==="hidden"&&a.getAttribute("name")===v)return a}else return a;if(a=_s(a.nextSibling),a===null)break}return null}function mw(a,r,l){if(r==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=_s(a.nextSibling),a===null))return null;return a}function Ep(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function pw(a,r){var l=a.ownerDocument;if(a.data!=="$?"||l.readyState==="complete")r();else{var u=function(){r(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),a._reactRetry=u}}function _s(a){for(;a!=null;a=a.nextSibling){var r=a.nodeType;if(r===1||r===3)break;if(r===8){if(r=a.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return a}var jp=null;function ib(a){a=a.previousSibling;for(var r=0;a;){if(a.nodeType===8){var l=a.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return a;r--}else l==="/$"&&r++}a=a.previousSibling}return null}function rb(a,r,l){switch(r=$d(l),a){case"html":if(a=r.documentElement,!a)throw Error(i(452));return a;case"head":if(a=r.head,!a)throw Error(i(453));return a;case"body":if(a=r.body,!a)throw Error(i(454));return a;default:throw Error(i(451))}}function Tc(a){for(var r=a.attributes;r.length;)a.removeAttributeNode(r[0]);Ka(a)}var ds=new Map,ob=new Set;function Yd(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Da=ie.d;ie.d={f:gw,r:vw,D:yw,C:xw,L:Nw,m:bw,X:Ew,S:_w,M:jw};function gw(){var a=Da.f(),r=Vd();return a||r}function vw(a){var r=ks(a);r!==null&&r.tag===5&&r.type==="form"?Cx(r):Da.r(a)}var zo=typeof document>"u"?null:document;function lb(a,r,l){var u=zo;if(u&&typeof r=="string"&&r){var m=kt(r);m='link[rel="'+a+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),ob.has(m)||(ob.add(m),a={rel:a,crossOrigin:l,href:r},u.querySelector(m)===null&&(r=u.createElement("link"),rn(r,"link",a),St(r),u.head.appendChild(r)))}}function yw(a){Da.D(a),lb("dns-prefetch",a,null)}function xw(a,r){Da.C(a,r),lb("preconnect",a,r)}function Nw(a,r,l){Da.L(a,r,l);var u=zo;if(u&&a&&r){var m='link[rel="preload"][as="'+kt(r)+'"]';r==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+kt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+kt(l.imageSizes)+'"]')):m+='[href="'+kt(a)+'"]';var v=m;switch(r){case"style":v=Go(a);break;case"script":v=$o(a)}ds.has(v)||(a=y({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:a,as:r},l),ds.set(v,a),u.querySelector(m)!==null||r==="style"&&u.querySelector(Ac(v))||r==="script"&&u.querySelector(Cc(v))||(r=u.createElement("link"),rn(r,"link",a),St(r),u.head.appendChild(r)))}}function bw(a,r){Da.m(a,r);var l=zo;if(l&&a){var u=r&&typeof r.as=="string"?r.as:"script",m='link[rel="modulepreload"][as="'+kt(u)+'"][href="'+kt(a)+'"]',v=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=$o(a)}if(!ds.has(v)&&(a=y({rel:"modulepreload",href:a},r),ds.set(v,a),l.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Cc(v)))return}u=l.createElement("link"),rn(u,"link",a),St(u),l.head.appendChild(u)}}}function _w(a,r,l){Da.S(a,r,l);var u=zo;if(u&&a){var m=En(u).hoistableStyles,v=Go(a);r=r||"default";var w=m.get(v);if(!w){var P={loading:0,preload:null};if(w=u.querySelector(Ac(v)))P.loading=5;else{a=y({rel:"stylesheet",href:a,"data-precedence":r},l),(l=ds.get(v))&&Tp(a,l);var z=w=u.createElement("link");St(z),rn(z,"link",a),z._p=new Promise(function(W,se){z.onload=W,z.onerror=se}),z.addEventListener("load",function(){P.loading|=1}),z.addEventListener("error",function(){P.loading|=2}),P.loading|=4,Qd(w,r,u)}w={type:"stylesheet",instance:w,count:1,state:P},m.set(v,w)}}}function Ew(a,r){Da.X(a,r);var l=zo;if(l&&a){var u=En(l).hoistableScripts,m=$o(a),v=u.get(m);v||(v=l.querySelector(Cc(m)),v||(a=y({src:a,async:!0},r),(r=ds.get(m))&&Ap(a,r),v=l.createElement("script"),St(v),rn(v,"link",a),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(m,v))}}function jw(a,r){Da.M(a,r);var l=zo;if(l&&a){var u=En(l).hoistableScripts,m=$o(a),v=u.get(m);v||(v=l.querySelector(Cc(m)),v||(a=y({src:a,async:!0,type:"module"},r),(r=ds.get(m))&&Ap(a,r),v=l.createElement("script"),St(v),rn(v,"link",a),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(m,v))}}function cb(a,r,l,u){var m=(m=ke.current)?Yd(m):null;if(!m)throw Error(i(446));switch(a){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=Go(l.href),l=En(m).hoistableStyles,u=l.get(r),u||(u={type:"style",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){a=Go(l.href);var v=En(m).hoistableStyles,w=v.get(a);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(a,w),(v=m.querySelector(Ac(a)))&&!v._p&&(w.instance=v,w.state.loading=5),ds.has(a)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ds.set(a,l),v||Tw(m,a,l,w.state))),r&&u===null)throw Error(i(528,""));return w}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=$o(l),l=En(m).hoistableScripts,u=l.get(r),u||(u={type:"script",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,a))}}function Go(a){return'href="'+kt(a)+'"'}function Ac(a){return'link[rel="stylesheet"]['+a+"]"}function ub(a){return y({},a,{"data-precedence":a.precedence,precedence:null})}function Tw(a,r,l,u){a.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=a.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),rn(r,"link",l),St(r),a.head.appendChild(r))}function $o(a){return'[src="'+kt(a)+'"]'}function Cc(a){return"script[async]"+a}function db(a,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var u=a.querySelector('style[data-href~="'+kt(l.href)+'"]');if(u)return r.instance=u,St(u),u;var m=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(a.ownerDocument||a).createElement("style"),St(u),rn(u,"style",m),Qd(u,l.precedence,a),r.instance=u;case"stylesheet":m=Go(l.href);var v=a.querySelector(Ac(m));if(v)return r.state.loading|=4,r.instance=v,St(v),v;u=ub(l),(m=ds.get(m))&&Tp(u,m),v=(a.ownerDocument||a).createElement("link"),St(v);var w=v;return w._p=new Promise(function(P,z){w.onload=P,w.onerror=z}),rn(v,"link",u),r.state.loading|=4,Qd(v,l.precedence,a),r.instance=v;case"script":return v=$o(l.src),(m=a.querySelector(Cc(v)))?(r.instance=m,St(m),m):(u=l,(m=ds.get(v))&&(u=y({},l),Ap(u,m)),a=a.ownerDocument||a,m=a.createElement("script"),St(m),rn(m,"link",u),a.head.appendChild(m),r.instance=m);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Qd(u,l.precedence,a));return r.instance}function Qd(a,r,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,v=m,w=0;w<u.length;w++){var P=u[w];if(P.dataset.precedence===r)v=P;else if(v!==m)break}v?v.parentNode.insertBefore(a,v.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(a,r.firstChild))}function Tp(a,r){a.crossOrigin==null&&(a.crossOrigin=r.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=r.referrerPolicy),a.title==null&&(a.title=r.title)}function Ap(a,r){a.crossOrigin==null&&(a.crossOrigin=r.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=r.referrerPolicy),a.integrity==null&&(a.integrity=r.integrity)}var Kd=null;function hb(a,r,l){if(Kd===null){var u=new Map,m=Kd=new Map;m.set(l,u)}else m=Kd,u=m.get(l),u||(u=new Map,m.set(l,u));if(u.has(a))return u;for(u.set(a,null),l=l.getElementsByTagName(a),m=0;m<l.length;m++){var v=l[m];if(!(v[ir]||v[Ft]||a==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var w=v.getAttribute(r)||"";w=a+w;var P=u.get(w);P?P.push(v):u.set(w,[v])}}return u}function fb(a,r,l){a=a.ownerDocument||a,a.head.insertBefore(l,r==="title"?a.querySelector("head > title"):null)}function Aw(a,r,l){if(l===1||r.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return a=r.disabled,typeof r.precedence=="string"&&a==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function mb(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var wc=null;function Cw(){}function ww(a,r,l){if(wc===null)throw Error(i(475));var u=wc;if(r.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var m=Go(l.href),v=a.querySelector(Ac(m));if(v){a=v._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(u.count++,u=Xd.bind(u),a.then(u,u)),r.state.loading|=4,r.instance=v,St(v);return}v=a.ownerDocument||a,l=ub(l),(m=ds.get(m))&&Tp(l,m),v=v.createElement("link"),St(v);var w=v;w._p=new Promise(function(P,z){w.onload=P,w.onerror=z}),rn(v,"link",l),r.instance=v}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(r,a),(a=r.state.preload)&&(r.state.loading&3)===0&&(u.count++,r=Xd.bind(u),a.addEventListener("load",r),a.addEventListener("error",r))}}function Sw(){if(wc===null)throw Error(i(475));var a=wc;return a.stylesheets&&a.count===0&&Cp(a,a.stylesheets),0<a.count?function(r){var l=setTimeout(function(){if(a.stylesheets&&Cp(a,a.stylesheets),a.unsuspend){var u=a.unsuspend;a.unsuspend=null,u()}},6e4);return a.unsuspend=r,function(){a.unsuspend=null,clearTimeout(l)}}:null}function Xd(){if(this.count--,this.count===0){if(this.stylesheets)Cp(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Wd=null;function Cp(a,r){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Wd=new Map,r.forEach(Iw,a),Wd=null,Xd.call(a))}function Iw(a,r){if(!(r.state.loading&4)){var l=Wd.get(a);if(l)var u=l.get(null);else{l=new Map,Wd.set(a,l);for(var m=a.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<m.length;v++){var w=m[v];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),u=w)}u&&l.set(null,u)}m=r.instance,w=m.getAttribute("data-precedence"),v=l.get(w)||u,v===u&&l.set(null,m),l.set(w,m),this.count++,u=Xd.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),v?v.parentNode.insertBefore(m,v.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(m,a.firstChild)),r.state.loading|=4}}var Sc={$$typeof:j,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function Rw(a,r,l,u,m,v,w,P){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ca(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ca(0),this.hiddenUpdates=ca(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=v,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function pb(a,r,l,u,m,v,w,P,z,W,se,oe){return a=new Rw(a,r,l,w,P,z,W,oe),r=1,v===!0&&(r|=24),v=Fn(3,null,null,r),a.current=v,v.stateNode=a,r=lm(),r.refCount++,a.pooledCache=r,r.refCount++,v.memoizedState={element:u,isDehydrated:l,cache:r},hm(v),a}function gb(a){return a?(a=Eo,a):Eo}function vb(a,r,l,u,m,v){m=gb(m),u.context===null?u.context=m:u.pendingContext=m,u=ti(r),u.payload={element:l},v=v===void 0?null:v,v!==null&&(u.callback=v),l=ni(a,u,r),l!==null&&(Gn(l,a,r),ic(l,a,r))}function yb(a,r){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var l=a.retryLane;a.retryLane=l!==0&&l<r?l:r}}function wp(a,r){yb(a,r),(a=a.alternate)&&yb(a,r)}function xb(a){if(a.tag===13){var r=_o(a,67108864);r!==null&&Gn(r,a,67108864),wp(a,67108864)}}var Zd=!0;function Mw(a,r,l,u){var m=Y.T;Y.T=null;var v=ie.p;try{ie.p=2,Sp(a,r,l,u)}finally{ie.p=v,Y.T=m}}function Dw(a,r,l,u){var m=Y.T;Y.T=null;var v=ie.p;try{ie.p=8,Sp(a,r,l,u)}finally{ie.p=v,Y.T=m}}function Sp(a,r,l,u){if(Zd){var m=Ip(u);if(m===null)gp(a,r,u,Jd,l),bb(a,u);else if(Ow(m,a,r,l,u))u.stopPropagation();else if(bb(a,u),r&4&&-1<kw.indexOf(a)){for(;m!==null;){var v=ks(m);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var w=vs(v.pendingLanes);if(w!==0){var P=v;for(P.pendingLanes|=2,P.entangledLanes|=2;w;){var z=1<<31-fn(w);P.entanglements[1]|=z,w&=~z}Qs(v),(it&6)===0&&(Pd=Jn()+500,_c(0))}}break;case 13:P=_o(v,2),P!==null&&Gn(P,v,2),Vd(),wp(v,2)}if(v=Ip(u),v===null&&gp(a,r,u,Jd,l),v===m)break;m=v}m!==null&&u.stopPropagation()}else gp(a,r,u,null,l)}}function Ip(a){return a=ns(a),Rp(a)}var Jd=null;function Rp(a){if(Jd=null,a=da(a),a!==null){var r=c(a);if(r===null)a=null;else{var l=r.tag;if(l===13){if(a=d(r),a!==null)return a;a=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;a=null}else r!==a&&(a=null)}}return Jd=a,null}function Nb(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(kf()){case Cl:return 2;case eo:return 8;case er:case Of:return 32;case to:return 268435456;default:return 32}default:return 32}}var Mp=!1,pi=null,gi=null,vi=null,Ic=new Map,Rc=new Map,yi=[],kw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bb(a,r){switch(a){case"focusin":case"focusout":pi=null;break;case"dragenter":case"dragleave":gi=null;break;case"mouseover":case"mouseout":vi=null;break;case"pointerover":case"pointerout":Ic.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rc.delete(r.pointerId)}}function Mc(a,r,l,u,m,v){return a===null||a.nativeEvent!==v?(a={blockedOn:r,domEventName:l,eventSystemFlags:u,nativeEvent:v,targetContainers:[m]},r!==null&&(r=ks(r),r!==null&&xb(r)),a):(a.eventSystemFlags|=u,r=a.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),a)}function Ow(a,r,l,u,m){switch(r){case"focusin":return pi=Mc(pi,a,r,l,u,m),!0;case"dragenter":return gi=Mc(gi,a,r,l,u,m),!0;case"mouseover":return vi=Mc(vi,a,r,l,u,m),!0;case"pointerover":var v=m.pointerId;return Ic.set(v,Mc(Ic.get(v)||null,a,r,l,u,m)),!0;case"gotpointercapture":return v=m.pointerId,Rc.set(v,Mc(Rc.get(v)||null,a,r,l,u,m)),!0}return!1}function _b(a){var r=da(a.target);if(r!==null){var l=c(r);if(l!==null){if(r=l.tag,r===13){if(r=d(l),r!==null){a.blockedOn=r,Vu(a.priority,function(){if(l.tag===13){var u=zn();u=$a(u);var m=_o(l,u);m!==null&&Gn(m,l,u),wp(l,u)}});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){a.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}a.blockedOn=null}function eh(a){if(a.blockedOn!==null)return!1;for(var r=a.targetContainers;0<r.length;){var l=Ip(a.nativeEvent);if(l===null){l=a.nativeEvent;var u=new l.constructor(l.type,l);pa=u,l.target.dispatchEvent(u),pa=null}else return r=ks(l),r!==null&&xb(r),a.blockedOn=l,!1;r.shift()}return!0}function Eb(a,r,l){eh(a)&&l.delete(r)}function Pw(){Mp=!1,pi!==null&&eh(pi)&&(pi=null),gi!==null&&eh(gi)&&(gi=null),vi!==null&&eh(vi)&&(vi=null),Ic.forEach(Eb),Rc.forEach(Eb)}function th(a,r){a.blockedOn===r&&(a.blockedOn=null,Mp||(Mp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Pw)))}var nh=null;function jb(a){nh!==a&&(nh=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){nh===a&&(nh=null);for(var r=0;r<a.length;r+=3){var l=a[r],u=a[r+1],m=a[r+2];if(typeof u!="function"){if(Rp(u||l)===null)continue;break}var v=ks(l);v!==null&&(a.splice(r,3),r-=3,Rm(v,{pending:!0,data:m,method:l.method,action:u},u,m))}}))}function Dc(a){function r(z){return th(z,a)}pi!==null&&th(pi,a),gi!==null&&th(gi,a),vi!==null&&th(vi,a),Ic.forEach(r),Rc.forEach(r);for(var l=0;l<yi.length;l++){var u=yi[l];u.blockedOn===a&&(u.blockedOn=null)}for(;0<yi.length&&(l=yi[0],l.blockedOn===null);)_b(l),l.blockedOn===null&&yi.shift();if(l=(a.ownerDocument||a).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var m=l[u],v=l[u+1],w=m[Dt]||null;if(typeof v=="function")w||jb(l);else if(w){var P=null;if(v&&v.hasAttribute("formAction")){if(m=v,w=v[Dt]||null)P=w.formAction;else if(Rp(m)!==null)continue}else P=w.action;typeof P=="function"?l[u+1]=P:(l.splice(u,3),u-=3),jb(l)}}}function Dp(a){this._internalRoot=a}sh.prototype.render=Dp.prototype.render=function(a){var r=this._internalRoot;if(r===null)throw Error(i(409));var l=r.current,u=zn();vb(l,u,a,r,null,null)},sh.prototype.unmount=Dp.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var r=a.containerInfo;vb(a.current,2,null,a,null,null),Vd(),r[es]=null}};function sh(a){this._internalRoot=a}sh.prototype.unstable_scheduleHydration=function(a){if(a){var r=Ya();a={blockedOn:null,target:a,priority:r};for(var l=0;l<yi.length&&r!==0&&r<yi[l].priority;l++);yi.splice(l,0,a),l===0&&_b(a)}};var Tb=e.version;if(Tb!=="19.1.0")throw Error(i(527,Tb,"19.1.0"));ie.findDOMNode=function(a){var r=a._reactInternals;if(r===void 0)throw typeof a.render=="function"?Error(i(188)):(a=Object.keys(a).join(","),Error(i(268,a)));return a=p(r),a=a!==null?g(a):null,a=a===null?null:a.stateNode,a};var Lw={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ah.isDisabled&&ah.supportsFiber)try{At=ah.inject(Lw),at=ah}catch{}}return Oc.createRoot=function(a,r){if(!o(a))throw Error(i(299));var l=!1,u="",m=qx,v=Hx,w=Bx,P=null;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(w=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(P=r.unstable_transitionCallbacks)),r=pb(a,1,!1,null,null,l,u,m,v,w,P,null),a[es]=r.current,pp(a),new Dp(r)},Oc.hydrateRoot=function(a,r,l){if(!o(a))throw Error(i(299));var u=!1,m="",v=qx,w=Hx,P=Bx,z=null,W=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(P=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(z=l.unstable_transitionCallbacks),l.formState!==void 0&&(W=l.formState)),r=pb(a,1,!0,r,l??null,u,m,v,w,P,z,W),r.context=gb(null),l=r.current,u=zn(),u=$a(u),m=ti(u),m.callback=null,ni(l,m,u),l=u,r.current.lanes=l,ua(r,l),Qs(r),a[es]=r.current,pp(a),new sh(r)},Oc.version="19.1.0",Oc}var Ob;function Yw(){if(Ob)return Pp.exports;Ob=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Pp.exports=$w(),Pp.exports}var Qw=Yw();const Kw=()=>{};var Pb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sj=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},Xw=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[i++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],f=n[t++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(p>>10)),e[i++]=String.fromCharCode(56320+(p&1023))}else{const c=n[t++],d=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},aj={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,f=d?n[o+1]:0,p=o+2<n.length,g=p?n[o+2]:0,y=c>>2,N=(c&3)<<4|f>>4;let E=(f&15)<<2|g>>6,A=g&63;p||(A=64,d||(E=64)),i.push(t[y],t[N],t[E],t[A])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(sj(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Xw(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],f=o<n.length?t[n.charAt(o)]:0;++o;const g=o<n.length?t[n.charAt(o)]:64;++o;const N=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||f==null||g==null||N==null)throw new Ww;const E=c<<2|f>>4;if(i.push(E),g!==64){const A=f<<4&240|g>>2;if(i.push(A),N!==64){const T=g<<6&192|N;i.push(T)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Ww extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Zw=function(n){const e=sj(n);return aj.encodeByteArray(e,!0)},Ah=function(n){return Zw(n).replace(/\./g,"")},ij=function(n){try{return aj.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jw(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS=()=>Jw().__FIREBASE_DEFAULTS__,tS=()=>{if(typeof process>"u"||typeof Pb>"u")return;const n=Pb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},nS=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&ij(n[1]);return e&&JSON.parse(e)},Jh=()=>{try{return Kw()||eS()||tS()||nS()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},rj=n=>{var e,t;return(t=(e=Jh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},oj=n=>{const e=rj(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},lj=()=>{var n;return(n=Jh())===null||n===void 0?void 0:n.config},cj=n=>{var e;return(e=Jh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Fg(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uj(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Ah(JSON.stringify(t)),Ah(JSON.stringify(d)),""].join(".")}const Hc={};function aS(){const n={prod:[],emulator:[]};for(const e of Object.keys(Hc))Hc[e]?n.emulator.push(e):n.prod.push(e);return n}function iS(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Lb=!1;function qg(n,e){if(typeof window>"u"||typeof document>"u"||!Qr(window.location.host)||Hc[n]===e||Hc[n]||Lb)return;Hc[n]=e;function t(E){return`__firebase__banner__${E}`}const i="__firebase__banner",c=aS().prod.length>0;function d(){const E=document.getElementById(i);E&&E.remove()}function f(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function p(E,A){E.setAttribute("width","24"),E.setAttribute("id",A),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function g(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Lb=!0,d()},E}function y(E,A){E.setAttribute("id",A),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function N(){const E=iS(i),A=t("text"),T=document.getElementById(A)||document.createElement("span"),R=t("learnmore"),b=document.getElementById(R)||document.createElement("a"),k=t("preprendIcon"),_=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const j=E.element;f(j),y(b,R);const S=g();p(_,k),j.append(_,T,b,S),document.body.appendChild(j)}c?(T.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",N):N()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_n())}function oS(){var n;const e=(n=Jh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Hg(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function cS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function uS(){const n=_n();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function dS(){return!oS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ef(){try{return typeof indexedDB=="object"}catch{return!1}}function tf(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}function Bg(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS="FirebaseError";class gs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=hS,Object.setPrototypeOf(this,gs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zi.prototype.create)}}class zi{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?fS(c,i):"Error",f=`${this.serviceName}: ${d} (${o}).`;return new gs(o,f,i)}}function fS(n,e){return n.replace(mS,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const mS=/\{\$([^}]+)}/g;function pS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Di(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const c=n[o],d=e[o];if(Vb(c)&&Vb(d)){if(!Di(c,d))return!1}else if(c!==d)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function Vb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Pc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,c]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Lc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function gS(n,e){const t=new vS(n,e);return t.subscribe.bind(t)}class vS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");yS(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=Fp),o.error===void 0&&(o.error=Fp),o.complete===void 0&&(o.complete=Fp);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function yS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Fp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS=1e3,NS=2,bS=4*60*60*1e3,_S=.5;function Ub(n,e=xS,t=NS){const i=e*Math.pow(t,n),o=Math.round(_S*i*(Math.random()-.5)*2);return Math.min(bS,i+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(n){return n&&n._delegate?n._delegate:n}class Wn{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new sS;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(TS(e))try{this.getOrInitializeService({instanceIdentifier:kr})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});i.resolve(c)}catch{}}}}clearInstance(e=kr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=kr){return this.instances.has(e)}getOptions(e=kr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[c,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(c);i===f&&d.resolve(o)}return o}onInit(e,t){var i;const o=this.normalizeInstanceIdentifier(t),c=(i=this.onInitCallbacks.get(o))!==null&&i!==void 0?i:new Set;c.add(e),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&e(d,o),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:jS(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=kr){return this.component?this.component.multipleInstances?e:kr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function jS(n){return n===kr?void 0:n}function TS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ES(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ye||(Ye={}));const CS={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},wS=Ye.INFO,SS={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},IS=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=SS[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class gu{constructor(e){this.name=e,this._logLevel=wS,this._logHandler=IS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?CS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}const RS=(n,e)=>e.some(t=>n instanceof t);let Fb,qb;function MS(){return Fb||(Fb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DS(){return qb||(qb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const dj=new WeakMap,lg=new WeakMap,hj=new WeakMap,qp=new WeakMap,zg=new WeakMap;function kS(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(Ci(n.result)),o()},d=()=>{i(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&dj.set(t,n)}).catch(()=>{}),zg.set(e,n),e}function OS(n){if(lg.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});lg.set(n,e)}let cg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return lg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||hj.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ci(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function PS(n){cg=n(cg)}function LS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Hp(this),e,...t);return hj.set(i,e.sort?e.sort():[e]),Ci(i)}:DS().includes(n)?function(...e){return n.apply(Hp(this),e),Ci(dj.get(this))}:function(...e){return Ci(n.apply(Hp(this),e))}}function VS(n){return typeof n=="function"?LS(n):(n instanceof IDBTransaction&&OS(n),RS(n,MS())?new Proxy(n,cg):n)}function Ci(n){if(n instanceof IDBRequest)return kS(n);if(qp.has(n))return qp.get(n);const e=VS(n);return e!==n&&(qp.set(n,e),zg.set(e,n)),e}const Hp=n=>zg.get(n);function fj(n,e,{blocked:t,upgrade:i,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),f=Ci(d);return i&&d.addEventListener("upgradeneeded",p=>{i(Ci(d.result),p.oldVersion,p.newVersion,Ci(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),f.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),f}const US=["get","getKey","getAll","getAllKeys","count"],FS=["put","add","delete","clear"],Bp=new Map;function Hb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Bp.get(e))return Bp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=FS.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||US.includes(t)))return;const c=async function(d,...f){const p=this.transaction(d,o?"readwrite":"readonly");let g=p.store;return i&&(g=g.index(f.shift())),(await Promise.all([g[t](...f),o&&p.done]))[0]};return Bp.set(e,c),c}PS(n=>({...n,get:(e,t,i)=>Hb(e,t)||n.get(e,t,i),has:(e,t)=>!!Hb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(HS(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function HS(n){const e=n.getComponent();return e?.type==="VERSION"}const ug="@firebase/app",Bb="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua=new gu("@firebase/app"),BS="@firebase/app-compat",zS="@firebase/analytics-compat",GS="@firebase/analytics",$S="@firebase/app-check-compat",YS="@firebase/app-check",QS="@firebase/auth",KS="@firebase/auth-compat",XS="@firebase/database",WS="@firebase/data-connect",ZS="@firebase/database-compat",JS="@firebase/functions",eI="@firebase/functions-compat",tI="@firebase/installations",nI="@firebase/installations-compat",sI="@firebase/messaging",aI="@firebase/messaging-compat",iI="@firebase/performance",rI="@firebase/performance-compat",oI="@firebase/remote-config",lI="@firebase/remote-config-compat",cI="@firebase/storage",uI="@firebase/storage-compat",dI="@firebase/firestore",hI="@firebase/ai",fI="@firebase/firestore-compat",mI="firebase",pI="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dg="[DEFAULT]",gI={[ug]:"fire-core",[BS]:"fire-core-compat",[GS]:"fire-analytics",[zS]:"fire-analytics-compat",[YS]:"fire-app-check",[$S]:"fire-app-check-compat",[QS]:"fire-auth",[KS]:"fire-auth-compat",[XS]:"fire-rtdb",[WS]:"fire-data-connect",[ZS]:"fire-rtdb-compat",[JS]:"fire-fn",[eI]:"fire-fn-compat",[tI]:"fire-iid",[nI]:"fire-iid-compat",[sI]:"fire-fcm",[aI]:"fire-fcm-compat",[iI]:"fire-perf",[rI]:"fire-perf-compat",[oI]:"fire-rc",[lI]:"fire-rc-compat",[cI]:"fire-gcs",[uI]:"fire-gcs-compat",[dI]:"fire-fst",[fI]:"fire-fst-compat",[hI]:"fire-vertex","fire-js":"fire-js",[mI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch=new Map,vI=new Map,hg=new Map;function zb(n,e){try{n.container.addComponent(e)}catch(t){Ua.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ms(n){const e=n.name;if(hg.has(e))return Ua.debug(`There were multiple attempts to register component ${e}.`),!1;hg.set(e,n);for(const t of Ch.values())zb(t,n);for(const t of vI.values())zb(t,n);return!0}function Ba(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function On(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wi=new zi("app","Firebase",yI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Wn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr=pI;function mj(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:dg,automaticDataCollectionEnabled:!0},e),o=i.name;if(typeof o!="string"||!o)throw wi.create("bad-app-name",{appName:String(o)});if(t||(t=lj()),!t)throw wi.create("no-options");const c=Ch.get(o);if(c){if(Di(t,c.options)&&Di(i,c.config))return c;throw wi.create("duplicate-app",{appName:o})}const d=new AS(o);for(const p of hg.values())d.addComponent(p);const f=new xI(t,i,d);return Ch.set(o,f),f}function vu(n=dg){const e=Ch.get(n);if(!e&&n===dg&&lj())return mj();if(!e)throw wi.create("no-app",{appName:n});return e}function bn(n,e,t){var i;let o=(i=gI[n])!==null&&i!==void 0?i:n;t&&(o+=`-${t}`);const c=o.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const f=[`Unable to register library "${o}" with version "${e}":`];c&&f.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ua.warn(f.join(" "));return}ms(new Wn(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI="firebase-heartbeat-database",bI=1,eu="firebase-heartbeat-store";let zp=null;function pj(){return zp||(zp=fj(NI,bI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(eu)}catch(t){console.warn(t)}}}}).catch(n=>{throw wi.create("idb-open",{originalErrorMessage:n.message})})),zp}async function _I(n){try{const t=(await pj()).transaction(eu),i=await t.objectStore(eu).get(gj(n));return await t.done,i}catch(e){if(e instanceof gs)Ua.warn(e.message);else{const t=wi.create("idb-get",{originalErrorMessage:e?.message});Ua.warn(t.message)}}}async function Gb(n,e){try{const i=(await pj()).transaction(eu,"readwrite");await i.objectStore(eu).put(e,gj(n)),await i.done}catch(t){if(t instanceof gs)Ua.warn(t.message);else{const i=wi.create("idb-set",{originalErrorMessage:t?.message});Ua.warn(i.message)}}}function gj(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI=1024,jI=30;class TI{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new CI(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=$b();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>jI){const d=wI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Ua.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=$b(),{heartbeatsToSend:i,unsentEntries:o}=AI(this._heartbeatsCache.heartbeats),c=Ah(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Ua.warn(t),""}}}function $b(){return new Date().toISOString().substring(0,10)}function AI(n,e=EI){const t=[];let i=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),Yb(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Yb(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class CI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ef()?tf().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _I(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return Gb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return Gb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function Yb(n){return Ah(JSON.stringify({version:2,heartbeats:n})).length}function wI(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SI(n){ms(new Wn("platform-logger",e=>new qS(e),"PRIVATE")),ms(new Wn("heartbeat",e=>new TI(e),"PRIVATE")),bn(ug,Bb,n),bn(ug,Bb,"esm2017"),bn("fire-js","")}SI("");function Gg(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function vj(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const II=vj,yj=new zi("auth","Firebase",vj());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh=new gu("@firebase/auth");function RI(n,...e){wh.logLevel<=Ye.WARN&&wh.warn(`Auth (${Kr}): ${n}`,...e)}function mh(n,...e){wh.logLevel<=Ye.ERROR&&wh.error(`Auth (${Kr}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ps(n,...e){throw Yg(n,...e)}function ws(n,...e){return Yg(n,...e)}function $g(n,e,t){const i=Object.assign(Object.assign({},II()),{[e]:t});return new zi("auth","Firebase",i).create(e,{appName:n.name})}function Va(n){return $g(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function MI(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&ps(n,"argument-error"),$g(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Yg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return yj.create(n,...e)}function Se(n,e,...t){if(!n)throw Yg(e,...t)}function Pa(n){const e="INTERNAL ASSERTION FAILED: "+n;throw mh(e),new Error(e)}function Fa(n,e){n||Pa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function DI(){return Qb()==="http:"||Qb()==="https:"}function Qb(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(DI()||Hg()||"connection"in navigator)?navigator.onLine:!0}function OI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Fa(t>e,"Short delay should be less than long delay!"),this.isMobile=rS()||cS()}get(){return kI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg(n,e){Fa(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Pa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Pa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Pa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],VI=new yu(3e4,6e4);function Gi(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function $i(n,e,t,i,o={}){return Nj(n,o,async()=>{let c={},d={};i&&(e==="GET"?d=i:c={body:JSON.stringify(i)});const f=pu(Object.assign({key:n.config.apiKey},d)).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const g=Object.assign({method:e,headers:p},c);return lS()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&Qr(n.emulatorConfig.host)&&(g.credentials="include"),xj.fetch()(await bj(n,n.config.apiHost,t,f),g)})}async function Nj(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},PI),e);try{const o=new FI(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw ih(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const f=c.ok?d.errorMessage:d.error.message,[p,g]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw ih(n,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw ih(n,"email-already-in-use",d);if(p==="USER_DISABLED")throw ih(n,"user-disabled",d);const y=i[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw $g(n,y,g);ps(n,y)}}catch(o){if(o instanceof gs)throw o;ps(n,"network-request-failed",{message:String(o)})}}async function xu(n,e,t,i,o={}){const c=await $i(n,e,t,i,o);return"mfaPendingCredential"in c&&ps(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function bj(n,e,t,i){const o=`${e}${t}?${i}`,c=n,d=c.config.emulator?Qg(n.config,o):`${n.config.apiScheme}://${o}`;return LI.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function UI(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class FI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(ws(this.auth,"network-request-failed")),VI.get())})}}function ih(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=ws(n,e,i);return o.customData._tokenResponse=t,o}function Kb(n){return n!==void 0&&n.enterprise!==void 0}class qI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return UI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function HI(n,e){return $i(n,"GET","/v2/recaptchaConfig",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BI(n,e){return $i(n,"POST","/v1/accounts:delete",e)}async function Sh(n,e){return $i(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function zI(n,e=!1){const t=Nt(n),i=await t.getIdToken(e),o=Kg(i);Se(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:i,authTime:Bc(Gp(o.auth_time)),issuedAtTime:Bc(Gp(o.iat)),expirationTime:Bc(Gp(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Gp(n){return Number(n)*1e3}function Kg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return mh("JWT malformed, contained fewer than 3 sections"),null;try{const o=ij(t);return o?JSON.parse(o):(mh("Failed to decode base64 JWT payload"),null)}catch(o){return mh("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Xb(n){const e=Kg(n);return Se(e,"internal-error"),Se(typeof e.exp<"u","internal-error"),Se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof gs&&GI(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function GI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bc(this.lastLoginAt),this.creationTime=Bc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ih(n){var e;const t=n.auth,i=await n.getIdToken(),o=await tu(n,Sh(t,{idToken:i}));Se(o?.users.length,t,"internal-error");const c=o.users[0];n._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?_j(c.providerUserInfo):[],f=QI(n.providerData,d),p=n.isAnonymous,g=!(n.email&&c.passwordHash)&&!f?.length,y=p?g:!1,N={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:f,metadata:new mg(c.createdAt,c.lastLoginAt),isAnonymous:y};Object.assign(n,N)}async function YI(n){const e=Nt(n);await Ih(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function QI(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function _j(n){return n.map(e=>{var{providerId:t}=e,i=Gg(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KI(n,e){const t=await Nj(n,{},async()=>{const i=pu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await bj(n,o,"/v1/token",`key=${c}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:i};return n.emulatorConfig&&Qr(n.emulatorConfig.host)&&(p.credentials="include"),xj.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function XI(n,e){return $i(n,"POST","/v2/accounts:revokeToken",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Se(e.idToken,"internal-error"),Se(typeof e.idToken<"u","internal-error"),Se(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Xb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Se(e.length!==0,"internal-error");const t=Xb(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:c}=await KI(e,t);this.updateTokensAndExpiration(i,o,Number(c))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:c}=t,d=new nl;return i&&(Se(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),o&&(Se(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(Se(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new nl,this.toJSON())}_performRefresh(){return Pa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ni(n,e){Se(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class As{constructor(e){var{uid:t,auth:i,stsTokenManager:o}=e,c=Gg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $I(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new mg(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await tu(this,this.stsTokenManager.getToken(this.auth,e));return Se(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return zI(this,e)}reload(){return YI(this)}_assign(e){this!==e&&(Se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new As(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Ih(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(On(this.auth.app))return Promise.reject(Va(this.auth));const e=await this.getIdToken();return await tu(this,BI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,o,c,d,f,p,g,y;const N=(i=t.displayName)!==null&&i!==void 0?i:void 0,E=(o=t.email)!==null&&o!==void 0?o:void 0,A=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,T=(d=t.photoURL)!==null&&d!==void 0?d:void 0,R=(f=t.tenantId)!==null&&f!==void 0?f:void 0,b=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,k=(g=t.createdAt)!==null&&g!==void 0?g:void 0,_=(y=t.lastLoginAt)!==null&&y!==void 0?y:void 0,{uid:j,emailVerified:S,isAnonymous:O,providerData:B,stsTokenManager:L}=t;Se(j&&L,e,"internal-error");const M=nl.fromJSON(this.name,L);Se(typeof j=="string",e,"internal-error"),Ni(N,e.name),Ni(E,e.name),Se(typeof S=="boolean",e,"internal-error"),Se(typeof O=="boolean",e,"internal-error"),Ni(A,e.name),Ni(T,e.name),Ni(R,e.name),Ni(b,e.name),Ni(k,e.name),Ni(_,e.name);const V=new As({uid:j,auth:e,email:E,emailVerified:S,displayName:N,isAnonymous:O,photoURL:T,phoneNumber:A,tenantId:R,stsTokenManager:M,createdAt:k,lastLoginAt:_});return B&&Array.isArray(B)&&(V.providerData=B.map(U=>Object.assign({},U))),b&&(V._redirectEventId=b),V}static async _fromIdTokenResponse(e,t,i=!1){const o=new nl;o.updateFromServerResponse(t);const c=new As({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await Ih(c),c}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];Se(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?_j(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,f=new nl;f.updateFromIdToken(i);const p=new As({uid:o.localId,auth:e,stsTokenManager:f,isAnonymous:d}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new mg(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,g),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb=new Map;function La(n){Fa(n instanceof Function,"Expected a class definition");let e=Wb.get(n);return e?(Fa(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Wb.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ej.type="NONE";const Zb=Ej;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ph(n,e,t){return`firebase:${n}:${e}:${t}`}class sl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:c}=this.auth;this.fullUserKey=ph(this.userKey,o.apiKey,c),this.fullPersistenceKey=ph("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Sh(this.auth,{idToken:e}).catch(()=>{});return t?As._fromGetAccountInfoResponse(this.auth,t,e):null}return As._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new sl(La(Zb),e,i);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let c=o[0]||La(Zb);const d=ph(i,e.config.apiKey,e.name);let f=null;for(const g of t)try{const y=await g._get(d);if(y){let N;if(typeof y=="string"){const E=await Sh(e,{idToken:y}).catch(()=>{});if(!E)break;N=await As._fromGetAccountInfoResponse(e,E,y)}else N=As._fromJSON(e,y);g!==c&&(f=N),c=g;break}}catch{}const p=o.filter(g=>g._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new sl(c,e,i):(c=p[0],f&&await c._set(d,f.toJSON()),await Promise.all(t.map(async g=>{if(g!==c)try{await g._remove(d)}catch{}})),new sl(c,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jb(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Cj(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(jj(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Sj(e))return"Blackberry";if(Ij(e))return"Webos";if(Tj(e))return"Safari";if((e.includes("chrome/")||Aj(e))&&!e.includes("edge/"))return"Chrome";if(wj(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function jj(n=_n()){return/firefox\//i.test(n)}function Tj(n=_n()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Aj(n=_n()){return/crios\//i.test(n)}function Cj(n=_n()){return/iemobile/i.test(n)}function wj(n=_n()){return/android/i.test(n)}function Sj(n=_n()){return/blackberry/i.test(n)}function Ij(n=_n()){return/webos/i.test(n)}function Xg(n=_n()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function WI(n=_n()){var e;return Xg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function ZI(){return uS()&&document.documentMode===10}function Rj(n=_n()){return Xg(n)||wj(n)||Ij(n)||Sj(n)||/windows phone/i.test(n)||Cj(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mj(n,e=[]){let t;switch(n){case"Browser":t=Jb(_n());break;case"Worker":t=`${Jb(_n())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Kr}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=c=>new Promise((d,f)=>{try{const p=e(c);d(p)}catch(p){f(p)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eR(n,e={}){return $i(n,"GET","/v2/passwordPolicy",Gi(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR=6;class nR{constructor(e){var t,i,o,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:tR,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,o,c,d,f;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(i=p.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),p.isValid&&(p.isValid=(o=p.containsLowercaseLetter)!==null&&o!==void 0?o:!0),p.isValid&&(p.isValid=(c=p.containsUppercaseLetter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(d=p.containsNumericCharacter)!==null&&d!==void 0?d:!0),p.isValid&&(p.isValid=(f=p.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),p}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new e_(this),this.idTokenSubscription=new e_(this),this.beforeStateQueue=new JI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yj,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=La(t)),this._initializationPromise=this.queue(async()=>{var i,o,c;if(!this._deleted&&(this.persistenceManager=await sl.create(this,e),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Sh(this,{idToken:e}),i=await As._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(On(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let o=i,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=o?._redirectEventId,p=await this.tryRedirectSignIn(e);(!d||d===f)&&p?.user&&(o=p.user,c=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(o)}catch(d){o=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return Se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ih(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=OI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(On(this.app))return Promise.reject(Va(this));const t=e?Nt(e):null;return t&&Se(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return On(this.app)?Promise.reject(Va(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return On(this.app)?Promise.reject(Va(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(La(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await eR(this),t=new nR(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new zi("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await XI(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&La(e)||this._popupRedirectResolver;Se(t,this,"argument-error"),this.redirectPersistenceManager=await sl.create(this,[La(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Se(f,this,"internal-error"),f.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,i,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Mj(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(On(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&RI(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Yi(n){return Nt(n)}class e_{constructor(e){this.auth=e,this.observer=null,this.addObserver=gS(t=>this.observer=t)}get next(){return Se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function aR(n){nf=n}function Dj(n){return nf.loadJS(n)}function iR(){return nf.recaptchaEnterpriseScript}function rR(){return nf.gapiScript}function oR(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class lR{constructor(){this.enterprise=new cR}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class cR{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const uR="recaptcha-enterprise",kj="NO_RECAPTCHA";class dR{constructor(e){this.type=uR,this.auth=Yi(e)}async verify(e="verify",t=!1){async function i(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,f)=>{HI(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const g=new qI(p);return c.tenantId==null?c._agentRecaptchaConfig=g:c._tenantRecaptchaConfigs[c.tenantId]=g,d(g.siteKey)}}).catch(p=>{f(p)})})}function o(c,d,f){const p=window.grecaptcha;Kb(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(g=>{d(g)}).catch(()=>{d(kj)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new lR().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{i(this.auth).then(f=>{if(!t&&Kb(window.grecaptcha))o(f,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=iR();p.length!==0&&(p+=f),Dj(p).then(()=>{o(f,c,d)}).catch(g=>{d(g)})}}).catch(f=>{d(f)})})}}async function t_(n,e,t,i=!1,o=!1){const c=new dR(n);let d;if(o)d=kj;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,g=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function pg(n,e,t,i,o){var c;if(!((c=n._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await t_(n,e,t,t==="getOobCode");return i(n,d)}else return i(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await t_(n,e,t,t==="getOobCode");return i(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(n,e){const t=Ba(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Di(c,e??{}))return o;ps(o,"already-initialized")}return t.initialize({options:e})}function fR(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(La);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function mR(n,e,t){const i=Yi(n);Se(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,c=Oj(e),{host:d,port:f}=pR(e),p=f===null?"":`:${f}`,g={url:`${c}//${d}${p}/`},y=Object.freeze({host:d,port:f,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){Se(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Se(Di(g,i.config.emulator)&&Di(y,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=y,i.settings.appVerificationDisabledForTesting=!0,Qr(d)?(Fg(`${c}//${d}${p}`),qg("Auth",!0)):gR()}function Oj(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function pR(n){const e=Oj(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const c=o[1];return{host:c,port:n_(i.substr(c.length+1))}}else{const[c,d]=i.split(":");return{host:c,port:n_(d)}}}function n_(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function gR(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Pa("not implemented")}_getIdTokenResponse(e){return Pa("not implemented")}_linkToIdToken(e,t){return Pa("not implemented")}_getReauthenticationResolver(e){return Pa("not implemented")}}async function vR(n,e){return $i(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yR(n,e){return xu(n,"POST","/v1/accounts:signInWithPassword",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xR(n,e){return xu(n,"POST","/v1/accounts:signInWithEmailLink",Gi(n,e))}async function NR(n,e){return xu(n,"POST","/v1/accounts:signInWithEmailLink",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu extends Wg{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new nu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new nu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pg(e,t,"signInWithPassword",yR);case"emailLink":return xR(e,{email:this._email,oobCode:this._password});default:ps(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pg(e,i,"signUpPassword",vR);case"emailLink":return NR(e,{idToken:t,email:this._email,oobCode:this._password});default:ps(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function al(n,e){return xu(n,"POST","/v1/accounts:signInWithIdp",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR="http://localhost";class Hr extends Wg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Hr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ps("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o}=t,c=Gg(t,["providerId","signInMethod"]);if(!i||!o)return null;const d=new Hr(i,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return al(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,al(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,al(e,t)}buildRequest(){const e={requestUri:bR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=pu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _R(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ER(n){const e=Pc(Lc(n)).link,t=e?Pc(Lc(e)).deep_link_id:null,i=Pc(Lc(n)).deep_link_id;return(i?Pc(Lc(i)).link:null)||i||t||e||n}class Zg{constructor(e){var t,i,o,c,d,f;const p=Pc(Lc(e)),g=(t=p.apiKey)!==null&&t!==void 0?t:null,y=(i=p.oobCode)!==null&&i!==void 0?i:null,N=_R((o=p.mode)!==null&&o!==void 0?o:null);Se(g&&y&&N,"argument-error"),this.apiKey=g,this.operation=N,this.code=y,this.continueUrl=(c=p.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=p.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=p.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=ER(e);try{return new Zg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(){this.providerId=vl.PROVIDER_ID}static credential(e,t){return nu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Zg.parseLink(t);return Se(i,"argument-error"),nu._fromEmailAndCode(e,i.code,i.tenantId)}}vl.PROVIDER_ID="password";vl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";vl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu extends Jg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends Nu{constructor(){super("facebook.com")}static credential(e){return Hr._fromParams({providerId:_i.PROVIDER_ID,signInMethod:_i.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _i.credentialFromTaggedObject(e)}static credentialFromError(e){return _i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _i.credential(e.oauthAccessToken)}catch{return null}}}_i.FACEBOOK_SIGN_IN_METHOD="facebook.com";_i.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa extends Nu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Hr._fromParams({providerId:Oa.PROVIDER_ID,signInMethod:Oa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Oa.credentialFromTaggedObject(e)}static credentialFromError(e){return Oa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Oa.credential(t,i)}catch{return null}}}Oa.GOOGLE_SIGN_IN_METHOD="google.com";Oa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei extends Nu{constructor(){super("github.com")}static credential(e){return Hr._fromParams({providerId:Ei.PROVIDER_ID,signInMethod:Ei.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ei.credentialFromTaggedObject(e)}static credentialFromError(e){return Ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ei.credential(e.oauthAccessToken)}catch{return null}}}Ei.GITHUB_SIGN_IN_METHOD="github.com";Ei.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji extends Nu{constructor(){super("twitter.com")}static credential(e,t){return Hr._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ji.credentialFromTaggedObject(e)}static credentialFromError(e){return ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return ji.credential(t,i)}catch{return null}}}ji.TWITTER_SIGN_IN_METHOD="twitter.com";ji.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jR(n,e){return xu(n,"POST","/v1/accounts:signUp",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const c=await As._fromIdTokenResponse(e,i,o),d=s_(i);return new Br({user:c,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=s_(i);return new Br({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function s_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh extends gs{constructor(e,t,i,o){var c;super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,Rh.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new Rh(e,t,i,o)}}function Pj(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?Rh._fromErrorAndOperation(n,c,e,i):c})}async function TR(n,e,t=!1){const i=await tu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Br._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AR(n,e,t=!1){const{auth:i}=n;if(On(i.app))return Promise.reject(Va(i));const o="reauthenticate";try{const c=await tu(n,Pj(i,o,e,n),t);Se(c.idToken,i,"internal-error");const d=Kg(c.idToken);Se(d,i,"internal-error");const{sub:f}=d;return Se(n.uid===f,i,"user-mismatch"),Br._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&ps(i,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lj(n,e,t=!1){if(On(n.app))return Promise.reject(Va(n));const i="signIn",o=await Pj(n,i,e),c=await Br._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(c.user),c}async function CR(n,e){return Lj(Yi(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vj(n){const e=Yi(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function wR(n,e,t){if(On(n.app))return Promise.reject(Va(n));const i=Yi(n),d=await pg(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",jR).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&Vj(n),p}),f=await Br._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(f.user),f}function SR(n,e,t){return On(n.app)?Promise.reject(Va(n)):CR(Nt(n),vl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Vj(n),i})}function IR(n,e,t,i){return Nt(n).onIdTokenChanged(e,t,i)}function RR(n,e,t){return Nt(n).beforeAuthStateChanged(e,t)}function MR(n,e,t,i){return Nt(n).onAuthStateChanged(e,t,i)}function DR(n){return Nt(n).signOut()}const Mh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Mh,"1"),this.storage.removeItem(Mh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR=1e3,OR=10;class Fj extends Uj{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Rj(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,p)=>{this.notifyListeners(d,p)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},c=this.storage.getItem(i);ZI()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,OR):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},kR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Fj.type="LOCAL";const PR=Fj;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj extends Uj{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}qj.type="SESSION";const Hj=qj;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LR(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new sf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const f=Array.from(d).map(async g=>g(t.origin,c)),p=await LR(f);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((f,p)=>{const g=ev("",20);o.port1.start();const y=setTimeout(()=>{p(new Error("unsupported_event"))},i);d={messageChannel:o,onMessage(N){const E=N;if(E.data.eventId===g)switch(E.data.status){case"ack":clearTimeout(y),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),f(E.data.response);break;default:clearTimeout(y),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Js(){return window}function UR(n){Js().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bj(){return typeof Js().WorkerGlobalScope<"u"&&typeof Js().importScripts=="function"}async function FR(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qR(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function HR(){return Bj()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj="firebaseLocalStorageDb",BR=1,Dh="firebaseLocalStorage",Gj="fbase_key";class bu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function af(n,e){return n.transaction([Dh],e?"readwrite":"readonly").objectStore(Dh)}function zR(){const n=indexedDB.deleteDatabase(zj);return new bu(n).toPromise()}function gg(){const n=indexedDB.open(zj,BR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Dh,{keyPath:Gj})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Dh)?e(i):(i.close(),await zR(),e(await gg()))})})}async function a_(n,e,t){const i=af(n,!0).put({[Gj]:e,value:t});return new bu(i).toPromise()}async function GR(n,e){const t=af(n,!1).get(e),i=await new bu(t).toPromise();return i===void 0?null:i.value}function i_(n,e){const t=af(n,!0).delete(e);return new bu(t).toPromise()}const $R=800,YR=3;class $j{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await gg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>YR)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Bj()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sf._getInstance(HR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await FR(),!this.activeServiceWorker)return;this.sender=new VR(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||qR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await gg();return await a_(e,Mh,"1"),await i_(e,Mh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>a_(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>GR(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>i_(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=af(o,!1).getAll();return new bu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$R)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$j.type="LOCAL";const QR=$j;new yu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(n,e){return e?La(e):(Se(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv extends Wg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return al(e,this._buildIdpRequest())}_linkToIdToken(e,t){return al(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return al(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function KR(n){return Lj(n.auth,new tv(n),n.bypassAuthState)}function XR(n){const{auth:e,user:t}=n;return Se(t,e,"internal-error"),AR(t,new tv(n),n.bypassAuthState)}async function WR(n){const{auth:e,user:t}=n;return Se(t,e,"internal-error"),TR(t,new tv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e,t,i,o,c=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:c,error:d,type:f}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:i,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return KR;case"linkViaPopup":case"linkViaRedirect":return WR;case"reauthViaPopup":case"reauthViaRedirect":return XR;default:ps(this.auth,"internal-error")}}resolve(e){Fa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=new yu(2e3,1e4);async function JR(n,e,t){if(On(n.app))return Promise.reject(ws(n,"operation-not-supported-in-this-environment"));const i=Yi(n);MI(n,e,Jg);const o=Yj(i,t);return new Or(i,"signInViaPopup",e,o).executeNotNull()}class Or extends Qj{constructor(e,t,i,o,c){super(e,t,o,c),this.provider=i,this.authWindow=null,this.pollId=null,Or.currentPopupAction&&Or.currentPopupAction.cancel(),Or.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Se(e,this.auth,"internal-error"),e}async onExecution(){Fa(this.filter.length===1,"Popup operations only handle one event");const e=ev();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ws(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ws(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Or.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ws(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ZR.get())};e()}}Or.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1="pendingRedirect",gh=new Map;class t1 extends Qj{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=gh.get(this.auth._key());if(!e){try{const i=await n1(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}gh.set(this.auth._key(),e)}return this.bypassAuthState||gh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function n1(n,e){const t=i1(e),i=a1(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function s1(n,e){gh.set(n._key(),e)}function a1(n){return La(n._redirectPersistence)}function i1(n){return ph(e1,n.config.apiKey,n.name)}async function r1(n,e,t=!1){if(On(n.app))return Promise.reject(Va(n));const i=Yi(n),o=Yj(i,e),d=await new t1(i,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1=10*60*1e3;class l1{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!c1(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!Kj(e)){const o=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(ws(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=o1&&this.cachedEventUids.clear(),this.cachedEventUids.has(r_(e))}saveEventToCache(e){this.cachedEventUids.add(r_(e)),this.lastProcessedEventTime=Date.now()}}function r_(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Kj({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function c1(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Kj(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u1(n,e={}){return $i(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d1=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,h1=/^https?/;async function f1(n){if(n.config.emulator)return;const{authorizedDomains:e}=await u1(n);for(const t of e)try{if(m1(t))return}catch{}ps(n,"unauthorized-domain")}function m1(n){const e=fg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!h1.test(t))return!1;if(d1.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1=new yu(3e4,6e4);function o_(){const n=Js().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function g1(n){return new Promise((e,t)=>{var i,o,c;function d(){o_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{o_(),t(ws(n,"network-request-failed"))},timeout:p1.get()})}if(!((o=(i=Js().gapi)===null||i===void 0?void 0:i.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((c=Js().gapi)===null||c===void 0)&&c.load)d();else{const f=oR("iframefcb");return Js()[f]=()=>{gapi.load?d():t(ws(n,"network-request-failed"))},Dj(`${rR()}?onload=${f}`).catch(p=>t(p))}}).catch(e=>{throw vh=null,e})}let vh=null;function v1(n){return vh=vh||g1(n),vh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1=new yu(5e3,15e3),x1="__/auth/iframe",N1="emulator/auth/iframe",b1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function E1(n){const e=n.config;Se(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qg(e,N1):`https://${n.config.authDomain}/${x1}`,i={apiKey:e.apiKey,appName:n.name,v:Kr},o=_1.get(n.config.apiHost);o&&(i.eid=o);const c=n._getFrameworks();return c.length&&(i.fw=c.join(",")),`${t}?${pu(i).slice(1)}`}async function j1(n){const e=await v1(n),t=Js().gapi;return Se(t,n,"internal-error"),e.open({where:document.body,url:E1(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:b1,dontclear:!0},i=>new Promise(async(o,c)=>{await i.restyle({setHideOnLeave:!1});const d=ws(n,"network-request-failed"),f=Js().setTimeout(()=>{c(d)},y1.get());function p(){Js().clearTimeout(f),o(i)}i.ping(p).then(p,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},A1=500,C1=600,w1="_blank",S1="http://localhost";class l_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function I1(n,e,t,i=A1,o=C1){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const p=Object.assign(Object.assign({},T1),{width:i.toString(),height:o.toString(),top:c,left:d}),g=_n().toLowerCase();t&&(f=Aj(g)?w1:t),jj(g)&&(e=e||S1,p.scrollbars="yes");const y=Object.entries(p).reduce((E,[A,T])=>`${E}${A}=${T},`,"");if(WI(g)&&f!=="_self")return R1(e||"",f),new l_(null);const N=window.open(e||"",f,y);Se(N,n,"popup-blocked");try{N.focus()}catch{}return new l_(N)}function R1(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1="__/auth/handler",D1="emulator/auth/handler",k1=encodeURIComponent("fac");async function c_(n,e,t,i,o,c){Se(n.config.authDomain,n,"auth-domain-config-required"),Se(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Kr,eventId:o};if(e instanceof Jg){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",pS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,N]of Object.entries({}))d[y]=N}if(e instanceof Nu){const y=e.getScopes().filter(N=>N!=="");y.length>0&&(d.scopes=y.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const y of Object.keys(f))f[y]===void 0&&delete f[y];const p=await n._getAppCheckToken(),g=p?`#${k1}=${encodeURIComponent(p)}`:"";return`${O1(n)}?${pu(f).slice(1)}${g}`}function O1({config:n}){return n.emulator?Qg(n,D1):`https://${n.authDomain}/${M1}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $p="webStorageSupport";class P1{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Hj,this._completeRedirectFn=r1,this._overrideRedirectResult=s1}async _openPopup(e,t,i,o){var c;Fa((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await c_(e,t,i,fg(),o);return I1(e,d,ev())}async _openRedirect(e,t,i,o){await this._originValidation(e);const c=await c_(e,t,i,fg(),o);return UR(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Fa(c,"If manager is not set, promise should be"),c)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await j1(e),i=new l1(e);return t.register("authEvent",o=>(Se(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send($p,{type:$p},o=>{var c;const d=(c=o?.[0])===null||c===void 0?void 0:c[$p];d!==void 0&&t(!!d),ps(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=f1(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Rj()||Tj()||Xg()}}const L1=P1;var u_="@firebase/auth",d_="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U1(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function F1(n){ms(new Wn("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=i.options;Se(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const p={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Mj(n)},g=new sR(i,o,c,p);return fR(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ms(new Wn("auth-internal",e=>{const t=Yi(e.getProvider("auth").getImmediate());return(i=>new V1(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),bn(u_,d_,U1(n)),bn(u_,d_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1=5*60,H1=cj("authIdTokenMaxAge")||q1;let h_=null;const B1=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>H1)return;const o=t?.token;h_!==o&&(h_=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function z1(n=vu()){const e=Ba(n,"auth");if(e.isInitialized())return e.getImmediate();const t=hR(n,{popupRedirectResolver:L1,persistence:[QR,PR,Hj]}),i=cj("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(i,location.origin);if(location.origin===c.origin){const d=B1(c.toString());RR(t,d,()=>d(t.currentUser)),IR(t,f=>d(f))}}const o=rj("auth");return o&&mR(t,`http://${o}`),t}function G1(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}aR({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const c=ws("internal-error");c.customData=o,t(c)},i.type="text/javascript",i.charset="UTF-8",G1().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});F1("Browser");var $1="firebase",Y1="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bn($1,Y1,"app");var f_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Si,Xj;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(L,M){function V(){}V.prototype=M.prototype,L.D=M.prototype,L.prototype=new V,L.prototype.constructor=L,L.C=function(U,I,D){for(var q=Array(arguments.length-2),be=2;be<arguments.length;be++)q[be-2]=arguments[be];return M.prototype[I].apply(U,q)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(L,M,V){V||(V=0);var U=Array(16);if(typeof M=="string")for(var I=0;16>I;++I)U[I]=M.charCodeAt(V++)|M.charCodeAt(V++)<<8|M.charCodeAt(V++)<<16|M.charCodeAt(V++)<<24;else for(I=0;16>I;++I)U[I]=M[V++]|M[V++]<<8|M[V++]<<16|M[V++]<<24;M=L.g[0],V=L.g[1],I=L.g[2];var D=L.g[3],q=M+(D^V&(I^D))+U[0]+3614090360&4294967295;M=V+(q<<7&4294967295|q>>>25),q=D+(I^M&(V^I))+U[1]+3905402710&4294967295,D=M+(q<<12&4294967295|q>>>20),q=I+(V^D&(M^V))+U[2]+606105819&4294967295,I=D+(q<<17&4294967295|q>>>15),q=V+(M^I&(D^M))+U[3]+3250441966&4294967295,V=I+(q<<22&4294967295|q>>>10),q=M+(D^V&(I^D))+U[4]+4118548399&4294967295,M=V+(q<<7&4294967295|q>>>25),q=D+(I^M&(V^I))+U[5]+1200080426&4294967295,D=M+(q<<12&4294967295|q>>>20),q=I+(V^D&(M^V))+U[6]+2821735955&4294967295,I=D+(q<<17&4294967295|q>>>15),q=V+(M^I&(D^M))+U[7]+4249261313&4294967295,V=I+(q<<22&4294967295|q>>>10),q=M+(D^V&(I^D))+U[8]+1770035416&4294967295,M=V+(q<<7&4294967295|q>>>25),q=D+(I^M&(V^I))+U[9]+2336552879&4294967295,D=M+(q<<12&4294967295|q>>>20),q=I+(V^D&(M^V))+U[10]+4294925233&4294967295,I=D+(q<<17&4294967295|q>>>15),q=V+(M^I&(D^M))+U[11]+2304563134&4294967295,V=I+(q<<22&4294967295|q>>>10),q=M+(D^V&(I^D))+U[12]+1804603682&4294967295,M=V+(q<<7&4294967295|q>>>25),q=D+(I^M&(V^I))+U[13]+4254626195&4294967295,D=M+(q<<12&4294967295|q>>>20),q=I+(V^D&(M^V))+U[14]+2792965006&4294967295,I=D+(q<<17&4294967295|q>>>15),q=V+(M^I&(D^M))+U[15]+1236535329&4294967295,V=I+(q<<22&4294967295|q>>>10),q=M+(I^D&(V^I))+U[1]+4129170786&4294967295,M=V+(q<<5&4294967295|q>>>27),q=D+(V^I&(M^V))+U[6]+3225465664&4294967295,D=M+(q<<9&4294967295|q>>>23),q=I+(M^V&(D^M))+U[11]+643717713&4294967295,I=D+(q<<14&4294967295|q>>>18),q=V+(D^M&(I^D))+U[0]+3921069994&4294967295,V=I+(q<<20&4294967295|q>>>12),q=M+(I^D&(V^I))+U[5]+3593408605&4294967295,M=V+(q<<5&4294967295|q>>>27),q=D+(V^I&(M^V))+U[10]+38016083&4294967295,D=M+(q<<9&4294967295|q>>>23),q=I+(M^V&(D^M))+U[15]+3634488961&4294967295,I=D+(q<<14&4294967295|q>>>18),q=V+(D^M&(I^D))+U[4]+3889429448&4294967295,V=I+(q<<20&4294967295|q>>>12),q=M+(I^D&(V^I))+U[9]+568446438&4294967295,M=V+(q<<5&4294967295|q>>>27),q=D+(V^I&(M^V))+U[14]+3275163606&4294967295,D=M+(q<<9&4294967295|q>>>23),q=I+(M^V&(D^M))+U[3]+4107603335&4294967295,I=D+(q<<14&4294967295|q>>>18),q=V+(D^M&(I^D))+U[8]+1163531501&4294967295,V=I+(q<<20&4294967295|q>>>12),q=M+(I^D&(V^I))+U[13]+2850285829&4294967295,M=V+(q<<5&4294967295|q>>>27),q=D+(V^I&(M^V))+U[2]+4243563512&4294967295,D=M+(q<<9&4294967295|q>>>23),q=I+(M^V&(D^M))+U[7]+1735328473&4294967295,I=D+(q<<14&4294967295|q>>>18),q=V+(D^M&(I^D))+U[12]+2368359562&4294967295,V=I+(q<<20&4294967295|q>>>12),q=M+(V^I^D)+U[5]+4294588738&4294967295,M=V+(q<<4&4294967295|q>>>28),q=D+(M^V^I)+U[8]+2272392833&4294967295,D=M+(q<<11&4294967295|q>>>21),q=I+(D^M^V)+U[11]+1839030562&4294967295,I=D+(q<<16&4294967295|q>>>16),q=V+(I^D^M)+U[14]+4259657740&4294967295,V=I+(q<<23&4294967295|q>>>9),q=M+(V^I^D)+U[1]+2763975236&4294967295,M=V+(q<<4&4294967295|q>>>28),q=D+(M^V^I)+U[4]+1272893353&4294967295,D=M+(q<<11&4294967295|q>>>21),q=I+(D^M^V)+U[7]+4139469664&4294967295,I=D+(q<<16&4294967295|q>>>16),q=V+(I^D^M)+U[10]+3200236656&4294967295,V=I+(q<<23&4294967295|q>>>9),q=M+(V^I^D)+U[13]+681279174&4294967295,M=V+(q<<4&4294967295|q>>>28),q=D+(M^V^I)+U[0]+3936430074&4294967295,D=M+(q<<11&4294967295|q>>>21),q=I+(D^M^V)+U[3]+3572445317&4294967295,I=D+(q<<16&4294967295|q>>>16),q=V+(I^D^M)+U[6]+76029189&4294967295,V=I+(q<<23&4294967295|q>>>9),q=M+(V^I^D)+U[9]+3654602809&4294967295,M=V+(q<<4&4294967295|q>>>28),q=D+(M^V^I)+U[12]+3873151461&4294967295,D=M+(q<<11&4294967295|q>>>21),q=I+(D^M^V)+U[15]+530742520&4294967295,I=D+(q<<16&4294967295|q>>>16),q=V+(I^D^M)+U[2]+3299628645&4294967295,V=I+(q<<23&4294967295|q>>>9),q=M+(I^(V|~D))+U[0]+4096336452&4294967295,M=V+(q<<6&4294967295|q>>>26),q=D+(V^(M|~I))+U[7]+1126891415&4294967295,D=M+(q<<10&4294967295|q>>>22),q=I+(M^(D|~V))+U[14]+2878612391&4294967295,I=D+(q<<15&4294967295|q>>>17),q=V+(D^(I|~M))+U[5]+4237533241&4294967295,V=I+(q<<21&4294967295|q>>>11),q=M+(I^(V|~D))+U[12]+1700485571&4294967295,M=V+(q<<6&4294967295|q>>>26),q=D+(V^(M|~I))+U[3]+2399980690&4294967295,D=M+(q<<10&4294967295|q>>>22),q=I+(M^(D|~V))+U[10]+4293915773&4294967295,I=D+(q<<15&4294967295|q>>>17),q=V+(D^(I|~M))+U[1]+2240044497&4294967295,V=I+(q<<21&4294967295|q>>>11),q=M+(I^(V|~D))+U[8]+1873313359&4294967295,M=V+(q<<6&4294967295|q>>>26),q=D+(V^(M|~I))+U[15]+4264355552&4294967295,D=M+(q<<10&4294967295|q>>>22),q=I+(M^(D|~V))+U[6]+2734768916&4294967295,I=D+(q<<15&4294967295|q>>>17),q=V+(D^(I|~M))+U[13]+1309151649&4294967295,V=I+(q<<21&4294967295|q>>>11),q=M+(I^(V|~D))+U[4]+4149444226&4294967295,M=V+(q<<6&4294967295|q>>>26),q=D+(V^(M|~I))+U[11]+3174756917&4294967295,D=M+(q<<10&4294967295|q>>>22),q=I+(M^(D|~V))+U[2]+718787259&4294967295,I=D+(q<<15&4294967295|q>>>17),q=V+(D^(I|~M))+U[9]+3951481745&4294967295,L.g[0]=L.g[0]+M&4294967295,L.g[1]=L.g[1]+(I+(q<<21&4294967295|q>>>11))&4294967295,L.g[2]=L.g[2]+I&4294967295,L.g[3]=L.g[3]+D&4294967295}i.prototype.u=function(L,M){M===void 0&&(M=L.length);for(var V=M-this.blockSize,U=this.B,I=this.h,D=0;D<M;){if(I==0)for(;D<=V;)o(this,L,D),D+=this.blockSize;if(typeof L=="string"){for(;D<M;)if(U[I++]=L.charCodeAt(D++),I==this.blockSize){o(this,U),I=0;break}}else for(;D<M;)if(U[I++]=L[D++],I==this.blockSize){o(this,U),I=0;break}}this.h=I,this.o+=M},i.prototype.v=function(){var L=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);L[0]=128;for(var M=1;M<L.length-8;++M)L[M]=0;var V=8*this.o;for(M=L.length-8;M<L.length;++M)L[M]=V&255,V/=256;for(this.u(L),L=Array(16),M=V=0;4>M;++M)for(var U=0;32>U;U+=8)L[V++]=this.g[M]>>>U&255;return L};function c(L,M){var V=f;return Object.prototype.hasOwnProperty.call(V,L)?V[L]:V[L]=M(L)}function d(L,M){this.h=M;for(var V=[],U=!0,I=L.length-1;0<=I;I--){var D=L[I]|0;U&&D==M||(V[I]=D,U=!1)}this.g=V}var f={};function p(L){return-128<=L&&128>L?c(L,function(M){return new d([M|0],0>M?-1:0)}):new d([L|0],0>L?-1:0)}function g(L){if(isNaN(L)||!isFinite(L))return N;if(0>L)return b(g(-L));for(var M=[],V=1,U=0;L>=V;U++)M[U]=L/V|0,V*=4294967296;return new d(M,0)}function y(L,M){if(L.length==0)throw Error("number format error: empty string");if(M=M||10,2>M||36<M)throw Error("radix out of range: "+M);if(L.charAt(0)=="-")return b(y(L.substring(1),M));if(0<=L.indexOf("-"))throw Error('number format error: interior "-" character');for(var V=g(Math.pow(M,8)),U=N,I=0;I<L.length;I+=8){var D=Math.min(8,L.length-I),q=parseInt(L.substring(I,I+D),M);8>D?(D=g(Math.pow(M,D)),U=U.j(D).add(g(q))):(U=U.j(V),U=U.add(g(q)))}return U}var N=p(0),E=p(1),A=p(16777216);n=d.prototype,n.m=function(){if(R(this))return-b(this).m();for(var L=0,M=1,V=0;V<this.g.length;V++){var U=this.i(V);L+=(0<=U?U:4294967296+U)*M,M*=4294967296}return L},n.toString=function(L){if(L=L||10,2>L||36<L)throw Error("radix out of range: "+L);if(T(this))return"0";if(R(this))return"-"+b(this).toString(L);for(var M=g(Math.pow(L,6)),V=this,U="";;){var I=S(V,M).g;V=k(V,I.j(M));var D=((0<V.g.length?V.g[0]:V.h)>>>0).toString(L);if(V=I,T(V))return D+U;for(;6>D.length;)D="0"+D;U=D+U}},n.i=function(L){return 0>L?0:L<this.g.length?this.g[L]:this.h};function T(L){if(L.h!=0)return!1;for(var M=0;M<L.g.length;M++)if(L.g[M]!=0)return!1;return!0}function R(L){return L.h==-1}n.l=function(L){return L=k(this,L),R(L)?-1:T(L)?0:1};function b(L){for(var M=L.g.length,V=[],U=0;U<M;U++)V[U]=~L.g[U];return new d(V,~L.h).add(E)}n.abs=function(){return R(this)?b(this):this},n.add=function(L){for(var M=Math.max(this.g.length,L.g.length),V=[],U=0,I=0;I<=M;I++){var D=U+(this.i(I)&65535)+(L.i(I)&65535),q=(D>>>16)+(this.i(I)>>>16)+(L.i(I)>>>16);U=q>>>16,D&=65535,q&=65535,V[I]=q<<16|D}return new d(V,V[V.length-1]&-2147483648?-1:0)};function k(L,M){return L.add(b(M))}n.j=function(L){if(T(this)||T(L))return N;if(R(this))return R(L)?b(this).j(b(L)):b(b(this).j(L));if(R(L))return b(this.j(b(L)));if(0>this.l(A)&&0>L.l(A))return g(this.m()*L.m());for(var M=this.g.length+L.g.length,V=[],U=0;U<2*M;U++)V[U]=0;for(U=0;U<this.g.length;U++)for(var I=0;I<L.g.length;I++){var D=this.i(U)>>>16,q=this.i(U)&65535,be=L.i(I)>>>16,Ie=L.i(I)&65535;V[2*U+2*I]+=q*Ie,_(V,2*U+2*I),V[2*U+2*I+1]+=D*Ie,_(V,2*U+2*I+1),V[2*U+2*I+1]+=q*be,_(V,2*U+2*I+1),V[2*U+2*I+2]+=D*be,_(V,2*U+2*I+2)}for(U=0;U<M;U++)V[U]=V[2*U+1]<<16|V[2*U];for(U=M;U<2*M;U++)V[U]=0;return new d(V,0)};function _(L,M){for(;(L[M]&65535)!=L[M];)L[M+1]+=L[M]>>>16,L[M]&=65535,M++}function j(L,M){this.g=L,this.h=M}function S(L,M){if(T(M))throw Error("division by zero");if(T(L))return new j(N,N);if(R(L))return M=S(b(L),M),new j(b(M.g),b(M.h));if(R(M))return M=S(L,b(M)),new j(b(M.g),M.h);if(30<L.g.length){if(R(L)||R(M))throw Error("slowDivide_ only works with positive integers.");for(var V=E,U=M;0>=U.l(L);)V=O(V),U=O(U);var I=B(V,1),D=B(U,1);for(U=B(U,2),V=B(V,2);!T(U);){var q=D.add(U);0>=q.l(L)&&(I=I.add(V),D=q),U=B(U,1),V=B(V,1)}return M=k(L,I.j(M)),new j(I,M)}for(I=N;0<=L.l(M);){for(V=Math.max(1,Math.floor(L.m()/M.m())),U=Math.ceil(Math.log(V)/Math.LN2),U=48>=U?1:Math.pow(2,U-48),D=g(V),q=D.j(M);R(q)||0<q.l(L);)V-=U,D=g(V),q=D.j(M);T(D)&&(D=E),I=I.add(D),L=k(L,q)}return new j(I,L)}n.A=function(L){return S(this,L).h},n.and=function(L){for(var M=Math.max(this.g.length,L.g.length),V=[],U=0;U<M;U++)V[U]=this.i(U)&L.i(U);return new d(V,this.h&L.h)},n.or=function(L){for(var M=Math.max(this.g.length,L.g.length),V=[],U=0;U<M;U++)V[U]=this.i(U)|L.i(U);return new d(V,this.h|L.h)},n.xor=function(L){for(var M=Math.max(this.g.length,L.g.length),V=[],U=0;U<M;U++)V[U]=this.i(U)^L.i(U);return new d(V,this.h^L.h)};function O(L){for(var M=L.g.length+1,V=[],U=0;U<M;U++)V[U]=L.i(U)<<1|L.i(U-1)>>>31;return new d(V,L.h)}function B(L,M){var V=M>>5;M%=32;for(var U=L.g.length-V,I=[],D=0;D<U;D++)I[D]=0<M?L.i(D+V)>>>M|L.i(D+V+1)<<32-M:L.i(D+V);return new d(I,L.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,Xj=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=g,d.fromString=y,Si=d}).apply(typeof f_<"u"?f_:typeof self<"u"?self:typeof window<"u"?window:{});var rh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Wj,Vc,Zj,yh,vg,Jj,eT,tT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,x,C){return h==Array.prototype||h==Object.prototype||(h[x]=C.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof rh=="object"&&rh];for(var x=0;x<h.length;++x){var C=h[x];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=t(this);function o(h,x){if(x)e:{var C=i;h=h.split(".");for(var F=0;F<h.length-1;F++){var K=h[F];if(!(K in C))break e;C=C[K]}h=h[h.length-1],F=C[h],x=x(F),x!=F&&x!=null&&e(C,h,{configurable:!0,writable:!0,value:x})}}function c(h,x){h instanceof String&&(h+="");var C=0,F=!1,K={next:function(){if(!F&&C<h.length){var ne=C++;return{value:x(ne,h[ne]),done:!1}}return F=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}o("Array.prototype.values",function(h){return h||function(){return c(this,function(x,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function p(h){var x=typeof h;return x=x!="object"?x:h?Array.isArray(h)?"array":x:"null",x=="array"||x=="object"&&typeof h.length=="number"}function g(h){var x=typeof h;return x=="object"&&h!=null||x=="function"}function y(h,x,C){return h.call.apply(h.bind,arguments)}function N(h,x,C){if(!h)throw Error();if(2<arguments.length){var F=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,F),h.apply(x,K)}}return function(){return h.apply(x,arguments)}}function E(h,x,C){return E=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:N,E.apply(null,arguments)}function A(h,x){var C=Array.prototype.slice.call(arguments,1);return function(){var F=C.slice();return F.push.apply(F,arguments),h.apply(this,F)}}function T(h,x){function C(){}C.prototype=x.prototype,h.aa=x.prototype,h.prototype=new C,h.prototype.constructor=h,h.Qb=function(F,K,ne){for(var fe=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)fe[Ke-2]=arguments[Ke];return x.prototype[K].apply(F,fe)}}function R(h){const x=h.length;if(0<x){const C=Array(x);for(let F=0;F<x;F++)C[F]=h[F];return C}return[]}function b(h,x){for(let C=1;C<arguments.length;C++){const F=arguments[C];if(p(F)){const K=h.length||0,ne=F.length||0;h.length=K+ne;for(let fe=0;fe<ne;fe++)h[K+fe]=F[fe]}else h.push(F)}}class k{constructor(x,C){this.i=x,this.j=C,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function _(h){return/^[\s\xa0]*$/.test(h)}function j(){var h=f.navigator;return h&&(h=h.userAgent)?h:""}function S(h){return S[" "](h),h}S[" "]=function(){};var O=j().indexOf("Gecko")!=-1&&!(j().toLowerCase().indexOf("webkit")!=-1&&j().indexOf("Edge")==-1)&&!(j().indexOf("Trident")!=-1||j().indexOf("MSIE")!=-1)&&j().indexOf("Edge")==-1;function B(h,x,C){for(const F in h)x.call(C,h[F],F,h)}function L(h,x){for(const C in h)x.call(void 0,h[C],C,h)}function M(h){const x={};for(const C in h)x[C]=h[C];return x}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(h,x){let C,F;for(let K=1;K<arguments.length;K++){F=arguments[K];for(C in F)h[C]=F[C];for(let ne=0;ne<V.length;ne++)C=V[ne],Object.prototype.hasOwnProperty.call(F,C)&&(h[C]=F[C])}}function I(h){var x=1;h=h.split(":");const C=[];for(;0<x&&h.length;)C.push(h.shift()),x--;return h.length&&C.push(h.join(":")),C}function D(h){f.setTimeout(()=>{throw h},0)}function q(){var h=xe;let x=null;return h.g&&(x=h.g,h.g=h.g.next,h.g||(h.h=null),x.next=null),x}class be{constructor(){this.h=this.g=null}add(x,C){const F=Ie.get();F.set(x,C),this.h?this.h.next=F:this.g=F,this.h=F}}var Ie=new k(()=>new Y,h=>h.reset());class Y{constructor(){this.next=this.g=this.h=null}set(x,C){this.h=x,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let ie,ee=!1,xe=new be,G=()=>{const h=f.Promise.resolve(void 0);ie=()=>{h.then(te)}};var te=()=>{for(var h;h=q();){try{h.h.call(h.g)}catch(C){D(C)}var x=Ie;x.j(h),100>x.h&&(x.h++,h.next=x.g,x.g=h)}ee=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function de(h,x){this.type=h,this.g=this.target=x,this.defaultPrevented=!1}de.prototype.h=function(){this.defaultPrevented=!0};var Ee=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var h=!1,x=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const C=()=>{};f.addEventListener("test",C,x),f.removeEventListener("test",C,x)}catch{}return h}();function Fe(h,x){if(de.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var C=this.type=h.type,F=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=x,x=h.relatedTarget){if(O){e:{try{S(x.nodeName);var K=!0;break e}catch{}K=!1}K||(x=null)}}else C=="mouseover"?x=h.fromElement:C=="mouseout"&&(x=h.toElement);this.relatedTarget=x,F?(this.clientX=F.clientX!==void 0?F.clientX:F.pageX,this.clientY=F.clientY!==void 0?F.clientY:F.pageY,this.screenX=F.screenX||0,this.screenY=F.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:ke[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Fe.aa.h.call(this)}}T(Fe,de);var ke={2:"touch",3:"pen",4:"mouse"};Fe.prototype.h=function(){Fe.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Yt="closure_listenable_"+(1e6*Math.random()|0),pt=0;function Ms(h,x,C,F,K){this.listener=h,this.proxy=null,this.src=x,this.type=C,this.capture=!!F,this.ha=K,this.key=++pt,this.da=this.fa=!1}function Ga(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function la(h){this.src=h,this.g={},this.h=0}la.prototype.add=function(h,x,C,F,K){var ne=h.toString();h=this.g[ne],h||(h=this.g[ne]=[],this.h++);var fe=Zi(h,x,F,K);return-1<fe?(x=h[fe],C||(x.fa=!1)):(x=new Ms(x,this.src,ne,!!F,K),x.fa=C,h.push(x)),x};function Wi(h,x){var C=x.type;if(C in h.g){var F=h.g[C],K=Array.prototype.indexOf.call(F,x,void 0),ne;(ne=0<=K)&&Array.prototype.splice.call(F,K,1),ne&&(Ga(x),h.g[C].length==0&&(delete h.g[C],h.h--))}}function Zi(h,x,C,F){for(var K=0;K<h.length;++K){var ne=h[K];if(!ne.da&&ne.listener==x&&ne.capture==!!C&&ne.ha==F)return K}return-1}var Ji="closure_lm_"+(1e6*Math.random()|0),Al={};function Ou(h,x,C,F,K){if(Array.isArray(x)){for(var ne=0;ne<x.length;ne++)Ou(h,x[ne],C,F,K);return null}return C=Pu(C),h&&h[Yt]?h.K(x,C,g(F)?!!F.capture:!1,K):Jn(h,x,C,!1,F,K)}function Jn(h,x,C,F,K,ne){if(!x)throw Error("Invalid event type");var fe=g(K)?!!K.capture:!!K,Ke=to(h);if(Ke||(h[Ji]=Ke=new la(h)),C=Ke.add(x,C,F,fe,ne),C.proxy)return C;if(F=kf(),C.proxy=F,F.src=h,F.listener=C,h.addEventListener)Ee||(K=fe),K===void 0&&(K=!1),h.addEventListener(x.toString(),F,K);else if(h.attachEvent)h.attachEvent(er(x.toString()),F);else if(h.addListener&&h.removeListener)h.addListener(F);else throw Error("addEventListener and attachEvent are unavailable.");return C}function kf(){function h(C){return x.call(h.src,h.listener,C)}const x=Of;return h}function Cl(h,x,C,F,K){if(Array.isArray(x))for(var ne=0;ne<x.length;ne++)Cl(h,x[ne],C,F,K);else F=g(F)?!!F.capture:!!F,C=Pu(C),h&&h[Yt]?(h=h.i,x=String(x).toString(),x in h.g&&(ne=h.g[x],C=Zi(ne,C,F,K),-1<C&&(Ga(ne[C]),Array.prototype.splice.call(ne,C,1),ne.length==0&&(delete h.g[x],h.h--)))):h&&(h=to(h))&&(x=h.g[x.toString()],h=-1,x&&(h=Zi(x,C,F,K)),(C=-1<h?x[h]:null)&&eo(C))}function eo(h){if(typeof h!="number"&&h&&!h.da){var x=h.src;if(x&&x[Yt])Wi(x.i,h);else{var C=h.type,F=h.proxy;x.removeEventListener?x.removeEventListener(C,F,h.capture):x.detachEvent?x.detachEvent(er(C),F):x.addListener&&x.removeListener&&x.removeListener(F),(C=to(x))?(Wi(C,h),C.h==0&&(C.src=null,x[Ji]=null)):Ga(h)}}}function er(h){return h in Al?Al[h]:Al[h]="on"+h}function Of(h,x){if(h.da)h=!0;else{x=new Fe(x,this);var C=h.listener,F=h.ha||h.src;h.fa&&eo(h),h=C.call(F,x)}return h}function to(h){return h=h[Ji],h instanceof la?h:null}var wl="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pu(h){return typeof h=="function"?h:(h[wl]||(h[wl]=function(x){return h.handleEvent(x)}),h[wl])}function At(){he.call(this),this.i=new la(this),this.M=this,this.F=null}T(At,he),At.prototype[Yt]=!0,At.prototype.removeEventListener=function(h,x,C,F){Cl(this,h,x,C,F)};function at(h,x){var C,F=h.F;if(F)for(C=[];F;F=F.F)C.push(F);if(h=h.M,F=x.type||x,typeof x=="string")x=new de(x,h);else if(x instanceof de)x.target=x.target||h;else{var K=x;x=new de(F,h),U(x,K)}if(K=!0,C)for(var ne=C.length-1;0<=ne;ne--){var fe=x.g=C[ne];K=Ln(fe,F,!0,x)&&K}if(fe=x.g=h,K=Ln(fe,F,!0,x)&&K,K=Ln(fe,F,!1,x)&&K,C)for(ne=0;ne<C.length;ne++)fe=x.g=C[ne],K=Ln(fe,F,!1,x)&&K}At.prototype.N=function(){if(At.aa.N.call(this),this.i){var h=this.i,x;for(x in h.g){for(var C=h.g[x],F=0;F<C.length;F++)Ga(C[F]);delete h.g[x],h.h--}}this.F=null},At.prototype.K=function(h,x,C,F){return this.i.add(String(h),x,!1,C,F)},At.prototype.L=function(h,x,C,F){return this.i.add(String(h),x,!0,C,F)};function Ln(h,x,C,F){if(x=h.i.g[String(x)],!x)return!0;x=x.concat();for(var K=!0,ne=0;ne<x.length;++ne){var fe=x[ne];if(fe&&!fe.da&&fe.capture==C){var Ke=fe.listener,qt=fe.ha||fe.src;fe.fa&&Wi(h.i,fe),K=Ke.call(qt,F)!==!1&&K}}return K&&!F.defaultPrevented}function fn(h,x,C){if(typeof h=="function")C&&(h=E(h,C));else if(h&&typeof h.handleEvent=="function")h=E(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:f.setTimeout(h,x||0)}function Lu(h){h.g=fn(()=>{h.g=null,h.i&&(h.i=!1,Lu(h))},h.l);const x=h.h;h.h=null,h.m.apply(null,x)}class Pf extends he{constructor(x,C){super(),this.m=x,this.l=C,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:Lu(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function tr(h){he.call(this),this.h=h,this.g={}}T(tr,he);var nr=[];function sr(h){B(h.g,function(x,C){this.g.hasOwnProperty(C)&&eo(x)},h),h.g={}}tr.prototype.N=function(){tr.aa.N.call(this),sr(this)},tr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vs=f.JSON.stringify,no=f.JSON.parse,ar=class{stringify(h){return f.JSON.stringify(h,void 0)}parse(h){return f.JSON.parse(h,void 0)}};function Sl(){}Sl.prototype.h=null;function Il(h){return h.h||(h.h=h.i())}function Rl(){}var ca={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ua(){de.call(this,"d")}T(ua,de);function Ml(){de.call(this,"c")}T(Ml,de);var Ds={},Dl=null;function $a(){return Dl=Dl||new At}Ds.La="serverreachability";function so(h){de.call(this,Ds.La,h)}T(so,de);function Ya(h){const x=$a();at(x,new so(x))}Ds.STAT_EVENT="statevent";function Vu(h,x){de.call(this,Ds.STAT_EVENT,h),this.stat=x}T(Vu,de);function bt(h){const x=$a();at(x,new Vu(x,h))}Ds.Ma="timingevent";function Ft(h,x){de.call(this,Ds.Ma,h),this.size=x}T(Ft,de);function Dt(h,x){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){h()},x)}function es(){this.g=!0}es.prototype.xa=function(){this.g=!1};function kl(h,x,C,F,K,ne){h.info(function(){if(h.g)if(ne)for(var fe="",Ke=ne.split("&"),qt=0;qt<Ke.length;qt++){var Xe=Ke[qt].split("=");if(1<Xe.length){var Kt=Xe[0];Xe=Xe[1];var Ht=Kt.split("_");fe=2<=Ht.length&&Ht[1]=="type"?fe+(Kt+"="+Xe+"&"):fe+(Kt+"=redacted&")}}else fe=null;else fe=ne;return"XMLHTTP REQ ("+F+") [attempt "+K+"]: "+x+`
`+C+`
`+fe})}function Lf(h,x,C,F,K,ne,fe){h.info(function(){return"XMLHTTP RESP ("+F+") [ attempt "+K+"]: "+x+`
`+C+`
`+ne+" "+fe})}function Qa(h,x,C,F){h.info(function(){return"XMLHTTP TEXT ("+x+"): "+ir(h,C)+(F?" "+F:"")})}function Uu(h,x){h.info(function(){return"TIMEOUT: "+x})}es.prototype.info=function(){};function ir(h,x){if(!h.g)return x;if(!x)return null;try{var C=JSON.parse(x);if(C){for(h=0;h<C.length;h++)if(Array.isArray(C[h])){var F=C[h];if(!(2>F.length)){var K=F[1];if(Array.isArray(K)&&!(1>K.length)){var ne=K[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(var fe=1;fe<K.length;fe++)K[fe]=""}}}}return vs(C)}catch{return x}}var Ka={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},da={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ks;function Os(){}T(Os,Sl),Os.prototype.g=function(){return new XMLHttpRequest},Os.prototype.i=function(){return{}},ks=new Os;function En(h,x,C,F){this.j=h,this.i=x,this.l=C,this.R=F||1,this.U=new tr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new St}function St(){this.i=null,this.g="",this.h=!1}var Ol={},ao={};function ys(h,x,C){h.L=1,h.v=ur(Vn(x)),h.m=C,h.P=!0,ha(h,null)}function ha(h,x){h.F=Date.now(),rr(h),h.A=Vn(h.v);var C=h.A,F=h.R;Array.isArray(F)||(F=[String(F)]),ql(C.i,"t",F),h.C=0,C=h.j.J,h.h=new St,h.g=td(h.j,C?x:null,!h.m),0<h.O&&(h.M=new Pf(E(h.Y,h,h.g),h.O)),x=h.U,C=h.g,F=h.ca;var K="readystatechange";Array.isArray(K)||(K&&(nr[0]=K.toString()),K=nr);for(var ne=0;ne<K.length;ne++){var fe=Ou(C,K[ne],F||x.handleEvent,!1,x.h||x);if(!fe)break;x.g[fe.key]=fe}x=h.H?M(h.H):{},h.m?(h.u||(h.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,x)):(h.u="GET",h.g.ea(h.A,h.u,null,x)),Ya(),kl(h.i,h.u,h.A,h.l,h.R,h.m)}En.prototype.ca=function(h){h=h.target;const x=this.M;x&&as(h)==3?x.j():this.Y(h)},En.prototype.Y=function(h){try{if(h==this.g)e:{const Ht=as(this.g);var x=this.g.Ba();const Na=this.g.Z();if(!(3>Ht)&&(Ht!=3||this.g&&(this.h.h||this.g.oa()||Yu(this.g)))){this.J||Ht!=4||x==7||(x==8||0>=Na?Ya(3):Ya(2)),Xa(this);var C=this.g.Z();this.X=C;t:if(Fu(this)){var F=Yu(this.g);h="";var K=F.length,ne=as(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){tn(this),Ps(this);var fe="";break t}this.h.i=new f.TextDecoder}for(x=0;x<K;x++)this.h.h=!0,h+=this.h.i.decode(F[x],{stream:!(ne&&x==K-1)});F.length=0,this.h.g+=h,this.C=0,fe=this.h.g}else fe=this.g.oa();if(this.o=C==200,Lf(this.i,this.u,this.A,this.l,this.R,Ht,C),this.o){if(this.T&&!this.K){t:{if(this.g){var Ke,qt=this.g;if((Ke=qt.g?qt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(Ke)){var Xe=Ke;break t}}Xe=null}if(C=Xe)Qa(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,or(this,C);else{this.o=!1,this.s=3,bt(12),tn(this),Ps(this);break e}}if(this.P){C=!0;let nn;for(;!this.J&&this.C<fe.length;)if(nn=qu(this,fe),nn==ao){Ht==4&&(this.s=4,bt(14),C=!1),Qa(this.i,this.l,null,"[Incomplete Response]");break}else if(nn==Ol){this.s=4,bt(15),Qa(this.i,this.l,fe,"[Invalid Chunk]"),C=!1;break}else Qa(this.i,this.l,nn,null),or(this,nn);if(Fu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ht!=4||fe.length!=0||this.h.h||(this.s=1,bt(16),C=!1),this.o=this.o&&C,!C)Qa(this.i,this.l,fe,"[Invalid Chunked Response]"),tn(this),Ps(this);else if(0<fe.length&&!this.W){this.W=!0;var Kt=this.j;Kt.g==this&&Kt.ba&&!Kt.M&&(Kt.j.info("Great, no buffering proxy detected. Bytes received: "+fe.length),yr(Kt),Kt.M=!0,bt(11))}}else Qa(this.i,this.l,fe,null),or(this,fe);Ht==4&&tn(this),this.o&&!this.J&&(Ht==4?Zu(this.j,this):(this.o=!1,rr(this)))}else Hf(this.g),C==400&&0<fe.indexOf("Unknown SID")?(this.s=3,bt(12)):(this.s=0,bt(13)),tn(this),Ps(this)}}}catch{}finally{}};function Fu(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function qu(h,x){var C=h.C,F=x.indexOf(`
`,C);return F==-1?ao:(C=Number(x.substring(C,F)),isNaN(C)?Ol:(F+=1,F+C>x.length?ao:(x=x.slice(F,F+C),h.C=F+C,x)))}En.prototype.cancel=function(){this.J=!0,tn(this)};function rr(h){h.S=Date.now()+h.I,Hu(h,h.I)}function Hu(h,x){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Dt(E(h.ba,h),x)}function Xa(h){h.B&&(f.clearTimeout(h.B),h.B=null)}En.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Uu(this.i,this.A),this.L!=2&&(Ya(),bt(17)),tn(this),this.s=2,Ps(this)):Hu(this,this.S-h)};function Ps(h){h.j.G==0||h.J||Zu(h.j,h)}function tn(h){Xa(h);var x=h.M;x&&typeof x.ma=="function"&&x.ma(),h.M=null,sr(h.U),h.g&&(x=h.g,h.g=null,x.abort(),x.ma())}function or(h,x){try{var C=h.j;if(C.G!=0&&(C.g==h||Pl(C.h,h))){if(!h.K&&Pl(C.h,h)&&C.G==3){try{var F=C.Da.g.parse(x)}catch{F=null}if(Array.isArray(F)&&F.length==3){var K=F;if(K[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<h.F)vo(C),po(C);else break e;$l(C),bt(18)}}else C.za=K[1],0<C.za-C.T&&37500>K[2]&&C.F&&C.v==0&&!C.C&&(C.C=Dt(E(C.Za,C),6e3));if(1>=ro(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else xa(C,11)}else if((h.K||C.g==h)&&vo(C),!_(x))for(K=C.Da.g.parse(x),x=0;x<K.length;x++){let Xe=K[x];if(C.T=Xe[0],Xe=Xe[1],C.G==2)if(Xe[0]=="c"){C.K=Xe[1],C.ia=Xe[2];const Kt=Xe[3];Kt!=null&&(C.la=Kt,C.j.info("VER="+C.la));const Ht=Xe[4];Ht!=null&&(C.Aa=Ht,C.j.info("SVER="+C.Aa));const Na=Xe[5];Na!=null&&typeof Na=="number"&&0<Na&&(F=1.5*Na,C.L=F,C.j.info("backChannelRequestTimeoutMs_="+F)),F=C;const nn=h.g;if(nn){const Bs=nn.g?nn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bs){var ne=F.h;ne.g||Bs.indexOf("spdy")==-1&&Bs.indexOf("quic")==-1&&Bs.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(oo(ne,ne.h),ne.h=null))}if(F.D){const Ql=nn.g?nn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ql&&(F.ya=Ql,ot(F.I,F.D,Ql))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-h.F,C.j.info("Handshake RTT: "+C.R+"ms")),F=C;var fe=h;if(F.qa=ed(F,F.J?F.ia:null,F.W),fe.K){jn(F.h,fe);var Ke=fe,qt=F.L;qt&&(Ke.I=qt),Ke.B&&(Xa(Ke),rr(Ke)),F.g=fe}else Xu(F);0<C.i.length&&go(C)}else Xe[0]!="stop"&&Xe[0]!="close"||xa(C,7);else C.G==3&&(Xe[0]=="stop"||Xe[0]=="close"?Xe[0]=="stop"?xa(C,7):zl(C):Xe[0]!="noop"&&C.l&&C.l.ta(Xe),C.v=0)}}Ya(4)}catch{}}var Bu=class{constructor(h,x){this.g=h,this.map=x}};function fa(h){this.l=h||10,f.PerformanceNavigationTiming?(h=f.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function io(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function ro(h){return h.h?1:h.g?h.g.size:0}function Pl(h,x){return h.h?h.h==x:h.g?h.g.has(x):!1}function oo(h,x){h.g?h.g.add(x):h.h=x}function jn(h,x){h.h&&h.h==x?h.h=null:h.g&&h.g.has(x)&&h.g.delete(x)}fa.prototype.cancel=function(){if(this.i=Ll(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Ll(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let x=h.i;for(const C of h.g.values())x=x.concat(C.D);return x}return R(h.i)}function Vf(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var x=[],C=h.length,F=0;F<C;F++)x.push(h[F]);return x}x=[],C=0;for(F in h)x[C++]=h[F];return x}function lo(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var x=[];h=h.length;for(var C=0;C<h;C++)x.push(C);return x}x=[],C=0;for(const F in h)x[C++]=F;return x}}}function Vl(h,x){if(h.forEach&&typeof h.forEach=="function")h.forEach(x,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,x,void 0);else for(var C=lo(h),F=Vf(h),K=F.length,ne=0;ne<K;ne++)x.call(void 0,F[ne],C&&C[ne],h)}var lr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Uf(h,x){if(h){h=h.split("&");for(var C=0;C<h.length;C++){var F=h[C].indexOf("="),K=null;if(0<=F){var ne=h[C].substring(0,F);K=h[C].substring(F+1)}else ne=h[C];x(ne,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function kt(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof kt){this.h=h.h,cr(this,h.j),this.o=h.o,this.g=h.g,Wa(this,h.s),this.l=h.l;var x=h.i,C=new pa;C.i=x.i,x.g&&(C.g=new Map(x.g),C.h=x.h),ma(this,C),this.m=h.m}else h&&(x=String(h).match(lr))?(this.h=!1,cr(this,x[1]||"",!0),this.o=ts(x[2]||""),this.g=ts(x[3]||"",!0),Wa(this,x[4]),this.l=ts(x[5]||"",!0),ma(this,x[6]||"",!0),this.m=ts(x[7]||"")):(this.h=!1,this.i=new pa(null,this.h))}kt.prototype.toString=function(){var h=[],x=this.j;x&&h.push(dr(x,Ul,!0),":");var C=this.g;return(C||x=="file")&&(h.push("//"),(x=this.o)&&h.push(dr(x,Ul,!0),"@"),h.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&h.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&h.push("/"),h.push(dr(C,C.charAt(0)=="/"?Ff:Fl,!0))),(C=this.i.toString())&&h.push("?",C),(C=this.m)&&h.push("#",dr(C,co)),h.join("")};function Vn(h){return new kt(h)}function cr(h,x,C){h.j=C?ts(x,!0):x,h.j&&(h.j=h.j.replace(/:$/,""))}function Wa(h,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);h.s=x}else h.s=null}function ma(h,x,C){x instanceof pa?(h.i=x,Gu(h.i,h.h)):(C||(x=dr(x,qf)),h.i=new pa(x,h.h))}function ot(h,x,C){h.i.set(x,C)}function ur(h){return ot(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function ts(h,x){return h?x?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function dr(h,x,C){return typeof h=="string"?(h=encodeURI(h).replace(x,zu),C&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function zu(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ul=/[#\/\?@]/g,Fl=/[#\?:]/g,Ff=/[#\?]/g,qf=/[#\?@]/g,co=/#/g;function pa(h,x){this.h=this.g=null,this.i=h||null,this.j=!!x}function ns(h){h.g||(h.g=new Map,h.h=0,h.i&&Uf(h.i,function(x,C){h.add(decodeURIComponent(x.replace(/\+/g," ")),C)}))}n=pa.prototype,n.add=function(h,x){ns(this),this.i=null,h=Ls(this,h);var C=this.g.get(h);return C||this.g.set(h,C=[]),C.push(x),this.h+=1,this};function ga(h,x){ns(h),x=Ls(h,x),h.g.has(x)&&(h.i=null,h.h-=h.g.get(x).length,h.g.delete(x))}function va(h,x){return ns(h),x=Ls(h,x),h.g.has(x)}n.forEach=function(h,x){ns(this),this.g.forEach(function(C,F){C.forEach(function(K){h.call(x,K,F,this)},this)},this)},n.na=function(){ns(this);const h=Array.from(this.g.values()),x=Array.from(this.g.keys()),C=[];for(let F=0;F<x.length;F++){const K=h[F];for(let ne=0;ne<K.length;ne++)C.push(x[F])}return C},n.V=function(h){ns(this);let x=[];if(typeof h=="string")va(this,h)&&(x=x.concat(this.g.get(Ls(this,h))));else{h=Array.from(this.g.values());for(let C=0;C<h.length;C++)x=x.concat(h[C])}return x},n.set=function(h,x){return ns(this),this.i=null,h=Ls(this,h),va(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[x]),this.h+=1,this},n.get=function(h,x){return h?(h=this.V(h),0<h.length?String(h[0]):x):x};function ql(h,x,C){ga(h,x),0<C.length&&(h.i=null,h.g.set(Ls(h,x),R(C)),h.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],x=Array.from(this.g.keys());for(var C=0;C<x.length;C++){var F=x[C];const ne=encodeURIComponent(String(F)),fe=this.V(F);for(F=0;F<fe.length;F++){var K=ne;fe[F]!==""&&(K+="="+encodeURIComponent(String(fe[F]))),h.push(K)}}return this.i=h.join("&")};function Ls(h,x){return x=String(x),h.j&&(x=x.toLowerCase()),x}function Gu(h,x){x&&!h.j&&(ns(h),h.i=null,h.g.forEach(function(C,F){var K=F.toLowerCase();F!=K&&(ga(this,F),ql(this,K,C))},h)),h.j=x}function hr(h,x){const C=new es;if(f.Image){const F=new Image;F.onload=A(ss,C,"TestLoadImage: loaded",!0,x,F),F.onerror=A(ss,C,"TestLoadImage: error",!1,x,F),F.onabort=A(ss,C,"TestLoadImage: abort",!1,x,F),F.ontimeout=A(ss,C,"TestLoadImage: timeout",!1,x,F),f.setTimeout(function(){F.ontimeout&&F.ontimeout()},1e4),F.src=h}else x(!1)}function xs(h,x){const C=new es,F=new AbortController,K=setTimeout(()=>{F.abort(),ss(C,"TestPingServer: timeout",!1,x)},1e4);fetch(h,{signal:F.signal}).then(ne=>{clearTimeout(K),ne.ok?ss(C,"TestPingServer: ok",!0,x):ss(C,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(K),ss(C,"TestPingServer: error",!1,x)})}function ss(h,x,C,F,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),F(C)}catch{}}function fr(){this.g=new ar}function Vs(h,x,C){const F=C||"";try{Vl(h,function(K,ne){let fe=K;g(K)&&(fe=vs(K)),x.push(F+ne+"="+encodeURIComponent(fe))})}catch(K){throw x.push(F+"type="+encodeURIComponent("_badmap")),K}}function Za(h){this.l=h.Ub||null,this.j=h.eb||!1}T(Za,Sl),Za.prototype.g=function(){return new ya(this.l,this.j)},Za.prototype.i=function(h){return function(){return h}}({});function ya(h,x){At.call(this),this.D=h,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(ya,At),n=ya.prototype,n.open=function(h,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=x,this.readyState=1,Fs(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(x.body=h),(this.D||f).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Us(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Fs(this)),this.g&&(this.readyState=3,Fs(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Hl(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Hl(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var x=h.value?h.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!h.done}))&&(this.response=this.responseText+=x)}h.done?Us(this):Fs(this),this.readyState==3&&Hl(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Us(this))},n.Qa=function(h){this.g&&(this.response=h,Us(this))},n.ga=function(){this.g&&Us(this)};function Us(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Fs(h)}n.setRequestHeader=function(h,x){this.u.append(h,x)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],x=this.h.entries();for(var C=x.next();!C.done;)C=C.value,h.push(C[0]+": "+C[1]),C=x.next();return h.join(`\r
`)};function Fs(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(ya.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Bl(h){let x="";return B(h,function(C,F){x+=F,x+=":",x+=C,x+=`\r
`}),x}function Qt(h,x,C){e:{for(F in C){var F=!1;break e}F=!0}F||(C=Bl(C),typeof h=="string"?C!=null&&encodeURIComponent(String(C)):ot(h,x,C))}function st(h){At.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(st,At);var uo=/^https?$/i,mr=["POST","PUT"];n=st.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,x,C,F){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);x=x?x.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ks.g(),this.v=this.o?Il(this.o):Il(ks),this.g.onreadystatechange=E(this.Ea,this);try{this.B=!0,this.g.open(x,String(h),!0),this.B=!1}catch(ne){$u(this,ne);return}if(h=C||"",C=new Map(this.headers),F)if(Object.getPrototypeOf(F)===Object.prototype)for(var K in F)C.set(K,F[K]);else if(typeof F.keys=="function"&&typeof F.get=="function")for(const ne of F.keys())C.set(ne,F.get(ne));else throw Error("Unknown input type for opt_headers: "+String(F));F=Array.from(C.keys()).find(ne=>ne.toLowerCase()=="content-type"),K=f.FormData&&h instanceof f.FormData,!(0<=Array.prototype.indexOf.call(mr,x,void 0))||F||K||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,fe]of C)this.g.setRequestHeader(ne,fe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{pr(this),this.u=!0,this.g.send(h),this.u=!1}catch(ne){$u(this,ne)}};function $u(h,x){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=x,h.m=5,ho(h),qs(h)}function ho(h){h.A||(h.A=!0,at(h,"complete"),at(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,at(this,"complete"),at(this,"abort"),qs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qs(this,!0)),st.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?fo(this):this.bb())},n.bb=function(){fo(this)};function fo(h){if(h.h&&typeof d<"u"&&(!h.v[1]||as(h)!=4||h.Z()!=2)){if(h.u&&as(h)==4)fn(h.Ea,0,h);else if(at(h,"readystatechange"),as(h)==4){h.h=!1;try{const fe=h.Z();e:switch(fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var C;if(!(C=x)){var F;if(F=fe===0){var K=String(h.D).match(lr)[1]||null;!K&&f.self&&f.self.location&&(K=f.self.location.protocol.slice(0,-1)),F=!uo.test(K?K.toLowerCase():"")}C=F}if(C)at(h,"complete"),at(h,"success");else{h.m=6;try{var ne=2<as(h)?h.g.statusText:""}catch{ne=""}h.l=ne+" ["+h.Z()+"]",ho(h)}}finally{qs(h)}}}}function qs(h,x){if(h.g){pr(h);const C=h.g,F=h.v[0]?()=>{}:null;h.g=null,h.v=null,x||at(h,"ready");try{C.onreadystatechange=F}catch{}}}function pr(h){h.I&&(f.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function as(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<as(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var x=this.g.responseText;return h&&x.indexOf(h)==0&&(x=x.substring(h.length)),no(x)}};function Yu(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Hf(h){const x={};h=(h.g&&2<=as(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let F=0;F<h.length;F++){if(_(h[F]))continue;var C=I(h[F]);const K=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ne=x[K]||[];x[K]=ne,ne.push(C)}L(x,function(F){return F.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function gr(h,x,C){return C&&C.internalChannelParams&&C.internalChannelParams[h]||x}function mo(h){this.Aa=0,this.i=[],this.j=new es,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=gr("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=gr("baseRetryDelayMs",5e3,h),this.cb=gr("retryDelaySeedMs",1e4,h),this.Wa=gr("forwardChannelMaxRetries",2,h),this.wa=gr("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new fa(h&&h.concurrentRequestLimit),this.Da=new fr,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=mo.prototype,n.la=8,n.G=1,n.connect=function(h,x,C,F){bt(0),this.W=h,this.H=x||{},C&&F!==void 0&&(this.H.OSID=C,this.H.OAID=F),this.F=this.X,this.I=ed(this,null,this.W),go(this)};function zl(h){if(Qu(h),h.G==3){var x=h.U++,C=Vn(h.I);if(ot(C,"SID",h.K),ot(C,"RID",x),ot(C,"TYPE","terminate"),vr(h,C),x=new En(h,h.j,x),x.L=2,x.v=ur(Vn(C)),C=!1,f.navigator&&f.navigator.sendBeacon)try{C=f.navigator.sendBeacon(x.v.toString(),"")}catch{}!C&&f.Image&&(new Image().src=x.v,C=!0),C||(x.g=td(x.j,null),x.g.ea(x.v)),x.F=Date.now(),rr(x)}Ju(h)}function po(h){h.g&&(yr(h),h.g.cancel(),h.g=null)}function Qu(h){po(h),h.u&&(f.clearTimeout(h.u),h.u=null),vo(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&f.clearTimeout(h.s),h.s=null)}function go(h){if(!io(h.h)&&!h.s){h.s=!0;var x=h.Ga;ie||G(),ee||(ie(),ee=!0),xe.add(x,h),h.B=0}}function Bf(h,x){return ro(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=x.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Dt(E(h.Ga,h,x),Yl(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const K=new En(this,this.j,h);let ne=this.o;if(this.S&&(ne?(ne=M(ne),U(ne,this.S)):ne=this.S),this.m!==null||this.O||(K.H=ne,ne=null),this.P)e:{for(var x=0,C=0;C<this.i.length;C++){t:{var F=this.i[C];if("__data__"in F.map&&(F=F.map.__data__,typeof F=="string")){F=F.length;break t}F=void 0}if(F===void 0)break;if(x+=F,4096<x){x=C;break e}if(x===4096||C===this.i.length-1){x=C+1;break e}}x=1e3}else x=1e3;x=Ku(this,K,x),C=Vn(this.I),ot(C,"RID",h),ot(C,"CVER",22),this.D&&ot(C,"X-HTTP-Session-Id",this.D),vr(this,C),ne&&(this.O?x="headers="+encodeURIComponent(String(Bl(ne)))+"&"+x:this.m&&Qt(C,this.m,ne)),oo(this.h,K),this.Ua&&ot(C,"TYPE","init"),this.P?(ot(C,"$req",x),ot(C,"SID","null"),K.T=!0,ys(K,C,null)):ys(K,C,x),this.G=2}}else this.G==3&&(h?Gl(this,h):this.i.length==0||io(this.h)||Gl(this))};function Gl(h,x){var C;x?C=x.l:C=h.U++;const F=Vn(h.I);ot(F,"SID",h.K),ot(F,"RID",C),ot(F,"AID",h.T),vr(h,F),h.m&&h.o&&Qt(F,h.m,h.o),C=new En(h,h.j,C,h.B+1),h.m===null&&(C.H=h.o),x&&(h.i=x.D.concat(h.i)),x=Ku(h,C,1e3),C.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),oo(h.h,C),ys(C,F,x)}function vr(h,x){h.H&&B(h.H,function(C,F){ot(x,F,C)}),h.l&&Vl({},function(C,F){ot(x,F,C)})}function Ku(h,x,C){C=Math.min(h.i.length,C);var F=h.l?E(h.l.Na,h.l,h):null;e:{var K=h.i;let ne=-1;for(;;){const fe=["count="+C];ne==-1?0<C?(ne=K[0].g,fe.push("ofs="+ne)):ne=0:fe.push("ofs="+ne);let Ke=!0;for(let qt=0;qt<C;qt++){let Xe=K[qt].g;const Kt=K[qt].map;if(Xe-=ne,0>Xe)ne=Math.max(0,K[qt].g-100),Ke=!1;else try{Vs(Kt,fe,"req"+Xe+"_")}catch{F&&F(Kt)}}if(Ke){F=fe.join("&");break e}}}return h=h.i.splice(0,C),x.D=h,F}function Xu(h){if(!h.g&&!h.u){h.Y=1;var x=h.Fa;ie||G(),ee||(ie(),ee=!0),xe.add(x,h),h.v=0}}function $l(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Dt(E(h.Fa,h),Yl(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,Wu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Dt(E(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bt(10),po(this),Wu(this))};function yr(h){h.A!=null&&(f.clearTimeout(h.A),h.A=null)}function Wu(h){h.g=new En(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var x=Vn(h.qa);ot(x,"RID","rpc"),ot(x,"SID",h.K),ot(x,"AID",h.T),ot(x,"CI",h.F?"0":"1"),!h.F&&h.ja&&ot(x,"TO",h.ja),ot(x,"TYPE","xmlhttp"),vr(h,x),h.m&&h.o&&Qt(x,h.m,h.o),h.L&&(h.g.I=h.L);var C=h.g;h=h.ia,C.L=1,C.v=ur(Vn(x)),C.m=null,C.P=!0,ha(C,h)}n.Za=function(){this.C!=null&&(this.C=null,po(this),$l(this),bt(19))};function vo(h){h.C!=null&&(f.clearTimeout(h.C),h.C=null)}function Zu(h,x){var C=null;if(h.g==x){vo(h),yr(h),h.g=null;var F=2}else if(Pl(h.h,x))C=x.D,jn(h.h,x),F=1;else return;if(h.G!=0){if(x.o)if(F==1){C=x.m?x.m.length:0,x=Date.now()-x.F;var K=h.B;F=$a(),at(F,new Ft(F,C)),go(h)}else Xu(h);else if(K=x.s,K==3||K==0&&0<x.X||!(F==1&&Bf(h,x)||F==2&&$l(h)))switch(C&&0<C.length&&(x=h.h,x.i=x.i.concat(C)),K){case 1:xa(h,5);break;case 4:xa(h,10);break;case 3:xa(h,6);break;default:xa(h,2)}}}function Yl(h,x){let C=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(C*=2),C*x}function xa(h,x){if(h.j.info("Error code "+x),x==2){var C=E(h.fb,h),F=h.Xa;const K=!F;F=new kt(F||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||cr(F,"https"),ur(F),K?hr(F.toString(),C):xs(F.toString(),C)}else bt(2);h.G=0,h.l&&h.l.sa(x),Ju(h),Qu(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function Ju(h){if(h.G=0,h.ka=[],h.l){const x=Ll(h.h);(x.length!=0||h.i.length!=0)&&(b(h.ka,x),b(h.ka,h.i),h.h.i.length=0,R(h.i),h.i.length=0),h.l.ra()}}function ed(h,x,C){var F=C instanceof kt?Vn(C):new kt(C);if(F.g!="")x&&(F.g=x+"."+F.g),Wa(F,F.s);else{var K=f.location;F=K.protocol,x=x?x+"."+K.hostname:K.hostname,K=+K.port;var ne=new kt(null);F&&cr(ne,F),x&&(ne.g=x),K&&Wa(ne,K),C&&(ne.l=C),F=ne}return C=h.D,x=h.ya,C&&x&&ot(F,C,x),ot(F,"VER",h.la),vr(h,F),F}function td(h,x,C){if(x&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=h.Ca&&!h.pa?new st(new Za({eb:C})):new st(h.pa),x.Ha(h.J),x}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function nd(){}n=nd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function yo(){}yo.prototype.g=function(h,x){return new Tn(h,x)};function Tn(h,x){At.call(this),this.g=new mo(x),this.l=h,this.h=x&&x.messageUrlParams||null,h=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(h?h["X-WebChannel-Content-Type"]=x.messageContentType:h={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(h?h["X-WebChannel-Client-Profile"]=x.va:h={"X-WebChannel-Client-Profile":x.va}),this.g.S=h,(h=x&&x.Sb)&&!_(h)&&(this.g.m=h),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!_(x)&&(this.g.D=x,h=this.h,h!==null&&x in h&&(h=this.h,x in h&&delete h[x])),this.j=new Hs(this)}T(Tn,At),Tn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Tn.prototype.close=function(){zl(this.g)},Tn.prototype.o=function(h){var x=this.g;if(typeof h=="string"){var C={};C.__data__=h,h=C}else this.u&&(C={},C.__data__=vs(h),h=C);x.i.push(new Bu(x.Ya++,h)),x.G==3&&go(x)},Tn.prototype.N=function(){this.g.l=null,delete this.j,zl(this.g),delete this.g,Tn.aa.N.call(this)};function sd(h){ua.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var x=h.__sm__;if(x){e:{for(const C in x){h=C;break e}h=void 0}(this.i=h)&&(h=this.i,x=x!==null&&h in x?x[h]:void 0),this.data=x}else this.data=h}T(sd,ua);function ad(){Ml.call(this),this.status=1}T(ad,Ml);function Hs(h){this.g=h}T(Hs,nd),Hs.prototype.ua=function(){at(this.g,"a")},Hs.prototype.ta=function(h){at(this.g,new sd(h))},Hs.prototype.sa=function(h){at(this.g,new ad)},Hs.prototype.ra=function(){at(this.g,"b")},yo.prototype.createWebChannel=yo.prototype.g,Tn.prototype.send=Tn.prototype.o,Tn.prototype.open=Tn.prototype.m,Tn.prototype.close=Tn.prototype.close,tT=function(){return new yo},eT=function(){return $a()},Jj=Ds,vg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ka.NO_ERROR=0,Ka.TIMEOUT=8,Ka.HTTP_ERROR=6,yh=Ka,da.COMPLETE="complete",Zj=da,Rl.EventType=ca,ca.OPEN="a",ca.CLOSE="b",ca.ERROR="c",ca.MESSAGE="d",At.prototype.listen=At.prototype.K,Vc=Rl,st.prototype.listenOnce=st.prototype.L,st.prototype.getLastError=st.prototype.Ka,st.prototype.getLastErrorCode=st.prototype.Ba,st.prototype.getStatus=st.prototype.Z,st.prototype.getResponseJson=st.prototype.Oa,st.prototype.getResponseText=st.prototype.oa,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Ha,Wj=st}).apply(typeof rh<"u"?rh:typeof self<"u"?self:typeof window<"u"?window:{});const m_="@firebase/firestore",p_="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yn.UNAUTHENTICATED=new yn(null),yn.GOOGLE_CREDENTIALS=new yn("google-credentials-uid"),yn.FIRST_PARTY=new yn("first-party-uid"),yn.MOCK_USER=new yn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yl="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr=new gu("@firebase/firestore");function Ko(){return zr.logLevel}function ve(n,...e){if(zr.logLevel<=Ye.DEBUG){const t=e.map(nv);zr.debug(`Firestore (${yl}): ${n}`,...t)}}function qa(n,...e){if(zr.logLevel<=Ye.ERROR){const t=e.map(nv);zr.error(`Firestore (${yl}): ${n}`,...t)}}function ki(n,...e){if(zr.logLevel<=Ye.WARN){const t=e.map(nv);zr.warn(`Firestore (${yl}): ${n}`,...t)}}function nv(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function je(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,nT(n,i,t)}function nT(n,e,t){let i=`FIRESTORE (${yl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw qa(i),new Error(i)}function Je(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||nT(e,o,i)}function Oe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends gs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Q1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(yn.UNAUTHENTICATED))}shutdown(){}}class K1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class X1{constructor(e){this.t=e,this.currentUser=yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Je(this.o===void 0,42304);let i=this.i;const o=p=>this.i!==i?(i=this.i,t(p)):Promise.resolve();let c=new ea;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new ea,e.enqueueRetryable(()=>o(this.currentUser))};const d=()=>{const p=c;e.enqueueRetryable(async()=>{await p.promise,await o(this.currentUser)})},f=p=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit(p=>f(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new ea)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Je(typeof i.accessToken=="string",31837,{l:i}),new sT(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Je(e===null||typeof e=="string",2055,{h:e}),new yn(e)}}class W1{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=yn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Z1{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new W1(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(yn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class g_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class J1{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,On(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Je(this.o===void 0,3512);const i=c=>{c.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,ve("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>i(c))};const o=c=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>o(c)),setTimeout(()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new g_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Je(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new g_(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eM(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aT(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=eM(40);for(let c=0;c<o.length;++c)i.length<20&&o[c]<t&&(i+=e.charAt(o[c]%62))}return i}}function Be(n,e){return n<e?-1:n>e?1:0}function yg(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=n.codePointAt(t),o=e.codePointAt(t);if(i!==o){if(i<128&&o<128)return Be(i,o);{const c=aT(),d=tM(c.encode(v_(n,t)),c.encode(v_(e,t)));return d!==0?d:Be(i,o)}}t+=i>65535?2:1}return Be(n.length,e.length)}function v_(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function tM(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Be(n[t],e[t]);return Be(n.length,e.length)}function ll(n,e,t){return n.length===e.length&&n.every((i,o)=>t(i,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y_="__name__";class Xs{constructor(e,t,i){t===void 0?t=0:t>e.length&&je(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&je(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Xs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Xs?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const c=Xs.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Be(e.length,t.length)}static compareSegments(e,t){const i=Xs.isNumericId(e),o=Xs.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?Xs.extractNumericId(e).compare(Xs.extractNumericId(t)):yg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Si.fromString(e.substring(4,e.length-2))}}class dt extends Xs{construct(e,t,i){return new dt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new me(ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(o=>o.length>0))}return new dt(t)}static emptyPath(){return new dt([])}}const nM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class un extends Xs{construct(e,t,i){return new un(e,t,i)}static isValidIdentifier(e){return nM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),un.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===y_}static keyField(){return new un([y_])}static fromServerFormat(e){const t=[];let i="",o=0;const c=()=>{if(i.length===0)throw new me(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;o<e.length;){const f=e[o];if(f==="\\"){if(o+1===e.length)throw new me(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new me(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=p,o+=2}else f==="`"?(d=!d,o++):f!=="."||d?(i+=f,o++):(c(),o++)}if(c(),d)throw new me(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new un(t)}static emptyPath(){return new un([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.path=e}static fromPath(e){return new _e(dt.fromString(e))}static fromName(e){return new _e(dt.fromString(e).popFirst(5))}static empty(){return new _e(dt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&dt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return dt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _e(new dt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iT(n,e,t){if(!t)throw new me(ae.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function sM(n,e,t,i){if(e===!0&&i===!0)throw new me(ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function x_(n){if(!_e.isDocumentKey(n))throw new me(ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function N_(n){if(_e.isDocumentKey(n))throw new me(ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function rT(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function rf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":je(12329,{type:typeof n})}function Sn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=rf(n);throw new me(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ut(n,e){const t={typeString:n};return e&&(t.value=e),t}function _u(n,e){if(!rT(n))throw new me(ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,c="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(o&&typeof d!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(c!==void 0&&d!==c.value){t=`Expected '${i}' field to equal '${c.value}'`;break}}if(t)throw new me(ae.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b_=-62135596800,__=1e6;class xt{static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*__);return new xt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<b_)throw new me(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/__}_compareTo(e){return this.seconds===e.seconds?Be(this.nanoseconds,e.nanoseconds):Be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(_u(e,xt._jsonSchema))return new xt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-b_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xt._jsonSchemaVersion="firestore/timestamp/1.0",xt._jsonSchema={type:Ut("string",xt._jsonSchemaVersion),seconds:Ut("number"),nanoseconds:Ut("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{static fromTimestamp(e){return new we(e)}static min(){return new we(new xt(0,0))}static max(){return new we(new xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su=-1;function aM(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=we.fromTimestamp(i===1e9?new xt(t+1,0):new xt(t,i));return new Oi(o,_e.empty(),e)}function iM(n){return new Oi(n.readTime,n.key,su)}class Oi{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Oi(we.min(),_e.empty(),su)}static max(){return new Oi(we.max(),_e.empty(),su)}}function rM(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=_e.comparator(n.documentKey,e.documentKey),t!==0?t:Be(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xl(n){if(n.code!==ae.FAILED_PRECONDITION||n.message!==oM)throw n;ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&je(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le((i,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(i,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(i,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):le.reject(t)}static resolve(e){return new le((t,i)=>{t(e)})}static reject(e){return new le((t,i)=>{i(e)})}static waitFor(e){return new le((t,i)=>{let o=0,c=0,d=!1;e.forEach(f=>{++o,f.next(()=>{++c,d&&c===o&&t()},p=>i(p))}),d=!0,c===o&&t()})}static or(e){let t=le.resolve(!1);for(const i of e)t=t.next(o=>o?le.resolve(o):i());return t}static forEach(e,t){const i=[];return e.forEach((o,c)=>{i.push(t.call(this,o,c))}),this.waitFor(i)}static mapArray(e,t){return new le((i,o)=>{const c=e.length,d=new Array(c);let f=0;for(let p=0;p<c;p++){const g=p;t(e[g]).next(y=>{d[g]=y,++f,f===c&&i(d)},y=>o(y))}})}static doWhile(e,t){return new le((i,o)=>{const c=()=>{e()===!0?t().next(()=>{c()},o):i()};c()})}}function cM(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Nl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this._e(i),this.ae=i=>t.writeSequenceNumber(i))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}of.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const av=-1;function Eu(n){return n==null}function kh(n){return n===0&&1/n==-1/0}function uM(n){return typeof n=="number"&&Number.isInteger(n)&&!kh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT="";function dM(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=E_(e)),e=hM(n.get(t),e);return E_(e)}function hM(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case oT:t+="";break;default:t+=c}}return t}function E_(n){return n+oT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j_(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Qi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function lT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,t){this.comparator=e,this.root=t||cn.EMPTY}insert(e,t){return new Tt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cn.BLACK,null,null))}remove(e){return new Tt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new oh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new oh(this.root,e,this.comparator,!1)}getReverseIterator(){return new oh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new oh(this.root,e,this.comparator,!0)}}class oh{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?i(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cn{constructor(e,t,i,o,c){this.key=e,this.value=t,this.color=i??cn.RED,this.left=o??cn.EMPTY,this.right=c??cn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,c){return new cn(e??this.key,t??this.value,i??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const c=i(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,i),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return cn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return cn.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw je(43730,{key:this.key,value:this.value});if(this.right.isRed())throw je(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw je(27949);return e+(this.isRed()?0:1)}}cn.EMPTY=null,cn.RED=!0,cn.BLACK=!1;cn.EMPTY=new class{constructor(){this.size=0}get key(){throw je(57766)}get value(){throw je(16141)}get color(){throw je(16727)}get left(){throw je(29726)}get right(){throw je(36894)}copy(e,t,i,o,c){return this}insert(e,t,i){return new cn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.comparator=e,this.data=new Tt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new T_(this.data.getIterator())}getIteratorFrom(e){return new T_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof Gt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Gt(this.comparator);return t.data=e,t}}class T_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this.fields=e,e.sort(un.comparator)}static empty(){return new Yn([])}unionWith(e){let t=new Gt(un.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Yn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ll(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new cT("Invalid base64 string: "+c):c}}(e);return new hn(t)}static fromUint8Array(e){const t=function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c}(e);return new hn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}hn.EMPTY_BYTE_STRING=new hn("");const fM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pi(n){if(Je(!!n,39018),typeof n=="string"){let e=0;const t=fM.exec(n);if(Je(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Mt(n.seconds),nanos:Mt(n.nanos)}}function Mt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Li(n){return typeof n=="string"?hn.fromBase64String(n):hn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uT="server_timestamp",dT="__type__",hT="__previous_value__",fT="__local_write_time__";function iv(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[dT])===null||t===void 0?void 0:t.stringValue)===uT}function lf(n){const e=n.mapValue.fields[hT];return iv(e)?lf(e):e}function au(n){const e=Pi(n.mapValue.fields[fT].timestampValue);return new xt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM{constructor(e,t,i,o,c,d,f,p,g,y){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=g,this.isUsingEmulator=y}}const Oh="(default)";class iu{constructor(e,t){this.projectId=e,this.database=t||Oh}static empty(){return new iu("","")}get isDefaultDatabase(){return this.database===Oh}isEqual(e){return e instanceof iu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="__type__",pM="__max__",lh={mapValue:{}},pT="__vector__",Ph="value";function Vi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?iv(n)?4:vM(n)?9007199254740991:gM(n)?10:11:je(28295,{value:n})}function aa(n,e){if(n===e)return!0;const t=Vi(n);if(t!==Vi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return au(n).isEqual(au(e));case 3:return function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=Pi(o.timestampValue),f=Pi(c.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,c){return Li(o.bytesValue).isEqual(Li(c.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,c){return Mt(o.geoPointValue.latitude)===Mt(c.geoPointValue.latitude)&&Mt(o.geoPointValue.longitude)===Mt(c.geoPointValue.longitude)}(n,e);case 2:return function(o,c){if("integerValue"in o&&"integerValue"in c)return Mt(o.integerValue)===Mt(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=Mt(o.doubleValue),f=Mt(c.doubleValue);return d===f?kh(d)===kh(f):isNaN(d)&&isNaN(f)}return!1}(n,e);case 9:return ll(n.arrayValue.values||[],e.arrayValue.values||[],aa);case 10:case 11:return function(o,c){const d=o.mapValue.fields||{},f=c.mapValue.fields||{};if(j_(d)!==j_(f))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(f[p]===void 0||!aa(d[p],f[p])))return!1;return!0}(n,e);default:return je(52216,{left:n})}}function ru(n,e){return(n.values||[]).find(t=>aa(t,e))!==void 0}function cl(n,e){if(n===e)return 0;const t=Vi(n),i=Vi(e);if(t!==i)return Be(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Be(n.booleanValue,e.booleanValue);case 2:return function(c,d){const f=Mt(c.integerValue||c.doubleValue),p=Mt(d.integerValue||d.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1}(n,e);case 3:return A_(n.timestampValue,e.timestampValue);case 4:return A_(au(n),au(e));case 5:return yg(n.stringValue,e.stringValue);case 6:return function(c,d){const f=Li(c),p=Li(d);return f.compareTo(p)}(n.bytesValue,e.bytesValue);case 7:return function(c,d){const f=c.split("/"),p=d.split("/");for(let g=0;g<f.length&&g<p.length;g++){const y=Be(f[g],p[g]);if(y!==0)return y}return Be(f.length,p.length)}(n.referenceValue,e.referenceValue);case 8:return function(c,d){const f=Be(Mt(c.latitude),Mt(d.latitude));return f!==0?f:Be(Mt(c.longitude),Mt(d.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return C_(n.arrayValue,e.arrayValue);case 10:return function(c,d){var f,p,g,y;const N=c.fields||{},E=d.fields||{},A=(f=N[Ph])===null||f===void 0?void 0:f.arrayValue,T=(p=E[Ph])===null||p===void 0?void 0:p.arrayValue,R=Be(((g=A?.values)===null||g===void 0?void 0:g.length)||0,((y=T?.values)===null||y===void 0?void 0:y.length)||0);return R!==0?R:C_(A,T)}(n.mapValue,e.mapValue);case 11:return function(c,d){if(c===lh.mapValue&&d===lh.mapValue)return 0;if(c===lh.mapValue)return 1;if(d===lh.mapValue)return-1;const f=c.fields||{},p=Object.keys(f),g=d.fields||{},y=Object.keys(g);p.sort(),y.sort();for(let N=0;N<p.length&&N<y.length;++N){const E=yg(p[N],y[N]);if(E!==0)return E;const A=cl(f[p[N]],g[y[N]]);if(A!==0)return A}return Be(p.length,y.length)}(n.mapValue,e.mapValue);default:throw je(23264,{le:t})}}function A_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Be(n,e);const t=Pi(n),i=Pi(e),o=Be(t.seconds,i.seconds);return o!==0?o:Be(t.nanos,i.nanos)}function C_(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const c=cl(t[o],i[o]);if(c)return c}return Be(t.length,i.length)}function ul(n){return xg(n)}function xg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=Pi(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Li(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return _e.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",o=!0;for(const c of t.values||[])o?o=!1:i+=",",i+=xg(c);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of i)c?c=!1:o+=",",o+=`${d}:${xg(t.fields[d])}`;return o+"}"}(n.mapValue):je(61005,{value:n})}function xh(n){switch(Vi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lf(n);return e?16+xh(e):16;case 5:return 2*n.stringValue.length;case 6:return Li(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((o,c)=>o+xh(c),0)}(n.arrayValue);case 10:case 11:return function(i){let o=0;return Qi(i.fields,(c,d)=>{o+=c.length+xh(d)}),o}(n.mapValue);default:throw je(13486,{value:n})}}function w_(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Ng(n){return!!n&&"integerValue"in n}function rv(n){return!!n&&"arrayValue"in n}function S_(n){return!!n&&"nullValue"in n}function I_(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Nh(n){return!!n&&"mapValue"in n}function gM(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[mT])===null||t===void 0?void 0:t.stringValue)===pT}function zc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Qi(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=zc(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=zc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function vM(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===pM}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.value=e}static empty(){return new wn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Nh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=zc(t)}setAll(e){let t=un.emptyPath(),i={},o=[];e.forEach((d,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,i,o),i={},o=[],t=f.popLast()}d?i[f.lastSegment()]=zc(d):o.push(f.lastSegment())});const c=this.getFieldsMap(t);this.applyChanges(c,i,o)}delete(e){const t=this.field(e.popLast());Nh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return aa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];Nh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Qi(t,(o,c)=>e[o]=c);for(const o of i)delete e[o]}clone(){return new wn(zc(this.value))}}function gT(n){const e=[];return Qi(n.fields,(t,i)=>{const o=new un([t]);if(Nh(i)){const c=gT(i.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)}),new Yn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,t,i,o,c,d,f){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=c,this.data=d,this.documentState=f}static newInvalidDocument(e){return new en(e,0,we.min(),we.min(),we.min(),wn.empty(),0)}static newFoundDocument(e,t,i,o){return new en(e,1,t,we.min(),i,o,0)}static newNoDocument(e,t){return new en(e,2,t,we.min(),we.min(),wn.empty(),0)}static newUnknownDocument(e,t){return new en(e,3,t,we.min(),we.min(),wn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(we.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=wn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=wn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof en&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new en(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e,t){this.position=e,this.inclusive=t}}function R_(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?i=_e.comparator(_e.fromName(d.referenceValue),t.key):i=cl(d,t.data.field(c.field)),c.dir==="desc"&&(i*=-1),i!==0)break}return i}function M_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!aa(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,t="asc"){this.field=e,this.dir=t}}function yM(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{}class Vt extends vT{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new NM(e,t,i):t==="array-contains"?new EM(e,i):t==="in"?new jM(e,i):t==="not-in"?new TM(e,i):t==="array-contains-any"?new AM(e,i):new Vt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new bM(e,i):new _M(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(cl(t,this.value)):t!==null&&Vi(this.value)===Vi(t)&&this.matchesComparison(cl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return je(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Is extends vT{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Is(e,t)}matches(e){return yT(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function yT(n){return n.op==="and"}function xT(n){return xM(n)&&yT(n)}function xM(n){for(const e of n.filters)if(e instanceof Is)return!1;return!0}function bg(n){if(n instanceof Vt)return n.field.canonicalString()+n.op.toString()+ul(n.value);if(xT(n))return n.filters.map(e=>bg(e)).join(",");{const e=n.filters.map(t=>bg(t)).join(",");return`${n.op}(${e})`}}function NT(n,e){return n instanceof Vt?function(i,o){return o instanceof Vt&&i.op===o.op&&i.field.isEqual(o.field)&&aa(i.value,o.value)}(n,e):n instanceof Is?function(i,o){return o instanceof Is&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce((c,d,f)=>c&&NT(d,o.filters[f]),!0):!1}(n,e):void je(19439)}function bT(n){return n instanceof Vt?function(t){return`${t.field.canonicalString()} ${t.op} ${ul(t.value)}`}(n):n instanceof Is?function(t){return t.op.toString()+" {"+t.getFilters().map(bT).join(" ,")+"}"}(n):"Filter"}class NM extends Vt{constructor(e,t,i){super(e,t,i),this.key=_e.fromName(i.referenceValue)}matches(e){const t=_e.comparator(e.key,this.key);return this.matchesComparison(t)}}class bM extends Vt{constructor(e,t){super(e,"in",t),this.keys=_T("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class _M extends Vt{constructor(e,t){super(e,"not-in",t),this.keys=_T("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function _T(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>_e.fromName(i.referenceValue))}class EM extends Vt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return rv(t)&&ru(t.arrayValue,this.value)}}class jM extends Vt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ru(this.value.arrayValue,t)}}class TM extends Vt{constructor(e,t){super(e,"not-in",t)}matches(e){if(ru(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ru(this.value.arrayValue,t)}}class AM extends Vt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!rv(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>ru(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CM{constructor(e,t=null,i=[],o=[],c=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=c,this.startAt=d,this.endAt=f,this.Pe=null}}function D_(n,e=null,t=[],i=[],o=null,c=null,d=null){return new CM(n,e,t,i,o,c,d)}function ov(n){const e=Oe(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>bg(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(c){return c.field.canonicalString()+c.dir}(i)).join(","),Eu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>ul(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>ul(i)).join(",")),e.Pe=t}return e.Pe}function lv(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!yM(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!NT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!M_(n.startAt,e.startAt)&&M_(n.endAt,e.endAt)}function _g(n){return _e.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e,t=null,i=[],o=[],c=null,d="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=c,this.limitType=d,this.startAt=f,this.endAt=p,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function wM(n,e,t,i,o,c,d,f){return new bl(n,e,t,i,o,c,d,f)}function cf(n){return new bl(n)}function k_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ET(n){return n.collectionGroup!==null}function Gc(n){const e=Oe(n);if(e.Te===null){e.Te=[];const t=new Set;for(const c of e.explicitOrderBy)e.Te.push(c),t.add(c.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new Gt(un.comparator);return d.filters.forEach(p=>{p.getFlattenedFilters().forEach(g=>{g.isInequality()&&(f=f.add(g.field))})}),f})(e).forEach(c=>{t.has(c.canonicalString())||c.isKeyField()||e.Te.push(new ou(c,i))}),t.has(un.keyField().canonicalString())||e.Te.push(new ou(un.keyField(),i))}return e.Te}function ta(n){const e=Oe(n);return e.Ie||(e.Ie=SM(e,Gc(n))),e.Ie}function SM(n,e){if(n.limitType==="F")return D_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const c=o.dir==="desc"?"asc":"desc";return new ou(o.field,c)});const t=n.endAt?new Lh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Lh(n.startAt.position,n.startAt.inclusive):null;return D_(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Eg(n,e){const t=n.filters.concat([e]);return new bl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Vh(n,e,t){return new bl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function uf(n,e){return lv(ta(n),ta(e))&&n.limitType===e.limitType}function jT(n){return`${ov(ta(n))}|lt:${n.limitType}`}function Xo(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(o=>bT(o)).join(", ")}]`),Eu(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(o=>function(d){return`${d.field.canonicalString()} (${d.dir})`}(o)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(o=>ul(o)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(o=>ul(o)).join(",")),`Target(${i})`}(ta(n))}; limitType=${n.limitType})`}function df(n,e){return e.isFoundDocument()&&function(i,o){const c=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(c):_e.isDocumentKey(i.path)?i.path.isEqual(c):i.path.isImmediateParentOf(c)}(n,e)&&function(i,o){for(const c of Gc(i))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0}(n,e)&&function(i,o){for(const c of i.filters)if(!c.matches(o))return!1;return!0}(n,e)&&function(i,o){return!(i.startAt&&!function(d,f,p){const g=R_(d,f,p);return d.inclusive?g<=0:g<0}(i.startAt,Gc(i),o)||i.endAt&&!function(d,f,p){const g=R_(d,f,p);return d.inclusive?g>=0:g>0}(i.endAt,Gc(i),o))}(n,e)}function IM(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function TT(n){return(e,t)=>{let i=!1;for(const o of Gc(n)){const c=RM(o,e,t);if(c!==0)return c;i=i||o.field.isKeyField()}return 0}}function RM(n,e,t){const i=n.field.isKeyField()?_e.comparator(e.key,t.key):function(c,d,f){const p=d.data.field(c),g=f.data.field(c);return p!==null&&g!==null?cl(p,g):je(42886)}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return je(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,c]of i)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Qi(this.inner,(t,i)=>{for(const[o,c]of i)e(o,c)})}isEmpty(){return lT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM=new Tt(_e.comparator);function Ha(){return MM}const AT=new Tt(_e.comparator);function Uc(...n){let e=AT;for(const t of n)e=e.insert(t.key,t);return e}function CT(n){let e=AT;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Pr(){return $c()}function wT(){return $c()}function $c(){return new Xr(n=>n.toString(),(n,e)=>n.isEqual(e))}const DM=new Tt(_e.comparator),kM=new Gt(_e.comparator);function Qe(...n){let e=kM;for(const t of n)e=e.add(t);return e}const OM=new Gt(Be);function PM(){return OM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kh(e)?"-0":e}}function ST(n){return{integerValue:""+n}}function LM(n,e){return uM(e)?ST(e):cv(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(){this._=void 0}}function VM(n,e,t){return n instanceof lu?function(o,c){const d={fields:{[dT]:{stringValue:uT},[fT]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&iv(c)&&(c=lf(c)),c&&(d.fields[hT]=c),{mapValue:d}}(t,e):n instanceof cu?RT(n,e):n instanceof uu?MT(n,e):function(o,c){const d=IT(o,c),f=O_(d)+O_(o.Ee);return Ng(d)&&Ng(o.Ee)?ST(f):cv(o.serializer,f)}(n,e)}function UM(n,e,t){return n instanceof cu?RT(n,e):n instanceof uu?MT(n,e):t}function IT(n,e){return n instanceof Uh?function(i){return Ng(i)||function(c){return!!c&&"doubleValue"in c}(i)}(e)?e:{integerValue:0}:null}class lu extends hf{}class cu extends hf{constructor(e){super(),this.elements=e}}function RT(n,e){const t=DT(e);for(const i of n.elements)t.some(o=>aa(o,i))||t.push(i);return{arrayValue:{values:t}}}class uu extends hf{constructor(e){super(),this.elements=e}}function MT(n,e){let t=DT(e);for(const i of n.elements)t=t.filter(o=>!aa(o,i));return{arrayValue:{values:t}}}class Uh extends hf{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function O_(n){return Mt(n.integerValue||n.doubleValue)}function DT(n){return rv(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{constructor(e,t){this.field=e,this.transform=t}}function qM(n,e){return n.field.isEqual(e.field)&&function(i,o){return i instanceof cu&&o instanceof cu||i instanceof uu&&o instanceof uu?ll(i.elements,o.elements,aa):i instanceof Uh&&o instanceof Uh?aa(i.Ee,o.Ee):i instanceof lu&&o instanceof lu}(n.transform,e.transform)}class HM{constructor(e,t){this.version=e,this.transformResults=t}}class dn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new dn}static exists(e){return new dn(void 0,e)}static updateTime(e){return new dn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class ff{}function kT(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new mf(n.key,dn.none()):new ju(n.key,n.data,dn.none());{const t=n.data,i=wn.empty();let o=new Gt(un.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?i.delete(c):i.set(c,d),o=o.add(c)}return new Ki(n.key,i,new Yn(o.toArray()),dn.none())}}function BM(n,e,t){n instanceof ju?function(o,c,d){const f=o.value.clone(),p=L_(o.fieldTransforms,c,d.transformResults);f.setAll(p),c.convertToFoundDocument(d.version,f).setHasCommittedMutations()}(n,e,t):n instanceof Ki?function(o,c,d){if(!bh(o.precondition,c))return void c.convertToUnknownDocument(d.version);const f=L_(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(OT(o)),p.setAll(f),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()}(n,e,t):function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()}(0,e,t)}function Yc(n,e,t,i){return n instanceof ju?function(c,d,f,p){if(!bh(c.precondition,d))return f;const g=c.value.clone(),y=V_(c.fieldTransforms,p,d);return g.setAll(y),d.convertToFoundDocument(d.version,g).setHasLocalMutations(),null}(n,e,t,i):n instanceof Ki?function(c,d,f,p){if(!bh(c.precondition,d))return f;const g=V_(c.fieldTransforms,p,d),y=d.data;return y.setAll(OT(c)),y.setAll(g),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),f===null?null:f.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(N=>N.field))}(n,e,t,i):function(c,d,f){return bh(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f}(n,e,t)}function zM(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),c=IT(i.transform,o||null);c!=null&&(t===null&&(t=wn.empty()),t.set(i.field,c))}return t||null}function P_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&ll(i,o,(c,d)=>qM(c,d))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ju extends ff{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Ki extends ff{constructor(e,t,i,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function OT(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function L_(n,e,t){const i=new Map;Je(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,f=e.data.field(c.field);i.set(c.field,UM(d,f,t[o]))}return i}function V_(n,e,t){const i=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);i.set(o.field,VM(c,d,e))}return i}class mf extends ff{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class PT extends ff{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&BM(c,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Yc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Yc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=wT();return this.mutations.forEach(o=>{const c=e.get(o.key),d=c.overlayedDocument;let f=this.applyToLocalView(d,c.mutatedFields);f=t.has(o.key)?null:f;const p=kT(d,f);p!==null&&i.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(we.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Qe())}isEqual(e){return this.batchId===e.batchId&&ll(this.mutations,e.mutations,(t,i)=>P_(t,i))&&ll(this.baseMutations,e.baseMutations,(t,i)=>P_(t,i))}}class uv{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){Je(e.mutations.length===i.length,58842,{Ve:e.mutations.length,me:i.length});let o=function(){return DM}();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,i[d].version);return new uv(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lt,Ze;function LT(n){switch(n){case ae.OK:return je(64938);case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return je(15467,{code:n})}}function VT(n){if(n===void 0)return qa("GRPC error has no .code"),ae.UNKNOWN;switch(n){case Lt.OK:return ae.OK;case Lt.CANCELLED:return ae.CANCELLED;case Lt.UNKNOWN:return ae.UNKNOWN;case Lt.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case Lt.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case Lt.INTERNAL:return ae.INTERNAL;case Lt.UNAVAILABLE:return ae.UNAVAILABLE;case Lt.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case Lt.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case Lt.NOT_FOUND:return ae.NOT_FOUND;case Lt.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case Lt.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case Lt.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case Lt.ABORTED:return ae.ABORTED;case Lt.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case Lt.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case Lt.DATA_LOSS:return ae.DATA_LOSS;default:return je(39323,{code:n})}}(Ze=Lt||(Lt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QM=new Si([4294967295,4294967295],0);function U_(n){const e=aT().encode(n),t=new Xj;return t.update(e),new Uint8Array(t.digest())}function F_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new Si([t,i],0),new Si([o,c],0)]}class dv{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Fc(`Invalid padding: ${t}`);if(i<0)throw new Fc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Fc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Fc(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Si.fromNumber(this.fe)}pe(e,t,i){let o=e.add(t.multiply(Si.fromNumber(i)));return o.compare(QM)===1&&(o=new Si([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=U_(e),[i,o]=F_(t);for(let c=0;c<this.hashCount;c++){const d=this.pe(i,o,c);if(!this.ye(d))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new dv(c,o,t);return i.forEach(f=>d.insert(f)),d}insert(e){if(this.fe===0)return;const t=U_(e),[i,o]=F_(t);for(let c=0;c<this.hashCount;c++){const d=this.pe(i,o,c);this.we(d)}}we(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Fc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,t,i,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,Tu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new pf(we.min(),o,new Tt(Be),Ha(),Qe())}}class Tu{constructor(e,t,i,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Tu(i,t,Qe(),Qe(),Qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(e,t,i,o){this.Se=e,this.removedTargetIds=t,this.key=i,this.be=o}}class UT{constructor(e,t){this.targetId=e,this.De=t}}class FT{constructor(e,t,i=hn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class q_{constructor(){this.ve=0,this.Ce=H_(),this.Fe=hn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Qe(),t=Qe(),i=Qe();return this.Ce.forEach((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:je(38017,{changeType:c})}}),new Tu(this.Fe,this.Me,e,t,i)}ke(){this.xe=!1,this.Ce=H_()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Je(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class KM{constructor(e){this.We=e,this.Ge=new Map,this.ze=Ha(),this.je=ch(),this.Je=ch(),this.He=new Tt(Be)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const i=this.tt(t);switch(e.state){case 0:this.nt(t)&&i.Be(e.resumeToken);break;case 1:i.Ue(),i.Oe||i.ke(),i.Be(e.resumeToken);break;case 2:i.Ue(),i.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(i.Ke(),i.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),i.Be(e.resumeToken));break;default:je(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((i,o)=>{this.nt(o)&&t(o)})}it(e){const t=e.targetId,i=e.De.count,o=this.st(t);if(o){const c=o.target;if(_g(c))if(i===0){const d=new _e(c.path);this.Xe(t,d,en.newNoDocument(d,we.min()))}else Je(i===1,20013,{expectedCount:i});else{const d=this.ot(t);if(d!==i){const f=this._t(e),p=f?this.ut(f,e,d):1;if(p!==0){this.rt(t);const g=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,g)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:c=0}=t;let d,f;try{d=Li(i).toUint8Array()}catch(p){if(p instanceof cT)return ki("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new dv(d,o,c)}catch(p){return ki(p instanceof Fc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.fe===0?null:f}ut(e,t,i){return t.De.count===i-this.ht(e,t.targetId)?0:2}ht(e,t){const i=this.We.getRemoteKeysForTarget(t);let o=0;return i.forEach(c=>{const d=this.We.lt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,c,null),o++)}),o}Pt(e){const t=new Map;this.Ge.forEach((c,d)=>{const f=this.st(d);if(f){if(c.current&&_g(f.target)){const p=new _e(f.target.path);this.Tt(p).has(d)||this.It(d,p)||this.Xe(d,p,en.newNoDocument(p,e))}c.Ne&&(t.set(d,c.Le()),c.ke())}});let i=Qe();this.Je.forEach((c,d)=>{let f=!0;d.forEachWhile(p=>{const g=this.st(p);return!g||g.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)}),f&&(i=i.add(c))}),this.ze.forEach((c,d)=>d.setReadTime(e));const o=new pf(e,t,this.He,this.ze,i);return this.ze=Ha(),this.je=ch(),this.Je=ch(),this.He=new Tt(Be),o}Ze(e,t){if(!this.nt(e))return;const i=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,i),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,i){if(!this.nt(e))return;const o=this.tt(e);this.It(e,t)?o.qe(t,1):o.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),i&&(this.ze=this.ze.insert(t,i))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new q_,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Gt(Be),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Gt(Be),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||ve("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new q_),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function ch(){return new Tt(_e.comparator)}function H_(){return new Tt(_e.comparator)}const XM={asc:"ASCENDING",desc:"DESCENDING"},WM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ZM={and:"AND",or:"OR"};class JM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function jg(n,e){return n.useProto3Json||Eu(e)?e:{value:e}}function Fh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function eD(n,e){return Fh(n,e.toTimestamp())}function Kn(n){return Je(!!n,49232),we.fromTimestamp(function(t){const i=Pi(t);return new xt(i.seconds,i.nanos)}(n))}function hv(n,e){return Tg(n,e).canonicalString()}function Tg(n,e){const t=function(o){return new dt(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function HT(n){const e=dt.fromString(n);return Je(QT(e),10190,{key:e.toString()}),e}function qh(n,e){return hv(n.databaseId,e.path)}function Qc(n,e){const t=HT(e);if(t.get(1)!==n.databaseId.projectId)throw new me(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new _e(zT(t))}function BT(n,e){return hv(n.databaseId,e)}function tD(n){const e=HT(n);return e.length===4?dt.emptyPath():zT(e)}function Ag(n){return new dt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function zT(n){return Je(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function B_(n,e,t){return{name:qh(n,e),fields:t.value.mapValue.fields}}function nD(n,e){return"found"in e?function(i,o){Je(!!o.found,43571),o.found.name,o.found.updateTime;const c=Qc(i,o.found.name),d=Kn(o.found.updateTime),f=o.found.createTime?Kn(o.found.createTime):we.min(),p=new wn({mapValue:{fields:o.found.fields}});return en.newFoundDocument(c,d,f,p)}(n,e):"missing"in e?function(i,o){Je(!!o.missing,3894),Je(!!o.readTime,22933);const c=Qc(i,o.missing),d=Kn(o.readTime);return en.newNoDocument(c,d)}(n,e):je(7234,{result:e})}function sD(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:je(39313,{state:g})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=function(g,y){return g.useProto3Json?(Je(y===void 0||typeof y=="string",58123),hn.fromBase64String(y||"")):(Je(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),hn.fromUint8Array(y||new Uint8Array))}(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&function(g){const y=g.code===void 0?ae.UNKNOWN:VT(g.code);return new me(y,g.message||"")}(d);t=new FT(i,o,c,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=Qc(n,i.document.name),c=Kn(i.document.updateTime),d=i.document.createTime?Kn(i.document.createTime):we.min(),f=new wn({mapValue:{fields:i.document.fields}}),p=en.newFoundDocument(o,c,d,f),g=i.targetIds||[],y=i.removedTargetIds||[];t=new _h(g,y,p.key,p)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=Qc(n,i.document),c=i.readTime?Kn(i.readTime):we.min(),d=en.newNoDocument(o,c),f=i.removedTargetIds||[];t=new _h([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=Qc(n,i.document),c=i.removedTargetIds||[];t=new _h([],c,o,null)}else{if(!("filter"in e))return je(11601,{At:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:c}=i,d=new YM(o,c),f=i.targetId;t=new UT(f,d)}}return t}function GT(n,e){let t;if(e instanceof ju)t={update:B_(n,e.key,e.value)};else if(e instanceof mf)t={delete:qh(n,e.key)};else if(e instanceof Ki)t={update:B_(n,e.key,e.data),updateMask:hD(e.fieldMask)};else{if(!(e instanceof PT))return je(16599,{Rt:e.type});t={verify:qh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(c,d){const f=d.transform;if(f instanceof lu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof cu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof uu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Uh)return{fieldPath:d.field.canonicalString(),increment:f.Ee};throw je(20930,{transform:d.transform})}(0,i))),e.precondition.isNone||(t.currentDocument=function(o,c){return c.updateTime!==void 0?{updateTime:eD(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:je(27497)}(n,e.precondition)),t}function aD(n,e){return n&&n.length>0?(Je(e!==void 0,14353),n.map(t=>function(o,c){let d=o.updateTime?Kn(o.updateTime):Kn(c);return d.isEqual(we.min())&&(d=Kn(c)),new HM(d,o.transformResults||[])}(t,e))):[]}function iD(n,e){return{documents:[BT(n,e.path)]}}function rD(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=BT(n,o);const c=function(g){if(g.length!==0)return YT(Is.create(g,"and"))}(e.filters);c&&(t.structuredQuery.where=c);const d=function(g){if(g.length!==0)return g.map(y=>function(E){return{field:Wo(E.field),direction:cD(E.dir)}}(y))}(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=jg(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=function(g){return{before:g.inclusive,values:g.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(g){return{before:!g.inclusive,values:g.position}}(e.endAt)),{Vt:t,parent:o}}function oD(n){let e=tD(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){Je(i===1,65062);const y=t.from[0];y.allDescendants?o=y.collectionId:e=e.child(y.collectionId)}let c=[];t.where&&(c=function(N){const E=$T(N);return E instanceof Is&&xT(E)?E.getFilters():[E]}(t.where));let d=[];t.orderBy&&(d=function(N){return N.map(E=>function(T){return new ou(Zo(T.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(E))}(t.orderBy));let f=null;t.limit&&(f=function(N){let E;return E=typeof N=="object"?N.value:N,Eu(E)?null:E}(t.limit));let p=null;t.startAt&&(p=function(N){const E=!!N.before,A=N.values||[];return new Lh(A,E)}(t.startAt));let g=null;return t.endAt&&(g=function(N){const E=!N.before,A=N.values||[];return new Lh(A,E)}(t.endAt)),wM(e,o,d,c,f,"F",p,g)}function lD(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return je(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function $T(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Zo(t.unaryFilter.field);return Vt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=Zo(t.unaryFilter.field);return Vt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Zo(t.unaryFilter.field);return Vt.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Zo(t.unaryFilter.field);return Vt.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return je(61313);default:return je(60726)}}(n):n.fieldFilter!==void 0?function(t){return Vt.create(Zo(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return je(58110);default:return je(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Is.create(t.compositeFilter.filters.map(i=>$T(i)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return je(1026)}}(t.compositeFilter.op))}(n):je(30097,{filter:n})}function cD(n){return XM[n]}function uD(n){return WM[n]}function dD(n){return ZM[n]}function Wo(n){return{fieldPath:n.canonicalString()}}function Zo(n){return un.fromServerFormat(n.fieldPath)}function YT(n){return n instanceof Vt?function(t){if(t.op==="=="){if(I_(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NAN"}};if(S_(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(I_(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NOT_NAN"}};if(S_(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wo(t.field),op:uD(t.op),value:t.value}}}(n):n instanceof Is?function(t){const i=t.getFilters().map(o=>YT(o));return i.length===1?i[0]:{compositeFilter:{op:dD(t.op),filters:i}}}(n):je(54877,{filter:n})}function hD(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function QT(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e,t,i,o,c=we.min(),d=we.min(),f=hn.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new Ai(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ai(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ai(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ai(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e){this.gt=e}}function mD(n){const e=oD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Vh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(){this.Dn=new gD}addToCollectionParentIndex(e,t){return this.Dn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(Oi.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(Oi.min())}updateCollectionGroup(e,t,i){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class gD{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new Gt(dt.comparator),c=!o.has(i);return this.index[t]=o.add(i),c}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new Gt(dt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},KT=41943040;class kn{static withCacheSize(e){return new kn(e,kn.DEFAULT_COLLECTION_PERCENTILE,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kn.DEFAULT_COLLECTION_PERCENTILE=10,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kn.DEFAULT=new kn(KT,kn.DEFAULT_COLLECTION_PERCENTILE,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kn.DISABLED=new kn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new dl(0)}static ur(){return new dl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_="LruGarbageCollector",vD=1048576;function $_([n,e],[t,i]){const o=Be(n,t);return o===0?Be(e,i):o}class yD{constructor(e){this.Tr=e,this.buffer=new Gt($_),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();$_(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xD{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){ve(G_,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Nl(t)?ve(G_,"Ignoring IndexedDB error during garbage collection: ",t):await xl(t)}await this.Rr(3e5)})}}class ND{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return le.resolve(of.ue);const i=new yD(t);return this.Vr.forEachTarget(e,o=>i.Er(o.sequenceNumber)).next(()=>this.Vr.gr(e,o=>i.Er(o))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(z_)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),z_):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let i,o,c,d,f,p,g;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(N=>(N>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${N}`),o=this.params.maximumSequenceNumbersToCollect):o=N,d=Date.now(),this.nthSequenceNumber(e,o))).next(N=>(i=N,f=Date.now(),this.removeTargets(e,i,t))).next(N=>(c=N,p=Date.now(),this.removeOrphanedDocuments(e,i))).next(N=>(g=Date.now(),Ko()<=Ye.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-y}ms
	Determined least recently used ${o} in `+(f-d)+`ms
	Removed ${c} targets in `+(p-f)+`ms
	Removed ${N} documents in `+(g-p)+`ms
Total Duration: ${g-y}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:N})))}}function bD(n,e){return new ND(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(){this.changes=new Xr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,en.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?le.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(i=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(i!==null&&Yc(i.mutation,o,Yn.empty(),xt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Qe()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Qe()){const o=Pr();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,i).next(c=>{let d=Uc();return c.forEach((f,p)=>{d=d.insert(f,p.overlayedDocument)}),d}))}getOverlayedDocuments(e,t){const i=Pr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Qe()))}populateOverlays(e,t,i){const o=[];return i.forEach(c=>{t.has(c)||o.push(c)}),this.documentOverlayCache.getOverlays(e,o).next(c=>{c.forEach((d,f)=>{t.set(d,f)})})}computeViews(e,t,i,o){let c=Ha();const d=$c(),f=function(){return $c()}();return t.forEach((p,g)=>{const y=i.get(g.key);o.has(g.key)&&(y===void 0||y.mutation instanceof Ki)?c=c.insert(g.key,g):y!==void 0?(d.set(g.key,y.mutation.getFieldMask()),Yc(y.mutation,g,y.mutation.getFieldMask(),xt.now())):d.set(g.key,Yn.empty())}),this.recalculateAndSaveOverlays(e,c).next(p=>(p.forEach((g,y)=>d.set(g,y)),t.forEach((g,y)=>{var N;return f.set(g,new ED(y,(N=d.get(g))!==null&&N!==void 0?N:null))}),f))}recalculateAndSaveOverlays(e,t){const i=$c();let o=new Tt((d,f)=>d-f),c=Qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(d=>{for(const f of d)f.keys().forEach(p=>{const g=t.get(p);if(g===null)return;let y=i.get(p)||Yn.empty();y=f.applyToLocalView(g,y),i.set(p,y);const N=(o.get(f.batchId)||Qe()).add(p);o=o.insert(f.batchId,N)})}).next(()=>{const d=[],f=o.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),g=p.key,y=p.value,N=wT();y.forEach(E=>{if(!c.has(E)){const A=kT(t.get(E),i.get(E));A!==null&&N.set(E,A),c=c.add(E)}}),d.push(this.documentOverlayCache.saveOverlays(e,g,N))}return le.waitFor(d)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,o){return function(d){return _e.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ET(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next(c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-c.size):le.resolve(Pr());let f=su,p=c;return d.next(g=>le.forEach(g,(y,N)=>(f<N.largestBatchId&&(f=N.largestBatchId),c.get(y)?le.resolve():this.remoteDocumentCache.getEntry(e,y).next(E=>{p=p.insert(y,E)}))).next(()=>this.populateOverlays(e,g,c)).next(()=>this.computeViews(e,p,g,Qe())).next(y=>({batchId:f,changes:CT(y)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _e(t)).next(i=>{let o=Uc();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const c=t.collectionGroup;let d=Uc();return this.indexManager.getCollectionParents(e,c).next(f=>le.forEach(f,p=>{const g=function(N,E){return new bl(E,null,N.explicitOrderBy.slice(),N.filters.slice(),N.limit,N.limitType,N.startAt,N.endAt)}(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,g,i,o).next(y=>{y.forEach((N,E)=>{d=d.insert(N,E)})})}).next(()=>d))}getDocumentsMatchingCollectionQuery(e,t,i,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,c,o))).next(d=>{c.forEach((p,g)=>{const y=g.getKey();d.get(y)===null&&(d=d.insert(y,en.newInvalidDocument(y)))});let f=Uc();return d.forEach((p,g)=>{const y=c.get(p);y!==void 0&&Yc(y.mutation,g,Yn.empty(),xt.now()),df(t,g)&&(f=f.insert(p,g))}),f})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return le.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(o){return{id:o.id,version:o.version,createTime:Kn(o.createTime)}}(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(o){return{name:o.name,query:mD(o.bundledQuery),readTime:Kn(o.readTime)}}(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(){this.overlays=new Tt(_e.comparator),this.kr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Pr();return le.forEach(t,o=>this.getOverlay(e,o).next(c=>{c!==null&&i.set(o,c)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((o,c)=>{this.wt(e,t,c)}),le.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.kr.get(i);return o!==void 0&&(o.forEach(c=>this.overlays=this.overlays.remove(c)),this.kr.delete(i)),le.resolve()}getOverlaysForCollection(e,t,i){const o=Pr(),c=t.length+1,d=new _e(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const p=f.getNext().value,g=p.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===c&&p.largestBatchId>i&&o.set(p.getKey(),p)}return le.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let c=new Tt((g,y)=>g-y);const d=this.overlays.getIterator();for(;d.hasNext();){const g=d.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>i){let y=c.get(g.largestBatchId);y===null&&(y=Pr(),c=c.insert(g.largestBatchId,y)),y.set(g.getKey(),g)}}const f=Pr(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((g,y)=>f.set(g,y)),!(f.size()>=o)););return le.resolve(f)}wt(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const d=this.kr.get(o.largestBatchId).delete(i.key);this.kr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new $M(t,i));let c=this.kr.get(t);c===void 0&&(c=Qe(),this.kr.set(t,c)),this.kr.set(t,c.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(){this.sessionToken=hn.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(){this.qr=new Gt(Jt.Qr),this.$r=new Gt(Jt.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const i=new Jt(e,t);this.qr=this.qr.add(i),this.$r=this.$r.add(i)}Kr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Wr(new Jt(e,t))}Gr(e,t){e.forEach(i=>this.removeReference(i,t))}zr(e){const t=new _e(new dt([])),i=new Jt(t,e),o=new Jt(t,e+1),c=[];return this.$r.forEachInRange([i,o],d=>{this.Wr(d),c.push(d.key)}),c}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new _e(new dt([])),i=new Jt(t,e),o=new Jt(t,e+1);let c=Qe();return this.$r.forEachInRange([i,o],d=>{c=c.add(d.key)}),c}containsKey(e){const t=new Jt(e,0),i=this.qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Jt{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return _e.comparator(e.key,t.key)||Be(e.Hr,t.Hr)}static Ur(e,t){return Be(e.Hr,t.Hr)||_e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Gt(Jt.Qr)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const c=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new GM(c,t,i,o);this.mutationQueue.push(d);for(const f of o)this.Yr=this.Yr.add(new Jt(f.key,c)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return le.resolve(d)}lookupMutationBatch(e,t){return le.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.Xr(i),c=o<0?0:o;return le.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?av:this.er-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Jt(t,0),o=new Jt(t,Number.POSITIVE_INFINITY),c=[];return this.Yr.forEachInRange([i,o],d=>{const f=this.Zr(d.Hr);c.push(f)}),le.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Gt(Be);return t.forEach(o=>{const c=new Jt(o,0),d=new Jt(o,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([c,d],f=>{i=i.add(f.Hr)})}),le.resolve(this.ei(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let c=i;_e.isDocumentKey(c)||(c=c.child(""));const d=new Jt(new _e(c),0);let f=new Gt(Be);return this.Yr.forEachWhile(p=>{const g=p.key.path;return!!i.isPrefixOf(g)&&(g.length===o&&(f=f.add(p.Hr)),!0)},d),le.resolve(this.ei(f))}ei(e){const t=[];return e.forEach(i=>{const o=this.Zr(i);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Je(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Yr;return le.forEach(t.mutations,o=>{const c=new Jt(o.key,t.batchId);return i=i.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Yr=i})}rr(e){}containsKey(e,t){const i=new Jt(t,0),o=this.Yr.firstAfterOrEqual(i);return le.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e){this.ni=e,this.docs=function(){return new Tt(_e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),c=o?o.size:0,d=this.ni(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return le.resolve(i?i.document.mutableCopy():en.newInvalidDocument(t))}getEntries(e,t){let i=Ha();return t.forEach(o=>{const c=this.docs.get(o);i=i.insert(o,c?c.document.mutableCopy():en.newInvalidDocument(o))}),le.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let c=Ha();const d=t.path,f=new _e(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:g,value:{document:y}}=p.getNext();if(!d.isPrefixOf(g.path))break;g.path.length>d.length+1||rM(iM(y),i)<=0||(o.has(y.key)||df(t,y))&&(c=c.insert(y.key,y.mutableCopy()))}return le.resolve(c)}getAllFromCollectionGroup(e,t,i,o){je(9500)}ri(e,t){return le.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new ID(this)}getSize(e){return le.resolve(this.size)}}class ID extends _D{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((i,o)=>{o.isValidDocument()?t.push(this.Or.addEntry(e,o)):this.Or.removeEntry(i)}),le.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e){this.persistence=e,this.ii=new Xr(t=>ov(t),lv),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this.si=0,this.oi=new fv,this.targetCount=0,this._i=dl.ar()}forEachTarget(e,t){return this.ii.forEach((i,o)=>t(o)),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.si&&(this.si=t),le.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new dl(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.hr(t),le.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,i){let o=0;const c=[];return this.ii.forEach((d,f)=>{f.sequenceNumber<=t&&i.get(f.targetId)===null&&(this.ii.delete(d),c.push(this.removeMatchingKeysForTargetId(e,f.targetId)),o++)}),le.waitFor(c).next(()=>o)}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const i=this.ii.get(t)||null;return le.resolve(i)}addMatchingKeys(e,t,i){return this.oi.Kr(t,i),le.resolve()}removeMatchingKeys(e,t,i){this.oi.Gr(t,i);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach(d=>{c.push(o.markPotentiallyOrphaned(e,d))}),le.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const i=this.oi.Jr(t);return le.resolve(i)}containsKey(e,t){return le.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(e,t){this.ai={},this.overlays={},this.ui=new of(0),this.ci=!1,this.ci=!0,this.li=new CD,this.referenceDelegate=e(this),this.hi=new RD(this),this.indexManager=new pD,this.remoteDocumentCache=function(o){return new SD(o)}(i=>this.referenceDelegate.Pi(i)),this.serializer=new fD(t),this.Ti=new TD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new AD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ai[e.toKey()];return i||(i=new wD(t,this.referenceDelegate),this.ai[e.toKey()]=i),i}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,i){ve("MemoryPersistence","Starting transaction:",e);const o=new MD(this.ui.next());return this.referenceDelegate.Ii(),i(o).next(c=>this.referenceDelegate.di(o).next(()=>c)).toPromise().then(c=>(o.raiseOnCommittedEvent(),c))}Ei(e,t){return le.or(Object.values(this.ai).map(i=>()=>i.containsKey(e,t)))}}class MD extends lM{constructor(e){super(),this.currentSequenceNumber=e}}class mv{constructor(e){this.persistence=e,this.Ai=new fv,this.Ri=null}static Vi(e){return new mv(e)}get mi(){if(this.Ri)return this.Ri;throw je(60996)}addReference(e,t,i){return this.Ai.addReference(i,t),this.mi.delete(i.toString()),le.resolve()}removeReference(e,t,i){return this.Ai.removeReference(i,t),this.mi.add(i.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(o=>this.mi.add(o.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(c=>this.mi.add(c.toString()))}).next(()=>i.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.mi,i=>{const o=_e.fromPath(i);return this.fi(e,o).next(c=>{c||t.removeEntry(o,we.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(i=>{i?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return le.or([()=>le.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Hh{constructor(e,t){this.persistence=e,this.gi=new Xr(i=>dM(i.path),(i,o)=>i.isEqual(o)),this.garbageCollector=bD(this,t)}static Vi(e,t){return new Hh(e,t)}Ii(){}di(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(o=>i+o))}yr(e){let t=0;return this.gr(e,i=>{t++}).next(()=>t)}gr(e,t){return le.forEach(this.gi,(i,o)=>this.Sr(e,i,o).next(c=>c?le.resolve():t(o)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.ri(e,d=>this.Sr(e,d,t).next(f=>{f||(i++,c.removeEntry(d,we.min()))})).next(()=>c.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.gi.set(i,e.currentSequenceNumber),le.resolve()}removeReference(e,t,i){return this.gi.set(i,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),le.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=xh(e.data.value)),t}Sr(e,t,i){return le.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.gi.get(t);return le.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Is=i,this.ds=o}static Es(e,t){let i=Qe(),o=Qe();for(const c of t.docChanges)switch(c.type){case 0:i=i.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new pv(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return dS()?8:cM(_n())>0?6:4}()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,i,o){const c={result:null};return this.ps(e,t).next(d=>{c.result=d}).next(()=>{if(!c.result)return this.ys(e,t,o,i).next(d=>{c.result=d})}).next(()=>{if(c.result)return;const d=new DD;return this.ws(e,t,d).next(f=>{if(c.result=f,this.Rs)return this.Ss(e,t,d,f.size)})}).next(()=>c.result)}Ss(e,t,i,o){return i.documentReadCount<this.Vs?(Ko()<=Ye.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",Xo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),le.resolve()):(Ko()<=Ye.DEBUG&&ve("QueryEngine","Query:",Xo(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.fs*o?(Ko()<=Ye.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",Xo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ta(t))):le.resolve())}ps(e,t){if(k_(t))return le.resolve(null);let i=ta(t);return this.indexManager.getIndexType(e,i).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Vh(t,null,"F"),i=ta(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(c=>{const d=Qe(...c);return this.gs.getDocuments(e,d).next(f=>this.indexManager.getMinOffset(e,i).next(p=>{const g=this.bs(t,f);return this.Ds(t,g,d,p.readTime)?this.ps(e,Vh(t,null,"F")):this.vs(e,g,t,p)}))})))}ys(e,t,i,o){return k_(t)||o.isEqual(we.min())?le.resolve(null):this.gs.getDocuments(e,i).next(c=>{const d=this.bs(t,c);return this.Ds(t,d,i,o)?le.resolve(null):(Ko()<=Ye.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Xo(t)),this.vs(e,d,t,aM(o,su)).next(f=>f))})}bs(e,t){let i=new Gt(TT(e));return t.forEach((o,c)=>{df(e,c)&&(i=i.add(c))}),i}Ds(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}ws(e,t,i){return Ko()<=Ye.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",Xo(t)),this.gs.getDocumentsMatchingQuery(e,t,Oi.min(),i)}vs(e,t,i,o){return this.gs.getDocumentsMatchingQuery(e,i,o).next(c=>(t.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv="LocalStore",OD=3e8;class PD{constructor(e,t,i,o){this.persistence=e,this.Cs=t,this.serializer=o,this.Fs=new Tt(Be),this.Ms=new Xr(c=>ov(c),lv),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(i)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jD(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function LD(n,e,t,i){return new PD(n,e,t,i)}async function WT(n,e){const t=Oe(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next(c=>(o=c,t.Ns(e),t.mutationQueue.getAllMutationBatches(i))).next(c=>{const d=[],f=[];let p=Qe();for(const g of o){d.push(g.batchId);for(const y of g.mutations)p=p.add(y.key)}for(const g of c){f.push(g.batchId);for(const y of g.mutations)p=p.add(y.key)}return t.localDocuments.getDocuments(i,p).next(g=>({Bs:g,removedBatchIds:d,addedBatchIds:f}))})})}function VD(n,e){const t=Oe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const o=e.batch.keys(),c=t.Os.newChangeBuffer({trackRemovals:!0});return function(f,p,g,y){const N=g.batch,E=N.keys();let A=le.resolve();return E.forEach(T=>{A=A.next(()=>y.getEntry(p,T)).next(R=>{const b=g.docVersions.get(T);Je(b!==null,48541),R.version.compareTo(b)<0&&(N.applyToRemoteDocument(R,g),R.isValidDocument()&&(R.setReadTime(g.commitVersion),y.addEntry(R)))})}),A.next(()=>f.mutationQueue.removeMutationBatch(p,N))}(t,i,e,c).next(()=>c.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(f){let p=Qe();for(let g=0;g<f.mutationResults.length;++g)f.mutationResults[g].transformResults.length>0&&(p=p.add(f.batch.mutations[g].key));return p}(e))).next(()=>t.localDocuments.getDocuments(i,o))})}function ZT(n){const e=Oe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function UD(n,e){const t=Oe(n),i=e.snapshotVersion;let o=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=t.Os.newChangeBuffer({trackRemovals:!0});o=t.Fs;const f=[];e.targetChanges.forEach((y,N)=>{const E=o.get(N);if(!E)return;f.push(t.hi.removeMatchingKeys(c,y.removedDocuments,N).next(()=>t.hi.addMatchingKeys(c,y.addedDocuments,N)));let A=E.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(N)!==null?A=A.withResumeToken(hn.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):y.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(y.resumeToken,i)),o=o.insert(N,A),function(R,b,k){return R.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=OD?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(E,A,y)&&f.push(t.hi.updateTargetData(c,A))});let p=Ha(),g=Qe();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(c,y))}),f.push(FD(c,d,e.documentUpdates).next(y=>{p=y.Ls,g=y.ks})),!i.isEqual(we.min())){const y=t.hi.getLastRemoteSnapshotVersion(c).next(N=>t.hi.setTargetsMetadata(c,c.currentSequenceNumber,i));f.push(y)}return le.waitFor(f).next(()=>d.apply(c)).next(()=>t.localDocuments.getLocalViewOfDocuments(c,p,g)).next(()=>p)}).then(c=>(t.Fs=o,c))}function FD(n,e,t){let i=Qe(),o=Qe();return t.forEach(c=>i=i.add(c)),e.getEntries(n,i).next(c=>{let d=Ha();return t.forEach((f,p)=>{const g=c.get(f);p.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(f)),p.isNoDocument()&&p.version.isEqual(we.min())?(e.removeEntry(f,p.readTime),d=d.insert(f,p)):!g.isValidDocument()||p.version.compareTo(g.version)>0||p.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(p),d=d.insert(f,p)):ve(gv,"Ignoring outdated watch update for ",f,". Current version:",g.version," Watch version:",p.version)}),{Ls:d,ks:o}})}function qD(n,e){const t=Oe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=av),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function HD(n,e){const t=Oe(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let o;return t.hi.getTargetData(i,e).next(c=>c?(o=c,le.resolve(o)):t.hi.allocateTargetId(i).next(d=>(o=new Ai(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.hi.addTargetData(i,o).next(()=>o))))}).then(i=>{const o=t.Fs.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(i.targetId,i),t.Ms.set(e,i.targetId)),i})}async function Cg(n,e,t){const i=Oe(n),o=i.Fs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",c,d=>i.persistence.referenceDelegate.removeTarget(d,o))}catch(d){if(!Nl(d))throw d;ve(gv,`Failed to update sequence numbers for target ${e}: ${d}`)}i.Fs=i.Fs.remove(e),i.Ms.delete(o.target)}function Y_(n,e,t){const i=Oe(n);let o=we.min(),c=Qe();return i.persistence.runTransaction("Execute query","readwrite",d=>function(p,g,y){const N=Oe(p),E=N.Ms.get(y);return E!==void 0?le.resolve(N.Fs.get(E)):N.hi.getTargetData(g,y)}(i,d,ta(e)).next(f=>{if(f)return o=f.lastLimboFreeSnapshotVersion,i.hi.getMatchingKeysForTargetId(d,f.targetId).next(p=>{c=p})}).next(()=>i.Cs.getDocumentsMatchingQuery(d,e,t?o:we.min(),t?c:Qe())).next(f=>(BD(i,IM(e),f),{documents:f,qs:c})))}function BD(n,e,t){let i=n.xs.get(e)||we.min();t.forEach((o,c)=>{c.readTime.compareTo(i)>0&&(i=c.readTime)}),n.xs.set(e,i)}class Q_{constructor(){this.activeTargetIds=PM()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class zD{constructor(){this.Fo=new Q_,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,i){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Q_,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_="ConnectivityMonitor";class X_{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){ve(K_,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){ve(K_,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uh=null;function wg(){return uh===null?uh=function(){return 268435456+Math.round(2147483648*Math.random())}():uh++,"0x"+uh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="RestConnection",$D={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class YD{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${i}/databases/${o}`,this.Ko=this.databaseId.database===Oh?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Wo(e,t,i,o,c){const d=wg(),f=this.Go(e,t.toUriEncodedString());ve(Yp,`Sending RPC '${e}' ${d}:`,f,i);const p={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(p,o,c);const{host:g}=new URL(f),y=Qr(g);return this.jo(e,f,p,i,y).then(N=>(ve(Yp,`Received RPC '${e}' ${d}: `,N),N),N=>{throw ki(Yp,`RPC '${e}' ${d} failed with error: `,N,"url: ",f,"request:",i),N})}Jo(e,t,i,o,c,d){return this.Wo(e,t,i,o,c)}zo(e,t,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+yl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,c)=>e[c]=o),i&&i.headers.forEach((o,c)=>e[c]=o)}Go(e,t){const i=$D[e];return`${this.$o}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gn="WebChannelConnection";class KD extends YD{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,i,o,c){const d=wg();return new Promise((f,p)=>{const g=new Wj;g.setWithCredentials(!0),g.listenOnce(Zj.COMPLETE,()=>{try{switch(g.getLastErrorCode()){case yh.NO_ERROR:const N=g.getResponseJson();ve(gn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(N)),f(N);break;case yh.TIMEOUT:ve(gn,`RPC '${e}' ${d} timed out`),p(new me(ae.DEADLINE_EXCEEDED,"Request time out"));break;case yh.HTTP_ERROR:const E=g.getStatus();if(ve(gn,`RPC '${e}' ${d} failed with status:`,E,"response text:",g.getResponseText()),E>0){let A=g.getResponseJson();Array.isArray(A)&&(A=A[0]);const T=A?.error;if(T&&T.status&&T.message){const R=function(k){const _=k.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(_)>=0?_:ae.UNKNOWN}(T.status);p(new me(R,T.message))}else p(new me(ae.UNKNOWN,"Server responded with status "+g.getStatus()))}else p(new me(ae.UNAVAILABLE,"Connection failed."));break;default:je(9055,{c_:e,streamId:d,l_:g.getLastErrorCode(),h_:g.getLastError()})}}finally{ve(gn,`RPC '${e}' ${d} completed.`)}});const y=JSON.stringify(o);ve(gn,`RPC '${e}' ${d} sending request:`,o),g.send(t,"POST",y,i,15)})}P_(e,t,i){const o=wg(),c=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=tT(),f=eT(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.zo(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=c.join("");ve(gn,`Creating RPC '${e}' stream ${o}: ${y}`,p);const N=d.createWebChannel(y,p);this.T_(N);let E=!1,A=!1;const T=new QD({Ho:b=>{A?ve(gn,`Not sending because RPC '${e}' stream ${o} is closed:`,b):(E||(ve(gn,`Opening RPC '${e}' stream ${o} transport.`),N.open(),E=!0),ve(gn,`RPC '${e}' stream ${o} sending:`,b),N.send(b))},Yo:()=>N.close()}),R=(b,k,_)=>{b.listen(k,j=>{try{_(j)}catch(S){setTimeout(()=>{throw S},0)}})};return R(N,Vc.EventType.OPEN,()=>{A||(ve(gn,`RPC '${e}' stream ${o} transport opened.`),T.s_())}),R(N,Vc.EventType.CLOSE,()=>{A||(A=!0,ve(gn,`RPC '${e}' stream ${o} transport closed`),T.__(),this.I_(N))}),R(N,Vc.EventType.ERROR,b=>{A||(A=!0,ki(gn,`RPC '${e}' stream ${o} transport errored. Name:`,b.name,"Message:",b.message),T.__(new me(ae.UNAVAILABLE,"The operation could not be completed")))}),R(N,Vc.EventType.MESSAGE,b=>{var k;if(!A){const _=b.data[0];Je(!!_,16349);const j=_,S=j?.error||((k=j[0])===null||k===void 0?void 0:k.error);if(S){ve(gn,`RPC '${e}' stream ${o} received error:`,S);const O=S.status;let B=function(V){const U=Lt[V];if(U!==void 0)return VT(U)}(O),L=S.message;B===void 0&&(B=ae.INTERNAL,L="Unknown error status: "+O+" with message "+S.message),A=!0,T.__(new me(B,L)),N.close()}else ve(gn,`RPC '${e}' stream ${o} received:`,_),T.a_(_)}}),R(f,Jj.STAT_EVENT,b=>{b.stat===vg.PROXY?ve(gn,`RPC '${e}' stream ${o} detected buffering proxy`):b.stat===vg.NOPROXY&&ve(gn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{T.o_()},0),T}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function Qp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gf(n){return new JM(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(e,t,i=1e3,o=1.5,c=6e4){this.Fi=e,this.timerId=t,this.d_=i,this.E_=o,this.A_=c,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),i=Math.max(0,Date.now()-this.m_),o=Math.max(0,t-i);o>0&&ve("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,o,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W_="PersistentStream";class JT{constructor(e,t,i,o,c,d,f,p){this.Fi=e,this.w_=i,this.S_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new vv(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===ae.RESOURCE_EXHAUSTED?(qa(t.toString()),qa("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,o])=>{this.b_===t&&this.W_(i,o)},i=>{e(()=>{const o=new me(ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.G_(o)})})}W_(e,t){const i=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.e_(()=>{i(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(o=>{i(()=>this.G_(o))}),this.stream.onMessage(o=>{i(()=>++this.C_==1?this.j_(o):this.onNext(o))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return ve(W_,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(ve(W_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class XD extends JT{constructor(e,t,i,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=sD(this.serializer,e),i=function(c){if(!("targetChange"in c))return we.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?we.min():d.readTime?Kn(d.readTime):we.min()}(e);return this.listener.J_(t,i)}H_(e){const t={};t.database=Ag(this.serializer),t.addTarget=function(c,d){let f;const p=d.target;if(f=_g(p)?{documents:iD(c,p)}:{query:rD(c,p).Vt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=qT(c,d.resumeToken);const g=jg(c,d.expectedCount);g!==null&&(f.expectedCount=g)}else if(d.snapshotVersion.compareTo(we.min())>0){f.readTime=Fh(c,d.snapshotVersion.toTimestamp());const g=jg(c,d.expectedCount);g!==null&&(f.expectedCount=g)}return f}(this.serializer,e);const i=lD(this.serializer,e);i&&(t.labels=i),this.k_(t)}Y_(e){const t={};t.database=Ag(this.serializer),t.removeTarget=e,this.k_(t)}}class WD extends JT{constructor(e,t,i,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Je(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=aD(e.writeResults,e.commitTime),i=Kn(e.commitTime);return this.listener.ta(i,t)}na(){const e={};e.database=Ag(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>GT(this.serializer,i))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{}class JD extends ZD{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ra=!1}ia(){if(this.ra)throw new me(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.Wo(e,Tg(t,i),o,c,d)).catch(c=>{throw c.name==="FirebaseError"?(c.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new me(ae.UNKNOWN,c.toString())})}Jo(e,t,i,o,c){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,f])=>this.connection.Jo(e,Tg(t,i),o,d,f,c)).catch(d=>{throw d.name==="FirebaseError"?(d.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new me(ae.UNKNOWN,d.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class ek{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(qa(t),this._a=!1):ve("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gr="RemoteStore";class tk{constructor(e,t,i,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=c,this.Ea.xo(d=>{i.enqueueAndForget(async()=>{Wr(this)&&(ve(Gr,"Restarting streams for network reachability change."),await async function(p){const g=Oe(p);g.Ia.add(4),await Au(g),g.Aa.set("Unknown"),g.Ia.delete(4),await vf(g)}(this))})}),this.Aa=new ek(i,o)}}async function vf(n){if(Wr(n))for(const e of n.da)await e(!0)}async function Au(n){for(const e of n.da)await e(!1)}function e0(n,e){const t=Oe(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),bv(t)?Nv(t):_l(t).x_()&&xv(t,e))}function yv(n,e){const t=Oe(n),i=_l(t);t.Ta.delete(e),i.x_()&&t0(t,e),t.Ta.size===0&&(i.x_()?i.B_():Wr(t)&&t.Aa.set("Unknown"))}function xv(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(we.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}_l(n).H_(e)}function t0(n,e){n.Ra.$e(e),_l(n).Y_(e)}function Nv(n){n.Ra=new KM({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),_l(n).start(),n.Aa.aa()}function bv(n){return Wr(n)&&!_l(n).M_()&&n.Ta.size>0}function Wr(n){return Oe(n).Ia.size===0}function n0(n){n.Ra=void 0}async function nk(n){n.Aa.set("Online")}async function sk(n){n.Ta.forEach((e,t)=>{xv(n,e)})}async function ak(n,e){n0(n),bv(n)?(n.Aa.la(e),Nv(n)):n.Aa.set("Unknown")}async function ik(n,e,t){if(n.Aa.set("Online"),e instanceof FT&&e.state===2&&e.cause)try{await async function(o,c){const d=c.cause;for(const f of c.targetIds)o.Ta.has(f)&&(await o.remoteSyncer.rejectListen(f,d),o.Ta.delete(f),o.Ra.removeTarget(f))}(n,e)}catch(i){ve(Gr,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Bh(n,i)}else if(e instanceof _h?n.Ra.Ye(e):e instanceof UT?n.Ra.it(e):n.Ra.et(e),!t.isEqual(we.min()))try{const i=await ZT(n.localStore);t.compareTo(i)>=0&&await function(c,d){const f=c.Ra.Pt(d);return f.targetChanges.forEach((p,g)=>{if(p.resumeToken.approximateByteSize()>0){const y=c.Ta.get(g);y&&c.Ta.set(g,y.withResumeToken(p.resumeToken,d))}}),f.targetMismatches.forEach((p,g)=>{const y=c.Ta.get(p);if(!y)return;c.Ta.set(p,y.withResumeToken(hn.EMPTY_BYTE_STRING,y.snapshotVersion)),t0(c,p);const N=new Ai(y.target,p,g,y.sequenceNumber);xv(c,N)}),c.remoteSyncer.applyRemoteEvent(f)}(n,t)}catch(i){ve(Gr,"Failed to raise snapshot:",i),await Bh(n,i)}}async function Bh(n,e,t){if(!Nl(e))throw e;n.Ia.add(1),await Au(n),n.Aa.set("Offline"),t||(t=()=>ZT(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ve(Gr,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await vf(n)})}function s0(n,e){return e().catch(t=>Bh(n,t,e))}async function yf(n){const e=Oe(n),t=Ui(e);let i=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:av;for(;rk(e);)try{const o=await qD(e.localStore,i);if(o===null){e.Pa.length===0&&t.B_();break}i=o.batchId,ok(e,o)}catch(o){await Bh(e,o)}a0(e)&&i0(e)}function rk(n){return Wr(n)&&n.Pa.length<10}function ok(n,e){n.Pa.push(e);const t=Ui(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function a0(n){return Wr(n)&&!Ui(n).M_()&&n.Pa.length>0}function i0(n){Ui(n).start()}async function lk(n){Ui(n).na()}async function ck(n){const e=Ui(n);for(const t of n.Pa)e.X_(t.mutations)}async function uk(n,e,t){const i=n.Pa.shift(),o=uv.from(i,e,t);await s0(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await yf(n)}async function dk(n,e){e&&Ui(n).Z_&&await async function(i,o){if(function(d){return LT(d)&&d!==ae.ABORTED}(o.code)){const c=i.Pa.shift();Ui(i).N_(),await s0(i,()=>i.remoteSyncer.rejectFailedWrite(c.batchId,o)),await yf(i)}}(n,e),a0(n)&&i0(n)}async function Z_(n,e){const t=Oe(n);t.asyncQueue.verifyOperationInProgress(),ve(Gr,"RemoteStore received new credentials");const i=Wr(t);t.Ia.add(3),await Au(t),i&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await vf(t)}async function hk(n,e){const t=Oe(n);e?(t.Ia.delete(2),await vf(t)):e||(t.Ia.add(2),await Au(t),t.Aa.set("Unknown"))}function _l(n){return n.Va||(n.Va=function(t,i,o){const c=Oe(t);return c.ia(),new XD(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{Zo:nk.bind(null,n),e_:sk.bind(null,n),n_:ak.bind(null,n),J_:ik.bind(null,n)}),n.da.push(async e=>{e?(n.Va.N_(),bv(n)?Nv(n):n.Aa.set("Unknown")):(await n.Va.stop(),n0(n))})),n.Va}function Ui(n){return n.ma||(n.ma=function(t,i,o){const c=Oe(t);return c.ia(),new WD(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:lk.bind(null,n),n_:dk.bind(null,n),ea:ck.bind(null,n),ta:uk.bind(null,n)}),n.da.push(async e=>{e?(n.ma.N_(),await yf(n)):(await n.ma.stop(),n.Pa.length>0&&(ve(Gr,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))})),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,t,i,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=c,this.deferred=new ea,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,c){const d=Date.now()+i,f=new _v(e,t,d,o,c);return f.start(i),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ev(n,e){if(qa("AsyncQueue",`${e}: ${n}`),Nl(n))return new me(ae.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{static emptySet(e){return new il(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||_e.comparator(t.key,i.key):(t,i)=>_e.comparator(t.key,i.key),this.keyedMap=Uc(),this.sortedSet=new Tt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof il)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new il;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(){this.fa=new Tt(_e.comparator)}track(e){const t=e.doc.key,i=this.fa.get(t);i?e.type!==0&&i.type===3?this.fa=this.fa.insert(t,e):e.type===3&&i.type!==1?this.fa=this.fa.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.fa=this.fa.remove(t):e.type===1&&i.type===2?this.fa=this.fa.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):je(63341,{At:e,ga:i}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,i)=>{e.push(i)}),e}}class hl{constructor(e,t,i,o,c,d,f,p,g){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=g}static fromInitialDocuments(e,t,i,o,c){const d=[];return t.forEach(f=>{d.push({type:0,doc:f})}),new hl(e,t,il.emptySet(t),d,i,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class mk{constructor(){this.queries=eE(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,i){const o=Oe(t),c=o.queries;o.queries=eE(),c.forEach((d,f)=>{for(const p of f.wa)p.onError(i)})})(this,new me(ae.ABORTED,"Firestore shutting down"))}}function eE(){return new Xr(n=>jT(n),uf)}async function jv(n,e){const t=Oe(n);let i=3;const o=e.query;let c=t.queries.get(o);c?!c.Sa()&&e.ba()&&(i=2):(c=new fk,i=e.ba()?0:1);try{switch(i){case 0:c.ya=await t.onListen(o,!0);break;case 1:c.ya=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const f=Ev(d,`Initialization of query '${Xo(e.query)}' failed`);return void e.onError(f)}t.queries.set(o,c),c.wa.push(e),e.va(t.onlineState),c.ya&&e.Ca(c.ya)&&Av(t)}async function Tv(n,e){const t=Oe(n),i=e.query;let o=3;const c=t.queries.get(i);if(c){const d=c.wa.indexOf(e);d>=0&&(c.wa.splice(d,1),c.wa.length===0?o=e.ba()?0:1:!c.Sa()&&e.ba()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function pk(n,e){const t=Oe(n);let i=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const f of d.wa)f.Ca(o)&&(i=!0);d.ya=o}}i&&Av(t)}function gk(n,e,t){const i=Oe(n),o=i.queries.get(e);if(o)for(const c of o.wa)c.onError(t);i.queries.delete(e)}function Av(n){n.Da.forEach(e=>{e.next()})}var Sg,tE;(tE=Sg||(Sg={})).Fa="default",tE.Cache="cache";class Cv{constructor(e,t,i){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=i||{}}Ca(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new hl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const i=t!=="Offline";return(!this.options.ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=hl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Sg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(e){this.key=e}}class o0{constructor(e){this.key=e}}class vk{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Qe(),this.mutatedKeys=Qe(),this.Xa=TT(e),this.eu=new il(this.Xa)}get tu(){return this.Ha}nu(e,t){const i=t?t.ru:new J_,o=t?t.eu:this.eu;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,f=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((y,N)=>{const E=o.get(y),A=df(this.query,N)?N:null,T=!!E&&this.mutatedKeys.has(E.key),R=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let b=!1;E&&A?E.data.isEqual(A.data)?T!==R&&(i.track({type:3,doc:A}),b=!0):this.iu(E,A)||(i.track({type:2,doc:A}),b=!0,(p&&this.Xa(A,p)>0||g&&this.Xa(A,g)<0)&&(f=!0)):!E&&A?(i.track({type:0,doc:A}),b=!0):E&&!A&&(i.track({type:1,doc:E}),b=!0,(p||g)&&(f=!0)),b&&(A?(d=d.add(A),c=R?c.add(y):c.delete(y)):(d=d.delete(y),c=c.delete(y)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const y=this.query.limitType==="F"?d.last():d.first();d=d.delete(y.key),c=c.delete(y.key),i.track({type:1,doc:y})}return{eu:d,ru:i,Ds:f,mutatedKeys:c}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const c=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const d=e.ru.pa();d.sort((y,N)=>function(A,T){const R=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return je(20277,{At:b})}};return R(A)-R(T)}(y.type,N.type)||this.Xa(y.doc,N.doc)),this.su(i),o=o!=null&&o;const f=t&&!o?this.ou():[],p=this.Za.size===0&&this.current&&!o?1:0,g=p!==this.Ya;return this.Ya=p,d.length!==0||g?{snapshot:new hl(this.query,e.eu,c,d,e.mutatedKeys,p===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new J_,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Qe(),this.eu.forEach(i=>{this.au(i.key)&&(this.Za=this.Za.add(i.key))});const t=[];return e.forEach(i=>{this.Za.has(i)||t.push(new o0(i))}),this.Za.forEach(i=>{e.has(i)||t.push(new r0(i))}),t}uu(e){this.Ha=e.qs,this.Za=Qe();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return hl.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const wv="SyncEngine";class yk{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class xk{constructor(e){this.key=e,this.lu=!1}}class Nk{constructor(e,t,i,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.hu={},this.Pu=new Xr(f=>jT(f),uf),this.Tu=new Map,this.Iu=new Set,this.du=new Tt(_e.comparator),this.Eu=new Map,this.Au=new fv,this.Ru={},this.Vu=new Map,this.mu=dl.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function bk(n,e,t=!0){const i=f0(n);let o;const c=i.Pu.get(e);return c?(i.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.cu()):o=await l0(i,e,t,!0),o}async function _k(n,e){const t=f0(n);await l0(t,e,!0,!1)}async function l0(n,e,t,i){const o=await HD(n.localStore,ta(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let f;return i&&(f=await Ek(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&e0(n.remoteStore,o),f}async function Ek(n,e,t,i,o){n.gu=(N,E,A)=>async function(R,b,k,_){let j=b.view.nu(k);j.Ds&&(j=await Y_(R.localStore,b.query,!1).then(({documents:L})=>b.view.nu(L,j)));const S=_&&_.targetChanges.get(b.targetId),O=_&&_.targetMismatches.get(b.targetId)!=null,B=b.view.applyChanges(j,R.isPrimaryClient,S,O);return sE(R,b.targetId,B._u),B.snapshot}(n,N,E,A);const c=await Y_(n.localStore,e,!0),d=new vk(e,c.qs),f=d.nu(c.documents),p=Tu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),g=d.applyChanges(f,n.isPrimaryClient,p);sE(n,t,g._u);const y=new yk(e,t,d);return n.Pu.set(e,y),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),g.snapshot}async function jk(n,e,t){const i=Oe(n),o=i.Pu.get(e),c=i.Tu.get(o.targetId);if(c.length>1)return i.Tu.set(o.targetId,c.filter(d=>!uf(d,e))),void i.Pu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await Cg(i.localStore,o.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(o.targetId),t&&yv(i.remoteStore,o.targetId),Ig(i,o.targetId)}).catch(xl)):(Ig(i,o.targetId),await Cg(i.localStore,o.targetId,!0))}async function Tk(n,e){const t=Oe(n),i=t.Pu.get(e),o=t.Tu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),yv(t.remoteStore,i.targetId))}async function Ak(n,e,t){const i=Dk(n);try{const o=await function(d,f){const p=Oe(d),g=xt.now(),y=f.reduce((A,T)=>A.add(T.key),Qe());let N,E;return p.persistence.runTransaction("Locally write mutations","readwrite",A=>{let T=Ha(),R=Qe();return p.Os.getEntries(A,y).next(b=>{T=b,T.forEach((k,_)=>{_.isValidDocument()||(R=R.add(k))})}).next(()=>p.localDocuments.getOverlayedDocuments(A,T)).next(b=>{N=b;const k=[];for(const _ of f){const j=zM(_,N.get(_.key).overlayedDocument);j!=null&&k.push(new Ki(_.key,j,gT(j.value.mapValue),dn.exists(!0)))}return p.mutationQueue.addMutationBatch(A,g,k,f)}).next(b=>{E=b;const k=b.applyToLocalDocumentSet(N,R);return p.documentOverlayCache.saveOverlays(A,b.batchId,k)})}).then(()=>({batchId:E.batchId,changes:CT(N)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),function(d,f,p){let g=d.Ru[d.currentUser.toKey()];g||(g=new Tt(Be)),g=g.insert(f,p),d.Ru[d.currentUser.toKey()]=g}(i,o.batchId,t),await Cu(i,o.changes),await yf(i.remoteStore)}catch(o){const c=Ev(o,"Failed to persist write");t.reject(c)}}async function c0(n,e){const t=Oe(n);try{const i=await UD(t.localStore,e);e.targetChanges.forEach((o,c)=>{const d=t.Eu.get(c);d&&(Je(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.lu=!0:o.modifiedDocuments.size>0?Je(d.lu,14607):o.removedDocuments.size>0&&(Je(d.lu,42227),d.lu=!1))}),await Cu(t,i,e)}catch(i){await xl(i)}}function nE(n,e,t){const i=Oe(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Pu.forEach((c,d)=>{const f=d.view.va(e);f.snapshot&&o.push(f.snapshot)}),function(d,f){const p=Oe(d);p.onlineState=f;let g=!1;p.queries.forEach((y,N)=>{for(const E of N.wa)E.va(f)&&(g=!0)}),g&&Av(p)}(i.eventManager,e),o.length&&i.hu.J_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Ck(n,e,t){const i=Oe(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Eu.get(e),c=o&&o.key;if(c){let d=new Tt(_e.comparator);d=d.insert(c,en.newNoDocument(c,we.min()));const f=Qe().add(c),p=new pf(we.min(),new Map,new Tt(Be),d,f);await c0(i,p),i.du=i.du.remove(c),i.Eu.delete(e),Sv(i)}else await Cg(i.localStore,e,!1).then(()=>Ig(i,e,t)).catch(xl)}async function wk(n,e){const t=Oe(n),i=e.batch.batchId;try{const o=await VD(t.localStore,e);d0(t,i,null),u0(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Cu(t,o)}catch(o){await xl(o)}}async function Sk(n,e,t){const i=Oe(n);try{const o=await function(d,f){const p=Oe(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let y;return p.mutationQueue.lookupMutationBatch(g,f).next(N=>(Je(N!==null,37113),y=N.keys(),p.mutationQueue.removeMutationBatch(g,N))).next(()=>p.mutationQueue.performConsistencyCheck(g)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(g,y,f)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,y)).next(()=>p.localDocuments.getDocuments(g,y))})}(i.localStore,e);d0(i,e,t),u0(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Cu(i,o)}catch(o){await xl(o)}}function u0(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function d0(n,e,t){const i=Oe(n);let o=i.Ru[i.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),i.Ru[i.currentUser.toKey()]=o}}function Ig(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Tu.get(e))n.Pu.delete(i),t&&n.hu.pu(i,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(i=>{n.Au.containsKey(i)||h0(n,i)})}function h0(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(yv(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Sv(n))}function sE(n,e,t){for(const i of t)i instanceof r0?(n.Au.addReference(i.key,e),Ik(n,i)):i instanceof o0?(ve(wv,"Document no longer in limbo: "+i.key),n.Au.removeReference(i.key,e),n.Au.containsKey(i.key)||h0(n,i.key)):je(19791,{yu:i})}function Ik(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Iu.has(i)||(ve(wv,"New document in limbo: "+t),n.Iu.add(i),Sv(n))}function Sv(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new _e(dt.fromString(e)),i=n.mu.next();n.Eu.set(i,new xk(t)),n.du=n.du.insert(t,i),e0(n.remoteStore,new Ai(ta(cf(t.path)),i,"TargetPurposeLimboResolution",of.ue))}}async function Cu(n,e,t){const i=Oe(n),o=[],c=[],d=[];i.Pu.isEmpty()||(i.Pu.forEach((f,p)=>{d.push(i.gu(p,e,t).then(g=>{var y;if((g||t)&&i.isPrimaryClient){const N=g?!g.fromCache:(y=t?.targetChanges.get(p.targetId))===null||y===void 0?void 0:y.current;i.sharedClientState.updateQueryState(p.targetId,N?"current":"not-current")}if(g){o.push(g);const N=pv.Es(p.targetId,g);c.push(N)}}))}),await Promise.all(d),i.hu.J_(o),await async function(p,g){const y=Oe(p);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",N=>le.forEach(g,E=>le.forEach(E.Is,A=>y.persistence.referenceDelegate.addReference(N,E.targetId,A)).next(()=>le.forEach(E.ds,A=>y.persistence.referenceDelegate.removeReference(N,E.targetId,A)))))}catch(N){if(!Nl(N))throw N;ve(gv,"Failed to update sequence numbers: "+N)}for(const N of g){const E=N.targetId;if(!N.fromCache){const A=y.Fs.get(E),T=A.snapshotVersion,R=A.withLastLimboFreeSnapshotVersion(T);y.Fs=y.Fs.insert(E,R)}}}(i.localStore,c))}async function Rk(n,e){const t=Oe(n);if(!t.currentUser.isEqual(e)){ve(wv,"User change. New user:",e.toKey());const i=await WT(t.localStore,e);t.currentUser=e,function(c,d){c.Vu.forEach(f=>{f.forEach(p=>{p.reject(new me(ae.CANCELLED,d))})}),c.Vu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Cu(t,i.Bs)}}function Mk(n,e){const t=Oe(n),i=t.Eu.get(e);if(i&&i.lu)return Qe().add(i.key);{let o=Qe();const c=t.Tu.get(e);if(!c)return o;for(const d of c){const f=t.Pu.get(d);o=o.unionWith(f.view.tu)}return o}}function f0(n){const e=Oe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=c0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Mk.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Ck.bind(null,e),e.hu.J_=pk.bind(null,e.eventManager),e.hu.pu=gk.bind(null,e.eventManager),e}function Dk(n){const e=Oe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wk.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Sk.bind(null,e),e}class zh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gf(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return LD(this.persistence,new kD,e.initialUser,this.serializer)}Du(e){return new XT(mv.Vi,this.serializer)}bu(e){return new zD}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}zh.provider={build:()=>new zh};class kk extends zh{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Je(this.persistence.referenceDelegate instanceof Hh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new xD(i,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?kn.withCacheSize(this.cacheSizeBytes):kn.DEFAULT;return new XT(i=>Hh.Vi(i,t),this.serializer)}}class Rg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>nE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=Rk.bind(null,this.syncEngine),await hk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new mk}()}createDatastore(e){const t=gf(e.databaseInfo.databaseId),i=function(c){return new KD(c)}(e.databaseInfo);return function(c,d,f,p){return new JD(c,d,f,p)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,o,c,d,f){return new tk(i,o,c,d,f)}(this.localStore,this.datastore,e.asyncQueue,t=>nE(this.syncEngine,t,0),function(){return X_.C()?new X_:new GD}())}createSyncEngine(e,t){return function(o,c,d,f,p,g,y){const N=new Nk(o,c,d,f,p,g);return y&&(N.fu=!0),N}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const c=Oe(o);ve(Gr,"RemoteStore shutting down."),c.Ia.add(5),await Au(c),c.Ea.shutdown(),c.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Rg.provider={build:()=>new Rg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):qa("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new me(ae.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,c){const d=Oe(o),f={documents:c.map(N=>qh(d.serializer,N))},p=await d.Jo("BatchGetDocuments",d.serializer.databaseId,dt.emptyPath(),f,c.length),g=new Map;p.forEach(N=>{const E=nD(d.serializer,N);g.set(E.key.toString(),E)});const y=[];return c.forEach(N=>{const E=g.get(N.toString());Je(!!E,55234,{key:N}),y.push(E)}),y}(this.datastore,e);return t.forEach(i=>this.recordVersion(i)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new mf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,i)=>{const o=_e.fromPath(i);this.mutations.push(new PT(o,this.precondition(o)))}),await async function(i,o){const c=Oe(i),d={writes:o.map(f=>GT(c.serializer,f))};await c.Wo("Commit",c.serializer.databaseId,dt.emptyPath(),d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw je(50498,{Wu:e.constructor.name});t=we.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new me(ae.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(we.min())?dn.exists(!1):dn.updateTime(t):dn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(we.min()))throw new me(ae.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return dn.updateTime(t)}return dn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e,t,i,o,c){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=o,this.deferred=c,this.Gu=i.maxAttempts,this.F_=new vv(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{const e=new Ok(this.datastore),t=this.Ju(e);t&&t.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(o=>{this.Hu(o)}))}).catch(i=>{this.Hu(i)})})}Ju(e){try{const t=this.updateFunction(e);return!Eu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!LT(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fi="FirestoreClient";class Lk{constructor(e,t,i,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=yn.UNAUTHENTICATED,this.clientId=sv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(i,async d=>{ve(Fi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(i,d=>(ve(Fi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ea;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ev(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function Kp(n,e){n.asyncQueue.verifyOperationInProgress(),ve(Fi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async o=>{i.isEqual(o)||(await WT(e.localStore,o),i=o)}),e.persistence.setDatabaseDeletedListener(()=>{ki("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{ve("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(o=>{ki("Terminating Firestore due to IndexedDb database deletion failed",o)})}),n._offlineComponents=e}async function aE(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Vk(n);ve(Fi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>Z_(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,o)=>Z_(e.remoteStore,o)),n._onlineComponents=e}async function Vk(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ve(Fi,"Using user provided OfflineComponentProvider");try{await Kp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===ae.FAILED_PRECONDITION||o.code===ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;ki("Error using user provided cache. Falling back to memory cache: "+t),await Kp(n,new zh)}}else ve(Fi,"Using default OfflineComponentProvider"),await Kp(n,new kk(void 0));return n._offlineComponents}async function Rv(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ve(Fi,"Using user provided OnlineComponentProvider"),await aE(n,n._uninitializedComponentsProvider._online)):(ve(Fi,"Using default OnlineComponentProvider"),await aE(n,new Rg))),n._onlineComponents}function Uk(n){return Rv(n).then(e=>e.syncEngine)}function Fk(n){return Rv(n).then(e=>e.datastore)}async function Gh(n){const e=await Rv(n),t=e.eventManager;return t.onListen=bk.bind(null,e.syncEngine),t.onUnlisten=jk.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=_k.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Tk.bind(null,e.syncEngine),t}function qk(n,e,t={}){const i=new ea;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,g){const y=new Iv({next:E=>{y.Ou(),d.enqueueAndForget(()=>Tv(c,N));const A=E.docs.has(f);!A&&E.fromCache?g.reject(new me(ae.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&E.fromCache&&p&&p.source==="server"?g.reject(new me(ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(E)},error:E=>g.reject(E)}),N=new Cv(cf(f.path),y,{includeMetadataChanges:!0,ka:!0});return jv(c,N)}(await Gh(n),n.asyncQueue,e,t,i)),i.promise}function Hk(n,e,t={}){const i=new ea;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,g){const y=new Iv({next:E=>{y.Ou(),d.enqueueAndForget(()=>Tv(c,N)),E.fromCache&&p.source==="server"?g.reject(new me(ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(E)},error:E=>g.reject(E)}),N=new Cv(f,y,{includeMetadataChanges:!0,ka:!0});return jv(c,N)}(await Gh(n),n.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0="firestore.googleapis.com",rE=!0;class oE{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new me(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=p0,this.ssl=rE}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:rE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=KT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<vD)throw new me(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=m0((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new me(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new me(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new me(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,o){return i.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xf{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new oE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new oE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Q1;switch(i.type){case"firstParty":return new Z1(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new me(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=iE.get(t);i&&(ve("ComponentProvider","Removing Datastore"),iE.delete(t),i.terminate())}(this),Promise.resolve()}}function Bk(n,e,t,i={}){var o;n=Sn(n,xf);const c=Qr(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),p=`${e}:${t}`;c&&(Fg(`https://${p}`),qg("Firestore",!0)),d.host!==p0&&d.host!==p&&ki("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g=Object.assign(Object.assign({},d),{host:p,ssl:c,emulatorOptions:i});if(!Di(g,f)&&(n._setSettings(g),i.mockUserToken)){let y,N;if(typeof i.mockUserToken=="string")y=i.mockUserToken,N=yn.MOCK_USER;else{y=uj(i.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const E=i.mockUserToken.sub||i.mockUserToken.user_id;if(!E)throw new me(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");N=new yn(E)}n._authCredentials=new K1(new sT(y,N))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new za(this.firestore,e,this._query)}}class jt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ii(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new jt(this.firestore,e,this._key)}toJSON(){return{type:jt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(_u(t,jt._jsonSchema))return new jt(e,i||null,new _e(dt.fromString(t.referencePath)))}}jt._jsonSchemaVersion="firestore/documentReference/1.0",jt._jsonSchema={type:Ut("string",jt._jsonSchemaVersion),referencePath:Ut("string")};class Ii extends za{constructor(e,t,i){super(e,t,cf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jt(this.firestore,null,new _e(e))}withConverter(e){return new Ii(this.firestore,e,this._path)}}function Pe(n,e,...t){if(n=Nt(n),iT("collection","path",e),n instanceof xf){const i=dt.fromString(e,...t);return N_(i),new Ii(n,null,i)}{if(!(n instanceof jt||n instanceof Ii))throw new me(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(dt.fromString(e,...t));return N_(i),new Ii(n.firestore,null,i)}}function et(n,e,...t){if(n=Nt(n),arguments.length===1&&(e=sv.newId()),iT("doc","path",e),n instanceof xf){const i=dt.fromString(e,...t);return x_(i),new jt(n,null,new _e(i))}{if(!(n instanceof jt||n instanceof Ii))throw new me(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(dt.fromString(e,...t));return x_(i),new jt(n.firestore,n instanceof Ii?n.converter:null,new _e(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lE="AsyncQueue";class cE{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new vv(this,"async_queue_retry"),this.oc=()=>{const i=Qp();i&&ve(lE,"Visibility state changed to "+i.visibilityState),this.F_.y_()},this._c=e;const t=Qp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=Qp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new ea;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Nl(e))throw e;ve(lE,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(i=>{throw this.tc=i,this.nc=!1,qa("INTERNAL UNHANDLED ERROR: ",uE(i)),i}).then(i=>(this.nc=!1,i))));return this._c=t,t}enqueueAfterDelay(e,t,i){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const o=_v.createAndSchedule(this,e,t,i,c=>this.lc(c));return this.ec.push(o),o}ac(){this.tc&&je(47125,{hc:uE(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function uE(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dE(n){return function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of i)if(c in o&&typeof o[c]=="function")return!0;return!1}(n,["next","error","complete"])}class ia extends xf{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new cE,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new cE(e),this._firestoreClient=void 0,await e}}}function zk(n,e){const t=typeof n=="object"?n:vu(),i=typeof n=="string"?n:Oh,o=Ba(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const c=oj("firestore");c&&Bk(o,...c)}return o}function wu(n){if(n._terminated)throw new me(ae.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Gk(n),n._firestoreClient}function Gk(n){var e,t,i;const o=n._freezeSettings(),c=function(f,p,g,y){return new mM(f,p,g,y.host,y.ssl,y.experimentalForceLongPolling,y.experimentalAutoDetectLongPolling,m0(y.experimentalLongPollingOptions),y.useFetchStreams,y.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=o.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new Lk(n._authCredentials,n._appCheckCredentials,n._queue,c,n._componentsProvider&&function(f){const p=f?._online.build();return{_offline:f?._offline.build(p),_online:p}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $n(hn.fromBase64String(e))}catch(t){throw new me(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new $n(hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:$n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(_u(e,$n._jsonSchema))return $n.fromBase64String(e.bytes)}}$n._jsonSchemaVersion="firestore/bytes/1.0",$n._jsonSchema={type:Ut("string",$n._jsonSchemaVersion),bytes:Ut("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Be(this._lat,e._lat)||Be(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:na._jsonSchemaVersion}}static fromJSON(e){if(_u(e,na._jsonSchema))return new na(e.latitude,e.longitude)}}na._jsonSchemaVersion="firestore/geoPoint/1.0",na._jsonSchema={type:Ut("string",na._jsonSchemaVersion),latitude:Ut("number"),longitude:Ut("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,o){if(i.length!==o.length)return!1;for(let c=0;c<i.length;++c)if(i[c]!==o[c])return!1;return!0}(this._values,e._values)}toJSON(){return{type:sa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(_u(e,sa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new sa(e.vectorValues);throw new me(ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}sa._jsonSchemaVersion="firestore/vectorValue/1.0",sa._jsonSchema={type:Ut("string",sa._jsonSchemaVersion),vectorValues:Ut("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $k=/^__.*__$/;class Yk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Ki(e,this.data,this.fieldMask,t,this.fieldTransforms):new ju(e,this.data,t,this.fieldTransforms)}}class g0{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Ki(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function v0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw je(40011,{Ec:n})}}class Mv{constructor(e,t,i,o,c,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,c===void 0&&this.Ac(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Mv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.Rc({path:i,mc:!1});return o.fc(e),o}gc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.Rc({path:i,mc:!1});return o.Ac(),o}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return $h(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(v0(this.Ec)&&$k.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class Qk{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||gf(e)}Dc(e,t,i,o=!1){return new Mv({Ec:e,methodName:t,bc:i,path:un.emptyPath(),mc:!1,Sc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Iu(n){const e=n._freezeSettings(),t=gf(n._databaseId);return new Qk(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Dv(n,e,t,i,o,c={}){const d=n.Dc(c.merge||c.mergeFields?2:0,e,t,o);Ov("Data must be an object, but it was:",d,i);const f=N0(i,d);let p,g;if(c.merge)p=new Yn(d.fieldMask),g=d.fieldTransforms;else if(c.mergeFields){const y=[];for(const N of c.mergeFields){const E=Mg(e,N,t);if(!d.contains(E))throw new me(ae.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);_0(y,E)||y.push(E)}p=new Yn(y),g=d.fieldTransforms.filter(N=>p.covers(N.field))}else p=null,g=d.fieldTransforms;return new Yk(new wn(f),p,g)}class bf extends Nf{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bf}}class kv extends Nf{_toFieldTransform(e){return new FM(e.path,new lu)}isEqual(e){return e instanceof kv}}function y0(n,e,t,i){const o=n.Dc(1,e,t);Ov("Data must be an object, but it was:",o,i);const c=[],d=wn.empty();Qi(i,(p,g)=>{const y=Pv(e,p,t);g=Nt(g);const N=o.gc(y);if(g instanceof bf)c.push(y);else{const E=Ru(g,N);E!=null&&(c.push(y),d.set(y,E))}});const f=new Yn(c);return new g0(d,f,o.fieldTransforms)}function x0(n,e,t,i,o,c){const d=n.Dc(1,e,t),f=[Mg(e,i,t)],p=[o];if(c.length%2!=0)throw new me(ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<c.length;E+=2)f.push(Mg(e,c[E])),p.push(c[E+1]);const g=[],y=wn.empty();for(let E=f.length-1;E>=0;--E)if(!_0(g,f[E])){const A=f[E];let T=p[E];T=Nt(T);const R=d.gc(A);if(T instanceof bf)g.push(A);else{const b=Ru(T,R);b!=null&&(g.push(A),y.set(A,b))}}const N=new Yn(g);return new g0(y,N,d.fieldTransforms)}function Kk(n,e,t,i=!1){return Ru(t,n.Dc(i?4:3,e))}function Ru(n,e){if(b0(n=Nt(n)))return Ov("Unsupported field value:",e,n),N0(n,e);if(n instanceof Nf)return function(i,o){if(!v0(o.Ec))throw o.wc(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.wc(`${i._methodName}() is not currently supported inside arrays`);const c=i._toFieldTransform(o);c&&o.fieldTransforms.push(c)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(i,o){const c=[];let d=0;for(const f of i){let p=Ru(f,o.yc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}}(n,e)}return function(i,o){if((i=Nt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return LM(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const c=xt.fromDate(i);return{timestampValue:Fh(o.serializer,c)}}if(i instanceof xt){const c=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Fh(o.serializer,c)}}if(i instanceof na)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof $n)return{bytesValue:qT(o.serializer,i._byteString)};if(i instanceof jt){const c=o.databaseId,d=i.firestore._databaseId;if(!d.isEqual(c))throw o.wc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:hv(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof sa)return function(d,f){return{mapValue:{fields:{[mT]:{stringValue:pT},[Ph]:{arrayValue:{values:d.toArray().map(g=>{if(typeof g!="number")throw f.wc("VectorValues must only contain numeric values.");return cv(f.serializer,g)})}}}}}}(i,o);throw o.wc(`Unsupported field value: ${rf(i)}`)}(n,e)}function N0(n,e){const t={};return lT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qi(n,(i,o)=>{const c=Ru(o,e.Vc(i));c!=null&&(t[i]=c)}),{mapValue:{fields:t}}}function b0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xt||n instanceof na||n instanceof $n||n instanceof jt||n instanceof Nf||n instanceof sa)}function Ov(n,e,t){if(!b0(t)||!rT(t)){const i=rf(t);throw i==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+i)}}function Mg(n,e,t){if((e=Nt(e))instanceof Su)return e._internalPath;if(typeof e=="string")return Pv(n,e);throw $h("Field path arguments must be of type string or ",n,!1,void 0,t)}const Xk=new RegExp("[~\\*/\\[\\]]");function Pv(n,e,t){if(e.search(Xk)>=0)throw $h(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Su(...e.split("."))._internalPath}catch{throw $h(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $h(n,e,t,i,o){const c=i&&!i.isEmpty(),d=o!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${i}`),d&&(p+=` in document ${o}`),p+=")"),new me(ae.INVALID_ARGUMENT,f+n+p)}function _0(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,t,i,o,c){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Wk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(_f("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Wk extends Yh{data(){return super.data()}}function _f(n,e){return typeof e=="string"?Pv(n,e):e instanceof Su?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Lv{}class Vv extends Lv{}function Te(n,e,...t){let i=[];e instanceof Lv&&i.push(e),i=i.concat(t),function(c){const d=c.filter(p=>p instanceof Uv).length,f=c.filter(p=>p instanceof Ef).length;if(d>1||d>0&&f>0)throw new me(ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const o of i)n=o._apply(n);return n}class Ef extends Vv{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Ef(e,t,i)}_apply(e){const t=this._parse(e);return j0(e._query,t),new za(e.firestore,e.converter,Eg(e._query,t))}_parse(e){const t=Iu(e.firestore);return function(c,d,f,p,g,y,N){let E;if(g.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new me(ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){fE(N,y);const T=[];for(const R of N)T.push(hE(p,c,R));E={arrayValue:{values:T}}}else E=hE(p,c,N)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||fE(N,y),E=Kk(f,d,N,y==="in"||y==="not-in");return Vt.create(g,y,E)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function De(n,e,t){const i=e,o=_f("where",n);return Ef._create(o,i,t)}class Uv extends Lv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Uv(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Is.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,c){let d=o;const f=c.getFlattenedFilters();for(const p of f)j0(d,p),d=Eg(d,p)}(e._query,t),new za(e.firestore,e.converter,Eg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Fv extends Vv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Fv(e,t)}_apply(e){const t=function(o,c,d){if(o.startAt!==null)throw new me(ae.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new me(ae.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ou(c,d)}(e._query,this._field,this._direction);return new za(e.firestore,e.converter,function(o,c){const d=o.explicitOrderBy.concat([c]);return new bl(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function In(n,e="asc"){const t=e,i=_f("orderBy",n);return Fv._create(i,t)}class qv extends Vv{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new qv(e,t,i)}_apply(e){return new za(e.firestore,e.converter,Vh(e._query,this._limit,this._limitType))}}function Zk(n){return qv._create("limit",n,"F")}function hE(n,e,t){if(typeof(t=Nt(t))=="string"){if(t==="")throw new me(ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ET(e)&&t.indexOf("/")!==-1)throw new me(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(dt.fromString(t));if(!_e.isDocumentKey(i))throw new me(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return w_(n,new _e(i))}if(t instanceof jt)return w_(n,t._key);throw new me(ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rf(t)}.`)}function fE(n,e){if(!Array.isArray(n)||n.length===0)throw new me(ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function j0(n,e){const t=function(o,c){for(const d of o)for(const f of d.getFlattenedFilters())if(c.indexOf(f.op)>=0)return f.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new me(ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class T0{convertValue(e,t="none"){switch(Vi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Mt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Li(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw je(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Qi(e,(o,c)=>{i[o]=this.convertValue(c,t)}),i}convertVectorValue(e){var t,i,o;const c=(o=(i=(t=e.fields)===null||t===void 0?void 0:t[Ph].arrayValue)===null||i===void 0?void 0:i.values)===null||o===void 0?void 0:o.map(d=>Mt(d.doubleValue));return new sa(c)}convertGeoPoint(e){return new na(Mt(e.latitude),Mt(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=lf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(au(e));default:return null}}convertTimestamp(e){const t=Pi(e);return new xt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=dt.fromString(e);Je(QT(i),9688,{name:e});const o=new iu(i.get(1),i.get(3)),c=new _e(i.popFirst(5));return o.isEqual(t)||qa(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hv(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Jk extends T0{constructor(e){super(),this.firestore=e}convertBytes(e){return new $n(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,t)}}class Jo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ri extends Yh{constructor(e,t,i,o,c,d){super(e,t,i,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Eh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(_f("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ri._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ri._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ri._jsonSchema={type:Ut("string",Ri._jsonSchemaVersion),bundleSource:Ut("string","DocumentSnapshot"),bundleName:Ut("string"),bundle:Ut("string")};class Eh extends Ri{data(e={}){return super.data(e)}}class Ur{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Jo(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Eh(this._firestore,this._userDataWriter,i.key,i,new Jo(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map(f=>{const p=new Eh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Jo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}})}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(f=>c||f.type!==3).map(f=>{const p=new Eh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Jo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,y=-1;return f.type!==0&&(g=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),y=d.indexOf(f.doc.key)),{type:eO(f.type),doc:p,oldIndex:g,newIndex:y}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ur._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=sv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach(c=>{c._document!==null&&(t.push(c._document),i.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),o.push(c.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function eO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return je(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(n){n=Sn(n,jt);const e=Sn(n.firestore,ia);return qk(wu(e),n._key).then(t=>A0(e,n,t))}Ur._jsonSchemaVersion="firestore/querySnapshot/1.0",Ur._jsonSchema={type:Ut("string",Ur._jsonSchemaVersion),bundleSource:Ut("string","QuerySnapshot"),bundleName:Ut("string"),bundle:Ut("string")};class jf extends T0{constructor(e){super(),this.firestore=e}convertBytes(e){return new $n(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,t)}}function mt(n){n=Sn(n,za);const e=Sn(n.firestore,ia),t=wu(e),i=new jf(e);return E0(n._query),Hk(t,n._query).then(o=>new Ur(e,i,n,o))}function Tf(n,e,t){n=Sn(n,jt);const i=Sn(n.firestore,ia),o=Hv(n.converter,e,t);return Cf(i,[Dv(Iu(i),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,dn.none())])}function Rs(n,e,t,...i){n=Sn(n,jt);const o=Sn(n.firestore,ia),c=Iu(o);let d;return d=typeof(e=Nt(e))=="string"||e instanceof Su?x0(c,"updateDoc",n._key,e,t,i):y0(c,"updateDoc",n._key,e),Cf(o,[d.toMutation(n._key,dn.exists(!0))])}function Af(n){return Cf(Sn(n.firestore,ia),[new mf(n._key,dn.none())])}function El(n,e){const t=Sn(n.firestore,ia),i=et(n),o=Hv(n.converter,e);return Cf(t,[Dv(Iu(n.firestore),"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,dn.exists(!1))]).then(()=>i)}function Zr(n,...e){var t,i,o;n=Nt(n);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||dE(e[d])||(c=e[d++]);const f={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(dE(e[d])){const N=e[d];e[d]=(t=N.next)===null||t===void 0?void 0:t.bind(N),e[d+1]=(i=N.error)===null||i===void 0?void 0:i.bind(N),e[d+2]=(o=N.complete)===null||o===void 0?void 0:o.bind(N)}let p,g,y;if(n instanceof jt)g=Sn(n.firestore,ia),y=cf(n._key.path),p={next:N=>{e[d]&&e[d](A0(g,n,N))},error:e[d+1],complete:e[d+2]};else{const N=Sn(n,za);g=Sn(N.firestore,ia),y=N._query;const E=new jf(g);p={next:A=>{e[d]&&e[d](new Ur(g,E,N,A))},error:e[d+1],complete:e[d+2]},E0(n._query)}return function(E,A,T,R){const b=new Iv(R),k=new Cv(A,b,T);return E.asyncQueue.enqueueAndForget(async()=>jv(await Gh(E),k)),()=>{b.Ou(),E.asyncQueue.enqueueAndForget(async()=>Tv(await Gh(E),k))}}(wu(g),y,f,p)}function Cf(n,e){return function(i,o){const c=new ea;return i.asyncQueue.enqueueAndForget(async()=>Ak(await Uk(i),o,c)),c.promise}(wu(n),e)}function A0(n,e,t){const i=t.docs.get(e._key),o=new jf(n);return new Ri(n,o,e._key,i,new Jo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tO={maxAttempts:5};function qc(n,e){if((n=Nt(n)).firestore!==e)throw new me(ae.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Iu(e)}get(e){const t=qc(e,this._firestore),i=new Jk(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return je(24041);const c=o[0];if(c.isFoundDocument())return new Yh(this._firestore,i,c.key,c,t.converter);if(c.isNoDocument())return new Yh(this._firestore,i,t._key,null,t.converter);throw je(18433,{doc:c})})}set(e,t,i){const o=qc(e,this._firestore),c=Hv(o.converter,t,i),d=Dv(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,i);return this._transaction.set(o._key,d),this}update(e,t,i,...o){const c=qc(e,this._firestore);let d;return d=typeof(t=Nt(t))=="string"||t instanceof Su?x0(this._dataReader,"Transaction.update",c._key,t,i,o):y0(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,d),this}delete(e){const t=qc(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO extends nO{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=qc(e,this._firestore),i=new jf(this._firestore);return super.get(e).then(o=>new Ri(this._firestore,i,t._key,o._document,new Jo(!1,!1),t.converter))}}function Bv(n,e,t){n=Sn(n,ia);const i=Object.assign(Object.assign({},tO),t);return function(c){if(c.maxAttempts<1)throw new me(ae.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(c,d,f){const p=new ea;return c.asyncQueue.enqueueAndForget(async()=>{const g=await Fk(c);new Pk(c.asyncQueue,g,f,d,p).zu()}),p.promise}(wu(n),o=>e(new sO(n,o)),i)}function qe(){return new kv("serverTimestamp")}(function(e,t=!0){(function(o){yl=o})(Kr),ms(new Wn("firestore",(i,{instanceIdentifier:o,options:c})=>{const d=i.getProvider("app").getImmediate(),f=new ia(new X1(i.getProvider("auth-internal")),new J1(d,i.getProvider("app-check-internal")),function(g,y){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new me(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new iu(g.options.projectId,y)}(d,o),d);return c=Object.assign({useFetchStreams:t},c),f._setSettings(c),f},"PUBLIC").setMultipleInstances(!0)),bn(m_,p_,e),bn(m_,p_,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0="firebasestorage.googleapis.com",aO="storageBucket",iO=2*60*1e3,rO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa extends gs{constructor(e,t,i=0){super(Xp(e),`Firebase Storage: ${t} (${Xp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,oa.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Xp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ra;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ra||(ra={}));function Xp(n){return"storage/"+n}function oO(){const n="An unknown error occurred, please check the error payload for server response.";return new oa(ra.UNKNOWN,n)}function lO(){return new oa(ra.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function cO(){return new oa(ra.CANCELED,"User canceled the upload/download.")}function uO(n){return new oa(ra.INVALID_URL,"Invalid URL '"+n+"'.")}function dO(n){return new oa(ra.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function mE(n){return new oa(ra.INVALID_ARGUMENT,n)}function w0(){return new oa(ra.APP_DELETED,"The Firebase app was deleted.")}function hO(n){return new oa(ra.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Cs.makeFromUrl(e,t)}catch{return new Cs(e,"")}if(i.path==="")return i;throw dO(e)}static makeFromUrl(e,t){let i=null;const o="([A-Za-z0-9.\\-_]+)";function c(S){S.path.charAt(S.path.length-1)==="/"&&(S.path_=S.path_.slice(0,-1))}const d="(/(.*))?$",f=new RegExp("^gs://"+o+d,"i"),p={bucket:1,path:3};function g(S){S.path_=decodeURIComponent(S.path)}const y="v[A-Za-z0-9_]+",N=t.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",A=new RegExp(`^https?://${N}/${y}/b/${o}/o${E}`,"i"),T={bucket:1,path:3},R=t===C0?"(?:storage.googleapis.com|storage.cloud.google.com)":t,b="([^?#]*)",k=new RegExp(`^https?://${R}/${o}/${b}`,"i"),j=[{regex:f,indices:p,postModify:c},{regex:A,indices:T,postModify:g},{regex:k,indices:{bucket:1,path:2},postModify:g}];for(let S=0;S<j.length;S++){const O=j[S],B=O.regex.exec(e);if(B){const L=B[O.indices.bucket];let M=B[O.indices.path];M||(M=""),i=new Cs(L,M),O.postModify(i);break}}if(i==null)throw uO(e);return i}}class fO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mO(n,e,t){let i=1,o=null,c=null,d=!1,f=0;function p(){return f===2}let g=!1;function y(...b){g||(g=!0,e.apply(null,b))}function N(b){o=setTimeout(()=>{o=null,n(A,p())},b)}function E(){c&&clearTimeout(c)}function A(b,...k){if(g){E();return}if(b){E(),y.call(null,b,...k);return}if(p()||d){E(),y.call(null,b,...k);return}i<64&&(i*=2);let j;f===1?(f=2,j=0):j=(i+Math.random())*1e3,N(j)}let T=!1;function R(b){T||(T=!0,E(),!g&&(o!==null?(b||(f=2),clearTimeout(o),N(0)):b||(f=1)))}return N(0),c=setTimeout(()=>{d=!0,R(!0)},t),R}function pO(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gO(n){return n!==void 0}function pE(n,e,t,i){if(i<e)throw mE(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw mE(`Invalid value for '${n}'. Expected ${t} or less.`)}function vO(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const o=e(i)+"="+e(n[i]);t=t+o+"&"}return t=t.slice(0,-1),t}var Qh;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Qh||(Qh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yO(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(e,t,i,o,c,d,f,p,g,y,N,E=!0,A=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=f,this.errorCallback_=p,this.timeout_=g,this.progressCallback_=y,this.connectionFactory_=N,this.retry=E,this.isUsingEmulator=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,R)=>{this.resolve_=T,this.reject_=R,this.start_()})}start_(){const e=(i,o)=>{if(o){i(!1,new dh(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=f=>{const p=f.loaded,g=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,g)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const f=c.getErrorCode()===Qh.NO_ERROR,p=c.getStatus();if(!f||yO(p,this.additionalRetryCodes_)&&this.retry){const y=c.getErrorCode()===Qh.ABORT;i(!1,new dh(!1,null,y));return}const g=this.successCodes_.indexOf(p)!==-1;i(!0,new dh(g,c))})},t=(i,o)=>{const c=this.resolve_,d=this.reject_,f=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(f,f.getResponse());gO(p)?c(p):c()}catch(p){d(p)}else if(f!==null){const p=oO();p.serverResponse=f.getErrorText(),this.errorCallback_?d(this.errorCallback_(f,p)):d(p)}else if(o.canceled){const p=this.appDelete_?w0():cO();d(p)}else{const p=lO();d(p)}};this.canceled_?t(!1,new dh(!1,null,!0)):this.backoffId_=mO(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&pO(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class dh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function NO(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function bO(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function _O(n,e){e&&(n["X-Firebase-GMPID"]=e)}function EO(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function jO(n,e,t,i,o,c,d=!0,f=!1){const p=vO(n.urlParams),g=n.url+p,y=Object.assign({},n.headers);return _O(y,e),NO(y,t),bO(y,c),EO(y,i),new xO(g,n.method,y,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,f)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TO(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function AO(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e,t){this._service=e,t instanceof Cs?this._location=t:this._location=Cs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Kh(e,t)}get root(){const e=new Cs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return AO(this._location.path)}get storage(){return this._service}get parent(){const e=TO(this._location.path);if(e===null)return null;const t=new Cs(this._location.bucket,e);return new Kh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw hO(e)}}function gE(n,e){const t=e?.[aO];return t==null?null:Cs.makeFromBucketSpec(t,n)}function CO(n,e,t,i={}){n.host=`${e}:${t}`;const o=Qr(e);o&&(Fg(`https://${n.host}/b`),qg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=i;c&&(n._overrideAuthToken=typeof c=="string"?c:uj(c,n.app.options.projectId))}class wO{constructor(e,t,i,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=C0,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=iO,this._maxUploadRetryTime=rO,this._requests=new Set,o!=null?this._bucket=Cs.makeFromBucketSpec(o,this._host):this._bucket=gE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Cs.makeFromBucketSpec(this._url,e):this._bucket=gE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){pE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){pE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(On(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Kh(this,e)}_makeRequest(e,t,i,o,c=!0){if(this._deleted)return new fO(w0());{const d=jO(e,this._appId,i,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,o).getPromise()}}const vE="@firebase/storage",yE="0.13.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0="storage";function SO(n=vu(),e){n=Nt(n);const i=Ba(n,S0).getImmediate({identifier:e}),o=oj("storage");return o&&IO(i,...o),i}function IO(n,e,t,i={}){CO(n,e,t,i)}function RO(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new wO(t,i,o,e,Kr)}function MO(){ms(new Wn(S0,RO,"PUBLIC").setMultipleInstances(!0)),bn(vE,yE,""),bn(vE,yE,"esm2017")}MO();const I0="@firebase/installations",zv="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0=1e4,M0=`w:${zv}`,D0="FIS_v2",DO="https://firebaseinstallations.googleapis.com/v1",kO=60*60*1e3,OO="installations",PO="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},$r=new zi(OO,PO,LO);function k0(n){return n instanceof gs&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O0({projectId:n}){return`${DO}/projects/${n}/installations`}function P0(n){return{token:n.token,requestStatus:2,expiresIn:UO(n.expiresIn),creationTime:Date.now()}}async function L0(n,e){const i=(await e.json()).error;return $r.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function V0({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function VO(n,{refreshToken:e}){const t=V0(n);return t.append("Authorization",FO(e)),t}async function U0(n){const e=await n();return e.status>=500&&e.status<600?n():e}function UO(n){return Number(n.replace("s","000"))}function FO(n){return`${D0} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qO({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=O0(n),o=V0(n),c=e.getImmediate({optional:!0});if(c){const g=await c.getHeartbeatsHeader();g&&o.append("x-firebase-client",g)}const d={fid:t,authVersion:D0,appId:n.appId,sdkVersion:M0},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await U0(()=>fetch(i,f));if(p.ok){const g=await p.json();return{fid:g.fid||t,registrationStatus:2,refreshToken:g.refreshToken,authToken:P0(g.authToken)}}else throw await L0("Create Installation",p)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F0(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HO(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BO=/^[cdef][\w-]{21}$/,Dg="";function zO(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=GO(n);return BO.test(t)?t:Dg}catch{return Dg}}function GO(n){return HO(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q0=new Map;function H0(n,e){const t=wf(n);B0(t,e),$O(t,e)}function B0(n,e){const t=q0.get(n);if(t)for(const i of t)i(e)}function $O(n,e){const t=YO();t&&t.postMessage({key:n,fid:e}),QO()}let Lr=null;function YO(){return!Lr&&"BroadcastChannel"in self&&(Lr=new BroadcastChannel("[Firebase] FID Change"),Lr.onmessage=n=>{B0(n.data.key,n.data.fid)}),Lr}function QO(){q0.size===0&&Lr&&(Lr.close(),Lr=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KO="firebase-installations-database",XO=1,Yr="firebase-installations-store";let Wp=null;function Gv(){return Wp||(Wp=fj(KO,XO,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Yr)}}})),Wp}async function Xh(n,e){const t=wf(n),o=(await Gv()).transaction(Yr,"readwrite"),c=o.objectStore(Yr),d=await c.get(t);return await c.put(e,t),await o.done,(!d||d.fid!==e.fid)&&H0(n,e.fid),e}async function z0(n){const e=wf(n),i=(await Gv()).transaction(Yr,"readwrite");await i.objectStore(Yr).delete(e),await i.done}async function Sf(n,e){const t=wf(n),o=(await Gv()).transaction(Yr,"readwrite"),c=o.objectStore(Yr),d=await c.get(t),f=e(d);return f===void 0?await c.delete(t):await c.put(f,t),await o.done,f&&(!d||d.fid!==f.fid)&&H0(n,f.fid),f}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $v(n){let e;const t=await Sf(n.appConfig,i=>{const o=WO(i),c=ZO(n,o);return e=c.registrationPromise,c.installationEntry});return t.fid===Dg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function WO(n){const e=n||{fid:zO(),registrationStatus:0};return G0(e)}function ZO(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject($r.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=JO(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:eP(n)}:{installationEntry:e}}async function JO(n,e){try{const t=await qO(n,e);return Xh(n.appConfig,t)}catch(t){throw k0(t)&&t.customData.serverCode===409?await z0(n.appConfig):await Xh(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function eP(n){let e=await xE(n.appConfig);for(;e.registrationStatus===1;)await F0(100),e=await xE(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await $v(n);return i||t}return e}function xE(n){return Sf(n,e=>{if(!e)throw $r.create("installation-not-found");return G0(e)})}function G0(n){return tP(n)?{fid:n.fid,registrationStatus:0}:n}function tP(n){return n.registrationStatus===1&&n.registrationTime+R0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nP({appConfig:n,heartbeatServiceProvider:e},t){const i=sP(n,t),o=VO(n,t),c=e.getImmediate({optional:!0});if(c){const g=await c.getHeartbeatsHeader();g&&o.append("x-firebase-client",g)}const d={installation:{sdkVersion:M0,appId:n.appId}},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await U0(()=>fetch(i,f));if(p.ok){const g=await p.json();return P0(g)}else throw await L0("Generate Auth Token",p)}function sP(n,{fid:e}){return`${O0(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yv(n,e=!1){let t;const i=await Sf(n.appConfig,c=>{if(!$0(c))throw $r.create("not-registered");const d=c.authToken;if(!e&&rP(d))return c;if(d.requestStatus===1)return t=aP(n,e),c;{if(!navigator.onLine)throw $r.create("app-offline");const f=lP(c);return t=iP(n,f),f}});return t?await t:i.authToken}async function aP(n,e){let t=await NE(n.appConfig);for(;t.authToken.requestStatus===1;)await F0(100),t=await NE(n.appConfig);const i=t.authToken;return i.requestStatus===0?Yv(n,e):i}function NE(n){return Sf(n,e=>{if(!$0(e))throw $r.create("not-registered");const t=e.authToken;return cP(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function iP(n,e){try{const t=await nP(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return await Xh(n.appConfig,i),t}catch(t){if(k0(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await z0(n.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Xh(n.appConfig,i)}throw t}}function $0(n){return n!==void 0&&n.registrationStatus===2}function rP(n){return n.requestStatus===2&&!oP(n)}function oP(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+kO}function lP(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function cP(n){return n.requestStatus===1&&n.requestTime+R0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uP(n){const e=n,{installationEntry:t,registrationPromise:i}=await $v(e);return i?i.catch(console.error):Yv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dP(n,e=!1){const t=n;return await hP(t),(await Yv(t,e)).token}async function hP(n){const{registrationPromise:e}=await $v(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fP(n){if(!n||!n.options)throw Zp("App Configuration");if(!n.name)throw Zp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Zp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Zp(n){return $r.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0="installations",mP="installations-internal",pP=n=>{const e=n.getProvider("app").getImmediate(),t=fP(e),i=Ba(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},gP=n=>{const e=n.getProvider("app").getImmediate(),t=Ba(e,Y0).getImmediate();return{getId:()=>uP(t),getToken:o=>dP(t,o)}};function vP(){ms(new Wn(Y0,pP,"PUBLIC")),ms(new Wn(mP,gP,"PRIVATE"))}vP();bn(I0,zv);bn(I0,zv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wh="analytics",yP="firebase_id",xP="origin",NP=60*1e3,bP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Qv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pn=new gu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _P={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Xn=new zi("analytics","Analytics",_P);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EP(n){if(!n.startsWith(Qv)){const e=Xn.create("invalid-gtag-resource",{gtagURL:n});return Pn.warn(e.message),""}return n}function Q0(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function jP(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function TP(n,e){const t=jP("firebase-js-sdk-policy",{createScriptURL:EP}),i=document.createElement("script"),o=`${Qv}?l=${n}&id=${e}`;i.src=t?t?.createScriptURL(o):o,i.async=!0,document.head.appendChild(i)}function AP(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function CP(n,e,t,i,o,c){const d=i[o];try{if(d)await e[d];else{const p=(await Q0(t)).find(g=>g.measurementId===o);p&&await e[p.appId]}}catch(f){Pn.error(f)}n("config",o,c)}async function wP(n,e,t,i,o){try{let c=[];if(o&&o.send_to){let d=o.send_to;Array.isArray(d)||(d=[d]);const f=await Q0(t);for(const p of d){const g=f.find(N=>N.measurementId===p),y=g&&e[g.appId];if(y)c.push(y);else{c=[];break}}}c.length===0&&(c=Object.values(e)),await Promise.all(c),n("event",i,o||{})}catch(c){Pn.error(c)}}function SP(n,e,t,i){async function o(c,...d){try{if(c==="event"){const[f,p]=d;await wP(n,e,t,f,p)}else if(c==="config"){const[f,p]=d;await CP(n,e,t,i,f,p)}else if(c==="consent"){const[f,p]=d;n("consent",f,p)}else if(c==="get"){const[f,p,g]=d;n("get",f,p,g)}else if(c==="set"){const[f]=d;n("set",f)}else n(c,...d)}catch(f){Pn.error(f)}}return o}function IP(n,e,t,i,o){let c=function(...d){window[i].push(arguments)};return window[o]&&typeof window[o]=="function"&&(c=window[o]),window[o]=SP(c,n,e,t),{gtagCore:c,wrappedGtag:window[o]}}function RP(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Qv)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP=30,DP=1e3;class kP{constructor(e={},t=DP){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const K0=new kP;function OP(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function PP(n){var e;const{appId:t,apiKey:i}=n,o={method:"GET",headers:OP(i)},c=bP.replace("{app-id}",t),d=await fetch(c,o);if(d.status!==200&&d.status!==304){let f="";try{const p=await d.json();!((e=p.error)===null||e===void 0)&&e.message&&(f=p.error.message)}catch{}throw Xn.create("config-fetch-failed",{httpStatus:d.status,responseMessage:f})}return d.json()}async function LP(n,e=K0,t){const{appId:i,apiKey:o,measurementId:c}=n.options;if(!i)throw Xn.create("no-app-id");if(!o){if(c)return{measurementId:c,appId:i};throw Xn.create("no-api-key")}const d=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},f=new FP;return setTimeout(async()=>{f.abort()},NP),X0({appId:i,apiKey:o,measurementId:c},d,f,e)}async function X0(n,{throttleEndTimeMillis:e,backoffCount:t},i,o=K0){var c;const{appId:d,measurementId:f}=n;try{await VP(i,e)}catch(p){if(f)return Pn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:d,measurementId:f};throw p}try{const p=await PP(n);return o.deleteThrottleMetadata(d),p}catch(p){const g=p;if(!UP(g)){if(o.deleteThrottleMetadata(d),f)return Pn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:d,measurementId:f};throw p}const y=Number((c=g?.customData)===null||c===void 0?void 0:c.httpStatus)===503?Ub(t,o.intervalMillis,MP):Ub(t,o.intervalMillis),N={throttleEndTimeMillis:Date.now()+y,backoffCount:t+1};return o.setThrottleMetadata(d,N),Pn.debug(`Calling attemptFetch again in ${y} millis`),X0(n,N,i,o)}}function VP(n,e){return new Promise((t,i)=>{const o=Math.max(e-Date.now(),0),c=setTimeout(t,o);n.addEventListener(()=>{clearTimeout(c),i(Xn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function UP(n){if(!(n instanceof gs)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class FP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function qP(n,e,t,i,o){if(o&&o.global){n("event",t,i);return}else{const c=await e,d=Object.assign(Object.assign({},i),{send_to:c});n("event",t,d)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HP(){if(ef())try{await tf()}catch(n){return Pn.warn(Xn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Pn.warn(Xn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function BP(n,e,t,i,o,c,d){var f;const p=LP(n);p.then(A=>{t[A.measurementId]=A.appId,n.options.measurementId&&A.measurementId!==n.options.measurementId&&Pn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${A.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(A=>Pn.error(A)),e.push(p);const g=HP().then(A=>{if(A)return i.getId()}),[y,N]=await Promise.all([p,g]);RP(c)||TP(c,y.measurementId),o("js",new Date);const E=(f=d?.config)!==null&&f!==void 0?f:{};return E[xP]="firebase",E.update=!0,N!=null&&(E[yP]=N),o("config",y.measurementId,E),y.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e){this.app=e}_delete(){return delete Kc[this.app.options.appId],Promise.resolve()}}let Kc={},bE=[];const _E={};let Jp="dataLayer",GP="gtag",EE,W0,jE=!1;function $P(){const n=[];if(Hg()&&n.push("This is a browser extension environment."),Bg()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,o)=>`(${o+1}) ${i}`).join(" "),t=Xn.create("invalid-analytics-context",{errorInfo:e});Pn.warn(t.message)}}function YP(n,e,t){$P();const i=n.options.appId;if(!i)throw Xn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Pn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Xn.create("no-api-key");if(Kc[i]!=null)throw Xn.create("already-exists",{id:i});if(!jE){AP(Jp);const{wrappedGtag:c,gtagCore:d}=IP(Kc,bE,_E,Jp,GP);W0=c,EE=d,jE=!0}return Kc[i]=BP(n,bE,_E,e,EE,Jp,t),new zP(n)}function QP(n=vu()){n=Nt(n);const e=Ba(n,Wh);return e.isInitialized()?e.getImmediate():KP(n)}function KP(n,e={}){const t=Ba(n,Wh);if(t.isInitialized()){const o=t.getImmediate();if(Di(e,t.getOptions()))return o;throw Xn.create("already-initialized")}return t.initialize({options:e})}async function XP(){if(Hg()||!Bg()||!ef())return!1;try{return await tf()}catch{return!1}}function WP(n,e,t,i){n=Nt(n),qP(W0,Kc[n.app.options.appId],e,t,i).catch(o=>Pn.error(o))}const TE="@firebase/analytics",AE="0.10.17";function ZP(){ms(new Wn(Wh,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return YP(i,o,t)},"PUBLIC")),ms(new Wn("analytics-internal",n,"PRIVATE")),bn(TE,AE),bn(TE,AE,"esm2017");function n(e){try{const t=e.getProvider(Wh).getImmediate();return{logEvent:(i,o,c)=>WP(t,i,o,c)}}catch(t){throw Xn.create("interop-component-reg-failed",{reason:t})}}}ZP();var kg,CE,If=function(){var n=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(n&&n.responseStart>0&&n.responseStart<performance.now())return n},Z0=function(n){if(document.readyState==="loading")return"loading";var e=If();if(e){if(n<e.domInteractive)return"loading";if(e.domContentLoadedEventStart===0||n<e.domContentLoadedEventStart)return"dom-interactive";if(e.domComplete===0||n<e.domComplete)return"dom-content-loaded"}return"complete"},JP=function(n){var e=n.nodeName;return n.nodeType===1?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},Kv=function(n,e){var t="";try{for(;n&&n.nodeType!==9;){var i=n,o=i.id?"#"+i.id:JP(i)+(i.classList&&i.classList.value&&i.classList.value.trim()&&i.classList.value.trim().length?"."+i.classList.value.trim().replace(/\s+/g,"."):"");if(t.length+o.length>(e||100)-1)return t||o;if(t=t?o+">"+t:o,i.id)break;n=i.parentNode}}catch{}return t},J0=-1,eL=function(){return J0},Mu=function(n){addEventListener("pageshow",function(e){e.persisted&&(J0=e.timeStamp,n(e))},!0)},Xv=function(){var n=If();return n&&n.activationStart||0},qi=function(n,e){var t=If(),i="navigate";return eL()>=0?i="back-forward-cache":t&&(document.prerendering||Xv()>0?i="prerender":document.wasDiscarded?i="restore":t.type&&(i=t.type.replace(/_/g,"-"))),{name:n,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},jl=function(n,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(n)){var i=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return i.observe(Object.assign({type:n,buffered:!0},t||{})),i}}catch{}},Hi=function(n,e,t,i){var o,c;return function(d){e.value>=0&&(d||i)&&((c=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=c,e.rating=function(f,p){return f>p[1]?"poor":f>p[0]?"needs-improvement":"good"}(e.value,t),n(e))}},Wv=function(n){requestAnimationFrame(function(){return requestAnimationFrame(function(){return n()})})},Rf=function(n){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&n()})},Zv=function(n){var e=!1;return function(){e||(n(),e=!0)}},el=-1,wE=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},Zh=function(n){document.visibilityState==="hidden"&&el>-1&&(el=n.type==="visibilitychange"?n.timeStamp:0,tL())},SE=function(){addEventListener("visibilitychange",Zh,!0),addEventListener("prerenderingchange",Zh,!0)},tL=function(){removeEventListener("visibilitychange",Zh,!0),removeEventListener("prerenderingchange",Zh,!0)},eA=function(){return el<0&&(el=wE(),SE(),Mu(function(){setTimeout(function(){el=wE(),SE()},0)})),{get firstHiddenTime(){return el}}},Jv=function(n){document.prerendering?addEventListener("prerenderingchange",function(){return n()},!0):n()},IE=[1800,3e3],nL=function(n,e){e=e||{},Jv(function(){var t,i=eA(),o=qi("FCP"),c=jl("paint",function(d){d.forEach(function(f){f.name==="first-contentful-paint"&&(c.disconnect(),f.startTime<i.firstHiddenTime&&(o.value=Math.max(f.startTime-Xv(),0),o.entries.push(f),t(!0)))})});c&&(t=Hi(n,o,IE,e.reportAllChanges),Mu(function(d){o=qi("FCP"),t=Hi(n,o,IE,e.reportAllChanges),Wv(function(){o.value=performance.now()-d.timeStamp,t(!0)})}))})},RE=[.1,.25],sL=function(n,e){(function(t,i){i=i||{},nL(Zv(function(){var o,c=qi("CLS",0),d=0,f=[],p=function(y){y.forEach(function(N){if(!N.hadRecentInput){var E=f[0],A=f[f.length-1];d&&N.startTime-A.startTime<1e3&&N.startTime-E.startTime<5e3?(d+=N.value,f.push(N)):(d=N.value,f=[N])}}),d>c.value&&(c.value=d,c.entries=f,o())},g=jl("layout-shift",p);g&&(o=Hi(t,c,RE,i.reportAllChanges),Rf(function(){p(g.takeRecords()),o(!0)}),Mu(function(){d=0,c=qi("CLS",0),o=Hi(t,c,RE,i.reportAllChanges),Wv(function(){return o()})}),setTimeout(o,0))}))})(function(t){var i=function(o){var c,d={};if(o.entries.length){var f=o.entries.reduce(function(g,y){return g&&g.value>y.value?g:y});if(f&&f.sources&&f.sources.length){var p=(c=f.sources).find(function(g){return g.node&&g.node.nodeType===1})||c[0];p&&(d={largestShiftTarget:Kv(p.node),largestShiftTime:f.startTime,largestShiftValue:f.value,largestShiftSource:p,largestShiftEntry:f,loadState:Z0(f.startTime)})}}return Object.assign(o,{attribution:d})}(t);n(i)},e)},tA=0,eg=1/0,hh=0,aL=function(n){n.forEach(function(e){e.interactionId&&(eg=Math.min(eg,e.interactionId),hh=Math.max(hh,e.interactionId),tA=hh?(hh-eg)/7+1:0)})},nA=function(){return kg?tA:performance.interactionCount||0},iL=function(){"interactionCount"in performance||kg||(kg=jl("event",aL,{type:"event",buffered:!0,durationThreshold:0}))},js=[],Xc=new Map,sA=0,rL=function(){var n=Math.min(js.length-1,Math.floor((nA()-sA)/50));return js[n]},aA=[],oL=function(n){if(aA.forEach(function(o){return o(n)}),n.interactionId||n.entryType==="first-input"){var e=js[js.length-1],t=Xc.get(n.interactionId);if(t||js.length<10||n.duration>e.latency){if(t)n.duration>t.latency?(t.entries=[n],t.latency=n.duration):n.duration===t.latency&&n.startTime===t.entries[0].startTime&&t.entries.push(n);else{var i={id:n.interactionId,latency:n.duration,entries:[n]};Xc.set(i.id,i),js.push(i)}js.sort(function(o,c){return c.latency-o.latency}),js.length>10&&js.splice(10).forEach(function(o){return Xc.delete(o.id)})}}},ey=function(n){var e=self.requestIdleCallback||self.setTimeout,t=-1;return n=Zv(n),document.visibilityState==="hidden"?n():(t=e(n),Rf(n)),t},ME=[200,500],lL=function(n,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},Jv(function(){var t;iL();var i,o=qi("INP"),c=function(f){ey(function(){f.forEach(oL);var p=rL();p&&p.latency!==o.value&&(o.value=p.latency,o.entries=p.entries,i())})},d=jl("event",c,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});i=Hi(n,o,ME,e.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),Rf(function(){c(d.takeRecords()),i(!0)}),Mu(function(){sA=nA(),js.length=0,Xc.clear(),o=qi("INP"),i=Hi(n,o,ME,e.reportAllChanges)}))}))},rl=[],Ti=[],Og=0,ty=new WeakMap,ol=new Map,Pg=-1,cL=function(n){rl=rl.concat(n),iA()},iA=function(){Pg<0&&(Pg=ey(uL))},uL=function(){ol.size>10&&ol.forEach(function(d,f){Xc.has(f)||ol.delete(f)});var n=js.map(function(d){return ty.get(d.entries[0])}),e=Ti.length-50;Ti=Ti.filter(function(d,f){return f>=e||n.includes(d)});for(var t=new Set,i=0;i<Ti.length;i++){var o=Ti[i];rA(o.startTime,o.processingEnd).forEach(function(d){t.add(d)})}var c=rl.length-1-50;rl=rl.filter(function(d,f){return d.startTime>Og&&f>c||t.has(d)}),Pg=-1};aA.push(function(n){n.interactionId&&n.target&&!ol.has(n.interactionId)&&ol.set(n.interactionId,n.target)},function(n){var e,t=n.startTime+n.duration;Og=Math.max(Og,n.processingEnd);for(var i=Ti.length-1;i>=0;i--){var o=Ti[i];if(Math.abs(t-o.renderTime)<=8){(e=o).startTime=Math.min(n.startTime,e.startTime),e.processingStart=Math.min(n.processingStart,e.processingStart),e.processingEnd=Math.max(n.processingEnd,e.processingEnd),e.entries.push(n);break}}e||(e={startTime:n.startTime,processingStart:n.processingStart,processingEnd:n.processingEnd,renderTime:t,entries:[n]},Ti.push(e)),(n.interactionId||n.entryType==="first-input")&&ty.set(n,e),iA()});var rA=function(n,e){for(var t,i=[],o=0;t=rl[o];o++)if(!(t.startTime+t.duration<n)){if(t.startTime>e)break;i.push(t)}return i},dL=function(n,e){CE||(CE=jl("long-animation-frame",cL)),lL(function(t){var i=function(o){var c=o.entries[0],d=ty.get(c),f=c.processingStart,p=d.processingEnd,g=d.entries.sort(function(b,k){return b.processingStart-k.processingStart}),y=rA(c.startTime,p),N=o.entries.find(function(b){return b.target}),E=N&&N.target||ol.get(c.interactionId),A=[c.startTime+c.duration,p].concat(y.map(function(b){return b.startTime+b.duration})),T=Math.max.apply(Math,A),R={interactionTarget:Kv(E),interactionTargetElement:E,interactionType:c.name.startsWith("key")?"keyboard":"pointer",interactionTime:c.startTime,nextPaintTime:T,processedEventEntries:g,longAnimationFrameEntries:y,inputDelay:f-c.startTime,processingDuration:p-f,presentationDelay:Math.max(T-p,0),loadState:Z0(c.startTime)};return Object.assign(o,{attribution:R})}(t);n(i)},e)},DE=[2500,4e3],tg={},hL=function(n,e){(function(t,i){i=i||{},Jv(function(){var o,c=eA(),d=qi("LCP"),f=function(y){i.reportAllChanges||(y=y.slice(-1)),y.forEach(function(N){N.startTime<c.firstHiddenTime&&(d.value=Math.max(N.startTime-Xv(),0),d.entries=[N],o())})},p=jl("largest-contentful-paint",f);if(p){o=Hi(t,d,DE,i.reportAllChanges);var g=Zv(function(){tg[d.id]||(f(p.takeRecords()),p.disconnect(),tg[d.id]=!0,o(!0))});["keydown","click"].forEach(function(y){addEventListener(y,function(){return ey(g)},{once:!0,capture:!0})}),Rf(g),Mu(function(y){d=qi("LCP"),o=Hi(t,d,DE,i.reportAllChanges),Wv(function(){d.value=performance.now()-y.timeStamp,tg[d.id]=!0,o(!0)})})}})})(function(t){var i=function(o){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:o.value};if(o.entries.length){var d=If();if(d){var f=d.activationStart||0,p=o.entries[o.entries.length-1],g=p.url&&performance.getEntriesByType("resource").filter(function(T){return T.name===p.url})[0],y=Math.max(0,d.responseStart-f),N=Math.max(y,g?(g.requestStart||g.startTime)-f:0),E=Math.max(N,g?g.responseEnd-f:0),A=Math.max(E,p.startTime-f);c={element:Kv(p.element),timeToFirstByte:y,resourceLoadDelay:N-y,resourceLoadDuration:E-N,elementRenderDelay:A-E,navigationEntry:d,lcpEntry:p},p.url&&(c.url=p.url),g&&(c.lcpResourceEntry=g)}}return Object.assign(o,{attribution:c})}(t);n(i)},e)};const kE="@firebase/performance",Lg="0.7.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA=Lg,fL="FB-PERF-TRACE-START",mL="FB-PERF-TRACE-STOP",Vg="FB-PERF-TRACE-MEASURE",lA="_wt_",cA="_fp",uA="_fcp",dA="_fid",hA="_lcp",pL="lcp_element",fA="_inp",gL="inp_interactionTarget",mA="_cls",vL="cls_largestShiftTarget",pA="@firebase/performance/config",gA="@firebase/performance/configexpire",yL="performance",vA="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xL={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},xn=new zi(yL,vA,xL);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi=new gu(vA);Bi.logLevel=Ye.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ng,yA;class $t{constructor(e){if(this.window=e,!e)throw xn.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=hL,this.onINP=dL,this.onCLS=sL}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,t,i){!this.performance||!this.performance.measure||this.performance.measure(e,t,i)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!Bg()?(Bi.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):ef()?!0:(Bi.info("IndexedDB is not supported by current browser"),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(o=>{for(const c of o.getEntries())t(c)}).observe({entryTypes:[e]})}static getInstance(){return ng===void 0&&(ng=new $t(yA)),ng}}function NL(n){yA=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xA;function bL(n){const e=n.getId();return e.then(t=>{xA=t}),e}function ny(){return xA}function _L(n){const e=n.getToken();return e.then(t=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(n,e){const t=n.length-e.length;if(t<0||t>1)throw xn.create("invalid String merger input");const i=[];for(let o=0;o<n.length;o++)i.push(n.charAt(o)),e.length>o&&i.push(e.charAt(o));return i.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sg;class Qn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=OE("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=OE("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return sg===void 0&&(sg=new Qn),sg}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wc;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.VISIBLE=1]="VISIBLE",n[n.HIDDEN=2]="HIDDEN"})(Wc||(Wc={}));const EL=["firebase_","google_","ga_"],jL=new RegExp("^[a-zA-Z]\\w*$"),TL=40,AL=100;function CL(){const n=$t.getInstance().navigator;return n?.serviceWorker?n.serviceWorker.controller?2:3:1}function wL(){switch($t.getInstance().document.visibilityState){case"visible":return Wc.VISIBLE;case"hidden":return Wc.HIDDEN;default:return Wc.UNKNOWN}}function SL(){const e=$t.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function IL(n){return n.length===0||n.length>TL?!1:!EL.some(t=>n.startsWith(t))&&!!n.match(jL)}function RL(n){return n.length!==0&&n.length<=AL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.appId;if(!t)throw xn.create("no app id");return t}function ML(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.projectId;if(!t)throw xn.create("no project id");return t}function DL(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.apiKey;if(!t)throw xn.create("no api key");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kL="0.0.1",Es={loggingEnabled:!0},OL="FIREBASE_INSTALLATIONS_AUTH";function PL(n,e){const t=LL();return t?(PE(t),Promise.resolve()):FL(n,e).then(PE).then(i=>VL(i),()=>{})}function LL(){const n=$t.getInstance().localStorage;if(!n)return;const e=n.getItem(gA);if(!e||!qL(e))return;const t=n.getItem(pA);if(t)try{return JSON.parse(t)}catch{return}}function VL(n){const e=$t.getInstance().localStorage;!n||!e||(e.setItem(pA,JSON.stringify(n)),e.setItem(gA,String(Date.now()+Qn.getInstance().configTimeToLive*60*60*1e3)))}const UL="Could not fetch config, will use default configs";function FL(n,e){return _L(n.installations).then(t=>{const i=ML(n.app),o=DL(n.app),c=`https://firebaseremoteconfig.googleapis.com/v1/projects/${i}/namespaces/fireperf:fetch?key=${o}`,d=new Request(c,{method:"POST",headers:{Authorization:`${OL} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:NA(n.app),app_version:oA,sdk_version:kL})});return fetch(d).then(f=>{if(f.ok)return f.json();throw xn.create("RC response not ok")})}).catch(()=>{Bi.info(UL)})}function PE(n){if(!n)return n;const e=Qn.getInstance(),t=n.entries||{};return t.fpr_enabled!==void 0?e.loggingEnabled=String(t.fpr_enabled)==="true":e.loggingEnabled=Es.loggingEnabled,t.fpr_log_source?e.logSource=Number(t.fpr_log_source):Es.logSource&&(e.logSource=Es.logSource),t.fpr_log_endpoint_url?e.logEndPointUrl=t.fpr_log_endpoint_url:Es.logEndPointUrl&&(e.logEndPointUrl=Es.logEndPointUrl),t.fpr_log_transport_key?e.transportKey=t.fpr_log_transport_key:Es.transportKey&&(e.transportKey=Es.transportKey),t.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(t.fpr_vc_network_request_sampling_rate):Es.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=Es.networkRequestsSamplingRate),t.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(t.fpr_vc_trace_sampling_rate):Es.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=Es.tracesSamplingRate),e.logTraceAfterSampling=LE(e.tracesSamplingRate),e.logNetworkAfterSampling=LE(e.networkRequestsSamplingRate),n}function qL(n){return Number(n)>Date.now()}function LE(n){return Math.random()<=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sy=1,ag;function bA(n){return sy=2,ag=ag||BL(n),ag}function HL(){return sy===3}function BL(n){return zL().then(()=>bL(n.installations)).then(e=>PL(n,e)).then(()=>VE(),()=>VE())}function zL(){const n=$t.getInstance().document;return new Promise(e=>{if(n&&n.readyState!=="complete"){const t=()=>{n.readyState==="complete"&&(n.removeEventListener("readystatechange",t),e())};n.addEventListener("readystatechange",t)}else e()})}function VE(){sy=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A=10*1e3,GL=5.5*1e3,$L=1e3,EA=3;let jh=EA,Fr=[],UE=!1;function YL(){UE||(ay(GL),UE=!0)}function ay(n){setTimeout(()=>{jh<=0||(Fr.length>0&&jA(),ay(_A))},n)}function jA(){const n=Fr.splice(0,$L),e=n.map(i=>({source_extension_json_proto3:i.message,event_time_ms:String(i.eventTime)})),t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Qn.getInstance().logSource,log_event:e};QL(t).then(()=>{jh=EA}).catch(()=>{Fr=[...n,...Fr],jh--,Bi.info(`Tries left: ${jh}.`),ay(_A)})}function QL(n){const e=Qn.getInstance().getFlTransportFullUrl(),t=JSON.stringify(n);return navigator.sendBeacon&&navigator.sendBeacon(e,t)?Promise.resolve():fetch(e,{method:"POST",body:t,keepalive:!0}).then()}function KL(n){if(!n.eventTime||!n.message)throw xn.create("invalid cc log");Fr=[...Fr,n]}function XL(n){return(...e)=>{const t=n(...e);KL({message:t,eventTime:Date.now()})}}function WL(){for(;Fr.length>0;)jA()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zc;function TA(n,e){Zc||(Zc={send:XL(e2),flush:WL}),Zc.send(n,e)}function fh(n){const e=Qn.getInstance();!e.instrumentationEnabled&&n.isAuto||!e.dataCollectionEnabled&&!n.isAuto||$t.getInstance().requiredApisAvailable()&&(HL()?ig(n):bA(n.performanceController).then(()=>ig(n),()=>ig(n)))}function ZL(){Zc&&Zc.flush()}function ig(n){if(!ny())return;const e=Qn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||TA(n,1)}function JL(n){const e=Qn.getInstance();if(!e.instrumentationEnabled)return;const t=n.url,i=e.logEndPointUrl.split("?")[0],o=e.flTransportEndpointUrl.split("?")[0];t===i||t===o||!e.loggingEnabled||!e.logNetworkAfterSampling||TA(n,0)}function e2(n,e){return e===0?t2(n):n2(n)}function t2(n){const e={url:n.url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},t={application_info:AA(n.performanceController.app),network_request_metric:e};return JSON.stringify(t)}function n2(n){const e={name:n.name,is_auto:n.isAuto,client_start_time_us:n.startTimeUs,duration_us:n.durationUs};Object.keys(n.counters).length!==0&&(e.counters=n.counters);const t=n.getAttributes();Object.keys(t).length!==0&&(e.custom_attributes=t);const i={application_info:AA(n.performanceController.app),trace_metric:e};return JSON.stringify(i)}function AA(n){return{google_app_id:NA(n),app_instance_id:ny(),web_app_info:{sdk_version:oA,page_url:$t.getInstance().getUrl(),service_worker_status:CL(),visibility_state:wL(),effective_connection_type:SL()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(n,e){const t=e;if(!t||t.responseStart===void 0)return;const i=$t.getInstance().getTimeOrigin(),o=Math.floor((t.startTime+i)*1e3),c=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,d=Math.floor((t.responseEnd-t.startTime)*1e3),f=t.name&&t.name.split("?")[0],p={performanceController:n,url:f,responsePayloadBytes:t.transferSize,startTimeUs:o,timeToResponseInitiatedUs:c,timeToResponseCompletedUs:d};JL(p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2=100,a2="_",i2=[cA,uA,dA,hA,mA,fA];function r2(n,e){return n.length===0||n.length>s2?!1:e&&e.startsWith(lA)&&i2.indexOf(n)>-1||!n.startsWith(a2)}function o2(n){const e=Math.floor(n);return e<n&&Bi.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,t,i=!1,o){this.performanceController=e,this.name=t,this.isAuto=i,this.state=1,this.customAttributes={},this.counters={},this.api=$t.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${fL}-${this.randomId}-${this.name}`,this.traceStopMark=`${mL}-${this.randomId}-${this.name}`,this.traceMeasure=o||`${Vg}-${this.randomId}-${this.name}`,o&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw xn.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw xn.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),fh(this)}record(e,t,i){if(e<=0)throw xn.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw xn.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(t*1e3),this.startTimeUs=Math.floor(e*1e3),i&&i.attributes&&(this.customAttributes=Object.assign({},i.attributes)),i&&i.metrics)for(const o of Object.keys(i.metrics))isNaN(Number(i.metrics[o]))||(this.counters[o]=Math.floor(Number(i.metrics[o])));fh(this)}incrementMetric(e,t=1){this.counters[e]===void 0?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(r2(e,this.name))this.counters[e]=o2(t??0);else throw xn.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const i=IL(e),o=RL(t);if(i&&o){this.customAttributes[e]=t;return}if(!i)throw xn.create("invalid attribute name",{attributeName:e});if(!o)throw xn.create("invalid attribute value",{attributeValue:t})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(t.duration*1e3),this.startTimeUs=Math.floor((t.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,t,i,o,c){const d=$t.getInstance().getUrl();if(!d)return;const f=new du(e,lA+d,!0),p=Math.floor($t.getInstance().getTimeOrigin()*1e3);f.setStartTime(p),t&&t[0]&&(f.setDuration(Math.floor(t[0].duration*1e3)),f.putMetric("domInteractive",Math.floor(t[0].domInteractive*1e3)),f.putMetric("domContentLoadedEventEnd",Math.floor(t[0].domContentLoadedEventEnd*1e3)),f.putMetric("loadEventEnd",Math.floor(t[0].loadEventEnd*1e3)));const g="first-paint",y="first-contentful-paint";if(i){const N=i.find(A=>A.name===g);N&&N.startTime&&f.putMetric(cA,Math.floor(N.startTime*1e3));const E=i.find(A=>A.name===y);E&&E.startTime&&f.putMetric(uA,Math.floor(E.startTime*1e3)),c&&f.putMetric(dA,Math.floor(c*1e3))}this.addWebVitalMetric(f,hA,pL,o.lcp),this.addWebVitalMetric(f,mA,vL,o.cls),this.addWebVitalMetric(f,fA,gL,o.inp),fh(f),ZL()}static addWebVitalMetric(e,t,i,o){o&&(e.putMetric(t,Math.floor(o.value*1e3)),o.elementAttribution&&e.putAttribute(i,o.elementAttribution))}static createUserTimingTrace(e,t){const i=new du(e,t,!1,t);fh(i)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Th={},qE=!1,CA;function HE(n){ny()&&(setTimeout(()=>c2(n),0),setTimeout(()=>l2(n),0),setTimeout(()=>u2(n),0))}function l2(n){const e=$t.getInstance(),t=e.getEntriesByType("resource");for(const i of t)FE(n,i);e.setupObserver("resource",i=>FE(n,i))}function c2(n){const e=$t.getInstance();"onpagehide"in window?e.document.addEventListener("pagehide",()=>rg(n)):e.document.addEventListener("unload",()=>rg(n)),e.document.addEventListener("visibilitychange",()=>{e.document.visibilityState==="hidden"&&rg(n)}),e.onFirstInputDelay&&e.onFirstInputDelay(t=>{CA=t}),e.onLCP(t=>{var i;Th.lcp={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.element}}),e.onCLS(t=>{var i;Th.cls={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.largestShiftTarget}}),e.onINP(t=>{var i;Th.inp={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.interactionTarget}})}function u2(n){const e=$t.getInstance(),t=e.getEntriesByType("measure");for(const i of t)BE(n,i);e.setupObserver("measure",i=>BE(n,i))}function BE(n,e){const t=e.name;t.substring(0,Vg.length)!==Vg&&du.createUserTimingTrace(n,t)}function rg(n){if(!qE){qE=!0;const e=$t.getInstance(),t=e.getEntriesByType("navigation"),i=e.getEntriesByType("paint");setTimeout(()=>{du.createOobTrace(n,t,i,Th,CA)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(e?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),e?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),$t.getInstance().requiredApisAvailable()?tf().then(t=>{t&&(YL(),bA(this).then(()=>HE(this),()=>HE(this)),this.initialized=!0)}).catch(t=>{Bi.info(`Environment doesn't support IndexedDB: ${t}`)}):Bi.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Qn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Qn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Qn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Qn.getInstance().dataCollectionEnabled}}const h2="[DEFAULT]";function f2(n=vu()){return n=Nt(n),Ba(n,"performance").getImmediate()}const m2=(n,{options:e})=>{const t=n.getProvider("app").getImmediate(),i=n.getProvider("installations-internal").getImmediate();if(t.name!==h2)throw xn.create("FB not default");if(typeof window>"u")throw xn.create("no window");NL(window);const o=new d2(t,i);return o._init(e),o};function p2(){ms(new Wn("performance",m2,"PUBLIC")),bn(kE,Lg),bn(kE,Lg,"esm2017")}p2();const g2={apiKey:"AIzaSyCbU834quCY8hjSffRwljJLgZrcxK8i2F4",authDomain:"liquidacionapp-62962.firebaseapp.com",projectId:"liquidacionapp-62962",storageBucket:"liquidacionapp-62962.firebasestorage.app",messagingSenderId:"851382130132",appId:"1:851382130132:web:eaba38fab449f14fb5b241",measurementId:"G-MEASUREMENT_ID"},hu=mj(g2),Jc=z1(hu),pe=zk(hu);SO(hu);let v2=null,y2=null;try{XP().then(n=>{n&&(v2=QP(hu))}).catch(()=>{console.warn("Firebase Analytics no est soportado en este entorno")}),typeof window<"u"&&(y2=f2(hu))}catch(n){console.warn("Error al inicializar Firebase Analytics/Performance:",n)}const Ts={ADMIN:"admin",CONTADOR:"contador",CLIENTE:"cliente"},ft={MANAGE_INVENTORY:"canManageInventory",CREATE_MOVEMENTS:"canCreateMovements",VIEW_ALL_MOVEMENTS:"canViewAllMovements",MANAGE_VEHICLES:"canManageVehicles",MANAGE_MAINTENANCE:"canManageMaintenance",MANAGE_SUPPLIERS:"canManageSuppliers",VIEW_REPORTS:"canViewReports",EXPORT_REPORTS:"canExportReports",MODIFY_SETTINGS:"canModifySettings"},x2="contacto.evert@gmail.com",wA=n=>{switch(n){case Ts.ADMIN:return{[ft.MANAGE_INVENTORY]:!0,[ft.CREATE_MOVEMENTS]:!0,[ft.VIEW_ALL_MOVEMENTS]:!0,[ft.MANAGE_VEHICLES]:!0,[ft.MANAGE_MAINTENANCE]:!0,[ft.MANAGE_SUPPLIERS]:!0,[ft.VIEW_REPORTS]:!0,[ft.EXPORT_REPORTS]:!0,[ft.MODIFY_SETTINGS]:!0};case Ts.CONTADOR:return{[ft.MANAGE_INVENTORY]:!0,[ft.CREATE_MOVEMENTS]:!0,[ft.VIEW_ALL_MOVEMENTS]:!0,[ft.MANAGE_VEHICLES]:!1,[ft.MANAGE_MAINTENANCE]:!0,[ft.MANAGE_SUPPLIERS]:!1,[ft.VIEW_REPORTS]:!0,[ft.EXPORT_REPORTS]:!0,[ft.MODIFY_SETTINGS]:!1};case Ts.CLIENTE:default:return{[ft.MANAGE_INVENTORY]:!1,[ft.CREATE_MOVEMENTS]:!0,[ft.VIEW_ALL_MOVEMENTS]:!1,[ft.MANAGE_VEHICLES]:!1,[ft.MANAGE_MAINTENANCE]:!1,[ft.MANAGE_SUPPLIERS]:!1,[ft.VIEW_REPORTS]:!1,[ft.EXPORT_REPORTS]:!1,[ft.MODIFY_SETTINGS]:!1}}},N2=n=>n===x2?Ts.ADMIN:Ts.CLIENTE,fl=()=>"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/invitations",b2=()=>{const n="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let e="";for(let t=0;t<8;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},_2=async(n,e)=>{try{const t=await Mf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden crear invitaciones"};let i,o=!1,c=0;for(;!o&&c<10;){i=b2();const p=Te(Pe(pe,fl()),De("code","==",i));(await mt(p)).empty&&(o=!0),c++}if(!o)return{success:!1,error:"No se pudo generar un cdigo nico"};const d=et(Pe(pe,fl())),f={code:i,targetEmail:n.email.toLowerCase(),targetRole:n.role||Ts.CLIENTE,targetName:n.name||"",status:"pending",appContext:"combustibles",expiresAt:new Date(Date.now()+7*24*60*60*1e3),createdAt:qe(),createdBy:e,usedAt:null,usedBy:null};return await Tf(d,f),console.log(" Invitacin creada:",{code:i,email:n.email,role:n.role}),{success:!0,invitation:{id:d.id,code:i,...f}}}catch(t){return console.error("Error creating invitation:",t),{success:!1,error:t.message}}},SA=async n=>{try{const e=Te(Pe(pe,fl()),De("code","==",n.toUpperCase()),De("status","==","pending")),t=await mt(e);if(t.empty)return{success:!1,error:"Cdigo de invitacin invlido o expirado"};const i=t.docs[0],o=i.data(),c=new Date,d=o.expiresAt.toDate();return c>d?{success:!1,error:"Cdigo de invitacin expirado"}:{success:!0,invitation:{id:i.id,...o}}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},E2=async(n,e)=>{try{const t=et(pe,fl(),n);return await Rs(t,{status:"used",usedAt:qe(),usedBy:e}),{success:!0}}catch(t){return console.error("Error marking invitation as used:",t),{success:!1,error:t.message}}},j2=async n=>{try{const e=await Mf(n);if(!e.success||e.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden ver invitaciones"};const t=Te(Pe(pe,fl())),i=await mt(t),o=[];return i.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,d)=>{const f=c.createdAt?.toDate()||new Date(0);return(d.createdAt?.toDate()||new Date(0))-f}),{success:!0,invitations:o}}catch(e){return console.error("Error getting invitations:",e),{success:!1,error:e.message}}},T2=async(n,e)=>{try{const t=await Mf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden cancelar invitaciones"};const i=et(pe,fl(),n);return await Rs(i,{status:"cancelled",cancelledAt:qe(),cancelledBy:e}),{success:!0}}catch(t){return console.error("Error cancelling invitation:",t),{success:!1,error:t.message}}},A2=n=>wA(n.targetRole),IA=async(n,e={})=>{const t=et(pe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const i=await Xi(t);if(i.exists())return{success:!0,userData:i.data(),isNewUser:!1};{const o=N2(n.email),c={uid:n.uid,email:n.email,displayName:n.displayName||"",photoURL:n.photoURL||"",role:o,emailVerified:n.emailVerified,combustiblesPermissions:wA(o),createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...e};return await Tf(t,c),{success:!0,userData:c,isNewUser:!0}}}catch(i){return console.error("Error creating/updating user profile:",i),{success:!1,error:i.message}}},zE=async(n,e,t={})=>{const i=et(pe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const o=await Xi(i);if(o.exists())return{success:!0,userData:o.data(),isNewUser:!1};const c=await SA(e);if(!c.success)return c;const d=c.invitation;if(d.targetEmail!==n.email.toLowerCase())return{success:!1,error:"El cdigo de invitacin no corresponde a este email"};const f={uid:n.uid,email:n.email,displayName:n.displayName||d.targetName||"",photoURL:n.photoURL||"",role:d.targetRole,emailVerified:n.emailVerified,combustiblesPermissions:A2(d),invitationUsed:d.id,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...t};return await Tf(i,f),await E2(d.id,n.uid),console.log(" Usuario creado con invitacin:",{email:n.email,role:d.targetRole,invitationCode:d.code}),{success:!0,userData:f,isNewUser:!0}}catch(o){return console.error("Error creating user profile with invitation:",o),{success:!1,error:o.message}}},Mf=async n=>{try{const e=et(pe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n),t=await Xi(e);return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"Usuario no encontrado"}}catch(e){return console.error("Error fetching user profile:",e),{success:!1,error:e.message}}},Nn={DIESEL:"diesel",GASOLINE:"gasoline",ACPM:"acpm",LUBRICANTS:"lubricants",TWO_STROKE:"two_stroke",MIXED:"mixed"},Ss={[Nn.DIESEL]:{name:"Disel",description:"Combustible para maquinaria pesada",unit:"galones",category:"Combustible",color:"#fbbf24",icon:"",density:.85,priceUnit:"COP/galn"},[Nn.GASOLINE]:{name:"Gasolina",description:"Combustible para vehculos livianos",unit:"galones",category:"Combustible",color:"#ef4444",icon:"",density:.75,priceUnit:"COP/galn"},[Nn.ACPM]:{name:"ACPM",description:"Aceite Combustible Para Motor",unit:"galones",category:"Combustible",color:"#8b5cf6",icon:"",density:.85,priceUnit:"COP/galn"},[Nn.LUBRICANTS]:{name:"Lubricantes",description:"Aceites y lubricantes para mantenimiento",unit:"litros",category:"Mantenimiento",color:"#06b6d4",icon:"",density:.9,priceUnit:"COP/litro"},[Nn.TWO_STROKE]:{name:"Mezcla 2T",description:"Mezcla para motores de 2 tiempos (motosierras)",unit:"litros",category:"Especializado",color:"#10b981",icon:"",density:.78,priceUnit:"COP/litro"},[Nn.MIXED]:{name:"Mixto",description:"Compatible con mltiples tipos de combustible",unit:"galones",category:"Flexible",color:"#64748b",icon:"",density:.8,priceUnit:"COP/galn"}},vn={CRITICAL:"critical",LOW:"low",MEDIUM:"medium",HIGH:"high",FULL:"full"},Vr={[vn.CRITICAL]:{label:"Crtico",color:"#dc2626",icon:"",threshold:.1},[vn.LOW]:{label:"Bajo",color:"#ea580c",icon:"",threshold:.25},[vn.MEDIUM]:{label:"Medio",color:"#ca8a04",icon:"",threshold:.5},[vn.HIGH]:{label:"Alto",color:"#16a34a",icon:"",threshold:.75},[vn.FULL]:{label:"Completo",color:"#059669",icon:"",threshold:1}},iy=(n,e)=>{if(e===0)return vn.CRITICAL;const t=n/e;return t<Vr[vn.CRITICAL].threshold?vn.CRITICAL:t<Vr[vn.LOW].threshold?vn.LOW:t<Vr[vn.MEDIUM].threshold?vn.MEDIUM:t<Vr[vn.HIGH].threshold?vn.HIGH:vn.FULL},C2=(n=[])=>Array.isArray(n)?n.reduce((e,t)=>{const i=parseFloat(t.currentStock)||0,o=parseFloat(t.pricePerUnit)||0;return e+i*o},0):0,RA=(n=[],e=null)=>{if(!Array.isArray(n))return e?0:{};if(e)return n.filter(i=>i.fuelType===e).reduce((i,o)=>i+(parseFloat(o.currentStock)||0),0);const t={};return Object.values(Nn).forEach(i=>{t[i]=n.filter(o=>o.fuelType===i).reduce((o,c)=>o+(parseFloat(c.currentStock)||0),0)}),t},w2=(n,e)=>{if(!e||e===0)return 0;const t=(parseFloat(n)||0)/parseFloat(e);return Math.min(Math.max(t*100,0),100)},ry=(n=[],e=.15)=>Array.isArray(n)?n.map(t=>{const i=parseFloat(t.currentStock)||0,o=parseFloat(t.maxCapacity)||0,c=o>0?i/o:0,d=iy(i,o);return{...t,percentage:c*100,stockLevel:d,isLowStock:c<=e,stockInfo:Vr[d]}}).filter(t=>t.isLowStock).sort((t,i)=>t.percentage-i.percentage):[],MA=(n=[])=>{if(!Array.isArray(n))return{totalValue:0,totalItems:0,activeItems:0,lowStockItems:0,criticalItems:0,averageStockLevel:0,stockByType:{}};const e=C2(n),t=n.length,i=n.filter(p=>p.status==="active").length,o=ry(n),c=o.filter(p=>p.stockLevel===vn.CRITICAL).length,d=RA(n),f=n.length>0?n.reduce((p,g)=>{const y=w2(g.currentStock,g.maxCapacity);return p+y},0)/n.length:0;return{totalValue:e,totalItems:t,activeItems:i,lowStockItems:o.length,criticalItems:c,averageStockLevel:f,stockByType:d}},S2=(n,e=[])=>{if(!n||!n.fuelType||!n.quantity)return{isValid:!1,error:"Datos de movimiento incompletos",availableStock:0,requiredStock:0};const{fuelType:t,quantity:i,type:o,sourceLocation:c}=n,d=parseFloat(i)||0;if(o!=="outbound"&&o!=="transfer")return{isValid:!0,message:"Movimiento no requiere validacin de stock",availableStock:0,requiredStock:d};const f=e.filter(y=>y.fuelType===t&&y.location?.toLowerCase()===c?.toLowerCase()&&y.status==="active").reduce((y,N)=>y+(parseFloat(N.currentStock)||0),0),p=f>=d,g=f-d;return console.log(`Validacin de stock - Tipo: ${t}, Ubicacin: ${c}`,{itemsEncontrados:e.filter(y=>y.fuelType===t&&y.location?.toLowerCase()===c?.toLowerCase()&&y.status==="active").length,disponible:f,requerido:d,valido:f>=d}),{isValid:p,availableStock:f,requiredStock:d,remainingStock:g,fuelType:t,location:c,error:p?null:`Stock insuficiente. Disponible: ${f}, Requerido: ${d}`,warning:g<f*.2&&g>=0?"Stock quedar bajo despus del movimiento":null}},qr=(n=[],e={})=>{if(!Array.isArray(n))return{totalCost:0,costsByType:{},costsByLocation:{}};let t=0;const i={},o={};return n.forEach(c=>{const d=parseFloat(c.quantity)||0,f=c.fuelType,p=c.sourceLocation||c.location,g=e[f]||parseFloat(c.pricePerUnit)||0,y=d*g;t+=y,i[f]||(i[f]=0),i[f]+=y,p&&(o[p]||(o[p]=0),o[p]+=y)}),{totalCost:t,costsByType:i,costsByLocation:o,averageCostPerMovement:n.length>0?t/n.length:0}},DA=(n=[])=>Array.isArray(n)?{totalMovements:n.length,pendingMovements:n.filter(t=>t.status==="pending").length,completedMovements:n.filter(t=>t.status==="completed").length,cancelledMovements:n.filter(t=>t.status==="cancelled").length,movementsByType:{inbound:n.filter(t=>t.type==="inbound").length,outbound:n.filter(t=>t.type==="outbound").length,transfer:n.filter(t=>t.type==="transfer").length,adjustment:n.filter(t=>t.type==="adjustment").length},totalQuantity:n.reduce((t,i)=>t+(parseFloat(i.quantity)||0),0)}:{totalMovements:0,pendingMovements:0,completedMovements:0,cancelledMovements:0,movementsByType:{},totalQuantity:0},oy=(n,e=[])=>{if(!n)return{averageConsumption:0,totalConsumption:0,movementsCount:0};const t=e.filter(d=>d.vehicleId===n.id&&d.type==="outbound"&&d.status==="completed"),i=t.reduce((d,f)=>d+(parseFloat(f.quantity)||0),0),o=t.length;return{averageConsumption:o>0?i/o:0,totalConsumption:i,movementsCount:o,consumptionByFuelType:t.reduce((d,f)=>{const p=f.fuelType;return d[p]||(d[p]=0),d[p]+=parseFloat(f.quantity)||0,d},{})}},kA=(n,e=[])=>{if(!n)return{efficiency:0,unit:"L/h"};const t=oy(n,e),i=parseFloat(n.hoursWorked)||0;if(i===0||t.totalConsumption===0)return{efficiency:0,unit:"L/h",hoursWorked:i,totalConsumption:t.totalConsumption};const o=t.totalConsumption/i;return{efficiency:o,unit:"L/h",hoursWorked:i,totalConsumption:t.totalConsumption,efficiencyRating:o<10?"Excelente":o<20?"Buena":o<30?"Regular":"Necesita revisin"}},I2=(n,e=[],t={})=>{if(!n)return{totalCost:0,costPerHour:0,costPerMovement:0};const i=e.filter(d=>d.vehicleId===n.id&&d.type==="outbound"&&d.status==="completed"),o=qr(i,t),c=parseFloat(n.hoursWorked)||0;return{totalCost:o.totalCost,costPerHour:c>0?o.totalCost/c:0,costPerMovement:o.averageCostPerMovement,costsByFuelType:o.costsByType,movementsCount:i.length}},OA=(n=[],e=[])=>{if(!Array.isArray(n))return{totalVehicles:0,activeVehicles:0,totalHours:0,totalConsumption:0,averageEfficiency:0,vehiclesByType:{},vehiclesByStatus:{}};const t=n.length,i=n.filter(N=>N.status==="active").length,o=n.reduce((N,E)=>N+(parseFloat(E.hoursWorked)||0),0);let c=0,d=0,f=0;n.forEach(N=>{const E=oy(N,e),A=kA(N,e);c+=E.totalConsumption,A.efficiency>0&&(d+=A.efficiency,f++)});const p=f>0?d/f:0,g=n.reduce((N,E)=>{const A=E.type||"unknown";return N[A]=(N[A]||0)+1,N},{}),y=n.reduce((N,E)=>{const A=E.status||"unknown";return N[A]=(N[A]||0)+1,N},{});return{totalVehicles:t,activeVehicles:i,totalHours:o,totalConsumption:c,averageEfficiency:p,vehiclesByType:g,vehiclesByStatus:y}},PA=(n=[],e={},t={})=>{if(!Array.isArray(n))return{totalValue:0,movementsInPeriod:0};const{start:i,end:o}=e;let c=n;(i||o)&&(c=n.filter(f=>{const p=new Date(f.createdAt||f.date),g=i?new Date(i):new Date(0),y=o?new Date(o):new Date;return p>=g&&p<=y}));const d=qr(c,t);return{totalValue:d.totalCost,movementsInPeriod:c.length,averageValuePerMovement:d.averageCostPerMovement,valueByType:d.costsByType,valueByLocation:d.costsByLocation}},R2=(n=[],e,t={})=>{if(!Array.isArray(n)||!e)return{totalCost:0,movementsCount:0};const i=n.filter(c=>c.sourceLocation===e||c.targetLocation===e||c.location===e),o=qr(i,t);return{location:e,totalCost:o.totalCost,movementsCount:i.length,averageCostPerMovement:o.averageCostPerMovement,costsByType:o.costsByType}},ly=(n=[],e=30)=>{if(!Array.isArray(n)||n.length===0)return{projectedConsumption:{},recommendedPurchases:{},confidence:0};const t=n.filter(N=>N.type==="outbound"&&N.status==="completed");if(t.length===0)return{projectedConsumption:{},recommendedPurchases:{},confidence:0};const i=t.map(N=>new Date(N.createdAt||N.date)),o=new Date(Math.min(...i)),c=new Date(Math.max(...i)),d=Math.max(1,(c-o)/(1e3*60*60*24)),f=t.reduce((N,E)=>{const A=E.fuelType;return N[A]||(N[A]=0),N[A]+=parseFloat(E.quantity)||0,N},{}),p={},g={};Object.entries(f).forEach(([N,E])=>{const A=E/d,T=A*e;p[N]={dailyAverage:A,projectedTotal:T,projectionDays:e,historicalTotal:E,historicalDays:d},g[N]=Math.ceil(T*1.2)});const y=Math.min(100,t.length/10*100);return{projectedConsumption:p,recommendedPurchases:g,confidence:y,dataPoints:t.length,projectionDays:e}},Me=n=>typeof n!="number"||isNaN(n)?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),ce=(n,e=2)=>typeof n!="number"||isNaN(n)?"0":new Intl.NumberFormat("es-CO",{minimumFractionDigits:e,maximumFractionDigits:e}).format(n),Cn=(n,e=1)=>typeof n!="number"||isNaN(n)?"0%":`${(n*100).toFixed(e)}%`,fu=(n,e,t=2)=>{const i=parseFloat(n)||0,o=parseFloat(e)||0;return parseFloat((i+o).toFixed(t))},mu=(n,e,t=2)=>{const i=parseFloat(n)||0,o=parseFloat(e)||0;return parseFloat((i-o).toFixed(t))},ml=(n,e=2)=>{const t=parseFloat(n)||0;return parseFloat(t.toFixed(e))},Mi=["principal","bodega austria","bodega ilusion","campo operativo","estacin mvil"],M2=["bodega austria","bodega ilusion"],Ws=n=>n?n.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"",Jr="combustibles_movements",hs="combustibles_inventory",ue={ENTRADA:"entrada",SALIDA:"salida",TRANSFERENCIA:"transferencia",AJUSTE:"ajuste"},vt={PENDIENTE:"pendiente",COMPLETADO:"completado",CANCELADO:"cancelado"},LA=async n=>{try{k2(n);const e={...n,createdAt:qe(),updatedAt:qe(),status:vt.COMPLETADO,approvedAt:qe(),totalValue:HA(n),effectiveDate:n.effectiveDate||qe()},t=await Bv(pe,async i=>{const o=et(Pe(pe,Jr));return i.set(o,e),await BA(i,e,o.id),o.id});return console.log(" Movimiento creado exitosamente:",t),t}catch(e){throw console.error(" Error al crear movimiento:",e),new Error(`Error al crear movimiento: ${e.message}`)}},VA=async(n={})=>{try{let e=Pe(pe,Jr);n.type&&(e=Te(e,De("type","==",n.type))),n.status&&(e=Te(e,De("status","==",n.status))),n.fuelType&&(e=Te(e,De("fuelType","==",n.fuelType))),n.vehicleId&&(e=Te(e,De("vehicleId","==",n.vehicleId))),e=Te(e,In("createdAt","desc"));const t=await mt(e),i=[];return t.forEach(o=>{i.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,effectiveDate:o.data().effectiveDate?.toDate?.()||o.data().effectiveDate})}),i}catch(e){throw console.error(" Error al obtener movimientos:",e),new Error(`Error al obtener movimientos: ${e.message}`)}},cy=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=et(pe,Jr,n),t=await Xi(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate?.()||t.data().createdAt,updatedAt:t.data().updatedAt?.toDate?.()||t.data().updatedAt,effectiveDate:t.data().effectiveDate?.toDate?.()||t.data().effectiveDate}:null}catch(e){throw console.error(" Error al obtener movimiento:",e),new Error(`Error al obtener movimiento: ${e.message}`)}},UA=async(n,e)=>{try{if(!n)throw new Error("ID de movimiento requerido");const t={...e,updatedAt:qe(),...e.quantity||e.unitPrice?{totalValue:HA(e)}:{}},i=et(pe,Jr,n);await Rs(i,t),console.log(" Movimiento actualizado exitosamente")}catch(t){throw console.error(" Error al actualizar movimiento:",t),new Error(`Error al actualizar movimiento: ${t.message}`)}},D2=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=await cy(n);if(!e)throw new Error("Movimiento no encontrado");await Bv(pe,async t=>{const i=et(pe,Jr,n);e.status===vt.COMPLETADO&&await O2(t,e),t.delete(i)}),console.log(" Movimiento eliminado y cambios de inventario revertidos exitosamente")}catch(e){throw console.error(" Error al eliminar movimiento:",e),new Error(`Error al eliminar movimiento: ${e.message}`)}},uy=(n,e={})=>{try{let t=Pe(pe,Jr);return e.type&&(t=Te(t,De("type","==",e.type))),e.status&&(t=Te(t,De("status","==",e.status))),t=Te(t,In("createdAt","desc")),Zr(t,i=>{const o=[];i.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,effectiveDate:c.data().effectiveDate?.toDate?.()||c.data().effectiveDate})}),n(o)},i=>{console.error(" Error en suscripcin de movimientos:",i),n([],i)})}catch(t){throw console.error(" Error al configurar suscripcin:",t),new Error(`Error en suscripcin: ${t.message}`)}},FA=async n=>{try{const e=await cy(n);if(!e)throw new Error("Movimiento no encontrado");if(e.status!==vt.PENDIENTE)throw new Error("Solo se pueden aprobar movimientos pendientes");await Bv(pe,async t=>{const i=et(pe,Jr,n);t.update(i,{status:vt.COMPLETADO,approvedAt:qe(),updatedAt:qe()}),await BA(t,e,n)}),console.log(" Movimiento aprobado exitosamente")}catch(e){throw console.error(" Error al aprobar movimiento:",e),new Error(`Error al aprobar movimiento: ${e.message}`)}},qA=async(n={})=>{try{const e=await VA(n),t={totalMovements:e.length,byType:{},byStatus:{},byFuelType:{},totalValue:0,totalQuantity:0,averageValue:0,thisMonth:0,lastMonth:0,thisWeek:0},i=new Date,o=new Date(i.getFullYear(),i.getMonth(),1),c=new Date(i.getFullYear(),i.getMonth()-1,1),d=new Date(i.setDate(i.getDate()-i.getDay()));return e.forEach(f=>{t.byType[f.type]=(t.byType[f.type]||0)+1,t.byStatus[f.status]=(t.byStatus[f.status]||0)+1,t.byFuelType[f.fuelType]=(t.byFuelType[f.fuelType]||0)+1,t.totalValue+=f.totalValue||0,t.totalQuantity+=f.quantity||0;const p=new Date(f.createdAt);p>=o&&t.thisMonth++,p>=c&&p<o&&t.lastMonth++,p>=d&&t.thisWeek++}),t.averageValue=t.totalMovements>0?t.totalValue/t.totalMovements:0,t}catch(e){throw console.error(" Error al calcular estadsticas:",e),new Error(`Error al calcular estadsticas: ${e.message}`)}},GE=n=>n?Mi.includes(n.toLowerCase()):!1,k2=n=>{const e=["type","fuelType","quantity","unitPrice"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!Object.values(ue).includes(n.type))throw new Error("Tipo de movimiento invlido");if(n.quantity<=0)throw new Error("La cantidad debe ser mayor a cero");if(n.unitPrice<0)throw new Error("El precio unitario no puede ser negativo");if(n.type===ue.SALIDA&&!n.vehicleId)throw new Error("Las salidas deben tener un vehculo asociado");if(n.type===ue.TRANSFERENCIA&&!n.destinationLocation)throw new Error("Las transferencias deben tener una ubicacin destino");if(n.type===ue.ENTRADA){if(!n.supplierName)throw new Error("Las entradas deben tener un proveedor");if(!n.destinationLocation)throw new Error("Las entradas deben tener una ubicacin destino")}if(n.type!==ue.ENTRADA&&n.location&&!GE(n.location))throw new Error(`Ubicacin origen invlida: ${n.location}. Ubicaciones vlidas: ${Mi.join(", ")}`);if(n.destinationLocation&&!GE(n.destinationLocation))throw new Error(`Ubicacin destino invlida: ${n.destinationLocation}. Ubicaciones vlidas: ${Mi.join(", ")}`);if(n.type===ue.TRANSFERENCIA){const t=(n.location||"principal").toLowerCase(),i=n.destinationLocation.toLowerCase();if(t===i)throw new Error("La ubicacin origen y destino no pueden ser la misma en una transferencia")}},HA=n=>(n.quantity||0)*(n.unitPrice||0),BA=async(n,e,t)=>{try{let i=e.location||"principal";e.type===ue.ENTRADA&&(i=e.destinationLocation||"principal");const o=Te(Pe(pe,hs),De("fuelType","==",e.fuelType),De("location","==",i)),c=await mt(o);if(c.empty){if(e.type!==ue.ENTRADA)throw new Error(`No se encontr inventario para ${e.fuelType} en ${i} para realizar un movimiento de ${e.type}.`);console.log(` Creando inventario automtico para ${e.fuelType} en ${i}`);const d=et(Pe(pe,hs)),f={fuelType:e.fuelType,location:i,name:e.fuelType,maxCapacity:1e4,currentStock:ml(e.quantity,2),minThreshold:1500,pricePerUnit:e.unitPrice||0,createdAt:qe(),updatedAt:qe(),status:"active",lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:qe()}};n.set(d,f)}else{const d=c.docs[0],f=d.data(),p=et(pe,hs,d.id);let g=f.currentStock;switch(e.type){case ue.ENTRADA:g=fu(g,e.quantity);break;case ue.SALIDA:if(g=mu(g,e.quantity),g<0)throw new Error("Stock insuficiente para realizar la salida");break;case ue.AJUSTE:g=fu(g,e.quantity),g<0&&(g=0);break;case ue.TRANSFERENCIA:if(g=mu(g,e.quantity),g<0)throw new Error("Stock insuficiente para realizar la transferencia");await P2(n,e,t);break}g=ml(g,2),n.update(p,{currentStock:g,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:qe()},updatedAt:qe()})}e.type===ue.SALIDA&&e.vehicleId&&e.currentHours&&await YE(n,e.vehicleId,e.currentHours),e.type===ue.SALIDA&&e.vehicleId&&e.currentHours&&await YE(n,e.vehicleId,e.currentHours)}catch(i){throw console.error(" Error al actualizar inventario:",i),i}},O2=async(n,e)=>{try{console.log(" Revirtiendo cambios de inventario para movimiento:",e.id);let t;switch(e.type){case ue.ENTRADA:t=e.destinationLocation||"principal";break;case ue.SALIDA:case ue.AJUSTE:t=e.location||"principal";break;case ue.TRANSFERENCIA:t=e.location||"principal";break;default:t=e.location||e.destinationLocation||"principal"}console.log(` Buscando inventario: ${e.fuelType} en ${t}`);const i=Te(Pe(pe,hs),De("fuelType","==",e.fuelType),De("location","==",t)),o=await mt(i);if(o.empty){console.warn(` No se encontr inventario para ${e.fuelType} en ${t}`);const p=Te(Pe(pe,hs),De("fuelType","==",e.fuelType)),g=await mt(p);if(g.empty)throw console.error(` No existe inventario para ${e.fuelType} en ninguna ubicacin`),new Error(`No se puede revertir: no existe inventario para ${e.fuelType} en ninguna ubicacin. Movimiento hurfano detectado.`);console.log(` Usando inventario fallback en ${g.docs[0].data().location}`);const y=g.docs[0],N=y.data(),E=et(pe,hs,y.id);await $E(n,E,N,e);return}const c=o.docs[0],d=c.data(),f=et(pe,hs,c.id);await $E(n,f,d,e)}catch(t){throw console.error(" Error al revertir cambios de inventario:",t),new Error(`Error al revertir inventario: ${t.message}`)}},$E=async(n,e,t,i)=>{try{let o=t.currentStock;switch(i.type){case ue.ENTRADA:o=mu(o,i.quantity),o<0&&(console.warn(" Advertencia: La reversin resulta en stock negativo, ajustando a 0"),o=0);break;case ue.SALIDA:o=fu(o,i.quantity);break;case ue.AJUSTE:o=mu(o,i.quantity),o<0&&(console.warn(" Advertencia: La reversin de ajuste resulta en stock negativo, ajustando a 0"),o=0);break;case ue.TRANSFERENCIA:o=fu(o,i.quantity),await L2(n,i);break;default:throw new Error(`Tipo de movimiento no soportado para reversin: ${i.type}`)}o=ml(o,2),n.update(e,{currentStock:o,lastMovement:{movementId:null,type:"reversion",quantity:i.quantity,originalType:i.type,date:qe(),note:`Reversin de movimiento ${i.id} - Ubicacin original: ${i.location||i.destinationLocation||"no especificada"}`},updatedAt:qe()}),console.log(` Inventario revertido exitosamente. Stock anterior: ${t.currentStock}, Nuevo stock: ${o}`)}catch(o){throw console.error(" Error en procesamiento de reversin:",o),o}},P2=async(n,e,t)=>{try{if(!e.destinationLocation)throw new Error("Ubicacin destino requerida para transferencias");console.log(` Transfiriendo ${e.quantity} ${e.fuelType} a ${e.destinationLocation}`);const i=Te(Pe(pe,hs),De("fuelType","==",e.fuelType),De("location","==",e.destinationLocation)),o=await mt(i);if(o.empty){console.log(` Creando inventario automtico en destino: ${e.fuelType} en ${e.destinationLocation}`);const c=et(Pe(pe,hs)),d={fuelType:e.fuelType,location:e.destinationLocation,name:e.fuelType,maxCapacity:1e4,currentStock:ml(e.quantity,2),minThreshold:1500,pricePerUnit:e.unitPrice||0,createdAt:qe(),updatedAt:qe(),status:"active",lastMovement:{movementId:t,type:"transferencia_entrada",quantity:e.quantity,date:qe(),originLocation:e.location}};n.set(c,d)}else{const c=o.docs[0],d=c.data(),f=et(pe,hs,c.id),p=ml(fu(d.currentStock,e.quantity),2);n.update(f,{currentStock:p,lastMovement:{movementId:t,type:"transferencia_entrada",quantity:e.quantity,date:qe(),originLocation:e.location},updatedAt:qe()})}console.log(" Transferencia al destino completada exitosamente")}catch(i){throw console.error(" Error al transferir a destino:",i),new Error(`Error en transferencia a destino: ${i.message}`)}},L2=async(n,e)=>{try{if(!e.destinationLocation){console.warn(" No hay ubicacin destino para revertir");return}console.log(` Revirtiendo transferencia en destino: ${e.destinationLocation}`);const t=Te(Pe(pe,hs),De("fuelType","==",e.fuelType),De("location","==",e.destinationLocation)),i=await mt(t);if(i.empty){console.warn(` No se encontr inventario destino para revertir: ${e.fuelType} en ${e.destinationLocation}`);return}const o=i.docs[0],c=o.data(),d=et(pe,hs,o.id);let f=mu(c.currentStock,e.quantity);f<0&&(console.warn(" Advertencia: La reversin en destino resulta en stock negativo, ajustando a 0"),f=0),f=ml(f,2),n.update(d,{currentStock:f,lastMovement:{movementId:null,type:"reversion_transferencia",quantity:e.quantity,date:qe(),note:`Reversin de transferencia desde ${e.location}`},updatedAt:qe()}),console.log(" Reversin en destino completada exitosamente")}catch(t){throw console.error(" Error al revertir transferencia en destino:",t),new Error(`Error al revertir destino: ${t.message}`)}},YE=async(n,e,t)=>{try{console.log(` Actualizando hormetro del vehculo ${e} a ${t} horas`);const i=Te(Pe(pe,"combustibles_vehicles"),De("vehicleId","==",e)),o=await mt(i);if(o.empty){console.warn(` Vehculo ${e} no encontrado para actualizar hormetro`);return}const c=o.docs[0],d=c.data(),f=et(pe,"combustibles_vehicles",c.id),p=parseFloat(d.currentHours)||0,g=parseFloat(t);g<p&&console.warn(` Nueva lectura hormetro (${g}) menor a la anterior (${p}). Actualizando de todas formas.`);const y=d.hourMeterHistory||[];y.push({previousHours:p,newHours:g,difference:g-p,updatedAt:new Date,updatedBy:"movement_service",source:"fuel_consumption"}),n.update(f,{currentHours:g,hourMeterHistory:y,lastHourMeterUpdate:qe(),updatedAt:qe()}),console.log(` Hormetro actualizado: ${e} - ${p}h  ${g}h`)}catch(i){console.error(" Error al actualizar hormetro del vehculo:",i),console.warn(" Continuando con el movimiento sin actualizacin de hormetro")}},QE={createMovement:LA,getAllMovements:VA,getMovement:cy,updateMovement:UA,deleteMovement:D2,subscribeToMovements:uy,approveMovement:FA,getMovementsStats:qA,MOVEMENT_TYPES:ue,MOVEMENT_STATUS:vt},pl="combustibles_inventory",V2=async(n,e)=>{try{const t=Ss[n.fuelType];if(!t)return{success:!1,error:"Tipo de combustible no vlido"};const i=Te(Pe(pe,pl),De("fuelType","==",n.fuelType),De("location","==",n.location.toLowerCase()));if(!(await mt(i)).empty)return{success:!1,error:`Ya existe ${t.name} en ${n.location}`};const c={fuelType:n.fuelType,name:t.name,description:n.description||t.description,currentStock:Number(n.currentStock)||0,maxCapacity:Number(n.maxCapacity),minThreshold:Number(n.minThreshold)||n.maxCapacity*.15,unit:t.unit,location:n.location.toLowerCase(),pricePerUnit:Number(n.pricePerUnit)||0,supplier:n.supplier||"",status:n.status||"active",createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await El(Pe(pe,pl),c)).id,...c},message:`${t.name} agregado al inventario exitosamente`}}catch(t){return console.error("Error creating inventory item:",t),{success:!1,error:t.message}}},U2=async()=>{try{const n=Te(Pe(pe,pl),In("fuelType","asc")),e=await mt(n),t=[];return e.forEach(i=>{const o=i.data();t.push({id:i.id,...o,stockLevel:iy(o.currentStock,o.maxCapacity),stockPercentage:Math.round(o.currentStock/o.maxCapacity*100),needsRestock:o.currentStock<=o.minThreshold})}),{success:!0,data:t}}catch(n){return console.error("Error fetching inventory items:",n),{success:!1,error:n.message}}},F2=async(n,e,t)=>{try{const i=et(pe,pl,n);if(!(await Xi(i)).exists())return{success:!1,error:"Item no encontrado"};const c={...e,lastUpdated:new Date,updatedBy:t};return delete c.id,delete c.createdAt,delete c.createdBy,await Rs(i,c),{success:!0,message:"Item actualizado exitosamente",data:{id:n,...c}}}catch(i){return console.error("Error updating inventory item:",i),{success:!1,error:i.message}}},q2=async n=>{try{const e=et(pe,pl,n);return(await Xi(e)).exists()?(await Af(e),{success:!0,message:"Item eliminado exitosamente"}):{success:!1,error:"Item no encontrado"}}catch(e){return console.error("Error deleting inventory item:",e),{success:!1,error:e.message}}},zA=n=>{const e=Te(Pe(pe,pl),In("fuelType","asc"));return Zr(e,t=>{const i=[];t.forEach(o=>{const c=o.data();i.push({id:o.id,...c,stockLevel:iy(c.currentStock,c.maxCapacity),stockPercentage:Math.round(c.currentStock/c.maxCapacity*100),needsRestock:c.currentStock<=c.minThreshold})}),n(i)},t=>{console.error("Error in inventory subscription:",t),n(null,t)})},H2=async()=>{try{const n=await U2();if(!n.success)return n;const e=n.data,t={totalItems:e.length,activeItems:e.filter(i=>i.status==="active").length,lowStockItems:e.filter(i=>i.needsRestock).length,totalValue:e.reduce((i,o)=>i+o.currentStock*o.pricePerUnit,0),averageStockLevel:e.length>0?Math.round(e.reduce((i,o)=>i+o.stockPercentage,0)/e.length):0,byFuelType:{}};return e.forEach(i=>{t.byFuelType[i.fuelType]||(t.byFuelType[i.fuelType]={count:0,totalStock:0,totalCapacity:0,totalValue:0}),t.byFuelType[i.fuelType].count++,t.byFuelType[i.fuelType].totalStock+=i.currentStock,t.byFuelType[i.fuelType].totalCapacity+=i.maxCapacity,t.byFuelType[i.fuelType].totalValue+=i.currentStock*i.pricePerUnit}),{success:!0,data:t}}catch(n){return console.error("Error calculating inventory stats:",n),{success:!1,error:n.message}}},fs=[{id:"maquinaria_pesada",name:"Maquinaria Pesada",description:"Excavadoras, bulldozers, cargadores, gras",icon:"",color:"#FF6B35",fuelTypes:["Diesel","ACPM"],fields:["enginePower","operatingWeight","bucketCapacity"]},{id:"transporte",name:"Transporte",description:"Camiones, camionetas, volquetas",icon:"",color:"#2E86AB",fuelTypes:["Diesel","ACPM","Gasolina"],fields:["plateNumber","loadCapacity","enginePower"]},{id:"herramientas_motorizadas",name:"Herramientas Motorizadas",description:"Motosierras, guadaas, fumigadoras",icon:"",color:"#A23B72",fuelTypes:["Gasolina","Mixto"],fields:["enginePower","weight"]},{id:"equipos_bombeo",name:"Equipos de Bombeo",description:"Motobombas, hidrolavadoras, plantas elctricas",icon:"",color:"#F18F01",fuelTypes:["Diesel","Gasolina"],fields:["flow","pressure","enginePower"]},{id:"vehiculos_ligeros",name:"Vehculos Ligeros",description:"Motocicletas, cuatrimotos, vehculos de apoyo",icon:"",color:"#C73E1D",fuelTypes:["Gasolina"],fields:["plateNumber","enginePower"]},{id:"agricola",name:"Agrcola/Forestal",description:"Tractores, asperjadoras, equipos forestales",icon:"",color:"#2F7D32",fuelTypes:["Diesel","ACPM"],fields:["enginePower","hasHourMeter","implementType"]},{id:"otros",name:"Otros",description:"Equipos especializados y otros vehculos",icon:"",color:"#616161",fuelTypes:["Diesel","Gasolina","ACPM","Mixto"],fields:["enginePower"]}],Ue={ACTIVO:"activo",MANTENIMIENTO:"mantenimiento",INACTIVO:"inactivo",REPARACION:"reparacion",FUERA_DE_SERVICIO:"fuera_de_servicio"},GA={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},KE=[{key:"plateNumber",label:"Nmero de Placa",type:"text",icon:""},{key:"enginePower",label:"Potencia del Motor (HP)",type:"number",icon:""},{key:"fuelCapacity",label:"Capacidad de Combustible (Litros)",type:"number",icon:""},{key:"operatingWeight",label:"Peso Operativo (Toneladas)",type:"number",icon:""},{key:"loadCapacity",label:"Capacidad de Carga (Toneladas)",type:"number",icon:""},{key:"bucketCapacity",label:"Capacidad de Balde (m)",type:"number",icon:""},{key:"hasHourMeter",label:"Tiene Hormetro",type:"boolean",icon:""},{key:"currentHours",label:"Horas Actuales",type:"number",icon:"",dependsOn:"hasHourMeter"},{key:"implementType",label:"Tipo de Implemento",type:"text",icon:""},{key:"flow",label:"Caudal (L/min)",type:"number",icon:""},{key:"pressure",label:"Presin (PSI)",type:"number",icon:""},{key:"weight",label:"Peso (Kg)",type:"number",icon:""}],XE=(n,e=[])=>{const t=e.find(i=>i.id===n);return t||fs.find(i=>i.id===n)||null},$A=(n=[])=>{const e=fs.map(i=>i.id),t=n.filter(i=>!e.includes(i.id));return[...fs,...t]},YA=n=>{const e=[];return(!n.id||typeof n.id!="string")&&e.push("ID de categora requerido y debe ser texto"),(!n.name||typeof n.name!="string")&&e.push("Nombre de categora requerido y debe ser texto"),n.name&&n.name.length<2&&e.push("Nombre debe tener al menos 2 caracteres"),n.fuelTypes&&!Array.isArray(n.fuelTypes)&&e.push("Tipos de combustible debe ser un array"),n.fields&&!Array.isArray(n.fields)&&e.push("Campos debe ser un array"),{isValid:e.length===0,errors:e}},QA=(n,e=[])=>{const t=n.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"");let i=t,o=1;for(;e.some(c=>c.id===i);)i=`${t}_${o}`,o++;return i},Tl="combustibles_vehicles",yt={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},KA=async n=>{try{if(B2(n),await dy(n.vehicleId))throw new Error(`El cdigo de vehculo '${n.vehicleId}' ya existe`);const t={...n,createdAt:qe(),updatedAt:qe(),status:n.status||Ue.ACTIVO,totalFuelConsumed:0,totalHoursWorked:0,totalMovements:0,lastMovementDate:null,estimatedConsumptionPerHour:JA(n)},i=await El(Pe(pe,Tl),t);return console.log(" Vehculo creado exitosamente:",i.id),i.id}catch(e){throw console.error(" Error al crear vehculo:",e),new Error(`Error al crear vehculo: ${e.message}`)}},XA=async(n={})=>{try{let e=Pe(pe,Tl);n.type&&(e=Te(e,De("type","==",n.type))),n.status&&(e=Te(e,De("status","==",n.status))),n.fuelType&&(e=Te(e,De("fuelType","==",n.fuelType))),n.location&&(e=Te(e,De("currentLocation","==",n.location))),e=Te(e,In("vehicleId","asc"));const t=await mt(e),i=[];return t.forEach(o=>{i.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,lastMovementDate:o.data().lastMovementDate?.toDate?.()||o.data().lastMovementDate,lastMaintenanceDate:o.data().lastMaintenanceDate?.toDate?.()||o.data().lastMaintenanceDate})}),i}catch(e){throw console.error(" Error al obtener vehculos:",e),new Error(`Error al obtener vehculos: ${e.message}`)}},dy=async n=>{try{const e=Te(Pe(pe,Tl),De("vehicleId","==",n)),t=await mt(e);if(t.empty)return null;const i=t.docs[0];return{id:i.id,...i.data(),createdAt:i.data().createdAt?.toDate?.()||i.data().createdAt,updatedAt:i.data().updatedAt?.toDate?.()||i.data().updatedAt,lastMovementDate:i.data().lastMovementDate?.toDate?.()||i.data().lastMovementDate,lastMaintenanceDate:i.data().lastMaintenanceDate?.toDate?.()||i.data().lastMaintenanceDate}}catch(e){throw console.error(" Error al buscar vehculo por cdigo:",e),new Error(`Error al buscar vehculo: ${e.message}`)}},WA=async(n,e)=>{try{if(!n)throw new Error("ID de vehculo requerido");if(e.vehicleId){const o=await dy(e.vehicleId);if(o&&o.id!==n)throw new Error(`El cdigo de vehculo '${e.vehicleId}' ya existe`)}const t={...e,updatedAt:qe(),...e.enginePower||e.type?{estimatedConsumptionPerHour:JA(e)}:{}},i=et(pe,Tl,n);await Rs(i,t),console.log(" Vehculo actualizado exitosamente")}catch(t){throw console.error(" Error al actualizar vehculo:",t),new Error(`Error al actualizar vehculo: ${t.message}`)}},hy=(n,e={})=>{try{let t=Pe(pe,Tl);const i=[];e.category&&i.push(De("category","==",e.category)),e.status&&i.push(De("status","==",e.status)),e.fuelType&&i.push(De("fuelType","==",e.fuelType)),e.currentLocation&&i.push(De("currentLocation","==",e.currentLocation)),i.forEach(c=>{t=Te(t,c)}),t=Te(t,In("updatedAt","desc"));let o=null;return Zr(t,c=>{const d=Date.now();if(o&&d-o<500)return;o=d;const f=[],p={added:[],modified:[],removed:[]};c.docChanges().forEach(g=>{const y={id:g.doc.id,...g.doc.data(),createdAt:g.doc.data().createdAt?.toDate?.()||g.doc.data().createdAt,updatedAt:g.doc.data().updatedAt?.toDate?.()||g.doc.data().updatedAt,lastMovementDate:g.doc.data().lastMovementDate?.toDate?.()||g.doc.data().lastMovementDate,lastMaintenanceDate:g.doc.data().lastMaintenanceDate?.toDate?.()||g.doc.data().lastMaintenanceDate,lastHourMeterDate:g.doc.data().lastHourMeterDate?.toDate?.()||g.doc.data().lastHourMeterDate};g.type==="added"?p.added.push(y):g.type==="modified"?p.modified.push(y):g.type==="removed"&&p.removed.push({id:g.doc.id})}),c.forEach(g=>{f.push({id:g.id,...g.data(),createdAt:g.data().createdAt?.toDate?.()||g.data().createdAt,updatedAt:g.data().updatedAt?.toDate?.()||g.data().updatedAt,lastMovementDate:g.data().lastMovementDate?.toDate?.()||g.data().lastMovementDate,lastMaintenanceDate:g.data().lastMaintenanceDate?.toDate?.()||g.data().lastMaintenanceDate,lastHourMeterDate:g.data().lastHourMeterDate?.toDate?.()||g.data().lastHourMeterDate})}),n(f,null,p)},c=>{console.error(" Error en suscripcin de vehculos:",c),n([],c)})}catch(t){throw console.error(" Error al configurar suscripcin:",t),new Error(`Error en suscripcin: ${t.message}`)}},ZA=async(n={})=>{try{const e=await XA(n),t={totalVehicles:e.length,byType:{},byStatus:{},byFuelType:{},totalFuelConsumed:0,totalHoursWorked:0,averageConsumption:0,mostActiveVehicle:null,leastActiveVehicle:null};let i=0,o=1/0;return e.forEach(c=>{t.byType[c.type]=(t.byType[c.type]||0)+1,t.byStatus[c.status]=(t.byStatus[c.status]||0)+1,t.byFuelType[c.fuelType]=(t.byFuelType[c.fuelType]||0)+1,t.totalFuelConsumed+=c.totalFuelConsumed||0,t.totalHoursWorked+=c.totalHoursWorked||0;const d=c.totalMovements||0;d>i&&(i=d,t.mostActiveVehicle=c),d<o&&d>0&&(o=d,t.leastActiveVehicle=c)}),t.totalHoursWorked>0&&(t.averageConsumption=t.totalFuelConsumed/t.totalHoursWorked),t}catch(e){throw console.error(" Error al calcular estadsticas:",e),new Error(`Error al calcular estadsticas: ${e.message}`)}},B2=n=>{const e=["vehicleId","name","type","fuelType"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!n.type||n.type.trim().length===0)throw new Error("Tipo de vehculo requerido");if(!Object.values(yt).includes(n.fuelType))throw new Error("Tipo de combustible invlido");if(n.status&&!Object.values(Ue).includes(n.status))throw new Error("Estado de vehculo invlido");if(n.enginePower&&n.enginePower<=0)throw new Error("La potencia del motor debe ser mayor a cero");if(n.fuelCapacity&&n.fuelCapacity<=0)throw new Error("La capacidad de combustible debe ser mayor a cero")},JA=n=>{const{type:e,enginePower:t,fuelType:i}=n,o={excavadora:.04,bulldozer:.05,cargador:.035,camion:.03,camioneta:.03,grua:.045,motosierra:.02,tractor:.025,volqueta:.035,motobomba:.035,fumigadora:.025,guadana:.02,motocicleta:.015,planta_electrica:.08,otros:.03},c={[yt.DIESEL]:1,[yt.GASOLINA]:1.2,[yt.ACPM]:.95,[yt.MIXTO]:1.1},d=o[e]||.03,f=c[i]||1;return d*(t||100)*f},z2=async n=>{try{const e=Te(Pe(pe,Tl),De("category","==",n));return(await mt(e)).size}catch(e){return console.error(" Error al contar vehculos por categora:",e),0}},eC=Object.freeze(Object.defineProperty({__proto__:null,FUEL_COMPATIBILITY:yt,FUEL_TYPES:GA,VEHICLE_STATUS:Ue,countVehiclesByCategory:z2,createVehicle:KA,getAllVehicles:XA,getVehicleByCode:dy,getVehiclesStats:ZA,subscribeToVehicles:hy,updateVehicle:WA},Symbol.toStringTag,{value:"Module"})),Zs="combustibles_suppliers",G2=async(n,e)=>{try{const t=Te(Pe(pe,Zs),De("name","==",n.name.trim()));if(!(await mt(t)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${n.name}"`};if(n.taxId){const d=Te(Pe(pe,Zs),De("taxId","==",n.taxId.trim()));if(!(await mt(d)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${n.taxId}"`}}const o={name:n.name.trim(),taxId:n.taxId?.trim()||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson?.trim()||"",phone:n.phone?.trim()||"",email:n.email?.trim()||"",address:n.address?.trim()||"",city:n.city?.trim()||"",state:n.state?.trim()||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:Number(n.creditLimit)||0,priceList:n.priceList||{},rating:Number(n.rating)||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1,totalOrders:0,totalPurchased:0,lastOrderDate:null,averageDeliveryTime:0,createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await El(Pe(pe,Zs),o)).id,...o},message:`Proveedor "${o.name}" creado exitosamente`}}catch(t){return console.error("Error creating supplier:",t),{success:!1,error:t.message}}},$2=async()=>{try{const n=Te(Pe(pe,Zs),In("name","asc"));return{success:!0,data:(await mt(n)).docs.map(i=>({id:i.id,...i.data()}))}}catch(n){return console.error("Error getting suppliers:",n),{success:!1,error:n.message}}},tC=n=>{const e=Te(Pe(pe,Zs),In("name","asc"));return Zr(e,t=>{const i=t.docs.map(o=>({id:o.id,...o.data()}));n(i)})},Y2=async(n,e,t)=>{try{const i=await Xi(et(pe,Zs,n));if(!i.exists())return{success:!1,error:"Proveedor no encontrado"};if(e.name&&e.name.trim()!==i.data().name){const c=Te(Pe(pe,Zs),De("name","==",e.name.trim()));if(!(await mt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${e.name}"`}}if(e.taxId&&e.taxId.trim()!==i.data().taxId){const c=Te(Pe(pe,Zs),De("taxId","==",e.taxId.trim()));if(!(await mt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${e.taxId}"`}}const o={...e,lastUpdated:new Date,updatedBy:t};return o.name&&(o.name=o.name.trim()),o.taxId&&(o.taxId=o.taxId.trim()),o.contactPerson&&(o.contactPerson=o.contactPerson.trim()),o.phone&&(o.phone=o.phone.trim()),o.email&&(o.email=o.email.trim()),await Rs(et(pe,Zs,n),o),{success:!0,message:"Proveedor actualizado exitosamente"}}catch(i){return console.error("Error updating supplier:",i),{success:!1,error:i.message}}},Q2=async(n,e)=>{try{return await Rs(et(pe,Zs,n),{status:"inactive",lastUpdated:new Date,updatedBy:e}),{success:!0,message:"Proveedor desactivado exitosamente"}}catch(t){return console.error("Error deleting supplier:",t),{success:!1,error:t.message}}},K2=async()=>{try{const n=await $2();if(!n.success)return n;const e=n.data,t={total:e.length,active:e.filter(i=>i.status==="active").length,inactive:e.filter(i=>i.status==="inactive").length,suspended:e.filter(i=>i.status==="suspended").length,preferred:e.filter(i=>i.isPreferred).length,averageRating:e.length>0?e.reduce((i,o)=>i+(o.rating||0),0)/e.length:0,byCategory:{},byType:{}};return e.forEach(i=>{const o=i.category||"sin_categoria";t.byCategory[o]=(t.byCategory[o]||0)+1}),e.forEach(i=>{const o=i.type||"sin_tipo";t.byType[o]=(t.byType[o]||0)+1}),{success:!0,data:t}}catch(n){return console.error("Error getting suppliers stats:",n),{success:!1,error:n.message}}},nC=H.createContext(),Zn=()=>{const n=H.useContext(nC);if(n===void 0)throw new Error("useCombustibles must be used within a CombustiblesProvider");return n},X2=({children:n})=>{const[e,t]=H.useState(null),[i,o]=H.useState(null),[c,d]=H.useState(!0),[f,p]=H.useState(null),[g,y]=H.useState([]),[N,E]=H.useState([]),[A,T]=H.useState([]),[R,b]=H.useState([]);H.useEffect(()=>{const U=MR(Jc,async I=>{try{if(d(!0),I){t(I);let D=await Mf(I.uid);D.success||(D=await IA(I,{provider:"existing_account",appContext:"combustibles"})),D.success?o(D.userData):p("Error cargando perfil de usuario")}else t(null),o(null),y([]),E([]),T([]),b([])}catch(D){console.error("Error en autenticacin:",D),p("Error de autenticacin")}finally{d(!1)}});return()=>U()},[]),H.useEffect(()=>{if(e){const U=zA(y),I=hy(T,be=>p(be.message)),D=tC(b),q=QE.subscribeToMovements(E,be=>p(be.message));return()=>{U(),I(),D(),q()}}},[e]);const V={user:e,userProfile:i,loading:c,error:f,hasPermission:U=>i?.combustiblesPermissions?.[U]||!1,isAdmin:()=>i?.role==="admin",isCounterOrAbove:()=>i?.role==="admin"||i?.role==="contador",inventory:g,movements:N,vehicles:A,suppliers:R,setInventory:y,setMovements:E,setVehicles:T,setSuppliers:b,deleteMovement:async U=>{try{return await QE.deleteMovement(U),{success:!0}}catch(I){return console.error("Error al eliminar el movimiento en el contexto:",I),p(I.message),{success:!1,error:I.message}}},refreshInventory:async()=>{console.log("Refrescando inventario...")},refreshMovements:async()=>{console.log("Refrescando movimientos...")},refreshVehicles:async()=>{console.log("Refrescando vehculos...")},refreshSuppliers:async()=>{console.log("Refrescando proveedores...")}};return s.jsx(nC.Provider,{value:V,children:n})},W2=({children:n,currentView:e,onViewChange:t})=>{const{userProfile:i,isAdmin:o,isCounterOrAbove:c}=Zn(),[d,f]=H.useState(!1),p=[{id:"dashboard",name:"Dashboard",icon:"",description:"Vista general",requiredPermission:null},{id:"inventory",name:"Inventario",icon:"",description:"Gestin de stock",requiredPermission:"canManageInventory"},{id:"movements",name:"Movimientos",icon:"",description:"Entradas y salidas",requiredPermission:"canCreateMovements"},{id:"vehicles",name:"Vehculos",icon:"",description:"Maquinaria forestal",requiredPermission:null},{id:"maintenance",name:"Mantenimiento",icon:"",description:"Cambios de aceite y bateras",requiredPermission:null},{id:"products",name:"Productos",icon:"",description:"Tipos de combustibles",requiredPermission:null},{id:"suppliers",name:"Proveedores",icon:"",description:"Gestin de proveedores",requiredPermission:"canManageSuppliers"},{id:"reports",name:"Reportes",icon:"",description:"Anlisis y reportes",requiredPermission:"canViewReports"},{id:"admin",name:"Administracin",icon:"",description:"Gestin de usuarios",requiredPermission:"admin"}],g=A=>{t(A),f(!1)},y=A=>A?A==="admin"?o():i?.combustiblesPermissions?.[A]||!1:!0,N=p.filter(A=>y(A.requiredPermission)),E=async()=>{try{await DR(Jc)}catch(A){console.error("Error al cerrar sesin:",A)}};return s.jsxs("div",{className:"dashboard-layout",children:[s.jsx("header",{className:"dashboard-header",children:s.jsxs("div",{className:"header-content",children:[s.jsx("button",{className:"sidebar-toggle",onClick:()=>f(!d),children:""}),s.jsxs("div",{className:"header-title",children:[s.jsx("h1",{children:" Gestin de Combustibles"}),s.jsx("span",{className:"subtitle",children:"Forestech Colombia"})]}),s.jsxs("div",{className:"header-user",children:[s.jsxs("div",{className:"user-info",children:[s.jsx("span",{className:"user-name",children:i?.displayName||i?.email}),s.jsx("span",{className:"user-role",children:i?.role})]}),s.jsx("div",{className:"user-avatar",children:i?.photoURL?s.jsx("img",{src:i.photoURL,alt:"Avatar"}):s.jsx("div",{className:"avatar-placeholder",children:(i?.displayName||i?.email||"U").charAt(0).toUpperCase()})}),s.jsx("button",{className:"logout-button",onClick:E,title:"Cerrar sesin",children:""})]})]})}),s.jsxs("div",{className:"dashboard-body",children:[s.jsxs("aside",{className:`dashboard-sidebar ${d?"open":""}`,children:[s.jsx("nav",{className:"sidebar-nav",children:N.map(A=>s.jsxs("button",{className:`nav-item ${e===A.id?"active":""}`,onClick:()=>g(A.id),children:[s.jsx("span",{className:"nav-icon",children:A.icon}),s.jsxs("div",{className:"nav-content",children:[s.jsx("span",{className:"nav-name",children:A.name}),s.jsx("span",{className:"nav-description",children:A.description})]})]},A.id))}),s.jsx("div",{className:"sidebar-footer",children:s.jsxs("div",{className:"user-permissions",children:[s.jsx("h4",{children:"Permisos Activos:"}),s.jsxs("div",{className:"permission-list",children:[o()&&s.jsx("span",{className:"permission admin",children:" Administrador"}),c()&&s.jsx("span",{className:"permission counter",children:" Gestin Operativa"}),y("canManageInventory")&&s.jsx("span",{className:"permission",children:" Inventario"}),y("canManageVehicles")&&s.jsx("span",{className:"permission",children:" Vehculos"})]})]})})]}),s.jsx("main",{className:"dashboard-main",children:s.jsx("div",{className:"main-content",children:n})})]}),d&&s.jsx("div",{className:"sidebar-overlay",onClick:()=>f(!1)})]})},Z2=(n=[])=>{if(!Array.isArray(n)||n.length===0){console.warn(" Inventario vaco o no vlido");return}console.group(" Estado Actual del Inventario"),console.log(`Total de items: ${n.length}`);const e=n.reduce((o,c)=>o+(parseFloat(c.currentStock)||0),0);console.log(`Stock total: ${e.toFixed(2)} galones`);const t=n.filter(o=>typeof o.currentStock>"u"||isNaN(parseFloat(o.currentStock))||o.currentStock!==o.quantity&&typeof o.quantity<"u");t.length>0&&(console.warn(` ${t.length} items con posibles problemas de datos:`),t.forEach(o=>{console.warn(`- ${o.fuelType||o.name||"Item sin nombre"}: currentStock=${o.currentStock}, quantity=${o.quantity}`)}));const i={};n.forEach(o=>{const c=o.fuelType||"Desconocido";i[c]||(i[c]=0),i[c]+=parseFloat(o.currentStock)||0}),console.log("Stock por tipo de combustible:"),Object.entries(i).forEach(([o,c])=>{console.log(`- ${o}: ${c.toFixed(2)} gal`)}),console.groupEnd()},J2=(n=[])=>{if(!Array.isArray(n)||n.length===0)return[];const e={},t=[];return n.forEach(i=>{const o=`${i.fuelType||""}:${i.location||""}`;e[o]?(e[o].push(i),e[o].length===2?t.push(...e[o]):e[o].length>2&&t.push(i)):e[o]=[i]}),t},WE=()=>{const{inventory:n,movements:e,vehicles:t,loading:i,error:o}=Zn();H.useEffect(()=>{if(!i&&n.length>0){console.log(" Ejecutando diagnstico del inventario..."),Z2(n);const g=J2(n);g.length>0&&(console.warn(` Se detectaron ${g.length} posibles items duplicados:`),console.table(g.map(y=>({id:y.id,tipo:y.fuelType,ubicacion:y.location,stock:y.currentStock}))))}},[i,n]);const c=g=>g?g.toDate&&typeof g.toDate=="function"?g.toDate():g.seconds?new Date(g.seconds*1e3):g instanceof Date?g:new Date(g):new Date,d=H.useMemo(()=>{const g=t.filter(T=>T.status==="activo").length,y=e.filter(T=>T.status==="pendiente").length;console.log("Inventario en DashboardMain:",n.map(T=>({id:T.id,fuelType:T.fuelType,currentStock:T.currentStock,pricePerUnit:T.pricePerUnit||T.unitPrice})));const N=n.filter(T=>T.status==="active").reduce((T,R)=>{const b=parseFloat(R.currentStock)||0;return console.log(`Sumando stock de ${R.fuelType}: ${b} gal`),T+b},0),E=n.filter(T=>T.isActive!==!1).reduce((T,R)=>{const b=parseFloat(R.currentStock)||0,k=parseFloat(R.pricePerUnit||R.unitPrice)||0;return T+b*k},0),A=n.filter(T=>{const R=parseFloat(T.currentStock)||0,b=parseFloat(T.minStock)||parseFloat(T.minThreshold)||20;return T.isActive!==!1&&R<=b}).length;return{totalFuel:N,totalValue:E,lowStockAlerts:A,activeInventoryItems:n.filter(T=>T.isActive!==!1).length,activeVehicles:g,pendingMovements:y,totalMaintenance:0,overdueMaintenance:0}},[n,t,e]),f=H.useMemo(()=>e.sort((g,y)=>c(y.createdAt).getTime()-c(g.createdAt).getTime()).slice(0,5),[e]),p=g=>{const y=g.quantity||0,N=g.fuelType||"N/A";switch(g.type){case"entrada":return`Entrada de ${y} gal de ${N}.`;case"salida":return`Salida de ${y} gal para vehculo ${g.vehicleId||"N/A"}.`;case"transferencia":return`Transferencia de ${y} gal.`;case"ajuste":return`Ajuste de inventario: ${y} gal de ${N}.`;default:return"Movimiento registrado."}};return i?s.jsxs("div",{className:"dashboard-main",children:[s.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),s.jsx("p",{className:"dashboard-subtitle",children:"Cargando datos en tiempo real..."}),s.jsx("div",{className:"loading-spinner-container",children:s.jsx("div",{className:"loading-spinner"})})]}):o?s.jsxs("div",{className:"dashboard-main",children:[s.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),s.jsxs("div",{className:"error-message",children:[s.jsxs("p",{children:[" ",o]}),s.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})]}):s.jsxs("div",{className:"dashboard-main",children:[s.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),s.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del estado de combustibles y maquinaria."}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon fuel-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("p",{children:"Combustible Total"}),s.jsxs("h2",{children:[ce(d.totalFuel)," gal"]})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon value-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("p",{children:"Valor Inventario"}),s.jsx("h2",{children:Me(d.totalValue)})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon vehicle-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("p",{children:"Vehculos Activos"}),s.jsx("h2",{children:ce(d.activeVehicles)})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon movement-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("p",{children:"Movimientos Pendientes"}),s.jsx("h2",{children:ce(d.pendingMovements)})]})]}),s.jsxs("div",{className:`stat-card ${d.lowStockAlerts>0?"alert":""}`,children:[s.jsx("div",{className:"stat-icon alert-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("p",{children:"Alertas de Stock"}),s.jsx("h2",{children:ce(d.lowStockAlerts)})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon maintenance-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("p",{children:"Mantenimientos"}),s.jsx("h2",{children:ce(d.totalMaintenance)})]})]}),s.jsxs("div",{className:`stat-card ${d.overdueMaintenance>0?"alert":""}`,children:[s.jsx("div",{className:"stat-icon maintenance-alert-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("p",{children:"Mantenimientos Vencidos"}),s.jsx("h2",{children:ce(d.overdueMaintenance)})]})]})]}),s.jsxs("div",{className:"dashboard-content",children:[s.jsxs("div",{className:"dashboard-widget",children:[s.jsx("h3",{children:"Actividad Reciente"}),f.length>0?s.jsx("ul",{children:f.map(g=>s.jsxs("li",{children:[s.jsx("span",{className:`movement-type-badge ${g.type}`,children:g.type}),p(g),s.jsx("span",{className:"movement-date",children:c(g.createdAt).toLocaleDateString()})]},g.id))}):s.jsx("p",{children:"No hay movimientos recientes."})]}),s.jsxs("div",{className:"dashboard-widget",children:[s.jsx("h3",{children:" Stock por Producto"}),n.length>0?s.jsx("div",{className:"products-summary",children:n.map(g=>{const y=parseFloat(g.currentStock)||0,N=parseFloat(g.minStock||g.minThreshold)||20;return s.jsxs("div",{className:"product-summary-item",children:[s.jsx("div",{className:"product-icon",children:""}),s.jsxs("div",{className:"product-info",children:[s.jsx("span",{className:"product-name",children:g.fuelType||g.name}),s.jsxs("div",{className:"product-stats",children:[s.jsxs("span",{className:"stock-value",children:[ce(y)," gal"]}),s.jsx("span",{className:`stock-status ${y<=N?"low":"normal"}`,children:y<=N?" Stock bajo":" Normal"})]})]})]},g.id)})}):s.jsx("div",{className:"no-products",children:s.jsx("p",{children:"No hay inventario registrado."})})]})]})]})},eV=({items:n,onEdit:e,onDelete:t,canManage:i})=>{const[o,c]=H.useState("name"),[d,f]=H.useState("asc"),p=T=>new Intl.NumberFormat("es-CO").format(T),g=T=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(T),y=T=>{if(!T)return"N/A";const R=new Date;let b;if(T&&typeof T=="object")if(T.seconds)b=new Date(T.seconds*1e3);else if(T.toDate&&typeof T.toDate=="function")b=T.toDate();else if(T instanceof Date)b=T;else return"N/A";else if(typeof T=="string"||typeof T=="number")b=new Date(T);else return"N/A";if(isNaN(b.getTime()))return"N/A";const k=R-b,_=Math.floor(k/(1e3*60*60)),j=Math.floor(_/24);return j>0?`${j}d`:_>0?`${_}h`:"ahora"},N=T=>{o===T?f(d==="asc"?"desc":"asc"):(c(T),f("asc"))},E=[...n].sort((T,R)=>{let b=T[o],k=R[o];if(o==="lastUpdated"){const _=j=>{if(!j)return new Date(0);if(j&&typeof j=="object"){if(j.seconds)return new Date(j.seconds*1e3);if(j.toDate&&typeof j.toDate=="function")return j.toDate();if(j instanceof Date)return j}return new Date(j)};b=_(b),k=_(k)}return b<k?d==="asc"?-1:1:b>k?d==="asc"?1:-1:0}),A=T=>o!==T?"":d==="asc"?"":"";return s.jsxs("div",{className:"inventory-table-container",children:[s.jsx("div",{className:"table-wrapper",children:s.jsxs("table",{className:"inventory-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsxs("th",{onClick:()=>N("name"),className:"sortable",children:["Combustible ",A("name")]}),s.jsxs("th",{onClick:()=>N("location"),className:"sortable",children:["Ubicacin ",A("location")]}),s.jsxs("th",{onClick:()=>N("currentStock"),className:"sortable",children:["Stock Actual ",A("currentStock")]}),s.jsxs("th",{onClick:()=>N("stockPercentage"),className:"sortable",children:["Nivel ",A("stockPercentage")]}),s.jsxs("th",{onClick:()=>N("pricePerUnit"),className:"sortable",children:["Precio ",A("pricePerUnit")]}),s.jsx("th",{children:"Valor Total"}),s.jsxs("th",{onClick:()=>N("status"),className:"sortable",children:["Estado ",A("status")]}),s.jsxs("th",{onClick:()=>N("lastUpdated"),className:"sortable",children:["Actualizado ",A("lastUpdated")]}),i&&s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:E.map(T=>{const R=Ss[T.fuelType],b=Vr[T.stockLevel],k=parseFloat(T.currentStock)||0,_=parseFloat(T.pricePerUnit)||0,j=parseFloat(T.maxCapacity)||0,S=parseFloat(T.stockPercentage)||0,O=k*_;return s.jsxs("tr",{className:T.needsRestock?"needs-restock":"",children:[s.jsx("td",{className:"fuel-cell",children:s.jsxs("div",{className:"fuel-info",children:[s.jsx("span",{className:"fuel-icon",style:{color:R?.color},children:R?.icon}),s.jsxs("div",{children:[s.jsx("div",{className:"fuel-name",children:R?.name}),s.jsx("div",{className:"fuel-type",children:T.fuelType})]})]})}),s.jsx("td",{children:T.location}),s.jsxs("td",{className:"stock-cell",children:[s.jsxs("div",{className:"stock-info",children:[s.jsx("span",{className:"stock-amount",children:p(k)}),s.jsxs("span",{className:"stock-unit",children:["/ ",p(j)," ",T.unit||"gal"]})]}),T.needsRestock&&s.jsx("div",{className:"restock-indicator",children:" Bajo mnimo"})]}),s.jsx("td",{className:"level-cell",children:s.jsxs("div",{className:"level-info",children:[s.jsxs("div",{className:"level-badge",style:{backgroundColor:b?.color,color:"white"},children:[S,"%"]}),s.jsx("div",{className:"level-bar",children:s.jsx("div",{className:"level-fill",style:{width:`${S}%`,backgroundColor:b?.color}})})]})}),s.jsx("td",{className:"price-cell",children:s.jsxs("div",{className:"price-info",children:[s.jsx("span",{className:"price-amount",children:g(_)}),s.jsxs("span",{className:"price-unit",children:["/ ",T.unit||"gal"]})]})}),s.jsx("td",{className:"value-cell",children:s.jsx("span",{className:"total-value",children:g(O)})}),s.jsx("td",{className:"status-cell",children:s.jsxs("span",{className:`status-badge ${T.status}`,children:[s.jsx("span",{className:"status-dot"}),T.status==="active"?"Activo":T.status==="inactive"?"Inactivo":T.status==="maintenance"?"Mantenimiento":T.status]})}),s.jsx("td",{className:"updated-cell",children:s.jsx("span",{className:"time-ago",children:y(T.lastUpdated)})}),i&&s.jsx("td",{className:"actions-cell",children:s.jsxs("div",{className:"action-buttons",children:[s.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(T),title:"Editar",children:""}),s.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(T),title:"Eliminar",children:""})]})})]},T.id)})})]})}),s.jsxs("div",{className:"table-footer",children:[s.jsxs("div",{className:"table-info",children:[E.length," items ordenados por ",o,"(",d==="asc"?"ascendente":"descendente",")"]}),s.jsxs("div",{className:"table-legend",children:[s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot critical"}),"Crtico"]}),s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot low"}),"Bajo"]}),s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot normal"}),"Normal"]}),s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},tV=({items:n,onEdit:e,onDelete:t,canManage:i})=>{const o=f=>new Intl.NumberFormat("es-CO",{maximumFractionDigits:0}).format(f),c=f=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(f),d=f=>{if(!f)return"sin fecha";try{const p=new Date,g=f.seconds?new Date(f.seconds*1e3):new Date(f),y=p-g,N=Math.floor(y/36e5),E=Math.floor(N/24);return E>0?`hace ${E} da${E>1?"s":""}`:N>0?`hace ${N} hora${N>1?"s":""}`:"hace unos minutos"}catch{return"fecha invlida"}};return s.jsx("div",{className:"inventory-cards-grid",children:n.map(f=>{const p=Ss[f.fuelType]||{},g=parseFloat(f.stockPercentage)||0;let y="default";g===0?y="empty":g<=15?y="critical":g<=30?y="low":g>=95?y="full":y="normal";const N=Vr[y],E=parseFloat(f.currentStock)||0,A=parseFloat(f.maxCapacity)||parseFloat(f.capacity)||1,T=parseFloat(f.pricePerUnit)||parseFloat(f.unitPrice)||0,R=E*T;return s.jsxs("div",{className:"inventory-card",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("div",{className:"fuel-info",children:[s.jsx("span",{className:"fuel-icon",style:{color:p.color},children:p.icon}),s.jsxs("div",{className:"fuel-details",children:[s.jsx("h3",{children:p.name||f.name}),s.jsx("p",{className:"location",children:f.location})]})]}),s.jsx("div",{className:"stock-status",children:s.jsxs("span",{className:"status-badge",style:{backgroundColor:N.color,color:"white"},children:[N.icon," ",N.label]})})]}),s.jsxs("div",{className:"stock-progress",children:[s.jsxs("div",{className:"progress-header",children:[s.jsxs("span",{className:"stock-text",children:[s.jsx("span",{className:"value",children:o(E)})," / ",o(A)," gal"]}),s.jsxs("span",{className:"percentage",style:{color:N.color},children:[g.toFixed(1),"%"]})]}),s.jsx("div",{className:"progress-bar",children:s.jsx("div",{className:"progress-fill",style:{width:`${g}%`,backgroundColor:N.color}})}),f.needsRestock&&s.jsx("div",{className:"restock-warning",children:" Nivel bajo"})]}),s.jsxs("div",{className:"card-metrics",children:[s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Precio/gal:"}),s.jsx("span",{className:"metric-value",children:c(T)})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Valor Total:"}),s.jsx("span",{className:"metric-value",children:c(R)})]})]}),s.jsxs("div",{className:"card-footer",children:[s.jsxs("div",{className:"last-update",children:["Actualizado ",d(f.updatedAt||f.lastUpdated)]}),i&&s.jsxs("div",{className:"card-actions",children:[s.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>e(f),children:"Editar"}),s.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>t(f),children:"Eliminar"})]})]})]},f.id)})})},nV=({item:n,onClose:e,onSuccess:t})=>{const{userProfile:i}=Zn(),o=!!n,[c,d]=H.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[f,p]=H.useState({}),[g,y]=H.useState(!1);H.useEffect(()=>{o&&n&&d({fuelType:n.fuelType||"",location:n.location||"",currentStock:n.currentStock||"",maxCapacity:n.maxCapacity||"",minThreshold:n.minThreshold||"",pricePerUnit:n.pricePerUnit||"",supplier:n.supplier||"",description:n.description||"",status:n.status||"active"})},[o,n]),H.useEffect(()=>{if(c.maxCapacity&&!c.minThreshold){const R=Math.round(Number(c.maxCapacity)*.15);d(b=>({...b,minThreshold:R}))}},[c.maxCapacity,c.minThreshold]);const N=R=>{const{name:b,value:k}=R.target;d(_=>({..._,[b]:k})),f[b]&&p(_=>({..._,[b]:null}))},E=()=>{const R={};c.fuelType||(R.fuelType="Tipo de combustible es requerido"),c.location||(R.location="Ubicacin es requerida"),c.maxCapacity||(R.maxCapacity="Capacidad mxima es requerida");const b=Number(c.currentStock),k=Number(c.maxCapacity),_=Number(c.minThreshold),j=Number(c.pricePerUnit);return c.currentStock&&(isNaN(b)||b<0)&&(R.currentStock="Stock actual debe ser un nmero vlido mayor o igual a 0"),c.maxCapacity&&(isNaN(k)||k<=0)&&(R.maxCapacity="Capacidad mxima debe ser un nmero vlido mayor a 0"),c.minThreshold&&(isNaN(_)||_<0)&&(R.minThreshold="Umbral mnimo debe ser un nmero vlido mayor o igual a 0"),c.pricePerUnit&&(isNaN(j)||j<0)&&(R.pricePerUnit="Precio debe ser un nmero vlido mayor o igual a 0"),b>k&&(R.currentStock="Stock actual no puede ser mayor a la capacidad mxima"),_>k&&(R.minThreshold="Umbral mnimo no puede ser mayor a la capacidad mxima"),p(R),Object.keys(R).length===0},A=async R=>{if(R.preventDefault(),!!E()){y(!0);try{let b;o?b=await F2(n.id,{location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},i.uid):b=await V2({fuelType:c.fuelType,location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},i.uid),b.success?(alert(b.message),t()):alert(`Error: ${b.error}`)}catch(b){console.error("Error saving inventory item:",b),alert("Error inesperado al guardar el item")}finally{y(!1)}}},T=Ss[c.fuelType];return s.jsx("div",{className:"modal-overlay",onClick:e,children:s.jsxs("div",{className:"modal-content inventory-modal",onClick:R=>R.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:o?" Editar Combustible":" Agregar Nuevo Combustible"}),s.jsx("button",{className:"modal-close",onClick:e,children:""})]}),s.jsxs("form",{onSubmit:A,className:"modal-form",children:[s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",T&&s.jsxs("span",{className:"fuel-preview",children:[T.icon," ",T.name]})]}),s.jsxs("select",{id:"fuelType",name:"fuelType",value:c.fuelType,onChange:N,disabled:o,className:f.fuelType?"error":"",required:!0,children:[s.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(Nn).map(([R,b])=>{const k=Ss[b];return s.jsxs("option",{value:b,children:[k.icon," ",k.name," (",k.unit,")"]},R)})]}),f.fuelType&&s.jsx("span",{className:"error-text",children:f.fuelType})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"location",children:"Ubicacin / Tanque *"}),s.jsx("input",{type:"text",id:"location",name:"location",value:c.location,onChange:N,placeholder:"ej. Tanque Principal, Depsito A, Bodega Norte",className:f.location?"error":"",required:!0}),f.location&&s.jsx("span",{className:"error-text",children:f.location})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",T&&`(${T.unit})`]}),s.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:c.currentStock,onChange:N,placeholder:"0",min:"0",step:"0.01",className:f.currentStock?"error":""}),f.currentStock&&s.jsx("span",{className:"error-text",children:f.currentStock})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad Mxima * ",T&&`(${T.unit})`]}),s.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:c.maxCapacity,onChange:N,placeholder:"1000",min:"1",step:"0.01",className:f.maxCapacity?"error":"",required:!0}),f.maxCapacity&&s.jsx("span",{className:"error-text",children:f.maxCapacity})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"minThreshold",children:["Umbral Mnimo ",T&&`(${T.unit})`,s.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),s.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:c.minThreshold,onChange:N,placeholder:"Auto: 15% de capacidad mxima",min:"0",step:"0.01",className:f.minThreshold?"error":""}),f.minThreshold&&s.jsx("span",{className:"error-text",children:f.minThreshold}),c.maxCapacity&&s.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(c.maxCapacity)*.15)," ",T?.unit||"unidades"]})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",T?.unit||"Unidad"]}),s.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:c.pricePerUnit,onChange:N,placeholder:"12000",min:"0",step:"0.01",className:f.pricePerUnit?"error":""}),f.pricePerUnit&&s.jsx("span",{className:"error-text",children:f.pricePerUnit})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),s.jsx("input",{type:"text",id:"supplier",name:"supplier",value:c.supplier,onChange:N,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"status",children:"Estado"}),s.jsxs("select",{id:"status",name:"status",value:c.status,onChange:N,children:[s.jsx("option",{value:"active",children:"Activo"}),s.jsx("option",{value:"inactive",children:"Inactivo"}),s.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),s.jsxs("div",{className:"form-group full-width",children:[s.jsx("label",{htmlFor:"description",children:"Descripcin / Notas"}),s.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:N,placeholder:"Informacin adicional sobre este combustible...",rows:"3"})]})]}),T&&c.maxCapacity&&s.jsxs("div",{className:"form-preview",children:[s.jsx("h4",{children:" Vista Previa"}),s.jsxs("div",{className:"preview-card",children:[s.jsxs("div",{className:"preview-header",children:[s.jsxs("span",{style:{color:T.color},children:[T.icon," ",T.name]}),s.jsx("span",{children:c.location})]}),s.jsxs("div",{className:"preview-capacity",children:[c.currentStock||0," / ",c.maxCapacity," ",T.unit,c.currentStock&&c.maxCapacity&&s.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(c.currentStock)/Number(c.maxCapacity)*100),"%)"]})]}),c.pricePerUnit&&s.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(c.currentStock)||0)*Number(c.pricePerUnit))]})]})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Cancelar"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:g,children:g?"Guardando...":o?"Actualizar":"Crear"})]})]})]})})},sV=({stats:n})=>s.jsxs("div",{className:"inventory-stats",children:[s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card primary",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:"Valor Total"}),s.jsx("div",{className:"stat-value",children:Me(n.totalValue)}),s.jsxs("div",{className:"stat-subtitle",children:[ce(n.totalItems)," tipos de combustible"]})]})]}),s.jsxs("div",{className:"stat-card success",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:"Items Activos"}),s.jsx("div",{className:"stat-value",children:n.activeItems}),s.jsxs("div",{className:"stat-subtitle",children:[Math.round(n.activeItems/n.totalItems*100),"% del total"]})]})]}),s.jsxs("div",{className:`stat-card ${n.lowStockItems>0?"warning":"info"}`,children:[s.jsx("div",{className:"stat-icon",children:n.lowStockItems>0?"":""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:"Stock Bajo"}),s.jsx("div",{className:"stat-value",children:n.lowStockItems}),s.jsx("div",{className:"stat-subtitle",children:n.lowStockItems>0?"Requieren atencin":"Niveles normales"})]})]}),s.jsxs("div",{className:"stat-card info",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:"Nivel Promedio"}),s.jsxs("div",{className:"stat-value",children:[n.averageStockLevel,"%"]}),s.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),s.jsxs("div",{className:"fuel-type-summary",children:[s.jsx("h4",{children:" Resumen por Tipo de Combustible"}),s.jsx("div",{className:"fuel-types-grid",children:Object.entries(n.byFuelType).map(([e,t])=>{const i=Ss[e],o=t.totalCapacity>0?Math.round(t.totalStock/t.totalCapacity*100):0;return s.jsxs("div",{className:"fuel-type-card",children:[s.jsxs("div",{className:"fuel-header",children:[s.jsx("span",{className:"fuel-icon",style:{color:i?.color||"#6b7280"},children:i?.icon||""}),s.jsxs("div",{className:"fuel-info",children:[s.jsx("h5",{children:i?.name||e}),s.jsxs("span",{className:"fuel-count",children:[t.count," ubicaciones"]})]})]}),s.jsxs("div",{className:"fuel-metrics",children:[s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Stock Total:"}),s.jsxs("span",{className:"metric-value",children:[ce(t.totalStock)," ",i?.unit||"unidades"]})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Capacidad:"}),s.jsxs("span",{className:"metric-value",children:[ce(t.totalCapacity)," ",i?.unit||"unidades"]})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Utilizacin:"}),s.jsxs("span",{className:`metric-value ${o<25?"low":o>75?"high":"normal"}`,children:[o,"%"]})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Valor:"}),s.jsx("span",{className:"metric-value",children:Me(t.totalValue)})]})]}),s.jsx("div",{className:"progress-bar",children:s.jsx("div",{className:"progress-fill",style:{width:`${o}%`,backgroundColor:i?.color||"#6b7280"}})})]},e)})}),Object.keys(n.byFuelType).length===0&&s.jsx("div",{className:"empty-fuel-types",children:s.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),aV=()=>{const{hasPermission:n}=Zn(),[e,t]=H.useState([]),[i,o]=H.useState(null),[c,d]=H.useState(!0),[f,p]=H.useState(null),[g,y]=H.useState("cards"),[N,E]=H.useState(!1),[A,T]=H.useState(null),[R,b]=H.useState("all"),[k,_]=H.useState("");H.useEffect(()=>{let M=null;return(()=>{M=zA((U,I)=>{if(I){console.error("Error in inventory subscription:",I),p("Error cargando inventario en tiempo real");return}t(U||[]),d(!1)})})(),()=>{M&&M()}},[]),H.useEffect(()=>{(async()=>{const V=await H2();V.success&&o(V.data)})()},[e]);const j=e.filter(M=>{if(R==="active"&&M.status!=="active"||R==="low-stock"&&!M.needsRestock)return!1;if(k){const V=k.toLowerCase();return M.name.toLowerCase().includes(V)||M.location.toLowerCase().includes(V)||M.fuelType.toLowerCase().includes(V)}return!0}),S=M=>{if(!n("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}T(M),E(!0)},O=async M=>{if(!n("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`Ests seguro de eliminar ${M.name} de ${M.location}?

Esta accin no se puede deshacer.`))return;d(!0);const U=await q2(M.id);U.success?alert("Item eliminado exitosamente"):(p(U.error),alert(`Error al eliminar: ${U.error}`)),d(!1)},B=()=>{E(!1),T(null)},L=()=>{B()};return c&&e.length===0?s.jsxs("div",{className:"inventory-loading",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Cargando inventario..."})]}):s.jsxs("div",{className:"inventory-main",children:[s.jsxs("div",{className:"inventory-header",children:[s.jsxs("div",{className:"header-title",children:[s.jsx("h2",{children:" Gestin de Inventario"}),s.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),s.jsx("div",{className:"inventory-info",children:s.jsxs("span",{className:"info-text",children:[" Los combustibles se agregan automticamente desde la pestaa ",s.jsx("strong",{children:"Movimientos"})]})})]}),i&&s.jsx(sV,{stats:i}),s.jsxs("div",{className:"inventory-controls",children:[s.jsxs("div",{className:"search-filters",children:[s.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicacin o tipo...",value:k,onChange:M=>_(M.target.value),className:"search-input"}),s.jsxs("select",{value:R,onChange:M=>b(M.target.value),className:"filter-select",children:[s.jsx("option",{value:"all",children:"Todos los items"}),s.jsx("option",{value:"active",children:"Solo activos"}),s.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),s.jsxs("div",{className:"view-toggle",children:[s.jsx("button",{className:`toggle-btn ${g==="cards"?"active":""}`,onClick:()=>y("cards"),children:" Cards"}),s.jsx("button",{className:`toggle-btn ${g==="table"?"active":""}`,onClick:()=>y("table"),children:" Tabla"})]})]}),f&&s.jsxs("div",{className:"error-banner",children:[s.jsxs("span",{children:[" ",f]}),s.jsx("button",{onClick:()=>p(null),children:""})]}),s.jsx("div",{className:"inventory-content",children:j.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:""}),s.jsx("h3",{children:"No hay items de inventario"}),s.jsx("p",{children:k||R!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaa Movimientos para crear una ENTRADA de combustible"})]}):s.jsx(s.Fragment,{children:g==="cards"?s.jsx(tV,{items:j,onEdit:S,onDelete:O,canManage:n("canManageInventory")}):s.jsx(eV,{items:j,onEdit:S,onDelete:O,canManage:n("canManageInventory")})})}),j.length>0&&s.jsx("div",{className:"results-footer",children:s.jsxs("p",{children:["Mostrando ",j.length," de ",e.length," items",k&&`  Filtro: "${k}"`,R!=="all"&&`  Estado: ${R}`]})}),N&&s.jsx(nV,{item:A,onClose:B,onSuccess:L})]})},iV=({stats:n,filters:e})=>{if(!n)return null;const t=(d,f)=>f===0?d>0?100:0:((d-f)/f*100).toFixed(1),i=d=>{switch(d){case ue.ENTRADA:return"#10b981";case ue.SALIDA:return"#ef4444";case ue.TRANSFERENCIA:return"#3b82f6";case ue.AJUSTE:return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case ue.ENTRADA:return"";case ue.SALIDA:return"";case ue.TRANSFERENCIA:return"";case ue.AJUSTE:return"";default:return""}},c=t(n.thisMonth,n.lastMonth);return s.jsxs("div",{className:"movements-stats",children:[s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card primary",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:ce(n.totalMovements)}),s.jsx("div",{className:"stat-label",children:"Total Movimientos"}),s.jsxs("div",{className:"stat-trend",children:[s.jsxs("span",{className:`trend ${c>=0?"positive":"negative"}`,children:[c>=0?"":""," ",Math.abs(c),"%"]}),s.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:Me(n.totalValue)}),s.jsx("div",{className:"stat-label",children:"Valor Total"}),s.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Me(n.averageValue)]})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:ce(n.totalQuantity)}),s.jsx("div",{className:"stat-label",children:"Galones Total"}),s.jsxs("div",{className:"stat-secondary",children:["Promedio: ",ce(n.totalQuantity/(n.totalMovements||1))," gal/mov"]})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:ce(n.thisWeek)}),s.jsx("div",{className:"stat-label",children:"Esta Semana"}),s.jsxs("div",{className:"stat-secondary",children:[ce(n.thisMonth)," este mes"]})]})]})]}),s.jsxs("div",{className:"stats-breakdown",children:[s.jsxs("div",{className:"breakdown-section",children:[s.jsx("h4",{children:" Por Tipo de Movimiento"}),s.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1);return s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-header",children:[s.jsx("span",{className:"breakdown-icon",children:o(d)}),s.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),s.jsx("div",{className:"breakdown-value",children:f}),s.jsx("div",{className:"breakdown-bar",children:s.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:i(d)}})}),s.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),s.jsxs("div",{className:"breakdown-section",children:[s.jsx("h4",{children:" Por Estado"}),s.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),g=N=>{switch(N){case vt.COMPLETADO:return"#10b981";case vt.PENDIENTE:return"#f59e0b";case vt.CANCELADO:return"#ef4444";default:return"#6b7280"}},y=N=>{switch(N){case vt.COMPLETADO:return"";case vt.PENDIENTE:return"";case vt.CANCELADO:return"";default:return""}};return s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-header",children:[s.jsx("span",{className:"breakdown-icon",children:y(d)}),s.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),s.jsx("div",{className:"breakdown-value",children:f}),s.jsx("div",{className:"breakdown-bar",children:s.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:g(d)}})}),s.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),s.jsxs("div",{className:"breakdown-section",children:[s.jsx("h4",{children:" Por Tipo de Combustible"}),s.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),g=y=>{switch(y?.toLowerCase()){case"diesel":return"";case"gasolina":return"";case"acpm":return"";case"lubricante":return"";default:return""}};return s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-header",children:[s.jsx("span",{className:"breakdown-icon",children:g(d)}),s.jsx("span",{className:"breakdown-label",children:d})]}),s.jsx("div",{className:"breakdown-value",children:f}),s.jsx("div",{className:"breakdown-bar",children:s.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:"#059669"}})}),s.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]})]}),(e.type||e.status||e.fuelType||e.vehicleId)&&s.jsxs("div",{className:"active-filters",children:[s.jsx("h4",{children:" Filtros Activos"}),s.jsxs("div",{className:"filters-list",children:[e.type&&s.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&s.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&s.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.vehicleId&&s.jsxs("span",{className:"filter-tag",children:["Vehculo: ",e.vehicleId]})]})]})]})},rV=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:i,onSearchChange:o,totalResults:c})=>{const[d,f]=H.useState(!1),p=[{value:"Diesel",label:"Diesel "},{value:"Gasolina",label:"Gasolina "},{value:"ACPM",label:"ACPM "},{value:"Lubricante",label:"Lubricante "}],g=[{value:"all",label:"Todos los perodos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este ao"}],y=Object.values(n).filter(A=>A&&A!==""&&A!=="all").length,N=(A,T)=>{e({[A]:T})},E=A=>{e(A)};return s.jsxs("div",{className:"movements-filters",children:[s.jsxs("div",{className:"filters-main",children:[s.jsx("div",{className:"search-section",children:s.jsxs("div",{className:"search-box",children:[s.jsx("span",{className:"search-icon",children:""}),s.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehculo, referencia...",value:i,onChange:A=>o(A.target.value),className:"search-input"}),i&&s.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar bsqueda",children:""})]})}),s.jsxs("div",{className:"filters-controls",children:[s.jsxs("div",{className:"quick-filters",children:[s.jsx("button",{className:`quick-filter ${n.type===ue.ENTRADA?"active":""}`,onClick:()=>E({type:ue.ENTRADA}),children:" Entradas"}),s.jsx("button",{className:`quick-filter ${n.type===ue.SALIDA?"active":""}`,onClick:()=>E({type:ue.SALIDA}),children:" Salidas"}),s.jsx("button",{className:`quick-filter ${n.status===vt.PENDIENTE?"active":""}`,onClick:()=>E({status:vt.PENDIENTE}),children:" Pendientes"})]}),s.jsxs("button",{className:`btn-advanced-filters ${d?"active":""}`,onClick:()=>f(!d),children:[" Filtros",y>0&&s.jsx("span",{className:"filters-count",children:y})]}),s.jsx("div",{className:"view-indicator",children:s.jsx("span",{className:"view-info",children:" Vista Tabla"})})]})]}),d&&s.jsxs("div",{className:"filters-advanced",children:[s.jsxs("div",{className:"filters-grid",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tipo de Movimiento"}),s.jsxs("select",{value:n.type,onChange:A=>N("type",A.target.value),className:"filter-select",children:[s.jsx("option",{value:"",children:"Todos los tipos"}),s.jsx("option",{value:ue.ENTRADA,children:" Entrada"}),s.jsx("option",{value:ue.SALIDA,children:" Salida"}),s.jsx("option",{value:ue.TRANSFERENCIA,children:" Transferencia"}),s.jsx("option",{value:ue.AJUSTE,children:" Ajuste"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Estado"}),s.jsxs("select",{value:n.status,onChange:A=>N("status",A.target.value),className:"filter-select",children:[s.jsx("option",{value:"",children:"Todos los estados"}),s.jsx("option",{value:vt.PENDIENTE,children:" Pendiente"}),s.jsx("option",{value:vt.COMPLETADO,children:" Completado"}),s.jsx("option",{value:vt.CANCELADO,children:" Cancelado"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tipo de Combustible"}),s.jsxs("select",{value:n.fuelType,onChange:A=>N("fuelType",A.target.value),className:"filter-select",children:[s.jsx("option",{value:"",children:"Todos los combustibles"}),p.map(A=>s.jsx("option",{value:A.value,children:A.label},A.value))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Perodo"}),s.jsx("select",{value:n.dateRange,onChange:A=>N("dateRange",A.target.value),className:"filter-select",children:g.map(A=>s.jsx("option",{value:A.value,children:A.label},A.value))})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Vehculo/Equipo"}),s.jsx("input",{type:"text",placeholder:"ID del vehculo...",value:n.vehicleId,onChange:A=>N("vehicleId",A.target.value),className:"filter-input"})]})]}),s.jsxs("div",{className:"filters-actions",children:[s.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:y===0,children:" Limpiar Filtros"}),s.jsxs("div",{className:"filters-info",children:[s.jsxs("span",{className:"results-count",children:[c," resultado",c!==1?"s":""]}),y>0&&s.jsxs("span",{className:"active-filters-text",children:["(",y," filtro",y!==1?"s":""," activo",y!==1?"s":"",")"]})]})]})]}),s.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:s.jsx("small",{children:" Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},oV=({movements:n,onEdit:e,onView:t,onApprove:i,onReject:o,onDelete:c,userRole:d})=>{const[f,p]=H.useState("createdAt"),[g,y]=H.useState("desc"),N=S=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(S),E=S=>S?(S instanceof Date?S:new Date(S)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",A=S=>{switch(S){case ue.ENTRADA:return"";case ue.SALIDA:return"";case ue.TRANSFERENCIA:return"";case ue.AJUSTE:return"";default:return""}},T=S=>{switch(S?.toLowerCase()){case"diesel":return"";case"gasolina":return"";case"acpm":return"";case"lubricante":return"";default:return""}},R=S=>{switch(S){case vt.COMPLETADO:return"";case vt.PENDIENTE:return"";case vt.CANCELADO:return"";default:return""}},b=S=>{switch(S){case vt.COMPLETADO:return"status-completado";case vt.PENDIENTE:return"status-pendiente";case vt.CANCELADO:return"status-cancelado";default:return"status-default"}},k=S=>{f===S?y(g==="asc"?"desc":"asc"):(p(S),y("asc"))},_=[...n].sort((S,O)=>{let B=S[f],L=O[f];return(f.includes("Date")||f.includes("At"))&&(B=new Date(B),L=new Date(L)),typeof B=="number"&&typeof L=="number"?g==="asc"?B-L:L-B:typeof B=="string"&&typeof L=="string"?g==="asc"?B.localeCompare(L):L.localeCompare(B):B instanceof Date&&L instanceof Date?g==="asc"?B-L:L-B:0}),j=S=>f!==S?"":g==="asc"?"":"";return s.jsxs("div",{className:"movements-table-container",children:[s.jsx("div",{className:"table-wrapper",children:s.jsxs("table",{className:"movements-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsxs("th",{className:"sortable",onClick:()=>k("type"),children:["Tipo ",j("type")]}),s.jsxs("th",{className:"sortable",onClick:()=>k("fuelType"),children:["Combustible ",j("fuelType")]}),s.jsxs("th",{className:"sortable text-right",onClick:()=>k("quantity"),children:["Cantidad ",j("quantity")]}),s.jsxs("th",{className:"sortable text-right",onClick:()=>k("unitPrice"),children:["Precio/Gal ",j("unitPrice")]}),s.jsxs("th",{className:"sortable text-right",onClick:()=>k("totalValue"),children:["Valor Total ",j("totalValue")]}),s.jsx("th",{children:"Vehculo"}),s.jsx("th",{children:"Ubicacin"}),s.jsxs("th",{className:"sortable",onClick:()=>k("status"),children:["Estado ",j("status")]}),s.jsxs("th",{className:"sortable",onClick:()=>k("createdAt"),children:["Fecha ",j("createdAt")]}),s.jsx("th",{className:"actions-column",children:"Acciones"})]})}),s.jsx("tbody",{children:_.map(S=>s.jsxs("tr",{className:`movement-row ${S.status===vt.PENDIENTE?"pending-row":""}`,children:[s.jsx("td",{className:"type-cell",children:s.jsxs("div",{className:"type-content",children:[s.jsx("span",{className:"type-icon",children:A(S.type)}),s.jsx("span",{className:"type-text",children:S.type.charAt(0).toUpperCase()+S.type.slice(1)})]})}),s.jsx("td",{className:"fuel-cell",children:s.jsxs("div",{className:"fuel-content",children:[s.jsx("span",{className:"fuel-icon",children:T(S.fuelType)}),s.jsx("span",{className:"fuel-text",children:S.fuelType})]})}),s.jsxs("td",{className:"quantity-cell text-right",children:[s.jsx("span",{className:"quantity-value",children:S.quantity}),s.jsx("span",{className:"quantity-unit",children:"gal"})]}),s.jsx("td",{className:"price-cell text-right",children:N(S.unitPrice)}),s.jsx("td",{className:"value-cell text-right",children:s.jsx("strong",{children:N(S.totalValue)})}),s.jsx("td",{className:"vehicle-cell",children:S.vehicleId?s.jsxs("span",{className:"vehicle-id",children:[" ",S.vehicleId]}):s.jsx("span",{className:"no-vehicle",children:"-"})}),s.jsx("td",{className:"location-cell",children:s.jsxs("span",{className:"location-text",children:[" ",S.type===ue.ENTRADA?S.destinationLocation||"Sin ubicacin":S.location||"Principal"]})}),s.jsx("td",{className:"status-cell",children:s.jsxs("div",{className:`status-badge ${b(S.status)}`,children:[s.jsx("span",{className:"status-icon",children:R(S.status)}),s.jsx("span",{className:"status-text",children:S.status.charAt(0).toUpperCase()+S.status.slice(1)})]})}),s.jsx("td",{className:"date-cell",children:s.jsxs("div",{className:"date-content",children:[s.jsx("span",{className:"date-value",children:E(S.createdAt)}),S.reference&&s.jsxs("span",{className:"reference-small",children:["#",S.reference]})]})}),s.jsx("td",{className:"actions-cell",children:s.jsxs("div",{className:"action-buttons",children:[s.jsx("button",{className:"btn-action btn-view",onClick:()=>t(S),title:"Ver detalles",children:""}),d==="admin"&&S.status===vt.PENDIENTE&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"btn-action btn-approve",onClick:()=>i(S.id),title:"Aprobar movimiento",children:""}),s.jsx("button",{className:"btn-action btn-reject",onClick:()=>o(S.id),title:"Rechazar movimiento",children:""})]}),e&&S.status===vt.PENDIENTE&&s.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(S),title:"Editar movimiento",children:""}),d==="admin"&&s.jsx("button",{className:"btn-action btn-delete",onClick:()=>{window.confirm("Ests seguro de que deseas eliminar este movimiento? Esta accin no se puede deshacer.")&&c(S.id)},title:"Eliminar movimiento",children:""})]})})]},S.id))})]})}),s.jsxs("div",{className:"table-info",children:[s.jsxs("div",{className:"table-summary",children:[s.jsxs("span",{className:"total-rows",children:[n.length," movimiento",n.length!==1?"s":""]}),f&&s.jsxs("span",{className:"sort-info",children:["Ordenado por ",f," (",g==="asc"?"ascendente":"descendente",")"]})]}),s.jsxs("div",{className:"table-legend",children:[s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-icon",children:""})," Pendiente"]}),s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-icon",children:""})," Completado"]}),s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-icon",children:""})," Cancelado"]})]})]})]})},lV=({movements:n,onEdit:e,onView:t,onApprove:i,onReject:o,onDelete:c,userRole:d})=>s.jsx(oV,{movements:n,onEdit:e,onView:t,onApprove:i,onReject:o,onDelete:c,userRole:d}),ka={ACPM:"ACPM",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},sC={[ka.ACPM]:{name:"ACPM",displayName:"ACPM ",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"",description:"Combustible diesel para vehculos pesados"},[ka.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina ",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"",description:"Gasolina corriente para vehculos livianos"},[ka.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidrulico ",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"",description:"Aceite hidrulico para sistemas de maquinaria"},[ka.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 ",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"",description:"Aceite multigrado para motores"},[ka.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja ",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"",description:"Grasa lubricante multipropsito"},[ka.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"",description:"Aceite para transmisiones y diferenciales"},[ka.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Lquido para Frenos ",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"",description:"Lquido de frenos DOT 3/4"},[ka.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga ",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"",description:"Mezcla de combustible para equipos menores"},[ka.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 ",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"",description:"Aceite especializado para tractores"}},Ks={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},ZE=()=>Object.values(sC),JE="combustibles_products",cV=async()=>{try{console.log(" Verificando productos existentes...");const n=Te(Pe(pe,JE),Zk(1));if(!(await mt(n)).empty){console.log(" Productos ya existen en Firebase");return}console.log(" Creando productos predefinidos...");const t=Object.values(sC).map(async o=>{const c={name:o.name,displayName:o.displayName,category:o.category,unit:o.unit,defaultPrice:o.defaultPrice,color:o.color,icon:o.icon,description:o.description,isActive:!0,createdAt:new Date,updatedAt:new Date,createdBy:"system-initialization"},d=et(Pe(pe,JE));return await Tf(d,c),console.log(` Producto creado: ${o.displayName}`),{id:d.id,...c}}),i=await Promise.all(t);return console.log(` ${i.length} productos inicializados correctamente`),i}catch(n){throw console.error(" Error inicializando productos:",n),n}},uV=async()=>{try{await cV()}catch(n){console.error(" Error en inicializacin automtica:",n)}},gl="combustibles_products",og=async n=>{try{const e={...n,createdAt:qe(),updatedAt:qe()},t=await El(Pe(pe,gl),e);return console.log("Product created with ID:",t.id),t.id}catch(e){throw console.error("Error creating product:",e),e}},dV=async(n,e)=>{try{const t=et(pe,gl,n);await Rs(t,{...e,updatedAt:qe()}),console.log("Product updated successfully")}catch(t){throw console.error("Error updating product:",t),t}},hV=async n=>{try{await Af(et(pe,gl,n)),console.log("Product deleted successfully")}catch(e){throw console.error("Error deleting product:",e),e}},fV=async()=>{try{await uV(),console.log(" Obteniendo productos activos...");const n=Te(Pe(pe,gl),De("isActive","==",!0),In("name")),t=(await mt(n)).docs.map(i=>({id:i.id,...i.data()}));return console.log(` Productos activos obtenidos: ${t.length}`),t}catch(n){if(console.error(" Error obteniendo productos activos:",n),n.code==="failed-precondition"||n.message.includes("index")){console.warn(" ndice no disponible, usando consulta alternativa...");try{const e=Te(Pe(pe,gl),De("isActive","==",!0)),o=(await mt(e)).docs.map(c=>({id:c.id,...c.data()})).sort((c,d)=>(c.name||"").localeCompare(d.name||""));return console.log(` Productos activos obtenidos (ordenamiento en cliente): ${o.length}`),o}catch(e){throw console.error(" Error en consulta alternativa:",e),e}}throw n}},mV=(n,e)=>{try{const t=Te(Pe(pe,gl),In("name"));return Zr(t,i=>{const o=i.docs.map(c=>({id:c.id,...c.data()}));n(o)},i=>{console.error("Error in products subscription:",i),e(i)})}catch(t){return console.error("Error setting up products subscription:",t),e(t),()=>{}}},pV=({formData:n,updateFormData:e,setError:t,isActive:i})=>{const o=[{type:ue.ENTRADA,icon:"",title:"Entrada",description:"Compra o reabastecimiento de combustible",color:"entrada",details:"Registra combustible que llega desde proveedores"},{type:ue.SALIDA,icon:"",title:"Salida",description:"Consumo de combustible por vehculos",color:"salida",details:"Asigna combustible a vehculos y equipos"},{type:ue.TRANSFERENCIA,icon:"",title:"Transferencia",description:"Movimiento entre ubicaciones",color:"transferencia",details:"Traslada combustible entre tanques o sitios"},{type:ue.AJUSTE,icon:"",title:"Ajuste",description:"Correccin de inventario",color:"ajuste",details:"Ajusta stock por mermas, prdidas o calibraciones"}],c=d=>{e("type",d),t("")};return s.jsx("div",{className:`wizard-step step-movement-type ${i?"active":""}`,children:s.jsxs("div",{className:"typeform-layout",children:[s.jsxs("div",{className:"typeform-question",children:[s.jsx("h3",{children:" Qu tipo de operacin realizars?"}),s.jsx("p",{children:"Selecciona el tipo de movimiento que necesitas registrar:"})]}),s.jsx("div",{className:"typeform-options",children:o.map(d=>s.jsxs("div",{className:`typeform-option ${n.type===d.type?"selected":""} ${d.color}`,onClick:()=>c(d.type),children:[s.jsx("div",{className:"typeform-option-icon",children:d.icon}),s.jsxs("div",{className:"typeform-option-content",children:[s.jsx("h4",{children:d.title}),s.jsx("p",{children:d.description})]}),s.jsx("div",{className:"typeform-option-selector",children:s.jsx("div",{className:"typeform-check",children:s.jsx("span",{className:"typeform-check-icon",children:""})})})]},d.type))}),n.type&&s.jsx("div",{className:"selection-confirmation",children:s.jsxs("div",{className:"confirmation-card",children:[s.jsx("span",{className:"confirmation-icon",children:o.find(d=>d.type===n.type)?.icon}),s.jsxs("div",{className:"confirmation-text",children:[s.jsx("strong",{children:"Seleccionado:"})," ",o.find(d=>d.type===n.type)?.title,s.jsx("br",{}),s.jsx("small",{children:o.find(d=>d.type===n.type)?.description})]})]})})]})})},gV=({formData:n,updateFormData:e,systemData:t,setError:i,isActive:o})=>{const[c,d]=H.useState(!1),[f,p]=H.useState(null),{products:g}=t;H.useEffect(()=>{if(n.fuelType&&g.length>0){const N=g.find(E=>E.name===n.fuelType||E.displayName===n.fuelType);p(N),N&&N.defaultPrice&&!n.unitPrice&&e("unitPrice",N.defaultPrice.toString())}},[n.fuelType,n.unitPrice,g,e]);const y=async(N,E)=>{d(!0),i("");try{await new Promise(A=>setTimeout(A,800)),e("fuelType",N),p(E),E.defaultPrice&&e("unitPrice",E.defaultPrice.toString()),console.log(" [Step2] Combustible seleccionado:",N,"Precio:",E.defaultPrice),console.log(" [Step2] FormData despus de actualizacin:",{fuelType:N,unitPrice:E.defaultPrice})}catch(A){console.error("Error al cargar combustible:",A),i("Error al cargar informacin del combustible")}finally{d(!1)}};return g.length===0?s.jsx("div",{className:`wizard-step step-fuel-type ${o?"active":""}`,children:s.jsx("div",{className:"typeform-layout",children:s.jsxs("div",{className:"loading-state",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:" Cargando productos disponibles..."})]})})}):s.jsx("div",{className:`wizard-step step-fuel-type ${o?"active":""}`,children:s.jsxs("div",{className:"typeform-layout",children:[s.jsxs("div",{className:"typeform-question",children:[s.jsx("h3",{children:" Qu combustible vas a mover?"}),s.jsx("p",{children:"Selecciona el producto del inventario:"})]}),c&&s.jsxs("div",{className:"loading-overlay",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:" Solicitando precios actualizados..."})]}),s.jsx("div",{className:"typeform-options",children:g.map(N=>s.jsxs("div",{className:`typeform-option ${n.fuelType===N.name?"selected":""} ${c?"disabled":""}`,onClick:()=>!c&&y(N.name,N),children:[s.jsx("div",{className:"typeform-option-icon",children:N.icon||""}),s.jsxs("div",{className:"typeform-option-content",children:[s.jsx("h4",{children:N.displayName||N.name}),s.jsx("p",{children:N.description||"Combustible"}),N.defaultPrice&&s.jsxs("div",{className:"fuel-price",children:[s.jsx("span",{className:"price-label",children:"Precio actual:"}),s.jsxs("span",{className:"price-value",children:["$",N.defaultPrice.toLocaleString("es-CO")," COP/gal"]})]})]}),s.jsx("div",{className:"typeform-option-selector",children:s.jsx("div",{className:"typeform-check",children:s.jsx("span",{className:"typeform-check-icon",children:""})})})]},N.id))}),f&&n.fuelType&&s.jsx("div",{className:"selection-confirmation",children:s.jsxs("div",{className:"confirmation-card fuel-confirmation",children:[s.jsxs("div",{className:"confirmation-header",children:[s.jsx("span",{className:"confirmation-icon",children:f.icon||""}),s.jsxs("div",{className:"confirmation-text",children:[s.jsx("strong",{children:f.displayName||f.name}),s.jsx("br",{}),s.jsx("small",{children:f.description||"Combustible seleccionado"})]})]}),f.defaultPrice&&s.jsxs("div",{className:"price-confirmation",children:[s.jsxs("div",{className:"price-info",children:[s.jsx("span",{className:"price-label",children:" Precio por galn:"}),s.jsxs("span",{className:"price-amount",children:["$",f.defaultPrice.toLocaleString("es-CO")," COP"]})]}),s.jsx("small",{className:"price-note",children:" Precio aplicado automticamente (puedes modificarlo ms adelante)"})]})]})})]})})},vV=({formData:n,updateFormData:e,systemData:t,setError:i,isActive:o})=>{const[c,d]=H.useState(!1),[f,p]=H.useState({}),[g,y]=H.useState(!1),{suppliers:N,inventory:E}=t,A=n.type===ue.ENTRADA;H.useEffect(()=>{(async()=>{if(!A&&n.fuelType&&E.length>0){y(!0),await new Promise(k=>setTimeout(k,600));const b={};console.log(" DEBUG Step3 - Datos para validacin:",{fuelType:n.fuelType,inventoryTotal:E.length,inventarioMuestra:E.slice(0,2),operationalLocations:Mi}),Mi.forEach(k=>{const _=E.filter(L=>L.fuelType===n.fuelType&&L.location?.toLowerCase()===k.toLowerCase()&&L.status==="active");console.log(` DEBUG ${k}:`,{itemsEncontrados:_.length,detalles:_.map(L=>({id:L.id,fuelType:L.fuelType,location:L.location,status:L.status,currentStock:L.currentStock,maxCapacity:L.maxCapacity}))});const j=_.reduce((L,M)=>L+(parseFloat(M.currentStock)||0),0),S=E.filter(L=>L.fuelType===n.fuelType&&L.location?.toLowerCase()===k.toLowerCase()&&L.status==="active").reduce((L,M)=>L+(parseFloat(M.maxCapacity)||0),0);let O="available",B=`${j.toFixed(1)} gal disponibles`;j===0?(O="empty",B="Sin stock disponible"):j<S*.2&&(O="low",B=`${j.toFixed(1)} gal (stock bajo)`),b[k]={available:j,maxCapacity:S,status:O,message:B,percentage:S>0?j/S*100:0}}),p(b),y(!1),console.log(" Stock validado por ubicacin:",b)}})()},[n.fuelType,A,E]);const T=async R=>{d(!0),i("");try{await new Promise(b=>setTimeout(b,400)),e(A?"supplierName":"location",R),console.log(" Ubicacin seleccionada:",R)}catch(b){console.error("Error al validar ubicacin:",b),i("Error al validar la ubicacin")}finally{d(!1)}};if(A){const R=N.filter(b=>b.status==="active");return s.jsx("div",{className:`wizard-step step-location ${o?"active":""}`,children:s.jsxs("div",{className:"typeform-layout",children:[s.jsxs("div",{className:"typeform-question",children:[s.jsx("h3",{children:" De qu proveedor viene el combustible?"}),s.jsx("p",{children:"Selecciona el proveedor de origen:"})]}),c&&s.jsxs("div",{className:"loading-overlay",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:" Validando proveedor..."})]}),s.jsx("div",{className:"typeform-options",children:R.map(b=>s.jsxs("div",{className:`typeform-option ${n.supplierName===b.name?"selected":""} ${c?"disabled":""}`,onClick:()=>!c&&T(b.name),children:[s.jsx("div",{className:"typeform-option-icon",children:""}),s.jsxs("div",{className:"typeform-option-content",children:[s.jsx("h4",{children:b.name}),s.jsx("p",{children:b.city})]}),s.jsx("div",{className:"typeform-option-selector",children:s.jsx("div",{className:"typeform-check",children:s.jsx("span",{className:"typeform-check-icon",children:""})})})]},b.id))}),n.supplierName&&s.jsx("div",{className:"selection-confirmation",children:s.jsxs("div",{className:"confirmation-card",children:[s.jsx("span",{className:"confirmation-icon",children:""}),s.jsxs("div",{className:"confirmation-text",children:[s.jsx("strong",{children:"Proveedor:"})," ",n.supplierName,s.jsx("br",{}),s.jsx("small",{children:"Origen del combustible confirmado"})]})]})})]})})}return s.jsx("div",{className:`wizard-step step-location ${o?"active":""}`,children:s.jsxs("div",{className:"typeform-layout",children:[s.jsxs("div",{className:"typeform-question",children:[s.jsx("h3",{children:" De qu ubicacin sale el combustible?"}),s.jsx("p",{children:"Selecciona la ubicacin de origen:"})]}),g&&s.jsxs("div",{className:"loading-overlay",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:" Verificando stock disponible..."})]}),s.jsx("div",{className:"typeform-options",children:Mi.map(R=>{const b=f[R],k=!b||b.status!=="empty";return s.jsxs("div",{className:`typeform-option ${n.location===R?"selected":""} 
                           ${b?.status||"unknown"} ${!k||c?"disabled":""}`,onClick:()=>k&&!c&&T(R),children:[s.jsx("div",{className:"typeform-option-icon",children:""}),s.jsxs("div",{className:"typeform-option-content",children:[s.jsx("h4",{children:Ws(R)}),b&&s.jsxs("div",{className:"stock-info",children:[s.jsx("p",{className:"stock-message",children:b.message}),b.available>0&&s.jsx("div",{className:"stock-bar-mini",children:s.jsx("div",{className:"stock-fill-mini",style:{width:`${Math.min(100,b.percentage)}%`}})})]})]}),s.jsx("div",{className:"typeform-option-selector",children:s.jsx("div",{className:"typeform-check",children:s.jsx("span",{className:"typeform-check-icon",children:""})})})]},R)})}),n.location&&f[n.location]&&s.jsx("div",{className:"selection-confirmation",children:s.jsxs("div",{className:"confirmation-card location-confirmation",children:[s.jsxs("div",{className:"confirmation-header",children:[s.jsx("span",{className:"confirmation-icon",children:""}),s.jsxs("div",{className:"confirmation-text",children:[s.jsx("strong",{children:Ws(n.location)}),s.jsx("br",{}),s.jsx("small",{children:"Ubicacin de origen confirmada"})]})]}),s.jsxs("div",{className:"stock-confirmation",children:[s.jsxs("div",{className:"stock-detail",children:[s.jsx("span",{className:"stock-label",children:" Stock disponible:"}),s.jsxs("span",{className:"stock-value",children:[f[n.location].available.toFixed(1)," gal"]})]}),s.jsx("div",{className:"capacity-bar",children:s.jsx("div",{className:"capacity-fill",style:{width:`${f[n.location].percentage}%`}})}),s.jsxs("small",{className:"capacity-text",children:[f[n.location].percentage.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},yV=({formData:n,updateFormData:e,systemData:t,setError:i,isActive:o})=>{const[c,d]=H.useState(!1),[f,p]=H.useState(null),[g,y]=H.useState(""),{inventory:N}=t,E=n.type===ue.SALIDA||n.type===ue.TRANSFERENCIA;H.useEffect(()=>{(async()=>{if(E&&n.fuelType&&n.location&&N.length>0){d(!0),await new Promise(V=>setTimeout(V,500));const b=N.filter(V=>V.fuelType===n.fuelType&&V.location?.toLowerCase()===n.location?.toLowerCase()&&V.status==="active").reduce((V,U)=>V+(parseFloat(U.currentStock)||0),0),k=N.filter(V=>V.fuelType===n.fuelType&&V.location?.toLowerCase()===n.location?.toLowerCase()&&V.status==="active").reduce((V,U)=>V+(parseFloat(U.maxCapacity)||0),0),_=parseFloat(n.quantity)||0,j=b-_,S=k>0?b/k*100:0;let O="available",B="",L="Stock Suficiente",M="Hay suficiente combustible disponible.";if(_>0&&(b<_?(O="critical",B="",L="Stock Insuficiente",M=`Faltan ${(_-b).toFixed(2)} galones.`):j<b*.2?(O="warning",B="",L="Stock Quedar Bajo",M=`Despus del movimiento quedarn ${j.toFixed(2)} galones.`):M=`Despus del movimiento quedarn ${j.toFixed(2)} galones disponibles.`),p({available:b,required:_,remaining:Math.max(0,j),maxCapacity:k,capacityPercentage:S,status:O,icon:B,title:L,message:M,isValid:b>=_}),_>0&&E){const V={type:n.type===ue.SALIDA?"outbound":"transfer",fuelType:n.fuelType,quantity:n.quantity,sourceLocation:n.location},U=S2(V,N);U.isValid?U.warning?y(` ${U.warning}`):y(""):y(` ${U.error}`)}else E||y("");d(!1)}})()},[n.quantity,n.fuelType,n.location,n.type,E,N]);const A=R=>{const b=parseFloat(R);(R===""||!isNaN(b)&&b>=0)&&(e("quantity",R),i(""))},T=()=>{if(!f||!f.available)return[];const R=f.available;return[{label:"25%",value:(R*.25).toFixed(1)},{label:"50%",value:(R*.5).toFixed(1)},{label:"75%",value:(R*.75).toFixed(1)},{label:"Todo",value:R.toFixed(1)}]};return s.jsx("div",{className:`wizard-step step-quantity ${o?"active":""}`,children:s.jsxs("div",{className:"typeform-layout",children:[s.jsxs("div",{className:"typeform-question",children:[s.jsx("h3",{children:" Cuntos galones necesitas?"}),s.jsx("p",{children:"Especifica la cantidad de combustible:"})]}),s.jsxs("div",{className:"typeform-input-section",children:[s.jsx("input",{id:"quantity",type:"number",step:"0.1",min:"0",value:n.quantity,onChange:R=>A(R.target.value),placeholder:"0.0",className:`typeform-input ${g?"error":""}`}),s.jsx("span",{className:"typeform-unit",children:"galones"})]}),f&&f.available>0&&s.jsxs("div",{className:"quantity-suggestions",children:[s.jsx("label",{children:"Cantidades sugeridas:"}),s.jsx("div",{className:"suggestion-buttons",children:T().map((R,b)=>s.jsxs("button",{type:"button",className:"suggestion-btn",onClick:()=>A(R.value),children:[R.label,s.jsx("br",{}),s.jsxs("small",{children:[R.value," gal"]})]},b))})]}),c&&s.jsxs("div",{className:"calculating-indicator",children:[s.jsx("div",{className:"loading-spinner small"}),s.jsx("span",{children:" Calculando disponibilidad..."})]}),f&&E&&!c&&s.jsxs("div",{className:`stock-info-container ${f.status}`,children:[s.jsxs("div",{className:"stock-info-header",children:[s.jsx("div",{className:"stock-info-icon",children:f.icon}),s.jsx("h4",{className:"stock-info-title",children:f.title})]}),s.jsx("div",{className:"stock-info-message",children:f.message})]}),g&&s.jsx("div",{className:"validation-warning",children:g}),n.quantity&&parseFloat(n.quantity)>0&&s.jsx("div",{className:"selection-confirmation",children:s.jsxs("div",{className:"confirmation-card",children:[s.jsx("span",{className:"confirmation-icon",children:""}),s.jsxs("div",{className:"confirmation-text",children:[s.jsx("strong",{children:"Cantidad:"})," ",parseFloat(n.quantity).toFixed(2)," galones",s.jsx("br",{}),s.jsx("small",{children:E?`Se restar del inventario de ${n.location}`:`Se aadir al inventario de ${n.destinationLocation||"ubicacin no especificada"}`})]})]})})]})})},xV=({formData:n,updateFormData:e,systemData:t,setError:i,isActive:o})=>{const[c,d]=H.useState(!1),[f,p]=H.useState(null),[g,y]=H.useState(!1),[N,E]=H.useState(""),{vehicles:A}=t;H.useEffect(()=>{if(n.vehicleId&&A.length>0){const k=A.find(j=>j.vehicleId===n.vehicleId);p(k);const _=T(k);y(_)}},[n.vehicleId,A]);const T=k=>{if(!k)return!1;const _=k.fuelType==="diesel"||k.fuelType==="Diesel",j=k.vehicleId?.toUpperCase(),S=j&&(j.includes("TR1")||j.includes("TR2")||j.includes("TR3")||j==="TR1"||j==="TR2"||j==="TR3"),O=k.category==="tractor"||k.type?.toLowerCase().includes("tractor");return _||S||O},R=async k=>{d(!0),i("");try{await new Promise(j=>setTimeout(j,600)),e("vehicleId",k.vehicleId),p(k);const _=T(k);y(_),!_&&n.currentHours&&e("currentHours",""),console.log(" [Step5] Vehculo seleccionado:",k.vehicleId,"Requiere hormetro:",_,"Tipo combustible:",k.fuelType),console.log(" [Step5] FormData despus de seleccin:",{vehicleId:k.vehicleId,type:n.type,fuelType:n.fuelType,location:n.location})}catch(_){console.error("Error al validar vehculo:",_),i("Error al validar el vehculo")}finally{d(!1)}},b=k=>{const _=parseFloat(k);(k===""||!isNaN(_)&&_>=0)&&(e("currentHours",k),f?.currentHours&&_<parseFloat(f.currentHours)?E(`La lectura debe ser mayor a la anterior: ${f.currentHours} hrs`):E(""))};return n.type!==ue.SALIDA?null:A.length===0?s.jsx("div",{className:`wizard-step step-vehicle ${o?"active":""}`,children:s.jsx("div",{className:"typeform-layout",children:s.jsxs("div",{className:"loading-state",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:" Cargando vehculos disponibles..."})]})})}):s.jsx("div",{className:`wizard-step step-vehicle ${o?"active":""}`,children:s.jsxs("div",{className:"typeform-layout",children:[s.jsxs("div",{className:"typeform-question",children:[s.jsx("h3",{children:" A qu vehculo/equipo va el combustible?"}),s.jsx("p",{children:"Selecciona el vehculo que recibir el combustible:"})]}),c&&s.jsxs("div",{className:"loading-overlay",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:" Validando vehculo..."})]}),s.jsx("div",{className:"typeform-options",children:A.map(k=>{const _=T(k);return s.jsxs("div",{className:`typeform-option ${n.vehicleId===k.vehicleId?"selected":""} 
                           ${_?"diesel-vehicle":""} ${c?"disabled":""}`,onClick:()=>!c&&R(k),children:[s.jsx("div",{className:"typeform-option-icon",children:_?"":""}),s.jsxs("div",{className:"typeform-option-content",children:[s.jsxs("h4",{children:[k.vehicleId," - ",k.name]}),s.jsx("p",{children:k.type}),k.currentHours&&_&&s.jsxs("small",{className:"vehicle-hours",children:[" Hormetro: ",k.currentHours," hrs"]}),_&&s.jsx("small",{className:"diesel-indicator",children:" Vehculo diesel - Requiere hormetro"})]}),s.jsx("div",{className:"typeform-option-selector",children:s.jsx("div",{className:"typeform-check",children:s.jsx("span",{className:"typeform-check-icon",children:""})})})]},k.id)})}),g&&f&&s.jsxs("div",{className:"typeform-input-section",children:[s.jsx("label",{htmlFor:"currentHours",children:"Hormetro actual (horas trabajadas) *"}),s.jsx("input",{id:"currentHours",type:"number",step:"0.1",min:"0",value:n.currentHours,onChange:k=>b(k.target.value),placeholder:"0.0",className:`typeform-input ${N?"error":""}`}),s.jsx("span",{className:"typeform-unit",children:"horas"}),f.currentHours&&s.jsxs("small",{className:"hour-meter-hint",children:[" ltima lectura: ",f.currentHours," horas"]}),N&&s.jsx("div",{className:"field-error",children:N})]}),f&&n.vehicleId&&s.jsx("div",{className:"selection-confirmation",children:s.jsxs("div",{className:"confirmation-card vehicle-confirmation",children:[s.jsxs("div",{className:"confirmation-header",children:[s.jsx("span",{className:"confirmation-icon",children:T(f)?"":""}),s.jsxs("div",{className:"confirmation-text",children:[s.jsxs("strong",{children:[f.vehicleId," - ",f.name]}),s.jsx("br",{}),s.jsx("small",{children:f.type})]})]}),s.jsxs("div",{className:"vehicle-details",children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:" Tipo:"}),s.jsx("span",{className:"detail-value",children:f.type})]}),f.category&&s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:" Categora:"}),s.jsx("span",{className:"detail-value",children:f.category})]}),g&&n.currentHours&&s.jsxs("div",{className:"detail-item",children:[s.jsx("span",{className:"detail-label",children:" Hormetro:"}),s.jsxs("span",{className:"detail-value",children:[n.currentHours," hrs"]})]})]}),T(f)&&!n.currentHours&&s.jsx("div",{className:"warning-message",children:" Se requiere lectura del hormetro para vehculos diesel"})]})})]})})},ej=({formData:n,updateFormData:e,systemData:t,setError:i,isEntryDestination:o=!1,isActive:c})=>{const[d,f]=H.useState(!1),[p,g]=H.useState({}),[y,N]=H.useState(!1),{inventory:E}=t;H.useEffect(()=>{(async()=>{if(n.fuelType&&n.quantity&&E.length>0&&!o){N(!0),await new Promise(_=>setTimeout(_,700));const b=parseFloat(n.quantity)||0,k={};Mi.filter(_=>o?!0:_!==n.location).forEach(_=>{const j=E.filter(I=>I.fuelType===n.fuelType&&I.location?.toLowerCase()===_.toLowerCase()&&I.status==="active").reduce((I,D)=>I+(parseFloat(D.currentStock)||0),0),S=E.filter(I=>I.fuelType===n.fuelType&&I.location?.toLowerCase()===_.toLowerCase()&&I.status==="active").reduce((I,D)=>I+(parseFloat(D.maxCapacity)||0),0),O=S-j,B=j+b,L=S>0?B/S*100:0;let M="available",V=`Capacidad: ${O.toFixed(1)} gal libres`,U=O>=b;S===0?(M="no_capacity",V="Sin tanques configurados",U=!1):O<b?(M="insufficient",V=`Insuficiente: faltan ${(b-O).toFixed(1)} gal`,U=!1):L>90&&(M="warning",V=`Quedar al ${L.toFixed(1)}% (casi lleno)`),k[_]={currentStock:j,maxCapacity:S,availableCapacity:O,afterTransfer:B,occupancyAfter:L,status:M,message:V,canAcceptTransfer:U}}),g(k),N(!1),console.log(" Capacidad validada por destino:",k)}})()},[n.fuelType,n.quantity,n.location,E,o]);const A=async R=>{const b=p[R];if(!o&&!b?.canAcceptTransfer){i("Esta ubicacin no puede recibir la cantidad solicitada");return}f(!0),i("");try{await new Promise(k=>setTimeout(k,500)),e("destinationLocation",R),console.log(" Destino seleccionado:",R)}catch(k){console.error("Error al validar destino:",k),i("Error al validar el destino")}finally{f(!1)}};if(!o&&n.type!==ue.TRANSFERENCIA)return null;const T=o?M2:Mi.filter(R=>R!==n.location);return s.jsx("div",{className:`wizard-step step-destination ${c?"active":""}`,children:s.jsxs("div",{className:"typeform-layout",children:[s.jsxs("div",{className:"typeform-question",children:[s.jsxs("h3",{children:[" ",o?"A qu ubicacin llegar el combustible?":"Hacia qu ubicacin se transfiere?"]}),s.jsx("p",{children:"Selecciona la ubicacin de destino:"})]}),y&&s.jsxs("div",{className:"loading-overlay",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:" Verificando capacidad disponible..."})]}),s.jsx("div",{className:"typeform-options",children:T.map(R=>{const b=p[R],k=!b||b.canAcceptTransfer;return s.jsxs("div",{className:`typeform-option ${n.destinationLocation===R?"selected":""} 
                           ${b?.status||"unknown"} ${!k||d?"disabled":""}`,onClick:()=>k&&!d&&A(R),children:[s.jsx("div",{className:"typeform-option-icon",children:""}),s.jsxs("div",{className:"typeform-option-content",children:[s.jsx("h4",{children:Ws(R)}),b&&s.jsxs("div",{className:"capacity-info",children:[s.jsx("p",{className:"capacity-message",children:b.message}),b.maxCapacity>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"capacity-bar-mini",children:[s.jsx("div",{className:"capacity-current-mini",style:{width:`${Math.min(100,b.currentStock/b.maxCapacity*100)}%`}}),b.canAcceptTransfer&&s.jsx("div",{className:"capacity-after-mini",style:{width:`${Math.min(100,b.occupancyAfter)}%`,left:`${Math.min(100,b.currentStock/b.maxCapacity*100)}%`}})]}),s.jsxs("small",{className:"capacity-details",children:["Actual: ",b.currentStock.toFixed(1),"/",b.maxCapacity.toFixed(1)," gal"]})]})]})]}),s.jsx("div",{className:"typeform-option-selector",children:s.jsx("div",{className:"typeform-check",children:s.jsx("span",{className:"typeform-check-icon",children:""})})})]},R)})}),n.location&&n.quantity&&s.jsx("div",{className:"transfer-summary",children:s.jsxs("div",{className:"transfer-flow",children:[s.jsxs("div",{className:"transfer-origin",children:[s.jsx("span",{className:"transfer-icon",children:""}),s.jsxs("div",{className:"transfer-info",children:[s.jsx("strong",{children:Ws(n.location)}),s.jsx("small",{children:"Origen"})]})]}),s.jsxs("div",{className:"transfer-arrow",children:[s.jsx("span",{children:""}),s.jsxs("small",{children:[parseFloat(n.quantity).toFixed(1)," gal"]})]}),s.jsxs("div",{className:"transfer-destination",children:[s.jsx("span",{className:"transfer-icon",children:""}),s.jsxs("div",{className:"transfer-info",children:[s.jsx("strong",{children:n.destinationLocation?Ws(n.destinationLocation):"Seleccionar destino"}),s.jsx("small",{children:"Destino"})]})]})]})}),n.destinationLocation&&p[n.destinationLocation]&&s.jsx("div",{className:"selection-confirmation",children:s.jsxs("div",{className:"confirmation-card destination-confirmation",children:[s.jsxs("div",{className:"confirmation-header",children:[s.jsx("span",{className:"confirmation-icon",children:""}),s.jsxs("div",{className:"confirmation-text",children:[s.jsx("strong",{children:Ws(n.destinationLocation)}),s.jsx("br",{}),s.jsx("small",{children:"Ubicacin de destino confirmada"})]})]}),s.jsxs("div",{className:"capacity-confirmation",children:[s.jsxs("div",{className:"capacity-detail",children:[s.jsx("span",{className:"capacity-label",children:" Despus de transferir:"}),s.jsxs("span",{className:"capacity-value",children:[p[n.destinationLocation].afterTransfer.toFixed(1)," gal"]})]}),s.jsx("div",{className:"occupancy-bar",children:s.jsx("div",{className:"occupancy-fill",style:{width:`${p[n.destinationLocation].occupancyAfter}%`}})}),s.jsxs("small",{className:"occupancy-text",children:[p[n.destinationLocation].occupancyAfter.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},NV=({formData:n,updateFormData:e,systemData:t,error:i,setError:o,isActive:c})=>{const[d,f]=H.useState(!1),[p,g]=H.useState(!1),{products:y}=t;H.useEffect(()=>{if(n.fuelType&&!n.unitPrice&&y.length>0){const k=y.find(_=>_.name===n.fuelType||_.displayName===n.fuelType);k&&k.defaultPrice&&(e("unitPrice",k.defaultPrice.toString()),g(!0))}},[n.fuelType,n.unitPrice,y,e]);const N=async k=>{const _=parseFloat(k);(k===""||!isNaN(_)&&_>=0)&&(f(!0),await new Promise(j=>setTimeout(j,300)),e("unitPrice",k),g(k!==""),o(""),f(!1))},E=k=>{e("effectiveDate",k)},A=k=>{e("description",k)},T=(parseFloat(n.quantity)||0)*(parseFloat(n.unitPrice)||0),R=k=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(k),b=()=>y.find(k=>k.name===n.fuelType||k.displayName===n.fuelType);return s.jsx("div",{className:`wizard-step step-details ${c?"active":""}`,children:s.jsxs("div",{className:"typeform-layout",children:[s.jsxs("div",{className:"typeform-question",children:[s.jsx("h3",{children:" Informacin adicional del movimiento"}),s.jsx("p",{children:"Completa los detalles restantes:"})]}),s.jsxs("div",{className:"typeform-input-section",children:[s.jsx("label",{htmlFor:"unitPrice",children:" Precio por galn (COP) *"}),s.jsx("input",{id:"unitPrice",type:"number",step:"1",min:"0",value:n.unitPrice,onChange:k=>N(k.target.value),placeholder:"0",className:`typeform-input ${i?"error":""}`}),s.jsx("span",{className:"typeform-unit",children:"COP"}),d&&s.jsxs("div",{className:"calculating-price",children:[s.jsx("div",{className:"loading-spinner small"}),s.jsx("span",{children:" Validando precio..."})]}),b()?.defaultPrice&&s.jsxs("small",{className:"price-suggestion",children:[" Precio sugerido: $",b().defaultPrice.toLocaleString("es-CO")," COP"]})]}),n.quantity&&n.unitPrice&&p&&s.jsx("div",{className:"total-value-section",children:s.jsxs("div",{className:"total-value-card",children:[s.jsx("div",{className:"total-icon",children:""}),s.jsxs("div",{className:"total-content",children:[s.jsx("h4",{children:"Valor Total Calculado"}),s.jsxs("div",{className:"total-calculation",children:[s.jsxs("span",{className:"calculation-details",children:[parseFloat(n.quantity).toFixed(2)," gal  $",parseFloat(n.unitPrice).toLocaleString("es-CO")," COP"]}),s.jsx("div",{className:"total-amount",children:R(T)})]})]})]})}),s.jsxs("div",{className:"typeform-input-section",children:[s.jsx("label",{htmlFor:"effectiveDate",children:" Cundo ocurri este movimiento?"}),s.jsx("input",{id:"effectiveDate",type:"datetime-local",value:n.effectiveDate,onChange:k=>E(k.target.value),className:"typeform-input"}),s.jsx("small",{className:"typeform-unit",children:" Por defecto se usa la fecha y hora actual"})]}),s.jsxs("div",{className:"typeform-input-section",children:[s.jsx("label",{htmlFor:"description",children:" Detalles adicionales del movimiento (opcional)"}),s.jsx("textarea",{id:"description",value:n.description,onChange:k=>A(k.target.value),placeholder:"Ej: Combustible para operacin en sector norte, mantenimiento programado, etc.",className:"typeform-input",rows:"3",maxLength:"500"}),s.jsxs("div",{className:"description-counter",children:[n.description.length,"/500 caracteres"]})]})]})})},bV=({formData:n,systemData:e,isLoading:t,error:i,onCommentsChange:o,confirmChecked:c,onConfirmChange:d})=>{const{vehicles:f,products:p,suppliers:g}=e,y=O=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(O),N=()=>({[ue.ENTRADA]:{icon:"",title:"Entrada",color:"entrada"},[ue.SALIDA]:{icon:"",title:"Salida",color:"salida"},[ue.TRANSFERENCIA]:{icon:"",title:"Transferencia",color:"transferencia"},[ue.AJUSTE]:{icon:"",title:"Ajuste",color:"ajuste"}})[n.type]||{icon:"",title:"Desconocido",color:"unknown"},E=()=>p.find(O=>O.name===n.fuelType||O.displayName===n.fuelType),A=()=>f.find(O=>O.vehicleId===n.vehicleId),T=()=>{const O=n.type===ue.ENTRADA?n.supplierName:n.location;return g.find(B=>B.name===O)},R=(parseFloat(n.quantity)||0)*(parseFloat(n.unitPrice)||0),b=N(),k=E(),_=A(),j=T(),S=O=>{o(O.target.value)};return s.jsx("div",{className:"wizard-step step-summary",children:s.jsxs("div",{className:"typeform-layout",children:[s.jsxs("div",{className:"typeform-question",children:[s.jsx("h3",{children:" Confirma tu movimiento"}),s.jsx("p",{children:"Revisa toda la informacin antes de crear el movimiento:"})]}),s.jsxs("div",{className:"summary-main",children:[s.jsxs("div",{className:`summary-header ${b.color}`,children:[s.jsx("div",{className:"summary-icon",children:b.icon}),s.jsxs("div",{className:"summary-title",children:[s.jsxs("h4",{children:[b.title," de Combustible"]}),s.jsxs("p",{children:[parseFloat(n.quantity).toFixed(2)," galones de ",k?.displayName||n.fuelType]})]}),s.jsx("div",{className:"summary-value",children:y(R)})]}),s.jsxs("div",{className:"summary-details",children:[s.jsxs("div",{className:"detail-row",children:[s.jsx("div",{className:"detail-icon",children:""}),s.jsxs("div",{className:"detail-content",children:[s.jsx("span",{className:"detail-label",children:"Combustible:"}),s.jsxs("span",{className:"detail-value",children:[k?.icon," ",k?.displayName||n.fuelType]})]})]}),s.jsxs("div",{className:"detail-row",children:[s.jsx("div",{className:"detail-icon",children:""}),s.jsxs("div",{className:"detail-content",children:[s.jsx("span",{className:"detail-label",children:"Cantidad:"}),s.jsxs("span",{className:"detail-value",children:[parseFloat(n.quantity).toFixed(2)," gal  $",parseFloat(n.unitPrice).toLocaleString("es-CO")," COP"]})]})]}),s.jsxs("div",{className:"detail-row",children:[s.jsx("div",{className:"detail-icon",children:n.type===ue.ENTRADA?"":""}),s.jsxs("div",{className:"detail-content",children:[s.jsx("span",{className:"detail-label",children:n.type===ue.ENTRADA?"Proveedor:":"Origen:"}),s.jsx("span",{className:"detail-value",children:n.type===ue.ENTRADA?j?`${j.name} - ${j.city}`:n.location:Ws(n.location)})]})]}),n.type===ue.SALIDA&&_&&s.jsxs("div",{className:"detail-row",children:[s.jsx("div",{className:"detail-icon",children:""}),s.jsxs("div",{className:"detail-content",children:[s.jsx("span",{className:"detail-label",children:"Vehculo:"}),s.jsxs("span",{className:"detail-value",children:[_.vehicleId," - ",_.name," (",_.type,")"]})]})]}),n.currentHours&&s.jsxs("div",{className:"detail-row",children:[s.jsx("div",{className:"detail-icon",children:""}),s.jsxs("div",{className:"detail-content",children:[s.jsx("span",{className:"detail-label",children:"Hormetro:"}),s.jsxs("span",{className:"detail-value",children:[n.currentHours," horas"]})]})]}),n.type===ue.TRANSFERENCIA&&n.destinationLocation&&s.jsxs("div",{className:"detail-row",children:[s.jsx("div",{className:"detail-icon",children:""}),s.jsxs("div",{className:"detail-content",children:[s.jsx("span",{className:"detail-label",children:"Destino:"}),s.jsx("span",{className:"detail-value",children:Ws(n.destinationLocation)})]})]}),s.jsxs("div",{className:"detail-row",children:[s.jsx("div",{className:"detail-icon",children:""}),s.jsxs("div",{className:"detail-content",children:[s.jsx("span",{className:"detail-label",children:"Fecha:"}),s.jsx("span",{className:"detail-value",children:new Date(n.effectiveDate).toLocaleString("es-CO")})]})]}),n.reference&&s.jsxs("div",{className:"detail-row",children:[s.jsx("div",{className:"detail-icon",children:""}),s.jsxs("div",{className:"detail-content",children:[s.jsx("span",{className:"detail-label",children:"Referencia:"}),s.jsx("span",{className:"detail-value",children:n.reference})]})]}),n.description&&s.jsxs("div",{className:"detail-row",children:[s.jsx("div",{className:"detail-icon",children:""}),s.jsxs("div",{className:"detail-content",children:[s.jsx("span",{className:"detail-label",children:"Descripcin:"}),s.jsx("span",{className:"detail-value description",children:n.description})]})]})]})]}),n.type===ue.TRANSFERENCIA&&s.jsxs("div",{className:"transfer-flow-summary",children:[s.jsx("div",{className:"flow-header",children:" Flujo de Transferencia"}),s.jsxs("div",{className:"flow-diagram",children:[s.jsxs("div",{className:"flow-location origin",children:[s.jsx("div",{className:"flow-icon",children:""}),s.jsxs("div",{className:"flow-text",children:[s.jsx("strong",{children:Ws(n.location)}),s.jsx("small",{children:"Origen"})]})]}),s.jsxs("div",{className:"flow-arrow",children:[s.jsx("div",{className:"arrow-line"}),s.jsx("div",{className:"arrow-head",children:""}),s.jsxs("div",{className:"flow-quantity",children:[parseFloat(n.quantity).toFixed(1)," gal"]})]}),s.jsxs("div",{className:"flow-location destination",children:[s.jsx("div",{className:"flow-icon",children:""}),s.jsxs("div",{className:"flow-text",children:[s.jsx("strong",{children:Ws(n.destinationLocation)}),s.jsx("small",{children:"Destino"})]})]})]})]}),s.jsxs("div",{className:"additional-comments-section",children:[s.jsxs("div",{className:"comments-header",children:[s.jsx("h4",{children:" Comentarios Adicionales"}),s.jsx("small",{children:"Opcional - Agrega informacin adicional sobre este movimiento"})]}),s.jsx("textarea",{className:"comments-textarea",value:n.additionalComments||"",onChange:S,placeholder:"Ejemplo: Combustible entregado por transporte especial, requiere almacenamiento prioritario, etc.",rows:3,maxLength:500}),s.jsxs("div",{className:"comments-counter",children:[(n.additionalComments||"").length,"/500 caracteres"]})]}),s.jsxs("div",{className:"confirmation-section",children:[s.jsxs("div",{className:"confirmation-checkbox",children:[s.jsx("input",{type:"checkbox",id:"confirmMovement",checked:c,onChange:O=>d(O.target.checked)}),s.jsx("label",{htmlFor:"confirmMovement",children:" Confirmo que toda la informacin es correcta y autorizo crear este movimiento"})]}),s.jsx("div",{className:"confirmation-warning",children:" Una vez creado, el movimiento actualizar automticamente el inventario"})]}),i&&s.jsxs("div",{className:"summary-error",children:[s.jsx("span",{className:"error-icon",children:""}),i]})]})})},_V=({isOpen:n,onClose:e,onSuccess:t})=>{const{inventory:i,vehicles:o,suppliers:c}=Zn(),[d,f]=H.useState(1),[p,g]=H.useState(!1),[y,N]=H.useState(!1),[E,A]=H.useState(""),[T,R]=H.useState(!1),[b,k]=H.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""}),[_,j]=H.useState({vehicles:[],inventory:[],suppliers:[],products:[],loadingData:!0}),S=()=>{f(1),A(""),R(!1),k({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""})};H.useEffect(()=>((async()=>{if(n){document.body.style.overflow="hidden",S(),j(xe=>({...xe,loadingData:!0}));try{console.log(" Cargando productos y sincronizando datos en tiempo real...");const xe=await fV();j({vehicles:o||[],inventory:i||[],suppliers:c||[],products:xe||[],loadingData:!1}),console.log(" Datos sincronizados para wizard - inventario en tiempo real:",i?.length||0,"items")}catch(xe){console.error(" Error al cargar datos del sistema:",xe),A("No se pudieron cargar los datos necesarios. Intntalo de nuevo."),j(G=>({...G,loadingData:!1}))}}else document.body.style.overflow="unset"})(),()=>{document.body.style.overflow="unset"}),[n,i,o,c]);const O=()=>{if(!b.type)return 8;let ee;return b.type===ue.TRANSFERENCIA?ee=8:b.type===ue.SALIDA||b.type===ue.ENTRADA?ee=7:ee=6,console.log(" [TOTAL STEPS]",{type:b.type,totalSteps:ee,currentStep:d}),ee},B=(ee,xe)=>{k(G=>({...G,[ee]:xe})),A("")},L=H.useCallback(()=>{let ee=!1;switch(d){case 1:ee=!!b.type;break;case 2:ee=!!b.fuelType,console.log(" [STEP 2 VALIDATION]",{fuelType:b.fuelType,isValid:ee,formData:b});break;case 3:b.type===ue.ENTRADA?ee=!!b.supplierName:ee=!!b.location;break;case"3b":ee=!!b.destinationLocation;break;case 4:ee=b.quantity&&parseFloat(b.quantity)>0,console.log(" [DEBUG Step 4] Validacin cantidad:",{step:d,quantity:b.quantity,parsedQuantity:parseFloat(b.quantity),isQuantityValid:!!b.quantity,isParsedValid:parseFloat(b.quantity)>0,finalValidation:ee,formData:b});break;case 5:if(b.type===ue.SALIDA){if(ee=!!b.vehicleId,ee&&b.vehicleId){const xe=o.find(G=>G.vehicleId===b.vehicleId);xe&&(xe.fuelType==="diesel"||xe.fuelType==="Diesel")&&(ee=!!b.currentHours&&parseFloat(b.currentHours)>=0)}}else ee=!0;break;case 6:b.type===ue.TRANSFERENCIA?ee=!!b.destinationLocation:ee=!0;break;case 7:ee=!!b.unitPrice&&parseFloat(b.unitPrice)>=0;break;case 8:ee=!0;break;default:ee=!1}return console.log(" [DEBUG General] validateCurrentStep:",{currentStep:d,isValid:ee,formDataKeys:Object.keys(b),formData:b}),ee},[d,b,o]),M=H.useMemo(()=>L(),[L]),V=()=>{g(!0);const ee=L();if(console.log(" [DEBUG nextStep] Intentando navegar:",{currentStep:d,isValid:ee,formData:b,type:b.type}),ee){const xe=O();let G=d+1;d===3&&b.type===ue.ENTRADA?G="3b":d==="3b"?G=4:d===4&&b.type!==ue.SALIDA?b.type===ue.TRANSFERENCIA?G=6:(b.type,ue.ENTRADA,G=7):d===5&&b.type!==ue.TRANSFERENCIA&&(G=7),console.log(" [DEBUG Navigation] Navegando:",{from:d,to:G,totalSteps:xe}),(de=>b.type===ue.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[de]||de:b.type===ue.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[de]||de:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[de]||de)(G)<=xe&&f(G)}else console.log(" [DEBUG] Validacin fall, no se puede navegar"),A("Por favor completa este paso antes de continuar");setTimeout(()=>g(!1),300)},U=()=>{if(g(!0),d>1&&d!=="3b"){let ee=d-1;d===4&&b.type===ue.ENTRADA?ee="3b":(d===7&&b.type===ue.ENTRADA||d===7&&b.type!==ue.TRANSFERENCIA&&b.type!==ue.SALIDA||d===6&&b.type!==ue.SALIDA)&&(ee=4),f(ee)}else d==="3b"&&f(3);setTimeout(()=>g(!1),300)},I=async()=>{N(!0),A("");try{const ee={...b};console.log(" [SUBMIT] Datos completos antes de crear movimiento:",ee);const xe={...ee,quantity:parseFloat(ee.quantity),unitPrice:parseFloat(ee.unitPrice),effectiveDate:new Date(ee.effectiveDate)};console.log(" [SUBMIT] MovementData enviado a createMovement:",xe),await LA(xe),t(),S()}catch(ee){console.error("Error al crear movimiento:",ee),A(ee.message||"Error al crear el movimiento")}finally{N(!1)}},D=()=>{const ee={formData:b,updateFormData:B,systemData:_,error:E,setError:A,isActive:!p};return{1:s.jsx(pV,{...ee}),2:s.jsx(gV,{...ee}),3:s.jsx(vV,{...ee}),"3b":s.jsx(ej,{...ee,isEntryDestination:!0}),4:s.jsx(yV,{...ee}),5:s.jsx(xV,{...ee}),6:s.jsx(ej,{...ee}),7:s.jsx(NV,{...ee}),8:s.jsx(bV,{...ee,onSubmit:I,isLoading:y,onCommentsChange:G=>B("additionalComments",G),confirmChecked:T,onConfirmChange:R})}[d]||s.jsx("div",{children:"Paso no encontrado"})};if(!n)return null;const q=O(),Ie=(ee=>b.type===ue.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[ee]||ee:b.type===ue.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[ee]||ee:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[ee]||ee)(d),Y=Ie/q*100,ie=Ie>=q;return console.log(" [WIZARD DEBUG]",{type:b.type,currentStep:d,currentLogicalStep:Ie,totalSteps:q,progress:Y,isLastStep:ie,formDataKeys:Object.keys(b).filter(ee=>b[ee]),fuelType:b.fuelType}),s.jsx("div",{className:"modal-overlay wizard-overlay",onClick:e,children:s.jsxs("div",{className:`modal-content wizard-modal typeform-mode ${ie?"is-last-step":""}`,onClick:ee=>ee.stopPropagation(),children:[s.jsx("div",{className:"typeform-progress",children:s.jsx("div",{className:"typeform-progress-fill",style:{width:`${Y}%`}})}),s.jsx("div",{className:"wizard-header typeform-mode",children:s.jsxs("div",{className:"wizard-title",children:[s.jsx("h3",{children:" Asistente de Movimientos"}),s.jsx("button",{className:"modal-close",onClick:e,children:""})]})}),s.jsx("div",{className:"wizard-body typeform-mode",children:_.loadingData?s.jsxs("div",{className:"wizard-loading",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:" Cargando datos del sistema..."})]}):s.jsx("div",{className:"wizard-step-container",children:D()})}),E&&s.jsxs("div",{className:"wizard-error",children:[s.jsx("span",{className:"error-icon",children:""}),E]}),s.jsxs("div",{className:"typeform-navigation",children:[d>1&&s.jsx("button",{className:"typeform-nav-btn",onClick:U,disabled:p,"aria-label":"Paso anterior",children:""}),ie?s.jsx("button",{className:"typeform-nav-btn",onClick:I,disabled:y||!T||p,"aria-label":"Confirmar movimiento",children:y?s.jsx("span",{className:"loading-spinner small"}):""}):s.jsx("button",{className:"typeform-nav-btn",onClick:V,disabled:!M||p,"aria-label":"Siguiente paso",children:""})]})]})})},EV=()=>{const{user:n,userProfile:e,deleteMovement:t}=Zn(),[i,o]=H.useState([]),[c,d]=H.useState(null),[f,p]=H.useState(!0),[g,y]=H.useState(null),[N,E]=H.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[A,T]=H.useState(""),[R,b]=H.useState(!1);H.useEffect(()=>{if(!n)return;p(!0);const I=uy((D,q)=>{if(q){console.error("Error en suscripcin de movimientos:",q),y("Error al cargar movimientos"),p(!1);return}o(D),y(null),p(!1)},N);return()=>I()},[n,N]),H.useEffect(()=>{n&&(async()=>{try{const D=await qA(N);d(D)}catch(D){console.error("Error al cargar estadsticas:",D)}})()},[n,i,N]);const k=i.filter(I=>{if(!A)return!0;const D=A.toLowerCase();return I.fuelType?.toLowerCase().includes(D)||I.type?.toLowerCase().includes(D)||I.location?.toLowerCase().includes(D)||I.vehicleId?.toLowerCase().includes(D)||I.description?.toLowerCase().includes(D)||I.reference?.toLowerCase().includes(D)}),_=()=>{b(!0)},j=I=>{alert(` Detalles del movimiento:

Tipo: ${I.type}
Combustible: ${I.fuelType}
Cantidad: ${I.quantity} gal
Fecha: ${new Date(I.createdAt).toLocaleDateString("es-CO")}`)},S=()=>{b(!1)},O=I=>{E(D=>({...D,...I}))},B=()=>{E({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),T("")},L=async I=>{if(window.confirm("Ests seguro de que quieres aprobar este movimiento? Esta accin actualizar el inventario."))try{await FA(I),alert("Movimiento aprobado y stock actualizado.")}catch(D){console.error("Error al aprobar movimiento:",D),alert(`Error al aprobar movimiento: ${D.message}`)}},M=async I=>{if(window.confirm("Ests seguro de que quieres rechazar este movimiento?"))try{await UA(I,{status:vt.CANCELADO}),alert("Movimiento rechazado.")}catch(D){console.error("Error al rechazar movimiento:",D),alert(`Error al rechazar movimiento: ${D.message}`)}},V=async I=>{try{const D=await t(I);if(D.success)alert("Movimiento eliminado exitosamente.");else throw new Error(D.error)}catch(D){console.error("Error al eliminar movimiento:",D),alert(`Error al eliminar movimiento: ${D.message}`)}},U=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente";return f?s.jsx("div",{className:"movements-main",children:s.jsxs("div",{className:"loading-container",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Cargando movimientos..."})]})}):g?s.jsx("div",{className:"movements-main",children:s.jsxs("div",{className:"error-container",children:[s.jsx("div",{className:"error-icon",children:""}),s.jsx("h3",{children:"Error al cargar movimientos"}),s.jsx("p",{children:g}),s.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):s.jsxs("div",{className:"movements-main",children:[s.jsxs("div",{className:"movements-header",children:[s.jsxs("div",{className:"header-title",children:[s.jsx("h2",{children:" Movimientos de Combustibles"}),s.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),U&&s.jsx("div",{className:"create-movement-options",children:s.jsx("button",{className:"btn-create-movement primary",onClick:_,children:" Nuevo Movimiento"})})]}),c&&s.jsx(iV,{stats:c,filters:N}),s.jsx(rV,{filters:N,onFilterChange:O,onClearFilters:B,searchTerm:A,onSearchChange:T,totalResults:k.length}),k.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:""}),s.jsx("h3",{children:i.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),s.jsx("p",{children:i.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de bsqueda"}),i.length===0&&U&&s.jsx("div",{className:"create-first-options",children:s.jsx("button",{className:"btn-create-first primary",onClick:_,children:" Crear Primer Movimiento"})})]}):s.jsx(lV,{movements:k,onEdit:null,onView:j,onApprove:L,onReject:M,onDelete:V,userRole:e?.role}),R&&s.jsx(_V,{isOpen:R,onClose:S,onSuccess:()=>{S()}})]})},jV=({stats:n,filters:e})=>{if(!n)return null;const t=N=>`${ce(N)} gal`,i=N=>`${ce(N)} hrs`,o=N=>`${N.toFixed(2)} gal/hr`,c=N=>{let E=0;for(let T=0;T<N.length;T++)E=(E<<5)-E+N.charCodeAt(T)&4294967295;const A=["#059669","#dc2626","#2563eb","#7c3aed","#ea580c","#16a34a","#ca8a04","#9333ea"];return A[Math.abs(E)%A.length]},d=N=>{if(!N)return"";const E=N.toLowerCase();return E.includes("excavadora")?"":E.includes("bulldozer")?"":E.includes("cargador")?"":E.includes("camion")?"":E.includes("grua")?"":E.includes("motosierra")?"":E.includes("tractor")?"":E.includes("volqueta")?"":""},f=N=>{switch(N){case Ue.ACTIVO:return"#10b981";case Ue.MANTENIMIENTO:return"#f59e0b";case Ue.INACTIVO:return"#6b7280";case Ue.REPARACION:return"#ef4444";default:return"#6b7280"}},p=N=>{switch(N){case Ue.ACTIVO:return"";case Ue.MANTENIMIENTO:return"";case Ue.INACTIVO:return"";case Ue.REPARACION:return"";default:return""}},g=N=>{switch(N){case yt.DIESEL:return"";case yt.GASOLINA:return"";case yt.ACPM:return"";case yt.MIXTO:return"";default:return""}},y=n.totalVehicles>0?((n.byStatus[Ue.ACTIVO]||0)/n.totalVehicles*100).toFixed(1):0;return s.jsxs("div",{className:"vehicles-stats",children:[s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card primary",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:ce(n.totalVehicles)}),s.jsx("div",{className:"stat-label",children:"Total Vehculos"}),s.jsx("div",{className:"stat-trend",children:s.jsxs("span",{className:`trend ${y>=80?"positive":"warning"}`,children:[y>=80?"":""," ",y,"% activos"]})})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:t(n.totalFuelConsumed)}),s.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),s.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(n.averageConsumption||0)]})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:i(n.totalHoursWorked)}),s.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),s.jsxs("div",{className:"stat-secondary",children:["Promedio: ",i(n.totalHoursWorked/(n.totalVehicles||1))]})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:n.mostActiveVehicle?n.mostActiveVehicle.vehicleId:"N/A"}),s.jsx("div",{className:"stat-label",children:"Ms Activo"}),s.jsx("div",{className:"stat-secondary",children:n.mostActiveVehicle?`${n.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),s.jsxs("div",{className:"stats-breakdown",children:[s.jsxs("div",{className:"breakdown-section",children:[s.jsx("h4",{children:" Por Tipo de Vehculo"}),s.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([N,E])=>{const A=(E/n.totalVehicles*100).toFixed(1);return s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-header",children:[s.jsx("span",{className:"breakdown-icon",children:d(N)}),s.jsx("span",{className:"breakdown-label",children:N.charAt(0).toUpperCase()+N.slice(1)})]}),s.jsx("div",{className:"breakdown-value",children:E}),s.jsx("div",{className:"breakdown-bar",children:s.jsx("div",{className:"breakdown-fill",style:{width:`${A}%`,backgroundColor:c(N)}})}),s.jsxs("div",{className:"breakdown-percentage",children:[A,"%"]})]},N)})})]}),s.jsxs("div",{className:"breakdown-section",children:[s.jsx("h4",{children:" Por Estado"}),s.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([N,E])=>{const A=(E/n.totalVehicles*100).toFixed(1);return s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-header",children:[s.jsx("span",{className:"breakdown-icon",children:p(N)}),s.jsx("span",{className:"breakdown-label",children:N.charAt(0).toUpperCase()+N.slice(1)})]}),s.jsx("div",{className:"breakdown-value",children:E}),s.jsx("div",{className:"breakdown-bar",children:s.jsx("div",{className:"breakdown-fill",style:{width:`${A}%`,backgroundColor:f(N)}})}),s.jsxs("div",{className:"breakdown-percentage",children:[A,"%"]})]},N)})})]}),s.jsxs("div",{className:"breakdown-section",children:[s.jsx("h4",{children:" Por Tipo de Combustible"}),s.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([N,E])=>{const A=(E/n.totalVehicles*100).toFixed(1);return s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-header",children:[s.jsx("span",{className:"breakdown-icon",children:g(N)}),s.jsx("span",{className:"breakdown-label",children:N})]}),s.jsx("div",{className:"breakdown-value",children:E}),s.jsx("div",{className:"breakdown-bar",children:s.jsx("div",{className:"breakdown-fill",style:{width:`${A}%`,backgroundColor:"#059669"}})}),s.jsxs("div",{className:"breakdown-percentage",children:[A,"%"]})]},N)})})]})]}),(n.totalFuelConsumed>0||n.totalHoursWorked>0)&&s.jsxs("div",{className:"performance-metrics",children:[s.jsx("h4",{children:" Mtricas de Rendimiento"}),s.jsxs("div",{className:"metrics-grid",children:[s.jsxs("div",{className:"metric-card",children:[s.jsx("div",{className:"metric-icon",children:""}),s.jsxs("div",{className:"metric-content",children:[s.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),s.jsxs("div",{className:"metric-value",children:[y,"%"]}),s.jsxs("div",{className:"metric-description",children:[n.byStatus[Ue.ACTIVO]||0," de ",n.totalVehicles," activos"]})]})]}),n.averageConsumption>0&&s.jsxs("div",{className:"metric-card",children:[s.jsx("div",{className:"metric-icon",children:""}),s.jsxs("div",{className:"metric-content",children:[s.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),s.jsx("div",{className:"metric-value",children:o(n.averageConsumption)}),s.jsx("div",{className:"metric-description",children:"Por vehculo por hora trabajada"})]})]}),n.mostActiveVehicle&&s.jsxs("div",{className:"metric-card",children:[s.jsx("div",{className:"metric-icon",children:""}),s.jsxs("div",{className:"metric-content",children:[s.jsx("div",{className:"metric-label",children:"Mayor Utilizacin"}),s.jsx("div",{className:"metric-value",children:n.mostActiveVehicle.vehicleId}),s.jsxs("div",{className:"metric-description",children:[t(n.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),n.leastActiveVehicle&&s.jsxs("div",{className:"metric-card",children:[s.jsx("div",{className:"metric-icon",children:""}),s.jsxs("div",{className:"metric-content",children:[s.jsx("div",{className:"metric-label",children:"Menor Utilizacin"}),s.jsx("div",{className:"metric-value",children:n.leastActiveVehicle.vehicleId}),s.jsxs("div",{className:"metric-description",children:[t(n.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(e.type||e.status||e.fuelType||e.location)&&s.jsxs("div",{className:"active-filters",children:[s.jsx("h4",{children:" Filtros Activos"}),s.jsxs("div",{className:"filters-list",children:[e.type&&s.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&s.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&s.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.location&&s.jsxs("span",{className:"filter-tag",children:["Ubicacin: ",e.location]})]})]})]})},TV=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:i,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const[p,g]=H.useState(!1),y=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mecnico","Proyecto A","Proyecto B","En Reparacin","Otros"],N=Object.values(n).filter(T=>T&&T!==""&&T!=="all").length,E=(T,R)=>{e({[T]:R})},A=T=>{e(T)};return s.jsxs("div",{className:"vehicles-filters",children:[s.jsxs("div",{className:"filters-main",children:[s.jsx("div",{className:"search-section",children:s.jsxs("div",{className:"search-box",children:[s.jsx("span",{className:"search-icon",children:""}),s.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicacin...",value:i,onChange:T=>o(T.target.value),className:"search-input"}),i&&s.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar bsqueda",children:""})]})}),s.jsxs("div",{className:"filters-controls",children:[s.jsxs("div",{className:"quick-filters",children:[s.jsx("button",{className:`quick-filter ${n.status==="activo"?"active":""}`,onClick:()=>A({status:"activo"}),children:" Activos"}),s.jsx("button",{className:`quick-filter ${n.status==="mantenimiento"?"active":""}`,onClick:()=>A({status:"mantenimiento"}),children:" Mantenimiento"}),s.jsx("button",{className:`quick-filter ${n.type==="excavadora"?"active":""}`,onClick:()=>A({type:"excavadora"}),children:" Excavadoras"}),s.jsx("button",{className:`quick-filter ${n.type==="tractor"?"active":""}`,onClick:()=>A({type:"tractor"}),children:" Tractores"})]}),s.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>g(!p),children:[" Filtros",N>0&&s.jsx("span",{className:"filters-count",children:N})]}),s.jsxs("div",{className:"view-modes",children:[s.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:""}),s.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:""})]})]})]}),p&&s.jsxs("div",{className:"filters-advanced",children:[s.jsxs("div",{className:"filters-grid",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tipo de Vehculo"}),s.jsxs("select",{value:n.type,onChange:T=>E("type",T.target.value),className:"filter-select",children:[s.jsx("option",{value:"",children:"Todos los tipos"}),s.jsx("option",{value:"excavadora",children:" Excavadora"}),s.jsx("option",{value:"bulldozer",children:" Bulldozer"}),s.jsx("option",{value:"cargador",children:" Cargador"}),s.jsx("option",{value:"camion",children:" Camin"}),s.jsx("option",{value:"grua",children:" Gra"}),s.jsx("option",{value:"motosierra",children:" Motosierra"}),s.jsx("option",{value:"tractor",children:" Tractor"}),s.jsx("option",{value:"volqueta",children:" Volqueta"}),s.jsx("option",{value:"otros",children:" Otros"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Estado"}),s.jsxs("select",{value:n.status,onChange:T=>E("status",T.target.value),className:"filter-select",children:[s.jsx("option",{value:"",children:"Todos los estados"}),s.jsx("option",{value:Ue.ACTIVO,children:" Activo"}),s.jsx("option",{value:Ue.MANTENIMIENTO,children:" Mantenimiento"}),s.jsx("option",{value:Ue.INACTIVO,children:" Inactivo"}),s.jsx("option",{value:Ue.REPARACION,children:" Reparacin"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tipo de Combustible"}),s.jsxs("select",{value:n.fuelType,onChange:T=>E("fuelType",T.target.value),className:"filter-select",children:[s.jsx("option",{value:"",children:"Todos los combustibles"}),s.jsx("option",{value:yt.DIESEL,children:" Diesel"}),s.jsx("option",{value:yt.GASOLINA,children:" Gasolina"}),s.jsx("option",{value:yt.ACPM,children:" ACPM"}),s.jsx("option",{value:yt.MIXTO,children:" Mixto"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Ubicacin Actual"}),s.jsxs("select",{value:n.location,onChange:T=>E("location",T.target.value),className:"filter-select",children:[s.jsx("option",{value:"",children:"Todas las ubicaciones"}),y.map(T=>s.jsxs("option",{value:T,children:[" ",T]},T))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Mantenimiento"}),s.jsxs("select",{value:n.maintenance,onChange:T=>E("maintenance",T.target.value),className:"filter-select",children:[s.jsx("option",{value:"all",children:"Todos"}),s.jsx("option",{value:"due",children:"Mantenimiento debido"}),s.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),s.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),s.jsxs("div",{className:"filters-actions",children:[s.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:N===0,children:" Limpiar Filtros"}),s.jsxs("div",{className:"filters-info",children:[s.jsxs("span",{className:"results-count",children:[f," resultado",f!==1?"s":""]}),N>0&&s.jsxs("span",{className:"active-filters-text",children:["(",N," filtro",N!==1?"s":""," activo",N!==1?"s":"",")"]})]})]})]}),N>0&&s.jsx("div",{className:"active-filters-summary",children:s.jsxs("div",{className:"summary-content",children:[s.jsx("span",{className:"summary-label",children:"Filtros activos:"}),s.jsxs("div",{className:"summary-tags",children:[n.type&&s.jsxs("span",{className:"summary-tag",onClick:()=>E("type",""),children:["Tipo: ",n.type," "]}),n.status&&s.jsxs("span",{className:"summary-tag",onClick:()=>E("status",""),children:["Estado: ",n.status," "]}),n.fuelType&&s.jsxs("span",{className:"summary-tag",onClick:()=>E("fuelType",""),children:["Combustible: ",n.fuelType," "]}),n.location&&s.jsxs("span",{className:"summary-tag",onClick:()=>E("location",""),children:["Ubicacin: ",n.location," "]}),n.maintenance!=="all"&&s.jsxs("span",{className:"summary-tag",onClick:()=>E("maintenance","all"),children:["Mantenimiento: ",n.maintenance," "]})]})]})}),s.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:s.jsx("small",{children:" Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},AV=({vehicles:n,onEdit:e,onView:t,onMaintenance:i})=>{const o=b=>new Intl.NumberFormat("es-CO").format(b),c=b=>`${o(b)} gal`,d=b=>`${o(b)} hrs`,f=b=>b?(b instanceof Date?b:new Date(b)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",p=b=>{if(!b)return"";const k=new Date,_=b instanceof Date?b:new Date(b),j=Math.abs(k-_),S=Math.ceil(j/(1e3*60*60*24));return S===1?"hace 1 da":S<7?`hace ${S} das`:S<30?`hace ${Math.ceil(S/7)} semanas`:S<365?`hace ${Math.ceil(S/30)} meses`:`hace ${Math.ceil(S/365)} aos`},g=b=>{if(!b)return"vehicle-default";const k=b.toLowerCase();return k.includes("excavadora")?"vehicle-excavadora":k.includes("bulldozer")?"vehicle-bulldozer":k.includes("cargador")?"vehicle-cargador":k.includes("camion")?"vehicle-camion":k.includes("grua")?"vehicle-grua":k.includes("motosierra")?"vehicle-motosierra":k.includes("tractor")?"vehicle-tractor":k.includes("volqueta")?"vehicle-volqueta":"vehicle-default"},y=b=>{switch(b){case Ue.ACTIVO:return"status-activo";case Ue.MANTENIMIENTO:return"status-mantenimiento";case Ue.INACTIVO:return"status-inactivo";case Ue.REPARACION:return"status-reparacion";default:return"status-default"}},N=b=>{if(!b)return"";const k=b.toLowerCase();return k.includes("excavadora")?"":k.includes("bulldozer")?"":k.includes("cargador")?"":k.includes("camion")?"":k.includes("grua")?"":k.includes("motosierra")?"":k.includes("tractor")?"":k.includes("volqueta")?"":""},E=b=>{switch(b){case yt.DIESEL:return"";case yt.GASOLINA:return"";case yt.ACPM:return"";case yt.MIXTO:return"";default:return""}},A=b=>{switch(b){case Ue.ACTIVO:return"";case Ue.MANTENIMIENTO:return"";case Ue.INACTIVO:return"";case Ue.REPARACION:return"";default:return""}},T=b=>!b.totalHoursWorked||b.totalHoursWorked===0?b.estimatedConsumptionPerHour||0:b.totalFuelConsumed/b.totalHoursWorked,R=b=>b.lastMaintenanceDate?Math.floor((new Date-new Date(b.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return s.jsx("div",{className:"vehicles-cards",children:n.map(b=>s.jsxs("div",{className:`vehicle-card ${g(b.type)}`,children:[s.jsx("div",{className:"card-header",children:s.jsxs("div",{className:"vehicle-info",children:[s.jsxs("div",{className:"vehicle-id-section",children:[s.jsx("span",{className:"vehicle-icon",children:N(b.type)}),s.jsxs("div",{className:"vehicle-details",children:[s.jsx("span",{className:"vehicle-id",children:b.vehicleId}),s.jsx("span",{className:"vehicle-name",children:b.name})]})]}),s.jsxs("div",{className:`status-badge ${y(b.status)}`,children:[s.jsx("span",{className:"status-icon",children:A(b.status)}),s.jsx("span",{className:"status-label",children:b.status.charAt(0).toUpperCase()+b.status.slice(1)})]})]})}),s.jsxs("div",{className:"card-content",children:[s.jsxs("div",{className:"basic-info",children:[s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Tipo:"}),s.jsxs("span",{className:"info-value",children:[N(b.type)," ",b.type.charAt(0).toUpperCase()+b.type.slice(1)]})]}),b.brand&&b.model&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),s.jsxs("span",{className:"info-value",children:[b.brand," ",b.model]})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Combustible:"}),s.jsxs("span",{className:"info-value",children:[E(b.fuelType)," ",b.fuelType]})]}),b.currentLocation&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Ubicacin:"}),s.jsxs("span",{className:"info-value",children:[" ",b.currentLocation]})]})]}),s.jsxs("div",{className:"consumption-metrics",children:[s.jsxs("div",{className:"metric-item",children:[s.jsx("div",{className:"metric-icon",children:""}),s.jsxs("div",{className:"metric-content",children:[s.jsx("div",{className:"metric-value",children:c(b.totalFuelConsumed||0)}),s.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),s.jsxs("div",{className:"metric-item",children:[s.jsx("div",{className:"metric-icon",children:""}),s.jsxs("div",{className:"metric-content",children:[s.jsx("div",{className:"metric-value",children:d(b.totalHoursWorked||0)}),s.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),s.jsxs("div",{className:"metric-item",children:[s.jsx("div",{className:"metric-icon",children:""}),s.jsxs("div",{className:"metric-content",children:[s.jsxs("div",{className:"metric-value",children:[T(b).toFixed(1)," gal/hr"]}),s.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),s.jsxs("div",{className:"metric-item",children:[s.jsx("div",{className:"metric-icon",children:""}),s.jsxs("div",{className:"metric-content",children:[s.jsx("div",{className:"metric-value",children:b.totalMovements||0}),s.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(b.enginePower||b.fuelCapacity||b.year)&&s.jsxs("div",{className:"technical-specs",children:[b.enginePower&&s.jsxs("div",{className:"spec-item",children:[s.jsx("span",{className:"spec-icon",children:""}),s.jsxs("span",{className:"spec-value",children:[b.enginePower," HP"]})]}),b.fuelCapacity&&s.jsxs("div",{className:"spec-item",children:[s.jsx("span",{className:"spec-icon",children:""}),s.jsxs("span",{className:"spec-value",children:[b.fuelCapacity," gal"]})]}),b.year&&s.jsxs("div",{className:"spec-item",children:[s.jsx("span",{className:"spec-icon",children:""}),s.jsx("span",{className:"spec-value",children:b.year})]})]}),b.description&&s.jsx("div",{className:"description",children:s.jsx("p",{children:b.description})})]}),s.jsxs("div",{className:"card-footer",children:[s.jsxs("div",{className:"date-info",children:[b.lastMovementDate&&s.jsxs("div",{className:"date-item",children:[s.jsx("span",{className:"date-label",children:"ltimo movimiento:"}),s.jsx("span",{className:"date-value",children:f(b.lastMovementDate)}),s.jsx("span",{className:"date-relative",children:p(b.lastMovementDate)})]}),b.lastMaintenanceDate&&s.jsxs("div",{className:"date-item",children:[s.jsx("span",{className:"date-label",children:"ltimo mantenimiento:"}),s.jsx("span",{className:"date-value",children:f(b.lastMaintenanceDate)}),s.jsx("span",{className:"date-relative",children:p(b.lastMaintenanceDate)})]})]}),s.jsxs("div",{className:"card-actions",children:[s.jsx("button",{className:"btn-view",onClick:()=>t(b),title:"Ver detalles",children:""}),e&&b.status!==Ue.REPARACION&&s.jsx("button",{className:"btn-edit",onClick:()=>e(b),title:"Editar vehculo",children:""}),i&&s.jsx("button",{className:"btn-maintenance",onClick:()=>i(b),title:"Registrar mantenimiento",children:""})]})]}),b.status===Ue.MANTENIMIENTO&&s.jsx("div",{className:"maintenance-indicator",children:s.jsx("div",{className:"maintenance-pulse"})}),R(b)&&b.status===Ue.ACTIVO&&s.jsx("div",{className:"maintenance-due-badge",children:s.jsx("span",{children:"Mantenimiento Debido"})}),b.status===Ue.REPARACION&&s.jsx("div",{className:"repair-badge",children:s.jsx("span",{children:"En Reparacin"})}),b.totalHoursWorked>0&&s.jsxs("div",{className:"efficiency-indicator",children:[s.jsx("div",{className:"efficiency-bar",children:s.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(b.totalHoursWorked/2e3*100,100)}%`}})}),s.jsxs("span",{className:"efficiency-label",children:[(b.totalHoursWorked/2e3*100).toFixed(1),"% utilizacin anual"]})]})]},b.id))})},CV=({vehicles:n,onEdit:e,onView:t,onMaintenance:i})=>{const[o,c]=H.useState("vehicleId"),[d,f]=H.useState("asc"),p=O=>new Intl.NumberFormat("es-CO").format(O),g=O=>`${p(O)} gal`,y=O=>`${p(O)} hrs`,N=O=>O?(O instanceof Date?O:new Date(O)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",E=O=>{if(!O)return"";const B=O.toLowerCase();return B.includes("excavadora")?"":B.includes("bulldozer")?"":B.includes("cargador")?"":B.includes("camion")?"":B.includes("grua")?"":B.includes("motosierra")?"":B.includes("tractor")?"":B.includes("volqueta")?"":""},A=O=>{switch(O){case yt.DIESEL:return"";case yt.GASOLINA:return"";case yt.ACPM:return"";case yt.MIXTO:return"";default:return""}},T=O=>{switch(O){case Ue.ACTIVO:return"";case Ue.MANTENIMIENTO:return"";case Ue.INACTIVO:return"";case Ue.REPARACION:return"";default:return""}},R=O=>{switch(O){case Ue.ACTIVO:return"status-activo";case Ue.MANTENIMIENTO:return"status-mantenimiento";case Ue.INACTIVO:return"status-inactivo";case Ue.REPARACION:return"status-reparacion";default:return"status-default"}},b=O=>{o===O?f(d==="asc"?"desc":"asc"):(c(O),f("asc"))},k=[...n].sort((O,B)=>{let L=O[o],M=B[o];return(o.includes("Date")||o.includes("At"))&&(L=new Date(L||0),M=new Date(M||0)),typeof L=="number"&&typeof M=="number"?d==="asc"?L-M:M-L:typeof L=="string"&&typeof M=="string"?d==="asc"?L.localeCompare(M):M.localeCompare(L):L instanceof Date&&M instanceof Date?d==="asc"?L-M:M-L:!L&&!M?0:L?M?0:d==="asc"?-1:1:d==="asc"?1:-1}),_=O=>o!==O?"":d==="asc"?"":"",j=O=>!O.totalHoursWorked||O.totalHoursWorked===0?O.estimatedConsumptionPerHour||0:O.totalFuelConsumed/O.totalHoursWorked,S=O=>O.lastMaintenanceDate?Math.floor((new Date-new Date(O.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return s.jsxs("div",{className:"vehicles-table-container",children:[s.jsx("div",{className:"table-wrapper",children:s.jsxs("table",{className:"vehicles-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsxs("th",{className:"sortable",onClick:()=>b("vehicleId"),children:["ID Vehculo ",_("vehicleId")]}),s.jsxs("th",{className:"sortable",onClick:()=>b("name"),children:["Nombre ",_("name")]}),s.jsxs("th",{className:"sortable",onClick:()=>b("type"),children:["Tipo ",_("type")]}),s.jsx("th",{children:"Marca/Modelo"}),s.jsxs("th",{className:"sortable",onClick:()=>b("fuelType"),children:["Combustible ",_("fuelType")]}),s.jsxs("th",{className:"sortable text-right",onClick:()=>b("totalFuelConsumed"),children:["Consumido ",_("totalFuelConsumed")]}),s.jsxs("th",{className:"sortable text-right",onClick:()=>b("totalHoursWorked"),children:["Horas ",_("totalHoursWorked")]}),s.jsx("th",{className:"text-right",children:"Consumo/Hr"}),s.jsx("th",{children:"Ubicacin"}),s.jsxs("th",{className:"sortable",onClick:()=>b("status"),children:["Estado ",_("status")]}),s.jsxs("th",{className:"sortable",onClick:()=>b("lastMovementDate"),children:["ltimo Mov. ",_("lastMovementDate")]}),s.jsx("th",{className:"actions-column",children:"Acciones"})]})}),s.jsx("tbody",{children:k.map(O=>s.jsxs("tr",{className:`vehicle-row ${O.status===Ue.MANTENIMIENTO?"maintenance-row":""} ${S(O)?"needs-maintenance":""}`,children:[s.jsx("td",{className:"vehicle-id-cell",children:s.jsxs("div",{className:"id-content",children:[s.jsx("span",{className:"vehicle-icon",children:E(O.type)}),s.jsx("span",{className:"vehicle-id",children:O.vehicleId})]})}),s.jsx("td",{className:"name-cell",children:s.jsx("span",{className:"vehicle-name",children:O.name})}),s.jsx("td",{className:"type-cell",children:s.jsx("span",{className:"type-text",children:O.type.charAt(0).toUpperCase()+O.type.slice(1)})}),s.jsx("td",{className:"brand-model-cell",children:O.brand&&O.model?s.jsxs("span",{className:"brand-model",children:[O.brand," ",O.model]}):s.jsx("span",{className:"no-data",children:"-"})}),s.jsx("td",{className:"fuel-cell",children:s.jsxs("div",{className:"fuel-content",children:[s.jsx("span",{className:"fuel-icon",children:A(O.fuelType)}),s.jsx("span",{className:"fuel-text",children:O.fuelType})]})}),s.jsx("td",{className:"consumption-cell text-right",children:s.jsx("span",{className:"consumption-value",children:g(O.totalFuelConsumed||0)})}),s.jsx("td",{className:"hours-cell text-right",children:s.jsx("span",{className:"hours-value",children:y(O.totalHoursWorked||0)})}),s.jsx("td",{className:"rate-cell text-right",children:s.jsxs("span",{className:"rate-value",children:[j(O).toFixed(1)," gal/hr"]})}),s.jsx("td",{className:"location-cell",children:s.jsxs("span",{className:"location-text",children:[" ",O.currentLocation||"Sin ubicacin"]})}),s.jsx("td",{className:"status-cell",children:s.jsxs("div",{className:`status-badge ${R(O.status)}`,children:[s.jsx("span",{className:"status-icon",children:T(O.status)}),s.jsx("span",{className:"status-text",children:O.status.charAt(0).toUpperCase()+O.status.slice(1)})]})}),s.jsx("td",{className:"date-cell",children:s.jsxs("div",{className:"date-content",children:[s.jsx("span",{className:"date-value",children:N(O.lastMovementDate)}),S(O)&&s.jsx("span",{className:"maintenance-warning",children:""})]})}),s.jsx("td",{className:"actions-cell",children:s.jsxs("div",{className:"action-buttons",children:[s.jsx("button",{className:"btn-action btn-view",onClick:()=>t(O),title:"Ver detalles",children:""}),e&&O.status!==Ue.REPARACION&&s.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(O),title:"Editar vehculo",children:""}),i&&s.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>i(O),title:"Registrar mantenimiento",children:""})]})})]},O.id))})]})}),s.jsxs("div",{className:"table-info",children:[s.jsxs("div",{className:"table-summary",children:[s.jsxs("span",{className:"total-rows",children:[n.length," vehculo",n.length!==1?"s":""]}),o&&s.jsxs("span",{className:"sort-info",children:["Ordenado por ",o," (",d==="asc"?"ascendente":"descendente",")"]})]}),s.jsxs("div",{className:"table-legend",children:[s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-icon",children:""})," Activo"]}),s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-icon",children:""})," Mantenimiento"]}),s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-icon",children:""})," Inactivo"]}),s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-icon",children:""})," Reparacin"]}),s.jsxs("span",{className:"legend-item",children:[s.jsx("span",{className:"legend-icon",children:""})," Mantto. Debido"]})]})]})]})},wV=({vehicles:n,viewMode:e,onEdit:t,onView:i,onMaintenance:o})=>e==="table"?s.jsx(CV,{vehicles:n,onEdit:t,onView:i,onMaintenance:o}):s.jsx(AV,{vehicles:n,onEdit:t,onView:i,onMaintenance:o}),SV="modulepreload",IV=function(n){return"/combustibles/"+n},tj={},fy=function(e,t,i){let o=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(N=>Promise.resolve(N).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};var d=g;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");o=g(t.map(y=>{if(y=IV(y),y in tj)return;tj[y]=!0;const N=y.endsWith(".css"),E=N?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${E}`))return;const A=document.createElement("link");if(A.rel=N?"stylesheet":SV,N||(A.as="script"),A.crossOrigin="",A.href=y,p&&A.setAttribute("nonce",p),document.head.appendChild(A),N)return new Promise((T,R)=>{A.addEventListener("load",T),A.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${y}`)))})}))}function c(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return o.then(f=>{for(const p of f||[])p.status==="rejected"&&c(p.reason);return e().catch(c)})},Du="combustibles_vehicle_categories",RV=async n=>{try{const e=YA(n);if(!e.isValid)throw new Error(`Datos invlidos: ${e.errors.join(", ")}`);const t=await aC();if(t.some(d=>d.id===n.id||d.name.toLowerCase()===n.name.toLowerCase()))throw new Error("Ya existe una categora con ese nombre o ID");n.id||(n.id=QA(n.name,t));const o={...n,createdAt:qe(),updatedAt:qe(),isCustom:!0,vehicleCount:0},c=await El(Pe(pe,Du),o);return console.log(" Categora creada:",n.name),{id:c.id,...o,createdAt:new Date,updatedAt:new Date}}catch(e){throw console.error(" Error al crear categora:",e),new Error(`Error al crear categora: ${e.message}`)}},aC=async()=>{try{const n=Te(Pe(pe,Du),In("name","asc")),e=await mt(n),t=[];return e.forEach(i=>{t.push({id:i.id,...i.data(),createdAt:i.data().createdAt?.toDate?.()||i.data().createdAt,updatedAt:i.data().updatedAt?.toDate?.()||i.data().updatedAt})}),t}catch(n){throw console.error(" Error al obtener categoras personalizadas:",n),new Error(`Error al obtener categoras: ${n.message}`)}},my=async()=>{try{const n=await aC();return $A(n)}catch(n){return console.error(" Error al obtener todas las categoras:",n),fs}},MV=async(n,e)=>{try{if(!n)throw new Error("ID de categora requerido");if(fs.some(d=>d.id===n))throw new Error("No se pueden modificar las categoras predeterminadas");if(e.name||e.fuelTypes||e.fields){const d=YA({...e,id:n});if(!d.isValid)throw new Error(`Datos invlidos: ${d.errors.join(", ")}`)}const i={...e,updatedAt:qe()},o=et(pe,Du,n);await Rs(o,i),console.log(" Categora actualizada:",n);const c=await Xi(o);return{id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt}}catch(t){throw console.error(" Error al actualizar categora:",t),new Error(`Error al actualizar categora: ${t.message}`)}},DV=async n=>{try{if(!n)throw new Error("ID de categora requerido");if(fs.some(c=>c.id===n))throw new Error("No se pueden eliminar las categoras predeterminadas");const{countVehiclesByCategory:t}=await fy(async()=>{const{countVehiclesByCategory:c}=await Promise.resolve().then(()=>eC);return{countVehiclesByCategory:c}},void 0),i=await t(n);if(i>0)throw new Error(`No se puede eliminar la categora porque tiene ${i} vehculo(s) asignado(s)`);const o=et(pe,Du,n);return await Af(o),console.log(" Categora eliminada:",n),!0}catch(e){throw console.error(" Error al eliminar categora:",e),new Error(`Error al eliminar categora: ${e.message}`)}},kV=n=>{try{const e=Te(Pe(pe,Du),In("name","asc"));return Zr(e,t=>{const i=[];t.forEach(c=>{i.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt})});const o=$A(i);n(o)},t=>{console.error(" Error en suscripcin a categoras:",t),n(fs)})}catch(e){return console.error(" Error al suscribirse a categoras:",e),n(fs),()=>{}}},nj=async()=>{try{const{getAllVehicles:n}=await fy(async()=>{const{getAllVehicles:i}=await Promise.resolve().then(()=>eC);return{getAllVehicles:i}},void 0),e=await n();return(await my()).map(i=>{const o=e.filter(c=>c.category===i.id);return{...i,vehicleCount:o.length,activeVehicles:o.filter(c=>c.status==="activo").length,totalFuelCapacity:o.reduce((c,d)=>c+(d.fuelCapacity||0),0),avgEnginepower:o.length>0?o.reduce((c,d)=>c+(d.enginePower||0),0)/o.length:0}}).sort((i,o)=>o.vehicleCount-i.vehicleCount)}catch(n){return console.error(" Error al obtener estadsticas de categoras:",n),[]}},iC=({onClose:n,onCategoryCreated:e})=>{const[t,i]=H.useState([]),[o,c]=H.useState([]),[d,f]=H.useState(!0),[p,g]=H.useState(!1),[y,N]=H.useState(null),[E,A]=H.useState(!1),[T,R]=H.useState(""),[b,k]=H.useState({name:"",description:"",icon:"",color:"#2E86AB",fuelTypes:[],fields:[]});H.useEffect(()=>{_();const I=kV(D=>{i(D),j()});return()=>I&&I()},[]);const _=async()=>{try{f(!0);const[I,D]=await Promise.all([my(),nj()]);i(I),c(D)}catch(I){console.error("Error cargando categoras:",I),R("Error al cargar categoras")}finally{f(!1)}},j=async()=>{try{const I=await nj();c(I)}catch(I){console.error("Error cargando estadsticas:",I)}},S=()=>{N(null),k({name:"",description:"",icon:"",color:"#2E86AB",fuelTypes:[],fields:[]}),A(!0)},O=I=>{if(fs.some(D=>D.id===I.id)){R("No se pueden editar las categoras predeterminadas");return}N(I),k({name:I.name||"",description:I.description||"",icon:I.icon||"",color:I.color||"#2E86AB",fuelTypes:I.fuelTypes||[],fields:I.fields||[]}),A(!0)},B=async I=>{if(fs.some(q=>q.id===I.id)){R("No se pueden eliminar las categoras predeterminadas");return}if(window.confirm(`Est seguro de eliminar la categora "${I.name}"?

Esta accin no se puede deshacer.`))try{g(!0),await DV(I.id),R("")}catch(q){console.error("Error eliminando categora:",q),R(q.message)}finally{g(!1)}},L=async I=>{if(I.preventDefault(),!b.name.trim()){R("El nombre de la categora es requerido");return}try{g(!0),R("");const D={...b,name:b.name.trim(),description:b.description.trim()};if(y)await MV(y.id,D);else{D.id=QA(D.name,t);const q=await RV(D);e&&e(q)}A(!1)}catch(D){console.error("Error guardando categora:",D),R(D.message)}finally{g(!1)}},M=I=>{k(D=>({...D,fields:D.fields.includes(I)?D.fields.filter(q=>q!==I):[...D.fields,I]}))},V=I=>{k(D=>({...D,fuelTypes:D.fuelTypes.includes(I)?D.fuelTypes.filter(q=>q!==I):[...D.fuelTypes,I]}))},U=I=>o.find(D=>D.id===I)||{vehicleCount:0,activeVehicles:0};return d?s.jsx("div",{className:"categories-manager",children:s.jsxs("div",{className:"loading",children:[s.jsx("div",{className:"spinner"}),s.jsx("p",{children:"Cargando categoras..."})]})}):s.jsxs("div",{className:"categories-manager",children:[s.jsxs("div",{className:"categories-header",children:[s.jsx("h3",{children:" Gestin de Categoras"}),s.jsxs("div",{className:"header-actions",children:[s.jsx("button",{className:"btn-primary",onClick:S,disabled:p,children:" Nueva Categora"}),s.jsx("button",{className:"btn-secondary",onClick:n,children:" Cerrar"})]})]}),T&&s.jsxs("div",{className:"error-message",children:[s.jsxs("span",{children:[" ",T]}),s.jsx("button",{onClick:()=>R(""),children:""})]}),s.jsx("div",{className:"categories-grid",children:t.map(I=>{const D=fs.some(be=>be.id===I.id),q=U(I.id);return s.jsxs("div",{className:`category-card ${D?"default":"custom"}`,style:{"--category-color":I.color},children:[s.jsxs("div",{className:"category-header",children:[s.jsx("div",{className:"category-icon",style:{color:I.color},children:I.icon}),s.jsxs("div",{className:"category-info",children:[s.jsx("h4",{children:I.name}),s.jsx("p",{children:I.description})]}),D&&s.jsx("span",{className:"default-badge",children:"Predeterminada"})]}),s.jsxs("div",{className:"category-stats",children:[s.jsxs("div",{className:"stat",children:[s.jsx("span",{className:"stat-value",children:q.vehicleCount}),s.jsx("span",{className:"stat-label",children:"Vehculos"})]}),s.jsxs("div",{className:"stat",children:[s.jsx("span",{className:"stat-value",children:q.activeVehicles}),s.jsx("span",{className:"stat-label",children:"Activos"})]})]}),s.jsxs("div",{className:"category-details",children:[s.jsxs("div",{className:"fuel-types",children:[s.jsx("strong",{children:"Combustibles:"}),s.jsx("div",{className:"fuel-list",children:(I.fuelTypes||[]).map(be=>s.jsx("span",{className:"fuel-tag",children:be},be))})]}),s.jsxs("div",{className:"fields",children:[s.jsx("strong",{children:"Campos:"}),s.jsxs("div",{className:"fields-list",children:[(I.fields||[]).slice(0,3).map(be=>{const Ie=KE.find(Y=>Y.key===be);return Ie?s.jsxs("span",{className:"field-tag",children:[Ie.icon," ",Ie.label]},be):null}),(I.fields||[]).length>3&&s.jsxs("span",{className:"more-fields",children:["+",(I.fields||[]).length-3," ms"]})]})]})]}),s.jsxs("div",{className:"category-actions",children:[s.jsx("button",{className:"btn-edit",onClick:()=>O(I),disabled:D||p,title:D?"No se pueden editar categoras predeterminadas":"Editar categora",children:" Editar"}),s.jsx("button",{className:"btn-delete",onClick:()=>B(I),disabled:D||p||q.vehicleCount>0,title:D?"No se pueden eliminar categoras predeterminadas":q.vehicleCount>0?"No se puede eliminar una categora con vehculos asignados":"Eliminar categora",children:" Eliminar"})]})]},I.id)})}),E&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-content",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h3",{children:y?" Editar Categora":" Nueva Categora"}),s.jsx("button",{onClick:()=>A(!1),children:""})]}),s.jsxs("form",{onSubmit:L,className:"category-form",children:[s.jsxs("div",{className:"form-section",children:[s.jsx("h4",{children:"Informacin Bsica"}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Nombre *"}),s.jsx("input",{type:"text",value:b.name,onChange:I=>k(D=>({...D,name:I.target.value})),placeholder:"Ej: Maquinaria Pesada",required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Icono"}),s.jsx("input",{type:"text",value:b.icon,onChange:I=>k(D=>({...D,icon:I.target.value})),placeholder:"",className:"icon-input"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Descripcin"}),s.jsx("textarea",{value:b.description,onChange:I=>k(D=>({...D,description:I.target.value})),placeholder:"Describe el tipo de vehculos que incluye esta categora",rows:"2"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Color"}),s.jsx("input",{type:"color",value:b.color,onChange:I=>k(D=>({...D,color:I.target.value})),className:"color-input"})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h4",{children:"Tipos de Combustible Compatibles"}),s.jsx("div",{className:"fuel-types-grid",children:Object.values(GA).map(I=>s.jsxs("label",{className:"checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:b.fuelTypes.includes(I),onChange:()=>V(I)}),s.jsx("span",{children:I})]},I))})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h4",{children:"Campos Especficos"}),s.jsx("p",{className:"section-description",children:"Selecciona los campos que sern relevantes para esta categora"}),s.jsx("div",{className:"fields-grid",children:KE.map(I=>s.jsxs("label",{className:"checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:b.fields.includes(I.key),onChange:()=>M(I.key)}),s.jsxs("span",{children:[I.icon," ",I.label]})]},I.key))})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h4",{children:"Vista Previa"}),s.jsx("div",{className:"category-preview",style:{"--category-color":b.color},children:s.jsxs("div",{className:"category-header",children:[s.jsx("div",{className:"category-icon",style:{color:b.color},children:b.icon}),s.jsxs("div",{className:"category-info",children:[s.jsx("h4",{children:b.name||"Nombre de la categora"}),s.jsx("p",{children:b.description||"Descripcin de la categora"})]})]})})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>A(!1),disabled:p,children:"Cancelar"}),s.jsx("button",{type:"submit",className:"btn-primary",disabled:p||!b.name.trim(),children:p?"Guardando...":y?"Actualizar":"Crear"})]})]})]})})]})},OV=({isOpen:n,onClose:e,vehicle:t,onSave:i,mode:o="create"})=>{const[c,d]=H.useState([]),[f,p]=H.useState(null),[g,y]=H.useState(!1),[N,E]=H.useState(!1),[A,T]=H.useState(!1),[R,b]=H.useState({}),k=H.useCallback(()=>({vehicleId:t?.vehicleId||"",name:t?.name||"",category:t?.category||"",brand:t?.brand||"",model:t?.model||"",year:t?.year||new Date().getFullYear(),fuelType:t?.fuelType||yt.DIESEL,status:t?.status||Ue.ACTIVO,currentLocation:t?.currentLocation||"",description:t?.description||"",plateNumber:t?.plateNumber||"",enginePower:t?.enginePower||"",fuelCapacity:t?.fuelCapacity||"",operatingWeight:t?.operatingWeight||"",loadCapacity:t?.loadCapacity||"",bucketCapacity:t?.bucketCapacity||"",hasHourMeter:t?.hasHourMeter||!1,currentHours:t?.currentHours||"",implementType:t?.implementType||"",flow:t?.flow||"",pressure:t?.pressure||"",weight:t?.weight||"",lastMaintenanceDate:t?.lastMaintenanceDate?new Date(t.lastMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:t?.purchaseDate?new Date(t.purchaseDate).toISOString().split("T")[0]:""}),[t]),[_,j]=H.useState(k()),S=H.useCallback(async()=>{try{T(!0);const I=await my();if(d(I),o==="create"&&I.length>0){const D=I[0];p(D),j(q=>({...q,category:D.id}))}}catch(I){console.error("Error cargando categoras:",I)}finally{T(!1)}},[o]);H.useEffect(()=>(n?(S(),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n,S]),H.useEffect(()=>{if(t&&c.length>0){const I=XE(t.category,c);p(I),j(k())}},[t,c,k]);const O=I=>{const D=XE(I,c);p(D),j(q=>{const be=o==="create"&&q.name&&D?L(q.name,D):q.vehicleId;return{...q,category:I,vehicleId:be,fuelType:D?.fuelTypes?.includes(q.fuelType)?q.fuelType:D?.fuelTypes?.[0]||yt.DIESEL}}),b({})},B=(I,D)=>{if(j(q=>({...q,[I]:D})),R[I]&&b(q=>({...q,[I]:null})),I==="name"&&o==="create"){const q=L(D,f);j(be=>({...be,vehicleId:q}))}if(I==="category"&&o==="create"&&_.name){const q=f;if(q){const be=L(_.name,q);j(Ie=>({...Ie,vehicleId:be}))}}},L=(I,D)=>{if(!I||!D)return"";const q=D.name.split(" ").map(ie=>ie.charAt(0).toUpperCase()).join("").substring(0,3),be=I.replace(/[^a-zA-Z0-9]/g,"").substring(0,4).toUpperCase(),Y=Date.now().toString().slice(-3);return`${q}${be}${Y}`},M=()=>{const I={};return _.vehicleId?.trim()||(I.vehicleId="Cdigo del vehculo es requerido"),_.name?.trim()||(I.name="Nombre del vehculo es requerido"),_.category||(I.category="Categora es requerida"),_.fuelType||(I.fuelType="Tipo de combustible es requerido"),f&&_.fuelType&&(f.fuelTypes?.includes(_.fuelType)||(I.fuelType=`Este combustible no es compatible con la categora ${f.name}`)),["enginePower","fuelCapacity","operatingWeight","loadCapacity","bucketCapacity","flow","pressure","weight"].forEach(q=>{_[q]&&(isNaN(_[q])||Number(_[q])<0)&&(I[q]="Debe ser un nmero vlido mayor o igual a 0")}),_.year&&(_.year<1900||_.year>new Date().getFullYear()+1)&&(I.year=`Ao debe estar entre 1900 y ${new Date().getFullYear()+1}`),_.hasHourMeter&&_.currentHours&&(isNaN(_.currentHours)||Number(_.currentHours)<0)&&(I.currentHours="Horas actuales debe ser un nmero vlido mayor o igual a 0"),b(I),Object.keys(I).length===0},V=async I=>{if(I.preventDefault(),!!M())try{T(!0);const D={..._,type:f?.name||_.category||"Otro",enginePower:_.enginePower?Number(_.enginePower):null,fuelCapacity:_.fuelCapacity?Number(_.fuelCapacity):null,operatingWeight:_.operatingWeight?Number(_.operatingWeight):null,loadCapacity:_.loadCapacity?Number(_.loadCapacity):null,bucketCapacity:_.bucketCapacity?Number(_.bucketCapacity):null,currentHours:_.currentHours?Number(_.currentHours):null,flow:_.flow?Number(_.flow):null,pressure:_.pressure?Number(_.pressure):null,weight:_.weight?Number(_.weight):null,year:Number(_.year),lastMaintenanceDate:_.lastMaintenanceDate?new Date(_.lastMaintenanceDate):null,purchaseDate:_.purchaseDate?new Date(_.purchaseDate):null,categoryName:f?.name,categoryIcon:f?.icon,categoryColor:f?.color};await i(D),e()}catch(D){console.error("Error guardando vehculo:",D),b({submit:D.message})}finally{T(!1)}},U=()=>f&&f.fuelTypes||Object.values(yt);return n?s.jsxs("div",{className:"modal-overlay",children:[s.jsxs("div",{className:"modal-container",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:o==="create"?" Nuevo Vehculo":" Editar Vehculo"}),s.jsxs("div",{className:"header-actions",children:[s.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>y(!0),disabled:A,children:" Gestionar Categoras"}),s.jsx("button",{type:"button",className:"btn-close",onClick:e,children:""})]})]}),s.jsxs("form",{onSubmit:V,className:"modal-body",children:[R.submit&&s.jsxs("div",{className:"error-banner",children:[" ",R.submit]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" Categora del Vehculo"}),A?s.jsxs("div",{className:"loading-categories",children:[s.jsx("div",{className:"spinner"}),s.jsx("span",{children:"Cargando categoras..."})]}):s.jsxs("div",{className:"categories-selector",children:[s.jsxs("select",{value:_.category,onChange:I=>O(I.target.value),className:`category-select ${R.category?"error":""}`,children:[s.jsx("option",{value:"",children:"Seleccionar categora del vehculo..."}),c.map(I=>s.jsxs("option",{value:I.id,children:[I.icon," ",I.name,fs.some(D=>D.id===I.id)&&" (Predeterminada)"]},I.id))]}),f&&s.jsx(PV,{category:f,isExpanded:N,onToggle:()=>E(!N)})]}),R.category&&s.jsx("span",{className:"field-error",children:R.category})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" Informacin Bsica"}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"vehicleId",className:"form-label",children:" Cdigo del Vehculo *"}),s.jsx("input",{type:"text",id:"vehicleId",value:_.vehicleId,className:`form-input ${R.vehicleId?"error":""} ${o==="create"?"readonly":""}`,placeholder:"Se genera automticamente",readOnly:o==="create",onChange:o==="edit"?I=>B("vehicleId",I.target.value):void 0,required:!0}),R.vehicleId&&s.jsx("span",{className:"field-error",children:R.vehicleId})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"name",className:"form-label",children:" Nombre del Vehculo *"}),s.jsx("input",{type:"text",id:"name",value:_.name,onChange:I=>B("name",I.target.value),className:`form-input ${R.name?"error":""}`,placeholder:"Ej: Excavadora Principal, Tractor TR1",required:!0}),R.name&&s.jsx("span",{className:"field-error",children:R.name})]})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"brand",className:"form-label",children:" Marca"}),s.jsx("input",{type:"text",id:"brand",value:_.brand,onChange:I=>B("brand",I.target.value),className:"form-input",placeholder:"Ej: Caterpillar, John Deere"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"year",className:"form-label",children:" Ao"}),s.jsx("input",{type:"number",id:"year",value:_.year,onChange:I=>B("year",I.target.value),className:`form-input ${R.year?"error":""}`,min:"1900",max:new Date().getFullYear()+1}),R.year&&s.jsx("span",{className:"field-error",children:R.year})]})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"fuelType",className:"form-label",children:" Tipo de Combustible *"}),s.jsx("select",{id:"fuelType",value:_.fuelType,onChange:I=>B("fuelType",I.target.value),className:`form-input ${R.fuelType?"error":""}`,required:!0,children:U().map(I=>s.jsx("option",{value:I,children:I},I))}),R.fuelType&&s.jsx("span",{className:"field-error",children:R.fuelType})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"status",className:"form-label",children:" Estado"}),s.jsx("select",{id:"status",value:_.status,onChange:I=>B("status",I.target.value),className:"form-input",children:Object.entries(Ue).map(([I,D])=>s.jsx("option",{value:D,children:D.charAt(0).toUpperCase()+D.slice(1)},I))})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"currentLocation",className:"form-label",children:" Ubicacin Actual"}),s.jsx("input",{type:"text",id:"currentLocation",value:_.currentLocation,onChange:I=>B("currentLocation",I.target.value),className:"form-input",placeholder:"Ej: Sector Norte, Patio Principal"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"description",className:"form-label",children:" Descripcin"}),s.jsx("textarea",{id:"description",value:_.description,onChange:I=>B("description",I.target.value),className:"form-input",rows:"3",placeholder:"Descripcin adicional del vehculo, caractersticas especiales, etc."})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" Fechas Importantes"}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"purchaseDate",className:"form-label",children:" Fecha de Compra"}),s.jsx("input",{type:"date",id:"purchaseDate",value:_.purchaseDate,onChange:I=>B("purchaseDate",I.target.value),className:"form-input"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"lastMaintenanceDate",className:"form-label",children:" ltimo Mantenimiento"}),s.jsx("input",{type:"date",id:"lastMaintenanceDate",value:_.lastMaintenanceDate,onChange:I=>B("lastMaintenanceDate",I.target.value),className:"form-input"})]})]})]}),f&&s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" Vista Previa"}),s.jsx("div",{className:"vehicle-preview",style:{"--category-color":f.color},children:s.jsxs("div",{className:"preview-header",children:[s.jsx("div",{className:"preview-icon",style:{color:f.color},children:f.icon}),s.jsxs("div",{className:"preview-info",children:[s.jsx("h4",{children:_.name||"Nombre del vehculo"}),s.jsxs("p",{children:[_.vehicleId||"Cdigo del vehculo","  ",f.name]}),s.jsxs("p",{children:[_.brand," ",_.year]})]})]})})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:A,children:"Cancelar"}),s.jsx("button",{type:"submit",className:"btn-primary",disabled:A||!f,children:A?"Guardando...":o==="create"?"Crear Vehculo":"Actualizar Vehculo"})]})]})]}),g&&s.jsx(iC,{onClose:()=>y(!1),onCategoryCreated:I=>{d(D=>[...D,I]),y(!1)}})]}):null},PV=({category:n,isExpanded:e,onToggle:t})=>n?s.jsxs("div",{className:"category-info-panel",children:[s.jsxs("div",{className:"category-compact",children:[s.jsxs("div",{className:"category-summary",children:[s.jsx("span",{className:"category-icon",style:{color:n.color},children:n.icon}),s.jsxs("div",{className:"category-basic-info",children:[s.jsx("span",{className:"category-name",children:n.name}),s.jsx("span",{className:"category-short-desc",children:n.description?.length>50?n.description.substring(0,50)+"...":n.description})]})]}),s.jsx("button",{type:"button",className:"category-toggle-btn",onClick:t,"aria-label":e?"Contraer informacin":"Expandir informacin",children:e?"":""})]}),e&&s.jsxs("div",{className:"category-expanded",children:[s.jsxs("div",{className:"category-detail-section",children:[s.jsx("h4",{children:" Descripcin Completa"}),s.jsx("p",{children:n.description})]}),n.fuelTypes&&n.fuelTypes.length>0&&s.jsxs("div",{className:"category-detail-section",children:[s.jsx("h4",{children:" Combustibles Compatibles"}),s.jsx("div",{className:"fuel-types-list",children:n.fuelTypes.map(i=>s.jsx("span",{className:"fuel-type-badge",children:i},i))})]}),n.fields&&n.fields.length>0&&s.jsxs("div",{className:"category-detail-section",children:[s.jsx("h4",{children:" Campos Especficos"}),s.jsx("div",{className:"fields-list",children:n.fields.map(i=>s.jsx("span",{className:"field-badge",children:i},i))})]}),n.isCustom&&s.jsx("div",{className:"category-detail-section",children:s.jsx("span",{className:"custom-badge",children:" Categora Personalizada"})})]})]}):null,Yo={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},bi={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},Qo={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},LV=({isOpen:n,onClose:e,vehicle:t,maintenance:i,onSave:o,mode:c="create",userRole:d})=>{const f=H.useCallback(()=>({vehicleId:t?.vehicleId||"",vehicleName:t?.name||"",type:i?.type||Yo.PREVENTIVO,title:i?.title||"",description:i?.description||"",priority:i?.priority||Qo.MEDIA,status:i?.status||bi.PROGRAMADO,scheduledDate:i?.scheduledDate?new Date(i.scheduledDate).toISOString().split("T")[0]:"",startDate:i?.startDate?new Date(i.startDate).toISOString().split("T")[0]:"",completedDate:i?.completedDate?new Date(i.completedDate).toISOString().split("T")[0]:"",estimatedHours:i?.estimatedHours||0,actualHours:i?.actualHours||0,estimatedCost:i?.estimatedCost||0,actualCost:i?.actualCost||0,technician:i?.technician||"",workshop:i?.workshop||"",parts:i?.parts||[],notes:i?.notes||"",nextMaintenanceKm:i?.nextMaintenanceKm||0,nextMaintenanceHours:i?.nextMaintenanceHours||0,nextMaintenanceDate:i?.nextMaintenanceDate?new Date(i.nextMaintenanceDate).toISOString().split("T")[0]:""}),[i,t]),[p,g]=H.useState(f()),[y,N]=H.useState({}),[E,A]=H.useState(!1),[T,R]=H.useState({name:"",quantity:1,cost:0});H.useEffect(()=>{n&&(g(f()),N({}))},[n,i,t,f]);const b=D=>{const{name:q,value:be,type:Ie}=D.target,Y=Ie==="number"?parseFloat(be)||0:be;g(ie=>({...ie,[q]:Y})),y[q]&&N(ie=>({...ie,[q]:null}))},k=D=>{const{name:q,value:be,type:Ie}=D.target,Y=Ie==="number"?parseFloat(be)||0:be;R(ie=>({...ie,[q]:Y}))},_=()=>{if(!T.name.trim())return;const D={id:Date.now().toString(),name:T.name.trim(),quantity:T.quantity,cost:T.cost,total:T.quantity*T.cost};g(q=>({...q,parts:[...q.parts,D]})),R({name:"",quantity:1,cost:0})},j=D=>{g(q=>({...q,parts:q.parts.filter(be=>be.id!==D)}))},S=()=>{const D={};if(p.title.trim()||(D.title="El ttulo del mantenimiento es obligatorio"),p.description.trim()||(D.description="La descripcin es obligatoria"),p.scheduledDate||(D.scheduledDate="La fecha programada es obligatoria"),p.startDate&&p.completedDate){const q=new Date(p.startDate);new Date(p.completedDate)<q&&(D.completedDate="La fecha de finalizacin debe ser posterior al inicio")}return p.scheduledDate&&p.startDate&&(new Date(p.scheduledDate),new Date(p.startDate)),p.estimatedHours<0&&(D.estimatedHours="Las horas estimadas no pueden ser negativas"),p.actualHours<0&&(D.actualHours="Las horas reales no pueden ser negativas"),p.estimatedCost<0&&(D.estimatedCost="El costo estimado no puede ser negativo"),p.actualCost<0&&(D.actualCost="El costo real no puede ser negativo"),p.status===bi.COMPLETADO&&!p.completedDate&&(D.completedDate="La fecha de finalizacin es obligatoria para mantenimientos completados"),p.status===bi.EN_PROCESO&&!p.startDate&&(D.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),N(D),Object.keys(D).length===0},O=async D=>{if(D.preventDefault(),!!S()){A(!0);try{const q=p.parts.reduce((ie,ee)=>ie+ee.total,0),be=p.estimatedCost+q,Ie=p.actualCost+q,Y={...p,vehicleId:t.id,vehicleName:t.name,totalPartsCost:q,totalEstimatedCost:be,totalActualCost:Ie,scheduledDate:p.scheduledDate||null,startDate:p.startDate||null,completedDate:p.completedDate||null,nextMaintenanceDate:p.nextMaintenanceDate||null,createdAt:i?.createdAt||new Date,updatedAt:new Date};await o(Y),e()}catch(q){console.error("Error guardando mantenimiento:",q),N({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{A(!1)}}},B=D=>{switch(D){case Yo.PREVENTIVO:return"";case Yo.CORRECTIVO:return"";case Yo.PREDICTIVO:return"";case Yo.EMERGENCIA:return"";default:return""}},L=D=>{switch(D){case Qo.BAJA:return"priority-low";case Qo.MEDIA:return"priority-medium";case Qo.ALTA:return"priority-high";case Qo.CRITICA:return"priority-critical";default:return"priority-medium"}},M=D=>{switch(D){case bi.PROGRAMADO:return"status-scheduled";case bi.EN_PROCESO:return"status-in-progress";case bi.COMPLETADO:return"status-completed";case bi.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},V=()=>p.parts.reduce((D,q)=>D+q.total,0),U=c==="view",I=d==="admin"||d==="supervisor";return n?s.jsx("div",{className:"modal-overlay",onClick:e,children:s.jsxs("div",{className:"modal-content maintenance-modal",onClick:D=>D.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("div",{className:"modal-title",children:[s.jsx("span",{className:"title-icon",children:c==="create"?"":c==="edit"?"":""}),s.jsxs("div",{className:"title-text",children:[s.jsxs("h3",{children:[c==="create"&&"Registrar Mantenimiento",c==="edit"&&"Editar Mantenimiento",c==="view"&&"Detalles del Mantenimiento"]}),s.jsxs("p",{children:["Vehculo: ",t?.vehicleId," - ",t?.name]})]})]}),s.jsx("button",{className:"btn-close",onClick:e,type:"button",children:""})]}),s.jsxs("form",{onSubmit:O,className:"modal-form",children:[s.jsxs("div",{className:"form-content",children:[y.general&&s.jsxs("div",{className:"error-message general-error",children:[" ",y.general]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h4",{className:"section-title",children:" Informacin del Mantenimiento"}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),s.jsx("select",{id:"type",name:"type",value:p.type,onChange:b,disabled:U||c==="edit"&&!I,children:Object.values(Yo).map(D=>s.jsxs("option",{value:D,children:[B(D)," ",D.charAt(0).toUpperCase()+D.slice(1)]},D))})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"priority",children:"Prioridad"}),s.jsx("select",{id:"priority",name:"priority",value:p.priority,onChange:b,className:L(p.priority),disabled:U||c==="edit"&&!I,children:Object.values(Qo).map(D=>s.jsx("option",{value:D,children:D.charAt(0).toUpperCase()+D.slice(1)},D))})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"status",children:"Estado"}),s.jsx("select",{id:"status",name:"status",value:p.status,onChange:b,className:M(p.status),disabled:U||c==="edit"&&!I,children:Object.values(bi).map(D=>s.jsx("option",{value:D,children:D.charAt(0).toUpperCase()+D.slice(1).replace("_"," ")},D))})]}),s.jsxs("div",{className:"form-group full-width",children:[s.jsx("label",{htmlFor:"title",children:"Ttulo del Mantenimiento *"}),s.jsx("input",{type:"text",id:"title",name:"title",value:p.title,onChange:b,placeholder:"Ej: Cambio de aceite y filtros",className:y.title?"error":"",disabled:U||c==="edit"&&!I,maxLength:100}),y.title&&s.jsx("span",{className:"error-text",children:y.title})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h4",{className:"section-title",children:" Programacin"}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),s.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:p.scheduledDate,onChange:b,className:y.scheduledDate?"error":"",disabled:U||c==="edit"&&!I}),y.scheduledDate&&s.jsx("span",{className:"error-text",children:y.scheduledDate})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),s.jsx("input",{type:"date",id:"startDate",name:"startDate",value:p.startDate,onChange:b,className:y.startDate?"error":"",disabled:U||c==="edit"&&!I}),y.startDate&&s.jsx("span",{className:"error-text",children:y.startDate})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalizacin"}),s.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:p.completedDate,onChange:b,className:y.completedDate?"error":"",disabled:U||c==="edit"&&!I}),y.completedDate&&s.jsx("span",{className:"error-text",children:y.completedDate})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Prximo Mantenimiento"}),s.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:p.nextMaintenanceDate,onChange:b,disabled:U||c==="edit"&&!I})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h4",{className:"section-title",children:" Recursos y Costos"}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"technician",children:"Tcnico Responsable"}),s.jsx("input",{type:"text",id:"technician",name:"technician",value:p.technician,onChange:b,placeholder:"Nombre del tcnico",disabled:U||c==="edit"&&!I,maxLength:100})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicacin"}),s.jsx("input",{type:"text",id:"workshop",name:"workshop",value:p.workshop,onChange:b,placeholder:"Taller donde se realiza",disabled:U||c==="edit"&&!I,maxLength:100})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),s.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:p.estimatedHours,onChange:b,min:"0",step:"0.5",className:y.estimatedHours?"error":"",disabled:U||c==="edit"&&!I}),y.estimatedHours&&s.jsx("span",{className:"error-text",children:y.estimatedHours})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),s.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:p.actualHours,onChange:b,min:"0",step:"0.5",className:y.actualHours?"error":"",disabled:U||c==="edit"&&!I}),y.actualHours&&s.jsx("span",{className:"error-text",children:y.actualHours})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),s.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:p.estimatedCost,onChange:b,min:"0",step:"1000",className:y.estimatedCost?"error":"",disabled:U||c==="edit"&&!I}),y.estimatedCost&&s.jsx("span",{className:"error-text",children:y.estimatedCost})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),s.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:p.actualCost,onChange:b,min:"0",step:"1000",className:y.actualCost?"error":"",disabled:U||c==="edit"&&!I}),y.actualCost&&s.jsx("span",{className:"error-text",children:y.actualCost})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h4",{className:"section-title",children:" Partes y Repuestos"}),!U&&I&&s.jsx("div",{className:"parts-form",children:s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),s.jsx("input",{type:"text",id:"partName",name:"name",value:T.name,onChange:k,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),s.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:T.quantity,onChange:k,min:"1",step:"1"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),s.jsx("input",{type:"number",id:"partCost",name:"cost",value:T.cost,onChange:k,min:"0",step:"1000"})]}),s.jsx("div",{className:"form-group",children:s.jsx("button",{type:"button",className:"btn-add-part",onClick:_,disabled:!T.name.trim(),children:" Agregar"})})]})}),p.parts.length>0&&s.jsx("div",{className:"parts-list",children:s.jsxs("table",{className:"parts-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Parte"}),s.jsx("th",{children:"Cantidad"}),s.jsx("th",{children:"Costo Unit."}),s.jsx("th",{children:"Total"}),!U&&I&&s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:p.parts.map(D=>s.jsxs("tr",{children:[s.jsx("td",{children:D.name}),s.jsx("td",{children:D.quantity}),s.jsxs("td",{children:["$",D.cost.toLocaleString("es-CO")]}),s.jsxs("td",{children:["$",D.total.toLocaleString("es-CO")]}),!U&&I&&s.jsx("td",{children:s.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>j(D.id),title:"Eliminar parte",children:""})})]},D.id))}),s.jsx("tfoot",{children:s.jsxs("tr",{className:"total-row",children:[s.jsx("td",{colSpan:"3",children:s.jsx("strong",{children:"Total Partes:"})}),s.jsx("td",{children:s.jsxs("strong",{children:["$",V().toLocaleString("es-CO")]})}),!U&&I&&s.jsx("td",{})]})})]})})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h4",{className:"section-title",children:" Prximo Mantenimiento"}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Prximo Mantenimiento (Km)"}),s.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:p.nextMaintenanceKm,onChange:b,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:U||c==="edit"&&!I})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Prximo Mantenimiento (Horas)"}),s.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:p.nextMaintenanceHours,onChange:b,min:"0",step:"100",placeholder:"0 = No aplica",disabled:U||c==="edit"&&!I})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h4",{className:"section-title",children:" Descripcin y Notas"}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"description",children:"Descripcin del Trabajo *"}),s.jsx("textarea",{id:"description",name:"description",value:p.description,onChange:b,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:y.description?"error":"",disabled:U||c==="edit"&&!I}),y.description&&s.jsx("span",{className:"error-text",children:y.description})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),s.jsx("textarea",{id:"notes",name:"notes",value:p.notes,onChange:b,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:U||c==="edit"&&!I}),s.jsxs("span",{className:"char-count",children:[p.notes.length,"/500 caracteres"]})]})]}),s.jsxs("div",{className:"cost-summary",children:[s.jsx("h4",{children:" Resumen de Costos"}),s.jsxs("div",{className:"cost-grid",children:[s.jsxs("div",{className:"cost-item",children:[s.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),s.jsxs("span",{className:"cost-value",children:["$",p.actualCost.toLocaleString("es-CO")]})]}),s.jsxs("div",{className:"cost-item",children:[s.jsx("span",{className:"cost-label",children:"Partes:"}),s.jsxs("span",{className:"cost-value",children:["$",V().toLocaleString("es-CO")]})]}),s.jsxs("div",{className:"cost-item total-cost",children:[s.jsx("span",{className:"cost-label",children:"Total:"}),s.jsxs("span",{className:"cost-value",children:["$",(p.actualCost+V()).toLocaleString("es-CO")]})]})]})]})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:E,children:c==="view"?"Cerrar":"Cancelar"}),!U&&I&&s.jsx("button",{type:"submit",className:"btn-primary",disabled:E,children:E?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):s.jsx(s.Fragment,{children:c==="create"?" Registrar Mantenimiento":" Guardar Cambios"})})]})]})]})}):null},VV=()=>{const{user:n,userProfile:e}=Zn(),[t,i]=H.useState([]),[o,c]=H.useState(null),[d,f]=H.useState(!0),[p,g]=H.useState(null),[y,N]=H.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[E,A]=H.useState("cards"),[T,R]=H.useState(""),[b,k]=H.useState(!1),[_,j]=H.useState(!1),[S,O]=H.useState(!1),[B,L]=H.useState(null),[M,V]=H.useState("create");H.useEffect(()=>{if(!n)return;f(!0);const te=hy((he,de)=>{if(de){console.error("Error en suscripcin de vehculos:",de),g("Error al cargar vehculos"),f(!1);return}i(he),g(null),f(!1)},y);return()=>te()},[n,y]),H.useEffect(()=>{n&&(async()=>{try{const he=await ZA(y);c(he)}catch(he){console.error("Error al cargar estadsticas:",he)}})()},[n,t,y]);const U=t.filter(te=>{if(!T)return!0;const he=T.toLowerCase();return te.vehicleId?.toLowerCase().includes(he)||te.name?.toLowerCase().includes(he)||te.type?.toLowerCase().includes(he)||te.brand?.toLowerCase().includes(he)||te.model?.toLowerCase().includes(he)||te.currentLocation?.toLowerCase().includes(he)||te.description?.toLowerCase().includes(he)}),I=()=>{L(null),V("create"),k(!0)},D=te=>{L(te),V("edit"),k(!0)},q=te=>{L(te),V("view"),k(!0)},be=te=>{L(te),j(!0)},Ie=()=>{k(!1),j(!1),L(null)},Y=te=>{N(he=>({...he,...te}))},ie=()=>{N({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),R("")},ee=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",xe=e?.role==="admin",G=e?.role==="admin"||e?.role==="contador";return d?s.jsx("div",{className:"vehicles-main",children:s.jsxs("div",{className:"loading-container",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Cargando vehculos..."})]})}):p?s.jsx("div",{className:"vehicles-main",children:s.jsxs("div",{className:"error-container",children:[s.jsx("div",{className:"error-icon",children:""}),s.jsx("h3",{children:"Error al cargar vehculos"}),s.jsx("p",{children:p}),s.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):s.jsxs("div",{className:"vehicles-main",children:[s.jsxs("div",{className:"vehicles-header",children:[s.jsxs("div",{className:"header-title",children:[s.jsx("h2",{children:" Gestin de Vehculos"}),s.jsx("p",{children:"Administra la maquinaria y vehculos forestales"})]}),ee&&s.jsx("button",{className:"btn-create-vehicle",onClick:I,children:" Nuevo Vehculo"})]}),o&&s.jsx(jV,{stats:o,filters:y}),s.jsx(TV,{filters:y,onFilterChange:Y,onClearFilters:ie,searchTerm:T,onSearchChange:R,viewMode:E,onViewModeChange:A,totalResults:U.length}),U.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:""}),s.jsx("h3",{children:t.length===0?"No hay vehculos registrados":"No se encontraron vehculos"}),s.jsx("p",{children:t.length===0?"Comienza registrando tu primer vehculo o maquinaria forestal":"Intenta ajustar los filtros de bsqueda"}),t.length===0&&ee&&s.jsx("button",{className:"btn-create-first",onClick:I,children:" Registrar Primer Vehculo"})]}):s.jsx(wV,{vehicles:U,viewMode:E,onEdit:xe?D:null,onView:q,onMaintenance:G?be:null,userRole:n?.role}),b&&s.jsx(OV,{isOpen:b,onClose:Ie,vehicle:B,mode:M,onSave:async te=>{M==="create"?await KA(te):await WA(B.id,te),Ie()},userRole:e?.role}),S&&s.jsx(iC,{onClose:()=>O(!1),onCategoryCreated:()=>{}}),_&&s.jsx(LV,{isOpen:_,onClose:Ie,vehicle:B,onSuccess:()=>{Ie()}})]})},ku="combustibles_maintenance",rC="combustibles_vehicles",ge={OIL_CHANGE:"oil_change",BATTERY_CHANGE:"battery_change",FILTER_CHANGE:"filter_change",GENERAL_MAINTENANCE:"general_maintenance"},Le={COMPLETED:"completado",PENDING:"pendiente",CANCELLED:"cancelado"},tl={NEW:"nueva",USED:"usada",REPAIRED:"reparada"},py={OIL_CHANGE_HOURS:250,BATTERY_LIFETIME_MONTHS:24},oC=async n=>{try{FV(n);const e={...n,createdAt:qe(),updatedAt:qe(),status:n.status||Le.COMPLETED,createdBy:n.createdBy||"system"};n.type===ge.OIL_CHANGE&&(e.nextChangeHours=Df(n.currentHours)),n.type===ge.BATTERY_CHANGE&&(e.nextBatteryChange=fC(n.date));const t=await El(Pe(pe,ku),e);return n.vehicleId&&n.currentHours&&await mC(n.vehicleId,n.currentHours),console.log(" Mantenimiento creado exitosamente:",t.id),t.id}catch(e){throw console.error(" Error al crear mantenimiento:",e),new Error(`Error al crear mantenimiento: ${e.message}`)}},lC=async(n={})=>{try{let e=Pe(pe,ku);n.type&&(e=Te(e,De("type","==",n.type))),n.vehicleId&&(e=Te(e,De("vehicleId","==",n.vehicleId))),n.status&&(e=Te(e,De("status","==",n.status))),n.dateFrom&&(e=Te(e,De("date",">=",new Date(n.dateFrom)))),n.dateTo&&(e=Te(e,De("date","<=",new Date(n.dateTo)))),e=Te(e,In("date","desc"));const t=await mt(e),i=[];return t.forEach(o=>{i.push({id:o.id,...o.data()})}),i}catch(e){throw console.error(" Error al obtener mantenimientos:",e),new Error(`Error al obtener mantenimientos: ${e.message}`)}},cC=async(n,e)=>{try{qV(e);const t=et(pe,ku,n),i={...e,updatedAt:qe()};e.currentHours&&e.type===ge.OIL_CHANGE&&(i.nextChangeHours=Df(e.currentHours)),await Rs(t,i),e.vehicleId&&e.currentHours&&await mC(e.vehicleId,e.currentHours),console.log(" Mantenimiento actualizado exitosamente:",n)}catch(t){throw console.error(" Error al actualizar mantenimiento:",t),new Error(`Error al actualizar mantenimiento: ${t.message}`)}},UV=async n=>{try{const e=et(pe,ku,n);await Af(e),console.log(" Mantenimiento eliminado exitosamente:",n)}catch(e){throw console.error(" Error al eliminar mantenimiento:",e),new Error(`Error al eliminar mantenimiento: ${e.message}`)}},uC=async(n={})=>{try{const e=await lC(n),t={total:e.length,byType:{},byStatus:{},byVehicle:{},totalCost:0,averageCost:0,upcomingCount:0,overdueCount:0};let i=0;return e.forEach(o=>{t.byType[o.type]=(t.byType[o.type]||0)+1,t.byStatus[o.status]=(t.byStatus[o.status]||0)+1,t.byVehicle[o.vehicleId]=(t.byVehicle[o.vehicleId]||0)+1,o.cost&&(i+=parseFloat(o.cost)),o.nextChangeDate&&(new Date(o.nextChangeDate)>new Date?t.upcomingCount++:t.overdueCount++)}),t.totalCost=i,t.averageCost=t.total>0?i/t.total:0,t}catch(e){throw console.error(" Error al obtener estadsticas de mantenimiento:",e),new Error(`Error al obtener estadsticas de mantenimiento: ${e.message}`)}},dC=(n,e={})=>{try{let t=Pe(pe,ku);return e.type&&(t=Te(t,De("type","==",e.type))),e.vehicleId&&(t=Te(t,De("vehicleId","==",e.vehicleId))),e.status&&(t=Te(t,De("status","==",e.status))),t=Te(t,In("date","desc")),Zr(t,o=>{const c=[];o.forEach(d=>{c.push({id:d.id,...d.data()})}),n(c,null)},o=>{console.error(" Error en suscripcin de mantenimientos:",o),n([],o)})}catch(t){return console.error(" Error al suscribirse a mantenimientos:",t),n([],t),()=>{}}},hC=async()=>{try{const n=Te(Pe(pe,rC),De("status","in",["activo","mantenimiento"]),In("name","asc")),e=await mt(n),t=[];return e.forEach(i=>{t.push({id:i.id,...i.data()})}),t}catch(n){throw console.error(" Error al obtener vehculos para mantenimiento:",n),new Error(`Error al obtener vehculos para mantenimiento: ${n.message}`)}},Df=n=>parseInt(n)+py.OIL_CHANGE_HOURS,fC=n=>{const e=new Date(n);return e.setMonth(e.getMonth()+py.BATTERY_LIFETIME_MONTHS),e},mC=async(n,e)=>{try{const t=Te(Pe(pe,rC),De("vehicleId","==",n)),i=await mt(t);if(!i.empty){const o=i.docs[0],c=o.data();if(c.hasHourMeter&&c.type==="tractor"){const d=parseInt(c.currentHours)||0,f=parseInt(e)||0;f>d&&(await Rs(o.ref,{currentHours:f,lastHourMeterDate:qe(),updatedAt:qe()}),console.log(` Hormetro actualizado para ${n}: ${d}  ${f}`))}}}catch(t){console.error(" Error al actualizar hormetro del vehculo:",t)}},FV=n=>{const e=[];if(n.type||e.push("El tipo de mantenimiento es obligatorio"),n.vehicleId||e.push("El vehculo es obligatorio"),n.date||e.push("La fecha es obligatoria"),n.type===ge.OIL_CHANGE&&((!n.quantity||n.quantity<=0)&&e.push("La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!n.currentHours||n.currentHours<0)&&e.push("La lectura del hormetro es obligatoria")),n.type===ge.BATTERY_CHANGE&&(n.batteryType||e.push("El tipo de batera es obligatorio"),(!n.cost||n.cost<=0)&&e.push("El costo de la batera es obligatorio")),e.length>0)throw new Error(e.join(", "))},qV=n=>{const e=[];if(n.type&&!Object.values(ge).includes(n.type)&&e.push("Tipo de mantenimiento invlido"),n.status&&!Object.values(Le).includes(n.status)&&e.push("Estado de mantenimiento invlido"),n.batteryStatus&&!Object.values(tl).includes(n.batteryStatus)&&e.push("Estado de batera invlido"),e.length>0)throw new Error(e.join(", "))},HV=Object.freeze(Object.defineProperty({__proto__:null,BATTERY_STATUS:tl,MAINTENANCE_CONSTANTS:py,MAINTENANCE_STATUS:Le,MAINTENANCE_TYPES:ge,calculateNextBatteryChange:fC,calculateNextOilChange:Df,createMaintenanceRecord:oC,deleteMaintenanceRecord:UV,getAllMaintenanceRecords:lC,getMaintenanceStats:uC,getVehiclesForMaintenance:hC,subscribeToMaintenance:dC,updateMaintenanceRecord:cC},Symbol.toStringTag,{value:"Module"})),BV=({stats:n})=>{if(!n)return null;const e=c=>{switch(c){case ge.OIL_CHANGE:return"";case ge.BATTERY_CHANGE:return"";case ge.FILTER_CHANGE:return"";case ge.GENERAL_MAINTENANCE:return"";default:return""}},t=c=>{switch(c){case ge.OIL_CHANGE:return"Cambios de Aceite";case ge.BATTERY_CHANGE:return"Cambios de Batera";case ge.FILTER_CHANGE:return"Cambios de Filtros";case ge.GENERAL_MAINTENANCE:return"Mantenimientos Generales";default:return c}},i=c=>{switch(c){case Le.COMPLETED:return"#10b981";case Le.PENDING:return"#f59e0b";case Le.CANCELLED:return"#ef4444";default:return"#6b7280"}},o=c=>{switch(c){case Le.COMPLETED:return"Completados";case Le.PENDING:return"Pendientes";case Le.CANCELLED:return"Cancelados";default:return c}};return s.jsxs("div",{className:"maintenance-stats",children:[s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card primary",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:ce(n.total)}),s.jsx("p",{children:"Total Mantenimientos"})]})]}),s.jsxs("div",{className:"stat-card success",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:Me(n.totalCost)}),s.jsx("p",{children:"Costo Total"})]})]}),s.jsxs("div",{className:"stat-card warning",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:ce(n.upcomingCount)}),s.jsx("p",{children:"Prximos"})]})]}),s.jsxs("div",{className:"stat-card danger",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-content",children:[s.jsx("h3",{children:ce(n.overdueCount)}),s.jsx("p",{children:"Vencidos"})]})]})]}),Object.keys(n.byType).length>0&&s.jsxs("div",{className:"stats-breakdown",children:[s.jsx("h3",{children:" Desglose por Tipo"}),s.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([c,d])=>s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-header",children:[s.jsx("span",{className:"breakdown-icon",children:e(c)}),s.jsx("span",{className:"breakdown-label",children:t(c)})]}),s.jsx("div",{className:"breakdown-value",children:ce(d)}),s.jsx("div",{className:"breakdown-bar",children:s.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:"#3b82f6"}})}),s.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),Object.keys(n.byStatus).length>0&&s.jsxs("div",{className:"stats-breakdown",children:[s.jsx("h3",{children:" Desglose por Estado"}),s.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([c,d])=>s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-header",children:[s.jsx("span",{className:"status-dot",style:{backgroundColor:i(c)}}),s.jsx("span",{className:"breakdown-label",children:o(c)})]}),s.jsx("div",{className:"breakdown-value",children:ce(d)}),s.jsx("div",{className:"breakdown-bar",children:s.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:i(c)}})}),s.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),s.jsxs("div",{className:"stats-insights",children:[s.jsx("h3",{children:" Insights"}),s.jsxs("div",{className:"insights-grid",children:[s.jsxs("div",{className:"insight-item",children:[s.jsx("span",{className:"insight-label",children:"Costo Promedio:"}),s.jsx("span",{className:"insight-value",children:Me(n.averageCost)})]}),n.overdueCount>0&&s.jsxs("div",{className:"insight-item alert",children:[s.jsx("span",{className:"insight-label",children:" Mantenimientos Vencidos:"}),s.jsxs("span",{className:"insight-value",children:[ce(n.overdueCount)," requieren atencin"]})]}),n.upcomingCount>0&&s.jsxs("div",{className:"insight-item info",children:[s.jsx("span",{className:"insight-label",children:" Prximos Mantenimientos:"}),s.jsxs("span",{className:"insight-value",children:[ce(n.upcomingCount)," programados"]})]})]})]})]})},zV=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:i,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const p=A=>{switch(A){case ge.OIL_CHANGE:return"Cambio de Aceite";case ge.BATTERY_CHANGE:return"Cambio de Batera";case ge.FILTER_CHANGE:return"Cambio de Filtros";case ge.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return A}},g=A=>{switch(A){case Le.COMPLETED:return"Completado";case Le.PENDING:return"Pendiente";case Le.CANCELLED:return"Cancelado";default:return A}},y=(A,T)=>{e({[A]:T})},N=A=>{e(A)},E=()=>Object.values(n).some(A=>A!=="")||i;return s.jsx("div",{className:"maintenance-filters",children:s.jsxs("div",{className:"filters-main",children:[s.jsx("div",{className:"search-section",children:s.jsxs("div",{className:"search-box",children:[s.jsx("span",{className:"search-icon",children:""}),s.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar mantenimientos...",value:i,onChange:A=>o(A.target.value)}),i&&s.jsx("button",{className:"search-clear",onClick:()=>o(""),children:""})]})}),s.jsxs("div",{className:"filters-controls",children:[s.jsxs("div",{className:"quick-filters",children:[s.jsx("button",{className:`quick-filter ${E()?"":"active"}`,onClick:()=>t(),children:"Todos"}),s.jsx("button",{className:`quick-filter ${n.type===ge.OIL_CHANGE?"active":""}`,onClick:()=>N({type:ge.OIL_CHANGE}),children:" Aceite"}),s.jsx("button",{className:`quick-filter ${n.type===ge.BATTERY_CHANGE?"active":""}`,onClick:()=>N({type:ge.BATTERY_CHANGE}),children:" Bateras"}),s.jsx("button",{className:`quick-filter ${n.status===Le.PENDING?"active":""}`,onClick:()=>N({status:Le.PENDING}),children:" Pendientes"})]}),s.jsxs("button",{className:`btn-advanced-filters ${E()?"active":""}`,onClick:()=>document.querySelector(".filters-advanced").classList.toggle("show"),children:[" Filtros Avanzados",E()&&s.jsx("span",{className:"filters-count",children:Object.values(n).filter(A=>A!=="").length})]}),s.jsxs("div",{className:"view-modes",children:[s.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),children:" Cards"}),s.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),children:" Tabla"})]})]}),s.jsxs("div",{className:"filters-advanced",children:[s.jsxs("div",{className:"filters-grid",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Tipo de Mantenimiento"}),s.jsxs("select",{value:n.type,onChange:A=>y("type",A.target.value),children:[s.jsx("option",{value:"",children:"Todos los tipos"}),s.jsx("option",{value:ge.OIL_CHANGE,children:p(ge.OIL_CHANGE)}),s.jsx("option",{value:ge.BATTERY_CHANGE,children:p(ge.BATTERY_CHANGE)}),s.jsx("option",{value:ge.FILTER_CHANGE,children:p(ge.FILTER_CHANGE)}),s.jsx("option",{value:ge.GENERAL_MAINTENANCE,children:p(ge.GENERAL_MAINTENANCE)})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Estado"}),s.jsxs("select",{value:n.status,onChange:A=>y("status",A.target.value),children:[s.jsx("option",{value:"",children:"Todos los estados"}),s.jsx("option",{value:Le.COMPLETED,children:g(Le.COMPLETED)}),s.jsx("option",{value:Le.PENDING,children:g(Le.PENDING)}),s.jsx("option",{value:Le.CANCELLED,children:g(Le.CANCELLED)})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Fecha Desde"}),s.jsx("input",{type:"date",value:n.dateFrom,onChange:A=>y("dateFrom",A.target.value)})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{children:"Fecha Hasta"}),s.jsx("input",{type:"date",value:n.dateTo,onChange:A=>y("dateTo",A.target.value)})]})]}),s.jsx("div",{className:"filters-actions",children:s.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:!E(),children:" Limpiar Filtros"})})]}),s.jsxs("div",{className:"filters-info",children:[s.jsxs("div",{className:"results-count",children:[f," mantenimiento",f!==1?"s":""," encontrado",f!==1?"s":""]}),E()&&s.jsxs("div",{className:"active-filters",children:[s.jsx("span",{className:"filters-label",children:"Filtros activos:"}),s.jsxs("div",{className:"filter-tags",children:[n.type&&s.jsxs("span",{className:"filter-tag",children:["Tipo: ",p(n.type),s.jsx("button",{onClick:()=>y("type",""),children:""})]}),n.status&&s.jsxs("span",{className:"filter-tag",children:["Estado: ",g(n.status),s.jsx("button",{onClick:()=>y("status",""),children:""})]}),n.dateFrom&&s.jsxs("span",{className:"filter-tag",children:["Desde: ",n.dateFrom,s.jsx("button",{onClick:()=>y("dateFrom",""),children:""})]}),n.dateTo&&s.jsxs("span",{className:"filter-tag",children:["Hasta: ",n.dateTo,s.jsx("button",{onClick:()=>y("dateTo",""),children:""})]}),i&&s.jsxs("span",{className:"filter-tag",children:['Bsqueda: "',i,'"',s.jsx("button",{onClick:()=>o(""),children:""})]})]})]})]})]})})},GV=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:i,userRole:o})=>{const c=T=>T?new Date(T).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"N/A",d=T=>{if(!T)return"";const R=new Date,b=new Date(T),k=Math.abs(R-b),_=Math.ceil(k/(1e3*60*60*24));return _===0?"Hoy":_===1?"Ayer":_<7?`Hace ${_} das`:_<30?`Hace ${Math.floor(_/7)} semanas`:`Hace ${Math.floor(_/30)} meses`},f=T=>{switch(T){case ge.OIL_CHANGE:return"maintenance-oil-change";case ge.BATTERY_CHANGE:return"maintenance-battery-change";case ge.FILTER_CHANGE:return"maintenance-filter-change";case ge.GENERAL_MAINTENANCE:return"maintenance-general";default:return"maintenance-general"}},p=T=>{switch(T){case Le.COMPLETED:return"status-completado";case Le.PENDING:return"status-pendiente";case Le.CANCELLED:return"status-cancelado";default:return"status-unknown"}},g=T=>{switch(T){case ge.OIL_CHANGE:return"";case ge.BATTERY_CHANGE:return"";case ge.FILTER_CHANGE:return"";case ge.GENERAL_MAINTENANCE:return"";default:return""}},y=T=>{switch(T){case ge.OIL_CHANGE:return"Cambio de Aceite";case ge.BATTERY_CHANGE:return"Cambio de Batera";case ge.FILTER_CHANGE:return"Cambio de Filtros";case ge.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return T}},N=T=>{switch(T){case Le.COMPLETED:return"";case Le.PENDING:return"";case Le.CANCELLED:return"";default:return""}},E=T=>{switch(T){case Le.COMPLETED:return"Completado";case Le.PENDING:return"Pendiente";case Le.CANCELLED:return"Cancelado";default:return T}},A=o==="admin"||o==="supervisor";return s.jsx("div",{className:"maintenance-cards",children:n.map(T=>s.jsxs("div",{className:`maintenance-card ${f(T.type)}`,children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("div",{className:"maintenance-type",children:[s.jsx("span",{className:"type-icon",children:g(T.type)}),s.jsx("span",{className:"type-label",children:y(T.type)})]}),s.jsxs("div",{className:`status-badge ${p(T.status)}`,children:[N(T.status)," ",E(T.status)]})]}),s.jsxs("div",{className:"card-content",children:[s.jsxs("div",{className:"vehicle-info",children:[s.jsx("span",{className:"vehicle-icon",children:""}),s.jsxs("div",{className:"vehicle-details",children:[s.jsx("div",{className:"vehicle-name",children:T.vehicleName}),s.jsx("div",{className:"vehicle-id",children:T.vehicleId})]})]}),s.jsxs("div",{className:"date-info",children:[s.jsx("div",{className:"created-date",children:c(T.date)}),s.jsx("div",{className:"relative-time",children:d(T.date)})]}),T.type===ge.OIL_CHANGE&&s.jsxs("div",{className:"oil-change-info",children:[s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Cantidad:"}),s.jsxs("span",{className:"info-value",children:[ce(T.quantity)," galones"]})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Hormetro:"}),s.jsxs("span",{className:"info-value",children:[ce(T.currentHours)," horas"]})]}),T.nextChangeHours&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Prximo cambio:"}),s.jsxs("span",{className:"info-value",children:[ce(T.nextChangeHours)," horas"]})]}),T.filters&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Filtros:"}),s.jsx("span",{className:"info-value",children:T.filters})]})]}),T.type===ge.BATTERY_CHANGE&&s.jsxs("div",{className:"battery-change-info",children:[s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Tipo:"}),s.jsx("span",{className:"info-value",children:T.batteryType})]}),T.brand&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Marca:"}),s.jsx("span",{className:"info-value",children:T.brand})]}),T.model&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Modelo:"}),s.jsx("span",{className:"info-value",children:T.model})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Estado:"}),s.jsx("span",{className:"info-value",children:T.batteryStatus})]}),T.cost&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Costo:"}),s.jsx("span",{className:"info-value",children:Me(T.cost)})]})]}),T.notes&&s.jsxs("div",{className:"notes-section",children:[s.jsx("span",{className:"notes-label",children:"Notas:"}),s.jsx("p",{className:"notes-text",children:T.notes})]})]}),s.jsx("div",{className:"card-footer",children:s.jsxs("div",{className:"card-actions",children:[s.jsx("button",{className:"btn-view",onClick:()=>t(T),title:"Ver detalles",children:" Ver"}),A&&e&&s.jsx("button",{className:"btn-edit",onClick:()=>e(T),title:"Editar",children:" Editar"}),A&&i&&s.jsx("button",{className:"btn-delete",onClick:()=>i(T.id),title:"Eliminar",children:" Eliminar"})]})})]},T.id))})},$V=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:i,userRole:o})=>{const[c,d]=H.useState("date"),[f,p]=H.useState("desc"),g=j=>j?new Date(j).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",y=j=>{switch(j){case ge.OIL_CHANGE:return"";case ge.BATTERY_CHANGE:return"";case ge.FILTER_CHANGE:return"";case ge.GENERAL_MAINTENANCE:return"";default:return""}},N=j=>{switch(j){case ge.OIL_CHANGE:return"Cambio de Aceite";case ge.BATTERY_CHANGE:return"Cambio de Batera";case ge.FILTER_CHANGE:return"Cambio de Filtros";case ge.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return j}},E=j=>{switch(j){case Le.COMPLETED:return"";case Le.PENDING:return"";case Le.CANCELLED:return"";default:return""}},A=j=>{switch(j){case Le.COMPLETED:return"Completado";case Le.PENDING:return"Pendiente";case Le.CANCELLED:return"Cancelado";default:return j}},T=j=>{switch(j){case Le.COMPLETED:return"status-completado";case Le.PENDING:return"status-pendiente";case Le.CANCELLED:return"status-cancelado";default:return"status-unknown"}},R=j=>{c===j?p(f==="asc"?"desc":"asc"):(d(j),p("asc"))},b=j=>c!==j?"":f==="asc"?"":"",k=[...n].sort((j,S)=>{let O=j[c],B=S[c];return c==="date"&&(O=new Date(O),B=new Date(B)),["quantity","currentHours","nextChangeHours","cost"].includes(c)&&(O=parseFloat(O)||0,B=parseFloat(B)||0),typeof O=="string"&&(O=O.toLowerCase(),B=B.toLowerCase()),f==="asc"?O>B?1:-1:O<B?1:-1}),_=o==="admin"||o==="supervisor";return s.jsxs("div",{className:"maintenance-table-container",children:[s.jsx("div",{className:"table-wrapper",children:s.jsxs("table",{className:"maintenance-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsxs("th",{className:"sortable",onClick:()=>R("type"),children:["Tipo ",b("type")]}),s.jsxs("th",{className:"sortable",onClick:()=>R("vehicleName"),children:["Vehculo ",b("vehicleName")]}),s.jsxs("th",{className:"sortable",onClick:()=>R("date"),children:["Fecha ",b("date")]}),s.jsx("th",{children:"Detalles"}),s.jsxs("th",{className:"sortable",onClick:()=>R("status"),children:["Estado ",b("status")]}),s.jsxs("th",{className:"sortable text-right",onClick:()=>R("cost"),children:["Costo ",b("cost")]}),s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:k.map(j=>s.jsxs("tr",{className:"maintenance-row",children:[s.jsx("td",{className:"type-cell",children:s.jsxs("div",{className:"type-content",children:[s.jsx("span",{className:"type-icon",children:y(j.type)}),s.jsx("span",{className:"type-name",children:N(j.type)})]})}),s.jsx("td",{className:"vehicle-cell",children:s.jsxs("div",{className:"vehicle-info",children:[s.jsx("div",{className:"vehicle-name",children:j.vehicleName}),s.jsx("div",{className:"vehicle-id",children:j.vehicleId})]})}),s.jsx("td",{className:"date-cell",children:s.jsx("div",{className:"date-content",children:s.jsx("div",{className:"date-value",children:g(j.date)})})}),s.jsxs("td",{className:"details-cell",children:[j.type===ge.OIL_CHANGE&&s.jsxs("div",{className:"oil-details",children:[s.jsxs("div",{children:["Qty: ",ce(j.quantity)," gal"]}),s.jsxs("div",{children:["Hrs: ",ce(j.currentHours)]}),j.filters&&s.jsxs("div",{children:["Filtros: ",j.filters]})]}),j.type===ge.BATTERY_CHANGE&&s.jsxs("div",{className:"battery-details",children:[s.jsx("div",{children:j.batteryType}),j.brand&&s.jsx("div",{children:j.brand}),s.jsxs("div",{children:["Estado: ",j.batteryStatus]})]}),j.notes&&s.jsx("div",{className:"notes-small",children:j.notes})]}),s.jsx("td",{className:"status-cell",children:s.jsxs("div",{className:`status-badge ${T(j.status)}`,children:[E(j.status)," ",A(j.status)]})}),s.jsx("td",{className:"cost-cell text-right",children:j.cost?Me(j.cost):"N/A"}),s.jsx("td",{className:"actions-cell",children:s.jsxs("div",{className:"action-buttons",children:[s.jsx("button",{className:"btn-action btn-view",onClick:()=>t(j),title:"Ver detalles",children:""}),_&&e&&s.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(j),title:"Editar",children:""}),_&&i&&s.jsx("button",{className:"btn-action btn-delete",onClick:()=>i(j.id),title:"Eliminar",children:""})]})})]},j.id))})]})}),s.jsxs("div",{className:"table-info",children:[s.jsx("div",{className:"table-summary",children:s.jsxs("span",{className:"total-rows",children:[n.length," mantenimiento",n.length!==1?"s":""," en total"]})}),s.jsxs("div",{className:"table-legend",children:[s.jsxs("div",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot oil-change"}),s.jsx("span",{children:"Cambio de Aceite"})]}),s.jsxs("div",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot battery-change"}),s.jsx("span",{children:"Cambio de Batera"})]}),s.jsxs("div",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot filter-change"}),s.jsx("span",{children:"Cambio de Filtros"})]}),s.jsxs("div",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot general"}),s.jsx("span",{children:"Mantenimiento General"})]})]})]})]})},YV=({maintenanceRecords:n,viewMode:e,onEdit:t,onView:i,onDelete:o,userRole:c})=>!n||n.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:""}),s.jsx("h3",{children:"No hay mantenimientos registrados"}),s.jsx("p",{children:"Comienza creando el primer mantenimiento para tu flota de vehculos."})]}):s.jsx("div",{className:"maintenance-list",children:e==="cards"?s.jsx(GV,{maintenanceRecords:n,onEdit:t,onView:i,onDelete:o,userRole:c}):s.jsx($V,{maintenanceRecords:n,onEdit:t,onView:i,onDelete:o,userRole:c})}),QV=({isOpen:n,onClose:e,onSuccess:t,maintenance:i,mode:o="create",userRole:c})=>{const d=H.useCallback(()=>({type:i?.type||ge.OIL_CHANGE,vehicleId:i?.vehicleId||"",vehicleName:i?.vehicleName||"",date:i?.date?new Date(i.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:i?.status||Le.COMPLETED,quantity:i?.quantity||0,currentHours:i?.currentHours||0,nextChangeHours:i?.nextChangeHours||0,filters:i?.filters||"",batteryType:i?.batteryType||"",brand:i?.brand||"",model:i?.model||"",batteryStatus:i?.batteryStatus||tl.NEW,notes:i?.notes||"",cost:i?.cost||0}),[i]),[f,p]=H.useState(d()),[g,y]=H.useState({}),[N,E]=H.useState(!1),[A,T]=H.useState([]);H.useEffect(()=>{n&&(async()=>{try{const B=await hC();T(B)}catch(B){console.error("Error al cargar vehculos:",B)}})()},[n]),H.useEffect(()=>{n&&(p(d()),y({}))},[n,i,A,d]),H.useEffect(()=>{if(f.type===ge.OIL_CHANGE&&f.currentHours>0){const O=Df(f.currentHours);p(B=>({...B,nextChangeHours:O}))}},[f.currentHours,f.type]);const R=(O,B)=>{const L=typeof B=="number"?parseFloat(B)||0:B;p(M=>({...M,[O]:L})),g[O]&&y(M=>({...M,[O]:null}))},b=O=>{const B=A.find(L=>L.vehicleId===O);p(L=>({...L,vehicleId:O,vehicleName:B?B.name:""})),B&&B.hasHourMeter&&B.currentHours&&p(L=>({...L,currentHours:B.currentHours}))},k=()=>{const O={};return f.type||(O.type="El tipo de mantenimiento es obligatorio"),f.vehicleId||(O.vehicleId="El vehculo es obligatorio"),f.date||(O.date="La fecha es obligatoria"),f.type===ge.OIL_CHANGE&&((!f.quantity||f.quantity<=0)&&(O.quantity="La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!f.currentHours||f.currentHours<0)&&(O.currentHours="La lectura del hormetro es obligatoria")),f.type===ge.BATTERY_CHANGE&&(f.batteryType||(O.batteryType="El tipo de batera es obligatorio"),(!f.cost||f.cost<=0)&&(O.cost="El costo de la batera es obligatorio")),y(O),Object.keys(O).length===0},_=async O=>{if(O.preventDefault(),!!k()){E(!0);try{const B={...f,date:new Date(f.date),createdBy:c||"user"};o==="create"?(await oC(B),console.log(" Mantenimiento creado exitosamente")):o==="edit"&&(await cC(i.id,B),console.log(" Mantenimiento actualizado exitosamente")),t()}catch(B){console.error(" Error al guardar mantenimiento:",B),alert("Error al guardar mantenimiento: "+B.message)}finally{E(!1)}}},j=()=>{switch(o){case"create":return"Crear Mantenimiento";case"edit":return"Editar Mantenimiento";case"view":return"Ver Mantenimiento";default:return"Mantenimiento"}},S=O=>{switch(O){case ge.OIL_CHANGE:return"";case ge.BATTERY_CHANGE:return"";case ge.FILTER_CHANGE:return"";case ge.GENERAL_MAINTENANCE:return"";default:return""}};return n?s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-content maintenance-modal",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:j()}),s.jsx("button",{className:"modal-close",onClick:e,children:""})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("form",{onSubmit:_,className:"maintenance-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Tipo de Mantenimiento *"}),s.jsxs("select",{value:f.type,onChange:O=>R("type",O.target.value),disabled:o==="view",children:[s.jsxs("option",{value:ge.OIL_CHANGE,children:[S(ge.OIL_CHANGE)," Cambio de Aceite"]}),s.jsxs("option",{value:ge.BATTERY_CHANGE,children:[S(ge.BATTERY_CHANGE)," Cambio de Batera"]}),s.jsxs("option",{value:ge.FILTER_CHANGE,children:[S(ge.FILTER_CHANGE)," Cambio de Filtros"]}),s.jsxs("option",{value:ge.GENERAL_MAINTENANCE,children:[S(ge.GENERAL_MAINTENANCE)," Mantenimiento General"]})]}),g.type&&s.jsx("span",{className:"error-text",children:g.type})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Vehculo *"}),s.jsxs("select",{value:f.vehicleId,onChange:O=>b(O.target.value),disabled:o==="view",children:[s.jsx("option",{value:"",children:"Seleccionar vehculo"}),A.map(O=>s.jsxs("option",{value:O.vehicleId,children:[O.vehicleId," - ",O.name," (",O.type,")"]},O.vehicleId))]}),g.vehicleId&&s.jsx("span",{className:"error-text",children:g.vehicleId})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Fecha *"}),s.jsx("input",{type:"date",value:f.date,onChange:O=>R("date",O.target.value),disabled:o==="view"}),g.date&&s.jsx("span",{className:"error-text",children:g.date})]}),f.type===ge.OIL_CHANGE&&s.jsxs("div",{className:"maintenance-section",children:[s.jsx("h3",{children:" Informacin del Cambio de Aceite"}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Cantidad (galones) *"}),s.jsx("input",{type:"number",step:"0.1",value:f.quantity,onChange:O=>R("quantity",O.target.value),disabled:o==="view"}),g.quantity&&s.jsx("span",{className:"error-text",children:g.quantity})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Hormetro Actual *"}),s.jsx("input",{type:"number",value:f.currentHours,onChange:O=>R("currentHours",O.target.value),disabled:o==="view"}),g.currentHours&&s.jsx("span",{className:"error-text",children:g.currentHours})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Prximo Cambio (horas)"}),s.jsx("input",{type:"number",value:f.nextChangeHours,disabled:!0,className:"readonly-input"}),s.jsx("small",{children:"Calculado automticamente: actual + 250 horas"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Filtros o Extras"}),s.jsx("textarea",{value:f.filters,onChange:O=>R("filters",O.target.value),disabled:o==="view",placeholder:"Especificar filtros cambiados o extras..."})]})]}),f.type===ge.BATTERY_CHANGE&&s.jsxs("div",{className:"maintenance-section",children:[s.jsx("h3",{children:" Informacin del Cambio de Batera"}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Tipo de Batera *"}),s.jsx("input",{type:"text",value:f.batteryType,onChange:O=>R("batteryType",O.target.value),disabled:o==="view",placeholder:"Ej: 12V 60Ah"}),g.batteryType&&s.jsx("span",{className:"error-text",children:g.batteryType})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Estado *"}),s.jsxs("select",{value:f.batteryStatus,onChange:O=>R("batteryStatus",O.target.value),disabled:o==="view",children:[s.jsx("option",{value:tl.NEW,children:"Nueva"}),s.jsx("option",{value:tl.USED,children:"Usada"}),s.jsx("option",{value:tl.REPAIRED,children:"Reparada"})]})]})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Marca"}),s.jsx("input",{type:"text",value:f.brand,onChange:O=>R("brand",O.target.value),disabled:o==="view",placeholder:"Ej: Bosch, Exide"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Modelo"}),s.jsx("input",{type:"text",value:f.model,onChange:O=>R("model",O.target.value),disabled:o==="view",placeholder:"Ej: S4 005"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Costo *"}),s.jsx("input",{type:"number",step:"1000",value:f.cost,onChange:O=>R("cost",O.target.value),disabled:o==="view",placeholder:"0"}),g.cost&&s.jsx("span",{className:"error-text",children:g.cost})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Notas Adicionales"}),s.jsx("textarea",{value:f.notes,onChange:O=>R("notes",O.target.value),disabled:o==="view",placeholder:"Observaciones adicionales...",rows:"3"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Estado"}),s.jsxs("select",{value:f.status,onChange:O=>R("status",O.target.value),disabled:o==="view",children:[s.jsx("option",{value:Le.COMPLETED,children:"Completado"}),s.jsx("option",{value:Le.PENDING,children:"Pendiente"}),s.jsx("option",{value:Le.CANCELLED,children:"Cancelado"})]})]})]})}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:N,children:"Cancelar"}),o!=="view"&&s.jsx("button",{type:"submit",className:"btn btn-primary",onClick:_,disabled:N,children:N?"Guardando...":o==="create"?"Crear":"Actualizar"})]})]})}):null},KV=()=>{const{user:n,userProfile:e}=Zn(),[t,i]=H.useState([]),[o,c]=H.useState(null),[d,f]=H.useState(!0),[p,g]=H.useState(null),[y,N]=H.useState({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),[E,A]=H.useState("cards"),[T,R]=H.useState(""),[b,k]=H.useState(!1),[_,j]=H.useState(null),[S,O]=H.useState("create");H.useEffect(()=>{if(!n)return;f(!0);const Y=dC((ie,ee)=>{if(ee){console.error("Error en suscripcin de mantenimientos:",ee),g("Error al cargar mantenimientos"),f(!1);return}i(ie),g(null),f(!1)},y);return()=>Y()},[n,y]),H.useEffect(()=>{n&&(async()=>{try{const ie=await uC(y);c(ie)}catch(ie){console.error("Error al cargar estadsticas:",ie)}})()},[n,t,y]);const B=t.filter(Y=>{if(!T)return!0;const ie=T.toLowerCase();return Y.vehicleName?.toLowerCase().includes(ie)||Y.type?.toLowerCase().includes(ie)||Y.status?.toLowerCase().includes(ie)||Y.notes?.toLowerCase().includes(ie)}),L=e?.combustiblesPermissions?.canManageMaintenance||!1,M=()=>{j(null),O("create"),k(!0)},V=Y=>{j(Y),O("edit"),k(!0)},U=Y=>{j(Y),O("view"),k(!0)},I=()=>{k(!1),j(null)},D=()=>{k(!1),j(null)},q=Y=>{N(ie=>({...ie,...Y}))},be=()=>{N({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),R("")},Ie=async Y=>{if(!L){alert("No tienes permisos para eliminar mantenimientos");return}if(window.confirm("Ests seguro de que quieres eliminar este mantenimiento?"))try{const{deleteMaintenanceRecord:ie}=await fy(async()=>{const{deleteMaintenanceRecord:ee}=await Promise.resolve().then(()=>HV);return{deleteMaintenanceRecord:ee}},void 0);await ie(Y),console.log(" Mantenimiento eliminado exitosamente")}catch(ie){console.error(" Error al eliminar mantenimiento:",ie),alert("Error al eliminar mantenimiento: "+ie.message)}};return n?s.jsxs("div",{className:"maintenance-main",children:[s.jsxs("div",{className:"maintenance-header",children:[s.jsxs("div",{className:"header-title",children:[s.jsx("h2",{children:" Mantenimiento de Vehculos"}),s.jsx("p",{children:"Gestin de cambios de aceite, filtros y bateras"})]}),s.jsx("div",{className:"header-actions",children:L&&s.jsx("button",{className:"btn-create-maintenance",onClick:M,children:" Crear Mantenimiento"})})]}),d&&s.jsxs("div",{className:"maintenance-loading",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Cargando mantenimientos..."})]}),p&&s.jsxs("div",{className:"error-banner",children:[s.jsxs("span",{children:[" ",p]}),s.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]}),o&&s.jsx(BV,{stats:o}),s.jsx(zV,{filters:y,onFilterChange:q,onClearFilters:be,searchTerm:T,onSearchChange:R,viewMode:E,onViewModeChange:A,totalResults:B.length}),!d&&!p&&s.jsx(YV,{maintenanceRecords:B,viewMode:E,onEdit:L?V:null,onView:U,onDelete:L?Ie:null,userRole:e?.role}),b&&s.jsx(QV,{isOpen:b,onClose:I,onSuccess:D,maintenance:_,mode:S,userRole:e?.role})]}):s.jsx("div",{className:"maintenance-main",children:s.jsxs("div",{className:"auth-required",children:[s.jsx("h2",{children:" Autenticacin Requerida"}),s.jsx("p",{children:"Debes iniciar sesin para acceder al mdulo de mantenimiento."})]})})},XV=({isOpen:n,onClose:e,product:t,mode:i="create",onSave:o,userRole:c})=>{const[d,f]=H.useState({name:"",displayName:"",category:Ks.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),[p,g]=H.useState({}),[y,N]=H.useState(!1),E=[{value:"gal",label:"Galones (gal)"},{value:"L",label:"Litros (L)"},{value:"kg",label:"Kilogramos (kg)"},{value:"und",label:"Unidades (und)"}],A={[Ks.COMBUSTIBLE]:["","","","",""],[Ks.ACEITE]:["","","","",""],[Ks.LUBRICANTE]:["","","","",""],[Ks.FLUIDO]:["","","","",""]},T=["#FF6B35","#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#E91E63","#795548","#607D8B","#3F51B5"];H.useEffect(()=>{f(t&&(i==="edit"||i==="view")?{name:t.name||"",displayName:t.displayName||"",category:t.category||Ks.COMBUSTIBLE,unit:t.unit||"gal",defaultPrice:t.defaultPrice||0,color:t.color||"#FF6B35",icon:t.icon||"",description:t.description||"",isActive:t.isActive!==void 0?t.isActive:!0,currentStock:t.currentStock||0,minThreshold:t.minThreshold||10,maxCapacity:t.maxCapacity||1e3}:{name:"",displayName:"",category:Ks.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),g({})},[t,i,n]);const R=j=>{const{name:S,value:O,type:B,checked:L}=j.target;f(M=>({...M,[S]:B==="checkbox"?L:O})),p[S]&&g(M=>({...M,[S]:""}))},b=()=>{const j={};return d.name.trim()||(j.name="El nombre es requerido"),d.displayName.trim()||(j.displayName="El nombre de visualizacin es requerido"),d.category||(j.category="La categora es requerida"),d.unit||(j.unit="La unidad es requerida"),d.defaultPrice<0&&(j.defaultPrice="El precio debe ser mayor o igual a 0"),d.currentStock<0&&(j.currentStock="El stock debe ser mayor o igual a 0"),d.minThreshold<0&&(j.minThreshold="El umbral mnimo debe ser mayor o igual a 0"),d.maxCapacity<=0&&(j.maxCapacity="La capacidad mxima debe ser mayor a 0"),d.minThreshold>=d.maxCapacity&&(j.minThreshold="El umbral mnimo debe ser menor que la capacidad mxima"),g(j),Object.keys(j).length===0},k=async j=>{if(j.preventDefault(),!!b()){N(!0);try{await o({...d,defaultPrice:parseFloat(d.defaultPrice),currentStock:parseFloat(d.currentStock),minThreshold:parseFloat(d.minThreshold),maxCapacity:parseFloat(d.maxCapacity)}),e()}catch(S){console.error("Error saving product:",S),g({submit:"Error al guardar el producto"})}finally{N(!1)}}};if(!n)return null;const _=["admin","supervisor"].includes(c)&&i!=="view";return s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-content product-modal",children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h2",{children:[i==="create"&&" Crear Producto",i==="edit"&&" Editar Producto",i==="view"&&" Ver Producto"]}),s.jsx("button",{className:"modal-close",onClick:e,children:""})]}),s.jsxs("form",{onSubmit:k,className:"modal-body",children:[s.jsx("div",{className:"product-preview",children:s.jsxs("div",{className:"preview-card",children:[s.jsx("div",{className:"preview-icon",style:{color:d.color},children:d.icon}),s.jsxs("div",{className:"preview-info",children:[s.jsx("h3",{children:d.displayName||"Nombre del producto"}),s.jsx("p",{className:"preview-category",children:d.category}),s.jsx("p",{className:"preview-description",children:d.description}),s.jsxs("div",{className:"preview-price",children:["$",new Intl.NumberFormat("es-CO").format(d.defaultPrice)," / ",d.unit]})]})]})}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" Informacin Bsica"}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Nombre Interno *"}),s.jsx("input",{type:"text",name:"name",value:d.name,onChange:R,disabled:!_,placeholder:"Ej: ACPM, GASOLINA"}),p.name&&s.jsx("span",{className:"error",children:p.name})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Nombre de Visualizacin *"}),s.jsx("input",{type:"text",name:"displayName",value:d.displayName,onChange:R,disabled:!_,placeholder:"Ej: ACPM , Gasolina "}),p.displayName&&s.jsx("span",{className:"error",children:p.displayName})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Categora *"}),s.jsx("select",{name:"category",value:d.category,onChange:R,disabled:!_,children:Object.values(Ks).map(j=>s.jsx("option",{value:j,children:j},j))}),p.category&&s.jsx("span",{className:"error",children:p.category})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Descripcin"}),s.jsx("textarea",{name:"description",value:d.description,onChange:R,disabled:!_,placeholder:"Descripcin del producto...",rows:"3"})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" Configuracin"}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Unidad de Medida *"}),s.jsx("select",{name:"unit",value:d.unit,onChange:R,disabled:!_,children:E.map(j=>s.jsx("option",{value:j.value,children:j.label},j.value))}),p.unit&&s.jsx("span",{className:"error",children:p.unit})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Precio por Defecto"}),s.jsx("input",{type:"number",name:"defaultPrice",value:d.defaultPrice,onChange:R,disabled:!_,min:"0",step:"0.01"}),p.defaultPrice&&s.jsx("span",{className:"error",children:p.defaultPrice})]}),s.jsx("div",{className:"form-group",children:s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",name:"isActive",checked:d.isActive,onChange:R,disabled:!_}),"Producto Activo"]})})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" Stock y Umbrales"}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Stock Actual"}),s.jsx("input",{type:"number",name:"currentStock",value:d.currentStock,onChange:R,disabled:!_,min:"0",step:"0.01"}),p.currentStock&&s.jsx("span",{className:"error",children:p.currentStock})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Umbral Mnimo"}),s.jsx("input",{type:"number",name:"minThreshold",value:d.minThreshold,onChange:R,disabled:!_,min:"0",step:"0.01"}),p.minThreshold&&s.jsx("span",{className:"error",children:p.minThreshold})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Capacidad Mxima"}),s.jsx("input",{type:"number",name:"maxCapacity",value:d.maxCapacity,onChange:R,disabled:!_,min:"1",step:"0.01"}),p.maxCapacity&&s.jsx("span",{className:"error",children:p.maxCapacity})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{children:" Apariencia"}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Icono"}),s.jsx("div",{className:"icon-selector",children:A[d.category]?.map(j=>s.jsx("button",{type:"button",className:`icon-option ${d.icon===j?"selected":""}`,onClick:()=>f(S=>({...S,icon:j})),disabled:!_,children:j},j))})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Color"}),s.jsx("div",{className:"color-selector",children:T.map(j=>s.jsx("button",{type:"button",className:`color-option ${d.color===j?"selected":""}`,style:{backgroundColor:j},onClick:()=>f(S=>({...S,color:j})),disabled:!_},j))})]})]})]}),p.submit&&s.jsx("div",{className:"error-message",children:p.submit})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:y,children:i==="view"?"Cerrar":"Cancelar"}),_&&s.jsx("button",{type:"submit",className:"btn-primary",onClick:k,disabled:y,children:y?"Guardando...":"Guardar"})]})]})})},WV=({products:n})=>{const[e,t]=H.useState([]),[i,o]=H.useState(!0);H.useEffect(()=>{const T=uy(R=>{t(R),o(!1)},R=>{console.error("Error loading movements for stats:",R),o(!1)});return()=>T()},[]);const c=()=>n.map(R=>{const b=e.filter(B=>B.fuelType===R.name||B.fuelType===R.displayName),k=b.filter(B=>B.type==="entrada"),_=b.filter(B=>B.type==="salida"),j=k.reduce((B,L)=>B+(L.quantity||0),0),S=_.reduce((B,L)=>B+(L.quantity||0),0),O=(R.currentStock||0)*(R.defaultPrice||0);return{...R,totalEntries:j,totalExits:S,totalValue:O,entriesCount:k.length,exitsCount:_.length,stockStatus:d(R)}}),d=T=>{const R=T.currentStock||0,b=T.minThreshold||0,k=T.maxCapacity||1e3;return R===0?"empty":R<=b?"low":R>=k*.9?"high":"normal"},f=T=>{const R={};return Object.values(Ks).forEach(b=>{const k=T.filter(_=>_.category===b);R[b]={totalProducts:k.length,totalStock:k.reduce((_,j)=>_+(j.currentStock||0),0),totalValue:k.reduce((_,j)=>_+j.totalValue,0),totalEntries:k.reduce((_,j)=>_+j.totalEntries,0),totalExits:k.reduce((_,j)=>_+j.totalExits,0),lowStockCount:k.filter(_=>_.stockStatus==="low"||_.stockStatus==="empty").length}}),R};if(i)return s.jsxs("div",{className:"products-stats loading",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Cargando estadsticas..."})]});const p=c(),g=f(p),y=n.length,N=n.filter(T=>T.isActive).length,E=p.reduce((T,R)=>T+R.totalValue,0),A=p.filter(T=>T.stockStatus==="low"||T.stockStatus==="empty").length;return s.jsxs("div",{className:"products-stats",children:[s.jsx("h2",{children:" Estadsticas de Productos"}),s.jsxs("div",{className:"stats-general",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("h3",{children:ce(y)}),s.jsx("p",{children:"Total Productos"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("h3",{children:ce(N)}),s.jsx("p",{children:"Productos Activos"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("h3",{children:Me(E)}),s.jsx("p",{children:"Valor Total Stock"})]})]}),s.jsxs("div",{className:`stat-card ${A>0?"alert":""}`,children:[s.jsx("div",{className:"stat-icon",children:""}),s.jsxs("div",{className:"stat-info",children:[s.jsx("h3",{children:ce(A)}),s.jsx("p",{children:"Stock Bajo"})]})]})]}),s.jsxs("div",{className:"stats-categories",children:[s.jsx("h3",{children:" Por Categora"}),s.jsx("div",{className:"categories-grid",children:Object.entries(g).map(([T,R])=>s.jsxs("div",{className:"category-card",children:[s.jsx("h4",{children:T}),s.jsxs("div",{className:"category-stats",children:[s.jsxs("div",{className:"stat-row",children:[s.jsx("span",{children:"Productos:"}),s.jsx("span",{children:ce(R.totalProducts)})]}),s.jsxs("div",{className:"stat-row",children:[s.jsx("span",{children:"Stock Total:"}),s.jsxs("span",{children:[ce(R.totalStock)," unidades"]})]}),s.jsxs("div",{className:"stat-row",children:[s.jsx("span",{children:"Valor:"}),s.jsx("span",{children:Me(R.totalValue)})]}),s.jsxs("div",{className:"stat-row",children:[s.jsx("span",{children:"Entradas:"}),s.jsx("span",{className:"positive",children:ce(R.totalEntries)})]}),s.jsxs("div",{className:"stat-row",children:[s.jsx("span",{children:"Salidas:"}),s.jsx("span",{className:"negative",children:ce(R.totalExits)})]}),R.lowStockCount>0&&s.jsxs("div",{className:"stat-row alert",children:[s.jsx("span",{children:"Stock Bajo:"}),s.jsx("span",{children:ce(R.lowStockCount)})]})]})]},T))})]}),s.jsxs("div",{className:"stats-top-products",children:[s.jsx("h3",{children:" Top Productos por Stock"}),s.jsx("div",{className:"top-products-list",children:p.sort((T,R)=>(R.currentStock||0)-(T.currentStock||0)).slice(0,5).map((T,R)=>s.jsxs("div",{className:"top-product-item",children:[s.jsxs("div",{className:"rank",children:["#",R+1]}),s.jsx("div",{className:"product-icon",style:{color:T.color},children:T.icon}),s.jsxs("div",{className:"product-info",children:[s.jsx("span",{className:"product-name",children:T.displayName}),s.jsxs("span",{className:"product-stock",children:[ce(T.currentStock||0)," ",T.unit]})]}),s.jsx("div",{className:"product-value",children:Me(T.totalValue)})]},T.id))})]}),A>0&&s.jsxs("div",{className:"stats-alerts",children:[s.jsx("h3",{children:" Alertas de Stock"}),s.jsx("div",{className:"alerts-list",children:p.filter(T=>T.stockStatus==="low"||T.stockStatus==="empty").map(T=>s.jsxs("div",{className:`alert-item ${T.stockStatus}`,children:[s.jsx("div",{className:"alert-icon",children:T.stockStatus==="empty"?"":""}),s.jsxs("div",{className:"alert-info",children:[s.jsx("span",{className:"alert-product",children:T.displayName}),s.jsxs("span",{className:"alert-stock",children:["Stock: ",ce(T.currentStock||0)," ",T.unit,T.stockStatus==="empty"&&" - SIN STOCK!",T.stockStatus==="low"&&` - Mnimo: ${T.minThreshold}`]})]})]},T.id))})]})]})},ZV=({userProfile:n})=>{const[e,t]=H.useState([]),[i,o]=H.useState(!0),[c,d]=H.useState(null),[f,p]=H.useState(!1),[g,y]=H.useState(null),[N,E]=H.useState("create"),[A,T]=H.useState(""),[R,b]=H.useState(""),[k,_]=H.useState(!0),j=["admin","supervisor"].includes(n?.role);H.useEffect(()=>{o(!0);const U=mV(I=>{t(I),o(!1),d(null)},I=>{console.error("Error loading products:",I),d("Error cargando productos"),o(!1)});return()=>U()},[]),H.useEffect(()=>{(async()=>{if(console.log(" Debug - Inicializando productos:",{productsLength:e.length,loading:i,canManageProducts:j}),e.length===0&&!i&&j)try{console.log(" Creando productos predefinidos...");const I=ZE();console.log(" Productos predefinidos:",I);for(const D of I)console.log(" Creando producto:",D.name),await og({name:D.name,displayName:D.displayName,category:D.category,unit:D.unit,defaultPrice:D.defaultPrice,color:D.color,icon:D.icon,description:D.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});console.log(" Productos predefinidos creados exitosamente")}catch(I){console.error(" Error inicializando productos:",I)}else console.log(" No se inicializan productos:",{reason:e.length>0?"Ya existen productos":i?"Est cargando":j?"Otra razn":"Sin permisos"})})()},[e.length,i,j]);const S=()=>{y(null),E("create"),p(!0)},O=U=>{y(U),E("edit"),p(!0)},B=U=>{y(U),E("view"),p(!0)},L=async U=>{if(window.confirm("Ests seguro de que deseas eliminar este producto?"))try{await hV(U)}catch(I){console.error("Error deleting product:",I),alert("Error al eliminar el producto")}},M=async U=>{try{N==="create"?await og(U):N==="edit"&&await dV(g.id,U),p(!1)}catch(I){throw console.error("Error saving product:",I),I}},V=e.filter(U=>{const I=U.displayName?.toLowerCase().includes(A.toLowerCase())||U.name?.toLowerCase().includes(A.toLowerCase()),D=!R||U.category===R;return I&&D});return i?s.jsx("div",{className:"products-main",children:s.jsxs("div",{className:"loading-container",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Cargando productos..."})]})}):c?s.jsx("div",{className:"products-main",children:s.jsxs("div",{className:"error-container",children:[s.jsxs("p",{children:[" ",c]}),s.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})}):s.jsxs("div",{className:"products-main",children:[s.jsxs("div",{className:"products-header",children:[s.jsxs("div",{className:"header-title",children:[s.jsx("h1",{children:" Gestin de Productos"}),s.jsx("p",{children:"Administra los tipos de combustibles y productos disponibles"})]}),j&&s.jsxs("div",{className:"header-actions",children:[s.jsx("button",{className:"btn-primary",onClick:S,children:" Agregar Producto"}),s.jsx("button",{className:"btn-secondary",onClick:async()=>{try{console.log(" Forzando creacin de productos predefinidos...");const U=ZE();for(const I of U)await og({name:I.name,displayName:I.displayName,category:I.category,unit:I.unit,defaultPrice:I.defaultPrice,color:I.color,icon:I.icon,description:I.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});alert("Productos predefinidos creados exitosamente")}catch(U){console.error("Error:",U),alert("Error creando productos: "+U.message)}},style:{marginLeft:"10px"},children:" Crear Predefinidos"})]})]}),k&&s.jsx(WV,{products:e}),s.jsxs("div",{className:"products-filters",children:[s.jsx("div",{className:"filter-group",children:s.jsx("input",{type:"text",placeholder:" Buscar productos...",value:A,onChange:U=>T(U.target.value),className:"search-input"})}),s.jsx("div",{className:"filter-group",children:s.jsxs("select",{value:R,onChange:U=>b(U.target.value),className:"filter-select",children:[s.jsx("option",{value:"",children:" Todas las categoras"}),Object.values(Ks).map(U=>s.jsx("option",{value:U,children:U},U))]})}),s.jsx("div",{className:"filter-group",children:s.jsx("button",{className:`toggle-btn ${k?"active":""}`,onClick:()=>_(!k),children:" Estadsticas"})})]}),s.jsx("div",{className:"products-grid",children:V.map(U=>s.jsxs("div",{className:"product-card",children:[s.jsx("div",{className:"product-icon",style:{color:U.color},children:U.icon}),s.jsxs("div",{className:"product-info",children:[s.jsx("h3",{children:U.displayName}),s.jsx("p",{className:"product-category",children:U.category}),s.jsx("p",{className:"product-description",children:U.description}),s.jsxs("div",{className:"product-stats",children:[s.jsxs("div",{className:"stat",children:[s.jsx("span",{className:"stat-label",children:"Stock:"}),s.jsxs("span",{className:"stat-value",children:[U.currentStock||0," ",U.unit]})]}),s.jsxs("div",{className:"stat",children:[s.jsx("span",{className:"stat-label",children:"Precio:"}),s.jsxs("span",{className:"stat-value",children:["$",new Intl.NumberFormat("es-CO").format(U.defaultPrice||0)]})]})]}),s.jsx("div",{className:`product-status ${U.isActive?"active":"inactive"}`,children:U.isActive?" Activo":" Inactivo"})]}),s.jsxs("div",{className:"product-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>B(U),children:" Ver"}),j&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"btn-primary",onClick:()=>O(U),children:" Editar"}),s.jsx("button",{className:"btn-danger",onClick:()=>L(U.id),children:" Eliminar"})]})]})]},U.id))}),V.length===0&&s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:""}),s.jsx("h3",{children:"No hay productos"}),s.jsx("p",{children:A||R?"No se encontraron productos con los filtros aplicados.":"An no hay productos registrados."}),j&&!A&&!R&&s.jsx("button",{className:"btn-primary",onClick:S,children:" Crear primer producto"})]}),s.jsx(XV,{isOpen:f,onClose:()=>p(!1),product:g,mode:N,onSave:M,userRole:n?.role})]})},JV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:i,hasDeletePermission:o})=>{const[c,d]=H.useState("name"),[f,p]=H.useState("asc"),g=k=>{c===k?p(f==="asc"?"desc":"asc"):(d(k),p("asc"))},y=[...n].sort((k,_)=>{let j=k[c],S=_[c];switch(c){case"rating":j=j||0,S=S||0;break;case"totalOrders":case"totalPurchased":j=j||0,S=S||0;break;case"createdAt":case"lastOrderDate":j=j?j.toDate?j.toDate():new Date(j):new Date(0),S=S?S.toDate?S.toDate():new Date(S):new Date(0);break;default:j=(j||"").toString().toLowerCase(),S=(S||"").toString().toLowerCase()}return j<S?f==="asc"?-1:1:j>S?f==="asc"?1:-1:0}),N=k=>{switch(k){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},E=k=>{switch(k){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},A=k=>k?(k.toDate?k.toDate():new Date(k)).toLocaleDateString("es-CO"):"-",T=k=>{const _=[];for(let j=1;j<=5;j++)_.push(s.jsx("span",{className:`star ${j<=k?"filled":""}`,children:""},j));return s.jsx("div",{className:"rating-stars",children:_})},R=k=>!k||k.length===0?s.jsx("span",{className:"no-data",children:"-"}):s.jsxs("div",{className:"fuel-types-cell",children:[k.slice(0,2).map(_=>s.jsx("span",{className:"fuel-badge-sm",children:Nn[_]||_},_)),k.length>2&&s.jsxs("span",{className:"fuel-badge-sm more",title:k.slice(2).map(_=>Nn[_]||_).join(", "),children:["+",k.length-2]})]}),b=k=>c!==k?"icon-chevrons-up-down":f==="asc"?"icon-chevron-up":"icon-chevron-down";return s.jsxs("div",{className:"suppliers-table-container",children:[s.jsxs("div",{className:"table-wrapper",children:[s.jsxs("table",{className:"suppliers-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsxs("th",{className:`sortable ${c==="name"?"active":""}`,onClick:()=>g("name"),children:[s.jsx("span",{children:"Proveedor"}),s.jsx("i",{className:b("name")})]}),s.jsxs("th",{className:`sortable ${c==="status"?"active":""}`,onClick:()=>g("status"),children:[s.jsx("span",{children:"Estado"}),s.jsx("i",{className:b("status")})]}),s.jsxs("th",{className:`sortable ${c==="category"?"active":""}`,onClick:()=>g("category"),children:[s.jsx("span",{children:"Categora"}),s.jsx("i",{className:b("category")})]}),s.jsx("th",{children:s.jsx("span",{children:"Combustibles"})}),s.jsx("th",{children:s.jsx("span",{children:"Contacto"})}),s.jsxs("th",{className:`sortable ${c==="rating"?"active":""}`,onClick:()=>g("rating"),children:[s.jsx("span",{children:"Rating"}),s.jsx("i",{className:b("rating")})]}),s.jsxs("th",{className:`sortable ${c==="totalOrders"?"active":""}`,onClick:()=>g("totalOrders"),children:[s.jsx("span",{children:"rdenes"}),s.jsx("i",{className:b("totalOrders")})]}),s.jsxs("th",{className:`sortable ${c==="totalPurchased"?"active":""}`,onClick:()=>g("totalPurchased"),children:[s.jsx("span",{children:"Total Comprado"}),s.jsx("i",{className:b("totalPurchased")})]}),s.jsxs("th",{className:`sortable ${c==="createdAt"?"active":""}`,onClick:()=>g("createdAt"),children:[s.jsx("span",{children:"Creado"}),s.jsx("i",{className:b("createdAt")})]}),s.jsx("th",{className:"actions-column",children:s.jsx("span",{children:"Acciones"})})]})}),s.jsx("tbody",{children:y.map(k=>s.jsxs("tr",{className:`supplier-row ${k.status}`,children:[s.jsx("td",{className:"supplier-info-cell",children:s.jsxs("div",{className:"supplier-main-info",children:[s.jsxs("div",{className:"supplier-name",children:[k.name,k.isPreferred&&s.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:s.jsx("i",{className:"icon-star"})})]}),k.taxId&&s.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",k.taxId]}),k.type&&s.jsx("div",{className:"supplier-type",children:k.type.charAt(0).toUpperCase()+k.type.slice(1)})]})}),s.jsx("td",{className:"status-cell",children:s.jsxs("div",{className:"status-display",children:[s.jsx("span",{className:"status-dot",style:{backgroundColor:N(k.status)}}),s.jsx("span",{className:"status-label",children:E(k.status)})]})}),s.jsx("td",{className:"category-cell",children:s.jsx("span",{className:"category-label",children:k.category?.charAt(0).toUpperCase()+k.category?.slice(1)||"-"})}),s.jsx("td",{className:"fuel-types-cell",children:R(k.fuelTypes)}),s.jsx("td",{className:"contact-cell",children:s.jsxs("div",{className:"contact-info",children:[k.contactPerson&&s.jsxs("div",{className:"contact-person",children:[s.jsx("i",{className:"icon-user"}),s.jsx("span",{children:k.contactPerson})]}),k.phone&&s.jsxs("div",{className:"contact-item",children:[s.jsx("i",{className:"icon-phone"}),s.jsx("a",{href:`tel:${k.phone}`,children:k.phone})]}),k.email&&s.jsxs("div",{className:"contact-item",children:[s.jsx("i",{className:"icon-mail"}),s.jsx("a",{href:`mailto:${k.email}`,children:k.email})]}),k.city&&s.jsxs("div",{className:"contact-item",children:[s.jsx("i",{className:"icon-map-pin"}),s.jsx("span",{children:k.city})]})]})}),s.jsx("td",{className:"rating-cell",children:s.jsxs("div",{className:"rating-display",children:[T(k.rating||0),s.jsx("span",{className:"rating-value",children:(k.rating||0).toFixed(1)})]})}),s.jsx("td",{className:"orders-cell",children:s.jsx("span",{className:"orders-count",children:k.totalOrders||0})}),s.jsx("td",{className:"purchased-cell",children:s.jsx("span",{className:"purchased-amount",children:Me(k.totalPurchased||0)})}),s.jsx("td",{className:"date-cell",children:s.jsx("span",{className:"date-value",children:A(k.createdAt)})}),s.jsx("td",{className:"actions-cell",children:s.jsxs("div",{className:"action-buttons",children:[i&&s.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(k),title:"Editar proveedor",children:s.jsx("i",{className:"icon-edit"})}),o&&k.status==="active"&&s.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(k.id,k.name),title:"Desactivar proveedor",children:s.jsx("i",{className:"icon-x-circle"})}),s.jsxs("div",{className:"quick-actions",children:[k.phone&&s.jsx("a",{href:`tel:${k.phone}`,className:"quick-action-btn",title:"Llamar",children:s.jsx("i",{className:"icon-phone"})}),k.email&&s.jsx("a",{href:`mailto:${k.email}`,className:"quick-action-btn",title:"Enviar email",children:s.jsx("i",{className:"icon-mail"})})]})]})})]},k.id))})]}),y.length===0&&s.jsxs("div",{className:"table-empty-state",children:[s.jsx("i",{className:"icon-truck"}),s.jsx("p",{children:"No hay proveedores para mostrar"})]})]}),s.jsxs("div",{className:"table-footer",children:[s.jsx("div",{className:"table-info",children:s.jsxs("span",{children:["Mostrando ",y.length," proveedor",y.length!==1?"es":""]})}),s.jsx("div",{className:"table-actions",children:s.jsxs("span",{className:"sort-info",children:["Ordenado por: ",c==="name"?"Nombre":c==="status"?"Estado":c==="category"?"Categora":c==="rating"?"Rating":c==="totalOrders"?"rdenes":c==="totalPurchased"?"Total Comprado":c==="createdAt"?"Fecha de Creacin":c," (",f==="asc"?"Ascendente":"Descendente",")"]})})]})]})},eU=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:i,hasDeletePermission:o})=>{const c=A=>{switch(A){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},d=A=>{switch(A){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},f=A=>{switch(A){case"combustibles":return"";case"lubricantes":return"";case"aditivos":return"";default:return""}},p=A=>{switch(A){case"proveedor":return"Proveedor";case"distribuidor":return"Distribuidor";case"mayorista":return"Mayorista";default:return"Sin especificar"}},g=A=>A?(A.toDate?A.toDate():new Date(A)).toLocaleDateString("es-CO"):"No disponible",y=A=>{const T=[];for(let R=1;R<=5;R++)T.push(s.jsx("span",{className:`star ${R<=A?"filled":""}`,children:""},R));return s.jsx("div",{className:"rating-stars",children:T})},N=A=>!A||A.length===0?s.jsx("span",{className:"no-fuels",children:"Sin combustibles especificados"}):s.jsxs("div",{className:"fuel-types",children:[A.slice(0,3).map(T=>s.jsx("span",{className:"fuel-badge",title:Nn[T],children:Nn[T]||T},T)),A.length>3&&s.jsxs("span",{className:"fuel-badge more",title:`+${A.length-3} ms`,children:["+",A.length-3]})]}),E=A=>{const T=[];return A.phone&&T.push(s.jsxs("div",{className:"contact-item",children:[s.jsx("i",{className:"icon-phone"}),s.jsx("span",{children:A.phone})]},"phone")),A.email&&T.push(s.jsxs("div",{className:"contact-item",children:[s.jsx("i",{className:"icon-mail"}),s.jsx("span",{children:A.email})]},"email")),A.city&&T.push(s.jsxs("div",{className:"contact-item",children:[s.jsx("i",{className:"icon-map-pin"}),s.jsx("span",{children:A.city})]},"city")),T.length>0?T:s.jsxs("div",{className:"contact-item no-contact",children:[s.jsx("i",{className:"icon-info-circle"}),s.jsx("span",{children:"Sin informacin de contacto"})]})};return s.jsx("div",{className:"suppliers-cards",children:n.map(A=>s.jsxs("div",{className:`supplier-card ${A.status}`,children:[s.jsxs("div",{className:"card-header",children:[s.jsx("div",{className:"header-left",children:s.jsxs("div",{className:"supplier-info",children:[s.jsxs("h3",{className:"supplier-name",children:[A.name,A.isPreferred&&s.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:s.jsx("i",{className:"icon-star"})})]}),A.taxId&&s.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",A.taxId]})]})}),s.jsx("div",{className:"header-right",children:s.jsxs("div",{className:"supplier-status",children:[s.jsx("span",{className:"status-dot",style:{backgroundColor:c(A.status)}}),s.jsx("span",{className:"status-label",children:d(A.status)})]})})]}),s.jsxs("div",{className:"card-content",children:[s.jsxs("div",{className:"supplier-meta",children:[s.jsxs("div",{className:"meta-item",children:[s.jsx("span",{className:"meta-icon",children:f(A.category)}),s.jsx("span",{className:"meta-label",children:A.category?.charAt(0).toUpperCase()+A.category?.slice(1)||"Sin categora"})]}),s.jsxs("div",{className:"meta-item",children:[s.jsx("i",{className:"icon-building meta-icon"}),s.jsx("span",{className:"meta-label",children:p(A.type)})]})]}),A.contactPerson&&s.jsxs("div",{className:"contact-person",children:[s.jsx("i",{className:"icon-user"}),s.jsx("span",{children:A.contactPerson})]}),s.jsx("div",{className:"contact-info",children:E(A)}),s.jsxs("div",{className:"fuel-types-section",children:[s.jsx("div",{className:"section-label",children:"Combustibles Suministrados:"}),N(A.fuelTypes)]}),s.jsxs("div",{className:"rating-section",children:[s.jsxs("div",{className:"rating-display",children:[y(A.rating||0),s.jsxs("span",{className:"rating-value",children:[(A.rating||0).toFixed(1),"/5"]})]}),A.evaluationNotes&&s.jsxs("div",{className:"evaluation-notes",title:A.evaluationNotes,children:[s.jsx("i",{className:"icon-message-square"}),s.jsx("span",{children:"Con evaluacin"})]})]}),A.paymentTerms&&s.jsxs("div",{className:"payment-terms",children:[s.jsx("i",{className:"icon-credit-card"}),s.jsxs("span",{children:["Trminos: ",A.paymentTerms==="contado"?"Contado":A.paymentTerms==="30dias"?"30 das":A.paymentTerms==="60dias"?"60 das":A.paymentTerms==="90dias"?"90 das":A.paymentTerms]})]}),s.jsxs("div",{className:"supplier-stats",children:[s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"stat-label",children:"rdenes:"}),s.jsx("span",{className:"stat-value",children:A.totalOrders||0})]}),s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"stat-label",children:"Total Comprado:"}),s.jsx("span",{className:"stat-value",children:Me(A.totalPurchased||0)})]}),A.lastOrderDate&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"stat-label",children:"ltima Orden:"}),s.jsx("span",{className:"stat-value",children:g(A.lastOrderDate)})]})]})]}),s.jsxs("div",{className:"card-footer",children:[s.jsx("div",{className:"footer-info",children:s.jsxs("span",{className:"created-date",children:["Creado: ",g(A.createdAt)]})}),s.jsxs("div",{className:"card-actions",children:[i&&s.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(A),title:"Editar proveedor",children:[s.jsx("i",{className:"icon-edit"}),"Editar"]}),o&&A.status==="active"&&s.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>t(A.id,A.name),title:"Desactivar proveedor",children:[s.jsx("i",{className:"icon-x-circle"}),"Desactivar"]}),s.jsxs("div",{className:"quick-actions",children:[A.phone&&s.jsx("a",{href:`tel:${A.phone}`,className:"quick-action-btn",title:"Llamar",children:s.jsx("i",{className:"icon-phone"})}),A.email&&s.jsx("a",{href:`mailto:${A.email}`,className:"quick-action-btn",title:"Enviar email",children:s.jsx("i",{className:"icon-mail"})})]})]})]})]},A.id))})},tU=({supplier:n,onClose:e,onSuccess:t,onError:i})=>{const{userProfile:o}=Zn(),c=!!n,[d,f]=H.useState({name:"",taxId:"",type:"proveedor",category:"combustibles",contactPerson:"",phone:"",email:"",address:"",city:"",state:"Colombia",fuelTypes:[],paymentTerms:"contado",creditLimit:"",priceList:{},rating:5,evaluationNotes:"",status:"active",isPreferred:!1}),[p,g]=H.useState(!1),[y,N]=H.useState({}),[E,A]=H.useState("basic");H.useEffect(()=>{c&&n&&f({name:n.name||"",taxId:n.taxId||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson||"",phone:n.phone||"",email:n.email||"",address:n.address||"",city:n.city||"",state:n.state||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:n.creditLimit||"",priceList:n.priceList||{},rating:n.rating||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1})},[c,n]);const T=(S,O)=>{f(B=>({...B,[S]:O})),y[S]&&N(B=>({...B,[S]:null}))},R=S=>{f(O=>({...O,fuelTypes:O.fuelTypes.includes(S)?O.fuelTypes.filter(B=>B!==S):[...O.fuelTypes,S]}))},b=(S,O)=>{f(B=>({...B,priceList:{...B.priceList,[S]:parseFloat(O)||0}}))},k=()=>{const S={};return d.name.trim()||(S.name="El nombre del proveedor es requerido"),d.category||(S.category="La categora es requerida"),d.type||(S.type="El tipo de proveedor es requerido"),d.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)&&(S.email="El formato del email no es vlido"),d.phone&&!/^[\d\s\-+()]+$/.test(d.phone)&&(S.phone="El formato del telfono no es vlido"),d.creditLimit&&(isNaN(d.creditLimit)||parseFloat(d.creditLimit)<0)&&(S.creditLimit="El lmite de crdito debe ser un nmero positivo"),(d.rating<1||d.rating>5)&&(S.rating="El rating debe estar entre 1 y 5"),d.fuelTypes.forEach(O=>{d.priceList[O]&&(isNaN(d.priceList[O])||parseFloat(d.priceList[O])<0)&&(S[`price_${O}`]=`El precio de ${Nn[O]} debe ser un nmero positivo`)}),N(S),Object.keys(S).length===0},_=async S=>{if(S.preventDefault(),!!k()){g(!0);try{const O={...d,creditLimit:parseFloat(d.creditLimit)||0,rating:parseFloat(d.rating)||5,priceList:Object.fromEntries(Object.entries(d.priceList).filter(([L,M])=>d.fuelTypes.includes(L)&&M>0))};let B;c?B=await Y2(n.id,O,o?.email):B=await G2(O,o?.email),B.success?t():i(B.error||"Error al guardar proveedor")}catch(O){console.error("Error saving supplier:",O),i("Error inesperado al guardar proveedor")}finally{g(!1)}}},j=[{id:"basic",label:"Informacin Bsica",icon:"icon-info"},{id:"contact",label:"Contacto",icon:"icon-phone"},{id:"products",label:"Productos",icon:"icon-package"},{id:"commercial",label:"Comercial",icon:"icon-credit-card"}];return s.jsx("div",{className:"modal-overlay",onClick:e,children:s.jsxs("div",{className:"modal-container large",onClick:S=>S.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h2",{children:[s.jsx("i",{className:"icon-truck"}),c?"Editar Proveedor":"Nuevo Proveedor"]}),s.jsx("button",{className:"modal-close",onClick:e,children:s.jsx("i",{className:"icon-x"})})]}),s.jsxs("form",{onSubmit:_,children:[s.jsx("div",{className:"modal-tabs",children:j.map(S=>s.jsxs("button",{type:"button",className:`tab-button ${E===S.id?"active":""}`,onClick:()=>A(S.id),children:[s.jsx("i",{className:S.icon}),S.label]},S.id))}),s.jsxs("div",{className:"modal-body",children:[E==="basic"&&s.jsx("div",{className:"tab-content",children:s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"required",children:"Nombre del Proveedor"}),s.jsx("input",{type:"text",value:d.name,onChange:S=>T("name",S.target.value),placeholder:"Ingresa el nombre del proveedor",className:y.name?"error":""}),y.name&&s.jsx("span",{className:"error-message",children:y.name})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"NIT / Documento"}),s.jsx("input",{type:"text",value:d.taxId,onChange:S=>T("taxId",S.target.value),placeholder:"123456789-0",className:y.taxId?"error":""}),y.taxId&&s.jsx("span",{className:"error-message",children:y.taxId})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"required",children:"Tipo de Proveedor"}),s.jsxs("select",{value:d.type,onChange:S=>T("type",S.target.value),className:y.type?"error":"",children:[s.jsx("option",{value:"proveedor",children:"Proveedor"}),s.jsx("option",{value:"distribuidor",children:"Distribuidor"}),s.jsx("option",{value:"mayorista",children:"Mayorista"})]}),y.type&&s.jsx("span",{className:"error-message",children:y.type})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"required",children:"Categora"}),s.jsxs("select",{value:d.category,onChange:S=>T("category",S.target.value),className:y.category?"error":"",children:[s.jsx("option",{value:"combustibles",children:"Combustibles"}),s.jsx("option",{value:"lubricantes",children:"Lubricantes"}),s.jsx("option",{value:"aditivos",children:"Aditivos"})]}),y.category&&s.jsx("span",{className:"error-message",children:y.category})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Estado"}),s.jsxs("select",{value:d.status,onChange:S=>T("status",S.target.value),children:[s.jsx("option",{value:"active",children:"Activo"}),s.jsx("option",{value:"inactive",children:"Inactivo"}),s.jsx("option",{value:"suspended",children:"Suspendido"})]})]}),s.jsx("div",{className:"form-group checkbox",children:s.jsxs("label",{className:"checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:d.isPreferred,onChange:S=>T("isPreferred",S.target.checked)}),s.jsx("span",{className:"checkbox-mark"}),"Proveedor Preferido"]})})]})}),E==="contact"&&s.jsx("div",{className:"tab-content",children:s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Persona de Contacto"}),s.jsx("input",{type:"text",value:d.contactPerson,onChange:S=>T("contactPerson",S.target.value),placeholder:"Nombre del contacto principal"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Telfono"}),s.jsx("input",{type:"tel",value:d.phone,onChange:S=>T("phone",S.target.value),placeholder:"+57 300 123 4567",className:y.phone?"error":""}),y.phone&&s.jsx("span",{className:"error-message",children:y.phone})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Email"}),s.jsx("input",{type:"email",value:d.email,onChange:S=>T("email",S.target.value),placeholder:"contacto@proveedor.com",className:y.email?"error":""}),y.email&&s.jsx("span",{className:"error-message",children:y.email})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Ciudad"}),s.jsx("input",{type:"text",value:d.city,onChange:S=>T("city",S.target.value),placeholder:"Bogot"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Estado/Pas"}),s.jsx("input",{type:"text",value:d.state,onChange:S=>T("state",S.target.value),placeholder:"Colombia"})]}),s.jsxs("div",{className:"form-group full-width",children:[s.jsx("label",{children:"Direccin"}),s.jsx("textarea",{value:d.address,onChange:S=>T("address",S.target.value),placeholder:"Direccin completa del proveedor",rows:"3"})]})]})}),E==="products"&&s.jsxs("div",{className:"tab-content",children:[s.jsxs("div",{className:"section",children:[s.jsx("h3",{children:"Tipos de Combustible que Suministra"}),s.jsx("div",{className:"fuel-types-grid",children:Object.entries(Nn).map(([S,O])=>s.jsx("div",{className:"fuel-type-item",children:s.jsxs("label",{className:"checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:d.fuelTypes.includes(S),onChange:()=>R(S)}),s.jsx("span",{className:"checkbox-mark"}),O]})},S))})]}),d.fuelTypes.length>0&&s.jsxs("div",{className:"section",children:[s.jsx("h3",{children:"Precios por Litro (Opcional)"}),s.jsx("div",{className:"prices-grid",children:d.fuelTypes.map(S=>s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:Nn[S]}),s.jsxs("div",{className:"input-with-currency",children:[s.jsx("span",{className:"currency-symbol",children:"$"}),s.jsx("input",{type:"number",step:"0.01",min:"0",value:d.priceList[S]||"",onChange:O=>b(S,O.target.value),placeholder:"0.00",className:y[`price_${S}`]?"error":""})]}),y[`price_${S}`]&&s.jsx("span",{className:"error-message",children:y[`price_${S}`]})]},S))})]})]}),E==="commercial"&&s.jsx("div",{className:"tab-content",children:s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Trminos de Pago"}),s.jsxs("select",{value:d.paymentTerms,onChange:S=>T("paymentTerms",S.target.value),children:[s.jsx("option",{value:"contado",children:"Contado"}),s.jsx("option",{value:"30dias",children:"30 das"}),s.jsx("option",{value:"60dias",children:"60 das"}),s.jsx("option",{value:"90dias",children:"90 das"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Lmite de Crdito"}),s.jsxs("div",{className:"input-with-currency",children:[s.jsx("span",{className:"currency-symbol",children:"$"}),s.jsx("input",{type:"number",step:"0.01",min:"0",value:d.creditLimit,onChange:S=>T("creditLimit",S.target.value),placeholder:"0.00",className:y.creditLimit?"error":""})]}),y.creditLimit&&s.jsx("span",{className:"error-message",children:y.creditLimit})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Rating"}),s.jsxs("div",{className:"rating-input",children:[s.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:d.rating,onChange:S=>T("rating",parseFloat(S.target.value)),className:y.rating?"error":""}),s.jsxs("div",{className:"rating-display",children:[s.jsx("span",{className:"rating-value",children:d.rating.toFixed(1)}),s.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(S=>s.jsx("span",{className:`star ${S<=Math.round(d.rating)?"filled":""}`,children:""},S))})]})]}),y.rating&&s.jsx("span",{className:"error-message",children:y.rating})]}),s.jsxs("div",{className:"form-group full-width",children:[s.jsx("label",{children:"Notas de Evaluacin"}),s.jsx("textarea",{value:d.evaluationNotes,onChange:S=>T("evaluationNotes",S.target.value),placeholder:"Comentarios sobre el desempeo del proveedor...",rows:"4"})]})]})})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:p,children:"Cancelar"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"loading-spinner small"}),c?"Actualizando...":"Creando..."]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"icon-save"}),c?"Actualizar Proveedor":"Crear Proveedor"]})})]})]})]})})},nU=({stats:n,suppliersCount:e,totalSuppliers:t})=>{if(!n)return null;const i=d=>{switch(d){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case"combustibles":return"";case"lubricantes":return"";case"aditivos":return"";default:return""}},c=d=>{switch(d){case"proveedor":return"";case"distribuidor":return"";case"mayorista":return"";default:return""}};return s.jsxs("div",{className:"suppliers-stats",children:[s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card primary",children:[s.jsx("div",{className:"stat-icon",children:s.jsx("i",{className:"icon-truck"})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:ce(n.total)}),s.jsx("div",{className:"stat-label",children:"Total Proveedores"}),t!==e&&s.jsxs("div",{className:"stat-sublabel",children:[ce(e)," mostrados"]})]})]}),s.jsxs("div",{className:"stat-card success",children:[s.jsx("div",{className:"stat-icon",children:s.jsx("i",{className:"icon-check-circle"})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:ce(n.active)}),s.jsx("div",{className:"stat-label",children:"Activos"}),s.jsx("div",{className:"stat-sublabel",children:Cn(n.total>0?n.active/n.total:0)})]})]}),s.jsxs("div",{className:"stat-card warning",children:[s.jsx("div",{className:"stat-icon",children:s.jsx("i",{className:"icon-star"})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:ce(n.preferred)}),s.jsx("div",{className:"stat-label",children:"Preferidos"}),s.jsx("div",{className:"stat-sublabel",children:Cn(n.active>0?n.preferred/n.active:0)})]})]}),s.jsxs("div",{className:"stat-card info",children:[s.jsx("div",{className:"stat-icon",children:s.jsx("i",{className:"icon-award"})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:n.averageRating.toFixed(1)}),s.jsx("div",{className:"stat-label",children:"Rating Promedio"}),s.jsx("div",{className:"stat-sublabel",children:s.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(d=>s.jsx("span",{className:`star ${d<=Math.round(n.averageRating)?"filled":""}`,children:""},d))})})]})]})]}),s.jsxs("div",{className:"stats-details",children:[s.jsxs("div",{className:"stats-section",children:[s.jsx("h3",{children:"Estado de Proveedores"}),s.jsxs("div",{className:"stats-breakdown",children:[s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-label",children:[s.jsx("span",{className:"status-dot",style:{backgroundColor:i("active")}}),"Activos"]}),s.jsx("div",{className:"breakdown-value",children:n.active}),s.jsx("div",{className:"breakdown-percentage",children:Cn(n.total>0?n.active/n.total:0)})]}),n.inactive>0&&s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-label",children:[s.jsx("span",{className:"status-dot",style:{backgroundColor:i("inactive")}}),"Inactivos"]}),s.jsx("div",{className:"breakdown-value",children:n.inactive}),s.jsx("div",{className:"breakdown-percentage",children:Cn(n.total>0?n.inactive/n.total:0)})]}),n.suspended>0&&s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-label",children:[s.jsx("span",{className:"status-dot",style:{backgroundColor:i("suspended")}}),"Suspendidos"]}),s.jsx("div",{className:"breakdown-value",children:n.suspended}),s.jsx("div",{className:"breakdown-percentage",children:Cn(n.total>0?n.suspended/n.total:0)})]})]})]}),Object.keys(n.byCategory).length>0&&s.jsxs("div",{className:"stats-section",children:[s.jsx("h3",{children:"Por Categora"}),s.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byCategory).sort(([,d],[,f])=>f-d).map(([d,f])=>s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-label",children:[s.jsx("span",{className:"category-icon",children:o(d)}),d.charAt(0).toUpperCase()+d.slice(1).replace("_"," ")]}),s.jsx("div",{className:"breakdown-value",children:f}),s.jsx("div",{className:"breakdown-percentage",children:Cn(n.total>0?f/n.total:0)})]},d))})]}),Object.keys(n.byType).length>0&&s.jsxs("div",{className:"stats-section",children:[s.jsx("h3",{children:"Por Tipo"}),s.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byType).sort(([,d],[,f])=>f-d).map(([d,f])=>s.jsxs("div",{className:"breakdown-item",children:[s.jsxs("div",{className:"breakdown-label",children:[s.jsx("span",{className:"type-icon",children:c(d)}),d.charAt(0).toUpperCase()+d.slice(1)]}),s.jsx("div",{className:"breakdown-value",children:f}),s.jsx("div",{className:"breakdown-percentage",children:Cn(n.total>0?f/n.total:0)})]},d))})]})]}),s.jsxs("div",{className:"stats-insights",children:[s.jsx("h3",{children:"Informacin Rpida"}),s.jsxs("div",{className:"insights-grid",children:[s.jsxs("div",{className:"insight-item",children:[s.jsx("div",{className:"insight-label",children:"Nivel de Satisfaccin"}),s.jsx("div",{className:"insight-value",children:n.averageRating>=4.5?"Excelente":n.averageRating>=4?"Muy Bueno":n.averageRating>=3.5?"Bueno":n.averageRating>=3?"Regular":"Necesita Mejora"})]}),s.jsxs("div",{className:"insight-item",children:[s.jsx("div",{className:"insight-label",children:"Estado General"}),s.jsx("div",{className:"insight-value",children:n.active/n.total>=.9?"Excelente":n.active/n.total>=.8?"Bueno":n.active/n.total>=.7?"Regular":"Revisar"})]}),s.jsxs("div",{className:"insight-item",children:[s.jsx("div",{className:"insight-label",children:"Proveedores Preferidos"}),s.jsx("div",{className:"insight-value",children:n.preferred===0?"Ninguno":n.preferred/n.active>=.3?"Suficientes":n.preferred/n.active>=.2?"Buenos":"Pocos"})]}),s.jsxs("div",{className:"insight-item",children:[s.jsx("div",{className:"insight-label",children:"Diversificacin"}),s.jsx("div",{className:"insight-value",children:Object.keys(n.byCategory).length>=3?"Alta":Object.keys(n.byCategory).length>=2?"Media":"Baja"})]})]})]})]})},sU=({searchTerm:n,setSearchTerm:e,filterStatus:t,setFilterStatus:i,filterCategory:o,setFilterCategory:c,filterFuelType:d,setFilterFuelType:f,viewMode:p,setViewMode:g,onClearFilters:y,resultsCount:N})=>{const E=[{value:"all",label:"Todos los Estados",icon:"list"},{value:"active",label:"Activos",icon:"check-circle"},{value:"inactive",label:"Inactivos",icon:"x-circle"},{value:"suspended",label:"Suspendidos",icon:"alert-circle"},{value:"preferred",label:"Preferidos",icon:"star"}],A=[{value:"all",label:"Todas las Categoras",icon:"grid"},{value:"combustibles",label:"Combustibles",icon:"fuel"},{value:"lubricantes",label:"Lubricantes",icon:"droplets"},{value:"aditivos",label:"Aditivos",icon:"flask"}],T=[{value:"all",label:"Todos los Combustibles",icon:"fuel"},...Object.entries(Nn).map(([b,k])=>({value:b,label:k,icon:"droplet"}))],R=n||t!=="all"||o!=="all"||d!=="all";return s.jsxs("div",{className:"suppliers-filters",children:[s.jsxs("div",{className:"filters-top",children:[s.jsx("div",{className:"search-container",children:s.jsxs("div",{className:"search-input-wrapper",children:[s.jsx("i",{className:"icon-search search-icon"}),s.jsx("input",{type:"text",placeholder:"Buscar por nombre, NIT, contacto, ciudad...",value:n,onChange:b=>e(b.target.value),className:"search-input"}),n&&s.jsx("button",{className:"search-clear",onClick:()=>e(""),title:"Limpiar bsqueda",children:s.jsx("i",{className:"icon-x"})})]})}),s.jsxs("div",{className:"view-controls",children:[s.jsxs("div",{className:"view-mode-toggle",children:[s.jsx("button",{className:`view-btn ${p==="cards"?"active":""}`,onClick:()=>g("cards"),title:"Vista de tarjetas",children:s.jsx("i",{className:"icon-grid"})}),s.jsx("button",{className:`view-btn ${p==="table"?"active":""}`,onClick:()=>g("table"),title:"Vista de tabla",children:s.jsx("i",{className:"icon-list"})})]}),R&&s.jsxs("button",{className:"btn btn-secondary clear-filters",onClick:y,title:"Limpiar todos los filtros",children:[s.jsx("i",{className:"icon-filter-x"}),"Limpiar"]})]})]}),s.jsxs("div",{className:"filters-dropdowns",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Estado"}),s.jsxs("div",{className:"select-wrapper",children:[s.jsx("select",{value:t,onChange:b=>i(b.target.value),className:"filter-select",children:E.map(b=>s.jsx("option",{value:b.value,children:b.label},b.value))}),s.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Categora"}),s.jsxs("div",{className:"select-wrapper",children:[s.jsx("select",{value:o,onChange:b=>c(b.target.value),className:"filter-select",children:A.map(b=>s.jsx("option",{value:b.value,children:b.label},b.value))}),s.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),s.jsxs("div",{className:"select-wrapper",children:[s.jsx("select",{value:d,onChange:b=>f(b.target.value),className:"filter-select",children:T.map(b=>s.jsx("option",{value:b.value,children:b.label},b.value))}),s.jsx("i",{className:"icon-chevron-down select-arrow"})]})]})]}),s.jsxs("div",{className:"filters-summary",children:[s.jsxs("div",{className:"results-count",children:[s.jsx("i",{className:"icon-info-circle"}),s.jsx("span",{children:N===0?"No se encontraron proveedores":`Mostrando ${N} proveedor${N!==1?"es":""}`})]}),R&&s.jsxs("div",{className:"active-filters",children:[s.jsx("span",{className:"filters-label",children:"Filtros activos:"}),s.jsxs("div",{className:"filter-tags",children:[n&&s.jsxs("span",{className:"filter-tag",children:[s.jsx("i",{className:"icon-search"}),n,s.jsx("button",{onClick:()=>e(""),children:s.jsx("i",{className:"icon-x"})})]}),t!=="all"&&s.jsxs("span",{className:"filter-tag",children:[s.jsx("i",{className:"icon-filter"}),E.find(b=>b.value===t)?.label,s.jsx("button",{onClick:()=>i("all"),children:s.jsx("i",{className:"icon-x"})})]}),o!=="all"&&s.jsxs("span",{className:"filter-tag",children:[s.jsx("i",{className:"icon-tag"}),A.find(b=>b.value===o)?.label,s.jsx("button",{onClick:()=>c("all"),children:s.jsx("i",{className:"icon-x"})})]}),d!=="all"&&s.jsxs("span",{className:"filter-tag",children:[s.jsx("i",{className:"icon-droplet"}),T.find(b=>b.value===d)?.label,s.jsx("button",{onClick:()=>f("all"),children:s.jsx("i",{className:"icon-x"})})]})]})]})]}),s.jsxs("div",{className:"quick-filters",children:[s.jsx("span",{className:"quick-filters-label",children:"Acceso rpido:"}),s.jsxs("div",{className:"quick-filter-buttons",children:[s.jsxs("button",{className:`quick-filter-btn ${t==="preferred"?"active":""}`,onClick:()=>i(t==="preferred"?"all":"preferred"),children:[s.jsx("i",{className:"icon-star"}),"Preferidos"]}),s.jsxs("button",{className:`quick-filter-btn ${t==="active"?"active":""}`,onClick:()=>i(t==="active"?"all":"active"),children:[s.jsx("i",{className:"icon-check-circle"}),"Activos"]}),s.jsxs("button",{className:`quick-filter-btn ${o==="combustibles"?"active":""}`,onClick:()=>c(o==="combustibles"?"all":"combustibles"),children:[s.jsx("i",{className:"icon-fuel"}),"Combustibles"]}),s.jsxs("button",{className:`quick-filter-btn ${d==="diesel"?"active":""}`,onClick:()=>f(d==="diesel"?"all":"diesel"),children:[s.jsx("i",{className:"icon-droplet"}),"Disel"]})]})]})]})},aU=()=>{const{hasPermission:n,userProfile:e}=Zn(),[t,i]=H.useState([]),[o,c]=H.useState(null),[d,f]=H.useState(!0),[p,g]=H.useState(null),[y,N]=H.useState("cards"),[E,A]=H.useState(!1),[T,R]=H.useState(null),[b,k]=H.useState("all"),[_,j]=H.useState("all"),[S,O]=H.useState("all"),[B,L]=H.useState("");H.useEffect(()=>{let Y=null;return(()=>{Y=tC(ee=>{i(ee||[]),f(!1)})})(),()=>{Y&&Y()}},[]),H.useEffect(()=>{const Y=async()=>{const ie=await K2();ie.success&&c(ie.data)};t.length>0&&Y()},[t]);const M=t.filter(Y=>{const ie=!B||Y.name?.toLowerCase().includes(B.toLowerCase())||Y.taxId?.toLowerCase().includes(B.toLowerCase())||Y.contactPerson?.toLowerCase().includes(B.toLowerCase())||Y.city?.toLowerCase().includes(B.toLowerCase()),ee=b==="all"||(b==="preferred"?Y.isPreferred:Y.status===b),xe=_==="all"||Y.category===_,G=S==="all"||Y.fuelTypes&&Y.fuelTypes.includes(S);return ie&&ee&&xe&&G}),V=()=>{if(!n("canManageSuppliers")){g("No tienes permisos para agregar proveedores");return}R(null),A(!0)},U=Y=>{if(!n("canManageSuppliers")){g("No tienes permisos para editar proveedores");return}R(Y),A(!0)},I=async(Y,ie)=>{if(!n("canManageSuppliers")){g("No tienes permisos para eliminar proveedores");return}if(window.confirm(`Ests seguro de que deseas desactivar el proveedor "${ie}"?

Esta accin se puede revertir cambiando su estado a activo.`))try{const ee=await Q2(Y,e?.email);ee.success?g(null):g(ee.error||"Error al desactivar proveedor")}catch(ee){console.error("Error deleting supplier:",ee),g("Error inesperado al eliminar proveedor")}},D=()=>{A(!1),R(null),g(null)},q=()=>{A(!1),R(null),g(null)},be=()=>{k("all"),j("all"),O("all"),L("")},Ie=()=>{if(!n("canExportReports")){g("No tienes permisos para exportar datos");return}try{const Y=M.map(te=>({Nombre:te.name,"NIT/Documento":te.taxId,Tipo:te.type,Categora:te.category,"Persona de Contacto":te.contactPerson,Telfono:te.phone,Email:te.email,Ciudad:te.city,Combustibles:te.fuelTypes?.join(", "),Rating:te.rating,Estado:te.status,Preferido:te.isPreferred?"S":"No","Fecha Creacin":te.createdAt?.toDate?.()?.toLocaleDateString()||"N/A"})),ie=[Object.keys(Y[0]).join(","),...Y.map(te=>Object.values(te).map(he=>`"${he||""}"`).join(","))].join(`
`),ee=new Blob([ie],{type:"text/csv;charset=utf-8;"}),xe=document.createElement("a"),G=URL.createObjectURL(ee);xe.setAttribute("href",G),xe.setAttribute("download",`proveedores_${new Date().toISOString().split("T")[0]}.csv`),xe.style.visibility="hidden",document.body.appendChild(xe),xe.click(),document.body.removeChild(xe)}catch(Y){console.error("Error exporting suppliers:",Y),g("Error al exportar proveedores")}};return d?s.jsx("div",{className:"suppliers-main",children:s.jsxs("div",{className:"loading-container",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Cargando proveedores..."})]})}):s.jsxs("div",{className:"suppliers-main",children:[s.jsxs("div",{className:"suppliers-header",children:[s.jsxs("div",{className:"header-content",children:[s.jsx("h1",{children:"Gestin de Proveedores"}),s.jsx("p",{className:"header-subtitle",children:"Administra los proveedores de combustibles y materiales"})]}),s.jsxs("div",{className:"header-actions",children:[n("canManageSuppliers")&&s.jsxs("button",{className:"btn btn-primary",onClick:V,children:[s.jsx("i",{className:"icon-plus"}),"Agregar Proveedor"]}),n("canExportReports")&&s.jsxs("button",{className:"btn btn-secondary",onClick:Ie,disabled:M.length===0,children:[s.jsx("i",{className:"icon-download"}),"Exportar"]})]})]}),p&&s.jsxs("div",{className:"alert alert-error",children:[s.jsx("i",{className:"icon-alert-circle"}),s.jsx("span",{children:p}),s.jsx("button",{onClick:()=>g(null),className:"alert-close",children:s.jsx("i",{className:"icon-x"})})]}),o&&s.jsx(nU,{stats:o,suppliersCount:M.length,totalSuppliers:t.length}),s.jsx(sU,{searchTerm:B,setSearchTerm:L,filterStatus:b,setFilterStatus:k,filterCategory:_,setFilterCategory:j,filterFuelType:S,setFilterFuelType:O,viewMode:y,setViewMode:N,onClearFilters:be,resultsCount:M.length}),M.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:s.jsx("i",{className:"icon-truck"})}),s.jsx("h3",{children:"No hay proveedores"}),s.jsx("p",{children:t.length===0?"Comienza agregando tu primer proveedor de combustibles.":"No se encontraron proveedores que coincidan con los filtros aplicados."}),t.length===0&&n("canManageSuppliers")&&s.jsxs("button",{className:"btn btn-primary",onClick:V,children:[s.jsx("i",{className:"icon-plus"}),"Agregar Primer Proveedor"]}),t.length>0&&s.jsxs("button",{className:"btn btn-secondary",onClick:be,children:[s.jsx("i",{className:"icon-filter-x"}),"Limpiar Filtros"]})]}):s.jsx("div",{className:"suppliers-content",children:y==="cards"?s.jsx(eU,{suppliers:M,onEdit:U,onDelete:I,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")}):s.jsx(JV,{suppliers:M,onEdit:U,onDelete:I,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")})}),E&&s.jsx(tU,{supplier:T,onClose:D,onSuccess:q,onError:g})]})},iU=()=>{const{user:n,userProfile:e}=Zn(),[t,i]=H.useState("invitations"),[o,c]=H.useState([]),[d,f]=H.useState(!1),[p,g]=H.useState(!1),[y,N]=H.useState(!1),[E,A]=H.useState({email:"",name:"",role:Ts.CLIENTE});H.useEffect(()=>{n&&e?.role==="admin"&&T()},[n,e,T]);const T=H.useCallback(async()=>{if(n){f(!0);try{const S=await j2(n.uid);S.success?c(S.invitations):console.error("Error loading invitations:",S.error)}catch(S){console.error("Error loading invitations:",S)}finally{f(!1)}}},[n]),R=async S=>{S.preventDefault(),N(!0);try{const O=await _2(E,n.uid);O.success?(A({email:"",name:"",role:Ts.CLIENTE}),g(!1),await T(),alert(`Invitacin creada exitosamente!
Cdigo: ${O.invitation.code}`)):alert(`Error: ${O.error}`)}catch(O){console.error("Error creating invitation:",O),alert("Error creando invitacin")}finally{N(!1)}},b=async S=>{if(confirm("Ests seguro de cancelar esta invitacin?"))try{const O=await T2(S,n.uid);O.success?(await T(),alert("Invitacin cancelada exitosamente")):alert(`Error: ${O.error}`)}catch(O){console.error("Error cancelling invitation:",O),alert("Error cancelando invitacin")}},k=S=>({pending:{text:"Pendiente",class:"status-pending"},used:{text:"Usada",class:"status-used"},cancelled:{text:"Cancelada",class:"status-cancelled"},expired:{text:"Expirada",class:"status-expired"}})[S]||{text:S,class:"status-unknown"},_=S=>({admin:"Administrador",contador:"Contador",cliente:"Cliente"})[S]||S,j=S=>S?(S.toDate?S.toDate():new Date(S)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e?.role!=="admin"?s.jsxs("div",{className:"admin-unauthorized",children:[s.jsx("h2",{children:" Acceso Denegado"}),s.jsx("p",{children:"Solo los administradores pueden acceder a esta seccin."})]}):s.jsxs("div",{className:"admin-main",children:[s.jsxs("div",{className:"admin-header",children:[s.jsx("h1",{children:" Administracin del Sistema"}),s.jsx("p",{children:"Gestin de usuarios y configuraciones"})]}),s.jsxs("div",{className:"admin-tabs",children:[s.jsx("button",{className:`tab-button ${t==="invitations"?"active":""}`,onClick:()=>i("invitations"),children:" Invitaciones"}),s.jsx("button",{className:`tab-button ${t==="users"?"active":""}`,onClick:()=>i("users"),children:" Usuarios"}),s.jsx("button",{className:`tab-button ${t==="settings"?"active":""}`,onClick:()=>i("settings"),children:" Configuracin"})]}),s.jsxs("div",{className:"admin-content",children:[t==="invitations"&&s.jsxs("div",{className:"invitations-section",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{children:"Gestin de Invitaciones"}),s.jsx("button",{className:"create-button",onClick:()=>g(!0),children:"+ Crear Invitacin"})]}),d?s.jsx("div",{className:"loading",children:"Cargando invitaciones..."}):s.jsxs("div",{className:"invitations-table",children:[s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Cdigo"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Nombre"}),s.jsx("th",{children:"Rol"}),s.jsx("th",{children:"Estado"}),s.jsx("th",{children:"Creada"}),s.jsx("th",{children:"Expira"}),s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:o.map(S=>{const O=k(S.status);return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("code",{className:"invitation-code",children:S.code})}),s.jsx("td",{children:S.targetEmail}),s.jsx("td",{children:S.targetName||"-"}),s.jsx("td",{children:_(S.targetRole)}),s.jsx("td",{children:s.jsx("span",{className:`status-badge ${O.class}`,children:O.text})}),s.jsx("td",{children:j(S.createdAt)}),s.jsx("td",{children:j(S.expiresAt)}),s.jsx("td",{children:S.status==="pending"&&s.jsx("button",{className:"cancel-button",onClick:()=>b(S.id),children:"Cancelar"})})]},S.id)})})]}),o.length===0&&s.jsx("div",{className:"empty-state",children:s.jsx("p",{children:"No hay invitaciones creadas"})})]})]}),t==="users"&&s.jsxs("div",{className:"users-section",children:[s.jsx("h2",{children:" Usuarios del Sistema"}),s.jsxs("div",{className:"coming-soon",children:[s.jsx("span",{children:" En desarrollo"}),s.jsx("p",{children:"Prximamente: Lista de usuarios registrados, edicin de permisos, y estadsticas."})]})]}),t==="settings"&&s.jsxs("div",{className:"settings-section",children:[s.jsx("h2",{children:" Configuracin del Sistema"}),s.jsxs("div",{className:"coming-soon",children:[s.jsx("span",{children:" En desarrollo"}),s.jsx("p",{children:"Prximamente: Configuraciones generales, notificaciones, y parmetros del sistema."})]})]})]}),p&&s.jsx("div",{className:"modal-overlay",onClick:()=>g(!1),children:s.jsxs("div",{className:"modal-content",onClick:S=>S.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h3",{children:"Crear Nueva Invitacin"}),s.jsx("button",{className:"modal-close",onClick:()=>g(!1),children:""})]}),s.jsxs("form",{onSubmit:R,className:"invitation-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"email",children:"Email del usuario:"}),s.jsx("input",{id:"email",type:"email",required:!0,value:E.email,onChange:S=>A({...E,email:S.target.value}),placeholder:"usuario@ejemplo.com"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"name",children:"Nombre (opcional):"}),s.jsx("input",{id:"name",type:"text",value:E.name,onChange:S=>A({...E,name:S.target.value}),placeholder:"Nombre del usuario"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"role",children:"Rol:"}),s.jsxs("select",{id:"role",value:E.role,onChange:S=>A({...E,role:S.target.value}),children:[s.jsx("option",{value:Ts.CLIENTE,children:"Cliente"}),s.jsx("option",{value:Ts.CONTADOR,children:"Contador"}),s.jsx("option",{value:Ts.ADMIN,children:"Administrador"})]})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{type:"button",className:"cancel-button",onClick:()=>g(!1),children:"Cancelar"}),s.jsx("button",{type:"submit",className:"create-button",disabled:y,children:y?"Creando...":"Crear Invitacin"})]})]})]})})]})},rU=({inventory:n,movements:e,dateRange:t})=>{const[i,o]=H.useState("all"),[c,d]=H.useState("stock_level"),f=H.useMemo(()=>i==="all"?n:n.filter(R=>R.location===i),[n,i]),p=H.useMemo(()=>[...new Set(n.map(b=>b.location))].filter(Boolean),[n]),g=H.useMemo(()=>MA(f),[f]),y=H.useMemo(()=>ry(f),[f]),N=H.useMemo(()=>RA(f),[f]),E=H.useMemo(()=>ly(e),[e]),A=H.useMemo(()=>f.map(b=>{const k=Ss[b.fuelType]||{},_=parseFloat(b.currentStock)||0,j=parseFloat(b.maxCapacity)||0,S=j>0?_/j*100:0,O=_*(parseFloat(b.pricePerUnit)||0);return{...b,fuelInfo:k,percentage:S,value:O,stockLevel:S<15?"critical":S<30?"low":"good"}}).sort((b,k)=>{switch(c){case"stock_level":return b.percentage-k.percentage;case"value":return k.value-b.value;case"name":return b.productName.localeCompare(k.productName);case"location":return b.location.localeCompare(k.location);default:return 0}}),[f,c]),T=()=>{const R=["Producto","Ubicacin","Stock Actual","Capacidad","% Capacidad","Valor","Estado"],b=A.map(O=>[O.productName,O.location,ce(O.currentStock),ce(O.maxCapacity),Cn(O.percentage/100),Me(O.value),O.stockLevel==="critical"?"Crtico":O.stockLevel==="low"?"Bajo":"Bueno"]),k=[R,...b].map(O=>O.join(",")).join(`
`),_=new Blob([k],{type:"text/csv"}),j=URL.createObjectURL(_),S=document.createElement("a");S.href=j,S.download=`inventario_${new Date().toISOString().slice(0,10)}.csv`,S.click(),URL.revokeObjectURL(j)};return s.jsxs("div",{className:"inventory-reports",children:[s.jsxs("div",{className:"kpis-grid",children:[s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon inventory",children:""}),s.jsx("div",{className:"kpi-value",children:Me(g.totalValue)}),s.jsx("div",{className:"kpi-label",children:"Valor Total"}),s.jsxs("div",{className:"kpi-trend neutral",children:[s.jsx("span",{className:"trend-icon",children:""}),g.totalItems," productos"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon inventory",children:""}),s.jsx("div",{className:"kpi-value",children:Cn(g.averageStockLevel/100)}),s.jsx("div",{className:"kpi-label",children:"Nivel Promedio"}),s.jsxs("div",{className:`kpi-trend ${g.averageStockLevel>60?"positive":g.averageStockLevel>30?"neutral":"negative"}`,children:[s.jsx("span",{className:"trend-icon",children:g.averageStockLevel>60?"":g.averageStockLevel>30?"":""}),g.activeItems," activos"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon inventory",children:""}),s.jsx("div",{className:"kpi-value",children:g.lowStockItems}),s.jsx("div",{className:"kpi-label",children:"Alertas de Stock"}),s.jsxs("div",{className:`kpi-trend ${g.criticalItems>0?"negative":"neutral"}`,children:[s.jsx("span",{className:"trend-icon",children:""}),g.criticalItems," crticos"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon inventory",children:""}),s.jsxs("div",{className:"kpi-value",children:[ce(E.confidence),"%"]}),s.jsx("div",{className:"kpi-label",children:"Precisin Proyeccin"}),s.jsxs("div",{className:"kpi-trend positive",children:[s.jsx("span",{className:"trend-icon",children:""}),E.dataPoints," datos"]})]})]}),s.jsx("div",{className:"reports-filters",children:s.jsxs("div",{className:"filters-grid",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Ubicacin"}),s.jsxs("select",{className:"filter-select",value:i,onChange:R=>o(R.target.value),children:[s.jsx("option",{value:"all",children:"Todas las ubicaciones"}),p.map(R=>s.jsx("option",{value:R,children:R},R))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Ordenar por"}),s.jsxs("select",{className:"filter-select",value:c,onChange:R=>d(R.target.value),children:[s.jsx("option",{value:"stock_level",children:"Nivel de Stock"}),s.jsx("option",{value:"value",children:"Valor"}),s.jsx("option",{value:"name",children:"Nombre"}),s.jsx("option",{value:"location",children:"Ubicacin"})]})]}),s.jsx("div",{className:"filter-actions",children:s.jsx("button",{className:"filter-btn secondary",onClick:T,children:" Exportar CSV"})})]})}),s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Stock por Tipo de Combustible"})}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"stock-grid",children:Object.entries(N).map(([R,b])=>{const k=Ss[R]||{};return s.jsxs("div",{className:"stock-item",children:[s.jsxs("div",{className:"stock-header",children:[s.jsx("span",{className:"stock-icon",children:k.icon||""}),s.jsx("h4",{children:k.name||R.toUpperCase()})]}),s.jsxs("div",{className:"stock-value",children:[ce(b)," ",k.unit||"L"]}),s.jsx("div",{className:"stock-status",children:b>1e3?s.jsx("span",{className:"badge success",children:"Stock Bueno"}):b>500?s.jsx("span",{className:"badge warning",children:"Stock Bajo"}):s.jsx("span",{className:"badge danger",children:"Stock Crtico"})})]},R)})})})]}),y.length>0&&s.jsxs("div",{className:"chart-container",children:[s.jsxs("div",{className:"chart-header",children:[s.jsx("h3",{className:"chart-title",children:" Alertas de Stock Bajo"}),s.jsx("div",{className:"chart-actions",children:s.jsxs("span",{className:"badge danger",children:[y.length," alertas"]})})]}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"alerts-list",children:y.map((R,b)=>s.jsxs("div",{className:`alert ${R.stockLevel==="critical"?"critical":"warning"}`,children:[s.jsx("span",{className:"alert-icon",children:R.stockLevel==="critical"?"":""}),s.jsxs("div",{className:"alert-content",children:[s.jsxs("div",{className:"alert-title",children:[R.productName," - ",R.location]}),s.jsxs("div",{className:"alert-message",children:["Stock: ",ce(R.currentStock)," ",R.unit,"(",Cn(R.percentage/100)," de capacidad mxima)"]})]})]},b))})})]}),Object.keys(E.recommendedPurchases).length>0&&s.jsxs("div",{className:"chart-container",children:[s.jsxs("div",{className:"chart-header",children:[s.jsx("h3",{className:"chart-title",children:" Proyecciones de Compra (30 das)"}),s.jsx("div",{className:"chart-actions",children:s.jsxs("span",{className:"badge info",children:["Confianza: ",ce(E.confidence),"%"]})})]}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"projections-grid",children:Object.entries(E.recommendedPurchases).map(([R,b])=>{const k=Ss[R]||{},_=E.projectedConsumption[R];return s.jsxs("div",{className:"projection-item",children:[s.jsxs("div",{className:"projection-header",children:[s.jsx("span",{children:k.icon||""}),s.jsx("h4",{children:k.name||R.toUpperCase()})]}),s.jsxs("div",{className:"projection-value",children:[ce(b)," ",k.unit||"L"]}),s.jsxs("div",{className:"projection-details",children:[s.jsxs("small",{children:["Consumo proyectado: ",ce(_?.projectedTotal)," ",k.unit||"L"]}),s.jsxs("small",{children:["Promedio diario: ",ce(_?.dailyAverage)," ",k.unit||"L"]})]})]},R)})})})]}),s.jsxs("div",{className:"report-table-container",children:[s.jsx("div",{className:"report-table-header",children:s.jsx("h3",{className:"report-table-title",children:" Inventario Detallado"})}),s.jsx("div",{style:{overflowX:"auto"},children:s.jsxs("table",{className:"report-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Ubicacin"}),s.jsx("th",{children:"Tipo"}),s.jsx("th",{children:"Stock Actual"}),s.jsx("th",{children:"Capacidad"}),s.jsx("th",{children:"% Capacidad"}),s.jsx("th",{children:"Precio/Unidad"}),s.jsx("th",{children:"Valor Total"}),s.jsx("th",{children:"Estado"})]})}),s.jsx("tbody",{children:A.map((R,b)=>s.jsxs("tr",{children:[s.jsx("td",{children:R.productName}),s.jsx("td",{children:R.location}),s.jsxs("td",{children:[s.jsx("span",{style:{marginRight:"0.5rem"},children:R.fuelInfo.icon||""}),R.fuelInfo.name||R.fuelType]}),s.jsxs("td",{children:[ce(R.currentStock)," ",R.unit]}),s.jsxs("td",{children:[ce(R.maxCapacity)," ",R.unit]}),s.jsx("td",{children:s.jsx("span",{className:`text-${R.stockLevel==="critical"?"danger":R.stockLevel==="low"?"warning":"success"}`,children:Cn(R.percentage/100)})}),s.jsx("td",{children:Me(R.pricePerUnit)}),s.jsx("td",{children:Me(R.value)}),s.jsx("td",{children:s.jsx("span",{className:`badge ${R.stockLevel==="critical"?"danger":R.stockLevel==="low"?"warning":"success"}`,children:R.stockLevel==="critical"?"Crtico":R.stockLevel==="low"?"Bajo":"Bueno"})})]},b))})]})})]})]})},on={HARVESTING:"harvesting",TRANSPORT:"transport",MAINTENANCE:"maintenance",SUPPORT:"support"},ln={CHAINSAW:"chainsaw",HARVESTER:"harvester",FORWARDER:"forwarder",SKIDDER:"skidder",LOG_TRUCK:"log_truck",PICKUP_TRUCK:"pickup_truck",CAR:"car",MOTORCYCLE:"motorcycle",ATV:"atv",BULLDOZER:"bulldozer",EXCAVATOR:"excavator",GRADER:"grader",LOADER:"loader",WATER_PUMP:"water_pump",FIRE_PUMP:"fire_pump",GENERATOR:"generator",COMPRESSOR:"compressor"},oU={[ln.CHAINSAW]:{name:"Motosierra",category:on.HARVESTING,fuelType:"two_stroke",avgConsumption:2.5,icon:"",color:"#dc2626",description:"Herramienta para corte de rboles"},[ln.HARVESTER]:{name:"Cosechadora Forestal",category:on.HARVESTING,fuelType:"diesel",avgConsumption:25,icon:"",color:"#059669",description:"Mquina para corte y procesamiento de rboles"},[ln.FORWARDER]:{name:"Forwarder",category:on.HARVESTING,fuelType:"diesel",avgConsumption:20,icon:"",color:"#0891b2",description:"Transporte de troncos dentro del bosque"},[ln.LOG_TRUCK]:{name:"Camin Maderero",category:on.TRANSPORT,fuelType:"acpm",avgConsumption:3.5,icon:"",color:"#ea580c",description:"Transporte de madera a destino"},[ln.PICKUP_TRUCK]:{name:"Camioneta",category:on.TRANSPORT,fuelType:"gasoline",avgConsumption:8,icon:"",color:"#2563eb",description:"Transporte de personal y herramientas"},[ln.CAR]:{name:"Automvil",category:on.TRANSPORT,fuelType:"gasoline",avgConsumption:12,icon:"",color:"#3b82f6",description:"Vehculo liviano para transporte ejecutivo"},[ln.MOTORCYCLE]:{name:"Motocicleta",category:on.TRANSPORT,fuelType:"gasoline",avgConsumption:25,icon:"",color:"#6366f1",description:"Transporte gil para terrenos difciles"},[ln.ATV]:{name:"Cuatrimoto",category:on.TRANSPORT,fuelType:"gasoline",avgConsumption:15,icon:"",color:"#84cc16",description:"Vehculo todo terreno para supervisin"},[ln.SKIDDER]:{name:"Skidder",category:on.HARVESTING,fuelType:"diesel",avgConsumption:22,icon:"",color:"#f59e0b",description:"Arrastre de troncos desde el lugar de corte"},[ln.BULLDOZER]:{name:"Bulldozer",category:on.MAINTENANCE,fuelType:"diesel",avgConsumption:30,icon:"",color:"#f97316",description:"Construccin y mantenimiento de caminos"},[ln.EXCAVATOR]:{name:"Excavadora",category:on.MAINTENANCE,fuelType:"diesel",avgConsumption:28,icon:"",color:"#eab308",description:"Excavacin y movimiento de tierra"},[ln.GRADER]:{name:"Motoniveladora",category:on.MAINTENANCE,fuelType:"diesel",avgConsumption:25,icon:"",color:"#a3a3a3",description:"Nivelacin y mantenimiento de vas"},[ln.LOADER]:{name:"Cargador Frontal",category:on.MAINTENANCE,fuelType:"diesel",avgConsumption:24,icon:"",color:"#71717a",description:"Carga y descarga de materiales"},[ln.WATER_PUMP]:{name:"Motobomba de Agua",category:on.SUPPORT,fuelType:"gasoline",avgConsumption:3.5,icon:"",color:"#0891b2",description:"Bombeo de agua para operaciones"},[ln.FIRE_PUMP]:{name:"Motobomba Contra Incendios",category:on.SUPPORT,fuelType:"gasoline",avgConsumption:4.2,icon:"",color:"#dc2626",description:"Equipo de emergencia contra incendios"},[ln.GENERATOR]:{name:"Generador Elctrico",category:on.SUPPORT,fuelType:"gasoline",avgConsumption:2.8,icon:"",color:"#7c3aed",description:"Suministro de energa elctrica"},[ln.COMPRESSOR]:{name:"Compresor de Aire",category:on.SUPPORT,fuelType:"gasoline",avgConsumption:2.5,icon:"",color:"#64748b",description:"Suministro de aire comprimido"}},lU=({vehicles:n,movements:e,dateRange:t})=>{const[i,o]=H.useState("all"),[c,d]=H.useState("all"),[f,p]=H.useState("efficiency"),g=H.useMemo(()=>{let _=n.filter(j=>j.status==="activo");return i!=="all"&&(_=_.filter(j=>j.category===i)),c!=="all"&&(_=_.filter(j=>j.fuelType===c)),_},[n,i,c]),y=H.useMemo(()=>!t.start&&!t.end?e:e.filter(_=>{const j=new Date(_.createdAt||_.date),S=t.start?new Date(t.start):new Date(0),O=t.end?new Date(t.end):new Date;return j>=S&&j<=O}),[e,t]),N=H.useMemo(()=>[...new Set(n.map(_=>_.category).filter(Boolean))],[n]),E=H.useMemo(()=>[...new Set(n.map(_=>_.fuelType).filter(Boolean))],[n]),A=H.useMemo(()=>OA(g,y),[g,y]),T=H.useMemo(()=>g.map(j=>{const S=oy(j,y),O=kA(j,y),B=I2(j,y),L=oU[j.type]||{},M=j.fuelType==="diesel"||j.fuelType==="Diesel",V=parseFloat(j.currentHours)||0,U=parseFloat(j.totalHoursWorked)||0,I=U>0?S.totalConsumption/U:0,D=L.avgConsumption||0,q=D>0&&I>0?(D-I)/D*100:0;return{...j,vehicleInfo:L,consumption:S,efficiency:O,costs:B,hasHourMeter:M,currentHours:V,totalHoursWorked:U,actualConsumptionPerHour:I,estimatedConsumption:D,efficiencyRating:q,nextMaintenanceHours:M?Math.ceil(V/250)*250:null,hoursToMaintenance:M?Math.ceil(V/250)*250-V:null}}).sort((j,S)=>{switch(f){case"efficiency":return S.efficiencyRating-j.efficiencyRating;case"consumption":return S.consumption.totalConsumption-j.consumption.totalConsumption;case"cost":return S.costs.totalCost-j.costs.totalCost;case"hours":return S.currentHours-j.currentHours;case"name":return j.name.localeCompare(S.name);default:return 0}}),[g,y,f]),R=H.useMemo(()=>{const _=[...T].sort((j,S)=>S.efficiencyRating-j.efficiencyRating);return{mostEfficient:_[0],leastEfficient:_[_.length-1],highestConsumption:[...T].sort((j,S)=>S.consumption.totalConsumption-j.consumption.totalConsumption)[0],nearMaintenance:T.filter(j=>j.hasHourMeter&&j.hoursToMaintenance<=50)}},[T]),b=H.useMemo(()=>{const _={};return E.forEach(j=>{const S=T.filter(M=>M.fuelType===j),O=S.reduce((M,V)=>M+V.consumption.totalConsumption,0),B=S.reduce((M,V)=>M+V.costs.totalCost,0),L=S.length>0?S.reduce((M,V)=>M+V.efficiencyRating,0)/S.length:0;_[j]={vehicleCount:S.length,totalConsumption:O,totalCost:B,avgEfficiency:L,avgConsumptionPerVehicle:S.length>0?O/S.length:0}}),_},[T,E]),k=()=>{const _=["Vehculo","Tipo","Combustible","Horas Actuales","Consumo Total (L)","Consumo/Hora","Eficiencia (%)","Costo Total","Prximo Mantenimiento"],j=T.map(M=>[M.vehicleId,M.type,M.fuelType,M.hasHourMeter?ce(M.currentHours):"N/A",ce(M.consumption.totalConsumption),ce(M.actualConsumptionPerHour,2),ce(M.efficiencyRating,1)+"%",Me(M.costs.totalCost),M.hasHourMeter?`${M.nextMaintenanceHours}h`:"N/A"]),S=[_,...j].map(M=>M.join(",")).join(`
`),O=new Blob([S],{type:"text/csv"}),B=URL.createObjectURL(O),L=document.createElement("a");L.href=B,L.download=`vehiculos_${new Date().toISOString().slice(0,10)}.csv`,L.click(),URL.revokeObjectURL(B)};return s.jsxs("div",{className:"vehicle-reports",children:[s.jsxs("div",{className:"kpis-grid",children:[s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon vehicles",children:""}),s.jsx("div",{className:"kpi-value",children:A.activeVehicles}),s.jsx("div",{className:"kpi-label",children:"Vehculos Activos"}),s.jsxs("div",{className:"kpi-trend positive",children:[s.jsx("span",{className:"trend-icon",children:""}),ce(A.totalHours)," horas total"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon vehicles",children:""}),s.jsx("div",{className:"kpi-value",children:ce(A.totalConsumption)}),s.jsx("div",{className:"kpi-label",children:"Consumo Total (L)"}),s.jsxs("div",{className:"kpi-trend neutral",children:[s.jsx("span",{className:"trend-icon",children:""}),ce(A.averageEfficiency,1)," L/h promedio"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon vehicles",children:""}),s.jsxs("div",{className:"kpi-value",children:[ce(R.mostEfficient?.efficiencyRating||0,1),"%"]}),s.jsx("div",{className:"kpi-label",children:"Mejor Eficiencia"}),s.jsxs("div",{className:"kpi-trend positive",children:[s.jsx("span",{className:"trend-icon",children:""}),R.mostEfficient?.vehicleId||"N/A"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon vehicles",children:""}),s.jsx("div",{className:"kpi-value",children:R.nearMaintenance.length}),s.jsx("div",{className:"kpi-label",children:"Prximo Mantenimiento"}),s.jsxs("div",{className:`kpi-trend ${R.nearMaintenance.length>0?"negative":"positive"}`,children:[s.jsx("span",{className:"trend-icon",children:""})," 50 horas"]})]})]}),s.jsx("div",{className:"reports-filters",children:s.jsxs("div",{className:"filters-grid",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Categora"}),s.jsxs("select",{className:"filter-select",value:i,onChange:_=>o(_.target.value),children:[s.jsx("option",{value:"all",children:"Todas las categoras"}),N.map(_=>s.jsx("option",{value:_,children:_},_))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),s.jsxs("select",{className:"filter-select",value:c,onChange:_=>d(_.target.value),children:[s.jsx("option",{value:"all",children:"Todos los combustibles"}),E.map(_=>s.jsx("option",{value:_,children:_},_))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Ordenar por"}),s.jsxs("select",{className:"filter-select",value:f,onChange:_=>p(_.target.value),children:[s.jsx("option",{value:"efficiency",children:"Eficiencia"}),s.jsx("option",{value:"consumption",children:"Consumo"}),s.jsx("option",{value:"cost",children:"Costo"}),s.jsx("option",{value:"hours",children:"Horas"}),s.jsx("option",{value:"name",children:"Nombre"})]})]}),s.jsx("div",{className:"filter-actions",children:s.jsx("button",{className:"filter-btn secondary",onClick:k,children:" Exportar CSV"})})]})}),R.nearMaintenance.length>0&&s.jsx("div",{className:"alerts-container",children:R.nearMaintenance.map((_,j)=>s.jsxs("div",{className:"alert warning",children:[s.jsx("span",{className:"alert-icon",children:""}),s.jsxs("div",{className:"alert-content",children:[s.jsxs("div",{className:"alert-title",children:["Mantenimiento Prximo: ",_.vehicleId]}),s.jsxs("div",{className:"alert-message",children:["Horas actuales: ",ce(_.currentHours),"h | Prximo mantenimiento: ",_.nextMaintenanceHours,"h | Faltan: ",ce(_.hoursToMaintenance),"h"]})]})]},j))}),s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Anlisis por Tipo de Combustible"})}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"fuel-analysis-grid",children:Object.entries(b).map(([_,j])=>s.jsxs("div",{className:"fuel-analysis-item",children:[s.jsx("h4",{children:_.toUpperCase()}),s.jsxs("div",{className:"analysis-metrics",children:[s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Vehculos:"}),s.jsx("span",{className:"metric-value",children:j.vehicleCount})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Consumo Total:"}),s.jsxs("span",{className:"metric-value",children:[ce(j.totalConsumption)," L"]})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Costo Total:"}),s.jsx("span",{className:"metric-value",children:Me(j.totalCost)})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Eficiencia Promedio:"}),s.jsxs("span",{className:`metric-value ${j.avgEfficiency>10?"text-success":j.avgEfficiency>0?"text-warning":"text-danger"}`,children:[ce(j.avgEfficiency,1),"%"]})]})]})]},_))})})]}),s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Anlisis de Rendimiento"})}),s.jsx("div",{className:"chart-content",children:s.jsxs("div",{className:"performers-grid",children:[s.jsxs("div",{className:"performer-item success",children:[s.jsx("h4",{children:" Ms Eficiente"}),s.jsx("div",{className:"performer-name",children:R.mostEfficient?.vehicleId||"N/A"}),s.jsxs("div",{className:"performer-metric",children:[ce(R.mostEfficient?.efficiencyRating||0,1),"% eficiencia"]}),s.jsxs("div",{className:"performer-details",children:[ce(R.mostEfficient?.actualConsumptionPerHour||0,2)," L/h"]})]}),s.jsxs("div",{className:"performer-item warning",children:[s.jsx("h4",{children:" Mayor Consumo"}),s.jsx("div",{className:"performer-name",children:R.highestConsumption?.vehicleId||"N/A"}),s.jsxs("div",{className:"performer-metric",children:[ce(R.highestConsumption?.consumption.totalConsumption||0)," L total"]}),s.jsxs("div",{className:"performer-details",children:[ce(R.highestConsumption?.actualConsumptionPerHour||0,2)," L/h"]})]}),s.jsxs("div",{className:"performer-item danger",children:[s.jsx("h4",{children:" Menos Eficiente"}),s.jsx("div",{className:"performer-name",children:R.leastEfficient?.vehicleId||"N/A"}),s.jsxs("div",{className:"performer-metric",children:[ce(R.leastEfficient?.efficiencyRating||0,1),"% eficiencia"]}),s.jsxs("div",{className:"performer-details",children:[ce(R.leastEfficient?.actualConsumptionPerHour||0,2)," L/h"]})]})]})})]}),s.jsxs("div",{className:"report-table-container",children:[s.jsx("div",{className:"report-table-header",children:s.jsx("h3",{className:"report-table-title",children:" Anlisis Detallado de Vehculos"})}),s.jsx("div",{style:{overflowX:"auto"},children:s.jsxs("table",{className:"report-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Vehculo"}),s.jsx("th",{children:"Tipo"}),s.jsx("th",{children:"Combustible"}),s.jsx("th",{children:"Horas Actuales"}),s.jsx("th",{children:"Horas Trabajadas"}),s.jsx("th",{children:"Consumo Total"}),s.jsx("th",{children:"L/Hora Real"}),s.jsx("th",{children:"L/Hora Estimado"}),s.jsx("th",{children:"Eficiencia"}),s.jsx("th",{children:"Costo Total"}),s.jsx("th",{children:"Prximo Mantenimiento"})]})}),s.jsx("tbody",{children:T.map((_,j)=>s.jsxs("tr",{children:[s.jsxs("td",{children:[s.jsx("strong",{children:_.vehicleId}),s.jsx("br",{}),s.jsx("small",{children:_.name})]}),s.jsx("td",{children:_.type}),s.jsx("td",{children:s.jsx("span",{className:`badge ${_.fuelType==="diesel"?"info":"secondary"}`,children:_.fuelType})}),s.jsx("td",{children:_.hasHourMeter?s.jsxs("span",{children:[ce(_.currentHours),"h"]}):s.jsx("span",{className:"text-muted",children:"N/A"})}),s.jsxs("td",{children:[ce(_.totalHoursWorked),"h"]}),s.jsxs("td",{children:[ce(_.consumption.totalConsumption)," L"]}),s.jsx("td",{children:ce(_.actualConsumptionPerHour,2)}),s.jsx("td",{children:ce(_.estimatedConsumption,2)}),s.jsx("td",{children:s.jsxs("span",{className:`badge ${_.efficiencyRating>10?"success":_.efficiencyRating>0?"warning":"danger"}`,children:[ce(_.efficiencyRating,1),"%"]})}),s.jsx("td",{children:Me(_.costs.totalCost)}),s.jsx("td",{children:_.hasHourMeter?s.jsxs("span",{className:_.hoursToMaintenance<=50?"text-warning":"text-success",children:[_.nextMaintenanceHours,"h",s.jsx("br",{}),s.jsxs("small",{children:["(",ce(_.hoursToMaintenance),"h restantes)"]})]}):s.jsx("span",{className:"text-muted",children:"N/A"})})]},j))})]})})]})]})},cU=({movements:n,vehicles:e,suppliers:t,dateRange:i,inventory:o})=>{const[c,d]=H.useState("month"),[f,p]=H.useState("previous"),g=H.useMemo(()=>!i.start&&!i.end?n:n.filter(_=>{const j=new Date(_.createdAt||_.date),S=i.start?new Date(i.start):new Date(0),O=i.end?new Date(i.end):new Date;return j>=S&&j<=O}),[n,i]),y=H.useMemo(()=>{if(!i.start||!i.end)return null;const _=new Date(i.start),j=new Date(i.end),S=Math.ceil((j-_)/(1e3*60*60*24)),O=new Date(_);O.setDate(O.getDate()-S);const B=new Date(_);return{movements:n.filter(M=>{const V=new Date(M.createdAt||M.date);return V>=O&&V<B}),period:`${O.toLocaleDateString()} - ${B.toLocaleDateString()}`}},[n,i]),N=H.useMemo(()=>{const _=qr(g),j=PA(g,i),S=g.filter(M=>M.type===ue.ENTRADA),O=g.filter(M=>M.type===ue.SALIDA),B=S.reduce((M,V)=>M+(parseFloat(V.quantity)||0)*(parseFloat(V.unitPrice)||0),0),L=O.reduce((M,V)=>M+(parseFloat(V.quantity)||0)*(parseFloat(V.unitPrice)||0),0);return{..._,...j,entradasValue:B,salidasValue:L,netFlow:B-L,turnoverRatio:B>0?L/B:0}},[g,i]),E=H.useMemo(()=>{if(!y)return null;const _=qr(g),j=qr(y.movements);return{costChange:_.totalCost-j.totalCost,costChangePercent:j.totalCost>0?(_.totalCost-j.totalCost)/j.totalCost*100:0,movementChange:g.length-y.movements.length,movementChangePercent:y.movements.length>0?(g.length-y.movements.length)/y.movements.length*100:0}},[g,y]),A=H.useMemo(()=>[...new Set(g.flatMap(j=>[j.location,j.sourceLocation,j.destinationLocation].filter(Boolean)))].map(j=>{const S=R2(g,j),O=g.filter(B=>B.location===j||B.sourceLocation===j||B.destinationLocation===j);return{location:j,...S,movementsPercentage:g.length>0?O.length/g.length*100:0}}).sort((j,S)=>S.totalCost-j.totalCost),[g]),T=H.useMemo(()=>{const _=g.filter(S=>S.type===ue.ENTRADA&&S.supplierName),j={};return _.forEach(S=>{const O=S.supplierName,B=parseFloat(S.quantity)||0,L=B*(parseFloat(S.unitPrice)||0);j[O]||(j[O]={name:O,movementsCount:0,totalQuantity:0,totalValue:0,avgPrice:0,fuelTypes:new Set}),j[O].movementsCount++,j[O].totalQuantity+=B,j[O].totalValue+=L,j[O].fuelTypes.add(S.fuelType)}),Object.values(j).forEach(S=>{S.avgPrice=S.totalQuantity>0?S.totalValue/S.totalQuantity:0,S.fuelTypes=Array.from(S.fuelTypes)}),Object.values(j).sort((S,O)=>O.totalValue-S.totalValue)},[g]),R=H.useMemo(()=>{const _=ly(n),j={};o.forEach(B=>{B.pricePerUnit&&(j[B.fuelType]=parseFloat(B.pricePerUnit))});const S={};Object.entries(_.recommendedPurchases).forEach(([B,L])=>{const M=j[B]||0;S[B]=L*M});const O=Object.values(S).reduce((B,L)=>B+L,0);return{..._,projectedCosts:S,totalProjectedCost:O,currentPrices:j}},[n,o]),b=H.useMemo(()=>{const _={};return g.forEach(j=>{let S=j.type;if(j.vehicleId){const B=e.find(L=>L.vehicleId===j.vehicleId);B&&(S=`${j.type}_${B.category||B.type}`)}const O=(parseFloat(j.quantity)||0)*(parseFloat(j.unitPrice)||0);_[S]||(_[S]=0),_[S]+=O}),Object.entries(_).map(([j,S])=>({category:j,cost:S})).sort((j,S)=>S.cost-j.cost).slice(0,10)},[g,e]),k=()=>{const _={period:`${i.start} a ${i.end}`,summary:N,locations:A,suppliers:T,projections:R,comparison:E},j=JSON.stringify(_,null,2),S=new Blob([j],{type:"application/json"}),O=URL.createObjectURL(S),B=document.createElement("a");B.href=O,B.download=`reporte_financiero_${new Date().toISOString().slice(0,10)}.json`,B.click(),URL.revokeObjectURL(O)};return s.jsxs("div",{className:"financial-reports",children:[s.jsxs("div",{className:"kpis-grid",children:[s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon financial",children:""}),s.jsx("div",{className:"kpi-value",children:Me(N.totalCost)}),s.jsx("div",{className:"kpi-label",children:"Costo Total"}),s.jsxs("div",{className:`kpi-trend ${E?.costChangePercent>0?"negative":"positive"}`,children:[s.jsx("span",{className:"trend-icon",children:E?.costChangePercent>0?"":""}),E?`${ce(Math.abs(E.costChangePercent),1)}%`:"N/A"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon financial",children:""}),s.jsx("div",{className:"kpi-value",children:Me(N.averageCostPerMovement)}),s.jsx("div",{className:"kpi-label",children:"Costo Promedio"}),s.jsxs("div",{className:"kpi-trend neutral",children:[s.jsx("span",{className:"trend-icon",children:""}),g.length," movimientos"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon financial",children:""}),s.jsx("div",{className:"kpi-value",children:Me(N.netFlow)}),s.jsx("div",{className:"kpi-label",children:"Flujo Neto"}),s.jsxs("div",{className:`kpi-trend ${N.netFlow>0?"negative":"positive"}`,children:[s.jsx("span",{className:"trend-icon",children:N.netFlow>0?"":""}),Cn(N.turnoverRatio)," rotacin"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon financial",children:""}),s.jsx("div",{className:"kpi-value",children:Me(R.totalProjectedCost)}),s.jsx("div",{className:"kpi-label",children:"Proyeccin 30 das"}),s.jsxs("div",{className:"kpi-trend info",children:[s.jsx("span",{className:"trend-icon",children:""}),ce(R.confidence),"% confianza"]})]})]}),s.jsx("div",{className:"reports-filters",children:s.jsxs("div",{className:"filters-grid",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Perodo de Anlisis"}),s.jsxs("select",{className:"filter-select",value:c,onChange:_=>d(_.target.value),children:[s.jsx("option",{value:"week",children:"Semanal"}),s.jsx("option",{value:"month",children:"Mensual"}),s.jsx("option",{value:"quarter",children:"Trimestral"}),s.jsx("option",{value:"year",children:"Anual"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Comparar con"}),s.jsxs("select",{className:"filter-select",value:f,onChange:_=>p(_.target.value),children:[s.jsx("option",{value:"previous",children:"Perodo anterior"}),s.jsx("option",{value:"year_ago",children:"Mismo perodo ao anterior"})]})]}),s.jsx("div",{className:"filter-actions",children:s.jsx("button",{className:"filter-btn secondary",onClick:k,children:" Exportar Reporte"})})]})}),E&&s.jsxs("div",{className:"chart-container",children:[s.jsxs("div",{className:"chart-header",children:[s.jsx("h3",{className:"chart-title",children:" Comparacin con Perodo Anterior"}),s.jsx("div",{className:"chart-actions",children:s.jsxs("span",{className:"badge info",children:["vs ",y.period]})})]}),s.jsx("div",{className:"chart-content",children:s.jsxs("div",{className:"comparison-grid",children:[s.jsxs("div",{className:"comparison-item",children:[s.jsx("h4",{children:" Cambio en Costos"}),s.jsxs("div",{className:`comparison-value ${E.costChangePercent>0?"negative":"positive"}`,children:[Me(E.costChange),s.jsxs("span",{className:"comparison-percent",children:["(",E.costChangePercent>0?"+":"",ce(E.costChangePercent,1),"%)"]})]})]}),s.jsxs("div",{className:"comparison-item",children:[s.jsx("h4",{children:" Cambio en Movimientos"}),s.jsxs("div",{className:`comparison-value ${E.movementChangePercent>0?"positive":"negative"}`,children:[E.movementChange>0?"+":"",E.movementChange,s.jsxs("span",{className:"comparison-percent",children:["(",E.movementChangePercent>0?"+":"",ce(E.movementChangePercent,1),"%)"]})]})]})]})})]}),s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Costos por Ubicacin"})}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"location-analysis-grid",children:A.slice(0,6).map(_=>s.jsxs("div",{className:"location-item",children:[s.jsx("h4",{children:_.location}),s.jsxs("div",{className:"location-metrics",children:[s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Costo Total:"}),s.jsx("span",{className:"metric-value",children:Me(_.totalCost)})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Movimientos:"}),s.jsx("span",{className:"metric-value",children:_.movementsCount})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Participacin:"}),s.jsxs("span",{className:"metric-value",children:[ce(_.movementsPercentage,1),"%"]})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Promedio:"}),s.jsx("span",{className:"metric-value",children:Me(_.averageCostPerMovement)})]})]})]},_.location))})})]}),T.length>0&&s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Anlisis de Proveedores"})}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"suppliers-analysis",children:T.slice(0,5).map(_=>s.jsxs("div",{className:"supplier-item",children:[s.jsx("h4",{children:_.name}),s.jsxs("div",{className:"supplier-metrics",children:[s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Valor Total:"}),s.jsx("span",{className:"metric-value",children:Me(_.totalValue)})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Cantidad:"}),s.jsxs("span",{className:"metric-value",children:[ce(_.totalQuantity)," L"]})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Precio Promedio:"}),s.jsx("span",{className:"metric-value",children:Me(_.avgPrice)})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Movimientos:"}),s.jsx("span",{className:"metric-value",children:_.movementsCount})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Combustibles:"}),s.jsx("span",{className:"metric-value",children:_.fuelTypes.join(", ")})]})]})]},_.name))})})]}),s.jsxs("div",{className:"chart-container",children:[s.jsxs("div",{className:"chart-header",children:[s.jsx("h3",{className:"chart-title",children:" Proyecciones Financieras (30 das)"}),s.jsx("div",{className:"chart-actions",children:s.jsxs("span",{className:"badge success",children:["Confianza: ",ce(R.confidence),"%"]})})]}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"projections-financial",children:Object.entries(R.projectedCosts).map(([_,j])=>{const S=R.recommendedPurchases[_],O=R.currentPrices[_],B=Ss[_]||{};return s.jsxs("div",{className:"projection-financial-item",children:[s.jsxs("h4",{children:[s.jsx("span",{style:{marginRight:"0.5rem"},children:B.icon||""}),B.name||_.toUpperCase()]}),s.jsxs("div",{className:"projection-financial-metrics",children:[s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Cantidad Proyectada:"}),s.jsxs("span",{className:"metric-value",children:[ce(S)," ",B.unit||"L"]})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Precio Actual:"}),s.jsx("span",{className:"metric-value",children:Me(O)})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Costo Proyectado:"}),s.jsx("span",{className:"metric-value highlight",children:Me(j)})]})]})]},_)})})})]}),s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Top Costos por Categora"})}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"top-costs-list",children:b.map((_,j)=>s.jsxs("div",{className:"cost-item",children:[s.jsxs("div",{className:"cost-rank",children:["#",j+1]}),s.jsxs("div",{className:"cost-info",children:[s.jsx("h4",{children:_.category.replace("_"," - ")}),s.jsxs("div",{className:"cost-percentage",children:[Cn(_.cost/N.totalCost)," del total"]})]}),s.jsx("div",{className:"cost-value",children:Me(_.cost)})]},_.category))})})]}),s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Resumen Ejecutivo"})}),s.jsx("div",{className:"chart-content",children:s.jsxs("div",{className:"executive-summary",children:[s.jsxs("div",{className:"summary-section",children:[s.jsx("h4",{children:" Flujo de Efectivo"}),s.jsxs("div",{className:"summary-metrics",children:[s.jsxs("div",{className:"summary-item",children:[s.jsx("span",{children:"Entradas:"}),s.jsx("span",{className:"text-success",children:Me(N.entradasValue)})]}),s.jsxs("div",{className:"summary-item",children:[s.jsx("span",{children:"Salidas:"}),s.jsx("span",{className:"text-warning",children:Me(N.salidasValue)})]}),s.jsxs("div",{className:"summary-item",children:[s.jsx("span",{children:"Balance:"}),s.jsx("span",{className:N.netFlow>0?"text-danger":"text-success",children:Me(Math.abs(N.netFlow))})]})]})]}),s.jsxs("div",{className:"summary-section",children:[s.jsx("h4",{children:" Eficiencia Operacional"}),s.jsxs("div",{className:"summary-metrics",children:[s.jsxs("div",{className:"summary-item",children:[s.jsx("span",{children:"Rotacin de Inventario:"}),s.jsx("span",{children:Cn(N.turnoverRatio)})]}),s.jsxs("div",{className:"summary-item",children:[s.jsx("span",{children:"Costo por Movimiento:"}),s.jsx("span",{children:Me(N.averageCostPerMovement)})]}),s.jsxs("div",{className:"summary-item",children:[s.jsx("span",{children:"Total Movimientos:"}),s.jsx("span",{children:g.length})]})]})]})]})})]})]})},uU=({movements:n,dateRange:e,vehicles:t})=>{const[i,o]=H.useState("all"),[c,d]=H.useState("all"),[f,p]=H.useState("all"),g=H.useMemo(()=>{let _=n;return(e.start||e.end)&&(_=_.filter(j=>{const S=new Date(j.createdAt||j.date),O=e.start?new Date(e.start):new Date(0),B=e.end?new Date(e.end):new Date;return S>=O&&S<=B})),i!=="all"&&(_=_.filter(j=>j.type===i)),c!=="all"&&(_=_.filter(j=>j.fuelType===c)),f!=="all"&&(_=_.filter(j=>j.location===f||j.sourceLocation===f||j.destinationLocation===f)),_},[n,e,i,c,f]),y=H.useMemo(()=>{const _=[...new Set(n.map(S=>S.fuelType).filter(Boolean))],j=[...new Set(n.flatMap(S=>[S.location,S.sourceLocation,S.destinationLocation].filter(Boolean)))];return{fuelTypes:_,locations:j}},[n]),N=H.useMemo(()=>DA(g),[g]),E=H.useMemo(()=>qr(g),[g]);H.useMemo(()=>PA(g,e),[g,e]);const A=H.useMemo(()=>Object.values(ue).map(j=>{const S=g.filter(L=>L.type===j),O=S.reduce((L,M)=>L+(parseFloat(M.quantity)||0),0),B=S.reduce((L,M)=>L+(parseFloat(M.quantity)||0)*(parseFloat(M.unitPrice)||0),0);return{type:j,count:S.length,totalQuantity:O,totalValue:B,percentage:N.totalMovements>0?S.length/N.totalMovements*100:0}}),[g,N.totalMovements]),T=H.useMemo(()=>{const _={};return y.fuelTypes.forEach(j=>{const S=g.filter(M=>M.fuelType===j),O=S.reduce((M,V)=>M+(parseFloat(V.quantity)||0),0),B=S.reduce((M,V)=>M+(parseFloat(V.quantity)||0)*(parseFloat(V.unitPrice)||0),0),L=S.length>0?S.reduce((M,V)=>M+(parseFloat(V.unitPrice)||0),0)/S.length:0;_[j]={count:S.length,totalQuantity:O,totalValue:B,avgPrice:L,fuelInfo:Ss[j]||{}}}),_},[g,y.fuelTypes]),R=H.useMemo(()=>{const _={};return g.forEach(j=>{const S=new Date(j.createdAt||j.date),O=`${S.getFullYear()}-${String(S.getMonth()+1).padStart(2,"0")}`;_[O]||(_[O]={month:O,entradas:0,salidas:0,transferencias:0,ajustes:0,totalQuantity:0,totalValue:0});const B=parseFloat(j.quantity)||0,L=B*(parseFloat(j.unitPrice)||0);_[O][j.type]++,_[O].totalQuantity+=B,_[O].totalValue+=L}),Object.values(_).sort((j,S)=>j.month.localeCompare(S.month))},[g]),b=H.useMemo(()=>{const _={};return g.filter(j=>j.type===ue.SALIDA&&j.vehicleId).forEach(j=>{const S=j.vehicleId,O=parseFloat(j.quantity)||0;_[S]||(_[S]={vehicleId:S,totalConsumption:0,movementsCount:0,vehicle:t.find(B=>B.vehicleId===S)}),_[S].totalConsumption+=O,_[S].movementsCount++}),Object.values(_).sort((j,S)=>S.totalConsumption-j.totalConsumption).slice(0,10)},[g,t]),k=()=>{const _=["Fecha","Tipo","Combustible","Cantidad","Precio Unitario","Valor Total","Ubicacin Origen","Ubicacin Destino","Vehculo","Estado"],j=g.map(M=>[new Date(M.createdAt||M.date).toLocaleDateString(),M.type,M.fuelType,ce(M.quantity),Me(M.unitPrice),Me((parseFloat(M.quantity)||0)*(parseFloat(M.unitPrice)||0)),M.sourceLocation||M.location||"",M.destinationLocation||"",M.vehicleId||"",M.status]),S=[_,...j].map(M=>M.join(",")).join(`
`),O=new Blob([S],{type:"text/csv"}),B=URL.createObjectURL(O),L=document.createElement("a");L.href=B,L.download=`movimientos_${new Date().toISOString().slice(0,10)}.csv`,L.click(),URL.revokeObjectURL(B)};return s.jsxs("div",{className:"movement-reports",children:[s.jsxs("div",{className:"kpis-grid",children:[s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon movements",children:""}),s.jsx("div",{className:"kpi-value",children:N.totalMovements}),s.jsx("div",{className:"kpi-label",children:"Movimientos Totales"}),s.jsxs("div",{className:"kpi-trend positive",children:[s.jsx("span",{className:"trend-icon",children:""}),N.completedMovements," completados"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon movements",children:""}),s.jsx("div",{className:"kpi-value",children:ce(N.totalQuantity)}),s.jsx("div",{className:"kpi-label",children:"Cantidad Total (L)"}),s.jsxs("div",{className:"kpi-trend neutral",children:[s.jsx("span",{className:"trend-icon",children:""}),"Promedio: ",ce(N.totalQuantity/(N.totalMovements||1),1)," L"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon financial",children:""}),s.jsx("div",{className:"kpi-value",children:Me(E.totalCost)}),s.jsx("div",{className:"kpi-label",children:"Valor Total"}),s.jsxs("div",{className:"kpi-trend positive",children:[s.jsx("span",{className:"trend-icon",children:""}),Me(E.averageCostPerMovement)," promedio"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon movements",children:""}),s.jsx("div",{className:"kpi-value",children:N.pendingMovements}),s.jsx("div",{className:"kpi-label",children:"Pendientes"}),s.jsxs("div",{className:`kpi-trend ${N.pendingMovements>0?"negative":"positive"}`,children:[s.jsx("span",{className:"trend-icon",children:N.pendingMovements>0?"":""}),N.cancelledMovements," cancelados"]})]})]}),s.jsx("div",{className:"reports-filters",children:s.jsxs("div",{className:"filters-grid",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Tipo de Movimiento"}),s.jsxs("select",{className:"filter-select",value:i,onChange:_=>o(_.target.value),children:[s.jsx("option",{value:"all",children:"Todos los tipos"}),s.jsx("option",{value:ue.ENTRADA,children:"Entradas"}),s.jsx("option",{value:ue.SALIDA,children:"Salidas"}),s.jsx("option",{value:ue.TRANSFERENCIA,children:"Transferencias"}),s.jsx("option",{value:ue.AJUSTE,children:"Ajustes"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),s.jsxs("select",{className:"filter-select",value:c,onChange:_=>d(_.target.value),children:[s.jsx("option",{value:"all",children:"Todos los combustibles"}),y.fuelTypes.map(_=>s.jsx("option",{value:_,children:_},_))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Ubicacin"}),s.jsxs("select",{className:"filter-select",value:f,onChange:_=>p(_.target.value),children:[s.jsx("option",{value:"all",children:"Todas las ubicaciones"}),y.locations.map(_=>s.jsx("option",{value:_,children:_},_))]})]}),s.jsx("div",{className:"filter-actions",children:s.jsx("button",{className:"filter-btn secondary",onClick:k,children:" Exportar CSV"})})]})}),s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Movimientos por Tipo"})}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"movement-types-grid",children:A.map(_=>s.jsxs("div",{className:"movement-type-item",children:[s.jsxs("h4",{children:[_.type===ue.ENTRADA&&" Entradas",_.type===ue.SALIDA&&" Salidas",_.type===ue.TRANSFERENCIA&&" Transferencias",_.type===ue.AJUSTE&&" Ajustes"]}),s.jsxs("div",{className:"type-metrics",children:[s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-value",children:_.count}),s.jsx("span",{className:"metric-label",children:"Movimientos"})]}),s.jsxs("div",{className:"metric",children:[s.jsxs("span",{className:"metric-value",children:[ce(_.totalQuantity)," L"]}),s.jsx("span",{className:"metric-label",children:"Cantidad"})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-value",children:Me(_.totalValue)}),s.jsx("span",{className:"metric-label",children:"Valor"})]}),s.jsxs("div",{className:"metric",children:[s.jsxs("span",{className:"metric-value",children:[ce(_.percentage,1),"%"]}),s.jsx("span",{className:"metric-label",children:"Participacin"})]})]})]},_.type))})})]}),s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Anlisis por Tipo de Combustible"})}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"fuel-analysis-grid",children:Object.entries(T).map(([_,j])=>s.jsxs("div",{className:"fuel-analysis-item",children:[s.jsxs("h4",{children:[s.jsx("span",{style:{marginRight:"0.5rem"},children:j.fuelInfo.icon||""}),j.fuelInfo.name||_.toUpperCase()]}),s.jsxs("div",{className:"analysis-metrics",children:[s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Movimientos:"}),s.jsx("span",{className:"metric-value",children:j.count})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Cantidad:"}),s.jsxs("span",{className:"metric-value",children:[ce(j.totalQuantity)," ",j.fuelInfo.unit||"L"]})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Valor:"}),s.jsx("span",{className:"metric-value",children:Me(j.totalValue)})]}),s.jsxs("div",{className:"metric",children:[s.jsx("span",{className:"metric-label",children:"Precio Promedio:"}),s.jsx("span",{className:"metric-value",children:Me(j.avgPrice)})]})]})]},_))})})]}),b.length>0&&s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Top Vehculos por Consumo"})}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"top-vehicles-list",children:b.slice(0,5).map((_,j)=>s.jsxs("div",{className:"top-vehicle-item",children:[s.jsxs("div",{className:"vehicle-rank",children:["#",j+1]}),s.jsxs("div",{className:"vehicle-info",children:[s.jsx("h4",{children:_.vehicleId}),s.jsx("p",{children:_.vehicle?.name||"Nombre no disponible"})]}),s.jsxs("div",{className:"vehicle-consumption",children:[s.jsxs("span",{className:"consumption-value",children:[ce(_.totalConsumption)," L"]}),s.jsxs("span",{className:"consumption-movements",children:[_.movementsCount," movimientos"]})]})]},_.vehicleId))})})]}),R.length>0&&s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Tendencia Temporal"})}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"temporal-analysis",children:R.map(_=>s.jsxs("div",{className:"month-data",children:[s.jsx("h4",{children:_.month}),s.jsxs("div",{className:"month-metrics",children:[s.jsxs("div",{className:"metric small",children:[s.jsx("span",{className:"metric-label",children:" Entradas:"}),s.jsx("span",{className:"metric-value",children:_.entradas})]}),s.jsxs("div",{className:"metric small",children:[s.jsx("span",{className:"metric-label",children:" Salidas:"}),s.jsx("span",{className:"metric-value",children:_.salidas})]}),s.jsxs("div",{className:"metric small",children:[s.jsx("span",{className:"metric-label",children:" Transferencias:"}),s.jsx("span",{className:"metric-value",children:_.transferencias})]}),s.jsxs("div",{className:"metric small",children:[s.jsx("span",{className:"metric-label",children:" Valor:"}),s.jsx("span",{className:"metric-value",children:Me(_.totalValue)})]})]})]},_.month))})})]}),s.jsxs("div",{className:"report-table-container",children:[s.jsx("div",{className:"report-table-header",children:s.jsx("h3",{className:"report-table-title",children:" Movimientos Detallados"})}),s.jsx("div",{style:{overflowX:"auto"},children:s.jsxs("table",{className:"report-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Fecha"}),s.jsx("th",{children:"Tipo"}),s.jsx("th",{children:"Combustible"}),s.jsx("th",{children:"Cantidad"}),s.jsx("th",{children:"Precio Unit."}),s.jsx("th",{children:"Valor Total"}),s.jsx("th",{children:"Origen"}),s.jsx("th",{children:"Destino"}),s.jsx("th",{children:"Vehculo"}),s.jsx("th",{children:"Estado"})]})}),s.jsx("tbody",{children:g.slice(0,100).map((_,j)=>s.jsxs("tr",{children:[s.jsx("td",{children:new Date(_.createdAt||_.date).toLocaleDateString()}),s.jsx("td",{children:s.jsx("span",{className:`badge ${_.type===ue.ENTRADA?"success":_.type===ue.SALIDA?"warning":_.type===ue.TRANSFERENCIA?"info":"secondary"}`,children:_.type})}),s.jsx("td",{children:_.fuelType}),s.jsxs("td",{children:[ce(_.quantity)," L"]}),s.jsx("td",{children:Me(_.unitPrice)}),s.jsx("td",{children:Me((parseFloat(_.quantity)||0)*(parseFloat(_.unitPrice)||0))}),s.jsx("td",{children:_.sourceLocation||_.location||"-"}),s.jsx("td",{children:_.destinationLocation||"-"}),s.jsx("td",{children:_.vehicleId||"-"}),s.jsx("td",{children:s.jsx("span",{className:`badge ${_.status==="completado"?"success":_.status==="pendiente"?"warning":"danger"}`,children:_.status})})]},j))})]})}),g.length>100&&s.jsxs("div",{style:{padding:"1rem",textAlign:"center",color:"#64748b"},children:["Mostrando los primeros 100 de ",g.length," movimientos. Use los filtros para refinar la bsqueda."]})]})]})},dU=()=>{const{inventory:n,movements:e,vehicles:t,suppliers:i,userProfile:o}=Zn(),[c,d]=H.useState("dashboard"),[f,p]=H.useState({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10),end:new Date().toISOString().slice(0,10)});if(!(o?.combustiblesPermissions?.canViewReports||o?.role==="admin"))return s.jsx("div",{className:"reports-main",children:s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:""}),s.jsx("h3",{className:"empty-title",children:"Acceso Restringido"}),s.jsx("p",{className:"empty-message",children:"No tienes permisos para ver los reportes. Contacta a tu administrador."})]})});const y=H.useMemo(()=>MA(n),[n]),N=H.useMemo(()=>DA(e),[e]),E=H.useMemo(()=>OA(t,e),[t,e]),A=H.useMemo(()=>ry(n),[n]),T=H.useMemo(()=>ly(e),[e]),R=[{id:"dashboard",title:"Dashboard",subtitle:"Vista ejecutiva",icon:"",component:null},{id:"inventory",title:"Inventario",subtitle:"Stock y alertas",icon:"",component:rU},{id:"vehicles",title:"Vehculos",subtitle:"Consumo y eficiencia",icon:"",component:lU},{id:"movements",title:"Movimientos",subtitle:"Entradas y salidas",icon:"",component:uU},{id:"financial",title:"Financiero",subtitle:"Costos y ROI",icon:"",component:cU}],b=(j,S)=>{p(O=>({...O,[j]:S}))},k=()=>s.jsxs("div",{className:"dashboard-content",children:[A.length>0&&s.jsx("div",{className:"alerts-container",children:A.slice(0,3).map((j,S)=>s.jsxs("div",{className:`alert ${j.stockLevel==="critical"?"critical":"warning"}`,children:[s.jsx("span",{className:"alert-icon",children:""}),s.jsxs("div",{className:"alert-content",children:[s.jsxs("div",{className:"alert-title",children:["Stock ",j.stockLevel==="critical"?"Crtico":"Bajo",": ",j.productName]}),s.jsxs("div",{className:"alert-message",children:[j.location," - ",ce(j.currentStock)," ",j.unit,"(",Cn(j.percentage/100)," de capacidad)"]})]})]},S))}),s.jsxs("div",{className:"kpis-grid",children:[s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon inventory",children:""}),s.jsx("div",{className:"kpi-value",children:Me(y.totalValue)}),s.jsx("div",{className:"kpi-label",children:"Valor Total Inventario"}),s.jsxs("div",{className:"kpi-trend neutral",children:[s.jsx("span",{className:"trend-icon",children:""}),y.totalItems," productos activos"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon vehicles",children:""}),s.jsx("div",{className:"kpi-value",children:E.activeVehicles}),s.jsx("div",{className:"kpi-label",children:"Vehculos Activos"}),s.jsxs("div",{className:"kpi-trend positive",children:[s.jsx("span",{className:"trend-icon",children:""}),ce(E.totalHours)," horas trabajadas"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon movements",children:""}),s.jsx("div",{className:"kpi-value",children:N.totalMovements}),s.jsx("div",{className:"kpi-label",children:"Movimientos del Mes"}),s.jsxs("div",{className:"kpi-trend positive",children:[s.jsx("span",{className:"trend-icon",children:""}),N.completedMovements," completados"]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon financial",children:""}),s.jsx("div",{className:"kpi-value",children:ce(E.averageEfficiency,1)}),s.jsx("div",{className:"kpi-label",children:"Consumo Promedio (L/h)"}),s.jsxs("div",{className:"kpi-trend neutral",children:[s.jsx("span",{className:"trend-icon",children:""}),ce(E.totalConsumption)," L total"]})]})]}),T.confidence>0&&s.jsxs("div",{className:"chart-container",children:[s.jsxs("div",{className:"chart-header",children:[s.jsx("h3",{className:"chart-title",children:" Proyecciones de Consumo (30 das)"}),s.jsx("div",{className:"chart-actions",children:s.jsxs("span",{className:"badge info",children:["Confianza: ",ce(T.confidence),"%"]})})]}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"projections-grid",children:Object.entries(T.projectedConsumption).map(([j,S])=>s.jsxs("div",{className:"projection-item",children:[s.jsx("h4",{children:j.toUpperCase()}),s.jsxs("div",{className:"projection-value",children:[ce(S.projectedTotal)," L"]}),s.jsxs("div",{className:"projection-daily",children:[ce(S.dailyAverage)," L/da promedio"]})]},j))})})]}),s.jsxs("div",{className:"chart-container",children:[s.jsx("div",{className:"chart-header",children:s.jsx("h3",{className:"chart-title",children:" Stock Actual por Tipo de Combustible"})}),s.jsx("div",{className:"chart-content",children:s.jsx("div",{className:"stock-grid",children:Object.entries(y.stockByType).map(([j,S])=>s.jsxs("div",{className:"stock-item",children:[s.jsx("h4",{children:j.toUpperCase()}),s.jsxs("div",{className:"stock-value",children:[ce(S)," L"]}),s.jsx("div",{className:"stock-status",children:S>1e3?s.jsx("span",{className:"badge success",children:"Stock Bueno"}):S>500?s.jsx("span",{className:"badge warning",children:"Stock Bajo"}):s.jsx("span",{className:"badge danger",children:"Stock Crtico"})})]},j))})})]})]}),_=()=>{const j=R.find(S=>S.id===c);if(c==="dashboard")return k();if(j?.component){const S=j.component;return s.jsx(S,{inventory:n,movements:e,vehicles:t,suppliers:i,dateRange:f,onDateRangeChange:b})}return s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:""}),s.jsx("h3",{className:"empty-title",children:"Reporte en Desarrollo"}),s.jsx("p",{className:"empty-message",children:"Este reporte estar disponible prximamente."})]})};return s.jsxs("div",{className:"reports-main",children:[s.jsxs("div",{className:"reports-header",children:[s.jsxs("div",{className:"reports-title",children:[s.jsx("span",{className:"title-icon",children:""}),s.jsx("h1",{children:"Reportes y Anlisis"})]}),s.jsx("p",{className:"reports-subtitle",children:"Dashboard ejecutivo con anlisis en tiempo real del sistema de combustibles"})]}),s.jsx("div",{className:"reports-filters",children:s.jsxs("div",{className:"filters-grid",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Fecha Inicio"}),s.jsx("input",{type:"date",className:"filter-input",value:f.start,onChange:j=>b("start",j.target.value)})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:"Fecha Fin"}),s.jsx("input",{type:"date",className:"filter-input",value:f.end,onChange:j=>b("end",j.target.value)})]}),s.jsxs("div",{className:"filter-actions",children:[s.jsx("button",{className:"filter-btn secondary",onClick:()=>{const j=new Date,S=new Date(j.getFullYear(),j.getMonth()-1,j.getDate());p({start:S.toISOString().slice(0,10),end:j.toISOString().slice(0,10)})},children:" ltimo Mes"}),s.jsx("button",{className:"filter-btn primary",onClick:()=>window.location.reload(),children:" Actualizar"})]})]})}),s.jsx("div",{className:"reports-navigation",children:R.map(j=>s.jsxs("button",{className:`nav-tab ${c===j.id?"active":""}`,onClick:()=>d(j.id),children:[s.jsx("span",{className:"nav-tab-icon",children:j.icon}),s.jsxs("div",{className:"nav-tab-text",children:[s.jsx("span",{className:"nav-tab-title",children:j.title}),s.jsx("span",{className:"nav-tab-subtitle",children:j.subtitle})]})]},j.id))}),_()]})},hU=()=>{const[n,e]=H.useState("dashboard"),t=()=>{switch(n){case"dashboard":return s.jsx(WE,{});case"inventory":return s.jsx(aV,{});case"movements":return s.jsx(EV,{});case"vehicles":return s.jsx(VV,{});case"maintenance":return s.jsx(KV,{});case"products":return s.jsx(ZV,{});case"suppliers":return s.jsx(aU,{});case"reports":return s.jsx(dU,{});case"admin":return s.jsx(iU,{});default:return s.jsx(WE,{})}};return s.jsx(W2,{currentView:n,onViewChange:e,children:t()})},fU=()=>{const[n,e]=H.useState("login"),[t,i]=H.useState(!1),[o,c]=H.useState(""),[d,f]=H.useState(""),[p,g]=H.useState(""),[y,N]=H.useState(""),[E,A]=H.useState({email:"",password:"",confirmPassword:"",invitationCode:""}),[T,R]=H.useState(""),[b,k]=H.useState(null),_=async V=>{V.preventDefault(),i(!0),c("");try{await SR(Jc,p,y)}catch(U){console.error("Error en login:",U),c(B(U.code))}finally{i(!1)}},j=async()=>{i(!0),c("");try{const V=new Oa,U=await JR(Jc,V);b?await zE(U.user,b.code):await IA(U.user)}catch(V){console.error("Error en login con Google:",V),c("Error al iniciar sesin con Google")}finally{i(!1)}},S=async V=>{V.preventDefault(),i(!0),c(""),f("");try{const U=await SA(T);U.success?(k(U.invitation),f(`Invitacin vlida para: ${U.invitation.targetEmail}`),e("register"),A({...E,email:U.invitation.targetEmail,invitationCode:T})):c(U.error)}catch(U){console.error("Error validando invitacin:",U),c("Error validando cdigo de invitacin")}finally{i(!1)}},O=async V=>{if(V.preventDefault(),i(!0),c(""),E.password!==E.confirmPassword){c("Las contraseas no coinciden"),i(!1);return}if(E.password.length<6){c("La contrasea debe tener al menos 6 caracteres"),i(!1);return}try{const U=await wR(Jc,E.email,E.password),I=await zE(U.user,E.invitationCode);I.success?f("Registro exitoso! Bienvenido al sistema."):c(I.error)}catch(U){console.error("Error en registro:",U),c(B(U.code))}finally{i(!1)}},B=V=>{switch(V){case"auth/invalid-email":return"El formato del email es invlido";case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contrasea incorrecta";case"auth/invalid-credential":return"Email o contrasea incorrectos";case"auth/email-already-in-use":return"Este email ya est registrado";case"auth/weak-password":return"La contrasea es muy dbil";default:return"Error de autenticacin. Intntalo de nuevo."}},L=()=>{c(""),f(""),g(""),N(""),R(""),k(null),A({email:"",password:"",confirmPassword:"",invitationCode:""})},M=()=>{switch(n){case"login":return s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:_,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"email",children:"Email:"}),s.jsx("input",{id:"email",type:"email",value:p,onChange:V=>g(V.target.value),required:!0,disabled:t,placeholder:"tu-email@ejemplo.com"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"password",children:"Contrasea:"}),s.jsx("input",{id:"password",type:"password",value:y,onChange:V=>N(V.target.value),required:!0,disabled:t,placeholder:"Tu contrasea"})]}),s.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Iniciando sesin...":"Iniciar Sesin"})]}),s.jsx("div",{className:"auth-divider",children:s.jsx("span",{children:"o"})}),s.jsxs("button",{onClick:j,className:"auth-button google",disabled:t,children:[s.jsx("span",{children:""}),"Continuar con Google"]}),s.jsx("div",{className:"auth-actions",children:s.jsx("button",{className:"link-button",onClick:()=>{L(),e("invite")},children:"Tienes un cdigo de invitacin? Regstrate aqu"})})]});case"invite":return s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:S,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"inviteCode",children:"Cdigo de invitacin:"}),s.jsx("input",{id:"inviteCode",type:"text",value:T,onChange:V=>R(V.target.value.toUpperCase()),required:!0,disabled:t,placeholder:"XXXXXXXX",maxLength:8,style:{textTransform:"uppercase",fontFamily:"monospace"}}),s.jsx("small",{children:"Ingresa el cdigo de 8 caracteres que recibiste"})]}),s.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Validando...":"Validar Cdigo"})]}),s.jsx("div",{className:"auth-actions",children:s.jsx("button",{className:"link-button",onClick:()=>{L(),e("login")},children:"Volver al inicio de sesin"})})]});case"register":return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"invitation-info",children:s.jsxs("div",{className:"success-message",children:[" Cdigo vlido para: ",b?.targetEmail]})}),s.jsxs("form",{onSubmit:O,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"registerEmail",children:"Email:"}),s.jsx("input",{id:"registerEmail",type:"email",value:E.email,disabled:!0,className:"disabled-input"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"registerPassword",children:"Contrasea:"}),s.jsx("input",{id:"registerPassword",type:"password",value:E.password,onChange:V=>A({...E,password:V.target.value}),required:!0,disabled:t,placeholder:"Mnimo 6 caracteres",minLength:6})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar contrasea:"}),s.jsx("input",{id:"confirmPassword",type:"password",value:E.confirmPassword,onChange:V=>A({...E,confirmPassword:V.target.value}),required:!0,disabled:t,placeholder:"Repite tu contrasea"})]}),s.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Registrando...":"Crear Cuenta"})]}),s.jsx("div",{className:"auth-divider",children:s.jsx("span",{children:"o"})}),s.jsxs("button",{onClick:j,className:"auth-button google",disabled:t,children:[s.jsx("span",{children:""}),"Registrarse con Google"]}),s.jsx("div",{className:"auth-actions",children:s.jsx("button",{className:"link-button",onClick:()=>{L(),e("invite")},children:"Usar otro cdigo de invitacin"})})]});default:return null}};return s.jsx("div",{className:"auth-container",children:s.jsxs("div",{className:"auth-card",children:[s.jsxs("div",{className:"auth-header",children:[s.jsx("h1",{children:" Combustibles"}),s.jsx("h2",{children:"Forestech Colombia"}),s.jsxs("p",{children:[n==="login"&&"Sistema de gestin de combustibles",n==="invite"&&"Validar cdigo de invitacin",n==="register"&&"Crear nueva cuenta"]})]}),s.jsxs("div",{className:"auth-form",children:[o&&s.jsx("div",{className:"error-message",children:o}),d&&s.jsx("div",{className:"success-message",children:d}),M(),s.jsx("div",{className:"auth-footer",children:s.jsx("p",{children:s.jsxs("small",{children:["Solo usuarios autorizados pueden acceder al sistema.",s.jsx("br",{}),n==="login"?"Contacta al administrador para obtener un cdigo de invitacin.":"Si no tienes cdigo, contacta al administrador."]})})})]})]})})};function mU(){return s.jsx(X2,{children:s.jsx(pU,{})})}function pU(){const{user:n,loading:e}=Zn();return e?s.jsx("div",{className:"loading-container",children:s.jsxs("div",{className:"loader",children:[s.jsx("div",{className:"spinner"}),s.jsx("p",{children:"Cargando..."})]})}):s.jsxs("div",{className:"App",children:[!n&&s.jsx(fU,{}),n&&s.jsx(hU,{})]})}Qw.createRoot(document.getElementById("root")).render(s.jsx(H.StrictMode,{children:s.jsx(mU,{})}));
