(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var bp={exports:{}},xc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fE;function _C(){if(fE)return xc;fE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var m in o)m!=="key"&&(c[m]=o[m])}else c=o;return o=c.ref,{$$typeof:n,type:a,key:d,ref:o!==void 0?o:null,props:c}}return xc.Fragment=e,xc.jsx=t,xc.jsxs=t,xc}var mE;function bC(){return mE||(mE=1,bp.exports=_C()),bp.exports}var r=bC(),Ep={exports:{}},Pe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pE;function EC(){if(pE)return Pe;pE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),b=Symbol.iterator;function A(q){return q===null||typeof q!="object"?null:(q=b&&q[b]||q["@@iterator"],typeof q=="function"?q:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,S={};function x(q,ee,ce){this.props=q,this.context=ee,this.refs=S,this.updater=ce||j}x.prototype.isReactComponent={},x.prototype.setState=function(q,ee){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,ee,"setState")},x.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function F(){}F.prototype=x.prototype;function Y(q,ee,ce){this.props=q,this.context=ee,this.refs=S,this.updater=ce||j}var V=Y.prototype=new F;V.constructor=Y,T(V,x.prototype),V.isPureReactComponent=!0;var O=Array.isArray,U={H:null,A:null,T:null,S:null,V:null},W=Object.prototype.hasOwnProperty;function L(q,ee,ce,ue,xe,qe){return ce=qe.ref,{$$typeof:n,type:q,key:ee,ref:ce!==void 0?ce:null,props:qe}}function D(q,ee){return L(q.type,ee,void 0,void 0,void 0,q.props)}function k(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function w(q){var ee={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(ce){return ee[ce]})}var C=/\/+/g;function R(q,ee){return typeof q=="object"&&q!==null&&q.key!=null?w(""+q.key):ee.toString(36)}function P(){}function Ee(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(P,P):(q.status="pending",q.then(function(ee){q.status==="pending"&&(q.status="fulfilled",q.value=ee)},function(ee){q.status==="pending"&&(q.status="rejected",q.reason=ee)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function ne(q,ee,ce,ue,xe){var qe=typeof q;(qe==="undefined"||qe==="boolean")&&(q=null);var Re=!1;if(q===null)Re=!0;else switch(qe){case"bigint":case"string":case"number":Re=!0;break;case"object":switch(q.$$typeof){case n:case e:Re=!0;break;case _:return Re=q._init,ne(Re(q._payload),ee,ce,ue,xe)}}if(Re)return xe=xe(q),Re=ue===""?"."+R(q,0):ue,O(xe)?(ce="",Re!=null&&(ce=Re.replace(C,"$&/")+"/"),ne(xe,ee,ce,"",function(As){return As})):xe!=null&&(k(xe)&&(xe=D(xe,ce+(xe.key==null||q&&q.key===xe.key?"":(""+xe.key).replace(C,"$&/")+"/")+Re)),ee.push(xe)),1;Re=0;var Ht=ue===""?".":ue+":";if(O(q))for(var mt=0;mt<q.length;mt++)ue=q[mt],qe=Ht+R(ue,mt),Re+=ne(ue,ee,ce,qe,xe);else if(mt=A(q),typeof mt=="function")for(q=mt.call(q),mt=0;!(ue=q.next()).done;)ue=ue.value,qe=Ht+R(ue,mt++),Re+=ne(ue,ee,ce,qe,xe);else if(qe==="object"){if(typeof q.then=="function")return ne(Ee(q),ee,ce,ue,xe);throw ee=String(q),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return Re}function z(q,ee,ce){if(q==null)return q;var ue=[],xe=0;return ne(q,ue,"","",function(qe){return ee.call(ce,qe,xe++)}),ue}function se(q){if(q._status===-1){var ee=q._result;ee=ee(),ee.then(function(ce){(q._status===0||q._status===-1)&&(q._status=1,q._result=ce)},function(ce){(q._status===0||q._status===-1)&&(q._status=2,q._result=ce)}),q._status===-1&&(q._status=0,q._result=ee)}if(q._status===1)return q._result.default;throw q._result}var he=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)};function ye(){}return Pe.Children={map:z,forEach:function(q,ee,ce){z(q,function(){ee.apply(this,arguments)},ce)},count:function(q){var ee=0;return z(q,function(){ee++}),ee},toArray:function(q){return z(q,function(ee){return ee})||[]},only:function(q){if(!k(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},Pe.Component=x,Pe.Fragment=t,Pe.Profiler=o,Pe.PureComponent=Y,Pe.StrictMode=a,Pe.Suspense=p,Pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,Pe.__COMPILER_RUNTIME={__proto__:null,c:function(q){return U.H.useMemoCache(q)}},Pe.cache=function(q){return function(){return q.apply(null,arguments)}},Pe.cloneElement=function(q,ee,ce){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var ue=T({},q.props),xe=q.key,qe=void 0;if(ee!=null)for(Re in ee.ref!==void 0&&(qe=void 0),ee.key!==void 0&&(xe=""+ee.key),ee)!W.call(ee,Re)||Re==="key"||Re==="__self"||Re==="__source"||Re==="ref"&&ee.ref===void 0||(ue[Re]=ee[Re]);var Re=arguments.length-2;if(Re===1)ue.children=ce;else if(1<Re){for(var Ht=Array(Re),mt=0;mt<Re;mt++)Ht[mt]=arguments[mt+2];ue.children=Ht}return L(q.type,xe,void 0,void 0,qe,ue)},Pe.createContext=function(q){return q={$$typeof:d,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:c,_context:q},q},Pe.createElement=function(q,ee,ce){var ue,xe={},qe=null;if(ee!=null)for(ue in ee.key!==void 0&&(qe=""+ee.key),ee)W.call(ee,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(xe[ue]=ee[ue]);var Re=arguments.length-2;if(Re===1)xe.children=ce;else if(1<Re){for(var Ht=Array(Re),mt=0;mt<Re;mt++)Ht[mt]=arguments[mt+2];xe.children=Ht}if(q&&q.defaultProps)for(ue in Re=q.defaultProps,Re)xe[ue]===void 0&&(xe[ue]=Re[ue]);return L(q,qe,void 0,void 0,null,xe)},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(q){return{$$typeof:m,render:q}},Pe.isValidElement=k,Pe.lazy=function(q){return{$$typeof:_,_payload:{_status:-1,_result:q},_init:se}},Pe.memo=function(q,ee){return{$$typeof:v,type:q,compare:ee===void 0?null:ee}},Pe.startTransition=function(q){var ee=U.T,ce={};U.T=ce;try{var ue=q(),xe=U.S;xe!==null&&xe(ce,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(ye,he)}catch(qe){he(qe)}finally{U.T=ee}},Pe.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},Pe.use=function(q){return U.H.use(q)},Pe.useActionState=function(q,ee,ce){return U.H.useActionState(q,ee,ce)},Pe.useCallback=function(q,ee){return U.H.useCallback(q,ee)},Pe.useContext=function(q){return U.H.useContext(q)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(q,ee){return U.H.useDeferredValue(q,ee)},Pe.useEffect=function(q,ee,ce){var ue=U.H;if(typeof ce=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ue.useEffect(q,ee)},Pe.useId=function(){return U.H.useId()},Pe.useImperativeHandle=function(q,ee,ce){return U.H.useImperativeHandle(q,ee,ce)},Pe.useInsertionEffect=function(q,ee){return U.H.useInsertionEffect(q,ee)},Pe.useLayoutEffect=function(q,ee){return U.H.useLayoutEffect(q,ee)},Pe.useMemo=function(q,ee){return U.H.useMemo(q,ee)},Pe.useOptimistic=function(q,ee){return U.H.useOptimistic(q,ee)},Pe.useReducer=function(q,ee,ce){return U.H.useReducer(q,ee,ce)},Pe.useRef=function(q){return U.H.useRef(q)},Pe.useState=function(q){return U.H.useState(q)},Pe.useSyncExternalStore=function(q,ee,ce){return U.H.useSyncExternalStore(q,ee,ce)},Pe.useTransition=function(){return U.H.useTransition()},Pe.version="19.1.0",Pe}var gE;function jg(){return gE||(gE=1,Ep.exports=EC()),Ep.exports}var $=jg(),Np={exports:{}},Tc={},xp={exports:{}},Tp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vE;function NC(){return vE||(vE=1,function(n){function e(z,se){var he=z.length;z.push(se);e:for(;0<he;){var ye=he-1>>>1,q=z[ye];if(0<o(q,se))z[ye]=se,z[he]=q,he=ye;else break e}}function t(z){return z.length===0?null:z[0]}function a(z){if(z.length===0)return null;var se=z[0],he=z.pop();if(he!==se){z[0]=he;e:for(var ye=0,q=z.length,ee=q>>>1;ye<ee;){var ce=2*(ye+1)-1,ue=z[ce],xe=ce+1,qe=z[xe];if(0>o(ue,he))xe<q&&0>o(qe,ue)?(z[ye]=qe,z[xe]=he,ye=xe):(z[ye]=ue,z[ce]=he,ye=ce);else if(xe<q&&0>o(qe,he))z[ye]=qe,z[xe]=he,ye=xe;else break e}}return se}function o(z,se){var he=z.sortIndex-se.sortIndex;return he!==0?he:z.id-se.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,m=d.now();n.unstable_now=function(){return d.now()-m}}var p=[],v=[],_=1,b=null,A=3,j=!1,T=!1,S=!1,x=!1,F=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;function O(z){for(var se=t(v);se!==null;){if(se.callback===null)a(v);else if(se.startTime<=z)a(v),se.sortIndex=se.expirationTime,e(p,se);else break;se=t(v)}}function U(z){if(S=!1,O(z),!T)if(t(p)!==null)T=!0,W||(W=!0,R());else{var se=t(v);se!==null&&ne(U,se.startTime-z)}}var W=!1,L=-1,D=5,k=-1;function w(){return x?!0:!(n.unstable_now()-k<D)}function C(){if(x=!1,W){var z=n.unstable_now();k=z;var se=!0;try{e:{T=!1,S&&(S=!1,Y(L),L=-1),j=!0;var he=A;try{t:{for(O(z),b=t(p);b!==null&&!(b.expirationTime>z&&w());){var ye=b.callback;if(typeof ye=="function"){b.callback=null,A=b.priorityLevel;var q=ye(b.expirationTime<=z);if(z=n.unstable_now(),typeof q=="function"){b.callback=q,O(z),se=!0;break t}b===t(p)&&a(p),O(z)}else a(p);b=t(p)}if(b!==null)se=!0;else{var ee=t(v);ee!==null&&ne(U,ee.startTime-z),se=!1}}break e}finally{b=null,A=he,j=!1}se=void 0}}finally{se?R():W=!1}}}var R;if(typeof V=="function")R=function(){V(C)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,Ee=P.port2;P.port1.onmessage=C,R=function(){Ee.postMessage(null)}}else R=function(){F(C,0)};function ne(z,se){L=F(function(){z(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(z){z.callback=null},n.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<z?Math.floor(1e3/z):5},n.unstable_getCurrentPriorityLevel=function(){return A},n.unstable_next=function(z){switch(A){case 1:case 2:case 3:var se=3;break;default:se=A}var he=A;A=se;try{return z()}finally{A=he}},n.unstable_requestPaint=function(){x=!0},n.unstable_runWithPriority=function(z,se){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var he=A;A=z;try{return se()}finally{A=he}},n.unstable_scheduleCallback=function(z,se,he){var ye=n.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?ye+he:ye):he=ye,z){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=he+q,z={id:_++,callback:se,priorityLevel:z,startTime:he,expirationTime:q,sortIndex:-1},he>ye?(z.sortIndex=he,e(v,z),t(p)===null&&z===t(v)&&(S?(Y(L),L=-1):S=!0,ne(U,he-ye))):(z.sortIndex=q,e(p,z),T||j||(T=!0,W||(W=!0,R()))),z},n.unstable_shouldYield=w,n.unstable_wrapCallback=function(z){var se=A;return function(){var he=A;A=se;try{return z.apply(this,arguments)}finally{A=he}}}}(Tp)),Tp}var yE;function xC(){return yE||(yE=1,xp.exports=NC()),xp.exports}var Ap={exports:{}},dn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _E;function TC(){if(_E)return dn;_E=1;var n=jg();function e(p){var v="https://react.dev/errors/"+p;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)v+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,v,_){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:b==null?null:""+b,children:p,containerInfo:v,implementation:_}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(p,v){if(p==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,dn.createPortal=function(p,v){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(e(299));return c(p,v,null,_)},dn.flushSync=function(p){var v=d.T,_=a.p;try{if(d.T=null,a.p=2,p)return p()}finally{d.T=v,a.p=_,a.d.f()}},dn.preconnect=function(p,v){typeof p=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,a.d.C(p,v))},dn.prefetchDNS=function(p){typeof p=="string"&&a.d.D(p)},dn.preinit=function(p,v){if(typeof p=="string"&&v&&typeof v.as=="string"){var _=v.as,b=m(_,v.crossOrigin),A=typeof v.integrity=="string"?v.integrity:void 0,j=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;_==="style"?a.d.S(p,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:b,integrity:A,fetchPriority:j}):_==="script"&&a.d.X(p,{crossOrigin:b,integrity:A,fetchPriority:j,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},dn.preinitModule=function(p,v){if(typeof p=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var _=m(v.as,v.crossOrigin);a.d.M(p,{crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&a.d.M(p)},dn.preload=function(p,v){if(typeof p=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var _=v.as,b=m(_,v.crossOrigin);a.d.L(p,_,{crossOrigin:b,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},dn.preloadModule=function(p,v){if(typeof p=="string")if(v){var _=m(v.as,v.crossOrigin);a.d.m(p,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else a.d.m(p)},dn.requestFormReset=function(p){a.d.r(p)},dn.unstable_batchedUpdates=function(p,v){return p(v)},dn.useFormState=function(p,v,_){return d.H.useFormState(p,v,_)},dn.useFormStatus=function(){return d.H.useHostTransitionStatus()},dn.version="19.1.0",dn}var bE;function AC(){if(bE)return Ap.exports;bE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ap.exports=TC(),Ap.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EE;function jC(){if(EE)return Tc;EE=1;var n=xC(),e=jg(),t=AC();function a(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var i=s,l=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(l=i.return),s=i.return;while(s)}return i.tag===3?l:null}function d(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function m(s){if(c(s)!==s)throw Error(a(188))}function p(s){var i=s.alternate;if(!i){if(i=c(s),i===null)throw Error(a(188));return i!==s?null:s}for(var l=s,u=i;;){var f=l.return;if(f===null)break;var g=f.alternate;if(g===null){if(u=f.return,u!==null){l=u;continue}break}if(f.child===g.child){for(g=f.child;g;){if(g===l)return m(f),s;if(g===u)return m(f),i;g=g.sibling}throw Error(a(188))}if(l.return!==u.return)l=f,u=g;else{for(var N=!1,I=f.child;I;){if(I===l){N=!0,l=f,u=g;break}if(I===u){N=!0,u=f,l=g;break}I=I.sibling}if(!N){for(I=g.child;I;){if(I===l){N=!0,l=g,u=f;break}if(I===u){N=!0,u=g,l=f;break}I=I.sibling}if(!N)throw Error(a(189))}}if(l.alternate!==u)throw Error(a(190))}if(l.tag!==3)throw Error(a(188));return l.stateNode.current===l?s:i}function v(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=v(s),i!==null)return i;s=s.sibling}return null}var _=Object.assign,b=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),Y=Symbol.for("react.consumer"),V=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),w=Symbol.for("react.memo_cache_sentinel"),C=Symbol.iterator;function R(s){return s===null||typeof s!="object"?null:(s=C&&s[C]||s["@@iterator"],typeof s=="function"?s:null)}var P=Symbol.for("react.client.reference");function Ee(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===P?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case T:return"Fragment";case x:return"Profiler";case S:return"StrictMode";case U:return"Suspense";case W:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case j:return"Portal";case V:return(s.displayName||"Context")+".Provider";case Y:return(s._context.displayName||"Context")+".Consumer";case O:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case L:return i=s.displayName||null,i!==null?i:Ee(s.type)||"Memo";case D:i=s._payload,s=s._init;try{return Ee(s(i))}catch{}}return null}var ne=Array.isArray,z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he={pending:!1,data:null,method:null,action:null},ye=[],q=-1;function ee(s){return{current:s}}function ce(s){0>q||(s.current=ye[q],ye[q]=null,q--)}function ue(s,i){q++,ye[q]=s.current,s.current=i}var xe=ee(null),qe=ee(null),Re=ee(null),Ht=ee(null);function mt(s,i){switch(ue(Re,i),ue(qe,s),ue(xe,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?qb(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=qb(i),s=Bb(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ce(xe),ue(xe,s)}function As(){ce(xe),ce(qe),ce(Re)}function ka(s){s.memoizedState!==null&&ue(Ht,s);var i=xe.current,l=Bb(i,s.type);i!==l&&(ue(qe,s),ue(xe,l))}function Zs(s){qe.current===s&&(ce(xe),ce(qe)),Ht.current===s&&(ce(Ht),yc._currentValue=he)}var Vi=Object.prototype.hasOwnProperty,Ui=n.unstable_scheduleCallback,Fi=n.unstable_cancelCallback,pl=n.unstable_shouldYield,Eu=n.unstable_requestPaint,Yn=n.unstable_now,bf=n.unstable_getCurrentPriorityLevel,gl=n.unstable_ImmediatePriority,qr=n.unstable_UserBlockingPriority,qi=n.unstable_NormalPriority,Ef=n.unstable_LowPriority,Br=n.unstable_IdlePriority,vl=n.log,Nu=n.unstable_setDisableYieldValue,xt=null,st=null;function Mn(s){if(typeof vl=="function"&&Nu(s),st&&typeof st.setStrictMode=="function")try{st.setStrictMode(xt,s)}catch{}}var cn=Math.clz32?Math.clz32:Bi,xu=Math.log,Nf=Math.LN2;function Bi(s){return s>>>=0,s===0?32:31-(xu(s)/Nf|0)|0}var zi=256,Hi=4194304;function us(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function zr(s,i,l){var u=s.pendingLanes;if(u===0)return 0;var f=0,g=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var I=u&134217727;return I!==0?(u=I&~g,u!==0?f=us(u):(N&=I,N!==0?f=us(N):l||(l=I&~s,l!==0&&(f=us(l))))):(I=u&~g,I!==0?f=us(I):N!==0?f=us(N):l||(l=u&~s,l!==0&&(f=us(l)))),f===0?0:i!==0&&i!==f&&(i&g)===0&&(g=f&-f,l=i&-i,g>=l||g===32&&(l&4194048)!==0)?i:f}function Gi(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function yl(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _l(){var s=zi;return zi<<=1,(zi&4194048)===0&&(zi=256),s}function bl(){var s=Hi;return Hi<<=1,(Hi&62914560)===0&&(Hi=4194304),s}function Js(s){for(var i=[],l=0;31>l;l++)i.push(s);return i}function ea(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function El(s,i,l,u,f,g){var N=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var I=s.entanglements,B=s.expirationTimes,X=s.hiddenUpdates;for(l=N&~l;0<l;){var ae=31-cn(l),oe=1<<ae;I[ae]=0,B[ae]=-1;var Z=X[ae];if(Z!==null)for(X[ae]=null,ae=0;ae<Z.length;ae++){var J=Z[ae];J!==null&&(J.lane&=-536870913)}l&=~oe}u!==0&&js(s,u,0),g!==0&&f===0&&s.tag!==0&&(s.suspendedLanes|=g&~(N&~i))}function js(s,i,l){s.pendingLanes|=i,s.suspendedLanes&=~i;var u=31-cn(i);s.entangledLanes|=i,s.entanglements[u]=s.entanglements[u]|1073741824|l&4194090}function Nl(s,i){var l=s.entangledLanes|=i;for(s=s.entanglements;l;){var u=31-cn(l),f=1<<u;f&i|s[u]&i&&(s[u]|=i),l&=~f}}function Pa(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Hr(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function La(){var s=se.p;return s!==0?s:(s=window.event,s===void 0?32:oE(s.type))}function Tu(s,i){var l=se.p;try{return se.p=s,i()}finally{se.p=l}}var yt=Math.random().toString(36).slice(2),Pt="__reactFiber$"+yt,It="__reactProps$"+yt,Kn="__reactContainer$"+yt,xl="__reactEvents$"+yt,xf="__reactListeners$"+yt,Va="__reactHandles$"+yt,Au="__reactResources$"+yt,$i="__reactMarker$"+yt;function Ua(s){delete s[Pt],delete s[It],delete s[xl],delete s[xf],delete s[Va]}function ta(s){var i=s[Pt];if(i)return i;for(var l=s.parentNode;l;){if(i=l[Kn]||l[Pt]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(s=$b(s);s!==null;){if(l=s[Pt])return l;s=$b(s)}return i}s=l,l=s.parentNode}return null}function ws(s){if(s=s[Pt]||s[Kn]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function Cs(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(a(33))}function vn(s){var i=s[Au];return i||(i=s[Au]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function jt(s){s[$i]=!0}var Tl=new Set,Gr={};function ds(s,i){na(s,i),na(s+"Capture",i)}function na(s,i){for(Gr[s]=i,s=0;s<i.length;s++)Tl.add(i[s])}var ju=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wu={},Yi={};function Cu(s){return Vi.call(Yi,s)?!0:Vi.call(wu,s)?!1:ju.test(s)?Yi[s]=!0:(wu[s]=!0,!1)}function Fa(s,i,l){if(Cu(i))if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+l)}}function Ss(s,i,l){if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+l)}}function Zt(s,i,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(i,l,""+u)}}var Ki,Su;function sa(s){if(Ki===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);Ki=i&&i[1]||"",Su=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ki+s+Su}var $r=!1;function Yr(s,i){if(!s||$r)return"";$r=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(J){var Z=J}Reflect.construct(s,[],oe)}else{try{oe.call()}catch(J){Z=J}s.call(oe.prototype)}}else{try{throw Error()}catch(J){Z=J}(oe=s())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(J){if(J&&Z&&typeof J.stack=="string")return[J.stack,Z.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),N=g[0],I=g[1];if(N&&I){var B=N.split(`
`),X=I.split(`
`);for(f=u=0;u<B.length&&!B[u].includes("DetermineComponentFrameRoot");)u++;for(;f<X.length&&!X[f].includes("DetermineComponentFrameRoot");)f++;if(u===B.length||f===X.length)for(u=B.length-1,f=X.length-1;1<=u&&0<=f&&B[u]!==X[f];)f--;for(;1<=u&&0<=f;u--,f--)if(B[u]!==X[f]){if(u!==1||f!==1)do if(u--,f--,0>f||B[u]!==X[f]){var ae=`
`+B[u].replace(" at new "," at ");return s.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",s.displayName)),ae}while(1<=u&&0<=f);break}}}finally{$r=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?sa(l):""}function Al(s){switch(s.tag){case 26:case 27:case 5:return sa(s.type);case 16:return sa("Lazy");case 13:return sa("Suspense");case 19:return sa("SuspenseList");case 0:case 15:return Yr(s.type,!1);case 11:return Yr(s.type.render,!1);case 1:return Yr(s.type,!0);case 31:return sa("Activity");default:return""}}function Kr(s){try{var i="";do i+=Al(s),s=s.return;while(s);return i}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function yn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function jl(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Tf(s){var i=jl(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),u=""+s[i];if(!s.hasOwnProperty(i)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var f=l.get,g=l.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return f.call(this)},set:function(N){u=""+N,g.call(this,N)}}),Object.defineProperty(s,i,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(N){u=""+N},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Qr(s){s._valueTracker||(s._valueTracker=Tf(s))}function wl(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var l=i.getValue(),u="";return s&&(u=jl(s)?s.checked?"true":"false":s.value),s=u,s!==l?(i.setValue(s),!0):!1}function Qi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Af=/[\n"\\]/g;function Rt(s){return s.replace(Af,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function On(s,i,l,u,f,g,N,I){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),i!=null?N==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+yn(i)):s.value!==""+yn(i)&&(s.value=""+yn(i)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),i!=null?qa(s,N,yn(i)):l!=null?qa(s,N,yn(l)):u!=null&&s.removeAttribute("value"),f==null&&g!=null&&(s.defaultChecked=!!g),f!=null&&(s.checked=f&&typeof f!="function"&&typeof f!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+yn(I):s.removeAttribute("name")}function Xi(s,i,l,u,f,g,N,I){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(s.type=g),i!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||i!=null))return;l=l!=null?""+yn(l):"",i=i!=null?""+yn(i):l,I||i===s.value||(s.value=i),s.defaultValue=i}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=I?s.checked:!!u,s.defaultChecked=!!u,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N)}function qa(s,i,l){i==="number"&&Qi(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function aa(s,i,l,u){if(s=s.options,i){i={};for(var f=0;f<l.length;f++)i["$"+l[f]]=!0;for(l=0;l<s.length;l++)f=i.hasOwnProperty("$"+s[l].value),s[l].selected!==f&&(s[l].selected=f),f&&u&&(s[l].defaultSelected=!0)}else{for(l=""+yn(l),i=null,f=0;f<s.length;f++){if(s[f].value===l){s[f].selected=!0,u&&(s[f].defaultSelected=!0);return}i!==null||s[f].disabled||(i=s[f])}i!==null&&(i.selected=!0)}}function ot(s,i,l){if(i!=null&&(i=""+yn(i),i!==s.value&&(s.value=i),l==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=l!=null?""+yn(l):""}function Wi(s,i,l,u){if(i==null){if(u!=null){if(l!=null)throw Error(a(92));if(ne(u)){if(1<u.length)throw Error(a(93));u=u[0]}l=u}l==null&&(l=""),i=l}l=yn(i),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u)}function Qn(s,i){if(i){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=i;return}}s.textContent=i}var Zi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Iu(s,i,l){var u=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":u?s.setProperty(i,l):typeof l!="number"||l===0||Zi.has(i)?i==="float"?s.cssFloat=l:s[i]=(""+l).trim():s[i]=l+"px"}function Cl(s,i,l){if(i!=null&&typeof i!="object")throw Error(a(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var f in i)u=i[f],i.hasOwnProperty(f)&&l[f]!==u&&Iu(s,f,u)}else for(var g in i)i.hasOwnProperty(g)&&Iu(s,g,i[g])}function Sl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xr(s){return wf.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var ia=null;function Xn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ra=null,oa=null;function Il(s){var i=ws(s);if(i&&(s=i.stateNode)){var l=s[It]||null;e:switch(s=i.stateNode,i.type){case"input":if(On(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Rt(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var u=l[i];if(u!==s&&u.form===s.form){var f=u[It]||null;if(!f)throw Error(a(90));On(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(i=0;i<l.length;i++)u=l[i],u.form===s.form&&wl(u)}break e;case"textarea":ot(s,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&aa(s,!!l.multiple,i,!1)}}}var Is=!1;function Ru(s,i,l){if(Is)return s(i,l);Is=!0;try{var u=s(i);return u}finally{if(Is=!1,(ra!==null||oa!==null)&&(Td(),ra&&(i=ra,s=oa,oa=ra=null,Il(i),s)))for(i=0;i<s.length;i++)Il(s[i])}}function Ji(s,i){var l=s.stateNode;if(l===null)return null;var u=l[It]||null;if(u===null)return null;l=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(a(231,i,typeof l));return l}var hs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wn=!1;if(hs)try{var er={};Object.defineProperty(er,"passive",{get:function(){Wn=!0}}),window.addEventListener("test",er,er),window.removeEventListener("test",er,er)}catch{Wn=!1}var Rs=null,Ba=null,la=null;function Rl(){if(la)return la;var s,i=Ba,l=i.length,u,f="value"in Rs?Rs.value:Rs.textContent,g=f.length;for(s=0;s<l&&i[s]===f[s];s++);var N=l-s;for(u=1;u<=N&&i[l-u]===f[g-u];u++);return la=f.slice(s,1<u?1-u:void 0)}function Ds(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Ms(){return!0}function Dl(){return!1}function Gt(s){function i(l,u,f,g,N){this._reactName=l,this._targetInst=f,this.type=u,this.nativeEvent=g,this.target=N,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(l=s[I],this[I]=l?l(g):g[I]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Ms:Dl,this.isPropagationStopped=Dl,this}return _(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ms)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ms)},persist:function(){},isPersistent:Ms}),i}var tt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wr=Gt(tt),tr=_({},tt,{view:0,detail:0}),Du=Gt(tr),Zr,Jr,Os,nr=_({},tr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ir,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Os&&(Os&&s.type==="mousemove"?(Zr=s.screenX-Os.screenX,Jr=s.screenY-Os.screenY):Jr=Zr=0,Os=s),Zr)},movementY:function(s){return"movementY"in s?s.movementY:Jr}}),Zn=Gt(nr),Mu=_({},nr,{dataTransfer:0}),Cf=Gt(Mu),sr=_({},tr,{relatedTarget:0}),eo=Gt(sr),Ml=_({},tt,{animationName:0,elapsedTime:0,pseudoElement:0}),to=Gt(Ml),Ou=_({},tt,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),no=Gt(Ou),Sf=_({},tt,{data:0}),Ol=Gt(Sf),ar={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ku={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kl(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Pu[s])?!!i[s]:!1}function ir(){return kl}var Lu=_({},tr,{key:function(s){if(s.key){var i=ar[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ds(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ku[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ir,charCode:function(s){return s.type==="keypress"?Ds(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ds(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),so=Gt(Lu),Vu=_({},nr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pl=Gt(Vu),ca=_({},tr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ir}),Uu=Gt(ca),Fu=_({},tt,{propertyName:0,elapsedTime:0,pseudoElement:0}),qu=Gt(Fu),Bu=_({},nr,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ao=Gt(Bu),_n=_({},tt,{newState:0,oldState:0}),zu=Gt(_n),Hu=[9,13,27,32],ks=hs&&"CompositionEvent"in window,h=null;hs&&"documentMode"in document&&(h=document.documentMode);var y=hs&&"TextEvent"in window&&!h,E=hs&&(!ks||h&&8<h&&11>=h),M=" ",K=!1;function te(s,i){switch(s){case"keyup":return Hu.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function de(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ke=!1;function Lt(s,i){switch(s){case"compositionend":return de(i);case"keypress":return i.which!==32?null:(K=!0,M);case"textInput":return s=i.data,s===M&&K?null:s;default:return null}}function Qe(s,i){if(Ke)return s==="compositionend"||!ks&&te(s,i)?(s=Rl(),la=Ba=Rs=null,Ke=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return E&&i.locale!=="ko"?null:i.data;default:return null}}var $t={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vt(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!$t[s.type]:i==="textarea"}function ua(s,i,l,u){ra?oa?oa.push(u):oa=[u]:ra=u,i=Id(i,"onChange"),0<i.length&&(l=new Wr("onChange","change",null,l,u),s.push({event:l,listeners:i}))}var Jt=null,Ps=null;function Ll(s){Pb(s,0)}function Gu(s){var i=Cs(s);if(wl(i))return s}function sy(s,i){if(s==="change")return i}var ay=!1;if(hs){var If;if(hs){var Rf="oninput"in document;if(!Rf){var iy=document.createElement("div");iy.setAttribute("oninput","return;"),Rf=typeof iy.oninput=="function"}If=Rf}else If=!1;ay=If&&(!document.documentMode||9<document.documentMode)}function ry(){Jt&&(Jt.detachEvent("onpropertychange",oy),Ps=Jt=null)}function oy(s){if(s.propertyName==="value"&&Gu(Ps)){var i=[];ua(i,Ps,s,Xn(s)),Ru(Ll,i)}}function Qj(s,i,l){s==="focusin"?(ry(),Jt=i,Ps=l,Jt.attachEvent("onpropertychange",oy)):s==="focusout"&&ry()}function Xj(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Gu(Ps)}function Wj(s,i){if(s==="click")return Gu(i)}function Zj(s,i){if(s==="input"||s==="change")return Gu(i)}function Jj(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var kn=typeof Object.is=="function"?Object.is:Jj;function Vl(s,i){if(kn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var l=Object.keys(s),u=Object.keys(i);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var f=l[u];if(!Vi.call(i,f)||!kn(s[f],i[f]))return!1}return!0}function ly(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function cy(s,i){var l=ly(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=i&&u>=i)return{node:l,offset:i-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=ly(l)}}function uy(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?uy(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function dy(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Qi(s.document);i instanceof s.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)s=i.contentWindow;else break;i=Qi(s.document)}return i}function Df(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var ew=hs&&"documentMode"in document&&11>=document.documentMode,io=null,Mf=null,Ul=null,Of=!1;function hy(s,i,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Of||io==null||io!==Qi(u)||(u=io,"selectionStart"in u&&Df(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ul&&Vl(Ul,u)||(Ul=u,u=Id(Mf,"onSelect"),0<u.length&&(i=new Wr("onSelect","select",null,i,l),s.push({event:i,listeners:u}),i.target=io)))}function rr(s,i){var l={};return l[s.toLowerCase()]=i.toLowerCase(),l["Webkit"+s]="webkit"+i,l["Moz"+s]="moz"+i,l}var ro={animationend:rr("Animation","AnimationEnd"),animationiteration:rr("Animation","AnimationIteration"),animationstart:rr("Animation","AnimationStart"),transitionrun:rr("Transition","TransitionRun"),transitionstart:rr("Transition","TransitionStart"),transitioncancel:rr("Transition","TransitionCancel"),transitionend:rr("Transition","TransitionEnd")},kf={},fy={};hs&&(fy=document.createElement("div").style,"AnimationEvent"in window||(delete ro.animationend.animation,delete ro.animationiteration.animation,delete ro.animationstart.animation),"TransitionEvent"in window||delete ro.transitionend.transition);function or(s){if(kf[s])return kf[s];if(!ro[s])return s;var i=ro[s],l;for(l in i)if(i.hasOwnProperty(l)&&l in fy)return kf[s]=i[l];return s}var my=or("animationend"),py=or("animationiteration"),gy=or("animationstart"),tw=or("transitionrun"),nw=or("transitionstart"),sw=or("transitioncancel"),vy=or("transitionend"),yy=new Map,Pf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pf.push("scrollEnd");function fs(s,i){yy.set(s,i),ds(i,[s])}var _y=new WeakMap;function Jn(s,i){if(typeof s=="object"&&s!==null){var l=_y.get(s);return l!==void 0?l:(i={value:s,source:i,stack:Kr(i)},_y.set(s,i),i)}return{value:s,source:i,stack:Kr(i)}}var es=[],oo=0,Lf=0;function $u(){for(var s=oo,i=Lf=oo=0;i<s;){var l=es[i];es[i++]=null;var u=es[i];es[i++]=null;var f=es[i];es[i++]=null;var g=es[i];if(es[i++]=null,u!==null&&f!==null){var N=u.pending;N===null?f.next=f:(f.next=N.next,N.next=f),u.pending=f}g!==0&&by(l,f,g)}}function Yu(s,i,l,u){es[oo++]=s,es[oo++]=i,es[oo++]=l,es[oo++]=u,Lf|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function Vf(s,i,l,u){return Yu(s,i,l,u),Ku(s)}function lo(s,i){return Yu(s,null,null,i),Ku(s)}function by(s,i,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var f=!1,g=s.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(s=g.stateNode,s===null||s._visibility&1||(f=!0)),s=g,g=g.return;return s.tag===3?(g=s.stateNode,f&&i!==null&&(f=31-cn(l),s=g.hiddenUpdates,u=s[f],u===null?s[f]=[i]:u.push(i),i.lane=l|536870912),g):null}function Ku(s){if(50<uc)throw uc=0,Hm=null,Error(a(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var co={};function aw(s,i,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(s,i,l,u){return new aw(s,i,l,u)}function Uf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function da(s,i){var l=s.alternate;return l===null?(l=Pn(s.tag,i,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=i,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,i=s.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Ey(s,i){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,i=l.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Qu(s,i,l,u,f,g){var N=0;if(u=s,typeof s=="function")Uf(s)&&(N=1);else if(typeof s=="string")N=rC(s,l,xe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=Pn(31,l,i,f),s.elementType=k,s.lanes=g,s;case T:return lr(l.children,f,g,i);case S:N=8,f|=24;break;case x:return s=Pn(12,l,i,f|2),s.elementType=x,s.lanes=g,s;case U:return s=Pn(13,l,i,f),s.elementType=U,s.lanes=g,s;case W:return s=Pn(19,l,i,f),s.elementType=W,s.lanes=g,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case F:case V:N=10;break e;case Y:N=9;break e;case O:N=11;break e;case L:N=14;break e;case D:N=16,u=null;break e}N=29,l=Error(a(130,s===null?"null":typeof s,"")),u=null}return i=Pn(N,l,i,f),i.elementType=s,i.type=u,i.lanes=g,i}function lr(s,i,l,u){return s=Pn(7,s,u,i),s.lanes=l,s}function Ff(s,i,l){return s=Pn(6,s,null,i),s.lanes=l,s}function qf(s,i,l){return i=Pn(4,s.children!==null?s.children:[],s.key,i),i.lanes=l,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var uo=[],ho=0,Xu=null,Wu=0,ts=[],ns=0,cr=null,ha=1,fa="";function ur(s,i){uo[ho++]=Wu,uo[ho++]=Xu,Xu=s,Wu=i}function Ny(s,i,l){ts[ns++]=ha,ts[ns++]=fa,ts[ns++]=cr,cr=s;var u=ha;s=fa;var f=32-cn(u)-1;u&=~(1<<f),l+=1;var g=32-cn(i)+f;if(30<g){var N=f-f%5;g=(u&(1<<N)-1).toString(32),u>>=N,f-=N,ha=1<<32-cn(i)+f|l<<f|u,fa=g+s}else ha=1<<g|l<<f|u,fa=s}function Bf(s){s.return!==null&&(ur(s,1),Ny(s,1,0))}function zf(s){for(;s===Xu;)Xu=uo[--ho],uo[ho]=null,Wu=uo[--ho],uo[ho]=null;for(;s===cr;)cr=ts[--ns],ts[ns]=null,fa=ts[--ns],ts[ns]=null,ha=ts[--ns],ts[ns]=null}var bn=null,Tt=null,et=!1,dr=null,Ls=!1,Hf=Error(a(519));function hr(s){var i=Error(a(418,""));throw Bl(Jn(i,s)),Hf}function xy(s){var i=s.stateNode,l=s.type,u=s.memoizedProps;switch(i[Pt]=s,i[It]=u,l){case"dialog":Ge("cancel",i),Ge("close",i);break;case"iframe":case"object":case"embed":Ge("load",i);break;case"video":case"audio":for(l=0;l<hc.length;l++)Ge(hc[l],i);break;case"source":Ge("error",i);break;case"img":case"image":case"link":Ge("error",i),Ge("load",i);break;case"details":Ge("toggle",i);break;case"input":Ge("invalid",i),Xi(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Qr(i);break;case"select":Ge("invalid",i);break;case"textarea":Ge("invalid",i),Wi(i,u.value,u.defaultValue,u.children),Qr(i)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||u.suppressHydrationWarning===!0||Fb(i.textContent,l)?(u.popover!=null&&(Ge("beforetoggle",i),Ge("toggle",i)),u.onScroll!=null&&Ge("scroll",i),u.onScrollEnd!=null&&Ge("scrollend",i),u.onClick!=null&&(i.onclick=Rd),i=!0):i=!1,i||hr(s)}function Ty(s){for(bn=s.return;bn;)switch(bn.tag){case 5:case 13:Ls=!1;return;case 27:case 3:Ls=!0;return;default:bn=bn.return}}function Fl(s){if(s!==bn)return!1;if(!et)return Ty(s),et=!0,!1;var i=s.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||rp(s.type,s.memoizedProps)),l=!l),l&&Tt&&hr(s),Ty(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(i===0){Tt=ps(s.nextSibling);break e}i--}else l!=="$"&&l!=="$!"&&l!=="$?"||i++;s=s.nextSibling}Tt=null}}else i===27?(i=Tt,ai(s.type)?(s=up,up=null,Tt=s):Tt=i):Tt=bn?ps(s.stateNode.nextSibling):null;return!0}function ql(){Tt=bn=null,et=!1}function Ay(){var s=dr;return s!==null&&(Sn===null?Sn=s:Sn.push.apply(Sn,s),dr=null),s}function Bl(s){dr===null?dr=[s]:dr.push(s)}var Gf=ee(null),fr=null,ma=null;function za(s,i,l){ue(Gf,i._currentValue),i._currentValue=l}function pa(s){s._currentValue=Gf.current,ce(Gf)}function $f(s,i,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),s===l)break;s=s.return}}function Yf(s,i,l,u){var f=s.child;for(f!==null&&(f.return=s);f!==null;){var g=f.dependencies;if(g!==null){var N=f.child;g=g.firstContext;e:for(;g!==null;){var I=g;g=f;for(var B=0;B<i.length;B++)if(I.context===i[B]){g.lanes|=l,I=g.alternate,I!==null&&(I.lanes|=l),$f(g.return,l,s),u||(N=null);break e}g=I.next}}else if(f.tag===18){if(N=f.return,N===null)throw Error(a(341));N.lanes|=l,g=N.alternate,g!==null&&(g.lanes|=l),$f(N,l,s),N=null}else N=f.child;if(N!==null)N.return=f;else for(N=f;N!==null;){if(N===s){N=null;break}if(f=N.sibling,f!==null){f.return=N.return,N=f;break}N=N.return}f=N}}function zl(s,i,l,u){s=null;for(var f=i,g=!1;f!==null;){if(!g){if((f.flags&524288)!==0)g=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var N=f.alternate;if(N===null)throw Error(a(387));if(N=N.memoizedProps,N!==null){var I=f.type;kn(f.pendingProps.value,N.value)||(s!==null?s.push(I):s=[I])}}else if(f===Ht.current){if(N=f.alternate,N===null)throw Error(a(387));N.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(s!==null?s.push(yc):s=[yc])}f=f.return}s!==null&&Yf(i,s,l,u),i.flags|=262144}function Zu(s){for(s=s.firstContext;s!==null;){if(!kn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function mr(s){fr=s,ma=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function un(s){return jy(fr,s)}function Ju(s,i){return fr===null&&mr(s),jy(s,i)}function jy(s,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},ma===null){if(s===null)throw Error(a(308));ma=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else ma=ma.next=i;return l}var iw=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){i.aborted=!0,s.forEach(function(l){return l()})}},rw=n.unstable_scheduleCallback,ow=n.unstable_NormalPriority,Ut={$$typeof:V,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kf(){return{controller:new iw,data:new Map,refCount:0}}function Hl(s){s.refCount--,s.refCount===0&&rw(ow,function(){s.controller.abort()})}var Gl=null,Qf=0,fo=0,mo=null;function lw(s,i){if(Gl===null){var l=Gl=[];Qf=0,fo=Wm(),mo={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Qf++,i.then(wy,wy),i}function wy(){if(--Qf===0&&Gl!==null){mo!==null&&(mo.status="fulfilled");var s=Gl;Gl=null,fo=0,mo=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function cw(s,i){var l=[],u={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return s.then(function(){u.status="fulfilled",u.value=i;for(var f=0;f<l.length;f++)(0,l[f])(i)},function(f){for(u.status="rejected",u.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),u}var Cy=z.S;z.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&lw(s,i),Cy!==null&&Cy(s,i)};var pr=ee(null);function Xf(){var s=pr.current;return s!==null?s:pt.pooledCache}function ed(s,i){i===null?ue(pr,pr.current):ue(pr,i.pool)}function Sy(){var s=Xf();return s===null?null:{parent:Ut._currentValue,pool:s}}var $l=Error(a(460)),Iy=Error(a(474)),td=Error(a(542)),Wf={then:function(){}};function Ry(s){return s=s.status,s==="fulfilled"||s==="rejected"}function nd(){}function Dy(s,i,l){switch(l=s[l],l===void 0?s.push(i):l!==i&&(i.then(nd,nd),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Oy(s),s;default:if(typeof i.status=="string")i.then(nd,nd);else{if(s=pt,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=i,s.status="pending",s.then(function(u){if(i.status==="pending"){var f=i;f.status="fulfilled",f.value=u}},function(u){if(i.status==="pending"){var f=i;f.status="rejected",f.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Oy(s),s}throw Yl=i,$l}}var Yl=null;function My(){if(Yl===null)throw Error(a(459));var s=Yl;return Yl=null,s}function Oy(s){if(s===$l||s===td)throw Error(a(483))}var Ha=!1;function Zf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jf(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ga(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function $a(s,i,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(at&2)!==0){var f=u.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),u.pending=i,i=Ku(s),by(s,null,l),i}return Yu(s,u,i,l),Ku(s)}function Kl(s,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,Nl(s,l)}}function em(s,i){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var f=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var N={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?f=g=N:g=g.next=N,l=l.next}while(l!==null);g===null?f=g=i:g=g.next=i}else f=g=i;l={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=i:s.next=i,l.lastBaseUpdate=i}var tm=!1;function Ql(){if(tm){var s=mo;if(s!==null)throw s}}function Xl(s,i,l,u){tm=!1;var f=s.updateQueue;Ha=!1;var g=f.firstBaseUpdate,N=f.lastBaseUpdate,I=f.shared.pending;if(I!==null){f.shared.pending=null;var B=I,X=B.next;B.next=null,N===null?g=X:N.next=X,N=B;var ae=s.alternate;ae!==null&&(ae=ae.updateQueue,I=ae.lastBaseUpdate,I!==N&&(I===null?ae.firstBaseUpdate=X:I.next=X,ae.lastBaseUpdate=B))}if(g!==null){var oe=f.baseState;N=0,ae=X=B=null,I=g;do{var Z=I.lane&-536870913,J=Z!==I.lane;if(J?(Xe&Z)===Z:(u&Z)===Z){Z!==0&&Z===fo&&(tm=!0),ae!==null&&(ae=ae.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var Ie=s,Ae=I;Z=i;var ut=l;switch(Ae.tag){case 1:if(Ie=Ae.payload,typeof Ie=="function"){oe=Ie.call(ut,oe,Z);break e}oe=Ie;break e;case 3:Ie.flags=Ie.flags&-65537|128;case 0:if(Ie=Ae.payload,Z=typeof Ie=="function"?Ie.call(ut,oe,Z):Ie,Z==null)break e;oe=_({},oe,Z);break e;case 2:Ha=!0}}Z=I.callback,Z!==null&&(s.flags|=64,J&&(s.flags|=8192),J=f.callbacks,J===null?f.callbacks=[Z]:J.push(Z))}else J={lane:Z,tag:I.tag,payload:I.payload,callback:I.callback,next:null},ae===null?(X=ae=J,B=oe):ae=ae.next=J,N|=Z;if(I=I.next,I===null){if(I=f.shared.pending,I===null)break;J=I,I=J.next,J.next=null,f.lastBaseUpdate=J,f.shared.pending=null}}while(!0);ae===null&&(B=oe),f.baseState=B,f.firstBaseUpdate=X,f.lastBaseUpdate=ae,g===null&&(f.shared.lanes=0),ei|=N,s.lanes=N,s.memoizedState=oe}}function ky(s,i){if(typeof s!="function")throw Error(a(191,s));s.call(i)}function Py(s,i){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)ky(l[s],i)}var po=ee(null),sd=ee(0);function Ly(s,i){s=Na,ue(sd,s),ue(po,i),Na=s|i.baseLanes}function nm(){ue(sd,Na),ue(po,po.current)}function sm(){Na=sd.current,ce(po),ce(sd)}var Ya=0,Ue=null,lt=null,Dt=null,ad=!1,go=!1,gr=!1,id=0,Wl=0,vo=null,uw=0;function wt(){throw Error(a(321))}function am(s,i){if(i===null)return!1;for(var l=0;l<i.length&&l<s.length;l++)if(!kn(s[l],i[l]))return!1;return!0}function im(s,i,l,u,f,g){return Ya=g,Ue=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,z.H=s===null||s.memoizedState===null?b_:E_,gr=!1,g=l(u,f),gr=!1,go&&(g=Uy(i,l,u,f)),Vy(s),g}function Vy(s){z.H=dd;var i=lt!==null&&lt.next!==null;if(Ya=0,Dt=lt=Ue=null,ad=!1,Wl=0,vo=null,i)throw Error(a(300));s===null||Yt||(s=s.dependencies,s!==null&&Zu(s)&&(Yt=!0))}function Uy(s,i,l,u){Ue=s;var f=0;do{if(go&&(vo=null),Wl=0,go=!1,25<=f)throw Error(a(301));if(f+=1,Dt=lt=null,s.updateQueue!=null){var g=s.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}z.H=vw,g=i(l,u)}while(go);return g}function dw(){var s=z.H,i=s.useState()[0];return i=typeof i.then=="function"?Zl(i):i,s=s.useState()[0],(lt!==null?lt.memoizedState:null)!==s&&(Ue.flags|=1024),i}function rm(){var s=id!==0;return id=0,s}function om(s,i,l){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~l}function lm(s){if(ad){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}ad=!1}Ya=0,Dt=lt=Ue=null,go=!1,Wl=id=0,vo=null}function wn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?Ue.memoizedState=Dt=s:Dt=Dt.next=s,Dt}function Mt(){if(lt===null){var s=Ue.alternate;s=s!==null?s.memoizedState:null}else s=lt.next;var i=Dt===null?Ue.memoizedState:Dt.next;if(i!==null)Dt=i,lt=s;else{if(s===null)throw Ue.alternate===null?Error(a(467)):Error(a(310));lt=s,s={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},Dt===null?Ue.memoizedState=Dt=s:Dt=Dt.next=s}return Dt}function cm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zl(s){var i=Wl;return Wl+=1,vo===null&&(vo=[]),s=Dy(vo,s,i),i=Ue,(Dt===null?i.memoizedState:Dt.next)===null&&(i=i.alternate,z.H=i===null||i.memoizedState===null?b_:E_),s}function rd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Zl(s);if(s.$$typeof===V)return un(s)}throw Error(a(438,String(s)))}function um(s){var i=null,l=Ue.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var u=Ue.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(f){return f.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=cm(),Ue.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(s),u=0;u<s;u++)l[u]=w;return i.index++,l}function ga(s,i){return typeof i=="function"?i(s):i}function od(s){var i=Mt();return dm(i,lt,s)}function dm(s,i,l){var u=s.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=l;var f=s.baseQueue,g=u.pending;if(g!==null){if(f!==null){var N=f.next;f.next=g.next,g.next=N}i.baseQueue=f=g,u.pending=null}if(g=s.baseState,f===null)s.memoizedState=g;else{i=f.next;var I=N=null,B=null,X=i,ae=!1;do{var oe=X.lane&-536870913;if(oe!==X.lane?(Xe&oe)===oe:(Ya&oe)===oe){var Z=X.revertLane;if(Z===0)B!==null&&(B=B.next={lane:0,revertLane:0,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),oe===fo&&(ae=!0);else if((Ya&Z)===Z){X=X.next,Z===fo&&(ae=!0);continue}else oe={lane:0,revertLane:X.revertLane,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},B===null?(I=B=oe,N=g):B=B.next=oe,Ue.lanes|=Z,ei|=Z;oe=X.action,gr&&l(g,oe),g=X.hasEagerState?X.eagerState:l(g,oe)}else Z={lane:oe,revertLane:X.revertLane,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},B===null?(I=B=Z,N=g):B=B.next=Z,Ue.lanes|=oe,ei|=oe;X=X.next}while(X!==null&&X!==i);if(B===null?N=g:B.next=I,!kn(g,s.memoizedState)&&(Yt=!0,ae&&(l=mo,l!==null)))throw l;s.memoizedState=g,s.baseState=N,s.baseQueue=B,u.lastRenderedState=g}return f===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function hm(s){var i=Mt(),l=i.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=s;var u=l.dispatch,f=l.pending,g=i.memoizedState;if(f!==null){l.pending=null;var N=f=f.next;do g=s(g,N.action),N=N.next;while(N!==f);kn(g,i.memoizedState)||(Yt=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),l.lastRenderedState=g}return[g,u]}function Fy(s,i,l){var u=Ue,f=Mt(),g=et;if(g){if(l===void 0)throw Error(a(407));l=l()}else l=i();var N=!kn((lt||f).memoizedState,l);N&&(f.memoizedState=l,Yt=!0),f=f.queue;var I=zy.bind(null,u,f,s);if(Jl(2048,8,I,[s]),f.getSnapshot!==i||N||Dt!==null&&Dt.memoizedState.tag&1){if(u.flags|=2048,yo(9,ld(),By.bind(null,u,f,l,i),null),pt===null)throw Error(a(349));g||(Ya&124)!==0||qy(u,i,l)}return l}function qy(s,i,l){s.flags|=16384,s={getSnapshot:i,value:l},i=Ue.updateQueue,i===null?(i=cm(),Ue.updateQueue=i,i.stores=[s]):(l=i.stores,l===null?i.stores=[s]:l.push(s))}function By(s,i,l,u){i.value=l,i.getSnapshot=u,Hy(i)&&Gy(s)}function zy(s,i,l){return l(function(){Hy(i)&&Gy(s)})}function Hy(s){var i=s.getSnapshot;s=s.value;try{var l=i();return!kn(s,l)}catch{return!0}}function Gy(s){var i=lo(s,2);i!==null&&qn(i,s,2)}function fm(s){var i=wn();if(typeof s=="function"){var l=s;if(s=l(),gr){Mn(!0);try{l()}finally{Mn(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:s},i}function $y(s,i,l,u){return s.baseState=l,dm(s,lt,typeof u=="function"?u:ga)}function hw(s,i,l,u,f){if(ud(s))throw Error(a(485));if(s=i.action,s!==null){var g={payload:f,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){g.listeners.push(N)}};z.T!==null?l(!0):g.isTransition=!1,u(g),l=i.pending,l===null?(g.next=i.pending=g,Yy(i,g)):(g.next=l.next,i.pending=l.next=g)}}function Yy(s,i){var l=i.action,u=i.payload,f=s.state;if(i.isTransition){var g=z.T,N={};z.T=N;try{var I=l(f,u),B=z.S;B!==null&&B(N,I),Ky(s,i,I)}catch(X){mm(s,i,X)}finally{z.T=g}}else try{g=l(f,u),Ky(s,i,g)}catch(X){mm(s,i,X)}}function Ky(s,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Qy(s,i,u)},function(u){return mm(s,i,u)}):Qy(s,i,l)}function Qy(s,i,l){i.status="fulfilled",i.value=l,Xy(i),s.state=l,i=s.pending,i!==null&&(l=i.next,l===i?s.pending=null:(l=l.next,i.next=l,Yy(s,l)))}function mm(s,i,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=l,Xy(i),i=i.next;while(i!==u)}s.action=null}function Xy(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function Wy(s,i){return i}function Zy(s,i){if(et){var l=pt.formState;if(l!==null){e:{var u=Ue;if(et){if(Tt){t:{for(var f=Tt,g=Ls;f.nodeType!==8;){if(!g){f=null;break t}if(f=ps(f.nextSibling),f===null){f=null;break t}}g=f.data,f=g==="F!"||g==="F"?f:null}if(f){Tt=ps(f.nextSibling),u=f.data==="F!";break e}}hr(u)}u=!1}u&&(i=l[0])}}return l=wn(),l.memoizedState=l.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wy,lastRenderedState:i},l.queue=u,l=v_.bind(null,Ue,u),u.dispatch=l,u=fm(!1),g=_m.bind(null,Ue,!1,u.queue),u=wn(),f={state:i,dispatch:null,action:s,pending:null},u.queue=f,l=hw.bind(null,Ue,f,g,l),f.dispatch=l,u.memoizedState=s,[i,l,!1]}function Jy(s){var i=Mt();return e_(i,lt,s)}function e_(s,i,l){if(i=dm(s,i,Wy)[0],s=od(ga)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Zl(i)}catch(N){throw N===$l?td:N}else u=i;i=Mt();var f=i.queue,g=f.dispatch;return l!==i.memoizedState&&(Ue.flags|=2048,yo(9,ld(),fw.bind(null,f,l),null)),[u,g,s]}function fw(s,i){s.action=i}function t_(s){var i=Mt(),l=lt;if(l!==null)return e_(i,l,s);Mt(),i=i.memoizedState,l=Mt();var u=l.queue.dispatch;return l.memoizedState=s,[i,u,!1]}function yo(s,i,l,u){return s={tag:s,create:l,deps:u,inst:i,next:null},i=Ue.updateQueue,i===null&&(i=cm(),Ue.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,i.lastEffect=s),s}function ld(){return{destroy:void 0,resource:void 0}}function n_(){return Mt().memoizedState}function cd(s,i,l,u){var f=wn();u=u===void 0?null:u,Ue.flags|=s,f.memoizedState=yo(1|i,ld(),l,u)}function Jl(s,i,l,u){var f=Mt();u=u===void 0?null:u;var g=f.memoizedState.inst;lt!==null&&u!==null&&am(u,lt.memoizedState.deps)?f.memoizedState=yo(i,g,l,u):(Ue.flags|=s,f.memoizedState=yo(1|i,g,l,u))}function s_(s,i){cd(8390656,8,s,i)}function a_(s,i){Jl(2048,8,s,i)}function i_(s,i){return Jl(4,2,s,i)}function r_(s,i){return Jl(4,4,s,i)}function o_(s,i){if(typeof i=="function"){s=s();var l=i(s);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function l_(s,i,l){l=l!=null?l.concat([s]):null,Jl(4,4,o_.bind(null,i,s),l)}function pm(){}function c_(s,i){var l=Mt();i=i===void 0?null:i;var u=l.memoizedState;return i!==null&&am(i,u[1])?u[0]:(l.memoizedState=[s,i],s)}function u_(s,i){var l=Mt();i=i===void 0?null:i;var u=l.memoizedState;if(i!==null&&am(i,u[1]))return u[0];if(u=s(),gr){Mn(!0);try{s()}finally{Mn(!1)}}return l.memoizedState=[u,i],u}function gm(s,i,l){return l===void 0||(Ya&1073741824)!==0?s.memoizedState=i:(s.memoizedState=l,s=fb(),Ue.lanes|=s,ei|=s,l)}function d_(s,i,l,u){return kn(l,i)?l:po.current!==null?(s=gm(s,l,u),kn(s,i)||(Yt=!0),s):(Ya&42)===0?(Yt=!0,s.memoizedState=l):(s=fb(),Ue.lanes|=s,ei|=s,i)}function h_(s,i,l,u,f){var g=se.p;se.p=g!==0&&8>g?g:8;var N=z.T,I={};z.T=I,_m(s,!1,i,l);try{var B=f(),X=z.S;if(X!==null&&X(I,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var ae=cw(B,u);ec(s,i,ae,Fn(s))}else ec(s,i,u,Fn(s))}catch(oe){ec(s,i,{then:function(){},status:"rejected",reason:oe},Fn())}finally{se.p=g,z.T=N}}function mw(){}function vm(s,i,l,u){if(s.tag!==5)throw Error(a(476));var f=f_(s).queue;h_(s,f,i,he,l===null?mw:function(){return m_(s),l(u)})}function f_(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:he,baseState:he,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:he},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:l},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function m_(s){var i=f_(s).next.queue;ec(s,i,{},Fn())}function ym(){return un(yc)}function p_(){return Mt().memoizedState}function g_(){return Mt().memoizedState}function pw(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var l=Fn();s=Ga(l);var u=$a(i,s,l);u!==null&&(qn(u,i,l),Kl(u,i,l)),i={cache:Kf()},s.payload=i;return}i=i.return}}function gw(s,i,l){var u=Fn();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},ud(s)?y_(i,l):(l=Vf(s,i,l,u),l!==null&&(qn(l,s,u),__(l,i,u)))}function v_(s,i,l){var u=Fn();ec(s,i,l,u)}function ec(s,i,l,u){var f={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(ud(s))y_(i,f);else{var g=s.alternate;if(s.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var N=i.lastRenderedState,I=g(N,l);if(f.hasEagerState=!0,f.eagerState=I,kn(I,N))return Yu(s,i,f,0),pt===null&&$u(),!1}catch{}finally{}if(l=Vf(s,i,f,u),l!==null)return qn(l,s,u),__(l,i,u),!0}return!1}function _m(s,i,l,u){if(u={lane:2,revertLane:Wm(),action:u,hasEagerState:!1,eagerState:null,next:null},ud(s)){if(i)throw Error(a(479))}else i=Vf(s,l,u,2),i!==null&&qn(i,s,2)}function ud(s){var i=s.alternate;return s===Ue||i!==null&&i===Ue}function y_(s,i){go=ad=!0;var l=s.pending;l===null?i.next=i:(i.next=l.next,l.next=i),s.pending=i}function __(s,i,l){if((l&4194048)!==0){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,Nl(s,l)}}var dd={readContext:un,use:rd,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useLayoutEffect:wt,useInsertionEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useSyncExternalStore:wt,useId:wt,useHostTransitionStatus:wt,useFormState:wt,useActionState:wt,useOptimistic:wt,useMemoCache:wt,useCacheRefresh:wt},b_={readContext:un,use:rd,useCallback:function(s,i){return wn().memoizedState=[s,i===void 0?null:i],s},useContext:un,useEffect:s_,useImperativeHandle:function(s,i,l){l=l!=null?l.concat([s]):null,cd(4194308,4,o_.bind(null,i,s),l)},useLayoutEffect:function(s,i){return cd(4194308,4,s,i)},useInsertionEffect:function(s,i){cd(4,2,s,i)},useMemo:function(s,i){var l=wn();i=i===void 0?null:i;var u=s();if(gr){Mn(!0);try{s()}finally{Mn(!1)}}return l.memoizedState=[u,i],u},useReducer:function(s,i,l){var u=wn();if(l!==void 0){var f=l(i);if(gr){Mn(!0);try{l(i)}finally{Mn(!1)}}}else f=i;return u.memoizedState=u.baseState=f,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:f},u.queue=s,s=s.dispatch=gw.bind(null,Ue,s),[u.memoizedState,s]},useRef:function(s){var i=wn();return s={current:s},i.memoizedState=s},useState:function(s){s=fm(s);var i=s.queue,l=v_.bind(null,Ue,i);return i.dispatch=l,[s.memoizedState,l]},useDebugValue:pm,useDeferredValue:function(s,i){var l=wn();return gm(l,s,i)},useTransition:function(){var s=fm(!1);return s=h_.bind(null,Ue,s.queue,!0,!1),wn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,l){var u=Ue,f=wn();if(et){if(l===void 0)throw Error(a(407));l=l()}else{if(l=i(),pt===null)throw Error(a(349));(Xe&124)!==0||qy(u,i,l)}f.memoizedState=l;var g={value:l,getSnapshot:i};return f.queue=g,s_(zy.bind(null,u,g,s),[s]),u.flags|=2048,yo(9,ld(),By.bind(null,u,g,l,i),null),l},useId:function(){var s=wn(),i=pt.identifierPrefix;if(et){var l=fa,u=ha;l=(u&~(1<<32-cn(u)-1)).toString(32)+l,i=""+i+"R"+l,l=id++,0<l&&(i+="H"+l.toString(32)),i+=""}else l=uw++,i=""+i+"r"+l.toString(32)+"";return s.memoizedState=i},useHostTransitionStatus:ym,useFormState:Zy,useActionState:Zy,useOptimistic:function(s){var i=wn();i.memoizedState=i.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=_m.bind(null,Ue,!0,l),l.dispatch=i,[s,i]},useMemoCache:um,useCacheRefresh:function(){return wn().memoizedState=pw.bind(null,Ue)}},E_={readContext:un,use:rd,useCallback:c_,useContext:un,useEffect:a_,useImperativeHandle:l_,useInsertionEffect:i_,useLayoutEffect:r_,useMemo:u_,useReducer:od,useRef:n_,useState:function(){return od(ga)},useDebugValue:pm,useDeferredValue:function(s,i){var l=Mt();return d_(l,lt.memoizedState,s,i)},useTransition:function(){var s=od(ga)[0],i=Mt().memoizedState;return[typeof s=="boolean"?s:Zl(s),i]},useSyncExternalStore:Fy,useId:p_,useHostTransitionStatus:ym,useFormState:Jy,useActionState:Jy,useOptimistic:function(s,i){var l=Mt();return $y(l,lt,s,i)},useMemoCache:um,useCacheRefresh:g_},vw={readContext:un,use:rd,useCallback:c_,useContext:un,useEffect:a_,useImperativeHandle:l_,useInsertionEffect:i_,useLayoutEffect:r_,useMemo:u_,useReducer:hm,useRef:n_,useState:function(){return hm(ga)},useDebugValue:pm,useDeferredValue:function(s,i){var l=Mt();return lt===null?gm(l,s,i):d_(l,lt.memoizedState,s,i)},useTransition:function(){var s=hm(ga)[0],i=Mt().memoizedState;return[typeof s=="boolean"?s:Zl(s),i]},useSyncExternalStore:Fy,useId:p_,useHostTransitionStatus:ym,useFormState:t_,useActionState:t_,useOptimistic:function(s,i){var l=Mt();return lt!==null?$y(l,lt,s,i):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:um,useCacheRefresh:g_},_o=null,tc=0;function hd(s){var i=tc;return tc+=1,_o===null&&(_o=[]),Dy(_o,s,i)}function nc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function fd(s,i){throw i.$$typeof===b?Error(a(525)):(s=Object.prototype.toString.call(i),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function N_(s){var i=s._init;return i(s._payload)}function x_(s){function i(G,H){if(s){var Q=G.deletions;Q===null?(G.deletions=[H],G.flags|=16):Q.push(H)}}function l(G,H){if(!s)return null;for(;H!==null;)i(G,H),H=H.sibling;return null}function u(G){for(var H=new Map;G!==null;)G.key!==null?H.set(G.key,G):H.set(G.index,G),G=G.sibling;return H}function f(G,H){return G=da(G,H),G.index=0,G.sibling=null,G}function g(G,H,Q){return G.index=Q,s?(Q=G.alternate,Q!==null?(Q=Q.index,Q<H?(G.flags|=67108866,H):Q):(G.flags|=67108866,H)):(G.flags|=1048576,H)}function N(G){return s&&G.alternate===null&&(G.flags|=67108866),G}function I(G,H,Q,ie){return H===null||H.tag!==6?(H=Ff(Q,G.mode,ie),H.return=G,H):(H=f(H,Q),H.return=G,H)}function B(G,H,Q,ie){var _e=Q.type;return _e===T?ae(G,H,Q.props.children,ie,Q.key):H!==null&&(H.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===D&&N_(_e)===H.type)?(H=f(H,Q.props),nc(H,Q),H.return=G,H):(H=Qu(Q.type,Q.key,Q.props,null,G.mode,ie),nc(H,Q),H.return=G,H)}function X(G,H,Q,ie){return H===null||H.tag!==4||H.stateNode.containerInfo!==Q.containerInfo||H.stateNode.implementation!==Q.implementation?(H=qf(Q,G.mode,ie),H.return=G,H):(H=f(H,Q.children||[]),H.return=G,H)}function ae(G,H,Q,ie,_e){return H===null||H.tag!==7?(H=lr(Q,G.mode,ie,_e),H.return=G,H):(H=f(H,Q),H.return=G,H)}function oe(G,H,Q){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=Ff(""+H,G.mode,Q),H.return=G,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case A:return Q=Qu(H.type,H.key,H.props,null,G.mode,Q),nc(Q,H),Q.return=G,Q;case j:return H=qf(H,G.mode,Q),H.return=G,H;case D:var ie=H._init;return H=ie(H._payload),oe(G,H,Q)}if(ne(H)||R(H))return H=lr(H,G.mode,Q,null),H.return=G,H;if(typeof H.then=="function")return oe(G,hd(H),Q);if(H.$$typeof===V)return oe(G,Ju(G,H),Q);fd(G,H)}return null}function Z(G,H,Q,ie){var _e=H!==null?H.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return _e!==null?null:I(G,H,""+Q,ie);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case A:return Q.key===_e?B(G,H,Q,ie):null;case j:return Q.key===_e?X(G,H,Q,ie):null;case D:return _e=Q._init,Q=_e(Q._payload),Z(G,H,Q,ie)}if(ne(Q)||R(Q))return _e!==null?null:ae(G,H,Q,ie,null);if(typeof Q.then=="function")return Z(G,H,hd(Q),ie);if(Q.$$typeof===V)return Z(G,H,Ju(G,Q),ie);fd(G,Q)}return null}function J(G,H,Q,ie,_e){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return G=G.get(Q)||null,I(H,G,""+ie,_e);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case A:return G=G.get(ie.key===null?Q:ie.key)||null,B(H,G,ie,_e);case j:return G=G.get(ie.key===null?Q:ie.key)||null,X(H,G,ie,_e);case D:var Be=ie._init;return ie=Be(ie._payload),J(G,H,Q,ie,_e)}if(ne(ie)||R(ie))return G=G.get(Q)||null,ae(H,G,ie,_e,null);if(typeof ie.then=="function")return J(G,H,Q,hd(ie),_e);if(ie.$$typeof===V)return J(G,H,Q,Ju(H,ie),_e);fd(H,ie)}return null}function Ie(G,H,Q,ie){for(var _e=null,Be=null,be=H,je=H=0,Qt=null;be!==null&&je<Q.length;je++){be.index>je?(Qt=be,be=null):Qt=be.sibling;var Je=Z(G,be,Q[je],ie);if(Je===null){be===null&&(be=Qt);break}s&&be&&Je.alternate===null&&i(G,be),H=g(Je,H,je),Be===null?_e=Je:Be.sibling=Je,Be=Je,be=Qt}if(je===Q.length)return l(G,be),et&&ur(G,je),_e;if(be===null){for(;je<Q.length;je++)be=oe(G,Q[je],ie),be!==null&&(H=g(be,H,je),Be===null?_e=be:Be.sibling=be,Be=be);return et&&ur(G,je),_e}for(be=u(be);je<Q.length;je++)Qt=J(be,G,je,Q[je],ie),Qt!==null&&(s&&Qt.alternate!==null&&be.delete(Qt.key===null?je:Qt.key),H=g(Qt,H,je),Be===null?_e=Qt:Be.sibling=Qt,Be=Qt);return s&&be.forEach(function(ci){return i(G,ci)}),et&&ur(G,je),_e}function Ae(G,H,Q,ie){if(Q==null)throw Error(a(151));for(var _e=null,Be=null,be=H,je=H=0,Qt=null,Je=Q.next();be!==null&&!Je.done;je++,Je=Q.next()){be.index>je?(Qt=be,be=null):Qt=be.sibling;var ci=Z(G,be,Je.value,ie);if(ci===null){be===null&&(be=Qt);break}s&&be&&ci.alternate===null&&i(G,be),H=g(ci,H,je),Be===null?_e=ci:Be.sibling=ci,Be=ci,be=Qt}if(Je.done)return l(G,be),et&&ur(G,je),_e;if(be===null){for(;!Je.done;je++,Je=Q.next())Je=oe(G,Je.value,ie),Je!==null&&(H=g(Je,H,je),Be===null?_e=Je:Be.sibling=Je,Be=Je);return et&&ur(G,je),_e}for(be=u(be);!Je.done;je++,Je=Q.next())Je=J(be,G,je,Je.value,ie),Je!==null&&(s&&Je.alternate!==null&&be.delete(Je.key===null?je:Je.key),H=g(Je,H,je),Be===null?_e=Je:Be.sibling=Je,Be=Je);return s&&be.forEach(function(yC){return i(G,yC)}),et&&ur(G,je),_e}function ut(G,H,Q,ie){if(typeof Q=="object"&&Q!==null&&Q.type===T&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case A:e:{for(var _e=Q.key;H!==null;){if(H.key===_e){if(_e=Q.type,_e===T){if(H.tag===7){l(G,H.sibling),ie=f(H,Q.props.children),ie.return=G,G=ie;break e}}else if(H.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===D&&N_(_e)===H.type){l(G,H.sibling),ie=f(H,Q.props),nc(ie,Q),ie.return=G,G=ie;break e}l(G,H);break}else i(G,H);H=H.sibling}Q.type===T?(ie=lr(Q.props.children,G.mode,ie,Q.key),ie.return=G,G=ie):(ie=Qu(Q.type,Q.key,Q.props,null,G.mode,ie),nc(ie,Q),ie.return=G,G=ie)}return N(G);case j:e:{for(_e=Q.key;H!==null;){if(H.key===_e)if(H.tag===4&&H.stateNode.containerInfo===Q.containerInfo&&H.stateNode.implementation===Q.implementation){l(G,H.sibling),ie=f(H,Q.children||[]),ie.return=G,G=ie;break e}else{l(G,H);break}else i(G,H);H=H.sibling}ie=qf(Q,G.mode,ie),ie.return=G,G=ie}return N(G);case D:return _e=Q._init,Q=_e(Q._payload),ut(G,H,Q,ie)}if(ne(Q))return Ie(G,H,Q,ie);if(R(Q)){if(_e=R(Q),typeof _e!="function")throw Error(a(150));return Q=_e.call(Q),Ae(G,H,Q,ie)}if(typeof Q.then=="function")return ut(G,H,hd(Q),ie);if(Q.$$typeof===V)return ut(G,H,Ju(G,Q),ie);fd(G,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,H!==null&&H.tag===6?(l(G,H.sibling),ie=f(H,Q),ie.return=G,G=ie):(l(G,H),ie=Ff(Q,G.mode,ie),ie.return=G,G=ie),N(G)):l(G,H)}return function(G,H,Q,ie){try{tc=0;var _e=ut(G,H,Q,ie);return _o=null,_e}catch(be){if(be===$l||be===td)throw be;var Be=Pn(29,be,null,G.mode);return Be.lanes=ie,Be.return=G,Be}finally{}}}var bo=x_(!0),T_=x_(!1),ss=ee(null),Vs=null;function Ka(s){var i=s.alternate;ue(Ft,Ft.current&1),ue(ss,s),Vs===null&&(i===null||po.current!==null||i.memoizedState!==null)&&(Vs=s)}function A_(s){if(s.tag===22){if(ue(Ft,Ft.current),ue(ss,s),Vs===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(Vs=s)}}else Qa()}function Qa(){ue(Ft,Ft.current),ue(ss,ss.current)}function va(s){ce(ss),Vs===s&&(Vs=null),ce(Ft)}var Ft=ee(0);function md(s){for(var i=s;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||cp(l)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function bm(s,i,l,u){i=s.memoizedState,l=l(u,i),l=l==null?i:_({},i,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Em={enqueueSetState:function(s,i,l){s=s._reactInternals;var u=Fn(),f=Ga(u);f.payload=i,l!=null&&(f.callback=l),i=$a(s,f,u),i!==null&&(qn(i,s,u),Kl(i,s,u))},enqueueReplaceState:function(s,i,l){s=s._reactInternals;var u=Fn(),f=Ga(u);f.tag=1,f.payload=i,l!=null&&(f.callback=l),i=$a(s,f,u),i!==null&&(qn(i,s,u),Kl(i,s,u))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var l=Fn(),u=Ga(l);u.tag=2,i!=null&&(u.callback=i),i=$a(s,u,l),i!==null&&(qn(i,s,l),Kl(i,s,l))}};function j_(s,i,l,u,f,g,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,g,N):i.prototype&&i.prototype.isPureReactComponent?!Vl(l,u)||!Vl(f,g):!0}function w_(s,i,l,u){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,u),i.state!==s&&Em.enqueueReplaceState(i,i.state,null)}function vr(s,i){var l=i;if("ref"in i){l={};for(var u in i)u!=="ref"&&(l[u]=i[u])}if(s=s.defaultProps){l===i&&(l=_({},l));for(var f in s)l[f]===void 0&&(l[f]=s[f])}return l}var pd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function C_(s){pd(s)}function S_(s){console.error(s)}function I_(s){pd(s)}function gd(s,i){try{var l=s.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function R_(s,i,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Nm(s,i,l){return l=Ga(l),l.tag=3,l.payload={element:null},l.callback=function(){gd(s,i)},l}function D_(s){return s=Ga(s),s.tag=3,s}function M_(s,i,l,u){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var g=u.value;s.payload=function(){return f(g)},s.callback=function(){R_(i,l,u)}}var N=l.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){R_(i,l,u),typeof f!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var I=u.stack;this.componentDidCatch(u.value,{componentStack:I!==null?I:""})})}function yw(s,i,l,u,f){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=l.alternate,i!==null&&zl(i,l,f,!0),l=ss.current,l!==null){switch(l.tag){case 13:return Vs===null?$m():l.alternate===null&&At===0&&(At=3),l.flags&=-257,l.flags|=65536,l.lanes=f,u===Wf?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([u]):i.add(u),Km(s,u,f)),!1;case 22:return l.flags|=65536,u===Wf?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([u]):l.add(u)),Km(s,u,f)),!1}throw Error(a(435,l.tag))}return Km(s,u,f),$m(),!1}if(et)return i=ss.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=f,u!==Hf&&(s=Error(a(422),{cause:u}),Bl(Jn(s,l)))):(u!==Hf&&(i=Error(a(423),{cause:u}),Bl(Jn(i,l))),s=s.current.alternate,s.flags|=65536,f&=-f,s.lanes|=f,u=Jn(u,l),f=Nm(s.stateNode,u,f),em(s,f),At!==4&&(At=2)),!1;var g=Error(a(520),{cause:u});if(g=Jn(g,l),cc===null?cc=[g]:cc.push(g),At!==4&&(At=2),i===null)return!0;u=Jn(u,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,s=f&-f,l.lanes|=s,s=Nm(l.stateNode,u,s),em(l,s),!1;case 1:if(i=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(ti===null||!ti.has(g))))return l.flags|=65536,f&=-f,l.lanes|=f,f=D_(f),M_(f,s,l,u),em(l,f),!1}l=l.return}while(l!==null);return!1}var O_=Error(a(461)),Yt=!1;function en(s,i,l,u){i.child=s===null?T_(i,null,l,u):bo(i,s.child,l,u)}function k_(s,i,l,u,f){l=l.render;var g=i.ref;if("ref"in u){var N={};for(var I in u)I!=="ref"&&(N[I]=u[I])}else N=u;return mr(i),u=im(s,i,l,N,g,f),I=rm(),s!==null&&!Yt?(om(s,i,f),ya(s,i,f)):(et&&I&&Bf(i),i.flags|=1,en(s,i,u,f),i.child)}function P_(s,i,l,u,f){if(s===null){var g=l.type;return typeof g=="function"&&!Uf(g)&&g.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=g,L_(s,i,g,u,f)):(s=Qu(l.type,null,u,i,i.mode,f),s.ref=i.ref,s.return=i,i.child=s)}if(g=s.child,!Im(s,f)){var N=g.memoizedProps;if(l=l.compare,l=l!==null?l:Vl,l(N,u)&&s.ref===i.ref)return ya(s,i,f)}return i.flags|=1,s=da(g,u),s.ref=i.ref,s.return=i,i.child=s}function L_(s,i,l,u,f){if(s!==null){var g=s.memoizedProps;if(Vl(g,u)&&s.ref===i.ref)if(Yt=!1,i.pendingProps=u=g,Im(s,f))(s.flags&131072)!==0&&(Yt=!0);else return i.lanes=s.lanes,ya(s,i,f)}return xm(s,i,l,u,f)}function V_(s,i,l){var u=i.pendingProps,f=u.children,g=s!==null?s.memoizedState:null;if(u.mode==="hidden"){if((i.flags&128)!==0){if(u=g!==null?g.baseLanes|l:l,s!==null){for(f=i.child=s.child,g=0;f!==null;)g=g|f.lanes|f.childLanes,f=f.sibling;i.childLanes=g&~u}else i.childLanes=0,i.child=null;return U_(s,i,u,l)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&ed(i,g!==null?g.cachePool:null),g!==null?Ly(i,g):nm(),A_(i);else return i.lanes=i.childLanes=536870912,U_(s,i,g!==null?g.baseLanes|l:l,l)}else g!==null?(ed(i,g.cachePool),Ly(i,g),Qa(),i.memoizedState=null):(s!==null&&ed(i,null),nm(),Qa());return en(s,i,f,l),i.child}function U_(s,i,l,u){var f=Xf();return f=f===null?null:{parent:Ut._currentValue,pool:f},i.memoizedState={baseLanes:l,cachePool:f},s!==null&&ed(i,null),nm(),A_(i),s!==null&&zl(s,i,u,!0),null}function vd(s,i){var l=i.ref;if(l===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(a(284));(s===null||s.ref!==l)&&(i.flags|=4194816)}}function xm(s,i,l,u,f){return mr(i),l=im(s,i,l,u,void 0,f),u=rm(),s!==null&&!Yt?(om(s,i,f),ya(s,i,f)):(et&&u&&Bf(i),i.flags|=1,en(s,i,l,f),i.child)}function F_(s,i,l,u,f,g){return mr(i),i.updateQueue=null,l=Uy(i,u,l,f),Vy(s),u=rm(),s!==null&&!Yt?(om(s,i,g),ya(s,i,g)):(et&&u&&Bf(i),i.flags|=1,en(s,i,l,g),i.child)}function q_(s,i,l,u,f){if(mr(i),i.stateNode===null){var g=co,N=l.contextType;typeof N=="object"&&N!==null&&(g=un(N)),g=new l(u,g),i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Em,i.stateNode=g,g._reactInternals=i,g=i.stateNode,g.props=u,g.state=i.memoizedState,g.refs={},Zf(i),N=l.contextType,g.context=typeof N=="object"&&N!==null?un(N):co,g.state=i.memoizedState,N=l.getDerivedStateFromProps,typeof N=="function"&&(bm(i,l,N,u),g.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(N=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),N!==g.state&&Em.enqueueReplaceState(g,g.state,null),Xl(i,u,g,f),Ql(),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(s===null){g=i.stateNode;var I=i.memoizedProps,B=vr(l,I);g.props=B;var X=g.context,ae=l.contextType;N=co,typeof ae=="object"&&ae!==null&&(N=un(ae));var oe=l.getDerivedStateFromProps;ae=typeof oe=="function"||typeof g.getSnapshotBeforeUpdate=="function",I=i.pendingProps!==I,ae||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(I||X!==N)&&w_(i,g,u,N),Ha=!1;var Z=i.memoizedState;g.state=Z,Xl(i,u,g,f),Ql(),X=i.memoizedState,I||Z!==X||Ha?(typeof oe=="function"&&(bm(i,l,oe,u),X=i.memoizedState),(B=Ha||j_(i,l,B,u,Z,X,N))?(ae||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=X),g.props=u,g.state=X,g.context=N,u=B):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{g=i.stateNode,Jf(s,i),N=i.memoizedProps,ae=vr(l,N),g.props=ae,oe=i.pendingProps,Z=g.context,X=l.contextType,B=co,typeof X=="object"&&X!==null&&(B=un(X)),I=l.getDerivedStateFromProps,(X=typeof I=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(N!==oe||Z!==B)&&w_(i,g,u,B),Ha=!1,Z=i.memoizedState,g.state=Z,Xl(i,u,g,f),Ql();var J=i.memoizedState;N!==oe||Z!==J||Ha||s!==null&&s.dependencies!==null&&Zu(s.dependencies)?(typeof I=="function"&&(bm(i,l,I,u),J=i.memoizedState),(ae=Ha||j_(i,l,ae,u,Z,J,B)||s!==null&&s.dependencies!==null&&Zu(s.dependencies))?(X||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,J,B),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,J,B)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||N===s.memoizedProps&&Z===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&Z===s.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=J),g.props=u,g.state=J,g.context=B,u=ae):(typeof g.componentDidUpdate!="function"||N===s.memoizedProps&&Z===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&Z===s.memoizedState||(i.flags|=1024),u=!1)}return g=u,vd(s,i),u=(i.flags&128)!==0,g||u?(g=i.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),i.flags|=1,s!==null&&u?(i.child=bo(i,s.child,null,f),i.child=bo(i,null,l,f)):en(s,i,l,f),i.memoizedState=g.state,s=i.child):s=ya(s,i,f),s}function B_(s,i,l,u){return ql(),i.flags|=256,en(s,i,l,u),i.child}var Tm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Am(s){return{baseLanes:s,cachePool:Sy()}}function jm(s,i,l){return s=s!==null?s.childLanes&~l:0,i&&(s|=as),s}function z_(s,i,l){var u=i.pendingProps,f=!1,g=(i.flags&128)!==0,N;if((N=g)||(N=s!==null&&s.memoizedState===null?!1:(Ft.current&2)!==0),N&&(f=!0,i.flags&=-129),N=(i.flags&32)!==0,i.flags&=-33,s===null){if(et){if(f?Ka(i):Qa(),et){var I=Tt,B;if(B=I){e:{for(B=I,I=Ls;B.nodeType!==8;){if(!I){I=null;break e}if(B=ps(B.nextSibling),B===null){I=null;break e}}I=B}I!==null?(i.memoizedState={dehydrated:I,treeContext:cr!==null?{id:ha,overflow:fa}:null,retryLane:536870912,hydrationErrors:null},B=Pn(18,null,null,0),B.stateNode=I,B.return=i,i.child=B,bn=i,Tt=null,B=!0):B=!1}B||hr(i)}if(I=i.memoizedState,I!==null&&(I=I.dehydrated,I!==null))return cp(I)?i.lanes=32:i.lanes=536870912,null;va(i)}return I=u.children,u=u.fallback,f?(Qa(),f=i.mode,I=yd({mode:"hidden",children:I},f),u=lr(u,f,l,null),I.return=i,u.return=i,I.sibling=u,i.child=I,f=i.child,f.memoizedState=Am(l),f.childLanes=jm(s,N,l),i.memoizedState=Tm,u):(Ka(i),wm(i,I))}if(B=s.memoizedState,B!==null&&(I=B.dehydrated,I!==null)){if(g)i.flags&256?(Ka(i),i.flags&=-257,i=Cm(s,i,l)):i.memoizedState!==null?(Qa(),i.child=s.child,i.flags|=128,i=null):(Qa(),f=u.fallback,I=i.mode,u=yd({mode:"visible",children:u.children},I),f=lr(f,I,l,null),f.flags|=2,u.return=i,f.return=i,u.sibling=f,i.child=u,bo(i,s.child,null,l),u=i.child,u.memoizedState=Am(l),u.childLanes=jm(s,N,l),i.memoizedState=Tm,i=f);else if(Ka(i),cp(I)){if(N=I.nextSibling&&I.nextSibling.dataset,N)var X=N.dgst;N=X,u=Error(a(419)),u.stack="",u.digest=N,Bl({value:u,source:null,stack:null}),i=Cm(s,i,l)}else if(Yt||zl(s,i,l,!1),N=(l&s.childLanes)!==0,Yt||N){if(N=pt,N!==null&&(u=l&-l,u=(u&42)!==0?1:Pa(u),u=(u&(N.suspendedLanes|l))!==0?0:u,u!==0&&u!==B.retryLane))throw B.retryLane=u,lo(s,u),qn(N,s,u),O_;I.data==="$?"||$m(),i=Cm(s,i,l)}else I.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=B.treeContext,Tt=ps(I.nextSibling),bn=i,et=!0,dr=null,Ls=!1,s!==null&&(ts[ns++]=ha,ts[ns++]=fa,ts[ns++]=cr,ha=s.id,fa=s.overflow,cr=i),i=wm(i,u.children),i.flags|=4096);return i}return f?(Qa(),f=u.fallback,I=i.mode,B=s.child,X=B.sibling,u=da(B,{mode:"hidden",children:u.children}),u.subtreeFlags=B.subtreeFlags&65011712,X!==null?f=da(X,f):(f=lr(f,I,l,null),f.flags|=2),f.return=i,u.return=i,u.sibling=f,i.child=u,u=f,f=i.child,I=s.child.memoizedState,I===null?I=Am(l):(B=I.cachePool,B!==null?(X=Ut._currentValue,B=B.parent!==X?{parent:X,pool:X}:B):B=Sy(),I={baseLanes:I.baseLanes|l,cachePool:B}),f.memoizedState=I,f.childLanes=jm(s,N,l),i.memoizedState=Tm,u):(Ka(i),l=s.child,s=l.sibling,l=da(l,{mode:"visible",children:u.children}),l.return=i,l.sibling=null,s!==null&&(N=i.deletions,N===null?(i.deletions=[s],i.flags|=16):N.push(s)),i.child=l,i.memoizedState=null,l)}function wm(s,i){return i=yd({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function yd(s,i){return s=Pn(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Cm(s,i,l){return bo(i,s.child,null,l),s=wm(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function H_(s,i,l){s.lanes|=i;var u=s.alternate;u!==null&&(u.lanes|=i),$f(s.return,i,l)}function Sm(s,i,l,u,f){var g=s.memoizedState;g===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:f}:(g.isBackwards=i,g.rendering=null,g.renderingStartTime=0,g.last=u,g.tail=l,g.tailMode=f)}function G_(s,i,l){var u=i.pendingProps,f=u.revealOrder,g=u.tail;if(en(s,i,u.children,l),u=Ft.current,(u&2)!==0)u=u&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&H_(s,l,i);else if(s.tag===19)H_(s,l,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}u&=1}switch(ue(Ft,u),f){case"forwards":for(l=i.child,f=null;l!==null;)s=l.alternate,s!==null&&md(s)===null&&(f=l),l=l.sibling;l=f,l===null?(f=i.child,i.child=null):(f=l.sibling,l.sibling=null),Sm(i,!1,f,l,g);break;case"backwards":for(l=null,f=i.child,i.child=null;f!==null;){if(s=f.alternate,s!==null&&md(s)===null){i.child=f;break}s=f.sibling,f.sibling=l,l=f,f=s}Sm(i,!0,l,null,g);break;case"together":Sm(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ya(s,i,l){if(s!==null&&(i.dependencies=s.dependencies),ei|=i.lanes,(l&i.childLanes)===0)if(s!==null){if(zl(s,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(a(153));if(i.child!==null){for(s=i.child,l=da(s,s.pendingProps),i.child=l,l.return=i;s.sibling!==null;)s=s.sibling,l=l.sibling=da(s,s.pendingProps),l.return=i;l.sibling=null}return i.child}function Im(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&Zu(s)))}function _w(s,i,l){switch(i.tag){case 3:mt(i,i.stateNode.containerInfo),za(i,Ut,s.memoizedState.cache),ql();break;case 27:case 5:ka(i);break;case 4:mt(i,i.stateNode.containerInfo);break;case 10:za(i,i.type,i.memoizedProps.value);break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(Ka(i),i.flags|=128,null):(l&i.child.childLanes)!==0?z_(s,i,l):(Ka(i),s=ya(s,i,l),s!==null?s.sibling:null);Ka(i);break;case 19:var f=(s.flags&128)!==0;if(u=(l&i.childLanes)!==0,u||(zl(s,i,l,!1),u=(l&i.childLanes)!==0),f){if(u)return G_(s,i,l);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ue(Ft,Ft.current),u)break;return null;case 22:case 23:return i.lanes=0,V_(s,i,l);case 24:za(i,Ut,s.memoizedState.cache)}return ya(s,i,l)}function $_(s,i,l){if(s!==null)if(s.memoizedProps!==i.pendingProps)Yt=!0;else{if(!Im(s,l)&&(i.flags&128)===0)return Yt=!1,_w(s,i,l);Yt=(s.flags&131072)!==0}else Yt=!1,et&&(i.flags&1048576)!==0&&Ny(i,Wu,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var u=i.elementType,f=u._init;if(u=f(u._payload),i.type=u,typeof u=="function")Uf(u)?(s=vr(u,s),i.tag=1,i=q_(null,i,u,s,l)):(i.tag=0,i=xm(null,i,u,s,l));else{if(u!=null){if(f=u.$$typeof,f===O){i.tag=11,i=k_(null,i,u,s,l);break e}else if(f===L){i.tag=14,i=P_(null,i,u,s,l);break e}}throw i=Ee(u)||u,Error(a(306,i,""))}}return i;case 0:return xm(s,i,i.type,i.pendingProps,l);case 1:return u=i.type,f=vr(u,i.pendingProps),q_(s,i,u,f,l);case 3:e:{if(mt(i,i.stateNode.containerInfo),s===null)throw Error(a(387));u=i.pendingProps;var g=i.memoizedState;f=g.element,Jf(s,i),Xl(i,u,null,l);var N=i.memoizedState;if(u=N.cache,za(i,Ut,u),u!==g.cache&&Yf(i,[Ut],l,!0),Ql(),u=N.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:N.cache},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){i=B_(s,i,u,l);break e}else if(u!==f){f=Jn(Error(a(424)),i),Bl(f),i=B_(s,i,u,l);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Tt=ps(s.firstChild),bn=i,et=!0,dr=null,Ls=!0,l=T_(i,null,u,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(ql(),u===f){i=ya(s,i,l);break e}en(s,i,u,l)}i=i.child}return i;case 26:return vd(s,i),s===null?(l=Xb(i.type,null,i.pendingProps,null))?i.memoizedState=l:et||(l=i.type,s=i.pendingProps,u=Dd(Re.current).createElement(l),u[Pt]=i,u[It]=s,nn(u,l,s),jt(u),i.stateNode=u):i.memoizedState=Xb(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return ka(i),s===null&&et&&(u=i.stateNode=Yb(i.type,i.pendingProps,Re.current),bn=i,Ls=!0,f=Tt,ai(i.type)?(up=f,Tt=ps(u.firstChild)):Tt=f),en(s,i,i.pendingProps.children,l),vd(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&et&&((f=u=Tt)&&(u=Yw(u,i.type,i.pendingProps,Ls),u!==null?(i.stateNode=u,bn=i,Tt=ps(u.firstChild),Ls=!1,f=!0):f=!1),f||hr(i)),ka(i),f=i.type,g=i.pendingProps,N=s!==null?s.memoizedProps:null,u=g.children,rp(f,g)?u=null:N!==null&&rp(f,N)&&(i.flags|=32),i.memoizedState!==null&&(f=im(s,i,dw,null,null,l),yc._currentValue=f),vd(s,i),en(s,i,u,l),i.child;case 6:return s===null&&et&&((s=l=Tt)&&(l=Kw(l,i.pendingProps,Ls),l!==null?(i.stateNode=l,bn=i,Tt=null,s=!0):s=!1),s||hr(i)),null;case 13:return z_(s,i,l);case 4:return mt(i,i.stateNode.containerInfo),u=i.pendingProps,s===null?i.child=bo(i,null,u,l):en(s,i,u,l),i.child;case 11:return k_(s,i,i.type,i.pendingProps,l);case 7:return en(s,i,i.pendingProps,l),i.child;case 8:return en(s,i,i.pendingProps.children,l),i.child;case 12:return en(s,i,i.pendingProps.children,l),i.child;case 10:return u=i.pendingProps,za(i,i.type,u.value),en(s,i,u.children,l),i.child;case 9:return f=i.type._context,u=i.pendingProps.children,mr(i),f=un(f),u=u(f),i.flags|=1,en(s,i,u,l),i.child;case 14:return P_(s,i,i.type,i.pendingProps,l);case 15:return L_(s,i,i.type,i.pendingProps,l);case 19:return G_(s,i,l);case 31:return u=i.pendingProps,l=i.mode,u={mode:u.mode,children:u.children},s===null?(l=yd(u,l),l.ref=i.ref,i.child=l,l.return=i,i=l):(l=da(s.child,u),l.ref=i.ref,i.child=l,l.return=i,i=l),i;case 22:return V_(s,i,l);case 24:return mr(i),u=un(Ut),s===null?(f=Xf(),f===null&&(f=pt,g=Kf(),f.pooledCache=g,g.refCount++,g!==null&&(f.pooledCacheLanes|=l),f=g),i.memoizedState={parent:u,cache:f},Zf(i),za(i,Ut,f)):((s.lanes&l)!==0&&(Jf(s,i),Xl(i,null,null,l),Ql()),f=s.memoizedState,g=i.memoizedState,f.parent!==u?(f={parent:u,cache:u},i.memoizedState=f,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=f),za(i,Ut,u)):(u=g.cache,za(i,Ut,u),u!==f.cache&&Yf(i,[Ut],l,!0))),en(s,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function _a(s){s.flags|=4}function Y_(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!tE(i)){if(i=ss.current,i!==null&&((Xe&4194048)===Xe?Vs!==null:(Xe&62914560)!==Xe&&(Xe&536870912)===0||i!==Vs))throw Yl=Wf,Iy;s.flags|=8192}}function _d(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?bl():536870912,s.lanes|=i,To|=i)}function sc(s,i){if(!et)switch(s.tailMode){case"hidden":i=s.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function Et(s){var i=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(i)for(var f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=s,f=f.sibling;else for(f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=s,f=f.sibling;return s.subtreeFlags|=u,s.childLanes=l,i}function bw(s,i,l){var u=i.pendingProps;switch(zf(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(i),null;case 1:return Et(i),null;case 3:return l=i.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),pa(Ut),As(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Fl(i)?_a(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Ay())),Et(i),null;case 26:return l=i.memoizedState,s===null?(_a(i),l!==null?(Et(i),Y_(i,l)):(Et(i),i.flags&=-16777217)):l?l!==s.memoizedState?(_a(i),Et(i),Y_(i,l)):(Et(i),i.flags&=-16777217):(s.memoizedProps!==u&&_a(i),Et(i),i.flags&=-16777217),null;case 27:Zs(i),l=Re.current;var f=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==u&&_a(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return Et(i),null}s=xe.current,Fl(i)?xy(i):(s=Yb(f,u,l),i.stateNode=s,_a(i))}return Et(i),null;case 5:if(Zs(i),l=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==u&&_a(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return Et(i),null}if(s=xe.current,Fl(i))xy(i);else{switch(f=Dd(Re.current),s){case 1:s=f.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=f.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=f.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=f.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=f.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof u.is=="string"?f.createElement("select",{is:u.is}):f.createElement("select"),u.multiple?s.multiple=!0:u.size&&(s.size=u.size);break;default:s=typeof u.is=="string"?f.createElement(l,{is:u.is}):f.createElement(l)}}s[Pt]=i,s[It]=u;e:for(f=i.child;f!==null;){if(f.tag===5||f.tag===6)s.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===i)break e;for(;f.sibling===null;){if(f.return===null||f.return===i)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}i.stateNode=s;e:switch(nn(s,l,u),l){case"button":case"input":case"select":case"textarea":s=!!u.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&_a(i)}}return Et(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==u&&_a(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(a(166));if(s=Re.current,Fl(i)){if(s=i.stateNode,l=i.memoizedProps,u=null,f=bn,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}s[Pt]=i,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||Fb(s.nodeValue,l)),s||hr(i)}else s=Dd(s).createTextNode(u),s[Pt]=i,i.stateNode=s}return Et(i),null;case 13:if(u=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(f=Fl(i),u!==null&&u.dehydrated!==null){if(s===null){if(!f)throw Error(a(318));if(f=i.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[Pt]=i}else ql(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Et(i),f=!1}else f=Ay(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),f=!0;if(!f)return i.flags&256?(va(i),i):(va(i),null)}if(va(i),(i.flags&128)!==0)return i.lanes=l,i;if(l=u!==null,s=s!==null&&s.memoizedState!==null,l){u=i.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool);var g=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==f&&(u.flags|=2048)}return l!==s&&l&&(i.child.flags|=8192),_d(i,i.updateQueue),Et(i),null;case 4:return As(),s===null&&tp(i.stateNode.containerInfo),Et(i),null;case 10:return pa(i.type),Et(i),null;case 19:if(ce(Ft),f=i.memoizedState,f===null)return Et(i),null;if(u=(i.flags&128)!==0,g=f.rendering,g===null)if(u)sc(f,!1);else{if(At!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(g=md(s),g!==null){for(i.flags|=128,sc(f,!1),s=g.updateQueue,i.updateQueue=s,_d(i,s),i.subtreeFlags=0,s=l,l=i.child;l!==null;)Ey(l,s),l=l.sibling;return ue(Ft,Ft.current&1|2),i.child}s=s.sibling}f.tail!==null&&Yn()>Nd&&(i.flags|=128,u=!0,sc(f,!1),i.lanes=4194304)}else{if(!u)if(s=md(g),s!==null){if(i.flags|=128,u=!0,s=s.updateQueue,i.updateQueue=s,_d(i,s),sc(f,!0),f.tail===null&&f.tailMode==="hidden"&&!g.alternate&&!et)return Et(i),null}else 2*Yn()-f.renderingStartTime>Nd&&l!==536870912&&(i.flags|=128,u=!0,sc(f,!1),i.lanes=4194304);f.isBackwards?(g.sibling=i.child,i.child=g):(s=f.last,s!==null?s.sibling=g:i.child=g,f.last=g)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Yn(),i.sibling=null,s=Ft.current,ue(Ft,u?s&1|2:s&1),i):(Et(i),null);case 22:case 23:return va(i),sm(),u=i.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(l&536870912)!==0&&(i.flags&128)===0&&(Et(i),i.subtreeFlags&6&&(i.flags|=8192)):Et(i),l=i.updateQueue,l!==null&&_d(i,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==l&&(i.flags|=2048),s!==null&&ce(pr),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),pa(Ut),Et(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function Ew(s,i){switch(zf(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return pa(Ut),As(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return Zs(i),null;case 13:if(va(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(a(340));ql()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return ce(Ft),null;case 4:return As(),null;case 10:return pa(i.type),null;case 22:case 23:return va(i),sm(),s!==null&&ce(pr),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return pa(Ut),null;case 25:return null;default:return null}}function K_(s,i){switch(zf(i),i.tag){case 3:pa(Ut),As();break;case 26:case 27:case 5:Zs(i);break;case 4:As();break;case 13:va(i);break;case 19:ce(Ft);break;case 10:pa(i.type);break;case 22:case 23:va(i),sm(),s!==null&&ce(pr);break;case 24:pa(Ut)}}function ac(s,i){try{var l=i.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&s)===s){u=void 0;var g=l.create,N=l.inst;u=g(),N.destroy=u}l=l.next}while(l!==f)}}catch(I){dt(i,i.return,I)}}function Xa(s,i,l){try{var u=i.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var g=f.next;u=g;do{if((u.tag&s)===s){var N=u.inst,I=N.destroy;if(I!==void 0){N.destroy=void 0,f=i;var B=l,X=I;try{X()}catch(ae){dt(f,B,ae)}}}u=u.next}while(u!==g)}}catch(ae){dt(i,i.return,ae)}}function Q_(s){var i=s.updateQueue;if(i!==null){var l=s.stateNode;try{Py(i,l)}catch(u){dt(s,s.return,u)}}}function X_(s,i,l){l.props=vr(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){dt(s,i,u)}}function ic(s,i){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(f){dt(s,i,f)}}function Us(s,i){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(f){dt(s,i,f)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){dt(s,i,f)}else l.current=null}function W_(s){var i=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(f){dt(s,s.return,f)}}function Rm(s,i,l){try{var u=s.stateNode;Bw(u,s.type,l,i),u[It]=i}catch(f){dt(s,s.return,f)}}function Z_(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ai(s.type)||s.tag===4}function Dm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Z_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ai(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Mm(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(s),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=Rd));else if(u!==4&&(u===27&&ai(s.type)&&(l=s.stateNode,i=null),s=s.child,s!==null))for(Mm(s,i,l),s=s.sibling;s!==null;)Mm(s,i,l),s=s.sibling}function bd(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?l.insertBefore(s,i):l.appendChild(s);else if(u!==4&&(u===27&&ai(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(bd(s,i,l),s=s.sibling;s!==null;)bd(s,i,l),s=s.sibling}function J_(s){var i=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,f=i.attributes;f.length;)i.removeAttributeNode(f[0]);nn(i,u,l),i[Pt]=s,i[It]=l}catch(g){dt(s,s.return,g)}}var ba=!1,Ct=!1,Om=!1,eb=typeof WeakSet=="function"?WeakSet:Set,Kt=null;function Nw(s,i){if(s=s.containerInfo,ap=Vd,s=dy(s),Df(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var f=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var N=0,I=-1,B=-1,X=0,ae=0,oe=s,Z=null;t:for(;;){for(var J;oe!==l||f!==0&&oe.nodeType!==3||(I=N+f),oe!==g||u!==0&&oe.nodeType!==3||(B=N+u),oe.nodeType===3&&(N+=oe.nodeValue.length),(J=oe.firstChild)!==null;)Z=oe,oe=J;for(;;){if(oe===s)break t;if(Z===l&&++X===f&&(I=N),Z===g&&++ae===u&&(B=N),(J=oe.nextSibling)!==null)break;oe=Z,Z=oe.parentNode}oe=J}l=I===-1||B===-1?null:{start:I,end:B}}else l=null}l=l||{start:0,end:0}}else l=null;for(ip={focusedElem:s,selectionRange:l},Vd=!1,Kt=i;Kt!==null;)if(i=Kt,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,Kt=s;else for(;Kt!==null;){switch(i=Kt,g=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&g!==null){s=void 0,l=i,f=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var Ie=vr(l.type,f,l.elementType===l.type);s=u.getSnapshotBeforeUpdate(Ie,g),u.__reactInternalSnapshotBeforeUpdate=s}catch(Ae){dt(l,l.return,Ae)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,l=s.nodeType,l===9)lp(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":lp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=i.sibling,s!==null){s.return=i.return,Kt=s;break}Kt=i.return}}function tb(s,i,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Wa(s,l),u&4&&ac(5,l);break;case 1:if(Wa(s,l),u&4)if(s=l.stateNode,i===null)try{s.componentDidMount()}catch(N){dt(l,l.return,N)}else{var f=vr(l.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(f,i,s.__reactInternalSnapshotBeforeUpdate)}catch(N){dt(l,l.return,N)}}u&64&&Q_(l),u&512&&ic(l,l.return);break;case 3:if(Wa(s,l),u&64&&(s=l.updateQueue,s!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{Py(s,i)}catch(N){dt(l,l.return,N)}}break;case 27:i===null&&u&4&&J_(l);case 26:case 5:Wa(s,l),i===null&&u&4&&W_(l),u&512&&ic(l,l.return);break;case 12:Wa(s,l);break;case 13:Wa(s,l),u&4&&ab(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=Rw.bind(null,l),Qw(s,l))));break;case 22:if(u=l.memoizedState!==null||ba,!u){i=i!==null&&i.memoizedState!==null||Ct,f=ba;var g=Ct;ba=u,(Ct=i)&&!g?Za(s,l,(l.subtreeFlags&8772)!==0):Wa(s,l),ba=f,Ct=g}break;case 30:break;default:Wa(s,l)}}function nb(s){var i=s.alternate;i!==null&&(s.alternate=null,nb(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&Ua(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var _t=null,Cn=!1;function Ea(s,i,l){for(l=l.child;l!==null;)sb(s,i,l),l=l.sibling}function sb(s,i,l){if(st&&typeof st.onCommitFiberUnmount=="function")try{st.onCommitFiberUnmount(xt,l)}catch{}switch(l.tag){case 26:Ct||Us(l,i),Ea(s,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ct||Us(l,i);var u=_t,f=Cn;ai(l.type)&&(_t=l.stateNode,Cn=!1),Ea(s,i,l),mc(l.stateNode),_t=u,Cn=f;break;case 5:Ct||Us(l,i);case 6:if(u=_t,f=Cn,_t=null,Ea(s,i,l),_t=u,Cn=f,_t!==null)if(Cn)try{(_t.nodeType===9?_t.body:_t.nodeName==="HTML"?_t.ownerDocument.body:_t).removeChild(l.stateNode)}catch(g){dt(l,i,g)}else try{_t.removeChild(l.stateNode)}catch(g){dt(l,i,g)}break;case 18:_t!==null&&(Cn?(s=_t,Gb(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Nc(s)):Gb(_t,l.stateNode));break;case 4:u=_t,f=Cn,_t=l.stateNode.containerInfo,Cn=!0,Ea(s,i,l),_t=u,Cn=f;break;case 0:case 11:case 14:case 15:Ct||Xa(2,l,i),Ct||Xa(4,l,i),Ea(s,i,l);break;case 1:Ct||(Us(l,i),u=l.stateNode,typeof u.componentWillUnmount=="function"&&X_(l,i,u)),Ea(s,i,l);break;case 21:Ea(s,i,l);break;case 22:Ct=(u=Ct)||l.memoizedState!==null,Ea(s,i,l),Ct=u;break;default:Ea(s,i,l)}}function ab(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Nc(s)}catch(l){dt(i,i.return,l)}}function xw(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new eb),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new eb),i;default:throw Error(a(435,s.tag))}}function km(s,i){var l=xw(s);i.forEach(function(u){var f=Dw.bind(null,s,u);l.has(u)||(l.add(u),u.then(f,f))})}function Ln(s,i){var l=i.deletions;if(l!==null)for(var u=0;u<l.length;u++){var f=l[u],g=s,N=i,I=N;e:for(;I!==null;){switch(I.tag){case 27:if(ai(I.type)){_t=I.stateNode,Cn=!1;break e}break;case 5:_t=I.stateNode,Cn=!1;break e;case 3:case 4:_t=I.stateNode.containerInfo,Cn=!0;break e}I=I.return}if(_t===null)throw Error(a(160));sb(g,N,f),_t=null,Cn=!1,g=f.alternate,g!==null&&(g.return=null),f.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)ib(i,s),i=i.sibling}var ms=null;function ib(s,i){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ln(i,s),Vn(s),u&4&&(Xa(3,s,s.return),ac(3,s),Xa(5,s,s.return));break;case 1:Ln(i,s),Vn(s),u&512&&(Ct||l===null||Us(l,l.return)),u&64&&ba&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var f=ms;if(Ln(i,s),Vn(s),u&512&&(Ct||l===null||Us(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":g=f.getElementsByTagName("title")[0],(!g||g[$i]||g[Pt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=f.createElement(u),f.head.insertBefore(g,f.querySelector("head > title"))),nn(g,u,l),g[Pt]=s,jt(g),u=g;break e;case"link":var N=Jb("link","href",f).get(u+(l.href||""));if(N){for(var I=0;I<N.length;I++)if(g=N[I],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){N.splice(I,1);break t}}g=f.createElement(u),nn(g,u,l),f.head.appendChild(g);break;case"meta":if(N=Jb("meta","content",f).get(u+(l.content||""))){for(I=0;I<N.length;I++)if(g=N[I],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){N.splice(I,1);break t}}g=f.createElement(u),nn(g,u,l),f.head.appendChild(g);break;default:throw Error(a(468,u))}g[Pt]=s,jt(g),u=g}s.stateNode=u}else eE(f,s.type,s.stateNode);else s.stateNode=Zb(f,u,s.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?eE(f,s.type,s.stateNode):Zb(f,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Rm(s,s.memoizedProps,l.memoizedProps)}break;case 27:Ln(i,s),Vn(s),u&512&&(Ct||l===null||Us(l,l.return)),l!==null&&u&4&&Rm(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Ln(i,s),Vn(s),u&512&&(Ct||l===null||Us(l,l.return)),s.flags&32){f=s.stateNode;try{Qn(f,"")}catch(J){dt(s,s.return,J)}}u&4&&s.stateNode!=null&&(f=s.memoizedProps,Rm(s,f,l!==null?l.memoizedProps:f)),u&1024&&(Om=!0);break;case 6:if(Ln(i,s),Vn(s),u&4){if(s.stateNode===null)throw Error(a(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(J){dt(s,s.return,J)}}break;case 3:if(kd=null,f=ms,ms=Md(i.containerInfo),Ln(i,s),ms=f,Vn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Nc(i.containerInfo)}catch(J){dt(s,s.return,J)}Om&&(Om=!1,rb(s));break;case 4:u=ms,ms=Md(s.stateNode.containerInfo),Ln(i,s),Vn(s),ms=u;break;case 12:Ln(i,s),Vn(s);break;case 13:Ln(i,s),Vn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(qm=Yn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,km(s,u)));break;case 22:f=s.memoizedState!==null;var B=l!==null&&l.memoizedState!==null,X=ba,ae=Ct;if(ba=X||f,Ct=ae||B,Ln(i,s),Ct=ae,ba=X,Vn(s),u&8192)e:for(i=s.stateNode,i._visibility=f?i._visibility&-2:i._visibility|1,f&&(l===null||B||ba||Ct||yr(s)),l=null,i=s;;){if(i.tag===5||i.tag===26){if(l===null){B=l=i;try{if(g=B.stateNode,f)N=g.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{I=B.stateNode;var oe=B.memoizedProps.style,Z=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;I.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(J){dt(B,B.return,J)}}}else if(i.tag===6){if(l===null){B=i;try{B.stateNode.nodeValue=f?"":B.memoizedProps}catch(J){dt(B,B.return,J)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,km(s,l))));break;case 19:Ln(i,s),Vn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,km(s,u)));break;case 30:break;case 21:break;default:Ln(i,s),Vn(s)}}function Vn(s){var i=s.flags;if(i&2){try{for(var l,u=s.return;u!==null;){if(Z_(u)){l=u;break}u=u.return}if(l==null)throw Error(a(160));switch(l.tag){case 27:var f=l.stateNode,g=Dm(s);bd(s,g,f);break;case 5:var N=l.stateNode;l.flags&32&&(Qn(N,""),l.flags&=-33);var I=Dm(s);bd(s,I,N);break;case 3:case 4:var B=l.stateNode.containerInfo,X=Dm(s);Mm(s,X,B);break;default:throw Error(a(161))}}catch(ae){dt(s,s.return,ae)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function rb(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;rb(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function Wa(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)tb(s,i.alternate,i),i=i.sibling}function yr(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Xa(4,i,i.return),yr(i);break;case 1:Us(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&X_(i,i.return,l),yr(i);break;case 27:mc(i.stateNode);case 26:case 5:Us(i,i.return),yr(i);break;case 22:i.memoizedState===null&&yr(i);break;case 30:yr(i);break;default:yr(i)}s=s.sibling}}function Za(s,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,f=s,g=i,N=g.flags;switch(g.tag){case 0:case 11:case 15:Za(f,g,l),ac(4,g);break;case 1:if(Za(f,g,l),u=g,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(X){dt(u,u.return,X)}if(u=g,f=u.updateQueue,f!==null){var I=u.stateNode;try{var B=f.shared.hiddenCallbacks;if(B!==null)for(f.shared.hiddenCallbacks=null,f=0;f<B.length;f++)ky(B[f],I)}catch(X){dt(u,u.return,X)}}l&&N&64&&Q_(g),ic(g,g.return);break;case 27:J_(g);case 26:case 5:Za(f,g,l),l&&u===null&&N&4&&W_(g),ic(g,g.return);break;case 12:Za(f,g,l);break;case 13:Za(f,g,l),l&&N&4&&ab(f,g);break;case 22:g.memoizedState===null&&Za(f,g,l),ic(g,g.return);break;case 30:break;default:Za(f,g,l)}i=i.sibling}}function Pm(s,i){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Hl(l))}function Lm(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Hl(s))}function Fs(s,i,l,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)ob(s,i,l,u),i=i.sibling}function ob(s,i,l,u){var f=i.flags;switch(i.tag){case 0:case 11:case 15:Fs(s,i,l,u),f&2048&&ac(9,i);break;case 1:Fs(s,i,l,u);break;case 3:Fs(s,i,l,u),f&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Hl(s)));break;case 12:if(f&2048){Fs(s,i,l,u),s=i.stateNode;try{var g=i.memoizedProps,N=g.id,I=g.onPostCommit;typeof I=="function"&&I(N,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(B){dt(i,i.return,B)}}else Fs(s,i,l,u);break;case 13:Fs(s,i,l,u);break;case 23:break;case 22:g=i.stateNode,N=i.alternate,i.memoizedState!==null?g._visibility&2?Fs(s,i,l,u):rc(s,i):g._visibility&2?Fs(s,i,l,u):(g._visibility|=2,Eo(s,i,l,u,(i.subtreeFlags&10256)!==0)),f&2048&&Pm(N,i);break;case 24:Fs(s,i,l,u),f&2048&&Lm(i.alternate,i);break;default:Fs(s,i,l,u)}}function Eo(s,i,l,u,f){for(f=f&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var g=s,N=i,I=l,B=u,X=N.flags;switch(N.tag){case 0:case 11:case 15:Eo(g,N,I,B,f),ac(8,N);break;case 23:break;case 22:var ae=N.stateNode;N.memoizedState!==null?ae._visibility&2?Eo(g,N,I,B,f):rc(g,N):(ae._visibility|=2,Eo(g,N,I,B,f)),f&&X&2048&&Pm(N.alternate,N);break;case 24:Eo(g,N,I,B,f),f&&X&2048&&Lm(N.alternate,N);break;default:Eo(g,N,I,B,f)}i=i.sibling}}function rc(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=s,u=i,f=u.flags;switch(u.tag){case 22:rc(l,u),f&2048&&Pm(u.alternate,u);break;case 24:rc(l,u),f&2048&&Lm(u.alternate,u);break;default:rc(l,u)}i=i.sibling}}var oc=8192;function No(s){if(s.subtreeFlags&oc)for(s=s.child;s!==null;)lb(s),s=s.sibling}function lb(s){switch(s.tag){case 26:No(s),s.flags&oc&&s.memoizedState!==null&&lC(ms,s.memoizedState,s.memoizedProps);break;case 5:No(s);break;case 3:case 4:var i=ms;ms=Md(s.stateNode.containerInfo),No(s),ms=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=oc,oc=16777216,No(s),oc=i):No(s));break;default:No(s)}}function cb(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function lc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];Kt=u,db(u,s)}cb(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)ub(s),s=s.sibling}function ub(s){switch(s.tag){case 0:case 11:case 15:lc(s),s.flags&2048&&Xa(9,s,s.return);break;case 3:lc(s);break;case 12:lc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,Ed(s)):lc(s);break;default:lc(s)}}function Ed(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];Kt=u,db(u,s)}cb(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Xa(8,i,i.return),Ed(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,Ed(i));break;default:Ed(i)}s=s.sibling}}function db(s,i){for(;Kt!==null;){var l=Kt;switch(l.tag){case 0:case 11:case 15:Xa(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Hl(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Kt=u;else e:for(l=s;Kt!==null;){u=Kt;var f=u.sibling,g=u.return;if(nb(u),u===l){Kt=null;break e}if(f!==null){f.return=g,Kt=f;break e}Kt=g}}}var Tw={getCacheForType:function(s){var i=un(Ut),l=i.data.get(s);return l===void 0&&(l=s(),i.data.set(s,l)),l}},Aw=typeof WeakMap=="function"?WeakMap:Map,at=0,pt=null,He=null,Xe=0,it=0,Un=null,Ja=!1,xo=!1,Vm=!1,Na=0,At=0,ei=0,_r=0,Um=0,as=0,To=0,cc=null,Sn=null,Fm=!1,qm=0,Nd=1/0,xd=null,ti=null,tn=0,ni=null,Ao=null,jo=0,Bm=0,zm=null,hb=null,uc=0,Hm=null;function Fn(){if((at&2)!==0&&Xe!==0)return Xe&-Xe;if(z.T!==null){var s=fo;return s!==0?s:Wm()}return La()}function fb(){as===0&&(as=(Xe&536870912)===0||et?_l():536870912);var s=ss.current;return s!==null&&(s.flags|=32),as}function qn(s,i,l){(s===pt&&(it===2||it===9)||s.cancelPendingCommit!==null)&&(wo(s,0),si(s,Xe,as,!1)),ea(s,l),((at&2)===0||s!==pt)&&(s===pt&&((at&2)===0&&(_r|=l),At===4&&si(s,Xe,as,!1)),qs(s))}function mb(s,i,l){if((at&6)!==0)throw Error(a(327));var u=!l&&(i&124)===0&&(i&s.expiredLanes)===0||Gi(s,i),f=u?Cw(s,i):Ym(s,i,!0),g=u;do{if(f===0){xo&&!u&&si(s,i,0,!1);break}else{if(l=s.current.alternate,g&&!jw(l)){f=Ym(s,i,!1),g=!1;continue}if(f===2){if(g=i,s.errorRecoveryDisabledLanes&g)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){i=N;e:{var I=s;f=cc;var B=I.current.memoizedState.isDehydrated;if(B&&(wo(I,N).flags|=256),N=Ym(I,N,!1),N!==2){if(Vm&&!B){I.errorRecoveryDisabledLanes|=g,_r|=g,f=4;break e}g=Sn,Sn=f,g!==null&&(Sn===null?Sn=g:Sn.push.apply(Sn,g))}f=N}if(g=!1,f!==2)continue}}if(f===1){wo(s,0),si(s,i,0,!0);break}e:{switch(u=s,g=f,g){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:si(u,i,as,!Ja);break e;case 2:Sn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(f=qm+300-Yn(),10<f)){if(si(u,i,as,!Ja),zr(u,0,!0)!==0)break e;u.timeoutHandle=zb(pb.bind(null,u,l,Sn,xd,Fm,i,as,_r,To,Ja,g,2,-0,0),f);break e}pb(u,l,Sn,xd,Fm,i,as,_r,To,Ja,g,0,-0,0)}}break}while(!0);qs(s)}function pb(s,i,l,u,f,g,N,I,B,X,ae,oe,Z,J){if(s.timeoutHandle=-1,oe=i.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(vc={stylesheets:null,count:0,unsuspend:oC},lb(i),oe=cC(),oe!==null)){s.cancelPendingCommit=oe(Nb.bind(null,s,i,g,l,u,f,N,I,B,ae,1,Z,J)),si(s,g,N,!X);return}Nb(s,i,g,l,u,f,N,I,B)}function jw(s){for(var i=s;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var f=l[u],g=f.getSnapshot;f=f.value;try{if(!kn(g(),f))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function si(s,i,l,u){i&=~Um,i&=~_r,s.suspendedLanes|=i,s.pingedLanes&=~i,u&&(s.warmLanes|=i),u=s.expirationTimes;for(var f=i;0<f;){var g=31-cn(f),N=1<<g;u[g]=-1,f&=~N}l!==0&&js(s,l,i)}function Td(){return(at&6)===0?(dc(0),!1):!0}function Gm(){if(He!==null){if(it===0)var s=He.return;else s=He,ma=fr=null,lm(s),_o=null,tc=0,s=He;for(;s!==null;)K_(s.alternate,s),s=s.return;He=null}}function wo(s,i){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,Hw(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Gm(),pt=s,He=l=da(s.current,null),Xe=i,it=0,Un=null,Ja=!1,xo=Gi(s,i),Vm=!1,To=as=Um=_r=ei=At=0,Sn=cc=null,Fm=!1,(i&8)!==0&&(i|=i&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=i;0<u;){var f=31-cn(u),g=1<<f;i|=s[f],u&=~g}return Na=i,$u(),l}function gb(s,i){Ue=null,z.H=dd,i===$l||i===td?(i=My(),it=3):i===Iy?(i=My(),it=4):it=i===O_?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Un=i,He===null&&(At=1,gd(s,Jn(i,s.current)))}function vb(){var s=z.H;return z.H=dd,s===null?dd:s}function yb(){var s=z.A;return z.A=Tw,s}function $m(){At=4,Ja||(Xe&4194048)!==Xe&&ss.current!==null||(xo=!0),(ei&134217727)===0&&(_r&134217727)===0||pt===null||si(pt,Xe,as,!1)}function Ym(s,i,l){var u=at;at|=2;var f=vb(),g=yb();(pt!==s||Xe!==i)&&(xd=null,wo(s,i)),i=!1;var N=At;e:do try{if(it!==0&&He!==null){var I=He,B=Un;switch(it){case 8:Gm(),N=6;break e;case 3:case 2:case 9:case 6:ss.current===null&&(i=!0);var X=it;if(it=0,Un=null,Co(s,I,B,X),l&&xo){N=0;break e}break;default:X=it,it=0,Un=null,Co(s,I,B,X)}}ww(),N=At;break}catch(ae){gb(s,ae)}while(!0);return i&&s.shellSuspendCounter++,ma=fr=null,at=u,z.H=f,z.A=g,He===null&&(pt=null,Xe=0,$u()),N}function ww(){for(;He!==null;)_b(He)}function Cw(s,i){var l=at;at|=2;var u=vb(),f=yb();pt!==s||Xe!==i?(xd=null,Nd=Yn()+500,wo(s,i)):xo=Gi(s,i);e:do try{if(it!==0&&He!==null){i=He;var g=Un;t:switch(it){case 1:it=0,Un=null,Co(s,i,g,1);break;case 2:case 9:if(Ry(g)){it=0,Un=null,bb(i);break}i=function(){it!==2&&it!==9||pt!==s||(it=7),qs(s)},g.then(i,i);break e;case 3:it=7;break e;case 4:it=5;break e;case 7:Ry(g)?(it=0,Un=null,bb(i)):(it=0,Un=null,Co(s,i,g,7));break;case 5:var N=null;switch(He.tag){case 26:N=He.memoizedState;case 5:case 27:var I=He;if(!N||tE(N)){it=0,Un=null;var B=I.sibling;if(B!==null)He=B;else{var X=I.return;X!==null?(He=X,Ad(X)):He=null}break t}}it=0,Un=null,Co(s,i,g,5);break;case 6:it=0,Un=null,Co(s,i,g,6);break;case 8:Gm(),At=6;break e;default:throw Error(a(462))}}Sw();break}catch(ae){gb(s,ae)}while(!0);return ma=fr=null,z.H=u,z.A=f,at=l,He!==null?0:(pt=null,Xe=0,$u(),At)}function Sw(){for(;He!==null&&!pl();)_b(He)}function _b(s){var i=$_(s.alternate,s,Na);s.memoizedProps=s.pendingProps,i===null?Ad(s):He=i}function bb(s){var i=s,l=i.alternate;switch(i.tag){case 15:case 0:i=F_(l,i,i.pendingProps,i.type,void 0,Xe);break;case 11:i=F_(l,i,i.pendingProps,i.type.render,i.ref,Xe);break;case 5:lm(i);default:K_(l,i),i=He=Ey(i,Na),i=$_(l,i,Na)}s.memoizedProps=s.pendingProps,i===null?Ad(s):He=i}function Co(s,i,l,u){ma=fr=null,lm(i),_o=null,tc=0;var f=i.return;try{if(yw(s,f,i,l,Xe)){At=1,gd(s,Jn(l,s.current)),He=null;return}}catch(g){if(f!==null)throw He=f,g;At=1,gd(s,Jn(l,s.current)),He=null;return}i.flags&32768?(et||u===1?s=!0:xo||(Xe&536870912)!==0?s=!1:(Ja=s=!0,(u===2||u===9||u===3||u===6)&&(u=ss.current,u!==null&&u.tag===13&&(u.flags|=16384))),Eb(i,s)):Ad(i)}function Ad(s){var i=s;do{if((i.flags&32768)!==0){Eb(i,Ja);return}s=i.return;var l=bw(i.alternate,i,Na);if(l!==null){He=l;return}if(i=i.sibling,i!==null){He=i;return}He=i=s}while(i!==null);At===0&&(At=5)}function Eb(s,i){do{var l=Ew(s.alternate,s);if(l!==null){l.flags&=32767,He=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(s=s.sibling,s!==null)){He=s;return}He=s=l}while(s!==null);At=6,He=null}function Nb(s,i,l,u,f,g,N,I,B){s.cancelPendingCommit=null;do jd();while(tn!==0);if((at&6)!==0)throw Error(a(327));if(i!==null){if(i===s.current)throw Error(a(177));if(g=i.lanes|i.childLanes,g|=Lf,El(s,l,g,N,I,B),s===pt&&(He=pt=null,Xe=0),Ao=i,ni=s,jo=l,Bm=g,zm=f,hb=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Mw(qi,function(){return wb(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=z.T,z.T=null,f=se.p,se.p=2,N=at,at|=4;try{Nw(s,i,l)}finally{at=N,se.p=f,z.T=u}}tn=1,xb(),Tb(),Ab()}}function xb(){if(tn===1){tn=0;var s=ni,i=Ao,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=z.T,z.T=null;var u=se.p;se.p=2;var f=at;at|=4;try{ib(i,s);var g=ip,N=dy(s.containerInfo),I=g.focusedElem,B=g.selectionRange;if(N!==I&&I&&I.ownerDocument&&uy(I.ownerDocument.documentElement,I)){if(B!==null&&Df(I)){var X=B.start,ae=B.end;if(ae===void 0&&(ae=X),"selectionStart"in I)I.selectionStart=X,I.selectionEnd=Math.min(ae,I.value.length);else{var oe=I.ownerDocument||document,Z=oe&&oe.defaultView||window;if(Z.getSelection){var J=Z.getSelection(),Ie=I.textContent.length,Ae=Math.min(B.start,Ie),ut=B.end===void 0?Ae:Math.min(B.end,Ie);!J.extend&&Ae>ut&&(N=ut,ut=Ae,Ae=N);var G=cy(I,Ae),H=cy(I,ut);if(G&&H&&(J.rangeCount!==1||J.anchorNode!==G.node||J.anchorOffset!==G.offset||J.focusNode!==H.node||J.focusOffset!==H.offset)){var Q=oe.createRange();Q.setStart(G.node,G.offset),J.removeAllRanges(),Ae>ut?(J.addRange(Q),J.extend(H.node,H.offset)):(Q.setEnd(H.node,H.offset),J.addRange(Q))}}}}for(oe=[],J=I;J=J.parentNode;)J.nodeType===1&&oe.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<oe.length;I++){var ie=oe[I];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Vd=!!ap,ip=ap=null}finally{at=f,se.p=u,z.T=l}}s.current=i,tn=2}}function Tb(){if(tn===2){tn=0;var s=ni,i=Ao,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=z.T,z.T=null;var u=se.p;se.p=2;var f=at;at|=4;try{tb(s,i.alternate,i)}finally{at=f,se.p=u,z.T=l}}tn=3}}function Ab(){if(tn===4||tn===3){tn=0,Eu();var s=ni,i=Ao,l=jo,u=hb;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?tn=5:(tn=0,Ao=ni=null,jb(s,s.pendingLanes));var f=s.pendingLanes;if(f===0&&(ti=null),Hr(l),i=i.stateNode,st&&typeof st.onCommitFiberRoot=="function")try{st.onCommitFiberRoot(xt,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=z.T,f=se.p,se.p=2,z.T=null;try{for(var g=s.onRecoverableError,N=0;N<u.length;N++){var I=u[N];g(I.value,{componentStack:I.stack})}}finally{z.T=i,se.p=f}}(jo&3)!==0&&jd(),qs(s),f=s.pendingLanes,(l&4194090)!==0&&(f&42)!==0?s===Hm?uc++:(uc=0,Hm=s):uc=0,dc(0)}}function jb(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,Hl(i)))}function jd(s){return xb(),Tb(),Ab(),wb()}function wb(){if(tn!==5)return!1;var s=ni,i=Bm;Bm=0;var l=Hr(jo),u=z.T,f=se.p;try{se.p=32>l?32:l,z.T=null,l=zm,zm=null;var g=ni,N=jo;if(tn=0,Ao=ni=null,jo=0,(at&6)!==0)throw Error(a(331));var I=at;if(at|=4,ub(g.current),ob(g,g.current,N,l),at=I,dc(0,!1),st&&typeof st.onPostCommitFiberRoot=="function")try{st.onPostCommitFiberRoot(xt,g)}catch{}return!0}finally{se.p=f,z.T=u,jb(s,i)}}function Cb(s,i,l){i=Jn(l,i),i=Nm(s.stateNode,i,2),s=$a(s,i,2),s!==null&&(ea(s,2),qs(s))}function dt(s,i,l){if(s.tag===3)Cb(s,s,l);else for(;i!==null;){if(i.tag===3){Cb(i,s,l);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ti===null||!ti.has(u))){s=Jn(l,s),l=D_(2),u=$a(i,l,2),u!==null&&(M_(l,u,i,s),ea(u,2),qs(u));break}}i=i.return}}function Km(s,i,l){var u=s.pingCache;if(u===null){u=s.pingCache=new Aw;var f=new Set;u.set(i,f)}else f=u.get(i),f===void 0&&(f=new Set,u.set(i,f));f.has(l)||(Vm=!0,f.add(l),s=Iw.bind(null,s,i,l),i.then(s,s))}function Iw(s,i,l){var u=s.pingCache;u!==null&&u.delete(i),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,pt===s&&(Xe&l)===l&&(At===4||At===3&&(Xe&62914560)===Xe&&300>Yn()-qm?(at&2)===0&&wo(s,0):Um|=l,To===Xe&&(To=0)),qs(s)}function Sb(s,i){i===0&&(i=bl()),s=lo(s,i),s!==null&&(ea(s,i),qs(s))}function Rw(s){var i=s.memoizedState,l=0;i!==null&&(l=i.retryLane),Sb(s,l)}function Dw(s,i){var l=0;switch(s.tag){case 13:var u=s.stateNode,f=s.memoizedState;f!==null&&(l=f.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(i),Sb(s,l)}function Mw(s,i){return Ui(s,i)}var wd=null,So=null,Qm=!1,Cd=!1,Xm=!1,br=0;function qs(s){s!==So&&s.next===null&&(So===null?wd=So=s:So=So.next=s),Cd=!0,Qm||(Qm=!0,kw())}function dc(s,i){if(!Xm&&Cd){Xm=!0;do for(var l=!1,u=wd;u!==null;){if(s!==0){var f=u.pendingLanes;if(f===0)var g=0;else{var N=u.suspendedLanes,I=u.pingedLanes;g=(1<<31-cn(42|s)+1)-1,g&=f&~(N&~I),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,Mb(u,g))}else g=Xe,g=zr(u,u===pt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||Gi(u,g)||(l=!0,Mb(u,g));u=u.next}while(l);Xm=!1}}function Ow(){Ib()}function Ib(){Cd=Qm=!1;var s=0;br!==0&&(zw()&&(s=br),br=0);for(var i=Yn(),l=null,u=wd;u!==null;){var f=u.next,g=Rb(u,i);g===0?(u.next=null,l===null?wd=f:l.next=f,f===null&&(So=l)):(l=u,(s!==0||(g&3)!==0)&&(Cd=!0)),u=f}dc(s)}function Rb(s,i){for(var l=s.suspendedLanes,u=s.pingedLanes,f=s.expirationTimes,g=s.pendingLanes&-62914561;0<g;){var N=31-cn(g),I=1<<N,B=f[N];B===-1?((I&l)===0||(I&u)!==0)&&(f[N]=yl(I,i)):B<=i&&(s.expiredLanes|=I),g&=~I}if(i=pt,l=Xe,l=zr(s,s===i?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===i&&(it===2||it===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Fi(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Gi(s,l)){if(i=l&-l,i===s.callbackPriority)return i;switch(u!==null&&Fi(u),Hr(l)){case 2:case 8:l=qr;break;case 32:l=qi;break;case 268435456:l=Br;break;default:l=qi}return u=Db.bind(null,s),l=Ui(l,u),s.callbackPriority=i,s.callbackNode=l,i}return u!==null&&u!==null&&Fi(u),s.callbackPriority=2,s.callbackNode=null,2}function Db(s,i){if(tn!==0&&tn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(jd()&&s.callbackNode!==l)return null;var u=Xe;return u=zr(s,s===pt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(mb(s,u,i),Rb(s,Yn()),s.callbackNode!=null&&s.callbackNode===l?Db.bind(null,s):null)}function Mb(s,i){if(jd())return null;mb(s,i,!0)}function kw(){Gw(function(){(at&6)!==0?Ui(gl,Ow):Ib()})}function Wm(){return br===0&&(br=_l()),br}function Ob(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Xr(""+s)}function kb(s,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,s.id&&l.setAttribute("form",s.id),i.parentNode.insertBefore(l,i),s=new FormData(s),l.parentNode.removeChild(l),s}function Pw(s,i,l,u,f){if(i==="submit"&&l&&l.stateNode===f){var g=Ob((f[It]||null).action),N=u.submitter;N&&(i=(i=N[It]||null)?Ob(i.formAction):N.getAttribute("formAction"),i!==null&&(g=i,N=null));var I=new Wr("action","action",null,u,f);s.push({event:I,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(br!==0){var B=N?kb(f,N):new FormData(f);vm(l,{pending:!0,data:B,method:f.method,action:g},null,B)}}else typeof g=="function"&&(I.preventDefault(),B=N?kb(f,N):new FormData(f),vm(l,{pending:!0,data:B,method:f.method,action:g},g,B))},currentTarget:f}]})}}for(var Zm=0;Zm<Pf.length;Zm++){var Jm=Pf[Zm],Lw=Jm.toLowerCase(),Vw=Jm[0].toUpperCase()+Jm.slice(1);fs(Lw,"on"+Vw)}fs(my,"onAnimationEnd"),fs(py,"onAnimationIteration"),fs(gy,"onAnimationStart"),fs("dblclick","onDoubleClick"),fs("focusin","onFocus"),fs("focusout","onBlur"),fs(tw,"onTransitionRun"),fs(nw,"onTransitionStart"),fs(sw,"onTransitionCancel"),fs(vy,"onTransitionEnd"),na("onMouseEnter",["mouseout","mouseover"]),na("onMouseLeave",["mouseout","mouseover"]),na("onPointerEnter",["pointerout","pointerover"]),na("onPointerLeave",["pointerout","pointerover"]),ds("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ds("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ds("onBeforeInput",["compositionend","keypress","textInput","paste"]),ds("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ds("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ds("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Uw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hc));function Pb(s,i){i=(i&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],f=u.event;u=u.listeners;e:{var g=void 0;if(i)for(var N=u.length-1;0<=N;N--){var I=u[N],B=I.instance,X=I.currentTarget;if(I=I.listener,B!==g&&f.isPropagationStopped())break e;g=I,f.currentTarget=X;try{g(f)}catch(ae){pd(ae)}f.currentTarget=null,g=B}else for(N=0;N<u.length;N++){if(I=u[N],B=I.instance,X=I.currentTarget,I=I.listener,B!==g&&f.isPropagationStopped())break e;g=I,f.currentTarget=X;try{g(f)}catch(ae){pd(ae)}f.currentTarget=null,g=B}}}}function Ge(s,i){var l=i[xl];l===void 0&&(l=i[xl]=new Set);var u=s+"__bubble";l.has(u)||(Lb(i,s,2,!1),l.add(u))}function ep(s,i,l){var u=0;i&&(u|=4),Lb(l,s,u,i)}var Sd="_reactListening"+Math.random().toString(36).slice(2);function tp(s){if(!s[Sd]){s[Sd]=!0,Tl.forEach(function(l){l!=="selectionchange"&&(Uw.has(l)||ep(l,!1,s),ep(l,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Sd]||(i[Sd]=!0,ep("selectionchange",!1,i))}}function Lb(s,i,l,u){switch(oE(i)){case 2:var f=hC;break;case 8:f=fC;break;default:f=pp}l=f.bind(null,i,l,s),f=void 0,!Wn||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),u?f!==void 0?s.addEventListener(i,l,{capture:!0,passive:f}):s.addEventListener(i,l,!0):f!==void 0?s.addEventListener(i,l,{passive:f}):s.addEventListener(i,l,!1)}function np(s,i,l,u,f){var g=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var N=u.tag;if(N===3||N===4){var I=u.stateNode.containerInfo;if(I===f)break;if(N===4)for(N=u.return;N!==null;){var B=N.tag;if((B===3||B===4)&&N.stateNode.containerInfo===f)return;N=N.return}for(;I!==null;){if(N=ta(I),N===null)return;if(B=N.tag,B===5||B===6||B===26||B===27){u=g=N;continue e}I=I.parentNode}}u=u.return}Ru(function(){var X=g,ae=Xn(l),oe=[];e:{var Z=yy.get(s);if(Z!==void 0){var J=Wr,Ie=s;switch(s){case"keypress":if(Ds(l)===0)break e;case"keydown":case"keyup":J=so;break;case"focusin":Ie="focus",J=eo;break;case"focusout":Ie="blur",J=eo;break;case"beforeblur":case"afterblur":J=eo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=Zn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=Cf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=Uu;break;case my:case py:case gy:J=to;break;case vy:J=qu;break;case"scroll":case"scrollend":J=Du;break;case"wheel":J=ao;break;case"copy":case"cut":case"paste":J=no;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=Pl;break;case"toggle":case"beforetoggle":J=zu}var Ae=(i&4)!==0,ut=!Ae&&(s==="scroll"||s==="scrollend"),G=Ae?Z!==null?Z+"Capture":null:Z;Ae=[];for(var H=X,Q;H!==null;){var ie=H;if(Q=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||Q===null||G===null||(ie=Ji(H,G),ie!=null&&Ae.push(fc(H,ie,Q))),ut)break;H=H.return}0<Ae.length&&(Z=new J(Z,Ie,null,l,ae),oe.push({event:Z,listeners:Ae}))}}if((i&7)===0){e:{if(Z=s==="mouseover"||s==="pointerover",J=s==="mouseout"||s==="pointerout",Z&&l!==ia&&(Ie=l.relatedTarget||l.fromElement)&&(ta(Ie)||Ie[Kn]))break e;if((J||Z)&&(Z=ae.window===ae?ae:(Z=ae.ownerDocument)?Z.defaultView||Z.parentWindow:window,J?(Ie=l.relatedTarget||l.toElement,J=X,Ie=Ie?ta(Ie):null,Ie!==null&&(ut=c(Ie),Ae=Ie.tag,Ie!==ut||Ae!==5&&Ae!==27&&Ae!==6)&&(Ie=null)):(J=null,Ie=X),J!==Ie)){if(Ae=Zn,ie="onMouseLeave",G="onMouseEnter",H="mouse",(s==="pointerout"||s==="pointerover")&&(Ae=Pl,ie="onPointerLeave",G="onPointerEnter",H="pointer"),ut=J==null?Z:Cs(J),Q=Ie==null?Z:Cs(Ie),Z=new Ae(ie,H+"leave",J,l,ae),Z.target=ut,Z.relatedTarget=Q,ie=null,ta(ae)===X&&(Ae=new Ae(G,H+"enter",Ie,l,ae),Ae.target=Q,Ae.relatedTarget=ut,ie=Ae),ut=ie,J&&Ie)t:{for(Ae=J,G=Ie,H=0,Q=Ae;Q;Q=Io(Q))H++;for(Q=0,ie=G;ie;ie=Io(ie))Q++;for(;0<H-Q;)Ae=Io(Ae),H--;for(;0<Q-H;)G=Io(G),Q--;for(;H--;){if(Ae===G||G!==null&&Ae===G.alternate)break t;Ae=Io(Ae),G=Io(G)}Ae=null}else Ae=null;J!==null&&Vb(oe,Z,J,Ae,!1),Ie!==null&&ut!==null&&Vb(oe,ut,Ie,Ae,!0)}}e:{if(Z=X?Cs(X):window,J=Z.nodeName&&Z.nodeName.toLowerCase(),J==="select"||J==="input"&&Z.type==="file")var _e=sy;else if(Vt(Z))if(ay)_e=Zj;else{_e=Xj;var Be=Qj}else J=Z.nodeName,!J||J.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?X&&Sl(X.elementType)&&(_e=sy):_e=Wj;if(_e&&(_e=_e(s,X))){ua(oe,_e,l,ae);break e}Be&&Be(s,Z,X),s==="focusout"&&X&&Z.type==="number"&&X.memoizedProps.value!=null&&qa(Z,"number",Z.value)}switch(Be=X?Cs(X):window,s){case"focusin":(Vt(Be)||Be.contentEditable==="true")&&(io=Be,Mf=X,Ul=null);break;case"focusout":Ul=Mf=io=null;break;case"mousedown":Of=!0;break;case"contextmenu":case"mouseup":case"dragend":Of=!1,hy(oe,l,ae);break;case"selectionchange":if(ew)break;case"keydown":case"keyup":hy(oe,l,ae)}var be;if(ks)e:{switch(s){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Ke?te(s,l)&&(je="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(je="onCompositionStart");je&&(E&&l.locale!=="ko"&&(Ke||je!=="onCompositionStart"?je==="onCompositionEnd"&&Ke&&(be=Rl()):(Rs=ae,Ba="value"in Rs?Rs.value:Rs.textContent,Ke=!0)),Be=Id(X,je),0<Be.length&&(je=new Ol(je,s,null,l,ae),oe.push({event:je,listeners:Be}),be?je.data=be:(be=de(l),be!==null&&(je.data=be)))),(be=y?Lt(s,l):Qe(s,l))&&(je=Id(X,"onBeforeInput"),0<je.length&&(Be=new Ol("onBeforeInput","beforeinput",null,l,ae),oe.push({event:Be,listeners:je}),Be.data=be)),Pw(oe,s,X,l,ae)}Pb(oe,i)})}function fc(s,i,l){return{instance:s,listener:i,currentTarget:l}}function Id(s,i){for(var l=i+"Capture",u=[];s!==null;){var f=s,g=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||g===null||(f=Ji(s,l),f!=null&&u.unshift(fc(s,f,g)),f=Ji(s,i),f!=null&&u.push(fc(s,f,g))),s.tag===3)return u;s=s.return}return[]}function Io(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Vb(s,i,l,u,f){for(var g=i._reactName,N=[];l!==null&&l!==u;){var I=l,B=I.alternate,X=I.stateNode;if(I=I.tag,B!==null&&B===u)break;I!==5&&I!==26&&I!==27||X===null||(B=X,f?(X=Ji(l,g),X!=null&&N.unshift(fc(l,X,B))):f||(X=Ji(l,g),X!=null&&N.push(fc(l,X,B)))),l=l.return}N.length!==0&&s.push({event:i,listeners:N})}var Fw=/\r\n?/g,qw=/\u0000|\uFFFD/g;function Ub(s){return(typeof s=="string"?s:""+s).replace(Fw,`
`).replace(qw,"")}function Fb(s,i){return i=Ub(i),Ub(s)===i}function Rd(){}function ct(s,i,l,u,f,g){switch(l){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||Qn(s,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&Qn(s,""+u);break;case"className":Ss(s,"class",u);break;case"tabIndex":Ss(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ss(s,l,u);break;case"style":Cl(s,u,g);break;case"data":if(i!=="object"){Ss(s,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Xr(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(i!=="input"&&ct(s,i,"name",f.name,f,null),ct(s,i,"formEncType",f.formEncType,f,null),ct(s,i,"formMethod",f.formMethod,f,null),ct(s,i,"formTarget",f.formTarget,f,null)):(ct(s,i,"encType",f.encType,f,null),ct(s,i,"method",f.method,f,null),ct(s,i,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Xr(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=Rd);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Xr(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":Ge("beforetoggle",s),Ge("toggle",s),Fa(s,"popover",u);break;case"xlinkActuate":Zt(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Zt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Zt(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Zt(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Zt(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Zt(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Fa(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=jf.get(l)||l,Fa(s,l,u))}}function sp(s,i,l,u,f,g){switch(l){case"style":Cl(s,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"children":typeof u=="string"?Qn(s,u):(typeof u=="number"||typeof u=="bigint")&&Qn(s,""+u);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"onClick":u!=null&&(s.onclick=Rd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gr.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),i=l.slice(2,f?l.length-7:void 0),g=s[It]||null,g=g!=null?g[l]:null,typeof g=="function"&&s.removeEventListener(i,g,f),typeof u=="function")){typeof g!="function"&&g!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(i,u,f);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):Fa(s,l,u)}}}function nn(s,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",s),Ge("load",s);var u=!1,f=!1,g;for(g in l)if(l.hasOwnProperty(g)){var N=l[g];if(N!=null)switch(g){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:ct(s,i,g,N,l,null)}}f&&ct(s,i,"srcSet",l.srcSet,l,null),u&&ct(s,i,"src",l.src,l,null);return;case"input":Ge("invalid",s);var I=g=N=f=null,B=null,X=null;for(u in l)if(l.hasOwnProperty(u)){var ae=l[u];if(ae!=null)switch(u){case"name":f=ae;break;case"type":N=ae;break;case"checked":B=ae;break;case"defaultChecked":X=ae;break;case"value":g=ae;break;case"defaultValue":I=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(a(137,i));break;default:ct(s,i,u,ae,l,null)}}Xi(s,g,I,B,X,N,f,!1),Qr(s);return;case"select":Ge("invalid",s),u=N=g=null;for(f in l)if(l.hasOwnProperty(f)&&(I=l[f],I!=null))switch(f){case"value":g=I;break;case"defaultValue":N=I;break;case"multiple":u=I;default:ct(s,i,f,I,l,null)}i=g,l=N,s.multiple=!!u,i!=null?aa(s,!!u,i,!1):l!=null&&aa(s,!!u,l,!0);return;case"textarea":Ge("invalid",s),g=f=u=null;for(N in l)if(l.hasOwnProperty(N)&&(I=l[N],I!=null))switch(N){case"value":u=I;break;case"defaultValue":f=I;break;case"children":g=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(a(91));break;default:ct(s,i,N,I,l,null)}Wi(s,u,f,g),Qr(s);return;case"option":for(B in l)if(l.hasOwnProperty(B)&&(u=l[B],u!=null))switch(B){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:ct(s,i,B,u,l,null)}return;case"dialog":Ge("beforetoggle",s),Ge("toggle",s),Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":Ge("load",s);break;case"video":case"audio":for(u=0;u<hc.length;u++)Ge(hc[u],s);break;case"image":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"embed":case"source":case"link":Ge("error",s),Ge("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(X in l)if(l.hasOwnProperty(X)&&(u=l[X],u!=null))switch(X){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:ct(s,i,X,u,l,null)}return;default:if(Sl(i)){for(ae in l)l.hasOwnProperty(ae)&&(u=l[ae],u!==void 0&&sp(s,i,ae,u,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(u=l[I],u!=null&&ct(s,i,I,u,l,null))}function Bw(s,i,l,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,g=null,N=null,I=null,B=null,X=null,ae=null;for(J in l){var oe=l[J];if(l.hasOwnProperty(J)&&oe!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":B=oe;default:u.hasOwnProperty(J)||ct(s,i,J,null,u,oe)}}for(var Z in u){var J=u[Z];if(oe=l[Z],u.hasOwnProperty(Z)&&(J!=null||oe!=null))switch(Z){case"type":g=J;break;case"name":f=J;break;case"checked":X=J;break;case"defaultChecked":ae=J;break;case"value":N=J;break;case"defaultValue":I=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(a(137,i));break;default:J!==oe&&ct(s,i,Z,J,u,oe)}}On(s,N,I,B,X,ae,g,f);return;case"select":J=N=I=Z=null;for(g in l)if(B=l[g],l.hasOwnProperty(g)&&B!=null)switch(g){case"value":break;case"multiple":J=B;default:u.hasOwnProperty(g)||ct(s,i,g,null,u,B)}for(f in u)if(g=u[f],B=l[f],u.hasOwnProperty(f)&&(g!=null||B!=null))switch(f){case"value":Z=g;break;case"defaultValue":I=g;break;case"multiple":N=g;default:g!==B&&ct(s,i,f,g,u,B)}i=I,l=N,u=J,Z!=null?aa(s,!!l,Z,!1):!!u!=!!l&&(i!=null?aa(s,!!l,i,!0):aa(s,!!l,l?[]:"",!1));return;case"textarea":J=Z=null;for(I in l)if(f=l[I],l.hasOwnProperty(I)&&f!=null&&!u.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:ct(s,i,I,null,u,f)}for(N in u)if(f=u[N],g=l[N],u.hasOwnProperty(N)&&(f!=null||g!=null))switch(N){case"value":Z=f;break;case"defaultValue":J=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==g&&ct(s,i,N,f,u,g)}ot(s,Z,J);return;case"option":for(var Ie in l)if(Z=l[Ie],l.hasOwnProperty(Ie)&&Z!=null&&!u.hasOwnProperty(Ie))switch(Ie){case"selected":s.selected=!1;break;default:ct(s,i,Ie,null,u,Z)}for(B in u)if(Z=u[B],J=l[B],u.hasOwnProperty(B)&&Z!==J&&(Z!=null||J!=null))switch(B){case"selected":s.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:ct(s,i,B,Z,u,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in l)Z=l[Ae],l.hasOwnProperty(Ae)&&Z!=null&&!u.hasOwnProperty(Ae)&&ct(s,i,Ae,null,u,Z);for(X in u)if(Z=u[X],J=l[X],u.hasOwnProperty(X)&&Z!==J&&(Z!=null||J!=null))switch(X){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(a(137,i));break;default:ct(s,i,X,Z,u,J)}return;default:if(Sl(i)){for(var ut in l)Z=l[ut],l.hasOwnProperty(ut)&&Z!==void 0&&!u.hasOwnProperty(ut)&&sp(s,i,ut,void 0,u,Z);for(ae in u)Z=u[ae],J=l[ae],!u.hasOwnProperty(ae)||Z===J||Z===void 0&&J===void 0||sp(s,i,ae,Z,u,J);return}}for(var G in l)Z=l[G],l.hasOwnProperty(G)&&Z!=null&&!u.hasOwnProperty(G)&&ct(s,i,G,null,u,Z);for(oe in u)Z=u[oe],J=l[oe],!u.hasOwnProperty(oe)||Z===J||Z==null&&J==null||ct(s,i,oe,Z,u,J)}var ap=null,ip=null;function Dd(s){return s.nodeType===9?s:s.ownerDocument}function qb(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Bb(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function rp(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var op=null;function zw(){var s=window.event;return s&&s.type==="popstate"?s===op?!1:(op=s,!0):(op=null,!1)}var zb=typeof setTimeout=="function"?setTimeout:void 0,Hw=typeof clearTimeout=="function"?clearTimeout:void 0,Hb=typeof Promise=="function"?Promise:void 0,Gw=typeof queueMicrotask=="function"?queueMicrotask:typeof Hb<"u"?function(s){return Hb.resolve(null).then(s).catch($w)}:zb;function $w(s){setTimeout(function(){throw s})}function ai(s){return s==="head"}function Gb(s,i){var l=i,u=0,f=0;do{var g=l.nextSibling;if(s.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(0<u&&8>u){l=u;var N=s.ownerDocument;if(l&1&&mc(N.documentElement),l&2&&mc(N.body),l&4)for(l=N.head,mc(l),N=l.firstChild;N;){var I=N.nextSibling,B=N.nodeName;N[$i]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&N.rel.toLowerCase()==="stylesheet"||l.removeChild(N),N=I}}if(f===0){s.removeChild(g),Nc(i);return}f--}else l==="$"||l==="$?"||l==="$!"?f++:u=l.charCodeAt(0)-48;else u=0;l=g}while(l);Nc(i)}function lp(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":lp(l),Ua(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function Yw(s,i,l,u){for(;s.nodeType===1;){var f=l;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[$i])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(g=s.getAttribute("rel"),g==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(g!==f.rel||s.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||s.getAttribute("title")!==(f.title==null?null:f.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(g=s.getAttribute("src"),(g!==(f.src==null?null:f.src)||s.getAttribute("type")!==(f.type==null?null:f.type)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&g&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var g=f.name==null?null:""+f.name;if(f.type==="hidden"&&s.getAttribute("name")===g)return s}else return s;if(s=ps(s.nextSibling),s===null)break}return null}function Kw(s,i,l){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=ps(s.nextSibling),s===null))return null;return s}function cp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Qw(s,i){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")i();else{var u=function(){i(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function ps(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var up=null;function $b(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(i===0)return s;i--}else l==="/$"&&i++}s=s.previousSibling}return null}function Yb(s,i,l){switch(i=Dd(l),s){case"html":if(s=i.documentElement,!s)throw Error(a(452));return s;case"head":if(s=i.head,!s)throw Error(a(453));return s;case"body":if(s=i.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function mc(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);Ua(s)}var is=new Map,Kb=new Set;function Md(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var xa=se.d;se.d={f:Xw,r:Ww,D:Zw,C:Jw,L:eC,m:tC,X:sC,S:nC,M:aC};function Xw(){var s=xa.f(),i=Td();return s||i}function Ww(s){var i=ws(s);i!==null&&i.tag===5&&i.type==="form"?m_(i):xa.r(s)}var Ro=typeof document>"u"?null:document;function Qb(s,i,l){var u=Ro;if(u&&typeof i=="string"&&i){var f=Rt(i);f='link[rel="'+s+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),Kb.has(f)||(Kb.add(f),s={rel:s,crossOrigin:l,href:i},u.querySelector(f)===null&&(i=u.createElement("link"),nn(i,"link",s),jt(i),u.head.appendChild(i)))}}function Zw(s){xa.D(s),Qb("dns-prefetch",s,null)}function Jw(s,i){xa.C(s,i),Qb("preconnect",s,i)}function eC(s,i,l){xa.L(s,i,l);var u=Ro;if(u&&s&&i){var f='link[rel="preload"][as="'+Rt(i)+'"]';i==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+Rt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+Rt(l.imageSizes)+'"]')):f+='[href="'+Rt(s)+'"]';var g=f;switch(i){case"style":g=Do(s);break;case"script":g=Mo(s)}is.has(g)||(s=_({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:s,as:i},l),is.set(g,s),u.querySelector(f)!==null||i==="style"&&u.querySelector(pc(g))||i==="script"&&u.querySelector(gc(g))||(i=u.createElement("link"),nn(i,"link",s),jt(i),u.head.appendChild(i)))}}function tC(s,i){xa.m(s,i);var l=Ro;if(l&&s){var u=i&&typeof i.as=="string"?i.as:"script",f='link[rel="modulepreload"][as="'+Rt(u)+'"][href="'+Rt(s)+'"]',g=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Mo(s)}if(!is.has(g)&&(s=_({rel:"modulepreload",href:s},i),is.set(g,s),l.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(gc(g)))return}u=l.createElement("link"),nn(u,"link",s),jt(u),l.head.appendChild(u)}}}function nC(s,i,l){xa.S(s,i,l);var u=Ro;if(u&&s){var f=vn(u).hoistableStyles,g=Do(s);i=i||"default";var N=f.get(g);if(!N){var I={loading:0,preload:null};if(N=u.querySelector(pc(g)))I.loading=5;else{s=_({rel:"stylesheet",href:s,"data-precedence":i},l),(l=is.get(g))&&dp(s,l);var B=N=u.createElement("link");jt(B),nn(B,"link",s),B._p=new Promise(function(X,ae){B.onload=X,B.onerror=ae}),B.addEventListener("load",function(){I.loading|=1}),B.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Od(N,i,u)}N={type:"stylesheet",instance:N,count:1,state:I},f.set(g,N)}}}function sC(s,i){xa.X(s,i);var l=Ro;if(l&&s){var u=vn(l).hoistableScripts,f=Mo(s),g=u.get(f);g||(g=l.querySelector(gc(f)),g||(s=_({src:s,async:!0},i),(i=is.get(f))&&hp(s,i),g=l.createElement("script"),jt(g),nn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(f,g))}}function aC(s,i){xa.M(s,i);var l=Ro;if(l&&s){var u=vn(l).hoistableScripts,f=Mo(s),g=u.get(f);g||(g=l.querySelector(gc(f)),g||(s=_({src:s,async:!0,type:"module"},i),(i=is.get(f))&&hp(s,i),g=l.createElement("script"),jt(g),nn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(f,g))}}function Xb(s,i,l,u){var f=(f=Re.current)?Md(f):null;if(!f)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=Do(l.href),l=vn(f).hoistableStyles,u=l.get(i),u||(u={type:"style",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Do(l.href);var g=vn(f).hoistableStyles,N=g.get(s);if(N||(f=f.ownerDocument||f,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(s,N),(g=f.querySelector(pc(s)))&&!g._p&&(N.instance=g,N.state.loading=5),is.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},is.set(s,l),g||iC(f,s,l,N.state))),i&&u===null)throw Error(a(528,""));return N}if(i&&u!==null)throw Error(a(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Mo(l),l=vn(f).hoistableScripts,u=l.get(i),u||(u={type:"script",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Do(s){return'href="'+Rt(s)+'"'}function pc(s){return'link[rel="stylesheet"]['+s+"]"}function Wb(s){return _({},s,{"data-precedence":s.precedence,precedence:null})}function iC(s,i,l,u){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=s.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),nn(i,"link",l),jt(i),s.head.appendChild(i))}function Mo(s){return'[src="'+Rt(s)+'"]'}function gc(s){return"script[async]"+s}function Zb(s,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var u=s.querySelector('style[data-href~="'+Rt(l.href)+'"]');if(u)return i.instance=u,jt(u),u;var f=_({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),jt(u),nn(u,"style",f),Od(u,l.precedence,s),i.instance=u;case"stylesheet":f=Do(l.href);var g=s.querySelector(pc(f));if(g)return i.state.loading|=4,i.instance=g,jt(g),g;u=Wb(l),(f=is.get(f))&&dp(u,f),g=(s.ownerDocument||s).createElement("link"),jt(g);var N=g;return N._p=new Promise(function(I,B){N.onload=I,N.onerror=B}),nn(g,"link",u),i.state.loading|=4,Od(g,l.precedence,s),i.instance=g;case"script":return g=Mo(l.src),(f=s.querySelector(gc(g)))?(i.instance=f,jt(f),f):(u=l,(f=is.get(g))&&(u=_({},l),hp(u,f)),s=s.ownerDocument||s,f=s.createElement("script"),jt(f),nn(f,"link",u),s.head.appendChild(f),i.instance=f);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,Od(u,l.precedence,s));return i.instance}function Od(s,i,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,g=f,N=0;N<u.length;N++){var I=u[N];if(I.dataset.precedence===i)g=I;else if(g!==f)break}g?g.parentNode.insertBefore(s,g.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(s,i.firstChild))}function dp(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function hp(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var kd=null;function Jb(s,i,l){if(kd===null){var u=new Map,f=kd=new Map;f.set(l,u)}else f=kd,u=f.get(l),u||(u=new Map,f.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),f=0;f<l.length;f++){var g=l[f];if(!(g[$i]||g[Pt]||s==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var N=g.getAttribute(i)||"";N=s+N;var I=u.get(N);I?I.push(g):u.set(N,[g])}}return u}function eE(s,i,l){s=s.ownerDocument||s,s.head.insertBefore(l,i==="title"?s.querySelector("head > title"):null)}function rC(s,i,l){if(l===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function tE(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var vc=null;function oC(){}function lC(s,i,l){if(vc===null)throw Error(a(475));var u=vc;if(i.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var f=Do(l.href),g=s.querySelector(pc(f));if(g){s=g._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(u.count++,u=Pd.bind(u),s.then(u,u)),i.state.loading|=4,i.instance=g,jt(g);return}g=s.ownerDocument||s,l=Wb(l),(f=is.get(f))&&dp(l,f),g=g.createElement("link"),jt(g);var N=g;N._p=new Promise(function(I,B){N.onload=I,N.onerror=B}),nn(g,"link",l),i.instance=g}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(u.count++,i=Pd.bind(u),s.addEventListener("load",i),s.addEventListener("error",i))}}function cC(){if(vc===null)throw Error(a(475));var s=vc;return s.stylesheets&&s.count===0&&fp(s,s.stylesheets),0<s.count?function(i){var l=setTimeout(function(){if(s.stylesheets&&fp(s,s.stylesheets),s.unsuspend){var u=s.unsuspend;s.unsuspend=null,u()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(l)}}:null}function Pd(){if(this.count--,this.count===0){if(this.stylesheets)fp(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Ld=null;function fp(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Ld=new Map,i.forEach(uC,s),Ld=null,Pd.call(s))}function uC(s,i){if(!(i.state.loading&4)){var l=Ld.get(s);if(l)var u=l.get(null);else{l=new Map,Ld.set(s,l);for(var f=s.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<f.length;g++){var N=f[g];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(l.set(N.dataset.precedence,N),u=N)}u&&l.set(null,u)}f=i.instance,N=f.getAttribute("data-precedence"),g=l.get(N)||u,g===u&&l.set(null,f),l.set(N,f),this.count++,u=Pd.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),g?g.parentNode.insertBefore(f,g.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(f,s.firstChild)),i.state.loading|=4}}var yc={$$typeof:V,Provider:null,Consumer:null,_currentValue:he,_currentValue2:he,_threadCount:0};function dC(s,i,l,u,f,g,N,I){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Js(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Js(0),this.hiddenUpdates=Js(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=g,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function nE(s,i,l,u,f,g,N,I,B,X,ae,oe){return s=new dC(s,i,l,N,I,B,X,oe),i=1,g===!0&&(i|=24),g=Pn(3,null,null,i),s.current=g,g.stateNode=s,i=Kf(),i.refCount++,s.pooledCache=i,i.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:i},Zf(g),s}function sE(s){return s?(s=co,s):co}function aE(s,i,l,u,f,g){f=sE(f),u.context===null?u.context=f:u.pendingContext=f,u=Ga(i),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=$a(s,u,i),l!==null&&(qn(l,s,i),Kl(l,s,i))}function iE(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<i?l:i}}function mp(s,i){iE(s,i),(s=s.alternate)&&iE(s,i)}function rE(s){if(s.tag===13){var i=lo(s,67108864);i!==null&&qn(i,s,67108864),mp(s,67108864)}}var Vd=!0;function hC(s,i,l,u){var f=z.T;z.T=null;var g=se.p;try{se.p=2,pp(s,i,l,u)}finally{se.p=g,z.T=f}}function fC(s,i,l,u){var f=z.T;z.T=null;var g=se.p;try{se.p=8,pp(s,i,l,u)}finally{se.p=g,z.T=f}}function pp(s,i,l,u){if(Vd){var f=gp(u);if(f===null)np(s,i,u,Ud,l),lE(s,u);else if(pC(f,s,i,l,u))u.stopPropagation();else if(lE(s,u),i&4&&-1<mC.indexOf(s)){for(;f!==null;){var g=ws(f);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var N=us(g.pendingLanes);if(N!==0){var I=g;for(I.pendingLanes|=2,I.entangledLanes|=2;N;){var B=1<<31-cn(N);I.entanglements[1]|=B,N&=~B}qs(g),(at&6)===0&&(Nd=Yn()+500,dc(0))}}break;case 13:I=lo(g,2),I!==null&&qn(I,g,2),Td(),mp(g,2)}if(g=gp(u),g===null&&np(s,i,u,Ud,l),g===f)break;f=g}f!==null&&u.stopPropagation()}else np(s,i,u,null,l)}}function gp(s){return s=Xn(s),vp(s)}var Ud=null;function vp(s){if(Ud=null,s=ta(s),s!==null){var i=c(s);if(i===null)s=null;else{var l=i.tag;if(l===13){if(s=d(i),s!==null)return s;s=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Ud=s,null}function oE(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(bf()){case gl:return 2;case qr:return 8;case qi:case Ef:return 32;case Br:return 268435456;default:return 32}default:return 32}}var yp=!1,ii=null,ri=null,oi=null,_c=new Map,bc=new Map,li=[],mC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function lE(s,i){switch(s){case"focusin":case"focusout":ii=null;break;case"dragenter":case"dragleave":ri=null;break;case"mouseover":case"mouseout":oi=null;break;case"pointerover":case"pointerout":_c.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":bc.delete(i.pointerId)}}function Ec(s,i,l,u,f,g){return s===null||s.nativeEvent!==g?(s={blockedOn:i,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[f]},i!==null&&(i=ws(i),i!==null&&rE(i)),s):(s.eventSystemFlags|=u,i=s.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),s)}function pC(s,i,l,u,f){switch(i){case"focusin":return ii=Ec(ii,s,i,l,u,f),!0;case"dragenter":return ri=Ec(ri,s,i,l,u,f),!0;case"mouseover":return oi=Ec(oi,s,i,l,u,f),!0;case"pointerover":var g=f.pointerId;return _c.set(g,Ec(_c.get(g)||null,s,i,l,u,f)),!0;case"gotpointercapture":return g=f.pointerId,bc.set(g,Ec(bc.get(g)||null,s,i,l,u,f)),!0}return!1}function cE(s){var i=ta(s.target);if(i!==null){var l=c(i);if(l!==null){if(i=l.tag,i===13){if(i=d(l),i!==null){s.blockedOn=i,Tu(s.priority,function(){if(l.tag===13){var u=Fn();u=Pa(u);var f=lo(l,u);f!==null&&qn(f,l,u),mp(l,u)}});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Fd(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var l=gp(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);ia=u,l.target.dispatchEvent(u),ia=null}else return i=ws(l),i!==null&&rE(i),s.blockedOn=l,!1;i.shift()}return!0}function uE(s,i,l){Fd(s)&&l.delete(i)}function gC(){yp=!1,ii!==null&&Fd(ii)&&(ii=null),ri!==null&&Fd(ri)&&(ri=null),oi!==null&&Fd(oi)&&(oi=null),_c.forEach(uE),bc.forEach(uE)}function qd(s,i){s.blockedOn===i&&(s.blockedOn=null,yp||(yp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,gC)))}var Bd=null;function dE(s){Bd!==s&&(Bd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Bd===s&&(Bd=null);for(var i=0;i<s.length;i+=3){var l=s[i],u=s[i+1],f=s[i+2];if(typeof u!="function"){if(vp(u||l)===null)continue;break}var g=ws(l);g!==null&&(s.splice(i,3),i-=3,vm(g,{pending:!0,data:f,method:l.method,action:u},u,f))}}))}function Nc(s){function i(B){return qd(B,s)}ii!==null&&qd(ii,s),ri!==null&&qd(ri,s),oi!==null&&qd(oi,s),_c.forEach(i),bc.forEach(i);for(var l=0;l<li.length;l++){var u=li[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<li.length&&(l=li[0],l.blockedOn===null);)cE(l),l.blockedOn===null&&li.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var f=l[u],g=l[u+1],N=f[It]||null;if(typeof g=="function")N||dE(l);else if(N){var I=null;if(g&&g.hasAttribute("formAction")){if(f=g,N=g[It]||null)I=N.formAction;else if(vp(f)!==null)continue}else I=N.action;typeof I=="function"?l[u+1]=I:(l.splice(u,3),u-=3),dE(l)}}}function _p(s){this._internalRoot=s}zd.prototype.render=_p.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(a(409));var l=i.current,u=Fn();aE(l,u,s,i,null,null)},zd.prototype.unmount=_p.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;aE(s.current,2,null,s,null,null),Td(),i[Kn]=null}};function zd(s){this._internalRoot=s}zd.prototype.unstable_scheduleHydration=function(s){if(s){var i=La();s={blockedOn:null,target:s,priority:i};for(var l=0;l<li.length&&i!==0&&i<li[l].priority;l++);li.splice(l,0,s),l===0&&cE(s)}};var hE=e.version;if(hE!=="19.1.0")throw Error(a(527,hE,"19.1.0"));se.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=p(i),s=s!==null?v(s):null,s=s===null?null:s.stateNode,s};var vC={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hd.isDisabled&&Hd.supportsFiber)try{xt=Hd.inject(vC),st=Hd}catch{}}return Tc.createRoot=function(s,i){if(!o(s))throw Error(a(299));var l=!1,u="",f=C_,g=S_,N=I_,I=null;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(f=i.onUncaughtError),i.onCaughtError!==void 0&&(g=i.onCaughtError),i.onRecoverableError!==void 0&&(N=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(I=i.unstable_transitionCallbacks)),i=nE(s,1,!1,null,null,l,u,f,g,N,I,null),s[Kn]=i.current,tp(s),new _p(i)},Tc.hydrateRoot=function(s,i,l){if(!o(s))throw Error(a(299));var u=!1,f="",g=C_,N=S_,I=I_,B=null,X=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(N=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(B=l.unstable_transitionCallbacks),l.formState!==void 0&&(X=l.formState)),i=nE(s,1,!0,i,l??null,u,f,g,N,I,B,X),i.context=sE(null),l=i.current,u=Fn(),u=Pa(u),f=Ga(u),f.callback=null,$a(l,f,u),l=u,i.current.lanes=l,ea(i,l),qs(i),s[Kn]=i.current,tp(s),new zd(i)},Tc.version="19.1.0",Tc}var NE;function wC(){if(NE)return Np.exports;NE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Np.exports=jC(),Np.exports}var CC=wC();const SC=()=>{};var xE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx=function(n){const e=[];let t=0;for(let a=0;a<n.length;a++){let o=n.charCodeAt(a);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&a+1<n.length&&(n.charCodeAt(a+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++a)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},IC=function(n){const e=[];let t=0,a=0;for(;t<n.length;){const o=n[t++];if(o<128)e[a++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[a++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],m=n[t++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|m&63)-65536;e[a++]=String.fromCharCode(55296+(p>>10)),e[a++]=String.fromCharCode(56320+(p&1023))}else{const c=n[t++],d=n[t++];e[a++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},Bx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,m=d?n[o+1]:0,p=o+2<n.length,v=p?n[o+2]:0,_=c>>2,b=(c&3)<<4|m>>4;let A=(m&15)<<2|v>>6,j=v&63;p||(j=64,d||(A=64)),a.push(t[_],t[b],t[A],t[j])}return a.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(qx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):IC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],m=o<n.length?t[n.charAt(o)]:0;++o;const v=o<n.length?t[n.charAt(o)]:64;++o;const b=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||m==null||v==null||b==null)throw new RC;const A=c<<2|m>>4;if(a.push(A),v!==64){const j=m<<4&240|v>>2;if(a.push(j),b!==64){const T=v<<6&192|b;a.push(T)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class RC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const DC=function(n){const e=qx(n);return Bx.encodeByteArray(e,!0)},hh=function(n){return DC(n).replace(/\./g,"")},zx=function(n){try{return Bx.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC=()=>MC().__FIREBASE_DEFAULTS__,kC=()=>{if(typeof process>"u"||typeof xE>"u")return;const n=xE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},PC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&zx(n[1]);return e&&JSON.parse(e)},Uh=()=>{try{return SC()||OC()||kC()||PC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Hx=n=>{var e,t;return(t=(e=Uh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Gx=n=>{const e=Hx(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},$x=()=>{var n;return(n=Uh())===null||n===void 0?void 0:n.config},Yx=n=>{var e;return(e=Uh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(n){return n.endsWith(".cloudworkstations.dev")}async function wg(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${a}`,aud:a,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},n);return[hh(JSON.stringify(t)),hh(JSON.stringify(d)),""].join(".")}const Rc={};function VC(){const n={prod:[],emulator:[]};for(const e of Object.keys(Rc))Rc[e]?n.emulator.push(e):n.prod.push(e);return n}function UC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let TE=!1;function Cg(n,e){if(typeof window>"u"||typeof document>"u"||!kr(window.location.host)||Rc[n]===e||Rc[n]||TE)return;Rc[n]=e;function t(A){return`__firebase__banner__${A}`}const a="__firebase__banner",c=VC().prod.length>0;function d(){const A=document.getElementById(a);A&&A.remove()}function m(A){A.style.display="flex",A.style.background="#7faaf0",A.style.position="fixed",A.style.bottom="5px",A.style.left="5px",A.style.padding=".5em",A.style.borderRadius="5px",A.style.alignItems="center"}function p(A,j){A.setAttribute("width","24"),A.setAttribute("id",j),A.setAttribute("height","24"),A.setAttribute("viewBox","0 0 24 24"),A.setAttribute("fill","none"),A.style.marginLeft="-6px"}function v(){const A=document.createElement("span");return A.style.cursor="pointer",A.style.marginLeft="16px",A.style.fontSize="24px",A.innerHTML=" &times;",A.onclick=()=>{TE=!0,d()},A}function _(A,j){A.setAttribute("id",j),A.innerText="Learn more",A.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",A.setAttribute("target","__blank"),A.style.paddingLeft="5px",A.style.textDecoration="underline"}function b(){const A=UC(a),j=t("text"),T=document.getElementById(j)||document.createElement("span"),S=t("learnmore"),x=document.getElementById(S)||document.createElement("a"),F=t("preprendIcon"),Y=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(A.created){const V=A.element;m(V),_(x,S);const O=v();p(Y,F),V.append(Y,T,x,O),document.body.appendChild(V)}c?(T.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",j)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function FC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gn())}function qC(){var n;const e=(n=Uh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Sg(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function zC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function HC(){const n=gn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function GC(){return!qC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fh(){try{return typeof indexedDB=="object"}catch{return!1}}function qh(){return new Promise((n,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(a);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(a),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}function Ig(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C="FirebaseError";class cs extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=$C,Object.setPrototypeOf(this,cs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ri.prototype.create)}}class Ri{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?YC(c,a):"Error",m=`${this.serviceName}: ${d} (${o}).`;return new cs(o,m,a)}}function YC(n,e){return n.replace(KC,(t,a)=>{const o=e[a];return o!=null?String(o):`<${a}?>`})}const KC=/\{\$([^}]+)}/g;function QC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ei(n,e){if(n===e)return!0;const t=Object.keys(n),a=Object.keys(e);for(const o of t){if(!a.includes(o))return!1;const c=n[o],d=e[o];if(AE(c)&&AE(d)){if(!Ei(c,d))return!1}else if(c!==d)return!1}for(const o of a)if(!t.includes(o))return!1;return!0}function AE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(n){const e=[];for(const[t,a]of Object.entries(n))Array.isArray(a)?a.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function Ac(n){const e={};return n.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[o,c]=a.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function jc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function XC(n,e){const t=new WC(n,e);return t.subscribe.bind(t)}class WC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let o;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");ZC(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:a},o.next===void 0&&(o.next=jp),o.error===void 0&&(o.error=jp),o.complete===void 0&&(o.complete=jp);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ZC(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function jp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC=1e3,eS=2,tS=4*60*60*1e3,nS=.5;function jE(n,e=JC,t=eS){const a=e*Math.pow(t,n),o=Math.round(nS*a*(Math.random()-.5)*2);return Math.min(tS,a+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(n){return n&&n._delegate?n._delegate:n}class $n{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new LC;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&a.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const a=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(a)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:a})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(iS(e))try{this.getOrInitializeService({instanceIdentifier:Nr})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});a.resolve(c)}catch{}}}}clearInstance(e=Nr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Nr){return this.instances.has(e)}getOptions(e=Nr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[c,d]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(c);a===m&&d.resolve(o)}return o}onInit(e,t){var a;const o=this.normalizeInstanceIdentifier(t),c=(a=this.onInitCallbacks.get(o))!==null&&a!==void 0?a:new Set;c.add(e),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&e(d,o),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const o of a)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:aS(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=Nr){return this.component?this.component.multipleInstances?e:Nr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aS(n){return n===Nr?void 0:n}function iS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new sS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})($e||($e={}));const oS={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},lS=$e.INFO,cS={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},uS=(n,e,...t)=>{if(e<n.logLevel)return;const a=new Date().toISOString(),o=cS[e];if(o)console[o](`[${a}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class su{constructor(e){this.name=e,this._logLevel=lS,this._logHandler=uS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?oS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const dS=(n,e)=>e.some(t=>n instanceof t);let wE,CE;function hS(){return wE||(wE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fS(){return CE||(CE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Qx=new WeakMap,Kp=new WeakMap,Xx=new WeakMap,wp=new WeakMap,Rg=new WeakMap;function mS(n){const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(vi(n.result)),o()},d=()=>{a(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&Qx.set(t,n)}).catch(()=>{}),Rg.set(e,n),e}function pS(n){if(Kp.has(n))return;const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{a(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});Kp.set(n,e)}let Qp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Kp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Xx.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return vi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function gS(n){Qp=n(Qp)}function vS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=n.call(Cp(this),e,...t);return Xx.set(a,e.sort?e.sort():[e]),vi(a)}:fS().includes(n)?function(...e){return n.apply(Cp(this),e),vi(Qx.get(this))}:function(...e){return vi(n.apply(Cp(this),e))}}function yS(n){return typeof n=="function"?vS(n):(n instanceof IDBTransaction&&pS(n),dS(n,hS())?new Proxy(n,Qp):n)}function vi(n){if(n instanceof IDBRequest)return mS(n);if(wp.has(n))return wp.get(n);const e=yS(n);return e!==n&&(wp.set(n,e),Rg.set(e,n)),e}const Cp=n=>Rg.get(n);function Wx(n,e,{blocked:t,upgrade:a,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),m=vi(d);return a&&d.addEventListener("upgradeneeded",p=>{a(vi(d.result),p.oldVersion,p.newVersion,vi(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),m.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",v=>o(v.oldVersion,v.newVersion,v))}).catch(()=>{}),m}const _S=["get","getKey","getAll","getAllKeys","count"],bS=["put","add","delete","clear"],Sp=new Map;function SE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Sp.get(e))return Sp.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,o=bS.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(o||_S.includes(t)))return;const c=async function(d,...m){const p=this.transaction(d,o?"readwrite":"readonly");let v=p.store;return a&&(v=v.index(m.shift())),(await Promise.all([v[t](...m),o&&p.done]))[0]};return Sp.set(e,c),c}gS(n=>({...n,get:(e,t,a)=>SE(e,t)||n.get(e,t,a),has:(e,t)=>!!SE(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(NS(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function NS(n){const e=n.getComponent();return e?.type==="VERSION"}const Xp="@firebase/app",IE="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sa=new su("@firebase/app"),xS="@firebase/app-compat",TS="@firebase/analytics-compat",AS="@firebase/analytics",jS="@firebase/app-check-compat",wS="@firebase/app-check",CS="@firebase/auth",SS="@firebase/auth-compat",IS="@firebase/database",RS="@firebase/data-connect",DS="@firebase/database-compat",MS="@firebase/functions",OS="@firebase/functions-compat",kS="@firebase/installations",PS="@firebase/installations-compat",LS="@firebase/messaging",VS="@firebase/messaging-compat",US="@firebase/performance",FS="@firebase/performance-compat",qS="@firebase/remote-config",BS="@firebase/remote-config-compat",zS="@firebase/storage",HS="@firebase/storage-compat",GS="@firebase/firestore",$S="@firebase/ai",YS="@firebase/firestore-compat",KS="firebase",QS="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp="[DEFAULT]",XS={[Xp]:"fire-core",[xS]:"fire-core-compat",[AS]:"fire-analytics",[TS]:"fire-analytics-compat",[wS]:"fire-app-check",[jS]:"fire-app-check-compat",[CS]:"fire-auth",[SS]:"fire-auth-compat",[IS]:"fire-rtdb",[RS]:"fire-data-connect",[DS]:"fire-rtdb-compat",[MS]:"fire-fn",[OS]:"fire-fn-compat",[kS]:"fire-iid",[PS]:"fire-iid-compat",[LS]:"fire-fcm",[VS]:"fire-fcm-compat",[US]:"fire-perf",[FS]:"fire-perf-compat",[qS]:"fire-rc",[BS]:"fire-rc-compat",[zS]:"fire-gcs",[HS]:"fire-gcs-compat",[GS]:"fire-fst",[YS]:"fire-fst-compat",[$S]:"fire-vertex","fire-js":"fire-js",[KS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fh=new Map,WS=new Map,Zp=new Map;function RE(n,e){try{n.container.addComponent(e)}catch(t){Sa.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function os(n){const e=n.name;if(Zp.has(e))return Sa.debug(`There were multiple attempts to register component ${e}.`),!1;Zp.set(e,n);for(const t of fh.values())RE(t,n);for(const t of WS.values())RE(t,n);return!0}function Ma(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Rn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yi=new Ri("app","Firebase",ZS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e,t,a){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pr=QS;function Zx(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const a=Object.assign({name:Wp,automaticDataCollectionEnabled:!0},e),o=a.name;if(typeof o!="string"||!o)throw yi.create("bad-app-name",{appName:String(o)});if(t||(t=$x()),!t)throw yi.create("no-options");const c=fh.get(o);if(c){if(Ei(t,c.options)&&Ei(a,c.config))return c;throw yi.create("duplicate-app",{appName:o})}const d=new rS(o);for(const p of Zp.values())d.addComponent(p);const m=new JS(t,a,d);return fh.set(o,m),m}function au(n=Wp){const e=fh.get(n);if(!e&&n===Wp&&$x())return Zx();if(!e)throw yi.create("no-app",{appName:n});return e}function pn(n,e,t){var a;let o=(a=XS[n])!==null&&a!==void 0?a:n;t&&(o+=`-${t}`);const c=o.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const m=[`Unable to register library "${o}" with version "${e}":`];c&&m.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&m.push("and"),d&&m.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Sa.warn(m.join(" "));return}os(new $n(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI="firebase-heartbeat-database",tI=1,zc="firebase-heartbeat-store";let Ip=null;function Jx(){return Ip||(Ip=Wx(eI,tI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(zc)}catch(t){console.warn(t)}}}}).catch(n=>{throw yi.create("idb-open",{originalErrorMessage:n.message})})),Ip}async function nI(n){try{const t=(await Jx()).transaction(zc),a=await t.objectStore(zc).get(eT(n));return await t.done,a}catch(e){if(e instanceof cs)Sa.warn(e.message);else{const t=yi.create("idb-get",{originalErrorMessage:e?.message});Sa.warn(t.message)}}}async function DE(n,e){try{const a=(await Jx()).transaction(zc,"readwrite");await a.objectStore(zc).put(e,eT(n)),await a.done}catch(t){if(t instanceof cs)Sa.warn(t.message);else{const a=yi.create("idb-set",{originalErrorMessage:t?.message});Sa.warn(a.message)}}}function eT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI=1024,aI=30;class iI{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new oI(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=ME();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>aI){const d=lI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){Sa.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ME(),{heartbeatsToSend:a,unsentEntries:o}=rI(this._heartbeatsCache.heartbeats),c=hh(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Sa.warn(t),""}}}function ME(){return new Date().toISOString().substring(0,10)}function rI(n,e=sI){const t=[];let a=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),OE(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),OE(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class oI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fh()?qh().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await nI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return DE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return DE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function OE(n){return hh(JSON.stringify({version:2,heartbeats:n})).length}function lI(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let a=1;a<n.length;a++)n[a].date<t&&(t=n[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(n){os(new $n("platform-logger",e=>new ES(e),"PRIVATE")),os(new $n("heartbeat",e=>new iI(e),"PRIVATE")),pn(Xp,IE,n),pn(Xp,IE,"esm2017"),pn("fire-js","")}cI("");function Dg(n,e){var t={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&e.indexOf(a)<0&&(t[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(n);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(n,a[o])&&(t[a[o]]=n[a[o]]);return t}function tT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const uI=tT,nT=new Ri("auth","Firebase",tT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh=new su("@firebase/auth");function dI(n,...e){mh.logLevel<=$e.WARN&&mh.warn(`Auth (${Pr}): ${n}`,...e)}function eh(n,...e){mh.logLevel<=$e.ERROR&&mh.error(`Auth (${Pr}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(n,...e){throw Og(n,...e)}function Es(n,...e){return Og(n,...e)}function Mg(n,e,t){const a=Object.assign(Object.assign({},uI()),{[e]:t});return new Ri("auth","Firebase",a).create(e,{appName:n.name})}function Ca(n){return Mg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hI(n,e,t){const a=t;if(!(e instanceof a))throw a.name!==e.constructor.name&&ls(n,"argument-error"),Mg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Og(n,...e){if(typeof n!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=n.name),n._errorFactory.create(t,...a)}return nT.create(n,...e)}function Se(n,e,...t){if(!n)throw Og(e,...t)}function ja(n){const e="INTERNAL ASSERTION FAILED: "+n;throw eh(e),new Error(e)}function Ia(n,e){n||ja(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jp(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function fI(){return kE()==="http:"||kE()==="https:"}function kE(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fI()||Sg()||"connection"in navigator)?navigator.onLine:!0}function pI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ia(t>e,"Short delay should be less than long delay!"),this.isMobile=FC()||zC()}get(){return mI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kg(n,e){Ia(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ja("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ja("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ja("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],yI=new iu(3e4,6e4);function Di(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Mi(n,e,t,a,o={}){return aT(n,o,async()=>{let c={},d={};a&&(e==="GET"?d=a:c={body:JSON.stringify(a)});const m=nu(Object.assign({key:n.config.apiKey},d)).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:p},c);return BC()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&kr(n.emulatorConfig.host)&&(v.credentials="include"),sT.fetch()(await iT(n,n.config.apiHost,t,m),v)})}async function aT(n,e,t){n._canInitEmulator=!1;const a=Object.assign(Object.assign({},gI),e);try{const o=new bI(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw Gd(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const m=c.ok?d.errorMessage:d.error.message,[p,v]=m.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gd(n,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw Gd(n,"email-already-in-use",d);if(p==="USER_DISABLED")throw Gd(n,"user-disabled",d);const _=a[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw Mg(n,_,v);ls(n,_)}}catch(o){if(o instanceof cs)throw o;ls(n,"network-request-failed",{message:String(o)})}}async function ru(n,e,t,a,o={}){const c=await Mi(n,e,t,a,o);return"mfaPendingCredential"in c&&ls(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function iT(n,e,t,a){const o=`${e}${t}?${a}`,c=n,d=c.config.emulator?kg(n.config,o):`${n.config.apiScheme}://${o}`;return vI.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function _I(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class bI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(Es(this.auth,"network-request-failed")),yI.get())})}}function Gd(n,e,t){const a={appName:n.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const o=Es(n,e,a);return o.customData._tokenResponse=t,o}function PE(n){return n!==void 0&&n.enterprise!==void 0}class EI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return _I(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function NI(n,e){return Mi(n,"GET","/v2/recaptchaConfig",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xI(n,e){return Mi(n,"POST","/v1/accounts:delete",e)}async function ph(n,e){return Mi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function TI(n,e=!1){const t=vt(n),a=await t.getIdToken(e),o=Pg(a);Se(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:a,authTime:Dc(Rp(o.auth_time)),issuedAtTime:Dc(Rp(o.iat)),expirationTime:Dc(Rp(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Rp(n){return Number(n)*1e3}function Pg(n){const[e,t,a]=n.split(".");if(e===void 0||t===void 0||a===void 0)return eh("JWT malformed, contained fewer than 3 sections"),null;try{const o=zx(t);return o?JSON.parse(o):(eh("Failed to decode base64 JWT payload"),null)}catch(o){return eh("Caught error parsing JWT payload as JSON",o?.toString()),null}}function LE(n){const e=Pg(n);return Se(e,"internal-error"),Se(typeof e.exp<"u","internal-error"),Se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hc(n,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof cs&&AI(a)&&n.auth.currentUser===n&&await n.auth.signOut(),a}}function AI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const a=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),a}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Dc(this.lastLoginAt),this.creationTime=Dc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gh(n){var e;const t=n.auth,a=await n.getIdToken(),o=await Hc(n,ph(t,{idToken:a}));Se(o?.users.length,t,"internal-error");const c=o.users[0];n._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?rT(c.providerUserInfo):[],m=CI(n.providerData,d),p=n.isAnonymous,v=!(n.email&&c.passwordHash)&&!m?.length,_=p?v:!1,b={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:m,metadata:new eg(c.createdAt,c.lastLoginAt),isAnonymous:_};Object.assign(n,b)}async function wI(n){const e=vt(n);await gh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function CI(n,e){return[...n.filter(a=>!e.some(o=>o.providerId===a.providerId)),...e]}function rT(n){return n.map(e=>{var{providerId:t}=e,a=Dg(e,["providerId"]);return{providerId:t,uid:a.rawId||"",displayName:a.displayName||null,email:a.email||null,phoneNumber:a.phoneNumber||null,photoURL:a.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SI(n,e){const t=await aT(n,{},async()=>{const a=nu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await iT(n,o,"/v1/token",`key=${c}`),m=await n._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:m,body:a};return n.emulatorConfig&&kr(n.emulatorConfig.host)&&(p.credentials="include"),sT.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function II(n,e){return Mi(n,"POST","/v2/accounts:revokeToken",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Se(e.idToken,"internal-error"),Se(typeof e.idToken<"u","internal-error"),Se(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):LE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Se(e.length!==0,"internal-error");const t=LE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:o,expiresIn:c}=await SI(e,t);this.updateTokensAndExpiration(a,o,Number(c))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:o,expirationTime:c}=t,d=new Ho;return a&&(Se(typeof a=="string","internal-error",{appName:e}),d.refreshToken=a),o&&(Se(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(Se(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ho,this.toJSON())}_performRefresh(){return ja("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(n,e){Se(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class _s{constructor(e){var{uid:t,auth:a,stsTokenManager:o}=e,c=Dg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new jI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=a,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new eg(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await Hc(this,this.stsTokenManager.getToken(this.auth,e));return Se(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return TI(this,e)}reload(){return wI(this)}_assign(e){this!==e&&(Se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _s(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await gh(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Rn(this.auth.app))return Promise.reject(Ca(this.auth));const e=await this.getIdToken();return await Hc(this,xI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var a,o,c,d,m,p,v,_;const b=(a=t.displayName)!==null&&a!==void 0?a:void 0,A=(o=t.email)!==null&&o!==void 0?o:void 0,j=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,T=(d=t.photoURL)!==null&&d!==void 0?d:void 0,S=(m=t.tenantId)!==null&&m!==void 0?m:void 0,x=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,F=(v=t.createdAt)!==null&&v!==void 0?v:void 0,Y=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:V,emailVerified:O,isAnonymous:U,providerData:W,stsTokenManager:L}=t;Se(V&&L,e,"internal-error");const D=Ho.fromJSON(this.name,L);Se(typeof V=="string",e,"internal-error"),ui(b,e.name),ui(A,e.name),Se(typeof O=="boolean",e,"internal-error"),Se(typeof U=="boolean",e,"internal-error"),ui(j,e.name),ui(T,e.name),ui(S,e.name),ui(x,e.name),ui(F,e.name),ui(Y,e.name);const k=new _s({uid:V,auth:e,email:A,emailVerified:O,displayName:b,isAnonymous:U,photoURL:T,phoneNumber:j,tenantId:S,stsTokenManager:D,createdAt:F,lastLoginAt:Y});return W&&Array.isArray(W)&&(k.providerData=W.map(w=>Object.assign({},w))),x&&(k._redirectEventId=x),k}static async _fromIdTokenResponse(e,t,a=!1){const o=new Ho;o.updateFromServerResponse(t);const c=new _s({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:a});return await gh(c),c}static async _fromGetAccountInfoResponse(e,t,a){const o=t.users[0];Se(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?rT(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,m=new Ho;m.updateFromIdToken(a);const p=new _s({uid:o.localId,auth:e,stsTokenManager:m,isAnonymous:d}),v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new eg(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,v),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VE=new Map;function wa(n){Ia(n instanceof Function,"Expected a class definition");let e=VE.get(n);return e?(Ia(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,VE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}oT.type="NONE";const UE=oT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(n,e,t){return`firebase:${n}:${e}:${t}`}class Go{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:o,name:c}=this.auth;this.fullUserKey=th(this.userKey,o.apiKey,c),this.fullPersistenceKey=th("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ph(this.auth,{idToken:e}).catch(()=>{});return t?_s._fromGetAccountInfoResponse(this.auth,t,e):null}return _s._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new Go(wa(UE),e,a);const o=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let c=o[0]||wa(UE);const d=th(a,e.config.apiKey,e.name);let m=null;for(const v of t)try{const _=await v._get(d);if(_){let b;if(typeof _=="string"){const A=await ph(e,{idToken:_}).catch(()=>{});if(!A)break;b=await _s._fromGetAccountInfoResponse(e,A,_)}else b=_s._fromJSON(e,_);v!==c&&(m=b),c=v;break}}catch{}const p=o.filter(v=>v._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new Go(c,e,a):(c=p[0],m&&await c._set(d,m.toJSON()),await Promise.all(t.map(async v=>{if(v!==c)try{await v._remove(d)}catch{}})),new Go(c,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(fT(e))return"Blackberry";if(mT(e))return"Webos";if(cT(e))return"Safari";if((e.includes("chrome/")||uT(e))&&!e.includes("edge/"))return"Chrome";if(hT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=n.match(t);if(a?.length===2)return a[1]}return"Other"}function lT(n=gn()){return/firefox\//i.test(n)}function cT(n=gn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function uT(n=gn()){return/crios\//i.test(n)}function dT(n=gn()){return/iemobile/i.test(n)}function hT(n=gn()){return/android/i.test(n)}function fT(n=gn()){return/blackberry/i.test(n)}function mT(n=gn()){return/webos/i.test(n)}function Lg(n=gn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function RI(n=gn()){var e;return Lg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function DI(){return HC()&&document.documentMode===10}function pT(n=gn()){return Lg(n)||hT(n)||mT(n)||fT(n)||/windows phone/i.test(n)||dT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gT(n,e=[]){let t;switch(n){case"Browser":t=FE(gn());break;case"Worker":t=`${FE(gn())}-${n}`;break;default:t=n}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Pr}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=c=>new Promise((d,m)=>{try{const p=e(c);d(p)}catch(p){m(p)}});a.onAbort=t,this.queue.push(a);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OI(n,e={}){return Mi(n,"GET","/v2/passwordPolicy",Di(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI=6;class PI{constructor(e){var t,a,o,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:kI,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(a=e.allowedNonAlphanumericCharacters)===null||a===void 0?void 0:a.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,a,o,c,d,m;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(a=p.meetsMaxPasswordLength)!==null&&a!==void 0?a:!0),p.isValid&&(p.isValid=(o=p.containsLowercaseLetter)!==null&&o!==void 0?o:!0),p.isValid&&(p.isValid=(c=p.containsUppercaseLetter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(d=p.containsNumericCharacter)!==null&&d!==void 0?d:!0),p.isValid&&(p.isValid=(m=p.containsNonAlphanumericCharacter)!==null&&m!==void 0?m:!0),p}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let o=0;o<e.length;o++)a=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e,t,a,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qE(this),this.idTokenSubscription=new qE(this),this.beforeStateQueue=new MI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=wa(t)),this._initializationPromise=this.queue(async()=>{var a,o,c;if(!this._deleted&&(this.persistenceManager=await Go.create(this,e),(a=this._resolvePersistenceManagerAvailable)===null||a===void 0||a.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ph(this,{idToken:e}),a=await _s._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Rn(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(m=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(m,m))}):this.directlySetCurrentUser(null)}const a=await this.assertedPersistence.getCurrentUser();let o=a,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,m=o?._redirectEventId,p=await this.tryRedirectSignIn(e);(!d||d===m)&&p?.user&&(o=p.user,c=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(o)}catch(d){o=a,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return Se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await gh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=pI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Rn(this.app))return Promise.reject(Ca(this));const t=e?vt(e):null;return t&&Se(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Rn(this.app)?Promise.reject(Ca(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Rn(this.app)?Promise.reject(Ca(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(wa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await OI(this),t=new PI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ri("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await II(this,a)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&wa(e)||this._popupRedirectResolver;Se(t,this,"argument-error"),this.redirectPersistenceManager=await Go.create(this,[wa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,a;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((a=this.redirectUser)===null||a===void 0?void 0:a._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const a=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==a&&(this.lastNotifiedUid=a,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(Se(m,this,"internal-error"),m.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,a,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=gT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const a=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());a&&(t["X-Firebase-Client"]=a);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(Rn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&dI(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Oi(n){return vt(n)}class qE{constructor(e){this.auth=e,this.observer=null,this.addObserver=XC(t=>this.observer=t)}get next(){return Se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function VI(n){Bh=n}function vT(n){return Bh.loadJS(n)}function UI(){return Bh.recaptchaEnterpriseScript}function FI(){return Bh.gapiScript}function qI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class BI{constructor(){this.enterprise=new zI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class zI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const HI="recaptcha-enterprise",yT="NO_RECAPTCHA";class GI{constructor(e){this.type=HI,this.auth=Oi(e)}async verify(e="verify",t=!1){async function a(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,m)=>{NI(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)m(new Error("recaptcha Enterprise site key undefined"));else{const v=new EI(p);return c.tenantId==null?c._agentRecaptchaConfig=v:c._tenantRecaptchaConfigs[c.tenantId]=v,d(v.siteKey)}}).catch(p=>{m(p)})})}function o(c,d,m){const p=window.grecaptcha;PE(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(v=>{d(v)}).catch(()=>{d(yT)})}):m(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new BI().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{a(this.auth).then(m=>{if(!t&&PE(window.grecaptcha))o(m,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=UI();p.length!==0&&(p+=m),vT(p).then(()=>{o(m,c,d)}).catch(v=>{d(v)})}}).catch(m=>{d(m)})})}}async function BE(n,e,t,a=!1,o=!1){const c=new GI(n);let d;if(o)d=yT;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const m=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in m){const p=m.phoneEnrollmentInfo.phoneNumber,v=m.phoneEnrollmentInfo.recaptchaToken;Object.assign(m,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in m){const p=m.phoneSignInInfo.recaptchaToken;Object.assign(m,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return m}return a?Object.assign(m,{captchaResp:d}):Object.assign(m,{captchaResponse:d}),Object.assign(m,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(m,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),m}async function tg(n,e,t,a,o){var c;if(!((c=n._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await BE(n,e,t,t==="getOobCode");return a(n,d)}else return a(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const m=await BE(n,e,t,t==="getOobCode");return a(n,m)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $I(n,e){const t=Ma(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Ei(c,e??{}))return o;ls(o,"already-initialized")}return t.initialize({options:e})}function YI(n,e){const t=e?.persistence||[],a=(Array.isArray(t)?t:[t]).map(wa);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(a,e?.popupRedirectResolver)}function KI(n,e,t){const a=Oi(n);Se(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const o=!1,c=_T(e),{host:d,port:m}=QI(e),p=m===null?"":`:${m}`,v={url:`${c}//${d}${p}/`},_=Object.freeze({host:d,port:m,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!a._canInitEmulator){Se(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),Se(Ei(v,a.config.emulator)&&Ei(_,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=v,a.emulatorConfig=_,a.settings.appVerificationDisabledForTesting=!0,kr(d)?(wg(`${c}//${d}${p}`),Cg("Auth",!0)):XI()}function _T(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function QI(n){const e=_T(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(a);if(o){const c=o[1];return{host:c,port:zE(a.substr(c.length+1))}}else{const[c,d]=a.split(":");return{host:c,port:zE(d)}}}function zE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function XI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ja("not implemented")}_getIdTokenResponse(e){return ja("not implemented")}_linkToIdToken(e,t){return ja("not implemented")}_getReauthenticationResolver(e){return ja("not implemented")}}async function WI(n,e){return Mi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZI(n,e){return ru(n,"POST","/v1/accounts:signInWithPassword",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JI(n,e){return ru(n,"POST","/v1/accounts:signInWithEmailLink",Di(n,e))}async function eR(n,e){return ru(n,"POST","/v1/accounts:signInWithEmailLink",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc extends Vg{constructor(e,t,a,o=null){super("password",a),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Gc(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new Gc(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tg(e,t,"signInWithPassword",ZI);case"emailLink":return JI(e,{email:this._email,oobCode:this._password});default:ls(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tg(e,a,"signUpPassword",WI);case"emailLink":return eR(e,{idToken:t,email:this._email,oobCode:this._password});default:ls(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $o(n,e){return ru(n,"POST","/v1/accounts:signInWithIdp",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR="http://localhost";class Cr extends Vg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Cr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ls("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:o}=t,c=Dg(t,["providerId","signInMethod"]);if(!a||!o)return null;const d=new Cr(a,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return $o(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,$o(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$o(e,t)}buildRequest(){const e={requestUri:tR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=nu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nR(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function sR(n){const e=Ac(jc(n)).link,t=e?Ac(jc(e)).deep_link_id:null,a=Ac(jc(n)).deep_link_id;return(a?Ac(jc(a)).link:null)||a||t||e||n}class Ug{constructor(e){var t,a,o,c,d,m;const p=Ac(jc(e)),v=(t=p.apiKey)!==null&&t!==void 0?t:null,_=(a=p.oobCode)!==null&&a!==void 0?a:null,b=nR((o=p.mode)!==null&&o!==void 0?o:null);Se(v&&_&&b,"argument-error"),this.apiKey=v,this.operation=b,this.code=_,this.continueUrl=(c=p.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=p.lang)!==null&&d!==void 0?d:null,this.tenantId=(m=p.tenantId)!==null&&m!==void 0?m:null}static parseLink(e){const t=sR(e);try{return new Ug(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(){this.providerId=rl.PROVIDER_ID}static credential(e,t){return Gc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=Ug.parseLink(t);return Se(a,"argument-error"),Gc._fromEmailAndCode(e,a.code,a.tenantId)}}rl.PROVIDER_ID="password";rl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou extends Fg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi extends ou{constructor(){super("facebook.com")}static credential(e){return Cr._fromParams({providerId:hi.PROVIDER_ID,signInMethod:hi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hi.credentialFromTaggedObject(e)}static credentialFromError(e){return hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hi.credential(e.oauthAccessToken)}catch{return null}}}hi.FACEBOOK_SIGN_IN_METHOD="facebook.com";hi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa extends ou{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Cr._fromParams({providerId:Aa.PROVIDER_ID,signInMethod:Aa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Aa.credentialFromTaggedObject(e)}static credentialFromError(e){return Aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return Aa.credential(t,a)}catch{return null}}}Aa.GOOGLE_SIGN_IN_METHOD="google.com";Aa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi extends ou{constructor(){super("github.com")}static credential(e){return Cr._fromParams({providerId:fi.PROVIDER_ID,signInMethod:fi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fi.credentialFromTaggedObject(e)}static credentialFromError(e){return fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fi.credential(e.oauthAccessToken)}catch{return null}}}fi.GITHUB_SIGN_IN_METHOD="github.com";fi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends ou{constructor(){super("twitter.com")}static credential(e,t){return Cr._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return mi.credential(t,a)}catch{return null}}}mi.TWITTER_SIGN_IN_METHOD="twitter.com";mi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aR(n,e){return ru(n,"POST","/v1/accounts:signUp",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,o=!1){const c=await _s._fromIdTokenResponse(e,a,o),d=HE(a);return new Sr({user:c,providerId:d,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const o=HE(a);return new Sr({user:e,providerId:o,_tokenResponse:a,operationType:t})}}function HE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh extends cs{constructor(e,t,a,o){var c;super(t.code,t.message),this.operationType=a,this.user=o,Object.setPrototypeOf(this,vh.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,o){return new vh(e,t,a,o)}}function bT(n,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?vh._fromErrorAndOperation(n,c,e,a):c})}async function iR(n,e,t=!1){const a=await Hc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Sr._forOperation(n,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rR(n,e,t=!1){const{auth:a}=n;if(Rn(a.app))return Promise.reject(Ca(a));const o="reauthenticate";try{const c=await Hc(n,bT(a,o,e,n),t);Se(c.idToken,a,"internal-error");const d=Pg(c.idToken);Se(d,a,"internal-error");const{sub:m}=d;return Se(n.uid===m,a,"user-mismatch"),Sr._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&ls(a,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ET(n,e,t=!1){if(Rn(n.app))return Promise.reject(Ca(n));const a="signIn",o=await bT(n,a,e),c=await Sr._fromIdTokenResponse(n,a,o);return t||await n._updateCurrentUser(c.user),c}async function oR(n,e){return ET(Oi(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NT(n){const e=Oi(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function lR(n,e,t){if(Rn(n.app))return Promise.reject(Ca(n));const a=Oi(n),d=await tg(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",aR).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&NT(n),p}),m=await Sr._fromIdTokenResponse(a,"signIn",d);return await a._updateCurrentUser(m.user),m}function cR(n,e,t){return Rn(n.app)?Promise.reject(Ca(n)):oR(vt(n),rl.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&NT(n),a})}function uR(n,e,t,a){return vt(n).onIdTokenChanged(e,t,a)}function dR(n,e,t){return vt(n).beforeAuthStateChanged(e,t)}function hR(n,e,t,a){return vt(n).onAuthStateChanged(e,t,a)}function fR(n){return vt(n).signOut()}const yh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(yh,"1"),this.storage.removeItem(yh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mR=1e3,pR=10;class TT extends xT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),o=this.localCache[t];a!==o&&e(t,o,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,m,p)=>{this.notifyListeners(d,p)});return}const a=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(a);!t&&this.localCache[a]===d||this.notifyListeners(a,d)},c=this.storage.getItem(a);DI()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,pR):o()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},mR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}TT.type="LOCAL";const gR=TT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT extends xT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}AT.type="SESSION";const jT=AT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const a=new zh(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:o});const m=Array.from(d).map(async v=>v(t.origin,c)),p=await vR(m);t.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}zh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qg(n="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((m,p)=>{const v=qg("",20);o.port1.start();const _=setTimeout(()=>{p(new Error("unsupported_event"))},a);d={messageChannel:o,onMessage(b){const A=b;if(A.data.eventId===v)switch(A.data.status){case"ack":clearTimeout(_),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),m(A.data.response);break;default:clearTimeout(_),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(){return window}function _R(n){Gs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(){return typeof Gs().WorkerGlobalScope<"u"&&typeof Gs().importScripts=="function"}async function bR(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ER(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function NR(){return wT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT="firebaseLocalStorageDb",xR=1,_h="firebaseLocalStorage",ST="fbase_key";class lu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Hh(n,e){return n.transaction([_h],e?"readwrite":"readonly").objectStore(_h)}function TR(){const n=indexedDB.deleteDatabase(CT);return new lu(n).toPromise()}function ng(){const n=indexedDB.open(CT,xR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const a=n.result;try{a.createObjectStore(_h,{keyPath:ST})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const a=n.result;a.objectStoreNames.contains(_h)?e(a):(a.close(),await TR(),e(await ng()))})})}async function GE(n,e,t){const a=Hh(n,!0).put({[ST]:e,value:t});return new lu(a).toPromise()}async function AR(n,e){const t=Hh(n,!1).get(e),a=await new lu(t).toPromise();return a===void 0?null:a.value}function $E(n,e){const t=Hh(n,!0).delete(e);return new lu(t).toPromise()}const jR=800,wR=3;class IT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ng(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>wR)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=zh._getInstance(NR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await bR(),!this.activeServiceWorker)return;this.sender=new yR(this.activeServiceWorker);const a=await this.sender._send("ping",{},800);a&&!((e=a[0])===null||e===void 0)&&e.fulfilled&&!((t=a[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ER()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ng();return await GE(e,yh,"1"),await $E(e,yh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>GE(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>AR(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>$E(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Hh(o,!1).getAll();return new lu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)a.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!a.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IT.type="LOCAL";const CR=IT;new iu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RT(n,e){return e?wa(e):(Se(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg extends Vg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $o(e,this._buildIdpRequest())}_linkToIdToken(e,t){return $o(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return $o(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function SR(n){return ET(n.auth,new Bg(n),n.bypassAuthState)}function IR(n){const{auth:e,user:t}=n;return Se(t,e,"internal-error"),rR(t,new Bg(n),n.bypassAuthState)}async function RR(n){const{auth:e,user:t}=n;return Se(t,e,"internal-error"),iR(t,new Bg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(e,t,a,o,c=!1){this.auth=e,this.resolver=a,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:o,tenantId:c,error:d,type:m}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:a,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(p))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return SR;case"linkViaPopup":case"linkViaRedirect":return RR;case"reauthViaPopup":case"reauthViaRedirect":return IR;default:ls(this.auth,"internal-error")}}resolve(e){Ia(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ia(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR=new iu(2e3,1e4);async function MR(n,e,t){if(Rn(n.app))return Promise.reject(Es(n,"operation-not-supported-in-this-environment"));const a=Oi(n);hI(n,e,Fg);const o=RT(a,t);return new xr(a,"signInViaPopup",e,o).executeNotNull()}class xr extends DT{constructor(e,t,a,o,c){super(e,t,o,c),this.provider=a,this.authWindow=null,this.pollId=null,xr.currentPopupAction&&xr.currentPopupAction.cancel(),xr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Se(e,this.auth,"internal-error"),e}async onExecution(){Ia(this.filter.length===1,"Popup operations only handle one event");const e=qg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Es(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Es(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,a;if(!((a=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||a===void 0)&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Es(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,DR.get())};e()}}xr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR="pendingRedirect",nh=new Map;class kR extends DT{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=nh.get(this.auth._key());if(!e){try{const a=await PR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}nh.set(this.auth._key(),e)}return this.bypassAuthState||nh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PR(n,e){const t=UR(e),a=VR(n);if(!await a._isAvailable())return!1;const o=await a._get(t)==="true";return await a._remove(t),o}function LR(n,e){nh.set(n._key(),e)}function VR(n){return wa(n._redirectPersistence)}function UR(n){return th(OR,n.config.apiKey,n.name)}async function FR(n,e,t=!1){if(Rn(n.app))return Promise.reject(Ca(n));const a=Oi(n),o=RT(a,e),d=await new kR(a,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await a._persistUserIfCurrent(d.user),await a._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR=10*60*1e3;class BR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zR(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var a;if(e.error&&!MT(e)){const o=((a=e.error.code)===null||a===void 0?void 0:a.split("auth/")[1])||"internal-error";t.onError(Es(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qR&&this.cachedEventUids.clear(),this.cachedEventUids.has(YE(e))}saveEventToCache(e){this.cachedEventUids.add(YE(e)),this.lastProcessedEventTime=Date.now()}}function YE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function MT({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function zR(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return MT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HR(n,e={}){return Mi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$R=/^https?/;async function YR(n){if(n.config.emulator)return;const{authorizedDomains:e}=await HR(n);for(const t of e)try{if(KR(t))return}catch{}ls(n,"unauthorized-domain")}function KR(n){const e=Jp(),{protocol:t,hostname:a}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&a===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===a}if(!$R.test(t))return!1;if(GR.test(n))return a===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=new iu(3e4,6e4);function KE(){const n=Gs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function XR(n){return new Promise((e,t)=>{var a,o,c;function d(){KE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{KE(),t(Es(n,"network-request-failed"))},timeout:QR.get()})}if(!((o=(a=Gs().gapi)===null||a===void 0?void 0:a.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((c=Gs().gapi)===null||c===void 0)&&c.load)d();else{const m=qI("iframefcb");return Gs()[m]=()=>{gapi.load?d():t(Es(n,"network-request-failed"))},vT(`${FI()}?onload=${m}`).catch(p=>t(p))}}).catch(e=>{throw sh=null,e})}let sh=null;function WR(n){return sh=sh||XR(n),sh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=new iu(5e3,15e3),JR="__/auth/iframe",e1="emulator/auth/iframe",t1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},n1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function s1(n){const e=n.config;Se(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?kg(e,e1):`https://${n.config.authDomain}/${JR}`,a={apiKey:e.apiKey,appName:n.name,v:Pr},o=n1.get(n.config.apiHost);o&&(a.eid=o);const c=n._getFrameworks();return c.length&&(a.fw=c.join(",")),`${t}?${nu(a).slice(1)}`}async function a1(n){const e=await WR(n),t=Gs().gapi;return Se(t,n,"internal-error"),e.open({where:document.body,url:s1(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:t1,dontclear:!0},a=>new Promise(async(o,c)=>{await a.restyle({setHideOnLeave:!1});const d=Es(n,"network-request-failed"),m=Gs().setTimeout(()=>{c(d)},ZR.get());function p(){Gs().clearTimeout(m),o(a)}a.ping(p).then(p,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},r1=500,o1=600,l1="_blank",c1="http://localhost";class QE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function u1(n,e,t,a=r1,o=o1){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-a)/2,0).toString();let m="";const p=Object.assign(Object.assign({},i1),{width:a.toString(),height:o.toString(),top:c,left:d}),v=gn().toLowerCase();t&&(m=uT(v)?l1:t),lT(v)&&(e=e||c1,p.scrollbars="yes");const _=Object.entries(p).reduce((A,[j,T])=>`${A}${j}=${T},`,"");if(RI(v)&&m!=="_self")return d1(e||"",m),new QE(null);const b=window.open(e||"",m,_);Se(b,n,"popup-blocked");try{b.focus()}catch{}return new QE(b)}function d1(n,e){const t=document.createElement("a");t.href=n,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1="__/auth/handler",f1="emulator/auth/handler",m1=encodeURIComponent("fac");async function XE(n,e,t,a,o,c){Se(n.config.authDomain,n,"auth-domain-config-required"),Se(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:a,v:Pr,eventId:o};if(e instanceof Fg){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",QC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,b]of Object.entries({}))d[_]=b}if(e instanceof ou){const _=e.getScopes().filter(b=>b!=="");_.length>0&&(d.scopes=_.join(","))}n.tenantId&&(d.tid=n.tenantId);const m=d;for(const _ of Object.keys(m))m[_]===void 0&&delete m[_];const p=await n._getAppCheckToken(),v=p?`#${m1}=${encodeURIComponent(p)}`:"";return`${p1(n)}?${nu(m).slice(1)}${v}`}function p1({config:n}){return n.emulator?kg(n,f1):`https://${n.authDomain}/${h1}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp="webStorageSupport";class g1{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=jT,this._completeRedirectFn=FR,this._overrideRedirectResult=LR}async _openPopup(e,t,a,o){var c;Ia((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await XE(e,t,a,Jp(),o);return u1(e,d,qg())}async _openRedirect(e,t,a,o){await this._originValidation(e);const c=await XE(e,t,a,Jp(),o);return _R(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Ia(c,"If manager is not set, promise should be"),c)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await a1(e),a=new BR(e);return t.register("authEvent",o=>(Se(o?.authEvent,e,"invalid-auth-event"),{status:a.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Dp,{type:Dp},o=>{var c;const d=(c=o?.[0])===null||c===void 0?void 0:c[Dp];d!==void 0&&t(!!d),ls(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=YR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return pT()||cT()||Lg()}}const v1=g1;var WE="@firebase/auth",ZE="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e(a?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _1(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function b1(n){os(new $n("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:m}=a.options;Se(d&&!d.includes(":"),"invalid-api-key",{appName:a.name});const p={apiKey:d,authDomain:m,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:gT(n)},v=new LI(a,o,c,p);return YI(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),os(new $n("auth-internal",e=>{const t=Oi(e.getProvider("auth").getImmediate());return(a=>new y1(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pn(WE,ZE,_1(n)),pn(WE,ZE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1=5*60,N1=Yx("authIdTokenMaxAge")||E1;let JE=null;const x1=n=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>N1)return;const o=t?.token;JE!==o&&(JE=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function T1(n=au()){const e=Ma(n,"auth");if(e.isInitialized())return e.getImmediate();const t=$I(n,{popupRedirectResolver:v1,persistence:[CR,gR,jT]}),a=Yx("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(a,location.origin);if(location.origin===c.origin){const d=x1(c.toString());dR(t,d,()=>d(t.currentUser)),uR(t,m=>d(m))}}const o=Hx("auth");return o&&KI(t,`http://${o}`),t}function A1(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}VI({loadJS(n){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",n),a.onload=e,a.onerror=o=>{const c=Es("internal-error");c.customData=o,t(c)},a.type="text/javascript",a.charset="UTF-8",A1().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});b1("Browser");var j1="firebase",w1="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn(j1,w1,"app");var eN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _i,OT;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(L,D){function k(){}k.prototype=D.prototype,L.D=D.prototype,L.prototype=new k,L.prototype.constructor=L,L.C=function(w,C,R){for(var P=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)P[Ee-2]=arguments[Ee];return D.prototype[C].apply(w,P)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(a,t),a.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(L,D,k){k||(k=0);var w=Array(16);if(typeof D=="string")for(var C=0;16>C;++C)w[C]=D.charCodeAt(k++)|D.charCodeAt(k++)<<8|D.charCodeAt(k++)<<16|D.charCodeAt(k++)<<24;else for(C=0;16>C;++C)w[C]=D[k++]|D[k++]<<8|D[k++]<<16|D[k++]<<24;D=L.g[0],k=L.g[1],C=L.g[2];var R=L.g[3],P=D+(R^k&(C^R))+w[0]+3614090360&4294967295;D=k+(P<<7&4294967295|P>>>25),P=R+(C^D&(k^C))+w[1]+3905402710&4294967295,R=D+(P<<12&4294967295|P>>>20),P=C+(k^R&(D^k))+w[2]+606105819&4294967295,C=R+(P<<17&4294967295|P>>>15),P=k+(D^C&(R^D))+w[3]+3250441966&4294967295,k=C+(P<<22&4294967295|P>>>10),P=D+(R^k&(C^R))+w[4]+4118548399&4294967295,D=k+(P<<7&4294967295|P>>>25),P=R+(C^D&(k^C))+w[5]+1200080426&4294967295,R=D+(P<<12&4294967295|P>>>20),P=C+(k^R&(D^k))+w[6]+2821735955&4294967295,C=R+(P<<17&4294967295|P>>>15),P=k+(D^C&(R^D))+w[7]+4249261313&4294967295,k=C+(P<<22&4294967295|P>>>10),P=D+(R^k&(C^R))+w[8]+1770035416&4294967295,D=k+(P<<7&4294967295|P>>>25),P=R+(C^D&(k^C))+w[9]+2336552879&4294967295,R=D+(P<<12&4294967295|P>>>20),P=C+(k^R&(D^k))+w[10]+4294925233&4294967295,C=R+(P<<17&4294967295|P>>>15),P=k+(D^C&(R^D))+w[11]+2304563134&4294967295,k=C+(P<<22&4294967295|P>>>10),P=D+(R^k&(C^R))+w[12]+1804603682&4294967295,D=k+(P<<7&4294967295|P>>>25),P=R+(C^D&(k^C))+w[13]+4254626195&4294967295,R=D+(P<<12&4294967295|P>>>20),P=C+(k^R&(D^k))+w[14]+2792965006&4294967295,C=R+(P<<17&4294967295|P>>>15),P=k+(D^C&(R^D))+w[15]+1236535329&4294967295,k=C+(P<<22&4294967295|P>>>10),P=D+(C^R&(k^C))+w[1]+4129170786&4294967295,D=k+(P<<5&4294967295|P>>>27),P=R+(k^C&(D^k))+w[6]+3225465664&4294967295,R=D+(P<<9&4294967295|P>>>23),P=C+(D^k&(R^D))+w[11]+643717713&4294967295,C=R+(P<<14&4294967295|P>>>18),P=k+(R^D&(C^R))+w[0]+3921069994&4294967295,k=C+(P<<20&4294967295|P>>>12),P=D+(C^R&(k^C))+w[5]+3593408605&4294967295,D=k+(P<<5&4294967295|P>>>27),P=R+(k^C&(D^k))+w[10]+38016083&4294967295,R=D+(P<<9&4294967295|P>>>23),P=C+(D^k&(R^D))+w[15]+3634488961&4294967295,C=R+(P<<14&4294967295|P>>>18),P=k+(R^D&(C^R))+w[4]+3889429448&4294967295,k=C+(P<<20&4294967295|P>>>12),P=D+(C^R&(k^C))+w[9]+568446438&4294967295,D=k+(P<<5&4294967295|P>>>27),P=R+(k^C&(D^k))+w[14]+3275163606&4294967295,R=D+(P<<9&4294967295|P>>>23),P=C+(D^k&(R^D))+w[3]+4107603335&4294967295,C=R+(P<<14&4294967295|P>>>18),P=k+(R^D&(C^R))+w[8]+1163531501&4294967295,k=C+(P<<20&4294967295|P>>>12),P=D+(C^R&(k^C))+w[13]+2850285829&4294967295,D=k+(P<<5&4294967295|P>>>27),P=R+(k^C&(D^k))+w[2]+4243563512&4294967295,R=D+(P<<9&4294967295|P>>>23),P=C+(D^k&(R^D))+w[7]+1735328473&4294967295,C=R+(P<<14&4294967295|P>>>18),P=k+(R^D&(C^R))+w[12]+2368359562&4294967295,k=C+(P<<20&4294967295|P>>>12),P=D+(k^C^R)+w[5]+4294588738&4294967295,D=k+(P<<4&4294967295|P>>>28),P=R+(D^k^C)+w[8]+2272392833&4294967295,R=D+(P<<11&4294967295|P>>>21),P=C+(R^D^k)+w[11]+1839030562&4294967295,C=R+(P<<16&4294967295|P>>>16),P=k+(C^R^D)+w[14]+4259657740&4294967295,k=C+(P<<23&4294967295|P>>>9),P=D+(k^C^R)+w[1]+2763975236&4294967295,D=k+(P<<4&4294967295|P>>>28),P=R+(D^k^C)+w[4]+1272893353&4294967295,R=D+(P<<11&4294967295|P>>>21),P=C+(R^D^k)+w[7]+4139469664&4294967295,C=R+(P<<16&4294967295|P>>>16),P=k+(C^R^D)+w[10]+3200236656&4294967295,k=C+(P<<23&4294967295|P>>>9),P=D+(k^C^R)+w[13]+681279174&4294967295,D=k+(P<<4&4294967295|P>>>28),P=R+(D^k^C)+w[0]+3936430074&4294967295,R=D+(P<<11&4294967295|P>>>21),P=C+(R^D^k)+w[3]+3572445317&4294967295,C=R+(P<<16&4294967295|P>>>16),P=k+(C^R^D)+w[6]+76029189&4294967295,k=C+(P<<23&4294967295|P>>>9),P=D+(k^C^R)+w[9]+3654602809&4294967295,D=k+(P<<4&4294967295|P>>>28),P=R+(D^k^C)+w[12]+3873151461&4294967295,R=D+(P<<11&4294967295|P>>>21),P=C+(R^D^k)+w[15]+530742520&4294967295,C=R+(P<<16&4294967295|P>>>16),P=k+(C^R^D)+w[2]+3299628645&4294967295,k=C+(P<<23&4294967295|P>>>9),P=D+(C^(k|~R))+w[0]+4096336452&4294967295,D=k+(P<<6&4294967295|P>>>26),P=R+(k^(D|~C))+w[7]+1126891415&4294967295,R=D+(P<<10&4294967295|P>>>22),P=C+(D^(R|~k))+w[14]+2878612391&4294967295,C=R+(P<<15&4294967295|P>>>17),P=k+(R^(C|~D))+w[5]+4237533241&4294967295,k=C+(P<<21&4294967295|P>>>11),P=D+(C^(k|~R))+w[12]+1700485571&4294967295,D=k+(P<<6&4294967295|P>>>26),P=R+(k^(D|~C))+w[3]+2399980690&4294967295,R=D+(P<<10&4294967295|P>>>22),P=C+(D^(R|~k))+w[10]+4293915773&4294967295,C=R+(P<<15&4294967295|P>>>17),P=k+(R^(C|~D))+w[1]+2240044497&4294967295,k=C+(P<<21&4294967295|P>>>11),P=D+(C^(k|~R))+w[8]+1873313359&4294967295,D=k+(P<<6&4294967295|P>>>26),P=R+(k^(D|~C))+w[15]+4264355552&4294967295,R=D+(P<<10&4294967295|P>>>22),P=C+(D^(R|~k))+w[6]+2734768916&4294967295,C=R+(P<<15&4294967295|P>>>17),P=k+(R^(C|~D))+w[13]+1309151649&4294967295,k=C+(P<<21&4294967295|P>>>11),P=D+(C^(k|~R))+w[4]+4149444226&4294967295,D=k+(P<<6&4294967295|P>>>26),P=R+(k^(D|~C))+w[11]+3174756917&4294967295,R=D+(P<<10&4294967295|P>>>22),P=C+(D^(R|~k))+w[2]+718787259&4294967295,C=R+(P<<15&4294967295|P>>>17),P=k+(R^(C|~D))+w[9]+3951481745&4294967295,L.g[0]=L.g[0]+D&4294967295,L.g[1]=L.g[1]+(C+(P<<21&4294967295|P>>>11))&4294967295,L.g[2]=L.g[2]+C&4294967295,L.g[3]=L.g[3]+R&4294967295}a.prototype.u=function(L,D){D===void 0&&(D=L.length);for(var k=D-this.blockSize,w=this.B,C=this.h,R=0;R<D;){if(C==0)for(;R<=k;)o(this,L,R),R+=this.blockSize;if(typeof L=="string"){for(;R<D;)if(w[C++]=L.charCodeAt(R++),C==this.blockSize){o(this,w),C=0;break}}else for(;R<D;)if(w[C++]=L[R++],C==this.blockSize){o(this,w),C=0;break}}this.h=C,this.o+=D},a.prototype.v=function(){var L=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);L[0]=128;for(var D=1;D<L.length-8;++D)L[D]=0;var k=8*this.o;for(D=L.length-8;D<L.length;++D)L[D]=k&255,k/=256;for(this.u(L),L=Array(16),D=k=0;4>D;++D)for(var w=0;32>w;w+=8)L[k++]=this.g[D]>>>w&255;return L};function c(L,D){var k=m;return Object.prototype.hasOwnProperty.call(k,L)?k[L]:k[L]=D(L)}function d(L,D){this.h=D;for(var k=[],w=!0,C=L.length-1;0<=C;C--){var R=L[C]|0;w&&R==D||(k[C]=R,w=!1)}this.g=k}var m={};function p(L){return-128<=L&&128>L?c(L,function(D){return new d([D|0],0>D?-1:0)}):new d([L|0],0>L?-1:0)}function v(L){if(isNaN(L)||!isFinite(L))return b;if(0>L)return x(v(-L));for(var D=[],k=1,w=0;L>=k;w++)D[w]=L/k|0,k*=4294967296;return new d(D,0)}function _(L,D){if(L.length==0)throw Error("number format error: empty string");if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(L.charAt(0)=="-")return x(_(L.substring(1),D));if(0<=L.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=v(Math.pow(D,8)),w=b,C=0;C<L.length;C+=8){var R=Math.min(8,L.length-C),P=parseInt(L.substring(C,C+R),D);8>R?(R=v(Math.pow(D,R)),w=w.j(R).add(v(P))):(w=w.j(k),w=w.add(v(P)))}return w}var b=p(0),A=p(1),j=p(16777216);n=d.prototype,n.m=function(){if(S(this))return-x(this).m();for(var L=0,D=1,k=0;k<this.g.length;k++){var w=this.i(k);L+=(0<=w?w:4294967296+w)*D,D*=4294967296}return L},n.toString=function(L){if(L=L||10,2>L||36<L)throw Error("radix out of range: "+L);if(T(this))return"0";if(S(this))return"-"+x(this).toString(L);for(var D=v(Math.pow(L,6)),k=this,w="";;){var C=O(k,D).g;k=F(k,C.j(D));var R=((0<k.g.length?k.g[0]:k.h)>>>0).toString(L);if(k=C,T(k))return R+w;for(;6>R.length;)R="0"+R;w=R+w}},n.i=function(L){return 0>L?0:L<this.g.length?this.g[L]:this.h};function T(L){if(L.h!=0)return!1;for(var D=0;D<L.g.length;D++)if(L.g[D]!=0)return!1;return!0}function S(L){return L.h==-1}n.l=function(L){return L=F(this,L),S(L)?-1:T(L)?0:1};function x(L){for(var D=L.g.length,k=[],w=0;w<D;w++)k[w]=~L.g[w];return new d(k,~L.h).add(A)}n.abs=function(){return S(this)?x(this):this},n.add=function(L){for(var D=Math.max(this.g.length,L.g.length),k=[],w=0,C=0;C<=D;C++){var R=w+(this.i(C)&65535)+(L.i(C)&65535),P=(R>>>16)+(this.i(C)>>>16)+(L.i(C)>>>16);w=P>>>16,R&=65535,P&=65535,k[C]=P<<16|R}return new d(k,k[k.length-1]&-2147483648?-1:0)};function F(L,D){return L.add(x(D))}n.j=function(L){if(T(this)||T(L))return b;if(S(this))return S(L)?x(this).j(x(L)):x(x(this).j(L));if(S(L))return x(this.j(x(L)));if(0>this.l(j)&&0>L.l(j))return v(this.m()*L.m());for(var D=this.g.length+L.g.length,k=[],w=0;w<2*D;w++)k[w]=0;for(w=0;w<this.g.length;w++)for(var C=0;C<L.g.length;C++){var R=this.i(w)>>>16,P=this.i(w)&65535,Ee=L.i(C)>>>16,ne=L.i(C)&65535;k[2*w+2*C]+=P*ne,Y(k,2*w+2*C),k[2*w+2*C+1]+=R*ne,Y(k,2*w+2*C+1),k[2*w+2*C+1]+=P*Ee,Y(k,2*w+2*C+1),k[2*w+2*C+2]+=R*Ee,Y(k,2*w+2*C+2)}for(w=0;w<D;w++)k[w]=k[2*w+1]<<16|k[2*w];for(w=D;w<2*D;w++)k[w]=0;return new d(k,0)};function Y(L,D){for(;(L[D]&65535)!=L[D];)L[D+1]+=L[D]>>>16,L[D]&=65535,D++}function V(L,D){this.g=L,this.h=D}function O(L,D){if(T(D))throw Error("division by zero");if(T(L))return new V(b,b);if(S(L))return D=O(x(L),D),new V(x(D.g),x(D.h));if(S(D))return D=O(L,x(D)),new V(x(D.g),D.h);if(30<L.g.length){if(S(L)||S(D))throw Error("slowDivide_ only works with positive integers.");for(var k=A,w=D;0>=w.l(L);)k=U(k),w=U(w);var C=W(k,1),R=W(w,1);for(w=W(w,2),k=W(k,2);!T(w);){var P=R.add(w);0>=P.l(L)&&(C=C.add(k),R=P),w=W(w,1),k=W(k,1)}return D=F(L,C.j(D)),new V(C,D)}for(C=b;0<=L.l(D);){for(k=Math.max(1,Math.floor(L.m()/D.m())),w=Math.ceil(Math.log(k)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),R=v(k),P=R.j(D);S(P)||0<P.l(L);)k-=w,R=v(k),P=R.j(D);T(R)&&(R=A),C=C.add(R),L=F(L,P)}return new V(C,L)}n.A=function(L){return O(this,L).h},n.and=function(L){for(var D=Math.max(this.g.length,L.g.length),k=[],w=0;w<D;w++)k[w]=this.i(w)&L.i(w);return new d(k,this.h&L.h)},n.or=function(L){for(var D=Math.max(this.g.length,L.g.length),k=[],w=0;w<D;w++)k[w]=this.i(w)|L.i(w);return new d(k,this.h|L.h)},n.xor=function(L){for(var D=Math.max(this.g.length,L.g.length),k=[],w=0;w<D;w++)k[w]=this.i(w)^L.i(w);return new d(k,this.h^L.h)};function U(L){for(var D=L.g.length+1,k=[],w=0;w<D;w++)k[w]=L.i(w)<<1|L.i(w-1)>>>31;return new d(k,L.h)}function W(L,D){var k=D>>5;D%=32;for(var w=L.g.length-k,C=[],R=0;R<w;R++)C[R]=0<D?L.i(R+k)>>>D|L.i(R+k+1)<<32-D:L.i(R+k);return new d(C,L.h)}a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,OT=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=_,_i=d}).apply(typeof eN<"u"?eN:typeof self<"u"?self:typeof window<"u"?window:{});var $d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kT,wc,PT,ah,sg,LT,VT,UT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,E){return h==Array.prototype||h==Object.prototype||(h[y]=E.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof $d=="object"&&$d];for(var y=0;y<h.length;++y){var E=h[y];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var a=t(this);function o(h,y){if(y)e:{var E=a;h=h.split(".");for(var M=0;M<h.length-1;M++){var K=h[M];if(!(K in E))break e;E=E[K]}h=h[h.length-1],M=E[h],y=y(M),y!=M&&y!=null&&e(E,h,{configurable:!0,writable:!0,value:y})}}function c(h,y){h instanceof String&&(h+="");var E=0,M=!1,K={next:function(){if(!M&&E<h.length){var te=E++;return{value:y(te,h[te]),done:!1}}return M=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}o("Array.prototype.values",function(h){return h||function(){return c(this,function(y,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},m=this||self;function p(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function v(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function _(h,y,E){return h.call.apply(h.bind,arguments)}function b(h,y,E){if(!h)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,M),h.apply(y,K)}}return function(){return h.apply(y,arguments)}}function A(h,y,E){return A=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:b,A.apply(null,arguments)}function j(h,y){var E=Array.prototype.slice.call(arguments,1);return function(){var M=E.slice();return M.push.apply(M,arguments),h.apply(this,M)}}function T(h,y){function E(){}E.prototype=y.prototype,h.aa=y.prototype,h.prototype=new E,h.prototype.constructor=h,h.Qb=function(M,K,te){for(var de=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)de[Ke-2]=arguments[Ke];return y.prototype[K].apply(M,de)}}function S(h){const y=h.length;if(0<y){const E=Array(y);for(let M=0;M<y;M++)E[M]=h[M];return E}return[]}function x(h,y){for(let E=1;E<arguments.length;E++){const M=arguments[E];if(p(M)){const K=h.length||0,te=M.length||0;h.length=K+te;for(let de=0;de<te;de++)h[K+de]=M[de]}else h.push(M)}}class F{constructor(y,E){this.i=y,this.j=E,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function Y(h){return/^[\s\xa0]*$/.test(h)}function V(){var h=m.navigator;return h&&(h=h.userAgent)?h:""}function O(h){return O[" "](h),h}O[" "]=function(){};var U=V().indexOf("Gecko")!=-1&&!(V().toLowerCase().indexOf("webkit")!=-1&&V().indexOf("Edge")==-1)&&!(V().indexOf("Trident")!=-1||V().indexOf("MSIE")!=-1)&&V().indexOf("Edge")==-1;function W(h,y,E){for(const M in h)y.call(E,h[M],M,h)}function L(h,y){for(const E in h)y.call(void 0,h[E],E,h)}function D(h){const y={};for(const E in h)y[E]=h[E];return y}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(h,y){let E,M;for(let K=1;K<arguments.length;K++){M=arguments[K];for(E in M)h[E]=M[E];for(let te=0;te<k.length;te++)E=k[te],Object.prototype.hasOwnProperty.call(M,E)&&(h[E]=M[E])}}function C(h){var y=1;h=h.split(":");const E=[];for(;0<y&&h.length;)E.push(h.shift()),y--;return h.length&&E.push(h.join(":")),E}function R(h){m.setTimeout(()=>{throw h},0)}function P(){var h=ye;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class Ee{constructor(){this.h=this.g=null}add(y,E){const M=ne.get();M.set(y,E),this.h?this.h.next=M:this.g=M,this.h=M}}var ne=new F(()=>new z,h=>h.reset());class z{constructor(){this.next=this.g=this.h=null}set(y,E){this.h=y,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let se,he=!1,ye=new Ee,q=()=>{const h=m.Promise.resolve(void 0);se=()=>{h.then(ee)}};var ee=()=>{for(var h;h=P();){try{h.h.call(h.g)}catch(E){R(E)}var y=ne;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}he=!1};function ce(){this.s=this.s,this.C=this.C}ce.prototype.s=!1,ce.prototype.ma=function(){this.s||(this.s=!0,this.N())},ce.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var xe=function(){if(!m.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};m.addEventListener("test",E,y),m.removeEventListener("test",E,y)}catch{}return h}();function qe(h,y){if(ue.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var E=this.type=h.type,M=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(U){e:{try{O(y.nodeName);var K=!0;break e}catch{}K=!1}K||(y=null)}}else E=="mouseover"?y=h.fromElement:E=="mouseout"&&(y=h.toElement);this.relatedTarget=y,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Re[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&qe.aa.h.call(this)}}T(qe,ue);var Re={2:"touch",3:"pen",4:"mouse"};qe.prototype.h=function(){qe.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Ht="closure_listenable_"+(1e6*Math.random()|0),mt=0;function As(h,y,E,M,K){this.listener=h,this.proxy=null,this.src=y,this.type=E,this.capture=!!M,this.ha=K,this.key=++mt,this.da=this.fa=!1}function ka(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Zs(h){this.src=h,this.g={},this.h=0}Zs.prototype.add=function(h,y,E,M,K){var te=h.toString();h=this.g[te],h||(h=this.g[te]=[],this.h++);var de=Ui(h,y,M,K);return-1<de?(y=h[de],E||(y.fa=!1)):(y=new As(y,this.src,te,!!M,K),y.fa=E,h.push(y)),y};function Vi(h,y){var E=y.type;if(E in h.g){var M=h.g[E],K=Array.prototype.indexOf.call(M,y,void 0),te;(te=0<=K)&&Array.prototype.splice.call(M,K,1),te&&(ka(y),h.g[E].length==0&&(delete h.g[E],h.h--))}}function Ui(h,y,E,M){for(var K=0;K<h.length;++K){var te=h[K];if(!te.da&&te.listener==y&&te.capture==!!E&&te.ha==M)return K}return-1}var Fi="closure_lm_"+(1e6*Math.random()|0),pl={};function Eu(h,y,E,M,K){if(Array.isArray(y)){for(var te=0;te<y.length;te++)Eu(h,y[te],E,M,K);return null}return E=Nu(E),h&&h[Ht]?h.K(y,E,v(M)?!!M.capture:!1,K):Yn(h,y,E,!1,M,K)}function Yn(h,y,E,M,K,te){if(!y)throw Error("Invalid event type");var de=v(K)?!!K.capture:!!K,Ke=Br(h);if(Ke||(h[Fi]=Ke=new Zs(h)),E=Ke.add(y,E,M,de,te),E.proxy)return E;if(M=bf(),E.proxy=M,M.src=h,M.listener=E,h.addEventListener)xe||(K=de),K===void 0&&(K=!1),h.addEventListener(y.toString(),M,K);else if(h.attachEvent)h.attachEvent(qi(y.toString()),M);else if(h.addListener&&h.removeListener)h.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return E}function bf(){function h(E){return y.call(h.src,h.listener,E)}const y=Ef;return h}function gl(h,y,E,M,K){if(Array.isArray(y))for(var te=0;te<y.length;te++)gl(h,y[te],E,M,K);else M=v(M)?!!M.capture:!!M,E=Nu(E),h&&h[Ht]?(h=h.i,y=String(y).toString(),y in h.g&&(te=h.g[y],E=Ui(te,E,M,K),-1<E&&(ka(te[E]),Array.prototype.splice.call(te,E,1),te.length==0&&(delete h.g[y],h.h--)))):h&&(h=Br(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Ui(y,E,M,K)),(E=-1<h?y[h]:null)&&qr(E))}function qr(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[Ht])Vi(y.i,h);else{var E=h.type,M=h.proxy;y.removeEventListener?y.removeEventListener(E,M,h.capture):y.detachEvent?y.detachEvent(qi(E),M):y.addListener&&y.removeListener&&y.removeListener(M),(E=Br(y))?(Vi(E,h),E.h==0&&(E.src=null,y[Fi]=null)):ka(h)}}}function qi(h){return h in pl?pl[h]:pl[h]="on"+h}function Ef(h,y){if(h.da)h=!0;else{y=new qe(y,this);var E=h.listener,M=h.ha||h.src;h.fa&&qr(h),h=E.call(M,y)}return h}function Br(h){return h=h[Fi],h instanceof Zs?h:null}var vl="__closure_events_fn_"+(1e9*Math.random()>>>0);function Nu(h){return typeof h=="function"?h:(h[vl]||(h[vl]=function(y){return h.handleEvent(y)}),h[vl])}function xt(){ce.call(this),this.i=new Zs(this),this.M=this,this.F=null}T(xt,ce),xt.prototype[Ht]=!0,xt.prototype.removeEventListener=function(h,y,E,M){gl(this,h,y,E,M)};function st(h,y){var E,M=h.F;if(M)for(E=[];M;M=M.F)E.push(M);if(h=h.M,M=y.type||y,typeof y=="string")y=new ue(y,h);else if(y instanceof ue)y.target=y.target||h;else{var K=y;y=new ue(M,h),w(y,K)}if(K=!0,E)for(var te=E.length-1;0<=te;te--){var de=y.g=E[te];K=Mn(de,M,!0,y)&&K}if(de=y.g=h,K=Mn(de,M,!0,y)&&K,K=Mn(de,M,!1,y)&&K,E)for(te=0;te<E.length;te++)de=y.g=E[te],K=Mn(de,M,!1,y)&&K}xt.prototype.N=function(){if(xt.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var E=h.g[y],M=0;M<E.length;M++)ka(E[M]);delete h.g[y],h.h--}}this.F=null},xt.prototype.K=function(h,y,E,M){return this.i.add(String(h),y,!1,E,M)},xt.prototype.L=function(h,y,E,M){return this.i.add(String(h),y,!0,E,M)};function Mn(h,y,E,M){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var K=!0,te=0;te<y.length;++te){var de=y[te];if(de&&!de.da&&de.capture==E){var Ke=de.listener,Lt=de.ha||de.src;de.fa&&Vi(h.i,de),K=Ke.call(Lt,M)!==!1&&K}}return K&&!M.defaultPrevented}function cn(h,y,E){if(typeof h=="function")E&&(h=A(h,E));else if(h&&typeof h.handleEvent=="function")h=A(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:m.setTimeout(h,y||0)}function xu(h){h.g=cn(()=>{h.g=null,h.i&&(h.i=!1,xu(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class Nf extends ce{constructor(y,E){super(),this.m=y,this.l=E,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:xu(this)}N(){super.N(),this.g&&(m.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bi(h){ce.call(this),this.h=h,this.g={}}T(Bi,ce);var zi=[];function Hi(h){W(h.g,function(y,E){this.g.hasOwnProperty(E)&&qr(y)},h),h.g={}}Bi.prototype.N=function(){Bi.aa.N.call(this),Hi(this)},Bi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var us=m.JSON.stringify,zr=m.JSON.parse,Gi=class{stringify(h){return m.JSON.stringify(h,void 0)}parse(h){return m.JSON.parse(h,void 0)}};function yl(){}yl.prototype.h=null;function _l(h){return h.h||(h.h=h.i())}function bl(){}var Js={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ea(){ue.call(this,"d")}T(ea,ue);function El(){ue.call(this,"c")}T(El,ue);var js={},Nl=null;function Pa(){return Nl=Nl||new xt}js.La="serverreachability";function Hr(h){ue.call(this,js.La,h)}T(Hr,ue);function La(h){const y=Pa();st(y,new Hr(y))}js.STAT_EVENT="statevent";function Tu(h,y){ue.call(this,js.STAT_EVENT,h),this.stat=y}T(Tu,ue);function yt(h){const y=Pa();st(y,new Tu(y,h))}js.Ma="timingevent";function Pt(h,y){ue.call(this,js.Ma,h),this.size=y}T(Pt,ue);function It(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return m.setTimeout(function(){h()},y)}function Kn(){this.g=!0}Kn.prototype.xa=function(){this.g=!1};function xl(h,y,E,M,K,te){h.info(function(){if(h.g)if(te)for(var de="",Ke=te.split("&"),Lt=0;Lt<Ke.length;Lt++){var Qe=Ke[Lt].split("=");if(1<Qe.length){var $t=Qe[0];Qe=Qe[1];var Vt=$t.split("_");de=2<=Vt.length&&Vt[1]=="type"?de+($t+"="+Qe+"&"):de+($t+"=redacted&")}}else de=null;else de=te;return"XMLHTTP REQ ("+M+") [attempt "+K+"]: "+y+`
`+E+`
`+de})}function xf(h,y,E,M,K,te,de){h.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+K+"]: "+y+`
`+E+`
`+te+" "+de})}function Va(h,y,E,M){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+$i(h,E)+(M?" "+M:"")})}function Au(h,y){h.info(function(){return"TIMEOUT: "+y})}Kn.prototype.info=function(){};function $i(h,y){if(!h.g)return y;if(!y)return null;try{var E=JSON.parse(y);if(E){for(h=0;h<E.length;h++)if(Array.isArray(E[h])){var M=E[h];if(!(2>M.length)){var K=M[1];if(Array.isArray(K)&&!(1>K.length)){var te=K[0];if(te!="noop"&&te!="stop"&&te!="close")for(var de=1;de<K.length;de++)K[de]=""}}}}return us(E)}catch{return y}}var Ua={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ta={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ws;function Cs(){}T(Cs,yl),Cs.prototype.g=function(){return new XMLHttpRequest},Cs.prototype.i=function(){return{}},ws=new Cs;function vn(h,y,E,M){this.j=h,this.i=y,this.l=E,this.R=M||1,this.U=new Bi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new jt}function jt(){this.i=null,this.g="",this.h=!1}var Tl={},Gr={};function ds(h,y,E){h.L=1,h.v=Wi(On(y)),h.m=E,h.P=!0,na(h,null)}function na(h,y){h.F=Date.now(),Yi(h),h.A=On(h.v);var E=h.A,M=h.R;Array.isArray(M)||(M=[String(M)]),Il(E.i,"t",M),h.C=0,E=h.j.J,h.h=new jt,h.g=qu(h.j,E?y:null,!h.m),0<h.O&&(h.M=new Nf(A(h.Y,h,h.g),h.O)),y=h.U,E=h.g,M=h.ca;var K="readystatechange";Array.isArray(K)||(K&&(zi[0]=K.toString()),K=zi);for(var te=0;te<K.length;te++){var de=Eu(E,K[te],M||y.handleEvent,!1,y.h||y);if(!de)break;y.g[de.key]=de}y=h.H?D(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),La(),xl(h.i,h.u,h.A,h.l,h.R,h.m)}vn.prototype.ca=function(h){h=h.target;const y=this.M;y&&Zn(h)==3?y.j():this.Y(h)},vn.prototype.Y=function(h){try{if(h==this.g)e:{const Vt=Zn(this.g);var y=this.g.Ba();const ua=this.g.Z();if(!(3>Vt)&&(Vt!=3||this.g&&(this.h.h||this.g.oa()||Mu(this.g)))){this.J||Vt!=4||y==7||(y==8||0>=ua?La(3):La(2)),Fa(this);var E=this.g.Z();this.X=E;t:if(ju(this)){var M=Mu(this.g);h="";var K=M.length,te=Zn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zt(this),Ss(this);var de="";break t}this.h.i=new m.TextDecoder}for(y=0;y<K;y++)this.h.h=!0,h+=this.h.i.decode(M[y],{stream:!(te&&y==K-1)});M.length=0,this.h.g+=h,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=E==200,xf(this.i,this.u,this.A,this.l,this.R,Vt,E),this.o){if(this.T&&!this.K){t:{if(this.g){var Ke,Lt=this.g;if((Ke=Lt.g?Lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(Ke)){var Qe=Ke;break t}}Qe=null}if(E=Qe)Va(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ki(this,E);else{this.o=!1,this.s=3,yt(12),Zt(this),Ss(this);break e}}if(this.P){E=!0;let Jt;for(;!this.J&&this.C<de.length;)if(Jt=wu(this,de),Jt==Gr){Vt==4&&(this.s=4,yt(14),E=!1),Va(this.i,this.l,null,"[Incomplete Response]");break}else if(Jt==Tl){this.s=4,yt(15),Va(this.i,this.l,de,"[Invalid Chunk]"),E=!1;break}else Va(this.i,this.l,Jt,null),Ki(this,Jt);if(ju(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vt!=4||de.length!=0||this.h.h||(this.s=1,yt(16),E=!1),this.o=this.o&&E,!E)Va(this.i,this.l,de,"[Invalid Chunked Response]"),Zt(this),Ss(this);else if(0<de.length&&!this.W){this.W=!0;var $t=this.j;$t.g==this&&$t.ba&&!$t.M&&($t.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),ir($t),$t.M=!0,yt(11))}}else Va(this.i,this.l,de,null),Ki(this,de);Vt==4&&Zt(this),this.o&&!this.J&&(Vt==4?Vu(this.j,this):(this.o=!1,Yi(this)))}else Cf(this.g),E==400&&0<de.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),Zt(this),Ss(this)}}}catch{}finally{}};function ju(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function wu(h,y){var E=h.C,M=y.indexOf(`
`,E);return M==-1?Gr:(E=Number(y.substring(E,M)),isNaN(E)?Tl:(M+=1,M+E>y.length?Gr:(y=y.slice(M,M+E),h.C=M+E,y)))}vn.prototype.cancel=function(){this.J=!0,Zt(this)};function Yi(h){h.S=Date.now()+h.I,Cu(h,h.I)}function Cu(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=It(A(h.ba,h),y)}function Fa(h){h.B&&(m.clearTimeout(h.B),h.B=null)}vn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Au(this.i,this.A),this.L!=2&&(La(),yt(17)),Zt(this),this.s=2,Ss(this)):Cu(this,this.S-h)};function Ss(h){h.j.G==0||h.J||Vu(h.j,h)}function Zt(h){Fa(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,Hi(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Ki(h,y){try{var E=h.j;if(E.G!=0&&(E.g==h||Al(E.h,h))){if(!h.K&&Al(E.h,h)&&E.G==3){try{var M=E.Da.g.parse(y)}catch{M=null}if(Array.isArray(M)&&M.length==3){var K=M;if(K[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<h.F)so(E),to(E);else break e;kl(E),yt(18)}}else E.za=K[1],0<E.za-E.T&&37500>K[2]&&E.F&&E.v==0&&!E.C&&(E.C=It(A(E.Za,E),6e3));if(1>=Yr(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else ca(E,11)}else if((h.K||E.g==h)&&so(E),!Y(y))for(K=E.Da.g.parse(y),y=0;y<K.length;y++){let Qe=K[y];if(E.T=Qe[0],Qe=Qe[1],E.G==2)if(Qe[0]=="c"){E.K=Qe[1],E.ia=Qe[2];const $t=Qe[3];$t!=null&&(E.la=$t,E.j.info("VER="+E.la));const Vt=Qe[4];Vt!=null&&(E.Aa=Vt,E.j.info("SVER="+E.Aa));const ua=Qe[5];ua!=null&&typeof ua=="number"&&0<ua&&(M=1.5*ua,E.L=M,E.j.info("backChannelRequestTimeoutMs_="+M)),M=E;const Jt=h.g;if(Jt){const Ps=Jt.g?Jt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ps){var te=M.h;te.g||Ps.indexOf("spdy")==-1&&Ps.indexOf("quic")==-1&&Ps.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Kr(te,te.h),te.h=null))}if(M.D){const Ll=Jt.g?Jt.g.getResponseHeader("X-HTTP-Session-Id"):null;Ll&&(M.ya=Ll,ot(M.I,M.D,Ll))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-h.F,E.j.info("Handshake RTT: "+E.R+"ms")),M=E;var de=h;if(M.qa=Fu(M,M.J?M.ia:null,M.W),de.K){yn(M.h,de);var Ke=de,Lt=M.L;Lt&&(Ke.I=Lt),Ke.B&&(Fa(Ke),Yi(Ke)),M.g=de}else Pu(M);0<E.i.length&&no(E)}else Qe[0]!="stop"&&Qe[0]!="close"||ca(E,7);else E.G==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?ca(E,7):Ml(E):Qe[0]!="noop"&&E.l&&E.l.ta(Qe),E.v=0)}}La(4)}catch{}}var Su=class{constructor(h,y){this.g=h,this.map=y}};function sa(h){this.l=h||10,m.PerformanceNavigationTiming?(h=m.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(m.chrome&&m.chrome.loadTimes&&m.chrome.loadTimes()&&m.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function $r(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Yr(h){return h.h?1:h.g?h.g.size:0}function Al(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function Kr(h,y){h.g?h.g.add(y):h.h=y}function yn(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}sa.prototype.cancel=function(){if(this.i=jl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function jl(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const E of h.g.values())y=y.concat(E.D);return y}return S(h.i)}function Tf(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var y=[],E=h.length,M=0;M<E;M++)y.push(h[M]);return y}y=[],E=0;for(M in h)y[E++]=h[M];return y}function Qr(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var y=[];h=h.length;for(var E=0;E<h;E++)y.push(E);return y}y=[],E=0;for(const M in h)y[E++]=M;return y}}}function wl(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var E=Qr(h),M=Tf(h),K=M.length,te=0;te<K;te++)y.call(void 0,M[te],E&&E[te],h)}var Qi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Af(h,y){if(h){h=h.split("&");for(var E=0;E<h.length;E++){var M=h[E].indexOf("="),K=null;if(0<=M){var te=h[E].substring(0,M);K=h[E].substring(M+1)}else te=h[E];y(te,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Rt(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Rt){this.h=h.h,Xi(this,h.j),this.o=h.o,this.g=h.g,qa(this,h.s),this.l=h.l;var y=h.i,E=new ia;E.i=y.i,y.g&&(E.g=new Map(y.g),E.h=y.h),aa(this,E),this.m=h.m}else h&&(y=String(h).match(Qi))?(this.h=!1,Xi(this,y[1]||"",!0),this.o=Qn(y[2]||""),this.g=Qn(y[3]||"",!0),qa(this,y[4]),this.l=Qn(y[5]||"",!0),aa(this,y[6]||"",!0),this.m=Qn(y[7]||"")):(this.h=!1,this.i=new ia(null,this.h))}Rt.prototype.toString=function(){var h=[],y=this.j;y&&h.push(Zi(y,Cl,!0),":");var E=this.g;return(E||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Zi(y,Cl,!0),"@"),h.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&h.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(Zi(E,E.charAt(0)=="/"?jf:Sl,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",Zi(E,Xr)),h.join("")};function On(h){return new Rt(h)}function Xi(h,y,E){h.j=E?Qn(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function qa(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function aa(h,y,E){y instanceof ia?(h.i=y,Ru(h.i,h.h)):(E||(y=Zi(y,wf)),h.i=new ia(y,h.h))}function ot(h,y,E){h.i.set(y,E)}function Wi(h){return ot(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Qn(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Zi(h,y,E){return typeof h=="string"?(h=encodeURI(h).replace(y,Iu),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Iu(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Cl=/[#\/\?@]/g,Sl=/[#\?:]/g,jf=/[#\?]/g,wf=/[#\?@]/g,Xr=/#/g;function ia(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function Xn(h){h.g||(h.g=new Map,h.h=0,h.i&&Af(h.i,function(y,E){h.add(decodeURIComponent(y.replace(/\+/g," ")),E)}))}n=ia.prototype,n.add=function(h,y){Xn(this),this.i=null,h=Is(this,h);var E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(y),this.h+=1,this};function ra(h,y){Xn(h),y=Is(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function oa(h,y){return Xn(h),y=Is(h,y),h.g.has(y)}n.forEach=function(h,y){Xn(this),this.g.forEach(function(E,M){E.forEach(function(K){h.call(y,K,M,this)},this)},this)},n.na=function(){Xn(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),E=[];for(let M=0;M<y.length;M++){const K=h[M];for(let te=0;te<K.length;te++)E.push(y[M])}return E},n.V=function(h){Xn(this);let y=[];if(typeof h=="string")oa(this,h)&&(y=y.concat(this.g.get(Is(this,h))));else{h=Array.from(this.g.values());for(let E=0;E<h.length;E++)y=y.concat(h[E])}return y},n.set=function(h,y){return Xn(this),this.i=null,h=Is(this,h),oa(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},n.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function Il(h,y,E){ra(h,y),0<E.length&&(h.i=null,h.g.set(Is(h,y),S(E)),h.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var E=0;E<y.length;E++){var M=y[E];const te=encodeURIComponent(String(M)),de=this.V(M);for(M=0;M<de.length;M++){var K=te;de[M]!==""&&(K+="="+encodeURIComponent(String(de[M]))),h.push(K)}}return this.i=h.join("&")};function Is(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Ru(h,y){y&&!h.j&&(Xn(h),h.i=null,h.g.forEach(function(E,M){var K=M.toLowerCase();M!=K&&(ra(this,M),Il(this,K,E))},h)),h.j=y}function Ji(h,y){const E=new Kn;if(m.Image){const M=new Image;M.onload=j(Wn,E,"TestLoadImage: loaded",!0,y,M),M.onerror=j(Wn,E,"TestLoadImage: error",!1,y,M),M.onabort=j(Wn,E,"TestLoadImage: abort",!1,y,M),M.ontimeout=j(Wn,E,"TestLoadImage: timeout",!1,y,M),m.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=h}else y(!1)}function hs(h,y){const E=new Kn,M=new AbortController,K=setTimeout(()=>{M.abort(),Wn(E,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:M.signal}).then(te=>{clearTimeout(K),te.ok?Wn(E,"TestPingServer: ok",!0,y):Wn(E,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(K),Wn(E,"TestPingServer: error",!1,y)})}function Wn(h,y,E,M,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),M(E)}catch{}}function er(){this.g=new Gi}function Rs(h,y,E){const M=E||"";try{wl(h,function(K,te){let de=K;v(K)&&(de=us(K)),y.push(M+te+"="+encodeURIComponent(de))})}catch(K){throw y.push(M+"type="+encodeURIComponent("_badmap")),K}}function Ba(h){this.l=h.Ub||null,this.j=h.eb||!1}T(Ba,yl),Ba.prototype.g=function(){return new la(this.l,this.j)},Ba.prototype.i=function(h){return function(){return h}}({});function la(h,y){xt.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(la,xt),n=la.prototype,n.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,Ms(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||m).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ds(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Ms(this)),this.g&&(this.readyState=3,Ms(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof m.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rl(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Rl(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Ds(this):Ms(this),this.readyState==3&&Rl(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Ds(this))},n.Qa=function(h){this.g&&(this.response=h,Ds(this))},n.ga=function(){this.g&&Ds(this)};function Ds(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Ms(h)}n.setRequestHeader=function(h,y){this.u.append(h,y)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var E=y.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=y.next();return h.join(`\r
`)};function Ms(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(la.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Dl(h){let y="";return W(h,function(E,M){y+=M,y+=":",y+=E,y+=`\r
`}),y}function Gt(h,y,E){e:{for(M in E){var M=!1;break e}M=!0}M||(E=Dl(E),typeof h=="string"?E!=null&&encodeURIComponent(String(E)):ot(h,y,E))}function tt(h){xt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(tt,xt);var Wr=/^https?$/i,tr=["POST","PUT"];n=tt.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,y,E,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ws.g(),this.v=this.o?_l(this.o):_l(ws),this.g.onreadystatechange=A(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(te){Du(this,te);return}if(h=E||"",E=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var K in M)E.set(K,M[K]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const te of M.keys())E.set(te,M.get(te));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(E.keys()).find(te=>te.toLowerCase()=="content-type"),K=m.FormData&&h instanceof m.FormData,!(0<=Array.prototype.indexOf.call(tr,y,void 0))||M||K||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,de]of E)this.g.setRequestHeader(te,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{nr(this),this.u=!0,this.g.send(h),this.u=!1}catch(te){Du(this,te)}};function Du(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,Zr(h),Os(h)}function Zr(h){h.A||(h.A=!0,st(h,"complete"),st(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,st(this,"complete"),st(this,"abort"),Os(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Os(this,!0)),tt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Jr(this):this.bb())},n.bb=function(){Jr(this)};function Jr(h){if(h.h&&typeof d<"u"&&(!h.v[1]||Zn(h)!=4||h.Z()!=2)){if(h.u&&Zn(h)==4)cn(h.Ea,0,h);else if(st(h,"readystatechange"),Zn(h)==4){h.h=!1;try{const de=h.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var E;if(!(E=y)){var M;if(M=de===0){var K=String(h.D).match(Qi)[1]||null;!K&&m.self&&m.self.location&&(K=m.self.location.protocol.slice(0,-1)),M=!Wr.test(K?K.toLowerCase():"")}E=M}if(E)st(h,"complete"),st(h,"success");else{h.m=6;try{var te=2<Zn(h)?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.Z()+"]",Zr(h)}}finally{Os(h)}}}}function Os(h,y){if(h.g){nr(h);const E=h.g,M=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||st(h,"ready");try{E.onreadystatechange=M}catch{}}}function nr(h){h.I&&(m.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function Zn(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<Zn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),zr(y)}};function Mu(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Cf(h){const y={};h=(h.g&&2<=Zn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<h.length;M++){if(Y(h[M]))continue;var E=C(h[M]);const K=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const te=y[K]||[];y[K]=te,te.push(E)}L(y,function(M){return M.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function sr(h,y,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||y}function eo(h){this.Aa=0,this.i=[],this.j=new Kn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=sr("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=sr("baseRetryDelayMs",5e3,h),this.cb=sr("retryDelaySeedMs",1e4,h),this.Wa=sr("forwardChannelMaxRetries",2,h),this.wa=sr("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new sa(h&&h.concurrentRequestLimit),this.Da=new er,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=eo.prototype,n.la=8,n.G=1,n.connect=function(h,y,E,M){yt(0),this.W=h,this.H=y||{},E&&M!==void 0&&(this.H.OSID=E,this.H.OAID=M),this.F=this.X,this.I=Fu(this,null,this.W),no(this)};function Ml(h){if(Ou(h),h.G==3){var y=h.U++,E=On(h.I);if(ot(E,"SID",h.K),ot(E,"RID",y),ot(E,"TYPE","terminate"),ar(h,E),y=new vn(h,h.j,y),y.L=2,y.v=Wi(On(E)),E=!1,m.navigator&&m.navigator.sendBeacon)try{E=m.navigator.sendBeacon(y.v.toString(),"")}catch{}!E&&m.Image&&(new Image().src=y.v,E=!0),E||(y.g=qu(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Yi(y)}Uu(h)}function to(h){h.g&&(ir(h),h.g.cancel(),h.g=null)}function Ou(h){to(h),h.u&&(m.clearTimeout(h.u),h.u=null),so(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&m.clearTimeout(h.s),h.s=null)}function no(h){if(!$r(h.h)&&!h.s){h.s=!0;var y=h.Ga;se||q(),he||(se(),he=!0),ye.add(y,h),h.B=0}}function Sf(h,y){return Yr(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=It(A(h.Ga,h,y),Pl(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const K=new vn(this,this.j,h);let te=this.o;if(this.S&&(te?(te=D(te),w(te,this.S)):te=this.S),this.m!==null||this.O||(K.H=te,te=null),this.P)e:{for(var y=0,E=0;E<this.i.length;E++){t:{var M=this.i[E];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(y+=M,4096<y){y=E;break e}if(y===4096||E===this.i.length-1){y=E+1;break e}}y=1e3}else y=1e3;y=ku(this,K,y),E=On(this.I),ot(E,"RID",h),ot(E,"CVER",22),this.D&&ot(E,"X-HTTP-Session-Id",this.D),ar(this,E),te&&(this.O?y="headers="+encodeURIComponent(String(Dl(te)))+"&"+y:this.m&&Gt(E,this.m,te)),Kr(this.h,K),this.Ua&&ot(E,"TYPE","init"),this.P?(ot(E,"$req",y),ot(E,"SID","null"),K.T=!0,ds(K,E,null)):ds(K,E,y),this.G=2}}else this.G==3&&(h?Ol(this,h):this.i.length==0||$r(this.h)||Ol(this))};function Ol(h,y){var E;y?E=y.l:E=h.U++;const M=On(h.I);ot(M,"SID",h.K),ot(M,"RID",E),ot(M,"AID",h.T),ar(h,M),h.m&&h.o&&Gt(M,h.m,h.o),E=new vn(h,h.j,E,h.B+1),h.m===null&&(E.H=h.o),y&&(h.i=y.D.concat(h.i)),y=ku(h,E,1e3),E.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Kr(h.h,E),ds(E,M,y)}function ar(h,y){h.H&&W(h.H,function(E,M){ot(y,M,E)}),h.l&&wl({},function(E,M){ot(y,M,E)})}function ku(h,y,E){E=Math.min(h.i.length,E);var M=h.l?A(h.l.Na,h.l,h):null;e:{var K=h.i;let te=-1;for(;;){const de=["count="+E];te==-1?0<E?(te=K[0].g,de.push("ofs="+te)):te=0:de.push("ofs="+te);let Ke=!0;for(let Lt=0;Lt<E;Lt++){let Qe=K[Lt].g;const $t=K[Lt].map;if(Qe-=te,0>Qe)te=Math.max(0,K[Lt].g-100),Ke=!1;else try{Rs($t,de,"req"+Qe+"_")}catch{M&&M($t)}}if(Ke){M=de.join("&");break e}}}return h=h.i.splice(0,E),y.D=h,M}function Pu(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;se||q(),he||(se(),he=!0),ye.add(y,h),h.v=0}}function kl(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=It(A(h.Fa,h),Pl(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,Lu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=It(A(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),to(this),Lu(this))};function ir(h){h.A!=null&&(m.clearTimeout(h.A),h.A=null)}function Lu(h){h.g=new vn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=On(h.qa);ot(y,"RID","rpc"),ot(y,"SID",h.K),ot(y,"AID",h.T),ot(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&ot(y,"TO",h.ja),ot(y,"TYPE","xmlhttp"),ar(h,y),h.m&&h.o&&Gt(y,h.m,h.o),h.L&&(h.g.I=h.L);var E=h.g;h=h.ia,E.L=1,E.v=Wi(On(y)),E.m=null,E.P=!0,na(E,h)}n.Za=function(){this.C!=null&&(this.C=null,to(this),kl(this),yt(19))};function so(h){h.C!=null&&(m.clearTimeout(h.C),h.C=null)}function Vu(h,y){var E=null;if(h.g==y){so(h),ir(h),h.g=null;var M=2}else if(Al(h.h,y))E=y.D,yn(h.h,y),M=1;else return;if(h.G!=0){if(y.o)if(M==1){E=y.m?y.m.length:0,y=Date.now()-y.F;var K=h.B;M=Pa(),st(M,new Pt(M,E)),no(h)}else Pu(h);else if(K=y.s,K==3||K==0&&0<y.X||!(M==1&&Sf(h,y)||M==2&&kl(h)))switch(E&&0<E.length&&(y=h.h,y.i=y.i.concat(E)),K){case 1:ca(h,5);break;case 4:ca(h,10);break;case 3:ca(h,6);break;default:ca(h,2)}}}function Pl(h,y){let E=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(E*=2),E*y}function ca(h,y){if(h.j.info("Error code "+y),y==2){var E=A(h.fb,h),M=h.Xa;const K=!M;M=new Rt(M||"//www.google.com/images/cleardot.gif"),m.location&&m.location.protocol=="http"||Xi(M,"https"),Wi(M),K?Ji(M.toString(),E):hs(M.toString(),E)}else yt(2);h.G=0,h.l&&h.l.sa(y),Uu(h),Ou(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function Uu(h){if(h.G=0,h.ka=[],h.l){const y=jl(h.h);(y.length!=0||h.i.length!=0)&&(x(h.ka,y),x(h.ka,h.i),h.h.i.length=0,S(h.i),h.i.length=0),h.l.ra()}}function Fu(h,y,E){var M=E instanceof Rt?On(E):new Rt(E);if(M.g!="")y&&(M.g=y+"."+M.g),qa(M,M.s);else{var K=m.location;M=K.protocol,y=y?y+"."+K.hostname:K.hostname,K=+K.port;var te=new Rt(null);M&&Xi(te,M),y&&(te.g=y),K&&qa(te,K),E&&(te.l=E),M=te}return E=h.D,y=h.ya,E&&y&&ot(M,E,y),ot(M,"VER",h.la),ar(h,M),M}function qu(h,y,E){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new tt(new Ba({eb:E})):new tt(h.pa),y.Ha(h.J),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Bu(){}n=Bu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ao(){}ao.prototype.g=function(h,y){return new _n(h,y)};function _n(h,y){xt.call(this),this.g=new eo(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!Y(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!Y(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new ks(this)}T(_n,xt),_n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},_n.prototype.close=function(){Ml(this.g)},_n.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.u&&(E={},E.__data__=us(h),h=E);y.i.push(new Su(y.Ya++,h)),y.G==3&&no(y)},_n.prototype.N=function(){this.g.l=null,delete this.j,Ml(this.g),delete this.g,_n.aa.N.call(this)};function zu(h){ea.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const E in y){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}T(zu,ea);function Hu(){El.call(this),this.status=1}T(Hu,El);function ks(h){this.g=h}T(ks,Bu),ks.prototype.ua=function(){st(this.g,"a")},ks.prototype.ta=function(h){st(this.g,new zu(h))},ks.prototype.sa=function(h){st(this.g,new Hu)},ks.prototype.ra=function(){st(this.g,"b")},ao.prototype.createWebChannel=ao.prototype.g,_n.prototype.send=_n.prototype.o,_n.prototype.open=_n.prototype.m,_n.prototype.close=_n.prototype.close,UT=function(){return new ao},VT=function(){return Pa()},LT=js,sg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ua.NO_ERROR=0,Ua.TIMEOUT=8,Ua.HTTP_ERROR=6,ah=Ua,ta.COMPLETE="complete",PT=ta,bl.EventType=Js,Js.OPEN="a",Js.CLOSE="b",Js.ERROR="c",Js.MESSAGE="d",xt.prototype.listen=xt.prototype.K,wc=bl,tt.prototype.listenOnce=tt.prototype.L,tt.prototype.getLastError=tt.prototype.Ka,tt.prototype.getLastErrorCode=tt.prototype.Ba,tt.prototype.getStatus=tt.prototype.Z,tt.prototype.getResponseJson=tt.prototype.Oa,tt.prototype.getResponseText=tt.prototype.oa,tt.prototype.send=tt.prototype.ea,tt.prototype.setWithCredentials=tt.prototype.Ha,kT=tt}).apply(typeof $d<"u"?$d:typeof self<"u"?self:typeof window<"u"?window:{});const tN="@firebase/firestore",nN="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ol="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir=new su("@firebase/firestore");function Po(){return Ir.logLevel}function ge(n,...e){if(Ir.logLevel<=$e.DEBUG){const t=e.map(zg);Ir.debug(`Firestore (${ol}): ${n}`,...t)}}function Ra(n,...e){if(Ir.logLevel<=$e.ERROR){const t=e.map(zg);Ir.error(`Firestore (${ol}): ${n}`,...t)}}function Xo(n,...e){if(Ir.logLevel<=$e.WARN){const t=e.map(zg);Ir.warn(`Firestore (${ol}): ${n}`,...t)}}function zg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(n,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,FT(n,a,t)}function FT(n,e,t){let a=`FIRESTORE (${ol}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw Ra(a),new Error(a)}function Ze(n,e,t,a){let o="Unexpected state";typeof t=="string"?o=t:a=t,n||FT(e,o,a)}function De(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends cs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class C1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(fn.UNAUTHENTICATED))}shutdown(){}}class S1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class I1{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0,42304);let a=this.i;const o=p=>this.i!==a?(a=this.i,t(p)):Promise.resolve();let c=new $s;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new $s,e.enqueueRetryable(()=>o(this.currentUser))};const d=()=>{const p=c;e.enqueueRetryable(async()=>{await p.promise,await o(this.currentUser)})},m=p=>{ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit(p=>m(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?m(p):(ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new $s)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(a=>this.i!==e?(ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Ze(typeof a.accessToken=="string",31837,{l:a}),new qT(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new fn(e)}}class R1{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class D1{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new R1(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(fn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class sN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class M1{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Rn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ze(this.o===void 0,3512);const a=c=>{c.error!=null&&ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,ge("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>a(c))};const o=c=>{ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>o(c)),setTimeout(()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new sN(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new sN(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O1(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<n;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BT(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const o=O1(40);for(let c=0;c<o.length;++c)a.length<20&&o[c]<t&&(a+=e.charAt(o[c]%62))}return a}}function Fe(n,e){return n<e?-1:n>e?1:0}function ag(n,e){let t=0;for(;t<n.length&&t<e.length;){const a=n.codePointAt(t),o=e.codePointAt(t);if(a!==o){if(a<128&&o<128)return Fe(a,o);{const c=BT(),d=k1(c.encode(aN(n,t)),c.encode(aN(e,t)));return d!==0?d:Fe(a,o)}}t+=a>65535?2:1}return Fe(n.length,e.length)}function aN(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function k1(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Fe(n[t],e[t]);return Fe(n.length,e.length)}function Wo(n,e,t){return n.length===e.length&&n.every((a,o)=>t(a,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iN=-62135596800,rN=1e6;class qt{static now(){return qt.fromMillis(Date.now())}static fromDate(e){return qt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*rN);return new qt(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<iN)throw new me(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/rN}_compareTo(e){return this.seconds===e.seconds?Fe(this.nanoseconds,e.nanoseconds):Fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-iN;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{static fromTimestamp(e){return new Ce(e)}static min(){return new Ce(new qt(0,0))}static max(){return new Ce(new qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oN="__name__";class zs{constructor(e,t,a){t===void 0?t=0:t>e.length&&Te(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&Te(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return zs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof zs?e.forEach(a=>{t.push(a)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let o=0;o<a;o++){const c=zs.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Fe(e.length,t.length)}static compareSegments(e,t){const a=zs.isNumericId(e),o=zs.isNumericId(t);return a&&!o?-1:!a&&o?1:a&&o?zs.extractNumericId(e).compare(zs.extractNumericId(t)):ag(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _i.fromString(e.substring(4,e.length-2))}}class ft extends zs{construct(e,t,a){return new ft(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new me(re.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter(o=>o.length>0))}return new ft(t)}static emptyPath(){return new ft([])}}const P1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class an extends zs{construct(e,t,a){return new an(e,t,a)}static isValidIdentifier(e){return P1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),an.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===oN}static keyField(){return new an([oN])}static fromServerFormat(e){const t=[];let a="",o=0;const c=()=>{if(a.length===0)throw new me(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let d=!1;for(;o<e.length;){const m=e[o];if(m==="\\"){if(o+1===e.length)throw new me(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new me(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=p,o+=2}else m==="`"?(d=!d,o++):m!=="."||d?(a+=m,o++):(c(),o++)}if(c(),d)throw new me(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new an(t)}static emptyPath(){return new an([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.path=e}static fromPath(e){return new Ne(ft.fromString(e))}static fromName(e){return new Ne(ft.fromString(e).popFirst(5))}static empty(){return new Ne(ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ft.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ne(new ft(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c=-1;function L1(n,e){const t=n.toTimestamp().seconds,a=n.toTimestamp().nanoseconds+1,o=Ce.fromTimestamp(a===1e9?new qt(t+1,0):new qt(t,a));return new Ni(o,Ne.empty(),e)}function V1(n){return new Ni(n.readTime,n.key,$c)}class Ni{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new Ni(Ce.min(),Ne.empty(),$c)}static max(){return new Ni(Ce.max(),Ne.empty(),$c)}}function U1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ne.comparator(n.documentKey,e.documentKey),t!==0?t:Fe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class q1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ll(n){if(n.code!==re.FAILED_PRECONDITION||n.message!==F1)throw n;ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le((a,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(a,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(a,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):le.reject(t)}static resolve(e){return new le((t,a)=>{t(e)})}static reject(e){return new le((t,a)=>{a(e)})}static waitFor(e){return new le((t,a)=>{let o=0,c=0,d=!1;e.forEach(m=>{++o,m.next(()=>{++c,d&&c===o&&t()},p=>a(p))}),d=!0,c===o&&t()})}static or(e){let t=le.resolve(!1);for(const a of e)t=t.next(o=>o?le.resolve(o):a());return t}static forEach(e,t){const a=[];return e.forEach((o,c)=>{a.push(t.call(this,o,c))}),this.waitFor(a)}static mapArray(e,t){return new le((a,o)=>{const c=e.length,d=new Array(c);let m=0;for(let p=0;p<c;p++){const v=p;t(e[v]).next(_=>{d[v]=_,++m,m===c&&a(d)},_=>o(_))}})}static doWhile(e,t){return new le((a,o)=>{const c=()=>{e()===!0?t().next(()=>{c()},o):a()};c()})}}function B1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function cl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ue(a),this.ce=a=>t.writeSequenceNumber(a))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Gh.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg=-1;function cu(n){return n==null}function bh(n){return n===0&&1/n==-1/0}function z1(n){return typeof n=="number"&&Number.isInteger(n)&&!bh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT="";function H1(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=lN(e)),e=G1(n.get(t),e);return lN(e)}function G1(n,e){let t=e;const a=n.length;for(let o=0;o<a;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case HT:t+="";break;default:t+=c}}return t}function lN(n){return n+HT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cN(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ki(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function GT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,t){this.comparator=e,this.root=t||sn.EMPTY}insert(e,t){return new Nt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,sn.BLACK,null,null))}remove(e){return new Nt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const o=this.comparator(e,a.key);if(o===0)return t+a.left.size;o<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,a)=>(e(t,a),!1))}toString(){const e=[];return this.inorderTraversal((t,a)=>(e.push(`${t}:${a}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Yd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Yd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Yd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Yd(this.root,e,this.comparator,!0)}}class Yd{constructor(e,t,a,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?a(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sn{constructor(e,t,a,o,c){this.key=e,this.value=t,this.color=a??sn.RED,this.left=o??sn.EMPTY,this.right=c??sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,o,c){return new sn(e??this.key,t??this.value,a??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let o=this;const c=a(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,a),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,a)),o.fixUp()}removeMin(){if(this.left.isEmpty())return sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return sn.EMPTY;a=o.right.min(),o=o.copy(a.key,a.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Te(27949);return e+(this.isRed()?0:1)}}sn.EMPTY=null,sn.RED=!0,sn.BLACK=!1;sn.EMPTY=new class{constructor(){this.size=0}get key(){throw Te(57766)}get value(){throw Te(16141)}get color(){throw Te(16727)}get left(){throw Te(29726)}get right(){throw Te(36894)}copy(e,t,a,o,c){return this}insert(e,t,a){return new sn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.comparator=e,this.data=new Nt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,a)=>(e(t),!1))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const o=a.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new uN(this.data.getIterator())}getIteratorFrom(e){return new uN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(a=>{t=t.add(a)}),t}isEqual(e){if(!(e instanceof Bt)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Bt(this.comparator);return t.data=e,t}}class uN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.fields=e,e.sort(an.comparator)}static empty(){return new Bn([])}unionWith(e){let t=new Bt(an.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new Bn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Wo(this.fields,e.fields,(t,a)=>t.isEqual(a))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new $T("Invalid base64 string: "+c):c}}(e);return new ln(t)}static fromUint8Array(e){const t=function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c}(e);return new ln(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const a=new Uint8Array(t.length);for(let o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return a}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ln.EMPTY_BYTE_STRING=new ln("");const $1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xi(n){if(Ze(!!n,39018),typeof n=="string"){let e=0;const t=$1.exec(n);if(Ze(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const a=new Date(n);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:St(n.seconds),nanos:St(n.nanos)}}function St(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ti(n){return typeof n=="string"?ln.fromBase64String(n):ln.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT="server_timestamp",KT="__type__",QT="__previous_value__",XT="__local_write_time__";function Gg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[KT])===null||t===void 0?void 0:t.stringValue)===YT}function $h(n){const e=n.mapValue.fields[QT];return Gg(e)?$h(e):e}function Yc(n){const e=xi(n.mapValue.fields[XT].timestampValue);return new qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e,t,a,o,c,d,m,p,v,_){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=m,this.longPollingOptions=p,this.useFetchStreams=v,this.isUsingEmulator=_}}const Eh="(default)";class Kc{constructor(e,t){this.projectId=e,this.database=t||Eh}static empty(){return new Kc("","")}get isDefaultDatabase(){return this.database===Eh}isEqual(e){return e instanceof Kc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT="__type__",K1="__max__",Kd={mapValue:{}},ZT="__vector__",Nh="value";function Ai(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Gg(n)?4:X1(n)?9007199254740991:Q1(n)?10:11:Te(28295,{value:n})}function Ks(n,e){if(n===e)return!0;const t=Ai(n);if(t!==Ai(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Yc(n).isEqual(Yc(e));case 3:return function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=xi(o.timestampValue),m=xi(c.timestampValue);return d.seconds===m.seconds&&d.nanos===m.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,c){return Ti(o.bytesValue).isEqual(Ti(c.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,c){return St(o.geoPointValue.latitude)===St(c.geoPointValue.latitude)&&St(o.geoPointValue.longitude)===St(c.geoPointValue.longitude)}(n,e);case 2:return function(o,c){if("integerValue"in o&&"integerValue"in c)return St(o.integerValue)===St(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=St(o.doubleValue),m=St(c.doubleValue);return d===m?bh(d)===bh(m):isNaN(d)&&isNaN(m)}return!1}(n,e);case 9:return Wo(n.arrayValue.values||[],e.arrayValue.values||[],Ks);case 10:case 11:return function(o,c){const d=o.mapValue.fields||{},m=c.mapValue.fields||{};if(cN(d)!==cN(m))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(m[p]===void 0||!Ks(d[p],m[p])))return!1;return!0}(n,e);default:return Te(52216,{left:n})}}function Qc(n,e){return(n.values||[]).find(t=>Ks(t,e))!==void 0}function Zo(n,e){if(n===e)return 0;const t=Ai(n),a=Ai(e);if(t!==a)return Fe(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return Fe(n.booleanValue,e.booleanValue);case 2:return function(c,d){const m=St(c.integerValue||c.doubleValue),p=St(d.integerValue||d.doubleValue);return m<p?-1:m>p?1:m===p?0:isNaN(m)?isNaN(p)?0:-1:1}(n,e);case 3:return dN(n.timestampValue,e.timestampValue);case 4:return dN(Yc(n),Yc(e));case 5:return ag(n.stringValue,e.stringValue);case 6:return function(c,d){const m=Ti(c),p=Ti(d);return m.compareTo(p)}(n.bytesValue,e.bytesValue);case 7:return function(c,d){const m=c.split("/"),p=d.split("/");for(let v=0;v<m.length&&v<p.length;v++){const _=Fe(m[v],p[v]);if(_!==0)return _}return Fe(m.length,p.length)}(n.referenceValue,e.referenceValue);case 8:return function(c,d){const m=Fe(St(c.latitude),St(d.latitude));return m!==0?m:Fe(St(c.longitude),St(d.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return hN(n.arrayValue,e.arrayValue);case 10:return function(c,d){var m,p,v,_;const b=c.fields||{},A=d.fields||{},j=(m=b[Nh])===null||m===void 0?void 0:m.arrayValue,T=(p=A[Nh])===null||p===void 0?void 0:p.arrayValue,S=Fe(((v=j?.values)===null||v===void 0?void 0:v.length)||0,((_=T?.values)===null||_===void 0?void 0:_.length)||0);return S!==0?S:hN(j,T)}(n.mapValue,e.mapValue);case 11:return function(c,d){if(c===Kd.mapValue&&d===Kd.mapValue)return 0;if(c===Kd.mapValue)return 1;if(d===Kd.mapValue)return-1;const m=c.fields||{},p=Object.keys(m),v=d.fields||{},_=Object.keys(v);p.sort(),_.sort();for(let b=0;b<p.length&&b<_.length;++b){const A=ag(p[b],_[b]);if(A!==0)return A;const j=Zo(m[p[b]],v[_[b]]);if(j!==0)return j}return Fe(p.length,_.length)}(n.mapValue,e.mapValue);default:throw Te(23264,{Pe:t})}}function dN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Fe(n,e);const t=xi(n),a=xi(e),o=Fe(t.seconds,a.seconds);return o!==0?o:Fe(t.nanos,a.nanos)}function hN(n,e){const t=n.values||[],a=e.values||[];for(let o=0;o<t.length&&o<a.length;++o){const c=Zo(t[o],a[o]);if(c)return c}return Fe(t.length,a.length)}function Jo(n){return ig(n)}function ig(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const a=xi(t);return`time(${a.seconds},${a.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ti(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ne.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let a="[",o=!0;for(const c of t.values||[])o?o=!1:a+=",",a+=ig(c);return a+"]"}(n.arrayValue):"mapValue"in n?function(t){const a=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of a)c?c=!1:o+=",",o+=`${d}:${ig(t.fields[d])}`;return o+"}"}(n.mapValue):Te(61005,{value:n})}function ih(n){switch(Ai(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$h(n);return e?16+ih(e):16;case 5:return 2*n.stringValue.length;case 6:return Ti(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(a){return(a.values||[]).reduce((o,c)=>o+ih(c),0)}(n.arrayValue);case 10:case 11:return function(a){let o=0;return ki(a.fields,(c,d)=>{o+=c.length+ih(d)}),o}(n.mapValue);default:throw Te(13486,{value:n})}}function fN(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function rg(n){return!!n&&"integerValue"in n}function $g(n){return!!n&&"arrayValue"in n}function mN(n){return!!n&&"nullValue"in n}function pN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function rh(n){return!!n&&"mapValue"in n}function Q1(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[WT])===null||t===void 0?void 0:t.stringValue)===ZT}function Mc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ki(n.mapValue.fields,(t,a)=>e.mapValue.fields[t]=Mc(a)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Mc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function X1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===K1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.value=e}static empty(){return new xn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!rh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mc(t)}setAll(e){let t=an.emptyPath(),a={},o=[];e.forEach((d,m)=>{if(!t.isImmediateParentOf(m)){const p=this.getFieldsMap(t);this.applyChanges(p,a,o),a={},o=[],t=m.popLast()}d?a[m.lastSegment()]=Mc(d):o.push(m.lastSegment())});const c=this.getFieldsMap(t);this.applyChanges(c,a,o)}delete(e){const t=this.field(e.popLast());rh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ks(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let o=t.mapValue.fields[e.get(a)];rh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,a){ki(t,(o,c)=>e[o]=c);for(const o of a)delete e[o]}clone(){return new xn(Mc(this.value))}}function JT(n){const e=[];return ki(n.fields,(t,a)=>{const o=new an([t]);if(rh(a)){const c=JT(a.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)}),new Bn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,t,a,o,c,d,m){this.key=e,this.documentType=t,this.version=a,this.readTime=o,this.createTime=c,this.data=d,this.documentState=m}static newInvalidDocument(e){return new Wt(e,0,Ce.min(),Ce.min(),Ce.min(),xn.empty(),0)}static newFoundDocument(e,t,a,o){return new Wt(e,1,t,Ce.min(),a,o,0)}static newNoDocument(e,t){return new Wt(e,2,t,Ce.min(),Ce.min(),xn.empty(),0)}static newUnknownDocument(e,t){return new Wt(e,3,t,Ce.min(),Ce.min(),xn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,t){this.position=e,this.inclusive=t}}function gN(n,e,t){let a=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?a=Ne.comparator(Ne.fromName(d.referenceValue),t.key):a=Zo(d,t.data.field(c.field)),c.dir==="desc"&&(a*=-1),a!==0)break}return a}function vN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ks(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,t="asc"){this.field=e,this.dir=t}}function W1(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{}class kt extends e0{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new J1(e,t,a):t==="array-contains"?new nD(e,a):t==="in"?new sD(e,a):t==="not-in"?new aD(e,a):t==="array-contains-any"?new iD(e,a):new kt(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new eD(e,a):new tD(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Zo(t,this.value)):t!==null&&Ai(this.value)===Ai(t)&&this.matchesComparison(Zo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ns extends e0{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Ns(e,t)}matches(e){return t0(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function t0(n){return n.op==="and"}function n0(n){return Z1(n)&&t0(n)}function Z1(n){for(const e of n.filters)if(e instanceof Ns)return!1;return!0}function og(n){if(n instanceof kt)return n.field.canonicalString()+n.op.toString()+Jo(n.value);if(n0(n))return n.filters.map(e=>og(e)).join(",");{const e=n.filters.map(t=>og(t)).join(",");return`${n.op}(${e})`}}function s0(n,e){return n instanceof kt?function(a,o){return o instanceof kt&&a.op===o.op&&a.field.isEqual(o.field)&&Ks(a.value,o.value)}(n,e):n instanceof Ns?function(a,o){return o instanceof Ns&&a.op===o.op&&a.filters.length===o.filters.length?a.filters.reduce((c,d,m)=>c&&s0(d,o.filters[m]),!0):!1}(n,e):void Te(19439)}function a0(n){return n instanceof kt?function(t){return`${t.field.canonicalString()} ${t.op} ${Jo(t.value)}`}(n):n instanceof Ns?function(t){return t.op.toString()+" {"+t.getFilters().map(a0).join(" ,")+"}"}(n):"Filter"}class J1 extends kt{constructor(e,t,a){super(e,t,a),this.key=Ne.fromName(a.referenceValue)}matches(e){const t=Ne.comparator(e.key,this.key);return this.matchesComparison(t)}}class eD extends kt{constructor(e,t){super(e,"in",t),this.keys=i0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class tD extends kt{constructor(e,t){super(e,"not-in",t),this.keys=i0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function i0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(a=>Ne.fromName(a.referenceValue))}class nD extends kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return $g(t)&&Qc(t.arrayValue,this.value)}}class sD extends kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Qc(this.value.arrayValue,t)}}class aD extends kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Qc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Qc(this.value.arrayValue,t)}}class iD extends kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!$g(t)||!t.arrayValue.values)&&t.arrayValue.values.some(a=>Qc(this.value.arrayValue,a))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e,t=null,a=[],o=[],c=null,d=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=o,this.limit=c,this.startAt=d,this.endAt=m,this.Ie=null}}function yN(n,e=null,t=[],a=[],o=null,c=null,d=null){return new rD(n,e,t,a,o,c,d)}function Yg(n){const e=De(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(a=>og(a)).join(","),t+="|ob:",t+=e.orderBy.map(a=>function(c){return c.field.canonicalString()+c.dir}(a)).join(","),cu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(a=>Jo(a)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(a=>Jo(a)).join(",")),e.Ie=t}return e.Ie}function Kg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!W1(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!s0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!vN(n.startAt,e.startAt)&&vN(n.endAt,e.endAt)}function lg(n){return Ne.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,t=null,a=[],o=[],c=null,d="F",m=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=o,this.limit=c,this.limitType=d,this.startAt=m,this.endAt=p,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function oD(n,e,t,a,o,c,d,m){return new ul(n,e,t,a,o,c,d,m)}function Yh(n){return new ul(n)}function _N(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function r0(n){return n.collectionGroup!==null}function Oc(n){const e=De(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ee.push(c),t.add(c.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let m=new Bt(an.comparator);return d.filters.forEach(p=>{p.getFlattenedFilters().forEach(v=>{v.isInequality()&&(m=m.add(v.field))})}),m})(e).forEach(c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ee.push(new Xc(c,a))}),t.has(an.keyField().canonicalString())||e.Ee.push(new Xc(an.keyField(),a))}return e.Ee}function Ys(n){const e=De(n);return e.de||(e.de=lD(e,Oc(n))),e.de}function lD(n,e){if(n.limitType==="F")return yN(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const c=o.dir==="desc"?"asc":"desc";return new Xc(o.field,c)});const t=n.endAt?new xh(n.endAt.position,n.endAt.inclusive):null,a=n.startAt?new xh(n.startAt.position,n.startAt.inclusive):null;return yN(n.path,n.collectionGroup,e,n.filters,n.limit,t,a)}}function cg(n,e){const t=n.filters.concat([e]);return new ul(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Th(n,e,t){return new ul(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Kh(n,e){return Kg(Ys(n),Ys(e))&&n.limitType===e.limitType}function o0(n){return`${Yg(Ys(n))}|lt:${n.limitType}`}function Lo(n){return`Query(target=${function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map(o=>a0(o)).join(", ")}]`),cu(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map(o=>function(d){return`${d.field.canonicalString()} (${d.dir})`}(o)).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map(o=>Jo(o)).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map(o=>Jo(o)).join(",")),`Target(${a})`}(Ys(n))}; limitType=${n.limitType})`}function Qh(n,e){return e.isFoundDocument()&&function(a,o){const c=o.key.path;return a.collectionGroup!==null?o.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):Ne.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)}(n,e)&&function(a,o){for(const c of Oc(a))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0}(n,e)&&function(a,o){for(const c of a.filters)if(!c.matches(o))return!1;return!0}(n,e)&&function(a,o){return!(a.startAt&&!function(d,m,p){const v=gN(d,m,p);return d.inclusive?v<=0:v<0}(a.startAt,Oc(a),o)||a.endAt&&!function(d,m,p){const v=gN(d,m,p);return d.inclusive?v>=0:v>0}(a.endAt,Oc(a),o))}(n,e)}function cD(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function l0(n){return(e,t)=>{let a=!1;for(const o of Oc(n)){const c=uD(o,e,t);if(c!==0)return c;a=a||o.field.isKeyField()}return 0}}function uD(n,e,t){const a=n.field.isKeyField()?Ne.comparator(e.key,t.key):function(c,d,m){const p=d.data.field(c),v=m.data.field(c);return p!==null&&v!==null?Zo(p,v):Te(42886)}(n.field,e,t);switch(n.dir){case"asc":return a;case"desc":return-1*a;default:return Te(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[o,c]of a)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),o=this.inner[a];if(o===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return a.length===1?delete this.inner[t]:a.splice(o,1),this.innerSize--,!0;return!1}forEach(e){ki(this.inner,(t,a)=>{for(const[o,c]of a)e(o,c)})}isEmpty(){return GT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dD=new Nt(Ne.comparator);function Da(){return dD}const c0=new Nt(Ne.comparator);function Cc(...n){let e=c0;for(const t of n)e=e.insert(t.key,t);return e}function u0(n){let e=c0;return n.forEach((t,a)=>e=e.insert(t,a.overlayedDocument)),e}function Tr(){return kc()}function d0(){return kc()}function kc(){return new Lr(n=>n.toString(),(n,e)=>n.isEqual(e))}const hD=new Nt(Ne.comparator),fD=new Bt(Ne.comparator);function Ye(...n){let e=fD;for(const t of n)e=e.add(t);return e}const mD=new Bt(Fe);function pD(){return mD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bh(e)?"-0":e}}function h0(n){return{integerValue:""+n}}function gD(n,e){return z1(e)?h0(e):Qg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(){this._=void 0}}function vD(n,e,t){return n instanceof Wc?function(o,c){const d={fields:{[KT]:{stringValue:YT},[XT]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Gg(c)&&(c=$h(c)),c&&(d.fields[QT]=c),{mapValue:d}}(t,e):n instanceof Zc?m0(n,e):n instanceof Jc?p0(n,e):function(o,c){const d=f0(o,c),m=bN(d)+bN(o.Re);return rg(d)&&rg(o.Re)?h0(m):Qg(o.serializer,m)}(n,e)}function yD(n,e,t){return n instanceof Zc?m0(n,e):n instanceof Jc?p0(n,e):t}function f0(n,e){return n instanceof Ah?function(a){return rg(a)||function(c){return!!c&&"doubleValue"in c}(a)}(e)?e:{integerValue:0}:null}class Wc extends Xh{}class Zc extends Xh{constructor(e){super(),this.elements=e}}function m0(n,e){const t=g0(e);for(const a of n.elements)t.some(o=>Ks(o,a))||t.push(a);return{arrayValue:{values:t}}}class Jc extends Xh{constructor(e){super(),this.elements=e}}function p0(n,e){let t=g0(e);for(const a of n.elements)t=t.filter(o=>!Ks(o,a));return{arrayValue:{values:t}}}class Ah extends Xh{constructor(e,t){super(),this.serializer=e,this.Re=t}}function bN(n){return St(n.integerValue||n.doubleValue)}function g0(n){return $g(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e,t){this.field=e,this.transform=t}}function bD(n,e){return n.field.isEqual(e.field)&&function(a,o){return a instanceof Zc&&o instanceof Zc||a instanceof Jc&&o instanceof Jc?Wo(a.elements,o.elements,Ks):a instanceof Ah&&o instanceof Ah?Ks(a.Re,o.Re):a instanceof Wc&&o instanceof Wc}(n.transform,e.transform)}class ED{constructor(e,t){this.version=e,this.transformResults=t}}class rn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function oh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Wh{}function v0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Zh(n.key,rn.none()):new uu(n.key,n.data,rn.none());{const t=n.data,a=xn.empty();let o=new Bt(an.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?a.delete(c):a.set(c,d),o=o.add(c)}return new Pi(n.key,a,new Bn(o.toArray()),rn.none())}}function ND(n,e,t){n instanceof uu?function(o,c,d){const m=o.value.clone(),p=NN(o.fieldTransforms,c,d.transformResults);m.setAll(p),c.convertToFoundDocument(d.version,m).setHasCommittedMutations()}(n,e,t):n instanceof Pi?function(o,c,d){if(!oh(o.precondition,c))return void c.convertToUnknownDocument(d.version);const m=NN(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(y0(o)),p.setAll(m),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()}(n,e,t):function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()}(0,e,t)}function Pc(n,e,t,a){return n instanceof uu?function(c,d,m,p){if(!oh(c.precondition,d))return m;const v=c.value.clone(),_=xN(c.fieldTransforms,p,d);return v.setAll(_),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null}(n,e,t,a):n instanceof Pi?function(c,d,m,p){if(!oh(c.precondition,d))return m;const v=xN(c.fieldTransforms,p,d),_=d.data;return _.setAll(y0(c)),_.setAll(v),d.convertToFoundDocument(d.version,_).setHasLocalMutations(),m===null?null:m.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(b=>b.field))}(n,e,t,a):function(c,d,m){return oh(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):m}(n,e,t)}function xD(n,e){let t=null;for(const a of n.fieldTransforms){const o=e.data.field(a.field),c=f0(a.transform,o||null);c!=null&&(t===null&&(t=xn.empty()),t.set(a.field,c))}return t||null}function EN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(a,o){return a===void 0&&o===void 0||!(!a||!o)&&Wo(a,o,(c,d)=>bD(c,d))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class uu extends Wh{constructor(e,t,a,o=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Pi extends Wh{constructor(e,t,a,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function y0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const a=n.data.field(t);e.set(t,a)}}),e}function NN(n,e,t){const a=new Map;Ze(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,m=e.data.field(c.field);a.set(c.field,yD(d,m,t[o]))}return a}function xN(n,e,t){const a=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);a.set(o.field,vD(c,d,e))}return a}class Zh extends Wh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _0 extends Wh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e,t,a,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=o}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&ND(c,e,a[o])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=Pc(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=Pc(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=d0();return this.mutations.forEach(o=>{const c=e.get(o.key),d=c.overlayedDocument;let m=this.applyToLocalView(d,c.mutatedFields);m=t.has(o.key)?null:m;const p=v0(d,m);p!==null&&a.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(Ce.min())}),a}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ye())}isEqual(e){return this.batchId===e.batchId&&Wo(this.mutations,e.mutations,(t,a)=>EN(t,a))&&Wo(this.baseMutations,e.baseMutations,(t,a)=>EN(t,a))}}class Xg{constructor(e,t,a,o){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=o}static from(e,t,a){Ze(e.mutations.length===a.length,58842,{fe:e.mutations.length,ge:a.length});let o=function(){return hD}();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,a[d].version);return new Xg(e,t,a,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot,We;function b0(n){switch(n){case re.OK:return Te(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return Te(15467,{code:n})}}function E0(n){if(n===void 0)return Ra("GRPC error has no .code"),re.UNKNOWN;switch(n){case Ot.OK:return re.OK;case Ot.CANCELLED:return re.CANCELLED;case Ot.UNKNOWN:return re.UNKNOWN;case Ot.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case Ot.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case Ot.INTERNAL:return re.INTERNAL;case Ot.UNAVAILABLE:return re.UNAVAILABLE;case Ot.UNAUTHENTICATED:return re.UNAUTHENTICATED;case Ot.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case Ot.NOT_FOUND:return re.NOT_FOUND;case Ot.ALREADY_EXISTS:return re.ALREADY_EXISTS;case Ot.PERMISSION_DENIED:return re.PERMISSION_DENIED;case Ot.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case Ot.ABORTED:return re.ABORTED;case Ot.OUT_OF_RANGE:return re.OUT_OF_RANGE;case Ot.UNIMPLEMENTED:return re.UNIMPLEMENTED;case Ot.DATA_LOSS:return re.DATA_LOSS;default:return Te(39323,{code:n})}}(We=Ot||(Ot={}))[We.OK=0]="OK",We[We.CANCELLED=1]="CANCELLED",We[We.UNKNOWN=2]="UNKNOWN",We[We.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",We[We.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",We[We.NOT_FOUND=5]="NOT_FOUND",We[We.ALREADY_EXISTS=6]="ALREADY_EXISTS",We[We.PERMISSION_DENIED=7]="PERMISSION_DENIED",We[We.UNAUTHENTICATED=16]="UNAUTHENTICATED",We[We.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",We[We.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",We[We.ABORTED=10]="ABORTED",We[We.OUT_OF_RANGE=11]="OUT_OF_RANGE",We[We.UNIMPLEMENTED=12]="UNIMPLEMENTED",We[We.INTERNAL=13]="INTERNAL",We[We.UNAVAILABLE=14]="UNAVAILABLE",We[We.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD=new _i([4294967295,4294967295],0);function TN(n){const e=BT().encode(n),t=new OT;return t.update(e),new Uint8Array(t.digest())}function AN(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new _i([t,a],0),new _i([o,c],0)]}class Wg{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new Sc(`Invalid padding: ${t}`);if(a<0)throw new Sc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new Sc(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new Sc(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=_i.fromNumber(this.pe)}we(e,t,a){let o=e.add(t.multiply(_i.fromNumber(a)));return o.compare(wD)===1&&(o=new _i([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=TN(e),[a,o]=AN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);if(!this.be(d))return!1}return!0}static create(e,t,a){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new Wg(c,o,t);return a.forEach(m=>d.insert(m)),d}insert(e){if(this.pe===0)return;const t=TN(e),[a,o]=AN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);this.Se(d)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class Sc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,t,a,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const o=new Map;return o.set(e,du.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new Jh(Ce.min(),o,new Nt(Fe),Da(),Ye())}}class du{constructor(e,t,a,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new du(a,t,Ye(),Ye(),Ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,t,a,o){this.De=e,this.removedTargetIds=t,this.key=a,this.ve=o}}class N0{constructor(e,t){this.targetId=e,this.Ce=t}}class x0{constructor(e,t,a=ln.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=o}}class jN{constructor(){this.Fe=0,this.Me=wN(),this.xe=ln.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Ye(),t=Ye(),a=Ye();return this.Me.forEach((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:a=a.add(o);break;default:Te(38017,{changeType:c})}}),new du(this.xe,this.Oe,e,t,a)}Qe(){this.Ne=!1,this.Me=wN()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Ze(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class CD{constructor(e){this.ze=e,this.je=new Map,this.He=Da(),this.Je=Qd(),this.Ye=Qd(),this.Ze=new Nt(Fe)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const a=this.rt(t);switch(e.state){case 0:this.it(t)&&a.ke(e.resumeToken);break;case 1:a.We(),a.Be||a.Qe(),a.ke(e.resumeToken);break;case 2:a.We(),a.Be||this.removeTarget(t);break;case 3:this.it(t)&&(a.Ge(),a.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),a.ke(e.resumeToken));break;default:Te(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((a,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,a=e.Ce.count,o=this._t(t);if(o){const c=o.target;if(lg(c))if(a===0){const d=new Ne(c.path);this.tt(t,d,Wt.newNoDocument(d,Ce.min()))}else Ze(a===1,20013,{expectedCount:a});else{const d=this.ut(t);if(d!==a){const m=this.ct(e),p=m?this.lt(m,e,d):1;if(p!==0){this.st(t);const v=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,v)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:o=0},hashCount:c=0}=t;let d,m;try{d=Ti(a).toUint8Array()}catch(p){if(p instanceof $T)return Xo("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{m=new Wg(d,o,c)}catch(p){return Xo(p instanceof Sc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return m.pe===0?null:m}lt(e,t,a){return t.Ce.count===a-this.Tt(e,t.targetId)?0:2}Tt(e,t){const a=this.ze.getRemoteKeysForTarget(t);let o=0;return a.forEach(c=>{const d=this.ze.Pt(),m=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(m)||(this.tt(t,c,null),o++)}),o}It(e){const t=new Map;this.je.forEach((c,d)=>{const m=this._t(d);if(m){if(c.current&&lg(m.target)){const p=new Ne(m.target.path);this.Et(p).has(d)||this.dt(d,p)||this.tt(d,p,Wt.newNoDocument(p,e))}c.Le&&(t.set(d,c.qe()),c.Qe())}});let a=Ye();this.Ye.forEach((c,d)=>{let m=!0;d.forEachWhile(p=>{const v=this._t(p);return!v||v.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)}),m&&(a=a.add(c))}),this.He.forEach((c,d)=>d.setReadTime(e));const o=new Jh(e,t,this.Ze,this.He,a);return this.He=Da(),this.Je=Qd(),this.Ye=Qd(),this.Ze=new Nt(Fe),o}et(e,t){if(!this.it(e))return;const a=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,a),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,a){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),a&&(this.He=this.He.insert(t,a))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new jN,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Bt(Fe),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Bt(Fe),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||ge("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new jN),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Qd(){return new Nt(Ne.comparator)}function wN(){return new Nt(Ne.comparator)}const SD={asc:"ASCENDING",desc:"DESCENDING"},ID={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},RD={and:"AND",or:"OR"};class DD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ug(n,e){return n.useProto3Json||cu(e)?e:{value:e}}function jh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function T0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function MD(n,e){return jh(n,e.toTimestamp())}function Hn(n){return Ze(!!n,49232),Ce.fromTimestamp(function(t){const a=xi(t);return new qt(a.seconds,a.nanos)}(n))}function Zg(n,e){return dg(n,e).canonicalString()}function dg(n,e){const t=function(o){return new ft(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function A0(n){const e=ft.fromString(n);return Ze(R0(e),10190,{key:e.toString()}),e}function wh(n,e){return Zg(n.databaseId,e.path)}function Lc(n,e){const t=A0(e);if(t.get(1)!==n.databaseId.projectId)throw new me(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ne(w0(t))}function j0(n,e){return Zg(n.databaseId,e)}function OD(n){const e=A0(n);return e.length===4?ft.emptyPath():w0(e)}function hg(n){return new ft(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function w0(n){return Ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function CN(n,e,t){return{name:wh(n,e),fields:t.value.mapValue.fields}}function kD(n,e){return"found"in e?function(a,o){Ze(!!o.found,43571),o.found.name,o.found.updateTime;const c=Lc(a,o.found.name),d=Hn(o.found.updateTime),m=o.found.createTime?Hn(o.found.createTime):Ce.min(),p=new xn({mapValue:{fields:o.found.fields}});return Wt.newFoundDocument(c,d,m,p)}(n,e):"missing"in e?function(a,o){Ze(!!o.missing,3894),Ze(!!o.readTime,22933);const c=Lc(a,o.missing),d=Hn(o.readTime);return Wt.newNoDocument(c,d)}(n,e):Te(7234,{result:e})}function PD(n,e){let t;if("targetChange"in e){e.targetChange;const a=function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:Te(39313,{state:v})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=function(v,_){return v.useProto3Json?(Ze(_===void 0||typeof _=="string",58123),ln.fromBase64String(_||"")):(Ze(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),ln.fromUint8Array(_||new Uint8Array))}(n,e.targetChange.resumeToken),d=e.targetChange.cause,m=d&&function(v){const _=v.code===void 0?re.UNKNOWN:E0(v.code);return new me(_,v.message||"")}(d);t=new x0(a,o,c,m||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const o=Lc(n,a.document.name),c=Hn(a.document.updateTime),d=a.document.createTime?Hn(a.document.createTime):Ce.min(),m=new xn({mapValue:{fields:a.document.fields}}),p=Wt.newFoundDocument(o,c,d,m),v=a.targetIds||[],_=a.removedTargetIds||[];t=new lh(v,_,p.key,p)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const o=Lc(n,a.document),c=a.readTime?Hn(a.readTime):Ce.min(),d=Wt.newNoDocument(o,c),m=a.removedTargetIds||[];t=new lh([],m,d.key,d)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const o=Lc(n,a.document),c=a.removedTargetIds||[];t=new lh([],c,o,null)}else{if(!("filter"in e))return Te(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:o=0,unchangedNames:c}=a,d=new jD(o,c),m=a.targetId;t=new N0(m,d)}}return t}function C0(n,e){let t;if(e instanceof uu)t={update:CN(n,e.key,e.value)};else if(e instanceof Zh)t={delete:wh(n,e.key)};else if(e instanceof Pi)t={update:CN(n,e.key,e.data),updateMask:GD(e.fieldMask)};else{if(!(e instanceof _0))return Te(16599,{ft:e.type});t={verify:wh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(a=>function(c,d){const m=d.transform;if(m instanceof Wc)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Zc)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Jc)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof Ah)return{fieldPath:d.field.canonicalString(),increment:m.Re};throw Te(20930,{transform:d.transform})}(0,a))),e.precondition.isNone||(t.currentDocument=function(o,c){return c.updateTime!==void 0?{updateTime:MD(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:Te(27497)}(n,e.precondition)),t}function LD(n,e){return n&&n.length>0?(Ze(e!==void 0,14353),n.map(t=>function(o,c){let d=o.updateTime?Hn(o.updateTime):Hn(c);return d.isEqual(Ce.min())&&(d=Hn(c)),new ED(d,o.transformResults||[])}(t,e))):[]}function VD(n,e){return{documents:[j0(n,e.path)]}}function UD(n,e){const t={structuredQuery:{}},a=e.path;let o;e.collectionGroup!==null?(o=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=j0(n,o);const c=function(v){if(v.length!==0)return I0(Ns.create(v,"and"))}(e.filters);c&&(t.structuredQuery.where=c);const d=function(v){if(v.length!==0)return v.map(_=>function(A){return{field:Vo(A.field),direction:BD(A.dir)}}(_))}(e.orderBy);d&&(t.structuredQuery.orderBy=d);const m=ug(n,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=function(v){return{before:v.inclusive,values:v.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(v){return{before:!v.inclusive,values:v.position}}(e.endAt)),{gt:t,parent:o}}function FD(n){let e=OD(n.parent);const t=n.structuredQuery,a=t.from?t.from.length:0;let o=null;if(a>0){Ze(a===1,65062);const _=t.from[0];_.allDescendants?o=_.collectionId:e=e.child(_.collectionId)}let c=[];t.where&&(c=function(b){const A=S0(b);return A instanceof Ns&&n0(A)?A.getFilters():[A]}(t.where));let d=[];t.orderBy&&(d=function(b){return b.map(A=>function(T){return new Xc(Uo(T.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(A))}(t.orderBy));let m=null;t.limit&&(m=function(b){let A;return A=typeof b=="object"?b.value:b,cu(A)?null:A}(t.limit));let p=null;t.startAt&&(p=function(b){const A=!!b.before,j=b.values||[];return new xh(j,A)}(t.startAt));let v=null;return t.endAt&&(v=function(b){const A=!b.before,j=b.values||[];return new xh(j,A)}(t.endAt)),oD(e,o,d,c,m,"F",p,v)}function qD(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Te(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function S0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=Uo(t.unaryFilter.field);return kt.create(a,"==",{doubleValue:NaN});case"IS_NULL":const o=Uo(t.unaryFilter.field);return kt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Uo(t.unaryFilter.field);return kt.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Uo(t.unaryFilter.field);return kt.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Te(61313);default:return Te(60726)}}(n):n.fieldFilter!==void 0?function(t){return kt.create(Uo(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Te(58110);default:return Te(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ns.create(t.compositeFilter.filters.map(a=>S0(a)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Te(1026)}}(t.compositeFilter.op))}(n):Te(30097,{filter:n})}function BD(n){return SD[n]}function zD(n){return ID[n]}function HD(n){return RD[n]}function Vo(n){return{fieldPath:n.canonicalString()}}function Uo(n){return an.fromServerFormat(n.fieldPath)}function I0(n){return n instanceof kt?function(t){if(t.op==="=="){if(pN(t.value))return{unaryFilter:{field:Vo(t.field),op:"IS_NAN"}};if(mN(t.value))return{unaryFilter:{field:Vo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(pN(t.value))return{unaryFilter:{field:Vo(t.field),op:"IS_NOT_NAN"}};if(mN(t.value))return{unaryFilter:{field:Vo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vo(t.field),op:zD(t.op),value:t.value}}}(n):n instanceof Ns?function(t){const a=t.getFilters().map(o=>I0(o));return a.length===1?a[0]:{compositeFilter:{op:HD(t.op),filters:a}}}(n):Te(54877,{filter:n})}function GD(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function R0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,t,a,o,c=Ce.min(),d=Ce.min(),m=ln.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=m,this.expectedCount=p}withSequenceNumber(e){return new gi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e){this.wt=e}}function YD(n){const e=FD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Th(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(){this.Cn=new QD}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(Ni.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(Ni.min())}updateCollectionGroup(e,t,a){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class QD{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t]||new Bt(ft.comparator),c=!o.has(a);return this.index[t]=o.add(a),c}has(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t];return o&&o.has(a)}getEntries(e){return(this.index[e]||new Bt(ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},D0=41943040;class In{static withCacheSize(e){return new In(e,In.DEFAULT_COLLECTION_PERCENTILE,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */In.DEFAULT_COLLECTION_PERCENTILE=10,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,In.DEFAULT=new In(D0,In.DEFAULT_COLLECTION_PERCENTILE,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),In.DISABLED=new In(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new el(0)}static lr(){return new el(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IN="LruGarbageCollector",XD=1048576;function RN([n,e],[t,a]){const o=Fe(n,t);return o===0?Fe(e,a):o}class WD{constructor(e){this.Er=e,this.buffer=new Bt(RN),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();RN(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ZD{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){ge(IN,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){cl(t)?ge(IN,"Ignoring IndexedDB error during garbage collection: ",t):await ll(t)}await this.mr(3e5)})}}class JD{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(a=>Math.floor(t/100*a))}nthSequenceNumber(e,t){if(t===0)return le.resolve(Gh.le);const a=new WD(t);return this.gr.forEachTarget(e,o=>a.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>a.Rr(o))).next(()=>a.maxValue)}removeTargets(e,t,a){return this.gr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ge("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(SN)):this.getCacheSize(e).next(a=>a<this.params.cacheSizeCollectionThreshold?(ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),SN):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let a,o,c,d,m,p,v;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(b=>(b>this.params.maximumSequenceNumbersToCollect?(ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),o=this.params.maximumSequenceNumbersToCollect):o=b,d=Date.now(),this.nthSequenceNumber(e,o))).next(b=>(a=b,m=Date.now(),this.removeTargets(e,a,t))).next(b=>(c=b,p=Date.now(),this.removeOrphanedDocuments(e,a))).next(b=>(v=Date.now(),Po()<=$e.DEBUG&&ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-_}ms
	Determined least recently used ${o} in `+(m-d)+`ms
	Removed ${c} targets in `+(p-m)+`ms
	Removed ${b} documents in `+(v-p)+`ms
Total Duration: ${v-_}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:b})))}}function eM(n,e){return new JD(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(){this.changes=new Lr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Wt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?le.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(e,t,a,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=o}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(a=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(a!==null&&Pc(a.mutation,o,Bn.empty(),qt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.getLocalViewOfDocuments(e,a,Ye()).next(()=>a))}getLocalViewOfDocuments(e,t,a=Ye()){const o=Tr();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,a).next(c=>{let d=Cc();return c.forEach((m,p)=>{d=d.insert(m,p.overlayedDocument)}),d}))}getOverlayedDocuments(e,t){const a=Tr();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,Ye()))}populateOverlays(e,t,a){const o=[];return a.forEach(c=>{t.has(c)||o.push(c)}),this.documentOverlayCache.getOverlays(e,o).next(c=>{c.forEach((d,m)=>{t.set(d,m)})})}computeViews(e,t,a,o){let c=Da();const d=kc(),m=function(){return kc()}();return t.forEach((p,v)=>{const _=a.get(v.key);o.has(v.key)&&(_===void 0||_.mutation instanceof Pi)?c=c.insert(v.key,v):_!==void 0?(d.set(v.key,_.mutation.getFieldMask()),Pc(_.mutation,v,_.mutation.getFieldMask(),qt.now())):d.set(v.key,Bn.empty())}),this.recalculateAndSaveOverlays(e,c).next(p=>(p.forEach((v,_)=>d.set(v,_)),t.forEach((v,_)=>{var b;return m.set(v,new nM(_,(b=d.get(v))!==null&&b!==void 0?b:null))}),m))}recalculateAndSaveOverlays(e,t){const a=kc();let o=new Nt((d,m)=>d-m),c=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(d=>{for(const m of d)m.keys().forEach(p=>{const v=t.get(p);if(v===null)return;let _=a.get(p)||Bn.empty();_=m.applyToLocalView(v,_),a.set(p,_);const b=(o.get(m.batchId)||Ye()).add(p);o=o.insert(m.batchId,b)})}).next(()=>{const d=[],m=o.getReverseIterator();for(;m.hasNext();){const p=m.getNext(),v=p.key,_=p.value,b=d0();_.forEach(A=>{if(!c.has(A)){const j=v0(t.get(A),a.get(A));j!==null&&b.set(A,j),c=c.add(A)}}),d.push(this.documentOverlayCache.saveOverlays(e,v,b))}return le.waitFor(d)}).next(()=>a)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.recalculateAndSaveOverlays(e,a))}getDocumentsMatchingQuery(e,t,a,o){return function(d){return Ne.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):r0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,o):this.getDocumentsMatchingCollectionQuery(e,t,a,o)}getNextDocuments(e,t,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,o).next(c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,o-c.size):le.resolve(Tr());let m=$c,p=c;return d.next(v=>le.forEach(v,(_,b)=>(m<b.largestBatchId&&(m=b.largestBatchId),c.get(_)?le.resolve():this.remoteDocumentCache.getEntry(e,_).next(A=>{p=p.insert(_,A)}))).next(()=>this.populateOverlays(e,v,c)).next(()=>this.computeViews(e,p,v,Ye())).next(_=>({batchId:m,changes:u0(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ne(t)).next(a=>{let o=Cc();return a.isFoundDocument()&&(o=o.insert(a.key,a)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,a,o){const c=t.collectionGroup;let d=Cc();return this.indexManager.getCollectionParents(e,c).next(m=>le.forEach(m,p=>{const v=function(b,A){return new ul(A,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)}(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,v,a,o).next(_=>{_.forEach((b,A)=>{d=d.insert(b,A)})})}).next(()=>d))}getDocumentsMatchingCollectionQuery(e,t,a,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next(d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,c,o))).next(d=>{c.forEach((p,v)=>{const _=v.getKey();d.get(_)===null&&(d=d.insert(_,Wt.newInvalidDocument(_)))});let m=Cc();return d.forEach((p,v)=>{const _=c.get(p);_!==void 0&&Pc(_.mutation,v,Bn.empty(),qt.now()),Qh(t,v)&&(m=m.insert(p,v))}),m})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return le.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:Hn(o.createTime)}}(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:YD(o.bundledQuery),readTime:Hn(o.readTime)}}(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(){this.overlays=new Nt(Ne.comparator),this.Qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const a=Tr();return le.forEach(t,o=>this.getOverlay(e,o).next(c=>{c!==null&&a.set(o,c)})).next(()=>a)}saveOverlays(e,t,a){return a.forEach((o,c)=>{this.St(e,t,c)}),le.resolve()}removeOverlaysForBatchId(e,t,a){const o=this.Qr.get(a);return o!==void 0&&(o.forEach(c=>this.overlays=this.overlays.remove(c)),this.Qr.delete(a)),le.resolve()}getOverlaysForCollection(e,t,a){const o=Tr(),c=t.length+1,d=new Ne(t.child("")),m=this.overlays.getIteratorFrom(d);for(;m.hasNext();){const p=m.getNext().value,v=p.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===c&&p.largestBatchId>a&&o.set(p.getKey(),p)}return le.resolve(o)}getOverlaysForCollectionGroup(e,t,a,o){let c=new Nt((v,_)=>v-_);const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>a){let _=c.get(v.largestBatchId);_===null&&(_=Tr(),c=c.insert(v.largestBatchId,_)),_.set(v.getKey(),v)}}const m=Tr(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((v,_)=>m.set(v,_)),!(m.size()>=o)););return le.resolve(m)}St(e,t,a){const o=this.overlays.get(a.key);if(o!==null){const d=this.Qr.get(o.largestBatchId).delete(a.key);this.Qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(a.key,new AD(t,a));let c=this.Qr.get(t);c===void 0&&(c=Ye(),this.Qr.set(t,c)),this.Qr.set(t,c.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(){this.sessionToken=ln.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(){this.$r=new Bt(Xt.Ur),this.Kr=new Bt(Xt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const a=new Xt(e,t);this.$r=this.$r.add(a),this.Kr=this.Kr.add(a)}Gr(e,t){e.forEach(a=>this.addReference(a,t))}removeReference(e,t){this.zr(new Xt(e,t))}jr(e,t){e.forEach(a=>this.removeReference(a,t))}Hr(e){const t=new Ne(new ft([])),a=new Xt(t,e),o=new Xt(t,e+1),c=[];return this.Kr.forEachInRange([a,o],d=>{this.zr(d),c.push(d.key)}),c}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new Ne(new ft([])),a=new Xt(t,e),o=new Xt(t,e+1);let c=Ye();return this.Kr.forEachInRange([a,o],d=>{c=c.add(d.key)}),c}containsKey(e){const t=new Xt(e,0),a=this.$r.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class Xt{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return Ne.comparator(e.key,t.key)||Fe(e.Zr,t.Zr)}static Wr(e,t){return Fe(e.Zr,t.Zr)||Ne.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Bt(Xt.Ur)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,o){const c=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new TD(c,t,a,o);this.mutationQueue.push(d);for(const m of o)this.Xr=this.Xr.add(new Xt(m.key,c)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return le.resolve(d)}lookupMutationBatch(e,t){return le.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,o=this.ti(a),c=o<0?0:o;return le.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?Hg:this.nr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new Xt(t,0),o=new Xt(t,Number.POSITIVE_INFINITY),c=[];return this.Xr.forEachInRange([a,o],d=>{const m=this.ei(d.Zr);c.push(m)}),le.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new Bt(Fe);return t.forEach(o=>{const c=new Xt(o,0),d=new Xt(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([c,d],m=>{a=a.add(m.Zr)})}),le.resolve(this.ni(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,o=a.length+1;let c=a;Ne.isDocumentKey(c)||(c=c.child(""));const d=new Xt(new Ne(c),0);let m=new Bt(Fe);return this.Xr.forEachWhile(p=>{const v=p.key.path;return!!a.isPrefixOf(v)&&(v.length===o&&(m=m.add(p.Zr)),!0)},d),le.resolve(this.ni(m))}ni(e){const t=[];return e.forEach(a=>{const o=this.ei(a);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Ze(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Xr;return le.forEach(t.mutations,o=>{const c=new Xt(o.key,t.batchId);return a=a.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=a})}sr(e){}containsKey(e,t){const a=new Xt(t,0),o=this.Xr.firstAfterOrEqual(a);return le.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lM{constructor(e){this.ii=e,this.docs=function(){return new Nt(Ne.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,o=this.docs.get(a),c=o?o.size:0,d=this.ii(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return le.resolve(a?a.document.mutableCopy():Wt.newInvalidDocument(t))}getEntries(e,t){let a=Da();return t.forEach(o=>{const c=this.docs.get(o);a=a.insert(o,c?c.document.mutableCopy():Wt.newInvalidDocument(o))}),le.resolve(a)}getDocumentsMatchingQuery(e,t,a,o){let c=Da();const d=t.path,m=new Ne(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(m);for(;p.hasNext();){const{key:v,value:{document:_}}=p.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||U1(V1(_),a)<=0||(o.has(_.key)||Qh(t,_))&&(c=c.insert(_.key,_.mutableCopy()))}return le.resolve(c)}getAllFromCollectionGroup(e,t,a,o){Te(9500)}si(e,t){return le.forEach(this.docs,a=>t(a))}newChangeBuffer(e){return new cM(this)}getSize(e){return le.resolve(this.size)}}class cM extends tM{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((a,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(a)}),le.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(e){this.persistence=e,this.oi=new Lr(t=>Yg(t),Kg),this.lastRemoteSnapshotVersion=Ce.min(),this.highestTargetId=0,this._i=0,this.ai=new Jg,this.targetCount=0,this.ui=el.cr()}forEachTarget(e,t){return this.oi.forEach((a,o)=>t(o)),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this._i&&(this._i=t),le.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new el(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Tr(t),le.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,a){let o=0;const c=[];return this.oi.forEach((d,m)=>{m.sequenceNumber<=t&&a.get(m.targetId)===null&&(this.oi.delete(d),c.push(this.removeMatchingKeysForTargetId(e,m.targetId)),o++)}),le.waitFor(c).next(()=>o)}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const a=this.oi.get(t)||null;return le.resolve(a)}addMatchingKeys(e,t,a){return this.ai.Gr(t,a),le.resolve()}removeMatchingKeys(e,t,a){this.ai.jr(t,a);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach(d=>{c.push(o.markPotentiallyOrphaned(e,d))}),le.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const a=this.ai.Yr(t);return le.resolve(a)}containsKey(e,t){return le.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e,t){this.ci={},this.overlays={},this.li=new Gh(0),this.hi=!1,this.hi=!0,this.Pi=new rM,this.referenceDelegate=e(this),this.Ti=new uM(this),this.indexManager=new KD,this.remoteDocumentCache=function(o){return new lM(o)}(a=>this.referenceDelegate.Ii(a)),this.serializer=new $D(t),this.Ei=new aM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new iM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ci[e.toKey()];return a||(a=new oM(t,this.referenceDelegate),this.ci[e.toKey()]=a),a}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,a){ge("MemoryPersistence","Starting transaction:",e);const o=new dM(this.li.next());return this.referenceDelegate.di(),a(o).next(c=>this.referenceDelegate.Ai(o).next(()=>c)).toPromise().then(c=>(o.raiseOnCommittedEvent(),c))}Ri(e,t){return le.or(Object.values(this.ci).map(a=>()=>a.containsKey(e,t)))}}class dM extends q1{constructor(e){super(),this.currentSequenceNumber=e}}class ev{constructor(e){this.persistence=e,this.Vi=new Jg,this.mi=null}static fi(e){return new ev(e)}get gi(){if(this.mi)return this.mi;throw Te(60996)}addReference(e,t,a){return this.Vi.addReference(a,t),this.gi.delete(a.toString()),le.resolve()}removeReference(e,t,a){return this.Vi.removeReference(a,t),this.gi.add(a.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(c=>this.gi.add(c.toString()))}).next(()=>a.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.gi,a=>{const o=Ne.fromPath(a);return this.pi(e,o).next(c=>{c||t.removeEntry(o,Ce.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(a=>{a?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return le.or([()=>le.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Ch{constructor(e,t){this.persistence=e,this.yi=new Lr(a=>H1(a.path),(a,o)=>a.isEqual(o)),this.garbageCollector=eM(this,t)}static fi(e,t){return new Ch(e,t)}di(){}Ai(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(a=>t.next(o=>a+o))}br(e){let t=0;return this.yr(e,a=>{t++}).next(()=>t)}yr(e,t){return le.forEach(this.yi,(a,o)=>this.Dr(e,a,o).next(c=>c?le.resolve():t(o)))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.si(e,d=>this.Dr(e,d,t).next(m=>{m||(a++,c.removeEntry(d,Ce.min()))})).next(()=>c.apply(e)).next(()=>a)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}removeReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ih(e.data.value)),t}Dr(e,t,a){return le.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return le.resolve(o!==void 0&&o>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv{constructor(e,t,a,o){this.targetId=e,this.fromCache=t,this.ds=a,this.As=o}static Rs(e,t){let a=Ye(),o=Ye();for(const c of t.docChanges)switch(c.type){case 0:a=a.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new tv(e,t.fromCache,a,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return GC()?8:B1(gn())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,a,o){const c={result:null};return this.ws(e,t).next(d=>{c.result=d}).next(()=>{if(!c.result)return this.bs(e,t,o,a).next(d=>{c.result=d})}).next(()=>{if(c.result)return;const d=new hM;return this.Ss(e,t,d).next(m=>{if(c.result=m,this.fs)return this.Ds(e,t,d,m.size)})}).next(()=>c.result)}Ds(e,t,a,o){return a.documentReadCount<this.gs?(Po()<=$e.DEBUG&&ge("QueryEngine","SDK will not create cache indexes for query:",Lo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),le.resolve()):(Po()<=$e.DEBUG&&ge("QueryEngine","Query:",Lo(t),"scans",a.documentReadCount,"local documents and returns",o,"documents as results."),a.documentReadCount>this.ps*o?(Po()<=$e.DEBUG&&ge("QueryEngine","The SDK decides to create cache indexes for query:",Lo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ys(t))):le.resolve())}ws(e,t){if(_N(t))return le.resolve(null);let a=Ys(t);return this.indexManager.getIndexType(e,a).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Th(t,null,"F"),a=Ys(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next(c=>{const d=Ye(...c);return this.ys.getDocuments(e,d).next(m=>this.indexManager.getMinOffset(e,a).next(p=>{const v=this.vs(t,m);return this.Cs(t,v,d,p.readTime)?this.ws(e,Th(t,null,"F")):this.Fs(e,v,t,p)}))})))}bs(e,t,a,o){return _N(t)||o.isEqual(Ce.min())?le.resolve(null):this.ys.getDocuments(e,a).next(c=>{const d=this.vs(t,c);return this.Cs(t,d,a,o)?le.resolve(null):(Po()<=$e.DEBUG&&ge("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Lo(t)),this.Fs(e,d,t,L1(o,$c)).next(m=>m))})}vs(e,t){let a=new Bt(l0(e));return t.forEach((o,c)=>{Qh(e,c)&&(a=a.add(c))}),a}Cs(e,t,a,o){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,a){return Po()<=$e.DEBUG&&ge("QueryEngine","Using full collection scan to execute query:",Lo(t)),this.ys.getDocumentsMatchingQuery(e,t,Ni.min(),a)}Fs(e,t,a,o){return this.ys.getDocumentsMatchingQuery(e,a,o).next(c=>(t.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nv="LocalStore",mM=3e8;class pM{constructor(e,t,a,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new Nt(Fe),this.Os=new Lr(c=>Yg(c),Kg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(a)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sM(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function gM(n,e,t,a){return new pM(n,e,t,a)}async function O0(n,e){const t=De(n);return await t.persistence.runTransaction("Handle user change","readonly",a=>{let o;return t.mutationQueue.getAllMutationBatches(a).next(c=>(o=c,t.Ls(e),t.mutationQueue.getAllMutationBatches(a))).next(c=>{const d=[],m=[];let p=Ye();for(const v of o){d.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}for(const v of c){m.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}return t.localDocuments.getDocuments(a,p).next(v=>({ks:v,removedBatchIds:d,addedBatchIds:m}))})})}function vM(n,e){const t=De(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const o=e.batch.keys(),c=t.Bs.newChangeBuffer({trackRemovals:!0});return function(m,p,v,_){const b=v.batch,A=b.keys();let j=le.resolve();return A.forEach(T=>{j=j.next(()=>_.getEntry(p,T)).next(S=>{const x=v.docVersions.get(T);Ze(x!==null,48541),S.version.compareTo(x)<0&&(b.applyToRemoteDocument(S,v),S.isValidDocument()&&(S.setReadTime(v.commitVersion),_.addEntry(S)))})}),j.next(()=>m.mutationQueue.removeMutationBatch(p,b))}(t,a,e,c).next(()=>c.apply(a)).next(()=>t.mutationQueue.performConsistencyCheck(a)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(a,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,function(m){let p=Ye();for(let v=0;v<m.mutationResults.length;++v)m.mutationResults[v].transformResults.length>0&&(p=p.add(m.batch.mutations[v].key));return p}(e))).next(()=>t.localDocuments.getDocuments(a,o))})}function k0(n){const e=De(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function yM(n,e){const t=De(n),a=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const m=[];e.targetChanges.forEach((_,b)=>{const A=o.get(b);if(!A)return;m.push(t.Ti.removeMatchingKeys(c,_.removedDocuments,b).next(()=>t.Ti.addMatchingKeys(c,_.addedDocuments,b)));let j=A.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(b)!==null?j=j.withResumeToken(ln.EMPTY_BYTE_STRING,Ce.min()).withLastLimboFreeSnapshotVersion(Ce.min()):_.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(_.resumeToken,a)),o=o.insert(b,j),function(S,x,F){return S.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=mM?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0}(A,j,_)&&m.push(t.Ti.updateTargetData(c,j))});let p=Da(),v=Ye();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(c,_))}),m.push(_M(c,d,e.documentUpdates).next(_=>{p=_.qs,v=_.Qs})),!a.isEqual(Ce.min())){const _=t.Ti.getLastRemoteSnapshotVersion(c).next(b=>t.Ti.setTargetsMetadata(c,c.currentSequenceNumber,a));m.push(_)}return le.waitFor(m).next(()=>d.apply(c)).next(()=>t.localDocuments.getLocalViewOfDocuments(c,p,v)).next(()=>p)}).then(c=>(t.xs=o,c))}function _M(n,e,t){let a=Ye(),o=Ye();return t.forEach(c=>a=a.add(c)),e.getEntries(n,a).next(c=>{let d=Da();return t.forEach((m,p)=>{const v=c.get(m);p.isFoundDocument()!==v.isFoundDocument()&&(o=o.add(m)),p.isNoDocument()&&p.version.isEqual(Ce.min())?(e.removeEntry(m,p.readTime),d=d.insert(m,p)):!v.isValidDocument()||p.version.compareTo(v.version)>0||p.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(p),d=d.insert(m,p)):ge(nv,"Ignoring outdated watch update for ",m,". Current version:",v.version," Watch version:",p.version)}),{qs:d,Qs:o}})}function bM(n,e){const t=De(n);return t.persistence.runTransaction("Get next mutation batch","readonly",a=>(e===void 0&&(e=Hg),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e)))}function EM(n,e){const t=De(n);return t.persistence.runTransaction("Allocate target","readwrite",a=>{let o;return t.Ti.getTargetData(a,e).next(c=>c?(o=c,le.resolve(o)):t.Ti.allocateTargetId(a).next(d=>(o=new gi(e,d,"TargetPurposeListen",a.currentSequenceNumber),t.Ti.addTargetData(a,o).next(()=>o))))}).then(a=>{const o=t.xs.get(a.targetId);return(o===null||a.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(a.targetId,a),t.Os.set(e,a.targetId)),a})}async function fg(n,e,t){const a=De(n),o=a.xs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",c,d=>a.persistence.referenceDelegate.removeTarget(d,o))}catch(d){if(!cl(d))throw d;ge(nv,`Failed to update sequence numbers for target ${e}: ${d}`)}a.xs=a.xs.remove(e),a.Os.delete(o.target)}function DN(n,e,t){const a=De(n);let o=Ce.min(),c=Ye();return a.persistence.runTransaction("Execute query","readwrite",d=>function(p,v,_){const b=De(p),A=b.Os.get(_);return A!==void 0?le.resolve(b.xs.get(A)):b.Ti.getTargetData(v,_)}(a,d,Ys(e)).next(m=>{if(m)return o=m.lastLimboFreeSnapshotVersion,a.Ti.getMatchingKeysForTargetId(d,m.targetId).next(p=>{c=p})}).next(()=>a.Ms.getDocumentsMatchingQuery(d,e,t?o:Ce.min(),t?c:Ye())).next(m=>(NM(a,cD(e),m),{documents:m,$s:c})))}function NM(n,e,t){let a=n.Ns.get(e)||Ce.min();t.forEach((o,c)=>{c.readTime.compareTo(a)>0&&(a=c.readTime)}),n.Ns.set(e,a)}class MN{constructor(){this.activeTargetIds=pD()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xM{constructor(){this.xo=new MN,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,a){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new MN,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TM{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON="ConnectivityMonitor";class kN{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){ge(ON,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){ge(ON,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xd=null;function mg(){return Xd===null?Xd=function(){return 268435456+Math.round(2147483648*Math.random())}():Xd++,"0x"+Xd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp="RestConnection",AM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class jM{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${a}/databases/${o}`,this.Go=this.databaseId.database===Eh?`project_id=${a}`:`project_id=${a}&database_id=${o}`}zo(e,t,a,o,c){const d=mg(),m=this.jo(e,t.toUriEncodedString());ge(Mp,`Sending RPC '${e}' ${d}:`,m,a);const p={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(p,o,c);const{host:v}=new URL(m),_=kr(v);return this.Jo(e,m,p,a,_).then(b=>(ge(Mp,`Received RPC '${e}' ${d}: `,b),b),b=>{throw Xo(Mp,`RPC '${e}' ${d} failed with error: `,b,"url: ",m,"request:",a),b})}Yo(e,t,a,o,c,d){return this.zo(e,t,a,o,c)}Ho(e,t,a){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ol}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,c)=>e[c]=o),a&&a.headers.forEach((o,c)=>e[c]=o)}jo(e,t){const a=AM[e];return`${this.Ko}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hn="WebChannelConnection";class CM extends jM{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,o,c){const d=mg();return new Promise((m,p)=>{const v=new kT;v.setWithCredentials(!0),v.listenOnce(PT.COMPLETE,()=>{try{switch(v.getLastErrorCode()){case ah.NO_ERROR:const b=v.getResponseJson();ge(hn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(b)),m(b);break;case ah.TIMEOUT:ge(hn,`RPC '${e}' ${d} timed out`),p(new me(re.DEADLINE_EXCEEDED,"Request time out"));break;case ah.HTTP_ERROR:const A=v.getStatus();if(ge(hn,`RPC '${e}' ${d} failed with status:`,A,"response text:",v.getResponseText()),A>0){let j=v.getResponseJson();Array.isArray(j)&&(j=j[0]);const T=j?.error;if(T&&T.status&&T.message){const S=function(F){const Y=F.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf(Y)>=0?Y:re.UNKNOWN}(T.status);p(new me(S,T.message))}else p(new me(re.UNKNOWN,"Server responded with status "+v.getStatus()))}else p(new me(re.UNAVAILABLE,"Connection failed."));break;default:Te(9055,{h_:e,streamId:d,P_:v.getLastErrorCode(),T_:v.getLastError()})}}finally{ge(hn,`RPC '${e}' ${d} completed.`)}});const _=JSON.stringify(o);ge(hn,`RPC '${e}' ${d} sending request:`,o),v.send(t,"POST",_,a,15)})}I_(e,t,a){const o=mg(),c=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=UT(),m=VT(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(p.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Ho(p.initMessageHeaders,t,a),p.encodeInitMessageHeaders=!0;const _=c.join("");ge(hn,`Creating RPC '${e}' stream ${o}: ${_}`,p);const b=d.createWebChannel(_,p);this.E_(b);let A=!1,j=!1;const T=new wM({Zo:x=>{j?ge(hn,`Not sending because RPC '${e}' stream ${o} is closed:`,x):(A||(ge(hn,`Opening RPC '${e}' stream ${o} transport.`),b.open(),A=!0),ge(hn,`RPC '${e}' stream ${o} sending:`,x),b.send(x))},Xo:()=>b.close()}),S=(x,F,Y)=>{x.listen(F,V=>{try{Y(V)}catch(O){setTimeout(()=>{throw O},0)}})};return S(b,wc.EventType.OPEN,()=>{j||(ge(hn,`RPC '${e}' stream ${o} transport opened.`),T.__())}),S(b,wc.EventType.CLOSE,()=>{j||(j=!0,ge(hn,`RPC '${e}' stream ${o} transport closed`),T.u_(),this.d_(b))}),S(b,wc.EventType.ERROR,x=>{j||(j=!0,Xo(hn,`RPC '${e}' stream ${o} transport errored. Name:`,x.name,"Message:",x.message),T.u_(new me(re.UNAVAILABLE,"The operation could not be completed")))}),S(b,wc.EventType.MESSAGE,x=>{var F;if(!j){const Y=x.data[0];Ze(!!Y,16349);const V=Y,O=V?.error||((F=V[0])===null||F===void 0?void 0:F.error);if(O){ge(hn,`RPC '${e}' stream ${o} received error:`,O);const U=O.status;let W=function(k){const w=Ot[k];if(w!==void 0)return E0(w)}(U),L=O.message;W===void 0&&(W=re.INTERNAL,L="Unknown error status: "+U+" with message "+O.message),j=!0,T.u_(new me(W,L)),b.close()}else ge(hn,`RPC '${e}' stream ${o} received:`,Y),T.c_(Y)}}),S(m,LT.STAT_EVENT,x=>{x.stat===sg.PROXY?ge(hn,`RPC '${e}' stream ${o} detected buffering proxy`):x.stat===sg.NOPROXY&&ge(hn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{T.a_()},0),T}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function Op(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ef(n){return new DD(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e,t,a=1e3,o=1.5,c=6e4){this.xi=e,this.timerId=t,this.A_=a,this.R_=o,this.V_=c,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),a=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-a);o>0&&ge("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN="PersistentStream";class P0{constructor(e,t,a,o,c,d,m,p){this.xi=e,this.S_=a,this.D_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=m,this.listener=p,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new sv(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(Ra(t.toString()),Ra("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,o])=>{this.v_===t&&this.z_(a,o)},a=>{e(()=>{const o=new me(re.UNKNOWN,"Fetching auth token failed: "+a.message);return this.j_(o)})})}z_(e,t){const a=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{a(()=>this.listener.e_())}),this.stream.n_(()=>{a(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{a(()=>this.j_(o))}),this.stream.onMessage(o=>{a(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return ge(PN,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(ge(PN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class SM extends P0{constructor(e,t,a,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=PD(this.serializer,e),a=function(c){if(!("targetChange"in c))return Ce.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?Ce.min():d.readTime?Hn(d.readTime):Ce.min()}(e);return this.listener.Y_(t,a)}Z_(e){const t={};t.database=hg(this.serializer),t.addTarget=function(c,d){let m;const p=d.target;if(m=lg(p)?{documents:VD(c,p)}:{query:UD(c,p).gt},m.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){m.resumeToken=T0(c,d.resumeToken);const v=ug(c,d.expectedCount);v!==null&&(m.expectedCount=v)}else if(d.snapshotVersion.compareTo(Ce.min())>0){m.readTime=jh(c,d.snapshotVersion.toTimestamp());const v=ug(c,d.expectedCount);v!==null&&(m.expectedCount=v)}return m}(this.serializer,e);const a=qD(this.serializer,e);a&&(t.labels=a),this.Q_(t)}X_(e){const t={};t.database=hg(this.serializer),t.removeTarget=e,this.Q_(t)}}class IM extends P0{constructor(e,t,a,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=LD(e.writeResults,e.commitTime),a=Hn(e.commitTime);return this.listener.ra(a,t)}ia(){const e={};e.database=hg(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(a=>C0(this.serializer,a))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RM{}class DM extends RM{constructor(e,t,a,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new me(re.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,a,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.zo(e,dg(t,a),o,c,d)).catch(c=>{throw c.name==="FirebaseError"?(c.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new me(re.UNKNOWN,c.toString())})}Yo(e,t,a,o,c){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,m])=>this.connection.Yo(e,dg(t,a),o,d,m,c)).catch(d=>{throw d.name==="FirebaseError"?(d.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new me(re.UNKNOWN,d.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class MM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Ra(t),this.ua=!1):ge("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr="RemoteStore";class OM{constructor(e,t,a,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=c,this.Ra.No(d=>{a.enqueueAndForget(async()=>{Vr(this)&&(ge(Rr,"Restarting streams for network reachability change."),await async function(p){const v=De(p);v.da.add(4),await hu(v),v.Va.set("Unknown"),v.da.delete(4),await tf(v)}(this))})}),this.Va=new MM(a,o)}}async function tf(n){if(Vr(n))for(const e of n.Aa)await e(!0)}async function hu(n){for(const e of n.Aa)await e(!1)}function L0(n,e){const t=De(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),ov(t)?rv(t):dl(t).N_()&&iv(t,e))}function av(n,e){const t=De(n),a=dl(t);t.Ea.delete(e),a.N_()&&V0(t,e),t.Ea.size===0&&(a.N_()?a.k_():Vr(t)&&t.Va.set("Unknown"))}function iv(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ce.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}dl(n).Z_(e)}function V0(n,e){n.ma.Ke(e),dl(n).X_(e)}function rv(n){n.ma=new CD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),dl(n).start(),n.Va.ca()}function ov(n){return Vr(n)&&!dl(n).O_()&&n.Ea.size>0}function Vr(n){return De(n).da.size===0}function U0(n){n.ma=void 0}async function kM(n){n.Va.set("Online")}async function PM(n){n.Ea.forEach((e,t)=>{iv(n,e)})}async function LM(n,e){U0(n),ov(n)?(n.Va.Pa(e),rv(n)):n.Va.set("Unknown")}async function VM(n,e,t){if(n.Va.set("Online"),e instanceof x0&&e.state===2&&e.cause)try{await async function(o,c){const d=c.cause;for(const m of c.targetIds)o.Ea.has(m)&&(await o.remoteSyncer.rejectListen(m,d),o.Ea.delete(m),o.ma.removeTarget(m))}(n,e)}catch(a){ge(Rr,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await Sh(n,a)}else if(e instanceof lh?n.ma.Xe(e):e instanceof N0?n.ma.ot(e):n.ma.nt(e),!t.isEqual(Ce.min()))try{const a=await k0(n.localStore);t.compareTo(a)>=0&&await function(c,d){const m=c.ma.It(d);return m.targetChanges.forEach((p,v)=>{if(p.resumeToken.approximateByteSize()>0){const _=c.Ea.get(v);_&&c.Ea.set(v,_.withResumeToken(p.resumeToken,d))}}),m.targetMismatches.forEach((p,v)=>{const _=c.Ea.get(p);if(!_)return;c.Ea.set(p,_.withResumeToken(ln.EMPTY_BYTE_STRING,_.snapshotVersion)),V0(c,p);const b=new gi(_.target,p,v,_.sequenceNumber);iv(c,b)}),c.remoteSyncer.applyRemoteEvent(m)}(n,t)}catch(a){ge(Rr,"Failed to raise snapshot:",a),await Sh(n,a)}}async function Sh(n,e,t){if(!cl(e))throw e;n.da.add(1),await hu(n),n.Va.set("Offline"),t||(t=()=>k0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ge(Rr,"Retrying IndexedDB access"),await t(),n.da.delete(1),await tf(n)})}function F0(n,e){return e().catch(t=>Sh(n,t,e))}async function nf(n){const e=De(n),t=ji(e);let a=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Hg;for(;UM(e);)try{const o=await bM(e.localStore,a);if(o===null){e.Ia.length===0&&t.k_();break}a=o.batchId,FM(e,o)}catch(o){await Sh(e,o)}q0(e)&&B0(e)}function UM(n){return Vr(n)&&n.Ia.length<10}function FM(n,e){n.Ia.push(e);const t=ji(n);t.N_()&&t.ea&&t.ta(e.mutations)}function q0(n){return Vr(n)&&!ji(n).O_()&&n.Ia.length>0}function B0(n){ji(n).start()}async function qM(n){ji(n).ia()}async function BM(n){const e=ji(n);for(const t of n.Ia)e.ta(t.mutations)}async function zM(n,e,t){const a=n.Ia.shift(),o=Xg.from(a,e,t);await F0(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await nf(n)}async function HM(n,e){e&&ji(n).ea&&await async function(a,o){if(function(d){return b0(d)&&d!==re.ABORTED}(o.code)){const c=a.Ia.shift();ji(a).L_(),await F0(a,()=>a.remoteSyncer.rejectFailedWrite(c.batchId,o)),await nf(a)}}(n,e),q0(n)&&B0(n)}async function LN(n,e){const t=De(n);t.asyncQueue.verifyOperationInProgress(),ge(Rr,"RemoteStore received new credentials");const a=Vr(t);t.da.add(3),await hu(t),a&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await tf(t)}async function GM(n,e){const t=De(n);e?(t.da.delete(2),await tf(t)):e||(t.da.add(2),await hu(t),t.Va.set("Unknown"))}function dl(n){return n.fa||(n.fa=function(t,a,o){const c=De(t);return c.oa(),new SM(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:kM.bind(null,n),n_:PM.bind(null,n),i_:LM.bind(null,n),Y_:VM.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),ov(n)?rv(n):n.Va.set("Unknown")):(await n.fa.stop(),U0(n))})),n.fa}function ji(n){return n.ga||(n.ga=function(t,a,o){const c=De(t);return c.oa(),new IM(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:qM.bind(null,n),i_:HM.bind(null,n),na:BM.bind(null,n),ra:zM.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await nf(n)):(await n.ga.stop(),n.Ia.length>0&&(ge(Rr,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e,t,a,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=o,this.removalCallback=c,this.deferred=new $s,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,o,c){const d=Date.now()+a,m=new lv(e,t,d,o,c);return m.start(a),m}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cv(n,e){if(Ra("AsyncQueue",`${e}: ${n}`),cl(n))return new me(re.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{static emptySet(e){return new Yo(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||Ne.comparator(t.key,a.key):(t,a)=>Ne.comparator(t.key,a.key),this.keyedMap=Cc(),this.sortedSet=new Nt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,a)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Yo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new Yo;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(){this.pa=new Nt(Ne.comparator)}track(e){const t=e.doc.key,a=this.pa.get(t);a?e.type!==0&&a.type===3?this.pa=this.pa.insert(t,e):e.type===3&&a.type!==1?this.pa=this.pa.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.pa=this.pa.remove(t):e.type===1&&a.type===2?this.pa=this.pa.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Te(63341,{Vt:e,ya:a}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,a)=>{e.push(a)}),e}}class tl{constructor(e,t,a,o,c,d,m,p,v){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=m,this.excludesMetadataChanges=p,this.hasCachedResults=v}static fromInitialDocuments(e,t,a,o,c){const d=[];return t.forEach(m=>{d.push({type:0,doc:m})}),new tl(e,t,Yo.emptySet(t),d,a,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==a[o].type||!t[o].doc.isEqual(a[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class YM{constructor(){this.queries=UN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const o=De(t),c=o.queries;o.queries=UN(),c.forEach((d,m)=>{for(const p of m.Sa)p.onError(a)})})(this,new me(re.ABORTED,"Firestore shutting down"))}}function UN(){return new Lr(n=>o0(n),Kh)}async function uv(n,e){const t=De(n);let a=3;const o=e.query;let c=t.queries.get(o);c?!c.Da()&&e.va()&&(a=2):(c=new $M,a=e.va()?0:1);try{switch(a){case 0:c.ba=await t.onListen(o,!0);break;case 1:c.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const m=cv(d,`Initialization of query '${Lo(e.query)}' failed`);return void e.onError(m)}t.queries.set(o,c),c.Sa.push(e),e.Fa(t.onlineState),c.ba&&e.Ma(c.ba)&&hv(t)}async function dv(n,e){const t=De(n),a=e.query;let o=3;const c=t.queries.get(a);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.va()?0:1:!c.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function KM(n,e){const t=De(n);let a=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const m of d.Sa)m.Ma(o)&&(a=!0);d.ba=o}}a&&hv(t)}function QM(n,e,t){const a=De(n),o=a.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);a.queries.delete(e)}function hv(n){n.Ca.forEach(e=>{e.next()})}var pg,FN;(FN=pg||(pg={})).xa="default",FN.Cache="cache";class fv{constructor(e,t,a){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=a||{}}Ma(e){if(!this.options.includeMetadataChanges){const a=[];for(const o of e.docChanges)o.type!==3&&a.push(o);e=new tl(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const a=t!=="Offline";return(!this.options.Qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=tl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==pg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(e){this.key=e}}class H0{constructor(e){this.key=e}}class XM{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ye(),this.mutatedKeys=Ye(),this.Za=l0(e),this.Xa=new Yo(this.Za)}get eu(){return this.Ha}tu(e,t){const a=t?t.nu:new VN,o=t?t.Xa:this.Xa;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,m=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,v=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((_,b)=>{const A=o.get(_),j=Qh(this.query,b)?b:null,T=!!A&&this.mutatedKeys.has(A.key),S=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let x=!1;A&&j?A.data.isEqual(j.data)?T!==S&&(a.track({type:3,doc:j}),x=!0):this.ru(A,j)||(a.track({type:2,doc:j}),x=!0,(p&&this.Za(j,p)>0||v&&this.Za(j,v)<0)&&(m=!0)):!A&&j?(a.track({type:0,doc:j}),x=!0):A&&!j&&(a.track({type:1,doc:A}),x=!0,(p||v)&&(m=!0)),x&&(j?(d=d.add(j),c=S?c.add(_):c.delete(_)):(d=d.delete(_),c=c.delete(_)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const _=this.query.limitType==="F"?d.last():d.first();d=d.delete(_.key),c=c.delete(_.key),a.track({type:1,doc:_})}return{Xa:d,nu:a,Cs:m,mutatedKeys:c}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,o){const c=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const d=e.nu.wa();d.sort((_,b)=>function(j,T){const S=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Te(20277,{Vt:x})}};return S(j)-S(T)}(_.type,b.type)||this.Za(_.doc,b.doc)),this.iu(a),o=o!=null&&o;const m=t&&!o?this.su():[],p=this.Ya.size===0&&this.current&&!o?1:0,v=p!==this.Ja;return this.Ja=p,d.length!==0||v?{snapshot:new tl(this.query,e.Xa,c,d,e.mutatedKeys,p===0,v,!1,!!a&&a.resumeToken.approximateByteSize()>0),ou:m}:{ou:m}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new VN,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Ye(),this.Xa.forEach(a=>{this._u(a.key)&&(this.Ya=this.Ya.add(a.key))});const t=[];return e.forEach(a=>{this.Ya.has(a)||t.push(new H0(a))}),this.Ya.forEach(a=>{e.has(a)||t.push(new z0(a))}),t}au(e){this.Ha=e.$s,this.Ya=Ye();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return tl.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const mv="SyncEngine";class WM{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class ZM{constructor(e){this.key=e,this.cu=!1}}class JM{constructor(e,t,a,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.lu={},this.hu=new Lr(m=>o0(m),Kh),this.Pu=new Map,this.Tu=new Set,this.Iu=new Nt(Ne.comparator),this.Eu=new Map,this.du=new Jg,this.Au={},this.Ru=new Map,this.Vu=el.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function eO(n,e,t=!0){const a=X0(n);let o;const c=a.hu.get(e);return c?(a.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.uu()):o=await G0(a,e,t,!0),o}async function tO(n,e){const t=X0(n);await G0(t,e,!0,!1)}async function G0(n,e,t,a){const o=await EM(n.localStore,Ys(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let m;return a&&(m=await nO(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&L0(n.remoteStore,o),m}async function nO(n,e,t,a,o){n.fu=(b,A,j)=>async function(S,x,F,Y){let V=x.view.tu(F);V.Cs&&(V=await DN(S.localStore,x.query,!1).then(({documents:L})=>x.view.tu(L,V)));const O=Y&&Y.targetChanges.get(x.targetId),U=Y&&Y.targetMismatches.get(x.targetId)!=null,W=x.view.applyChanges(V,S.isPrimaryClient,O,U);return BN(S,x.targetId,W.ou),W.snapshot}(n,b,A,j);const c=await DN(n.localStore,e,!0),d=new XM(e,c.$s),m=d.tu(c.documents),p=du.createSynthesizedTargetChangeForCurrentChange(t,a&&n.onlineState!=="Offline",o),v=d.applyChanges(m,n.isPrimaryClient,p);BN(n,t,v.ou);const _=new WM(e,t,d);return n.hu.set(e,_),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),v.snapshot}async function sO(n,e,t){const a=De(n),o=a.hu.get(e),c=a.Pu.get(o.targetId);if(c.length>1)return a.Pu.set(o.targetId,c.filter(d=>!Kh(d,e))),void a.hu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(o.targetId),a.sharedClientState.isActiveQueryTarget(o.targetId)||await fg(a.localStore,o.targetId,!1).then(()=>{a.sharedClientState.clearQueryState(o.targetId),t&&av(a.remoteStore,o.targetId),gg(a,o.targetId)}).catch(ll)):(gg(a,o.targetId),await fg(a.localStore,o.targetId,!0))}async function aO(n,e){const t=De(n),a=t.hu.get(e),o=t.Pu.get(a.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),av(t.remoteStore,a.targetId))}async function iO(n,e,t){const a=hO(n);try{const o=await function(d,m){const p=De(d),v=qt.now(),_=m.reduce((j,T)=>j.add(T.key),Ye());let b,A;return p.persistence.runTransaction("Locally write mutations","readwrite",j=>{let T=Da(),S=Ye();return p.Bs.getEntries(j,_).next(x=>{T=x,T.forEach((F,Y)=>{Y.isValidDocument()||(S=S.add(F))})}).next(()=>p.localDocuments.getOverlayedDocuments(j,T)).next(x=>{b=x;const F=[];for(const Y of m){const V=xD(Y,b.get(Y.key).overlayedDocument);V!=null&&F.push(new Pi(Y.key,V,JT(V.value.mapValue),rn.exists(!0)))}return p.mutationQueue.addMutationBatch(j,v,F,m)}).next(x=>{A=x;const F=x.applyToLocalDocumentSet(b,S);return p.documentOverlayCache.saveOverlays(j,x.batchId,F)})}).then(()=>({batchId:A.batchId,changes:u0(b)}))}(a.localStore,e);a.sharedClientState.addPendingMutation(o.batchId),function(d,m,p){let v=d.Au[d.currentUser.toKey()];v||(v=new Nt(Fe)),v=v.insert(m,p),d.Au[d.currentUser.toKey()]=v}(a,o.batchId,t),await fu(a,o.changes),await nf(a.remoteStore)}catch(o){const c=cv(o,"Failed to persist write");t.reject(c)}}async function $0(n,e){const t=De(n);try{const a=await yM(t.localStore,e);e.targetChanges.forEach((o,c)=>{const d=t.Eu.get(c);d&&(Ze(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.cu=!0:o.modifiedDocuments.size>0?Ze(d.cu,14607):o.removedDocuments.size>0&&(Ze(d.cu,42227),d.cu=!1))}),await fu(t,a,e)}catch(a){await ll(a)}}function qN(n,e,t){const a=De(n);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const o=[];a.hu.forEach((c,d)=>{const m=d.view.Fa(e);m.snapshot&&o.push(m.snapshot)}),function(d,m){const p=De(d);p.onlineState=m;let v=!1;p.queries.forEach((_,b)=>{for(const A of b.Sa)A.Fa(m)&&(v=!0)}),v&&hv(p)}(a.eventManager,e),o.length&&a.lu.Y_(o),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function rO(n,e,t){const a=De(n);a.sharedClientState.updateQueryState(e,"rejected",t);const o=a.Eu.get(e),c=o&&o.key;if(c){let d=new Nt(Ne.comparator);d=d.insert(c,Wt.newNoDocument(c,Ce.min()));const m=Ye().add(c),p=new Jh(Ce.min(),new Map,new Nt(Fe),d,m);await $0(a,p),a.Iu=a.Iu.remove(c),a.Eu.delete(e),pv(a)}else await fg(a.localStore,e,!1).then(()=>gg(a,e,t)).catch(ll)}async function oO(n,e){const t=De(n),a=e.batch.batchId;try{const o=await vM(t.localStore,e);K0(t,a,null),Y0(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await fu(t,o)}catch(o){await ll(o)}}async function lO(n,e,t){const a=De(n);try{const o=await function(d,m){const p=De(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",v=>{let _;return p.mutationQueue.lookupMutationBatch(v,m).next(b=>(Ze(b!==null,37113),_=b.keys(),p.mutationQueue.removeMutationBatch(v,b))).next(()=>p.mutationQueue.performConsistencyCheck(v)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(v,_,m)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,_)).next(()=>p.localDocuments.getDocuments(v,_))})}(a.localStore,e);K0(a,e,t),Y0(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await fu(a,o)}catch(o){await ll(o)}}function Y0(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function K0(n,e,t){const a=De(n);let o=a.Au[a.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),a.Au[a.currentUser.toKey()]=o}}function gg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const a of n.Pu.get(e))n.hu.delete(a),t&&n.lu.gu(a,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(a=>{n.du.containsKey(a)||Q0(n,a)})}function Q0(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(av(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),pv(n))}function BN(n,e,t){for(const a of t)a instanceof z0?(n.du.addReference(a.key,e),cO(n,a)):a instanceof H0?(ge(mv,"Document no longer in limbo: "+a.key),n.du.removeReference(a.key,e),n.du.containsKey(a.key)||Q0(n,a.key)):Te(19791,{pu:a})}function cO(n,e){const t=e.key,a=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(a)||(ge(mv,"New document in limbo: "+t),n.Tu.add(a),pv(n))}function pv(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new Ne(ft.fromString(e)),a=n.Vu.next();n.Eu.set(a,new ZM(t)),n.Iu=n.Iu.insert(t,a),L0(n.remoteStore,new gi(Ys(Yh(t.path)),a,"TargetPurposeLimboResolution",Gh.le))}}async function fu(n,e,t){const a=De(n),o=[],c=[],d=[];a.hu.isEmpty()||(a.hu.forEach((m,p)=>{d.push(a.fu(p,e,t).then(v=>{var _;if((v||t)&&a.isPrimaryClient){const b=v?!v.fromCache:(_=t?.targetChanges.get(p.targetId))===null||_===void 0?void 0:_.current;a.sharedClientState.updateQueryState(p.targetId,b?"current":"not-current")}if(v){o.push(v);const b=tv.Rs(p.targetId,v);c.push(b)}}))}),await Promise.all(d),a.lu.Y_(o),await async function(p,v){const _=De(p);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",b=>le.forEach(v,A=>le.forEach(A.ds,j=>_.persistence.referenceDelegate.addReference(b,A.targetId,j)).next(()=>le.forEach(A.As,j=>_.persistence.referenceDelegate.removeReference(b,A.targetId,j)))))}catch(b){if(!cl(b))throw b;ge(nv,"Failed to update sequence numbers: "+b)}for(const b of v){const A=b.targetId;if(!b.fromCache){const j=_.xs.get(A),T=j.snapshotVersion,S=j.withLastLimboFreeSnapshotVersion(T);_.xs=_.xs.insert(A,S)}}}(a.localStore,c))}async function uO(n,e){const t=De(n);if(!t.currentUser.isEqual(e)){ge(mv,"User change. New user:",e.toKey());const a=await O0(t.localStore,e);t.currentUser=e,function(c,d){c.Ru.forEach(m=>{m.forEach(p=>{p.reject(new me(re.CANCELLED,d))})}),c.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await fu(t,a.ks)}}function dO(n,e){const t=De(n),a=t.Eu.get(e);if(a&&a.cu)return Ye().add(a.key);{let o=Ye();const c=t.Pu.get(e);if(!c)return o;for(const d of c){const m=t.hu.get(d);o=o.unionWith(m.view.eu)}return o}}function X0(n){const e=De(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=$0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=dO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rO.bind(null,e),e.lu.Y_=KM.bind(null,e.eventManager),e.lu.gu=QM.bind(null,e.eventManager),e}function hO(n){const e=De(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=oO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lO.bind(null,e),e}class Ih{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ef(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return gM(this.persistence,new fM,e.initialUser,this.serializer)}Su(e){return new M0(ev.fi,this.serializer)}bu(e){return new xM}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ih.provider={build:()=>new Ih};class fO extends Ih{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Ze(this.persistence.referenceDelegate instanceof Ch,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new ZD(a,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?In.withCacheSize(this.cacheSizeBytes):In.DEFAULT;return new M0(a=>Ch.fi(a,t),this.serializer)}}class vg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>qN(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=uO.bind(null,this.syncEngine),await GM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new YM}()}createDatastore(e){const t=ef(e.databaseInfo.databaseId),a=function(c){return new CM(c)}(e.databaseInfo);return function(c,d,m,p){return new DM(c,d,m,p)}(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return function(a,o,c,d,m){return new OM(a,o,c,d,m)}(this.localStore,this.datastore,e.asyncQueue,t=>qN(this.syncEngine,t,0),function(){return kN.C()?new kN:new TM}())}createSyncEngine(e,t){return function(o,c,d,m,p,v,_){const b=new JM(o,c,d,m,p,v);return _&&(b.mu=!0),b}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const c=De(o);ge(Rr,"RemoteStore shutting down."),c.da.add(5),await hu(c),c.Ra.shutdown(),c.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}vg.provider={build:()=>new vg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Ra("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new me(re.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,c){const d=De(o),m={documents:c.map(b=>wh(d.serializer,b))},p=await d.Yo("BatchGetDocuments",d.serializer.databaseId,ft.emptyPath(),m,c.length),v=new Map;p.forEach(b=>{const A=kD(d.serializer,b);v.set(A.key.toString(),A)});const _=[];return c.forEach(b=>{const A=v.get(b.toString());Ze(!!A,55234,{key:b}),_.push(A)}),_}(this.datastore,e);return t.forEach(a=>this.recordVersion(a)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(a){this.lastTransactionError=a}this.writtenDocs.add(e.toString())}delete(e){this.write(new Zh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,a)=>{const o=Ne.fromPath(a);this.mutations.push(new _0(o,this.precondition(o)))}),await async function(a,o){const c=De(a),d={writes:o.map(m=>C0(c.serializer,m))};await c.zo("Commit",c.serializer.databaseId,ft.emptyPath(),d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Te(50498,{Uu:e.constructor.name});t=Ce.min()}const a=this.readVersions.get(e.key.toString());if(a){if(!t.isEqual(a))throw new me(re.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ce.min())?rn.exists(!1):rn.updateTime(t):rn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ce.min()))throw new me(re.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rn.updateTime(t)}return rn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e,t,a,o,c){this.asyncQueue=e,this.datastore=t,this.options=a,this.updateFunction=o,this.deferred=c,this.Ku=a.maxAttempts,this.x_=new sv(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new mO(this.datastore),t=this.zu(e);t&&t.then(a=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(a)}).catch(o=>{this.ju(o)}))}).catch(a=>{this.ju(a)})})}zu(e){try{const t=this.updateFunction(e);return!cu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!b0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi="FirestoreClient";class gO{constructor(e,t,a,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=o,this.user=fn.UNAUTHENTICATED,this.clientId=zT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(a,async d=>{ge(wi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(a,d=>(ge(wi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $s;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=cv(t,"Failed to shutdown persistence");e.reject(a)}}),e.promise}}async function kp(n,e){n.asyncQueue.verifyOperationInProgress(),ge(wi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let a=t.initialUser;n.setCredentialChangeListener(async o=>{a.isEqual(o)||(await O0(e.localStore,o),a=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function zN(n,e){n.asyncQueue.verifyOperationInProgress();const t=await vO(n);ge(wi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(a=>LN(e.remoteStore,a)),n.setAppCheckTokenChangeListener((a,o)=>LN(e.remoteStore,o)),n._onlineComponents=e}async function vO(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ge(wi,"Using user provided OfflineComponentProvider");try{await kp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===re.FAILED_PRECONDITION||o.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Xo("Error using user provided cache. Falling back to memory cache: "+t),await kp(n,new Ih)}}else ge(wi,"Using default OfflineComponentProvider"),await kp(n,new fO(void 0));return n._offlineComponents}async function vv(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ge(wi,"Using user provided OnlineComponentProvider"),await zN(n,n._uninitializedComponentsProvider._online)):(ge(wi,"Using default OnlineComponentProvider"),await zN(n,new vg))),n._onlineComponents}function yO(n){return vv(n).then(e=>e.syncEngine)}function _O(n){return vv(n).then(e=>e.datastore)}async function Rh(n){const e=await vv(n),t=e.eventManager;return t.onListen=eO.bind(null,e.syncEngine),t.onUnlisten=sO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=tO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=aO.bind(null,e.syncEngine),t}function bO(n,e,t={}){const a=new $s;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,m,p,v){const _=new gv({next:A=>{_.xu(),d.enqueueAndForget(()=>dv(c,b));const j=A.docs.has(m);!j&&A.fromCache?v.reject(new me(re.UNAVAILABLE,"Failed to get document because the client is offline.")):j&&A.fromCache&&p&&p.source==="server"?v.reject(new me(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(A)},error:A=>v.reject(A)}),b=new fv(Yh(m.path),_,{includeMetadataChanges:!0,Qa:!0});return uv(c,b)}(await Rh(n),n.asyncQueue,e,t,a)),a.promise}function EO(n,e,t={}){const a=new $s;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,m,p,v){const _=new gv({next:A=>{_.xu(),d.enqueueAndForget(()=>dv(c,b)),A.fromCache&&p.source==="server"?v.reject(new me(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(A)},error:A=>v.reject(A)}),b=new fv(m,_,{includeMetadataChanges:!0,Qa:!0});return uv(c,b)}(await Rh(n),n.asyncQueue,e,t,a)),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z0(n,e,t){if(!t)throw new me(re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function NO(n,e,t,a){if(e===!0&&a===!0)throw new me(re.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function GN(n){if(!Ne.isDocumentKey(n))throw new me(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function $N(n){if(Ne.isDocumentKey(n))throw new me(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function sf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(a){return a.constructor?a.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Te(12329,{type:typeof n})}function Tn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=sf(n);throw new me(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0="firestore.googleapis.com",YN=!0;class KN{constructor(e){var t,a;if(e.host===void 0){if(e.ssl!==void 0)throw new me(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=J0,this.ssl=YN}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:YN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=D0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<XD)throw new me(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}NO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=W0((a=e.experimentalLongPollingOptions)!==null&&a!==void 0?a:{}),function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(a,o){return a.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class af{constructor(e,t,a,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new KN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new KN(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(a){if(!a)return new C1;switch(a.type){case"firstParty":return new D1(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new me(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const a=HN.get(t);a&&(ge("ComponentProvider","Removing Datastore"),HN.delete(t),a.terminate())}(this),Promise.resolve()}}function xO(n,e,t,a={}){var o;n=Tn(n,af);const c=kr(e),d=n._getSettings(),m=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),p=`${e}:${t}`;c&&(wg(`https://${p}`),Cg("Firestore",!0)),d.host!==J0&&d.host!==p&&Xo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:p,ssl:c,emulatorOptions:a});if(!Ei(v,m)&&(n._setSettings(v),a.mockUserToken)){let _,b;if(typeof a.mockUserToken=="string")_=a.mockUserToken,b=fn.MOCK_USER;else{_=Kx(a.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const A=a.mockUserToken.sub||a.mockUserToken.user_id;if(!A)throw new me(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new fn(A)}n._authCredentials=new S1(new qT(_,b))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Oa(this.firestore,e,this._query)}}class on{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new bi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new on(this.firestore,e,this._key)}}class bi extends Oa{constructor(e,t,a){super(e,t,Yh(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new on(this.firestore,null,new Ne(e))}withConverter(e){return new bi(this.firestore,e,this._path)}}function Ve(n,e,...t){if(n=vt(n),Z0("collection","path",e),n instanceof af){const a=ft.fromString(e,...t);return $N(a),new bi(n,null,a)}{if(!(n instanceof on||n instanceof bi))throw new me(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ft.fromString(e,...t));return $N(a),new bi(n.firestore,null,a)}}function rt(n,e,...t){if(n=vt(n),arguments.length===1&&(e=zT.newId()),Z0("doc","path",e),n instanceof af){const a=ft.fromString(e,...t);return GN(a),new on(n,null,new Ne(a))}{if(!(n instanceof on||n instanceof bi))throw new me(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ft.fromString(e,...t));return GN(a),new on(n.firestore,n instanceof bi?n.converter:null,new Ne(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN="AsyncQueue";class XN{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new sv(this,"async_queue_retry"),this.rc=()=>{const a=Op();a&&ge(QN,"Visibility state changed to "+a.visibilityState),this.x_.b_()},this.sc=e;const t=Op();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Op();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new $s;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!cl(e))throw e;ge(QN,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(a=>{throw this.Xu=a,this.ec=!1,Ra("INTERNAL UNHANDLED ERROR: ",WN(a)),a}).then(a=>(this.ec=!1,a))));return this.sc=t,t}enqueueAfterDelay(e,t,a){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=lv.createAndSchedule(this,e,t,a,c=>this.uc(c));return this.Zu.push(o),o}oc(){this.Xu&&Te(47125,{cc:WN(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,a)=>t.targetTimeMs-a.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function WN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZN(n){return function(t,a){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of a)if(c in o&&typeof o[c]=="function")return!0;return!1}(n,["next","error","complete"])}class Qs extends af{constructor(e,t,a,o){super(e,t,a,o),this.type="firestore",this._queue=new XN,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new XN(e),this._firestoreClient=void 0,await e}}}function TO(n,e){const t=typeof n=="object"?n:au(),a=typeof n=="string"?n:Eh,o=Ma(t,"firestore").getImmediate({identifier:a});if(!o._initialized){const c=Gx("firestore");c&&xO(o,...c)}return o}function mu(n){if(n._terminated)throw new me(re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||AO(n),n._firestoreClient}function AO(n){var e,t,a;const o=n._freezeSettings(),c=function(m,p,v,_){return new Y1(m,p,v,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,W0(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((a=o.localCache)===null||a===void 0)&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new gO(n._authCredentials,n._appCheckCredentials,n._queue,c,n._componentsProvider&&function(m){const p=m?._online.build();return{_offline:m?._offline.build(p),_online:p}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dr(ln.fromBase64String(e))}catch(t){throw new me(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Dr(ln.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new an(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Fe(this._lat,e._lat)||Fe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(a,o){if(a.length!==o.length)return!1;for(let c=0;c<a.length;++c)if(a[c]!==o[c])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO=/^__.*__$/;class wO{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new Pi(e,this.data,this.fieldMask,t,this.fieldTransforms):new uu(e,this.data,t,this.fieldTransforms)}}class eA{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return new Pi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function tA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Te(40011,{Ic:n})}}class bv{constructor(e,t,a,o,c,d){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=o,c===void 0&&this.Ec(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new bv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Vc(e),o}mc(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Dh(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(tA(this.Ic)&&jO.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class CO{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||ef(e)}bc(e,t,a,o=!1){return new bv({Ic:e,methodName:t,wc:a,path:an.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gu(n){const e=n._freezeSettings(),t=ef(n._databaseId);return new CO(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ev(n,e,t,a,o,c={}){const d=n.bc(c.merge||c.mergeFields?2:0,e,t,o);xv("Data must be an object, but it was:",d,a);const m=aA(a,d);let p,v;if(c.merge)p=new Bn(d.fieldMask),v=d.fieldTransforms;else if(c.mergeFields){const _=[];for(const b of c.mergeFields){const A=yg(e,b,t);if(!d.contains(A))throw new me(re.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);rA(_,A)||_.push(A)}p=new Bn(_),v=d.fieldTransforms.filter(b=>p.covers(b.field))}else p=null,v=d.fieldTransforms;return new wO(new xn(m),p,v)}class of extends rf{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof of}}class Nv extends rf{_toFieldTransform(e){return new _D(e.path,new Wc)}isEqual(e){return e instanceof Nv}}function nA(n,e,t,a){const o=n.bc(1,e,t);xv("Data must be an object, but it was:",o,a);const c=[],d=xn.empty();ki(a,(p,v)=>{const _=Tv(e,p,t);v=vt(v);const b=o.mc(_);if(v instanceof of)c.push(_);else{const A=vu(v,b);A!=null&&(c.push(_),d.set(_,A))}});const m=new Bn(c);return new eA(d,m,o.fieldTransforms)}function sA(n,e,t,a,o,c){const d=n.bc(1,e,t),m=[yg(e,a,t)],p=[o];if(c.length%2!=0)throw new me(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let A=0;A<c.length;A+=2)m.push(yg(e,c[A])),p.push(c[A+1]);const v=[],_=xn.empty();for(let A=m.length-1;A>=0;--A)if(!rA(v,m[A])){const j=m[A];let T=p[A];T=vt(T);const S=d.mc(j);if(T instanceof of)v.push(j);else{const x=vu(T,S);x!=null&&(v.push(j),_.set(j,x))}}const b=new Bn(v);return new eA(_,b,d.fieldTransforms)}function SO(n,e,t,a=!1){return vu(t,n.bc(a?4:3,e))}function vu(n,e){if(iA(n=vt(n)))return xv("Unsupported field value:",e,n),aA(n,e);if(n instanceof rf)return function(a,o){if(!tA(o.Ic))throw o.gc(`${a._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${a._methodName}() is not currently supported inside arrays`);const c=a._toFieldTransform(o);c&&o.fieldTransforms.push(c)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(a,o){const c=[];let d=0;for(const m of a){let p=vu(m,o.fc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}}(n,e)}return function(a,o){if((a=vt(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return gD(o.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const c=qt.fromDate(a);return{timestampValue:jh(o.serializer,c)}}if(a instanceof qt){const c=new qt(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:jh(o.serializer,c)}}if(a instanceof yv)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof Dr)return{bytesValue:T0(o.serializer,a._byteString)};if(a instanceof on){const c=o.databaseId,d=a.firestore._databaseId;if(!d.isEqual(c))throw o.gc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Zg(a.firestore._databaseId||o.databaseId,a._key.path)}}if(a instanceof _v)return function(d,m){return{mapValue:{fields:{[WT]:{stringValue:ZT},[Nh]:{arrayValue:{values:d.toArray().map(v=>{if(typeof v!="number")throw m.gc("VectorValues must only contain numeric values.");return Qg(m.serializer,v)})}}}}}}(a,o);throw o.gc(`Unsupported field value: ${sf(a)}`)}(n,e)}function aA(n,e){const t={};return GT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ki(n,(a,o)=>{const c=vu(o,e.Ac(a));c!=null&&(t[a]=c)}),{mapValue:{fields:t}}}function iA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qt||n instanceof yv||n instanceof Dr||n instanceof on||n instanceof rf||n instanceof _v)}function xv(n,e,t){if(!iA(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const a=sf(t);throw a==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+a)}}function yg(n,e,t){if((e=vt(e))instanceof pu)return e._internalPath;if(typeof e=="string")return Tv(n,e);throw Dh("Field path arguments must be of type string or ",n,!1,void 0,t)}const IO=new RegExp("[~\\*/\\[\\]]");function Tv(n,e,t){if(e.search(IO)>=0)throw Dh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new pu(...e.split("."))._internalPath}catch{throw Dh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Dh(n,e,t,a,o){const c=a&&!a.isEmpty(),d=o!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${a}`),d&&(p+=` in document ${o}`),p+=")"),new me(re.INVALID_ARGUMENT,m+n+p)}function rA(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,t,a,o,c){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new on(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new RO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(lf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class RO extends Mh{data(){return super.data()}}function lf(n,e){return typeof e=="string"?Tv(n,e):e instanceof pu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Av{}class jv extends Av{}function we(n,e,...t){let a=[];e instanceof Av&&a.push(e),a=a.concat(t),function(c){const d=c.filter(p=>p instanceof wv).length,m=c.filter(p=>p instanceof cf).length;if(d>1||d>0&&m>0)throw new me(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a);for(const o of a)n=o._apply(n);return n}class cf extends jv{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new cf(e,t,a)}_apply(e){const t=this._parse(e);return lA(e._query,t),new Oa(e.firestore,e.converter,cg(e._query,t))}_parse(e){const t=gu(e.firestore);return function(c,d,m,p,v,_,b){let A;if(v.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new me(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){ex(b,_);const T=[];for(const S of b)T.push(JN(p,c,S));A={arrayValue:{values:T}}}else A=JN(p,c,b)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||ex(b,_),A=SO(m,d,b,_==="in"||_==="not-in");return kt.create(v,_,A)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function ke(n,e,t){const a=e,o=lf("where",n);return cf._create(o,a,t)}class wv extends Av{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new wv(e,t)}_parse(e){const t=this._queryConstraints.map(a=>a._parse(e)).filter(a=>a.getFilters().length>0);return t.length===1?t[0]:Ns.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,c){let d=o;const m=c.getFlattenedFilters();for(const p of m)lA(d,p),d=cg(d,p)}(e._query,t),new Oa(e.firestore,e.converter,cg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Cv extends jv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Cv(e,t)}_apply(e){const t=function(o,c,d){if(o.startAt!==null)throw new me(re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new me(re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Xc(c,d)}(e._query,this._field,this._direction);return new Oa(e.firestore,e.converter,function(o,c){const d=o.explicitOrderBy.concat([c]);return new ul(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function jn(n,e="asc"){const t=e,a=lf("orderBy",n);return Cv._create(a,t)}class Sv extends jv{constructor(e,t,a){super(),this.type=e,this._limit=t,this._limitType=a}static _create(e,t,a){return new Sv(e,t,a)}_apply(e){return new Oa(e.firestore,e.converter,Th(e._query,this._limit,this._limitType))}}function DO(n){return Sv._create("limit",n,"F")}function JN(n,e,t){if(typeof(t=vt(t))=="string"){if(t==="")throw new me(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!r0(e)&&t.indexOf("/")!==-1)throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(ft.fromString(t));if(!Ne.isDocumentKey(a))throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return fN(n,new Ne(a))}if(t instanceof on)return fN(n,t._key);throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sf(t)}.`)}function ex(n,e){if(!Array.isArray(n)||n.length===0)throw new me(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function lA(n,e){const t=function(o,c){for(const d of o)for(const m of d.getFlattenedFilters())if(c.indexOf(m.op)>=0)return m.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new me(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class cA{convertValue(e,t="none"){switch(Ai(e)){case 0:return null;case 1:return e.booleanValue;case 2:return St(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ti(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Te(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return ki(e,(o,c)=>{a[o]=this.convertValue(c,t)}),a}convertVectorValue(e){var t,a,o;const c=(o=(a=(t=e.fields)===null||t===void 0?void 0:t[Nh].arrayValue)===null||a===void 0?void 0:a.values)===null||o===void 0?void 0:o.map(d=>St(d.doubleValue));return new _v(c)}convertGeoPoint(e){return new yv(St(e.latitude),St(e.longitude))}convertArray(e,t){return(e.values||[]).map(a=>this.convertValue(a,t))}convertServerTimestamp(e,t){switch(t){case"previous":const a=$h(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp(Yc(e));default:return null}}convertTimestamp(e){const t=xi(e);return new qt(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=ft.fromString(e);Ze(R0(a),9688,{name:e});const o=new Kc(a.get(1),a.get(3)),c=new Ne(a.popFirst(5));return o.isEqual(t)||Ra(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(n,e,t){let a;return a=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,a}class MO extends cA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Rv extends Mh{constructor(e,t,a,o,c,d){super(e,t,a,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ch(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(lf("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}}class ch extends Rv{data(e={}){return super.data(e)}}class uA{constructor(e,t,a,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Fo(o.hasPendingWrites,o.fromCache),this.query=a}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(a=>{e.call(t,new ch(this._firestore,this._userDataWriter,a.key,a,new Fo(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map(m=>{const p=new ch(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Fo(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}})}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(m=>c||m.type!==3).map(m=>{const p=new ch(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Fo(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let v=-1,_=-1;return m.type!==0&&(v=d.indexOf(m.doc.key),d=d.delete(m.doc.key)),m.type!==1&&(d=d.add(m.doc),_=d.indexOf(m.doc.key)),{type:OO(m.type),doc:p,oldIndex:v,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function OO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Te(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(n){n=Tn(n,on);const e=Tn(n.firestore,Qs);return bO(mu(e),n._key).then(t=>dA(e,n,t))}class uf extends cA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}function bt(n){n=Tn(n,Oa);const e=Tn(n.firestore,Qs),t=mu(e),a=new uf(e);return oA(n._query),EO(t,n._query).then(o=>new uA(e,a,n,o))}function df(n,e,t){n=Tn(n,on);const a=Tn(n.firestore,Qs),o=Iv(n.converter,e,t);return ff(a,[Ev(gu(a),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,rn.none())])}function xs(n,e,t,...a){n=Tn(n,on);const o=Tn(n.firestore,Qs),c=gu(o);let d;return d=typeof(e=vt(e))=="string"||e instanceof pu?sA(c,"updateDoc",n._key,e,t,a):nA(c,"updateDoc",n._key,e),ff(o,[d.toMutation(n._key,rn.exists(!0))])}function hf(n){return ff(Tn(n.firestore,Qs),[new Zh(n._key,rn.none())])}function hl(n,e){const t=Tn(n.firestore,Qs),a=rt(n),o=Iv(n.converter,e);return ff(t,[Ev(gu(n.firestore),"addDoc",a._key,o,n.converter!==null,{}).toMutation(a._key,rn.exists(!1))]).then(()=>a)}function Ur(n,...e){var t,a,o;n=vt(n);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||ZN(e[d])||(c=e[d],d++);const m={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(ZN(e[d])){const b=e[d];e[d]=(t=b.next)===null||t===void 0?void 0:t.bind(b),e[d+1]=(a=b.error)===null||a===void 0?void 0:a.bind(b),e[d+2]=(o=b.complete)===null||o===void 0?void 0:o.bind(b)}let p,v,_;if(n instanceof on)v=Tn(n.firestore,Qs),_=Yh(n._key.path),p={next:b=>{e[d]&&e[d](dA(v,n,b))},error:e[d+1],complete:e[d+2]};else{const b=Tn(n,Oa);v=Tn(b.firestore,Qs),_=b._query;const A=new uf(v);p={next:j=>{e[d]&&e[d](new uA(v,A,b,j))},error:e[d+1],complete:e[d+2]},oA(n._query)}return function(A,j,T,S){const x=new gv(S),F=new fv(j,x,T);return A.asyncQueue.enqueueAndForget(async()=>uv(await Rh(A),F)),()=>{x.xu(),A.asyncQueue.enqueueAndForget(async()=>dv(await Rh(A),F))}}(mu(v),_,m,p)}function ff(n,e){return function(a,o){const c=new $s;return a.asyncQueue.enqueueAndForget(async()=>iO(await yO(a),o,c)),c.promise}(mu(n),e)}function dA(n,e,t){const a=t.docs.get(e._key),o=new uf(n);return new Rv(n,o,e._key,a,new Fo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO={maxAttempts:5};function Ic(n,e){if((n=vt(n)).firestore!==e)throw new me(re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=gu(e)}get(e){const t=Ic(e,this._firestore),a=new MO(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return Te(24041);const c=o[0];if(c.isFoundDocument())return new Mh(this._firestore,a,c.key,c,t.converter);if(c.isNoDocument())return new Mh(this._firestore,a,t._key,null,t.converter);throw Te(18433,{doc:c})})}set(e,t,a){const o=Ic(e,this._firestore),c=Iv(o.converter,t,a),d=Ev(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,a);return this._transaction.set(o._key,d),this}update(e,t,a,...o){const c=Ic(e,this._firestore);let d;return d=typeof(t=vt(t))=="string"||t instanceof pu?sA(this._dataReader,"Transaction.update",c._key,t,a,o):nA(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,d),this}delete(e){const t=Ic(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO extends PO{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Ic(e,this._firestore),a=new uf(this._firestore);return super.get(e).then(o=>new Rv(this._firestore,a,t._key,o._document,new Fo(!1,!1),t.converter))}}function Dv(n,e,t){n=Tn(n,Qs);const a=Object.assign(Object.assign({},kO),t);return function(c){if(c.maxAttempts<1)throw new me(re.INVALID_ARGUMENT,"Max attempts must be at least 1")}(a),function(c,d,m){const p=new $s;return c.asyncQueue.enqueueAndForget(async()=>{const v=await _O(c);new pO(c.asyncQueue,v,m,d,p).Wu()}),p.promise}(mu(n),o=>e(new LO(n,o)),a)}function nt(){return new Nv("serverTimestamp")}(function(e,t=!0){(function(o){ol=o})(Pr),os(new $n("firestore",(a,{instanceIdentifier:o,options:c})=>{const d=a.getProvider("app").getImmediate(),m=new Qs(new I1(a.getProvider("auth-internal")),new M1(d,a.getProvider("app-check-internal")),function(v,_){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new me(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Kc(v.options.projectId,_)}(d,o),d);return c=Object.assign({useFetchStreams:t},c),m._setSettings(c),m},"PUBLIC").setMultipleInstances(!0)),pn(tN,nN,e),pn(tN,nN,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA="firebasestorage.googleapis.com",VO="storageBucket",UO=2*60*1e3,FO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws extends cs{constructor(e,t,a=0){super(Pp(e),`Firebase Storage: ${t} (${Pp(e)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ws.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Pp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Xs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Xs||(Xs={}));function Pp(n){return"storage/"+n}function qO(){const n="An unknown error occurred, please check the error payload for server response.";return new Ws(Xs.UNKNOWN,n)}function BO(){return new Ws(Xs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function zO(){return new Ws(Xs.CANCELED,"User canceled the upload/download.")}function HO(n){return new Ws(Xs.INVALID_URL,"Invalid URL '"+n+"'.")}function GO(n){return new Ws(Xs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function tx(n){return new Ws(Xs.INVALID_ARGUMENT,n)}function fA(){return new Ws(Xs.APP_DELETED,"The Firebase app was deleted.")}function $O(n){return new Ws(Xs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let a;try{a=bs.makeFromUrl(e,t)}catch{return new bs(e,"")}if(a.path==="")return a;throw GO(e)}static makeFromUrl(e,t){let a=null;const o="([A-Za-z0-9.\\-_]+)";function c(O){O.path.charAt(O.path.length-1)==="/"&&(O.path_=O.path_.slice(0,-1))}const d="(/(.*))?$",m=new RegExp("^gs://"+o+d,"i"),p={bucket:1,path:3};function v(O){O.path_=decodeURIComponent(O.path)}const _="v[A-Za-z0-9_]+",b=t.replace(/[.]/g,"\\."),A="(/([^?#]*).*)?$",j=new RegExp(`^https?://${b}/${_}/b/${o}/o${A}`,"i"),T={bucket:1,path:3},S=t===hA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",F=new RegExp(`^https?://${S}/${o}/${x}`,"i"),V=[{regex:m,indices:p,postModify:c},{regex:j,indices:T,postModify:v},{regex:F,indices:{bucket:1,path:2},postModify:v}];for(let O=0;O<V.length;O++){const U=V[O],W=U.regex.exec(e);if(W){const L=W[U.indices.bucket];let D=W[U.indices.path];D||(D=""),a=new bs(L,D),U.postModify(a);break}}if(a==null)throw HO(e);return a}}class YO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KO(n,e,t){let a=1,o=null,c=null,d=!1,m=0;function p(){return m===2}let v=!1;function _(...x){v||(v=!0,e.apply(null,x))}function b(x){o=setTimeout(()=>{o=null,n(j,p())},x)}function A(){c&&clearTimeout(c)}function j(x,...F){if(v){A();return}if(x){A(),_.call(null,x,...F);return}if(p()||d){A(),_.call(null,x,...F);return}a<64&&(a*=2);let V;m===1?(m=2,V=0):V=(a+Math.random())*1e3,b(V)}let T=!1;function S(x){T||(T=!0,A(),!v&&(o!==null?(x||(m=2),clearTimeout(o),b(0)):x||(m=1)))}return b(0),c=setTimeout(()=>{d=!0,S(!0)},t),S}function QO(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XO(n){return n!==void 0}function nx(n,e,t,a){if(a<e)throw tx(`Invalid value for '${n}'. Expected ${e} or greater.`);if(a>t)throw tx(`Invalid value for '${n}'. Expected ${t} or less.`)}function WO(n){const e=encodeURIComponent;let t="?";for(const a in n)if(n.hasOwnProperty(a)){const o=e(a)+"="+e(n[a]);t=t+o+"&"}return t=t.slice(0,-1),t}var Oh;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Oh||(Oh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZO(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(e,t,a,o,c,d,m,p,v,_,b,A=!0,j=!1){this.url_=e,this.method_=t,this.headers_=a,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=m,this.errorCallback_=p,this.timeout_=v,this.progressCallback_=_,this.connectionFactory_=b,this.retry=A,this.isUsingEmulator=j,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,S)=>{this.resolve_=T,this.reject_=S,this.start_()})}start_(){const e=(a,o)=>{if(o){a(!1,new Wd(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=m=>{const p=m.loaded,v=m.lengthComputable?m.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,v)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const m=c.getErrorCode()===Oh.NO_ERROR,p=c.getStatus();if(!m||ZO(p,this.additionalRetryCodes_)&&this.retry){const _=c.getErrorCode()===Oh.ABORT;a(!1,new Wd(!1,null,_));return}const v=this.successCodes_.indexOf(p)!==-1;a(!0,new Wd(v,c))})},t=(a,o)=>{const c=this.resolve_,d=this.reject_,m=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(m,m.getResponse());XO(p)?c(p):c()}catch(p){d(p)}else if(m!==null){const p=qO();p.serverResponse=m.getErrorText(),this.errorCallback_?d(this.errorCallback_(m,p)):d(p)}else if(o.canceled){const p=this.appDelete_?fA():zO();d(p)}else{const p=BO();d(p)}};this.canceled_?t(!1,new Wd(!1,null,!0)):this.backoffId_=KO(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&QO(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Wd{constructor(e,t,a){this.wasSuccessCode=e,this.connection=t,this.canceled=!!a}}function ek(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function tk(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function nk(n,e){e&&(n["X-Firebase-GMPID"]=e)}function sk(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function ak(n,e,t,a,o,c,d=!0,m=!1){const p=WO(n.urlParams),v=n.url+p,_=Object.assign({},n.headers);return nk(_,e),ek(_,t),tk(_,c),sk(_,a),new JO(v,n.method,_,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,m)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ik(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function rk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,t){this._service=e,t instanceof bs?this._location=t:this._location=bs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new kh(e,t)}get root(){const e=new bs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return rk(this._location.path)}get storage(){return this._service}get parent(){const e=ik(this._location.path);if(e===null)return null;const t=new bs(this._location.bucket,e);return new kh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw $O(e)}}function sx(n,e){const t=e?.[VO];return t==null?null:bs.makeFromBucketSpec(t,n)}function ok(n,e,t,a={}){n.host=`${e}:${t}`;const o=kr(e);o&&(wg(`https://${n.host}/b`),Cg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=a;c&&(n._overrideAuthToken=typeof c=="string"?c:Kx(c,n.app.options.projectId))}class lk{constructor(e,t,a,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=a,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=hA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=UO,this._maxUploadRetryTime=FO,this._requests=new Set,o!=null?this._bucket=bs.makeFromBucketSpec(o,this._host):this._bucket=sx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=bs.makeFromBucketSpec(this._url,e):this._bucket=sx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){nx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){nx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Rn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new kh(this,e)}_makeRequest(e,t,a,o,c=!0){if(this._deleted)return new YO(fA());{const d=ak(e,this._appId,a,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[a,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,a,o).getPromise()}}const ax="@firebase/storage",ix="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA="storage";function ck(n=au(),e){n=vt(n);const a=Ma(n,mA).getImmediate({identifier:e}),o=Gx("storage");return o&&uk(a,...o),a}function uk(n,e,t,a={}){ok(n,e,t,a)}function dk(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new lk(t,a,o,e,Pr)}function hk(){os(new $n(mA,dk,"PUBLIC").setMultipleInstances(!0)),pn(ax,ix,""),pn(ax,ix,"esm2017")}hk();const pA="@firebase/installations",Mv="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA=1e4,vA=`w:${Mv}`,yA="FIS_v2",fk="https://firebaseinstallations.googleapis.com/v1",mk=60*60*1e3,pk="installations",gk="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vk={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Mr=new Ri(pk,gk,vk);function _A(n){return n instanceof cs&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA({projectId:n}){return`${fk}/projects/${n}/installations`}function EA(n){return{token:n.token,requestStatus:2,expiresIn:_k(n.expiresIn),creationTime:Date.now()}}async function NA(n,e){const a=(await e.json()).error;return Mr.create("request-failed",{requestName:n,serverCode:a.code,serverMessage:a.message,serverStatus:a.status})}function xA({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function yk(n,{refreshToken:e}){const t=xA(n);return t.append("Authorization",bk(e)),t}async function TA(n){const e=await n();return e.status>=500&&e.status<600?n():e}function _k(n){return Number(n.replace("s","000"))}function bk(n){return`${yA} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ek({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const a=bA(n),o=xA(n),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={fid:t,authVersion:yA,appId:n.appId,sdkVersion:vA},m={method:"POST",headers:o,body:JSON.stringify(d)},p=await TA(()=>fetch(a,m));if(p.ok){const v=await p.json();return{fid:v.fid||t,registrationStatus:2,refreshToken:v.refreshToken,authToken:EA(v.authToken)}}else throw await NA("Create Installation",p)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AA(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nk(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xk=/^[cdef][\w-]{21}$/,_g="";function Tk(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=Ak(n);return xk.test(t)?t:_g}catch{return _g}}function Ak(n){return Nk(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA=new Map;function wA(n,e){const t=mf(n);CA(t,e),jk(t,e)}function CA(n,e){const t=jA.get(n);if(t)for(const a of t)a(e)}function jk(n,e){const t=wk();t&&t.postMessage({key:n,fid:e}),Ck()}let Ar=null;function wk(){return!Ar&&"BroadcastChannel"in self&&(Ar=new BroadcastChannel("[Firebase] FID Change"),Ar.onmessage=n=>{CA(n.data.key,n.data.fid)}),Ar}function Ck(){jA.size===0&&Ar&&(Ar.close(),Ar=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk="firebase-installations-database",Ik=1,Or="firebase-installations-store";let Lp=null;function Ov(){return Lp||(Lp=Wx(Sk,Ik,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Or)}}})),Lp}async function Ph(n,e){const t=mf(n),o=(await Ov()).transaction(Or,"readwrite"),c=o.objectStore(Or),d=await c.get(t);return await c.put(e,t),await o.done,(!d||d.fid!==e.fid)&&wA(n,e.fid),e}async function SA(n){const e=mf(n),a=(await Ov()).transaction(Or,"readwrite");await a.objectStore(Or).delete(e),await a.done}async function pf(n,e){const t=mf(n),o=(await Ov()).transaction(Or,"readwrite"),c=o.objectStore(Or),d=await c.get(t),m=e(d);return m===void 0?await c.delete(t):await c.put(m,t),await o.done,m&&(!d||d.fid!==m.fid)&&wA(n,m.fid),m}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kv(n){let e;const t=await pf(n.appConfig,a=>{const o=Rk(a),c=Dk(n,o);return e=c.registrationPromise,c.installationEntry});return t.fid===_g?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function Rk(n){const e=n||{fid:Tk(),registrationStatus:0};return IA(e)}function Dk(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject(Mr.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},a=Mk(n,t);return{installationEntry:t,registrationPromise:a}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Ok(n)}:{installationEntry:e}}async function Mk(n,e){try{const t=await Ek(n,e);return Ph(n.appConfig,t)}catch(t){throw _A(t)&&t.customData.serverCode===409?await SA(n.appConfig):await Ph(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Ok(n){let e=await rx(n.appConfig);for(;e.registrationStatus===1;)await AA(100),e=await rx(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:a}=await kv(n);return a||t}return e}function rx(n){return pf(n,e=>{if(!e)throw Mr.create("installation-not-found");return IA(e)})}function IA(n){return kk(n)?{fid:n.fid,registrationStatus:0}:n}function kk(n){return n.registrationStatus===1&&n.registrationTime+gA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pk({appConfig:n,heartbeatServiceProvider:e},t){const a=Lk(n,t),o=yk(n,t),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={installation:{sdkVersion:vA,appId:n.appId}},m={method:"POST",headers:o,body:JSON.stringify(d)},p=await TA(()=>fetch(a,m));if(p.ok){const v=await p.json();return EA(v)}else throw await NA("Generate Auth Token",p)}function Lk(n,{fid:e}){return`${bA(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pv(n,e=!1){let t;const a=await pf(n.appConfig,c=>{if(!RA(c))throw Mr.create("not-registered");const d=c.authToken;if(!e&&Fk(d))return c;if(d.requestStatus===1)return t=Vk(n,e),c;{if(!navigator.onLine)throw Mr.create("app-offline");const m=Bk(c);return t=Uk(n,m),m}});return t?await t:a.authToken}async function Vk(n,e){let t=await ox(n.appConfig);for(;t.authToken.requestStatus===1;)await AA(100),t=await ox(n.appConfig);const a=t.authToken;return a.requestStatus===0?Pv(n,e):a}function ox(n){return pf(n,e=>{if(!RA(e))throw Mr.create("not-registered");const t=e.authToken;return zk(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Uk(n,e){try{const t=await Pk(n,e),a=Object.assign(Object.assign({},e),{authToken:t});return await Ph(n.appConfig,a),t}catch(t){if(_A(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await SA(n.appConfig);else{const a=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Ph(n.appConfig,a)}throw t}}function RA(n){return n!==void 0&&n.registrationStatus===2}function Fk(n){return n.requestStatus===2&&!qk(n)}function qk(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+mk}function Bk(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function zk(n){return n.requestStatus===1&&n.requestTime+gA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hk(n){const e=n,{installationEntry:t,registrationPromise:a}=await kv(e);return a?a.catch(console.error):Pv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gk(n,e=!1){const t=n;return await $k(t),(await Pv(t,e)).token}async function $k(n){const{registrationPromise:e}=await kv(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yk(n){if(!n||!n.options)throw Vp("App Configuration");if(!n.name)throw Vp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Vp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Vp(n){return Mr.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA="installations",Kk="installations-internal",Qk=n=>{const e=n.getProvider("app").getImmediate(),t=Yk(e),a=Ma(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:a,_delete:()=>Promise.resolve()}},Xk=n=>{const e=n.getProvider("app").getImmediate(),t=Ma(e,DA).getImmediate();return{getId:()=>Hk(t),getToken:o=>Gk(t,o)}};function Wk(){os(new $n(DA,Qk,"PUBLIC")),os(new $n(Kk,Xk,"PRIVATE"))}Wk();pn(pA,Mv);pn(pA,Mv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh="analytics",Zk="firebase_id",Jk="origin",eP=60*1e3,tP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Lv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dn=new su("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Gn=new Ri("analytics","Analytics",nP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(n){if(!n.startsWith(Lv)){const e=Gn.create("invalid-gtag-resource",{gtagURL:n});return Dn.warn(e.message),""}return n}function MA(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function aP(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function iP(n,e){const t=aP("firebase-js-sdk-policy",{createScriptURL:sP}),a=document.createElement("script"),o=`${Lv}?l=${n}&id=${e}`;a.src=t?t?.createScriptURL(o):o,a.async=!0,document.head.appendChild(a)}function rP(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function oP(n,e,t,a,o,c){const d=a[o];try{if(d)await e[d];else{const p=(await MA(t)).find(v=>v.measurementId===o);p&&await e[p.appId]}}catch(m){Dn.error(m)}n("config",o,c)}async function lP(n,e,t,a,o){try{let c=[];if(o&&o.send_to){let d=o.send_to;Array.isArray(d)||(d=[d]);const m=await MA(t);for(const p of d){const v=m.find(b=>b.measurementId===p),_=v&&e[v.appId];if(_)c.push(_);else{c=[];break}}}c.length===0&&(c=Object.values(e)),await Promise.all(c),n("event",a,o||{})}catch(c){Dn.error(c)}}function cP(n,e,t,a){async function o(c,...d){try{if(c==="event"){const[m,p]=d;await lP(n,e,t,m,p)}else if(c==="config"){const[m,p]=d;await oP(n,e,t,a,m,p)}else if(c==="consent"){const[m,p]=d;n("consent",m,p)}else if(c==="get"){const[m,p,v]=d;n("get",m,p,v)}else if(c==="set"){const[m]=d;n("set",m)}else n(c,...d)}catch(m){Dn.error(m)}}return o}function uP(n,e,t,a,o){let c=function(...d){window[a].push(arguments)};return window[o]&&typeof window[o]=="function"&&(c=window[o]),window[o]=cP(c,n,e,t),{gtagCore:c,wrappedGtag:window[o]}}function dP(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Lv)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP=30,fP=1e3;class mP{constructor(e={},t=fP){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const OA=new mP;function pP(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function gP(n){var e;const{appId:t,apiKey:a}=n,o={method:"GET",headers:pP(a)},c=tP.replace("{app-id}",t),d=await fetch(c,o);if(d.status!==200&&d.status!==304){let m="";try{const p=await d.json();!((e=p.error)===null||e===void 0)&&e.message&&(m=p.error.message)}catch{}throw Gn.create("config-fetch-failed",{httpStatus:d.status,responseMessage:m})}return d.json()}async function vP(n,e=OA,t){const{appId:a,apiKey:o,measurementId:c}=n.options;if(!a)throw Gn.create("no-app-id");if(!o){if(c)return{measurementId:c,appId:a};throw Gn.create("no-api-key")}const d=e.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},m=new bP;return setTimeout(async()=>{m.abort()},eP),kA({appId:a,apiKey:o,measurementId:c},d,m,e)}async function kA(n,{throttleEndTimeMillis:e,backoffCount:t},a,o=OA){var c;const{appId:d,measurementId:m}=n;try{await yP(a,e)}catch(p){if(m)return Dn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:d,measurementId:m};throw p}try{const p=await gP(n);return o.deleteThrottleMetadata(d),p}catch(p){const v=p;if(!_P(v)){if(o.deleteThrottleMetadata(d),m)return Dn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${v?.message}]`),{appId:d,measurementId:m};throw p}const _=Number((c=v?.customData)===null||c===void 0?void 0:c.httpStatus)===503?jE(t,o.intervalMillis,hP):jE(t,o.intervalMillis),b={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return o.setThrottleMetadata(d,b),Dn.debug(`Calling attemptFetch again in ${_} millis`),kA(n,b,a,o)}}function yP(n,e){return new Promise((t,a)=>{const o=Math.max(e-Date.now(),0),c=setTimeout(t,o);n.addEventListener(()=>{clearTimeout(c),a(Gn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function _P(n){if(!(n instanceof cs)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class bP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function EP(n,e,t,a,o){if(o&&o.global){n("event",t,a);return}else{const c=await e,d=Object.assign(Object.assign({},a),{send_to:c});n("event",t,d)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NP(){if(Fh())try{await qh()}catch(n){return Dn.warn(Gn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Dn.warn(Gn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function xP(n,e,t,a,o,c,d){var m;const p=vP(n);p.then(j=>{t[j.measurementId]=j.appId,n.options.measurementId&&j.measurementId!==n.options.measurementId&&Dn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${j.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(j=>Dn.error(j)),e.push(p);const v=NP().then(j=>{if(j)return a.getId()}),[_,b]=await Promise.all([p,v]);dP(c)||iP(c,_.measurementId),o("js",new Date);const A=(m=d?.config)!==null&&m!==void 0?m:{};return A[Jk]="firebase",A.update=!0,b!=null&&(A[Zk]=b),o("config",_.measurementId,A),_.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e){this.app=e}_delete(){return delete Vc[this.app.options.appId],Promise.resolve()}}let Vc={},lx=[];const cx={};let Up="dataLayer",AP="gtag",ux,PA,dx=!1;function jP(){const n=[];if(Sg()&&n.push("This is a browser extension environment."),Ig()||n.push("Cookies are not available."),n.length>0){const e=n.map((a,o)=>`(${o+1}) ${a}`).join(" "),t=Gn.create("invalid-analytics-context",{errorInfo:e});Dn.warn(t.message)}}function wP(n,e,t){jP();const a=n.options.appId;if(!a)throw Gn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Dn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Gn.create("no-api-key");if(Vc[a]!=null)throw Gn.create("already-exists",{id:a});if(!dx){rP(Up);const{wrappedGtag:c,gtagCore:d}=uP(Vc,lx,cx,Up,AP);PA=c,ux=d,dx=!0}return Vc[a]=xP(n,lx,cx,e,ux,Up,t),new TP(n)}function CP(n=au()){n=vt(n);const e=Ma(n,Lh);return e.isInitialized()?e.getImmediate():SP(n)}function SP(n,e={}){const t=Ma(n,Lh);if(t.isInitialized()){const o=t.getImmediate();if(Ei(e,t.getOptions()))return o;throw Gn.create("already-initialized")}return t.initialize({options:e})}async function IP(){if(Sg()||!Ig()||!Fh())return!1;try{return await qh()}catch{return!1}}function RP(n,e,t,a){n=vt(n),EP(PA,Vc[n.app.options.appId],e,t,a).catch(o=>Dn.error(o))}const hx="@firebase/analytics",fx="0.10.16";function DP(){os(new $n(Lh,(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return wP(a,o,t)},"PUBLIC")),os(new $n("analytics-internal",n,"PRIVATE")),pn(hx,fx),pn(hx,fx,"esm2017");function n(e){try{const t=e.getProvider(Lh).getImmediate();return{logEvent:(a,o,c)=>RP(t,a,o,c)}}catch(t){throw Gn.create("interop-component-reg-failed",{reason:t})}}}DP();var bg,mx,gf=function(){var n=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(n&&n.responseStart>0&&n.responseStart<performance.now())return n},LA=function(n){if(document.readyState==="loading")return"loading";var e=gf();if(e){if(n<e.domInteractive)return"loading";if(e.domContentLoadedEventStart===0||n<e.domContentLoadedEventStart)return"dom-interactive";if(e.domComplete===0||n<e.domComplete)return"dom-content-loaded"}return"complete"},MP=function(n){var e=n.nodeName;return n.nodeType===1?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},Vv=function(n,e){var t="";try{for(;n&&n.nodeType!==9;){var a=n,o=a.id?"#"+a.id:MP(a)+(a.classList&&a.classList.value&&a.classList.value.trim()&&a.classList.value.trim().length?"."+a.classList.value.trim().replace(/\s+/g,"."):"");if(t.length+o.length>(e||100)-1)return t||o;if(t=t?o+">"+t:o,a.id)break;n=a.parentNode}}catch{}return t},VA=-1,OP=function(){return VA},yu=function(n){addEventListener("pageshow",function(e){e.persisted&&(VA=e.timeStamp,n(e))},!0)},Uv=function(){var n=gf();return n&&n.activationStart||0},Ci=function(n,e){var t=gf(),a="navigate";return OP()>=0?a="back-forward-cache":t&&(document.prerendering||Uv()>0?a="prerender":document.wasDiscarded?a="restore":t.type&&(a=t.type.replace(/_/g,"-"))),{name:n,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:a}},fl=function(n,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(n)){var a=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return a.observe(Object.assign({type:n,buffered:!0},t||{})),a}}catch{}},Si=function(n,e,t,a){var o,c;return function(d){e.value>=0&&(d||a)&&((c=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=c,e.rating=function(m,p){return m>p[1]?"poor":m>p[0]?"needs-improvement":"good"}(e.value,t),n(e))}},Fv=function(n){requestAnimationFrame(function(){return requestAnimationFrame(function(){return n()})})},vf=function(n){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&n()})},qv=function(n){var e=!1;return function(){e||(n(),e=!0)}},qo=-1,px=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},Vh=function(n){document.visibilityState==="hidden"&&qo>-1&&(qo=n.type==="visibilitychange"?n.timeStamp:0,kP())},gx=function(){addEventListener("visibilitychange",Vh,!0),addEventListener("prerenderingchange",Vh,!0)},kP=function(){removeEventListener("visibilitychange",Vh,!0),removeEventListener("prerenderingchange",Vh,!0)},UA=function(){return qo<0&&(qo=px(),gx(),yu(function(){setTimeout(function(){qo=px(),gx()},0)})),{get firstHiddenTime(){return qo}}},Bv=function(n){document.prerendering?addEventListener("prerenderingchange",function(){return n()},!0):n()},vx=[1800,3e3],PP=function(n,e){e=e||{},Bv(function(){var t,a=UA(),o=Ci("FCP"),c=fl("paint",function(d){d.forEach(function(m){m.name==="first-contentful-paint"&&(c.disconnect(),m.startTime<a.firstHiddenTime&&(o.value=Math.max(m.startTime-Uv(),0),o.entries.push(m),t(!0)))})});c&&(t=Si(n,o,vx,e.reportAllChanges),yu(function(d){o=Ci("FCP"),t=Si(n,o,vx,e.reportAllChanges),Fv(function(){o.value=performance.now()-d.timeStamp,t(!0)})}))})},yx=[.1,.25],LP=function(n,e){(function(t,a){a=a||{},PP(qv(function(){var o,c=Ci("CLS",0),d=0,m=[],p=function(_){_.forEach(function(b){if(!b.hadRecentInput){var A=m[0],j=m[m.length-1];d&&b.startTime-j.startTime<1e3&&b.startTime-A.startTime<5e3?(d+=b.value,m.push(b)):(d=b.value,m=[b])}}),d>c.value&&(c.value=d,c.entries=m,o())},v=fl("layout-shift",p);v&&(o=Si(t,c,yx,a.reportAllChanges),vf(function(){p(v.takeRecords()),o(!0)}),yu(function(){d=0,c=Ci("CLS",0),o=Si(t,c,yx,a.reportAllChanges),Fv(function(){return o()})}),setTimeout(o,0))}))})(function(t){var a=function(o){var c,d={};if(o.entries.length){var m=o.entries.reduce(function(v,_){return v&&v.value>_.value?v:_});if(m&&m.sources&&m.sources.length){var p=(c=m.sources).find(function(v){return v.node&&v.node.nodeType===1})||c[0];p&&(d={largestShiftTarget:Vv(p.node),largestShiftTime:m.startTime,largestShiftValue:m.value,largestShiftSource:p,largestShiftEntry:m,loadState:LA(m.startTime)})}}return Object.assign(o,{attribution:d})}(t);n(a)},e)},FA=0,Fp=1/0,Zd=0,VP=function(n){n.forEach(function(e){e.interactionId&&(Fp=Math.min(Fp,e.interactionId),Zd=Math.max(Zd,e.interactionId),FA=Zd?(Zd-Fp)/7+1:0)})},qA=function(){return bg?FA:performance.interactionCount||0},UP=function(){"interactionCount"in performance||bg||(bg=fl("event",VP,{type:"event",buffered:!0,durationThreshold:0}))},vs=[],Uc=new Map,BA=0,FP=function(){var n=Math.min(vs.length-1,Math.floor((qA()-BA)/50));return vs[n]},zA=[],qP=function(n){if(zA.forEach(function(o){return o(n)}),n.interactionId||n.entryType==="first-input"){var e=vs[vs.length-1],t=Uc.get(n.interactionId);if(t||vs.length<10||n.duration>e.latency){if(t)n.duration>t.latency?(t.entries=[n],t.latency=n.duration):n.duration===t.latency&&n.startTime===t.entries[0].startTime&&t.entries.push(n);else{var a={id:n.interactionId,latency:n.duration,entries:[n]};Uc.set(a.id,a),vs.push(a)}vs.sort(function(o,c){return c.latency-o.latency}),vs.length>10&&vs.splice(10).forEach(function(o){return Uc.delete(o.id)})}}},zv=function(n){var e=self.requestIdleCallback||self.setTimeout,t=-1;return n=qv(n),document.visibilityState==="hidden"?n():(t=e(n),vf(n)),t},_x=[200,500],BP=function(n,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},Bv(function(){var t;UP();var a,o=Ci("INP"),c=function(m){zv(function(){m.forEach(qP);var p=FP();p&&p.latency!==o.value&&(o.value=p.latency,o.entries=p.entries,a())})},d=fl("event",c,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});a=Si(n,o,_x,e.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),vf(function(){c(d.takeRecords()),a(!0)}),yu(function(){BA=qA(),vs.length=0,Uc.clear(),o=Ci("INP"),a=Si(n,o,_x,e.reportAllChanges)}))}))},Ko=[],pi=[],Eg=0,Hv=new WeakMap,Qo=new Map,Ng=-1,zP=function(n){Ko=Ko.concat(n),HA()},HA=function(){Ng<0&&(Ng=zv(HP))},HP=function(){Qo.size>10&&Qo.forEach(function(d,m){Uc.has(m)||Qo.delete(m)});var n=vs.map(function(d){return Hv.get(d.entries[0])}),e=pi.length-50;pi=pi.filter(function(d,m){return m>=e||n.includes(d)});for(var t=new Set,a=0;a<pi.length;a++){var o=pi[a];GA(o.startTime,o.processingEnd).forEach(function(d){t.add(d)})}var c=Ko.length-1-50;Ko=Ko.filter(function(d,m){return d.startTime>Eg&&m>c||t.has(d)}),Ng=-1};zA.push(function(n){n.interactionId&&n.target&&!Qo.has(n.interactionId)&&Qo.set(n.interactionId,n.target)},function(n){var e,t=n.startTime+n.duration;Eg=Math.max(Eg,n.processingEnd);for(var a=pi.length-1;a>=0;a--){var o=pi[a];if(Math.abs(t-o.renderTime)<=8){(e=o).startTime=Math.min(n.startTime,e.startTime),e.processingStart=Math.min(n.processingStart,e.processingStart),e.processingEnd=Math.max(n.processingEnd,e.processingEnd),e.entries.push(n);break}}e||(e={startTime:n.startTime,processingStart:n.processingStart,processingEnd:n.processingEnd,renderTime:t,entries:[n]},pi.push(e)),(n.interactionId||n.entryType==="first-input")&&Hv.set(n,e),HA()});var GA=function(n,e){for(var t,a=[],o=0;t=Ko[o];o++)if(!(t.startTime+t.duration<n)){if(t.startTime>e)break;a.push(t)}return a},GP=function(n,e){mx||(mx=fl("long-animation-frame",zP)),BP(function(t){var a=function(o){var c=o.entries[0],d=Hv.get(c),m=c.processingStart,p=d.processingEnd,v=d.entries.sort(function(x,F){return x.processingStart-F.processingStart}),_=GA(c.startTime,p),b=o.entries.find(function(x){return x.target}),A=b&&b.target||Qo.get(c.interactionId),j=[c.startTime+c.duration,p].concat(_.map(function(x){return x.startTime+x.duration})),T=Math.max.apply(Math,j),S={interactionTarget:Vv(A),interactionTargetElement:A,interactionType:c.name.startsWith("key")?"keyboard":"pointer",interactionTime:c.startTime,nextPaintTime:T,processedEventEntries:v,longAnimationFrameEntries:_,inputDelay:m-c.startTime,processingDuration:p-m,presentationDelay:Math.max(T-p,0),loadState:LA(c.startTime)};return Object.assign(o,{attribution:S})}(t);n(a)},e)},bx=[2500,4e3],qp={},$P=function(n,e){(function(t,a){a=a||{},Bv(function(){var o,c=UA(),d=Ci("LCP"),m=function(_){a.reportAllChanges||(_=_.slice(-1)),_.forEach(function(b){b.startTime<c.firstHiddenTime&&(d.value=Math.max(b.startTime-Uv(),0),d.entries=[b],o())})},p=fl("largest-contentful-paint",m);if(p){o=Si(t,d,bx,a.reportAllChanges);var v=qv(function(){qp[d.id]||(m(p.takeRecords()),p.disconnect(),qp[d.id]=!0,o(!0))});["keydown","click"].forEach(function(_){addEventListener(_,function(){return zv(v)},{once:!0,capture:!0})}),vf(v),yu(function(_){d=Ci("LCP"),o=Si(t,d,bx,a.reportAllChanges),Fv(function(){d.value=performance.now()-_.timeStamp,qp[d.id]=!0,o(!0)})})}})})(function(t){var a=function(o){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:o.value};if(o.entries.length){var d=gf();if(d){var m=d.activationStart||0,p=o.entries[o.entries.length-1],v=p.url&&performance.getEntriesByType("resource").filter(function(T){return T.name===p.url})[0],_=Math.max(0,d.responseStart-m),b=Math.max(_,v?(v.requestStart||v.startTime)-m:0),A=Math.max(b,v?v.responseEnd-m:0),j=Math.max(A,p.startTime-m);c={element:Vv(p.element),timeToFirstByte:_,resourceLoadDelay:b-_,resourceLoadDuration:A-b,elementRenderDelay:j-A,navigationEntry:d,lcpEntry:p},p.url&&(c.url=p.url),v&&(c.lcpResourceEntry=v)}}return Object.assign(o,{attribution:c})}(t);n(a)},e)};const Ex="@firebase/performance",xg="0.7.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A=xg,YP="FB-PERF-TRACE-START",KP="FB-PERF-TRACE-STOP",Tg="FB-PERF-TRACE-MEASURE",YA="_wt_",KA="_fp",QA="_fcp",XA="_fid",WA="_lcp",QP="lcp_element",ZA="_inp",XP="inp_interactionTarget",JA="_cls",WP="cls_largestShiftTarget",ej="@firebase/performance/config",tj="@firebase/performance/configexpire",ZP="performance",nj="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},mn=new Ri(ZP,nj,JP);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii=new su(nj);Ii.logLevel=$e.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bp,sj;class zt{constructor(e){if(this.window=e,!e)throw mn.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=$P,this.onINP=GP,this.onCLS=LP}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,t,a){!this.performance||!this.performance.measure||this.performance.measure(e,t,a)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!Ig()?(Ii.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):Fh()?!0:(Ii.info("IndexedDB is not supported by current browser"),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(o=>{for(const c of o.getEntries())t(c)}).observe({entryTypes:[e]})}static getInstance(){return Bp===void 0&&(Bp=new zt(sj)),Bp}}function e2(n){sj=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aj;function t2(n){const e=n.getId();return e.then(t=>{aj=t}),e}function Gv(){return aj}function n2(n){const e=n.getToken();return e.then(t=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nx(n,e){const t=n.length-e.length;if(t<0||t>1)throw mn.create("invalid String merger input");const a=[];for(let o=0;o<n.length;o++)a.push(n.charAt(o)),e.length>o&&a.push(e.charAt(o));return a.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zp;class zn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Nx("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Nx("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return zp===void 0&&(zp=new zn),zp}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fc;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.VISIBLE=1]="VISIBLE",n[n.HIDDEN=2]="HIDDEN"})(Fc||(Fc={}));const s2=["firebase_","google_","ga_"],a2=new RegExp("^[a-zA-Z]\\w*$"),i2=40,r2=100;function o2(){const n=zt.getInstance().navigator;return n?.serviceWorker?n.serviceWorker.controller?2:3:1}function l2(){switch(zt.getInstance().document.visibilityState){case"visible":return Fc.VISIBLE;case"hidden":return Fc.HIDDEN;default:return Fc.UNKNOWN}}function c2(){const e=zt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function u2(n){return n.length===0||n.length>i2?!1:!s2.some(t=>n.startsWith(t))&&!!n.match(a2)}function d2(n){return n.length!==0&&n.length<=r2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ij(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.appId;if(!t)throw mn.create("no app id");return t}function h2(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.projectId;if(!t)throw mn.create("no project id");return t}function f2(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.apiKey;if(!t)throw mn.create("no api key");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2="0.0.1",gs={loggingEnabled:!0},p2="FIREBASE_INSTALLATIONS_AUTH";function g2(n,e){const t=v2();return t?(xx(t),Promise.resolve()):b2(n,e).then(xx).then(a=>y2(a),()=>{})}function v2(){const n=zt.getInstance().localStorage;if(!n)return;const e=n.getItem(tj);if(!e||!E2(e))return;const t=n.getItem(ej);if(t)try{return JSON.parse(t)}catch{return}}function y2(n){const e=zt.getInstance().localStorage;!n||!e||(e.setItem(ej,JSON.stringify(n)),e.setItem(tj,String(Date.now()+zn.getInstance().configTimeToLive*60*60*1e3)))}const _2="Could not fetch config, will use default configs";function b2(n,e){return n2(n.installations).then(t=>{const a=h2(n.app),o=f2(n.app),c=`https://firebaseremoteconfig.googleapis.com/v1/projects/${a}/namespaces/fireperf:fetch?key=${o}`,d=new Request(c,{method:"POST",headers:{Authorization:`${p2} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:ij(n.app),app_version:$A,sdk_version:m2})});return fetch(d).then(m=>{if(m.ok)return m.json();throw mn.create("RC response not ok")})}).catch(()=>{Ii.info(_2)})}function xx(n){if(!n)return n;const e=zn.getInstance(),t=n.entries||{};return t.fpr_enabled!==void 0?e.loggingEnabled=String(t.fpr_enabled)==="true":e.loggingEnabled=gs.loggingEnabled,t.fpr_log_source?e.logSource=Number(t.fpr_log_source):gs.logSource&&(e.logSource=gs.logSource),t.fpr_log_endpoint_url?e.logEndPointUrl=t.fpr_log_endpoint_url:gs.logEndPointUrl&&(e.logEndPointUrl=gs.logEndPointUrl),t.fpr_log_transport_key?e.transportKey=t.fpr_log_transport_key:gs.transportKey&&(e.transportKey=gs.transportKey),t.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(t.fpr_vc_network_request_sampling_rate):gs.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=gs.networkRequestsSamplingRate),t.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(t.fpr_vc_trace_sampling_rate):gs.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=gs.tracesSamplingRate),e.logTraceAfterSampling=Tx(e.tracesSamplingRate),e.logNetworkAfterSampling=Tx(e.networkRequestsSamplingRate),n}function E2(n){return Number(n)>Date.now()}function Tx(n){return Math.random()<=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $v=1,Hp;function rj(n){return $v=2,Hp=Hp||x2(n),Hp}function N2(){return $v===3}function x2(n){return T2().then(()=>t2(n.installations)).then(e=>g2(n,e)).then(()=>Ax(),()=>Ax())}function T2(){const n=zt.getInstance().document;return new Promise(e=>{if(n&&n.readyState!=="complete"){const t=()=>{n.readyState==="complete"&&(n.removeEventListener("readystatechange",t),e())};n.addEventListener("readystatechange",t)}else e()})}function Ax(){$v=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oj=10*1e3,A2=5.5*1e3,j2=1e3,lj=3;let uh=lj,wr=[],jx=!1;function w2(){jx||(Yv(A2),jx=!0)}function Yv(n){setTimeout(()=>{uh<=0||(wr.length>0&&cj(),Yv(oj))},n)}function cj(){const n=wr.splice(0,j2),e=n.map(a=>({source_extension_json_proto3:a.message,event_time_ms:String(a.eventTime)})),t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:zn.getInstance().logSource,log_event:e};C2(t).then(()=>{uh=lj}).catch(()=>{wr=[...n,...wr],uh--,Ii.info(`Tries left: ${uh}.`),Yv(oj)})}function C2(n){const e=zn.getInstance().getFlTransportFullUrl(),t=JSON.stringify(n);return navigator.sendBeacon&&navigator.sendBeacon(e,t)?Promise.resolve():fetch(e,{method:"POST",body:t,keepalive:!0}).then()}function S2(n){if(!n.eventTime||!n.message)throw mn.create("invalid cc log");wr=[...wr,n]}function I2(n){return(...e)=>{const t=n(...e);S2({message:t,eventTime:Date.now()})}}function R2(){for(;wr.length>0;)cj()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qc;function uj(n,e){qc||(qc={send:I2(O2),flush:R2}),qc.send(n,e)}function Jd(n){const e=zn.getInstance();!e.instrumentationEnabled&&n.isAuto||!e.dataCollectionEnabled&&!n.isAuto||zt.getInstance().requiredApisAvailable()&&(N2()?Gp(n):rj(n.performanceController).then(()=>Gp(n),()=>Gp(n)))}function D2(){qc&&qc.flush()}function Gp(n){if(!Gv())return;const e=zn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||uj(n,1)}function M2(n){const e=zn.getInstance();if(!e.instrumentationEnabled)return;const t=n.url,a=e.logEndPointUrl.split("?")[0],o=e.flTransportEndpointUrl.split("?")[0];t===a||t===o||!e.loggingEnabled||!e.logNetworkAfterSampling||uj(n,0)}function O2(n,e){return e===0?k2(n):P2(n)}function k2(n){const e={url:n.url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},t={application_info:dj(n.performanceController.app),network_request_metric:e};return JSON.stringify(t)}function P2(n){const e={name:n.name,is_auto:n.isAuto,client_start_time_us:n.startTimeUs,duration_us:n.durationUs};Object.keys(n.counters).length!==0&&(e.counters=n.counters);const t=n.getAttributes();Object.keys(t).length!==0&&(e.custom_attributes=t);const a={application_info:dj(n.performanceController.app),trace_metric:e};return JSON.stringify(a)}function dj(n){return{google_app_id:ij(n),app_instance_id:Gv(),web_app_info:{sdk_version:$A,page_url:zt.getInstance().getUrl(),service_worker_status:o2(),visibility_state:l2(),effective_connection_type:c2()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wx(n,e){const t=e;if(!t||t.responseStart===void 0)return;const a=zt.getInstance().getTimeOrigin(),o=Math.floor((t.startTime+a)*1e3),c=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,d=Math.floor((t.responseEnd-t.startTime)*1e3),m=t.name&&t.name.split("?")[0],p={performanceController:n,url:m,responsePayloadBytes:t.transferSize,startTimeUs:o,timeToResponseInitiatedUs:c,timeToResponseCompletedUs:d};M2(p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2=100,V2="_",U2=[KA,QA,XA,WA,JA,ZA];function F2(n,e){return n.length===0||n.length>L2?!1:e&&e.startsWith(YA)&&U2.indexOf(n)>-1||!n.startsWith(V2)}function q2(n){const e=Math.floor(n);return e<n&&Ii.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,t,a=!1,o){this.performanceController=e,this.name=t,this.isAuto=a,this.state=1,this.customAttributes={},this.counters={},this.api=zt.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${YP}-${this.randomId}-${this.name}`,this.traceStopMark=`${KP}-${this.randomId}-${this.name}`,this.traceMeasure=o||`${Tg}-${this.randomId}-${this.name}`,o&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw mn.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw mn.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Jd(this)}record(e,t,a){if(e<=0)throw mn.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw mn.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(t*1e3),this.startTimeUs=Math.floor(e*1e3),a&&a.attributes&&(this.customAttributes=Object.assign({},a.attributes)),a&&a.metrics)for(const o of Object.keys(a.metrics))isNaN(Number(a.metrics[o]))||(this.counters[o]=Math.floor(Number(a.metrics[o])));Jd(this)}incrementMetric(e,t=1){this.counters[e]===void 0?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(F2(e,this.name))this.counters[e]=q2(t??0);else throw mn.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const a=u2(e),o=d2(t);if(a&&o){this.customAttributes[e]=t;return}if(!a)throw mn.create("invalid attribute name",{attributeName:e});if(!o)throw mn.create("invalid attribute value",{attributeValue:t})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(t.duration*1e3),this.startTimeUs=Math.floor((t.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,t,a,o,c){const d=zt.getInstance().getUrl();if(!d)return;const m=new eu(e,YA+d,!0),p=Math.floor(zt.getInstance().getTimeOrigin()*1e3);m.setStartTime(p),t&&t[0]&&(m.setDuration(Math.floor(t[0].duration*1e3)),m.putMetric("domInteractive",Math.floor(t[0].domInteractive*1e3)),m.putMetric("domContentLoadedEventEnd",Math.floor(t[0].domContentLoadedEventEnd*1e3)),m.putMetric("loadEventEnd",Math.floor(t[0].loadEventEnd*1e3)));const v="first-paint",_="first-contentful-paint";if(a){const b=a.find(j=>j.name===v);b&&b.startTime&&m.putMetric(KA,Math.floor(b.startTime*1e3));const A=a.find(j=>j.name===_);A&&A.startTime&&m.putMetric(QA,Math.floor(A.startTime*1e3)),c&&m.putMetric(XA,Math.floor(c*1e3))}this.addWebVitalMetric(m,WA,QP,o.lcp),this.addWebVitalMetric(m,JA,WP,o.cls),this.addWebVitalMetric(m,ZA,XP,o.inp),Jd(m),D2()}static addWebVitalMetric(e,t,a,o){o&&(e.putMetric(t,Math.floor(o.value*1e3)),o.elementAttribution&&e.putAttribute(a,o.elementAttribution))}static createUserTimingTrace(e,t){const a=new eu(e,t,!1,t);Jd(a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dh={},Cx=!1,hj;function Sx(n){Gv()&&(setTimeout(()=>z2(n),0),setTimeout(()=>B2(n),0),setTimeout(()=>H2(n),0))}function B2(n){const e=zt.getInstance(),t=e.getEntriesByType("resource");for(const a of t)wx(n,a);e.setupObserver("resource",a=>wx(n,a))}function z2(n){const e=zt.getInstance();"onpagehide"in window?e.document.addEventListener("pagehide",()=>$p(n)):e.document.addEventListener("unload",()=>$p(n)),e.document.addEventListener("visibilitychange",()=>{e.document.visibilityState==="hidden"&&$p(n)}),e.onFirstInputDelay&&e.onFirstInputDelay(t=>{hj=t}),e.onLCP(t=>{var a;dh.lcp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.element}}),e.onCLS(t=>{var a;dh.cls={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.largestShiftTarget}}),e.onINP(t=>{var a;dh.inp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.interactionTarget}})}function H2(n){const e=zt.getInstance(),t=e.getEntriesByType("measure");for(const a of t)Ix(n,a);e.setupObserver("measure",a=>Ix(n,a))}function Ix(n,e){const t=e.name;t.substring(0,Tg.length)!==Tg&&eu.createUserTimingTrace(n,t)}function $p(n){if(!Cx){Cx=!0;const e=zt.getInstance(),t=e.getEntriesByType("navigation"),a=e.getEntriesByType("paint");setTimeout(()=>{eu.createOobTrace(n,t,a,dh,hj)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(e?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),e?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),zt.getInstance().requiredApisAvailable()?qh().then(t=>{t&&(w2(),rj(this).then(()=>Sx(this),()=>Sx(this)),this.initialized=!0)}).catch(t=>{Ii.info(`Environment doesn't support IndexedDB: ${t}`)}):Ii.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){zn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return zn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){zn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return zn.getInstance().dataCollectionEnabled}}const $2="[DEFAULT]";function Y2(n=au()){return n=vt(n),Ma(n,"performance").getImmediate()}const K2=(n,{options:e})=>{const t=n.getProvider("app").getImmediate(),a=n.getProvider("installations-internal").getImmediate();if(t.name!==$2)throw mn.create("FB not default");if(typeof window>"u")throw mn.create("no window");e2(window);const o=new G2(t,a);return o._init(e),o};function Q2(){os(new $n("performance",K2,"PUBLIC")),pn(Ex,xg),pn(Ex,xg,"esm2017")}Q2();const X2={apiKey:"AIzaSyCbU834quCY8hjSffRwljJLgZrcxK8i2F4",authDomain:"liquidacionapp-62962.firebaseapp.com",projectId:"liquidacionapp-62962",storageBucket:"liquidacionapp-62962.firebasestorage.app",messagingSenderId:"851382130132",appId:"1:851382130132:web:eaba38fab449f14fb5b241",measurementId:void 0},tu=Zx(X2),Bc=T1(tu),ve=TO(tu);ck(tu);let W2=null,Z2=null;try{IP().then(n=>{n&&(W2=CP(tu))}).catch(()=>{console.warn("Firebase Analytics no est soportado en este entorno")}),typeof window<"u"&&(Z2=Y2(tu))}catch(n){console.warn("Error al inicializar Firebase Analytics/Performance:",n)}const ys={ADMIN:"admin",CONTADOR:"contador",CLIENTE:"cliente"},ht={MANAGE_INVENTORY:"canManageInventory",CREATE_MOVEMENTS:"canCreateMovements",VIEW_ALL_MOVEMENTS:"canViewAllMovements",MANAGE_VEHICLES:"canManageVehicles",MANAGE_MAINTENANCE:"canManageMaintenance",MANAGE_SUPPLIERS:"canManageSuppliers",VIEW_REPORTS:"canViewReports",EXPORT_REPORTS:"canExportReports",MODIFY_SETTINGS:"canModifySettings"},J2="contacto.evert@gmail.com",fj=n=>{switch(n){case ys.ADMIN:return{[ht.MANAGE_INVENTORY]:!0,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!0,[ht.MANAGE_VEHICLES]:!0,[ht.MANAGE_MAINTENANCE]:!0,[ht.MANAGE_SUPPLIERS]:!0,[ht.VIEW_REPORTS]:!0,[ht.EXPORT_REPORTS]:!0,[ht.MODIFY_SETTINGS]:!0};case ys.CONTADOR:return{[ht.MANAGE_INVENTORY]:!0,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!0,[ht.MANAGE_VEHICLES]:!1,[ht.MANAGE_MAINTENANCE]:!0,[ht.MANAGE_SUPPLIERS]:!1,[ht.VIEW_REPORTS]:!0,[ht.EXPORT_REPORTS]:!0,[ht.MODIFY_SETTINGS]:!1};case ys.CLIENTE:default:return{[ht.MANAGE_INVENTORY]:!1,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!1,[ht.MANAGE_VEHICLES]:!1,[ht.MANAGE_MAINTENANCE]:!1,[ht.MANAGE_SUPPLIERS]:!1,[ht.VIEW_REPORTS]:!1,[ht.EXPORT_REPORTS]:!1,[ht.MODIFY_SETTINGS]:!1}}},eL=n=>n===J2?ys.ADMIN:ys.CLIENTE,nl=()=>"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/invitations",tL=()=>{const n="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let e="";for(let t=0;t<8;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},nL=async(n,e)=>{try{const t=await yf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden crear invitaciones"};let a,o=!1,c=0;for(;!o&&c<10;){a=tL();const p=we(Ve(ve,nl()),ke("code","==",a));(await bt(p)).empty&&(o=!0),c++}if(!o)return{success:!1,error:"No se pudo generar un cdigo nico"};const d=rt(Ve(ve,nl())),m={code:a,targetEmail:n.email.toLowerCase(),targetRole:n.role||ys.CLIENTE,targetName:n.name||"",status:"pending",appContext:"combustibles",expiresAt:new Date(Date.now()+7*24*60*60*1e3),createdAt:nt(),createdBy:e,usedAt:null,usedBy:null};return await df(d,m),console.log(" Invitacin creada:",{code:a,email:n.email,role:n.role}),{success:!0,invitation:{id:d.id,code:a,...m}}}catch(t){return console.error("Error creating invitation:",t),{success:!1,error:t.message}}},mj=async n=>{try{const e=we(Ve(ve,nl()),ke("code","==",n.toUpperCase()),ke("status","==","pending")),t=await bt(e);if(t.empty)return{success:!1,error:"Cdigo de invitacin invlido o expirado"};const a=t.docs[0],o=a.data(),c=new Date,d=o.expiresAt.toDate();return c>d?{success:!1,error:"Cdigo de invitacin expirado"}:{success:!0,invitation:{id:a.id,...o}}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},sL=async(n,e)=>{try{const t=rt(ve,nl(),n);return await xs(t,{status:"used",usedAt:nt(),usedBy:e}),{success:!0}}catch(t){return console.error("Error marking invitation as used:",t),{success:!1,error:t.message}}},aL=async n=>{try{const e=await yf(n);if(!e.success||e.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden ver invitaciones"};const t=we(Ve(ve,nl())),a=await bt(t),o=[];return a.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,d)=>{const m=c.createdAt?.toDate()||new Date(0);return(d.createdAt?.toDate()||new Date(0))-m}),{success:!0,invitations:o}}catch(e){return console.error("Error getting invitations:",e),{success:!1,error:e.message}}},iL=async(n,e)=>{try{const t=await yf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden cancelar invitaciones"};const a=rt(ve,nl(),n);return await xs(a,{status:"cancelled",cancelledAt:nt(),cancelledBy:e}),{success:!0}}catch(t){return console.error("Error cancelling invitation:",t),{success:!1,error:t.message}}},rL=n=>fj(n.targetRole),pj=async(n,e={})=>{const t=rt(ve,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const a=await Li(t);if(a.exists())return{success:!0,userData:a.data(),isNewUser:!1};{const o=eL(n.email),c={uid:n.uid,email:n.email,displayName:n.displayName||"",photoURL:n.photoURL||"",role:o,emailVerified:n.emailVerified,combustiblesPermissions:fj(o),createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...e};return await df(t,c),{success:!0,userData:c,isNewUser:!0}}}catch(a){return console.error("Error creating/updating user profile:",a),{success:!1,error:a.message}}},Rx=async(n,e,t={})=>{const a=rt(ve,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const o=await Li(a);if(o.exists())return{success:!0,userData:o.data(),isNewUser:!1};const c=await mj(e);if(!c.success)return c;const d=c.invitation;if(d.targetEmail!==n.email.toLowerCase())return{success:!1,error:"El cdigo de invitacin no corresponde a este email"};const m={uid:n.uid,email:n.email,displayName:n.displayName||d.targetName||"",photoURL:n.photoURL||"",role:d.targetRole,emailVerified:n.emailVerified,combustiblesPermissions:rL(d),invitationUsed:d.id,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...t};return await df(a,m),await sL(d.id,n.uid),console.log(" Usuario creado con invitacin:",{email:n.email,role:d.targetRole,invitationCode:d.code}),{success:!0,userData:m,isNewUser:!0}}catch(o){return console.error("Error creating user profile with invitation:",o),{success:!1,error:o.message}}},yf=async n=>{try{const e=rt(ve,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n),t=await Li(e);return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"Usuario no encontrado"}}catch(e){return console.error("Error fetching user profile:",e),{success:!1,error:e.message}}},Fr="combustibles_movements",jr="combustibles_inventory",pe={ENTRADA:"entrada",SALIDA:"salida",TRANSFERENCIA:"transferencia",AJUSTE:"ajuste"},ze={PENDIENTE:"pendiente",COMPLETADO:"completado",CANCELADO:"cancelado"},gj=async n=>{try{lL(n);const e={...n,createdAt:nt(),updatedAt:nt(),status:ze.COMPLETADO,approvedAt:nt(),totalValue:bj(n),effectiveDate:n.effectiveDate||nt()},t=await Dv(ve,async a=>{const o=rt(Ve(ve,Fr));return a.set(o,e),await Ej(a,e,o.id),o.id});return console.log(" Movimiento creado exitosamente:",t),t}catch(e){throw console.error(" Error al crear movimiento:",e),new Error(`Error al crear movimiento: ${e.message}`)}},vj=async(n={})=>{try{let e=Ve(ve,Fr);n.type&&(e=we(e,ke("type","==",n.type))),n.status&&(e=we(e,ke("status","==",n.status))),n.fuelType&&(e=we(e,ke("fuelType","==",n.fuelType))),n.vehicleId&&(e=we(e,ke("vehicleId","==",n.vehicleId))),e=we(e,jn("createdAt","desc"));const t=await bt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,effectiveDate:o.data().effectiveDate?.toDate?.()||o.data().effectiveDate})}),a}catch(e){throw console.error(" Error al obtener movimientos:",e),new Error(`Error al obtener movimientos: ${e.message}`)}},Kv=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=rt(ve,Fr,n),t=await Li(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate?.()||t.data().createdAt,updatedAt:t.data().updatedAt?.toDate?.()||t.data().updatedAt,effectiveDate:t.data().effectiveDate?.toDate?.()||t.data().effectiveDate}:null}catch(e){throw console.error(" Error al obtener movimiento:",e),new Error(`Error al obtener movimiento: ${e.message}`)}},Qv=async(n,e)=>{try{if(!n)throw new Error("ID de movimiento requerido");const t={...e,updatedAt:nt(),...e.quantity||e.unitPrice?{totalValue:bj(e)}:{}},a=rt(ve,Fr,n);await xs(a,t),console.log(" Movimiento actualizado exitosamente")}catch(t){throw console.error(" Error al actualizar movimiento:",t),new Error(`Error al actualizar movimiento: ${t.message}`)}},oL=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=await Kv(n);if(!e)throw new Error("Movimiento no encontrado");await Dv(ve,async t=>{const a=rt(ve,Fr,n);e.status===ze.COMPLETADO&&await cL(t,e),t.delete(a)}),console.log(" Movimiento eliminado y cambios de inventario revertidos exitosamente")}catch(e){throw console.error(" Error al eliminar movimiento:",e),new Error(`Error al eliminar movimiento: ${e.message}`)}},Xv=(n,e={})=>{try{let t=Ve(ve,Fr);return e.type&&(t=we(t,ke("type","==",e.type))),e.status&&(t=we(t,ke("status","==",e.status))),t=we(t,jn("createdAt","desc")),Ur(t,a=>{const o=[];a.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,effectiveDate:c.data().effectiveDate?.toDate?.()||c.data().effectiveDate})}),n(o)},a=>{console.error(" Error en suscripcin de movimientos:",a),n([],a)})}catch(t){throw console.error(" Error al configurar suscripcin:",t),new Error(`Error en suscripcin: ${t.message}`)}},yj=async n=>{try{const e=await Kv(n);if(!e)throw new Error("Movimiento no encontrado");if(e.status!==ze.PENDIENTE)throw new Error("Solo se pueden aprobar movimientos pendientes");await Dv(ve,async t=>{const a=rt(ve,Fr,n);t.update(a,{status:ze.COMPLETADO,approvedAt:nt(),updatedAt:nt()}),await Ej(t,e,n)}),console.log(" Movimiento aprobado exitosamente")}catch(e){throw console.error(" Error al aprobar movimiento:",e),new Error(`Error al aprobar movimiento: ${e.message}`)}},_j=async(n={})=>{try{const e=await vj(n),t={totalMovements:e.length,byType:{},byStatus:{},byFuelType:{},totalValue:0,totalQuantity:0,averageValue:0,thisMonth:0,lastMonth:0,thisWeek:0},a=new Date,o=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()-1,1),d=new Date(a.setDate(a.getDate()-a.getDay()));return e.forEach(m=>{t.byType[m.type]=(t.byType[m.type]||0)+1,t.byStatus[m.status]=(t.byStatus[m.status]||0)+1,t.byFuelType[m.fuelType]=(t.byFuelType[m.fuelType]||0)+1,t.totalValue+=m.totalValue||0,t.totalQuantity+=m.quantity||0;const p=new Date(m.createdAt);p>=o&&t.thisMonth++,p>=c&&p<o&&t.lastMonth++,p>=d&&t.thisWeek++}),t.averageValue=t.totalMovements>0?t.totalValue/t.totalMovements:0,t}catch(e){throw console.error(" Error al calcular estadsticas:",e),new Error(`Error al calcular estadsticas: ${e.message}`)}},lL=n=>{const e=["type","fuelType","quantity","unitPrice"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!Object.values(pe).includes(n.type))throw new Error("Tipo de movimiento invlido");if(n.quantity<=0)throw new Error("La cantidad debe ser mayor a cero");if(n.unitPrice<0)throw new Error("El precio unitario no puede ser negativo");if(n.type===pe.SALIDA&&!n.vehicleId)throw new Error("Las salidas deben tener un vehculo asociado");if(n.type===pe.TRANSFERENCIA&&!n.destinationLocation)throw new Error("Las transferencias deben tener una ubicacin destino")},bj=n=>(n.quantity||0)*(n.unitPrice||0),Ej=async(n,e,t)=>{try{let a=e.location||"principal";e.type===pe.ENTRADA&&(a=e.destinationLocation||"principal");const o=we(Ve(ve,jr),ke("fuelType","==",e.fuelType),ke("location","==",a)),c=await bt(o);let d,m,p=0;if(c.empty)if(e.type===pe.ENTRADA)console.log(` Creando inventario automtico para ${e.fuelType} en ${a}`),d=rt(Ve(ve,jr)),m={fuelType:e.fuelType,location:a,capacity:1e3,currentStock:0,minStock:50,unitPrice:e.unitPrice||0,createdAt:nt(),updatedAt:nt(),isActive:!0},n.set(d,m),p=e.quantity;else throw new Error(`No se encontr inventario para ${e.fuelType} en ${a}`);else{const v=c.docs[0];m=v.data(),d=rt(ve,jr,v.id),p=m.currentStock}switch(e.type){case pe.ENTRADA:p+=e.quantity;break;case pe.SALIDA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la salida");break;case pe.AJUSTE:p+=e.quantity,p<0&&(p=0);break;case pe.TRANSFERENCIA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la transferencia");break}n.update(d,{currentStock:p,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:nt()},updatedAt:nt()})}catch(a){throw console.error(" Error al actualizar inventario:",a),a}},cL=async(n,e)=>{try{console.log(" Revirtiendo cambios de inventario para movimiento:",e.id);let t;switch(e.type){case pe.ENTRADA:t=e.destinationLocation||"principal";break;case pe.SALIDA:case pe.AJUSTE:t=e.location||"principal";break;case pe.TRANSFERENCIA:t=e.location||"principal";break;default:t=e.location||e.destinationLocation||"principal"}console.log(` Buscando inventario: ${e.fuelType} en ${t}`);const a=we(Ve(ve,jr),ke("fuelType","==",e.fuelType),ke("location","==",t)),o=await bt(a);if(o.empty){console.warn(` No se encontr inventario para ${e.fuelType} en ${t}`);const p=we(Ve(ve,jr),ke("fuelType","==",e.fuelType)),v=await bt(p);if(v.empty)throw console.error(` No existe inventario para ${e.fuelType} en ninguna ubicacin`),new Error(`No se puede revertir: no existe inventario para ${e.fuelType} en ninguna ubicacin. Movimiento hurfano detectado.`);console.log(` Usando inventario fallback en ${v.docs[0].data().location}`);const _=v.docs[0],b=_.data(),A=rt(ve,jr,_.id);await Dx(n,A,b,e);return}const c=o.docs[0],d=c.data(),m=rt(ve,jr,c.id);await Dx(n,m,d,e)}catch(t){throw console.error(" Error al revertir cambios de inventario:",t),new Error(`Error al revertir inventario: ${t.message}`)}},Dx=async(n,e,t,a)=>{try{let o=t.currentStock;switch(a.type){case pe.ENTRADA:o-=a.quantity,o<0&&(console.warn(" Advertencia: La reversin resulta en stock negativo, ajustando a 0"),o=0);break;case pe.SALIDA:o+=a.quantity;break;case pe.AJUSTE:o-=a.quantity,o<0&&(console.warn(" Advertencia: La reversin de ajuste resulta en stock negativo, ajustando a 0"),o=0);break;case pe.TRANSFERENCIA:o+=a.quantity;break;default:throw new Error(`Tipo de movimiento no soportado para reversin: ${a.type}`)}n.update(e,{currentStock:o,lastMovement:{movementId:null,type:"reversion",quantity:a.quantity,originalType:a.type,date:nt(),note:`Reversin de movimiento ${a.id} - Ubicacin original: ${a.location||a.destinationLocation||"no especificada"}`},updatedAt:nt()}),console.log(` Inventario revertido exitosamente. Stock anterior: ${t.currentStock}, Nuevo stock: ${o}`)}catch(o){throw console.error(" Error en procesamiento de reversin:",o),o}},Mx={createMovement:gj,getAllMovements:vj,getMovement:Kv,updateMovement:Qv,deleteMovement:oL,subscribeToMovements:Xv,approveMovement:yj,getMovementsStats:_j,MOVEMENT_TYPES:pe,MOVEMENT_STATUS:ze},Nn={DIESEL:"diesel",GASOLINE:"gasoline",ACPM:"acpm",LUBRICANTS:"lubricants",TWO_STROKE:"two_stroke",MIXED:"mixed"},sl={[Nn.DIESEL]:{name:"Disel",description:"Combustible para maquinaria pesada",unit:"galones",category:"Combustible",color:"#fbbf24",icon:"",density:.85,priceUnit:"COP/galn"},[Nn.GASOLINE]:{name:"Gasolina",description:"Combustible para vehculos livianos",unit:"galones",category:"Combustible",color:"#ef4444",icon:"",density:.75,priceUnit:"COP/galn"},[Nn.ACPM]:{name:"ACPM",description:"Aceite Combustible Para Motor",unit:"galones",category:"Combustible",color:"#8b5cf6",icon:"",density:.85,priceUnit:"COP/galn"},[Nn.LUBRICANTS]:{name:"Lubricantes",description:"Aceites y lubricantes para mantenimiento",unit:"litros",category:"Mantenimiento",color:"#06b6d4",icon:"",density:.9,priceUnit:"COP/litro"},[Nn.TWO_STROKE]:{name:"Mezcla 2T",description:"Mezcla para motores de 2 tiempos (motosierras)",unit:"litros",category:"Especializado",color:"#10b981",icon:"",density:.78,priceUnit:"COP/litro"},[Nn.MIXED]:{name:"Mixto",description:"Compatible con mltiples tipos de combustible",unit:"galones",category:"Flexible",color:"#64748b",icon:"",density:.8,priceUnit:"COP/galn"}},En={CRITICAL:"critical",LOW:"low",MEDIUM:"medium",HIGH:"high",FULL:"full"},Bo={[En.CRITICAL]:{label:"Crtico",color:"#dc2626",icon:"",threshold:.1},[En.LOW]:{label:"Bajo",color:"#ea580c",icon:"",threshold:.25},[En.MEDIUM]:{label:"Medio",color:"#ca8a04",icon:"",threshold:.5},[En.HIGH]:{label:"Alto",color:"#16a34a",icon:"",threshold:.75},[En.FULL]:{label:"Completo",color:"#059669",icon:"",threshold:1}},Nj=(n,e)=>{if(e===0)return En.CRITICAL;const t=n/e;return t<Bo[En.CRITICAL].threshold?En.CRITICAL:t<Bo[En.LOW].threshold?En.LOW:t<Bo[En.MEDIUM].threshold?En.MEDIUM:t<Bo[En.HIGH].threshold?En.HIGH:En.FULL},al="combustibles_inventory",uL=async(n,e)=>{try{const t=sl[n.fuelType];if(!t)return{success:!1,error:"Tipo de combustible no vlido"};const a=we(Ve(ve,al),ke("fuelType","==",n.fuelType),ke("location","==",n.location));if(!(await bt(a)).empty)return{success:!1,error:`Ya existe ${t.name} en ${n.location}`};const c={fuelType:n.fuelType,name:t.name,description:n.description||t.description,currentStock:Number(n.currentStock)||0,maxCapacity:Number(n.maxCapacity),minThreshold:Number(n.minThreshold)||n.maxCapacity*.15,unit:t.unit,location:n.location,pricePerUnit:Number(n.pricePerUnit)||0,supplier:n.supplier||"",status:n.status||"active",createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await hl(Ve(ve,al),c)).id,...c},message:`${t.name} agregado al inventario exitosamente`}}catch(t){return console.error("Error creating inventory item:",t),{success:!1,error:t.message}}},xj=async()=>{try{const n=we(Ve(ve,al),jn("fuelType","asc")),e=await bt(n),t=[];return e.forEach(a=>{const o=a.data();t.push({id:a.id,...o,stockLevel:Nj(o.currentStock,o.maxCapacity),stockPercentage:Math.round(o.currentStock/o.maxCapacity*100),needsRestock:o.currentStock<=o.minThreshold})}),{success:!0,data:t}}catch(n){return console.error("Error fetching inventory items:",n),{success:!1,error:n.message}}},dL=async(n,e,t)=>{try{const a=rt(ve,al,n);if(!(await Li(a)).exists())return{success:!1,error:"Item no encontrado"};const c={...e,lastUpdated:new Date,updatedBy:t};return delete c.id,delete c.createdAt,delete c.createdBy,await xs(a,c),{success:!0,message:"Item actualizado exitosamente",data:{id:n,...c}}}catch(a){return console.error("Error updating inventory item:",a),{success:!1,error:a.message}}},hL=async n=>{try{const e=rt(ve,al,n);return(await Li(e)).exists()?(await hf(e),{success:!0,message:"Item eliminado exitosamente"}):{success:!1,error:"Item no encontrado"}}catch(e){return console.error("Error deleting inventory item:",e),{success:!1,error:e.message}}},Tj=n=>{const e=we(Ve(ve,al),jn("fuelType","asc"));return Ur(e,t=>{const a=[];t.forEach(o=>{const c=o.data();a.push({id:o.id,...c,stockLevel:Nj(c.currentStock,c.maxCapacity),stockPercentage:Math.round(c.currentStock/c.maxCapacity*100),needsRestock:c.currentStock<=c.minThreshold})}),n(a)},t=>{console.error("Error in inventory subscription:",t),n(null,t)})},fL=async()=>{try{const n=await xj();if(!n.success)return n;const e=n.data,t={totalItems:e.length,activeItems:e.filter(a=>a.status==="active").length,lowStockItems:e.filter(a=>a.needsRestock).length,totalValue:e.reduce((a,o)=>a+o.currentStock*o.pricePerUnit,0),averageStockLevel:e.length>0?Math.round(e.reduce((a,o)=>a+o.stockPercentage,0)/e.length):0,byFuelType:{}};return e.forEach(a=>{t.byFuelType[a.fuelType]||(t.byFuelType[a.fuelType]={count:0,totalStock:0,totalCapacity:0,totalValue:0}),t.byFuelType[a.fuelType].count++,t.byFuelType[a.fuelType].totalStock+=a.currentStock,t.byFuelType[a.fuelType].totalCapacity+=a.maxCapacity,t.byFuelType[a.fuelType].totalValue+=a.currentStock*a.pricePerUnit}),{success:!0,data:t}}catch(n){return console.error("Error calculating inventory stats:",n),{success:!1,error:n.message}}},rs=[{id:"maquinaria_pesada",name:"Maquinaria Pesada",description:"Excavadoras, bulldozers, cargadores, gras",icon:"",color:"#FF6B35",fuelTypes:["Diesel","ACPM"],fields:["enginePower","operatingWeight","bucketCapacity"]},{id:"transporte",name:"Transporte",description:"Camiones, camionetas, volquetas",icon:"",color:"#2E86AB",fuelTypes:["Diesel","ACPM","Gasolina"],fields:["plateNumber","loadCapacity","enginePower"]},{id:"herramientas_motorizadas",name:"Herramientas Motorizadas",description:"Motosierras, guadaas, fumigadoras",icon:"",color:"#A23B72",fuelTypes:["Gasolina","Mixto"],fields:["enginePower","weight"]},{id:"equipos_bombeo",name:"Equipos de Bombeo",description:"Motobombas, hidrolavadoras, plantas elctricas",icon:"",color:"#F18F01",fuelTypes:["Diesel","Gasolina"],fields:["flow","pressure","enginePower"]},{id:"vehiculos_ligeros",name:"Vehculos Ligeros",description:"Motocicletas, cuatrimotos, vehculos de apoyo",icon:"",color:"#C73E1D",fuelTypes:["Gasolina"],fields:["plateNumber","enginePower"]},{id:"agricola",name:"Agrcola/Forestal",description:"Tractores, asperjadoras, equipos forestales",icon:"",color:"#2F7D32",fuelTypes:["Diesel","ACPM"],fields:["enginePower","hasHourMeter","implementType"]},{id:"otros",name:"Otros",description:"Equipos especializados y otros vehculos",icon:"",color:"#616161",fuelTypes:["Diesel","Gasolina","ACPM","Mixto"],fields:["enginePower"]}],Le={ACTIVO:"activo",MANTENIMIENTO:"mantenimiento",INACTIVO:"inactivo",REPARACION:"reparacion",FUERA_DE_SERVICIO:"fuera_de_servicio"},Aj={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},Ag=[{key:"plateNumber",label:"Nmero de Placa",type:"text",icon:""},{key:"enginePower",label:"Potencia del Motor (HP)",type:"number",icon:""},{key:"fuelCapacity",label:"Capacidad de Combustible (Litros)",type:"number",icon:""},{key:"operatingWeight",label:"Peso Operativo (Toneladas)",type:"number",icon:""},{key:"loadCapacity",label:"Capacidad de Carga (Toneladas)",type:"number",icon:""},{key:"bucketCapacity",label:"Capacidad de Balde (m)",type:"number",icon:""},{key:"hasHourMeter",label:"Tiene Hormetro",type:"boolean",icon:""},{key:"currentHours",label:"Horas Actuales",type:"number",icon:"",dependsOn:"hasHourMeter"},{key:"implementType",label:"Tipo de Implemento",type:"text",icon:""},{key:"flow",label:"Caudal (L/min)",type:"number",icon:""},{key:"pressure",label:"Presin (PSI)",type:"number",icon:""},{key:"weight",label:"Peso (Kg)",type:"number",icon:""}],Ox=(n,e=[])=>{const t=e.find(a=>a.id===n);return t||rs.find(a=>a.id===n)||null},jj=(n=[])=>{const e=rs.map(a=>a.id),t=n.filter(a=>!e.includes(a.id));return[...rs,...t]},wj=n=>{const e=[];return(!n.id||typeof n.id!="string")&&e.push("ID de categora requerido y debe ser texto"),(!n.name||typeof n.name!="string")&&e.push("Nombre de categora requerido y debe ser texto"),n.name&&n.name.length<2&&e.push("Nombre debe tener al menos 2 caracteres"),n.fuelTypes&&!Array.isArray(n.fuelTypes)&&e.push("Tipos de combustible debe ser un array"),n.fields&&!Array.isArray(n.fields)&&e.push("Campos debe ser un array"),{isValid:e.length===0,errors:e}},Cj=(n,e=[])=>{const t=n.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"");let a=t,o=1;for(;e.some(c=>c.id===a);)a=`${t}_${o}`,o++;return a},ml="combustibles_vehicles",gt={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},Sj=async n=>{try{if(mL(n),await Zv(n.vehicleId))throw new Error(`El cdigo de vehculo '${n.vehicleId}' ya existe`);const t={...n,createdAt:nt(),updatedAt:nt(),status:n.status||Le.ACTIVO,totalFuelConsumed:0,totalHoursWorked:0,totalMovements:0,lastMovementDate:null,estimatedConsumptionPerHour:Dj(n)},a=await hl(Ve(ve,ml),t);return console.log(" Vehculo creado exitosamente:",a.id),a.id}catch(e){throw console.error(" Error al crear vehculo:",e),new Error(`Error al crear vehculo: ${e.message}`)}},Wv=async(n={})=>{try{let e=Ve(ve,ml);n.type&&(e=we(e,ke("type","==",n.type))),n.status&&(e=we(e,ke("status","==",n.status))),n.fuelType&&(e=we(e,ke("fuelType","==",n.fuelType))),n.location&&(e=we(e,ke("currentLocation","==",n.location))),e=we(e,jn("vehicleId","asc"));const t=await bt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,lastMovementDate:o.data().lastMovementDate?.toDate?.()||o.data().lastMovementDate,lastMaintenanceDate:o.data().lastMaintenanceDate?.toDate?.()||o.data().lastMaintenanceDate})}),a}catch(e){throw console.error(" Error al obtener vehculos:",e),new Error(`Error al obtener vehculos: ${e.message}`)}},Zv=async n=>{try{const e=we(Ve(ve,ml),ke("vehicleId","==",n)),t=await bt(e);if(t.empty)return null;const a=t.docs[0];return{id:a.id,...a.data(),createdAt:a.data().createdAt?.toDate?.()||a.data().createdAt,updatedAt:a.data().updatedAt?.toDate?.()||a.data().updatedAt,lastMovementDate:a.data().lastMovementDate?.toDate?.()||a.data().lastMovementDate,lastMaintenanceDate:a.data().lastMaintenanceDate?.toDate?.()||a.data().lastMaintenanceDate}}catch(e){throw console.error(" Error al buscar vehculo por cdigo:",e),new Error(`Error al buscar vehculo: ${e.message}`)}},Ij=async(n,e)=>{try{if(!n)throw new Error("ID de vehculo requerido");if(e.vehicleId){const o=await Zv(e.vehicleId);if(o&&o.id!==n)throw new Error(`El cdigo de vehculo '${e.vehicleId}' ya existe`)}const t={...e,updatedAt:nt(),...e.enginePower||e.type?{estimatedConsumptionPerHour:Dj(e)}:{}},a=rt(ve,ml,n);await xs(a,t),console.log(" Vehculo actualizado exitosamente")}catch(t){throw console.error(" Error al actualizar vehculo:",t),new Error(`Error al actualizar vehculo: ${t.message}`)}},Jv=(n,e={})=>{try{let t=Ve(ve,ml);const a=[];e.category&&a.push(ke("category","==",e.category)),e.status&&a.push(ke("status","==",e.status)),e.fuelType&&a.push(ke("fuelType","==",e.fuelType)),e.currentLocation&&a.push(ke("currentLocation","==",e.currentLocation)),a.forEach(c=>{t=we(t,c)}),t=we(t,jn("updatedAt","desc"));let o=null;return Ur(t,c=>{const d=Date.now();if(o&&d-o<500)return;o=d;const m=[],p={added:[],modified:[],removed:[]};c.docChanges().forEach(v=>{const _={id:v.doc.id,...v.doc.data(),createdAt:v.doc.data().createdAt?.toDate?.()||v.doc.data().createdAt,updatedAt:v.doc.data().updatedAt?.toDate?.()||v.doc.data().updatedAt,lastMovementDate:v.doc.data().lastMovementDate?.toDate?.()||v.doc.data().lastMovementDate,lastMaintenanceDate:v.doc.data().lastMaintenanceDate?.toDate?.()||v.doc.data().lastMaintenanceDate,lastHourMeterDate:v.doc.data().lastHourMeterDate?.toDate?.()||v.doc.data().lastHourMeterDate};v.type==="added"?p.added.push(_):v.type==="modified"?p.modified.push(_):v.type==="removed"&&p.removed.push({id:v.doc.id})}),c.forEach(v=>{m.push({id:v.id,...v.data(),createdAt:v.data().createdAt?.toDate?.()||v.data().createdAt,updatedAt:v.data().updatedAt?.toDate?.()||v.data().updatedAt,lastMovementDate:v.data().lastMovementDate?.toDate?.()||v.data().lastMovementDate,lastMaintenanceDate:v.data().lastMaintenanceDate?.toDate?.()||v.data().lastMaintenanceDate,lastHourMeterDate:v.data().lastHourMeterDate?.toDate?.()||v.data().lastHourMeterDate})}),n(m,null,p)},c=>{console.error(" Error en suscripcin de vehculos:",c),n([],c)})}catch(t){throw console.error(" Error al configurar suscripcin:",t),new Error(`Error en suscripcin: ${t.message}`)}},Rj=async(n={})=>{try{const e=await Wv(n),t={totalVehicles:e.length,byType:{},byStatus:{},byFuelType:{},totalFuelConsumed:0,totalHoursWorked:0,averageConsumption:0,mostActiveVehicle:null,leastActiveVehicle:null};let a=0,o=1/0;return e.forEach(c=>{t.byType[c.type]=(t.byType[c.type]||0)+1,t.byStatus[c.status]=(t.byStatus[c.status]||0)+1,t.byFuelType[c.fuelType]=(t.byFuelType[c.fuelType]||0)+1,t.totalFuelConsumed+=c.totalFuelConsumed||0,t.totalHoursWorked+=c.totalHoursWorked||0;const d=c.totalMovements||0;d>a&&(a=d,t.mostActiveVehicle=c),d<o&&d>0&&(o=d,t.leastActiveVehicle=c)}),t.totalHoursWorked>0&&(t.averageConsumption=t.totalFuelConsumed/t.totalHoursWorked),t}catch(e){throw console.error(" Error al calcular estadsticas:",e),new Error(`Error al calcular estadsticas: ${e.message}`)}},mL=n=>{const e=["vehicleId","name","type","fuelType"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!n.type||n.type.trim().length===0)throw new Error("Tipo de vehculo requerido");if(!Object.values(gt).includes(n.fuelType))throw new Error("Tipo de combustible invlido");if(n.status&&!Object.values(Le).includes(n.status))throw new Error("Estado de vehculo invlido");if(n.enginePower&&n.enginePower<=0)throw new Error("La potencia del motor debe ser mayor a cero");if(n.fuelCapacity&&n.fuelCapacity<=0)throw new Error("La capacidad de combustible debe ser mayor a cero")},Dj=n=>{const{type:e,enginePower:t,fuelType:a}=n,o={excavadora:.04,bulldozer:.05,cargador:.035,camion:.03,camioneta:.03,grua:.045,motosierra:.02,tractor:.025,volqueta:.035,motobomba:.035,fumigadora:.025,guadana:.02,motocicleta:.015,planta_electrica:.08,otros:.03},c={[gt.DIESEL]:1,[gt.GASOLINA]:1.2,[gt.ACPM]:.95,[gt.MIXTO]:1.1},d=o[e]||.03,m=c[a]||1;return d*(t||100)*m},pL=async n=>{try{const e=we(Ve(ve,ml),ke("category","==",n));return(await bt(e)).size}catch(e){return console.error(" Error al contar vehculos por categora:",e),0}},Mj=Object.freeze(Object.defineProperty({__proto__:null,FUEL_COMPATIBILITY:gt,FUEL_TYPES:Aj,VEHICLE_STATUS:Le,countVehiclesByCategory:pL,createVehicle:Sj,getAllVehicles:Wv,getVehicleByCode:Zv,getVehiclesStats:Rj,subscribeToVehicles:Jv,updateVehicle:Ij},Symbol.toStringTag,{value:"Module"})),Hs="combustibles_suppliers",gL=async(n,e)=>{try{const t=we(Ve(ve,Hs),ke("name","==",n.name.trim()));if(!(await bt(t)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${n.name}"`};if(n.taxId){const d=we(Ve(ve,Hs),ke("taxId","==",n.taxId.trim()));if(!(await bt(d)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${n.taxId}"`}}const o={name:n.name.trim(),taxId:n.taxId?.trim()||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson?.trim()||"",phone:n.phone?.trim()||"",email:n.email?.trim()||"",address:n.address?.trim()||"",city:n.city?.trim()||"",state:n.state?.trim()||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:Number(n.creditLimit)||0,priceList:n.priceList||{},rating:Number(n.rating)||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1,totalOrders:0,totalPurchased:0,lastOrderDate:null,averageDeliveryTime:0,createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await hl(Ve(ve,Hs),o)).id,...o},message:`Proveedor "${o.name}" creado exitosamente`}}catch(t){return console.error("Error creating supplier:",t),{success:!1,error:t.message}}},Oj=async()=>{try{const n=we(Ve(ve,Hs),jn("name","asc"));return{success:!0,data:(await bt(n)).docs.map(a=>({id:a.id,...a.data()}))}}catch(n){return console.error("Error getting suppliers:",n),{success:!1,error:n.message}}},kj=n=>{const e=we(Ve(ve,Hs),jn("name","asc"));return Ur(e,t=>{const a=t.docs.map(o=>({id:o.id,...o.data()}));n(a)})},vL=async(n,e,t)=>{try{const a=await Li(rt(ve,Hs,n));if(!a.exists())return{success:!1,error:"Proveedor no encontrado"};if(e.name&&e.name.trim()!==a.data().name){const c=we(Ve(ve,Hs),ke("name","==",e.name.trim()));if(!(await bt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${e.name}"`}}if(e.taxId&&e.taxId.trim()!==a.data().taxId){const c=we(Ve(ve,Hs),ke("taxId","==",e.taxId.trim()));if(!(await bt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${e.taxId}"`}}const o={...e,lastUpdated:new Date,updatedBy:t};return o.name&&(o.name=o.name.trim()),o.taxId&&(o.taxId=o.taxId.trim()),o.contactPerson&&(o.contactPerson=o.contactPerson.trim()),o.phone&&(o.phone=o.phone.trim()),o.email&&(o.email=o.email.trim()),await xs(rt(ve,Hs,n),o),{success:!0,message:"Proveedor actualizado exitosamente"}}catch(a){return console.error("Error updating supplier:",a),{success:!1,error:a.message}}},yL=async(n,e)=>{try{return await xs(rt(ve,Hs,n),{status:"inactive",lastUpdated:new Date,updatedBy:e}),{success:!0,message:"Proveedor desactivado exitosamente"}}catch(t){return console.error("Error deleting supplier:",t),{success:!1,error:t.message}}},_L=async()=>{try{const n=await Oj();if(!n.success)return n;const e=n.data,t={total:e.length,active:e.filter(a=>a.status==="active").length,inactive:e.filter(a=>a.status==="inactive").length,suspended:e.filter(a=>a.status==="suspended").length,preferred:e.filter(a=>a.isPreferred).length,averageRating:e.length>0?e.reduce((a,o)=>a+(o.rating||0),0)/e.length:0,byCategory:{},byType:{}};return e.forEach(a=>{const o=a.category||"sin_categoria";t.byCategory[o]=(t.byCategory[o]||0)+1}),e.forEach(a=>{const o=a.type||"sin_tipo";t.byType[o]=(t.byType[o]||0)+1}),{success:!0,data:t}}catch(n){return console.error("Error getting suppliers stats:",n),{success:!1,error:n.message}}},Pj=$.createContext(),Ts=()=>{const n=$.useContext(Pj);if(n===void 0)throw new Error("useCombustibles must be used within a CombustiblesProvider");return n},bL=({children:n})=>{const[e,t]=$.useState(null),[a,o]=$.useState(null),[c,d]=$.useState(!0),[m,p]=$.useState(null),[v,_]=$.useState([]),[b,A]=$.useState([]),[j,T]=$.useState([]),[S,x]=$.useState([]);$.useEffect(()=>{const w=hR(Bc,async C=>{try{if(d(!0),C){t(C);let R=await yf(C.uid);R.success||(R=await pj(C,{provider:"existing_account",appContext:"combustibles"})),R.success?o(R.userData):p("Error cargando perfil de usuario")}else t(null),o(null),_([]),A([]),T([]),x([])}catch(R){console.error("Error en autenticacin:",R),p("Error de autenticacin")}finally{d(!1)}});return()=>w()},[]),$.useEffect(()=>{if(e){const w=Tj(_),C=Jv(T,Ee=>p(Ee.message)),R=kj(x),P=Mx.subscribeToMovements(A,Ee=>p(Ee.message));return()=>{w(),C(),R(),P()}}},[e]);const k={user:e,userProfile:a,loading:c,error:m,hasPermission:w=>a?.combustiblesPermissions?.[w]||!1,isAdmin:()=>a?.role==="admin",isCounterOrAbove:()=>a?.role==="admin"||a?.role==="contador",inventory:v,movements:b,vehicles:j,suppliers:S,setInventory:_,setMovements:A,setVehicles:T,setSuppliers:x,deleteMovement:async w=>{try{return await Mx.deleteMovement(w),{success:!0}}catch(C){return console.error("Error al eliminar el movimiento en el contexto:",C),p(C.message),{success:!1,error:C.message}}},refreshInventory:async()=>{console.log("Refrescando inventario...")},refreshMovements:async()=>{console.log("Refrescando movimientos...")},refreshVehicles:async()=>{console.log("Refrescando vehculos...")},refreshSuppliers:async()=>{console.log("Refrescando proveedores...")}};return r.jsx(Pj.Provider,{value:k,children:n})},EL=({children:n,currentView:e,onViewChange:t})=>{const{userProfile:a,isAdmin:o,isCounterOrAbove:c}=Ts(),[d,m]=$.useState(!1),p=[{id:"dashboard",name:"Dashboard",icon:"",description:"Vista general",requiredPermission:null},{id:"inventory",name:"Inventario",icon:"",description:"Gestin de stock",requiredPermission:"canManageInventory"},{id:"movements",name:"Movimientos",icon:"",description:"Entradas y salidas",requiredPermission:"canCreateMovements"},{id:"vehicles",name:"Vehculos",icon:"",description:"Maquinaria forestal",requiredPermission:null},{id:"maintenance",name:"Mantenimiento",icon:"",description:"Cambios de aceite y bateras",requiredPermission:"canManageMaintenance"},{id:"products",name:"Productos",icon:"",description:"Tipos de combustibles",requiredPermission:null},{id:"suppliers",name:"Proveedores",icon:"",description:"Gestin de proveedores",requiredPermission:"canManageSuppliers"},{id:"reports",name:"Reportes",icon:"",description:"Anlisis y reportes",requiredPermission:"canViewReports"},{id:"admin",name:"Administracin",icon:"",description:"Gestin de usuarios",requiredPermission:"admin"}],v=j=>{t(j),m(!1)},_=j=>j?j==="admin"?o():a?.combustiblesPermissions?.[j]||!1:!0,b=p.filter(j=>_(j.requiredPermission)),A=async()=>{try{await fR(Bc)}catch(j){console.error("Error al cerrar sesin:",j)}};return r.jsxs("div",{className:"dashboard-layout",children:[r.jsx("header",{className:"dashboard-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"sidebar-toggle",onClick:()=>m(!d),children:""}),r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:" Gestin de Combustibles"}),r.jsx("span",{className:"subtitle",children:"Forestech Colombia"})]}),r.jsxs("div",{className:"header-user",children:[r.jsxs("div",{className:"user-info",children:[r.jsx("span",{className:"user-name",children:a?.displayName||a?.email}),r.jsx("span",{className:"user-role",children:a?.role})]}),r.jsx("div",{className:"user-avatar",children:a?.photoURL?r.jsx("img",{src:a.photoURL,alt:"Avatar"}):r.jsx("div",{className:"avatar-placeholder",children:(a?.displayName||a?.email||"U").charAt(0).toUpperCase()})}),r.jsx("button",{className:"logout-button",onClick:A,title:"Cerrar sesin",children:""})]})]})}),r.jsxs("div",{className:"dashboard-body",children:[r.jsxs("aside",{className:`dashboard-sidebar ${d?"open":""}`,children:[r.jsx("nav",{className:"sidebar-nav",children:b.map(j=>r.jsxs("button",{className:`nav-item ${e===j.id?"active":""}`,onClick:()=>v(j.id),children:[r.jsx("span",{className:"nav-icon",children:j.icon}),r.jsxs("div",{className:"nav-content",children:[r.jsx("span",{className:"nav-name",children:j.name}),r.jsx("span",{className:"nav-description",children:j.description})]})]},j.id))}),r.jsx("div",{className:"sidebar-footer",children:r.jsxs("div",{className:"user-permissions",children:[r.jsx("h4",{children:"Permisos Activos:"}),r.jsxs("div",{className:"permission-list",children:[o()&&r.jsx("span",{className:"permission admin",children:" Administrador"}),c()&&r.jsx("span",{className:"permission counter",children:" Gestin Operativa"}),_("canManageInventory")&&r.jsx("span",{className:"permission",children:" Inventario"}),_("canManageVehicles")&&r.jsx("span",{className:"permission",children:" Vehculos"})]})]})})]}),r.jsx("main",{className:"dashboard-main",children:r.jsx("div",{className:"main-content",children:n})})]}),d&&r.jsx("div",{className:"sidebar-overlay",onClick:()=>m(!1)})]})},kx=(n,e=[])=>{if(!n||!n.fuelType||!n.quantity)return{isValid:!1,error:"Datos de movimiento incompletos",availableStock:0,requiredStock:0};const{fuelType:t,quantity:a,type:o,sourceLocation:c}=n,d=parseFloat(a)||0;if(o!=="outbound"&&o!=="transfer")return{isValid:!0,message:"Movimiento no requiere validacin de stock",availableStock:0,requiredStock:d};const m=e.filter(_=>_.fuelType===t&&_.location===c&&_.status==="active").reduce((_,b)=>_+(parseFloat(b.quantity)||0),0),p=m>=d,v=m-d;return{isValid:p,availableStock:m,requiredStock:d,remainingStock:v,fuelType:t,location:c,error:p?null:`Stock insuficiente. Disponible: ${m}, Requerido: ${d}`,warning:v<m*.2&&v>=0?"Stock quedar bajo despus del movimiento":null}},An=n=>typeof n!="number"||isNaN(n)?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),Me=(n,e=2)=>typeof n!="number"||isNaN(n)?"0":new Intl.NumberFormat("es-CO",{minimumFractionDigits:e,maximumFractionDigits:e}).format(n),Er=(n,e=1)=>typeof n!="number"||isNaN(n)?"0%":`${(n*100).toFixed(e)}%`,Px=()=>{const{inventory:n,movements:e,vehicles:t,loading:a,error:o}=Ts(),c=v=>v?v.toDate&&typeof v.toDate=="function"?v.toDate():v.seconds?new Date(v.seconds*1e3):v instanceof Date?v:new Date(v):new Date,d=$.useMemo(()=>{const v=t.filter(T=>T.status==="activo").length,_=e.filter(T=>T.status==="pendiente").length,b=n.filter(T=>T.isActive!==!1).reduce((T,S)=>T+(parseFloat(S.currentStock)||0),0),A=n.filter(T=>T.isActive!==!1).reduce((T,S)=>{const x=parseFloat(S.currentStock)||0,F=parseFloat(S.unitPrice)||0;return T+x*F},0),j=n.filter(T=>{const S=parseFloat(T.currentStock)||0,x=parseFloat(T.minStock)||parseFloat(T.minThreshold)||20;return T.isActive!==!1&&S<=x}).length;return{totalFuel:b,totalValue:A,lowStockAlerts:j,activeInventoryItems:n.filter(T=>T.isActive!==!1).length,activeVehicles:v,pendingMovements:_,totalMaintenance:0,overdueMaintenance:0}},[n,t,e]),m=$.useMemo(()=>e.sort((v,_)=>c(_.createdAt).getTime()-c(v.createdAt).getTime()).slice(0,5),[e]),p=v=>{const _=v.quantity||0,b=v.fuelType||"N/A";switch(v.type){case"entrada":return`Entrada de ${_} gal de ${b}.`;case"salida":return`Salida de ${_} gal para vehculo ${v.vehicleId||"N/A"}.`;case"transferencia":return`Transferencia de ${_} gal.`;case"ajuste":return`Ajuste de inventario: ${_} gal de ${b}.`;default:return"Movimiento registrado."}};return a?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Cargando datos en tiempo real..."}),r.jsx("div",{className:"loading-spinner-container",children:r.jsx("div",{className:"loading-spinner"})})]}):o?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsxs("div",{className:"error-message",children:[r.jsxs("p",{children:[" ",o]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})]}):r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del estado de combustibles y maquinaria."}),r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon fuel-icon",children:""}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Combustible Total"}),r.jsxs("h2",{children:[Me(d.totalFuel)," gal"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon value-icon",children:""}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Valor Inventario"}),r.jsx("h2",{children:An(d.totalValue)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon vehicle-icon",children:""}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Vehculos Activos"}),r.jsx("h2",{children:Me(d.activeVehicles)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon movement-icon",children:""}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Movimientos Pendientes"}),r.jsx("h2",{children:Me(d.pendingMovements)})]})]}),r.jsxs("div",{className:`stat-card ${d.lowStockAlerts>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon alert-icon",children:""}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Alertas de Stock"}),r.jsx("h2",{children:Me(d.lowStockAlerts)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon maintenance-icon",children:""}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Mantenimientos"}),r.jsx("h2",{children:Me(d.totalMaintenance)})]})]}),r.jsxs("div",{className:`stat-card ${d.overdueMaintenance>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon maintenance-alert-icon",children:""}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Mantenimientos Vencidos"}),r.jsx("h2",{children:Me(d.overdueMaintenance)})]})]})]}),r.jsxs("div",{className:"dashboard-content",children:[r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"Actividad Reciente"}),m.length>0?r.jsx("ul",{children:m.map(v=>r.jsxs("li",{children:[r.jsx("span",{className:`movement-type-badge ${v.type}`,children:v.type}),p(v),r.jsx("span",{className:"movement-date",children:c(v.createdAt).toLocaleDateString()})]},v.id))}):r.jsx("p",{children:"No hay movimientos recientes."})]}),r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:" Stock por Producto"}),n.length>0?r.jsx("div",{className:"products-summary",children:n.map(v=>r.jsxs("div",{className:"product-summary-item",children:[r.jsx("div",{className:"product-icon",children:""}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:v.fuelType}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("span",{className:"stock-value",children:[Me(v.currentStock||0)," gal"]}),r.jsx("span",{className:`stock-status ${(v.currentStock||0)<=(v.minStock||20)?"low":"normal"}`,children:(v.currentStock||0)<=(v.minStock||20)?" Stock bajo":" Normal"})]})]})]},v.id))}):r.jsx("div",{className:"no-products",children:r.jsx("p",{children:"No hay inventario registrado."})})]})]})]})},NL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const[o,c]=$.useState("name"),[d,m]=$.useState("asc"),p=T=>new Intl.NumberFormat("es-CO").format(T),v=T=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(T),_=T=>{if(!T)return"N/A";const S=new Date;let x;if(T&&typeof T=="object")if(T.seconds)x=new Date(T.seconds*1e3);else if(T.toDate&&typeof T.toDate=="function")x=T.toDate();else if(T instanceof Date)x=T;else return"N/A";else if(typeof T=="string"||typeof T=="number")x=new Date(T);else return"N/A";if(isNaN(x.getTime()))return"N/A";const F=S-x,Y=Math.floor(F/(1e3*60*60)),V=Math.floor(Y/24);return V>0?`${V}d`:Y>0?`${Y}h`:"ahora"},b=T=>{o===T?m(d==="asc"?"desc":"asc"):(c(T),m("asc"))},A=[...n].sort((T,S)=>{let x=T[o],F=S[o];if(o==="lastUpdated"){const Y=V=>{if(!V)return new Date(0);if(V&&typeof V=="object"){if(V.seconds)return new Date(V.seconds*1e3);if(V.toDate&&typeof V.toDate=="function")return V.toDate();if(V instanceof Date)return V}return new Date(V)};x=Y(x),F=Y(F)}return x<F?d==="asc"?-1:1:x>F?d==="asc"?1:-1:0}),j=T=>o!==T?"":d==="asc"?"":"";return r.jsxs("div",{className:"inventory-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{onClick:()=>b("name"),className:"sortable",children:["Combustible ",j("name")]}),r.jsxs("th",{onClick:()=>b("location"),className:"sortable",children:["Ubicacin ",j("location")]}),r.jsxs("th",{onClick:()=>b("currentStock"),className:"sortable",children:["Stock Actual ",j("currentStock")]}),r.jsxs("th",{onClick:()=>b("stockPercentage"),className:"sortable",children:["Nivel ",j("stockPercentage")]}),r.jsxs("th",{onClick:()=>b("pricePerUnit"),className:"sortable",children:["Precio ",j("pricePerUnit")]}),r.jsx("th",{children:"Valor Total"}),r.jsxs("th",{onClick:()=>b("status"),className:"sortable",children:["Estado ",j("status")]}),r.jsxs("th",{onClick:()=>b("lastUpdated"),className:"sortable",children:["Actualizado ",j("lastUpdated")]}),a&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:A.map(T=>{const S=sl[T.fuelType],x=Bo[T.stockLevel],F=parseFloat(T.currentStock)||0,Y=parseFloat(T.pricePerUnit)||0,V=parseFloat(T.maxCapacity)||0,O=parseFloat(T.stockPercentage)||0,U=F*Y;return r.jsxs("tr",{className:T.needsRestock?"needs-restock":"",children:[r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:S?.color},children:S?.icon}),r.jsxs("div",{children:[r.jsx("div",{className:"fuel-name",children:S?.name}),r.jsx("div",{className:"fuel-type",children:T.fuelType})]})]})}),r.jsx("td",{children:T.location}),r.jsxs("td",{className:"stock-cell",children:[r.jsxs("div",{className:"stock-info",children:[r.jsx("span",{className:"stock-amount",children:p(F)}),r.jsxs("span",{className:"stock-unit",children:["/ ",p(V)," ",T.unit||"gal"]})]}),T.needsRestock&&r.jsx("div",{className:"restock-indicator",children:" Bajo mnimo"})]}),r.jsx("td",{className:"level-cell",children:r.jsxs("div",{className:"level-info",children:[r.jsxs("div",{className:"level-badge",style:{backgroundColor:x?.color,color:"white"},children:[O,"%"]}),r.jsx("div",{className:"level-bar",children:r.jsx("div",{className:"level-fill",style:{width:`${O}%`,backgroundColor:x?.color}})})]})}),r.jsx("td",{className:"price-cell",children:r.jsxs("div",{className:"price-info",children:[r.jsx("span",{className:"price-amount",children:v(Y)}),r.jsxs("span",{className:"price-unit",children:["/ ",T.unit||"gal"]})]})}),r.jsx("td",{className:"value-cell",children:r.jsx("span",{className:"total-value",children:v(U)})}),r.jsx("td",{className:"status-cell",children:r.jsxs("span",{className:`status-badge ${T.status}`,children:[r.jsx("span",{className:"status-dot"}),T.status==="active"?"Activo":T.status==="inactive"?"Inactivo":T.status==="maintenance"?"Mantenimiento":T.status]})}),r.jsx("td",{className:"updated-cell",children:r.jsx("span",{className:"time-ago",children:_(T.lastUpdated)})}),a&&r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(T),title:"Editar",children:""}),r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(T),title:"Eliminar",children:""})]})})]},T.id)})})]})}),r.jsxs("div",{className:"table-footer",children:[r.jsxs("div",{className:"table-info",children:[A.length," items ordenados por ",o,"(",d==="asc"?"ascendente":"descendente",")"]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot critical"}),"Crtico"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot low"}),"Bajo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot normal"}),"Normal"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},xL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const o=m=>new Intl.NumberFormat("es-CO").format(m),c=m=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(m),d=m=>{if(!m)return"sin fecha";try{const p=new Date;let v;m.seconds?v=new Date(m.seconds*1e3):m.toDate&&typeof m.toDate=="function"?v=m.toDate():v=new Date(m);const _=p-v,b=Math.floor(_/(1e3*60*60)),A=Math.floor(b/24);return A>0?`hace ${A} da${A>1?"s":""}`:b>0?`hace ${b} hora${b>1?"s":""}`:"hace unos minutos"}catch(p){return console.warn("Error al calcular tiempo transcurrido:",p),"fecha invlida"}};return r.jsx("div",{className:"inventory-cards-grid",children:n.map(m=>{const p=sl[m.fuelType],v=Bo[m.stockLevel],_=parseFloat(m.currentStock)||0,b=parseFloat(m.pricePerUnit)||parseFloat(m.unitPrice)||0,A=parseFloat(m.maxCapacity)||parseFloat(m.capacity)||0,j=parseFloat(m.stockPercentage)||0,T=_*b;return r.jsxs("div",{className:"inventory-card",children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:p?.color},children:p?.icon}),r.jsxs("div",{className:"fuel-details",children:[r.jsx("h3",{children:p?.name}),r.jsx("p",{className:"location",children:m.location})]})]}),r.jsx("div",{className:"stock-status",children:r.jsxs("span",{className:"status-badge",style:{backgroundColor:v?.color,color:"white"},children:[v?.icon," ",v?.label]})})]}),r.jsxs("div",{className:"stock-progress",children:[r.jsxs("div",{className:"progress-header",children:[r.jsxs("span",{className:"stock-text",children:[o(_)," / ",o(A)," ",m.unit||"gal"]}),r.jsxs("span",{className:"percentage",children:[j,"%"]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${j}%`,backgroundColor:v?.color}})}),m.needsRestock&&r.jsxs("div",{className:"restock-warning",children:[" Bajo nivel mnimo (",o(m.minThreshold||m.minStock||0)," ",m.unit||"gal",")"]})]}),r.jsxs("div",{className:"card-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsxs("span",{className:"metric-label",children:["Precio por ",m.unit||"gal",":"]}),r.jsx("span",{className:"metric-value",children:c(b)})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor total:"}),r.jsx("span",{className:"metric-value",children:c(T)})]}),m.supplier&&r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Proveedor:"}),r.jsx("span",{className:"metric-value",children:m.supplier})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"status-info",children:[r.jsx("span",{className:`status-dot ${m.status}`}),r.jsx("span",{className:"status-text",children:m.status==="active"?"Activo":m.status==="inactive"?"Inactivo":m.status==="maintenance"?"Mantenimiento":m.status})]}),r.jsxs("div",{className:"last-update",children:["Actualizado ",d(m.updatedAt||m.lastUpdated)]})]}),a&&r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>e(m),title:"Editar combustible",children:" Editar"}),r.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>t(m),title:"Eliminar combustible",children:" Eliminar"})]}),m.description&&m.description!==p?.description&&r.jsx("div",{className:"card-description",children:r.jsx("p",{children:m.description})})]},m.id)})})},TL=({item:n,onClose:e,onSuccess:t})=>{const{userProfile:a}=Ts(),o=!!n,[c,d]=$.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[m,p]=$.useState({}),[v,_]=$.useState(!1);$.useEffect(()=>{o&&n&&d({fuelType:n.fuelType||"",location:n.location||"",currentStock:n.currentStock||"",maxCapacity:n.maxCapacity||"",minThreshold:n.minThreshold||"",pricePerUnit:n.pricePerUnit||"",supplier:n.supplier||"",description:n.description||"",status:n.status||"active"})},[o,n]),$.useEffect(()=>{if(c.maxCapacity&&!c.minThreshold){const S=Math.round(Number(c.maxCapacity)*.15);d(x=>({...x,minThreshold:S}))}},[c.maxCapacity]);const b=S=>{const{name:x,value:F}=S.target;d(Y=>({...Y,[x]:F})),m[x]&&p(Y=>({...Y,[x]:null}))},A=()=>{const S={};c.fuelType||(S.fuelType="Tipo de combustible es requerido"),c.location||(S.location="Ubicacin es requerida"),c.maxCapacity||(S.maxCapacity="Capacidad mxima es requerida");const x=Number(c.currentStock),F=Number(c.maxCapacity),Y=Number(c.minThreshold),V=Number(c.pricePerUnit);return c.currentStock&&(isNaN(x)||x<0)&&(S.currentStock="Stock actual debe ser un nmero vlido mayor o igual a 0"),c.maxCapacity&&(isNaN(F)||F<=0)&&(S.maxCapacity="Capacidad mxima debe ser un nmero vlido mayor a 0"),c.minThreshold&&(isNaN(Y)||Y<0)&&(S.minThreshold="Umbral mnimo debe ser un nmero vlido mayor o igual a 0"),c.pricePerUnit&&(isNaN(V)||V<0)&&(S.pricePerUnit="Precio debe ser un nmero vlido mayor o igual a 0"),x>F&&(S.currentStock="Stock actual no puede ser mayor a la capacidad mxima"),Y>F&&(S.minThreshold="Umbral mnimo no puede ser mayor a la capacidad mxima"),p(S),Object.keys(S).length===0},j=async S=>{if(S.preventDefault(),!!A()){_(!0);try{let x;o?x=await dL(n.id,{location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid):x=await uL({fuelType:c.fuelType,location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid),x.success?(alert(x.message),t()):alert(`Error: ${x.error}`)}catch(x){console.error("Error saving inventory item:",x),alert("Error inesperado al guardar el item")}finally{_(!1)}}},T=sl[c.fuelType];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content inventory-modal",onClick:S=>S.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:o?" Editar Combustible":" Agregar Nuevo Combustible"}),r.jsx("button",{className:"modal-close",onClick:e,children:""})]}),r.jsxs("form",{onSubmit:j,className:"modal-form",children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",T&&r.jsxs("span",{className:"fuel-preview",children:[T.icon," ",T.name]})]}),r.jsxs("select",{id:"fuelType",name:"fuelType",value:c.fuelType,onChange:b,disabled:o,className:m.fuelType?"error":"",required:!0,children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(Nn).map(([S,x])=>{const F=sl[x];return r.jsxs("option",{value:x,children:[F.icon," ",F.name," (",F.unit,")"]},S)})]}),m.fuelType&&r.jsx("span",{className:"error-text",children:m.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"location",children:"Ubicacin / Tanque *"}),r.jsx("input",{type:"text",id:"location",name:"location",value:c.location,onChange:b,placeholder:"ej. Tanque Principal, Depsito A, Bodega Norte",className:m.location?"error":"",required:!0}),m.location&&r.jsx("span",{className:"error-text",children:m.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",T&&`(${T.unit})`]}),r.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:c.currentStock,onChange:b,placeholder:"0",min:"0",step:"0.01",className:m.currentStock?"error":""}),m.currentStock&&r.jsx("span",{className:"error-text",children:m.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad Mxima * ",T&&`(${T.unit})`]}),r.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:c.maxCapacity,onChange:b,placeholder:"1000",min:"1",step:"0.01",className:m.maxCapacity?"error":"",required:!0}),m.maxCapacity&&r.jsx("span",{className:"error-text",children:m.maxCapacity})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"minThreshold",children:["Umbral Mnimo ",T&&`(${T.unit})`,r.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),r.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:c.minThreshold,onChange:b,placeholder:"Auto: 15% de capacidad mxima",min:"0",step:"0.01",className:m.minThreshold?"error":""}),m.minThreshold&&r.jsx("span",{className:"error-text",children:m.minThreshold}),c.maxCapacity&&r.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(c.maxCapacity)*.15)," ",T?.unit||"unidades"]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",T?.unit||"Unidad"]}),r.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:c.pricePerUnit,onChange:b,placeholder:"12000",min:"0",step:"0.01",className:m.pricePerUnit?"error":""}),m.pricePerUnit&&r.jsx("span",{className:"error-text",children:m.pricePerUnit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),r.jsx("input",{type:"text",id:"supplier",name:"supplier",value:c.supplier,onChange:b,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsxs("select",{id:"status",name:"status",value:c.status,onChange:b,children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"description",children:"Descripcin / Notas"}),r.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:b,placeholder:"Informacin adicional sobre este combustible...",rows:"3"})]})]}),T&&c.maxCapacity&&r.jsxs("div",{className:"form-preview",children:[r.jsx("h4",{children:" Vista Previa"}),r.jsxs("div",{className:"preview-card",children:[r.jsxs("div",{className:"preview-header",children:[r.jsxs("span",{style:{color:T.color},children:[T.icon," ",T.name]}),r.jsx("span",{children:c.location})]}),r.jsxs("div",{className:"preview-capacity",children:[c.currentStock||0," / ",c.maxCapacity," ",T.unit,c.currentStock&&c.maxCapacity&&r.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(c.currentStock)/Number(c.maxCapacity)*100),"%)"]})]}),c.pricePerUnit&&r.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(c.currentStock)||0)*Number(c.pricePerUnit))]})]})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v,children:v?"Guardando...":o?"Actualizar":"Crear"})]})]})]})})},AL=({stats:n})=>r.jsxs("div",{className:"inventory-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Valor Total"}),r.jsx("div",{className:"stat-value",children:An(n.totalValue)}),r.jsxs("div",{className:"stat-subtitle",children:[Me(n.totalItems)," tipos de combustible"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Items Activos"}),r.jsx("div",{className:"stat-value",children:n.activeItems}),r.jsxs("div",{className:"stat-subtitle",children:[Math.round(n.activeItems/n.totalItems*100),"% del total"]})]})]}),r.jsxs("div",{className:`stat-card ${n.lowStockItems>0?"warning":"info"}`,children:[r.jsx("div",{className:"stat-icon",children:n.lowStockItems>0?"":""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Stock Bajo"}),r.jsx("div",{className:"stat-value",children:n.lowStockItems}),r.jsx("div",{className:"stat-subtitle",children:n.lowStockItems>0?"Requieren atencin":"Niveles normales"})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Nivel Promedio"}),r.jsxs("div",{className:"stat-value",children:[n.averageStockLevel,"%"]}),r.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),r.jsxs("div",{className:"fuel-type-summary",children:[r.jsx("h4",{children:" Resumen por Tipo de Combustible"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(n.byFuelType).map(([e,t])=>{const a=sl[e],o=t.totalCapacity>0?Math.round(t.totalStock/t.totalCapacity*100):0;return r.jsxs("div",{className:"fuel-type-card",children:[r.jsxs("div",{className:"fuel-header",children:[r.jsx("span",{className:"fuel-icon",style:{color:a?.color||"#6b7280"},children:a?.icon||""}),r.jsxs("div",{className:"fuel-info",children:[r.jsx("h5",{children:a?.name||e}),r.jsxs("span",{className:"fuel-count",children:[t.count," ubicaciones"]})]})]}),r.jsxs("div",{className:"fuel-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Stock Total:"}),r.jsxs("span",{className:"metric-value",children:[Me(t.totalStock)," ",a?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Capacidad:"}),r.jsxs("span",{className:"metric-value",children:[Me(t.totalCapacity)," ",a?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Utilizacin:"}),r.jsxs("span",{className:`metric-value ${o<25?"low":o>75?"high":"normal"}`,children:[o,"%"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor:"}),r.jsx("span",{className:"metric-value",children:An(t.totalValue)})]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${o}%`,backgroundColor:a?.color||"#6b7280"}})})]},e)})}),Object.keys(n.byFuelType).length===0&&r.jsx("div",{className:"empty-fuel-types",children:r.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),jL=()=>{const{hasPermission:n}=Ts(),[e,t]=$.useState([]),[a,o]=$.useState(null),[c,d]=$.useState(!0),[m,p]=$.useState(null),[v,_]=$.useState("cards"),[b,A]=$.useState(!1),[j,T]=$.useState(null),[S,x]=$.useState("all"),[F,Y]=$.useState("");$.useEffect(()=>{let D=null;return(()=>{D=Tj((w,C)=>{if(C){console.error("Error in inventory subscription:",C),p("Error cargando inventario en tiempo real");return}t(w||[]),d(!1)})})(),()=>{D&&D()}},[]),$.useEffect(()=>{(async()=>{const k=await fL();k.success&&o(k.data)})()},[e]);const V=e.filter(D=>{if(S==="active"&&D.status!=="active"||S==="low-stock"&&!D.needsRestock)return!1;if(F){const k=F.toLowerCase();return D.name.toLowerCase().includes(k)||D.location.toLowerCase().includes(k)||D.fuelType.toLowerCase().includes(k)}return!0}),O=D=>{if(!n("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}T(D),A(!0)},U=async D=>{if(!n("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`Ests seguro de eliminar ${D.name} de ${D.location}?

Esta accin no se puede deshacer.`))return;d(!0);const w=await hL(D.id);w.success?alert("Item eliminado exitosamente"):(p(w.error),alert(`Error al eliminar: ${w.error}`)),d(!1)},W=()=>{A(!1),T(null)},L=()=>{W()};return c&&e.length===0?r.jsxs("div",{className:"inventory-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando inventario..."})]}):r.jsxs("div",{className:"inventory-main",children:[r.jsxs("div",{className:"inventory-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:" Gestin de Inventario"}),r.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),r.jsx("div",{className:"inventory-info",children:r.jsxs("span",{className:"info-text",children:[" Los combustibles se agregan automticamente desde la pestaa ",r.jsx("strong",{children:"Movimientos"})]})})]}),a&&r.jsx(AL,{stats:a}),r.jsxs("div",{className:"inventory-controls",children:[r.jsxs("div",{className:"search-filters",children:[r.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicacin o tipo...",value:F,onChange:D=>Y(D.target.value),className:"search-input"}),r.jsxs("select",{value:S,onChange:D=>x(D.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos los items"}),r.jsx("option",{value:"active",children:"Solo activos"}),r.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),r.jsxs("div",{className:"view-toggle",children:[r.jsx("button",{className:`toggle-btn ${v==="cards"?"active":""}`,onClick:()=>_("cards"),children:" Cards"}),r.jsx("button",{className:`toggle-btn ${v==="table"?"active":""}`,onClick:()=>_("table"),children:" Tabla"})]})]}),m&&r.jsxs("div",{className:"error-banner",children:[r.jsxs("span",{children:[" ",m]}),r.jsx("button",{onClick:()=>p(null),children:""})]}),r.jsx("div",{className:"inventory-content",children:V.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:""}),r.jsx("h3",{children:"No hay items de inventario"}),r.jsx("p",{children:F||S!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaa Movimientos para crear una ENTRADA de combustible"})]}):r.jsx(r.Fragment,{children:v==="cards"?r.jsx(xL,{items:V,onEdit:O,onDelete:U,canManage:n("canManageInventory")}):r.jsx(NL,{items:V,onEdit:O,onDelete:U,canManage:n("canManageInventory")})})}),V.length>0&&r.jsx("div",{className:"results-footer",children:r.jsxs("p",{children:["Mostrando ",V.length," de ",e.length," items",F&&`  Filtro: "${F}"`,S!=="all"&&`  Estado: ${S}`]})}),b&&r.jsx(TL,{item:j,onClose:W,onSuccess:L})]})},wL=({stats:n,filters:e})=>{if(!n)return null;const t=(d,m)=>m===0?d>0?100:0:((d-m)/m*100).toFixed(1),a=d=>{switch(d){case pe.ENTRADA:return"#10b981";case pe.SALIDA:return"#ef4444";case pe.TRANSFERENCIA:return"#3b82f6";case pe.AJUSTE:return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case pe.ENTRADA:return"";case pe.SALIDA:return"";case pe.TRANSFERENCIA:return"";case pe.AJUSTE:return"";default:return""}},c=t(n.thisMonth,n.lastMonth);return r.jsxs("div",{className:"movements-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.totalMovements)}),r.jsx("div",{className:"stat-label",children:"Total Movimientos"}),r.jsxs("div",{className:"stat-trend",children:[r.jsxs("span",{className:`trend ${c>=0?"positive":"negative"}`,children:[c>=0?"":""," ",Math.abs(c),"%"]}),r.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:An(n.totalValue)}),r.jsx("div",{className:"stat-label",children:"Valor Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",An(n.averageValue)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.totalQuantity)}),r.jsx("div",{className:"stat-label",children:"Galones Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Me(n.totalQuantity/(n.totalMovements||1))," gal/mov"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.thisWeek)}),r.jsx("div",{className:"stat-label",children:"Esta Semana"}),r.jsxs("div",{className:"stat-secondary",children:[Me(n.thisMonth)," este mes"]})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:" Por Tipo de Movimiento"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([d,m])=>{const p=(m/n.totalMovements*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:o(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:a(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:" Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([d,m])=>{const p=(m/n.totalMovements*100).toFixed(1),v=b=>{switch(b){case ze.COMPLETADO:return"#10b981";case ze.PENDIENTE:return"#f59e0b";case ze.CANCELADO:return"#ef4444";default:return"#6b7280"}},_=b=>{switch(b){case ze.COMPLETADO:return"";case ze.PENDIENTE:return"";case ze.CANCELADO:return"";default:return""}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:_(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:v(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:" Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([d,m])=>{const p=(m/n.totalMovements*100).toFixed(1),v=_=>{switch(_?.toLowerCase()){case"diesel":return"";case"gasolina":return"";case"acpm":return"";case"lubricante":return"";default:return""}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(d)}),r.jsx("span",{className:"breakdown-label",children:d})]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]})]}),(e.type||e.status||e.fuelType||e.vehicleId)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:" Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.vehicleId&&r.jsxs("span",{className:"filter-tag",children:["Vehculo: ",e.vehicleId]})]})]})]})},CL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:m})=>{const[p,v]=$.useState(!1),_=[{value:"Diesel",label:"Diesel "},{value:"Gasolina",label:"Gasolina "},{value:"ACPM",label:"ACPM "},{value:"Lubricante",label:"Lubricante "}],b=[{value:"all",label:"Todos los perodos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este ao"}],A=Object.values(n).filter(S=>S&&S!==""&&S!=="all").length,j=(S,x)=>{e({[S]:x})},T=S=>{e(S)};return r.jsxs("div",{className:"movements-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:""}),r.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehculo, referencia...",value:a,onChange:S=>o(S.target.value),className:"search-input"}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar bsqueda",children:""})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${n.type===pe.ENTRADA?"active":""}`,onClick:()=>T({type:pe.ENTRADA}),children:" Entradas"}),r.jsx("button",{className:`quick-filter ${n.type===pe.SALIDA?"active":""}`,onClick:()=>T({type:pe.SALIDA}),children:" Salidas"}),r.jsx("button",{className:`quick-filter ${n.status===ze.PENDIENTE?"active":""}`,onClick:()=>T({status:ze.PENDIENTE}),children:" Pendientes"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:[" Filtros",A>0&&r.jsx("span",{className:"filters-count",children:A})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:""}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:""})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Movimiento"}),r.jsxs("select",{value:n.type,onChange:S=>j("type",S.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:pe.ENTRADA,children:" Entrada"}),r.jsx("option",{value:pe.SALIDA,children:" Salida"}),r.jsx("option",{value:pe.TRANSFERENCIA,children:" Transferencia"}),r.jsx("option",{value:pe.AJUSTE,children:" Ajuste"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:S=>j("status",S.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:ze.PENDIENTE,children:" Pendiente"}),r.jsx("option",{value:ze.COMPLETADO,children:" Completado"}),r.jsx("option",{value:ze.CANCELADO,children:" Cancelado"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:n.fuelType,onChange:S=>j("fuelType",S.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),_.map(S=>r.jsx("option",{value:S.value,children:S.label},S.value))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Perodo"}),r.jsx("select",{value:n.dateRange,onChange:S=>j("dateRange",S.target.value),className:"filter-select",children:b.map(S=>r.jsx("option",{value:S.value,children:S.label},S.value))})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Vehculo/Equipo"}),r.jsx("input",{type:"text",placeholder:"ID del vehculo...",value:n.vehicleId,onChange:S=>j("vehicleId",S.target.value),className:"filter-input"})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:A===0,children:" Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[m," resultado",m!==1?"s":""]}),A>0&&r.jsxs("span",{className:"active-filters-text",children:["(",A," filtro",A!==1?"s":""," activo",A!==1?"s":"",")"]})]})]})]}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:" Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},SL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,onDelete:c,userRole:d})=>{const m=S=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(S),p=S=>S?(S instanceof Date?S:new Date(S)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Sin fecha",v=S=>{if(!S)return"";const x=new Date,F=S instanceof Date?S:new Date(S),Y=Math.abs(x-F),V=Math.ceil(Y/(1e3*60*60*24));return V===1?"hace 1 da":V<7?`hace ${V} das`:V<30?`hace ${Math.ceil(V/7)} semanas`:V<365?`hace ${Math.ceil(V/30)} meses`:`hace ${Math.ceil(V/365)} aos`},_=S=>{switch(S){case pe.ENTRADA:return"movement-entrada";case pe.SALIDA:return"movement-salida";case pe.TRANSFERENCIA:return"movement-transferencia";case pe.AJUSTE:return"movement-ajuste";default:return"movement-default"}},b=S=>{switch(S){case ze.COMPLETADO:return"status-completado";case ze.PENDIENTE:return"status-pendiente";case ze.CANCELADO:return"status-cancelado";default:return"status-default"}},A=S=>{switch(S){case pe.ENTRADA:return"";case pe.SALIDA:return"";case pe.TRANSFERENCIA:return"";case pe.AJUSTE:return"";default:return""}},j=S=>{switch(S?.toLowerCase()){case"diesel":return"";case"gasolina":return"";case"acpm":return"";case"lubricante":return"";default:return""}},T=S=>{switch(S){case ze.COMPLETADO:return"";case ze.PENDIENTE:return"";case ze.CANCELADO:return"";default:return""}};return r.jsx("div",{className:"movements-cards",children:n.map(S=>r.jsxs("div",{className:`movement-card ${_(S.type)}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"movement-type",children:[r.jsx("span",{className:"type-icon",children:A(S.type)}),r.jsx("span",{className:"type-label",children:S.type.charAt(0).toUpperCase()+S.type.slice(1)})]}),r.jsxs("div",{className:`status-badge ${b(S.status)}`,children:[r.jsx("span",{className:"status-icon",children:T(S.status)}),r.jsx("span",{className:"status-label",children:S.status.charAt(0).toUpperCase()+S.status.slice(1)})]})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",children:j(S.fuelType)}),r.jsx("span",{className:"fuel-type",children:S.fuelType}),r.jsxs("span",{className:"quantity",children:[S.quantity," galones"]})]}),r.jsxs("div",{className:"value-info",children:[r.jsx("div",{className:"total-value",children:m(S.totalValue)}),r.jsxs("div",{className:"unit-price",children:[m(S.unitPrice),"/galn"]})]}),S.vehicleId&&r.jsxs("div",{className:"vehicle-info",children:[r.jsx("span",{className:"vehicle-icon",children:""}),r.jsxs("span",{className:"vehicle-id",children:["Vehculo: ",S.vehicleId]})]}),S.location&&r.jsxs("div",{className:"location-info",children:[r.jsx("span",{className:"location-icon",children:""}),r.jsx("span",{className:"location",children:S.location})]}),S.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:S.description})}),S.reference&&r.jsxs("div",{className:"reference",children:[r.jsx("span",{className:"reference-label",children:"Ref:"}),r.jsx("span",{className:"reference-value",children:S.reference})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[r.jsx("div",{className:"created-date",children:p(S.createdAt)}),r.jsx("div",{className:"relative-time",children:v(S.createdAt)})]}),r.jsxs("div",{className:"card-actions",children:[d==="admin"&&S.status===ze.PENDIENTE&&r.jsxs("div",{className:"admin-actions",children:[r.jsx("button",{className:"btn-approve",onClick:()=>a(S.id),title:"Aprobar movimiento",children:" Aprobar"}),r.jsx("button",{className:"btn-reject",onClick:()=>o(S.id),title:"Rechazar movimiento",children:" Rechazar"})]}),r.jsxs("div",{className:"user-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(S),title:"Ver detalles",children:" Ver"}),e&&S.status===ze.PENDIENTE&&r.jsx("button",{className:"btn-edit",onClick:()=>e(S),title:"Editar movimiento",children:" Editar"}),d==="admin"&&r.jsx("button",{className:"btn-delete",onClick:()=>{window.confirm("Ests seguro de que deseas eliminar este movimiento? Esta accin no se puede deshacer.")&&c(S.id)},title:"Eliminar movimiento",children:" Eliminar"})]})]})]}),S.status===ze.PENDIENTE&&r.jsx("div",{className:"urgency-indicator",children:r.jsx("div",{className:"urgency-pulse"})}),S.type===pe.AJUSTE&&r.jsx("div",{className:"adjustment-badge",children:r.jsx("span",{children:"Ajuste"})}),S.type===pe.TRANSFERENCIA&&S.destinationLocation&&r.jsxs("div",{className:"transfer-info",children:[r.jsx("span",{className:"transfer-arrow",children:""}),r.jsx("span",{className:"destination",children:S.destinationLocation})]})]},S.id))})},IL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,onDelete:c,userRole:d})=>{const[m,p]=$.useState("createdAt"),[v,_]=$.useState("desc"),b=O=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(O),A=O=>O?(O instanceof Date?O:new Date(O)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",j=O=>{switch(O){case pe.ENTRADA:return"";case pe.SALIDA:return"";case pe.TRANSFERENCIA:return"";case pe.AJUSTE:return"";default:return""}},T=O=>{switch(O?.toLowerCase()){case"diesel":return"";case"gasolina":return"";case"acpm":return"";case"lubricante":return"";default:return""}},S=O=>{switch(O){case ze.COMPLETADO:return"";case ze.PENDIENTE:return"";case ze.CANCELADO:return"";default:return""}},x=O=>{switch(O){case ze.COMPLETADO:return"status-completado";case ze.PENDIENTE:return"status-pendiente";case ze.CANCELADO:return"status-cancelado";default:return"status-default"}},F=O=>{m===O?_(v==="asc"?"desc":"asc"):(p(O),_("asc"))},Y=[...n].sort((O,U)=>{let W=O[m],L=U[m];return(m.includes("Date")||m.includes("At"))&&(W=new Date(W),L=new Date(L)),typeof W=="number"&&typeof L=="number"?v==="asc"?W-L:L-W:typeof W=="string"&&typeof L=="string"?v==="asc"?W.localeCompare(L):L.localeCompare(W):W instanceof Date&&L instanceof Date?v==="asc"?W-L:L-W:0}),V=O=>m!==O?"":v==="asc"?"":"";return r.jsxs("div",{className:"movements-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"movements-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>F("type"),children:["Tipo ",V("type")]}),r.jsxs("th",{className:"sortable",onClick:()=>F("fuelType"),children:["Combustible ",V("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>F("quantity"),children:["Cantidad ",V("quantity")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>F("unitPrice"),children:["Precio/Gal ",V("unitPrice")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>F("totalValue"),children:["Valor Total ",V("totalValue")]}),r.jsx("th",{children:"Vehculo"}),r.jsx("th",{children:"Ubicacin"}),r.jsxs("th",{className:"sortable",onClick:()=>F("status"),children:["Estado ",V("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>F("createdAt"),children:["Fecha ",V("createdAt")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:Y.map(O=>r.jsxs("tr",{className:`movement-row ${O.status===ze.PENDIENTE?"pending-row":""}`,children:[r.jsx("td",{className:"type-cell",children:r.jsxs("div",{className:"type-content",children:[r.jsx("span",{className:"type-icon",children:j(O.type)}),r.jsx("span",{className:"type-text",children:O.type.charAt(0).toUpperCase()+O.type.slice(1)})]})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:T(O.fuelType)}),r.jsx("span",{className:"fuel-text",children:O.fuelType})]})}),r.jsxs("td",{className:"quantity-cell text-right",children:[r.jsx("span",{className:"quantity-value",children:O.quantity}),r.jsx("span",{className:"quantity-unit",children:"gal"})]}),r.jsx("td",{className:"price-cell text-right",children:b(O.unitPrice)}),r.jsx("td",{className:"value-cell text-right",children:r.jsx("strong",{children:b(O.totalValue)})}),r.jsx("td",{className:"vehicle-cell",children:O.vehicleId?r.jsxs("span",{className:"vehicle-id",children:[" ",O.vehicleId]}):r.jsx("span",{className:"no-vehicle",children:"-"})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:[" ",O.location||"Principal"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${x(O.status)}`,children:[r.jsx("span",{className:"status-icon",children:S(O.status)}),r.jsx("span",{className:"status-text",children:O.status.charAt(0).toUpperCase()+O.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:A(O.createdAt)}),O.reference&&r.jsxs("span",{className:"reference-small",children:["#",O.reference]})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(O),title:"Ver detalles",children:""}),d==="admin"&&O.status===ze.PENDIENTE&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-action btn-approve",onClick:()=>a(O.id),title:"Aprobar movimiento",children:""}),r.jsx("button",{className:"btn-action btn-reject",onClick:()=>o(O.id),title:"Rechazar movimiento",children:""})]}),e&&O.status===ze.PENDIENTE&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(O),title:"Editar movimiento",children:""}),d==="admin"&&r.jsx("button",{className:"btn-action btn-delete",onClick:()=>{window.confirm("Ests seguro de que deseas eliminar este movimiento? Esta accin no se puede deshacer.")&&c(O.id)},title:"Eliminar movimiento",children:""})]})})]},O.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[n.length," movimiento",n.length!==1?"s":""]}),m&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",m," (",v==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:""})," Pendiente"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:""})," Completado"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:""})," Cancelado"]})]})]})]})},RL=({movements:n,viewMode:e,onEdit:t,onView:a,onApprove:o,onReject:c,onDelete:d,userRole:m})=>e==="table"?r.jsx(IL,{movements:n,onEdit:t,onView:a,onApprove:o,onReject:c,onDelete:d,userRole:m}):r.jsx(SL,{movements:n,onEdit:t,onView:a,onApprove:o,onReject:c,onDelete:d,userRole:m}),Ta={ACPM:"ACPM",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},Lj={[Ta.ACPM]:{name:"ACPM",displayName:"ACPM ",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"",description:"Combustible diesel para vehculos pesados"},[Ta.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina ",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"",description:"Gasolina corriente para vehculos livianos"},[Ta.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidrulico ",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"",description:"Aceite hidrulico para sistemas de maquinaria"},[Ta.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 ",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"",description:"Aceite multigrado para motores"},[Ta.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja ",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"",description:"Grasa lubricante multipropsito"},[Ta.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"",description:"Aceite para transmisiones y diferenciales"},[Ta.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Lquido para Frenos ",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"",description:"Lquido de frenos DOT 3/4"},[Ta.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga ",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"",description:"Mezcla de combustible para equipos menores"},[Ta.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 ",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"",description:"Aceite especializado para tractores"}},Bs={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},Lx=()=>Object.values(Lj),Vx="combustibles_products",DL=async()=>{try{console.log(" Verificando productos existentes...");const n=we(Ve(ve,Vx),DO(1));if(!(await bt(n)).empty){console.log(" Productos ya existen en Firebase");return}console.log(" Creando productos predefinidos...");const t=Object.values(Lj).map(async o=>{const c={name:o.name,displayName:o.displayName,category:o.category,unit:o.unit,defaultPrice:o.defaultPrice,color:o.color,icon:o.icon,description:o.description,isActive:!0,createdAt:new Date,updatedAt:new Date,createdBy:"system-initialization"},d=rt(Ve(ve,Vx));return await df(d,c),console.log(` Producto creado: ${o.displayName}`),{id:d.id,...c}}),a=await Promise.all(t);return console.log(` ${a.length} productos inicializados correctamente`),a}catch(n){throw console.error(" Error inicializando productos:",n),n}},ML=async()=>{try{await DL()}catch(n){console.error(" Error en inicializacin automtica:",n)}},il="combustibles_products",Yp=async n=>{try{const e={...n,createdAt:nt(),updatedAt:nt()},t=await hl(Ve(ve,il),e);return console.log("Product created with ID:",t.id),t.id}catch(e){throw console.error("Error creating product:",e),e}},OL=async(n,e)=>{try{const t=rt(ve,il,n);await xs(t,{...e,updatedAt:nt()}),console.log("Product updated successfully")}catch(t){throw console.error("Error updating product:",t),t}},kL=async n=>{try{await hf(rt(ve,il,n)),console.log("Product deleted successfully")}catch(e){throw console.error("Error deleting product:",e),e}},PL=async()=>{try{await ML(),console.log(" Obteniendo productos activos...");const n=we(Ve(ve,il),ke("isActive","==",!0),jn("name")),t=(await bt(n)).docs.map(a=>({id:a.id,...a.data()}));return console.log(` Productos activos obtenidos: ${t.length}`),t}catch(n){if(console.error(" Error obteniendo productos activos:",n),n.code==="failed-precondition"||n.message.includes("index")){console.warn(" ndice no disponible, usando consulta alternativa...");try{const e=we(Ve(ve,il),ke("isActive","==",!0)),o=(await bt(e)).docs.map(c=>({id:c.id,...c.data()})).sort((c,d)=>(c.name||"").localeCompare(d.name||""));return console.log(` Productos activos obtenidos (ordenamiento en cliente): ${o.length}`),o}catch(e){throw console.error(" Error en consulta alternativa:",e),e}}throw n}},LL=(n,e)=>{try{const t=we(Ve(ve,il),jn("name"));return Ur(t,a=>{const o=a.docs.map(c=>({id:c.id,...c.data()}));n(o)},a=>{console.error("Error in products subscription:",a),e(a)})}catch(t){return console.error("Error setting up products subscription:",t),e(t),()=>{}}},VL=({isOpen:n,onClose:e,movement:t,mode:a,onSuccess:o})=>{const[c,d]=$.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),[m,p]=$.useState(!1),[v,_]=$.useState(""),[b,A]=$.useState({}),[j,T]=$.useState([]),[S,x]=$.useState(!1),[F,Y]=$.useState([]),[V,O]=$.useState(""),[U,W]=$.useState([]),[L,D]=$.useState([]),k=["Bodega Austria","Bodega Ilusion","Campo Operativo","Estacin Mvil"];$.useEffect(()=>((async()=>{if(n){document.body.style.overflow="hidden",x(!0);try{console.log(" Cargando datos para formulario de movimientos...");const[z,se,he,ye]=await Promise.all([Wv(),xj(),Oj(),PL()]);console.log(" Datos cargados:",{vehicles:z?.length||0,inventory:se?.success?se.data?.length||0:"Error",suppliers:he?.success?he.data?.length||0:"Error",products:ye?.length||0}),T(z),Y(se.success?se.data:[]),W(he.success?he.data:[]),D(ye),console.log(" Datos cargados exitosamente")}catch(z){console.error(" Error al cargar datos:",z)}finally{x(!1)}}else document.body.style.overflow="unset"})(),()=>{document.body.style.overflow="unset"}),[n]),$.useEffect(()=>{t&&(a==="edit"||a==="view")?d({type:t.type||"",fuelType:t.fuelType||"",quantity:t.quantity?.toString()||"",unitPrice:t.unitPrice?.toString()||"",location:t.location||"Principal",vehicleId:t.vehicleId||"",destinationLocation:t.destinationLocation||"",description:t.description||"",reference:t.reference||"",effectiveDate:t.effectiveDate?new Date(t.effectiveDate).toISOString().slice(0,16):new Date().toISOString().slice(0,16)}):a==="create"&&d({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),_(""),A({})},[t,a,n]),$.useEffect(()=>{if(c.fuelType&&!c.unitPrice&&L.length>0){const ne=L.find(z=>z.name===c.fuelType||z.displayName===c.fuelType);ne&&ne.defaultPrice&&d(z=>({...z,unitPrice:ne.defaultPrice.toString()}))}},[c.fuelType,L]),$.useEffect(()=>{if(O(""),(c.type===pe.SALIDA||c.type===pe.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&F.length>0){const ne={type:c.type===pe.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},z=kx(ne,F);z.isValid?z.warning&&O(` ${z.warning}`):O(` ${z.error}`)}},[c.type,c.fuelType,c.location,c.quantity,F]);const w=(ne,z)=>{d(ne==="type"?se=>({...se,[ne]:z,location:z===pe.ENTRADA?"":"Principal"}):se=>({...se,[ne]:z})),b[ne]&&A(se=>({...se,[ne]:""}))},C=()=>{const ne={};if(c.type||(ne.type="Tipo de movimiento requerido"),c.fuelType||(ne.fuelType="Tipo de combustible requerido"),c.quantity?parseFloat(c.quantity)<=0&&(ne.quantity="La cantidad debe ser mayor a cero"):ne.quantity="Cantidad requerida",c.unitPrice?parseFloat(c.unitPrice)<0&&(ne.unitPrice="El precio no puede ser negativo"):ne.unitPrice="Precio unitario requerido",c.type===pe.ENTRADA&&!c.location&&(ne.location="Las entradas requieren un proveedor"),c.type===pe.SALIDA&&!c.vehicleId&&(ne.vehicleId="Las salidas requieren un vehculo"),c.type===pe.TRANSFERENCIA&&!c.destinationLocation&&(ne.destinationLocation="Las transferencias requieren una ubicacin destino"),(c.type===pe.SALIDA||c.type===pe.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&F.length>0){const z={type:c.type===pe.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},se=kx(z,F);se.isValid||(ne.quantity=se.error)}return A(ne),Object.keys(ne).length===0},R=async ne=>{if(ne.preventDefault(),!C()){_("Por favor corrige los errores en el formulario");return}p(!0),_("");try{const z={...c,quantity:parseFloat(c.quantity),unitPrice:parseFloat(c.unitPrice),effectiveDate:new Date(c.effectiveDate)};a==="create"?await gj(z):a==="edit"&&await Qv(t.id,z),o()}catch(z){console.error("Error al guardar movimiento:",z),_(z.message||"Error al guardar el movimiento")}finally{p(!1)}},P=(parseFloat(c.quantity)||0)*(parseFloat(c.unitPrice)||0),Ee=()=>{switch(a){case"create":return" Nuevo Movimiento";case"edit":return" Editar Movimiento";case"view":return" Detalles del Movimiento";default:return"Movimiento"}};return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content movement-modal",onClick:ne=>ne.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:Ee()}),r.jsx("button",{className:"modal-close",onClick:e,children:""})]}),a==="create"&&r.jsx("div",{style:{padding:"10px",background:"#f0f0f0",borderBottom:"1px solid #ddd"},children:r.jsx("button",{onClick:()=>{console.log(" Debug - Estado actual:",{products:L.length,vehicles:j.length,suppliers:U.length,inventory:F.length,loadingVehicles:S}),alert(`Productos: ${L.length}, Vehculos: ${j.length}, Proveedores: ${U.length}`)},style:{background:"#007bff",color:"white",border:"none",padding:"5px 10px",borderRadius:"4px",cursor:"pointer"},children:" Debug Datos"})}),r.jsxs("div",{className:"modal-body",children:[v&&r.jsxs("div",{className:"error-message",children:[r.jsx("span",{className:"error-icon",children:""}),v]}),r.jsxs("form",{onSubmit:R,className:"movement-form",children:[r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Movimiento *"}),r.jsxs("select",{value:c.type,onChange:ne=>w("type",ne.target.value),disabled:a==="view",className:b.type?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),r.jsx("option",{value:pe.ENTRADA,children:" Entrada"}),r.jsx("option",{value:pe.SALIDA,children:" Salida"}),r.jsx("option",{value:pe.TRANSFERENCIA,children:" Transferencia"}),r.jsx("option",{value:pe.AJUSTE,children:" Ajuste"})]}),b.type&&r.jsx("span",{className:"field-error",children:b.type})]}),a==="view"&&t&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsx("div",{className:"status-display",children:r.jsxs("span",{className:`status-badge status-${t.status}`,children:[t.status===ze.COMPLETADO&&"",t.status===ze.PENDIENTE&&"",t.status===ze.CANCELADO&&"",t.status.charAt(0).toUpperCase()+t.status.slice(1)]})})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Combustible *"}),r.jsxs("select",{value:c.fuelType,onChange:ne=>w("fuelType",ne.target.value),disabled:a==="view",className:b.fuelType?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar producto/combustible..."}),L.map(ne=>r.jsxs("option",{value:ne.name,children:[ne.icon," ",ne.displayName]},ne.id))]}),b.fuelType&&r.jsx("span",{className:"field-error",children:b.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cantidad (galones) *"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:c.quantity,onChange:ne=>w("quantity",ne.target.value),disabled:a==="view",placeholder:"0.00",className:b.quantity?"error":""}),b.quantity&&r.jsx("span",{className:"field-error",children:b.quantity}),V&&!b.quantity&&r.jsx("div",{className:"stock-warning",children:V})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio Unitario (COP) *"}),r.jsx("input",{type:"number",step:"1",min:"0",value:c.unitPrice,onChange:ne=>w("unitPrice",ne.target.value),disabled:a==="view",placeholder:"0",className:b.unitPrice?"error":""}),b.unitPrice&&r.jsx("span",{className:"field-error",children:b.unitPrice})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Valor Total"}),r.jsx("div",{className:"total-value-display",children:An(P)})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:c.type===pe.ENTRADA?"Proveedor *":"Ubicacin"}),c.type===pe.ENTRADA?r.jsxs("select",{value:c.location,onChange:ne=>w("location",ne.target.value),disabled:a==="view",className:b.location?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar proveedor..."}),U.filter(ne=>ne.status==="active").map(ne=>r.jsxs("option",{value:ne.name,children:[" ",ne.name," - ",ne.city]},ne.id))]}):r.jsx("select",{value:c.location,onChange:ne=>w("location",ne.target.value),disabled:a==="view",children:k.map(ne=>r.jsxs("option",{value:ne,children:[" ",ne]},ne))}),b.location&&r.jsx("span",{className:"field-error",children:b.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:c.type===pe.ENTRADA?"Vehculo que hizo el transporte":`Vehculo/Equipo ${c.type===pe.SALIDA?"*":""}`}),c.type===pe.SALIDA?S?r.jsxs("div",{className:"loading-vehicles",children:[r.jsx("span",{className:"loading-spinner small"}),"Cargando vehculos..."]}):r.jsxs("select",{value:c.vehicleId,onChange:ne=>w("vehicleId",ne.target.value),disabled:a==="view",className:b.vehicleId?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar vehculo destino..."}),j.map(ne=>r.jsxs("option",{value:ne.vehicleId,children:[" ",ne.vehicleId," - ",ne.name," (",ne.type,")"]},ne.id))]}):r.jsx("input",{type:"text",value:c.vehicleId,onChange:ne=>w("vehicleId",ne.target.value),disabled:a==="view",placeholder:"ID del vehculo o equipo",className:b.vehicleId?"error":""}),b.vehicleId&&r.jsx("span",{className:"field-error",children:b.vehicleId})]})]}),c.type===pe.ENTRADA&&r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ubicacin Destino"}),r.jsxs("select",{value:c.destinationLocation,onChange:ne=>w("destinationLocation",ne.target.value),disabled:a==="view",className:b.destinationLocation?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar ubicacin destino (opcional)..."}),k.map(ne=>r.jsxs("option",{value:ne,children:[" ",ne]},ne))]}),b.destinationLocation&&r.jsx("span",{className:"field-error",children:b.destinationLocation}),r.jsx("small",{className:"field-hint",children:'Si no se especifica, se usar la ubicacin "Principal"'})]})}),c.type===pe.TRANSFERENCIA&&r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ubicacin Destino *"}),r.jsxs("select",{value:c.destinationLocation,onChange:ne=>w("destinationLocation",ne.target.value),disabled:a==="view",className:b.destinationLocation?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar destino..."}),k.filter(ne=>ne!==c.location).map(ne=>r.jsxs("option",{value:ne,children:[" ",ne]},ne))]}),b.destinationLocation&&r.jsx("span",{className:"field-error",children:b.destinationLocation})]})}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Fecha Efectiva"}),r.jsx("input",{type:"datetime-local",value:c.effectiveDate,onChange:ne=>w("effectiveDate",ne.target.value),disabled:a==="view"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Referencia"}),r.jsx("input",{type:"text",value:c.reference,onChange:ne=>w("reference",ne.target.value),disabled:a==="view",placeholder:"Factura, orden, etc."})]})]}),r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Descripcin"}),r.jsx("textarea",{value:c.description,onChange:ne=>w("description",ne.target.value),disabled:a==="view",placeholder:"Detalles adicionales del movimiento...",rows:"3"})]})}),a==="view"&&t&&r.jsx("div",{className:"movement-details",children:r.jsxs("div",{className:"details-section",children:[r.jsx("h4",{children:" Informacin del Sistema"}),r.jsxs("div",{className:"details-grid",children:[r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"ID:"}),r.jsx("span",{children:t.id})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Creado:"}),r.jsx("span",{children:new Date(t.createdAt).toLocaleString("es-CO")})]}),t.updatedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Actualizado:"}),r.jsx("span",{children:new Date(t.updatedAt).toLocaleString("es-CO")})]}),t.approvedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Aprobado:"}),r.jsx("span",{children:new Date(t.approvedAt).toLocaleString("es-CO")})]})]})]})})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-cancel",onClick:e,children:a==="view"?"Cerrar":"Cancelar"}),a!=="view"&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:R,disabled:m,children:m?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner small"}),"Guardando..."]}):a==="create"?"Crear Movimiento":"Actualizar Movimiento"})]})]})}):null},UL=()=>{const{user:n,userProfile:e,deleteMovement:t}=Ts(),[a,o]=$.useState([]),[c,d]=$.useState(null),[m,p]=$.useState(!0),[v,_]=$.useState(null),[b,A]=$.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[j,T]=$.useState("cards"),[S,x]=$.useState(""),[F,Y]=$.useState(!1),[V,O]=$.useState(null),[U,W]=$.useState("create");$.useEffect(()=>{if(!n)return;p(!0);const ye=Xv((q,ee)=>{if(ee){console.error("Error en suscripcin de movimientos:",ee),_("Error al cargar movimientos"),p(!1);return}o(q),_(null),p(!1)},b);return()=>ye()},[n,b]),$.useEffect(()=>{n&&(async()=>{try{const q=await _j(b);d(q)}catch(q){console.error("Error al cargar estadsticas:",q)}})()},[n,a,b]);const L=a.filter(ye=>{if(!S)return!0;const q=S.toLowerCase();return ye.fuelType?.toLowerCase().includes(q)||ye.type?.toLowerCase().includes(q)||ye.location?.toLowerCase().includes(q)||ye.vehicleId?.toLowerCase().includes(q)||ye.description?.toLowerCase().includes(q)||ye.reference?.toLowerCase().includes(q)}),D=()=>{O(null),W("create"),Y(!0)},k=ye=>{O(ye),W("edit"),Y(!0)},w=ye=>{O(ye),W("view"),Y(!0)},C=()=>{Y(!1),O(null)},R=ye=>{A(q=>({...q,...ye}))},P=()=>{A({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),x("")},Ee=async ye=>{if(window.confirm("Ests seguro de que quieres aprobar este movimiento? Esta accin actualizar el inventario."))try{await yj(ye),alert("Movimiento aprobado y stock actualizado.")}catch(q){console.error("Error al aprobar movimiento:",q),alert(`Error al aprobar movimiento: ${q.message}`)}},ne=async ye=>{if(window.confirm("Ests seguro de que quieres rechazar este movimiento?"))try{await Qv(ye,{status:ze.CANCELADO}),alert("Movimiento rechazado.")}catch(q){console.error("Error al rechazar movimiento:",q),alert(`Error al rechazar movimiento: ${q.message}`)}},z=async ye=>{try{const q=await t(ye);if(q.success)alert("Movimiento eliminado exitosamente.");else throw new Error(q.error)}catch(q){console.error("Error al eliminar movimiento:",q),alert(`Error al eliminar movimiento: ${q.message}`)}},se=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",he=e?.role==="admin";return m?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando movimientos..."})]})}):v?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:""}),r.jsx("h3",{children:"Error al cargar movimientos"}),r.jsx("p",{children:v}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"movements-main",children:[r.jsxs("div",{className:"movements-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:" Movimientos de Combustibles"}),r.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),se&&r.jsx("button",{className:"btn-create-movement",onClick:D,children:" Nuevo Movimiento"})]}),c&&r.jsx(wL,{stats:c,filters:b}),r.jsx(CL,{filters:b,onFilterChange:R,onClearFilters:P,searchTerm:S,onSearchChange:x,viewMode:j,onViewModeChange:T,totalResults:L.length}),L.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:""}),r.jsx("h3",{children:a.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),r.jsx("p",{children:a.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de bsqueda"}),a.length===0&&se&&r.jsx("button",{className:"btn-create-first",onClick:D,children:" Crear Primer Movimiento"})]}):r.jsx(RL,{movements:L,viewMode:j,onEdit:he?k:null,onView:w,onApprove:Ee,onReject:ne,onDelete:z,userRole:e?.role}),F&&r.jsx(VL,{isOpen:F,onClose:C,movement:V,mode:U,onSuccess:()=>{C()}})]})},FL=({stats:n,filters:e})=>{if(!n)return null;const t=b=>`${Me(b)} gal`,a=b=>`${Me(b)} hrs`,o=b=>`${b.toFixed(2)} gal/hr`,c=b=>{let A=0;for(let T=0;T<b.length;T++)A=(A<<5)-A+b.charCodeAt(T)&4294967295;const j=["#059669","#dc2626","#2563eb","#7c3aed","#ea580c","#16a34a","#ca8a04","#9333ea"];return j[Math.abs(A)%j.length]},d=b=>{if(!b)return"";const A=b.toLowerCase();return A.includes("excavadora")?"":A.includes("bulldozer")?"":A.includes("cargador")?"":A.includes("camion")?"":A.includes("grua")?"":A.includes("motosierra")?"":A.includes("tractor")?"":A.includes("volqueta")?"":""},m=b=>{switch(b){case Le.ACTIVO:return"#10b981";case Le.MANTENIMIENTO:return"#f59e0b";case Le.INACTIVO:return"#6b7280";case Le.REPARACION:return"#ef4444";default:return"#6b7280"}},p=b=>{switch(b){case Le.ACTIVO:return"";case Le.MANTENIMIENTO:return"";case Le.INACTIVO:return"";case Le.REPARACION:return"";default:return""}},v=b=>{switch(b){case gt.DIESEL:return"";case gt.GASOLINA:return"";case gt.ACPM:return"";case gt.MIXTO:return"";default:return""}},_=n.totalVehicles>0?((n.byStatus[Le.ACTIVO]||0)/n.totalVehicles*100).toFixed(1):0;return r.jsxs("div",{className:"vehicles-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.totalVehicles)}),r.jsx("div",{className:"stat-label",children:"Total Vehculos"}),r.jsx("div",{className:"stat-trend",children:r.jsxs("span",{className:`trend ${_>=80?"positive":"warning"}`,children:[_>=80?"":""," ",_,"% activos"]})})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:t(n.totalFuelConsumed)}),r.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(n.averageConsumption||0)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:a(n.totalHoursWorked)}),r.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",a(n.totalHoursWorked/(n.totalVehicles||1))]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:n.mostActiveVehicle?n.mostActiveVehicle.vehicleId:"N/A"}),r.jsx("div",{className:"stat-label",children:"Ms Activo"}),r.jsx("div",{className:"stat-secondary",children:n.mostActiveVehicle?`${n.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:" Por Tipo de Vehculo"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([b,A])=>{const j=(A/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:d(b)}),r.jsx("span",{className:"breakdown-label",children:b.charAt(0).toUpperCase()+b.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:A}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:c(b)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},b)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:" Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([b,A])=>{const j=(A/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:p(b)}),r.jsx("span",{className:"breakdown-label",children:b.charAt(0).toUpperCase()+b.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:A}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:m(b)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},b)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:" Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([b,A])=>{const j=(A/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(b)}),r.jsx("span",{className:"breakdown-label",children:b})]}),r.jsx("div",{className:"breakdown-value",children:A}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},b)})})]})]}),(n.totalFuelConsumed>0||n.totalHoursWorked>0)&&r.jsxs("div",{className:"performance-metrics",children:[r.jsx("h4",{children:" Mtricas de Rendimiento"}),r.jsxs("div",{className:"metrics-grid",children:[r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:""}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),r.jsxs("div",{className:"metric-value",children:[_,"%"]}),r.jsxs("div",{className:"metric-description",children:[n.byStatus[Le.ACTIVO]||0," de ",n.totalVehicles," activos"]})]})]}),n.averageConsumption>0&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:""}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),r.jsx("div",{className:"metric-value",children:o(n.averageConsumption)}),r.jsx("div",{className:"metric-description",children:"Por vehculo por hora trabajada"})]})]}),n.mostActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:""}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Mayor Utilizacin"}),r.jsx("div",{className:"metric-value",children:n.mostActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(n.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),n.leastActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:""}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Menor Utilizacin"}),r.jsx("div",{className:"metric-value",children:n.leastActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(n.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(e.type||e.status||e.fuelType||e.location)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:" Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.location&&r.jsxs("span",{className:"filter-tag",children:["Ubicacin: ",e.location]})]})]})]})},qL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:m})=>{const[p,v]=$.useState(!1),_=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mecnico","Proyecto A","Proyecto B","En Reparacin","Otros"],b=Object.values(n).filter(T=>T&&T!==""&&T!=="all").length,A=(T,S)=>{e({[T]:S})},j=T=>{e(T)};return r.jsxs("div",{className:"vehicles-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:""}),r.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicacin...",value:a,onChange:T=>o(T.target.value),className:"search-input"}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar bsqueda",children:""})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${n.status==="activo"?"active":""}`,onClick:()=>j({status:"activo"}),children:" Activos"}),r.jsx("button",{className:`quick-filter ${n.status==="mantenimiento"?"active":""}`,onClick:()=>j({status:"mantenimiento"}),children:" Mantenimiento"}),r.jsx("button",{className:`quick-filter ${n.type==="excavadora"?"active":""}`,onClick:()=>j({type:"excavadora"}),children:" Excavadoras"}),r.jsx("button",{className:`quick-filter ${n.type==="tractor"?"active":""}`,onClick:()=>j({type:"tractor"}),children:" Tractores"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:[" Filtros",b>0&&r.jsx("span",{className:"filters-count",children:b})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:""}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:""})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Vehculo"}),r.jsxs("select",{value:n.type,onChange:T=>A("type",T.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:"excavadora",children:" Excavadora"}),r.jsx("option",{value:"bulldozer",children:" Bulldozer"}),r.jsx("option",{value:"cargador",children:" Cargador"}),r.jsx("option",{value:"camion",children:" Camin"}),r.jsx("option",{value:"grua",children:" Gra"}),r.jsx("option",{value:"motosierra",children:" Motosierra"}),r.jsx("option",{value:"tractor",children:" Tractor"}),r.jsx("option",{value:"volqueta",children:" Volqueta"}),r.jsx("option",{value:"otros",children:" Otros"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:T=>A("status",T.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:Le.ACTIVO,children:" Activo"}),r.jsx("option",{value:Le.MANTENIMIENTO,children:" Mantenimiento"}),r.jsx("option",{value:Le.INACTIVO,children:" Inactivo"}),r.jsx("option",{value:Le.REPARACION,children:" Reparacin"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:n.fuelType,onChange:T=>A("fuelType",T.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),r.jsx("option",{value:gt.DIESEL,children:" Diesel"}),r.jsx("option",{value:gt.GASOLINA,children:" Gasolina"}),r.jsx("option",{value:gt.ACPM,children:" ACPM"}),r.jsx("option",{value:gt.MIXTO,children:" Mixto"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Ubicacin Actual"}),r.jsxs("select",{value:n.location,onChange:T=>A("location",T.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todas las ubicaciones"}),_.map(T=>r.jsxs("option",{value:T,children:[" ",T]},T))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Mantenimiento"}),r.jsxs("select",{value:n.maintenance,onChange:T=>A("maintenance",T.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos"}),r.jsx("option",{value:"due",children:"Mantenimiento debido"}),r.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),r.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:b===0,children:" Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[m," resultado",m!==1?"s":""]}),b>0&&r.jsxs("span",{className:"active-filters-text",children:["(",b," filtro",b!==1?"s":""," activo",b!==1?"s":"",")"]})]})]})]}),b>0&&r.jsx("div",{className:"active-filters-summary",children:r.jsxs("div",{className:"summary-content",children:[r.jsx("span",{className:"summary-label",children:"Filtros activos:"}),r.jsxs("div",{className:"summary-tags",children:[n.type&&r.jsxs("span",{className:"summary-tag",onClick:()=>A("type",""),children:["Tipo: ",n.type," "]}),n.status&&r.jsxs("span",{className:"summary-tag",onClick:()=>A("status",""),children:["Estado: ",n.status," "]}),n.fuelType&&r.jsxs("span",{className:"summary-tag",onClick:()=>A("fuelType",""),children:["Combustible: ",n.fuelType," "]}),n.location&&r.jsxs("span",{className:"summary-tag",onClick:()=>A("location",""),children:["Ubicacin: ",n.location," "]}),n.maintenance!=="all"&&r.jsxs("span",{className:"summary-tag",onClick:()=>A("maintenance","all"),children:["Mantenimiento: ",n.maintenance," "]})]})]})}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:" Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},BL=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const o=x=>new Intl.NumberFormat("es-CO").format(x),c=x=>`${o(x)} gal`,d=x=>`${o(x)} hrs`,m=x=>x?(x instanceof Date?x:new Date(x)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",p=x=>{if(!x)return"";const F=new Date,Y=x instanceof Date?x:new Date(x),V=Math.abs(F-Y),O=Math.ceil(V/(1e3*60*60*24));return O===1?"hace 1 da":O<7?`hace ${O} das`:O<30?`hace ${Math.ceil(O/7)} semanas`:O<365?`hace ${Math.ceil(O/30)} meses`:`hace ${Math.ceil(O/365)} aos`},v=x=>{if(!x)return"vehicle-default";const F=x.toLowerCase();return F.includes("excavadora")?"vehicle-excavadora":F.includes("bulldozer")?"vehicle-bulldozer":F.includes("cargador")?"vehicle-cargador":F.includes("camion")?"vehicle-camion":F.includes("grua")?"vehicle-grua":F.includes("motosierra")?"vehicle-motosierra":F.includes("tractor")?"vehicle-tractor":F.includes("volqueta")?"vehicle-volqueta":"vehicle-default"},_=x=>{switch(x){case Le.ACTIVO:return"status-activo";case Le.MANTENIMIENTO:return"status-mantenimiento";case Le.INACTIVO:return"status-inactivo";case Le.REPARACION:return"status-reparacion";default:return"status-default"}},b=x=>{if(!x)return"";const F=x.toLowerCase();return F.includes("excavadora")?"":F.includes("bulldozer")?"":F.includes("cargador")?"":F.includes("camion")?"":F.includes("grua")?"":F.includes("motosierra")?"":F.includes("tractor")?"":F.includes("volqueta")?"":""},A=x=>{switch(x){case gt.DIESEL:return"";case gt.GASOLINA:return"";case gt.ACPM:return"";case gt.MIXTO:return"";default:return""}},j=x=>{switch(x){case Le.ACTIVO:return"";case Le.MANTENIMIENTO:return"";case Le.INACTIVO:return"";case Le.REPARACION:return"";default:return""}},T=x=>!x.totalHoursWorked||x.totalHoursWorked===0?x.estimatedConsumptionPerHour||0:x.totalFuelConsumed/x.totalHoursWorked,S=x=>x.lastMaintenanceDate?Math.floor((new Date-new Date(x.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsx("div",{className:"vehicles-cards",children:n.map(x=>r.jsxs("div",{className:`vehicle-card ${v(x.type)}`,children:[r.jsx("div",{className:"card-header",children:r.jsxs("div",{className:"vehicle-info",children:[r.jsxs("div",{className:"vehicle-id-section",children:[r.jsx("span",{className:"vehicle-icon",children:b(x.type)}),r.jsxs("div",{className:"vehicle-details",children:[r.jsx("span",{className:"vehicle-id",children:x.vehicleId}),r.jsx("span",{className:"vehicle-name",children:x.name})]})]}),r.jsxs("div",{className:`status-badge ${_(x.status)}`,children:[r.jsx("span",{className:"status-icon",children:j(x.status)}),r.jsx("span",{className:"status-label",children:x.status.charAt(0).toUpperCase()+x.status.slice(1)})]})]})}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"basic-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Tipo:"}),r.jsxs("span",{className:"info-value",children:[b(x.type)," ",x.type.charAt(0).toUpperCase()+x.type.slice(1)]})]}),x.brand&&x.model&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),r.jsxs("span",{className:"info-value",children:[x.brand," ",x.model]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Combustible:"}),r.jsxs("span",{className:"info-value",children:[A(x.fuelType)," ",x.fuelType]})]}),x.currentLocation&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Ubicacin:"}),r.jsxs("span",{className:"info-value",children:[" ",x.currentLocation]})]})]}),r.jsxs("div",{className:"consumption-metrics",children:[r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:""}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:c(x.totalFuelConsumed||0)}),r.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:""}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:d(x.totalHoursWorked||0)}),r.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:""}),r.jsxs("div",{className:"metric-content",children:[r.jsxs("div",{className:"metric-value",children:[T(x).toFixed(1)," gal/hr"]}),r.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:""}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:x.totalMovements||0}),r.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(x.enginePower||x.fuelCapacity||x.year)&&r.jsxs("div",{className:"technical-specs",children:[x.enginePower&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:""}),r.jsxs("span",{className:"spec-value",children:[x.enginePower," HP"]})]}),x.fuelCapacity&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:""}),r.jsxs("span",{className:"spec-value",children:[x.fuelCapacity," gal"]})]}),x.year&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:""}),r.jsx("span",{className:"spec-value",children:x.year})]})]}),x.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:x.description})})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[x.lastMovementDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"ltimo movimiento:"}),r.jsx("span",{className:"date-value",children:m(x.lastMovementDate)}),r.jsx("span",{className:"date-relative",children:p(x.lastMovementDate)})]}),x.lastMaintenanceDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"ltimo mantenimiento:"}),r.jsx("span",{className:"date-value",children:m(x.lastMaintenanceDate)}),r.jsx("span",{className:"date-relative",children:p(x.lastMaintenanceDate)})]})]}),r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(x),title:"Ver detalles",children:""}),e&&x.status!==Le.REPARACION&&r.jsx("button",{className:"btn-edit",onClick:()=>e(x),title:"Editar vehculo",children:""}),a&&r.jsx("button",{className:"btn-maintenance",onClick:()=>a(x),title:"Registrar mantenimiento",children:""})]})]}),x.status===Le.MANTENIMIENTO&&r.jsx("div",{className:"maintenance-indicator",children:r.jsx("div",{className:"maintenance-pulse"})}),S(x)&&x.status===Le.ACTIVO&&r.jsx("div",{className:"maintenance-due-badge",children:r.jsx("span",{children:"Mantenimiento Debido"})}),x.status===Le.REPARACION&&r.jsx("div",{className:"repair-badge",children:r.jsx("span",{children:"En Reparacin"})}),x.totalHoursWorked>0&&r.jsxs("div",{className:"efficiency-indicator",children:[r.jsx("div",{className:"efficiency-bar",children:r.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(x.totalHoursWorked/2e3*100,100)}%`}})}),r.jsxs("span",{className:"efficiency-label",children:[(x.totalHoursWorked/2e3*100).toFixed(1),"% utilizacin anual"]})]})]},x.id))})},zL=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const[o,c]=$.useState("vehicleId"),[d,m]=$.useState("asc"),p=U=>new Intl.NumberFormat("es-CO").format(U),v=U=>`${p(U)} gal`,_=U=>`${p(U)} hrs`,b=U=>U?(U instanceof Date?U:new Date(U)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",A=U=>{if(!U)return"";const W=U.toLowerCase();return W.includes("excavadora")?"":W.includes("bulldozer")?"":W.includes("cargador")?"":W.includes("camion")?"":W.includes("grua")?"":W.includes("motosierra")?"":W.includes("tractor")?"":W.includes("volqueta")?"":""},j=U=>{switch(U){case gt.DIESEL:return"";case gt.GASOLINA:return"";case gt.ACPM:return"";case gt.MIXTO:return"";default:return""}},T=U=>{switch(U){case Le.ACTIVO:return"";case Le.MANTENIMIENTO:return"";case Le.INACTIVO:return"";case Le.REPARACION:return"";default:return""}},S=U=>{switch(U){case Le.ACTIVO:return"status-activo";case Le.MANTENIMIENTO:return"status-mantenimiento";case Le.INACTIVO:return"status-inactivo";case Le.REPARACION:return"status-reparacion";default:return"status-default"}},x=U=>{o===U?m(d==="asc"?"desc":"asc"):(c(U),m("asc"))},F=[...n].sort((U,W)=>{let L=U[o],D=W[o];return(o.includes("Date")||o.includes("At"))&&(L=new Date(L||0),D=new Date(D||0)),typeof L=="number"&&typeof D=="number"?d==="asc"?L-D:D-L:typeof L=="string"&&typeof D=="string"?d==="asc"?L.localeCompare(D):D.localeCompare(L):L instanceof Date&&D instanceof Date?d==="asc"?L-D:D-L:!L&&!D?0:L?D?0:d==="asc"?-1:1:d==="asc"?1:-1}),Y=U=>o!==U?"":d==="asc"?"":"",V=U=>!U.totalHoursWorked||U.totalHoursWorked===0?U.estimatedConsumptionPerHour||0:U.totalFuelConsumed/U.totalHoursWorked,O=U=>U.lastMaintenanceDate?Math.floor((new Date-new Date(U.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsxs("div",{className:"vehicles-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"vehicles-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>x("vehicleId"),children:["ID Vehculo ",Y("vehicleId")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("name"),children:["Nombre ",Y("name")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("type"),children:["Tipo ",Y("type")]}),r.jsx("th",{children:"Marca/Modelo"}),r.jsxs("th",{className:"sortable",onClick:()=>x("fuelType"),children:["Combustible ",Y("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("totalFuelConsumed"),children:["Consumido ",Y("totalFuelConsumed")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("totalHoursWorked"),children:["Horas ",Y("totalHoursWorked")]}),r.jsx("th",{className:"text-right",children:"Consumo/Hr"}),r.jsx("th",{children:"Ubicacin"}),r.jsxs("th",{className:"sortable",onClick:()=>x("status"),children:["Estado ",Y("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("lastMovementDate"),children:["ltimo Mov. ",Y("lastMovementDate")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:F.map(U=>r.jsxs("tr",{className:`vehicle-row ${U.status===Le.MANTENIMIENTO?"maintenance-row":""} ${O(U)?"needs-maintenance":""}`,children:[r.jsx("td",{className:"vehicle-id-cell",children:r.jsxs("div",{className:"id-content",children:[r.jsx("span",{className:"vehicle-icon",children:A(U.type)}),r.jsx("span",{className:"vehicle-id",children:U.vehicleId})]})}),r.jsx("td",{className:"name-cell",children:r.jsx("span",{className:"vehicle-name",children:U.name})}),r.jsx("td",{className:"type-cell",children:r.jsx("span",{className:"type-text",children:U.type.charAt(0).toUpperCase()+U.type.slice(1)})}),r.jsx("td",{className:"brand-model-cell",children:U.brand&&U.model?r.jsxs("span",{className:"brand-model",children:[U.brand," ",U.model]}):r.jsx("span",{className:"no-data",children:"-"})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:j(U.fuelType)}),r.jsx("span",{className:"fuel-text",children:U.fuelType})]})}),r.jsx("td",{className:"consumption-cell text-right",children:r.jsx("span",{className:"consumption-value",children:v(U.totalFuelConsumed||0)})}),r.jsx("td",{className:"hours-cell text-right",children:r.jsx("span",{className:"hours-value",children:_(U.totalHoursWorked||0)})}),r.jsx("td",{className:"rate-cell text-right",children:r.jsxs("span",{className:"rate-value",children:[V(U).toFixed(1)," gal/hr"]})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:[" ",U.currentLocation||"Sin ubicacin"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${S(U.status)}`,children:[r.jsx("span",{className:"status-icon",children:T(U.status)}),r.jsx("span",{className:"status-text",children:U.status.charAt(0).toUpperCase()+U.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:b(U.lastMovementDate)}),O(U)&&r.jsx("span",{className:"maintenance-warning",children:""})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(U),title:"Ver detalles",children:""}),e&&U.status!==Le.REPARACION&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(U),title:"Editar vehculo",children:""}),a&&r.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>a(U),title:"Registrar mantenimiento",children:""})]})})]},U.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[n.length," vehculo",n.length!==1?"s":""]}),o&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",o," (",d==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:""})," Activo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:""})," Mantenimiento"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:""})," Inactivo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:""})," Reparacin"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:""})," Mantto. Debido"]})]})]})]})},HL=({vehicles:n,viewMode:e,onEdit:t,onView:a,onMaintenance:o})=>e==="table"?r.jsx(zL,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}):r.jsx(BL,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}),GL="modulepreload",$L=function(n){return"/combustibles/"+n},Ux={},ey=function(e,t,a){let o=Promise.resolve();if(t&&t.length>0){let v=function(_){return Promise.all(_.map(b=>Promise.resolve(b).then(A=>({status:"fulfilled",value:A}),A=>({status:"rejected",reason:A}))))};var d=v;document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),p=m?.nonce||m?.getAttribute("nonce");o=v(t.map(_=>{if(_=$L(_),_ in Ux)return;Ux[_]=!0;const b=_.endsWith(".css"),A=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${A}`))return;const j=document.createElement("link");if(j.rel=b?"stylesheet":GL,b||(j.as="script"),j.crossOrigin="",j.href=_,p&&j.setAttribute("nonce",p),document.head.appendChild(j),b)return new Promise((T,S)=>{j.addEventListener("load",T),j.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${_}`)))})}))}function c(m){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=m,window.dispatchEvent(p),!p.defaultPrevented)throw m}return o.then(m=>{for(const p of m||[])p.status==="rejected"&&c(p.reason);return e().catch(c)})},_u="combustibles_vehicle_categories",YL=async n=>{try{const e=wj(n);if(!e.isValid)throw new Error(`Datos invlidos: ${e.errors.join(", ")}`);const t=await Vj();if(t.some(d=>d.id===n.id||d.name.toLowerCase()===n.name.toLowerCase()))throw new Error("Ya existe una categora con ese nombre o ID");n.id||(n.id=Cj(n.name,t));const o={...n,createdAt:nt(),updatedAt:nt(),isCustom:!0,vehicleCount:0},c=await hl(Ve(ve,_u),o);return console.log(" Categora creada:",n.name),{id:c.id,...o,createdAt:new Date,updatedAt:new Date}}catch(e){throw console.error(" Error al crear categora:",e),new Error(`Error al crear categora: ${e.message}`)}},Vj=async()=>{try{const n=we(Ve(ve,_u),jn("name","asc")),e=await bt(n),t=[];return e.forEach(a=>{t.push({id:a.id,...a.data(),createdAt:a.data().createdAt?.toDate?.()||a.data().createdAt,updatedAt:a.data().updatedAt?.toDate?.()||a.data().updatedAt})}),t}catch(n){throw console.error(" Error al obtener categoras personalizadas:",n),new Error(`Error al obtener categoras: ${n.message}`)}},ty=async()=>{try{const n=await Vj();return jj(n)}catch(n){return console.error(" Error al obtener todas las categoras:",n),rs}},KL=async(n,e)=>{try{if(!n)throw new Error("ID de categora requerido");if(rs.some(d=>d.id===n))throw new Error("No se pueden modificar las categoras predeterminadas");if(e.name||e.fuelTypes||e.fields){const d=wj({...e,id:n});if(!d.isValid)throw new Error(`Datos invlidos: ${d.errors.join(", ")}`)}const a={...e,updatedAt:nt()},o=rt(ve,_u,n);await xs(o,a),console.log(" Categora actualizada:",n);const c=await Li(o);return{id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt}}catch(t){throw console.error(" Error al actualizar categora:",t),new Error(`Error al actualizar categora: ${t.message}`)}},QL=async n=>{try{if(!n)throw new Error("ID de categora requerido");if(rs.some(c=>c.id===n))throw new Error("No se pueden eliminar las categoras predeterminadas");const{countVehiclesByCategory:t}=await ey(async()=>{const{countVehiclesByCategory:c}=await Promise.resolve().then(()=>Mj);return{countVehiclesByCategory:c}},void 0),a=await t(n);if(a>0)throw new Error(`No se puede eliminar la categora porque tiene ${a} vehculo(s) asignado(s)`);const o=rt(ve,_u,n);return await hf(o),console.log(" Categora eliminada:",n),!0}catch(e){throw console.error(" Error al eliminar categora:",e),new Error(`Error al eliminar categora: ${e.message}`)}},XL=n=>{try{const e=we(Ve(ve,_u),jn("name","asc"));return Ur(e,t=>{const a=[];t.forEach(c=>{a.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt})});const o=jj(a);n(o)},t=>{console.error(" Error en suscripcin a categoras:",t),n(rs)})}catch(e){return console.error(" Error al suscribirse a categoras:",e),n(rs),()=>{}}},Fx=async()=>{try{const{getAllVehicles:n}=await ey(async()=>{const{getAllVehicles:a}=await Promise.resolve().then(()=>Mj);return{getAllVehicles:a}},void 0),e=await n();return(await ty()).map(a=>{const o=e.filter(c=>c.category===a.id);return{...a,vehicleCount:o.length,activeVehicles:o.filter(c=>c.status==="activo").length,totalFuelCapacity:o.reduce((c,d)=>c+(d.fuelCapacity||0),0),avgEnginepower:o.length>0?o.reduce((c,d)=>c+(d.enginePower||0),0)/o.length:0}}).sort((a,o)=>o.vehicleCount-a.vehicleCount)}catch(n){return console.error(" Error al obtener estadsticas de categoras:",n),[]}},Uj=({onClose:n,onCategoryCreated:e})=>{const[t,a]=$.useState([]),[o,c]=$.useState([]),[d,m]=$.useState(!0),[p,v]=$.useState(!1),[_,b]=$.useState(null),[A,j]=$.useState(!1),[T,S]=$.useState(""),[x,F]=$.useState({name:"",description:"",icon:"",color:"#2E86AB",fuelTypes:[],fields:[]});$.useEffect(()=>{Y();const C=XL(R=>{a(R),V()});return()=>C&&C()},[]);const Y=async()=>{try{m(!0);const[C,R]=await Promise.all([ty(),Fx()]);a(C),c(R)}catch(C){console.error("Error cargando categoras:",C),S("Error al cargar categoras")}finally{m(!1)}},V=async()=>{try{const C=await Fx();c(C)}catch(C){console.error("Error cargando estadsticas:",C)}},O=()=>{b(null),F({name:"",description:"",icon:"",color:"#2E86AB",fuelTypes:[],fields:[]}),j(!0)},U=C=>{if(rs.some(R=>R.id===C.id)){S("No se pueden editar las categoras predeterminadas");return}b(C),F({name:C.name||"",description:C.description||"",icon:C.icon||"",color:C.color||"#2E86AB",fuelTypes:C.fuelTypes||[],fields:C.fields||[]}),j(!0)},W=async C=>{if(rs.some(P=>P.id===C.id)){S("No se pueden eliminar las categoras predeterminadas");return}if(window.confirm(`Est seguro de eliminar la categora "${C.name}"?

Esta accin no se puede deshacer.`))try{v(!0),await QL(C.id),S("")}catch(P){console.error("Error eliminando categora:",P),S(P.message)}finally{v(!1)}},L=async C=>{if(C.preventDefault(),!x.name.trim()){S("El nombre de la categora es requerido");return}try{v(!0),S("");const R={...x,name:x.name.trim(),description:x.description.trim()};if(_)await KL(_.id,R);else{R.id=Cj(R.name,t);const P=await YL(R);e&&e(P)}j(!1)}catch(R){console.error("Error guardando categora:",R),S(R.message)}finally{v(!1)}},D=C=>{F(R=>({...R,fields:R.fields.includes(C)?R.fields.filter(P=>P!==C):[...R.fields,C]}))},k=C=>{F(R=>({...R,fuelTypes:R.fuelTypes.includes(C)?R.fuelTypes.filter(P=>P!==C):[...R.fuelTypes,C]}))},w=C=>o.find(R=>R.id===C)||{vehicleCount:0,activeVehicles:0};return d?r.jsx("div",{className:"categories-manager",children:r.jsxs("div",{className:"loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Cargando categoras..."})]})}):r.jsxs("div",{className:"categories-manager",children:[r.jsxs("div",{className:"categories-header",children:[r.jsx("h3",{children:" Gestin de Categoras"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{className:"btn-primary",onClick:O,disabled:p,children:" Nueva Categora"}),r.jsx("button",{className:"btn-secondary",onClick:n,children:" Cerrar"})]})]}),T&&r.jsxs("div",{className:"error-message",children:[r.jsxs("span",{children:[" ",T]}),r.jsx("button",{onClick:()=>S(""),children:""})]}),r.jsx("div",{className:"categories-grid",children:t.map(C=>{const R=rs.some(Ee=>Ee.id===C.id),P=w(C.id);return r.jsxs("div",{className:`category-card ${R?"default":"custom"}`,style:{"--category-color":C.color},children:[r.jsxs("div",{className:"category-header",children:[r.jsx("div",{className:"category-icon",style:{color:C.color},children:C.icon}),r.jsxs("div",{className:"category-info",children:[r.jsx("h4",{children:C.name}),r.jsx("p",{children:C.description})]}),R&&r.jsx("span",{className:"default-badge",children:"Predeterminada"})]}),r.jsxs("div",{className:"category-stats",children:[r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-value",children:P.vehicleCount}),r.jsx("span",{className:"stat-label",children:"Vehculos"})]}),r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-value",children:P.activeVehicles}),r.jsx("span",{className:"stat-label",children:"Activos"})]})]}),r.jsxs("div",{className:"category-details",children:[r.jsxs("div",{className:"fuel-types",children:[r.jsx("strong",{children:"Combustibles:"}),r.jsx("div",{className:"fuel-list",children:(C.fuelTypes||[]).map(Ee=>r.jsx("span",{className:"fuel-tag",children:Ee},Ee))})]}),r.jsxs("div",{className:"fields",children:[r.jsx("strong",{children:"Campos:"}),r.jsxs("div",{className:"fields-list",children:[(C.fields||[]).slice(0,3).map(Ee=>{const ne=Ag.find(z=>z.key===Ee);return ne?r.jsxs("span",{className:"field-tag",children:[ne.icon," ",ne.label]},Ee):null}),(C.fields||[]).length>3&&r.jsxs("span",{className:"more-fields",children:["+",(C.fields||[]).length-3," ms"]})]})]})]}),r.jsxs("div",{className:"category-actions",children:[r.jsx("button",{className:"btn-edit",onClick:()=>U(C),disabled:R||p,title:R?"No se pueden editar categoras predeterminadas":"Editar categora",children:" Editar"}),r.jsx("button",{className:"btn-delete",onClick:()=>W(C),disabled:R||p||P.vehicleCount>0,title:R?"No se pueden eliminar categoras predeterminadas":P.vehicleCount>0?"No se puede eliminar una categora con vehculos asignados":"Eliminar categora",children:" Eliminar"})]})]},C.id)})}),A&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:_?" Editar Categora":" Nueva Categora"}),r.jsx("button",{onClick:()=>j(!1),children:""})]}),r.jsxs("form",{onSubmit:L,className:"category-form",children:[r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{children:"Informacin Bsica"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre *"}),r.jsx("input",{type:"text",value:x.name,onChange:C=>F(R=>({...R,name:C.target.value})),placeholder:"Ej: Maquinaria Pesada",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Icono"}),r.jsx("input",{type:"text",value:x.icon,onChange:C=>F(R=>({...R,icon:C.target.value})),placeholder:"",className:"icon-input"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Descripcin"}),r.jsx("textarea",{value:x.description,onChange:C=>F(R=>({...R,description:C.target.value})),placeholder:"Describe el tipo de vehculos que incluye esta categora",rows:"2"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Color"}),r.jsx("input",{type:"color",value:x.color,onChange:C=>F(R=>({...R,color:C.target.value})),className:"color-input"})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{children:"Tipos de Combustible Compatibles"}),r.jsx("div",{className:"fuel-types-grid",children:Object.values(Aj).map(C=>r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:x.fuelTypes.includes(C),onChange:()=>k(C)}),r.jsx("span",{children:C})]},C))})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{children:"Campos Especficos"}),r.jsx("p",{className:"section-description",children:"Selecciona los campos que sern relevantes para esta categora"}),r.jsx("div",{className:"fields-grid",children:Ag.map(C=>r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:x.fields.includes(C.key),onChange:()=>D(C.key)}),r.jsxs("span",{children:[C.icon," ",C.label]})]},C.key))})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{children:"Vista Previa"}),r.jsx("div",{className:"category-preview",style:{"--category-color":x.color},children:r.jsxs("div",{className:"category-header",children:[r.jsx("div",{className:"category-icon",style:{color:x.color},children:x.icon}),r.jsxs("div",{className:"category-info",children:[r.jsx("h4",{children:x.name||"Nombre de la categora"}),r.jsx("p",{children:x.description||"Descripcin de la categora"})]})]})})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>j(!1),disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:p||!x.name.trim(),children:p?"Guardando...":_?"Actualizar":"Crear"})]})]})]})})]})},WL=({isOpen:n,onClose:e,vehicle:t,onSave:a,mode:o="create"})=>{const[c,d]=$.useState([]),[m,p]=$.useState(null),[v,_]=$.useState(!1),[b,A]=$.useState(!1),[j,T]=$.useState({}),S=()=>({vehicleId:t?.vehicleId||"",name:t?.name||"",category:t?.category||"",brand:t?.brand||"",model:t?.model||"",year:t?.year||new Date().getFullYear(),fuelType:t?.fuelType||gt.DIESEL,status:t?.status||Le.ACTIVO,currentLocation:t?.currentLocation||"",description:t?.description||"",plateNumber:t?.plateNumber||"",enginePower:t?.enginePower||"",fuelCapacity:t?.fuelCapacity||"",operatingWeight:t?.operatingWeight||"",loadCapacity:t?.loadCapacity||"",bucketCapacity:t?.bucketCapacity||"",hasHourMeter:t?.hasHourMeter||!1,currentHours:t?.currentHours||"",implementType:t?.implementType||"",flow:t?.flow||"",pressure:t?.pressure||"",weight:t?.weight||"",lastMaintenanceDate:t?.lastMaintenanceDate?new Date(t.lastMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:t?.purchaseDate?new Date(t.purchaseDate).toISOString().split("T")[0]:""}),[x,F]=$.useState(S());$.useEffect(()=>(n?(Y(),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n]),$.useEffect(()=>{if(t&&c.length>0){const w=Ox(t.category,c);p(w),F(S())}},[t,c]);const Y=async()=>{try{A(!0);const w=await ty();if(d(w),o==="create"&&w.length>0){const C=w[0];p(C),F(R=>({...R,category:C.id}))}}catch(w){console.error("Error cargando categoras:",w)}finally{A(!1)}},V=w=>{const C=Ox(w,c);p(C),F(R=>({...R,category:w,fuelType:C?.fuelTypes?.includes(R.fuelType)?R.fuelType:C?.fuelTypes?.[0]||gt.DIESEL})),T({})},O=(w,C)=>{if(F(R=>({...R,[w]:C})),j[w]&&T(R=>({...R,[w]:null})),w==="name"&&!x.vehicleId&&o==="create"){const R=U(C,m);F(P=>({...P,vehicleId:R}))}},U=(w,C)=>{if(!w||!C)return"";const R=C.name.split(" ").map(Ee=>Ee.charAt(0).toUpperCase()).join(""),P=w.replace(/[^a-zA-Z0-9]/g,"").substring(0,6).toUpperCase();return`${R}-${P}-${String(Math.floor(Math.random()*100)).padStart(2,"0")}`},W=()=>{const w={};return x.vehicleId?.trim()||(w.vehicleId="Cdigo del vehculo es requerido"),x.name?.trim()||(w.name="Nombre del vehculo es requerido"),x.category||(w.category="Categora es requerida"),x.fuelType||(w.fuelType="Tipo de combustible es requerido"),m&&x.fuelType&&(m.fuelTypes?.includes(x.fuelType)||(w.fuelType=`Este combustible no es compatible con la categora ${m.name}`)),["enginePower","fuelCapacity","operatingWeight","loadCapacity","bucketCapacity","flow","pressure","weight"].forEach(R=>{x[R]&&(isNaN(x[R])||Number(x[R])<0)&&(w[R]="Debe ser un nmero vlido mayor o igual a 0")}),x.year&&(x.year<1900||x.year>new Date().getFullYear()+1)&&(w.year=`Ao debe estar entre 1900 y ${new Date().getFullYear()+1}`),x.hasHourMeter&&x.currentHours&&(isNaN(x.currentHours)||Number(x.currentHours)<0)&&(w.currentHours="Horas actuales debe ser un nmero vlido mayor o igual a 0"),T(w),Object.keys(w).length===0},L=async w=>{if(w.preventDefault(),!!W())try{A(!0);const C={...x,enginePower:x.enginePower?Number(x.enginePower):null,fuelCapacity:x.fuelCapacity?Number(x.fuelCapacity):null,operatingWeight:x.operatingWeight?Number(x.operatingWeight):null,loadCapacity:x.loadCapacity?Number(x.loadCapacity):null,bucketCapacity:x.bucketCapacity?Number(x.bucketCapacity):null,currentHours:x.currentHours?Number(x.currentHours):null,flow:x.flow?Number(x.flow):null,pressure:x.pressure?Number(x.pressure):null,weight:x.weight?Number(x.weight):null,year:Number(x.year),lastMaintenanceDate:x.lastMaintenanceDate?new Date(x.lastMaintenanceDate):null,purchaseDate:x.purchaseDate?new Date(x.purchaseDate):null,categoryName:m?.name,categoryIcon:m?.icon,categoryColor:m?.color};await a(C),e()}catch(C){console.error("Error guardando vehculo:",C),T({submit:C.message})}finally{A(!1)}},D=w=>{const C=Ag.find(ne=>ne.key===w);if(!C)return null;const R=x[w]||"",P=j[w];if(C.dependsOn&&!x[C.dependsOn])return null;const Ee={id:w,value:R,onChange:ne=>O(w,ne.target.value),className:`form-input ${P?"error":""}`};return r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:w,className:"form-label",children:[C.icon," ",C.label]}),C.type==="boolean"?r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:R,onChange:ne=>O(w,ne.target.checked)}),r.jsxs("span",{children:["S, tiene ",C.label.toLowerCase()]})]}):r.jsx("input",{type:C.type,...Ee,placeholder:`Ingrese ${C.label.toLowerCase()}`,min:C.type==="number"?"0":void 0,step:C.type==="number"?"any":void 0}),P&&r.jsx("span",{className:"field-error",children:P})]},w)},k=()=>m&&m.fuelTypes||Object.values(gt);return n?r.jsxs("div",{className:"modal-overlay",children:[r.jsxs("div",{className:"modal-container",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:o==="create"?" Nuevo Vehculo":" Editar Vehculo"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>_(!0),disabled:b,children:" Gestionar Categoras"}),r.jsx("button",{type:"button",className:"btn-close",onClick:e,children:""})]})]}),r.jsxs("form",{onSubmit:L,className:"modal-body",children:[j.submit&&r.jsxs("div",{className:"error-banner",children:[" ",j.submit]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:" Categora del Vehculo"}),b?r.jsxs("div",{className:"loading-categories",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{children:"Cargando categoras..."})]}):r.jsx("div",{className:"categories-selector",children:c.map(w=>r.jsxs("div",{className:`category-option ${x.category===w.id?"selected":""}`,onClick:()=>V(w.id),style:{"--category-color":w.color},children:[r.jsx("div",{className:"category-icon",style:{color:w.color},children:w.icon}),r.jsxs("div",{className:"category-info",children:[r.jsx("h4",{children:w.name}),r.jsx("p",{children:w.description})]}),rs.some(C=>C.id===w.id)&&r.jsx("span",{className:"default-badge",children:"Predeterminada"})]},w.id))}),j.category&&r.jsx("span",{className:"field-error",children:j.category})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:" Informacin Bsica"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"vehicleId",className:"form-label",children:" Cdigo del Vehculo *"}),r.jsx("input",{type:"text",id:"vehicleId",value:x.vehicleId,onChange:w=>O("vehicleId",w.target.value),className:`form-input ${j.vehicleId?"error":""}`,placeholder:"Ej: EXC-001, TR-123",required:!0}),j.vehicleId&&r.jsx("span",{className:"field-error",children:j.vehicleId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",className:"form-label",children:" Nombre del Vehculo *"}),r.jsx("input",{type:"text",id:"name",value:x.name,onChange:w=>O("name",w.target.value),className:`form-input ${j.name?"error":""}`,placeholder:"Ej: Excavadora Principal, Tractor TR1",required:!0}),j.name&&r.jsx("span",{className:"field-error",children:j.name})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"brand",className:"form-label",children:" Marca"}),r.jsx("input",{type:"text",id:"brand",value:x.brand,onChange:w=>O("brand",w.target.value),className:"form-input",placeholder:"Ej: Caterpillar, John Deere"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"model",className:"form-label",children:" Modelo"}),r.jsx("input",{type:"text",id:"model",value:x.model,onChange:w=>O("model",w.target.value),className:"form-input",placeholder:"Ej: 320D, 6120M"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"year",className:"form-label",children:" Ao"}),r.jsx("input",{type:"number",id:"year",value:x.year,onChange:w=>O("year",w.target.value),className:`form-input ${j.year?"error":""}`,min:"1900",max:new Date().getFullYear()+1}),j.year&&r.jsx("span",{className:"field-error",children:j.year})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"fuelType",className:"form-label",children:" Tipo de Combustible *"}),r.jsx("select",{id:"fuelType",value:x.fuelType,onChange:w=>O("fuelType",w.target.value),className:`form-input ${j.fuelType?"error":""}`,required:!0,children:k().map(w=>r.jsx("option",{value:w,children:w},w))}),j.fuelType&&r.jsx("span",{className:"field-error",children:j.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",className:"form-label",children:" Estado"}),r.jsx("select",{id:"status",value:x.status,onChange:w=>O("status",w.target.value),className:"form-input",children:Object.entries(Le).map(([w,C])=>r.jsx("option",{value:C,children:C.charAt(0).toUpperCase()+C.slice(1)},w))})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"currentLocation",className:"form-label",children:" Ubicacin Actual"}),r.jsx("input",{type:"text",id:"currentLocation",value:x.currentLocation,onChange:w=>O("currentLocation",w.target.value),className:"form-input",placeholder:"Ej: Sector Norte, Patio Principal"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",className:"form-label",children:" Descripcin"}),r.jsx("textarea",{id:"description",value:x.description,onChange:w=>O("description",w.target.value),className:"form-input",rows:"3",placeholder:"Descripcin adicional del vehculo, caractersticas especiales, etc."})]})]}),m&&m.fields&&m.fields.length>0&&r.jsxs("div",{className:"form-section",children:[r.jsxs("h3",{children:[" Especificaciones de ",m.name]}),r.jsx("div",{className:"dynamic-fields",children:m.fields.map(w=>D(w))})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:" Fechas Importantes"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"purchaseDate",className:"form-label",children:" Fecha de Compra"}),r.jsx("input",{type:"date",id:"purchaseDate",value:x.purchaseDate,onChange:w=>O("purchaseDate",w.target.value),className:"form-input"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastMaintenanceDate",className:"form-label",children:" ltimo Mantenimiento"}),r.jsx("input",{type:"date",id:"lastMaintenanceDate",value:x.lastMaintenanceDate,onChange:w=>O("lastMaintenanceDate",w.target.value),className:"form-input"})]})]})]}),m&&r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:" Vista Previa"}),r.jsx("div",{className:"vehicle-preview",style:{"--category-color":m.color},children:r.jsxs("div",{className:"preview-header",children:[r.jsx("div",{className:"preview-icon",style:{color:m.color},children:m.icon}),r.jsxs("div",{className:"preview-info",children:[r.jsx("h4",{children:x.name||"Nombre del vehculo"}),r.jsxs("p",{children:[x.vehicleId||"Cdigo del vehculo","  ",m.name]}),r.jsxs("p",{children:[x.brand," ",x.model," ",x.year]})]})]})})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:b,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:b||!m,children:b?"Guardando...":o==="create"?"Crear Vehculo":"Actualizar Vehculo"})]})]})]}),v&&r.jsx(Uj,{onClose:()=>_(!1),onCategoryCreated:w=>{d(C=>[...C,w]),_(!1)}})]}):null},Oo={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},di={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},ko={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},ZL=({isOpen:n,onClose:e,vehicle:t,maintenance:a,onSave:o,mode:c="create",userRole:d})=>{const m=()=>({vehicleId:t?.vehicleId||"",vehicleName:t?.name||"",type:a?.type||Oo.PREVENTIVO,title:a?.title||"",description:a?.description||"",priority:a?.priority||ko.MEDIA,status:a?.status||di.PROGRAMADO,scheduledDate:a?.scheduledDate?new Date(a.scheduledDate).toISOString().split("T")[0]:"",startDate:a?.startDate?new Date(a.startDate).toISOString().split("T")[0]:"",completedDate:a?.completedDate?new Date(a.completedDate).toISOString().split("T")[0]:"",estimatedHours:a?.estimatedHours||0,actualHours:a?.actualHours||0,estimatedCost:a?.estimatedCost||0,actualCost:a?.actualCost||0,technician:a?.technician||"",workshop:a?.workshop||"",parts:a?.parts||[],notes:a?.notes||"",nextMaintenanceKm:a?.nextMaintenanceKm||0,nextMaintenanceHours:a?.nextMaintenanceHours||0,nextMaintenanceDate:a?.nextMaintenanceDate?new Date(a.nextMaintenanceDate).toISOString().split("T")[0]:""}),[p,v]=$.useState(m()),[_,b]=$.useState({}),[A,j]=$.useState(!1),[T,S]=$.useState({name:"",quantity:1,cost:0});$.useEffect(()=>{n&&(v(m()),b({}))},[n,a,t]);const x=R=>{const{name:P,value:Ee,type:ne}=R.target,z=ne==="number"?parseFloat(Ee)||0:Ee;v(se=>({...se,[P]:z})),_[P]&&b(se=>({...se,[P]:null}))},F=R=>{const{name:P,value:Ee,type:ne}=R.target,z=ne==="number"?parseFloat(Ee)||0:Ee;S(se=>({...se,[P]:z}))},Y=()=>{if(!T.name.trim())return;const R={id:Date.now().toString(),name:T.name.trim(),quantity:T.quantity,cost:T.cost,total:T.quantity*T.cost};v(P=>({...P,parts:[...P.parts,R]})),S({name:"",quantity:1,cost:0})},V=R=>{v(P=>({...P,parts:P.parts.filter(Ee=>Ee.id!==R)}))},O=()=>{const R={};if(p.title.trim()||(R.title="El ttulo del mantenimiento es obligatorio"),p.description.trim()||(R.description="La descripcin es obligatoria"),p.scheduledDate||(R.scheduledDate="La fecha programada es obligatoria"),p.startDate&&p.completedDate){const P=new Date(p.startDate);new Date(p.completedDate)<P&&(R.completedDate="La fecha de finalizacin debe ser posterior al inicio")}return p.scheduledDate&&p.startDate&&(new Date(p.scheduledDate),new Date(p.startDate)),p.estimatedHours<0&&(R.estimatedHours="Las horas estimadas no pueden ser negativas"),p.actualHours<0&&(R.actualHours="Las horas reales no pueden ser negativas"),p.estimatedCost<0&&(R.estimatedCost="El costo estimado no puede ser negativo"),p.actualCost<0&&(R.actualCost="El costo real no puede ser negativo"),p.status===di.COMPLETADO&&!p.completedDate&&(R.completedDate="La fecha de finalizacin es obligatoria para mantenimientos completados"),p.status===di.EN_PROCESO&&!p.startDate&&(R.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),b(R),Object.keys(R).length===0},U=async R=>{if(R.preventDefault(),!!O()){j(!0);try{const P=p.parts.reduce((se,he)=>se+he.total,0),Ee=p.estimatedCost+P,ne=p.actualCost+P,z={...p,vehicleId:t.id,vehicleName:t.name,totalPartsCost:P,totalEstimatedCost:Ee,totalActualCost:ne,scheduledDate:p.scheduledDate||null,startDate:p.startDate||null,completedDate:p.completedDate||null,nextMaintenanceDate:p.nextMaintenanceDate||null,createdAt:a?.createdAt||new Date,updatedAt:new Date};await o(z),e()}catch(P){console.error("Error guardando mantenimiento:",P),b({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{j(!1)}}},W=R=>{switch(R){case Oo.PREVENTIVO:return"";case Oo.CORRECTIVO:return"";case Oo.PREDICTIVO:return"";case Oo.EMERGENCIA:return"";default:return""}},L=R=>{switch(R){case ko.BAJA:return"priority-low";case ko.MEDIA:return"priority-medium";case ko.ALTA:return"priority-high";case ko.CRITICA:return"priority-critical";default:return"priority-medium"}},D=R=>{switch(R){case di.PROGRAMADO:return"status-scheduled";case di.EN_PROCESO:return"status-in-progress";case di.COMPLETADO:return"status-completed";case di.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},k=()=>p.parts.reduce((R,P)=>R+P.total,0),w=c==="view",C=d==="admin"||d==="supervisor";return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content maintenance-modal",onClick:R=>R.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("div",{className:"modal-title",children:[r.jsx("span",{className:"title-icon",children:c==="create"?"":c==="edit"?"":""}),r.jsxs("div",{className:"title-text",children:[r.jsxs("h3",{children:[c==="create"&&"Registrar Mantenimiento",c==="edit"&&"Editar Mantenimiento",c==="view"&&"Detalles del Mantenimiento"]}),r.jsxs("p",{children:["Vehculo: ",t?.vehicleId," - ",t?.name]})]})]}),r.jsx("button",{className:"btn-close",onClick:e,type:"button",children:""})]}),r.jsxs("form",{onSubmit:U,className:"modal-form",children:[r.jsxs("div",{className:"form-content",children:[_.general&&r.jsxs("div",{className:"error-message general-error",children:[" ",_.general]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:" Informacin del Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),r.jsx("select",{id:"type",name:"type",value:p.type,onChange:x,disabled:w||c==="edit"&&!C,children:Object.values(Oo).map(R=>r.jsxs("option",{value:R,children:[W(R)," ",R.charAt(0).toUpperCase()+R.slice(1)]},R))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"priority",children:"Prioridad"}),r.jsx("select",{id:"priority",name:"priority",value:p.priority,onChange:x,className:L(p.priority),disabled:w||c==="edit"&&!C,children:Object.values(ko).map(R=>r.jsx("option",{value:R,children:R.charAt(0).toUpperCase()+R.slice(1)},R))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsx("select",{id:"status",name:"status",value:p.status,onChange:x,className:D(p.status),disabled:w||c==="edit"&&!C,children:Object.values(di).map(R=>r.jsx("option",{value:R,children:R.charAt(0).toUpperCase()+R.slice(1).replace("_"," ")},R))})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"title",children:"Ttulo del Mantenimiento *"}),r.jsx("input",{type:"text",id:"title",name:"title",value:p.title,onChange:x,placeholder:"Ej: Cambio de aceite y filtros",className:_.title?"error":"",disabled:w||c==="edit"&&!C,maxLength:100}),_.title&&r.jsx("span",{className:"error-text",children:_.title})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:" Programacin"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),r.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:p.scheduledDate,onChange:x,className:_.scheduledDate?"error":"",disabled:w||c==="edit"&&!C}),_.scheduledDate&&r.jsx("span",{className:"error-text",children:_.scheduledDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),r.jsx("input",{type:"date",id:"startDate",name:"startDate",value:p.startDate,onChange:x,className:_.startDate?"error":"",disabled:w||c==="edit"&&!C}),_.startDate&&r.jsx("span",{className:"error-text",children:_.startDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalizacin"}),r.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:p.completedDate,onChange:x,className:_.completedDate?"error":"",disabled:w||c==="edit"&&!C}),_.completedDate&&r.jsx("span",{className:"error-text",children:_.completedDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Prximo Mantenimiento"}),r.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:p.nextMaintenanceDate,onChange:x,disabled:w||c==="edit"&&!C})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:" Recursos y Costos"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"technician",children:"Tcnico Responsable"}),r.jsx("input",{type:"text",id:"technician",name:"technician",value:p.technician,onChange:x,placeholder:"Nombre del tcnico",disabled:w||c==="edit"&&!C,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicacin"}),r.jsx("input",{type:"text",id:"workshop",name:"workshop",value:p.workshop,onChange:x,placeholder:"Taller donde se realiza",disabled:w||c==="edit"&&!C,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),r.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:p.estimatedHours,onChange:x,min:"0",step:"0.5",className:_.estimatedHours?"error":"",disabled:w||c==="edit"&&!C}),_.estimatedHours&&r.jsx("span",{className:"error-text",children:_.estimatedHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),r.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:p.actualHours,onChange:x,min:"0",step:"0.5",className:_.actualHours?"error":"",disabled:w||c==="edit"&&!C}),_.actualHours&&r.jsx("span",{className:"error-text",children:_.actualHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),r.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:p.estimatedCost,onChange:x,min:"0",step:"1000",className:_.estimatedCost?"error":"",disabled:w||c==="edit"&&!C}),_.estimatedCost&&r.jsx("span",{className:"error-text",children:_.estimatedCost})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),r.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:p.actualCost,onChange:x,min:"0",step:"1000",className:_.actualCost?"error":"",disabled:w||c==="edit"&&!C}),_.actualCost&&r.jsx("span",{className:"error-text",children:_.actualCost})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:" Partes y Repuestos"}),!w&&C&&r.jsx("div",{className:"parts-form",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),r.jsx("input",{type:"text",id:"partName",name:"name",value:T.name,onChange:F,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),r.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:T.quantity,onChange:F,min:"1",step:"1"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),r.jsx("input",{type:"number",id:"partCost",name:"cost",value:T.cost,onChange:F,min:"0",step:"1000"})]}),r.jsx("div",{className:"form-group",children:r.jsx("button",{type:"button",className:"btn-add-part",onClick:Y,disabled:!T.name.trim(),children:" Agregar"})})]})}),p.parts.length>0&&r.jsx("div",{className:"parts-list",children:r.jsxs("table",{className:"parts-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Parte"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo Unit."}),r.jsx("th",{children:"Total"}),!w&&C&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:p.parts.map(R=>r.jsxs("tr",{children:[r.jsx("td",{children:R.name}),r.jsx("td",{children:R.quantity}),r.jsxs("td",{children:["$",R.cost.toLocaleString("es-CO")]}),r.jsxs("td",{children:["$",R.total.toLocaleString("es-CO")]}),!w&&C&&r.jsx("td",{children:r.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>V(R.id),title:"Eliminar parte",children:""})})]},R.id))}),r.jsx("tfoot",{children:r.jsxs("tr",{className:"total-row",children:[r.jsx("td",{colSpan:"3",children:r.jsx("strong",{children:"Total Partes:"})}),r.jsx("td",{children:r.jsxs("strong",{children:["$",k().toLocaleString("es-CO")]})}),!w&&C&&r.jsx("td",{})]})})]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:" Prximo Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Prximo Mantenimiento (Km)"}),r.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:p.nextMaintenanceKm,onChange:x,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:w||c==="edit"&&!C})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Prximo Mantenimiento (Horas)"}),r.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:p.nextMaintenanceHours,onChange:x,min:"0",step:"100",placeholder:"0 = No aplica",disabled:w||c==="edit"&&!C})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:" Descripcin y Notas"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Descripcin del Trabajo *"}),r.jsx("textarea",{id:"description",name:"description",value:p.description,onChange:x,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:_.description?"error":"",disabled:w||c==="edit"&&!C}),_.description&&r.jsx("span",{className:"error-text",children:_.description})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),r.jsx("textarea",{id:"notes",name:"notes",value:p.notes,onChange:x,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:w||c==="edit"&&!C}),r.jsxs("span",{className:"char-count",children:[p.notes.length,"/500 caracteres"]})]})]}),r.jsxs("div",{className:"cost-summary",children:[r.jsx("h4",{children:" Resumen de Costos"}),r.jsxs("div",{className:"cost-grid",children:[r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),r.jsxs("span",{className:"cost-value",children:["$",p.actualCost.toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Partes:"}),r.jsxs("span",{className:"cost-value",children:["$",k().toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item total-cost",children:[r.jsx("span",{className:"cost-label",children:"Total:"}),r.jsxs("span",{className:"cost-value",children:["$",(p.actualCost+k()).toLocaleString("es-CO")]})]})]})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:A,children:c==="view"?"Cerrar":"Cancelar"}),!w&&C&&r.jsx("button",{type:"submit",className:"btn-primary",disabled:A,children:A?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):r.jsx(r.Fragment,{children:c==="create"?" Registrar Mantenimiento":" Guardar Cambios"})})]})]})]})}):null},JL=()=>{const{user:n,userProfile:e}=Ts(),[t,a]=$.useState([]),[o,c]=$.useState(null),[d,m]=$.useState(!0),[p,v]=$.useState(null),[_,b]=$.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[A,j]=$.useState("cards"),[T,S]=$.useState(""),[x,F]=$.useState(!1),[Y,V]=$.useState(!1),[O,U]=$.useState(!1),[W,L]=$.useState(null),[D,k]=$.useState("create");$.useEffect(()=>{if(!n)return;m(!0);const ee=Jv((ce,ue)=>{if(ue){console.error("Error en suscripcin de vehculos:",ue),v("Error al cargar vehculos"),m(!1);return}a(ce),v(null),m(!1)},_);return()=>ee()},[n,_]),$.useEffect(()=>{n&&(async()=>{try{const ce=await Rj(_);c(ce)}catch(ce){console.error("Error al cargar estadsticas:",ce)}})()},[n,t,_]);const w=t.filter(ee=>{if(!T)return!0;const ce=T.toLowerCase();return ee.vehicleId?.toLowerCase().includes(ce)||ee.name?.toLowerCase().includes(ce)||ee.type?.toLowerCase().includes(ce)||ee.brand?.toLowerCase().includes(ce)||ee.model?.toLowerCase().includes(ce)||ee.currentLocation?.toLowerCase().includes(ce)||ee.description?.toLowerCase().includes(ce)}),C=()=>{L(null),k("create"),F(!0)},R=ee=>{L(ee),k("edit"),F(!0)},P=ee=>{L(ee),k("view"),F(!0)},Ee=ee=>{L(ee),V(!0)},ne=()=>{F(!1),V(!1),L(null)},z=ee=>{b(ce=>({...ce,...ee}))},se=()=>{b({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),S("")},he=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",ye=e?.role==="admin",q=e?.role==="admin"||e?.role==="contador";return d?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando vehculos..."})]})}):p?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:""}),r.jsx("h3",{children:"Error al cargar vehculos"}),r.jsx("p",{children:p}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"vehicles-main",children:[r.jsxs("div",{className:"vehicles-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:" Gestin de Vehculos"}),r.jsx("p",{children:"Administra la maquinaria y vehculos forestales"})]}),he&&r.jsx("button",{className:"btn-create-vehicle",onClick:C,children:" Nuevo Vehculo"})]}),o&&r.jsx(FL,{stats:o,filters:_}),r.jsx(qL,{filters:_,onFilterChange:z,onClearFilters:se,searchTerm:T,onSearchChange:S,viewMode:A,onViewModeChange:j,totalResults:w.length}),w.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:""}),r.jsx("h3",{children:t.length===0?"No hay vehculos registrados":"No se encontraron vehculos"}),r.jsx("p",{children:t.length===0?"Comienza registrando tu primer vehculo o maquinaria forestal":"Intenta ajustar los filtros de bsqueda"}),t.length===0&&he&&r.jsx("button",{className:"btn-create-first",onClick:C,children:" Registrar Primer Vehculo"})]}):r.jsx(HL,{vehicles:w,viewMode:A,onEdit:ye?R:null,onView:P,onMaintenance:q?Ee:null,userRole:n?.role}),x&&r.jsx(WL,{isOpen:x,onClose:ne,vehicle:W,mode:D,onSave:async ee=>{D==="create"?await Sj(ee):await Ij(W.id,ee),ne()},userRole:e?.role}),O&&r.jsx(Uj,{onClose:()=>U(!1),onCategoryCreated:()=>{}}),Y&&r.jsx(ZL,{isOpen:Y,onClose:ne,vehicle:W,onSuccess:()=>{ne()}})]})},bu="combustibles_maintenance",Fj="combustibles_vehicles",fe={OIL_CHANGE:"oil_change",BATTERY_CHANGE:"battery_change",FILTER_CHANGE:"filter_change",GENERAL_MAINTENANCE:"general_maintenance"},Oe={COMPLETED:"completado",PENDING:"pendiente",CANCELLED:"cancelado"},zo={NEW:"nueva",USED:"usada",REPAIRED:"reparada"},ny={OIL_CHANGE_HOURS:250,BATTERY_LIFETIME_MONTHS:24},qj=async n=>{try{tV(n);const e={...n,createdAt:nt(),updatedAt:nt(),status:n.status||Oe.COMPLETED,createdBy:n.createdBy||"system"};n.type===fe.OIL_CHANGE&&(e.nextChangeHours=_f(n.currentHours)),n.type===fe.BATTERY_CHANGE&&(e.nextBatteryChange=Yj(n.date));const t=await hl(Ve(ve,bu),e);return n.vehicleId&&n.currentHours&&await Kj(n.vehicleId,n.currentHours),console.log(" Mantenimiento creado exitosamente:",t.id),t.id}catch(e){throw console.error(" Error al crear mantenimiento:",e),new Error(`Error al crear mantenimiento: ${e.message}`)}},Bj=async(n={})=>{try{let e=Ve(ve,bu);n.type&&(e=we(e,ke("type","==",n.type))),n.vehicleId&&(e=we(e,ke("vehicleId","==",n.vehicleId))),n.status&&(e=we(e,ke("status","==",n.status))),n.dateFrom&&(e=we(e,ke("date",">=",new Date(n.dateFrom)))),n.dateTo&&(e=we(e,ke("date","<=",new Date(n.dateTo)))),e=we(e,jn("date","desc"));const t=await bt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data()})}),a}catch(e){throw console.error(" Error al obtener mantenimientos:",e),new Error(`Error al obtener mantenimientos: ${e.message}`)}},zj=async(n,e)=>{try{nV(e);const t=rt(ve,bu,n),a={...e,updatedAt:nt()};e.currentHours&&e.type===fe.OIL_CHANGE&&(a.nextChangeHours=_f(e.currentHours)),await xs(t,a),e.vehicleId&&e.currentHours&&await Kj(e.vehicleId,e.currentHours),console.log(" Mantenimiento actualizado exitosamente:",n)}catch(t){throw console.error(" Error al actualizar mantenimiento:",t),new Error(`Error al actualizar mantenimiento: ${t.message}`)}},eV=async n=>{try{const e=rt(ve,bu,n);await hf(e),console.log(" Mantenimiento eliminado exitosamente:",n)}catch(e){throw console.error(" Error al eliminar mantenimiento:",e),new Error(`Error al eliminar mantenimiento: ${e.message}`)}},Hj=async(n={})=>{try{const e=await Bj(n),t={total:e.length,byType:{},byStatus:{},byVehicle:{},totalCost:0,averageCost:0,upcomingCount:0,overdueCount:0};let a=0;return e.forEach(o=>{t.byType[o.type]=(t.byType[o.type]||0)+1,t.byStatus[o.status]=(t.byStatus[o.status]||0)+1,t.byVehicle[o.vehicleId]=(t.byVehicle[o.vehicleId]||0)+1,o.cost&&(a+=parseFloat(o.cost)),o.nextChangeDate&&(new Date(o.nextChangeDate)>new Date?t.upcomingCount++:t.overdueCount++)}),t.totalCost=a,t.averageCost=t.total>0?a/t.total:0,t}catch(e){throw console.error(" Error al obtener estadsticas de mantenimiento:",e),new Error(`Error al obtener estadsticas de mantenimiento: ${e.message}`)}},Gj=(n,e={})=>{try{let t=Ve(ve,bu);return e.type&&(t=we(t,ke("type","==",e.type))),e.vehicleId&&(t=we(t,ke("vehicleId","==",e.vehicleId))),e.status&&(t=we(t,ke("status","==",e.status))),t=we(t,jn("date","desc")),Ur(t,o=>{const c=[];o.forEach(d=>{c.push({id:d.id,...d.data()})}),n(c,null)},o=>{console.error(" Error en suscripcin de mantenimientos:",o),n([],o)})}catch(t){return console.error(" Error al suscribirse a mantenimientos:",t),n([],t),()=>{}}},$j=async()=>{try{const n=we(Ve(ve,Fj),ke("status","in",["activo","mantenimiento"]),jn("name","asc")),e=await bt(n),t=[];return e.forEach(a=>{t.push({id:a.id,...a.data()})}),t}catch(n){throw console.error(" Error al obtener vehculos para mantenimiento:",n),new Error(`Error al obtener vehculos para mantenimiento: ${n.message}`)}},_f=n=>parseInt(n)+ny.OIL_CHANGE_HOURS,Yj=n=>{const e=new Date(n);return e.setMonth(e.getMonth()+ny.BATTERY_LIFETIME_MONTHS),e},Kj=async(n,e)=>{try{const t=we(Ve(ve,Fj),ke("vehicleId","==",n)),a=await bt(t);if(!a.empty){const o=a.docs[0],c=o.data();if(c.hasHourMeter&&c.type==="tractor"){const d=parseInt(c.currentHours)||0,m=parseInt(e)||0;m>d&&(await xs(o.ref,{currentHours:m,lastHourMeterDate:nt(),updatedAt:nt()}),console.log(` Hormetro actualizado para ${n}: ${d}  ${m}`))}}}catch(t){console.error(" Error al actualizar hormetro del vehculo:",t)}},tV=n=>{const e=[];if(n.type||e.push("El tipo de mantenimiento es obligatorio"),n.vehicleId||e.push("El vehculo es obligatorio"),n.date||e.push("La fecha es obligatoria"),n.type===fe.OIL_CHANGE&&((!n.quantity||n.quantity<=0)&&e.push("La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!n.currentHours||n.currentHours<0)&&e.push("La lectura del hormetro es obligatoria")),n.type===fe.BATTERY_CHANGE&&(n.batteryType||e.push("El tipo de batera es obligatorio"),(!n.cost||n.cost<=0)&&e.push("El costo de la batera es obligatorio")),e.length>0)throw new Error(e.join(", "))},nV=n=>{const e=[];if(n.type&&!Object.values(fe).includes(n.type)&&e.push("Tipo de mantenimiento invlido"),n.status&&!Object.values(Oe).includes(n.status)&&e.push("Estado de mantenimiento invlido"),n.batteryStatus&&!Object.values(zo).includes(n.batteryStatus)&&e.push("Estado de batera invlido"),e.length>0)throw new Error(e.join(", "))},sV=Object.freeze(Object.defineProperty({__proto__:null,BATTERY_STATUS:zo,MAINTENANCE_CONSTANTS:ny,MAINTENANCE_STATUS:Oe,MAINTENANCE_TYPES:fe,calculateNextBatteryChange:Yj,calculateNextOilChange:_f,createMaintenanceRecord:qj,deleteMaintenanceRecord:eV,getAllMaintenanceRecords:Bj,getMaintenanceStats:Hj,getVehiclesForMaintenance:$j,subscribeToMaintenance:Gj,updateMaintenanceRecord:zj},Symbol.toStringTag,{value:"Module"})),aV=({stats:n})=>{if(!n)return null;const e=c=>{switch(c){case fe.OIL_CHANGE:return"";case fe.BATTERY_CHANGE:return"";case fe.FILTER_CHANGE:return"";case fe.GENERAL_MAINTENANCE:return"";default:return""}},t=c=>{switch(c){case fe.OIL_CHANGE:return"Cambios de Aceite";case fe.BATTERY_CHANGE:return"Cambios de Batera";case fe.FILTER_CHANGE:return"Cambios de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimientos Generales";default:return c}},a=c=>{switch(c){case Oe.COMPLETED:return"#10b981";case Oe.PENDING:return"#f59e0b";case Oe.CANCELLED:return"#ef4444";default:return"#6b7280"}},o=c=>{switch(c){case Oe.COMPLETED:return"Completados";case Oe.PENDING:return"Pendientes";case Oe.CANCELLED:return"Cancelados";default:return c}};return r.jsxs("div",{className:"maintenance-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:Me(n.total)}),r.jsx("p",{children:"Total Mantenimientos"})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:An(n.totalCost)}),r.jsx("p",{children:"Costo Total"})]})]}),r.jsxs("div",{className:"stat-card warning",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:Me(n.upcomingCount)}),r.jsx("p",{children:"Prximos"})]})]}),r.jsxs("div",{className:"stat-card danger",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:Me(n.overdueCount)}),r.jsx("p",{children:"Vencidos"})]})]})]}),Object.keys(n.byType).length>0&&r.jsxs("div",{className:"stats-breakdown",children:[r.jsx("h3",{children:" Desglose por Tipo"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([c,d])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:e(c)}),r.jsx("span",{className:"breakdown-label",children:t(c)})]}),r.jsx("div",{className:"breakdown-value",children:Me(d)}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:"#3b82f6"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),Object.keys(n.byStatus).length>0&&r.jsxs("div",{className:"stats-breakdown",children:[r.jsx("h3",{children:" Desglose por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([c,d])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a(c)}}),r.jsx("span",{className:"breakdown-label",children:o(c)})]}),r.jsx("div",{className:"breakdown-value",children:Me(d)}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:a(c)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),r.jsxs("div",{className:"stats-insights",children:[r.jsx("h3",{children:" Insights"}),r.jsxs("div",{className:"insights-grid",children:[r.jsxs("div",{className:"insight-item",children:[r.jsx("span",{className:"insight-label",children:"Costo Promedio:"}),r.jsx("span",{className:"insight-value",children:An(n.averageCost)})]}),n.overdueCount>0&&r.jsxs("div",{className:"insight-item alert",children:[r.jsx("span",{className:"insight-label",children:" Mantenimientos Vencidos:"}),r.jsxs("span",{className:"insight-value",children:[Me(n.overdueCount)," requieren atencin"]})]}),n.upcomingCount>0&&r.jsxs("div",{className:"insight-item info",children:[r.jsx("span",{className:"insight-label",children:" Prximos Mantenimientos:"}),r.jsxs("span",{className:"insight-value",children:[Me(n.upcomingCount)," programados"]})]})]})]})]})},iV=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:m})=>{const p=j=>{switch(j){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batera";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return j}},v=j=>{switch(j){case Oe.COMPLETED:return"Completado";case Oe.PENDING:return"Pendiente";case Oe.CANCELLED:return"Cancelado";default:return j}},_=(j,T)=>{e({[j]:T})},b=j=>{e(j)},A=()=>Object.values(n).some(j=>j!=="")||a;return r.jsx("div",{className:"maintenance-filters",children:r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:""}),r.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar mantenimientos...",value:a,onChange:j=>o(j.target.value)}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),children:""})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${A()?"":"active"}`,onClick:()=>t(),children:"Todos"}),r.jsx("button",{className:`quick-filter ${n.type===fe.OIL_CHANGE?"active":""}`,onClick:()=>b({type:fe.OIL_CHANGE}),children:" Aceite"}),r.jsx("button",{className:`quick-filter ${n.type===fe.BATTERY_CHANGE?"active":""}`,onClick:()=>b({type:fe.BATTERY_CHANGE}),children:" Bateras"}),r.jsx("button",{className:`quick-filter ${n.status===Oe.PENDING?"active":""}`,onClick:()=>b({status:Oe.PENDING}),children:" Pendientes"})]}),r.jsxs("button",{className:`btn-advanced-filters ${A()?"active":""}`,onClick:()=>document.querySelector(".filters-advanced").classList.toggle("show"),children:[" Filtros Avanzados",A()&&r.jsx("span",{className:"filters-count",children:Object.values(n).filter(j=>j!=="").length})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),children:" Cards"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),children:" Tabla"})]})]}),r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Mantenimiento"}),r.jsxs("select",{value:n.type,onChange:j=>_("type",j.target.value),children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:fe.OIL_CHANGE,children:p(fe.OIL_CHANGE)}),r.jsx("option",{value:fe.BATTERY_CHANGE,children:p(fe.BATTERY_CHANGE)}),r.jsx("option",{value:fe.FILTER_CHANGE,children:p(fe.FILTER_CHANGE)}),r.jsx("option",{value:fe.GENERAL_MAINTENANCE,children:p(fe.GENERAL_MAINTENANCE)})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:j=>_("status",j.target.value),children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:Oe.COMPLETED,children:v(Oe.COMPLETED)}),r.jsx("option",{value:Oe.PENDING,children:v(Oe.PENDING)}),r.jsx("option",{value:Oe.CANCELLED,children:v(Oe.CANCELLED)})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Fecha Desde"}),r.jsx("input",{type:"date",value:n.dateFrom,onChange:j=>_("dateFrom",j.target.value)})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Fecha Hasta"}),r.jsx("input",{type:"date",value:n.dateTo,onChange:j=>_("dateTo",j.target.value)})]})]}),r.jsx("div",{className:"filters-actions",children:r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:!A(),children:" Limpiar Filtros"})})]}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("div",{className:"results-count",children:[m," mantenimiento",m!==1?"s":""," encontrado",m!==1?"s":""]}),A()&&r.jsxs("div",{className:"active-filters",children:[r.jsx("span",{className:"filters-label",children:"Filtros activos:"}),r.jsxs("div",{className:"filter-tags",children:[n.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",p(n.type),r.jsx("button",{onClick:()=>_("type",""),children:""})]}),n.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",v(n.status),r.jsx("button",{onClick:()=>_("status",""),children:""})]}),n.dateFrom&&r.jsxs("span",{className:"filter-tag",children:["Desde: ",n.dateFrom,r.jsx("button",{onClick:()=>_("dateFrom",""),children:""})]}),n.dateTo&&r.jsxs("span",{className:"filter-tag",children:["Hasta: ",n.dateTo,r.jsx("button",{onClick:()=>_("dateTo",""),children:""})]}),a&&r.jsxs("span",{className:"filter-tag",children:['Bsqueda: "',a,'"',r.jsx("button",{onClick:()=>o(""),children:""})]})]})]})]})]})})},rV=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const c=T=>T?new Date(T).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"N/A",d=T=>{if(!T)return"";const S=new Date,x=new Date(T),F=Math.abs(S-x),Y=Math.ceil(F/(1e3*60*60*24));return Y===0?"Hoy":Y===1?"Ayer":Y<7?`Hace ${Y} das`:Y<30?`Hace ${Math.floor(Y/7)} semanas`:`Hace ${Math.floor(Y/30)} meses`},m=T=>{switch(T){case fe.OIL_CHANGE:return"maintenance-oil-change";case fe.BATTERY_CHANGE:return"maintenance-battery-change";case fe.FILTER_CHANGE:return"maintenance-filter-change";case fe.GENERAL_MAINTENANCE:return"maintenance-general";default:return"maintenance-general"}},p=T=>{switch(T){case Oe.COMPLETED:return"status-completado";case Oe.PENDING:return"status-pendiente";case Oe.CANCELLED:return"status-cancelado";default:return"status-unknown"}},v=T=>{switch(T){case fe.OIL_CHANGE:return"";case fe.BATTERY_CHANGE:return"";case fe.FILTER_CHANGE:return"";case fe.GENERAL_MAINTENANCE:return"";default:return""}},_=T=>{switch(T){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batera";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return T}},b=T=>{switch(T){case Oe.COMPLETED:return"";case Oe.PENDING:return"";case Oe.CANCELLED:return"";default:return""}},A=T=>{switch(T){case Oe.COMPLETED:return"Completado";case Oe.PENDING:return"Pendiente";case Oe.CANCELLED:return"Cancelado";default:return T}},j=o==="admin"||o==="supervisor";return r.jsx("div",{className:"maintenance-cards",children:n.map(T=>r.jsxs("div",{className:`maintenance-card ${m(T.type)}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"maintenance-type",children:[r.jsx("span",{className:"type-icon",children:v(T.type)}),r.jsx("span",{className:"type-label",children:_(T.type)})]}),r.jsxs("div",{className:`status-badge ${p(T.status)}`,children:[b(T.status)," ",A(T.status)]})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"vehicle-info",children:[r.jsx("span",{className:"vehicle-icon",children:""}),r.jsxs("div",{className:"vehicle-details",children:[r.jsx("div",{className:"vehicle-name",children:T.vehicleName}),r.jsx("div",{className:"vehicle-id",children:T.vehicleId})]})]}),r.jsxs("div",{className:"date-info",children:[r.jsx("div",{className:"created-date",children:c(T.date)}),r.jsx("div",{className:"relative-time",children:d(T.date)})]}),T.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"oil-change-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Cantidad:"}),r.jsxs("span",{className:"info-value",children:[Me(T.quantity)," galones"]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Hormetro:"}),r.jsxs("span",{className:"info-value",children:[Me(T.currentHours)," horas"]})]}),T.nextChangeHours&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Prximo cambio:"}),r.jsxs("span",{className:"info-value",children:[Me(T.nextChangeHours)," horas"]})]}),T.filters&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Filtros:"}),r.jsx("span",{className:"info-value",children:T.filters})]})]}),T.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"battery-change-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Tipo:"}),r.jsx("span",{className:"info-value",children:T.batteryType})]}),T.brand&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Marca:"}),r.jsx("span",{className:"info-value",children:T.brand})]}),T.model&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Modelo:"}),r.jsx("span",{className:"info-value",children:T.model})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Estado:"}),r.jsx("span",{className:"info-value",children:T.batteryStatus})]}),T.cost&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Costo:"}),r.jsx("span",{className:"info-value",children:An(T.cost)})]})]}),T.notes&&r.jsxs("div",{className:"notes-section",children:[r.jsx("span",{className:"notes-label",children:"Notas:"}),r.jsx("p",{className:"notes-text",children:T.notes})]})]}),r.jsx("div",{className:"card-footer",children:r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(T),title:"Ver detalles",children:" Ver"}),j&&e&&r.jsx("button",{className:"btn-edit",onClick:()=>e(T),title:"Editar",children:" Editar"}),j&&a&&r.jsx("button",{className:"btn-delete",onClick:()=>a(T.id),title:"Eliminar",children:" Eliminar"})]})})]},T.id))})},oV=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const[c,d]=$.useState("date"),[m,p]=$.useState("desc"),v=V=>V?new Date(V).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",_=V=>{switch(V){case fe.OIL_CHANGE:return"";case fe.BATTERY_CHANGE:return"";case fe.FILTER_CHANGE:return"";case fe.GENERAL_MAINTENANCE:return"";default:return""}},b=V=>{switch(V){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batera";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return V}},A=V=>{switch(V){case Oe.COMPLETED:return"";case Oe.PENDING:return"";case Oe.CANCELLED:return"";default:return""}},j=V=>{switch(V){case Oe.COMPLETED:return"Completado";case Oe.PENDING:return"Pendiente";case Oe.CANCELLED:return"Cancelado";default:return V}},T=V=>{switch(V){case Oe.COMPLETED:return"status-completado";case Oe.PENDING:return"status-pendiente";case Oe.CANCELLED:return"status-cancelado";default:return"status-unknown"}},S=V=>{c===V?p(m==="asc"?"desc":"asc"):(d(V),p("asc"))},x=V=>c!==V?"":m==="asc"?"":"",F=[...n].sort((V,O)=>{let U=V[c],W=O[c];return c==="date"&&(U=new Date(U),W=new Date(W)),["quantity","currentHours","nextChangeHours","cost"].includes(c)&&(U=parseFloat(U)||0,W=parseFloat(W)||0),typeof U=="string"&&(U=U.toLowerCase(),W=W.toLowerCase()),m==="asc"?U>W?1:-1:U<W?1:-1}),Y=o==="admin"||o==="supervisor";return r.jsxs("div",{className:"maintenance-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"maintenance-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>S("type"),children:["Tipo ",x("type")]}),r.jsxs("th",{className:"sortable",onClick:()=>S("vehicleName"),children:["Vehculo ",x("vehicleName")]}),r.jsxs("th",{className:"sortable",onClick:()=>S("date"),children:["Fecha ",x("date")]}),r.jsx("th",{children:"Detalles"}),r.jsxs("th",{className:"sortable",onClick:()=>S("status"),children:["Estado ",x("status")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>S("cost"),children:["Costo ",x("cost")]}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:F.map(V=>r.jsxs("tr",{className:"maintenance-row",children:[r.jsx("td",{className:"type-cell",children:r.jsxs("div",{className:"type-content",children:[r.jsx("span",{className:"type-icon",children:_(V.type)}),r.jsx("span",{className:"type-name",children:b(V.type)})]})}),r.jsx("td",{className:"vehicle-cell",children:r.jsxs("div",{className:"vehicle-info",children:[r.jsx("div",{className:"vehicle-name",children:V.vehicleName}),r.jsx("div",{className:"vehicle-id",children:V.vehicleId})]})}),r.jsx("td",{className:"date-cell",children:r.jsx("div",{className:"date-content",children:r.jsx("div",{className:"date-value",children:v(V.date)})})}),r.jsxs("td",{className:"details-cell",children:[V.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"oil-details",children:[r.jsxs("div",{children:["Qty: ",Me(V.quantity)," gal"]}),r.jsxs("div",{children:["Hrs: ",Me(V.currentHours)]}),V.filters&&r.jsxs("div",{children:["Filtros: ",V.filters]})]}),V.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"battery-details",children:[r.jsx("div",{children:V.batteryType}),V.brand&&r.jsx("div",{children:V.brand}),r.jsxs("div",{children:["Estado: ",V.batteryStatus]})]}),V.notes&&r.jsx("div",{className:"notes-small",children:V.notes})]}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${T(V.status)}`,children:[A(V.status)," ",j(V.status)]})}),r.jsx("td",{className:"cost-cell text-right",children:V.cost?An(V.cost):"N/A"}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(V),title:"Ver detalles",children:""}),Y&&e&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(V),title:"Editar",children:""}),Y&&a&&r.jsx("button",{className:"btn-action btn-delete",onClick:()=>a(V.id),title:"Eliminar",children:""})]})})]},V.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsx("div",{className:"table-summary",children:r.jsxs("span",{className:"total-rows",children:[n.length," mantenimiento",n.length!==1?"s":""," en total"]})}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot oil-change"}),r.jsx("span",{children:"Cambio de Aceite"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot battery-change"}),r.jsx("span",{children:"Cambio de Batera"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot filter-change"}),r.jsx("span",{children:"Cambio de Filtros"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot general"}),r.jsx("span",{children:"Mantenimiento General"})]})]})]})]})},lV=({maintenanceRecords:n,viewMode:e,onEdit:t,onView:a,onDelete:o,userRole:c})=>!n||n.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:""}),r.jsx("h3",{children:"No hay mantenimientos registrados"}),r.jsx("p",{children:"Comienza creando el primer mantenimiento para tu flota de vehculos."})]}):r.jsx("div",{className:"maintenance-list",children:e==="cards"?r.jsx(rV,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c}):r.jsx(oV,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c})}),cV=({isOpen:n,onClose:e,onSuccess:t,maintenance:a,mode:o="create",userRole:c})=>{const d=()=>({type:a?.type||fe.OIL_CHANGE,vehicleId:a?.vehicleId||"",vehicleName:a?.vehicleName||"",date:a?.date?new Date(a.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:a?.status||Oe.COMPLETED,quantity:a?.quantity||0,currentHours:a?.currentHours||0,nextChangeHours:a?.nextChangeHours||0,filters:a?.filters||"",batteryType:a?.batteryType||"",brand:a?.brand||"",model:a?.model||"",batteryStatus:a?.batteryStatus||zo.NEW,notes:a?.notes||"",cost:a?.cost||0}),[m,p]=$.useState(d()),[v,_]=$.useState({}),[b,A]=$.useState(!1),[j,T]=$.useState([]);$.useEffect(()=>{n&&(async()=>{try{const W=await $j();T(W)}catch(W){console.error("Error al cargar vehculos:",W)}})()},[n]),$.useEffect(()=>{n&&(p(d()),_({}))},[n,a,j]),$.useEffect(()=>{if(m.type===fe.OIL_CHANGE&&m.currentHours>0){const U=_f(m.currentHours);p(W=>({...W,nextChangeHours:U}))}},[m.currentHours,m.type]);const S=(U,W)=>{const L=typeof W=="number"?parseFloat(W)||0:W;p(D=>({...D,[U]:L})),v[U]&&_(D=>({...D,[U]:null}))},x=U=>{const W=j.find(L=>L.vehicleId===U);p(L=>({...L,vehicleId:U,vehicleName:W?W.name:""})),W&&W.hasHourMeter&&W.currentHours&&p(L=>({...L,currentHours:W.currentHours}))},F=()=>{const U={};return m.type||(U.type="El tipo de mantenimiento es obligatorio"),m.vehicleId||(U.vehicleId="El vehculo es obligatorio"),m.date||(U.date="La fecha es obligatoria"),m.type===fe.OIL_CHANGE&&((!m.quantity||m.quantity<=0)&&(U.quantity="La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!m.currentHours||m.currentHours<0)&&(U.currentHours="La lectura del hormetro es obligatoria")),m.type===fe.BATTERY_CHANGE&&(m.batteryType||(U.batteryType="El tipo de batera es obligatorio"),(!m.cost||m.cost<=0)&&(U.cost="El costo de la batera es obligatorio")),_(U),Object.keys(U).length===0},Y=async U=>{if(U.preventDefault(),!!F()){A(!0);try{const W={...m,date:new Date(m.date),createdBy:c||"user"};o==="create"?(await qj(W),console.log(" Mantenimiento creado exitosamente")):o==="edit"&&(await zj(a.id,W),console.log(" Mantenimiento actualizado exitosamente")),t()}catch(W){console.error(" Error al guardar mantenimiento:",W),alert("Error al guardar mantenimiento: "+W.message)}finally{A(!1)}}},V=()=>{switch(o){case"create":return"Crear Mantenimiento";case"edit":return"Editar Mantenimiento";case"view":return"Ver Mantenimiento";default:return"Mantenimiento"}},O=U=>{switch(U){case fe.OIL_CHANGE:return"";case fe.BATTERY_CHANGE:return"";case fe.FILTER_CHANGE:return"";case fe.GENERAL_MAINTENANCE:return"";default:return""}};return n?r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content maintenance-modal",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:V()}),r.jsx("button",{className:"modal-close",onClick:e,children:""})]}),r.jsx("div",{className:"modal-body",children:r.jsxs("form",{onSubmit:Y,className:"maintenance-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Mantenimiento *"}),r.jsxs("select",{value:m.type,onChange:U=>S("type",U.target.value),disabled:o==="view",children:[r.jsxs("option",{value:fe.OIL_CHANGE,children:[O(fe.OIL_CHANGE)," Cambio de Aceite"]}),r.jsxs("option",{value:fe.BATTERY_CHANGE,children:[O(fe.BATTERY_CHANGE)," Cambio de Batera"]}),r.jsxs("option",{value:fe.FILTER_CHANGE,children:[O(fe.FILTER_CHANGE)," Cambio de Filtros"]}),r.jsxs("option",{value:fe.GENERAL_MAINTENANCE,children:[O(fe.GENERAL_MAINTENANCE)," Mantenimiento General"]})]}),v.type&&r.jsx("span",{className:"error-text",children:v.type})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Vehculo *"}),r.jsxs("select",{value:m.vehicleId,onChange:U=>x(U.target.value),disabled:o==="view",children:[r.jsx("option",{value:"",children:"Seleccionar vehculo"}),j.map(U=>r.jsxs("option",{value:U.vehicleId,children:[U.vehicleId," - ",U.name," (",U.type,")"]},U.vehicleId))]}),v.vehicleId&&r.jsx("span",{className:"error-text",children:v.vehicleId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Fecha *"}),r.jsx("input",{type:"date",value:m.date,onChange:U=>S("date",U.target.value),disabled:o==="view"}),v.date&&r.jsx("span",{className:"error-text",children:v.date})]}),m.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"maintenance-section",children:[r.jsx("h3",{children:" Informacin del Cambio de Aceite"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cantidad (galones) *"}),r.jsx("input",{type:"number",step:"0.1",value:m.quantity,onChange:U=>S("quantity",U.target.value),disabled:o==="view"}),v.quantity&&r.jsx("span",{className:"error-text",children:v.quantity})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Hormetro Actual *"}),r.jsx("input",{type:"number",value:m.currentHours,onChange:U=>S("currentHours",U.target.value),disabled:o==="view"}),v.currentHours&&r.jsx("span",{className:"error-text",children:v.currentHours})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Prximo Cambio (horas)"}),r.jsx("input",{type:"number",value:m.nextChangeHours,disabled:!0,className:"readonly-input"}),r.jsx("small",{children:"Calculado automticamente: actual + 250 horas"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Filtros o Extras"}),r.jsx("textarea",{value:m.filters,onChange:U=>S("filters",U.target.value),disabled:o==="view",placeholder:"Especificar filtros cambiados o extras..."})]})]}),m.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"maintenance-section",children:[r.jsx("h3",{children:" Informacin del Cambio de Batera"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Batera *"}),r.jsx("input",{type:"text",value:m.batteryType,onChange:U=>S("batteryType",U.target.value),disabled:o==="view",placeholder:"Ej: 12V 60Ah"}),v.batteryType&&r.jsx("span",{className:"error-text",children:v.batteryType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado *"}),r.jsxs("select",{value:m.batteryStatus,onChange:U=>S("batteryStatus",U.target.value),disabled:o==="view",children:[r.jsx("option",{value:zo.NEW,children:"Nueva"}),r.jsx("option",{value:zo.USED,children:"Usada"}),r.jsx("option",{value:zo.REPAIRED,children:"Reparada"})]})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Marca"}),r.jsx("input",{type:"text",value:m.brand,onChange:U=>S("brand",U.target.value),disabled:o==="view",placeholder:"Ej: Bosch, Exide"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Modelo"}),r.jsx("input",{type:"text",value:m.model,onChange:U=>S("model",U.target.value),disabled:o==="view",placeholder:"Ej: S4 005"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Costo *"}),r.jsx("input",{type:"number",step:"1000",value:m.cost,onChange:U=>S("cost",U.target.value),disabled:o==="view",placeholder:"0"}),v.cost&&r.jsx("span",{className:"error-text",children:v.cost})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Notas Adicionales"}),r.jsx("textarea",{value:m.notes,onChange:U=>S("notes",U.target.value),disabled:o==="view",placeholder:"Observaciones adicionales...",rows:"3"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:m.status,onChange:U=>S("status",U.target.value),disabled:o==="view",children:[r.jsx("option",{value:Oe.COMPLETED,children:"Completado"}),r.jsx("option",{value:Oe.PENDING,children:"Pendiente"}),r.jsx("option",{value:Oe.CANCELLED,children:"Cancelado"})]})]})]})}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:b,children:"Cancelar"}),o!=="view"&&r.jsx("button",{type:"submit",className:"btn btn-primary",onClick:Y,disabled:b,children:b?"Guardando...":o==="create"?"Crear":"Actualizar"})]})]})}):null},uV=()=>{const{user:n,userProfile:e}=Ts(),[t,a]=$.useState([]),[o,c]=$.useState(null),[d,m]=$.useState(!0),[p,v]=$.useState(null),[_,b]=$.useState({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),[A,j]=$.useState("cards"),[T,S]=$.useState(""),[x,F]=$.useState(!1),[Y,V]=$.useState(null),[O,U]=$.useState("create");$.useEffect(()=>{if(!n)return;m(!0);const z=Gj((se,he)=>{if(he){console.error("Error en suscripcin de mantenimientos:",he),v("Error al cargar mantenimientos"),m(!1);return}a(se),v(null),m(!1)},_);return()=>z()},[n,_]),$.useEffect(()=>{n&&(async()=>{try{const se=await Hj(_);c(se)}catch(se){console.error("Error al cargar estadsticas:",se)}})()},[n,t,_]);const W=t.filter(z=>{if(!T)return!0;const se=T.toLowerCase();return z.vehicleName?.toLowerCase().includes(se)||z.type?.toLowerCase().includes(se)||z.status?.toLowerCase().includes(se)||z.notes?.toLowerCase().includes(se)}),L=e?.combustiblesPermissions?.canManageMaintenance||!1,D=()=>{V(null),U("create"),F(!0)},k=z=>{V(z),U("edit"),F(!0)},w=z=>{V(z),U("view"),F(!0)},C=()=>{F(!1),V(null)},R=()=>{F(!1),V(null)},P=z=>{b(se=>({...se,...z}))},Ee=()=>{b({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),S("")},ne=async z=>{if(!L){alert("No tienes permisos para eliminar mantenimientos");return}if(window.confirm("Ests seguro de que quieres eliminar este mantenimiento?"))try{const{deleteMaintenanceRecord:se}=await ey(async()=>{const{deleteMaintenanceRecord:he}=await Promise.resolve().then(()=>sV);return{deleteMaintenanceRecord:he}},void 0);await se(z),console.log(" Mantenimiento eliminado exitosamente")}catch(se){console.error(" Error al eliminar mantenimiento:",se),alert("Error al eliminar mantenimiento: "+se.message)}};return n?r.jsxs("div",{className:"maintenance-main",children:[r.jsxs("div",{className:"maintenance-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:" Mantenimiento de Vehculos"}),r.jsx("p",{children:"Gestin de cambios de aceite, filtros y bateras"})]}),r.jsx("div",{className:"header-actions",children:L&&r.jsx("button",{className:"btn-create-maintenance",onClick:D,children:" Crear Mantenimiento"})})]}),d&&r.jsxs("div",{className:"maintenance-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando mantenimientos..."})]}),p&&r.jsxs("div",{className:"error-banner",children:[r.jsxs("span",{children:[" ",p]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]}),o&&r.jsx(aV,{stats:o}),r.jsx(iV,{filters:_,onFilterChange:P,onClearFilters:Ee,searchTerm:T,onSearchChange:S,viewMode:A,onViewModeChange:j,totalResults:W.length}),!d&&!p&&r.jsx(lV,{maintenanceRecords:W,viewMode:A,onEdit:L?k:null,onView:w,onDelete:L?ne:null,userRole:e?.role}),x&&r.jsx(cV,{isOpen:x,onClose:C,onSuccess:R,maintenance:Y,mode:O,userRole:e?.role})]}):r.jsx("div",{className:"maintenance-main",children:r.jsxs("div",{className:"auth-required",children:[r.jsx("h2",{children:" Autenticacin Requerida"}),r.jsx("p",{children:"Debes iniciar sesin para acceder al mdulo de mantenimiento."})]})})},dV=({isOpen:n,onClose:e,product:t,mode:a="create",onSave:o,userRole:c})=>{const[d,m]=$.useState({name:"",displayName:"",category:Bs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),[p,v]=$.useState({}),[_,b]=$.useState(!1),A=[{value:"gal",label:"Galones (gal)"},{value:"L",label:"Litros (L)"},{value:"kg",label:"Kilogramos (kg)"},{value:"und",label:"Unidades (und)"}],j={[Bs.COMBUSTIBLE]:["","","","",""],[Bs.ACEITE]:["","","","",""],[Bs.LUBRICANTE]:["","","","",""],[Bs.FLUIDO]:["","","","",""]},T=["#FF6B35","#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#E91E63","#795548","#607D8B","#3F51B5"];$.useEffect(()=>{m(t&&(a==="edit"||a==="view")?{name:t.name||"",displayName:t.displayName||"",category:t.category||Bs.COMBUSTIBLE,unit:t.unit||"gal",defaultPrice:t.defaultPrice||0,color:t.color||"#FF6B35",icon:t.icon||"",description:t.description||"",isActive:t.isActive!==void 0?t.isActive:!0,currentStock:t.currentStock||0,minThreshold:t.minThreshold||10,maxCapacity:t.maxCapacity||1e3}:{name:"",displayName:"",category:Bs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),v({})},[t,a,n]);const S=V=>{const{name:O,value:U,type:W,checked:L}=V.target;m(D=>({...D,[O]:W==="checkbox"?L:U})),p[O]&&v(D=>({...D,[O]:""}))},x=()=>{const V={};return d.name.trim()||(V.name="El nombre es requerido"),d.displayName.trim()||(V.displayName="El nombre de visualizacin es requerido"),d.category||(V.category="La categora es requerida"),d.unit||(V.unit="La unidad es requerida"),d.defaultPrice<0&&(V.defaultPrice="El precio debe ser mayor o igual a 0"),d.currentStock<0&&(V.currentStock="El stock debe ser mayor o igual a 0"),d.minThreshold<0&&(V.minThreshold="El umbral mnimo debe ser mayor o igual a 0"),d.maxCapacity<=0&&(V.maxCapacity="La capacidad mxima debe ser mayor a 0"),d.minThreshold>=d.maxCapacity&&(V.minThreshold="El umbral mnimo debe ser menor que la capacidad mxima"),v(V),Object.keys(V).length===0},F=async V=>{if(V.preventDefault(),!!x()){b(!0);try{await o({...d,defaultPrice:parseFloat(d.defaultPrice),currentStock:parseFloat(d.currentStock),minThreshold:parseFloat(d.minThreshold),maxCapacity:parseFloat(d.maxCapacity)}),e()}catch(O){console.error("Error saving product:",O),v({submit:"Error al guardar el producto"})}finally{b(!1)}}};if(!n)return null;const Y=["admin","supervisor"].includes(c)&&a!=="view";return r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content product-modal",children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[a==="create"&&" Crear Producto",a==="edit"&&" Editar Producto",a==="view"&&" Ver Producto"]}),r.jsx("button",{className:"modal-close",onClick:e,children:""})]}),r.jsxs("form",{onSubmit:F,className:"modal-body",children:[r.jsx("div",{className:"product-preview",children:r.jsxs("div",{className:"preview-card",children:[r.jsx("div",{className:"preview-icon",style:{color:d.color},children:d.icon}),r.jsxs("div",{className:"preview-info",children:[r.jsx("h3",{children:d.displayName||"Nombre del producto"}),r.jsx("p",{className:"preview-category",children:d.category}),r.jsx("p",{className:"preview-description",children:d.description}),r.jsxs("div",{className:"preview-price",children:["$",new Intl.NumberFormat("es-CO").format(d.defaultPrice)," / ",d.unit]})]})]})}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:" Informacin Bsica"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre Interno *"}),r.jsx("input",{type:"text",name:"name",value:d.name,onChange:S,disabled:!Y,placeholder:"Ej: ACPM, GASOLINA"}),p.name&&r.jsx("span",{className:"error",children:p.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre de Visualizacin *"}),r.jsx("input",{type:"text",name:"displayName",value:d.displayName,onChange:S,disabled:!Y,placeholder:"Ej: ACPM , Gasolina "}),p.displayName&&r.jsx("span",{className:"error",children:p.displayName})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Categora *"}),r.jsx("select",{name:"category",value:d.category,onChange:S,disabled:!Y,children:Object.values(Bs).map(V=>r.jsx("option",{value:V,children:V},V))}),p.category&&r.jsx("span",{className:"error",children:p.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Descripcin"}),r.jsx("textarea",{name:"description",value:d.description,onChange:S,disabled:!Y,placeholder:"Descripcin del producto...",rows:"3"})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:" Configuracin"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Unidad de Medida *"}),r.jsx("select",{name:"unit",value:d.unit,onChange:S,disabled:!Y,children:A.map(V=>r.jsx("option",{value:V.value,children:V.label},V.value))}),p.unit&&r.jsx("span",{className:"error",children:p.unit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio por Defecto"}),r.jsx("input",{type:"number",name:"defaultPrice",value:d.defaultPrice,onChange:S,disabled:!Y,min:"0",step:"0.01"}),p.defaultPrice&&r.jsx("span",{className:"error",children:p.defaultPrice})]}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",name:"isActive",checked:d.isActive,onChange:S,disabled:!Y}),"Producto Activo"]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:" Stock y Umbrales"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Stock Actual"}),r.jsx("input",{type:"number",name:"currentStock",value:d.currentStock,onChange:S,disabled:!Y,min:"0",step:"0.01"}),p.currentStock&&r.jsx("span",{className:"error",children:p.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Umbral Mnimo"}),r.jsx("input",{type:"number",name:"minThreshold",value:d.minThreshold,onChange:S,disabled:!Y,min:"0",step:"0.01"}),p.minThreshold&&r.jsx("span",{className:"error",children:p.minThreshold})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Capacidad Mxima"}),r.jsx("input",{type:"number",name:"maxCapacity",value:d.maxCapacity,onChange:S,disabled:!Y,min:"1",step:"0.01"}),p.maxCapacity&&r.jsx("span",{className:"error",children:p.maxCapacity})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:" Apariencia"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Icono"}),r.jsx("div",{className:"icon-selector",children:j[d.category]?.map(V=>r.jsx("button",{type:"button",className:`icon-option ${d.icon===V?"selected":""}`,onClick:()=>m(O=>({...O,icon:V})),disabled:!Y,children:V},V))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Color"}),r.jsx("div",{className:"color-selector",children:T.map(V=>r.jsx("button",{type:"button",className:`color-option ${d.color===V?"selected":""}`,style:{backgroundColor:V},onClick:()=>m(O=>({...O,color:V})),disabled:!Y},V))})]})]})]}),p.submit&&r.jsx("div",{className:"error-message",children:p.submit})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:_,children:a==="view"?"Cerrar":"Cancelar"}),Y&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:F,disabled:_,children:_?"Guardando...":"Guardar"})]})]})})},hV=({products:n})=>{const[e,t]=$.useState([]),[a,o]=$.useState(!0);$.useEffect(()=>{const T=Xv(S=>{t(S),o(!1)},S=>{console.error("Error loading movements for stats:",S),o(!1)});return()=>T()},[]);const c=()=>n.map(S=>{const x=e.filter(W=>W.fuelType===S.name||W.fuelType===S.displayName),F=x.filter(W=>W.type==="entrada"),Y=x.filter(W=>W.type==="salida"),V=F.reduce((W,L)=>W+(L.quantity||0),0),O=Y.reduce((W,L)=>W+(L.quantity||0),0),U=(S.currentStock||0)*(S.defaultPrice||0);return{...S,totalEntries:V,totalExits:O,totalValue:U,entriesCount:F.length,exitsCount:Y.length,stockStatus:d(S)}}),d=T=>{const S=T.currentStock||0,x=T.minThreshold||0,F=T.maxCapacity||1e3;return S===0?"empty":S<=x?"low":S>=F*.9?"high":"normal"},m=T=>{const S={};return Object.values(Bs).forEach(x=>{const F=T.filter(Y=>Y.category===x);S[x]={totalProducts:F.length,totalStock:F.reduce((Y,V)=>Y+(V.currentStock||0),0),totalValue:F.reduce((Y,V)=>Y+V.totalValue,0),totalEntries:F.reduce((Y,V)=>Y+V.totalEntries,0),totalExits:F.reduce((Y,V)=>Y+V.totalExits,0),lowStockCount:F.filter(Y=>Y.stockStatus==="low"||Y.stockStatus==="empty").length}}),S};if(a)return r.jsxs("div",{className:"products-stats loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando estadsticas..."})]});const p=c(),v=m(p),_=n.length,b=n.filter(T=>T.isActive).length,A=p.reduce((T,S)=>T+S.totalValue,0),j=p.filter(T=>T.stockStatus==="low"||T.stockStatus==="empty").length;return r.jsxs("div",{className:"products-stats",children:[r.jsx("h2",{children:" Estadsticas de Productos"}),r.jsxs("div",{className:"stats-general",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Me(_)}),r.jsx("p",{children:"Total Productos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Me(b)}),r.jsx("p",{children:"Productos Activos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:An(A)}),r.jsx("p",{children:"Valor Total Stock"})]})]}),r.jsxs("div",{className:`stat-card ${j>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon",children:""}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Me(j)}),r.jsx("p",{children:"Stock Bajo"})]})]})]}),r.jsxs("div",{className:"stats-categories",children:[r.jsx("h3",{children:" Por Categora"}),r.jsx("div",{className:"categories-grid",children:Object.entries(v).map(([T,S])=>r.jsxs("div",{className:"category-card",children:[r.jsx("h4",{children:T}),r.jsxs("div",{className:"category-stats",children:[r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Productos:"}),r.jsx("span",{children:Me(S.totalProducts)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Stock Total:"}),r.jsxs("span",{children:[Me(S.totalStock)," unidades"]})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Valor:"}),r.jsx("span",{children:An(S.totalValue)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Entradas:"}),r.jsx("span",{className:"positive",children:Me(S.totalEntries)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Salidas:"}),r.jsx("span",{className:"negative",children:Me(S.totalExits)})]}),S.lowStockCount>0&&r.jsxs("div",{className:"stat-row alert",children:[r.jsx("span",{children:"Stock Bajo:"}),r.jsx("span",{children:Me(S.lowStockCount)})]})]})]},T))})]}),r.jsxs("div",{className:"stats-top-products",children:[r.jsx("h3",{children:" Top Productos por Stock"}),r.jsx("div",{className:"top-products-list",children:p.sort((T,S)=>(S.currentStock||0)-(T.currentStock||0)).slice(0,5).map((T,S)=>r.jsxs("div",{className:"top-product-item",children:[r.jsxs("div",{className:"rank",children:["#",S+1]}),r.jsx("div",{className:"product-icon",style:{color:T.color},children:T.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:T.displayName}),r.jsxs("span",{className:"product-stock",children:[Me(T.currentStock||0)," ",T.unit]})]}),r.jsx("div",{className:"product-value",children:An(T.totalValue)})]},T.id))})]}),j>0&&r.jsxs("div",{className:"stats-alerts",children:[r.jsx("h3",{children:" Alertas de Stock"}),r.jsx("div",{className:"alerts-list",children:p.filter(T=>T.stockStatus==="low"||T.stockStatus==="empty").map(T=>r.jsxs("div",{className:`alert-item ${T.stockStatus}`,children:[r.jsx("div",{className:"alert-icon",children:T.stockStatus==="empty"?"":""}),r.jsxs("div",{className:"alert-info",children:[r.jsx("span",{className:"alert-product",children:T.displayName}),r.jsxs("span",{className:"alert-stock",children:["Stock: ",Me(T.currentStock||0)," ",T.unit,T.stockStatus==="empty"&&" - SIN STOCK!",T.stockStatus==="low"&&` - Mnimo: ${T.minThreshold}`]})]})]},T.id))})]})]})},fV=({userProfile:n})=>{const[e,t]=$.useState([]),[a,o]=$.useState(!0),[c,d]=$.useState(null),[m,p]=$.useState(!1),[v,_]=$.useState(null),[b,A]=$.useState("create"),[j,T]=$.useState(""),[S,x]=$.useState(""),[F,Y]=$.useState(!0),V=["admin","supervisor"].includes(n?.role);$.useEffect(()=>{o(!0);const w=LL(C=>{t(C),o(!1),d(null)},C=>{console.error("Error loading products:",C),d("Error cargando productos"),o(!1)});return()=>w()},[]),$.useEffect(()=>{(async()=>{if(console.log(" Debug - Inicializando productos:",{productsLength:e.length,loading:a,canManageProducts:V}),e.length===0&&!a&&V)try{console.log(" Creando productos predefinidos...");const C=Lx();console.log(" Productos predefinidos:",C);for(const R of C)console.log(" Creando producto:",R.name),await Yp({name:R.name,displayName:R.displayName,category:R.category,unit:R.unit,defaultPrice:R.defaultPrice,color:R.color,icon:R.icon,description:R.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});console.log(" Productos predefinidos creados exitosamente")}catch(C){console.error(" Error inicializando productos:",C)}else console.log(" No se inicializan productos:",{reason:e.length>0?"Ya existen productos":a?"Est cargando":V?"Otra razn":"Sin permisos"})})()},[e.length,a,V]);const O=()=>{_(null),A("create"),p(!0)},U=w=>{_(w),A("edit"),p(!0)},W=w=>{_(w),A("view"),p(!0)},L=async w=>{if(window.confirm("Ests seguro de que deseas eliminar este producto?"))try{await kL(w)}catch(C){console.error("Error deleting product:",C),alert("Error al eliminar el producto")}},D=async w=>{try{b==="create"?await Yp(w):b==="edit"&&await OL(v.id,w),p(!1)}catch(C){throw console.error("Error saving product:",C),C}},k=e.filter(w=>{const C=w.displayName?.toLowerCase().includes(j.toLowerCase())||w.name?.toLowerCase().includes(j.toLowerCase()),R=!S||w.category===S;return C&&R});return a?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando productos..."})]})}):c?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"error-container",children:[r.jsxs("p",{children:[" ",c]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"products-main",children:[r.jsxs("div",{className:"products-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:" Gestin de Productos"}),r.jsx("p",{children:"Administra los tipos de combustibles y productos disponibles"})]}),V&&r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{className:"btn-primary",onClick:O,children:" Agregar Producto"}),r.jsx("button",{className:"btn-secondary",onClick:async()=>{try{console.log(" Forzando creacin de productos predefinidos...");const w=Lx();for(const C of w)await Yp({name:C.name,displayName:C.displayName,category:C.category,unit:C.unit,defaultPrice:C.defaultPrice,color:C.color,icon:C.icon,description:C.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});alert("Productos predefinidos creados exitosamente")}catch(w){console.error("Error:",w),alert("Error creando productos: "+w.message)}},style:{marginLeft:"10px"},children:" Crear Predefinidos"})]})]}),F&&r.jsx(hV,{products:e}),r.jsxs("div",{className:"products-filters",children:[r.jsx("div",{className:"filter-group",children:r.jsx("input",{type:"text",placeholder:" Buscar productos...",value:j,onChange:w=>T(w.target.value),className:"search-input"})}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:S,onChange:w=>x(w.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:" Todas las categoras"}),Object.values(Bs).map(w=>r.jsx("option",{value:w,children:w},w))]})}),r.jsx("div",{className:"filter-group",children:r.jsx("button",{className:`toggle-btn ${F?"active":""}`,onClick:()=>Y(!F),children:" Estadsticas"})})]}),r.jsx("div",{className:"products-grid",children:k.map(w=>r.jsxs("div",{className:"product-card",children:[r.jsx("div",{className:"product-icon",style:{color:w.color},children:w.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("h3",{children:w.displayName}),r.jsx("p",{className:"product-category",children:w.category}),r.jsx("p",{className:"product-description",children:w.description}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Stock:"}),r.jsxs("span",{className:"stat-value",children:[w.currentStock||0," ",w.unit]})]}),r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Precio:"}),r.jsxs("span",{className:"stat-value",children:["$",new Intl.NumberFormat("es-CO").format(w.defaultPrice||0)]})]})]}),r.jsx("div",{className:`product-status ${w.isActive?"active":"inactive"}`,children:w.isActive?" Activo":" Inactivo"})]}),r.jsxs("div",{className:"product-actions",children:[r.jsx("button",{className:"btn-secondary",onClick:()=>W(w),children:" Ver"}),V&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-primary",onClick:()=>U(w),children:" Editar"}),r.jsx("button",{className:"btn-danger",onClick:()=>L(w.id),children:" Eliminar"})]})]})]},w.id))}),k.length===0&&r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:""}),r.jsx("h3",{children:"No hay productos"}),r.jsx("p",{children:j||S?"No se encontraron productos con los filtros aplicados.":"An no hay productos registrados."}),V&&!j&&!S&&r.jsx("button",{className:"btn-primary",onClick:O,children:" Crear primer producto"})]}),r.jsx(dV,{isOpen:m,onClose:()=>p(!1),product:v,mode:b,onSave:D,userRole:n?.role})]})},mV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const[c,d]=$.useState("name"),[m,p]=$.useState("asc"),v=F=>{c===F?p(m==="asc"?"desc":"asc"):(d(F),p("asc"))},_=[...n].sort((F,Y)=>{let V=F[c],O=Y[c];switch(c){case"rating":V=V||0,O=O||0;break;case"totalOrders":case"totalPurchased":V=V||0,O=O||0;break;case"createdAt":case"lastOrderDate":V=V?V.toDate?V.toDate():new Date(V):new Date(0),O=O?O.toDate?O.toDate():new Date(O):new Date(0);break;default:V=(V||"").toString().toLowerCase(),O=(O||"").toString().toLowerCase()}return V<O?m==="asc"?-1:1:V>O?m==="asc"?1:-1:0}),b=F=>{switch(F){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},A=F=>{switch(F){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},j=F=>F?(F.toDate?F.toDate():new Date(F)).toLocaleDateString("es-CO"):"-",T=F=>{const Y=[];for(let V=1;V<=5;V++)Y.push(r.jsx("span",{className:`star ${V<=F?"filled":""}`,children:""},V));return r.jsx("div",{className:"rating-stars",children:Y})},S=F=>!F||F.length===0?r.jsx("span",{className:"no-data",children:"-"}):r.jsxs("div",{className:"fuel-types-cell",children:[F.slice(0,2).map(Y=>r.jsx("span",{className:"fuel-badge-sm",children:Nn[Y]||Y},Y)),F.length>2&&r.jsxs("span",{className:"fuel-badge-sm more",title:F.slice(2).map(Y=>Nn[Y]||Y).join(", "),children:["+",F.length-2]})]}),x=F=>c!==F?"icon-chevrons-up-down":m==="asc"?"icon-chevron-up":"icon-chevron-down";return r.jsxs("div",{className:"suppliers-table-container",children:[r.jsxs("div",{className:"table-wrapper",children:[r.jsxs("table",{className:"suppliers-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:`sortable ${c==="name"?"active":""}`,onClick:()=>v("name"),children:[r.jsx("span",{children:"Proveedor"}),r.jsx("i",{className:x("name")})]}),r.jsxs("th",{className:`sortable ${c==="status"?"active":""}`,onClick:()=>v("status"),children:[r.jsx("span",{children:"Estado"}),r.jsx("i",{className:x("status")})]}),r.jsxs("th",{className:`sortable ${c==="category"?"active":""}`,onClick:()=>v("category"),children:[r.jsx("span",{children:"Categora"}),r.jsx("i",{className:x("category")})]}),r.jsx("th",{children:r.jsx("span",{children:"Combustibles"})}),r.jsx("th",{children:r.jsx("span",{children:"Contacto"})}),r.jsxs("th",{className:`sortable ${c==="rating"?"active":""}`,onClick:()=>v("rating"),children:[r.jsx("span",{children:"Rating"}),r.jsx("i",{className:x("rating")})]}),r.jsxs("th",{className:`sortable ${c==="totalOrders"?"active":""}`,onClick:()=>v("totalOrders"),children:[r.jsx("span",{children:"rdenes"}),r.jsx("i",{className:x("totalOrders")})]}),r.jsxs("th",{className:`sortable ${c==="totalPurchased"?"active":""}`,onClick:()=>v("totalPurchased"),children:[r.jsx("span",{children:"Total Comprado"}),r.jsx("i",{className:x("totalPurchased")})]}),r.jsxs("th",{className:`sortable ${c==="createdAt"?"active":""}`,onClick:()=>v("createdAt"),children:[r.jsx("span",{children:"Creado"}),r.jsx("i",{className:x("createdAt")})]}),r.jsx("th",{className:"actions-column",children:r.jsx("span",{children:"Acciones"})})]})}),r.jsx("tbody",{children:_.map(F=>r.jsxs("tr",{className:`supplier-row ${F.status}`,children:[r.jsx("td",{className:"supplier-info-cell",children:r.jsxs("div",{className:"supplier-main-info",children:[r.jsxs("div",{className:"supplier-name",children:[F.name,F.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),F.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",F.taxId]}),F.type&&r.jsx("div",{className:"supplier-type",children:F.type.charAt(0).toUpperCase()+F.type.slice(1)})]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:"status-display",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:b(F.status)}}),r.jsx("span",{className:"status-label",children:A(F.status)})]})}),r.jsx("td",{className:"category-cell",children:r.jsx("span",{className:"category-label",children:F.category?.charAt(0).toUpperCase()+F.category?.slice(1)||"-"})}),r.jsx("td",{className:"fuel-types-cell",children:S(F.fuelTypes)}),r.jsx("td",{className:"contact-cell",children:r.jsxs("div",{className:"contact-info",children:[F.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:F.contactPerson})]}),F.phone&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("a",{href:`tel:${F.phone}`,children:F.phone})]}),F.email&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("a",{href:`mailto:${F.email}`,children:F.email})]}),F.city&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:F.city})]})]})}),r.jsx("td",{className:"rating-cell",children:r.jsxs("div",{className:"rating-display",children:[T(F.rating||0),r.jsx("span",{className:"rating-value",children:(F.rating||0).toFixed(1)})]})}),r.jsx("td",{className:"orders-cell",children:r.jsx("span",{className:"orders-count",children:F.totalOrders||0})}),r.jsx("td",{className:"purchased-cell",children:r.jsx("span",{className:"purchased-amount",children:An(F.totalPurchased||0)})}),r.jsx("td",{className:"date-cell",children:r.jsx("span",{className:"date-value",children:j(F.createdAt)})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[a&&r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(F),title:"Editar proveedor",children:r.jsx("i",{className:"icon-edit"})}),o&&F.status==="active"&&r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(F.id,F.name),title:"Desactivar proveedor",children:r.jsx("i",{className:"icon-x-circle"})}),r.jsxs("div",{className:"quick-actions",children:[F.phone&&r.jsx("a",{href:`tel:${F.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),F.email&&r.jsx("a",{href:`mailto:${F.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})})]},F.id))})]}),_.length===0&&r.jsxs("div",{className:"table-empty-state",children:[r.jsx("i",{className:"icon-truck"}),r.jsx("p",{children:"No hay proveedores para mostrar"})]})]}),r.jsxs("div",{className:"table-footer",children:[r.jsx("div",{className:"table-info",children:r.jsxs("span",{children:["Mostrando ",_.length," proveedor",_.length!==1?"es":""]})}),r.jsx("div",{className:"table-actions",children:r.jsxs("span",{className:"sort-info",children:["Ordenado por: ",c==="name"?"Nombre":c==="status"?"Estado":c==="category"?"Categora":c==="rating"?"Rating":c==="totalOrders"?"rdenes":c==="totalPurchased"?"Total Comprado":c==="createdAt"?"Fecha de Creacin":c," (",m==="asc"?"Ascendente":"Descendente",")"]})})]})]})},pV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const c=j=>{switch(j){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},d=j=>{switch(j){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},m=j=>{switch(j){case"combustibles":return"";case"lubricantes":return"";case"aditivos":return"";default:return""}},p=j=>{switch(j){case"proveedor":return"Proveedor";case"distribuidor":return"Distribuidor";case"mayorista":return"Mayorista";default:return"Sin especificar"}},v=j=>j?(j.toDate?j.toDate():new Date(j)).toLocaleDateString("es-CO"):"No disponible",_=j=>{const T=[];for(let S=1;S<=5;S++)T.push(r.jsx("span",{className:`star ${S<=j?"filled":""}`,children:""},S));return r.jsx("div",{className:"rating-stars",children:T})},b=j=>!j||j.length===0?r.jsx("span",{className:"no-fuels",children:"Sin combustibles especificados"}):r.jsxs("div",{className:"fuel-types",children:[j.slice(0,3).map(T=>r.jsx("span",{className:"fuel-badge",title:Nn[T],children:Nn[T]||T},T)),j.length>3&&r.jsxs("span",{className:"fuel-badge more",title:`+${j.length-3} ms`,children:["+",j.length-3]})]}),A=j=>{const T=[];return j.phone&&T.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("span",{children:j.phone})]},"phone")),j.email&&T.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("span",{children:j.email})]},"email")),j.city&&T.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:j.city})]},"city")),T.length>0?T:r.jsxs("div",{className:"contact-item no-contact",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:"Sin informacin de contacto"})]})};return r.jsx("div",{className:"suppliers-cards",children:n.map(j=>r.jsxs("div",{className:`supplier-card ${j.status}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsx("div",{className:"header-left",children:r.jsxs("div",{className:"supplier-info",children:[r.jsxs("h3",{className:"supplier-name",children:[j.name,j.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),j.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",j.taxId]})]})}),r.jsx("div",{className:"header-right",children:r.jsxs("div",{className:"supplier-status",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:c(j.status)}}),r.jsx("span",{className:"status-label",children:d(j.status)})]})})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"supplier-meta",children:[r.jsxs("div",{className:"meta-item",children:[r.jsx("span",{className:"meta-icon",children:m(j.category)}),r.jsx("span",{className:"meta-label",children:j.category?.charAt(0).toUpperCase()+j.category?.slice(1)||"Sin categora"})]}),r.jsxs("div",{className:"meta-item",children:[r.jsx("i",{className:"icon-building meta-icon"}),r.jsx("span",{className:"meta-label",children:p(j.type)})]})]}),j.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:j.contactPerson})]}),r.jsx("div",{className:"contact-info",children:A(j)}),r.jsxs("div",{className:"fuel-types-section",children:[r.jsx("div",{className:"section-label",children:"Combustibles Suministrados:"}),b(j.fuelTypes)]}),r.jsxs("div",{className:"rating-section",children:[r.jsxs("div",{className:"rating-display",children:[_(j.rating||0),r.jsxs("span",{className:"rating-value",children:[(j.rating||0).toFixed(1),"/5"]})]}),j.evaluationNotes&&r.jsxs("div",{className:"evaluation-notes",title:j.evaluationNotes,children:[r.jsx("i",{className:"icon-message-square"}),r.jsx("span",{children:"Con evaluacin"})]})]}),j.paymentTerms&&r.jsxs("div",{className:"payment-terms",children:[r.jsx("i",{className:"icon-credit-card"}),r.jsxs("span",{children:["Trminos: ",j.paymentTerms==="contado"?"Contado":j.paymentTerms==="30dias"?"30 das":j.paymentTerms==="60dias"?"60 das":j.paymentTerms==="90dias"?"90 das":j.paymentTerms]})]}),r.jsxs("div",{className:"supplier-stats",children:[r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"rdenes:"}),r.jsx("span",{className:"stat-value",children:j.totalOrders||0})]}),r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Total Comprado:"}),r.jsx("span",{className:"stat-value",children:An(j.totalPurchased||0)})]}),j.lastOrderDate&&r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"ltima Orden:"}),r.jsx("span",{className:"stat-value",children:v(j.lastOrderDate)})]})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsx("div",{className:"footer-info",children:r.jsxs("span",{className:"created-date",children:["Creado: ",v(j.createdAt)]})}),r.jsxs("div",{className:"card-actions",children:[a&&r.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(j),title:"Editar proveedor",children:[r.jsx("i",{className:"icon-edit"}),"Editar"]}),o&&j.status==="active"&&r.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>t(j.id,j.name),title:"Desactivar proveedor",children:[r.jsx("i",{className:"icon-x-circle"}),"Desactivar"]}),r.jsxs("div",{className:"quick-actions",children:[j.phone&&r.jsx("a",{href:`tel:${j.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),j.email&&r.jsx("a",{href:`mailto:${j.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})]})]},j.id))})},gV=({supplier:n,onClose:e,onSuccess:t,onError:a})=>{const{userProfile:o}=Ts(),c=!!n,[d,m]=$.useState({name:"",taxId:"",type:"proveedor",category:"combustibles",contactPerson:"",phone:"",email:"",address:"",city:"",state:"Colombia",fuelTypes:[],paymentTerms:"contado",creditLimit:"",priceList:{},rating:5,evaluationNotes:"",status:"active",isPreferred:!1}),[p,v]=$.useState(!1),[_,b]=$.useState({}),[A,j]=$.useState("basic");$.useEffect(()=>{c&&n&&m({name:n.name||"",taxId:n.taxId||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson||"",phone:n.phone||"",email:n.email||"",address:n.address||"",city:n.city||"",state:n.state||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:n.creditLimit||"",priceList:n.priceList||{},rating:n.rating||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1})},[c,n]);const T=(O,U)=>{m(W=>({...W,[O]:U})),_[O]&&b(W=>({...W,[O]:null}))},S=O=>{m(U=>({...U,fuelTypes:U.fuelTypes.includes(O)?U.fuelTypes.filter(W=>W!==O):[...U.fuelTypes,O]}))},x=(O,U)=>{m(W=>({...W,priceList:{...W.priceList,[O]:parseFloat(U)||0}}))},F=()=>{const O={};return d.name.trim()||(O.name="El nombre del proveedor es requerido"),d.category||(O.category="La categora es requerida"),d.type||(O.type="El tipo de proveedor es requerido"),d.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)&&(O.email="El formato del email no es vlido"),d.phone&&!/^[\d\s\-+()]+$/.test(d.phone)&&(O.phone="El formato del telfono no es vlido"),d.creditLimit&&(isNaN(d.creditLimit)||parseFloat(d.creditLimit)<0)&&(O.creditLimit="El lmite de crdito debe ser un nmero positivo"),(d.rating<1||d.rating>5)&&(O.rating="El rating debe estar entre 1 y 5"),d.fuelTypes.forEach(U=>{d.priceList[U]&&(isNaN(d.priceList[U])||parseFloat(d.priceList[U])<0)&&(O[`price_${U}`]=`El precio de ${Nn[U]} debe ser un nmero positivo`)}),b(O),Object.keys(O).length===0},Y=async O=>{if(O.preventDefault(),!!F()){v(!0);try{const U={...d,creditLimit:parseFloat(d.creditLimit)||0,rating:parseFloat(d.rating)||5,priceList:Object.fromEntries(Object.entries(d.priceList).filter(([L,D])=>d.fuelTypes.includes(L)&&D>0))};let W;c?W=await vL(n.id,U,o?.email):W=await gL(U,o?.email),W.success?t():a(W.error||"Error al guardar proveedor")}catch(U){console.error("Error saving supplier:",U),a("Error inesperado al guardar proveedor")}finally{v(!1)}}},V=[{id:"basic",label:"Informacin Bsica",icon:"icon-info"},{id:"contact",label:"Contacto",icon:"icon-phone"},{id:"products",label:"Productos",icon:"icon-package"},{id:"commercial",label:"Comercial",icon:"icon-credit-card"}];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-container large",onClick:O=>O.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[r.jsx("i",{className:"icon-truck"}),c?"Editar Proveedor":"Nuevo Proveedor"]}),r.jsx("button",{className:"modal-close",onClick:e,children:r.jsx("i",{className:"icon-x"})})]}),r.jsxs("form",{onSubmit:Y,children:[r.jsx("div",{className:"modal-tabs",children:V.map(O=>r.jsxs("button",{type:"button",className:`tab-button ${A===O.id?"active":""}`,onClick:()=>j(O.id),children:[r.jsx("i",{className:O.icon}),O.label]},O.id))}),r.jsxs("div",{className:"modal-body",children:[A==="basic"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Nombre del Proveedor"}),r.jsx("input",{type:"text",value:d.name,onChange:O=>T("name",O.target.value),placeholder:"Ingresa el nombre del proveedor",className:_.name?"error":""}),_.name&&r.jsx("span",{className:"error-message",children:_.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"NIT / Documento"}),r.jsx("input",{type:"text",value:d.taxId,onChange:O=>T("taxId",O.target.value),placeholder:"123456789-0",className:_.taxId?"error":""}),_.taxId&&r.jsx("span",{className:"error-message",children:_.taxId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Tipo de Proveedor"}),r.jsxs("select",{value:d.type,onChange:O=>T("type",O.target.value),className:_.type?"error":"",children:[r.jsx("option",{value:"proveedor",children:"Proveedor"}),r.jsx("option",{value:"distribuidor",children:"Distribuidor"}),r.jsx("option",{value:"mayorista",children:"Mayorista"})]}),_.type&&r.jsx("span",{className:"error-message",children:_.type})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Categora"}),r.jsxs("select",{value:d.category,onChange:O=>T("category",O.target.value),className:_.category?"error":"",children:[r.jsx("option",{value:"combustibles",children:"Combustibles"}),r.jsx("option",{value:"lubricantes",children:"Lubricantes"}),r.jsx("option",{value:"aditivos",children:"Aditivos"})]}),_.category&&r.jsx("span",{className:"error-message",children:_.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:d.status,onChange:O=>T("status",O.target.value),children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"suspended",children:"Suspendido"})]})]}),r.jsx("div",{className:"form-group checkbox",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.isPreferred,onChange:O=>T("isPreferred",O.target.checked)}),r.jsx("span",{className:"checkbox-mark"}),"Proveedor Preferido"]})})]})}),A==="contact"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Persona de Contacto"}),r.jsx("input",{type:"text",value:d.contactPerson,onChange:O=>T("contactPerson",O.target.value),placeholder:"Nombre del contacto principal"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Telfono"}),r.jsx("input",{type:"tel",value:d.phone,onChange:O=>T("phone",O.target.value),placeholder:"+57 300 123 4567",className:_.phone?"error":""}),_.phone&&r.jsx("span",{className:"error-message",children:_.phone})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{type:"email",value:d.email,onChange:O=>T("email",O.target.value),placeholder:"contacto@proveedor.com",className:_.email?"error":""}),_.email&&r.jsx("span",{className:"error-message",children:_.email})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ciudad"}),r.jsx("input",{type:"text",value:d.city,onChange:O=>T("city",O.target.value),placeholder:"Bogot"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado/Pas"}),r.jsx("input",{type:"text",value:d.state,onChange:O=>T("state",O.target.value),placeholder:"Colombia"})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Direccin"}),r.jsx("textarea",{value:d.address,onChange:O=>T("address",O.target.value),placeholder:"Direccin completa del proveedor",rows:"3"})]})]})}),A==="products"&&r.jsxs("div",{className:"tab-content",children:[r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Tipos de Combustible que Suministra"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(Nn).map(([O,U])=>r.jsx("div",{className:"fuel-type-item",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.fuelTypes.includes(O),onChange:()=>S(O)}),r.jsx("span",{className:"checkbox-mark"}),U]})},O))})]}),d.fuelTypes.length>0&&r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Precios por Litro (Opcional)"}),r.jsx("div",{className:"prices-grid",children:d.fuelTypes.map(O=>r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:Nn[O]}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.priceList[O]||"",onChange:U=>x(O,U.target.value),placeholder:"0.00",className:_[`price_${O}`]?"error":""})]}),_[`price_${O}`]&&r.jsx("span",{className:"error-message",children:_[`price_${O}`]})]},O))})]})]}),A==="commercial"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Trminos de Pago"}),r.jsxs("select",{value:d.paymentTerms,onChange:O=>T("paymentTerms",O.target.value),children:[r.jsx("option",{value:"contado",children:"Contado"}),r.jsx("option",{value:"30dias",children:"30 das"}),r.jsx("option",{value:"60dias",children:"60 das"}),r.jsx("option",{value:"90dias",children:"90 das"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Lmite de Crdito"}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.creditLimit,onChange:O=>T("creditLimit",O.target.value),placeholder:"0.00",className:_.creditLimit?"error":""})]}),_.creditLimit&&r.jsx("span",{className:"error-message",children:_.creditLimit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Rating"}),r.jsxs("div",{className:"rating-input",children:[r.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:d.rating,onChange:O=>T("rating",parseFloat(O.target.value)),className:_.rating?"error":""}),r.jsxs("div",{className:"rating-display",children:[r.jsx("span",{className:"rating-value",children:d.rating.toFixed(1)}),r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(O=>r.jsx("span",{className:`star ${O<=Math.round(d.rating)?"filled":""}`,children:""},O))})]})]}),_.rating&&r.jsx("span",{className:"error-message",children:_.rating})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Notas de Evaluacin"}),r.jsx("textarea",{value:d.evaluationNotes,onChange:O=>T("evaluationNotes",O.target.value),placeholder:"Comentarios sobre el desempeo del proveedor...",rows:"4"})]})]})})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"loading-spinner small"}),c?"Actualizando...":"Creando..."]}):r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"icon-save"}),c?"Actualizar Proveedor":"Crear Proveedor"]})})]})]})]})})},vV=({stats:n,suppliersCount:e,totalSuppliers:t})=>{if(!n)return null;const a=d=>{switch(d){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case"combustibles":return"";case"lubricantes":return"";case"aditivos":return"";default:return""}},c=d=>{switch(d){case"proveedor":return"";case"distribuidor":return"";case"mayorista":return"";default:return""}};return r.jsxs("div",{className:"suppliers-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.total)}),r.jsx("div",{className:"stat-label",children:"Total Proveedores"}),t!==e&&r.jsxs("div",{className:"stat-sublabel",children:[Me(e)," mostrados"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-check-circle"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.active)}),r.jsx("div",{className:"stat-label",children:"Activos"}),r.jsx("div",{className:"stat-sublabel",children:Er(n.total>0?n.active/n.total:0)})]})]}),r.jsxs("div",{className:"stat-card warning",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-star"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.preferred)}),r.jsx("div",{className:"stat-label",children:"Preferidos"}),r.jsx("div",{className:"stat-sublabel",children:Er(n.active>0?n.preferred/n.active:0)})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-award"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:n.averageRating.toFixed(1)}),r.jsx("div",{className:"stat-label",children:"Rating Promedio"}),r.jsx("div",{className:"stat-sublabel",children:r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(d=>r.jsx("span",{className:`star ${d<=Math.round(n.averageRating)?"filled":""}`,children:""},d))})})]})]})]}),r.jsxs("div",{className:"stats-details",children:[r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Estado de Proveedores"}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("active")}}),"Activos"]}),r.jsx("div",{className:"breakdown-value",children:n.active}),r.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?n.active/n.total:0)})]}),n.inactive>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("inactive")}}),"Inactivos"]}),r.jsx("div",{className:"breakdown-value",children:n.inactive}),r.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?n.inactive/n.total:0)})]}),n.suspended>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("suspended")}}),"Suspendidos"]}),r.jsx("div",{className:"breakdown-value",children:n.suspended}),r.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?n.suspended/n.total:0)})]})]})]}),Object.keys(n.byCategory).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Categora"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byCategory).sort(([,d],[,m])=>m-d).map(([d,m])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"category-icon",children:o(d)}),d.charAt(0).toUpperCase()+d.slice(1).replace("_"," ")]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?m/n.total:0)})]},d))})]}),Object.keys(n.byType).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Tipo"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byType).sort(([,d],[,m])=>m-d).map(([d,m])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"type-icon",children:c(d)}),d.charAt(0).toUpperCase()+d.slice(1)]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?m/n.total:0)})]},d))})]})]}),r.jsxs("div",{className:"stats-insights",children:[r.jsx("h3",{children:"Informacin Rpida"}),r.jsxs("div",{className:"insights-grid",children:[r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Nivel de Satisfaccin"}),r.jsx("div",{className:"insight-value",children:n.averageRating>=4.5?"Excelente":n.averageRating>=4?"Muy Bueno":n.averageRating>=3.5?"Bueno":n.averageRating>=3?"Regular":"Necesita Mejora"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Estado General"}),r.jsx("div",{className:"insight-value",children:n.active/n.total>=.9?"Excelente":n.active/n.total>=.8?"Bueno":n.active/n.total>=.7?"Regular":"Revisar"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Proveedores Preferidos"}),r.jsx("div",{className:"insight-value",children:n.preferred===0?"Ninguno":n.preferred/n.active>=.3?"Suficientes":n.preferred/n.active>=.2?"Buenos":"Pocos"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Diversificacin"}),r.jsx("div",{className:"insight-value",children:Object.keys(n.byCategory).length>=3?"Alta":Object.keys(n.byCategory).length>=2?"Media":"Baja"})]})]})]})]})},yV=({searchTerm:n,setSearchTerm:e,filterStatus:t,setFilterStatus:a,filterCategory:o,setFilterCategory:c,filterFuelType:d,setFilterFuelType:m,viewMode:p,setViewMode:v,onClearFilters:_,resultsCount:b})=>{const A=[{value:"all",label:"Todos los Estados",icon:"list"},{value:"active",label:"Activos",icon:"check-circle"},{value:"inactive",label:"Inactivos",icon:"x-circle"},{value:"suspended",label:"Suspendidos",icon:"alert-circle"},{value:"preferred",label:"Preferidos",icon:"star"}],j=[{value:"all",label:"Todas las Categoras",icon:"grid"},{value:"combustibles",label:"Combustibles",icon:"fuel"},{value:"lubricantes",label:"Lubricantes",icon:"droplets"},{value:"aditivos",label:"Aditivos",icon:"flask"}],T=[{value:"all",label:"Todos los Combustibles",icon:"fuel"},...Object.entries(Nn).map(([x,F])=>({value:x,label:F,icon:"droplet"}))],S=n||t!=="all"||o!=="all"||d!=="all";return r.jsxs("div",{className:"suppliers-filters",children:[r.jsxs("div",{className:"filters-top",children:[r.jsx("div",{className:"search-container",children:r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx("i",{className:"icon-search search-icon"}),r.jsx("input",{type:"text",placeholder:"Buscar por nombre, NIT, contacto, ciudad...",value:n,onChange:x=>e(x.target.value),className:"search-input"}),n&&r.jsx("button",{className:"search-clear",onClick:()=>e(""),title:"Limpiar bsqueda",children:r.jsx("i",{className:"icon-x"})})]})}),r.jsxs("div",{className:"view-controls",children:[r.jsxs("div",{className:"view-mode-toggle",children:[r.jsx("button",{className:`view-btn ${p==="cards"?"active":""}`,onClick:()=>v("cards"),title:"Vista de tarjetas",children:r.jsx("i",{className:"icon-grid"})}),r.jsx("button",{className:`view-btn ${p==="table"?"active":""}`,onClick:()=>v("table"),title:"Vista de tabla",children:r.jsx("i",{className:"icon-list"})})]}),S&&r.jsxs("button",{className:"btn btn-secondary clear-filters",onClick:_,title:"Limpiar todos los filtros",children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar"]})]})]}),r.jsxs("div",{className:"filters-dropdowns",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Estado"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:t,onChange:x=>a(x.target.value),className:"filter-select",children:A.map(x=>r.jsx("option",{value:x.value,children:x.label},x.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Categora"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:o,onChange:x=>c(x.target.value),className:"filter-select",children:j.map(x=>r.jsx("option",{value:x.value,children:x.label},x.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:d,onChange:x=>m(x.target.value),className:"filter-select",children:T.map(x=>r.jsx("option",{value:x.value,children:x.label},x.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]})]}),r.jsxs("div",{className:"filters-summary",children:[r.jsxs("div",{className:"results-count",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:b===0?"No se encontraron proveedores":`Mostrando ${b} proveedor${b!==1?"es":""}`})]}),S&&r.jsxs("div",{className:"active-filters",children:[r.jsx("span",{className:"filters-label",children:"Filtros activos:"}),r.jsxs("div",{className:"filter-tags",children:[n&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-search"}),n,r.jsx("button",{onClick:()=>e(""),children:r.jsx("i",{className:"icon-x"})})]}),t!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-filter"}),A.find(x=>x.value===t)?.label,r.jsx("button",{onClick:()=>a("all"),children:r.jsx("i",{className:"icon-x"})})]}),o!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-tag"}),j.find(x=>x.value===o)?.label,r.jsx("button",{onClick:()=>c("all"),children:r.jsx("i",{className:"icon-x"})})]}),d!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-droplet"}),T.find(x=>x.value===d)?.label,r.jsx("button",{onClick:()=>m("all"),children:r.jsx("i",{className:"icon-x"})})]})]})]})]}),r.jsxs("div",{className:"quick-filters",children:[r.jsx("span",{className:"quick-filters-label",children:"Acceso rpido:"}),r.jsxs("div",{className:"quick-filter-buttons",children:[r.jsxs("button",{className:`quick-filter-btn ${t==="preferred"?"active":""}`,onClick:()=>a(t==="preferred"?"all":"preferred"),children:[r.jsx("i",{className:"icon-star"}),"Preferidos"]}),r.jsxs("button",{className:`quick-filter-btn ${t==="active"?"active":""}`,onClick:()=>a(t==="active"?"all":"active"),children:[r.jsx("i",{className:"icon-check-circle"}),"Activos"]}),r.jsxs("button",{className:`quick-filter-btn ${o==="combustibles"?"active":""}`,onClick:()=>c(o==="combustibles"?"all":"combustibles"),children:[r.jsx("i",{className:"icon-fuel"}),"Combustibles"]}),r.jsxs("button",{className:`quick-filter-btn ${d==="diesel"?"active":""}`,onClick:()=>m(d==="diesel"?"all":"diesel"),children:[r.jsx("i",{className:"icon-droplet"}),"Disel"]})]})]})]})},_V=()=>{const{hasPermission:n,userProfile:e}=Ts(),[t,a]=$.useState([]),[o,c]=$.useState(null),[d,m]=$.useState(!0),[p,v]=$.useState(null),[_,b]=$.useState("cards"),[A,j]=$.useState(!1),[T,S]=$.useState(null),[x,F]=$.useState("all"),[Y,V]=$.useState("all"),[O,U]=$.useState("all"),[W,L]=$.useState("");$.useEffect(()=>{let z=null;return(()=>{z=kj(he=>{a(he||[]),m(!1)})})(),()=>{z&&z()}},[]),$.useEffect(()=>{const z=async()=>{const se=await _L();se.success&&c(se.data)};t.length>0&&z()},[t]);const D=t.filter(z=>{const se=!W||z.name?.toLowerCase().includes(W.toLowerCase())||z.taxId?.toLowerCase().includes(W.toLowerCase())||z.contactPerson?.toLowerCase().includes(W.toLowerCase())||z.city?.toLowerCase().includes(W.toLowerCase()),he=x==="all"||(x==="preferred"?z.isPreferred:z.status===x),ye=Y==="all"||z.category===Y,q=O==="all"||z.fuelTypes&&z.fuelTypes.includes(O);return se&&he&&ye&&q}),k=()=>{if(!n("canManageSuppliers")){v("No tienes permisos para agregar proveedores");return}S(null),j(!0)},w=z=>{if(!n("canManageSuppliers")){v("No tienes permisos para editar proveedores");return}S(z),j(!0)},C=async(z,se)=>{if(!n("canManageSuppliers")){v("No tienes permisos para eliminar proveedores");return}if(window.confirm(`Ests seguro de que deseas desactivar el proveedor "${se}"?

Esta accin se puede revertir cambiando su estado a activo.`))try{const he=await yL(z,e?.email);he.success?v(null):v(he.error||"Error al desactivar proveedor")}catch(he){console.error("Error deleting supplier:",he),v("Error inesperado al eliminar proveedor")}},R=()=>{j(!1),S(null),v(null)},P=()=>{j(!1),S(null),v(null)},Ee=()=>{F("all"),V("all"),U("all"),L("")},ne=()=>{if(!n("canExportReports")){v("No tienes permisos para exportar datos");return}try{const z=D.map(ee=>({Nombre:ee.name,"NIT/Documento":ee.taxId,Tipo:ee.type,Categora:ee.category,"Persona de Contacto":ee.contactPerson,Telfono:ee.phone,Email:ee.email,Ciudad:ee.city,Combustibles:ee.fuelTypes?.join(", "),Rating:ee.rating,Estado:ee.status,Preferido:ee.isPreferred?"S":"No","Fecha Creacin":ee.createdAt?.toDate?.()?.toLocaleDateString()||"N/A"})),se=[Object.keys(z[0]).join(","),...z.map(ee=>Object.values(ee).map(ce=>`"${ce||""}"`).join(","))].join(`
`),he=new Blob([se],{type:"text/csv;charset=utf-8;"}),ye=document.createElement("a"),q=URL.createObjectURL(he);ye.setAttribute("href",q),ye.setAttribute("download",`proveedores_${new Date().toISOString().split("T")[0]}.csv`),ye.style.visibility="hidden",document.body.appendChild(ye),ye.click(),document.body.removeChild(ye)}catch(z){console.error("Error exporting suppliers:",z),v("Error al exportar proveedores")}};return d?r.jsx("div",{className:"suppliers-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando proveedores..."})]})}):r.jsxs("div",{className:"suppliers-main",children:[r.jsxs("div",{className:"suppliers-header",children:[r.jsxs("div",{className:"header-content",children:[r.jsx("h1",{children:"Gestin de Proveedores"}),r.jsx("p",{className:"header-subtitle",children:"Administra los proveedores de combustibles y materiales"})]}),r.jsxs("div",{className:"header-actions",children:[n("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:k,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Proveedor"]}),n("canExportReports")&&r.jsxs("button",{className:"btn btn-secondary",onClick:ne,disabled:D.length===0,children:[r.jsx("i",{className:"icon-download"}),"Exportar"]})]})]}),p&&r.jsxs("div",{className:"alert alert-error",children:[r.jsx("i",{className:"icon-alert-circle"}),r.jsx("span",{children:p}),r.jsx("button",{onClick:()=>v(null),className:"alert-close",children:r.jsx("i",{className:"icon-x"})})]}),o&&r.jsx(vV,{stats:o,suppliersCount:D.length,totalSuppliers:t.length}),r.jsx(yV,{searchTerm:W,setSearchTerm:L,filterStatus:x,setFilterStatus:F,filterCategory:Y,setFilterCategory:V,filterFuelType:O,setFilterFuelType:U,viewMode:_,setViewMode:b,onClearFilters:Ee,resultsCount:D.length}),D.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsx("h3",{children:"No hay proveedores"}),r.jsx("p",{children:t.length===0?"Comienza agregando tu primer proveedor de combustibles.":"No se encontraron proveedores que coincidan con los filtros aplicados."}),t.length===0&&n("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:k,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Primer Proveedor"]}),t.length>0&&r.jsxs("button",{className:"btn btn-secondary",onClick:Ee,children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar Filtros"]})]}):r.jsx("div",{className:"suppliers-content",children:_==="cards"?r.jsx(pV,{suppliers:D,onEdit:w,onDelete:C,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")}):r.jsx(mV,{suppliers:D,onEdit:w,onDelete:C,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")})}),A&&r.jsx(gV,{supplier:T,onClose:R,onSuccess:P,onError:v})]})},bV=()=>{const{user:n,userProfile:e}=Ts(),[t,a]=$.useState("invitations"),[o,c]=$.useState([]),[d,m]=$.useState(!1),[p,v]=$.useState(!1),[_,b]=$.useState(!1),[A,j]=$.useState({email:"",name:"",role:ys.CLIENTE});$.useEffect(()=>{n&&e?.role==="admin"&&T()},[n,e]);const T=async()=>{m(!0);try{const O=await aL(n.uid);O.success?c(O.invitations):console.error("Error loading invitations:",O.error)}catch(O){console.error("Error loading invitations:",O)}finally{m(!1)}},S=async O=>{O.preventDefault(),b(!0);try{const U=await nL(A,n.uid);U.success?(j({email:"",name:"",role:ys.CLIENTE}),v(!1),await T(),alert(`Invitacin creada exitosamente!
Cdigo: ${U.invitation.code}`)):alert(`Error: ${U.error}`)}catch(U){console.error("Error creating invitation:",U),alert("Error creando invitacin")}finally{b(!1)}},x=async O=>{if(confirm("Ests seguro de cancelar esta invitacin?"))try{const U=await iL(O,n.uid);U.success?(await T(),alert("Invitacin cancelada exitosamente")):alert(`Error: ${U.error}`)}catch(U){console.error("Error cancelling invitation:",U),alert("Error cancelando invitacin")}},F=O=>({pending:{text:"Pendiente",class:"status-pending"},used:{text:"Usada",class:"status-used"},cancelled:{text:"Cancelada",class:"status-cancelled"},expired:{text:"Expirada",class:"status-expired"}})[O]||{text:O,class:"status-unknown"},Y=O=>({admin:"Administrador",contador:"Contador",cliente:"Cliente"})[O]||O,V=O=>O?(O.toDate?O.toDate():new Date(O)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e?.role!=="admin"?r.jsxs("div",{className:"admin-unauthorized",children:[r.jsx("h2",{children:" Acceso Denegado"}),r.jsx("p",{children:"Solo los administradores pueden acceder a esta seccin."})]}):r.jsxs("div",{className:"admin-main",children:[r.jsxs("div",{className:"admin-header",children:[r.jsx("h1",{children:" Administracin del Sistema"}),r.jsx("p",{children:"Gestin de usuarios y configuraciones"})]}),r.jsxs("div",{className:"admin-tabs",children:[r.jsx("button",{className:`tab-button ${t==="invitations"?"active":""}`,onClick:()=>a("invitations"),children:" Invitaciones"}),r.jsx("button",{className:`tab-button ${t==="users"?"active":""}`,onClick:()=>a("users"),children:" Usuarios"}),r.jsx("button",{className:`tab-button ${t==="settings"?"active":""}`,onClick:()=>a("settings"),children:" Configuracin"})]}),r.jsxs("div",{className:"admin-content",children:[t==="invitations"&&r.jsxs("div",{className:"invitations-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h2",{children:"Gestin de Invitaciones"}),r.jsx("button",{className:"create-button",onClick:()=>v(!0),children:"+ Crear Invitacin"})]}),d?r.jsx("div",{className:"loading",children:"Cargando invitaciones..."}):r.jsxs("div",{className:"invitations-table",children:[r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Cdigo"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Rol"}),r.jsx("th",{children:"Estado"}),r.jsx("th",{children:"Creada"}),r.jsx("th",{children:"Expira"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(O=>{const U=F(O.status);return r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("code",{className:"invitation-code",children:O.code})}),r.jsx("td",{children:O.targetEmail}),r.jsx("td",{children:O.targetName||"-"}),r.jsx("td",{children:Y(O.targetRole)}),r.jsx("td",{children:r.jsx("span",{className:`status-badge ${U.class}`,children:U.text})}),r.jsx("td",{children:V(O.createdAt)}),r.jsx("td",{children:V(O.expiresAt)}),r.jsx("td",{children:O.status==="pending"&&r.jsx("button",{className:"cancel-button",onClick:()=>x(O.id),children:"Cancelar"})})]},O.id)})})]}),o.length===0&&r.jsx("div",{className:"empty-state",children:r.jsx("p",{children:"No hay invitaciones creadas"})})]})]}),t==="users"&&r.jsxs("div",{className:"users-section",children:[r.jsx("h2",{children:" Usuarios del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:" En desarrollo"}),r.jsx("p",{children:"Prximamente: Lista de usuarios registrados, edicin de permisos, y estadsticas."})]})]}),t==="settings"&&r.jsxs("div",{className:"settings-section",children:[r.jsx("h2",{children:" Configuracin del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:" En desarrollo"}),r.jsx("p",{children:"Prximamente: Configuraciones generales, notificaciones, y parmetros del sistema."})]})]})]}),p&&r.jsx("div",{className:"modal-overlay",onClick:()=>v(!1),children:r.jsxs("div",{className:"modal-content",onClick:O=>O.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Crear Nueva Invitacin"}),r.jsx("button",{className:"modal-close",onClick:()=>v(!1),children:""})]}),r.jsxs("form",{onSubmit:S,className:"invitation-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email del usuario:"}),r.jsx("input",{id:"email",type:"email",required:!0,value:A.email,onChange:O=>j({...A,email:O.target.value}),placeholder:"usuario@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Nombre (opcional):"}),r.jsx("input",{id:"name",type:"text",value:A.name,onChange:O=>j({...A,name:O.target.value}),placeholder:"Nombre del usuario"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"role",children:"Rol:"}),r.jsxs("select",{id:"role",value:A.role,onChange:O=>j({...A,role:O.target.value}),children:[r.jsx("option",{value:ys.CLIENTE,children:"Cliente"}),r.jsx("option",{value:ys.CONTADOR,children:"Contador"}),r.jsx("option",{value:ys.ADMIN,children:"Administrador"})]})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"cancel-button",onClick:()=>v(!1),children:"Cancelar"}),r.jsx("button",{type:"submit",className:"create-button",disabled:_,children:_?"Creando...":"Crear Invitacin"})]})]})]})})]})},EV=()=>r.jsxs("div",{className:"module-placeholder",children:[r.jsx("h2",{children:" Mdulo de Reportes"}),r.jsx("p",{children:"Anlisis y reportes de combustibles"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:" En desarrollo"}),r.jsx("p",{children:"Prximamente: Reportes personalizables, grficos interactivos, y exportacin."})]})]}),NV=()=>{const[n,e]=$.useState("dashboard"),t=()=>{switch(n){case"dashboard":return r.jsx(Px,{});case"inventory":return r.jsx(jL,{});case"movements":return r.jsx(UL,{});case"vehicles":return r.jsx(JL,{});case"maintenance":return r.jsx(uV,{});case"products":return r.jsx(fV,{});case"suppliers":return r.jsx(_V,{});case"reports":return r.jsx(EV,{});case"admin":return r.jsx(bV,{});default:return r.jsx(Px,{})}};return r.jsx(EL,{currentView:n,onViewChange:e,children:t()})},xV=()=>{const[n,e]=$.useState("login"),[t,a]=$.useState(!1),[o,c]=$.useState(""),[d,m]=$.useState(""),[p,v]=$.useState(""),[_,b]=$.useState(""),[A,j]=$.useState({email:"",password:"",confirmPassword:"",invitationCode:""}),[T,S]=$.useState(""),[x,F]=$.useState(null),Y=async k=>{k.preventDefault(),a(!0),c("");try{await cR(Bc,p,_)}catch(w){console.error("Error en login:",w),c(W(w.code))}finally{a(!1)}},V=async()=>{a(!0),c("");try{const k=new Aa,w=await MR(Bc,k);x?await Rx(w.user,x.code):await pj(w.user)}catch(k){console.error("Error en login con Google:",k),c("Error al iniciar sesin con Google")}finally{a(!1)}},O=async k=>{k.preventDefault(),a(!0),c(""),m("");try{const w=await mj(T);w.success?(F(w.invitation),m(`Invitacin vlida para: ${w.invitation.targetEmail}`),e("register"),j({...A,email:w.invitation.targetEmail,invitationCode:T})):c(w.error)}catch(w){console.error("Error validando invitacin:",w),c("Error validando cdigo de invitacin")}finally{a(!1)}},U=async k=>{if(k.preventDefault(),a(!0),c(""),A.password!==A.confirmPassword){c("Las contraseas no coinciden"),a(!1);return}if(A.password.length<6){c("La contrasea debe tener al menos 6 caracteres"),a(!1);return}try{const w=await lR(Bc,A.email,A.password),C=await Rx(w.user,A.invitationCode);C.success?m("Registro exitoso! Bienvenido al sistema."):c(C.error)}catch(w){console.error("Error en registro:",w),c(W(w.code))}finally{a(!1)}},W=k=>{switch(k){case"auth/invalid-email":return"El formato del email es invlido";case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contrasea incorrecta";case"auth/invalid-credential":return"Email o contrasea incorrectos";case"auth/email-already-in-use":return"Este email ya est registrado";case"auth/weak-password":return"La contrasea es muy dbil";default:return"Error de autenticacin. Intntalo de nuevo."}},L=()=>{c(""),m(""),v(""),b(""),S(""),F(null),j({email:"",password:"",confirmPassword:"",invitationCode:""})},D=()=>{switch(n){case"login":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:Y,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email:"}),r.jsx("input",{id:"email",type:"email",value:p,onChange:k=>v(k.target.value),required:!0,disabled:t,placeholder:"tu-email@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Contrasea:"}),r.jsx("input",{id:"password",type:"password",value:_,onChange:k=>b(k.target.value),required:!0,disabled:t,placeholder:"Tu contrasea"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Iniciando sesin...":"Iniciar Sesin"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:V,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:""}),"Continuar con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{L(),e("invite")},children:"Tienes un cdigo de invitacin? Regstrate aqu"})})]});case"invite":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:O,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"inviteCode",children:"Cdigo de invitacin:"}),r.jsx("input",{id:"inviteCode",type:"text",value:T,onChange:k=>S(k.target.value.toUpperCase()),required:!0,disabled:t,placeholder:"XXXXXXXX",maxLength:8,style:{textTransform:"uppercase",fontFamily:"monospace"}}),r.jsx("small",{children:"Ingresa el cdigo de 8 caracteres que recibiste"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Validando...":"Validar Cdigo"})]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{L(),e("login")},children:"Volver al inicio de sesin"})})]});case"register":return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"invitation-info",children:r.jsxs("div",{className:"success-message",children:[" Cdigo vlido para: ",x?.targetEmail]})}),r.jsxs("form",{onSubmit:U,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerEmail",children:"Email:"}),r.jsx("input",{id:"registerEmail",type:"email",value:A.email,disabled:!0,className:"disabled-input"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerPassword",children:"Contrasea:"}),r.jsx("input",{id:"registerPassword",type:"password",value:A.password,onChange:k=>j({...A,password:k.target.value}),required:!0,disabled:t,placeholder:"Mnimo 6 caracteres",minLength:6})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar contrasea:"}),r.jsx("input",{id:"confirmPassword",type:"password",value:A.confirmPassword,onChange:k=>j({...A,confirmPassword:k.target.value}),required:!0,disabled:t,placeholder:"Repite tu contrasea"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Registrando...":"Crear Cuenta"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:V,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:""}),"Registrarse con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{L(),e("invite")},children:"Usar otro cdigo de invitacin"})})]});default:return null}};return r.jsx("div",{className:"auth-container",children:r.jsxs("div",{className:"auth-card",children:[r.jsxs("div",{className:"auth-header",children:[r.jsx("h1",{children:" Combustibles"}),r.jsx("h2",{children:"Forestech Colombia"}),r.jsxs("p",{children:[n==="login"&&"Sistema de gestin de combustibles",n==="invite"&&"Validar cdigo de invitacin",n==="register"&&"Crear nueva cuenta"]})]}),r.jsxs("div",{className:"auth-form",children:[o&&r.jsx("div",{className:"error-message",children:o}),d&&r.jsx("div",{className:"success-message",children:d}),D(),r.jsx("div",{className:"auth-footer",children:r.jsx("p",{children:r.jsxs("small",{children:["Solo usuarios autorizados pueden acceder al sistema.",r.jsx("br",{}),n==="login"?"Contacta al administrador para obtener un cdigo de invitacin.":"Si no tienes cdigo, contacta al administrador."]})})})]})]})})};function TV(){return r.jsx(bL,{children:r.jsx(AV,{})})}function AV(){const{user:n,loading:e}=Ts();return e?r.jsx("div",{className:"loading-container",children:r.jsxs("div",{className:"loader",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Cargando..."})]})}):r.jsxs("div",{className:"App",children:[!n&&r.jsx(xV,{}),n&&r.jsx(NV,{})]})}CC.createRoot(document.getElementById("root")).render(r.jsx($.StrictMode,{children:r.jsx(TV,{})}));
