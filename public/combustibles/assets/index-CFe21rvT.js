(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var jp={exports:{}},Ac={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pN;function TC(){if(pN)return Ac;pN=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var f in o)f!=="key"&&(c[f]=o[f])}else c=o;return o=c.ref,{$$typeof:n,type:i,key:d,ref:o!==void 0?o:null,props:c}}return Ac.Fragment=e,Ac.jsx=t,Ac.jsxs=t,Ac}var gN;function jC(){return gN||(gN=1,jp.exports=TC()),jp.exports}var a=jC(),Ap={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vN;function AC(){if(vN)return Le;vN=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.iterator;function _(B){return B===null||typeof B!="object"?null:(B=x&&B[x]||B["@@iterator"],typeof B=="function"?B:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,C={};function T(B,ee,le){this.props=B,this.context=ee,this.refs=C,this.updater=le||A}T.prototype.isReactComponent={},T.prototype.setState=function(B,ee){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,ee,"setState")},T.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function M(){}M.prototype=T.prototype;function q(B,ee,le){this.props=B,this.context=ee,this.refs=C,this.updater=le||A}var U=q.prototype=new M;U.constructor=q,N(U,T.prototype),U.isPureReactComponent=!0;var P=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},G=Object.prototype.hasOwnProperty;function V(B,ee,le,ce,_e,ze){return le=ze.ref,{$$typeof:n,type:B,key:ee,ref:le!==void 0?le:null,props:ze}}function S(B,ee){return V(B.type,ee,void 0,void 0,void 0,B.props)}function L(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function O(B){var ee={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(le){return ee[le]})}var w=/\/+/g;function I(B,ee){return typeof B=="object"&&B!==null&&B.key!=null?O(""+B.key):ee.toString(36)}function R(){}function de(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(R,R):(B.status="pending",B.then(function(ee){B.status==="pending"&&(B.status="fulfilled",B.value=ee)},function(ee){B.status==="pending"&&(B.status="rejected",B.reason=ee)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function be(B,ee,le,ce,_e){var ze=typeof B;(ze==="undefined"||ze==="boolean")&&(B=null);var Re=!1;if(B===null)Re=!0;else switch(ze){case"bigint":case"string":case"number":Re=!0;break;case"object":switch(B.$$typeof){case n:case e:Re=!0;break;case y:return Re=B._init,be(Re(B._payload),ee,le,ce,_e)}}if(Re)return _e=_e(B),Re=ce===""?"."+I(B,0):ce,P(_e)?(le="",Re!=null&&(le=Re.replace(w,"$&/")+"/"),be(_e,ee,le,"",function(As){return As})):_e!=null&&(L(_e)&&(_e=S(_e,le+(_e.key==null||B&&B.key===_e.key?"":(""+_e.key).replace(w,"$&/")+"/")+Re)),ee.push(_e)),1;Re=0;var Ht=ce===""?".":ce+":";if(P(B))for(var mt=0;mt<B.length;mt++)ce=B[mt],ze=Ht+I(ce,mt),Re+=be(ce,ee,le,ze,_e);else if(mt=_(B),typeof mt=="function")for(B=mt.call(B),mt=0;!(ce=B.next()).done;)ce=ce.value,ze=Ht+I(ce,mt++),Re+=be(ce,ee,le,ze,_e);else if(ze==="object"){if(typeof B.then=="function")return be(de(B),ee,le,ce,_e);throw ee=String(B),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return Re}function Q(B,ee,le){if(B==null)return B;var ce=[],_e=0;return be(B,ce,"","",function(ze){return ee.call(le,ze,_e++)}),ce}function se(B){if(B._status===-1){var ee=B._result;ee=ee(),ee.then(function(le){(B._status===0||B._status===-1)&&(B._status=1,B._result=le)},function(le){(B._status===0||B._status===-1)&&(B._status=2,B._result=le)}),B._status===-1&&(B._status=0,B._result=ee)}if(B._status===1)return B._result.default;throw B._result}var fe=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)};function ke(){}return Le.Children={map:Q,forEach:function(B,ee,le){Q(B,function(){ee.apply(this,arguments)},le)},count:function(B){var ee=0;return Q(B,function(){ee++}),ee},toArray:function(B){return Q(B,function(ee){return ee})||[]},only:function(B){if(!L(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},Le.Component=T,Le.Fragment=t,Le.Profiler=o,Le.PureComponent=q,Le.StrictMode=i,Le.Suspense=p,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Le.__COMPILER_RUNTIME={__proto__:null,c:function(B){return F.H.useMemoCache(B)}},Le.cache=function(B){return function(){return B.apply(null,arguments)}},Le.cloneElement=function(B,ee,le){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var ce=N({},B.props),_e=B.key,ze=void 0;if(ee!=null)for(Re in ee.ref!==void 0&&(ze=void 0),ee.key!==void 0&&(_e=""+ee.key),ee)!G.call(ee,Re)||Re==="key"||Re==="__self"||Re==="__source"||Re==="ref"&&ee.ref===void 0||(ce[Re]=ee[Re]);var Re=arguments.length-2;if(Re===1)ce.children=le;else if(1<Re){for(var Ht=Array(Re),mt=0;mt<Re;mt++)Ht[mt]=arguments[mt+2];ce.children=Ht}return V(B.type,_e,void 0,void 0,ze,ce)},Le.createContext=function(B){return B={$$typeof:d,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:c,_context:B},B},Le.createElement=function(B,ee,le){var ce,_e={},ze=null;if(ee!=null)for(ce in ee.key!==void 0&&(ze=""+ee.key),ee)G.call(ee,ce)&&ce!=="key"&&ce!=="__self"&&ce!=="__source"&&(_e[ce]=ee[ce]);var Re=arguments.length-2;if(Re===1)_e.children=le;else if(1<Re){for(var Ht=Array(Re),mt=0;mt<Re;mt++)Ht[mt]=arguments[mt+2];_e.children=Ht}if(B&&B.defaultProps)for(ce in Re=B.defaultProps,Re)_e[ce]===void 0&&(_e[ce]=Re[ce]);return V(B,ze,void 0,void 0,null,_e)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(B){return{$$typeof:f,render:B}},Le.isValidElement=L,Le.lazy=function(B){return{$$typeof:y,_payload:{_status:-1,_result:B},_init:se}},Le.memo=function(B,ee){return{$$typeof:g,type:B,compare:ee===void 0?null:ee}},Le.startTransition=function(B){var ee=F.T,le={};F.T=le;try{var ce=B(),_e=F.S;_e!==null&&_e(le,ce),typeof ce=="object"&&ce!==null&&typeof ce.then=="function"&&ce.then(ke,fe)}catch(ze){fe(ze)}finally{F.T=ee}},Le.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Le.use=function(B){return F.H.use(B)},Le.useActionState=function(B,ee,le){return F.H.useActionState(B,ee,le)},Le.useCallback=function(B,ee){return F.H.useCallback(B,ee)},Le.useContext=function(B){return F.H.useContext(B)},Le.useDebugValue=function(){},Le.useDeferredValue=function(B,ee){return F.H.useDeferredValue(B,ee)},Le.useEffect=function(B,ee,le){var ce=F.H;if(typeof le=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ce.useEffect(B,ee)},Le.useId=function(){return F.H.useId()},Le.useImperativeHandle=function(B,ee,le){return F.H.useImperativeHandle(B,ee,le)},Le.useInsertionEffect=function(B,ee){return F.H.useInsertionEffect(B,ee)},Le.useLayoutEffect=function(B,ee){return F.H.useLayoutEffect(B,ee)},Le.useMemo=function(B,ee){return F.H.useMemo(B,ee)},Le.useOptimistic=function(B,ee){return F.H.useOptimistic(B,ee)},Le.useReducer=function(B,ee,le){return F.H.useReducer(B,ee,le)},Le.useRef=function(B){return F.H.useRef(B)},Le.useState=function(B){return F.H.useState(B)},Le.useSyncExternalStore=function(B,ee,le){return F.H.useSyncExternalStore(B,ee,le)},Le.useTransition=function(){return F.H.useTransition()},Le.version="19.1.0",Le}var yN;function Ig(){return yN||(yN=1,Ap.exports=AC()),Ap.exports}var $=Ig(),wp={exports:{}},wc={},Cp={exports:{}},Sp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bN;function wC(){return bN||(bN=1,function(n){function e(Q,se){var fe=Q.length;Q.push(se);e:for(;0<fe;){var ke=fe-1>>>1,B=Q[ke];if(0<o(B,se))Q[ke]=se,Q[fe]=B,fe=ke;else break e}}function t(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var se=Q[0],fe=Q.pop();if(fe!==se){Q[0]=fe;e:for(var ke=0,B=Q.length,ee=B>>>1;ke<ee;){var le=2*(ke+1)-1,ce=Q[le],_e=le+1,ze=Q[_e];if(0>o(ce,fe))_e<B&&0>o(ze,ce)?(Q[ke]=ze,Q[_e]=fe,ke=_e):(Q[ke]=ce,Q[le]=fe,ke=le);else if(_e<B&&0>o(ze,fe))Q[ke]=ze,Q[_e]=fe,ke=_e;else break e}}return se}function o(Q,se){var fe=Q.sortIndex-se.sortIndex;return fe!==0?fe:Q.id-se.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var p=[],g=[],y=1,x=null,_=3,A=!1,N=!1,C=!1,T=!1,M=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;function P(Q){for(var se=t(g);se!==null;){if(se.callback===null)i(g);else if(se.startTime<=Q)i(g),se.sortIndex=se.expirationTime,e(p,se);else break;se=t(g)}}function F(Q){if(C=!1,P(Q),!N)if(t(p)!==null)N=!0,G||(G=!0,I());else{var se=t(g);se!==null&&be(F,se.startTime-Q)}}var G=!1,V=-1,S=5,L=-1;function O(){return T?!0:!(n.unstable_now()-L<S)}function w(){if(T=!1,G){var Q=n.unstable_now();L=Q;var se=!0;try{e:{N=!1,C&&(C=!1,q(V),V=-1),A=!0;var fe=_;try{t:{for(P(Q),x=t(p);x!==null&&!(x.expirationTime>Q&&O());){var ke=x.callback;if(typeof ke=="function"){x.callback=null,_=x.priorityLevel;var B=ke(x.expirationTime<=Q);if(Q=n.unstable_now(),typeof B=="function"){x.callback=B,P(Q),se=!0;break t}x===t(p)&&i(p),P(Q)}else i(p);x=t(p)}if(x!==null)se=!0;else{var ee=t(g);ee!==null&&be(F,ee.startTime-Q),se=!1}}break e}finally{x=null,_=fe,A=!1}se=void 0}}finally{se?I():G=!1}}}var I;if(typeof U=="function")I=function(){U(w)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,de=R.port2;R.port1.onmessage=w,I=function(){de.postMessage(null)}}else I=function(){M(w,0)};function be(Q,se){V=M(function(){Q(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_next=function(Q){switch(_){case 1:case 2:case 3:var se=3;break;default:se=_}var fe=_;_=se;try{return Q()}finally{_=fe}},n.unstable_requestPaint=function(){T=!0},n.unstable_runWithPriority=function(Q,se){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var fe=_;_=Q;try{return se()}finally{_=fe}},n.unstable_scheduleCallback=function(Q,se,fe){var ke=n.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?ke+fe:ke):fe=ke,Q){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=fe+B,Q={id:y++,callback:se,priorityLevel:Q,startTime:fe,expirationTime:B,sortIndex:-1},fe>ke?(Q.sortIndex=fe,e(g,Q),t(p)===null&&Q===t(g)&&(C?(q(V),V=-1):C=!0,be(F,fe-ke))):(Q.sortIndex=B,e(p,Q),N||A||(N=!0,G||(G=!0,I()))),Q},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(Q){var se=_;return function(){var fe=_;_=se;try{return Q.apply(this,arguments)}finally{_=fe}}}}(Sp)),Sp}var xN;function CC(){return xN||(xN=1,Cp.exports=wC()),Cp.exports}var Ip={exports:{}},dn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NN;function SC(){if(NN)return dn;NN=1;var n=Ig();function e(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)g+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,g,y){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:x==null?null:""+x,children:p,containerInfo:g,implementation:y}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,dn.createPortal=function(p,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return c(p,g,null,y)},dn.flushSync=function(p){var g=d.T,y=i.p;try{if(d.T=null,i.p=2,p)return p()}finally{d.T=g,i.p=y,i.d.f()}},dn.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(p,g))},dn.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},dn.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var y=g.as,x=f(y,g.crossOrigin),_=typeof g.integrity=="string"?g.integrity:void 0,A=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;y==="style"?i.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:x,integrity:_,fetchPriority:A}):y==="script"&&i.d.X(p,{crossOrigin:x,integrity:_,fetchPriority:A,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},dn.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var y=f(g.as,g.crossOrigin);i.d.M(p,{crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(p)},dn.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var y=g.as,x=f(y,g.crossOrigin);i.d.L(p,y,{crossOrigin:x,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},dn.preloadModule=function(p,g){if(typeof p=="string")if(g){var y=f(g.as,g.crossOrigin);i.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(p)},dn.requestFormReset=function(p){i.d.r(p)},dn.unstable_batchedUpdates=function(p,g){return p(g)},dn.useFormState=function(p,g,y){return d.H.useFormState(p,g,y)},dn.useFormStatus=function(){return d.H.useHostTransitionStatus()},dn.version="19.1.0",dn}var _N;function IC(){if(_N)return Ip.exports;_N=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ip.exports=SC(),Ip.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EN;function RC(){if(EN)return wc;EN=1;var n=CC(),e=Ig(),t=IC();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var r=s,l=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(l=r.return),s=r.return;while(s)}return r.tag===3?l:null}function d(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function f(s){if(c(s)!==s)throw Error(i(188))}function p(s){var r=s.alternate;if(!r){if(r=c(s),r===null)throw Error(i(188));return r!==s?null:s}for(var l=s,u=r;;){var m=l.return;if(m===null)break;var v=m.alternate;if(v===null){if(u=m.return,u!==null){l=u;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===l)return f(m),s;if(v===u)return f(m),r;v=v.sibling}throw Error(i(188))}if(l.return!==u.return)l=m,u=v;else{for(var j=!1,D=m.child;D;){if(D===l){j=!0,l=m,u=v;break}if(D===u){j=!0,u=m,l=v;break}D=D.sibling}if(!j){for(D=v.child;D;){if(D===l){j=!0,l=v,u=m;break}if(D===u){j=!0,u=v,l=m;break}D=D.sibling}if(!j)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:r}function g(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=g(s),r!==null)return r;s=s.sibling}return null}var y=Object.assign,x=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),q=Symbol.for("react.consumer"),U=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),w=Symbol.iterator;function I(s){return s===null||typeof s!="object"?null:(s=w&&s[w]||s["@@iterator"],typeof s=="function"?s:null)}var R=Symbol.for("react.client.reference");function de(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===R?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case N:return"Fragment";case T:return"Profiler";case C:return"StrictMode";case F:return"Suspense";case G:return"SuspenseList";case L:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case A:return"Portal";case U:return(s.displayName||"Context")+".Provider";case q:return(s._context.displayName||"Context")+".Consumer";case P:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case V:return r=s.displayName||null,r!==null?r:de(s.type)||"Memo";case S:r=s._payload,s=s._init;try{return de(s(r))}catch{}}return null}var be=Array.isArray,Q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe={pending:!1,data:null,method:null,action:null},ke=[],B=-1;function ee(s){return{current:s}}function le(s){0>B||(s.current=ke[B],ke[B]=null,B--)}function ce(s,r){B++,ke[B]=s.current,s.current=r}var _e=ee(null),ze=ee(null),Re=ee(null),Ht=ee(null);function mt(s,r){switch(ce(Re,r),ce(ze,s),ce(_e,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?Bx(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=Bx(r),s=Hx(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}le(_e),ce(_e,s)}function As(){le(_e),le(ze),le(Re)}function La(s){s.memoizedState!==null&&ce(Ht,s);var r=_e.current,l=Hx(r,s.type);r!==l&&(ce(ze,s),ce(_e,l))}function ea(s){ze.current===s&&(le(_e),le(ze)),Ht.current===s&&(le(Ht),Nc._currentValue=fe)}var qi=Object.prototype.hasOwnProperty,zi=n.unstable_scheduleCallback,Bi=n.unstable_cancelCallback,yl=n.unstable_shouldYield,Au=n.unstable_requestPaint,Yn=n.unstable_now,jf=n.unstable_getCurrentPriorityLevel,bl=n.unstable_ImmediatePriority,Br=n.unstable_UserBlockingPriority,Hi=n.unstable_NormalPriority,Af=n.unstable_LowPriority,Hr=n.unstable_IdlePriority,xl=n.log,wu=n.unstable_setDisableYieldValue,Et=null,st=null;function Mn(s){if(typeof xl=="function"&&wu(s),st&&typeof st.setStrictMode=="function")try{st.setStrictMode(Et,s)}catch{}}var cn=Math.clz32?Math.clz32:Gi,Cu=Math.log,wf=Math.LN2;function Gi(s){return s>>>=0,s===0?32:31-(Cu(s)/wf|0)|0}var $i=256,Yi=4194304;function hs(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Gr(s,r,l){var u=s.pendingLanes;if(u===0)return 0;var m=0,v=s.suspendedLanes,j=s.pingedLanes;s=s.warmLanes;var D=u&134217727;return D!==0?(u=D&~v,u!==0?m=hs(u):(j&=D,j!==0?m=hs(j):l||(l=D&~s,l!==0&&(m=hs(l))))):(D=u&~v,D!==0?m=hs(D):j!==0?m=hs(j):l||(l=u&~s,l!==0&&(m=hs(l)))),m===0?0:r!==0&&r!==m&&(r&v)===0&&(v=m&-m,l=r&-r,v>=l||v===32&&(l&4194048)!==0)?r:m}function Qi(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function Nl(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _l(){var s=$i;return $i<<=1,($i&4194048)===0&&($i=256),s}function El(){var s=Yi;return Yi<<=1,(Yi&62914560)===0&&(Yi=4194304),s}function ta(s){for(var r=[],l=0;31>l;l++)r.push(s);return r}function na(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Tl(s,r,l,u,m,v){var j=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var D=s.entanglements,z=s.expirationTimes,W=s.hiddenUpdates;for(l=j&~l;0<l;){var ne=31-cn(l),re=1<<ne;D[ne]=0,z[ne]=-1;var Z=W[ne];if(Z!==null)for(W[ne]=null,ne=0;ne<Z.length;ne++){var J=Z[ne];J!==null&&(J.lane&=-536870913)}l&=~re}u!==0&&ws(s,u,0),v!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=v&~(j&~r))}function ws(s,r,l){s.pendingLanes|=r,s.suspendedLanes&=~r;var u=31-cn(r);s.entangledLanes|=r,s.entanglements[u]=s.entanglements[u]|1073741824|l&4194090}function jl(s,r){var l=s.entangledLanes|=r;for(s=s.entanglements;l;){var u=31-cn(l),m=1<<u;m&r|s[u]&r&&(s[u]|=r),l&=~m}}function Va(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function $r(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ua(){var s=se.p;return s!==0?s:(s=window.event,s===void 0?32:cN(s.type))}function Su(s,r){var l=se.p;try{return se.p=s,r()}finally{se.p=l}}var bt=Math.random().toString(36).slice(2),Pt="__reactFiber$"+bt,It="__reactProps$"+bt,Qn="__reactContainer$"+bt,Al="__reactEvents$"+bt,Cf="__reactListeners$"+bt,Fa="__reactHandles$"+bt,Iu="__reactResources$"+bt,Ki="__reactMarker$"+bt;function qa(s){delete s[Pt],delete s[It],delete s[Al],delete s[Cf],delete s[Fa]}function sa(s){var r=s[Pt];if(r)return r;for(var l=s.parentNode;l;){if(r=l[Qn]||l[Pt]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(s=Qx(s);s!==null;){if(l=s[Pt])return l;s=Qx(s)}return r}s=l,l=s.parentNode}return null}function Cs(s){if(s=s[Pt]||s[Qn]){var r=s.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return s}return null}function Ss(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function vn(s){var r=s[Iu];return r||(r=s[Iu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function At(s){s[Ki]=!0}var wl=new Set,Yr={};function fs(s,r){aa(s,r),aa(s+"Capture",r)}function aa(s,r){for(Yr[s]=r,s=0;s<r.length;s++)wl.add(r[s])}var Ru=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Du={},Xi={};function Mu(s){return qi.call(Xi,s)?!0:qi.call(Du,s)?!1:Ru.test(s)?Xi[s]=!0:(Du[s]=!0,!1)}function za(s,r,l){if(Mu(r))if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+l)}}function Is(s,r,l){if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+l)}}function Zt(s,r,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(r,l,""+u)}}var Wi,Ou;function ia(s){if(Wi===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);Wi=r&&r[1]||"",Ou=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Wi+s+Ou}var Qr=!1;function Kr(s,r){if(!s||Qr)return"";Qr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(J){var Z=J}Reflect.construct(s,[],re)}else{try{re.call()}catch(J){Z=J}s.call(re.prototype)}}else{try{throw Error()}catch(J){Z=J}(re=s())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(J){if(J&&Z&&typeof J.stack=="string")return[J.stack,Z.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=u.DetermineComponentFrameRoot(),j=v[0],D=v[1];if(j&&D){var z=j.split(`
`),W=D.split(`
`);for(m=u=0;u<z.length&&!z[u].includes("DetermineComponentFrameRoot");)u++;for(;m<W.length&&!W[m].includes("DetermineComponentFrameRoot");)m++;if(u===z.length||m===W.length)for(u=z.length-1,m=W.length-1;1<=u&&0<=m&&z[u]!==W[m];)m--;for(;1<=u&&0<=m;u--,m--)if(z[u]!==W[m]){if(u!==1||m!==1)do if(u--,m--,0>m||z[u]!==W[m]){var ne=`
`+z[u].replace(" at new "," at ");return s.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",s.displayName)),ne}while(1<=u&&0<=m);break}}}finally{Qr=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?ia(l):""}function Cl(s){switch(s.tag){case 26:case 27:case 5:return ia(s.type);case 16:return ia("Lazy");case 13:return ia("Suspense");case 19:return ia("SuspenseList");case 0:case 15:return Kr(s.type,!1);case 11:return Kr(s.type.render,!1);case 1:return Kr(s.type,!0);case 31:return ia("Activity");default:return""}}function Xr(s){try{var r="";do r+=Cl(s),s=s.return;while(s);return r}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function yn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Sl(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Sf(s){var r=Sl(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,r),u=""+s[r];if(!s.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,v=l.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return m.call(this)},set:function(j){u=""+j,v.call(this,j)}}),Object.defineProperty(s,r,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(j){u=""+j},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function Wr(s){s._valueTracker||(s._valueTracker=Sf(s))}function Il(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var l=r.getValue(),u="";return s&&(u=Sl(s)?s.checked?"true":"false":s.value),s=u,s!==l?(r.setValue(s),!0):!1}function Zi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var If=/[\n"\\]/g;function Rt(s){return s.replace(If,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function On(s,r,l,u,m,v,j,D){s.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?s.type=j:s.removeAttribute("type"),r!=null?j==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+yn(r)):s.value!==""+yn(r)&&(s.value=""+yn(r)):j!=="submit"&&j!=="reset"||s.removeAttribute("value"),r!=null?Ba(s,j,yn(r)):l!=null?Ba(s,j,yn(l)):u!=null&&s.removeAttribute("value"),m==null&&v!=null&&(s.defaultChecked=!!v),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?s.name=""+yn(D):s.removeAttribute("name")}function Ji(s,r,l,u,m,v,j,D){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),r!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||r!=null))return;l=l!=null?""+yn(l):"",r=r!=null?""+yn(r):l,D||r===s.value||(s.value=r),s.defaultValue=r}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=D?s.checked:!!u,s.defaultChecked=!!u,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(s.name=j)}function Ba(s,r,l){r==="number"&&Zi(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function ra(s,r,l,u){if(s=s.options,r){r={};for(var m=0;m<l.length;m++)r["$"+l[m]]=!0;for(l=0;l<s.length;l++)m=r.hasOwnProperty("$"+s[l].value),s[l].selected!==m&&(s[l].selected=m),m&&u&&(s[l].defaultSelected=!0)}else{for(l=""+yn(l),r=null,m=0;m<s.length;m++){if(s[m].value===l){s[m].selected=!0,u&&(s[m].defaultSelected=!0);return}r!==null||s[m].disabled||(r=s[m])}r!==null&&(r.selected=!0)}}function rt(s,r,l){if(r!=null&&(r=""+yn(r),r!==s.value&&(s.value=r),l==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=l!=null?""+yn(l):""}function er(s,r,l,u){if(r==null){if(u!=null){if(l!=null)throw Error(i(92));if(be(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),r=l}l=yn(r),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u)}function Kn(s,r){if(r){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=r;return}}s.textContent=r}var tr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ku(s,r,l){var u=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":u?s.setProperty(r,l):typeof l!="number"||l===0||tr.has(r)?r==="float"?s.cssFloat=l:s[r]=(""+l).trim():s[r]=l+"px"}function Rl(s,r,l){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var m in r)u=r[m],r.hasOwnProperty(m)&&l[m]!==u&&ku(s,m,u)}else for(var v in r)r.hasOwnProperty(v)&&ku(s,v,r[v])}function Dl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Df=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zr(s){return Df.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var oa=null;function Xn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var la=null,ca=null;function Ml(s){var r=Cs(s);if(r&&(s=r.stateNode)){var l=s[It]||null;e:switch(s=r.stateNode,r.type){case"input":if(On(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Rt(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var u=l[r];if(u!==s&&u.form===s.form){var m=u[It]||null;if(!m)throw Error(i(90));On(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(r=0;r<l.length;r++)u=l[r],u.form===s.form&&Il(u)}break e;case"textarea":rt(s,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&ra(s,!!l.multiple,r,!1)}}}var Rs=!1;function Pu(s,r,l){if(Rs)return s(r,l);Rs=!0;try{var u=s(r);return u}finally{if(Rs=!1,(la!==null||ca!==null)&&(Sd(),la&&(r=la,s=ca,ca=la=null,Ml(r),s)))for(r=0;r<s.length;r++)Ml(s[r])}}function nr(s,r){var l=s.stateNode;if(l===null)return null;var u=l[It]||null;if(u===null)return null;l=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wn=!1;if(ms)try{var sr={};Object.defineProperty(sr,"passive",{get:function(){Wn=!0}}),window.addEventListener("test",sr,sr),window.removeEventListener("test",sr,sr)}catch{Wn=!1}var Ds=null,Ha=null,ua=null;function Ol(){if(ua)return ua;var s,r=Ha,l=r.length,u,m="value"in Ds?Ds.value:Ds.textContent,v=m.length;for(s=0;s<l&&r[s]===m[s];s++);var j=l-s;for(u=1;u<=j&&r[l-u]===m[v-u];u++);return ua=m.slice(s,1<u?1-u:void 0)}function Ms(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function Os(){return!0}function kl(){return!1}function Gt(s){function r(l,u,m,v,j){this._reactName=l,this._targetInst=m,this.type=u,this.nativeEvent=v,this.target=j,this.currentTarget=null;for(var D in s)s.hasOwnProperty(D)&&(l=s[D],this[D]=l?l(v):v[D]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Os:kl,this.isPropagationStopped=kl,this}return y(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Os)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Os)},persist:function(){},isPersistent:Os}),r}var nt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jr=Gt(nt),ar=y({},nt,{view:0,detail:0}),Lu=Gt(ar),eo,to,ks,ir=y({},ar,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ks&&(ks&&s.type==="mousemove"?(eo=s.screenX-ks.screenX,to=s.screenY-ks.screenY):to=eo=0,ks=s),eo)},movementY:function(s){return"movementY"in s?s.movementY:to}}),Zn=Gt(ir),Vu=y({},ir,{dataTransfer:0}),Mf=Gt(Vu),rr=y({},ar,{relatedTarget:0}),no=Gt(rr),Pl=y({},nt,{animationName:0,elapsedTime:0,pseudoElement:0}),so=Gt(Pl),Uu=y({},nt,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ao=Gt(Uu),Of=y({},nt,{data:0}),Ll=Gt(Of),or={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vl(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=qu[s])?!!r[s]:!1}function lr(){return Vl}var zu=y({},ar,{key:function(s){if(s.key){var r=or[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Ms(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Fu[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lr,charCode:function(s){return s.type==="keypress"?Ms(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ms(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),io=Gt(zu),Bu=y({},ir,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ul=Gt(Bu),da=y({},ar,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lr}),Hu=Gt(da),Gu=y({},nt,{propertyName:0,elapsedTime:0,pseudoElement:0}),$u=Gt(Gu),Yu=y({},ir,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ro=Gt(Yu),bn=y({},nt,{newState:0,oldState:0}),Qu=Gt(bn),Ku=[9,13,27,32],Ps=ms&&"CompositionEvent"in window,h=null;ms&&"documentMode"in document&&(h=document.documentMode);var b=ms&&"TextEvent"in window&&!h,E=ms&&(!Ps||h&&8<h&&11>=h),k=" ",K=!1;function te(s,r){switch(s){case"keyup":return Ku.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Qe=!1;function Lt(s,r){switch(s){case"compositionend":return he(r);case"keypress":return r.which!==32?null:(K=!0,k);case"textInput":return s=r.data,s===k&&K?null:s;default:return null}}function Ke(s,r){if(Qe)return s==="compositionend"||!Ps&&te(s,r)?(s=Ol(),ua=Ha=Ds=null,Qe=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return E&&r.locale!=="ko"?null:r.data;default:return null}}var $t={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vt(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!$t[s.type]:r==="textarea"}function ha(s,r,l,u){la?ca?ca.push(u):ca=[u]:la=u,r=kd(r,"onChange"),0<r.length&&(l=new Jr("onChange","change",null,l,u),s.push({event:l,listeners:r}))}var Jt=null,Ls=null;function Fl(s){Vx(s,0)}function Xu(s){var r=Ss(s);if(Il(r))return s}function iy(s,r){if(s==="change")return r}var ry=!1;if(ms){var kf;if(ms){var Pf="oninput"in document;if(!Pf){var oy=document.createElement("div");oy.setAttribute("oninput","return;"),Pf=typeof oy.oninput=="function"}kf=Pf}else kf=!1;ry=kf&&(!document.documentMode||9<document.documentMode)}function ly(){Jt&&(Jt.detachEvent("onpropertychange",cy),Ls=Jt=null)}function cy(s){if(s.propertyName==="value"&&Xu(Ls)){var r=[];ha(r,Ls,s,Xn(s)),Pu(Fl,r)}}function ew(s,r,l){s==="focusin"?(ly(),Jt=r,Ls=l,Jt.attachEvent("onpropertychange",cy)):s==="focusout"&&ly()}function tw(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Xu(Ls)}function nw(s,r){if(s==="click")return Xu(r)}function sw(s,r){if(s==="input"||s==="change")return Xu(r)}function aw(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var kn=typeof Object.is=="function"?Object.is:aw;function ql(s,r){if(kn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var l=Object.keys(s),u=Object.keys(r);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var m=l[u];if(!qi.call(r,m)||!kn(s[m],r[m]))return!1}return!0}function uy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function dy(s,r){var l=uy(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=r&&u>=r)return{node:l,offset:r-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=uy(l)}}function hy(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?hy(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function fy(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Zi(s.document);r instanceof s.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)s=r.contentWindow;else break;r=Zi(s.document)}return r}function Lf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var iw=ms&&"documentMode"in document&&11>=document.documentMode,oo=null,Vf=null,zl=null,Uf=!1;function my(s,r,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Uf||oo==null||oo!==Zi(u)||(u=oo,"selectionStart"in u&&Lf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),zl&&ql(zl,u)||(zl=u,u=kd(Vf,"onSelect"),0<u.length&&(r=new Jr("onSelect","select",null,r,l),s.push({event:r,listeners:u}),r.target=oo)))}function cr(s,r){var l={};return l[s.toLowerCase()]=r.toLowerCase(),l["Webkit"+s]="webkit"+r,l["Moz"+s]="moz"+r,l}var lo={animationend:cr("Animation","AnimationEnd"),animationiteration:cr("Animation","AnimationIteration"),animationstart:cr("Animation","AnimationStart"),transitionrun:cr("Transition","TransitionRun"),transitionstart:cr("Transition","TransitionStart"),transitioncancel:cr("Transition","TransitionCancel"),transitionend:cr("Transition","TransitionEnd")},Ff={},py={};ms&&(py=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function ur(s){if(Ff[s])return Ff[s];if(!lo[s])return s;var r=lo[s],l;for(l in r)if(r.hasOwnProperty(l)&&l in py)return Ff[s]=r[l];return s}var gy=ur("animationend"),vy=ur("animationiteration"),yy=ur("animationstart"),rw=ur("transitionrun"),ow=ur("transitionstart"),lw=ur("transitioncancel"),by=ur("transitionend"),xy=new Map,qf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");qf.push("scrollEnd");function ps(s,r){xy.set(s,r),fs(r,[s])}var Ny=new WeakMap;function Jn(s,r){if(typeof s=="object"&&s!==null){var l=Ny.get(s);return l!==void 0?l:(r={value:s,source:r,stack:Xr(r)},Ny.set(s,r),r)}return{value:s,source:r,stack:Xr(r)}}var es=[],co=0,zf=0;function Wu(){for(var s=co,r=zf=co=0;r<s;){var l=es[r];es[r++]=null;var u=es[r];es[r++]=null;var m=es[r];es[r++]=null;var v=es[r];if(es[r++]=null,u!==null&&m!==null){var j=u.pending;j===null?m.next=m:(m.next=j.next,j.next=m),u.pending=m}v!==0&&_y(l,m,v)}}function Zu(s,r,l,u){es[co++]=s,es[co++]=r,es[co++]=l,es[co++]=u,zf|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function Bf(s,r,l,u){return Zu(s,r,l,u),Ju(s)}function uo(s,r){return Zu(s,null,null,r),Ju(s)}function _y(s,r,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var m=!1,v=s.return;v!==null;)v.childLanes|=l,u=v.alternate,u!==null&&(u.childLanes|=l),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(m=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,m&&r!==null&&(m=31-cn(l),s=v.hiddenUpdates,u=s[m],u===null?s[m]=[r]:u.push(r),r.lane=l|536870912),v):null}function Ju(s){if(50<fc)throw fc=0,Km=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var ho={};function cw(s,r,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(s,r,l,u){return new cw(s,r,l,u)}function Hf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function fa(s,r){var l=s.alternate;return l===null?(l=Pn(s.tag,r,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=r,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,r=s.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Ey(s,r){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,r=l.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function ed(s,r,l,u,m,v){var j=0;if(u=s,typeof s=="function")Hf(s)&&(j=1);else if(typeof s=="string")j=dC(s,l,_e.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case L:return s=Pn(31,l,r,m),s.elementType=L,s.lanes=v,s;case N:return dr(l.children,m,v,r);case C:j=8,m|=24;break;case T:return s=Pn(12,l,r,m|2),s.elementType=T,s.lanes=v,s;case F:return s=Pn(13,l,r,m),s.elementType=F,s.lanes=v,s;case G:return s=Pn(19,l,r,m),s.elementType=G,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case M:case U:j=10;break e;case q:j=9;break e;case P:j=11;break e;case V:j=14;break e;case S:j=16,u=null;break e}j=29,l=Error(i(130,s===null?"null":typeof s,"")),u=null}return r=Pn(j,l,r,m),r.elementType=s,r.type=u,r.lanes=v,r}function dr(s,r,l,u){return s=Pn(7,s,u,r),s.lanes=l,s}function Gf(s,r,l){return s=Pn(6,s,null,r),s.lanes=l,s}function $f(s,r,l){return r=Pn(4,s.children!==null?s.children:[],s.key,r),r.lanes=l,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var fo=[],mo=0,td=null,nd=0,ts=[],ns=0,hr=null,ma=1,pa="";function fr(s,r){fo[mo++]=nd,fo[mo++]=td,td=s,nd=r}function Ty(s,r,l){ts[ns++]=ma,ts[ns++]=pa,ts[ns++]=hr,hr=s;var u=ma;s=pa;var m=32-cn(u)-1;u&=~(1<<m),l+=1;var v=32-cn(r)+m;if(30<v){var j=m-m%5;v=(u&(1<<j)-1).toString(32),u>>=j,m-=j,ma=1<<32-cn(r)+m|l<<m|u,pa=v+s}else ma=1<<v|l<<m|u,pa=s}function Yf(s){s.return!==null&&(fr(s,1),Ty(s,1,0))}function Qf(s){for(;s===td;)td=fo[--mo],fo[mo]=null,nd=fo[--mo],fo[mo]=null;for(;s===hr;)hr=ts[--ns],ts[ns]=null,pa=ts[--ns],ts[ns]=null,ma=ts[--ns],ts[ns]=null}var xn=null,Tt=null,tt=!1,mr=null,Vs=!1,Kf=Error(i(519));function pr(s){var r=Error(i(418,""));throw Gl(Jn(r,s)),Kf}function jy(s){var r=s.stateNode,l=s.type,u=s.memoizedProps;switch(r[Pt]=s,r[It]=u,l){case"dialog":Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":case"embed":Ge("load",r);break;case"video":case"audio":for(l=0;l<pc.length;l++)Ge(pc[l],r);break;case"source":Ge("error",r);break;case"img":case"image":case"link":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"input":Ge("invalid",r),Ji(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Wr(r);break;case"select":Ge("invalid",r);break;case"textarea":Ge("invalid",r),er(r,u.value,u.defaultValue,u.children),Wr(r)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||u.suppressHydrationWarning===!0||zx(r.textContent,l)?(u.popover!=null&&(Ge("beforetoggle",r),Ge("toggle",r)),u.onScroll!=null&&Ge("scroll",r),u.onScrollEnd!=null&&Ge("scrollend",r),u.onClick!=null&&(r.onclick=Pd),r=!0):r=!1,r||pr(s)}function Ay(s){for(xn=s.return;xn;)switch(xn.tag){case 5:case 13:Vs=!1;return;case 27:case 3:Vs=!0;return;default:xn=xn.return}}function Bl(s){if(s!==xn)return!1;if(!tt)return Ay(s),tt=!0,!1;var r=s.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||dp(s.type,s.memoizedProps)),l=!l),l&&Tt&&pr(s),Ay(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));e:{for(s=s.nextSibling,r=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(r===0){Tt=vs(s.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++;s=s.nextSibling}Tt=null}}else r===27?(r=Tt,ri(s.type)?(s=pp,pp=null,Tt=s):Tt=r):Tt=xn?vs(s.stateNode.nextSibling):null;return!0}function Hl(){Tt=xn=null,tt=!1}function wy(){var s=mr;return s!==null&&(Cn===null?Cn=s:Cn.push.apply(Cn,s),mr=null),s}function Gl(s){mr===null?mr=[s]:mr.push(s)}var Xf=ee(null),gr=null,ga=null;function Ga(s,r,l){ce(Xf,r._currentValue),r._currentValue=l}function va(s){s._currentValue=Xf.current,le(Xf)}function Wf(s,r,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),s===l)break;s=s.return}}function Zf(s,r,l,u){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var v=m.dependencies;if(v!==null){var j=m.child;v=v.firstContext;e:for(;v!==null;){var D=v;v=m;for(var z=0;z<r.length;z++)if(D.context===r[z]){v.lanes|=l,D=v.alternate,D!==null&&(D.lanes|=l),Wf(v.return,l,s),u||(j=null);break e}v=D.next}}else if(m.tag===18){if(j=m.return,j===null)throw Error(i(341));j.lanes|=l,v=j.alternate,v!==null&&(v.lanes|=l),Wf(j,l,s),j=null}else j=m.child;if(j!==null)j.return=m;else for(j=m;j!==null;){if(j===s){j=null;break}if(m=j.sibling,m!==null){m.return=j.return,j=m;break}j=j.return}m=j}}function $l(s,r,l,u){s=null;for(var m=r,v=!1;m!==null;){if(!v){if((m.flags&524288)!==0)v=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var j=m.alternate;if(j===null)throw Error(i(387));if(j=j.memoizedProps,j!==null){var D=m.type;kn(m.pendingProps.value,j.value)||(s!==null?s.push(D):s=[D])}}else if(m===Ht.current){if(j=m.alternate,j===null)throw Error(i(387));j.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Nc):s=[Nc])}m=m.return}s!==null&&Zf(r,s,l,u),r.flags|=262144}function sd(s){for(s=s.firstContext;s!==null;){if(!kn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function vr(s){gr=s,ga=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function un(s){return Cy(gr,s)}function ad(s,r){return gr===null&&vr(s),Cy(s,r)}function Cy(s,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},ga===null){if(s===null)throw Error(i(308));ga=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else ga=ga.next=r;return l}var uw=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){r.aborted=!0,s.forEach(function(l){return l()})}},dw=n.unstable_scheduleCallback,hw=n.unstable_NormalPriority,Ut={$$typeof:U,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jf(){return{controller:new uw,data:new Map,refCount:0}}function Yl(s){s.refCount--,s.refCount===0&&dw(hw,function(){s.controller.abort()})}var Ql=null,em=0,po=0,go=null;function fw(s,r){if(Ql===null){var l=Ql=[];em=0,po=np(),go={status:"pending",value:void 0,then:function(u){l.push(u)}}}return em++,r.then(Sy,Sy),r}function Sy(){if(--em===0&&Ql!==null){go!==null&&(go.status="fulfilled");var s=Ql;Ql=null,po=0,go=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function mw(s,r){var l=[],u={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return s.then(function(){u.status="fulfilled",u.value=r;for(var m=0;m<l.length;m++)(0,l[m])(r)},function(m){for(u.status="rejected",u.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),u}var Iy=Q.S;Q.S=function(s,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&fw(s,r),Iy!==null&&Iy(s,r)};var yr=ee(null);function tm(){var s=yr.current;return s!==null?s:pt.pooledCache}function id(s,r){r===null?ce(yr,yr.current):ce(yr,r.pool)}function Ry(){var s=tm();return s===null?null:{parent:Ut._currentValue,pool:s}}var Kl=Error(i(460)),Dy=Error(i(474)),rd=Error(i(542)),nm={then:function(){}};function My(s){return s=s.status,s==="fulfilled"||s==="rejected"}function od(){}function Oy(s,r,l){switch(l=s[l],l===void 0?s.push(r):l!==r&&(r.then(od,od),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Py(s),s;default:if(typeof r.status=="string")r.then(od,od);else{if(s=pt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(u){if(r.status==="pending"){var m=r;m.status="fulfilled",m.value=u}},function(u){if(r.status==="pending"){var m=r;m.status="rejected",m.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Py(s),s}throw Xl=r,Kl}}var Xl=null;function ky(){if(Xl===null)throw Error(i(459));var s=Xl;return Xl=null,s}function Py(s){if(s===Kl||s===rd)throw Error(i(483))}var $a=!1;function sm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function am(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ya(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Qa(s,r,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(at&2)!==0){var m=u.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),u.pending=r,r=Ju(s),_y(s,null,l),r}return Zu(s,u,r,l),Ju(s)}function Wl(s,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,jl(s,l)}}function im(s,r){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var m=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var j={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?m=v=j:v=v.next=j,l=l.next}while(l!==null);v===null?m=v=r:v=v.next=r}else m=v=r;l={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=r:s.next=r,l.lastBaseUpdate=r}var rm=!1;function Zl(){if(rm){var s=go;if(s!==null)throw s}}function Jl(s,r,l,u){rm=!1;var m=s.updateQueue;$a=!1;var v=m.firstBaseUpdate,j=m.lastBaseUpdate,D=m.shared.pending;if(D!==null){m.shared.pending=null;var z=D,W=z.next;z.next=null,j===null?v=W:j.next=W,j=z;var ne=s.alternate;ne!==null&&(ne=ne.updateQueue,D=ne.lastBaseUpdate,D!==j&&(D===null?ne.firstBaseUpdate=W:D.next=W,ne.lastBaseUpdate=z))}if(v!==null){var re=m.baseState;j=0,ne=W=z=null,D=v;do{var Z=D.lane&-536870913,J=Z!==D.lane;if(J?(Xe&Z)===Z:(u&Z)===Z){Z!==0&&Z===po&&(rm=!0),ne!==null&&(ne=ne.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Se=s,je=D;Z=r;var ct=l;switch(je.tag){case 1:if(Se=je.payload,typeof Se=="function"){re=Se.call(ct,re,Z);break e}re=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=je.payload,Z=typeof Se=="function"?Se.call(ct,re,Z):Se,Z==null)break e;re=y({},re,Z);break e;case 2:$a=!0}}Z=D.callback,Z!==null&&(s.flags|=64,J&&(s.flags|=8192),J=m.callbacks,J===null?m.callbacks=[Z]:J.push(Z))}else J={lane:Z,tag:D.tag,payload:D.payload,callback:D.callback,next:null},ne===null?(W=ne=J,z=re):ne=ne.next=J,j|=Z;if(D=D.next,D===null){if(D=m.shared.pending,D===null)break;J=D,D=J.next,J.next=null,m.lastBaseUpdate=J,m.shared.pending=null}}while(!0);ne===null&&(z=re),m.baseState=z,m.firstBaseUpdate=W,m.lastBaseUpdate=ne,v===null&&(m.shared.lanes=0),ni|=j,s.lanes=j,s.memoizedState=re}}function Ly(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function Vy(s,r){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)Ly(l[s],r)}var vo=ee(null),ld=ee(0);function Uy(s,r){s=Ta,ce(ld,s),ce(vo,r),Ta=s|r.baseLanes}function om(){ce(ld,Ta),ce(vo,vo.current)}function lm(){Ta=ld.current,le(vo),le(ld)}var Ka=0,Fe=null,ot=null,Dt=null,cd=!1,yo=!1,br=!1,ud=0,ec=0,bo=null,pw=0;function wt(){throw Error(i(321))}function cm(s,r){if(r===null)return!1;for(var l=0;l<r.length&&l<s.length;l++)if(!kn(s[l],r[l]))return!1;return!0}function um(s,r,l,u,m,v){return Ka=v,Fe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Q.H=s===null||s.memoizedState===null?_b:Eb,br=!1,v=l(u,m),br=!1,yo&&(v=qy(r,l,u,m)),Fy(s),v}function Fy(s){Q.H=gd;var r=ot!==null&&ot.next!==null;if(Ka=0,Dt=ot=Fe=null,cd=!1,ec=0,bo=null,r)throw Error(i(300));s===null||Yt||(s=s.dependencies,s!==null&&sd(s)&&(Yt=!0))}function qy(s,r,l,u){Fe=s;var m=0;do{if(yo&&(bo=null),ec=0,yo=!1,25<=m)throw Error(i(301));if(m+=1,Dt=ot=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}Q.H=_w,v=r(l,u)}while(yo);return v}function gw(){var s=Q.H,r=s.useState()[0];return r=typeof r.then=="function"?tc(r):r,s=s.useState()[0],(ot!==null?ot.memoizedState:null)!==s&&(Fe.flags|=1024),r}function dm(){var s=ud!==0;return ud=0,s}function hm(s,r,l){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~l}function fm(s){if(cd){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}cd=!1}Ka=0,Dt=ot=Fe=null,yo=!1,ec=ud=0,bo=null}function An(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?Fe.memoizedState=Dt=s:Dt=Dt.next=s,Dt}function Mt(){if(ot===null){var s=Fe.alternate;s=s!==null?s.memoizedState:null}else s=ot.next;var r=Dt===null?Fe.memoizedState:Dt.next;if(r!==null)Dt=r,ot=s;else{if(s===null)throw Fe.alternate===null?Error(i(467)):Error(i(310));ot=s,s={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},Dt===null?Fe.memoizedState=Dt=s:Dt=Dt.next=s}return Dt}function mm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function tc(s){var r=ec;return ec+=1,bo===null&&(bo=[]),s=Oy(bo,s,r),r=Fe,(Dt===null?r.memoizedState:Dt.next)===null&&(r=r.alternate,Q.H=r===null||r.memoizedState===null?_b:Eb),s}function dd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return tc(s);if(s.$$typeof===U)return un(s)}throw Error(i(438,String(s)))}function pm(s){var r=null,l=Fe.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var u=Fe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(m){return m.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=mm(),Fe.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(s),u=0;u<s;u++)l[u]=O;return r.index++,l}function ya(s,r){return typeof r=="function"?r(s):r}function hd(s){var r=Mt();return gm(r,ot,s)}function gm(s,r,l){var u=s.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var m=s.baseQueue,v=u.pending;if(v!==null){if(m!==null){var j=m.next;m.next=v.next,v.next=j}r.baseQueue=m=v,u.pending=null}if(v=s.baseState,m===null)s.memoizedState=v;else{r=m.next;var D=j=null,z=null,W=r,ne=!1;do{var re=W.lane&-536870913;if(re!==W.lane?(Xe&re)===re:(Ka&re)===re){var Z=W.revertLane;if(Z===0)z!==null&&(z=z.next={lane:0,revertLane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),re===po&&(ne=!0);else if((Ka&Z)===Z){W=W.next,Z===po&&(ne=!0);continue}else re={lane:0,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},z===null?(D=z=re,j=v):z=z.next=re,Fe.lanes|=Z,ni|=Z;re=W.action,br&&l(v,re),v=W.hasEagerState?W.eagerState:l(v,re)}else Z={lane:re,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},z===null?(D=z=Z,j=v):z=z.next=Z,Fe.lanes|=re,ni|=re;W=W.next}while(W!==null&&W!==r);if(z===null?j=v:z.next=D,!kn(v,s.memoizedState)&&(Yt=!0,ne&&(l=go,l!==null)))throw l;s.memoizedState=v,s.baseState=j,s.baseQueue=z,u.lastRenderedState=v}return m===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function vm(s){var r=Mt(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var u=l.dispatch,m=l.pending,v=r.memoizedState;if(m!==null){l.pending=null;var j=m=m.next;do v=s(v,j.action),j=j.next;while(j!==m);kn(v,r.memoizedState)||(Yt=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),l.lastRenderedState=v}return[v,u]}function zy(s,r,l){var u=Fe,m=Mt(),v=tt;if(v){if(l===void 0)throw Error(i(407));l=l()}else l=r();var j=!kn((ot||m).memoizedState,l);j&&(m.memoizedState=l,Yt=!0),m=m.queue;var D=Gy.bind(null,u,m,s);if(nc(2048,8,D,[s]),m.getSnapshot!==r||j||Dt!==null&&Dt.memoizedState.tag&1){if(u.flags|=2048,xo(9,fd(),Hy.bind(null,u,m,l,r),null),pt===null)throw Error(i(349));v||(Ka&124)!==0||By(u,r,l)}return l}function By(s,r,l){s.flags|=16384,s={getSnapshot:r,value:l},r=Fe.updateQueue,r===null?(r=mm(),Fe.updateQueue=r,r.stores=[s]):(l=r.stores,l===null?r.stores=[s]:l.push(s))}function Hy(s,r,l,u){r.value=l,r.getSnapshot=u,$y(r)&&Yy(s)}function Gy(s,r,l){return l(function(){$y(r)&&Yy(s)})}function $y(s){var r=s.getSnapshot;s=s.value;try{var l=r();return!kn(s,l)}catch{return!0}}function Yy(s){var r=uo(s,2);r!==null&&qn(r,s,2)}function ym(s){var r=An();if(typeof s=="function"){var l=s;if(s=l(),br){Mn(!0);try{l()}finally{Mn(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:s},r}function Qy(s,r,l,u){return s.baseState=l,gm(s,ot,typeof u=="function"?u:ya)}function vw(s,r,l,u,m){if(pd(s))throw Error(i(485));if(s=r.action,s!==null){var v={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){v.listeners.push(j)}};Q.T!==null?l(!0):v.isTransition=!1,u(v),l=r.pending,l===null?(v.next=r.pending=v,Ky(r,v)):(v.next=l.next,r.pending=l.next=v)}}function Ky(s,r){var l=r.action,u=r.payload,m=s.state;if(r.isTransition){var v=Q.T,j={};Q.T=j;try{var D=l(m,u),z=Q.S;z!==null&&z(j,D),Xy(s,r,D)}catch(W){bm(s,r,W)}finally{Q.T=v}}else try{v=l(m,u),Xy(s,r,v)}catch(W){bm(s,r,W)}}function Xy(s,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Wy(s,r,u)},function(u){return bm(s,r,u)}):Wy(s,r,l)}function Wy(s,r,l){r.status="fulfilled",r.value=l,Zy(r),s.state=l,r=s.pending,r!==null&&(l=r.next,l===r?s.pending=null:(l=l.next,r.next=l,Ky(s,l)))}function bm(s,r,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=l,Zy(r),r=r.next;while(r!==u)}s.action=null}function Zy(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function Jy(s,r){return r}function eb(s,r){if(tt){var l=pt.formState;if(l!==null){e:{var u=Fe;if(tt){if(Tt){t:{for(var m=Tt,v=Vs;m.nodeType!==8;){if(!v){m=null;break t}if(m=vs(m.nextSibling),m===null){m=null;break t}}v=m.data,m=v==="F!"||v==="F"?m:null}if(m){Tt=vs(m.nextSibling),u=m.data==="F!";break e}}pr(u)}u=!1}u&&(r=l[0])}}return l=An(),l.memoizedState=l.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jy,lastRenderedState:r},l.queue=u,l=bb.bind(null,Fe,u),u.dispatch=l,u=ym(!1),v=Tm.bind(null,Fe,!1,u.queue),u=An(),m={state:r,dispatch:null,action:s,pending:null},u.queue=m,l=vw.bind(null,Fe,m,v,l),m.dispatch=l,u.memoizedState=s,[r,l,!1]}function tb(s){var r=Mt();return nb(r,ot,s)}function nb(s,r,l){if(r=gm(s,r,Jy)[0],s=hd(ya)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=tc(r)}catch(j){throw j===Kl?rd:j}else u=r;r=Mt();var m=r.queue,v=m.dispatch;return l!==r.memoizedState&&(Fe.flags|=2048,xo(9,fd(),yw.bind(null,m,l),null)),[u,v,s]}function yw(s,r){s.action=r}function sb(s){var r=Mt(),l=ot;if(l!==null)return nb(r,l,s);Mt(),r=r.memoizedState,l=Mt();var u=l.queue.dispatch;return l.memoizedState=s,[r,u,!1]}function xo(s,r,l,u){return s={tag:s,create:l,deps:u,inst:r,next:null},r=Fe.updateQueue,r===null&&(r=mm(),Fe.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,r.lastEffect=s),s}function fd(){return{destroy:void 0,resource:void 0}}function ab(){return Mt().memoizedState}function md(s,r,l,u){var m=An();u=u===void 0?null:u,Fe.flags|=s,m.memoizedState=xo(1|r,fd(),l,u)}function nc(s,r,l,u){var m=Mt();u=u===void 0?null:u;var v=m.memoizedState.inst;ot!==null&&u!==null&&cm(u,ot.memoizedState.deps)?m.memoizedState=xo(r,v,l,u):(Fe.flags|=s,m.memoizedState=xo(1|r,v,l,u))}function ib(s,r){md(8390656,8,s,r)}function rb(s,r){nc(2048,8,s,r)}function ob(s,r){return nc(4,2,s,r)}function lb(s,r){return nc(4,4,s,r)}function cb(s,r){if(typeof r=="function"){s=s();var l=r(s);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function ub(s,r,l){l=l!=null?l.concat([s]):null,nc(4,4,cb.bind(null,r,s),l)}function xm(){}function db(s,r){var l=Mt();r=r===void 0?null:r;var u=l.memoizedState;return r!==null&&cm(r,u[1])?u[0]:(l.memoizedState=[s,r],s)}function hb(s,r){var l=Mt();r=r===void 0?null:r;var u=l.memoizedState;if(r!==null&&cm(r,u[1]))return u[0];if(u=s(),br){Mn(!0);try{s()}finally{Mn(!1)}}return l.memoizedState=[u,r],u}function Nm(s,r,l){return l===void 0||(Ka&1073741824)!==0?s.memoizedState=r:(s.memoizedState=l,s=px(),Fe.lanes|=s,ni|=s,l)}function fb(s,r,l,u){return kn(l,r)?l:vo.current!==null?(s=Nm(s,l,u),kn(s,r)||(Yt=!0),s):(Ka&42)===0?(Yt=!0,s.memoizedState=l):(s=px(),Fe.lanes|=s,ni|=s,r)}function mb(s,r,l,u,m){var v=se.p;se.p=v!==0&&8>v?v:8;var j=Q.T,D={};Q.T=D,Tm(s,!1,r,l);try{var z=m(),W=Q.S;if(W!==null&&W(D,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var ne=mw(z,u);sc(s,r,ne,Fn(s))}else sc(s,r,u,Fn(s))}catch(re){sc(s,r,{then:function(){},status:"rejected",reason:re},Fn())}finally{se.p=v,Q.T=j}}function bw(){}function _m(s,r,l,u){if(s.tag!==5)throw Error(i(476));var m=pb(s).queue;mb(s,m,r,fe,l===null?bw:function(){return gb(s),l(u)})}function pb(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:fe,baseState:fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:fe},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:l},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function gb(s){var r=pb(s).next.queue;sc(s,r,{},Fn())}function Em(){return un(Nc)}function vb(){return Mt().memoizedState}function yb(){return Mt().memoizedState}function xw(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var l=Fn();s=Ya(l);var u=Qa(r,s,l);u!==null&&(qn(u,r,l),Wl(u,r,l)),r={cache:Jf()},s.payload=r;return}r=r.return}}function Nw(s,r,l){var u=Fn();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},pd(s)?xb(r,l):(l=Bf(s,r,l,u),l!==null&&(qn(l,s,u),Nb(l,r,u)))}function bb(s,r,l){var u=Fn();sc(s,r,l,u)}function sc(s,r,l,u){var m={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(pd(s))xb(r,m);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var j=r.lastRenderedState,D=v(j,l);if(m.hasEagerState=!0,m.eagerState=D,kn(D,j))return Zu(s,r,m,0),pt===null&&Wu(),!1}catch{}finally{}if(l=Bf(s,r,m,u),l!==null)return qn(l,s,u),Nb(l,r,u),!0}return!1}function Tm(s,r,l,u){if(u={lane:2,revertLane:np(),action:u,hasEagerState:!1,eagerState:null,next:null},pd(s)){if(r)throw Error(i(479))}else r=Bf(s,l,u,2),r!==null&&qn(r,s,2)}function pd(s){var r=s.alternate;return s===Fe||r!==null&&r===Fe}function xb(s,r){yo=cd=!0;var l=s.pending;l===null?r.next=r:(r.next=l.next,l.next=r),s.pending=r}function Nb(s,r,l){if((l&4194048)!==0){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,jl(s,l)}}var gd={readContext:un,use:dd,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useLayoutEffect:wt,useInsertionEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useSyncExternalStore:wt,useId:wt,useHostTransitionStatus:wt,useFormState:wt,useActionState:wt,useOptimistic:wt,useMemoCache:wt,useCacheRefresh:wt},_b={readContext:un,use:dd,useCallback:function(s,r){return An().memoizedState=[s,r===void 0?null:r],s},useContext:un,useEffect:ib,useImperativeHandle:function(s,r,l){l=l!=null?l.concat([s]):null,md(4194308,4,cb.bind(null,r,s),l)},useLayoutEffect:function(s,r){return md(4194308,4,s,r)},useInsertionEffect:function(s,r){md(4,2,s,r)},useMemo:function(s,r){var l=An();r=r===void 0?null:r;var u=s();if(br){Mn(!0);try{s()}finally{Mn(!1)}}return l.memoizedState=[u,r],u},useReducer:function(s,r,l){var u=An();if(l!==void 0){var m=l(r);if(br){Mn(!0);try{l(r)}finally{Mn(!1)}}}else m=r;return u.memoizedState=u.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},u.queue=s,s=s.dispatch=Nw.bind(null,Fe,s),[u.memoizedState,s]},useRef:function(s){var r=An();return s={current:s},r.memoizedState=s},useState:function(s){s=ym(s);var r=s.queue,l=bb.bind(null,Fe,r);return r.dispatch=l,[s.memoizedState,l]},useDebugValue:xm,useDeferredValue:function(s,r){var l=An();return Nm(l,s,r)},useTransition:function(){var s=ym(!1);return s=mb.bind(null,Fe,s.queue,!0,!1),An().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,l){var u=Fe,m=An();if(tt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),pt===null)throw Error(i(349));(Xe&124)!==0||By(u,r,l)}m.memoizedState=l;var v={value:l,getSnapshot:r};return m.queue=v,ib(Gy.bind(null,u,v,s),[s]),u.flags|=2048,xo(9,fd(),Hy.bind(null,u,v,l,r),null),l},useId:function(){var s=An(),r=pt.identifierPrefix;if(tt){var l=pa,u=ma;l=(u&~(1<<32-cn(u)-1)).toString(32)+l,r=""+r+"R"+l,l=ud++,0<l&&(r+="H"+l.toString(32)),r+=""}else l=pw++,r=""+r+"r"+l.toString(32)+"";return s.memoizedState=r},useHostTransitionStatus:Em,useFormState:eb,useActionState:eb,useOptimistic:function(s){var r=An();r.memoizedState=r.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=Tm.bind(null,Fe,!0,l),l.dispatch=r,[s,r]},useMemoCache:pm,useCacheRefresh:function(){return An().memoizedState=xw.bind(null,Fe)}},Eb={readContext:un,use:dd,useCallback:db,useContext:un,useEffect:rb,useImperativeHandle:ub,useInsertionEffect:ob,useLayoutEffect:lb,useMemo:hb,useReducer:hd,useRef:ab,useState:function(){return hd(ya)},useDebugValue:xm,useDeferredValue:function(s,r){var l=Mt();return fb(l,ot.memoizedState,s,r)},useTransition:function(){var s=hd(ya)[0],r=Mt().memoizedState;return[typeof s=="boolean"?s:tc(s),r]},useSyncExternalStore:zy,useId:vb,useHostTransitionStatus:Em,useFormState:tb,useActionState:tb,useOptimistic:function(s,r){var l=Mt();return Qy(l,ot,s,r)},useMemoCache:pm,useCacheRefresh:yb},_w={readContext:un,use:dd,useCallback:db,useContext:un,useEffect:rb,useImperativeHandle:ub,useInsertionEffect:ob,useLayoutEffect:lb,useMemo:hb,useReducer:vm,useRef:ab,useState:function(){return vm(ya)},useDebugValue:xm,useDeferredValue:function(s,r){var l=Mt();return ot===null?Nm(l,s,r):fb(l,ot.memoizedState,s,r)},useTransition:function(){var s=vm(ya)[0],r=Mt().memoizedState;return[typeof s=="boolean"?s:tc(s),r]},useSyncExternalStore:zy,useId:vb,useHostTransitionStatus:Em,useFormState:sb,useActionState:sb,useOptimistic:function(s,r){var l=Mt();return ot!==null?Qy(l,ot,s,r):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:pm,useCacheRefresh:yb},No=null,ac=0;function vd(s){var r=ac;return ac+=1,No===null&&(No=[]),Oy(No,s,r)}function ic(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function yd(s,r){throw r.$$typeof===x?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Tb(s){var r=s._init;return r(s._payload)}function jb(s){function r(Y,H){if(s){var X=Y.deletions;X===null?(Y.deletions=[H],Y.flags|=16):X.push(H)}}function l(Y,H){if(!s)return null;for(;H!==null;)r(Y,H),H=H.sibling;return null}function u(Y){for(var H=new Map;Y!==null;)Y.key!==null?H.set(Y.key,Y):H.set(Y.index,Y),Y=Y.sibling;return H}function m(Y,H){return Y=fa(Y,H),Y.index=0,Y.sibling=null,Y}function v(Y,H,X){return Y.index=X,s?(X=Y.alternate,X!==null?(X=X.index,X<H?(Y.flags|=67108866,H):X):(Y.flags|=67108866,H)):(Y.flags|=1048576,H)}function j(Y){return s&&Y.alternate===null&&(Y.flags|=67108866),Y}function D(Y,H,X,ae){return H===null||H.tag!==6?(H=Gf(X,Y.mode,ae),H.return=Y,H):(H=m(H,X),H.return=Y,H)}function z(Y,H,X,ae){var ye=X.type;return ye===N?ne(Y,H,X.props.children,ae,X.key):H!==null&&(H.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===S&&Tb(ye)===H.type)?(H=m(H,X.props),ic(H,X),H.return=Y,H):(H=ed(X.type,X.key,X.props,null,Y.mode,ae),ic(H,X),H.return=Y,H)}function W(Y,H,X,ae){return H===null||H.tag!==4||H.stateNode.containerInfo!==X.containerInfo||H.stateNode.implementation!==X.implementation?(H=$f(X,Y.mode,ae),H.return=Y,H):(H=m(H,X.children||[]),H.return=Y,H)}function ne(Y,H,X,ae,ye){return H===null||H.tag!==7?(H=dr(X,Y.mode,ae,ye),H.return=Y,H):(H=m(H,X),H.return=Y,H)}function re(Y,H,X){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=Gf(""+H,Y.mode,X),H.return=Y,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case _:return X=ed(H.type,H.key,H.props,null,Y.mode,X),ic(X,H),X.return=Y,X;case A:return H=$f(H,Y.mode,X),H.return=Y,H;case S:var ae=H._init;return H=ae(H._payload),re(Y,H,X)}if(be(H)||I(H))return H=dr(H,Y.mode,X,null),H.return=Y,H;if(typeof H.then=="function")return re(Y,vd(H),X);if(H.$$typeof===U)return re(Y,ad(Y,H),X);yd(Y,H)}return null}function Z(Y,H,X,ae){var ye=H!==null?H.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return ye!==null?null:D(Y,H,""+X,ae);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case _:return X.key===ye?z(Y,H,X,ae):null;case A:return X.key===ye?W(Y,H,X,ae):null;case S:return ye=X._init,X=ye(X._payload),Z(Y,H,X,ae)}if(be(X)||I(X))return ye!==null?null:ne(Y,H,X,ae,null);if(typeof X.then=="function")return Z(Y,H,vd(X),ae);if(X.$$typeof===U)return Z(Y,H,ad(Y,X),ae);yd(Y,X)}return null}function J(Y,H,X,ae,ye){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Y=Y.get(X)||null,D(H,Y,""+ae,ye);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case _:return Y=Y.get(ae.key===null?X:ae.key)||null,z(H,Y,ae,ye);case A:return Y=Y.get(ae.key===null?X:ae.key)||null,W(H,Y,ae,ye);case S:var Be=ae._init;return ae=Be(ae._payload),J(Y,H,X,ae,ye)}if(be(ae)||I(ae))return Y=Y.get(X)||null,ne(H,Y,ae,ye,null);if(typeof ae.then=="function")return J(Y,H,X,vd(ae),ye);if(ae.$$typeof===U)return J(Y,H,X,ad(H,ae),ye);yd(H,ae)}return null}function Se(Y,H,X,ae){for(var ye=null,Be=null,xe=H,Ae=H=0,Kt=null;xe!==null&&Ae<X.length;Ae++){xe.index>Ae?(Kt=xe,xe=null):Kt=xe.sibling;var et=Z(Y,xe,X[Ae],ae);if(et===null){xe===null&&(xe=Kt);break}s&&xe&&et.alternate===null&&r(Y,xe),H=v(et,H,Ae),Be===null?ye=et:Be.sibling=et,Be=et,xe=Kt}if(Ae===X.length)return l(Y,xe),tt&&fr(Y,Ae),ye;if(xe===null){for(;Ae<X.length;Ae++)xe=re(Y,X[Ae],ae),xe!==null&&(H=v(xe,H,Ae),Be===null?ye=xe:Be.sibling=xe,Be=xe);return tt&&fr(Y,Ae),ye}for(xe=u(xe);Ae<X.length;Ae++)Kt=J(xe,Y,Ae,X[Ae],ae),Kt!==null&&(s&&Kt.alternate!==null&&xe.delete(Kt.key===null?Ae:Kt.key),H=v(Kt,H,Ae),Be===null?ye=Kt:Be.sibling=Kt,Be=Kt);return s&&xe.forEach(function(di){return r(Y,di)}),tt&&fr(Y,Ae),ye}function je(Y,H,X,ae){if(X==null)throw Error(i(151));for(var ye=null,Be=null,xe=H,Ae=H=0,Kt=null,et=X.next();xe!==null&&!et.done;Ae++,et=X.next()){xe.index>Ae?(Kt=xe,xe=null):Kt=xe.sibling;var di=Z(Y,xe,et.value,ae);if(di===null){xe===null&&(xe=Kt);break}s&&xe&&di.alternate===null&&r(Y,xe),H=v(di,H,Ae),Be===null?ye=di:Be.sibling=di,Be=di,xe=Kt}if(et.done)return l(Y,xe),tt&&fr(Y,Ae),ye;if(xe===null){for(;!et.done;Ae++,et=X.next())et=re(Y,et.value,ae),et!==null&&(H=v(et,H,Ae),Be===null?ye=et:Be.sibling=et,Be=et);return tt&&fr(Y,Ae),ye}for(xe=u(xe);!et.done;Ae++,et=X.next())et=J(xe,Y,Ae,et.value,ae),et!==null&&(s&&et.alternate!==null&&xe.delete(et.key===null?Ae:et.key),H=v(et,H,Ae),Be===null?ye=et:Be.sibling=et,Be=et);return s&&xe.forEach(function(EC){return r(Y,EC)}),tt&&fr(Y,Ae),ye}function ct(Y,H,X,ae){if(typeof X=="object"&&X!==null&&X.type===N&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case _:e:{for(var ye=X.key;H!==null;){if(H.key===ye){if(ye=X.type,ye===N){if(H.tag===7){l(Y,H.sibling),ae=m(H,X.props.children),ae.return=Y,Y=ae;break e}}else if(H.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===S&&Tb(ye)===H.type){l(Y,H.sibling),ae=m(H,X.props),ic(ae,X),ae.return=Y,Y=ae;break e}l(Y,H);break}else r(Y,H);H=H.sibling}X.type===N?(ae=dr(X.props.children,Y.mode,ae,X.key),ae.return=Y,Y=ae):(ae=ed(X.type,X.key,X.props,null,Y.mode,ae),ic(ae,X),ae.return=Y,Y=ae)}return j(Y);case A:e:{for(ye=X.key;H!==null;){if(H.key===ye)if(H.tag===4&&H.stateNode.containerInfo===X.containerInfo&&H.stateNode.implementation===X.implementation){l(Y,H.sibling),ae=m(H,X.children||[]),ae.return=Y,Y=ae;break e}else{l(Y,H);break}else r(Y,H);H=H.sibling}ae=$f(X,Y.mode,ae),ae.return=Y,Y=ae}return j(Y);case S:return ye=X._init,X=ye(X._payload),ct(Y,H,X,ae)}if(be(X))return Se(Y,H,X,ae);if(I(X)){if(ye=I(X),typeof ye!="function")throw Error(i(150));return X=ye.call(X),je(Y,H,X,ae)}if(typeof X.then=="function")return ct(Y,H,vd(X),ae);if(X.$$typeof===U)return ct(Y,H,ad(Y,X),ae);yd(Y,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,H!==null&&H.tag===6?(l(Y,H.sibling),ae=m(H,X),ae.return=Y,Y=ae):(l(Y,H),ae=Gf(X,Y.mode,ae),ae.return=Y,Y=ae),j(Y)):l(Y,H)}return function(Y,H,X,ae){try{ac=0;var ye=ct(Y,H,X,ae);return No=null,ye}catch(xe){if(xe===Kl||xe===rd)throw xe;var Be=Pn(29,xe,null,Y.mode);return Be.lanes=ae,Be.return=Y,Be}finally{}}}var _o=jb(!0),Ab=jb(!1),ss=ee(null),Us=null;function Xa(s){var r=s.alternate;ce(Ft,Ft.current&1),ce(ss,s),Us===null&&(r===null||vo.current!==null||r.memoizedState!==null)&&(Us=s)}function wb(s){if(s.tag===22){if(ce(Ft,Ft.current),ce(ss,s),Us===null){var r=s.alternate;r!==null&&r.memoizedState!==null&&(Us=s)}}else Wa()}function Wa(){ce(Ft,Ft.current),ce(ss,ss.current)}function ba(s){le(ss),Us===s&&(Us=null),le(Ft)}var Ft=ee(0);function bd(s){for(var r=s;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||mp(l)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function jm(s,r,l,u){r=s.memoizedState,l=l(u,r),l=l==null?r:y({},r,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Am={enqueueSetState:function(s,r,l){s=s._reactInternals;var u=Fn(),m=Ya(u);m.payload=r,l!=null&&(m.callback=l),r=Qa(s,m,u),r!==null&&(qn(r,s,u),Wl(r,s,u))},enqueueReplaceState:function(s,r,l){s=s._reactInternals;var u=Fn(),m=Ya(u);m.tag=1,m.payload=r,l!=null&&(m.callback=l),r=Qa(s,m,u),r!==null&&(qn(r,s,u),Wl(r,s,u))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var l=Fn(),u=Ya(l);u.tag=2,r!=null&&(u.callback=r),r=Qa(s,u,l),r!==null&&(qn(r,s,l),Wl(r,s,l))}};function Cb(s,r,l,u,m,v,j){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,v,j):r.prototype&&r.prototype.isPureReactComponent?!ql(l,u)||!ql(m,v):!0}function Sb(s,r,l,u){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,u),r.state!==s&&Am.enqueueReplaceState(r,r.state,null)}function xr(s,r){var l=r;if("ref"in r){l={};for(var u in r)u!=="ref"&&(l[u]=r[u])}if(s=s.defaultProps){l===r&&(l=y({},l));for(var m in s)l[m]===void 0&&(l[m]=s[m])}return l}var xd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Ib(s){xd(s)}function Rb(s){console.error(s)}function Db(s){xd(s)}function Nd(s,r){try{var l=s.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function Mb(s,r,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function wm(s,r,l){return l=Ya(l),l.tag=3,l.payload={element:null},l.callback=function(){Nd(s,r)},l}function Ob(s){return s=Ya(s),s.tag=3,s}function kb(s,r,l,u){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var v=u.value;s.payload=function(){return m(v)},s.callback=function(){Mb(r,l,u)}}var j=l.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(s.callback=function(){Mb(r,l,u),typeof m!="function"&&(si===null?si=new Set([this]):si.add(this));var D=u.stack;this.componentDidCatch(u.value,{componentStack:D!==null?D:""})})}function Ew(s,r,l,u,m){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=l.alternate,r!==null&&$l(r,l,m,!0),l=ss.current,l!==null){switch(l.tag){case 13:return Us===null?Wm():l.alternate===null&&jt===0&&(jt=3),l.flags&=-257,l.flags|=65536,l.lanes=m,u===nm?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([u]):r.add(u),Jm(s,u,m)),!1;case 22:return l.flags|=65536,u===nm?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([u]):l.add(u)),Jm(s,u,m)),!1}throw Error(i(435,l.tag))}return Jm(s,u,m),Wm(),!1}if(tt)return r=ss.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=m,u!==Kf&&(s=Error(i(422),{cause:u}),Gl(Jn(s,l)))):(u!==Kf&&(r=Error(i(423),{cause:u}),Gl(Jn(r,l))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,u=Jn(u,l),m=wm(s.stateNode,u,m),im(s,m),jt!==4&&(jt=2)),!1;var v=Error(i(520),{cause:u});if(v=Jn(v,l),hc===null?hc=[v]:hc.push(v),jt!==4&&(jt=2),r===null)return!0;u=Jn(u,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,s=m&-m,l.lanes|=s,s=wm(l.stateNode,u,s),im(l,s),!1;case 1:if(r=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(si===null||!si.has(v))))return l.flags|=65536,m&=-m,l.lanes|=m,m=Ob(m),kb(m,s,l,u),im(l,m),!1}l=l.return}while(l!==null);return!1}var Pb=Error(i(461)),Yt=!1;function en(s,r,l,u){r.child=s===null?Ab(r,null,l,u):_o(r,s.child,l,u)}function Lb(s,r,l,u,m){l=l.render;var v=r.ref;if("ref"in u){var j={};for(var D in u)D!=="ref"&&(j[D]=u[D])}else j=u;return vr(r),u=um(s,r,l,j,v,m),D=dm(),s!==null&&!Yt?(hm(s,r,m),xa(s,r,m)):(tt&&D&&Yf(r),r.flags|=1,en(s,r,u,m),r.child)}function Vb(s,r,l,u,m){if(s===null){var v=l.type;return typeof v=="function"&&!Hf(v)&&v.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=v,Ub(s,r,v,u,m)):(s=ed(l.type,null,u,r,r.mode,m),s.ref=r.ref,s.return=r,r.child=s)}if(v=s.child,!km(s,m)){var j=v.memoizedProps;if(l=l.compare,l=l!==null?l:ql,l(j,u)&&s.ref===r.ref)return xa(s,r,m)}return r.flags|=1,s=fa(v,u),s.ref=r.ref,s.return=r,r.child=s}function Ub(s,r,l,u,m){if(s!==null){var v=s.memoizedProps;if(ql(v,u)&&s.ref===r.ref)if(Yt=!1,r.pendingProps=u=v,km(s,m))(s.flags&131072)!==0&&(Yt=!0);else return r.lanes=s.lanes,xa(s,r,m)}return Cm(s,r,l,u,m)}function Fb(s,r,l){var u=r.pendingProps,m=u.children,v=s!==null?s.memoizedState:null;if(u.mode==="hidden"){if((r.flags&128)!==0){if(u=v!==null?v.baseLanes|l:l,s!==null){for(m=r.child=s.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;r.childLanes=v&~u}else r.childLanes=0,r.child=null;return qb(s,r,u,l)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&id(r,v!==null?v.cachePool:null),v!==null?Uy(r,v):om(),wb(r);else return r.lanes=r.childLanes=536870912,qb(s,r,v!==null?v.baseLanes|l:l,l)}else v!==null?(id(r,v.cachePool),Uy(r,v),Wa(),r.memoizedState=null):(s!==null&&id(r,null),om(),Wa());return en(s,r,m,l),r.child}function qb(s,r,l,u){var m=tm();return m=m===null?null:{parent:Ut._currentValue,pool:m},r.memoizedState={baseLanes:l,cachePool:m},s!==null&&id(r,null),om(),wb(r),s!==null&&$l(s,r,u,!0),null}function _d(s,r){var l=r.ref;if(l===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(r.flags|=4194816)}}function Cm(s,r,l,u,m){return vr(r),l=um(s,r,l,u,void 0,m),u=dm(),s!==null&&!Yt?(hm(s,r,m),xa(s,r,m)):(tt&&u&&Yf(r),r.flags|=1,en(s,r,l,m),r.child)}function zb(s,r,l,u,m,v){return vr(r),r.updateQueue=null,l=qy(r,u,l,m),Fy(s),u=dm(),s!==null&&!Yt?(hm(s,r,v),xa(s,r,v)):(tt&&u&&Yf(r),r.flags|=1,en(s,r,l,v),r.child)}function Bb(s,r,l,u,m){if(vr(r),r.stateNode===null){var v=ho,j=l.contextType;typeof j=="object"&&j!==null&&(v=un(j)),v=new l(u,v),r.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Am,r.stateNode=v,v._reactInternals=r,v=r.stateNode,v.props=u,v.state=r.memoizedState,v.refs={},sm(r),j=l.contextType,v.context=typeof j=="object"&&j!==null?un(j):ho,v.state=r.memoizedState,j=l.getDerivedStateFromProps,typeof j=="function"&&(jm(r,l,j,u),v.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(j=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),j!==v.state&&Am.enqueueReplaceState(v,v.state,null),Jl(r,u,v,m),Zl(),v.state=r.memoizedState),typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(s===null){v=r.stateNode;var D=r.memoizedProps,z=xr(l,D);v.props=z;var W=v.context,ne=l.contextType;j=ho,typeof ne=="object"&&ne!==null&&(j=un(ne));var re=l.getDerivedStateFromProps;ne=typeof re=="function"||typeof v.getSnapshotBeforeUpdate=="function",D=r.pendingProps!==D,ne||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(D||W!==j)&&Sb(r,v,u,j),$a=!1;var Z=r.memoizedState;v.state=Z,Jl(r,u,v,m),Zl(),W=r.memoizedState,D||Z!==W||$a?(typeof re=="function"&&(jm(r,l,re,u),W=r.memoizedState),(z=$a||Cb(r,l,z,u,Z,W,j))?(ne||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=W),v.props=u,v.state=W,v.context=j,u=z):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{v=r.stateNode,am(s,r),j=r.memoizedProps,ne=xr(l,j),v.props=ne,re=r.pendingProps,Z=v.context,W=l.contextType,z=ho,typeof W=="object"&&W!==null&&(z=un(W)),D=l.getDerivedStateFromProps,(W=typeof D=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(j!==re||Z!==z)&&Sb(r,v,u,z),$a=!1,Z=r.memoizedState,v.state=Z,Jl(r,u,v,m),Zl();var J=r.memoizedState;j!==re||Z!==J||$a||s!==null&&s.dependencies!==null&&sd(s.dependencies)?(typeof D=="function"&&(jm(r,l,D,u),J=r.memoizedState),(ne=$a||Cb(r,l,ne,u,Z,J,z)||s!==null&&s.dependencies!==null&&sd(s.dependencies))?(W||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,J,z),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,J,z)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||j===s.memoizedProps&&Z===s.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&Z===s.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=J),v.props=u,v.state=J,v.context=z,u=ne):(typeof v.componentDidUpdate!="function"||j===s.memoizedProps&&Z===s.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&Z===s.memoizedState||(r.flags|=1024),u=!1)}return v=u,_d(s,r),u=(r.flags&128)!==0,v||u?(v=r.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:v.render(),r.flags|=1,s!==null&&u?(r.child=_o(r,s.child,null,m),r.child=_o(r,null,l,m)):en(s,r,l,m),r.memoizedState=v.state,s=r.child):s=xa(s,r,m),s}function Hb(s,r,l,u){return Hl(),r.flags|=256,en(s,r,l,u),r.child}var Sm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Im(s){return{baseLanes:s,cachePool:Ry()}}function Rm(s,r,l){return s=s!==null?s.childLanes&~l:0,r&&(s|=as),s}function Gb(s,r,l){var u=r.pendingProps,m=!1,v=(r.flags&128)!==0,j;if((j=v)||(j=s!==null&&s.memoizedState===null?!1:(Ft.current&2)!==0),j&&(m=!0,r.flags&=-129),j=(r.flags&32)!==0,r.flags&=-33,s===null){if(tt){if(m?Xa(r):Wa(),tt){var D=Tt,z;if(z=D){e:{for(z=D,D=Vs;z.nodeType!==8;){if(!D){D=null;break e}if(z=vs(z.nextSibling),z===null){D=null;break e}}D=z}D!==null?(r.memoizedState={dehydrated:D,treeContext:hr!==null?{id:ma,overflow:pa}:null,retryLane:536870912,hydrationErrors:null},z=Pn(18,null,null,0),z.stateNode=D,z.return=r,r.child=z,xn=r,Tt=null,z=!0):z=!1}z||pr(r)}if(D=r.memoizedState,D!==null&&(D=D.dehydrated,D!==null))return mp(D)?r.lanes=32:r.lanes=536870912,null;ba(r)}return D=u.children,u=u.fallback,m?(Wa(),m=r.mode,D=Ed({mode:"hidden",children:D},m),u=dr(u,m,l,null),D.return=r,u.return=r,D.sibling=u,r.child=D,m=r.child,m.memoizedState=Im(l),m.childLanes=Rm(s,j,l),r.memoizedState=Sm,u):(Xa(r),Dm(r,D))}if(z=s.memoizedState,z!==null&&(D=z.dehydrated,D!==null)){if(v)r.flags&256?(Xa(r),r.flags&=-257,r=Mm(s,r,l)):r.memoizedState!==null?(Wa(),r.child=s.child,r.flags|=128,r=null):(Wa(),m=u.fallback,D=r.mode,u=Ed({mode:"visible",children:u.children},D),m=dr(m,D,l,null),m.flags|=2,u.return=r,m.return=r,u.sibling=m,r.child=u,_o(r,s.child,null,l),u=r.child,u.memoizedState=Im(l),u.childLanes=Rm(s,j,l),r.memoizedState=Sm,r=m);else if(Xa(r),mp(D)){if(j=D.nextSibling&&D.nextSibling.dataset,j)var W=j.dgst;j=W,u=Error(i(419)),u.stack="",u.digest=j,Gl({value:u,source:null,stack:null}),r=Mm(s,r,l)}else if(Yt||$l(s,r,l,!1),j=(l&s.childLanes)!==0,Yt||j){if(j=pt,j!==null&&(u=l&-l,u=(u&42)!==0?1:Va(u),u=(u&(j.suspendedLanes|l))!==0?0:u,u!==0&&u!==z.retryLane))throw z.retryLane=u,uo(s,u),qn(j,s,u),Pb;D.data==="$?"||Wm(),r=Mm(s,r,l)}else D.data==="$?"?(r.flags|=192,r.child=s.child,r=null):(s=z.treeContext,Tt=vs(D.nextSibling),xn=r,tt=!0,mr=null,Vs=!1,s!==null&&(ts[ns++]=ma,ts[ns++]=pa,ts[ns++]=hr,ma=s.id,pa=s.overflow,hr=r),r=Dm(r,u.children),r.flags|=4096);return r}return m?(Wa(),m=u.fallback,D=r.mode,z=s.child,W=z.sibling,u=fa(z,{mode:"hidden",children:u.children}),u.subtreeFlags=z.subtreeFlags&65011712,W!==null?m=fa(W,m):(m=dr(m,D,l,null),m.flags|=2),m.return=r,u.return=r,u.sibling=m,r.child=u,u=m,m=r.child,D=s.child.memoizedState,D===null?D=Im(l):(z=D.cachePool,z!==null?(W=Ut._currentValue,z=z.parent!==W?{parent:W,pool:W}:z):z=Ry(),D={baseLanes:D.baseLanes|l,cachePool:z}),m.memoizedState=D,m.childLanes=Rm(s,j,l),r.memoizedState=Sm,u):(Xa(r),l=s.child,s=l.sibling,l=fa(l,{mode:"visible",children:u.children}),l.return=r,l.sibling=null,s!==null&&(j=r.deletions,j===null?(r.deletions=[s],r.flags|=16):j.push(s)),r.child=l,r.memoizedState=null,l)}function Dm(s,r){return r=Ed({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Ed(s,r){return s=Pn(22,s,null,r),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Mm(s,r,l){return _o(r,s.child,null,l),s=Dm(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function $b(s,r,l){s.lanes|=r;var u=s.alternate;u!==null&&(u.lanes|=r),Wf(s.return,r,l)}function Om(s,r,l,u,m){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:m}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=l,v.tailMode=m)}function Yb(s,r,l){var u=r.pendingProps,m=u.revealOrder,v=u.tail;if(en(s,r,u.children,l),u=Ft.current,(u&2)!==0)u=u&1|2,r.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&$b(s,l,r);else if(s.tag===19)$b(s,l,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}u&=1}switch(ce(Ft,u),m){case"forwards":for(l=r.child,m=null;l!==null;)s=l.alternate,s!==null&&bd(s)===null&&(m=l),l=l.sibling;l=m,l===null?(m=r.child,r.child=null):(m=l.sibling,l.sibling=null),Om(r,!1,m,l,v);break;case"backwards":for(l=null,m=r.child,r.child=null;m!==null;){if(s=m.alternate,s!==null&&bd(s)===null){r.child=m;break}s=m.sibling,m.sibling=l,l=m,m=s}Om(r,!0,l,null,v);break;case"together":Om(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function xa(s,r,l){if(s!==null&&(r.dependencies=s.dependencies),ni|=r.lanes,(l&r.childLanes)===0)if(s!==null){if($l(s,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,l=fa(s,s.pendingProps),r.child=l,l.return=r;s.sibling!==null;)s=s.sibling,l=l.sibling=fa(s,s.pendingProps),l.return=r;l.sibling=null}return r.child}function km(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&sd(s)))}function Tw(s,r,l){switch(r.tag){case 3:mt(r,r.stateNode.containerInfo),Ga(r,Ut,s.memoizedState.cache),Hl();break;case 27:case 5:La(r);break;case 4:mt(r,r.stateNode.containerInfo);break;case 10:Ga(r,r.type,r.memoizedProps.value);break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(Xa(r),r.flags|=128,null):(l&r.child.childLanes)!==0?Gb(s,r,l):(Xa(r),s=xa(s,r,l),s!==null?s.sibling:null);Xa(r);break;case 19:var m=(s.flags&128)!==0;if(u=(l&r.childLanes)!==0,u||($l(s,r,l,!1),u=(l&r.childLanes)!==0),m){if(u)return Yb(s,r,l);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ce(Ft,Ft.current),u)break;return null;case 22:case 23:return r.lanes=0,Fb(s,r,l);case 24:Ga(r,Ut,s.memoizedState.cache)}return xa(s,r,l)}function Qb(s,r,l){if(s!==null)if(s.memoizedProps!==r.pendingProps)Yt=!0;else{if(!km(s,l)&&(r.flags&128)===0)return Yt=!1,Tw(s,r,l);Yt=(s.flags&131072)!==0}else Yt=!1,tt&&(r.flags&1048576)!==0&&Ty(r,nd,r.index);switch(r.lanes=0,r.tag){case 16:e:{s=r.pendingProps;var u=r.elementType,m=u._init;if(u=m(u._payload),r.type=u,typeof u=="function")Hf(u)?(s=xr(u,s),r.tag=1,r=Bb(null,r,u,s,l)):(r.tag=0,r=Cm(null,r,u,s,l));else{if(u!=null){if(m=u.$$typeof,m===P){r.tag=11,r=Lb(null,r,u,s,l);break e}else if(m===V){r.tag=14,r=Vb(null,r,u,s,l);break e}}throw r=de(u)||u,Error(i(306,r,""))}}return r;case 0:return Cm(s,r,r.type,r.pendingProps,l);case 1:return u=r.type,m=xr(u,r.pendingProps),Bb(s,r,u,m,l);case 3:e:{if(mt(r,r.stateNode.containerInfo),s===null)throw Error(i(387));u=r.pendingProps;var v=r.memoizedState;m=v.element,am(s,r),Jl(r,u,null,l);var j=r.memoizedState;if(u=j.cache,Ga(r,Ut,u),u!==v.cache&&Zf(r,[Ut],l,!0),Zl(),u=j.element,v.isDehydrated)if(v={element:u,isDehydrated:!1,cache:j.cache},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){r=Hb(s,r,u,l);break e}else if(u!==m){m=Jn(Error(i(424)),r),Gl(m),r=Hb(s,r,u,l);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Tt=vs(s.firstChild),xn=r,tt=!0,mr=null,Vs=!0,l=Ab(r,null,u,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Hl(),u===m){r=xa(s,r,l);break e}en(s,r,u,l)}r=r.child}return r;case 26:return _d(s,r),s===null?(l=Zx(r.type,null,r.pendingProps,null))?r.memoizedState=l:tt||(l=r.type,s=r.pendingProps,u=Ld(Re.current).createElement(l),u[Pt]=r,u[It]=s,nn(u,l,s),At(u),r.stateNode=u):r.memoizedState=Zx(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return La(r),s===null&&tt&&(u=r.stateNode=Kx(r.type,r.pendingProps,Re.current),xn=r,Vs=!0,m=Tt,ri(r.type)?(pp=m,Tt=vs(u.firstChild)):Tt=m),en(s,r,r.pendingProps.children,l),_d(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&tt&&((m=u=Tt)&&(u=Zw(u,r.type,r.pendingProps,Vs),u!==null?(r.stateNode=u,xn=r,Tt=vs(u.firstChild),Vs=!1,m=!0):m=!1),m||pr(r)),La(r),m=r.type,v=r.pendingProps,j=s!==null?s.memoizedProps:null,u=v.children,dp(m,v)?u=null:j!==null&&dp(m,j)&&(r.flags|=32),r.memoizedState!==null&&(m=um(s,r,gw,null,null,l),Nc._currentValue=m),_d(s,r),en(s,r,u,l),r.child;case 6:return s===null&&tt&&((s=l=Tt)&&(l=Jw(l,r.pendingProps,Vs),l!==null?(r.stateNode=l,xn=r,Tt=null,s=!0):s=!1),s||pr(r)),null;case 13:return Gb(s,r,l);case 4:return mt(r,r.stateNode.containerInfo),u=r.pendingProps,s===null?r.child=_o(r,null,u,l):en(s,r,u,l),r.child;case 11:return Lb(s,r,r.type,r.pendingProps,l);case 7:return en(s,r,r.pendingProps,l),r.child;case 8:return en(s,r,r.pendingProps.children,l),r.child;case 12:return en(s,r,r.pendingProps.children,l),r.child;case 10:return u=r.pendingProps,Ga(r,r.type,u.value),en(s,r,u.children,l),r.child;case 9:return m=r.type._context,u=r.pendingProps.children,vr(r),m=un(m),u=u(m),r.flags|=1,en(s,r,u,l),r.child;case 14:return Vb(s,r,r.type,r.pendingProps,l);case 15:return Ub(s,r,r.type,r.pendingProps,l);case 19:return Yb(s,r,l);case 31:return u=r.pendingProps,l=r.mode,u={mode:u.mode,children:u.children},s===null?(l=Ed(u,l),l.ref=r.ref,r.child=l,l.return=r,r=l):(l=fa(s.child,u),l.ref=r.ref,r.child=l,l.return=r,r=l),r;case 22:return Fb(s,r,l);case 24:return vr(r),u=un(Ut),s===null?(m=tm(),m===null&&(m=pt,v=Jf(),m.pooledCache=v,v.refCount++,v!==null&&(m.pooledCacheLanes|=l),m=v),r.memoizedState={parent:u,cache:m},sm(r),Ga(r,Ut,m)):((s.lanes&l)!==0&&(am(s,r),Jl(r,null,null,l),Zl()),m=s.memoizedState,v=r.memoizedState,m.parent!==u?(m={parent:u,cache:u},r.memoizedState=m,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=m),Ga(r,Ut,u)):(u=v.cache,Ga(r,Ut,u),u!==m.cache&&Zf(r,[Ut],l,!0))),en(s,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Na(s){s.flags|=4}function Kb(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!sN(r)){if(r=ss.current,r!==null&&((Xe&4194048)===Xe?Us!==null:(Xe&62914560)!==Xe&&(Xe&536870912)===0||r!==Us))throw Xl=nm,Dy;s.flags|=8192}}function Td(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?El():536870912,s.lanes|=r,Ao|=r)}function rc(s,r){if(!tt)switch(s.tailMode){case"hidden":r=s.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function Nt(s){var r=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(r)for(var m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=u,s.childLanes=l,r}function jw(s,r,l){var u=r.pendingProps;switch(Qf(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(r),null;case 1:return Nt(r),null;case 3:return l=r.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),va(Ut),As(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Bl(r)?Na(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,wy())),Nt(r),null;case 26:return l=r.memoizedState,s===null?(Na(r),l!==null?(Nt(r),Kb(r,l)):(Nt(r),r.flags&=-16777217)):l?l!==s.memoizedState?(Na(r),Nt(r),Kb(r,l)):(Nt(r),r.flags&=-16777217):(s.memoizedProps!==u&&Na(r),Nt(r),r.flags&=-16777217),null;case 27:ea(r),l=Re.current;var m=r.type;if(s!==null&&r.stateNode!=null)s.memoizedProps!==u&&Na(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Nt(r),null}s=_e.current,Bl(r)?jy(r):(s=Kx(m,u,l),r.stateNode=s,Na(r))}return Nt(r),null;case 5:if(ea(r),l=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&Na(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Nt(r),null}if(s=_e.current,Bl(r))jy(r);else{switch(m=Ld(Re.current),s){case 1:s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=m.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof u.is=="string"?m.createElement("select",{is:u.is}):m.createElement("select"),u.multiple?s.multiple=!0:u.size&&(s.size=u.size);break;default:s=typeof u.is=="string"?m.createElement(l,{is:u.is}):m.createElement(l)}}s[Pt]=r,s[It]=u;e:for(m=r.child;m!==null;){if(m.tag===5||m.tag===6)s.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===r)break e;for(;m.sibling===null;){if(m.return===null||m.return===r)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}r.stateNode=s;e:switch(nn(s,l,u),l){case"button":case"input":case"select":case"textarea":s=!!u.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Na(r)}}return Nt(r),r.flags&=-16777217,null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==u&&Na(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(s=Re.current,Bl(r)){if(s=r.stateNode,l=r.memoizedProps,u=null,m=xn,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}s[Pt]=r,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||zx(s.nodeValue,l)),s||pr(r)}else s=Ld(s).createTextNode(u),s[Pt]=r,r.stateNode=s}return Nt(r),null;case 13:if(u=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=Bl(r),u!==null&&u.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[Pt]=r}else Hl(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Nt(r),m=!1}else m=wy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return r.flags&256?(ba(r),r):(ba(r),null)}if(ba(r),(r.flags&128)!==0)return r.lanes=l,r;if(l=u!==null,s=s!==null&&s.memoizedState!==null,l){u=r.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool);var v=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),v!==m&&(u.flags|=2048)}return l!==s&&l&&(r.child.flags|=8192),Td(r,r.updateQueue),Nt(r),null;case 4:return As(),s===null&&rp(r.stateNode.containerInfo),Nt(r),null;case 10:return va(r.type),Nt(r),null;case 19:if(le(Ft),m=r.memoizedState,m===null)return Nt(r),null;if(u=(r.flags&128)!==0,v=m.rendering,v===null)if(u)rc(m,!1);else{if(jt!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(v=bd(s),v!==null){for(r.flags|=128,rc(m,!1),s=v.updateQueue,r.updateQueue=s,Td(r,s),r.subtreeFlags=0,s=l,l=r.child;l!==null;)Ey(l,s),l=l.sibling;return ce(Ft,Ft.current&1|2),r.child}s=s.sibling}m.tail!==null&&Yn()>wd&&(r.flags|=128,u=!0,rc(m,!1),r.lanes=4194304)}else{if(!u)if(s=bd(v),s!==null){if(r.flags|=128,u=!0,s=s.updateQueue,r.updateQueue=s,Td(r,s),rc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!tt)return Nt(r),null}else 2*Yn()-m.renderingStartTime>wd&&l!==536870912&&(r.flags|=128,u=!0,rc(m,!1),r.lanes=4194304);m.isBackwards?(v.sibling=r.child,r.child=v):(s=m.last,s!==null?s.sibling=v:r.child=v,m.last=v)}return m.tail!==null?(r=m.tail,m.rendering=r,m.tail=r.sibling,m.renderingStartTime=Yn(),r.sibling=null,s=Ft.current,ce(Ft,u?s&1|2:s&1),r):(Nt(r),null);case 22:case 23:return ba(r),lm(),u=r.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(l&536870912)!==0&&(r.flags&128)===0&&(Nt(r),r.subtreeFlags&6&&(r.flags|=8192)):Nt(r),l=r.updateQueue,l!==null&&Td(r,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==l&&(r.flags|=2048),s!==null&&le(yr),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),va(Ut),Nt(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function Aw(s,r){switch(Qf(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return va(Ut),As(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return ea(r),null;case 13:if(ba(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));Hl()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return le(Ft),null;case 4:return As(),null;case 10:return va(r.type),null;case 22:case 23:return ba(r),lm(),s!==null&&le(yr),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return va(Ut),null;case 25:return null;default:return null}}function Xb(s,r){switch(Qf(r),r.tag){case 3:va(Ut),As();break;case 26:case 27:case 5:ea(r);break;case 4:As();break;case 13:ba(r);break;case 19:le(Ft);break;case 10:va(r.type);break;case 22:case 23:ba(r),lm(),s!==null&&le(yr);break;case 24:va(Ut)}}function oc(s,r){try{var l=r.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var m=u.next;l=m;do{if((l.tag&s)===s){u=void 0;var v=l.create,j=l.inst;u=v(),j.destroy=u}l=l.next}while(l!==m)}}catch(D){ut(r,r.return,D)}}function Za(s,r,l){try{var u=r.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var v=m.next;u=v;do{if((u.tag&s)===s){var j=u.inst,D=j.destroy;if(D!==void 0){j.destroy=void 0,m=r;var z=l,W=D;try{W()}catch(ne){ut(m,z,ne)}}}u=u.next}while(u!==v)}}catch(ne){ut(r,r.return,ne)}}function Wb(s){var r=s.updateQueue;if(r!==null){var l=s.stateNode;try{Vy(r,l)}catch(u){ut(s,s.return,u)}}}function Zb(s,r,l){l.props=xr(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){ut(s,r,u)}}function lc(s,r){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(m){ut(s,r,m)}}function Fs(s,r){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(m){ut(s,r,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){ut(s,r,m)}else l.current=null}function Jb(s){var r=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(m){ut(s,s.return,m)}}function Pm(s,r,l){try{var u=s.stateNode;Yw(u,s.type,l,r),u[It]=r}catch(m){ut(s,s.return,m)}}function ex(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ri(s.type)||s.tag===4}function Lm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||ex(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ri(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vm(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(s),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Pd));else if(u!==4&&(u===27&&ri(s.type)&&(l=s.stateNode,r=null),s=s.child,s!==null))for(Vm(s,r,l),s=s.sibling;s!==null;)Vm(s,r,l),s=s.sibling}function jd(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?l.insertBefore(s,r):l.appendChild(s);else if(u!==4&&(u===27&&ri(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(jd(s,r,l),s=s.sibling;s!==null;)jd(s,r,l),s=s.sibling}function tx(s){var r=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,m=r.attributes;m.length;)r.removeAttributeNode(m[0]);nn(r,u,l),r[Pt]=s,r[It]=l}catch(v){ut(s,s.return,v)}}var _a=!1,Ct=!1,Um=!1,nx=typeof WeakSet=="function"?WeakSet:Set,Qt=null;function ww(s,r){if(s=s.containerInfo,cp=Bd,s=fy(s),Lf(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var m=u.anchorOffset,v=u.focusNode;u=u.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var j=0,D=-1,z=-1,W=0,ne=0,re=s,Z=null;t:for(;;){for(var J;re!==l||m!==0&&re.nodeType!==3||(D=j+m),re!==v||u!==0&&re.nodeType!==3||(z=j+u),re.nodeType===3&&(j+=re.nodeValue.length),(J=re.firstChild)!==null;)Z=re,re=J;for(;;){if(re===s)break t;if(Z===l&&++W===m&&(D=j),Z===v&&++ne===u&&(z=j),(J=re.nextSibling)!==null)break;re=Z,Z=re.parentNode}re=J}l=D===-1||z===-1?null:{start:D,end:z}}else l=null}l=l||{start:0,end:0}}else l=null;for(up={focusedElem:s,selectionRange:l},Bd=!1,Qt=r;Qt!==null;)if(r=Qt,s=r.child,(r.subtreeFlags&1024)!==0&&s!==null)s.return=r,Qt=s;else for(;Qt!==null;){switch(r=Qt,v=r.alternate,s=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,l=r,m=v.memoizedProps,v=v.memoizedState,u=l.stateNode;try{var Se=xr(l.type,m,l.elementType===l.type);s=u.getSnapshotBeforeUpdate(Se,v),u.__reactInternalSnapshotBeforeUpdate=s}catch(je){ut(l,l.return,je)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,l=s.nodeType,l===9)fp(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":fp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,Qt=s;break}Qt=r.return}}function sx(s,r,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Ja(s,l),u&4&&oc(5,l);break;case 1:if(Ja(s,l),u&4)if(s=l.stateNode,r===null)try{s.componentDidMount()}catch(j){ut(l,l.return,j)}else{var m=xr(l.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(m,r,s.__reactInternalSnapshotBeforeUpdate)}catch(j){ut(l,l.return,j)}}u&64&&Wb(l),u&512&&lc(l,l.return);break;case 3:if(Ja(s,l),u&64&&(s=l.updateQueue,s!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Vy(s,r)}catch(j){ut(l,l.return,j)}}break;case 27:r===null&&u&4&&tx(l);case 26:case 5:Ja(s,l),r===null&&u&4&&Jb(l),u&512&&lc(l,l.return);break;case 12:Ja(s,l);break;case 13:Ja(s,l),u&4&&rx(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=Pw.bind(null,l),eC(s,l))));break;case 22:if(u=l.memoizedState!==null||_a,!u){r=r!==null&&r.memoizedState!==null||Ct,m=_a;var v=Ct;_a=u,(Ct=r)&&!v?ei(s,l,(l.subtreeFlags&8772)!==0):Ja(s,l),_a=m,Ct=v}break;case 30:break;default:Ja(s,l)}}function ax(s){var r=s.alternate;r!==null&&(s.alternate=null,ax(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&qa(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var xt=null,wn=!1;function Ea(s,r,l){for(l=l.child;l!==null;)ix(s,r,l),l=l.sibling}function ix(s,r,l){if(st&&typeof st.onCommitFiberUnmount=="function")try{st.onCommitFiberUnmount(Et,l)}catch{}switch(l.tag){case 26:Ct||Fs(l,r),Ea(s,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ct||Fs(l,r);var u=xt,m=wn;ri(l.type)&&(xt=l.stateNode,wn=!1),Ea(s,r,l),vc(l.stateNode),xt=u,wn=m;break;case 5:Ct||Fs(l,r);case 6:if(u=xt,m=wn,xt=null,Ea(s,r,l),xt=u,wn=m,xt!==null)if(wn)try{(xt.nodeType===9?xt.body:xt.nodeName==="HTML"?xt.ownerDocument.body:xt).removeChild(l.stateNode)}catch(v){ut(l,r,v)}else try{xt.removeChild(l.stateNode)}catch(v){ut(l,r,v)}break;case 18:xt!==null&&(wn?(s=xt,Yx(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),jc(s)):Yx(xt,l.stateNode));break;case 4:u=xt,m=wn,xt=l.stateNode.containerInfo,wn=!0,Ea(s,r,l),xt=u,wn=m;break;case 0:case 11:case 14:case 15:Ct||Za(2,l,r),Ct||Za(4,l,r),Ea(s,r,l);break;case 1:Ct||(Fs(l,r),u=l.stateNode,typeof u.componentWillUnmount=="function"&&Zb(l,r,u)),Ea(s,r,l);break;case 21:Ea(s,r,l);break;case 22:Ct=(u=Ct)||l.memoizedState!==null,Ea(s,r,l),Ct=u;break;default:Ea(s,r,l)}}function rx(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{jc(s)}catch(l){ut(r,r.return,l)}}function Cw(s){switch(s.tag){case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new nx),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new nx),r;default:throw Error(i(435,s.tag))}}function Fm(s,r){var l=Cw(s);r.forEach(function(u){var m=Lw.bind(null,s,u);l.has(u)||(l.add(u),u.then(m,m))})}function Ln(s,r){var l=r.deletions;if(l!==null)for(var u=0;u<l.length;u++){var m=l[u],v=s,j=r,D=j;e:for(;D!==null;){switch(D.tag){case 27:if(ri(D.type)){xt=D.stateNode,wn=!1;break e}break;case 5:xt=D.stateNode,wn=!1;break e;case 3:case 4:xt=D.stateNode.containerInfo,wn=!0;break e}D=D.return}if(xt===null)throw Error(i(160));ix(v,j,m),xt=null,wn=!1,v=m.alternate,v!==null&&(v.return=null),m.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)ox(r,s),r=r.sibling}var gs=null;function ox(s,r){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ln(r,s),Vn(s),u&4&&(Za(3,s,s.return),oc(3,s),Za(5,s,s.return));break;case 1:Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),u&64&&_a&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var m=gs;if(Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),u&4){var v=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":v=m.getElementsByTagName("title")[0],(!v||v[Ki]||v[Pt]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=m.createElement(u),m.head.insertBefore(v,m.querySelector("head > title"))),nn(v,u,l),v[Pt]=s,At(v),u=v;break e;case"link":var j=tN("link","href",m).get(u+(l.href||""));if(j){for(var D=0;D<j.length;D++)if(v=j[D],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){j.splice(D,1);break t}}v=m.createElement(u),nn(v,u,l),m.head.appendChild(v);break;case"meta":if(j=tN("meta","content",m).get(u+(l.content||""))){for(D=0;D<j.length;D++)if(v=j[D],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){j.splice(D,1);break t}}v=m.createElement(u),nn(v,u,l),m.head.appendChild(v);break;default:throw Error(i(468,u))}v[Pt]=s,At(v),u=v}s.stateNode=u}else nN(m,s.type,s.stateNode);else s.stateNode=eN(m,u,s.memoizedProps);else v!==u?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,u===null?nN(m,s.type,s.stateNode):eN(m,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Pm(s,s.memoizedProps,l.memoizedProps)}break;case 27:Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),l!==null&&u&4&&Pm(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),s.flags&32){m=s.stateNode;try{Kn(m,"")}catch(J){ut(s,s.return,J)}}u&4&&s.stateNode!=null&&(m=s.memoizedProps,Pm(s,m,l!==null?l.memoizedProps:m)),u&1024&&(Um=!0);break;case 6:if(Ln(r,s),Vn(s),u&4){if(s.stateNode===null)throw Error(i(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(J){ut(s,s.return,J)}}break;case 3:if(Fd=null,m=gs,gs=Vd(r.containerInfo),Ln(r,s),gs=m,Vn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{jc(r.containerInfo)}catch(J){ut(s,s.return,J)}Um&&(Um=!1,lx(s));break;case 4:u=gs,gs=Vd(s.stateNode.containerInfo),Ln(r,s),Vn(s),gs=u;break;case 12:Ln(r,s),Vn(s);break;case 13:Ln(r,s),Vn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&($m=Yn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Fm(s,u)));break;case 22:m=s.memoizedState!==null;var z=l!==null&&l.memoizedState!==null,W=_a,ne=Ct;if(_a=W||m,Ct=ne||z,Ln(r,s),Ct=ne,_a=W,Vn(s),u&8192)e:for(r=s.stateNode,r._visibility=m?r._visibility&-2:r._visibility|1,m&&(l===null||z||_a||Ct||Nr(s)),l=null,r=s;;){if(r.tag===5||r.tag===26){if(l===null){z=l=r;try{if(v=z.stateNode,m)j=v.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none";else{D=z.stateNode;var re=z.memoizedProps.style,Z=re!=null&&re.hasOwnProperty("display")?re.display:null;D.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(J){ut(z,z.return,J)}}}else if(r.tag===6){if(l===null){z=r;try{z.stateNode.nodeValue=m?"":z.memoizedProps}catch(J){ut(z,z.return,J)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Fm(s,l))));break;case 19:Ln(r,s),Vn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Fm(s,u)));break;case 30:break;case 21:break;default:Ln(r,s),Vn(s)}}function Vn(s){var r=s.flags;if(r&2){try{for(var l,u=s.return;u!==null;){if(ex(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var m=l.stateNode,v=Lm(s);jd(s,v,m);break;case 5:var j=l.stateNode;l.flags&32&&(Kn(j,""),l.flags&=-33);var D=Lm(s);jd(s,D,j);break;case 3:case 4:var z=l.stateNode.containerInfo,W=Lm(s);Vm(s,W,z);break;default:throw Error(i(161))}}catch(ne){ut(s,s.return,ne)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function lx(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;lx(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function Ja(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)sx(s,r.alternate,r),r=r.sibling}function Nr(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:Za(4,r,r.return),Nr(r);break;case 1:Fs(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&Zb(r,r.return,l),Nr(r);break;case 27:vc(r.stateNode);case 26:case 5:Fs(r,r.return),Nr(r);break;case 22:r.memoizedState===null&&Nr(r);break;case 30:Nr(r);break;default:Nr(r)}s=s.sibling}}function ei(s,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,m=s,v=r,j=v.flags;switch(v.tag){case 0:case 11:case 15:ei(m,v,l),oc(4,v);break;case 1:if(ei(m,v,l),u=v,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(W){ut(u,u.return,W)}if(u=v,m=u.updateQueue,m!==null){var D=u.stateNode;try{var z=m.shared.hiddenCallbacks;if(z!==null)for(m.shared.hiddenCallbacks=null,m=0;m<z.length;m++)Ly(z[m],D)}catch(W){ut(u,u.return,W)}}l&&j&64&&Wb(v),lc(v,v.return);break;case 27:tx(v);case 26:case 5:ei(m,v,l),l&&u===null&&j&4&&Jb(v),lc(v,v.return);break;case 12:ei(m,v,l);break;case 13:ei(m,v,l),l&&j&4&&rx(m,v);break;case 22:v.memoizedState===null&&ei(m,v,l),lc(v,v.return);break;case 30:break;default:ei(m,v,l)}r=r.sibling}}function qm(s,r){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Yl(l))}function zm(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Yl(s))}function qs(s,r,l,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)cx(s,r,l,u),r=r.sibling}function cx(s,r,l,u){var m=r.flags;switch(r.tag){case 0:case 11:case 15:qs(s,r,l,u),m&2048&&oc(9,r);break;case 1:qs(s,r,l,u);break;case 3:qs(s,r,l,u),m&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Yl(s)));break;case 12:if(m&2048){qs(s,r,l,u),s=r.stateNode;try{var v=r.memoizedProps,j=v.id,D=v.onPostCommit;typeof D=="function"&&D(j,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(z){ut(r,r.return,z)}}else qs(s,r,l,u);break;case 13:qs(s,r,l,u);break;case 23:break;case 22:v=r.stateNode,j=r.alternate,r.memoizedState!==null?v._visibility&2?qs(s,r,l,u):cc(s,r):v._visibility&2?qs(s,r,l,u):(v._visibility|=2,Eo(s,r,l,u,(r.subtreeFlags&10256)!==0)),m&2048&&qm(j,r);break;case 24:qs(s,r,l,u),m&2048&&zm(r.alternate,r);break;default:qs(s,r,l,u)}}function Eo(s,r,l,u,m){for(m=m&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var v=s,j=r,D=l,z=u,W=j.flags;switch(j.tag){case 0:case 11:case 15:Eo(v,j,D,z,m),oc(8,j);break;case 23:break;case 22:var ne=j.stateNode;j.memoizedState!==null?ne._visibility&2?Eo(v,j,D,z,m):cc(v,j):(ne._visibility|=2,Eo(v,j,D,z,m)),m&&W&2048&&qm(j.alternate,j);break;case 24:Eo(v,j,D,z,m),m&&W&2048&&zm(j.alternate,j);break;default:Eo(v,j,D,z,m)}r=r.sibling}}function cc(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=s,u=r,m=u.flags;switch(u.tag){case 22:cc(l,u),m&2048&&qm(u.alternate,u);break;case 24:cc(l,u),m&2048&&zm(u.alternate,u);break;default:cc(l,u)}r=r.sibling}}var uc=8192;function To(s){if(s.subtreeFlags&uc)for(s=s.child;s!==null;)ux(s),s=s.sibling}function ux(s){switch(s.tag){case 26:To(s),s.flags&uc&&s.memoizedState!==null&&fC(gs,s.memoizedState,s.memoizedProps);break;case 5:To(s);break;case 3:case 4:var r=gs;gs=Vd(s.stateNode.containerInfo),To(s),gs=r;break;case 22:s.memoizedState===null&&(r=s.alternate,r!==null&&r.memoizedState!==null?(r=uc,uc=16777216,To(s),uc=r):To(s));break;default:To(s)}}function dx(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function dc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Qt=u,fx(u,s)}dx(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)hx(s),s=s.sibling}function hx(s){switch(s.tag){case 0:case 11:case 15:dc(s),s.flags&2048&&Za(9,s,s.return);break;case 3:dc(s);break;case 12:dc(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Ad(s)):dc(s);break;default:dc(s)}}function Ad(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Qt=u,fx(u,s)}dx(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:Za(8,r,r.return),Ad(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,Ad(r));break;default:Ad(r)}s=s.sibling}}function fx(s,r){for(;Qt!==null;){var l=Qt;switch(l.tag){case 0:case 11:case 15:Za(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Yl(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Qt=u;else e:for(l=s;Qt!==null;){u=Qt;var m=u.sibling,v=u.return;if(ax(u),u===l){Qt=null;break e}if(m!==null){m.return=v,Qt=m;break e}Qt=v}}}var Sw={getCacheForType:function(s){var r=un(Ut),l=r.data.get(s);return l===void 0&&(l=s(),r.data.set(s,l)),l}},Iw=typeof WeakMap=="function"?WeakMap:Map,at=0,pt=null,He=null,Xe=0,it=0,Un=null,ti=!1,jo=!1,Bm=!1,Ta=0,jt=0,ni=0,_r=0,Hm=0,as=0,Ao=0,hc=null,Cn=null,Gm=!1,$m=0,wd=1/0,Cd=null,si=null,tn=0,ai=null,wo=null,Co=0,Ym=0,Qm=null,mx=null,fc=0,Km=null;function Fn(){if((at&2)!==0&&Xe!==0)return Xe&-Xe;if(Q.T!==null){var s=po;return s!==0?s:np()}return Ua()}function px(){as===0&&(as=(Xe&536870912)===0||tt?_l():536870912);var s=ss.current;return s!==null&&(s.flags|=32),as}function qn(s,r,l){(s===pt&&(it===2||it===9)||s.cancelPendingCommit!==null)&&(So(s,0),ii(s,Xe,as,!1)),na(s,l),((at&2)===0||s!==pt)&&(s===pt&&((at&2)===0&&(_r|=l),jt===4&&ii(s,Xe,as,!1)),zs(s))}function gx(s,r,l){if((at&6)!==0)throw Error(i(327));var u=!l&&(r&124)===0&&(r&s.expiredLanes)===0||Qi(s,r),m=u?Mw(s,r):Zm(s,r,!0),v=u;do{if(m===0){jo&&!u&&ii(s,r,0,!1);break}else{if(l=s.current.alternate,v&&!Rw(l)){m=Zm(s,r,!1),v=!1;continue}if(m===2){if(v=r,s.errorRecoveryDisabledLanes&v)var j=0;else j=s.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){r=j;e:{var D=s;m=hc;var z=D.current.memoizedState.isDehydrated;if(z&&(So(D,j).flags|=256),j=Zm(D,j,!1),j!==2){if(Bm&&!z){D.errorRecoveryDisabledLanes|=v,_r|=v,m=4;break e}v=Cn,Cn=m,v!==null&&(Cn===null?Cn=v:Cn.push.apply(Cn,v))}m=j}if(v=!1,m!==2)continue}}if(m===1){So(s,0),ii(s,r,0,!0);break}e:{switch(u=s,v=m,v){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:ii(u,r,as,!ti);break e;case 2:Cn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(m=$m+300-Yn(),10<m)){if(ii(u,r,as,!ti),Gr(u,0,!0)!==0)break e;u.timeoutHandle=Gx(vx.bind(null,u,l,Cn,Cd,Gm,r,as,_r,Ao,ti,v,2,-0,0),m);break e}vx(u,l,Cn,Cd,Gm,r,as,_r,Ao,ti,v,0,-0,0)}}break}while(!0);zs(s)}function vx(s,r,l,u,m,v,j,D,z,W,ne,re,Z,J){if(s.timeoutHandle=-1,re=r.subtreeFlags,(re&8192||(re&16785408)===16785408)&&(xc={stylesheets:null,count:0,unsuspend:hC},ux(r),re=mC(),re!==null)){s.cancelPendingCommit=re(Tx.bind(null,s,r,v,l,u,m,j,D,z,ne,1,Z,J)),ii(s,v,j,!W);return}Tx(s,r,v,l,u,m,j,D,z)}function Rw(s){for(var r=s;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var m=l[u],v=m.getSnapshot;m=m.value;try{if(!kn(v(),m))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function ii(s,r,l,u){r&=~Hm,r&=~_r,s.suspendedLanes|=r,s.pingedLanes&=~r,u&&(s.warmLanes|=r),u=s.expirationTimes;for(var m=r;0<m;){var v=31-cn(m),j=1<<v;u[v]=-1,m&=~j}l!==0&&ws(s,l,r)}function Sd(){return(at&6)===0?(mc(0),!1):!0}function Xm(){if(He!==null){if(it===0)var s=He.return;else s=He,ga=gr=null,fm(s),No=null,ac=0,s=He;for(;s!==null;)Xb(s.alternate,s),s=s.return;He=null}}function So(s,r){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,Kw(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Xm(),pt=s,He=l=fa(s.current,null),Xe=r,it=0,Un=null,ti=!1,jo=Qi(s,r),Bm=!1,Ao=as=Hm=_r=ni=jt=0,Cn=hc=null,Gm=!1,(r&8)!==0&&(r|=r&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=r;0<u;){var m=31-cn(u),v=1<<m;r|=s[m],u&=~v}return Ta=r,Wu(),l}function yx(s,r){Fe=null,Q.H=gd,r===Kl||r===rd?(r=ky(),it=3):r===Dy?(r=ky(),it=4):it=r===Pb?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Un=r,He===null&&(jt=1,Nd(s,Jn(r,s.current)))}function bx(){var s=Q.H;return Q.H=gd,s===null?gd:s}function xx(){var s=Q.A;return Q.A=Sw,s}function Wm(){jt=4,ti||(Xe&4194048)!==Xe&&ss.current!==null||(jo=!0),(ni&134217727)===0&&(_r&134217727)===0||pt===null||ii(pt,Xe,as,!1)}function Zm(s,r,l){var u=at;at|=2;var m=bx(),v=xx();(pt!==s||Xe!==r)&&(Cd=null,So(s,r)),r=!1;var j=jt;e:do try{if(it!==0&&He!==null){var D=He,z=Un;switch(it){case 8:Xm(),j=6;break e;case 3:case 2:case 9:case 6:ss.current===null&&(r=!0);var W=it;if(it=0,Un=null,Io(s,D,z,W),l&&jo){j=0;break e}break;default:W=it,it=0,Un=null,Io(s,D,z,W)}}Dw(),j=jt;break}catch(ne){yx(s,ne)}while(!0);return r&&s.shellSuspendCounter++,ga=gr=null,at=u,Q.H=m,Q.A=v,He===null&&(pt=null,Xe=0,Wu()),j}function Dw(){for(;He!==null;)Nx(He)}function Mw(s,r){var l=at;at|=2;var u=bx(),m=xx();pt!==s||Xe!==r?(Cd=null,wd=Yn()+500,So(s,r)):jo=Qi(s,r);e:do try{if(it!==0&&He!==null){r=He;var v=Un;t:switch(it){case 1:it=0,Un=null,Io(s,r,v,1);break;case 2:case 9:if(My(v)){it=0,Un=null,_x(r);break}r=function(){it!==2&&it!==9||pt!==s||(it=7),zs(s)},v.then(r,r);break e;case 3:it=7;break e;case 4:it=5;break e;case 7:My(v)?(it=0,Un=null,_x(r)):(it=0,Un=null,Io(s,r,v,7));break;case 5:var j=null;switch(He.tag){case 26:j=He.memoizedState;case 5:case 27:var D=He;if(!j||sN(j)){it=0,Un=null;var z=D.sibling;if(z!==null)He=z;else{var W=D.return;W!==null?(He=W,Id(W)):He=null}break t}}it=0,Un=null,Io(s,r,v,5);break;case 6:it=0,Un=null,Io(s,r,v,6);break;case 8:Xm(),jt=6;break e;default:throw Error(i(462))}}Ow();break}catch(ne){yx(s,ne)}while(!0);return ga=gr=null,Q.H=u,Q.A=m,at=l,He!==null?0:(pt=null,Xe=0,Wu(),jt)}function Ow(){for(;He!==null&&!yl();)Nx(He)}function Nx(s){var r=Qb(s.alternate,s,Ta);s.memoizedProps=s.pendingProps,r===null?Id(s):He=r}function _x(s){var r=s,l=r.alternate;switch(r.tag){case 15:case 0:r=zb(l,r,r.pendingProps,r.type,void 0,Xe);break;case 11:r=zb(l,r,r.pendingProps,r.type.render,r.ref,Xe);break;case 5:fm(r);default:Xb(l,r),r=He=Ey(r,Ta),r=Qb(l,r,Ta)}s.memoizedProps=s.pendingProps,r===null?Id(s):He=r}function Io(s,r,l,u){ga=gr=null,fm(r),No=null,ac=0;var m=r.return;try{if(Ew(s,m,r,l,Xe)){jt=1,Nd(s,Jn(l,s.current)),He=null;return}}catch(v){if(m!==null)throw He=m,v;jt=1,Nd(s,Jn(l,s.current)),He=null;return}r.flags&32768?(tt||u===1?s=!0:jo||(Xe&536870912)!==0?s=!1:(ti=s=!0,(u===2||u===9||u===3||u===6)&&(u=ss.current,u!==null&&u.tag===13&&(u.flags|=16384))),Ex(r,s)):Id(r)}function Id(s){var r=s;do{if((r.flags&32768)!==0){Ex(r,ti);return}s=r.return;var l=jw(r.alternate,r,Ta);if(l!==null){He=l;return}if(r=r.sibling,r!==null){He=r;return}He=r=s}while(r!==null);jt===0&&(jt=5)}function Ex(s,r){do{var l=Aw(s.alternate,s);if(l!==null){l.flags&=32767,He=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(s=s.sibling,s!==null)){He=s;return}He=s=l}while(s!==null);jt=6,He=null}function Tx(s,r,l,u,m,v,j,D,z){s.cancelPendingCommit=null;do Rd();while(tn!==0);if((at&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(v=r.lanes|r.childLanes,v|=zf,Tl(s,l,v,j,D,z),s===pt&&(He=pt=null,Xe=0),wo=r,ai=s,Co=l,Ym=v,Qm=m,mx=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Vw(Hi,function(){return Sx(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=Q.T,Q.T=null,m=se.p,se.p=2,j=at,at|=4;try{ww(s,r,l)}finally{at=j,se.p=m,Q.T=u}}tn=1,jx(),Ax(),wx()}}function jx(){if(tn===1){tn=0;var s=ai,r=wo,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=Q.T,Q.T=null;var u=se.p;se.p=2;var m=at;at|=4;try{ox(r,s);var v=up,j=fy(s.containerInfo),D=v.focusedElem,z=v.selectionRange;if(j!==D&&D&&D.ownerDocument&&hy(D.ownerDocument.documentElement,D)){if(z!==null&&Lf(D)){var W=z.start,ne=z.end;if(ne===void 0&&(ne=W),"selectionStart"in D)D.selectionStart=W,D.selectionEnd=Math.min(ne,D.value.length);else{var re=D.ownerDocument||document,Z=re&&re.defaultView||window;if(Z.getSelection){var J=Z.getSelection(),Se=D.textContent.length,je=Math.min(z.start,Se),ct=z.end===void 0?je:Math.min(z.end,Se);!J.extend&&je>ct&&(j=ct,ct=je,je=j);var Y=dy(D,je),H=dy(D,ct);if(Y&&H&&(J.rangeCount!==1||J.anchorNode!==Y.node||J.anchorOffset!==Y.offset||J.focusNode!==H.node||J.focusOffset!==H.offset)){var X=re.createRange();X.setStart(Y.node,Y.offset),J.removeAllRanges(),je>ct?(J.addRange(X),J.extend(H.node,H.offset)):(X.setEnd(H.node,H.offset),J.addRange(X))}}}}for(re=[],J=D;J=J.parentNode;)J.nodeType===1&&re.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<re.length;D++){var ae=re[D];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}Bd=!!cp,up=cp=null}finally{at=m,se.p=u,Q.T=l}}s.current=r,tn=2}}function Ax(){if(tn===2){tn=0;var s=ai,r=wo,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=Q.T,Q.T=null;var u=se.p;se.p=2;var m=at;at|=4;try{sx(s,r.alternate,r)}finally{at=m,se.p=u,Q.T=l}}tn=3}}function wx(){if(tn===4||tn===3){tn=0,Au();var s=ai,r=wo,l=Co,u=mx;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?tn=5:(tn=0,wo=ai=null,Cx(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(si=null),$r(l),r=r.stateNode,st&&typeof st.onCommitFiberRoot=="function")try{st.onCommitFiberRoot(Et,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=Q.T,m=se.p,se.p=2,Q.T=null;try{for(var v=s.onRecoverableError,j=0;j<u.length;j++){var D=u[j];v(D.value,{componentStack:D.stack})}}finally{Q.T=r,se.p=m}}(Co&3)!==0&&Rd(),zs(s),m=s.pendingLanes,(l&4194090)!==0&&(m&42)!==0?s===Km?fc++:(fc=0,Km=s):fc=0,mc(0)}}function Cx(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Yl(r)))}function Rd(s){return jx(),Ax(),wx(),Sx()}function Sx(){if(tn!==5)return!1;var s=ai,r=Ym;Ym=0;var l=$r(Co),u=Q.T,m=se.p;try{se.p=32>l?32:l,Q.T=null,l=Qm,Qm=null;var v=ai,j=Co;if(tn=0,wo=ai=null,Co=0,(at&6)!==0)throw Error(i(331));var D=at;if(at|=4,hx(v.current),cx(v,v.current,j,l),at=D,mc(0,!1),st&&typeof st.onPostCommitFiberRoot=="function")try{st.onPostCommitFiberRoot(Et,v)}catch{}return!0}finally{se.p=m,Q.T=u,Cx(s,r)}}function Ix(s,r,l){r=Jn(l,r),r=wm(s.stateNode,r,2),s=Qa(s,r,2),s!==null&&(na(s,2),zs(s))}function ut(s,r,l){if(s.tag===3)Ix(s,s,l);else for(;r!==null;){if(r.tag===3){Ix(r,s,l);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(si===null||!si.has(u))){s=Jn(l,s),l=Ob(2),u=Qa(r,l,2),u!==null&&(kb(l,u,r,s),na(u,2),zs(u));break}}r=r.return}}function Jm(s,r,l){var u=s.pingCache;if(u===null){u=s.pingCache=new Iw;var m=new Set;u.set(r,m)}else m=u.get(r),m===void 0&&(m=new Set,u.set(r,m));m.has(l)||(Bm=!0,m.add(l),s=kw.bind(null,s,r,l),r.then(s,s))}function kw(s,r,l){var u=s.pingCache;u!==null&&u.delete(r),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,pt===s&&(Xe&l)===l&&(jt===4||jt===3&&(Xe&62914560)===Xe&&300>Yn()-$m?(at&2)===0&&So(s,0):Hm|=l,Ao===Xe&&(Ao=0)),zs(s)}function Rx(s,r){r===0&&(r=El()),s=uo(s,r),s!==null&&(na(s,r),zs(s))}function Pw(s){var r=s.memoizedState,l=0;r!==null&&(l=r.retryLane),Rx(s,l)}function Lw(s,r){var l=0;switch(s.tag){case 13:var u=s.stateNode,m=s.memoizedState;m!==null&&(l=m.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),Rx(s,l)}function Vw(s,r){return zi(s,r)}var Dd=null,Ro=null,ep=!1,Md=!1,tp=!1,Er=0;function zs(s){s!==Ro&&s.next===null&&(Ro===null?Dd=Ro=s:Ro=Ro.next=s),Md=!0,ep||(ep=!0,Fw())}function mc(s,r){if(!tp&&Md){tp=!0;do for(var l=!1,u=Dd;u!==null;){if(s!==0){var m=u.pendingLanes;if(m===0)var v=0;else{var j=u.suspendedLanes,D=u.pingedLanes;v=(1<<31-cn(42|s)+1)-1,v&=m&~(j&~D),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,kx(u,v))}else v=Xe,v=Gr(u,u===pt?v:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(v&3)===0||Qi(u,v)||(l=!0,kx(u,v));u=u.next}while(l);tp=!1}}function Uw(){Dx()}function Dx(){Md=ep=!1;var s=0;Er!==0&&(Qw()&&(s=Er),Er=0);for(var r=Yn(),l=null,u=Dd;u!==null;){var m=u.next,v=Mx(u,r);v===0?(u.next=null,l===null?Dd=m:l.next=m,m===null&&(Ro=l)):(l=u,(s!==0||(v&3)!==0)&&(Md=!0)),u=m}mc(s)}function Mx(s,r){for(var l=s.suspendedLanes,u=s.pingedLanes,m=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var j=31-cn(v),D=1<<j,z=m[j];z===-1?((D&l)===0||(D&u)!==0)&&(m[j]=Nl(D,r)):z<=r&&(s.expiredLanes|=D),v&=~D}if(r=pt,l=Xe,l=Gr(s,s===r?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===r&&(it===2||it===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Bi(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Qi(s,l)){if(r=l&-l,r===s.callbackPriority)return r;switch(u!==null&&Bi(u),$r(l)){case 2:case 8:l=Br;break;case 32:l=Hi;break;case 268435456:l=Hr;break;default:l=Hi}return u=Ox.bind(null,s),l=zi(l,u),s.callbackPriority=r,s.callbackNode=l,r}return u!==null&&u!==null&&Bi(u),s.callbackPriority=2,s.callbackNode=null,2}function Ox(s,r){if(tn!==0&&tn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Rd()&&s.callbackNode!==l)return null;var u=Xe;return u=Gr(s,s===pt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(gx(s,u,r),Mx(s,Yn()),s.callbackNode!=null&&s.callbackNode===l?Ox.bind(null,s):null)}function kx(s,r){if(Rd())return null;gx(s,r,!0)}function Fw(){Xw(function(){(at&6)!==0?zi(bl,Uw):Dx()})}function np(){return Er===0&&(Er=_l()),Er}function Px(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Zr(""+s)}function Lx(s,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,s.id&&l.setAttribute("form",s.id),r.parentNode.insertBefore(l,r),s=new FormData(s),l.parentNode.removeChild(l),s}function qw(s,r,l,u,m){if(r==="submit"&&l&&l.stateNode===m){var v=Px((m[It]||null).action),j=u.submitter;j&&(r=(r=j[It]||null)?Px(r.formAction):j.getAttribute("formAction"),r!==null&&(v=r,j=null));var D=new Jr("action","action",null,u,m);s.push({event:D,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Er!==0){var z=j?Lx(m,j):new FormData(m);_m(l,{pending:!0,data:z,method:m.method,action:v},null,z)}}else typeof v=="function"&&(D.preventDefault(),z=j?Lx(m,j):new FormData(m),_m(l,{pending:!0,data:z,method:m.method,action:v},v,z))},currentTarget:m}]})}}for(var sp=0;sp<qf.length;sp++){var ap=qf[sp],zw=ap.toLowerCase(),Bw=ap[0].toUpperCase()+ap.slice(1);ps(zw,"on"+Bw)}ps(gy,"onAnimationEnd"),ps(vy,"onAnimationIteration"),ps(yy,"onAnimationStart"),ps("dblclick","onDoubleClick"),ps("focusin","onFocus"),ps("focusout","onBlur"),ps(rw,"onTransitionRun"),ps(ow,"onTransitionStart"),ps(lw,"onTransitionCancel"),ps(by,"onTransitionEnd"),aa("onMouseEnter",["mouseout","mouseover"]),aa("onMouseLeave",["mouseout","mouseover"]),aa("onPointerEnter",["pointerout","pointerover"]),aa("onPointerLeave",["pointerout","pointerover"]),fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fs("onBeforeInput",["compositionend","keypress","textInput","paste"]),fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(pc));function Vx(s,r){r=(r&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],m=u.event;u=u.listeners;e:{var v=void 0;if(r)for(var j=u.length-1;0<=j;j--){var D=u[j],z=D.instance,W=D.currentTarget;if(D=D.listener,z!==v&&m.isPropagationStopped())break e;v=D,m.currentTarget=W;try{v(m)}catch(ne){xd(ne)}m.currentTarget=null,v=z}else for(j=0;j<u.length;j++){if(D=u[j],z=D.instance,W=D.currentTarget,D=D.listener,z!==v&&m.isPropagationStopped())break e;v=D,m.currentTarget=W;try{v(m)}catch(ne){xd(ne)}m.currentTarget=null,v=z}}}}function Ge(s,r){var l=r[Al];l===void 0&&(l=r[Al]=new Set);var u=s+"__bubble";l.has(u)||(Ux(r,s,2,!1),l.add(u))}function ip(s,r,l){var u=0;r&&(u|=4),Ux(l,s,u,r)}var Od="_reactListening"+Math.random().toString(36).slice(2);function rp(s){if(!s[Od]){s[Od]=!0,wl.forEach(function(l){l!=="selectionchange"&&(Hw.has(l)||ip(l,!1,s),ip(l,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Od]||(r[Od]=!0,ip("selectionchange",!1,r))}}function Ux(s,r,l,u){switch(cN(r)){case 2:var m=vC;break;case 8:m=yC;break;default:m=xp}l=m.bind(null,r,l,s),m=void 0,!Wn||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),u?m!==void 0?s.addEventListener(r,l,{capture:!0,passive:m}):s.addEventListener(r,l,!0):m!==void 0?s.addEventListener(r,l,{passive:m}):s.addEventListener(r,l,!1)}function op(s,r,l,u,m){var v=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var j=u.tag;if(j===3||j===4){var D=u.stateNode.containerInfo;if(D===m)break;if(j===4)for(j=u.return;j!==null;){var z=j.tag;if((z===3||z===4)&&j.stateNode.containerInfo===m)return;j=j.return}for(;D!==null;){if(j=sa(D),j===null)return;if(z=j.tag,z===5||z===6||z===26||z===27){u=v=j;continue e}D=D.parentNode}}u=u.return}Pu(function(){var W=v,ne=Xn(l),re=[];e:{var Z=xy.get(s);if(Z!==void 0){var J=Jr,Se=s;switch(s){case"keypress":if(Ms(l)===0)break e;case"keydown":case"keyup":J=io;break;case"focusin":Se="focus",J=no;break;case"focusout":Se="blur",J=no;break;case"beforeblur":case"afterblur":J=no;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=Zn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=Mf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=Hu;break;case gy:case vy:case yy:J=so;break;case by:J=$u;break;case"scroll":case"scrollend":J=Lu;break;case"wheel":J=ro;break;case"copy":case"cut":case"paste":J=ao;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=Ul;break;case"toggle":case"beforetoggle":J=Qu}var je=(r&4)!==0,ct=!je&&(s==="scroll"||s==="scrollend"),Y=je?Z!==null?Z+"Capture":null:Z;je=[];for(var H=W,X;H!==null;){var ae=H;if(X=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||X===null||Y===null||(ae=nr(H,Y),ae!=null&&je.push(gc(H,ae,X))),ct)break;H=H.return}0<je.length&&(Z=new J(Z,Se,null,l,ne),re.push({event:Z,listeners:je}))}}if((r&7)===0){e:{if(Z=s==="mouseover"||s==="pointerover",J=s==="mouseout"||s==="pointerout",Z&&l!==oa&&(Se=l.relatedTarget||l.fromElement)&&(sa(Se)||Se[Qn]))break e;if((J||Z)&&(Z=ne.window===ne?ne:(Z=ne.ownerDocument)?Z.defaultView||Z.parentWindow:window,J?(Se=l.relatedTarget||l.toElement,J=W,Se=Se?sa(Se):null,Se!==null&&(ct=c(Se),je=Se.tag,Se!==ct||je!==5&&je!==27&&je!==6)&&(Se=null)):(J=null,Se=W),J!==Se)){if(je=Zn,ae="onMouseLeave",Y="onMouseEnter",H="mouse",(s==="pointerout"||s==="pointerover")&&(je=Ul,ae="onPointerLeave",Y="onPointerEnter",H="pointer"),ct=J==null?Z:Ss(J),X=Se==null?Z:Ss(Se),Z=new je(ae,H+"leave",J,l,ne),Z.target=ct,Z.relatedTarget=X,ae=null,sa(ne)===W&&(je=new je(Y,H+"enter",Se,l,ne),je.target=X,je.relatedTarget=ct,ae=je),ct=ae,J&&Se)t:{for(je=J,Y=Se,H=0,X=je;X;X=Do(X))H++;for(X=0,ae=Y;ae;ae=Do(ae))X++;for(;0<H-X;)je=Do(je),H--;for(;0<X-H;)Y=Do(Y),X--;for(;H--;){if(je===Y||Y!==null&&je===Y.alternate)break t;je=Do(je),Y=Do(Y)}je=null}else je=null;J!==null&&Fx(re,Z,J,je,!1),Se!==null&&ct!==null&&Fx(re,ct,Se,je,!0)}}e:{if(Z=W?Ss(W):window,J=Z.nodeName&&Z.nodeName.toLowerCase(),J==="select"||J==="input"&&Z.type==="file")var ye=iy;else if(Vt(Z))if(ry)ye=sw;else{ye=tw;var Be=ew}else J=Z.nodeName,!J||J.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?W&&Dl(W.elementType)&&(ye=iy):ye=nw;if(ye&&(ye=ye(s,W))){ha(re,ye,l,ne);break e}Be&&Be(s,Z,W),s==="focusout"&&W&&Z.type==="number"&&W.memoizedProps.value!=null&&Ba(Z,"number",Z.value)}switch(Be=W?Ss(W):window,s){case"focusin":(Vt(Be)||Be.contentEditable==="true")&&(oo=Be,Vf=W,zl=null);break;case"focusout":zl=Vf=oo=null;break;case"mousedown":Uf=!0;break;case"contextmenu":case"mouseup":case"dragend":Uf=!1,my(re,l,ne);break;case"selectionchange":if(iw)break;case"keydown":case"keyup":my(re,l,ne)}var xe;if(Ps)e:{switch(s){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else Qe?te(s,l)&&(Ae="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Ae="onCompositionStart");Ae&&(E&&l.locale!=="ko"&&(Qe||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&Qe&&(xe=Ol()):(Ds=ne,Ha="value"in Ds?Ds.value:Ds.textContent,Qe=!0)),Be=kd(W,Ae),0<Be.length&&(Ae=new Ll(Ae,s,null,l,ne),re.push({event:Ae,listeners:Be}),xe?Ae.data=xe:(xe=he(l),xe!==null&&(Ae.data=xe)))),(xe=b?Lt(s,l):Ke(s,l))&&(Ae=kd(W,"onBeforeInput"),0<Ae.length&&(Be=new Ll("onBeforeInput","beforeinput",null,l,ne),re.push({event:Be,listeners:Ae}),Be.data=xe)),qw(re,s,W,l,ne)}Vx(re,r)})}function gc(s,r,l){return{instance:s,listener:r,currentTarget:l}}function kd(s,r){for(var l=r+"Capture",u=[];s!==null;){var m=s,v=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||v===null||(m=nr(s,l),m!=null&&u.unshift(gc(s,m,v)),m=nr(s,r),m!=null&&u.push(gc(s,m,v))),s.tag===3)return u;s=s.return}return[]}function Do(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Fx(s,r,l,u,m){for(var v=r._reactName,j=[];l!==null&&l!==u;){var D=l,z=D.alternate,W=D.stateNode;if(D=D.tag,z!==null&&z===u)break;D!==5&&D!==26&&D!==27||W===null||(z=W,m?(W=nr(l,v),W!=null&&j.unshift(gc(l,W,z))):m||(W=nr(l,v),W!=null&&j.push(gc(l,W,z)))),l=l.return}j.length!==0&&s.push({event:r,listeners:j})}var Gw=/\r\n?/g,$w=/\u0000|\uFFFD/g;function qx(s){return(typeof s=="string"?s:""+s).replace(Gw,`
`).replace($w,"")}function zx(s,r){return r=qx(r),qx(s)===r}function Pd(){}function lt(s,r,l,u,m,v){switch(l){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||Kn(s,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&Kn(s,""+u);break;case"className":Is(s,"class",u);break;case"tabIndex":Is(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Is(s,l,u);break;case"style":Rl(s,u,v);break;case"data":if(r!=="object"){Is(s,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Zr(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(r!=="input"&&lt(s,r,"name",m.name,m,null),lt(s,r,"formEncType",m.formEncType,m,null),lt(s,r,"formMethod",m.formMethod,m,null),lt(s,r,"formTarget",m.formTarget,m,null)):(lt(s,r,"encType",m.encType,m,null),lt(s,r,"method",m.method,m,null),lt(s,r,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Zr(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=Pd);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Zr(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":Ge("beforetoggle",s),Ge("toggle",s),za(s,"popover",u);break;case"xlinkActuate":Zt(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Zt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Zt(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Zt(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Zt(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Zt(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":za(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Rf.get(l)||l,za(s,l,u))}}function lp(s,r,l,u,m,v){switch(l){case"style":Rl(s,u,v);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof u=="string"?Kn(s,u):(typeof u=="number"||typeof u=="bigint")&&Kn(s,""+u);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"onClick":u!=null&&(s.onclick=Pd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yr.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),r=l.slice(2,m?l.length-7:void 0),v=s[It]||null,v=v!=null?v[l]:null,typeof v=="function"&&s.removeEventListener(r,v,m),typeof u=="function")){typeof v!="function"&&v!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(r,u,m);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):za(s,l,u)}}}function nn(s,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",s),Ge("load",s);var u=!1,m=!1,v;for(v in l)if(l.hasOwnProperty(v)){var j=l[v];if(j!=null)switch(v){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:lt(s,r,v,j,l,null)}}m&&lt(s,r,"srcSet",l.srcSet,l,null),u&&lt(s,r,"src",l.src,l,null);return;case"input":Ge("invalid",s);var D=v=j=m=null,z=null,W=null;for(u in l)if(l.hasOwnProperty(u)){var ne=l[u];if(ne!=null)switch(u){case"name":m=ne;break;case"type":j=ne;break;case"checked":z=ne;break;case"defaultChecked":W=ne;break;case"value":v=ne;break;case"defaultValue":D=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(i(137,r));break;default:lt(s,r,u,ne,l,null)}}Ji(s,v,D,z,W,j,m,!1),Wr(s);return;case"select":Ge("invalid",s),u=j=v=null;for(m in l)if(l.hasOwnProperty(m)&&(D=l[m],D!=null))switch(m){case"value":v=D;break;case"defaultValue":j=D;break;case"multiple":u=D;default:lt(s,r,m,D,l,null)}r=v,l=j,s.multiple=!!u,r!=null?ra(s,!!u,r,!1):l!=null&&ra(s,!!u,l,!0);return;case"textarea":Ge("invalid",s),v=m=u=null;for(j in l)if(l.hasOwnProperty(j)&&(D=l[j],D!=null))switch(j){case"value":u=D;break;case"defaultValue":m=D;break;case"children":v=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(i(91));break;default:lt(s,r,j,D,l,null)}er(s,u,m,v),Wr(s);return;case"option":for(z in l)if(l.hasOwnProperty(z)&&(u=l[z],u!=null))switch(z){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:lt(s,r,z,u,l,null)}return;case"dialog":Ge("beforetoggle",s),Ge("toggle",s),Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":Ge("load",s);break;case"video":case"audio":for(u=0;u<pc.length;u++)Ge(pc[u],s);break;case"image":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"embed":case"source":case"link":Ge("error",s),Ge("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in l)if(l.hasOwnProperty(W)&&(u=l[W],u!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:lt(s,r,W,u,l,null)}return;default:if(Dl(r)){for(ne in l)l.hasOwnProperty(ne)&&(u=l[ne],u!==void 0&&lp(s,r,ne,u,l,void 0));return}}for(D in l)l.hasOwnProperty(D)&&(u=l[D],u!=null&&lt(s,r,D,u,l,null))}function Yw(s,r,l,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,v=null,j=null,D=null,z=null,W=null,ne=null;for(J in l){var re=l[J];if(l.hasOwnProperty(J)&&re!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":z=re;default:u.hasOwnProperty(J)||lt(s,r,J,null,u,re)}}for(var Z in u){var J=u[Z];if(re=l[Z],u.hasOwnProperty(Z)&&(J!=null||re!=null))switch(Z){case"type":v=J;break;case"name":m=J;break;case"checked":W=J;break;case"defaultChecked":ne=J;break;case"value":j=J;break;case"defaultValue":D=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,r));break;default:J!==re&&lt(s,r,Z,J,u,re)}}On(s,j,D,z,W,ne,v,m);return;case"select":J=j=D=Z=null;for(v in l)if(z=l[v],l.hasOwnProperty(v)&&z!=null)switch(v){case"value":break;case"multiple":J=z;default:u.hasOwnProperty(v)||lt(s,r,v,null,u,z)}for(m in u)if(v=u[m],z=l[m],u.hasOwnProperty(m)&&(v!=null||z!=null))switch(m){case"value":Z=v;break;case"defaultValue":D=v;break;case"multiple":j=v;default:v!==z&&lt(s,r,m,v,u,z)}r=D,l=j,u=J,Z!=null?ra(s,!!l,Z,!1):!!u!=!!l&&(r!=null?ra(s,!!l,r,!0):ra(s,!!l,l?[]:"",!1));return;case"textarea":J=Z=null;for(D in l)if(m=l[D],l.hasOwnProperty(D)&&m!=null&&!u.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:lt(s,r,D,null,u,m)}for(j in u)if(m=u[j],v=l[j],u.hasOwnProperty(j)&&(m!=null||v!=null))switch(j){case"value":Z=m;break;case"defaultValue":J=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==v&&lt(s,r,j,m,u,v)}rt(s,Z,J);return;case"option":for(var Se in l)if(Z=l[Se],l.hasOwnProperty(Se)&&Z!=null&&!u.hasOwnProperty(Se))switch(Se){case"selected":s.selected=!1;break;default:lt(s,r,Se,null,u,Z)}for(z in u)if(Z=u[z],J=l[z],u.hasOwnProperty(z)&&Z!==J&&(Z!=null||J!=null))switch(z){case"selected":s.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:lt(s,r,z,Z,u,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var je in l)Z=l[je],l.hasOwnProperty(je)&&Z!=null&&!u.hasOwnProperty(je)&&lt(s,r,je,null,u,Z);for(W in u)if(Z=u[W],J=l[W],u.hasOwnProperty(W)&&Z!==J&&(Z!=null||J!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,r));break;default:lt(s,r,W,Z,u,J)}return;default:if(Dl(r)){for(var ct in l)Z=l[ct],l.hasOwnProperty(ct)&&Z!==void 0&&!u.hasOwnProperty(ct)&&lp(s,r,ct,void 0,u,Z);for(ne in u)Z=u[ne],J=l[ne],!u.hasOwnProperty(ne)||Z===J||Z===void 0&&J===void 0||lp(s,r,ne,Z,u,J);return}}for(var Y in l)Z=l[Y],l.hasOwnProperty(Y)&&Z!=null&&!u.hasOwnProperty(Y)&&lt(s,r,Y,null,u,Z);for(re in u)Z=u[re],J=l[re],!u.hasOwnProperty(re)||Z===J||Z==null&&J==null||lt(s,r,re,Z,u,J)}var cp=null,up=null;function Ld(s){return s.nodeType===9?s:s.ownerDocument}function Bx(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Hx(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function dp(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var hp=null;function Qw(){var s=window.event;return s&&s.type==="popstate"?s===hp?!1:(hp=s,!0):(hp=null,!1)}var Gx=typeof setTimeout=="function"?setTimeout:void 0,Kw=typeof clearTimeout=="function"?clearTimeout:void 0,$x=typeof Promise=="function"?Promise:void 0,Xw=typeof queueMicrotask=="function"?queueMicrotask:typeof $x<"u"?function(s){return $x.resolve(null).then(s).catch(Ww)}:Gx;function Ww(s){setTimeout(function(){throw s})}function ri(s){return s==="head"}function Yx(s,r){var l=r,u=0,m=0;do{var v=l.nextSibling;if(s.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<u&&8>u){l=u;var j=s.ownerDocument;if(l&1&&vc(j.documentElement),l&2&&vc(j.body),l&4)for(l=j.head,vc(l),j=l.firstChild;j;){var D=j.nextSibling,z=j.nodeName;j[Ki]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&j.rel.toLowerCase()==="stylesheet"||l.removeChild(j),j=D}}if(m===0){s.removeChild(v),jc(r);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:u=l.charCodeAt(0)-48;else u=0;l=v}while(l);jc(r)}function fp(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":fp(l),qa(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function Zw(s,r,l,u){for(;s.nodeType===1;){var m=l;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Ki])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var v=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=vs(s.nextSibling),s===null)break}return null}function Jw(s,r,l){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=vs(s.nextSibling),s===null))return null;return s}function mp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function eC(s,r){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")r();else{var u=function(){r(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function vs(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return s}var pp=null;function Qx(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return s;r--}else l==="/$"&&r++}s=s.previousSibling}return null}function Kx(s,r,l){switch(r=Ld(l),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function vc(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);qa(s)}var is=new Map,Xx=new Set;function Vd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ja=se.d;se.d={f:tC,r:nC,D:sC,C:aC,L:iC,m:rC,X:lC,S:oC,M:cC};function tC(){var s=ja.f(),r=Sd();return s||r}function nC(s){var r=Cs(s);r!==null&&r.tag===5&&r.type==="form"?gb(r):ja.r(s)}var Mo=typeof document>"u"?null:document;function Wx(s,r,l){var u=Mo;if(u&&typeof r=="string"&&r){var m=Rt(r);m='link[rel="'+s+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),Xx.has(m)||(Xx.add(m),s={rel:s,crossOrigin:l,href:r},u.querySelector(m)===null&&(r=u.createElement("link"),nn(r,"link",s),At(r),u.head.appendChild(r)))}}function sC(s){ja.D(s),Wx("dns-prefetch",s,null)}function aC(s,r){ja.C(s,r),Wx("preconnect",s,r)}function iC(s,r,l){ja.L(s,r,l);var u=Mo;if(u&&s&&r){var m='link[rel="preload"][as="'+Rt(r)+'"]';r==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+Rt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+Rt(l.imageSizes)+'"]')):m+='[href="'+Rt(s)+'"]';var v=m;switch(r){case"style":v=Oo(s);break;case"script":v=ko(s)}is.has(v)||(s=y({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:s,as:r},l),is.set(v,s),u.querySelector(m)!==null||r==="style"&&u.querySelector(yc(v))||r==="script"&&u.querySelector(bc(v))||(r=u.createElement("link"),nn(r,"link",s),At(r),u.head.appendChild(r)))}}function rC(s,r){ja.m(s,r);var l=Mo;if(l&&s){var u=r&&typeof r.as=="string"?r.as:"script",m='link[rel="modulepreload"][as="'+Rt(u)+'"][href="'+Rt(s)+'"]',v=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ko(s)}if(!is.has(v)&&(s=y({rel:"modulepreload",href:s},r),is.set(v,s),l.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(bc(v)))return}u=l.createElement("link"),nn(u,"link",s),At(u),l.head.appendChild(u)}}}function oC(s,r,l){ja.S(s,r,l);var u=Mo;if(u&&s){var m=vn(u).hoistableStyles,v=Oo(s);r=r||"default";var j=m.get(v);if(!j){var D={loading:0,preload:null};if(j=u.querySelector(yc(v)))D.loading=5;else{s=y({rel:"stylesheet",href:s,"data-precedence":r},l),(l=is.get(v))&&gp(s,l);var z=j=u.createElement("link");At(z),nn(z,"link",s),z._p=new Promise(function(W,ne){z.onload=W,z.onerror=ne}),z.addEventListener("load",function(){D.loading|=1}),z.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Ud(j,r,u)}j={type:"stylesheet",instance:j,count:1,state:D},m.set(v,j)}}}function lC(s,r){ja.X(s,r);var l=Mo;if(l&&s){var u=vn(l).hoistableScripts,m=ko(s),v=u.get(m);v||(v=l.querySelector(bc(m)),v||(s=y({src:s,async:!0},r),(r=is.get(m))&&vp(s,r),v=l.createElement("script"),At(v),nn(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(m,v))}}function cC(s,r){ja.M(s,r);var l=Mo;if(l&&s){var u=vn(l).hoistableScripts,m=ko(s),v=u.get(m);v||(v=l.querySelector(bc(m)),v||(s=y({src:s,async:!0,type:"module"},r),(r=is.get(m))&&vp(s,r),v=l.createElement("script"),At(v),nn(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(m,v))}}function Zx(s,r,l,u){var m=(m=Re.current)?Vd(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=Oo(l.href),l=vn(m).hoistableStyles,u=l.get(r),u||(u={type:"style",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Oo(l.href);var v=vn(m).hoistableStyles,j=v.get(s);if(j||(m=m.ownerDocument||m,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,j),(v=m.querySelector(yc(s)))&&!v._p&&(j.instance=v,j.state.loading=5),is.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},is.set(s,l),v||uC(m,s,l,j.state))),r&&u===null)throw Error(i(528,""));return j}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ko(l),l=vn(m).hoistableScripts,u=l.get(r),u||(u={type:"script",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Oo(s){return'href="'+Rt(s)+'"'}function yc(s){return'link[rel="stylesheet"]['+s+"]"}function Jx(s){return y({},s,{"data-precedence":s.precedence,precedence:null})}function uC(s,r,l,u){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=s.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),nn(r,"link",l),At(r),s.head.appendChild(r))}function ko(s){return'[src="'+Rt(s)+'"]'}function bc(s){return"script[async]"+s}function eN(s,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var u=s.querySelector('style[data-href~="'+Rt(l.href)+'"]');if(u)return r.instance=u,At(u),u;var m=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),At(u),nn(u,"style",m),Ud(u,l.precedence,s),r.instance=u;case"stylesheet":m=Oo(l.href);var v=s.querySelector(yc(m));if(v)return r.state.loading|=4,r.instance=v,At(v),v;u=Jx(l),(m=is.get(m))&&gp(u,m),v=(s.ownerDocument||s).createElement("link"),At(v);var j=v;return j._p=new Promise(function(D,z){j.onload=D,j.onerror=z}),nn(v,"link",u),r.state.loading|=4,Ud(v,l.precedence,s),r.instance=v;case"script":return v=ko(l.src),(m=s.querySelector(bc(v)))?(r.instance=m,At(m),m):(u=l,(m=is.get(v))&&(u=y({},l),vp(u,m)),s=s.ownerDocument||s,m=s.createElement("script"),At(m),nn(m,"link",u),s.head.appendChild(m),r.instance=m);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Ud(u,l.precedence,s));return r.instance}function Ud(s,r,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,v=m,j=0;j<u.length;j++){var D=u[j];if(D.dataset.precedence===r)v=D;else if(v!==m)break}v?v.parentNode.insertBefore(s,v.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(s,r.firstChild))}function gp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function vp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var Fd=null;function tN(s,r,l){if(Fd===null){var u=new Map,m=Fd=new Map;m.set(l,u)}else m=Fd,u=m.get(l),u||(u=new Map,m.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),m=0;m<l.length;m++){var v=l[m];if(!(v[Ki]||v[Pt]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var j=v.getAttribute(r)||"";j=s+j;var D=u.get(j);D?D.push(v):u.set(j,[v])}}return u}function nN(s,r,l){s=s.ownerDocument||s,s.head.insertBefore(l,r==="title"?s.querySelector("head > title"):null)}function dC(s,r,l){if(l===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function sN(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var xc=null;function hC(){}function fC(s,r,l){if(xc===null)throw Error(i(475));var u=xc;if(r.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var m=Oo(l.href),v=s.querySelector(yc(m));if(v){s=v._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(u.count++,u=qd.bind(u),s.then(u,u)),r.state.loading|=4,r.instance=v,At(v);return}v=s.ownerDocument||s,l=Jx(l),(m=is.get(m))&&gp(l,m),v=v.createElement("link"),At(v);var j=v;j._p=new Promise(function(D,z){j.onload=D,j.onerror=z}),nn(v,"link",l),r.instance=v}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(r,s),(s=r.state.preload)&&(r.state.loading&3)===0&&(u.count++,r=qd.bind(u),s.addEventListener("load",r),s.addEventListener("error",r))}}function mC(){if(xc===null)throw Error(i(475));var s=xc;return s.stylesheets&&s.count===0&&yp(s,s.stylesheets),0<s.count?function(r){var l=setTimeout(function(){if(s.stylesheets&&yp(s,s.stylesheets),s.unsuspend){var u=s.unsuspend;s.unsuspend=null,u()}},6e4);return s.unsuspend=r,function(){s.unsuspend=null,clearTimeout(l)}}:null}function qd(){if(this.count--,this.count===0){if(this.stylesheets)yp(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var zd=null;function yp(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,zd=new Map,r.forEach(pC,s),zd=null,qd.call(s))}function pC(s,r){if(!(r.state.loading&4)){var l=zd.get(s);if(l)var u=l.get(null);else{l=new Map,zd.set(s,l);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<m.length;v++){var j=m[v];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(l.set(j.dataset.precedence,j),u=j)}u&&l.set(null,u)}m=r.instance,j=m.getAttribute("data-precedence"),v=l.get(j)||u,v===u&&l.set(null,m),l.set(j,m),this.count++,u=qd.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),v?v.parentNode.insertBefore(m,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),r.state.loading|=4}}var Nc={$$typeof:U,Provider:null,Consumer:null,_currentValue:fe,_currentValue2:fe,_threadCount:0};function gC(s,r,l,u,m,v,j,D){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ta(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ta(0),this.hiddenUpdates=ta(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=v,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function aN(s,r,l,u,m,v,j,D,z,W,ne,re){return s=new gC(s,r,l,j,D,z,W,re),r=1,v===!0&&(r|=24),v=Pn(3,null,null,r),s.current=v,v.stateNode=s,r=Jf(),r.refCount++,s.pooledCache=r,r.refCount++,v.memoizedState={element:u,isDehydrated:l,cache:r},sm(v),s}function iN(s){return s?(s=ho,s):ho}function rN(s,r,l,u,m,v){m=iN(m),u.context===null?u.context=m:u.pendingContext=m,u=Ya(r),u.payload={element:l},v=v===void 0?null:v,v!==null&&(u.callback=v),l=Qa(s,u,r),l!==null&&(qn(l,s,r),Wl(l,s,r))}function oN(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<r?l:r}}function bp(s,r){oN(s,r),(s=s.alternate)&&oN(s,r)}function lN(s){if(s.tag===13){var r=uo(s,67108864);r!==null&&qn(r,s,67108864),bp(s,67108864)}}var Bd=!0;function vC(s,r,l,u){var m=Q.T;Q.T=null;var v=se.p;try{se.p=2,xp(s,r,l,u)}finally{se.p=v,Q.T=m}}function yC(s,r,l,u){var m=Q.T;Q.T=null;var v=se.p;try{se.p=8,xp(s,r,l,u)}finally{se.p=v,Q.T=m}}function xp(s,r,l,u){if(Bd){var m=Np(u);if(m===null)op(s,r,u,Hd,l),uN(s,u);else if(xC(m,s,r,l,u))u.stopPropagation();else if(uN(s,u),r&4&&-1<bC.indexOf(s)){for(;m!==null;){var v=Cs(m);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var j=hs(v.pendingLanes);if(j!==0){var D=v;for(D.pendingLanes|=2,D.entangledLanes|=2;j;){var z=1<<31-cn(j);D.entanglements[1]|=z,j&=~z}zs(v),(at&6)===0&&(wd=Yn()+500,mc(0))}}break;case 13:D=uo(v,2),D!==null&&qn(D,v,2),Sd(),bp(v,2)}if(v=Np(u),v===null&&op(s,r,u,Hd,l),v===m)break;m=v}m!==null&&u.stopPropagation()}else op(s,r,u,null,l)}}function Np(s){return s=Xn(s),_p(s)}var Hd=null;function _p(s){if(Hd=null,s=sa(s),s!==null){var r=c(s);if(r===null)s=null;else{var l=r.tag;if(l===13){if(s=d(r),s!==null)return s;s=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return Hd=s,null}function cN(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(jf()){case bl:return 2;case Br:return 8;case Hi:case Af:return 32;case Hr:return 268435456;default:return 32}default:return 32}}var Ep=!1,oi=null,li=null,ci=null,_c=new Map,Ec=new Map,ui=[],bC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function uN(s,r){switch(s){case"focusin":case"focusout":oi=null;break;case"dragenter":case"dragleave":li=null;break;case"mouseover":case"mouseout":ci=null;break;case"pointerover":case"pointerout":_c.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ec.delete(r.pointerId)}}function Tc(s,r,l,u,m,v){return s===null||s.nativeEvent!==v?(s={blockedOn:r,domEventName:l,eventSystemFlags:u,nativeEvent:v,targetContainers:[m]},r!==null&&(r=Cs(r),r!==null&&lN(r)),s):(s.eventSystemFlags|=u,r=s.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),s)}function xC(s,r,l,u,m){switch(r){case"focusin":return oi=Tc(oi,s,r,l,u,m),!0;case"dragenter":return li=Tc(li,s,r,l,u,m),!0;case"mouseover":return ci=Tc(ci,s,r,l,u,m),!0;case"pointerover":var v=m.pointerId;return _c.set(v,Tc(_c.get(v)||null,s,r,l,u,m)),!0;case"gotpointercapture":return v=m.pointerId,Ec.set(v,Tc(Ec.get(v)||null,s,r,l,u,m)),!0}return!1}function dN(s){var r=sa(s.target);if(r!==null){var l=c(r);if(l!==null){if(r=l.tag,r===13){if(r=d(l),r!==null){s.blockedOn=r,Su(s.priority,function(){if(l.tag===13){var u=Fn();u=Va(u);var m=uo(l,u);m!==null&&qn(m,l,u),bp(l,u)}});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Gd(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var l=Np(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);oa=u,l.target.dispatchEvent(u),oa=null}else return r=Cs(l),r!==null&&lN(r),s.blockedOn=l,!1;r.shift()}return!0}function hN(s,r,l){Gd(s)&&l.delete(r)}function NC(){Ep=!1,oi!==null&&Gd(oi)&&(oi=null),li!==null&&Gd(li)&&(li=null),ci!==null&&Gd(ci)&&(ci=null),_c.forEach(hN),Ec.forEach(hN)}function $d(s,r){s.blockedOn===r&&(s.blockedOn=null,Ep||(Ep=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,NC)))}var Yd=null;function fN(s){Yd!==s&&(Yd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Yd===s&&(Yd=null);for(var r=0;r<s.length;r+=3){var l=s[r],u=s[r+1],m=s[r+2];if(typeof u!="function"){if(_p(u||l)===null)continue;break}var v=Cs(l);v!==null&&(s.splice(r,3),r-=3,_m(v,{pending:!0,data:m,method:l.method,action:u},u,m))}}))}function jc(s){function r(z){return $d(z,s)}oi!==null&&$d(oi,s),li!==null&&$d(li,s),ci!==null&&$d(ci,s),_c.forEach(r),Ec.forEach(r);for(var l=0;l<ui.length;l++){var u=ui[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<ui.length&&(l=ui[0],l.blockedOn===null);)dN(l),l.blockedOn===null&&ui.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var m=l[u],v=l[u+1],j=m[It]||null;if(typeof v=="function")j||fN(l);else if(j){var D=null;if(v&&v.hasAttribute("formAction")){if(m=v,j=v[It]||null)D=j.formAction;else if(_p(m)!==null)continue}else D=j.action;typeof D=="function"?l[u+1]=D:(l.splice(u,3),u-=3),fN(l)}}}function Tp(s){this._internalRoot=s}Qd.prototype.render=Tp.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var l=r.current,u=Fn();rN(l,u,s,r,null,null)},Qd.prototype.unmount=Tp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;rN(s.current,2,null,s,null,null),Sd(),r[Qn]=null}};function Qd(s){this._internalRoot=s}Qd.prototype.unstable_scheduleHydration=function(s){if(s){var r=Ua();s={blockedOn:null,target:s,priority:r};for(var l=0;l<ui.length&&r!==0&&r<ui[l].priority;l++);ui.splice(l,0,s),l===0&&dN(s)}};var mN=e.version;if(mN!=="19.1.0")throw Error(i(527,mN,"19.1.0"));se.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=p(r),s=s!==null?g(s):null,s=s===null?null:s.stateNode,s};var _C={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kd.isDisabled&&Kd.supportsFiber)try{Et=Kd.inject(_C),st=Kd}catch{}}return wc.createRoot=function(s,r){if(!o(s))throw Error(i(299));var l=!1,u="",m=Ib,v=Rb,j=Db,D=null;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(j=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(D=r.unstable_transitionCallbacks)),r=aN(s,1,!1,null,null,l,u,m,v,j,D,null),s[Qn]=r.current,rp(s),new Tp(r)},wc.hydrateRoot=function(s,r,l){if(!o(s))throw Error(i(299));var u=!1,m="",v=Ib,j=Rb,D=Db,z=null,W=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(j=l.onCaughtError),l.onRecoverableError!==void 0&&(D=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(z=l.unstable_transitionCallbacks),l.formState!==void 0&&(W=l.formState)),r=aN(s,1,!0,r,l??null,u,m,v,j,D,z,W),r.context=iN(null),l=r.current,u=Fn(),u=Va(u),m=Ya(u),m.callback=null,Qa(l,m,u),l=u,r.current.lanes=l,na(r,l),zs(r),s[Qn]=r.current,rp(s),new Qd(r)},wc.version="19.1.0",wc}var TN;function DC(){if(TN)return wp.exports;TN=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),wp.exports=RC(),wp.exports}var MC=DC();const OC=()=>{};var jN={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},kC=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[i++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],f=n[t++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(p>>10)),e[i++]=String.fromCharCode(56320+(p&1023))}else{const c=n[t++],d=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},YE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,f=d?n[o+1]:0,p=o+2<n.length,g=p?n[o+2]:0,y=c>>2,x=(c&3)<<4|f>>4;let _=(f&15)<<2|g>>6,A=g&63;p||(A=64,d||(_=64)),i.push(t[y],t[x],t[_],t[A])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray($E(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):kC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],f=o<n.length?t[n.charAt(o)]:0;++o;const g=o<n.length?t[n.charAt(o)]:64;++o;const x=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||f==null||g==null||x==null)throw new PC;const _=c<<2|f>>4;if(i.push(_),g!==64){const A=f<<4&240|g>>2;if(i.push(A),x!==64){const N=g<<6&192|x;i.push(N)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class PC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const LC=function(n){const e=$E(n);return YE.encodeByteArray(e,!0)},vh=function(n){return LC(n).replace(/\./g,"")},QE=function(n){try{return YE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=()=>VC().__FIREBASE_DEFAULTS__,FC=()=>{if(typeof process>"u"||typeof jN>"u")return;const n=jN.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},qC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&QE(n[1]);return e&&JSON.parse(e)},Hh=()=>{try{return OC()||UC()||FC()||qC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},KE=n=>{var e,t;return(t=(e=Hh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},XE=n=>{const e=KE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},WE=()=>{var n;return(n=Hh())===null||n===void 0?void 0:n.config},ZE=n=>{var e;return(e=Hh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lr(n){return n.endsWith(".cloudworkstations.dev")}async function Rg(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},n);return[vh(JSON.stringify(t)),vh(JSON.stringify(d)),""].join(".")}const Oc={};function BC(){const n={prod:[],emulator:[]};for(const e of Object.keys(Oc))Oc[e]?n.emulator.push(e):n.prod.push(e);return n}function HC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let AN=!1;function Dg(n,e){if(typeof window>"u"||typeof document>"u"||!Lr(window.location.host)||Oc[n]===e||Oc[n]||AN)return;Oc[n]=e;function t(_){return`__firebase__banner__${_}`}const i="__firebase__banner",c=BC().prod.length>0;function d(){const _=document.getElementById(i);_&&_.remove()}function f(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function p(_,A){_.setAttribute("width","24"),_.setAttribute("id",A),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function g(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{AN=!0,d()},_}function y(_,A){_.setAttribute("id",A),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function x(){const _=HC(i),A=t("text"),N=document.getElementById(A)||document.createElement("span"),C=t("learnmore"),T=document.getElementById(C)||document.createElement("a"),M=t("preprendIcon"),q=document.getElementById(M)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const U=_.element;f(U),y(T,C);const P=g();p(q,M),U.append(q,N,T,P),document.body.appendChild(U)}c?(N.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function GC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gn())}function $C(){var n;const e=(n=Hh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function YC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Mg(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function QC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function KC(){const n=gn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function XC(){return!$C()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Gh(){try{return typeof indexedDB=="object"}catch{return!1}}function $h(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}function Og(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC="FirebaseError";class us extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=WC,Object.setPrototypeOf(this,us.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oi.prototype.create)}}class Oi{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?ZC(c,i):"Error",f=`${this.serviceName}: ${d} (${o}).`;return new us(o,f,i)}}function ZC(n,e){return n.replace(JC,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const JC=/\{\$([^}]+)}/g;function eS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ti(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const c=n[o],d=e[o];if(wN(c)&&wN(d)){if(!Ti(c,d))return!1}else if(c!==d)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function wN(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Cc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,c]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Sc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function tS(n,e){const t=new nS(n,e);return t.subscribe.bind(t)}class nS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");sS(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=Rp),o.error===void 0&&(o.error=Rp),o.complete===void 0&&(o.complete=Rp);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Rp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS=1e3,iS=2,rS=4*60*60*1e3,oS=.5;function CN(n,e=aS,t=iS){const i=e*Math.pow(t,n),o=Math.round(oS*i*(Math.random()-.5)*2);return Math.min(rS,i+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(n){return n&&n._delegate?n._delegate:n}class $n{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new zC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(uS(e))try{this.getOrInitializeService({instanceIdentifier:jr})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});i.resolve(c)}catch{}}}}clearInstance(e=jr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=jr){return this.instances.has(e)}getOptions(e=jr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[c,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(c);i===f&&d.resolve(o)}return o}onInit(e,t){var i;const o=this.normalizeInstanceIdentifier(t),c=(i=this.onInitCallbacks.get(o))!==null&&i!==void 0?i:new Set;c.add(e),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&e(d,o),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:cS(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=jr){return this.component?this.component.multipleInstances?e:jr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function cS(n){return n===jr?void 0:n}function uS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new lS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})($e||($e={}));const hS={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},fS=$e.INFO,mS={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},pS=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=mS[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lu{constructor(e){this.name=e,this._logLevel=fS,this._logHandler=pS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const gS=(n,e)=>e.some(t=>n instanceof t);let SN,IN;function vS(){return SN||(SN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yS(){return IN||(IN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const eT=new WeakMap,Jp=new WeakMap,tT=new WeakMap,Dp=new WeakMap,kg=new WeakMap;function bS(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(bi(n.result)),o()},d=()=>{i(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&eT.set(t,n)}).catch(()=>{}),kg.set(e,n),e}function xS(n){if(Jp.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});Jp.set(n,e)}let eg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Jp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||tT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function NS(n){eg=n(eg)}function _S(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Mp(this),e,...t);return tT.set(i,e.sort?e.sort():[e]),bi(i)}:yS().includes(n)?function(...e){return n.apply(Mp(this),e),bi(eT.get(this))}:function(...e){return bi(n.apply(Mp(this),e))}}function ES(n){return typeof n=="function"?_S(n):(n instanceof IDBTransaction&&xS(n),gS(n,vS())?new Proxy(n,eg):n)}function bi(n){if(n instanceof IDBRequest)return bS(n);if(Dp.has(n))return Dp.get(n);const e=ES(n);return e!==n&&(Dp.set(n,e),kg.set(e,n)),e}const Mp=n=>kg.get(n);function nT(n,e,{blocked:t,upgrade:i,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),f=bi(d);return i&&d.addEventListener("upgradeneeded",p=>{i(bi(d.result),p.oldVersion,p.newVersion,bi(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),f.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),f}const TS=["get","getKey","getAll","getAllKeys","count"],jS=["put","add","delete","clear"],Op=new Map;function RN(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Op.get(e))return Op.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=jS.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||TS.includes(t)))return;const c=async function(d,...f){const p=this.transaction(d,o?"readwrite":"readonly");let g=p.store;return i&&(g=g.index(f.shift())),(await Promise.all([g[t](...f),o&&p.done]))[0]};return Op.set(e,c),c}NS(n=>({...n,get:(e,t,i)=>RN(e,t)||n.get(e,t,i),has:(e,t)=>!!RN(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(wS(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function wS(n){const e=n.getComponent();return e?.type==="VERSION"}const tg="@firebase/app",DN="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=new lu("@firebase/app"),CS="@firebase/app-compat",SS="@firebase/analytics-compat",IS="@firebase/analytics",RS="@firebase/app-check-compat",DS="@firebase/app-check",MS="@firebase/auth",OS="@firebase/auth-compat",kS="@firebase/database",PS="@firebase/data-connect",LS="@firebase/database-compat",VS="@firebase/functions",US="@firebase/functions-compat",FS="@firebase/installations",qS="@firebase/installations-compat",zS="@firebase/messaging",BS="@firebase/messaging-compat",HS="@firebase/performance",GS="@firebase/performance-compat",$S="@firebase/remote-config",YS="@firebase/remote-config-compat",QS="@firebase/storage",KS="@firebase/storage-compat",XS="@firebase/firestore",WS="@firebase/ai",ZS="@firebase/firestore-compat",JS="firebase",eI="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng="[DEFAULT]",tI={[tg]:"fire-core",[CS]:"fire-core-compat",[IS]:"fire-analytics",[SS]:"fire-analytics-compat",[DS]:"fire-app-check",[RS]:"fire-app-check-compat",[MS]:"fire-auth",[OS]:"fire-auth-compat",[kS]:"fire-rtdb",[PS]:"fire-data-connect",[LS]:"fire-rtdb-compat",[VS]:"fire-fn",[US]:"fire-fn-compat",[FS]:"fire-iid",[qS]:"fire-iid-compat",[zS]:"fire-fcm",[BS]:"fire-fcm-compat",[HS]:"fire-perf",[GS]:"fire-perf-compat",[$S]:"fire-rc",[YS]:"fire-rc-compat",[QS]:"fire-gcs",[KS]:"fire-gcs-compat",[XS]:"fire-fst",[ZS]:"fire-fst-compat",[WS]:"fire-vertex","fire-js":"fire-js",[JS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yh=new Map,nI=new Map,sg=new Map;function MN(n,e){try{n.container.addComponent(e)}catch(t){Ra.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ls(n){const e=n.name;if(sg.has(e))return Ra.debug(`There were multiple attempts to register component ${e}.`),!1;sg.set(e,n);for(const t of yh.values())MN(t,n);for(const t of nI.values())MN(t,n);return!0}function ka(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function In(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xi=new Oi("app","Firebase",sI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vr=eI;function sT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:ng,automaticDataCollectionEnabled:!0},e),o=i.name;if(typeof o!="string"||!o)throw xi.create("bad-app-name",{appName:String(o)});if(t||(t=WE()),!t)throw xi.create("no-options");const c=yh.get(o);if(c){if(Ti(t,c.options)&&Ti(i,c.config))return c;throw xi.create("duplicate-app",{appName:o})}const d=new dS(o);for(const p of sg.values())d.addComponent(p);const f=new aI(t,i,d);return yh.set(o,f),f}function cu(n=ng){const e=yh.get(n);if(!e&&n===ng&&WE())return sT();if(!e)throw xi.create("no-app",{appName:n});return e}function pn(n,e,t){var i;let o=(i=tI[n])!==null&&i!==void 0?i:n;t&&(o+=`-${t}`);const c=o.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const f=[`Unable to register library "${o}" with version "${e}":`];c&&f.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ra.warn(f.join(" "));return}ls(new $n(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI="firebase-heartbeat-database",rI=1,$c="firebase-heartbeat-store";let kp=null;function aT(){return kp||(kp=nT(iI,rI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore($c)}catch(t){console.warn(t)}}}}).catch(n=>{throw xi.create("idb-open",{originalErrorMessage:n.message})})),kp}async function oI(n){try{const t=(await aT()).transaction($c),i=await t.objectStore($c).get(iT(n));return await t.done,i}catch(e){if(e instanceof us)Ra.warn(e.message);else{const t=xi.create("idb-get",{originalErrorMessage:e?.message});Ra.warn(t.message)}}}async function ON(n,e){try{const i=(await aT()).transaction($c,"readwrite");await i.objectStore($c).put(e,iT(n)),await i.done}catch(t){if(t instanceof us)Ra.warn(t.message);else{const i=xi.create("idb-set",{originalErrorMessage:t?.message});Ra.warn(i.message)}}}function iT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI=1024,cI=30;class uI{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new hI(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=kN();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>cI){const d=fI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Ra.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=kN(),{heartbeatsToSend:i,unsentEntries:o}=dI(this._heartbeatsCache.heartbeats),c=vh(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Ra.warn(t),""}}}function kN(){return new Date().toISOString().substring(0,10)}function dI(n,e=lI){const t=[];let i=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),PN(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),PN(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class hI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Gh()?$h().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await oI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return ON(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return ON(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function PN(n){return vh(JSON.stringify({version:2,heartbeats:n})).length}function fI(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mI(n){ls(new $n("platform-logger",e=>new AS(e),"PRIVATE")),ls(new $n("heartbeat",e=>new uI(e),"PRIVATE")),pn(tg,DN,n),pn(tg,DN,"esm2017"),pn("fire-js","")}mI("");function Pg(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function rT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const pI=rT,oT=new Oi("auth","Firebase",rT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh=new lu("@firebase/auth");function gI(n,...e){bh.logLevel<=$e.WARN&&bh.warn(`Auth (${Vr}): ${n}`,...e)}function ih(n,...e){bh.logLevel<=$e.ERROR&&bh.error(`Auth (${Vr}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(n,...e){throw Vg(n,...e)}function Es(n,...e){return Vg(n,...e)}function Lg(n,e,t){const i=Object.assign(Object.assign({},pI()),{[e]:t});return new Oi("auth","Firebase",i).create(e,{appName:n.name})}function Ia(n){return Lg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function vI(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&cs(n,"argument-error"),Lg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Vg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return oT.create(n,...e)}function Ce(n,e,...t){if(!n)throw Vg(e,...t)}function Ca(n){const e="INTERNAL ASSERTION FAILED: "+n;throw ih(e),new Error(e)}function Da(n,e){n||Ca(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ag(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function yI(){return LN()==="http:"||LN()==="https:"}function LN(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(yI()||Mg()||"connection"in navigator)?navigator.onLine:!0}function xI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Da(t>e,"Short delay should be less than long delay!"),this.isMobile=GC()||QC()}get(){return bI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(n,e){Da(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ca("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ca("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ca("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],EI=new uu(3e4,6e4);function ki(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Pi(n,e,t,i,o={}){return cT(n,o,async()=>{let c={},d={};i&&(e==="GET"?d=i:c={body:JSON.stringify(i)});const f=ou(Object.assign({key:n.config.apiKey},d)).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const g=Object.assign({method:e,headers:p},c);return YC()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&Lr(n.emulatorConfig.host)&&(g.credentials="include"),lT.fetch()(await uT(n,n.config.apiHost,t,f),g)})}async function cT(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},NI),e);try{const o=new jI(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw Xd(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const f=c.ok?d.errorMessage:d.error.message,[p,g]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xd(n,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw Xd(n,"email-already-in-use",d);if(p==="USER_DISABLED")throw Xd(n,"user-disabled",d);const y=i[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw Lg(n,y,g);cs(n,y)}}catch(o){if(o instanceof us)throw o;cs(n,"network-request-failed",{message:String(o)})}}async function du(n,e,t,i,o={}){const c=await Pi(n,e,t,i,o);return"mfaPendingCredential"in c&&cs(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function uT(n,e,t,i){const o=`${e}${t}?${i}`,c=n,d=c.config.emulator?Ug(n.config,o):`${n.config.apiScheme}://${o}`;return _I.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function TI(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Es(this.auth,"network-request-failed")),EI.get())})}}function Xd(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=Es(n,e,i);return o.customData._tokenResponse=t,o}function VN(n){return n!==void 0&&n.enterprise!==void 0}class AI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return TI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function wI(n,e){return Pi(n,"GET","/v2/recaptchaConfig",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CI(n,e){return Pi(n,"POST","/v1/accounts:delete",e)}async function xh(n,e){return Pi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function SI(n,e=!1){const t=yt(n),i=await t.getIdToken(e),o=Fg(i);Ce(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:i,authTime:kc(Pp(o.auth_time)),issuedAtTime:kc(Pp(o.iat)),expirationTime:kc(Pp(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Pp(n){return Number(n)*1e3}function Fg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return ih("JWT malformed, contained fewer than 3 sections"),null;try{const o=QE(t);return o?JSON.parse(o):(ih("Failed to decode base64 JWT payload"),null)}catch(o){return ih("Caught error parsing JWT payload as JSON",o?.toString()),null}}function UN(n){const e=Fg(n);return Ce(e,"internal-error"),Ce(typeof e.exp<"u","internal-error"),Ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yc(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof us&&II(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function II({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=kc(this.lastLoginAt),this.creationTime=kc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nh(n){var e;const t=n.auth,i=await n.getIdToken(),o=await Yc(n,xh(t,{idToken:i}));Ce(o?.users.length,t,"internal-error");const c=o.users[0];n._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?dT(c.providerUserInfo):[],f=MI(n.providerData,d),p=n.isAnonymous,g=!(n.email&&c.passwordHash)&&!f?.length,y=p?g:!1,x={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:f,metadata:new ig(c.createdAt,c.lastLoginAt),isAnonymous:y};Object.assign(n,x)}async function DI(n){const e=yt(n);await Nh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function MI(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function dT(n){return n.map(e=>{var{providerId:t}=e,i=Pg(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OI(n,e){const t=await cT(n,{},async()=>{const i=ou({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await uT(n,o,"/v1/token",`key=${c}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:i};return n.emulatorConfig&&Lr(n.emulatorConfig.host)&&(p.credentials="include"),lT.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function kI(n,e){return Pi(n,"POST","/v2/accounts:revokeToken",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ce(e.idToken,"internal-error"),Ce(typeof e.idToken<"u","internal-error"),Ce(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):UN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ce(e.length!==0,"internal-error");const t=UN(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:c}=await OI(e,t);this.updateTokensAndExpiration(i,o,Number(c))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:c}=t,d=new $o;return i&&(Ce(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),o&&(Ce(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(Ce(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $o,this.toJSON())}_performRefresh(){return Ca("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(n,e){Ce(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ns{constructor(e){var{uid:t,auth:i,stsTokenManager:o}=e,c=Pg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new RI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new ig(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await Yc(this,this.stsTokenManager.getToken(this.auth,e));return Ce(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return SI(this,e)}reload(){return DI(this)}_assign(e){this!==e&&(Ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ns(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Nh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(In(this.auth.app))return Promise.reject(Ia(this.auth));const e=await this.getIdToken();return await Yc(this,CI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,o,c,d,f,p,g,y;const x=(i=t.displayName)!==null&&i!==void 0?i:void 0,_=(o=t.email)!==null&&o!==void 0?o:void 0,A=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,N=(d=t.photoURL)!==null&&d!==void 0?d:void 0,C=(f=t.tenantId)!==null&&f!==void 0?f:void 0,T=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,M=(g=t.createdAt)!==null&&g!==void 0?g:void 0,q=(y=t.lastLoginAt)!==null&&y!==void 0?y:void 0,{uid:U,emailVerified:P,isAnonymous:F,providerData:G,stsTokenManager:V}=t;Ce(U&&V,e,"internal-error");const S=$o.fromJSON(this.name,V);Ce(typeof U=="string",e,"internal-error"),hi(x,e.name),hi(_,e.name),Ce(typeof P=="boolean",e,"internal-error"),Ce(typeof F=="boolean",e,"internal-error"),hi(A,e.name),hi(N,e.name),hi(C,e.name),hi(T,e.name),hi(M,e.name),hi(q,e.name);const L=new Ns({uid:U,auth:e,email:_,emailVerified:P,displayName:x,isAnonymous:F,photoURL:N,phoneNumber:A,tenantId:C,stsTokenManager:S,createdAt:M,lastLoginAt:q});return G&&Array.isArray(G)&&(L.providerData=G.map(O=>Object.assign({},O))),T&&(L._redirectEventId=T),L}static async _fromIdTokenResponse(e,t,i=!1){const o=new $o;o.updateFromServerResponse(t);const c=new Ns({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await Nh(c),c}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];Ce(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?dT(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,f=new $o;f.updateFromIdToken(i);const p=new Ns({uid:o.localId,auth:e,stsTokenManager:f,isAnonymous:d}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new ig(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,g),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN=new Map;function Sa(n){Da(n instanceof Function,"Expected a class definition");let e=FN.get(n);return e?(Da(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,FN.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}hT.type="NONE";const qN=hT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rh(n,e,t){return`firebase:${n}:${e}:${t}`}class Yo{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:c}=this.auth;this.fullUserKey=rh(this.userKey,o.apiKey,c),this.fullPersistenceKey=rh("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await xh(this.auth,{idToken:e}).catch(()=>{});return t?Ns._fromGetAccountInfoResponse(this.auth,t,e):null}return Ns._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Yo(Sa(qN),e,i);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let c=o[0]||Sa(qN);const d=rh(i,e.config.apiKey,e.name);let f=null;for(const g of t)try{const y=await g._get(d);if(y){let x;if(typeof y=="string"){const _=await xh(e,{idToken:y}).catch(()=>{});if(!_)break;x=await Ns._fromGetAccountInfoResponse(e,_,y)}else x=Ns._fromJSON(e,y);g!==c&&(f=x),c=g;break}}catch{}const p=o.filter(g=>g._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new Yo(c,e,i):(c=p[0],f&&await c._set(d,f.toJSON()),await Promise.all(t.map(async g=>{if(g!==c)try{await g._remove(d)}catch{}})),new Yo(c,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zN(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(yT(e))return"Blackberry";if(bT(e))return"Webos";if(mT(e))return"Safari";if((e.includes("chrome/")||pT(e))&&!e.includes("edge/"))return"Chrome";if(vT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function fT(n=gn()){return/firefox\//i.test(n)}function mT(n=gn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pT(n=gn()){return/crios\//i.test(n)}function gT(n=gn()){return/iemobile/i.test(n)}function vT(n=gn()){return/android/i.test(n)}function yT(n=gn()){return/blackberry/i.test(n)}function bT(n=gn()){return/webos/i.test(n)}function qg(n=gn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function PI(n=gn()){var e;return qg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function LI(){return KC()&&document.documentMode===10}function xT(n=gn()){return qg(n)||vT(n)||bT(n)||yT(n)||/windows phone/i.test(n)||gT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(n,e=[]){let t;switch(n){case"Browser":t=zN(gn());break;case"Worker":t=`${zN(gn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Vr}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=c=>new Promise((d,f)=>{try{const p=e(c);d(p)}catch(p){f(p)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UI(n,e={}){return Pi(n,"GET","/v2/passwordPolicy",ki(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI=6;class qI{constructor(e){var t,i,o,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:FI,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,o,c,d,f;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(i=p.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),p.isValid&&(p.isValid=(o=p.containsLowercaseLetter)!==null&&o!==void 0?o:!0),p.isValid&&(p.isValid=(c=p.containsUppercaseLetter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(d=p.containsNumericCharacter)!==null&&d!==void 0?d:!0),p.isValid&&(p.isValid=(f=p.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),p}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new BN(this),this.idTokenSubscription=new BN(this),this.beforeStateQueue=new VI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=oT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Sa(t)),this._initializationPromise=this.queue(async()=>{var i,o,c;if(!this._deleted&&(this.persistenceManager=await Yo.create(this,e),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await xh(this,{idToken:e}),i=await Ns._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(In(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let o=i,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=o?._redirectEventId,p=await this.tryRedirectSignIn(e);(!d||d===f)&&p?.user&&(o=p.user,c=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(o)}catch(d){o=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return Ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Nh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=xI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(In(this.app))return Promise.reject(Ia(this));const t=e?yt(e):null;return t&&Ce(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return In(this.app)?Promise.reject(Ia(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return In(this.app)?Promise.reject(Ia(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await UI(this),t=new qI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Oi("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await kI(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Sa(e)||this._popupRedirectResolver;Ce(t,this,"argument-error"),this.redirectPersistenceManager=await Yo.create(this,[Sa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ce(f,this,"internal-error"),f.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,i,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=NT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(In(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&gI(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Li(n){return yt(n)}class BN{constructor(e){this.auth=e,this.observer=null,this.addObserver=tS(t=>this.observer=t)}get next(){return Ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function BI(n){Yh=n}function _T(n){return Yh.loadJS(n)}function HI(){return Yh.recaptchaEnterpriseScript}function GI(){return Yh.gapiScript}function $I(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class YI{constructor(){this.enterprise=new QI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class QI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const KI="recaptcha-enterprise",ET="NO_RECAPTCHA";class XI{constructor(e){this.type=KI,this.auth=Li(e)}async verify(e="verify",t=!1){async function i(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,f)=>{wI(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const g=new AI(p);return c.tenantId==null?c._agentRecaptchaConfig=g:c._tenantRecaptchaConfigs[c.tenantId]=g,d(g.siteKey)}}).catch(p=>{f(p)})})}function o(c,d,f){const p=window.grecaptcha;VN(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(g=>{d(g)}).catch(()=>{d(ET)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new YI().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{i(this.auth).then(f=>{if(!t&&VN(window.grecaptcha))o(f,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=HI();p.length!==0&&(p+=f),_T(p).then(()=>{o(f,c,d)}).catch(g=>{d(g)})}}).catch(f=>{d(f)})})}}async function HN(n,e,t,i=!1,o=!1){const c=new XI(n);let d;if(o)d=ET;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,g=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function rg(n,e,t,i,o){var c;if(!((c=n._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await HN(n,e,t,t==="getOobCode");return i(n,d)}else return i(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await HN(n,e,t,t==="getOobCode");return i(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WI(n,e){const t=ka(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Ti(c,e??{}))return o;cs(o,"already-initialized")}return t.initialize({options:e})}function ZI(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Sa);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function JI(n,e,t){const i=Li(n);Ce(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,c=TT(e),{host:d,port:f}=eR(e),p=f===null?"":`:${f}`,g={url:`${c}//${d}${p}/`},y=Object.freeze({host:d,port:f,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){Ce(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ce(Ti(g,i.config.emulator)&&Ti(y,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=y,i.settings.appVerificationDisabledForTesting=!0,Lr(d)?(Rg(`${c}//${d}${p}`),Dg("Auth",!0)):tR()}function TT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function eR(n){const e=TT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const c=o[1];return{host:c,port:GN(i.substr(c.length+1))}}else{const[c,d]=i.split(":");return{host:c,port:GN(d)}}}function GN(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function tR(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ca("not implemented")}_getIdTokenResponse(e){return Ca("not implemented")}_linkToIdToken(e,t){return Ca("not implemented")}_getReauthenticationResolver(e){return Ca("not implemented")}}async function nR(n,e){return Pi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sR(n,e){return du(n,"POST","/v1/accounts:signInWithPassword",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aR(n,e){return du(n,"POST","/v1/accounts:signInWithEmailLink",ki(n,e))}async function iR(n,e){return du(n,"POST","/v1/accounts:signInWithEmailLink",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc extends zg{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Qc(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Qc(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rg(e,t,"signInWithPassword",sR);case"emailLink":return aR(e,{email:this._email,oobCode:this._password});default:cs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rg(e,i,"signUpPassword",nR);case"emailLink":return iR(e,{idToken:t,email:this._email,oobCode:this._password});default:cs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qo(n,e){return du(n,"POST","/v1/accounts:signInWithIdp",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR="http://localhost";class Ir extends zg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ir(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):cs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o}=t,c=Pg(t,["providerId","signInMethod"]);if(!i||!o)return null;const d=new Ir(i,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Qo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Qo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qo(e,t)}buildRequest(){const e={requestUri:rR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ou(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oR(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function lR(n){const e=Cc(Sc(n)).link,t=e?Cc(Sc(e)).deep_link_id:null,i=Cc(Sc(n)).deep_link_id;return(i?Cc(Sc(i)).link:null)||i||t||e||n}class Bg{constructor(e){var t,i,o,c,d,f;const p=Cc(Sc(e)),g=(t=p.apiKey)!==null&&t!==void 0?t:null,y=(i=p.oobCode)!==null&&i!==void 0?i:null,x=oR((o=p.mode)!==null&&o!==void 0?o:null);Ce(g&&y&&x,"argument-error"),this.apiKey=g,this.operation=x,this.code=y,this.continueUrl=(c=p.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=p.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=p.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=lR(e);try{return new Bg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(){this.providerId=cl.PROVIDER_ID}static credential(e,t){return Qc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Bg.parseLink(t);return Ce(i,"argument-error"),Qc._fromEmailAndCode(e,i.code,i.tenantId)}}cl.PROVIDER_ID="password";cl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";cl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu extends Hg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends hu{constructor(){super("facebook.com")}static credential(e){return Ir._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.FACEBOOK_SIGN_IN_METHOD="facebook.com";mi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa extends hu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ir._fromParams({providerId:wa.PROVIDER_ID,signInMethod:wa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wa.credentialFromTaggedObject(e)}static credentialFromError(e){return wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return wa.credential(t,i)}catch{return null}}}wa.GOOGLE_SIGN_IN_METHOD="google.com";wa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends hu{constructor(){super("github.com")}static credential(e){return Ir._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pi.credential(e.oauthAccessToken)}catch{return null}}}pi.GITHUB_SIGN_IN_METHOD="github.com";pi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends hu{constructor(){super("twitter.com")}static credential(e,t){return Ir._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return gi.credential(t,i)}catch{return null}}}gi.TWITTER_SIGN_IN_METHOD="twitter.com";gi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cR(n,e){return du(n,"POST","/v1/accounts:signUp",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const c=await Ns._fromIdTokenResponse(e,i,o),d=$N(i);return new Rr({user:c,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=$N(i);return new Rr({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function $N(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h extends us{constructor(e,t,i,o){var c;super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,_h.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new _h(e,t,i,o)}}function jT(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?_h._fromErrorAndOperation(n,c,e,i):c})}async function uR(n,e,t=!1){const i=await Yc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Rr._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dR(n,e,t=!1){const{auth:i}=n;if(In(i.app))return Promise.reject(Ia(i));const o="reauthenticate";try{const c=await Yc(n,jT(i,o,e,n),t);Ce(c.idToken,i,"internal-error");const d=Fg(c.idToken);Ce(d,i,"internal-error");const{sub:f}=d;return Ce(n.uid===f,i,"user-mismatch"),Rr._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&cs(i,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AT(n,e,t=!1){if(In(n.app))return Promise.reject(Ia(n));const i="signIn",o=await jT(n,i,e),c=await Rr._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(c.user),c}async function hR(n,e){return AT(Li(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wT(n){const e=Li(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function fR(n,e,t){if(In(n.app))return Promise.reject(Ia(n));const i=Li(n),d=await rg(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",cR).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&wT(n),p}),f=await Rr._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(f.user),f}function mR(n,e,t){return In(n.app)?Promise.reject(Ia(n)):hR(yt(n),cl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&wT(n),i})}function pR(n,e,t,i){return yt(n).onIdTokenChanged(e,t,i)}function gR(n,e,t){return yt(n).beforeAuthStateChanged(e,t)}function vR(n,e,t,i){return yt(n).onAuthStateChanged(e,t,i)}function yR(n){return yt(n).signOut()}const Eh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Eh,"1"),this.storage.removeItem(Eh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR=1e3,xR=10;class ST extends CT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,p)=>{this.notifyListeners(d,p)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},c=this.storage.getItem(i);LI()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,xR):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},bR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ST.type="LOCAL";const NR=ST;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT extends CT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}IT.type="SESSION";const RT=IT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _R(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new Qh(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const f=Array.from(d).map(async g=>g(t.origin,c)),p=await _R(f);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((f,p)=>{const g=Gg("",20);o.port1.start();const y=setTimeout(()=>{p(new Error("unsupported_event"))},i);d={messageChannel:o,onMessage(x){const _=x;if(_.data.eventId===g)switch(_.data.status){case"ack":clearTimeout(y),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),f(_.data.response);break;default:clearTimeout(y),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(){return window}function TR(n){Ys().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(){return typeof Ys().WorkerGlobalScope<"u"&&typeof Ys().importScripts=="function"}async function jR(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function AR(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function wR(){return DT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT="firebaseLocalStorageDb",CR=1,Th="firebaseLocalStorage",OT="fbase_key";class fu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Kh(n,e){return n.transaction([Th],e?"readwrite":"readonly").objectStore(Th)}function SR(){const n=indexedDB.deleteDatabase(MT);return new fu(n).toPromise()}function og(){const n=indexedDB.open(MT,CR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Th,{keyPath:OT})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Th)?e(i):(i.close(),await SR(),e(await og()))})})}async function YN(n,e,t){const i=Kh(n,!0).put({[OT]:e,value:t});return new fu(i).toPromise()}async function IR(n,e){const t=Kh(n,!1).get(e),i=await new fu(t).toPromise();return i===void 0?null:i.value}function QN(n,e){const t=Kh(n,!0).delete(e);return new fu(t).toPromise()}const RR=800,DR=3;class kT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await og(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>DR)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return DT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qh._getInstance(wR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await jR(),!this.activeServiceWorker)return;this.sender=new ER(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||AR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await og();return await YN(e,Eh,"1"),await QN(e,Eh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>YN(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>IR(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>QN(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Kh(o,!1).getAll();return new fu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),RR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}kT.type="LOCAL";const MR=kT;new uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n,e){return e?Sa(e):(Ce(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g extends zg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function OR(n){return AT(n.auth,new $g(n),n.bypassAuthState)}function kR(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),dR(t,new $g(n),n.bypassAuthState)}async function PR(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),uR(t,new $g(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e,t,i,o,c=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:c,error:d,type:f}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:i,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OR;case"linkViaPopup":case"linkViaRedirect":return PR;case"reauthViaPopup":case"reauthViaRedirect":return kR;default:cs(this.auth,"internal-error")}}resolve(e){Da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR=new uu(2e3,1e4);async function VR(n,e,t){if(In(n.app))return Promise.reject(Es(n,"operation-not-supported-in-this-environment"));const i=Li(n);vI(n,e,Hg);const o=PT(i,t);return new Ar(i,"signInViaPopup",e,o).executeNotNull()}class Ar extends LT{constructor(e,t,i,o,c){super(e,t,o,c),this.provider=i,this.authWindow=null,this.pollId=null,Ar.currentPopupAction&&Ar.currentPopupAction.cancel(),Ar.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ce(e,this.auth,"internal-error"),e}async onExecution(){Da(this.filter.length===1,"Popup operations only handle one event");const e=Gg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Es(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Es(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ar.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Es(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,LR.get())};e()}}Ar.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR="pendingRedirect",oh=new Map;class FR extends LT{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=oh.get(this.auth._key());if(!e){try{const i=await qR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}oh.set(this.auth._key(),e)}return this.bypassAuthState||oh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qR(n,e){const t=HR(e),i=BR(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function zR(n,e){oh.set(n._key(),e)}function BR(n){return Sa(n._redirectPersistence)}function HR(n){return rh(UR,n.config.apiKey,n.name)}async function GR(n,e,t=!1){if(In(n.app))return Promise.reject(Ia(n));const i=Li(n),o=PT(i,e),d=await new FR(i,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R=10*60*1e3;class YR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!QR(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!VT(e)){const o=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(Es(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=$R&&this.cachedEventUids.clear(),this.cachedEventUids.has(KN(e))}saveEventToCache(e){this.cachedEventUids.add(KN(e)),this.lastProcessedEventTime=Date.now()}}function KN(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function VT({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function QR(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return VT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KR(n,e={}){return Pi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,WR=/^https?/;async function ZR(n){if(n.config.emulator)return;const{authorizedDomains:e}=await KR(n);for(const t of e)try{if(JR(t))return}catch{}cs(n,"unauthorized-domain")}function JR(n){const e=ag(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!WR.test(t))return!1;if(XR.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1=new uu(3e4,6e4);function XN(){const n=Ys().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function t1(n){return new Promise((e,t)=>{var i,o,c;function d(){XN(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{XN(),t(Es(n,"network-request-failed"))},timeout:e1.get()})}if(!((o=(i=Ys().gapi)===null||i===void 0?void 0:i.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((c=Ys().gapi)===null||c===void 0)&&c.load)d();else{const f=$I("iframefcb");return Ys()[f]=()=>{gapi.load?d():t(Es(n,"network-request-failed"))},_T(`${GI()}?onload=${f}`).catch(p=>t(p))}}).catch(e=>{throw lh=null,e})}let lh=null;function n1(n){return lh=lh||t1(n),lh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1=new uu(5e3,15e3),a1="__/auth/iframe",i1="emulator/auth/iframe",r1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},o1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function l1(n){const e=n.config;Ce(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ug(e,i1):`https://${n.config.authDomain}/${a1}`,i={apiKey:e.apiKey,appName:n.name,v:Vr},o=o1.get(n.config.apiHost);o&&(i.eid=o);const c=n._getFrameworks();return c.length&&(i.fw=c.join(",")),`${t}?${ou(i).slice(1)}`}async function c1(n){const e=await n1(n),t=Ys().gapi;return Ce(t,n,"internal-error"),e.open({where:document.body,url:l1(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:r1,dontclear:!0},i=>new Promise(async(o,c)=>{await i.restyle({setHideOnLeave:!1});const d=Es(n,"network-request-failed"),f=Ys().setTimeout(()=>{c(d)},s1.get());function p(){Ys().clearTimeout(f),o(i)}i.ping(p).then(p,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},d1=500,h1=600,f1="_blank",m1="http://localhost";class WN{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function p1(n,e,t,i=d1,o=h1){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const p=Object.assign(Object.assign({},u1),{width:i.toString(),height:o.toString(),top:c,left:d}),g=gn().toLowerCase();t&&(f=pT(g)?f1:t),fT(g)&&(e=e||m1,p.scrollbars="yes");const y=Object.entries(p).reduce((_,[A,N])=>`${_}${A}=${N},`,"");if(PI(g)&&f!=="_self")return g1(e||"",f),new WN(null);const x=window.open(e||"",f,y);Ce(x,n,"popup-blocked");try{x.focus()}catch{}return new WN(x)}function g1(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1="__/auth/handler",y1="emulator/auth/handler",b1=encodeURIComponent("fac");async function ZN(n,e,t,i,o,c){Ce(n.config.authDomain,n,"auth-domain-config-required"),Ce(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Vr,eventId:o};if(e instanceof Hg){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",eS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,x]of Object.entries({}))d[y]=x}if(e instanceof hu){const y=e.getScopes().filter(x=>x!=="");y.length>0&&(d.scopes=y.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const y of Object.keys(f))f[y]===void 0&&delete f[y];const p=await n._getAppCheckToken(),g=p?`#${b1}=${encodeURIComponent(p)}`:"";return`${x1(n)}?${ou(f).slice(1)}${g}`}function x1({config:n}){return n.emulator?Ug(n,y1):`https://${n.authDomain}/${v1}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="webStorageSupport";class N1{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=RT,this._completeRedirectFn=GR,this._overrideRedirectResult=zR}async _openPopup(e,t,i,o){var c;Da((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await ZN(e,t,i,ag(),o);return p1(e,d,Gg())}async _openRedirect(e,t,i,o){await this._originValidation(e);const c=await ZN(e,t,i,ag(),o);return TR(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Da(c,"If manager is not set, promise should be"),c)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await c1(e),i=new YR(e);return t.register("authEvent",o=>(Ce(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Lp,{type:Lp},o=>{var c;const d=(c=o?.[0])===null||c===void 0?void 0:c[Lp];d!==void 0&&t(!!d),cs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ZR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return xT()||mT()||qg()}}const _1=N1;var JN="@firebase/auth",e_="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T1(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function j1(n){ls(new $n("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=i.options;Ce(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const p={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:NT(n)},g=new zI(i,o,c,p);return ZI(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ls(new $n("auth-internal",e=>{const t=Li(e.getProvider("auth").getImmediate());return(i=>new E1(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pn(JN,e_,T1(n)),pn(JN,e_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A1=5*60,w1=ZE("authIdTokenMaxAge")||A1;let t_=null;const C1=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>w1)return;const o=t?.token;t_!==o&&(t_=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function S1(n=cu()){const e=ka(n,"auth");if(e.isInitialized())return e.getImmediate();const t=WI(n,{popupRedirectResolver:_1,persistence:[MR,NR,RT]}),i=ZE("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(i,location.origin);if(location.origin===c.origin){const d=C1(c.toString());gR(t,d,()=>d(t.currentUser)),pR(t,f=>d(f))}}const o=KE("auth");return o&&JI(t,`http://${o}`),t}function I1(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}BI({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const c=Es("internal-error");c.customData=o,t(c)},i.type="text/javascript",i.charset="UTF-8",I1().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});j1("Browser");var R1="firebase",D1="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn(R1,D1,"app");var n_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ni,UT;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(V,S){function L(){}L.prototype=S.prototype,V.D=S.prototype,V.prototype=new L,V.prototype.constructor=V,V.C=function(O,w,I){for(var R=Array(arguments.length-2),de=2;de<arguments.length;de++)R[de-2]=arguments[de];return S.prototype[w].apply(O,R)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(V,S,L){L||(L=0);var O=Array(16);if(typeof S=="string")for(var w=0;16>w;++w)O[w]=S.charCodeAt(L++)|S.charCodeAt(L++)<<8|S.charCodeAt(L++)<<16|S.charCodeAt(L++)<<24;else for(w=0;16>w;++w)O[w]=S[L++]|S[L++]<<8|S[L++]<<16|S[L++]<<24;S=V.g[0],L=V.g[1],w=V.g[2];var I=V.g[3],R=S+(I^L&(w^I))+O[0]+3614090360&4294967295;S=L+(R<<7&4294967295|R>>>25),R=I+(w^S&(L^w))+O[1]+3905402710&4294967295,I=S+(R<<12&4294967295|R>>>20),R=w+(L^I&(S^L))+O[2]+606105819&4294967295,w=I+(R<<17&4294967295|R>>>15),R=L+(S^w&(I^S))+O[3]+3250441966&4294967295,L=w+(R<<22&4294967295|R>>>10),R=S+(I^L&(w^I))+O[4]+4118548399&4294967295,S=L+(R<<7&4294967295|R>>>25),R=I+(w^S&(L^w))+O[5]+1200080426&4294967295,I=S+(R<<12&4294967295|R>>>20),R=w+(L^I&(S^L))+O[6]+2821735955&4294967295,w=I+(R<<17&4294967295|R>>>15),R=L+(S^w&(I^S))+O[7]+4249261313&4294967295,L=w+(R<<22&4294967295|R>>>10),R=S+(I^L&(w^I))+O[8]+1770035416&4294967295,S=L+(R<<7&4294967295|R>>>25),R=I+(w^S&(L^w))+O[9]+2336552879&4294967295,I=S+(R<<12&4294967295|R>>>20),R=w+(L^I&(S^L))+O[10]+4294925233&4294967295,w=I+(R<<17&4294967295|R>>>15),R=L+(S^w&(I^S))+O[11]+2304563134&4294967295,L=w+(R<<22&4294967295|R>>>10),R=S+(I^L&(w^I))+O[12]+1804603682&4294967295,S=L+(R<<7&4294967295|R>>>25),R=I+(w^S&(L^w))+O[13]+4254626195&4294967295,I=S+(R<<12&4294967295|R>>>20),R=w+(L^I&(S^L))+O[14]+2792965006&4294967295,w=I+(R<<17&4294967295|R>>>15),R=L+(S^w&(I^S))+O[15]+1236535329&4294967295,L=w+(R<<22&4294967295|R>>>10),R=S+(w^I&(L^w))+O[1]+4129170786&4294967295,S=L+(R<<5&4294967295|R>>>27),R=I+(L^w&(S^L))+O[6]+3225465664&4294967295,I=S+(R<<9&4294967295|R>>>23),R=w+(S^L&(I^S))+O[11]+643717713&4294967295,w=I+(R<<14&4294967295|R>>>18),R=L+(I^S&(w^I))+O[0]+3921069994&4294967295,L=w+(R<<20&4294967295|R>>>12),R=S+(w^I&(L^w))+O[5]+3593408605&4294967295,S=L+(R<<5&4294967295|R>>>27),R=I+(L^w&(S^L))+O[10]+38016083&4294967295,I=S+(R<<9&4294967295|R>>>23),R=w+(S^L&(I^S))+O[15]+3634488961&4294967295,w=I+(R<<14&4294967295|R>>>18),R=L+(I^S&(w^I))+O[4]+3889429448&4294967295,L=w+(R<<20&4294967295|R>>>12),R=S+(w^I&(L^w))+O[9]+568446438&4294967295,S=L+(R<<5&4294967295|R>>>27),R=I+(L^w&(S^L))+O[14]+3275163606&4294967295,I=S+(R<<9&4294967295|R>>>23),R=w+(S^L&(I^S))+O[3]+4107603335&4294967295,w=I+(R<<14&4294967295|R>>>18),R=L+(I^S&(w^I))+O[8]+1163531501&4294967295,L=w+(R<<20&4294967295|R>>>12),R=S+(w^I&(L^w))+O[13]+2850285829&4294967295,S=L+(R<<5&4294967295|R>>>27),R=I+(L^w&(S^L))+O[2]+4243563512&4294967295,I=S+(R<<9&4294967295|R>>>23),R=w+(S^L&(I^S))+O[7]+1735328473&4294967295,w=I+(R<<14&4294967295|R>>>18),R=L+(I^S&(w^I))+O[12]+2368359562&4294967295,L=w+(R<<20&4294967295|R>>>12),R=S+(L^w^I)+O[5]+4294588738&4294967295,S=L+(R<<4&4294967295|R>>>28),R=I+(S^L^w)+O[8]+2272392833&4294967295,I=S+(R<<11&4294967295|R>>>21),R=w+(I^S^L)+O[11]+1839030562&4294967295,w=I+(R<<16&4294967295|R>>>16),R=L+(w^I^S)+O[14]+4259657740&4294967295,L=w+(R<<23&4294967295|R>>>9),R=S+(L^w^I)+O[1]+2763975236&4294967295,S=L+(R<<4&4294967295|R>>>28),R=I+(S^L^w)+O[4]+1272893353&4294967295,I=S+(R<<11&4294967295|R>>>21),R=w+(I^S^L)+O[7]+4139469664&4294967295,w=I+(R<<16&4294967295|R>>>16),R=L+(w^I^S)+O[10]+3200236656&4294967295,L=w+(R<<23&4294967295|R>>>9),R=S+(L^w^I)+O[13]+681279174&4294967295,S=L+(R<<4&4294967295|R>>>28),R=I+(S^L^w)+O[0]+3936430074&4294967295,I=S+(R<<11&4294967295|R>>>21),R=w+(I^S^L)+O[3]+3572445317&4294967295,w=I+(R<<16&4294967295|R>>>16),R=L+(w^I^S)+O[6]+76029189&4294967295,L=w+(R<<23&4294967295|R>>>9),R=S+(L^w^I)+O[9]+3654602809&4294967295,S=L+(R<<4&4294967295|R>>>28),R=I+(S^L^w)+O[12]+3873151461&4294967295,I=S+(R<<11&4294967295|R>>>21),R=w+(I^S^L)+O[15]+530742520&4294967295,w=I+(R<<16&4294967295|R>>>16),R=L+(w^I^S)+O[2]+3299628645&4294967295,L=w+(R<<23&4294967295|R>>>9),R=S+(w^(L|~I))+O[0]+4096336452&4294967295,S=L+(R<<6&4294967295|R>>>26),R=I+(L^(S|~w))+O[7]+1126891415&4294967295,I=S+(R<<10&4294967295|R>>>22),R=w+(S^(I|~L))+O[14]+2878612391&4294967295,w=I+(R<<15&4294967295|R>>>17),R=L+(I^(w|~S))+O[5]+4237533241&4294967295,L=w+(R<<21&4294967295|R>>>11),R=S+(w^(L|~I))+O[12]+1700485571&4294967295,S=L+(R<<6&4294967295|R>>>26),R=I+(L^(S|~w))+O[3]+2399980690&4294967295,I=S+(R<<10&4294967295|R>>>22),R=w+(S^(I|~L))+O[10]+4293915773&4294967295,w=I+(R<<15&4294967295|R>>>17),R=L+(I^(w|~S))+O[1]+2240044497&4294967295,L=w+(R<<21&4294967295|R>>>11),R=S+(w^(L|~I))+O[8]+1873313359&4294967295,S=L+(R<<6&4294967295|R>>>26),R=I+(L^(S|~w))+O[15]+4264355552&4294967295,I=S+(R<<10&4294967295|R>>>22),R=w+(S^(I|~L))+O[6]+2734768916&4294967295,w=I+(R<<15&4294967295|R>>>17),R=L+(I^(w|~S))+O[13]+1309151649&4294967295,L=w+(R<<21&4294967295|R>>>11),R=S+(w^(L|~I))+O[4]+4149444226&4294967295,S=L+(R<<6&4294967295|R>>>26),R=I+(L^(S|~w))+O[11]+3174756917&4294967295,I=S+(R<<10&4294967295|R>>>22),R=w+(S^(I|~L))+O[2]+718787259&4294967295,w=I+(R<<15&4294967295|R>>>17),R=L+(I^(w|~S))+O[9]+3951481745&4294967295,V.g[0]=V.g[0]+S&4294967295,V.g[1]=V.g[1]+(w+(R<<21&4294967295|R>>>11))&4294967295,V.g[2]=V.g[2]+w&4294967295,V.g[3]=V.g[3]+I&4294967295}i.prototype.u=function(V,S){S===void 0&&(S=V.length);for(var L=S-this.blockSize,O=this.B,w=this.h,I=0;I<S;){if(w==0)for(;I<=L;)o(this,V,I),I+=this.blockSize;if(typeof V=="string"){for(;I<S;)if(O[w++]=V.charCodeAt(I++),w==this.blockSize){o(this,O),w=0;break}}else for(;I<S;)if(O[w++]=V[I++],w==this.blockSize){o(this,O),w=0;break}}this.h=w,this.o+=S},i.prototype.v=function(){var V=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);V[0]=128;for(var S=1;S<V.length-8;++S)V[S]=0;var L=8*this.o;for(S=V.length-8;S<V.length;++S)V[S]=L&255,L/=256;for(this.u(V),V=Array(16),S=L=0;4>S;++S)for(var O=0;32>O;O+=8)V[L++]=this.g[S]>>>O&255;return V};function c(V,S){var L=f;return Object.prototype.hasOwnProperty.call(L,V)?L[V]:L[V]=S(V)}function d(V,S){this.h=S;for(var L=[],O=!0,w=V.length-1;0<=w;w--){var I=V[w]|0;O&&I==S||(L[w]=I,O=!1)}this.g=L}var f={};function p(V){return-128<=V&&128>V?c(V,function(S){return new d([S|0],0>S?-1:0)}):new d([V|0],0>V?-1:0)}function g(V){if(isNaN(V)||!isFinite(V))return x;if(0>V)return T(g(-V));for(var S=[],L=1,O=0;V>=L;O++)S[O]=V/L|0,L*=4294967296;return new d(S,0)}function y(V,S){if(V.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(V.charAt(0)=="-")return T(y(V.substring(1),S));if(0<=V.indexOf("-"))throw Error('number format error: interior "-" character');for(var L=g(Math.pow(S,8)),O=x,w=0;w<V.length;w+=8){var I=Math.min(8,V.length-w),R=parseInt(V.substring(w,w+I),S);8>I?(I=g(Math.pow(S,I)),O=O.j(I).add(g(R))):(O=O.j(L),O=O.add(g(R)))}return O}var x=p(0),_=p(1),A=p(16777216);n=d.prototype,n.m=function(){if(C(this))return-T(this).m();for(var V=0,S=1,L=0;L<this.g.length;L++){var O=this.i(L);V+=(0<=O?O:4294967296+O)*S,S*=4294967296}return V},n.toString=function(V){if(V=V||10,2>V||36<V)throw Error("radix out of range: "+V);if(N(this))return"0";if(C(this))return"-"+T(this).toString(V);for(var S=g(Math.pow(V,6)),L=this,O="";;){var w=P(L,S).g;L=M(L,w.j(S));var I=((0<L.g.length?L.g[0]:L.h)>>>0).toString(V);if(L=w,N(L))return I+O;for(;6>I.length;)I="0"+I;O=I+O}},n.i=function(V){return 0>V?0:V<this.g.length?this.g[V]:this.h};function N(V){if(V.h!=0)return!1;for(var S=0;S<V.g.length;S++)if(V.g[S]!=0)return!1;return!0}function C(V){return V.h==-1}n.l=function(V){return V=M(this,V),C(V)?-1:N(V)?0:1};function T(V){for(var S=V.g.length,L=[],O=0;O<S;O++)L[O]=~V.g[O];return new d(L,~V.h).add(_)}n.abs=function(){return C(this)?T(this):this},n.add=function(V){for(var S=Math.max(this.g.length,V.g.length),L=[],O=0,w=0;w<=S;w++){var I=O+(this.i(w)&65535)+(V.i(w)&65535),R=(I>>>16)+(this.i(w)>>>16)+(V.i(w)>>>16);O=R>>>16,I&=65535,R&=65535,L[w]=R<<16|I}return new d(L,L[L.length-1]&-2147483648?-1:0)};function M(V,S){return V.add(T(S))}n.j=function(V){if(N(this)||N(V))return x;if(C(this))return C(V)?T(this).j(T(V)):T(T(this).j(V));if(C(V))return T(this.j(T(V)));if(0>this.l(A)&&0>V.l(A))return g(this.m()*V.m());for(var S=this.g.length+V.g.length,L=[],O=0;O<2*S;O++)L[O]=0;for(O=0;O<this.g.length;O++)for(var w=0;w<V.g.length;w++){var I=this.i(O)>>>16,R=this.i(O)&65535,de=V.i(w)>>>16,be=V.i(w)&65535;L[2*O+2*w]+=R*be,q(L,2*O+2*w),L[2*O+2*w+1]+=I*be,q(L,2*O+2*w+1),L[2*O+2*w+1]+=R*de,q(L,2*O+2*w+1),L[2*O+2*w+2]+=I*de,q(L,2*O+2*w+2)}for(O=0;O<S;O++)L[O]=L[2*O+1]<<16|L[2*O];for(O=S;O<2*S;O++)L[O]=0;return new d(L,0)};function q(V,S){for(;(V[S]&65535)!=V[S];)V[S+1]+=V[S]>>>16,V[S]&=65535,S++}function U(V,S){this.g=V,this.h=S}function P(V,S){if(N(S))throw Error("division by zero");if(N(V))return new U(x,x);if(C(V))return S=P(T(V),S),new U(T(S.g),T(S.h));if(C(S))return S=P(V,T(S)),new U(T(S.g),S.h);if(30<V.g.length){if(C(V)||C(S))throw Error("slowDivide_ only works with positive integers.");for(var L=_,O=S;0>=O.l(V);)L=F(L),O=F(O);var w=G(L,1),I=G(O,1);for(O=G(O,2),L=G(L,2);!N(O);){var R=I.add(O);0>=R.l(V)&&(w=w.add(L),I=R),O=G(O,1),L=G(L,1)}return S=M(V,w.j(S)),new U(w,S)}for(w=x;0<=V.l(S);){for(L=Math.max(1,Math.floor(V.m()/S.m())),O=Math.ceil(Math.log(L)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),I=g(L),R=I.j(S);C(R)||0<R.l(V);)L-=O,I=g(L),R=I.j(S);N(I)&&(I=_),w=w.add(I),V=M(V,R)}return new U(w,V)}n.A=function(V){return P(this,V).h},n.and=function(V){for(var S=Math.max(this.g.length,V.g.length),L=[],O=0;O<S;O++)L[O]=this.i(O)&V.i(O);return new d(L,this.h&V.h)},n.or=function(V){for(var S=Math.max(this.g.length,V.g.length),L=[],O=0;O<S;O++)L[O]=this.i(O)|V.i(O);return new d(L,this.h|V.h)},n.xor=function(V){for(var S=Math.max(this.g.length,V.g.length),L=[],O=0;O<S;O++)L[O]=this.i(O)^V.i(O);return new d(L,this.h^V.h)};function F(V){for(var S=V.g.length+1,L=[],O=0;O<S;O++)L[O]=V.i(O)<<1|V.i(O-1)>>>31;return new d(L,V.h)}function G(V,S){var L=S>>5;S%=32;for(var O=V.g.length-L,w=[],I=0;I<O;I++)w[I]=0<S?V.i(I+L)>>>S|V.i(I+L+1)<<32-S:V.i(I+L);return new d(w,V.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,UT=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=g,d.fromString=y,Ni=d}).apply(typeof n_<"u"?n_:typeof self<"u"?self:typeof window<"u"?window:{});var Wd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var FT,Ic,qT,ch,lg,zT,BT,HT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,b,E){return h==Array.prototype||h==Object.prototype||(h[b]=E.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wd=="object"&&Wd];for(var b=0;b<h.length;++b){var E=h[b];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var i=t(this);function o(h,b){if(b)e:{var E=i;h=h.split(".");for(var k=0;k<h.length-1;k++){var K=h[k];if(!(K in E))break e;E=E[K]}h=h[h.length-1],k=E[h],b=b(k),b!=k&&b!=null&&e(E,h,{configurable:!0,writable:!0,value:b})}}function c(h,b){h instanceof String&&(h+="");var E=0,k=!1,K={next:function(){if(!k&&E<h.length){var te=E++;return{value:b(te,h[te]),done:!1}}return k=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}o("Array.prototype.values",function(h){return h||function(){return c(this,function(b,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function p(h){var b=typeof h;return b=b!="object"?b:h?Array.isArray(h)?"array":b:"null",b=="array"||b=="object"&&typeof h.length=="number"}function g(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function y(h,b,E){return h.call.apply(h.bind,arguments)}function x(h,b,E){if(!h)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,k),h.apply(b,K)}}return function(){return h.apply(b,arguments)}}function _(h,b,E){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:x,_.apply(null,arguments)}function A(h,b){var E=Array.prototype.slice.call(arguments,1);return function(){var k=E.slice();return k.push.apply(k,arguments),h.apply(this,k)}}function N(h,b){function E(){}E.prototype=b.prototype,h.aa=b.prototype,h.prototype=new E,h.prototype.constructor=h,h.Qb=function(k,K,te){for(var he=Array(arguments.length-2),Qe=2;Qe<arguments.length;Qe++)he[Qe-2]=arguments[Qe];return b.prototype[K].apply(k,he)}}function C(h){const b=h.length;if(0<b){const E=Array(b);for(let k=0;k<b;k++)E[k]=h[k];return E}return[]}function T(h,b){for(let E=1;E<arguments.length;E++){const k=arguments[E];if(p(k)){const K=h.length||0,te=k.length||0;h.length=K+te;for(let he=0;he<te;he++)h[K+he]=k[he]}else h.push(k)}}class M{constructor(b,E){this.i=b,this.j=E,this.h=0,this.g=null}get(){let b;return 0<this.h?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function q(h){return/^[\s\xa0]*$/.test(h)}function U(){var h=f.navigator;return h&&(h=h.userAgent)?h:""}function P(h){return P[" "](h),h}P[" "]=function(){};var F=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function G(h,b,E){for(const k in h)b.call(E,h[k],k,h)}function V(h,b){for(const E in h)b.call(void 0,h[E],E,h)}function S(h){const b={};for(const E in h)b[E]=h[E];return b}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(h,b){let E,k;for(let K=1;K<arguments.length;K++){k=arguments[K];for(E in k)h[E]=k[E];for(let te=0;te<L.length;te++)E=L[te],Object.prototype.hasOwnProperty.call(k,E)&&(h[E]=k[E])}}function w(h){var b=1;h=h.split(":");const E=[];for(;0<b&&h.length;)E.push(h.shift()),b--;return h.length&&E.push(h.join(":")),E}function I(h){f.setTimeout(()=>{throw h},0)}function R(){var h=ke;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class de{constructor(){this.h=this.g=null}add(b,E){const k=be.get();k.set(b,E),this.h?this.h.next=k:this.g=k,this.h=k}}var be=new M(()=>new Q,h=>h.reset());class Q{constructor(){this.next=this.g=this.h=null}set(b,E){this.h=b,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let se,fe=!1,ke=new de,B=()=>{const h=f.Promise.resolve(void 0);se=()=>{h.then(ee)}};var ee=()=>{for(var h;h=R();){try{h.h.call(h.g)}catch(E){I(E)}var b=be;b.j(h),100>b.h&&(b.h++,h.next=b.g,b.g=h)}fe=!1};function le(){this.s=this.s,this.C=this.C}le.prototype.s=!1,le.prototype.ma=function(){this.s||(this.s=!0,this.N())},le.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ce(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}ce.prototype.h=function(){this.defaultPrevented=!0};var _e=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};f.addEventListener("test",E,b),f.removeEventListener("test",E,b)}catch{}return h}();function ze(h,b){if(ce.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var E=this.type=h.type,k=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget){if(F){e:{try{P(b.nodeName);var K=!0;break e}catch{}K=!1}K||(b=null)}}else E=="mouseover"?b=h.fromElement:E=="mouseout"&&(b=h.toElement);this.relatedTarget=b,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Re[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&ze.aa.h.call(this)}}N(ze,ce);var Re={2:"touch",3:"pen",4:"mouse"};ze.prototype.h=function(){ze.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Ht="closure_listenable_"+(1e6*Math.random()|0),mt=0;function As(h,b,E,k,K){this.listener=h,this.proxy=null,this.src=b,this.type=E,this.capture=!!k,this.ha=K,this.key=++mt,this.da=this.fa=!1}function La(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function ea(h){this.src=h,this.g={},this.h=0}ea.prototype.add=function(h,b,E,k,K){var te=h.toString();h=this.g[te],h||(h=this.g[te]=[],this.h++);var he=zi(h,b,k,K);return-1<he?(b=h[he],E||(b.fa=!1)):(b=new As(b,this.src,te,!!k,K),b.fa=E,h.push(b)),b};function qi(h,b){var E=b.type;if(E in h.g){var k=h.g[E],K=Array.prototype.indexOf.call(k,b,void 0),te;(te=0<=K)&&Array.prototype.splice.call(k,K,1),te&&(La(b),h.g[E].length==0&&(delete h.g[E],h.h--))}}function zi(h,b,E,k){for(var K=0;K<h.length;++K){var te=h[K];if(!te.da&&te.listener==b&&te.capture==!!E&&te.ha==k)return K}return-1}var Bi="closure_lm_"+(1e6*Math.random()|0),yl={};function Au(h,b,E,k,K){if(Array.isArray(b)){for(var te=0;te<b.length;te++)Au(h,b[te],E,k,K);return null}return E=wu(E),h&&h[Ht]?h.K(b,E,g(k)?!!k.capture:!1,K):Yn(h,b,E,!1,k,K)}function Yn(h,b,E,k,K,te){if(!b)throw Error("Invalid event type");var he=g(K)?!!K.capture:!!K,Qe=Hr(h);if(Qe||(h[Bi]=Qe=new ea(h)),E=Qe.add(b,E,k,he,te),E.proxy)return E;if(k=jf(),E.proxy=k,k.src=h,k.listener=E,h.addEventListener)_e||(K=he),K===void 0&&(K=!1),h.addEventListener(b.toString(),k,K);else if(h.attachEvent)h.attachEvent(Hi(b.toString()),k);else if(h.addListener&&h.removeListener)h.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return E}function jf(){function h(E){return b.call(h.src,h.listener,E)}const b=Af;return h}function bl(h,b,E,k,K){if(Array.isArray(b))for(var te=0;te<b.length;te++)bl(h,b[te],E,k,K);else k=g(k)?!!k.capture:!!k,E=wu(E),h&&h[Ht]?(h=h.i,b=String(b).toString(),b in h.g&&(te=h.g[b],E=zi(te,E,k,K),-1<E&&(La(te[E]),Array.prototype.splice.call(te,E,1),te.length==0&&(delete h.g[b],h.h--)))):h&&(h=Hr(h))&&(b=h.g[b.toString()],h=-1,b&&(h=zi(b,E,k,K)),(E=-1<h?b[h]:null)&&Br(E))}function Br(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[Ht])qi(b.i,h);else{var E=h.type,k=h.proxy;b.removeEventListener?b.removeEventListener(E,k,h.capture):b.detachEvent?b.detachEvent(Hi(E),k):b.addListener&&b.removeListener&&b.removeListener(k),(E=Hr(b))?(qi(E,h),E.h==0&&(E.src=null,b[Bi]=null)):La(h)}}}function Hi(h){return h in yl?yl[h]:yl[h]="on"+h}function Af(h,b){if(h.da)h=!0;else{b=new ze(b,this);var E=h.listener,k=h.ha||h.src;h.fa&&Br(h),h=E.call(k,b)}return h}function Hr(h){return h=h[Bi],h instanceof ea?h:null}var xl="__closure_events_fn_"+(1e9*Math.random()>>>0);function wu(h){return typeof h=="function"?h:(h[xl]||(h[xl]=function(b){return h.handleEvent(b)}),h[xl])}function Et(){le.call(this),this.i=new ea(this),this.M=this,this.F=null}N(Et,le),Et.prototype[Ht]=!0,Et.prototype.removeEventListener=function(h,b,E,k){bl(this,h,b,E,k)};function st(h,b){var E,k=h.F;if(k)for(E=[];k;k=k.F)E.push(k);if(h=h.M,k=b.type||b,typeof b=="string")b=new ce(b,h);else if(b instanceof ce)b.target=b.target||h;else{var K=b;b=new ce(k,h),O(b,K)}if(K=!0,E)for(var te=E.length-1;0<=te;te--){var he=b.g=E[te];K=Mn(he,k,!0,b)&&K}if(he=b.g=h,K=Mn(he,k,!0,b)&&K,K=Mn(he,k,!1,b)&&K,E)for(te=0;te<E.length;te++)he=b.g=E[te],K=Mn(he,k,!1,b)&&K}Et.prototype.N=function(){if(Et.aa.N.call(this),this.i){var h=this.i,b;for(b in h.g){for(var E=h.g[b],k=0;k<E.length;k++)La(E[k]);delete h.g[b],h.h--}}this.F=null},Et.prototype.K=function(h,b,E,k){return this.i.add(String(h),b,!1,E,k)},Et.prototype.L=function(h,b,E,k){return this.i.add(String(h),b,!0,E,k)};function Mn(h,b,E,k){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();for(var K=!0,te=0;te<b.length;++te){var he=b[te];if(he&&!he.da&&he.capture==E){var Qe=he.listener,Lt=he.ha||he.src;he.fa&&qi(h.i,he),K=Qe.call(Lt,k)!==!1&&K}}return K&&!k.defaultPrevented}function cn(h,b,E){if(typeof h=="function")E&&(h=_(h,E));else if(h&&typeof h.handleEvent=="function")h=_(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:f.setTimeout(h,b||0)}function Cu(h){h.g=cn(()=>{h.g=null,h.i&&(h.i=!1,Cu(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class wf extends le{constructor(b,E){super(),this.m=b,this.l=E,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Cu(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gi(h){le.call(this),this.h=h,this.g={}}N(Gi,le);var $i=[];function Yi(h){G(h.g,function(b,E){this.g.hasOwnProperty(E)&&Br(b)},h),h.g={}}Gi.prototype.N=function(){Gi.aa.N.call(this),Yi(this)},Gi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hs=f.JSON.stringify,Gr=f.JSON.parse,Qi=class{stringify(h){return f.JSON.stringify(h,void 0)}parse(h){return f.JSON.parse(h,void 0)}};function Nl(){}Nl.prototype.h=null;function _l(h){return h.h||(h.h=h.i())}function El(){}var ta={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function na(){ce.call(this,"d")}N(na,ce);function Tl(){ce.call(this,"c")}N(Tl,ce);var ws={},jl=null;function Va(){return jl=jl||new Et}ws.La="serverreachability";function $r(h){ce.call(this,ws.La,h)}N($r,ce);function Ua(h){const b=Va();st(b,new $r(b))}ws.STAT_EVENT="statevent";function Su(h,b){ce.call(this,ws.STAT_EVENT,h),this.stat=b}N(Su,ce);function bt(h){const b=Va();st(b,new Su(b,h))}ws.Ma="timingevent";function Pt(h,b){ce.call(this,ws.Ma,h),this.size=b}N(Pt,ce);function It(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){h()},b)}function Qn(){this.g=!0}Qn.prototype.xa=function(){this.g=!1};function Al(h,b,E,k,K,te){h.info(function(){if(h.g)if(te)for(var he="",Qe=te.split("&"),Lt=0;Lt<Qe.length;Lt++){var Ke=Qe[Lt].split("=");if(1<Ke.length){var $t=Ke[0];Ke=Ke[1];var Vt=$t.split("_");he=2<=Vt.length&&Vt[1]=="type"?he+($t+"="+Ke+"&"):he+($t+"=redacted&")}}else he=null;else he=te;return"XMLHTTP REQ ("+k+") [attempt "+K+"]: "+b+`
`+E+`
`+he})}function Cf(h,b,E,k,K,te,he){h.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+K+"]: "+b+`
`+E+`
`+te+" "+he})}function Fa(h,b,E,k){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+Ki(h,E)+(k?" "+k:"")})}function Iu(h,b){h.info(function(){return"TIMEOUT: "+b})}Qn.prototype.info=function(){};function Ki(h,b){if(!h.g)return b;if(!b)return null;try{var E=JSON.parse(b);if(E){for(h=0;h<E.length;h++)if(Array.isArray(E[h])){var k=E[h];if(!(2>k.length)){var K=k[1];if(Array.isArray(K)&&!(1>K.length)){var te=K[0];if(te!="noop"&&te!="stop"&&te!="close")for(var he=1;he<K.length;he++)K[he]=""}}}}return hs(E)}catch{return b}}var qa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},sa={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Cs;function Ss(){}N(Ss,Nl),Ss.prototype.g=function(){return new XMLHttpRequest},Ss.prototype.i=function(){return{}},Cs=new Ss;function vn(h,b,E,k){this.j=h,this.i=b,this.l=E,this.R=k||1,this.U=new Gi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new At}function At(){this.i=null,this.g="",this.h=!1}var wl={},Yr={};function fs(h,b,E){h.L=1,h.v=er(On(b)),h.m=E,h.P=!0,aa(h,null)}function aa(h,b){h.F=Date.now(),Xi(h),h.A=On(h.v);var E=h.A,k=h.R;Array.isArray(k)||(k=[String(k)]),Ml(E.i,"t",k),h.C=0,E=h.j.J,h.h=new At,h.g=$u(h.j,E?b:null,!h.m),0<h.O&&(h.M=new wf(_(h.Y,h,h.g),h.O)),b=h.U,E=h.g,k=h.ca;var K="readystatechange";Array.isArray(K)||(K&&($i[0]=K.toString()),K=$i);for(var te=0;te<K.length;te++){var he=Au(E,K[te],k||b.handleEvent,!1,b.h||b);if(!he)break;b.g[he.key]=he}b=h.H?S(h.H):{},h.m?(h.u||(h.u="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,b)):(h.u="GET",h.g.ea(h.A,h.u,null,b)),Ua(),Al(h.i,h.u,h.A,h.l,h.R,h.m)}vn.prototype.ca=function(h){h=h.target;const b=this.M;b&&Zn(h)==3?b.j():this.Y(h)},vn.prototype.Y=function(h){try{if(h==this.g)e:{const Vt=Zn(this.g);var b=this.g.Ba();const ha=this.g.Z();if(!(3>Vt)&&(Vt!=3||this.g&&(this.h.h||this.g.oa()||Vu(this.g)))){this.J||Vt!=4||b==7||(b==8||0>=ha?Ua(3):Ua(2)),za(this);var E=this.g.Z();this.X=E;t:if(Ru(this)){var k=Vu(this.g);h="";var K=k.length,te=Zn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zt(this),Is(this);var he="";break t}this.h.i=new f.TextDecoder}for(b=0;b<K;b++)this.h.h=!0,h+=this.h.i.decode(k[b],{stream:!(te&&b==K-1)});k.length=0,this.h.g+=h,this.C=0,he=this.h.g}else he=this.g.oa();if(this.o=E==200,Cf(this.i,this.u,this.A,this.l,this.R,Vt,E),this.o){if(this.T&&!this.K){t:{if(this.g){var Qe,Lt=this.g;if((Qe=Lt.g?Lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(Qe)){var Ke=Qe;break t}}Ke=null}if(E=Ke)Fa(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wi(this,E);else{this.o=!1,this.s=3,bt(12),Zt(this),Is(this);break e}}if(this.P){E=!0;let Jt;for(;!this.J&&this.C<he.length;)if(Jt=Du(this,he),Jt==Yr){Vt==4&&(this.s=4,bt(14),E=!1),Fa(this.i,this.l,null,"[Incomplete Response]");break}else if(Jt==wl){this.s=4,bt(15),Fa(this.i,this.l,he,"[Invalid Chunk]"),E=!1;break}else Fa(this.i,this.l,Jt,null),Wi(this,Jt);if(Ru(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vt!=4||he.length!=0||this.h.h||(this.s=1,bt(16),E=!1),this.o=this.o&&E,!E)Fa(this.i,this.l,he,"[Invalid Chunked Response]"),Zt(this),Is(this);else if(0<he.length&&!this.W){this.W=!0;var $t=this.j;$t.g==this&&$t.ba&&!$t.M&&($t.j.info("Great, no buffering proxy detected. Bytes received: "+he.length),lr($t),$t.M=!0,bt(11))}}else Fa(this.i,this.l,he,null),Wi(this,he);Vt==4&&Zt(this),this.o&&!this.J&&(Vt==4?Bu(this.j,this):(this.o=!1,Xi(this)))}else Mf(this.g),E==400&&0<he.indexOf("Unknown SID")?(this.s=3,bt(12)):(this.s=0,bt(13)),Zt(this),Is(this)}}}catch{}finally{}};function Ru(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Du(h,b){var E=h.C,k=b.indexOf(`
`,E);return k==-1?Yr:(E=Number(b.substring(E,k)),isNaN(E)?wl:(k+=1,k+E>b.length?Yr:(b=b.slice(k,k+E),h.C=k+E,b)))}vn.prototype.cancel=function(){this.J=!0,Zt(this)};function Xi(h){h.S=Date.now()+h.I,Mu(h,h.I)}function Mu(h,b){if(h.B!=null)throw Error("WatchDog timer not null");h.B=It(_(h.ba,h),b)}function za(h){h.B&&(f.clearTimeout(h.B),h.B=null)}vn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Iu(this.i,this.A),this.L!=2&&(Ua(),bt(17)),Zt(this),this.s=2,Is(this)):Mu(this,this.S-h)};function Is(h){h.j.G==0||h.J||Bu(h.j,h)}function Zt(h){za(h);var b=h.M;b&&typeof b.ma=="function"&&b.ma(),h.M=null,Yi(h.U),h.g&&(b=h.g,h.g=null,b.abort(),b.ma())}function Wi(h,b){try{var E=h.j;if(E.G!=0&&(E.g==h||Cl(E.h,h))){if(!h.K&&Cl(E.h,h)&&E.G==3){try{var k=E.Da.g.parse(b)}catch{k=null}if(Array.isArray(k)&&k.length==3){var K=k;if(K[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<h.F)io(E),so(E);else break e;Vl(E),bt(18)}}else E.za=K[1],0<E.za-E.T&&37500>K[2]&&E.F&&E.v==0&&!E.C&&(E.C=It(_(E.Za,E),6e3));if(1>=Kr(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else da(E,11)}else if((h.K||E.g==h)&&io(E),!q(b))for(K=E.Da.g.parse(b),b=0;b<K.length;b++){let Ke=K[b];if(E.T=Ke[0],Ke=Ke[1],E.G==2)if(Ke[0]=="c"){E.K=Ke[1],E.ia=Ke[2];const $t=Ke[3];$t!=null&&(E.la=$t,E.j.info("VER="+E.la));const Vt=Ke[4];Vt!=null&&(E.Aa=Vt,E.j.info("SVER="+E.Aa));const ha=Ke[5];ha!=null&&typeof ha=="number"&&0<ha&&(k=1.5*ha,E.L=k,E.j.info("backChannelRequestTimeoutMs_="+k)),k=E;const Jt=h.g;if(Jt){const Ls=Jt.g?Jt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ls){var te=k.h;te.g||Ls.indexOf("spdy")==-1&&Ls.indexOf("quic")==-1&&Ls.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Xr(te,te.h),te.h=null))}if(k.D){const Fl=Jt.g?Jt.g.getResponseHeader("X-HTTP-Session-Id"):null;Fl&&(k.ya=Fl,rt(k.I,k.D,Fl))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-h.F,E.j.info("Handshake RTT: "+E.R+"ms")),k=E;var he=h;if(k.qa=Gu(k,k.J?k.ia:null,k.W),he.K){yn(k.h,he);var Qe=he,Lt=k.L;Lt&&(Qe.I=Lt),Qe.B&&(za(Qe),Xi(Qe)),k.g=he}else qu(k);0<E.i.length&&ao(E)}else Ke[0]!="stop"&&Ke[0]!="close"||da(E,7);else E.G==3&&(Ke[0]=="stop"||Ke[0]=="close"?Ke[0]=="stop"?da(E,7):Pl(E):Ke[0]!="noop"&&E.l&&E.l.ta(Ke),E.v=0)}}Ua(4)}catch{}}var Ou=class{constructor(h,b){this.g=h,this.map=b}};function ia(h){this.l=h||10,f.PerformanceNavigationTiming?(h=f.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Kr(h){return h.h?1:h.g?h.g.size:0}function Cl(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Xr(h,b){h.g?h.g.add(b):h.h=b}function yn(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}ia.prototype.cancel=function(){if(this.i=Sl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Sl(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const E of h.g.values())b=b.concat(E.D);return b}return C(h.i)}function Sf(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var b=[],E=h.length,k=0;k<E;k++)b.push(h[k]);return b}b=[],E=0;for(k in h)b[E++]=h[k];return b}function Wr(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var b=[];h=h.length;for(var E=0;E<h;E++)b.push(E);return b}b=[],E=0;for(const k in h)b[E++]=k;return b}}}function Il(h,b){if(h.forEach&&typeof h.forEach=="function")h.forEach(b,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,b,void 0);else for(var E=Wr(h),k=Sf(h),K=k.length,te=0;te<K;te++)b.call(void 0,k[te],E&&E[te],h)}var Zi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function If(h,b){if(h){h=h.split("&");for(var E=0;E<h.length;E++){var k=h[E].indexOf("="),K=null;if(0<=k){var te=h[E].substring(0,k);K=h[E].substring(k+1)}else te=h[E];b(te,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Rt(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Rt){this.h=h.h,Ji(this,h.j),this.o=h.o,this.g=h.g,Ba(this,h.s),this.l=h.l;var b=h.i,E=new oa;E.i=b.i,b.g&&(E.g=new Map(b.g),E.h=b.h),ra(this,E),this.m=h.m}else h&&(b=String(h).match(Zi))?(this.h=!1,Ji(this,b[1]||"",!0),this.o=Kn(b[2]||""),this.g=Kn(b[3]||"",!0),Ba(this,b[4]),this.l=Kn(b[5]||"",!0),ra(this,b[6]||"",!0),this.m=Kn(b[7]||"")):(this.h=!1,this.i=new oa(null,this.h))}Rt.prototype.toString=function(){var h=[],b=this.j;b&&h.push(tr(b,Rl,!0),":");var E=this.g;return(E||b=="file")&&(h.push("//"),(b=this.o)&&h.push(tr(b,Rl,!0),"@"),h.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&h.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(tr(E,E.charAt(0)=="/"?Rf:Dl,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",tr(E,Zr)),h.join("")};function On(h){return new Rt(h)}function Ji(h,b,E){h.j=E?Kn(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function Ba(h,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);h.s=b}else h.s=null}function ra(h,b,E){b instanceof oa?(h.i=b,Pu(h.i,h.h)):(E||(b=tr(b,Df)),h.i=new oa(b,h.h))}function rt(h,b,E){h.i.set(b,E)}function er(h){return rt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Kn(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function tr(h,b,E){return typeof h=="string"?(h=encodeURI(h).replace(b,ku),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function ku(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Rl=/[#\/\?@]/g,Dl=/[#\?:]/g,Rf=/[#\?]/g,Df=/[#\?@]/g,Zr=/#/g;function oa(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Xn(h){h.g||(h.g=new Map,h.h=0,h.i&&If(h.i,function(b,E){h.add(decodeURIComponent(b.replace(/\+/g," ")),E)}))}n=oa.prototype,n.add=function(h,b){Xn(this),this.i=null,h=Rs(this,h);var E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(b),this.h+=1,this};function la(h,b){Xn(h),b=Rs(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function ca(h,b){return Xn(h),b=Rs(h,b),h.g.has(b)}n.forEach=function(h,b){Xn(this),this.g.forEach(function(E,k){E.forEach(function(K){h.call(b,K,k,this)},this)},this)},n.na=function(){Xn(this);const h=Array.from(this.g.values()),b=Array.from(this.g.keys()),E=[];for(let k=0;k<b.length;k++){const K=h[k];for(let te=0;te<K.length;te++)E.push(b[k])}return E},n.V=function(h){Xn(this);let b=[];if(typeof h=="string")ca(this,h)&&(b=b.concat(this.g.get(Rs(this,h))));else{h=Array.from(this.g.values());for(let E=0;E<h.length;E++)b=b.concat(h[E])}return b},n.set=function(h,b){return Xn(this),this.i=null,h=Rs(this,h),ca(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=this.V(h),0<h.length?String(h[0]):b):b};function Ml(h,b,E){la(h,b),0<E.length&&(h.i=null,h.g.set(Rs(h,b),C(E)),h.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(var E=0;E<b.length;E++){var k=b[E];const te=encodeURIComponent(String(k)),he=this.V(k);for(k=0;k<he.length;k++){var K=te;he[k]!==""&&(K+="="+encodeURIComponent(String(he[k]))),h.push(K)}}return this.i=h.join("&")};function Rs(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function Pu(h,b){b&&!h.j&&(Xn(h),h.i=null,h.g.forEach(function(E,k){var K=k.toLowerCase();k!=K&&(la(this,k),Ml(this,K,E))},h)),h.j=b}function nr(h,b){const E=new Qn;if(f.Image){const k=new Image;k.onload=A(Wn,E,"TestLoadImage: loaded",!0,b,k),k.onerror=A(Wn,E,"TestLoadImage: error",!1,b,k),k.onabort=A(Wn,E,"TestLoadImage: abort",!1,b,k),k.ontimeout=A(Wn,E,"TestLoadImage: timeout",!1,b,k),f.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=h}else b(!1)}function ms(h,b){const E=new Qn,k=new AbortController,K=setTimeout(()=>{k.abort(),Wn(E,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:k.signal}).then(te=>{clearTimeout(K),te.ok?Wn(E,"TestPingServer: ok",!0,b):Wn(E,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(K),Wn(E,"TestPingServer: error",!1,b)})}function Wn(h,b,E,k,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),k(E)}catch{}}function sr(){this.g=new Qi}function Ds(h,b,E){const k=E||"";try{Il(h,function(K,te){let he=K;g(K)&&(he=hs(K)),b.push(k+te+"="+encodeURIComponent(he))})}catch(K){throw b.push(k+"type="+encodeURIComponent("_badmap")),K}}function Ha(h){this.l=h.Ub||null,this.j=h.eb||!1}N(Ha,Nl),Ha.prototype.g=function(){return new ua(this.l,this.j)},Ha.prototype.i=function(h){return function(){return h}}({});function ua(h,b){Et.call(this),this.D=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(ua,Et),n=ua.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=b,this.readyState=1,Os(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const b={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(b.body=h),(this.D||f).fetch(new Request(this.A,b)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ms(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Os(this)),this.g&&(this.readyState=3,Os(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ol(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ol(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.v.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Ms(this):Os(this),this.readyState==3&&Ol(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Ms(this))},n.Qa=function(h){this.g&&(this.response=h,Ms(this))},n.ga=function(){this.g&&Ms(this)};function Ms(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Os(h)}n.setRequestHeader=function(h,b){this.u.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var E=b.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=b.next();return h.join(`\r
`)};function Os(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(ua.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function kl(h){let b="";return G(h,function(E,k){b+=k,b+=":",b+=E,b+=`\r
`}),b}function Gt(h,b,E){e:{for(k in E){var k=!1;break e}k=!0}k||(E=kl(E),typeof h=="string"?E!=null&&encodeURIComponent(String(E)):rt(h,b,E))}function nt(h){Et.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(nt,Et);var Jr=/^https?$/i,ar=["POST","PUT"];n=nt.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,b,E,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Cs.g(),this.v=this.o?_l(this.o):_l(Cs),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(te){Lu(this,te);return}if(h=E||"",E=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var K in k)E.set(K,k[K]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const te of k.keys())E.set(te,k.get(te));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(E.keys()).find(te=>te.toLowerCase()=="content-type"),K=f.FormData&&h instanceof f.FormData,!(0<=Array.prototype.indexOf.call(ar,b,void 0))||k||K||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,he]of E)this.g.setRequestHeader(te,he);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ir(this),this.u=!0,this.g.send(h),this.u=!1}catch(te){Lu(this,te)}};function Lu(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.m=5,eo(h),ks(h)}function eo(h){h.A||(h.A=!0,st(h,"complete"),st(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,st(this,"complete"),st(this,"abort"),ks(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ks(this,!0)),nt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?to(this):this.bb())},n.bb=function(){to(this)};function to(h){if(h.h&&typeof d<"u"&&(!h.v[1]||Zn(h)!=4||h.Z()!=2)){if(h.u&&Zn(h)==4)cn(h.Ea,0,h);else if(st(h,"readystatechange"),Zn(h)==4){h.h=!1;try{const he=h.Z();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var E;if(!(E=b)){var k;if(k=he===0){var K=String(h.D).match(Zi)[1]||null;!K&&f.self&&f.self.location&&(K=f.self.location.protocol.slice(0,-1)),k=!Jr.test(K?K.toLowerCase():"")}E=k}if(E)st(h,"complete"),st(h,"success");else{h.m=6;try{var te=2<Zn(h)?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.Z()+"]",eo(h)}}finally{ks(h)}}}}function ks(h,b){if(h.g){ir(h);const E=h.g,k=h.v[0]?()=>{}:null;h.g=null,h.v=null,b||st(h,"ready");try{E.onreadystatechange=k}catch{}}}function ir(h){h.I&&(f.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function Zn(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<Zn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),Gr(b)}};function Vu(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Mf(h){const b={};h=(h.g&&2<=Zn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<h.length;k++){if(q(h[k]))continue;var E=w(h[k]);const K=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const te=b[K]||[];b[K]=te,te.push(E)}V(b,function(k){return k.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function rr(h,b,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||b}function no(h){this.Aa=0,this.i=[],this.j=new Qn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rr("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rr("baseRetryDelayMs",5e3,h),this.cb=rr("retryDelaySeedMs",1e4,h),this.Wa=rr("forwardChannelMaxRetries",2,h),this.wa=rr("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ia(h&&h.concurrentRequestLimit),this.Da=new sr,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=no.prototype,n.la=8,n.G=1,n.connect=function(h,b,E,k){bt(0),this.W=h,this.H=b||{},E&&k!==void 0&&(this.H.OSID=E,this.H.OAID=k),this.F=this.X,this.I=Gu(this,null,this.W),ao(this)};function Pl(h){if(Uu(h),h.G==3){var b=h.U++,E=On(h.I);if(rt(E,"SID",h.K),rt(E,"RID",b),rt(E,"TYPE","terminate"),or(h,E),b=new vn(h,h.j,b),b.L=2,b.v=er(On(E)),E=!1,f.navigator&&f.navigator.sendBeacon)try{E=f.navigator.sendBeacon(b.v.toString(),"")}catch{}!E&&f.Image&&(new Image().src=b.v,E=!0),E||(b.g=$u(b.j,null),b.g.ea(b.v)),b.F=Date.now(),Xi(b)}Hu(h)}function so(h){h.g&&(lr(h),h.g.cancel(),h.g=null)}function Uu(h){so(h),h.u&&(f.clearTimeout(h.u),h.u=null),io(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&f.clearTimeout(h.s),h.s=null)}function ao(h){if(!Qr(h.h)&&!h.s){h.s=!0;var b=h.Ga;se||B(),fe||(se(),fe=!0),ke.add(b,h),h.B=0}}function Of(h,b){return Kr(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=b.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=It(_(h.Ga,h,b),Ul(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const K=new vn(this,this.j,h);let te=this.o;if(this.S&&(te?(te=S(te),O(te,this.S)):te=this.S),this.m!==null||this.O||(K.H=te,te=null),this.P)e:{for(var b=0,E=0;E<this.i.length;E++){t:{var k=this.i[E];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(b+=k,4096<b){b=E;break e}if(b===4096||E===this.i.length-1){b=E+1;break e}}b=1e3}else b=1e3;b=Fu(this,K,b),E=On(this.I),rt(E,"RID",h),rt(E,"CVER",22),this.D&&rt(E,"X-HTTP-Session-Id",this.D),or(this,E),te&&(this.O?b="headers="+encodeURIComponent(String(kl(te)))+"&"+b:this.m&&Gt(E,this.m,te)),Xr(this.h,K),this.Ua&&rt(E,"TYPE","init"),this.P?(rt(E,"$req",b),rt(E,"SID","null"),K.T=!0,fs(K,E,null)):fs(K,E,b),this.G=2}}else this.G==3&&(h?Ll(this,h):this.i.length==0||Qr(this.h)||Ll(this))};function Ll(h,b){var E;b?E=b.l:E=h.U++;const k=On(h.I);rt(k,"SID",h.K),rt(k,"RID",E),rt(k,"AID",h.T),or(h,k),h.m&&h.o&&Gt(k,h.m,h.o),E=new vn(h,h.j,E,h.B+1),h.m===null&&(E.H=h.o),b&&(h.i=b.D.concat(h.i)),b=Fu(h,E,1e3),E.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Xr(h.h,E),fs(E,k,b)}function or(h,b){h.H&&G(h.H,function(E,k){rt(b,k,E)}),h.l&&Il({},function(E,k){rt(b,k,E)})}function Fu(h,b,E){E=Math.min(h.i.length,E);var k=h.l?_(h.l.Na,h.l,h):null;e:{var K=h.i;let te=-1;for(;;){const he=["count="+E];te==-1?0<E?(te=K[0].g,he.push("ofs="+te)):te=0:he.push("ofs="+te);let Qe=!0;for(let Lt=0;Lt<E;Lt++){let Ke=K[Lt].g;const $t=K[Lt].map;if(Ke-=te,0>Ke)te=Math.max(0,K[Lt].g-100),Qe=!1;else try{Ds($t,he,"req"+Ke+"_")}catch{k&&k($t)}}if(Qe){k=he.join("&");break e}}}return h=h.i.splice(0,E),b.D=h,k}function qu(h){if(!h.g&&!h.u){h.Y=1;var b=h.Fa;se||B(),fe||(se(),fe=!0),ke.add(b,h),h.v=0}}function Vl(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=It(_(h.Fa,h),Ul(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,zu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=It(_(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bt(10),so(this),zu(this))};function lr(h){h.A!=null&&(f.clearTimeout(h.A),h.A=null)}function zu(h){h.g=new vn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var b=On(h.qa);rt(b,"RID","rpc"),rt(b,"SID",h.K),rt(b,"AID",h.T),rt(b,"CI",h.F?"0":"1"),!h.F&&h.ja&&rt(b,"TO",h.ja),rt(b,"TYPE","xmlhttp"),or(h,b),h.m&&h.o&&Gt(b,h.m,h.o),h.L&&(h.g.I=h.L);var E=h.g;h=h.ia,E.L=1,E.v=er(On(b)),E.m=null,E.P=!0,aa(E,h)}n.Za=function(){this.C!=null&&(this.C=null,so(this),Vl(this),bt(19))};function io(h){h.C!=null&&(f.clearTimeout(h.C),h.C=null)}function Bu(h,b){var E=null;if(h.g==b){io(h),lr(h),h.g=null;var k=2}else if(Cl(h.h,b))E=b.D,yn(h.h,b),k=1;else return;if(h.G!=0){if(b.o)if(k==1){E=b.m?b.m.length:0,b=Date.now()-b.F;var K=h.B;k=Va(),st(k,new Pt(k,E)),ao(h)}else qu(h);else if(K=b.s,K==3||K==0&&0<b.X||!(k==1&&Of(h,b)||k==2&&Vl(h)))switch(E&&0<E.length&&(b=h.h,b.i=b.i.concat(E)),K){case 1:da(h,5);break;case 4:da(h,10);break;case 3:da(h,6);break;default:da(h,2)}}}function Ul(h,b){let E=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(E*=2),E*b}function da(h,b){if(h.j.info("Error code "+b),b==2){var E=_(h.fb,h),k=h.Xa;const K=!k;k=new Rt(k||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||Ji(k,"https"),er(k),K?nr(k.toString(),E):ms(k.toString(),E)}else bt(2);h.G=0,h.l&&h.l.sa(b),Hu(h),Uu(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function Hu(h){if(h.G=0,h.ka=[],h.l){const b=Sl(h.h);(b.length!=0||h.i.length!=0)&&(T(h.ka,b),T(h.ka,h.i),h.h.i.length=0,C(h.i),h.i.length=0),h.l.ra()}}function Gu(h,b,E){var k=E instanceof Rt?On(E):new Rt(E);if(k.g!="")b&&(k.g=b+"."+k.g),Ba(k,k.s);else{var K=f.location;k=K.protocol,b=b?b+"."+K.hostname:K.hostname,K=+K.port;var te=new Rt(null);k&&Ji(te,k),b&&(te.g=b),K&&Ba(te,K),E&&(te.l=E),k=te}return E=h.D,b=h.ya,E&&b&&rt(k,E,b),rt(k,"VER",h.la),or(h,k),k}function $u(h,b,E){if(b&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Ca&&!h.pa?new nt(new Ha({eb:E})):new nt(h.pa),b.Ha(h.J),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yu(){}n=Yu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ro(){}ro.prototype.g=function(h,b){return new bn(h,b)};function bn(h,b){Et.call(this),this.g=new no(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.va&&(h?h["X-WebChannel-Client-Profile"]=b.va:h={"X-WebChannel-Client-Profile":b.va}),this.g.S=h,(h=b&&b.Sb)&&!q(h)&&(this.g.m=h),this.v=b&&b.supportsCrossDomainXhr||!1,this.u=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!q(b)&&(this.g.D=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new Ps(this)}N(bn,Et),bn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},bn.prototype.close=function(){Pl(this.g)},bn.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.u&&(E={},E.__data__=hs(h),h=E);b.i.push(new Ou(b.Ya++,h)),b.G==3&&ao(b)},bn.prototype.N=function(){this.g.l=null,delete this.j,Pl(this.g),delete this.g,bn.aa.N.call(this)};function Qu(h){na.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const E in b){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}N(Qu,na);function Ku(){Tl.call(this),this.status=1}N(Ku,Tl);function Ps(h){this.g=h}N(Ps,Yu),Ps.prototype.ua=function(){st(this.g,"a")},Ps.prototype.ta=function(h){st(this.g,new Qu(h))},Ps.prototype.sa=function(h){st(this.g,new Ku)},Ps.prototype.ra=function(){st(this.g,"b")},ro.prototype.createWebChannel=ro.prototype.g,bn.prototype.send=bn.prototype.o,bn.prototype.open=bn.prototype.m,bn.prototype.close=bn.prototype.close,HT=function(){return new ro},BT=function(){return Va()},zT=ws,lg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qa.NO_ERROR=0,qa.TIMEOUT=8,qa.HTTP_ERROR=6,ch=qa,sa.COMPLETE="complete",qT=sa,El.EventType=ta,ta.OPEN="a",ta.CLOSE="b",ta.ERROR="c",ta.MESSAGE="d",Et.prototype.listen=Et.prototype.K,Ic=El,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,FT=nt}).apply(typeof Wd<"u"?Wd:typeof self<"u"?self:typeof window<"u"?window:{});const s_="@firebase/firestore",a_="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ul="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr=new lu("@firebase/firestore");function Vo(){return Dr.logLevel}function ve(n,...e){if(Dr.logLevel<=$e.DEBUG){const t=e.map(Yg);Dr.debug(`Firestore (${ul}): ${n}`,...t)}}function Ma(n,...e){if(Dr.logLevel<=$e.ERROR){const t=e.map(Yg);Dr.error(`Firestore (${ul}): ${n}`,...t)}}function Zo(n,...e){if(Dr.logLevel<=$e.WARN){const t=e.map(Yg);Dr.warn(`Firestore (${ul}): ${n}`,...t)}}function Yg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ee(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,GT(n,i,t)}function GT(n,e,t){let i=`FIRESTORE (${ul}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ma(i),new Error(i)}function Ze(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||GT(e,o,i)}function De(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ge extends us{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class M1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(fn.UNAUTHENTICATED))}shutdown(){}}class O1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class k1{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0,42304);let i=this.i;const o=p=>this.i!==i?(i=this.i,t(p)):Promise.resolve();let c=new Qs;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Qs,e.enqueueRetryable(()=>o(this.currentUser))};const d=()=>{const p=c;e.enqueueRetryable(async()=>{await p.promise,await o(this.currentUser)})},f=p=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit(p=>f(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Qs)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ze(typeof i.accessToken=="string",31837,{l:i}),new $T(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new fn(e)}}class P1{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class L1{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new P1(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(fn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class i_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class V1{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,In(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ze(this.o===void 0,3512);const i=c=>{c.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,ve("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>i(c))};const o=c=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>o(c)),setTimeout(()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new i_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new i_(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U1(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YT(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=U1(40);for(let c=0;c<o.length;++c)i.length<20&&o[c]<t&&(i+=e.charAt(o[c]%62))}return i}}function qe(n,e){return n<e?-1:n>e?1:0}function cg(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=n.codePointAt(t),o=e.codePointAt(t);if(i!==o){if(i<128&&o<128)return qe(i,o);{const c=YT(),d=F1(c.encode(r_(n,t)),c.encode(r_(e,t)));return d!==0?d:qe(i,o)}}t+=i>65535?2:1}return qe(n.length,e.length)}function r_(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function F1(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return qe(n[t],e[t]);return qe(n.length,e.length)}function Jo(n,e,t){return n.length===e.length&&n.every((i,o)=>t(i,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_=-62135596800,l_=1e6;class qt{static now(){return qt.fromMillis(Date.now())}static fromDate(e){return qt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*l_);return new qt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ge(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ge(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<o_)throw new ge(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ge(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/l_}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-o_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{static fromTimestamp(e){return new we(e)}static min(){return new we(new qt(0,0))}static max(){return new we(new qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_="__name__";class Hs{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ee(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ee(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Hs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Hs?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const c=Hs.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return qe(e.length,t.length)}static compareSegments(e,t){const i=Hs.isNumericId(e),o=Hs.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?Hs.extractNumericId(e).compare(Hs.extractNumericId(t)):cg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ni.fromString(e.substring(4,e.length-2))}}class ht extends Hs{construct(e,t,i){return new ht(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ge(ie.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(o=>o.length>0))}return new ht(t)}static emptyPath(){return new ht([])}}const q1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class an extends Hs{construct(e,t,i){return new an(e,t,i)}static isValidIdentifier(e){return q1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),an.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===c_}static keyField(){return new an([c_])}static fromServerFormat(e){const t=[];let i="",o=0;const c=()=>{if(i.length===0)throw new ge(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;o<e.length;){const f=e[o];if(f==="\\"){if(o+1===e.length)throw new ge(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new ge(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=p,o+=2}else f==="`"?(d=!d,o++):f!=="."||d?(i+=f,o++):(c(),o++)}if(c(),d)throw new ge(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new an(t)}static emptyPath(){return new an([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.path=e}static fromPath(e){return new Ne(ht.fromString(e))}static fromName(e){return new Ne(ht.fromString(e).popFirst(5))}static empty(){return new Ne(ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ht.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ne(new ht(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=-1;function z1(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=we.fromTimestamp(i===1e9?new qt(t+1,0):new qt(t,i));return new ji(o,Ne.empty(),e)}function B1(n){return new ji(n.readTime,n.key,Kc)}class ji{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ji(we.min(),Ne.empty(),Kc)}static max(){return new ji(we.max(),Ne.empty(),Kc)}}function H1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ne.comparator(n.documentKey,e.documentKey),t!==0?t:qe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dl(n){if(n.code!==ie.FAILED_PRECONDITION||n.message!==G1)throw n;ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ee(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe((i,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(i,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(i,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.reject(t)}static resolve(e){return new oe((t,i)=>{t(e)})}static reject(e){return new oe((t,i)=>{i(e)})}static waitFor(e){return new oe((t,i)=>{let o=0,c=0,d=!1;e.forEach(f=>{++o,f.next(()=>{++c,d&&c===o&&t()},p=>i(p))}),d=!0,c===o&&t()})}static or(e){let t=oe.resolve(!1);for(const i of e)t=t.next(o=>o?oe.resolve(o):i());return t}static forEach(e,t){const i=[];return e.forEach((o,c)=>{i.push(t.call(this,o,c))}),this.waitFor(i)}static mapArray(e,t){return new oe((i,o)=>{const c=e.length,d=new Array(c);let f=0;for(let p=0;p<c;p++){const g=p;t(e[g]).next(y=>{d[g]=y,++f,f===c&&i(d)},y=>o(y))}})}static doWhile(e,t){return new oe((i,o)=>{const c=()=>{e()===!0?t().next(()=>{c()},o):i()};c()})}}function Y1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function hl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>t.writeSequenceNumber(i))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Xh.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg=-1;function mu(n){return n==null}function jh(n){return n===0&&1/n==-1/0}function Q1(n){return typeof n=="number"&&Number.isInteger(n)&&!jh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT="";function K1(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=u_(e)),e=X1(n.get(t),e);return u_(e)}function X1(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case KT:t+="";break;default:t+=c}}return t}function u_(n){return n+KT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d_(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Vi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function XT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,t){this.comparator=e,this.root=t||sn.EMPTY}insert(e,t){return new _t(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,sn.BLACK,null,null))}remove(e){return new _t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zd(this.root,e,this.comparator,!0)}}class Zd{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?i(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sn{constructor(e,t,i,o,c){this.key=e,this.value=t,this.color=i??sn.RED,this.left=o??sn.EMPTY,this.right=c??sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,c){return new sn(e??this.key,t??this.value,i??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const c=i(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,i),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return sn.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ee(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ee(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ee(27949);return e+(this.isRed()?0:1)}}sn.EMPTY=null,sn.RED=!0,sn.BLACK=!1;sn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ee(57766)}get value(){throw Ee(16141)}get color(){throw Ee(16727)}get left(){throw Ee(29726)}get right(){throw Ee(36894)}copy(e,t,i,o,c){return this}insert(e,t,i){return new sn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.comparator=e,this.data=new _t(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new h_(this.data.getIterator())}getIteratorFrom(e){return new h_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof zt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new zt(this.comparator);return t.data=e,t}}class h_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.fields=e,e.sort(an.comparator)}static empty(){return new zn([])}unionWith(e){let t=new zt(an.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new zn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jo(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new WT("Invalid base64 string: "+c):c}}(e);return new ln(t)}static fromUint8Array(e){const t=function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c}(e);return new ln(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ln.EMPTY_BYTE_STRING=new ln("");const W1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ai(n){if(Ze(!!n,39018),typeof n=="string"){let e=0;const t=W1.exec(n);if(Ze(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:St(n.seconds),nanos:St(n.nanos)}}function St(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wi(n){return typeof n=="string"?ln.fromBase64String(n):ln.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT="server_timestamp",JT="__type__",e0="__previous_value__",t0="__local_write_time__";function Kg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[JT])===null||t===void 0?void 0:t.stringValue)===ZT}function Wh(n){const e=n.mapValue.fields[e0];return Kg(e)?Wh(e):e}function Xc(n){const e=Ai(n.mapValue.fields[t0].timestampValue);return new qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(e,t,i,o,c,d,f,p,g,y){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=g,this.isUsingEmulator=y}}const Ah="(default)";class Wc{constructor(e,t){this.projectId=e,this.database=t||Ah}static empty(){return new Wc("","")}get isDefaultDatabase(){return this.database===Ah}isEqual(e){return e instanceof Wc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0="__type__",J1="__max__",Jd={mapValue:{}},s0="__vector__",wh="value";function Ci(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Kg(n)?4:tD(n)?9007199254740991:eD(n)?10:11:Ee(28295,{value:n})}function Xs(n,e){if(n===e)return!0;const t=Ci(n);if(t!==Ci(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Xc(n).isEqual(Xc(e));case 3:return function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=Ai(o.timestampValue),f=Ai(c.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,c){return wi(o.bytesValue).isEqual(wi(c.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,c){return St(o.geoPointValue.latitude)===St(c.geoPointValue.latitude)&&St(o.geoPointValue.longitude)===St(c.geoPointValue.longitude)}(n,e);case 2:return function(o,c){if("integerValue"in o&&"integerValue"in c)return St(o.integerValue)===St(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=St(o.doubleValue),f=St(c.doubleValue);return d===f?jh(d)===jh(f):isNaN(d)&&isNaN(f)}return!1}(n,e);case 9:return Jo(n.arrayValue.values||[],e.arrayValue.values||[],Xs);case 10:case 11:return function(o,c){const d=o.mapValue.fields||{},f=c.mapValue.fields||{};if(d_(d)!==d_(f))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(f[p]===void 0||!Xs(d[p],f[p])))return!1;return!0}(n,e);default:return Ee(52216,{left:n})}}function Zc(n,e){return(n.values||[]).find(t=>Xs(t,e))!==void 0}function el(n,e){if(n===e)return 0;const t=Ci(n),i=Ci(e);if(t!==i)return qe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return qe(n.booleanValue,e.booleanValue);case 2:return function(c,d){const f=St(c.integerValue||c.doubleValue),p=St(d.integerValue||d.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1}(n,e);case 3:return f_(n.timestampValue,e.timestampValue);case 4:return f_(Xc(n),Xc(e));case 5:return cg(n.stringValue,e.stringValue);case 6:return function(c,d){const f=wi(c),p=wi(d);return f.compareTo(p)}(n.bytesValue,e.bytesValue);case 7:return function(c,d){const f=c.split("/"),p=d.split("/");for(let g=0;g<f.length&&g<p.length;g++){const y=qe(f[g],p[g]);if(y!==0)return y}return qe(f.length,p.length)}(n.referenceValue,e.referenceValue);case 8:return function(c,d){const f=qe(St(c.latitude),St(d.latitude));return f!==0?f:qe(St(c.longitude),St(d.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return m_(n.arrayValue,e.arrayValue);case 10:return function(c,d){var f,p,g,y;const x=c.fields||{},_=d.fields||{},A=(f=x[wh])===null||f===void 0?void 0:f.arrayValue,N=(p=_[wh])===null||p===void 0?void 0:p.arrayValue,C=qe(((g=A?.values)===null||g===void 0?void 0:g.length)||0,((y=N?.values)===null||y===void 0?void 0:y.length)||0);return C!==0?C:m_(A,N)}(n.mapValue,e.mapValue);case 11:return function(c,d){if(c===Jd.mapValue&&d===Jd.mapValue)return 0;if(c===Jd.mapValue)return 1;if(d===Jd.mapValue)return-1;const f=c.fields||{},p=Object.keys(f),g=d.fields||{},y=Object.keys(g);p.sort(),y.sort();for(let x=0;x<p.length&&x<y.length;++x){const _=cg(p[x],y[x]);if(_!==0)return _;const A=el(f[p[x]],g[y[x]]);if(A!==0)return A}return qe(p.length,y.length)}(n.mapValue,e.mapValue);default:throw Ee(23264,{Pe:t})}}function f_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return qe(n,e);const t=Ai(n),i=Ai(e),o=qe(t.seconds,i.seconds);return o!==0?o:qe(t.nanos,i.nanos)}function m_(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const c=el(t[o],i[o]);if(c)return c}return qe(t.length,i.length)}function tl(n){return ug(n)}function ug(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=Ai(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return wi(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ne.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",o=!0;for(const c of t.values||[])o?o=!1:i+=",",i+=ug(c);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of i)c?c=!1:o+=",",o+=`${d}:${ug(t.fields[d])}`;return o+"}"}(n.mapValue):Ee(61005,{value:n})}function uh(n){switch(Ci(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Wh(n);return e?16+uh(e):16;case 5:return 2*n.stringValue.length;case 6:return wi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((o,c)=>o+uh(c),0)}(n.arrayValue);case 10:case 11:return function(i){let o=0;return Vi(i.fields,(c,d)=>{o+=c.length+uh(d)}),o}(n.mapValue);default:throw Ee(13486,{value:n})}}function p_(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function dg(n){return!!n&&"integerValue"in n}function Xg(n){return!!n&&"arrayValue"in n}function g_(n){return!!n&&"nullValue"in n}function v_(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function dh(n){return!!n&&"mapValue"in n}function eD(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[n0])===null||t===void 0?void 0:t.stringValue)===s0}function Pc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Vi(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Pc(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Pc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function tD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===J1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.value=e}static empty(){return new En({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!dh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pc(t)}setAll(e){let t=an.emptyPath(),i={},o=[];e.forEach((d,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,i,o),i={},o=[],t=f.popLast()}d?i[f.lastSegment()]=Pc(d):o.push(f.lastSegment())});const c=this.getFieldsMap(t);this.applyChanges(c,i,o)}delete(e){const t=this.field(e.popLast());dh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];dh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Vi(t,(o,c)=>e[o]=c);for(const o of i)delete e[o]}clone(){return new En(Pc(this.value))}}function a0(n){const e=[];return Vi(n.fields,(t,i)=>{const o=new an([t]);if(dh(i)){const c=a0(i.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)}),new zn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,t,i,o,c,d,f){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=c,this.data=d,this.documentState=f}static newInvalidDocument(e){return new Wt(e,0,we.min(),we.min(),we.min(),En.empty(),0)}static newFoundDocument(e,t,i,o){return new Wt(e,1,t,we.min(),i,o,0)}static newNoDocument(e,t){return new Wt(e,2,t,we.min(),we.min(),En.empty(),0)}static newUnknownDocument(e,t){return new Wt(e,3,t,we.min(),we.min(),En.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(we.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=En.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=En.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,t){this.position=e,this.inclusive=t}}function y_(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?i=Ne.comparator(Ne.fromName(d.referenceValue),t.key):i=el(d,t.data.field(c.field)),c.dir==="desc"&&(i*=-1),i!==0)break}return i}function b_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Xs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,t="asc"){this.field=e,this.dir=t}}function nD(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{}class kt extends i0{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new aD(e,t,i):t==="array-contains"?new oD(e,i):t==="in"?new lD(e,i):t==="not-in"?new cD(e,i):t==="array-contains-any"?new uD(e,i):new kt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new iD(e,i):new rD(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(el(t,this.value)):t!==null&&Ci(this.value)===Ci(t)&&this.matchesComparison(el(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ee(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ts extends i0{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Ts(e,t)}matches(e){return r0(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function r0(n){return n.op==="and"}function o0(n){return sD(n)&&r0(n)}function sD(n){for(const e of n.filters)if(e instanceof Ts)return!1;return!0}function hg(n){if(n instanceof kt)return n.field.canonicalString()+n.op.toString()+tl(n.value);if(o0(n))return n.filters.map(e=>hg(e)).join(",");{const e=n.filters.map(t=>hg(t)).join(",");return`${n.op}(${e})`}}function l0(n,e){return n instanceof kt?function(i,o){return o instanceof kt&&i.op===o.op&&i.field.isEqual(o.field)&&Xs(i.value,o.value)}(n,e):n instanceof Ts?function(i,o){return o instanceof Ts&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce((c,d,f)=>c&&l0(d,o.filters[f]),!0):!1}(n,e):void Ee(19439)}function c0(n){return n instanceof kt?function(t){return`${t.field.canonicalString()} ${t.op} ${tl(t.value)}`}(n):n instanceof Ts?function(t){return t.op.toString()+" {"+t.getFilters().map(c0).join(" ,")+"}"}(n):"Filter"}class aD extends kt{constructor(e,t,i){super(e,t,i),this.key=Ne.fromName(i.referenceValue)}matches(e){const t=Ne.comparator(e.key,this.key);return this.matchesComparison(t)}}class iD extends kt{constructor(e,t){super(e,"in",t),this.keys=u0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class rD extends kt{constructor(e,t){super(e,"not-in",t),this.keys=u0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function u0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>Ne.fromName(i.referenceValue))}class oD extends kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Xg(t)&&Zc(t.arrayValue,this.value)}}class lD extends kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Zc(this.value.arrayValue,t)}}class cD extends kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Zc(this.value.arrayValue,t)}}class uD extends kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Xg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Zc(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(e,t=null,i=[],o=[],c=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=c,this.startAt=d,this.endAt=f,this.Ie=null}}function x_(n,e=null,t=[],i=[],o=null,c=null,d=null){return new dD(n,e,t,i,o,c,d)}function Wg(n){const e=De(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>hg(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(c){return c.field.canonicalString()+c.dir}(i)).join(","),mu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>tl(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>tl(i)).join(",")),e.Ie=t}return e.Ie}function Zg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!nD(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!l0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!b_(n.startAt,e.startAt)&&b_(n.endAt,e.endAt)}function fg(n){return Ne.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,t=null,i=[],o=[],c=null,d="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=c,this.limitType=d,this.startAt=f,this.endAt=p,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function hD(n,e,t,i,o,c,d,f){return new fl(n,e,t,i,o,c,d,f)}function Zh(n){return new fl(n)}function N_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function d0(n){return n.collectionGroup!==null}function Lc(n){const e=De(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ee.push(c),t.add(c.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new zt(an.comparator);return d.filters.forEach(p=>{p.getFlattenedFilters().forEach(g=>{g.isInequality()&&(f=f.add(g.field))})}),f})(e).forEach(c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ee.push(new Jc(c,i))}),t.has(an.keyField().canonicalString())||e.Ee.push(new Jc(an.keyField(),i))}return e.Ee}function Ks(n){const e=De(n);return e.de||(e.de=fD(e,Lc(n))),e.de}function fD(n,e){if(n.limitType==="F")return x_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const c=o.dir==="desc"?"asc":"desc";return new Jc(o.field,c)});const t=n.endAt?new Ch(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ch(n.startAt.position,n.startAt.inclusive):null;return x_(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function mg(n,e){const t=n.filters.concat([e]);return new fl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Sh(n,e,t){return new fl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Jh(n,e){return Zg(Ks(n),Ks(e))&&n.limitType===e.limitType}function h0(n){return`${Wg(Ks(n))}|lt:${n.limitType}`}function Uo(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(o=>c0(o)).join(", ")}]`),mu(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(o=>function(d){return`${d.field.canonicalString()} (${d.dir})`}(o)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(o=>tl(o)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(o=>tl(o)).join(",")),`Target(${i})`}(Ks(n))}; limitType=${n.limitType})`}function ef(n,e){return e.isFoundDocument()&&function(i,o){const c=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(c):Ne.isDocumentKey(i.path)?i.path.isEqual(c):i.path.isImmediateParentOf(c)}(n,e)&&function(i,o){for(const c of Lc(i))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0}(n,e)&&function(i,o){for(const c of i.filters)if(!c.matches(o))return!1;return!0}(n,e)&&function(i,o){return!(i.startAt&&!function(d,f,p){const g=y_(d,f,p);return d.inclusive?g<=0:g<0}(i.startAt,Lc(i),o)||i.endAt&&!function(d,f,p){const g=y_(d,f,p);return d.inclusive?g>=0:g>0}(i.endAt,Lc(i),o))}(n,e)}function mD(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function f0(n){return(e,t)=>{let i=!1;for(const o of Lc(n)){const c=pD(o,e,t);if(c!==0)return c;i=i||o.field.isKeyField()}return 0}}function pD(n,e,t){const i=n.field.isKeyField()?Ne.comparator(e.key,t.key):function(c,d,f){const p=d.data.field(c),g=f.data.field(c);return p!==null&&g!==null?el(p,g):Ee(42886)}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ee(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,c]of i)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Vi(this.inner,(t,i)=>{for(const[o,c]of i)e(o,c)})}isEmpty(){return XT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD=new _t(Ne.comparator);function Oa(){return gD}const m0=new _t(Ne.comparator);function Rc(...n){let e=m0;for(const t of n)e=e.insert(t.key,t);return e}function p0(n){let e=m0;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function wr(){return Vc()}function g0(){return Vc()}function Vc(){return new Ur(n=>n.toString(),(n,e)=>n.isEqual(e))}const vD=new _t(Ne.comparator),yD=new zt(Ne.comparator);function Ye(...n){let e=yD;for(const t of n)e=e.add(t);return e}const bD=new zt(qe);function xD(){return bD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jh(e)?"-0":e}}function v0(n){return{integerValue:""+n}}function ND(n,e){return Q1(e)?v0(e):Jg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(){this._=void 0}}function _D(n,e,t){return n instanceof eu?function(o,c){const d={fields:{[JT]:{stringValue:ZT},[t0]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Kg(c)&&(c=Wh(c)),c&&(d.fields[e0]=c),{mapValue:d}}(t,e):n instanceof tu?b0(n,e):n instanceof nu?x0(n,e):function(o,c){const d=y0(o,c),f=__(d)+__(o.Re);return dg(d)&&dg(o.Re)?v0(f):Jg(o.serializer,f)}(n,e)}function ED(n,e,t){return n instanceof tu?b0(n,e):n instanceof nu?x0(n,e):t}function y0(n,e){return n instanceof Ih?function(i){return dg(i)||function(c){return!!c&&"doubleValue"in c}(i)}(e)?e:{integerValue:0}:null}class eu extends tf{}class tu extends tf{constructor(e){super(),this.elements=e}}function b0(n,e){const t=N0(e);for(const i of n.elements)t.some(o=>Xs(o,i))||t.push(i);return{arrayValue:{values:t}}}class nu extends tf{constructor(e){super(),this.elements=e}}function x0(n,e){let t=N0(e);for(const i of n.elements)t=t.filter(o=>!Xs(o,i));return{arrayValue:{values:t}}}class Ih extends tf{constructor(e,t){super(),this.serializer=e,this.Re=t}}function __(n){return St(n.integerValue||n.doubleValue)}function N0(n){return Xg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e,t){this.field=e,this.transform=t}}function jD(n,e){return n.field.isEqual(e.field)&&function(i,o){return i instanceof tu&&o instanceof tu||i instanceof nu&&o instanceof nu?Jo(i.elements,o.elements,Xs):i instanceof Ih&&o instanceof Ih?Xs(i.Re,o.Re):i instanceof eu&&o instanceof eu}(n.transform,e.transform)}class AD{constructor(e,t){this.version=e,this.transformResults=t}}class rn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class nf{}function _0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new sf(n.key,rn.none()):new pu(n.key,n.data,rn.none());{const t=n.data,i=En.empty();let o=new zt(an.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?i.delete(c):i.set(c,d),o=o.add(c)}return new Ui(n.key,i,new zn(o.toArray()),rn.none())}}function wD(n,e,t){n instanceof pu?function(o,c,d){const f=o.value.clone(),p=T_(o.fieldTransforms,c,d.transformResults);f.setAll(p),c.convertToFoundDocument(d.version,f).setHasCommittedMutations()}(n,e,t):n instanceof Ui?function(o,c,d){if(!hh(o.precondition,c))return void c.convertToUnknownDocument(d.version);const f=T_(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(E0(o)),p.setAll(f),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()}(n,e,t):function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()}(0,e,t)}function Uc(n,e,t,i){return n instanceof pu?function(c,d,f,p){if(!hh(c.precondition,d))return f;const g=c.value.clone(),y=j_(c.fieldTransforms,p,d);return g.setAll(y),d.convertToFoundDocument(d.version,g).setHasLocalMutations(),null}(n,e,t,i):n instanceof Ui?function(c,d,f,p){if(!hh(c.precondition,d))return f;const g=j_(c.fieldTransforms,p,d),y=d.data;return y.setAll(E0(c)),y.setAll(g),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),f===null?null:f.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(x=>x.field))}(n,e,t,i):function(c,d,f){return hh(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f}(n,e,t)}function CD(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),c=y0(i.transform,o||null);c!=null&&(t===null&&(t=En.empty()),t.set(i.field,c))}return t||null}function E_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Jo(i,o,(c,d)=>jD(c,d))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class pu extends nf{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Ui extends nf{constructor(e,t,i,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function E0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function T_(n,e,t){const i=new Map;Ze(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,f=e.data.field(c.field);i.set(c.field,ED(d,f,t[o]))}return i}function j_(n,e,t){const i=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);i.set(o.field,_D(c,d,e))}return i}class sf extends nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class T0 extends nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&wD(c,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Uc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Uc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=g0();return this.mutations.forEach(o=>{const c=e.get(o.key),d=c.overlayedDocument;let f=this.applyToLocalView(d,c.mutatedFields);f=t.has(o.key)?null:f;const p=_0(d,f);p!==null&&i.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(we.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ye())}isEqual(e){return this.batchId===e.batchId&&Jo(this.mutations,e.mutations,(t,i)=>E_(t,i))&&Jo(this.baseMutations,e.baseMutations,(t,i)=>E_(t,i))}}class ev{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){Ze(e.mutations.length===i.length,58842,{fe:e.mutations.length,ge:i.length});let o=function(){return vD}();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,i[d].version);return new ev(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot,We;function j0(n){switch(n){case ie.OK:return Ee(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return Ee(15467,{code:n})}}function A0(n){if(n===void 0)return Ma("GRPC error has no .code"),ie.UNKNOWN;switch(n){case Ot.OK:return ie.OK;case Ot.CANCELLED:return ie.CANCELLED;case Ot.UNKNOWN:return ie.UNKNOWN;case Ot.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case Ot.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case Ot.INTERNAL:return ie.INTERNAL;case Ot.UNAVAILABLE:return ie.UNAVAILABLE;case Ot.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case Ot.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case Ot.NOT_FOUND:return ie.NOT_FOUND;case Ot.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case Ot.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case Ot.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case Ot.ABORTED:return ie.ABORTED;case Ot.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case Ot.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case Ot.DATA_LOSS:return ie.DATA_LOSS;default:return Ee(39323,{code:n})}}(We=Ot||(Ot={}))[We.OK=0]="OK",We[We.CANCELLED=1]="CANCELLED",We[We.UNKNOWN=2]="UNKNOWN",We[We.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",We[We.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",We[We.NOT_FOUND=5]="NOT_FOUND",We[We.ALREADY_EXISTS=6]="ALREADY_EXISTS",We[We.PERMISSION_DENIED=7]="PERMISSION_DENIED",We[We.UNAUTHENTICATED=16]="UNAUTHENTICATED",We[We.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",We[We.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",We[We.ABORTED=10]="ABORTED",We[We.OUT_OF_RANGE=11]="OUT_OF_RANGE",We[We.UNIMPLEMENTED=12]="UNIMPLEMENTED",We[We.INTERNAL=13]="INTERNAL",We[We.UNAVAILABLE=14]="UNAVAILABLE",We[We.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD=new Ni([4294967295,4294967295],0);function A_(n){const e=YT().encode(n),t=new UT;return t.update(e),new Uint8Array(t.digest())}function w_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new Ni([t,i],0),new Ni([o,c],0)]}class tv{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Dc(`Invalid padding: ${t}`);if(i<0)throw new Dc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Dc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Dc(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Ni.fromNumber(this.pe)}we(e,t,i){let o=e.add(t.multiply(Ni.fromNumber(i)));return o.compare(DD)===1&&(o=new Ni([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=A_(e),[i,o]=w_(t);for(let c=0;c<this.hashCount;c++){const d=this.we(i,o,c);if(!this.be(d))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new tv(c,o,t);return i.forEach(f=>d.insert(f)),d}insert(e){if(this.pe===0)return;const t=A_(e),[i,o]=w_(t);for(let c=0;c<this.hashCount;c++){const d=this.we(i,o,c);this.Se(d)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Dc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,t,i,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,gu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new af(we.min(),o,new _t(qe),Oa(),Ye())}}class gu{constructor(e,t,i,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new gu(i,t,Ye(),Ye(),Ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,t,i,o){this.De=e,this.removedTargetIds=t,this.key=i,this.ve=o}}class w0{constructor(e,t){this.targetId=e,this.Ce=t}}class C0{constructor(e,t,i=ln.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class C_{constructor(){this.Fe=0,this.Me=S_(),this.xe=ln.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Ye(),t=Ye(),i=Ye();return this.Me.forEach((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:Ee(38017,{changeType:c})}}),new gu(this.xe,this.Oe,e,t,i)}Qe(){this.Ne=!1,this.Me=S_()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Ze(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class MD{constructor(e){this.ze=e,this.je=new Map,this.He=Oa(),this.Je=eh(),this.Ye=eh(),this.Ze=new _t(qe)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const i=this.rt(t);switch(e.state){case 0:this.it(t)&&i.ke(e.resumeToken);break;case 1:i.We(),i.Be||i.Qe(),i.ke(e.resumeToken);break;case 2:i.We(),i.Be||this.removeTarget(t);break;case 3:this.it(t)&&(i.Ge(),i.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),i.ke(e.resumeToken));break;default:Ee(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((i,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,i=e.Ce.count,o=this._t(t);if(o){const c=o.target;if(fg(c))if(i===0){const d=new Ne(c.path);this.tt(t,d,Wt.newNoDocument(d,we.min()))}else Ze(i===1,20013,{expectedCount:i});else{const d=this.ut(t);if(d!==i){const f=this.ct(e),p=f?this.lt(f,e,d):1;if(p!==0){this.st(t);const g=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:c=0}=t;let d,f;try{d=wi(i).toUint8Array()}catch(p){if(p instanceof WT)return Zo("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new tv(d,o,c)}catch(p){return Zo(p instanceof Dc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.pe===0?null:f}lt(e,t,i){return t.Ce.count===i-this.Tt(e,t.targetId)?0:2}Tt(e,t){const i=this.ze.getRemoteKeysForTarget(t);let o=0;return i.forEach(c=>{const d=this.ze.Pt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(f)||(this.tt(t,c,null),o++)}),o}It(e){const t=new Map;this.je.forEach((c,d)=>{const f=this._t(d);if(f){if(c.current&&fg(f.target)){const p=new Ne(f.target.path);this.Et(p).has(d)||this.dt(d,p)||this.tt(d,p,Wt.newNoDocument(p,e))}c.Le&&(t.set(d,c.qe()),c.Qe())}});let i=Ye();this.Ye.forEach((c,d)=>{let f=!0;d.forEachWhile(p=>{const g=this._t(p);return!g||g.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)}),f&&(i=i.add(c))}),this.He.forEach((c,d)=>d.setReadTime(e));const o=new af(e,t,this.Ze,this.He,i);return this.He=Oa(),this.Je=eh(),this.Ye=eh(),this.Ze=new _t(qe),o}et(e,t){if(!this.it(e))return;const i=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,i),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,i){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),i&&(this.He=this.He.insert(t,i))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new C_,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new zt(qe),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new zt(qe),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||ve("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new C_),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function eh(){return new _t(Ne.comparator)}function S_(){return new _t(Ne.comparator)}const OD={asc:"ASCENDING",desc:"DESCENDING"},kD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},PD={and:"AND",or:"OR"};class LD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function pg(n,e){return n.useProto3Json||mu(e)?e:{value:e}}function Rh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function S0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function VD(n,e){return Rh(n,e.toTimestamp())}function Hn(n){return Ze(!!n,49232),we.fromTimestamp(function(t){const i=Ai(t);return new qt(i.seconds,i.nanos)}(n))}function nv(n,e){return gg(n,e).canonicalString()}function gg(n,e){const t=function(o){return new ht(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function I0(n){const e=ht.fromString(n);return Ze(P0(e),10190,{key:e.toString()}),e}function Dh(n,e){return nv(n.databaseId,e.path)}function Fc(n,e){const t=I0(e);if(t.get(1)!==n.databaseId.projectId)throw new ge(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ge(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ne(D0(t))}function R0(n,e){return nv(n.databaseId,e)}function UD(n){const e=I0(n);return e.length===4?ht.emptyPath():D0(e)}function vg(n){return new ht(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function D0(n){return Ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function I_(n,e,t){return{name:Dh(n,e),fields:t.value.mapValue.fields}}function FD(n,e){return"found"in e?function(i,o){Ze(!!o.found,43571),o.found.name,o.found.updateTime;const c=Fc(i,o.found.name),d=Hn(o.found.updateTime),f=o.found.createTime?Hn(o.found.createTime):we.min(),p=new En({mapValue:{fields:o.found.fields}});return Wt.newFoundDocument(c,d,f,p)}(n,e):"missing"in e?function(i,o){Ze(!!o.missing,3894),Ze(!!o.readTime,22933);const c=Fc(i,o.missing),d=Hn(o.readTime);return Wt.newNoDocument(c,d)}(n,e):Ee(7234,{result:e})}function qD(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:Ee(39313,{state:g})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=function(g,y){return g.useProto3Json?(Ze(y===void 0||typeof y=="string",58123),ln.fromBase64String(y||"")):(Ze(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),ln.fromUint8Array(y||new Uint8Array))}(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&function(g){const y=g.code===void 0?ie.UNKNOWN:A0(g.code);return new ge(y,g.message||"")}(d);t=new C0(i,o,c,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=Fc(n,i.document.name),c=Hn(i.document.updateTime),d=i.document.createTime?Hn(i.document.createTime):we.min(),f=new En({mapValue:{fields:i.document.fields}}),p=Wt.newFoundDocument(o,c,d,f),g=i.targetIds||[],y=i.removedTargetIds||[];t=new fh(g,y,p.key,p)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=Fc(n,i.document),c=i.readTime?Hn(i.readTime):we.min(),d=Wt.newNoDocument(o,c),f=i.removedTargetIds||[];t=new fh([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=Fc(n,i.document),c=i.removedTargetIds||[];t=new fh([],c,o,null)}else{if(!("filter"in e))return Ee(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:c}=i,d=new RD(o,c),f=i.targetId;t=new w0(f,d)}}return t}function M0(n,e){let t;if(e instanceof pu)t={update:I_(n,e.key,e.value)};else if(e instanceof sf)t={delete:Dh(n,e.key)};else if(e instanceof Ui)t={update:I_(n,e.key,e.data),updateMask:XD(e.fieldMask)};else{if(!(e instanceof T0))return Ee(16599,{ft:e.type});t={verify:Dh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(c,d){const f=d.transform;if(f instanceof eu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof tu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof nu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Ih)return{fieldPath:d.field.canonicalString(),increment:f.Re};throw Ee(20930,{transform:d.transform})}(0,i))),e.precondition.isNone||(t.currentDocument=function(o,c){return c.updateTime!==void 0?{updateTime:VD(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:Ee(27497)}(n,e.precondition)),t}function zD(n,e){return n&&n.length>0?(Ze(e!==void 0,14353),n.map(t=>function(o,c){let d=o.updateTime?Hn(o.updateTime):Hn(c);return d.isEqual(we.min())&&(d=Hn(c)),new AD(d,o.transformResults||[])}(t,e))):[]}function BD(n,e){return{documents:[R0(n,e.path)]}}function HD(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=R0(n,o);const c=function(g){if(g.length!==0)return k0(Ts.create(g,"and"))}(e.filters);c&&(t.structuredQuery.where=c);const d=function(g){if(g.length!==0)return g.map(y=>function(_){return{field:Fo(_.field),direction:YD(_.dir)}}(y))}(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=pg(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=function(g){return{before:g.inclusive,values:g.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(g){return{before:!g.inclusive,values:g.position}}(e.endAt)),{gt:t,parent:o}}function GD(n){let e=UD(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){Ze(i===1,65062);const y=t.from[0];y.allDescendants?o=y.collectionId:e=e.child(y.collectionId)}let c=[];t.where&&(c=function(x){const _=O0(x);return _ instanceof Ts&&o0(_)?_.getFilters():[_]}(t.where));let d=[];t.orderBy&&(d=function(x){return x.map(_=>function(N){return new Jc(qo(N.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(_))}(t.orderBy));let f=null;t.limit&&(f=function(x){let _;return _=typeof x=="object"?x.value:x,mu(_)?null:_}(t.limit));let p=null;t.startAt&&(p=function(x){const _=!!x.before,A=x.values||[];return new Ch(A,_)}(t.startAt));let g=null;return t.endAt&&(g=function(x){const _=!x.before,A=x.values||[];return new Ch(A,_)}(t.endAt)),hD(e,o,d,c,f,"F",p,g)}function $D(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ee(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function O0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=qo(t.unaryFilter.field);return kt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=qo(t.unaryFilter.field);return kt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=qo(t.unaryFilter.field);return kt.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=qo(t.unaryFilter.field);return kt.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ee(61313);default:return Ee(60726)}}(n):n.fieldFilter!==void 0?function(t){return kt.create(qo(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ee(58110);default:return Ee(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ts.create(t.compositeFilter.filters.map(i=>O0(i)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ee(1026)}}(t.compositeFilter.op))}(n):Ee(30097,{filter:n})}function YD(n){return OD[n]}function QD(n){return kD[n]}function KD(n){return PD[n]}function Fo(n){return{fieldPath:n.canonicalString()}}function qo(n){return an.fromServerFormat(n.fieldPath)}function k0(n){return n instanceof kt?function(t){if(t.op==="=="){if(v_(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NAN"}};if(g_(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(v_(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NOT_NAN"}};if(g_(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fo(t.field),op:QD(t.op),value:t.value}}}(n):n instanceof Ts?function(t){const i=t.getFilters().map(o=>k0(o));return i.length===1?i[0]:{compositeFilter:{op:KD(t.op),filters:i}}}(n):Ee(54877,{filter:n})}function XD(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function P0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,t,i,o,c=we.min(),d=we.min(),f=ln.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e){this.wt=e}}function ZD(n){const e=GD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Sh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(){this.Cn=new eM}addToCollectionParentIndex(e,t){return this.Cn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(ji.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(ji.min())}updateCollectionGroup(e,t,i){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class eM{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new zt(ht.comparator),c=!o.has(i);return this.index[t]=o.add(i),c}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new zt(ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},L0=41943040;class Sn{static withCacheSize(e){return new Sn(e,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sn.DEFAULT_COLLECTION_PERCENTILE=10,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sn.DEFAULT=new Sn(L0,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sn.DISABLED=new Sn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new nl(0)}static lr(){return new nl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D_="LruGarbageCollector",tM=1048576;function M_([n,e],[t,i]){const o=qe(n,t);return o===0?qe(e,i):o}class nM{constructor(e){this.Er=e,this.buffer=new zt(M_),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();M_(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class sM{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){ve(D_,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){hl(t)?ve(D_,"Ignoring IndexedDB error during garbage collection: ",t):await dl(t)}await this.mr(3e5)})}}class aM{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(Xh.le);const i=new nM(t);return this.gr.forEachTarget(e,o=>i.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>i.Rr(o))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.gr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(R_)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),R_):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let i,o,c,d,f,p,g;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(x=>(x>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),o=this.params.maximumSequenceNumbersToCollect):o=x,d=Date.now(),this.nthSequenceNumber(e,o))).next(x=>(i=x,f=Date.now(),this.removeTargets(e,i,t))).next(x=>(c=x,p=Date.now(),this.removeOrphanedDocuments(e,i))).next(x=>(g=Date.now(),Vo()<=$e.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-y}ms
	Determined least recently used ${o} in `+(f-d)+`ms
	Removed ${c} targets in `+(p-f)+`ms
	Removed ${x} documents in `+(g-p)+`ms
Total Duration: ${g-y}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:x})))}}function iM(n,e){return new aM(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(){this.changes=new Ur(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Wt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?oe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lM{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(i=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(i!==null&&Uc(i.mutation,o,zn.empty(),qt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Ye()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Ye()){const o=wr();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,i).next(c=>{let d=Rc();return c.forEach((f,p)=>{d=d.insert(f,p.overlayedDocument)}),d}))}getOverlayedDocuments(e,t){const i=wr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Ye()))}populateOverlays(e,t,i){const o=[];return i.forEach(c=>{t.has(c)||o.push(c)}),this.documentOverlayCache.getOverlays(e,o).next(c=>{c.forEach((d,f)=>{t.set(d,f)})})}computeViews(e,t,i,o){let c=Oa();const d=Vc(),f=function(){return Vc()}();return t.forEach((p,g)=>{const y=i.get(g.key);o.has(g.key)&&(y===void 0||y.mutation instanceof Ui)?c=c.insert(g.key,g):y!==void 0?(d.set(g.key,y.mutation.getFieldMask()),Uc(y.mutation,g,y.mutation.getFieldMask(),qt.now())):d.set(g.key,zn.empty())}),this.recalculateAndSaveOverlays(e,c).next(p=>(p.forEach((g,y)=>d.set(g,y)),t.forEach((g,y)=>{var x;return f.set(g,new oM(y,(x=d.get(g))!==null&&x!==void 0?x:null))}),f))}recalculateAndSaveOverlays(e,t){const i=Vc();let o=new _t((d,f)=>d-f),c=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(d=>{for(const f of d)f.keys().forEach(p=>{const g=t.get(p);if(g===null)return;let y=i.get(p)||zn.empty();y=f.applyToLocalView(g,y),i.set(p,y);const x=(o.get(f.batchId)||Ye()).add(p);o=o.insert(f.batchId,x)})}).next(()=>{const d=[],f=o.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),g=p.key,y=p.value,x=g0();y.forEach(_=>{if(!c.has(_)){const A=_0(t.get(_),i.get(_));A!==null&&x.set(_,A),c=c.add(_)}}),d.push(this.documentOverlayCache.saveOverlays(e,g,x))}return oe.waitFor(d)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,o){return function(d){return Ne.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):d0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next(c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-c.size):oe.resolve(wr());let f=Kc,p=c;return d.next(g=>oe.forEach(g,(y,x)=>(f<x.largestBatchId&&(f=x.largestBatchId),c.get(y)?oe.resolve():this.remoteDocumentCache.getEntry(e,y).next(_=>{p=p.insert(y,_)}))).next(()=>this.populateOverlays(e,g,c)).next(()=>this.computeViews(e,p,g,Ye())).next(y=>({batchId:f,changes:p0(y)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ne(t)).next(i=>{let o=Rc();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const c=t.collectionGroup;let d=Rc();return this.indexManager.getCollectionParents(e,c).next(f=>oe.forEach(f,p=>{const g=function(x,_){return new fl(_,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)}(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,g,i,o).next(y=>{y.forEach((x,_)=>{d=d.insert(x,_)})})}).next(()=>d))}getDocumentsMatchingCollectionQuery(e,t,i,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,c,o))).next(d=>{c.forEach((p,g)=>{const y=g.getKey();d.get(y)===null&&(d=d.insert(y,Wt.newInvalidDocument(y)))});let f=Rc();return d.forEach((p,g)=>{const y=c.get(p);y!==void 0&&Uc(y.mutation,g,zn.empty(),qt.now()),ef(t,g)&&(f=f.insert(p,g))}),f})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return oe.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:Hn(o.createTime)}}(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:ZD(o.bundledQuery),readTime:Hn(o.readTime)}}(t)),oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(){this.overlays=new _t(Ne.comparator),this.Qr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=wr();return oe.forEach(t,o=>this.getOverlay(e,o).next(c=>{c!==null&&i.set(o,c)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((o,c)=>{this.St(e,t,c)}),oe.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.Qr.get(i);return o!==void 0&&(o.forEach(c=>this.overlays=this.overlays.remove(c)),this.Qr.delete(i)),oe.resolve()}getOverlaysForCollection(e,t,i){const o=wr(),c=t.length+1,d=new Ne(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const p=f.getNext().value,g=p.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===c&&p.largestBatchId>i&&o.set(p.getKey(),p)}return oe.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let c=new _t((g,y)=>g-y);const d=this.overlays.getIterator();for(;d.hasNext();){const g=d.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>i){let y=c.get(g.largestBatchId);y===null&&(y=wr(),c=c.insert(g.largestBatchId,y)),y.set(g.getKey(),g)}}const f=wr(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((g,y)=>f.set(g,y)),!(f.size()>=o)););return oe.resolve(f)}St(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const d=this.Qr.get(o.largestBatchId).delete(i.key);this.Qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new ID(t,i));let c=this.Qr.get(t);c===void 0&&(c=Ye(),this.Qr.set(t,c)),this.Qr.set(t,c.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(){this.sessionToken=ln.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(){this.$r=new zt(Xt.Ur),this.Kr=new zt(Xt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const i=new Xt(e,t);this.$r=this.$r.add(i),this.Kr=this.Kr.add(i)}Gr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.zr(new Xt(e,t))}jr(e,t){e.forEach(i=>this.removeReference(i,t))}Hr(e){const t=new Ne(new ht([])),i=new Xt(t,e),o=new Xt(t,e+1),c=[];return this.Kr.forEachInRange([i,o],d=>{this.zr(d),c.push(d.key)}),c}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new Ne(new ht([])),i=new Xt(t,e),o=new Xt(t,e+1);let c=Ye();return this.Kr.forEachInRange([i,o],d=>{c=c.add(d.key)}),c}containsKey(e){const t=new Xt(e,0),i=this.$r.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Xt{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return Ne.comparator(e.key,t.key)||qe(e.Zr,t.Zr)}static Wr(e,t){return qe(e.Zr,t.Zr)||Ne.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new zt(Xt.Ur)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const c=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new SD(c,t,i,o);this.mutationQueue.push(d);for(const f of o)this.Xr=this.Xr.add(new Xt(f.key,c)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return oe.resolve(d)}lookupMutationBatch(e,t){return oe.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.ti(i),c=o<0?0:o;return oe.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?Qg:this.nr-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Xt(t,0),o=new Xt(t,Number.POSITIVE_INFINITY),c=[];return this.Xr.forEachInRange([i,o],d=>{const f=this.ei(d.Zr);c.push(f)}),oe.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new zt(qe);return t.forEach(o=>{const c=new Xt(o,0),d=new Xt(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([c,d],f=>{i=i.add(f.Zr)})}),oe.resolve(this.ni(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let c=i;Ne.isDocumentKey(c)||(c=c.child(""));const d=new Xt(new Ne(c),0);let f=new zt(qe);return this.Xr.forEachWhile(p=>{const g=p.key.path;return!!i.isPrefixOf(g)&&(g.length===o&&(f=f.add(p.Zr)),!0)},d),oe.resolve(this.ni(f))}ni(e){const t=[];return e.forEach(i=>{const o=this.ei(i);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Ze(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Xr;return oe.forEach(t.mutations,o=>{const c=new Xt(o.key,t.batchId);return i=i.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=i})}sr(e){}containsKey(e,t){const i=new Xt(t,0),o=this.Xr.firstAfterOrEqual(i);return oe.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e){this.ii=e,this.docs=function(){return new _t(Ne.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),c=o?o.size:0,d=this.ii(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return oe.resolve(i?i.document.mutableCopy():Wt.newInvalidDocument(t))}getEntries(e,t){let i=Oa();return t.forEach(o=>{const c=this.docs.get(o);i=i.insert(o,c?c.document.mutableCopy():Wt.newInvalidDocument(o))}),oe.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let c=Oa();const d=t.path,f=new Ne(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:g,value:{document:y}}=p.getNext();if(!d.isPrefixOf(g.path))break;g.path.length>d.length+1||H1(B1(y),i)<=0||(o.has(y.key)||ef(t,y))&&(c=c.insert(y.key,y.mutableCopy()))}return oe.resolve(c)}getAllFromCollectionGroup(e,t,i,o){Ee(9500)}si(e,t){return oe.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new mM(this)}getSize(e){return oe.resolve(this.size)}}class mM extends rM{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((i,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(i)}),oe.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e){this.persistence=e,this.oi=new Ur(t=>Wg(t),Zg),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this._i=0,this.ai=new sv,this.targetCount=0,this.ui=nl.cr()}forEachTarget(e,t){return this.oi.forEach((i,o)=>t(o)),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this._i&&(this._i=t),oe.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new nl(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.Tr(t),oe.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,i){let o=0;const c=[];return this.oi.forEach((d,f)=>{f.sequenceNumber<=t&&i.get(f.targetId)===null&&(this.oi.delete(d),c.push(this.removeMatchingKeysForTargetId(e,f.targetId)),o++)}),oe.waitFor(c).next(()=>o)}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const i=this.oi.get(t)||null;return oe.resolve(i)}addMatchingKeys(e,t,i){return this.ai.Gr(t,i),oe.resolve()}removeMatchingKeys(e,t,i){this.ai.jr(t,i);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach(d=>{c.push(o.markPotentiallyOrphaned(e,d))}),oe.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const i=this.ai.Yr(t);return oe.resolve(i)}containsKey(e,t){return oe.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e,t){this.ci={},this.overlays={},this.li=new Xh(0),this.hi=!1,this.hi=!0,this.Pi=new dM,this.referenceDelegate=e(this),this.Ti=new pM(this),this.indexManager=new JD,this.remoteDocumentCache=function(o){return new fM(o)}(i=>this.referenceDelegate.Ii(i)),this.serializer=new WD(t),this.Ei=new cM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new uM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ci[e.toKey()];return i||(i=new hM(t,this.referenceDelegate),this.ci[e.toKey()]=i),i}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,i){ve("MemoryPersistence","Starting transaction:",e);const o=new gM(this.li.next());return this.referenceDelegate.di(),i(o).next(c=>this.referenceDelegate.Ai(o).next(()=>c)).toPromise().then(c=>(o.raiseOnCommittedEvent(),c))}Ri(e,t){return oe.or(Object.values(this.ci).map(i=>()=>i.containsKey(e,t)))}}class gM extends $1{constructor(e){super(),this.currentSequenceNumber=e}}class av{constructor(e){this.persistence=e,this.Vi=new sv,this.mi=null}static fi(e){return new av(e)}get gi(){if(this.mi)return this.mi;throw Ee(60996)}addReference(e,t,i){return this.Vi.addReference(i,t),this.gi.delete(i.toString()),oe.resolve()}removeReference(e,t,i){return this.Vi.removeReference(i,t),this.gi.add(i.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(c=>this.gi.add(c.toString()))}).next(()=>i.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.gi,i=>{const o=Ne.fromPath(i);return this.pi(e,o).next(c=>{c||t.removeEntry(o,we.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(i=>{i?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return oe.or([()=>oe.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Mh{constructor(e,t){this.persistence=e,this.yi=new Ur(i=>K1(i.path),(i,o)=>i.isEqual(o)),this.garbageCollector=iM(this,t)}static fi(e,t){return new Mh(e,t)}di(){}Ai(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(o=>i+o))}br(e){let t=0;return this.yr(e,i=>{t++}).next(()=>t)}yr(e,t){return oe.forEach(this.yi,(i,o)=>this.Dr(e,i,o).next(c=>c?oe.resolve():t(o)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.si(e,d=>this.Dr(e,d,t).next(f=>{f||(i++,c.removeEntry(d,we.min()))})).next(()=>c.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.yi.set(i,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,i){return this.yi.set(i,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),oe.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=uh(e.data.value)),t}Dr(e,t,i){return oe.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return oe.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.ds=i,this.As=o}static Rs(e,t){let i=Ye(),o=Ye();for(const c of t.docChanges)switch(c.type){case 0:i=i.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new iv(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return XC()?8:Y1(gn())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,i,o){const c={result:null};return this.ws(e,t).next(d=>{c.result=d}).next(()=>{if(!c.result)return this.bs(e,t,o,i).next(d=>{c.result=d})}).next(()=>{if(c.result)return;const d=new vM;return this.Ss(e,t,d).next(f=>{if(c.result=f,this.fs)return this.Ds(e,t,d,f.size)})}).next(()=>c.result)}Ds(e,t,i,o){return i.documentReadCount<this.gs?(Vo()<=$e.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",Uo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),oe.resolve()):(Vo()<=$e.DEBUG&&ve("QueryEngine","Query:",Uo(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.ps*o?(Vo()<=$e.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",Uo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ks(t))):oe.resolve())}ws(e,t){if(N_(t))return oe.resolve(null);let i=Ks(t);return this.indexManager.getIndexType(e,i).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Sh(t,null,"F"),i=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(c=>{const d=Ye(...c);return this.ys.getDocuments(e,d).next(f=>this.indexManager.getMinOffset(e,i).next(p=>{const g=this.vs(t,f);return this.Cs(t,g,d,p.readTime)?this.ws(e,Sh(t,null,"F")):this.Fs(e,g,t,p)}))})))}bs(e,t,i,o){return N_(t)||o.isEqual(we.min())?oe.resolve(null):this.ys.getDocuments(e,i).next(c=>{const d=this.vs(t,c);return this.Cs(t,d,i,o)?oe.resolve(null):(Vo()<=$e.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Uo(t)),this.Fs(e,d,t,z1(o,Kc)).next(f=>f))})}vs(e,t){let i=new zt(f0(e));return t.forEach((o,c)=>{ef(e,c)&&(i=i.add(c))}),i}Cs(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,i){return Vo()<=$e.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",Uo(t)),this.ys.getDocumentsMatchingQuery(e,t,ji.min(),i)}Fs(e,t,i,o){return this.ys.getDocumentsMatchingQuery(e,i,o).next(c=>(t.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv="LocalStore",bM=3e8;class xM{constructor(e,t,i,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new _t(qe),this.Os=new Ur(c=>Wg(c),Zg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(i)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lM(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function NM(n,e,t,i){return new xM(n,e,t,i)}async function U0(n,e){const t=De(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next(c=>(o=c,t.Ls(e),t.mutationQueue.getAllMutationBatches(i))).next(c=>{const d=[],f=[];let p=Ye();for(const g of o){d.push(g.batchId);for(const y of g.mutations)p=p.add(y.key)}for(const g of c){f.push(g.batchId);for(const y of g.mutations)p=p.add(y.key)}return t.localDocuments.getDocuments(i,p).next(g=>({ks:g,removedBatchIds:d,addedBatchIds:f}))})})}function _M(n,e){const t=De(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const o=e.batch.keys(),c=t.Bs.newChangeBuffer({trackRemovals:!0});return function(f,p,g,y){const x=g.batch,_=x.keys();let A=oe.resolve();return _.forEach(N=>{A=A.next(()=>y.getEntry(p,N)).next(C=>{const T=g.docVersions.get(N);Ze(T!==null,48541),C.version.compareTo(T)<0&&(x.applyToRemoteDocument(C,g),C.isValidDocument()&&(C.setReadTime(g.commitVersion),y.addEntry(C)))})}),A.next(()=>f.mutationQueue.removeMutationBatch(p,x))}(t,i,e,c).next(()=>c.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(f){let p=Ye();for(let g=0;g<f.mutationResults.length;++g)f.mutationResults[g].transformResults.length>0&&(p=p.add(f.batch.mutations[g].key));return p}(e))).next(()=>t.localDocuments.getDocuments(i,o))})}function F0(n){const e=De(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function EM(n,e){const t=De(n),i=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const f=[];e.targetChanges.forEach((y,x)=>{const _=o.get(x);if(!_)return;f.push(t.Ti.removeMatchingKeys(c,y.removedDocuments,x).next(()=>t.Ti.addMatchingKeys(c,y.addedDocuments,x)));let A=_.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(x)!==null?A=A.withResumeToken(ln.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):y.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(y.resumeToken,i)),o=o.insert(x,A),function(C,T,M){return C.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=bM?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0}(_,A,y)&&f.push(t.Ti.updateTargetData(c,A))});let p=Oa(),g=Ye();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(c,y))}),f.push(TM(c,d,e.documentUpdates).next(y=>{p=y.qs,g=y.Qs})),!i.isEqual(we.min())){const y=t.Ti.getLastRemoteSnapshotVersion(c).next(x=>t.Ti.setTargetsMetadata(c,c.currentSequenceNumber,i));f.push(y)}return oe.waitFor(f).next(()=>d.apply(c)).next(()=>t.localDocuments.getLocalViewOfDocuments(c,p,g)).next(()=>p)}).then(c=>(t.xs=o,c))}function TM(n,e,t){let i=Ye(),o=Ye();return t.forEach(c=>i=i.add(c)),e.getEntries(n,i).next(c=>{let d=Oa();return t.forEach((f,p)=>{const g=c.get(f);p.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(f)),p.isNoDocument()&&p.version.isEqual(we.min())?(e.removeEntry(f,p.readTime),d=d.insert(f,p)):!g.isValidDocument()||p.version.compareTo(g.version)>0||p.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(p),d=d.insert(f,p)):ve(rv,"Ignoring outdated watch update for ",f,". Current version:",g.version," Watch version:",p.version)}),{qs:d,Qs:o}})}function jM(n,e){const t=De(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=Qg),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function AM(n,e){const t=De(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let o;return t.Ti.getTargetData(i,e).next(c=>c?(o=c,oe.resolve(o)):t.Ti.allocateTargetId(i).next(d=>(o=new yi(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.Ti.addTargetData(i,o).next(()=>o))))}).then(i=>{const o=t.xs.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(i.targetId,i),t.Os.set(e,i.targetId)),i})}async function yg(n,e,t){const i=De(n),o=i.xs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",c,d=>i.persistence.referenceDelegate.removeTarget(d,o))}catch(d){if(!hl(d))throw d;ve(rv,`Failed to update sequence numbers for target ${e}: ${d}`)}i.xs=i.xs.remove(e),i.Os.delete(o.target)}function O_(n,e,t){const i=De(n);let o=we.min(),c=Ye();return i.persistence.runTransaction("Execute query","readwrite",d=>function(p,g,y){const x=De(p),_=x.Os.get(y);return _!==void 0?oe.resolve(x.xs.get(_)):x.Ti.getTargetData(g,y)}(i,d,Ks(e)).next(f=>{if(f)return o=f.lastLimboFreeSnapshotVersion,i.Ti.getMatchingKeysForTargetId(d,f.targetId).next(p=>{c=p})}).next(()=>i.Ms.getDocumentsMatchingQuery(d,e,t?o:we.min(),t?c:Ye())).next(f=>(wM(i,mD(e),f),{documents:f,$s:c})))}function wM(n,e,t){let i=n.Ns.get(e)||we.min();t.forEach((o,c)=>{c.readTime.compareTo(i)>0&&(i=c.readTime)}),n.Ns.set(e,i)}class k_{constructor(){this.activeTargetIds=xD()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class CM{constructor(){this.xo=new k_,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,i){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new k_,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P_="ConnectivityMonitor";class L_{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){ve(P_,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){ve(P_,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let th=null;function bg(){return th===null?th=function(){return 268435456+Math.round(2147483648*Math.random())}():th++,"0x"+th.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp="RestConnection",IM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class RM{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${i}/databases/${o}`,this.Go=this.databaseId.database===Ah?`project_id=${i}`:`project_id=${i}&database_id=${o}`}zo(e,t,i,o,c){const d=bg(),f=this.jo(e,t.toUriEncodedString());ve(Vp,`Sending RPC '${e}' ${d}:`,f,i);const p={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(p,o,c);const{host:g}=new URL(f),y=Lr(g);return this.Jo(e,f,p,i,y).then(x=>(ve(Vp,`Received RPC '${e}' ${d}: `,x),x),x=>{throw Zo(Vp,`RPC '${e}' ${d} failed with error: `,x,"url: ",f,"request:",i),x})}Yo(e,t,i,o,c,d){return this.zo(e,t,i,o,c)}Ho(e,t,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ul}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,c)=>e[c]=o),i&&i.headers.forEach((o,c)=>e[c]=o)}jo(e,t){const i=IM[e];return`${this.Ko}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hn="WebChannelConnection";class MM extends RM{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,o,c){const d=bg();return new Promise((f,p)=>{const g=new FT;g.setWithCredentials(!0),g.listenOnce(qT.COMPLETE,()=>{try{switch(g.getLastErrorCode()){case ch.NO_ERROR:const x=g.getResponseJson();ve(hn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(x)),f(x);break;case ch.TIMEOUT:ve(hn,`RPC '${e}' ${d} timed out`),p(new ge(ie.DEADLINE_EXCEEDED,"Request time out"));break;case ch.HTTP_ERROR:const _=g.getStatus();if(ve(hn,`RPC '${e}' ${d} failed with status:`,_,"response text:",g.getResponseText()),_>0){let A=g.getResponseJson();Array.isArray(A)&&(A=A[0]);const N=A?.error;if(N&&N.status&&N.message){const C=function(M){const q=M.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(q)>=0?q:ie.UNKNOWN}(N.status);p(new ge(C,N.message))}else p(new ge(ie.UNKNOWN,"Server responded with status "+g.getStatus()))}else p(new ge(ie.UNAVAILABLE,"Connection failed."));break;default:Ee(9055,{h_:e,streamId:d,P_:g.getLastErrorCode(),T_:g.getLastError()})}}finally{ve(hn,`RPC '${e}' ${d} completed.`)}});const y=JSON.stringify(o);ve(hn,`RPC '${e}' ${d} sending request:`,o),g.send(t,"POST",y,i,15)})}I_(e,t,i){const o=bg(),c=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=HT(),f=BT(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Ho(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=c.join("");ve(hn,`Creating RPC '${e}' stream ${o}: ${y}`,p);const x=d.createWebChannel(y,p);this.E_(x);let _=!1,A=!1;const N=new DM({Zo:T=>{A?ve(hn,`Not sending because RPC '${e}' stream ${o} is closed:`,T):(_||(ve(hn,`Opening RPC '${e}' stream ${o} transport.`),x.open(),_=!0),ve(hn,`RPC '${e}' stream ${o} sending:`,T),x.send(T))},Xo:()=>x.close()}),C=(T,M,q)=>{T.listen(M,U=>{try{q(U)}catch(P){setTimeout(()=>{throw P},0)}})};return C(x,Ic.EventType.OPEN,()=>{A||(ve(hn,`RPC '${e}' stream ${o} transport opened.`),N.__())}),C(x,Ic.EventType.CLOSE,()=>{A||(A=!0,ve(hn,`RPC '${e}' stream ${o} transport closed`),N.u_(),this.d_(x))}),C(x,Ic.EventType.ERROR,T=>{A||(A=!0,Zo(hn,`RPC '${e}' stream ${o} transport errored. Name:`,T.name,"Message:",T.message),N.u_(new ge(ie.UNAVAILABLE,"The operation could not be completed")))}),C(x,Ic.EventType.MESSAGE,T=>{var M;if(!A){const q=T.data[0];Ze(!!q,16349);const U=q,P=U?.error||((M=U[0])===null||M===void 0?void 0:M.error);if(P){ve(hn,`RPC '${e}' stream ${o} received error:`,P);const F=P.status;let G=function(L){const O=Ot[L];if(O!==void 0)return A0(O)}(F),V=P.message;G===void 0&&(G=ie.INTERNAL,V="Unknown error status: "+F+" with message "+P.message),A=!0,N.u_(new ge(G,V)),x.close()}else ve(hn,`RPC '${e}' stream ${o} received:`,q),N.c_(q)}}),C(f,zT.STAT_EVENT,T=>{T.stat===lg.PROXY?ve(hn,`RPC '${e}' stream ${o} detected buffering proxy`):T.stat===lg.NOPROXY&&ve(hn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{N.a_()},0),N}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function Up(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(n){return new LD(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,t,i=1e3,o=1.5,c=6e4){this.xi=e,this.timerId=t,this.A_=i,this.R_=o,this.V_=c,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),i=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-i);o>0&&ve("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V_="PersistentStream";class q0{constructor(e,t,i,o,c,d,f,p){this.xi=e,this.S_=i,this.D_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new ov(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(Ma(t.toString()),Ma("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,o])=>{this.v_===t&&this.z_(i,o)},i=>{e(()=>{const o=new ge(ie.UNKNOWN,"Fetching auth token failed: "+i.message);return this.j_(o)})})}z_(e,t){const i=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{i(()=>this.listener.e_())}),this.stream.n_(()=>{i(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{i(()=>this.j_(o))}),this.stream.onMessage(o=>{i(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return ve(V_,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(ve(V_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class OM extends q0{constructor(e,t,i,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=qD(this.serializer,e),i=function(c){if(!("targetChange"in c))return we.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?we.min():d.readTime?Hn(d.readTime):we.min()}(e);return this.listener.Y_(t,i)}Z_(e){const t={};t.database=vg(this.serializer),t.addTarget=function(c,d){let f;const p=d.target;if(f=fg(p)?{documents:BD(c,p)}:{query:HD(c,p).gt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=S0(c,d.resumeToken);const g=pg(c,d.expectedCount);g!==null&&(f.expectedCount=g)}else if(d.snapshotVersion.compareTo(we.min())>0){f.readTime=Rh(c,d.snapshotVersion.toTimestamp());const g=pg(c,d.expectedCount);g!==null&&(f.expectedCount=g)}return f}(this.serializer,e);const i=$D(this.serializer,e);i&&(t.labels=i),this.Q_(t)}X_(e){const t={};t.database=vg(this.serializer),t.removeTarget=e,this.Q_(t)}}class kM extends q0{constructor(e,t,i,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=zD(e.writeResults,e.commitTime),i=Hn(e.commitTime);return this.listener.ra(i,t)}ia(){const e={};e.database=vg(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>M0(this.serializer,i))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{}class LM extends PM{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new ge(ie.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,i,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.zo(e,gg(t,i),o,c,d)).catch(c=>{throw c.name==="FirebaseError"?(c.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new ge(ie.UNKNOWN,c.toString())})}Yo(e,t,i,o,c){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,f])=>this.connection.Yo(e,gg(t,i),o,d,f,c)).catch(d=>{throw d.name==="FirebaseError"?(d.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new ge(ie.UNKNOWN,d.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class VM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Ma(t),this.ua=!1):ve("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="RemoteStore";class UM{constructor(e,t,i,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=c,this.Ra.No(d=>{i.enqueueAndForget(async()=>{Fr(this)&&(ve(Mr,"Restarting streams for network reachability change."),await async function(p){const g=De(p);g.da.add(4),await vu(g),g.Va.set("Unknown"),g.da.delete(4),await of(g)}(this))})}),this.Va=new VM(i,o)}}async function of(n){if(Fr(n))for(const e of n.Aa)await e(!0)}async function vu(n){for(const e of n.Aa)await e(!1)}function z0(n,e){const t=De(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),dv(t)?uv(t):ml(t).N_()&&cv(t,e))}function lv(n,e){const t=De(n),i=ml(t);t.Ea.delete(e),i.N_()&&B0(t,e),t.Ea.size===0&&(i.N_()?i.k_():Fr(t)&&t.Va.set("Unknown"))}function cv(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(we.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ml(n).Z_(e)}function B0(n,e){n.ma.Ke(e),ml(n).X_(e)}function uv(n){n.ma=new MD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),ml(n).start(),n.Va.ca()}function dv(n){return Fr(n)&&!ml(n).O_()&&n.Ea.size>0}function Fr(n){return De(n).da.size===0}function H0(n){n.ma=void 0}async function FM(n){n.Va.set("Online")}async function qM(n){n.Ea.forEach((e,t)=>{cv(n,e)})}async function zM(n,e){H0(n),dv(n)?(n.Va.Pa(e),uv(n)):n.Va.set("Unknown")}async function BM(n,e,t){if(n.Va.set("Online"),e instanceof C0&&e.state===2&&e.cause)try{await async function(o,c){const d=c.cause;for(const f of c.targetIds)o.Ea.has(f)&&(await o.remoteSyncer.rejectListen(f,d),o.Ea.delete(f),o.ma.removeTarget(f))}(n,e)}catch(i){ve(Mr,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Oh(n,i)}else if(e instanceof fh?n.ma.Xe(e):e instanceof w0?n.ma.ot(e):n.ma.nt(e),!t.isEqual(we.min()))try{const i=await F0(n.localStore);t.compareTo(i)>=0&&await function(c,d){const f=c.ma.It(d);return f.targetChanges.forEach((p,g)=>{if(p.resumeToken.approximateByteSize()>0){const y=c.Ea.get(g);y&&c.Ea.set(g,y.withResumeToken(p.resumeToken,d))}}),f.targetMismatches.forEach((p,g)=>{const y=c.Ea.get(p);if(!y)return;c.Ea.set(p,y.withResumeToken(ln.EMPTY_BYTE_STRING,y.snapshotVersion)),B0(c,p);const x=new yi(y.target,p,g,y.sequenceNumber);cv(c,x)}),c.remoteSyncer.applyRemoteEvent(f)}(n,t)}catch(i){ve(Mr,"Failed to raise snapshot:",i),await Oh(n,i)}}async function Oh(n,e,t){if(!hl(e))throw e;n.da.add(1),await vu(n),n.Va.set("Offline"),t||(t=()=>F0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ve(Mr,"Retrying IndexedDB access"),await t(),n.da.delete(1),await of(n)})}function G0(n,e){return e().catch(t=>Oh(n,t,e))}async function lf(n){const e=De(n),t=Si(e);let i=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Qg;for(;HM(e);)try{const o=await jM(e.localStore,i);if(o===null){e.Ia.length===0&&t.k_();break}i=o.batchId,GM(e,o)}catch(o){await Oh(e,o)}$0(e)&&Y0(e)}function HM(n){return Fr(n)&&n.Ia.length<10}function GM(n,e){n.Ia.push(e);const t=Si(n);t.N_()&&t.ea&&t.ta(e.mutations)}function $0(n){return Fr(n)&&!Si(n).O_()&&n.Ia.length>0}function Y0(n){Si(n).start()}async function $M(n){Si(n).ia()}async function YM(n){const e=Si(n);for(const t of n.Ia)e.ta(t.mutations)}async function QM(n,e,t){const i=n.Ia.shift(),o=ev.from(i,e,t);await G0(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await lf(n)}async function KM(n,e){e&&Si(n).ea&&await async function(i,o){if(function(d){return j0(d)&&d!==ie.ABORTED}(o.code)){const c=i.Ia.shift();Si(i).L_(),await G0(i,()=>i.remoteSyncer.rejectFailedWrite(c.batchId,o)),await lf(i)}}(n,e),$0(n)&&Y0(n)}async function U_(n,e){const t=De(n);t.asyncQueue.verifyOperationInProgress(),ve(Mr,"RemoteStore received new credentials");const i=Fr(t);t.da.add(3),await vu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await of(t)}async function XM(n,e){const t=De(n);e?(t.da.delete(2),await of(t)):e||(t.da.add(2),await vu(t),t.Va.set("Unknown"))}function ml(n){return n.fa||(n.fa=function(t,i,o){const c=De(t);return c.oa(),new OM(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:FM.bind(null,n),n_:qM.bind(null,n),i_:zM.bind(null,n),Y_:BM.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),dv(n)?uv(n):n.Va.set("Unknown")):(await n.fa.stop(),H0(n))})),n.fa}function Si(n){return n.ga||(n.ga=function(t,i,o){const c=De(t);return c.oa(),new kM(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:$M.bind(null,n),i_:KM.bind(null,n),na:YM.bind(null,n),ra:QM.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await lf(n)):(await n.ga.stop(),n.Ia.length>0&&(ve(Mr,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e,t,i,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=c,this.deferred=new Qs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,c){const d=Date.now()+i,f=new hv(e,t,d,o,c);return f.start(i),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ge(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fv(n,e){if(Ma("AsyncQueue",`${e}: ${n}`),hl(n))return new ge(ie.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{static emptySet(e){return new Ko(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ne.comparator(t.key,i.key):(t,i)=>Ne.comparator(t.key,i.key),this.keyedMap=Rc(),this.sortedSet=new _t(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ko)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Ko;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(){this.pa=new _t(Ne.comparator)}track(e){const t=e.doc.key,i=this.pa.get(t);i?e.type!==0&&i.type===3?this.pa=this.pa.insert(t,e):e.type===3&&i.type!==1?this.pa=this.pa.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.pa=this.pa.remove(t):e.type===1&&i.type===2?this.pa=this.pa.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Ee(63341,{Vt:e,ya:i}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,i)=>{e.push(i)}),e}}class sl{constructor(e,t,i,o,c,d,f,p,g){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=g}static fromInitialDocuments(e,t,i,o,c){const d=[];return t.forEach(f=>{d.push({type:0,doc:f})}),new sl(e,t,Ko.emptySet(t),d,i,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WM{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class ZM{constructor(){this.queries=q_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=De(t),c=o.queries;o.queries=q_(),c.forEach((d,f)=>{for(const p of f.Sa)p.onError(i)})})(this,new ge(ie.ABORTED,"Firestore shutting down"))}}function q_(){return new Ur(n=>h0(n),Jh)}async function mv(n,e){const t=De(n);let i=3;const o=e.query;let c=t.queries.get(o);c?!c.Da()&&e.va()&&(i=2):(c=new WM,i=e.va()?0:1);try{switch(i){case 0:c.ba=await t.onListen(o,!0);break;case 1:c.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const f=fv(d,`Initialization of query '${Uo(e.query)}' failed`);return void e.onError(f)}t.queries.set(o,c),c.Sa.push(e),e.Fa(t.onlineState),c.ba&&e.Ma(c.ba)&&gv(t)}async function pv(n,e){const t=De(n),i=e.query;let o=3;const c=t.queries.get(i);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.va()?0:1:!c.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function JM(n,e){const t=De(n);let i=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const f of d.Sa)f.Ma(o)&&(i=!0);d.ba=o}}i&&gv(t)}function eO(n,e,t){const i=De(n),o=i.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);i.queries.delete(e)}function gv(n){n.Ca.forEach(e=>{e.next()})}var xg,z_;(z_=xg||(xg={})).xa="default",z_.Cache="cache";class vv{constructor(e,t,i){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=i||{}}Ma(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new sl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const i=t!=="Offline";return(!this.options.Qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=sl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==xg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e){this.key=e}}class K0{constructor(e){this.key=e}}class tO{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ye(),this.mutatedKeys=Ye(),this.Za=f0(e),this.Xa=new Ko(this.Za)}get eu(){return this.Ha}tu(e,t){const i=t?t.nu:new F_,o=t?t.Xa:this.Xa;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,f=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((y,x)=>{const _=o.get(y),A=ef(this.query,x)?x:null,N=!!_&&this.mutatedKeys.has(_.key),C=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let T=!1;_&&A?_.data.isEqual(A.data)?N!==C&&(i.track({type:3,doc:A}),T=!0):this.ru(_,A)||(i.track({type:2,doc:A}),T=!0,(p&&this.Za(A,p)>0||g&&this.Za(A,g)<0)&&(f=!0)):!_&&A?(i.track({type:0,doc:A}),T=!0):_&&!A&&(i.track({type:1,doc:_}),T=!0,(p||g)&&(f=!0)),T&&(A?(d=d.add(A),c=C?c.add(y):c.delete(y)):(d=d.delete(y),c=c.delete(y)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const y=this.query.limitType==="F"?d.last():d.first();d=d.delete(y.key),c=c.delete(y.key),i.track({type:1,doc:y})}return{Xa:d,nu:i,Cs:f,mutatedKeys:c}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const c=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const d=e.nu.wa();d.sort((y,x)=>function(A,N){const C=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ee(20277,{Vt:T})}};return C(A)-C(N)}(y.type,x.type)||this.Za(y.doc,x.doc)),this.iu(i),o=o!=null&&o;const f=t&&!o?this.su():[],p=this.Ya.size===0&&this.current&&!o?1:0,g=p!==this.Ja;return this.Ja=p,d.length!==0||g?{snapshot:new sl(this.query,e.Xa,c,d,e.mutatedKeys,p===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),ou:f}:{ou:f}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new F_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Ye(),this.Xa.forEach(i=>{this._u(i.key)&&(this.Ya=this.Ya.add(i.key))});const t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new K0(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new Q0(i))}),t}au(e){this.Ha=e.$s,this.Ya=Ye();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return sl.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const yv="SyncEngine";class nO{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class sO{constructor(e){this.key=e,this.cu=!1}}class aO{constructor(e,t,i,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.lu={},this.hu=new Ur(f=>h0(f),Jh),this.Pu=new Map,this.Tu=new Set,this.Iu=new _t(Ne.comparator),this.Eu=new Map,this.du=new sv,this.Au={},this.Ru=new Map,this.Vu=nl.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function iO(n,e,t=!0){const i=tj(n);let o;const c=i.hu.get(e);return c?(i.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.uu()):o=await X0(i,e,t,!0),o}async function rO(n,e){const t=tj(n);await X0(t,e,!0,!1)}async function X0(n,e,t,i){const o=await AM(n.localStore,Ks(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let f;return i&&(f=await oO(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&z0(n.remoteStore,o),f}async function oO(n,e,t,i,o){n.fu=(x,_,A)=>async function(C,T,M,q){let U=T.view.tu(M);U.Cs&&(U=await O_(C.localStore,T.query,!1).then(({documents:V})=>T.view.tu(V,U)));const P=q&&q.targetChanges.get(T.targetId),F=q&&q.targetMismatches.get(T.targetId)!=null,G=T.view.applyChanges(U,C.isPrimaryClient,P,F);return H_(C,T.targetId,G.ou),G.snapshot}(n,x,_,A);const c=await O_(n.localStore,e,!0),d=new tO(e,c.$s),f=d.tu(c.documents),p=gu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),g=d.applyChanges(f,n.isPrimaryClient,p);H_(n,t,g.ou);const y=new nO(e,t,d);return n.hu.set(e,y),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),g.snapshot}async function lO(n,e,t){const i=De(n),o=i.hu.get(e),c=i.Pu.get(o.targetId);if(c.length>1)return i.Pu.set(o.targetId,c.filter(d=>!Jh(d,e))),void i.hu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await yg(i.localStore,o.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(o.targetId),t&&lv(i.remoteStore,o.targetId),Ng(i,o.targetId)}).catch(dl)):(Ng(i,o.targetId),await yg(i.localStore,o.targetId,!0))}async function cO(n,e){const t=De(n),i=t.hu.get(e),o=t.Pu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),lv(t.remoteStore,i.targetId))}async function uO(n,e,t){const i=vO(n);try{const o=await function(d,f){const p=De(d),g=qt.now(),y=f.reduce((A,N)=>A.add(N.key),Ye());let x,_;return p.persistence.runTransaction("Locally write mutations","readwrite",A=>{let N=Oa(),C=Ye();return p.Bs.getEntries(A,y).next(T=>{N=T,N.forEach((M,q)=>{q.isValidDocument()||(C=C.add(M))})}).next(()=>p.localDocuments.getOverlayedDocuments(A,N)).next(T=>{x=T;const M=[];for(const q of f){const U=CD(q,x.get(q.key).overlayedDocument);U!=null&&M.push(new Ui(q.key,U,a0(U.value.mapValue),rn.exists(!0)))}return p.mutationQueue.addMutationBatch(A,g,M,f)}).next(T=>{_=T;const M=T.applyToLocalDocumentSet(x,C);return p.documentOverlayCache.saveOverlays(A,T.batchId,M)})}).then(()=>({batchId:_.batchId,changes:p0(x)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),function(d,f,p){let g=d.Au[d.currentUser.toKey()];g||(g=new _t(qe)),g=g.insert(f,p),d.Au[d.currentUser.toKey()]=g}(i,o.batchId,t),await yu(i,o.changes),await lf(i.remoteStore)}catch(o){const c=fv(o,"Failed to persist write");t.reject(c)}}async function W0(n,e){const t=De(n);try{const i=await EM(t.localStore,e);e.targetChanges.forEach((o,c)=>{const d=t.Eu.get(c);d&&(Ze(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.cu=!0:o.modifiedDocuments.size>0?Ze(d.cu,14607):o.removedDocuments.size>0&&(Ze(d.cu,42227),d.cu=!1))}),await yu(t,i,e)}catch(i){await dl(i)}}function B_(n,e,t){const i=De(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.hu.forEach((c,d)=>{const f=d.view.Fa(e);f.snapshot&&o.push(f.snapshot)}),function(d,f){const p=De(d);p.onlineState=f;let g=!1;p.queries.forEach((y,x)=>{for(const _ of x.Sa)_.Fa(f)&&(g=!0)}),g&&gv(p)}(i.eventManager,e),o.length&&i.lu.Y_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function dO(n,e,t){const i=De(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Eu.get(e),c=o&&o.key;if(c){let d=new _t(Ne.comparator);d=d.insert(c,Wt.newNoDocument(c,we.min()));const f=Ye().add(c),p=new af(we.min(),new Map,new _t(qe),d,f);await W0(i,p),i.Iu=i.Iu.remove(c),i.Eu.delete(e),bv(i)}else await yg(i.localStore,e,!1).then(()=>Ng(i,e,t)).catch(dl)}async function hO(n,e){const t=De(n),i=e.batch.batchId;try{const o=await _M(t.localStore,e);J0(t,i,null),Z0(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await yu(t,o)}catch(o){await dl(o)}}async function fO(n,e,t){const i=De(n);try{const o=await function(d,f){const p=De(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let y;return p.mutationQueue.lookupMutationBatch(g,f).next(x=>(Ze(x!==null,37113),y=x.keys(),p.mutationQueue.removeMutationBatch(g,x))).next(()=>p.mutationQueue.performConsistencyCheck(g)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(g,y,f)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,y)).next(()=>p.localDocuments.getDocuments(g,y))})}(i.localStore,e);J0(i,e,t),Z0(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await yu(i,o)}catch(o){await dl(o)}}function Z0(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function J0(n,e,t){const i=De(n);let o=i.Au[i.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),i.Au[i.currentUser.toKey()]=o}}function Ng(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Pu.get(e))n.hu.delete(i),t&&n.lu.gu(i,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(i=>{n.du.containsKey(i)||ej(n,i)})}function ej(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(lv(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),bv(n))}function H_(n,e,t){for(const i of t)i instanceof Q0?(n.du.addReference(i.key,e),mO(n,i)):i instanceof K0?(ve(yv,"Document no longer in limbo: "+i.key),n.du.removeReference(i.key,e),n.du.containsKey(i.key)||ej(n,i.key)):Ee(19791,{pu:i})}function mO(n,e){const t=e.key,i=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(i)||(ve(yv,"New document in limbo: "+t),n.Tu.add(i),bv(n))}function bv(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new Ne(ht.fromString(e)),i=n.Vu.next();n.Eu.set(i,new sO(t)),n.Iu=n.Iu.insert(t,i),z0(n.remoteStore,new yi(Ks(Zh(t.path)),i,"TargetPurposeLimboResolution",Xh.le))}}async function yu(n,e,t){const i=De(n),o=[],c=[],d=[];i.hu.isEmpty()||(i.hu.forEach((f,p)=>{d.push(i.fu(p,e,t).then(g=>{var y;if((g||t)&&i.isPrimaryClient){const x=g?!g.fromCache:(y=t?.targetChanges.get(p.targetId))===null||y===void 0?void 0:y.current;i.sharedClientState.updateQueryState(p.targetId,x?"current":"not-current")}if(g){o.push(g);const x=iv.Rs(p.targetId,g);c.push(x)}}))}),await Promise.all(d),i.lu.Y_(o),await async function(p,g){const y=De(p);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",x=>oe.forEach(g,_=>oe.forEach(_.ds,A=>y.persistence.referenceDelegate.addReference(x,_.targetId,A)).next(()=>oe.forEach(_.As,A=>y.persistence.referenceDelegate.removeReference(x,_.targetId,A)))))}catch(x){if(!hl(x))throw x;ve(rv,"Failed to update sequence numbers: "+x)}for(const x of g){const _=x.targetId;if(!x.fromCache){const A=y.xs.get(_),N=A.snapshotVersion,C=A.withLastLimboFreeSnapshotVersion(N);y.xs=y.xs.insert(_,C)}}}(i.localStore,c))}async function pO(n,e){const t=De(n);if(!t.currentUser.isEqual(e)){ve(yv,"User change. New user:",e.toKey());const i=await U0(t.localStore,e);t.currentUser=e,function(c,d){c.Ru.forEach(f=>{f.forEach(p=>{p.reject(new ge(ie.CANCELLED,d))})}),c.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await yu(t,i.ks)}}function gO(n,e){const t=De(n),i=t.Eu.get(e);if(i&&i.cu)return Ye().add(i.key);{let o=Ye();const c=t.Pu.get(e);if(!c)return o;for(const d of c){const f=t.hu.get(d);o=o.unionWith(f.view.eu)}return o}}function tj(n){const e=De(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=W0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dO.bind(null,e),e.lu.Y_=JM.bind(null,e.eventManager),e.lu.gu=eO.bind(null,e.eventManager),e}function vO(n){const e=De(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fO.bind(null,e),e}class kh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rf(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return NM(this.persistence,new yM,e.initialUser,this.serializer)}Su(e){return new V0(av.fi,this.serializer)}bu(e){return new CM}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}kh.provider={build:()=>new kh};class yO extends kh{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Ze(this.persistence.referenceDelegate instanceof Mh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new sM(i,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?Sn.withCacheSize(this.cacheSizeBytes):Sn.DEFAULT;return new V0(i=>Mh.fi(i,t),this.serializer)}}class _g{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>B_(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=pO.bind(null,this.syncEngine),await XM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ZM}()}createDatastore(e){const t=rf(e.databaseInfo.databaseId),i=function(c){return new MM(c)}(e.databaseInfo);return function(c,d,f,p){return new LM(c,d,f,p)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,o,c,d,f){return new UM(i,o,c,d,f)}(this.localStore,this.datastore,e.asyncQueue,t=>B_(this.syncEngine,t,0),function(){return L_.C()?new L_:new SM}())}createSyncEngine(e,t){return function(o,c,d,f,p,g,y){const x=new aO(o,c,d,f,p,g);return y&&(x.mu=!0),x}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const c=De(o);ve(Mr,"RemoteStore shutting down."),c.da.add(5),await vu(c),c.Ra.shutdown(),c.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}_g.provider={build:()=>new _g};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Ma("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ge(ie.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,c){const d=De(o),f={documents:c.map(x=>Dh(d.serializer,x))},p=await d.Yo("BatchGetDocuments",d.serializer.databaseId,ht.emptyPath(),f,c.length),g=new Map;p.forEach(x=>{const _=FD(d.serializer,x);g.set(_.key.toString(),_)});const y=[];return c.forEach(x=>{const _=g.get(x.toString());Ze(!!_,55234,{key:x}),y.push(_)}),y}(this.datastore,e);return t.forEach(i=>this.recordVersion(i)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new sf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,i)=>{const o=Ne.fromPath(i);this.mutations.push(new T0(o,this.precondition(o)))}),await async function(i,o){const c=De(i),d={writes:o.map(f=>M0(c.serializer,f))};await c.zo("Commit",c.serializer.databaseId,ht.emptyPath(),d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ee(50498,{Uu:e.constructor.name});t=we.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new ge(ie.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(we.min())?rn.exists(!1):rn.updateTime(t):rn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(we.min()))throw new ge(ie.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rn.updateTime(t)}return rn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(e,t,i,o,c){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=o,this.deferred=c,this.Ku=i.maxAttempts,this.x_=new ov(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new bO(this.datastore),t=this.zu(e);t&&t.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(o=>{this.ju(o)}))}).catch(i=>{this.ju(i)})})}zu(e){try{const t=this.updateFunction(e);return!mu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!j0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii="FirestoreClient";class NO{constructor(e,t,i,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=fn.UNAUTHENTICATED,this.clientId=QT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(i,async d=>{ve(Ii,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(i,d=>(ve(Ii,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=fv(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function Fp(n,e){n.asyncQueue.verifyOperationInProgress(),ve(Ii,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async o=>{i.isEqual(o)||(await U0(e.localStore,o),i=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function G_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await _O(n);ve(Ii,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>U_(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,o)=>U_(e.remoteStore,o)),n._onlineComponents=e}async function _O(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ve(Ii,"Using user provided OfflineComponentProvider");try{await Fp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===ie.FAILED_PRECONDITION||o.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Zo("Error using user provided cache. Falling back to memory cache: "+t),await Fp(n,new kh)}}else ve(Ii,"Using default OfflineComponentProvider"),await Fp(n,new yO(void 0));return n._offlineComponents}async function Nv(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ve(Ii,"Using user provided OnlineComponentProvider"),await G_(n,n._uninitializedComponentsProvider._online)):(ve(Ii,"Using default OnlineComponentProvider"),await G_(n,new _g))),n._onlineComponents}function EO(n){return Nv(n).then(e=>e.syncEngine)}function TO(n){return Nv(n).then(e=>e.datastore)}async function Ph(n){const e=await Nv(n),t=e.eventManager;return t.onListen=iO.bind(null,e.syncEngine),t.onUnlisten=lO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=rO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=cO.bind(null,e.syncEngine),t}function jO(n,e,t={}){const i=new Qs;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,g){const y=new xv({next:_=>{y.xu(),d.enqueueAndForget(()=>pv(c,x));const A=_.docs.has(f);!A&&_.fromCache?g.reject(new ge(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&_.fromCache&&p&&p.source==="server"?g.reject(new ge(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(_)},error:_=>g.reject(_)}),x=new vv(Zh(f.path),y,{includeMetadataChanges:!0,Qa:!0});return mv(c,x)}(await Ph(n),n.asyncQueue,e,t,i)),i.promise}function AO(n,e,t={}){const i=new Qs;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,g){const y=new xv({next:_=>{y.xu(),d.enqueueAndForget(()=>pv(c,x)),_.fromCache&&p.source==="server"?g.reject(new ge(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(_)},error:_=>g.reject(_)}),x=new vv(f,y,{includeMetadataChanges:!0,Qa:!0});return mv(c,x)}(await Ph(n),n.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nj(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sj(n,e,t){if(!t)throw new ge(ie.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function wO(n,e,t,i){if(e===!0&&i===!0)throw new ge(ie.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Y_(n){if(!Ne.isDocumentKey(n))throw new ge(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Q_(n){if(Ne.isDocumentKey(n))throw new ge(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function cf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ee(12329,{type:typeof n})}function Tn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ge(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=cf(n);throw new ge(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aj="firestore.googleapis.com",K_=!0;class X_{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new ge(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=aj,this.ssl=K_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:K_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=L0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<tM)throw new ge(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}wO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nj((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new ge(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new ge(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new ge(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,o){return i.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class uf{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new X_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ge(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ge(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new X_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new M1;switch(i.type){case"firstParty":return new L1(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ge(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=$_.get(t);i&&(ve("ComponentProvider","Removing Datastore"),$_.delete(t),i.terminate())}(this),Promise.resolve()}}function CO(n,e,t,i={}){var o;n=Tn(n,uf);const c=Lr(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),p=`${e}:${t}`;c&&(Rg(`https://${p}`),Dg("Firestore",!0)),d.host!==aj&&d.host!==p&&Zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g=Object.assign(Object.assign({},d),{host:p,ssl:c,emulatorOptions:i});if(!Ti(g,f)&&(n._setSettings(g),i.mockUserToken)){let y,x;if(typeof i.mockUserToken=="string")y=i.mockUserToken,x=fn.MOCK_USER;else{y=JE(i.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const _=i.mockUserToken.sub||i.mockUserToken.user_id;if(!_)throw new ge(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new fn(_)}n._authCredentials=new O1(new $T(y,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Pa(this.firestore,e,this._query)}}class on{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _i(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new on(this.firestore,e,this._key)}}class _i extends Pa{constructor(e,t,i){super(e,t,Zh(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new on(this.firestore,null,new Ne(e))}withConverter(e){return new _i(this.firestore,e,this._path)}}function Me(n,e,...t){if(n=yt(n),sj("collection","path",e),n instanceof uf){const i=ht.fromString(e,...t);return Q_(i),new _i(n,null,i)}{if(!(n instanceof on||n instanceof _i))throw new ge(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ht.fromString(e,...t));return Q_(i),new _i(n.firestore,null,i)}}function Je(n,e,...t){if(n=yt(n),arguments.length===1&&(e=QT.newId()),sj("doc","path",e),n instanceof uf){const i=ht.fromString(e,...t);return Y_(i),new on(n,null,new Ne(i))}{if(!(n instanceof on||n instanceof _i))throw new ge(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ht.fromString(e,...t));return Y_(i),new on(n.firestore,n instanceof _i?n.converter:null,new Ne(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W_="AsyncQueue";class Z_{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new ov(this,"async_queue_retry"),this.rc=()=>{const i=Up();i&&ve(W_,"Visibility state changed to "+i.visibilityState),this.x_.b_()},this.sc=e;const t=Up();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Up();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Qs;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!hl(e))throw e;ve(W_,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(i=>{throw this.Xu=i,this.ec=!1,Ma("INTERNAL UNHANDLED ERROR: ",J_(i)),i}).then(i=>(this.ec=!1,i))));return this.sc=t,t}enqueueAfterDelay(e,t,i){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=hv.createAndSchedule(this,e,t,i,c=>this.uc(c));return this.Zu.push(o),o}oc(){this.Xu&&Ee(47125,{cc:J_(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function J_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eE(n){return function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of i)if(c in o&&typeof o[c]=="function")return!0;return!1}(n,["next","error","complete"])}class Ws extends uf{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new Z_,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Z_(e),this._firestoreClient=void 0,await e}}}function SO(n,e){const t=typeof n=="object"?n:cu(),i=typeof n=="string"?n:Ah,o=ka(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const c=XE("firestore");c&&CO(o,...c)}return o}function bu(n){if(n._terminated)throw new ge(ie.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||IO(n),n._firestoreClient}function IO(n){var e,t,i;const o=n._freezeSettings(),c=function(f,p,g,y){return new Z1(f,p,g,y.host,y.ssl,y.experimentalForceLongPolling,y.experimentalAutoDetectLongPolling,nj(y.experimentalLongPollingOptions),y.useFetchStreams,y.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=o.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new NO(n._authCredentials,n._appCheckCredentials,n._queue,c,n._componentsProvider&&function(f){const p=f?._online.build();return{_offline:f?._offline.build(p),_online:p}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Or(ln.fromBase64String(e))}catch(t){throw new ge(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Or(ln.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ge(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new an(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ge(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ge(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,o){if(i.length!==o.length)return!1;for(let c=0;c<i.length;++c)if(i[c]!==o[c])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RO=/^__.*__$/;class DO{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Ui(e,this.data,this.fieldMask,t,this.fieldTransforms):new pu(e,this.data,t,this.fieldTransforms)}}class ij{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Ui(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function rj(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ee(40011,{Ic:n})}}class Tv{constructor(e,t,i,o,c,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,c===void 0&&this.Ec(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Tv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:i,Rc:!1});return o.Vc(e),o}mc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:i,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Lh(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(rj(this.Ic)&&RO.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class MO{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||rf(e)}bc(e,t,i,o=!1){return new Tv({Ic:e,methodName:t,wc:i,path:an.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Nu(n){const e=n._freezeSettings(),t=rf(n._databaseId);return new MO(n._databaseId,!!e.ignoreUndefinedProperties,t)}function jv(n,e,t,i,o,c={}){const d=n.bc(c.merge||c.mergeFields?2:0,e,t,o);wv("Data must be an object, but it was:",d,i);const f=cj(i,d);let p,g;if(c.merge)p=new zn(d.fieldMask),g=d.fieldTransforms;else if(c.mergeFields){const y=[];for(const x of c.mergeFields){const _=Eg(e,x,t);if(!d.contains(_))throw new ge(ie.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);dj(y,_)||y.push(_)}p=new zn(y),g=d.fieldTransforms.filter(x=>p.covers(x.field))}else p=null,g=d.fieldTransforms;return new DO(new En(f),p,g)}class hf extends df{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof hf}}class Av extends df{_toFieldTransform(e){return new TD(e.path,new eu)}isEqual(e){return e instanceof Av}}function oj(n,e,t,i){const o=n.bc(1,e,t);wv("Data must be an object, but it was:",o,i);const c=[],d=En.empty();Vi(i,(p,g)=>{const y=Cv(e,p,t);g=yt(g);const x=o.mc(y);if(g instanceof hf)c.push(y);else{const _=_u(g,x);_!=null&&(c.push(y),d.set(y,_))}});const f=new zn(c);return new ij(d,f,o.fieldTransforms)}function lj(n,e,t,i,o,c){const d=n.bc(1,e,t),f=[Eg(e,i,t)],p=[o];if(c.length%2!=0)throw new ge(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<c.length;_+=2)f.push(Eg(e,c[_])),p.push(c[_+1]);const g=[],y=En.empty();for(let _=f.length-1;_>=0;--_)if(!dj(g,f[_])){const A=f[_];let N=p[_];N=yt(N);const C=d.mc(A);if(N instanceof hf)g.push(A);else{const T=_u(N,C);T!=null&&(g.push(A),y.set(A,T))}}const x=new zn(g);return new ij(y,x,d.fieldTransforms)}function OO(n,e,t,i=!1){return _u(t,n.bc(i?4:3,e))}function _u(n,e){if(uj(n=yt(n)))return wv("Unsupported field value:",e,n),cj(n,e);if(n instanceof df)return function(i,o){if(!rj(o.Ic))throw o.gc(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${i._methodName}() is not currently supported inside arrays`);const c=i._toFieldTransform(o);c&&o.fieldTransforms.push(c)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(i,o){const c=[];let d=0;for(const f of i){let p=_u(f,o.fc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}}(n,e)}return function(i,o){if((i=yt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return ND(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const c=qt.fromDate(i);return{timestampValue:Rh(o.serializer,c)}}if(i instanceof qt){const c=new qt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Rh(o.serializer,c)}}if(i instanceof _v)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Or)return{bytesValue:S0(o.serializer,i._byteString)};if(i instanceof on){const c=o.databaseId,d=i.firestore._databaseId;if(!d.isEqual(c))throw o.gc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:nv(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof Ev)return function(d,f){return{mapValue:{fields:{[n0]:{stringValue:s0},[wh]:{arrayValue:{values:d.toArray().map(g=>{if(typeof g!="number")throw f.gc("VectorValues must only contain numeric values.");return Jg(f.serializer,g)})}}}}}}(i,o);throw o.gc(`Unsupported field value: ${cf(i)}`)}(n,e)}function cj(n,e){const t={};return XT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vi(n,(i,o)=>{const c=_u(o,e.Ac(i));c!=null&&(t[i]=c)}),{mapValue:{fields:t}}}function uj(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qt||n instanceof _v||n instanceof Or||n instanceof on||n instanceof df||n instanceof Ev)}function wv(n,e,t){if(!uj(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const i=cf(t);throw i==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+i)}}function Eg(n,e,t){if((e=yt(e))instanceof xu)return e._internalPath;if(typeof e=="string")return Cv(n,e);throw Lh("Field path arguments must be of type string or ",n,!1,void 0,t)}const kO=new RegExp("[~\\*/\\[\\]]");function Cv(n,e,t){if(e.search(kO)>=0)throw Lh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new xu(...e.split("."))._internalPath}catch{throw Lh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Lh(n,e,t,i,o){const c=i&&!i.isEmpty(),d=o!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${i}`),d&&(p+=` in document ${o}`),p+=")"),new ge(ie.INVALID_ARGUMENT,f+n+p)}function dj(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,t,i,o,c){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new on(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new PO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ff("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class PO extends Vh{data(){return super.data()}}function ff(n,e){return typeof e=="string"?Cv(n,e):e instanceof xu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hj(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ge(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Sv{}class Iv extends Sv{}function Te(n,e,...t){let i=[];e instanceof Sv&&i.push(e),i=i.concat(t),function(c){const d=c.filter(p=>p instanceof Rv).length,f=c.filter(p=>p instanceof mf).length;if(d>1||d>0&&f>0)throw new ge(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const o of i)n=o._apply(n);return n}class mf extends Iv{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new mf(e,t,i)}_apply(e){const t=this._parse(e);return fj(e._query,t),new Pa(e.firestore,e.converter,mg(e._query,t))}_parse(e){const t=Nu(e.firestore);return function(c,d,f,p,g,y,x){let _;if(g.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new ge(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){nE(x,y);const N=[];for(const C of x)N.push(tE(p,c,C));_={arrayValue:{values:N}}}else _=tE(p,c,x)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||nE(x,y),_=OO(f,d,x,y==="in"||y==="not-in");return kt.create(g,y,_)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ie(n,e,t){const i=e,o=ff("where",n);return mf._create(o,i,t)}class Rv extends Sv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Rv(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Ts.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,c){let d=o;const f=c.getFlattenedFilters();for(const p of f)fj(d,p),d=mg(d,p)}(e._query,t),new Pa(e.firestore,e.converter,mg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Dv extends Iv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Dv(e,t)}_apply(e){const t=function(o,c,d){if(o.startAt!==null)throw new ge(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new ge(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jc(c,d)}(e._query,this._field,this._direction);return new Pa(e.firestore,e.converter,function(o,c){const d=o.explicitOrderBy.concat([c]);return new fl(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function jn(n,e="asc"){const t=e,i=ff("orderBy",n);return Dv._create(i,t)}class Mv extends Iv{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new Mv(e,t,i)}_apply(e){return new Pa(e.firestore,e.converter,Sh(e._query,this._limit,this._limitType))}}function LO(n){return Mv._create("limit",n,"F")}function tE(n,e,t){if(typeof(t=yt(t))=="string"){if(t==="")throw new ge(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!d0(e)&&t.indexOf("/")!==-1)throw new ge(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(ht.fromString(t));if(!Ne.isDocumentKey(i))throw new ge(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return p_(n,new Ne(i))}if(t instanceof on)return p_(n,t._key);throw new ge(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cf(t)}.`)}function nE(n,e){if(!Array.isArray(n)||n.length===0)throw new ge(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function fj(n,e){const t=function(o,c){for(const d of o)for(const f of d.getFlattenedFilters())if(c.indexOf(f.op)>=0)return f.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ge(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ge(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class mj{convertValue(e,t="none"){switch(Ci(e)){case 0:return null;case 1:return e.booleanValue;case 2:return St(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(wi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ee(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Vi(e,(o,c)=>{i[o]=this.convertValue(c,t)}),i}convertVectorValue(e){var t,i,o;const c=(o=(i=(t=e.fields)===null||t===void 0?void 0:t[wh].arrayValue)===null||i===void 0?void 0:i.values)===null||o===void 0?void 0:o.map(d=>St(d.doubleValue));return new Ev(c)}convertGeoPoint(e){return new _v(St(e.latitude),St(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Wh(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Xc(e));default:return null}}convertTimestamp(e){const t=Ai(e);return new qt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=ht.fromString(e);Ze(P0(i),9688,{name:e});const o=new Wc(i.get(1),i.get(3)),c=new Ne(i.popFirst(5));return o.isEqual(t)||Ma(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ov(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class VO extends mj{constructor(e){super(),this.firestore=e}convertBytes(e){return new Or(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class kv extends Vh{constructor(e,t,i,o,c,d){super(e,t,i,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new mh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(ff("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class mh extends kv{data(e={}){return super.data(e)}}class pj{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new zo(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new mh(this._firestore,this._userDataWriter,i.key,i,new zo(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ge(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map(f=>{const p=new mh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new zo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}})}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(f=>c||f.type!==3).map(f=>{const p=new mh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new zo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,y=-1;return f.type!==0&&(g=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),y=d.indexOf(f.doc.key)),{type:UO(f.type),doc:p,oldIndex:g,newIndex:y}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function UO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ee(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(n){n=Tn(n,on);const e=Tn(n.firestore,Ws);return jO(bu(e),n._key).then(t=>gj(e,n,t))}class pf extends mj{constructor(e){super(),this.firestore=e}convertBytes(e){return new Or(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}function ft(n){n=Tn(n,Pa);const e=Tn(n.firestore,Ws),t=bu(e),i=new pf(e);return hj(n._query),AO(t,n._query).then(o=>new pj(e,i,n,o))}function gf(n,e,t){n=Tn(n,on);const i=Tn(n.firestore,Ws),o=Ov(n.converter,e,t);return yf(i,[jv(Nu(i),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,rn.none())])}function js(n,e,t,...i){n=Tn(n,on);const o=Tn(n.firestore,Ws),c=Nu(o);let d;return d=typeof(e=yt(e))=="string"||e instanceof xu?lj(c,"updateDoc",n._key,e,t,i):oj(c,"updateDoc",n._key,e),yf(o,[d.toMutation(n._key,rn.exists(!0))])}function vf(n){return yf(Tn(n.firestore,Ws),[new sf(n._key,rn.none())])}function pl(n,e){const t=Tn(n.firestore,Ws),i=Je(n),o=Ov(n.converter,e);return yf(t,[jv(Nu(n.firestore),"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,rn.exists(!1))]).then(()=>i)}function qr(n,...e){var t,i,o;n=yt(n);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||eE(e[d])||(c=e[d],d++);const f={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(eE(e[d])){const x=e[d];e[d]=(t=x.next)===null||t===void 0?void 0:t.bind(x),e[d+1]=(i=x.error)===null||i===void 0?void 0:i.bind(x),e[d+2]=(o=x.complete)===null||o===void 0?void 0:o.bind(x)}let p,g,y;if(n instanceof on)g=Tn(n.firestore,Ws),y=Zh(n._key.path),p={next:x=>{e[d]&&e[d](gj(g,n,x))},error:e[d+1],complete:e[d+2]};else{const x=Tn(n,Pa);g=Tn(x.firestore,Ws),y=x._query;const _=new pf(g);p={next:A=>{e[d]&&e[d](new pj(g,_,x,A))},error:e[d+1],complete:e[d+2]},hj(n._query)}return function(_,A,N,C){const T=new xv(C),M=new vv(A,T,N);return _.asyncQueue.enqueueAndForget(async()=>mv(await Ph(_),M)),()=>{T.xu(),_.asyncQueue.enqueueAndForget(async()=>pv(await Ph(_),M))}}(bu(g),y,f,p)}function yf(n,e){return function(i,o){const c=new Qs;return i.asyncQueue.enqueueAndForget(async()=>uO(await EO(i),o,c)),c.promise}(bu(n),e)}function gj(n,e,t){const i=t.docs.get(e._key),o=new pf(n);return new kv(n,o,e._key,i,new zo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FO={maxAttempts:5};function Mc(n,e){if((n=yt(n)).firestore!==e)throw new ge(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Nu(e)}get(e){const t=Mc(e,this._firestore),i=new VO(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return Ee(24041);const c=o[0];if(c.isFoundDocument())return new Vh(this._firestore,i,c.key,c,t.converter);if(c.isNoDocument())return new Vh(this._firestore,i,t._key,null,t.converter);throw Ee(18433,{doc:c})})}set(e,t,i){const o=Mc(e,this._firestore),c=Ov(o.converter,t,i),d=jv(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,i);return this._transaction.set(o._key,d),this}update(e,t,i,...o){const c=Mc(e,this._firestore);let d;return d=typeof(t=yt(t))=="string"||t instanceof xu?lj(this._dataReader,"Transaction.update",c._key,t,i,o):oj(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,d),this}delete(e){const t=Mc(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO extends qO{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Mc(e,this._firestore),i=new pf(this._firestore);return super.get(e).then(o=>new kv(this._firestore,i,t._key,o._document,new zo(!1,!1),t.converter))}}function Pv(n,e,t){n=Tn(n,Ws);const i=Object.assign(Object.assign({},FO),t);return function(c){if(c.maxAttempts<1)throw new ge(ie.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(c,d,f){const p=new Qs;return c.asyncQueue.enqueueAndForget(async()=>{const g=await TO(c);new xO(c.asyncQueue,g,f,d,p).Wu()}),p.promise}(bu(n),o=>e(new zO(n,o)),i)}function Ue(){return new Av("serverTimestamp")}(function(e,t=!0){(function(o){ul=o})(Vr),ls(new $n("firestore",(i,{instanceIdentifier:o,options:c})=>{const d=i.getProvider("app").getImmediate(),f=new Ws(new k1(i.getProvider("auth-internal")),new V1(d,i.getProvider("app-check-internal")),function(g,y){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new ge(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wc(g.options.projectId,y)}(d,o),d);return c=Object.assign({useFetchStreams:t},c),f._setSettings(c),f},"PUBLIC").setMultipleInstances(!0)),pn(s_,a_,e),pn(s_,a_,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj="firebasestorage.googleapis.com",BO="storageBucket",HO=2*60*1e3,GO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js extends us{constructor(e,t,i=0){super(qp(e),`Firebase Storage: ${t} (${qp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Js.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Zs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Zs||(Zs={}));function qp(n){return"storage/"+n}function $O(){const n="An unknown error occurred, please check the error payload for server response.";return new Js(Zs.UNKNOWN,n)}function YO(){return new Js(Zs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function QO(){return new Js(Zs.CANCELED,"User canceled the upload/download.")}function KO(n){return new Js(Zs.INVALID_URL,"Invalid URL '"+n+"'.")}function XO(n){return new Js(Zs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function sE(n){return new Js(Zs.INVALID_ARGUMENT,n)}function yj(){return new Js(Zs.APP_DELETED,"The Firebase app was deleted.")}function WO(n){return new Js(Zs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=_s.makeFromUrl(e,t)}catch{return new _s(e,"")}if(i.path==="")return i;throw XO(e)}static makeFromUrl(e,t){let i=null;const o="([A-Za-z0-9.\\-_]+)";function c(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const d="(/(.*))?$",f=new RegExp("^gs://"+o+d,"i"),p={bucket:1,path:3};function g(P){P.path_=decodeURIComponent(P.path)}const y="v[A-Za-z0-9_]+",x=t.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",A=new RegExp(`^https?://${x}/${y}/b/${o}/o${_}`,"i"),N={bucket:1,path:3},C=t===vj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",M=new RegExp(`^https?://${C}/${o}/${T}`,"i"),U=[{regex:f,indices:p,postModify:c},{regex:A,indices:N,postModify:g},{regex:M,indices:{bucket:1,path:2},postModify:g}];for(let P=0;P<U.length;P++){const F=U[P],G=F.regex.exec(e);if(G){const V=G[F.indices.bucket];let S=G[F.indices.path];S||(S=""),i=new _s(V,S),F.postModify(i);break}}if(i==null)throw KO(e);return i}}class ZO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JO(n,e,t){let i=1,o=null,c=null,d=!1,f=0;function p(){return f===2}let g=!1;function y(...T){g||(g=!0,e.apply(null,T))}function x(T){o=setTimeout(()=>{o=null,n(A,p())},T)}function _(){c&&clearTimeout(c)}function A(T,...M){if(g){_();return}if(T){_(),y.call(null,T,...M);return}if(p()||d){_(),y.call(null,T,...M);return}i<64&&(i*=2);let U;f===1?(f=2,U=0):U=(i+Math.random())*1e3,x(U)}let N=!1;function C(T){N||(N=!0,_(),!g&&(o!==null?(T||(f=2),clearTimeout(o),x(0)):T||(f=1)))}return x(0),c=setTimeout(()=>{d=!0,C(!0)},t),C}function ek(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tk(n){return n!==void 0}function aE(n,e,t,i){if(i<e)throw sE(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw sE(`Invalid value for '${n}'. Expected ${t} or less.`)}function nk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const o=e(i)+"="+e(n[i]);t=t+o+"&"}return t=t.slice(0,-1),t}var Uh;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Uh||(Uh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sk(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,t,i,o,c,d,f,p,g,y,x,_=!0,A=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=f,this.errorCallback_=p,this.timeout_=g,this.progressCallback_=y,this.connectionFactory_=x,this.retry=_,this.isUsingEmulator=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,C)=>{this.resolve_=N,this.reject_=C,this.start_()})}start_(){const e=(i,o)=>{if(o){i(!1,new nh(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=f=>{const p=f.loaded,g=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,g)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const f=c.getErrorCode()===Uh.NO_ERROR,p=c.getStatus();if(!f||sk(p,this.additionalRetryCodes_)&&this.retry){const y=c.getErrorCode()===Uh.ABORT;i(!1,new nh(!1,null,y));return}const g=this.successCodes_.indexOf(p)!==-1;i(!0,new nh(g,c))})},t=(i,o)=>{const c=this.resolve_,d=this.reject_,f=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(f,f.getResponse());tk(p)?c(p):c()}catch(p){d(p)}else if(f!==null){const p=$O();p.serverResponse=f.getErrorText(),this.errorCallback_?d(this.errorCallback_(f,p)):d(p)}else if(o.canceled){const p=this.appDelete_?yj():QO();d(p)}else{const p=YO();d(p)}};this.canceled_?t(!1,new nh(!1,null,!0)):this.backoffId_=JO(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&ek(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class nh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function ik(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function rk(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function ok(n,e){e&&(n["X-Firebase-GMPID"]=e)}function lk(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function ck(n,e,t,i,o,c,d=!0,f=!1){const p=nk(n.urlParams),g=n.url+p,y=Object.assign({},n.headers);return ok(y,e),ik(y,t),rk(y,c),lk(y,i),new ak(g,n.method,y,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,f)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uk(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function dk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,t){this._service=e,t instanceof _s?this._location=t:this._location=_s.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Fh(e,t)}get root(){const e=new _s(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return dk(this._location.path)}get storage(){return this._service}get parent(){const e=uk(this._location.path);if(e===null)return null;const t=new _s(this._location.bucket,e);return new Fh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw WO(e)}}function iE(n,e){const t=e?.[BO];return t==null?null:_s.makeFromBucketSpec(t,n)}function hk(n,e,t,i={}){n.host=`${e}:${t}`;const o=Lr(e);o&&(Rg(`https://${n.host}/b`),Dg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=i;c&&(n._overrideAuthToken=typeof c=="string"?c:JE(c,n.app.options.projectId))}class fk{constructor(e,t,i,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=vj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=HO,this._maxUploadRetryTime=GO,this._requests=new Set,o!=null?this._bucket=_s.makeFromBucketSpec(o,this._host):this._bucket=iE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=_s.makeFromBucketSpec(this._url,e):this._bucket=iE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){aE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){aE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(In(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Fh(this,e)}_makeRequest(e,t,i,o,c=!0){if(this._deleted)return new ZO(yj());{const d=ck(e,this._appId,i,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,o).getPromise()}}const rE="@firebase/storage",oE="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bj="storage";function mk(n=cu(),e){n=yt(n);const i=ka(n,bj).getImmediate({identifier:e}),o=XE("storage");return o&&pk(i,...o),i}function pk(n,e,t,i={}){hk(n,e,t,i)}function gk(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new fk(t,i,o,e,Vr)}function vk(){ls(new $n(bj,gk,"PUBLIC").setMultipleInstances(!0)),pn(rE,oE,""),pn(rE,oE,"esm2017")}vk();const xj="@firebase/installations",Lv="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj=1e4,_j=`w:${Lv}`,Ej="FIS_v2",yk="https://firebaseinstallations.googleapis.com/v1",bk=60*60*1e3,xk="installations",Nk="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},kr=new Oi(xk,Nk,_k);function Tj(n){return n instanceof us&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jj({projectId:n}){return`${yk}/projects/${n}/installations`}function Aj(n){return{token:n.token,requestStatus:2,expiresIn:Tk(n.expiresIn),creationTime:Date.now()}}async function wj(n,e){const i=(await e.json()).error;return kr.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function Cj({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function Ek(n,{refreshToken:e}){const t=Cj(n);return t.append("Authorization",jk(e)),t}async function Sj(n){const e=await n();return e.status>=500&&e.status<600?n():e}function Tk(n){return Number(n.replace("s","000"))}function jk(n){return`${Ej} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ak({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=jj(n),o=Cj(n),c=e.getImmediate({optional:!0});if(c){const g=await c.getHeartbeatsHeader();g&&o.append("x-firebase-client",g)}const d={fid:t,authVersion:Ej,appId:n.appId,sdkVersion:_j},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await Sj(()=>fetch(i,f));if(p.ok){const g=await p.json();return{fid:g.fid||t,registrationStatus:2,refreshToken:g.refreshToken,authToken:Aj(g.authToken)}}else throw await wj("Create Installation",p)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ij(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck=/^[cdef][\w-]{21}$/,Tg="";function Sk(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=Ik(n);return Ck.test(t)?t:Tg}catch{return Tg}}function Ik(n){return wk(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj=new Map;function Dj(n,e){const t=bf(n);Mj(t,e),Rk(t,e)}function Mj(n,e){const t=Rj.get(n);if(t)for(const i of t)i(e)}function Rk(n,e){const t=Dk();t&&t.postMessage({key:n,fid:e}),Mk()}let Cr=null;function Dk(){return!Cr&&"BroadcastChannel"in self&&(Cr=new BroadcastChannel("[Firebase] FID Change"),Cr.onmessage=n=>{Mj(n.data.key,n.data.fid)}),Cr}function Mk(){Rj.size===0&&Cr&&(Cr.close(),Cr=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ok="firebase-installations-database",kk=1,Pr="firebase-installations-store";let zp=null;function Vv(){return zp||(zp=nT(Ok,kk,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Pr)}}})),zp}async function qh(n,e){const t=bf(n),o=(await Vv()).transaction(Pr,"readwrite"),c=o.objectStore(Pr),d=await c.get(t);return await c.put(e,t),await o.done,(!d||d.fid!==e.fid)&&Dj(n,e.fid),e}async function Oj(n){const e=bf(n),i=(await Vv()).transaction(Pr,"readwrite");await i.objectStore(Pr).delete(e),await i.done}async function xf(n,e){const t=bf(n),o=(await Vv()).transaction(Pr,"readwrite"),c=o.objectStore(Pr),d=await c.get(t),f=e(d);return f===void 0?await c.delete(t):await c.put(f,t),await o.done,f&&(!d||d.fid!==f.fid)&&Dj(n,f.fid),f}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uv(n){let e;const t=await xf(n.appConfig,i=>{const o=Pk(i),c=Lk(n,o);return e=c.registrationPromise,c.installationEntry});return t.fid===Tg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function Pk(n){const e=n||{fid:Sk(),registrationStatus:0};return kj(e)}function Lk(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject(kr.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=Vk(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Uk(n)}:{installationEntry:e}}async function Vk(n,e){try{const t=await Ak(n,e);return qh(n.appConfig,t)}catch(t){throw Tj(t)&&t.customData.serverCode===409?await Oj(n.appConfig):await qh(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Uk(n){let e=await lE(n.appConfig);for(;e.registrationStatus===1;)await Ij(100),e=await lE(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await Uv(n);return i||t}return e}function lE(n){return xf(n,e=>{if(!e)throw kr.create("installation-not-found");return kj(e)})}function kj(n){return Fk(n)?{fid:n.fid,registrationStatus:0}:n}function Fk(n){return n.registrationStatus===1&&n.registrationTime+Nj<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qk({appConfig:n,heartbeatServiceProvider:e},t){const i=zk(n,t),o=Ek(n,t),c=e.getImmediate({optional:!0});if(c){const g=await c.getHeartbeatsHeader();g&&o.append("x-firebase-client",g)}const d={installation:{sdkVersion:_j,appId:n.appId}},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await Sj(()=>fetch(i,f));if(p.ok){const g=await p.json();return Aj(g)}else throw await wj("Generate Auth Token",p)}function zk(n,{fid:e}){return`${jj(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fv(n,e=!1){let t;const i=await xf(n.appConfig,c=>{if(!Pj(c))throw kr.create("not-registered");const d=c.authToken;if(!e&&Gk(d))return c;if(d.requestStatus===1)return t=Bk(n,e),c;{if(!navigator.onLine)throw kr.create("app-offline");const f=Yk(c);return t=Hk(n,f),f}});return t?await t:i.authToken}async function Bk(n,e){let t=await cE(n.appConfig);for(;t.authToken.requestStatus===1;)await Ij(100),t=await cE(n.appConfig);const i=t.authToken;return i.requestStatus===0?Fv(n,e):i}function cE(n){return xf(n,e=>{if(!Pj(e))throw kr.create("not-registered");const t=e.authToken;return Qk(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Hk(n,e){try{const t=await qk(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return await qh(n.appConfig,i),t}catch(t){if(Tj(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await Oj(n.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await qh(n.appConfig,i)}throw t}}function Pj(n){return n!==void 0&&n.registrationStatus===2}function Gk(n){return n.requestStatus===2&&!$k(n)}function $k(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+bk}function Yk(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function Qk(n){return n.requestStatus===1&&n.requestTime+Nj<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kk(n){const e=n,{installationEntry:t,registrationPromise:i}=await Uv(e);return i?i.catch(console.error):Fv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xk(n,e=!1){const t=n;return await Wk(t),(await Fv(t,e)).token}async function Wk(n){const{registrationPromise:e}=await Uv(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(n){if(!n||!n.options)throw Bp("App Configuration");if(!n.name)throw Bp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Bp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Bp(n){return kr.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lj="installations",Jk="installations-internal",eP=n=>{const e=n.getProvider("app").getImmediate(),t=Zk(e),i=ka(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},tP=n=>{const e=n.getProvider("app").getImmediate(),t=ka(e,Lj).getImmediate();return{getId:()=>Kk(t),getToken:o=>Xk(t,o)}};function nP(){ls(new $n(Lj,eP,"PUBLIC")),ls(new $n(Jk,tP,"PRIVATE"))}nP();pn(xj,Lv);pn(xj,Lv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh="analytics",sP="firebase_id",aP="origin",iP=60*1e3,rP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",qv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new lu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Gn=new Oi("analytics","Analytics",oP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lP(n){if(!n.startsWith(qv)){const e=Gn.create("invalid-gtag-resource",{gtagURL:n});return Rn.warn(e.message),""}return n}function Vj(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function cP(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function uP(n,e){const t=cP("firebase-js-sdk-policy",{createScriptURL:lP}),i=document.createElement("script"),o=`${qv}?l=${n}&id=${e}`;i.src=t?t?.createScriptURL(o):o,i.async=!0,document.head.appendChild(i)}function dP(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function hP(n,e,t,i,o,c){const d=i[o];try{if(d)await e[d];else{const p=(await Vj(t)).find(g=>g.measurementId===o);p&&await e[p.appId]}}catch(f){Rn.error(f)}n("config",o,c)}async function fP(n,e,t,i,o){try{let c=[];if(o&&o.send_to){let d=o.send_to;Array.isArray(d)||(d=[d]);const f=await Vj(t);for(const p of d){const g=f.find(x=>x.measurementId===p),y=g&&e[g.appId];if(y)c.push(y);else{c=[];break}}}c.length===0&&(c=Object.values(e)),await Promise.all(c),n("event",i,o||{})}catch(c){Rn.error(c)}}function mP(n,e,t,i){async function o(c,...d){try{if(c==="event"){const[f,p]=d;await fP(n,e,t,f,p)}else if(c==="config"){const[f,p]=d;await hP(n,e,t,i,f,p)}else if(c==="consent"){const[f,p]=d;n("consent",f,p)}else if(c==="get"){const[f,p,g]=d;n("get",f,p,g)}else if(c==="set"){const[f]=d;n("set",f)}else n(c,...d)}catch(f){Rn.error(f)}}return o}function pP(n,e,t,i,o){let c=function(...d){window[i].push(arguments)};return window[o]&&typeof window[o]=="function"&&(c=window[o]),window[o]=mP(c,n,e,t),{gtagCore:c,wrappedGtag:window[o]}}function gP(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(qv)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vP=30,yP=1e3;class bP{constructor(e={},t=yP){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Uj=new bP;function xP(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function NP(n){var e;const{appId:t,apiKey:i}=n,o={method:"GET",headers:xP(i)},c=rP.replace("{app-id}",t),d=await fetch(c,o);if(d.status!==200&&d.status!==304){let f="";try{const p=await d.json();!((e=p.error)===null||e===void 0)&&e.message&&(f=p.error.message)}catch{}throw Gn.create("config-fetch-failed",{httpStatus:d.status,responseMessage:f})}return d.json()}async function _P(n,e=Uj,t){const{appId:i,apiKey:o,measurementId:c}=n.options;if(!i)throw Gn.create("no-app-id");if(!o){if(c)return{measurementId:c,appId:i};throw Gn.create("no-api-key")}const d=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},f=new jP;return setTimeout(async()=>{f.abort()},iP),Fj({appId:i,apiKey:o,measurementId:c},d,f,e)}async function Fj(n,{throttleEndTimeMillis:e,backoffCount:t},i,o=Uj){var c;const{appId:d,measurementId:f}=n;try{await EP(i,e)}catch(p){if(f)return Rn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:d,measurementId:f};throw p}try{const p=await NP(n);return o.deleteThrottleMetadata(d),p}catch(p){const g=p;if(!TP(g)){if(o.deleteThrottleMetadata(d),f)return Rn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:d,measurementId:f};throw p}const y=Number((c=g?.customData)===null||c===void 0?void 0:c.httpStatus)===503?CN(t,o.intervalMillis,vP):CN(t,o.intervalMillis),x={throttleEndTimeMillis:Date.now()+y,backoffCount:t+1};return o.setThrottleMetadata(d,x),Rn.debug(`Calling attemptFetch again in ${y} millis`),Fj(n,x,i,o)}}function EP(n,e){return new Promise((t,i)=>{const o=Math.max(e-Date.now(),0),c=setTimeout(t,o);n.addEventListener(()=>{clearTimeout(c),i(Gn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function TP(n){if(!(n instanceof us)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class jP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function AP(n,e,t,i,o){if(o&&o.global){n("event",t,i);return}else{const c=await e,d=Object.assign(Object.assign({},i),{send_to:c});n("event",t,d)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wP(){if(Gh())try{await $h()}catch(n){return Rn.warn(Gn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Rn.warn(Gn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function CP(n,e,t,i,o,c,d){var f;const p=_P(n);p.then(A=>{t[A.measurementId]=A.appId,n.options.measurementId&&A.measurementId!==n.options.measurementId&&Rn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${A.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(A=>Rn.error(A)),e.push(p);const g=wP().then(A=>{if(A)return i.getId()}),[y,x]=await Promise.all([p,g]);gP(c)||uP(c,y.measurementId),o("js",new Date);const _=(f=d?.config)!==null&&f!==void 0?f:{};return _[aP]="firebase",_.update=!0,x!=null&&(_[sP]=x),o("config",y.measurementId,_),y.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e){this.app=e}_delete(){return delete qc[this.app.options.appId],Promise.resolve()}}let qc={},uE=[];const dE={};let Hp="dataLayer",IP="gtag",hE,qj,fE=!1;function RP(){const n=[];if(Mg()&&n.push("This is a browser extension environment."),Og()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,o)=>`(${o+1}) ${i}`).join(" "),t=Gn.create("invalid-analytics-context",{errorInfo:e});Rn.warn(t.message)}}function DP(n,e,t){RP();const i=n.options.appId;if(!i)throw Gn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Rn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Gn.create("no-api-key");if(qc[i]!=null)throw Gn.create("already-exists",{id:i});if(!fE){dP(Hp);const{wrappedGtag:c,gtagCore:d}=pP(qc,uE,dE,Hp,IP);qj=c,hE=d,fE=!0}return qc[i]=CP(n,uE,dE,e,hE,Hp,t),new SP(n)}function MP(n=cu()){n=yt(n);const e=ka(n,zh);return e.isInitialized()?e.getImmediate():OP(n)}function OP(n,e={}){const t=ka(n,zh);if(t.isInitialized()){const o=t.getImmediate();if(Ti(e,t.getOptions()))return o;throw Gn.create("already-initialized")}return t.initialize({options:e})}async function kP(){if(Mg()||!Og()||!Gh())return!1;try{return await $h()}catch{return!1}}function PP(n,e,t,i){n=yt(n),AP(qj,qc[n.app.options.appId],e,t,i).catch(o=>Rn.error(o))}const mE="@firebase/analytics",pE="0.10.16";function LP(){ls(new $n(zh,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return DP(i,o,t)},"PUBLIC")),ls(new $n("analytics-internal",n,"PRIVATE")),pn(mE,pE),pn(mE,pE,"esm2017");function n(e){try{const t=e.getProvider(zh).getImmediate();return{logEvent:(i,o,c)=>PP(t,i,o,c)}}catch(t){throw Gn.create("interop-component-reg-failed",{reason:t})}}}LP();var jg,gE,Nf=function(){var n=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(n&&n.responseStart>0&&n.responseStart<performance.now())return n},zj=function(n){if(document.readyState==="loading")return"loading";var e=Nf();if(e){if(n<e.domInteractive)return"loading";if(e.domContentLoadedEventStart===0||n<e.domContentLoadedEventStart)return"dom-interactive";if(e.domComplete===0||n<e.domComplete)return"dom-content-loaded"}return"complete"},VP=function(n){var e=n.nodeName;return n.nodeType===1?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},zv=function(n,e){var t="";try{for(;n&&n.nodeType!==9;){var i=n,o=i.id?"#"+i.id:VP(i)+(i.classList&&i.classList.value&&i.classList.value.trim()&&i.classList.value.trim().length?"."+i.classList.value.trim().replace(/\s+/g,"."):"");if(t.length+o.length>(e||100)-1)return t||o;if(t=t?o+">"+t:o,i.id)break;n=i.parentNode}}catch{}return t},Bj=-1,UP=function(){return Bj},Eu=function(n){addEventListener("pageshow",function(e){e.persisted&&(Bj=e.timeStamp,n(e))},!0)},Bv=function(){var n=Nf();return n&&n.activationStart||0},Ri=function(n,e){var t=Nf(),i="navigate";return UP()>=0?i="back-forward-cache":t&&(document.prerendering||Bv()>0?i="prerender":document.wasDiscarded?i="restore":t.type&&(i=t.type.replace(/_/g,"-"))),{name:n,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},gl=function(n,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(n)){var i=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return i.observe(Object.assign({type:n,buffered:!0},t||{})),i}}catch{}},Di=function(n,e,t,i){var o,c;return function(d){e.value>=0&&(d||i)&&((c=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=c,e.rating=function(f,p){return f>p[1]?"poor":f>p[0]?"needs-improvement":"good"}(e.value,t),n(e))}},Hv=function(n){requestAnimationFrame(function(){return requestAnimationFrame(function(){return n()})})},_f=function(n){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&n()})},Gv=function(n){var e=!1;return function(){e||(n(),e=!0)}},Bo=-1,vE=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},Bh=function(n){document.visibilityState==="hidden"&&Bo>-1&&(Bo=n.type==="visibilitychange"?n.timeStamp:0,FP())},yE=function(){addEventListener("visibilitychange",Bh,!0),addEventListener("prerenderingchange",Bh,!0)},FP=function(){removeEventListener("visibilitychange",Bh,!0),removeEventListener("prerenderingchange",Bh,!0)},Hj=function(){return Bo<0&&(Bo=vE(),yE(),Eu(function(){setTimeout(function(){Bo=vE(),yE()},0)})),{get firstHiddenTime(){return Bo}}},$v=function(n){document.prerendering?addEventListener("prerenderingchange",function(){return n()},!0):n()},bE=[1800,3e3],qP=function(n,e){e=e||{},$v(function(){var t,i=Hj(),o=Ri("FCP"),c=gl("paint",function(d){d.forEach(function(f){f.name==="first-contentful-paint"&&(c.disconnect(),f.startTime<i.firstHiddenTime&&(o.value=Math.max(f.startTime-Bv(),0),o.entries.push(f),t(!0)))})});c&&(t=Di(n,o,bE,e.reportAllChanges),Eu(function(d){o=Ri("FCP"),t=Di(n,o,bE,e.reportAllChanges),Hv(function(){o.value=performance.now()-d.timeStamp,t(!0)})}))})},xE=[.1,.25],zP=function(n,e){(function(t,i){i=i||{},qP(Gv(function(){var o,c=Ri("CLS",0),d=0,f=[],p=function(y){y.forEach(function(x){if(!x.hadRecentInput){var _=f[0],A=f[f.length-1];d&&x.startTime-A.startTime<1e3&&x.startTime-_.startTime<5e3?(d+=x.value,f.push(x)):(d=x.value,f=[x])}}),d>c.value&&(c.value=d,c.entries=f,o())},g=gl("layout-shift",p);g&&(o=Di(t,c,xE,i.reportAllChanges),_f(function(){p(g.takeRecords()),o(!0)}),Eu(function(){d=0,c=Ri("CLS",0),o=Di(t,c,xE,i.reportAllChanges),Hv(function(){return o()})}),setTimeout(o,0))}))})(function(t){var i=function(o){var c,d={};if(o.entries.length){var f=o.entries.reduce(function(g,y){return g&&g.value>y.value?g:y});if(f&&f.sources&&f.sources.length){var p=(c=f.sources).find(function(g){return g.node&&g.node.nodeType===1})||c[0];p&&(d={largestShiftTarget:zv(p.node),largestShiftTime:f.startTime,largestShiftValue:f.value,largestShiftSource:p,largestShiftEntry:f,loadState:zj(f.startTime)})}}return Object.assign(o,{attribution:d})}(t);n(i)},e)},Gj=0,Gp=1/0,sh=0,BP=function(n){n.forEach(function(e){e.interactionId&&(Gp=Math.min(Gp,e.interactionId),sh=Math.max(sh,e.interactionId),Gj=sh?(sh-Gp)/7+1:0)})},$j=function(){return jg?Gj:performance.interactionCount||0},HP=function(){"interactionCount"in performance||jg||(jg=gl("event",BP,{type:"event",buffered:!0,durationThreshold:0}))},bs=[],zc=new Map,Yj=0,GP=function(){var n=Math.min(bs.length-1,Math.floor(($j()-Yj)/50));return bs[n]},Qj=[],$P=function(n){if(Qj.forEach(function(o){return o(n)}),n.interactionId||n.entryType==="first-input"){var e=bs[bs.length-1],t=zc.get(n.interactionId);if(t||bs.length<10||n.duration>e.latency){if(t)n.duration>t.latency?(t.entries=[n],t.latency=n.duration):n.duration===t.latency&&n.startTime===t.entries[0].startTime&&t.entries.push(n);else{var i={id:n.interactionId,latency:n.duration,entries:[n]};zc.set(i.id,i),bs.push(i)}bs.sort(function(o,c){return c.latency-o.latency}),bs.length>10&&bs.splice(10).forEach(function(o){return zc.delete(o.id)})}}},Yv=function(n){var e=self.requestIdleCallback||self.setTimeout,t=-1;return n=Gv(n),document.visibilityState==="hidden"?n():(t=e(n),_f(n)),t},NE=[200,500],YP=function(n,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},$v(function(){var t;HP();var i,o=Ri("INP"),c=function(f){Yv(function(){f.forEach($P);var p=GP();p&&p.latency!==o.value&&(o.value=p.latency,o.entries=p.entries,i())})},d=gl("event",c,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});i=Di(n,o,NE,e.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),_f(function(){c(d.takeRecords()),i(!0)}),Eu(function(){Yj=$j(),bs.length=0,zc.clear(),o=Ri("INP"),i=Di(n,o,NE,e.reportAllChanges)}))}))},Xo=[],vi=[],Ag=0,Qv=new WeakMap,Wo=new Map,wg=-1,QP=function(n){Xo=Xo.concat(n),Kj()},Kj=function(){wg<0&&(wg=Yv(KP))},KP=function(){Wo.size>10&&Wo.forEach(function(d,f){zc.has(f)||Wo.delete(f)});var n=bs.map(function(d){return Qv.get(d.entries[0])}),e=vi.length-50;vi=vi.filter(function(d,f){return f>=e||n.includes(d)});for(var t=new Set,i=0;i<vi.length;i++){var o=vi[i];Xj(o.startTime,o.processingEnd).forEach(function(d){t.add(d)})}var c=Xo.length-1-50;Xo=Xo.filter(function(d,f){return d.startTime>Ag&&f>c||t.has(d)}),wg=-1};Qj.push(function(n){n.interactionId&&n.target&&!Wo.has(n.interactionId)&&Wo.set(n.interactionId,n.target)},function(n){var e,t=n.startTime+n.duration;Ag=Math.max(Ag,n.processingEnd);for(var i=vi.length-1;i>=0;i--){var o=vi[i];if(Math.abs(t-o.renderTime)<=8){(e=o).startTime=Math.min(n.startTime,e.startTime),e.processingStart=Math.min(n.processingStart,e.processingStart),e.processingEnd=Math.max(n.processingEnd,e.processingEnd),e.entries.push(n);break}}e||(e={startTime:n.startTime,processingStart:n.processingStart,processingEnd:n.processingEnd,renderTime:t,entries:[n]},vi.push(e)),(n.interactionId||n.entryType==="first-input")&&Qv.set(n,e),Kj()});var Xj=function(n,e){for(var t,i=[],o=0;t=Xo[o];o++)if(!(t.startTime+t.duration<n)){if(t.startTime>e)break;i.push(t)}return i},XP=function(n,e){gE||(gE=gl("long-animation-frame",QP)),YP(function(t){var i=function(o){var c=o.entries[0],d=Qv.get(c),f=c.processingStart,p=d.processingEnd,g=d.entries.sort(function(T,M){return T.processingStart-M.processingStart}),y=Xj(c.startTime,p),x=o.entries.find(function(T){return T.target}),_=x&&x.target||Wo.get(c.interactionId),A=[c.startTime+c.duration,p].concat(y.map(function(T){return T.startTime+T.duration})),N=Math.max.apply(Math,A),C={interactionTarget:zv(_),interactionTargetElement:_,interactionType:c.name.startsWith("key")?"keyboard":"pointer",interactionTime:c.startTime,nextPaintTime:N,processedEventEntries:g,longAnimationFrameEntries:y,inputDelay:f-c.startTime,processingDuration:p-f,presentationDelay:Math.max(N-p,0),loadState:zj(c.startTime)};return Object.assign(o,{attribution:C})}(t);n(i)},e)},_E=[2500,4e3],$p={},WP=function(n,e){(function(t,i){i=i||{},$v(function(){var o,c=Hj(),d=Ri("LCP"),f=function(y){i.reportAllChanges||(y=y.slice(-1)),y.forEach(function(x){x.startTime<c.firstHiddenTime&&(d.value=Math.max(x.startTime-Bv(),0),d.entries=[x],o())})},p=gl("largest-contentful-paint",f);if(p){o=Di(t,d,_E,i.reportAllChanges);var g=Gv(function(){$p[d.id]||(f(p.takeRecords()),p.disconnect(),$p[d.id]=!0,o(!0))});["keydown","click"].forEach(function(y){addEventListener(y,function(){return Yv(g)},{once:!0,capture:!0})}),_f(g),Eu(function(y){d=Ri("LCP"),o=Di(t,d,_E,i.reportAllChanges),Hv(function(){d.value=performance.now()-y.timeStamp,$p[d.id]=!0,o(!0)})})}})})(function(t){var i=function(o){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:o.value};if(o.entries.length){var d=Nf();if(d){var f=d.activationStart||0,p=o.entries[o.entries.length-1],g=p.url&&performance.getEntriesByType("resource").filter(function(N){return N.name===p.url})[0],y=Math.max(0,d.responseStart-f),x=Math.max(y,g?(g.requestStart||g.startTime)-f:0),_=Math.max(x,g?g.responseEnd-f:0),A=Math.max(_,p.startTime-f);c={element:zv(p.element),timeToFirstByte:y,resourceLoadDelay:x-y,resourceLoadDuration:_-x,elementRenderDelay:A-_,navigationEntry:d,lcpEntry:p},p.url&&(c.url=p.url),g&&(c.lcpResourceEntry=g)}}return Object.assign(o,{attribution:c})}(t);n(i)},e)};const EE="@firebase/performance",Cg="0.7.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj=Cg,ZP="FB-PERF-TRACE-START",JP="FB-PERF-TRACE-STOP",Sg="FB-PERF-TRACE-MEASURE",Zj="_wt_",Jj="_fp",eA="_fcp",tA="_fid",nA="_lcp",e2="lcp_element",sA="_inp",t2="inp_interactionTarget",aA="_cls",n2="cls_largestShiftTarget",iA="@firebase/performance/config",rA="@firebase/performance/configexpire",s2="performance",oA="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},mn=new Oi(s2,oA,a2);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi=new lu(oA);Mi.logLevel=$e.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yp,lA;class Bt{constructor(e){if(this.window=e,!e)throw mn.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=WP,this.onINP=XP,this.onCLS=zP}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,t,i){!this.performance||!this.performance.measure||this.performance.measure(e,t,i)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!Og()?(Mi.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):Gh()?!0:(Mi.info("IndexedDB is not supported by current browser"),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(o=>{for(const c of o.getEntries())t(c)}).observe({entryTypes:[e]})}static getInstance(){return Yp===void 0&&(Yp=new Bt(lA)),Yp}}function i2(n){lA=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cA;function r2(n){const e=n.getId();return e.then(t=>{cA=t}),e}function Kv(){return cA}function o2(n){const e=n.getToken();return e.then(t=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(n,e){const t=n.length-e.length;if(t<0||t>1)throw mn.create("invalid String merger input");const i=[];for(let o=0;o<n.length;o++)i.push(n.charAt(o)),e.length>o&&i.push(e.charAt(o));return i.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qp;class Bn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=TE("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=TE("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Qp===void 0&&(Qp=new Bn),Qp}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bc;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.VISIBLE=1]="VISIBLE",n[n.HIDDEN=2]="HIDDEN"})(Bc||(Bc={}));const l2=["firebase_","google_","ga_"],c2=new RegExp("^[a-zA-Z]\\w*$"),u2=40,d2=100;function h2(){const n=Bt.getInstance().navigator;return n?.serviceWorker?n.serviceWorker.controller?2:3:1}function f2(){switch(Bt.getInstance().document.visibilityState){case"visible":return Bc.VISIBLE;case"hidden":return Bc.HIDDEN;default:return Bc.UNKNOWN}}function m2(){const e=Bt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function p2(n){return n.length===0||n.length>u2?!1:!l2.some(t=>n.startsWith(t))&&!!n.match(c2)}function g2(n){return n.length!==0&&n.length<=d2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uA(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.appId;if(!t)throw mn.create("no app id");return t}function v2(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.projectId;if(!t)throw mn.create("no project id");return t}function y2(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.apiKey;if(!t)throw mn.create("no api key");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2="0.0.1",ys={loggingEnabled:!0},x2="FIREBASE_INSTALLATIONS_AUTH";function N2(n,e){const t=_2();return t?(jE(t),Promise.resolve()):j2(n,e).then(jE).then(i=>E2(i),()=>{})}function _2(){const n=Bt.getInstance().localStorage;if(!n)return;const e=n.getItem(rA);if(!e||!A2(e))return;const t=n.getItem(iA);if(t)try{return JSON.parse(t)}catch{return}}function E2(n){const e=Bt.getInstance().localStorage;!n||!e||(e.setItem(iA,JSON.stringify(n)),e.setItem(rA,String(Date.now()+Bn.getInstance().configTimeToLive*60*60*1e3)))}const T2="Could not fetch config, will use default configs";function j2(n,e){return o2(n.installations).then(t=>{const i=v2(n.app),o=y2(n.app),c=`https://firebaseremoteconfig.googleapis.com/v1/projects/${i}/namespaces/fireperf:fetch?key=${o}`,d=new Request(c,{method:"POST",headers:{Authorization:`${x2} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:uA(n.app),app_version:Wj,sdk_version:b2})});return fetch(d).then(f=>{if(f.ok)return f.json();throw mn.create("RC response not ok")})}).catch(()=>{Mi.info(T2)})}function jE(n){if(!n)return n;const e=Bn.getInstance(),t=n.entries||{};return t.fpr_enabled!==void 0?e.loggingEnabled=String(t.fpr_enabled)==="true":e.loggingEnabled=ys.loggingEnabled,t.fpr_log_source?e.logSource=Number(t.fpr_log_source):ys.logSource&&(e.logSource=ys.logSource),t.fpr_log_endpoint_url?e.logEndPointUrl=t.fpr_log_endpoint_url:ys.logEndPointUrl&&(e.logEndPointUrl=ys.logEndPointUrl),t.fpr_log_transport_key?e.transportKey=t.fpr_log_transport_key:ys.transportKey&&(e.transportKey=ys.transportKey),t.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(t.fpr_vc_network_request_sampling_rate):ys.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=ys.networkRequestsSamplingRate),t.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(t.fpr_vc_trace_sampling_rate):ys.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=ys.tracesSamplingRate),e.logTraceAfterSampling=AE(e.tracesSamplingRate),e.logNetworkAfterSampling=AE(e.networkRequestsSamplingRate),n}function A2(n){return Number(n)>Date.now()}function AE(n){return Math.random()<=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xv=1,Kp;function dA(n){return Xv=2,Kp=Kp||C2(n),Kp}function w2(){return Xv===3}function C2(n){return S2().then(()=>r2(n.installations)).then(e=>N2(n,e)).then(()=>wE(),()=>wE())}function S2(){const n=Bt.getInstance().document;return new Promise(e=>{if(n&&n.readyState!=="complete"){const t=()=>{n.readyState==="complete"&&(n.removeEventListener("readystatechange",t),e())};n.addEventListener("readystatechange",t)}else e()})}function wE(){Xv=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA=10*1e3,I2=5.5*1e3,R2=1e3,fA=3;let ph=fA,Sr=[],CE=!1;function D2(){CE||(Wv(I2),CE=!0)}function Wv(n){setTimeout(()=>{ph<=0||(Sr.length>0&&mA(),Wv(hA))},n)}function mA(){const n=Sr.splice(0,R2),e=n.map(i=>({source_extension_json_proto3:i.message,event_time_ms:String(i.eventTime)})),t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Bn.getInstance().logSource,log_event:e};M2(t).then(()=>{ph=fA}).catch(()=>{Sr=[...n,...Sr],ph--,Mi.info(`Tries left: ${ph}.`),Wv(hA)})}function M2(n){const e=Bn.getInstance().getFlTransportFullUrl(),t=JSON.stringify(n);return navigator.sendBeacon&&navigator.sendBeacon(e,t)?Promise.resolve():fetch(e,{method:"POST",body:t,keepalive:!0}).then()}function O2(n){if(!n.eventTime||!n.message)throw mn.create("invalid cc log");Sr=[...Sr,n]}function k2(n){return(...e)=>{const t=n(...e);O2({message:t,eventTime:Date.now()})}}function P2(){for(;Sr.length>0;)mA()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hc;function pA(n,e){Hc||(Hc={send:k2(U2),flush:P2}),Hc.send(n,e)}function ah(n){const e=Bn.getInstance();!e.instrumentationEnabled&&n.isAuto||!e.dataCollectionEnabled&&!n.isAuto||Bt.getInstance().requiredApisAvailable()&&(w2()?Xp(n):dA(n.performanceController).then(()=>Xp(n),()=>Xp(n)))}function L2(){Hc&&Hc.flush()}function Xp(n){if(!Kv())return;const e=Bn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||pA(n,1)}function V2(n){const e=Bn.getInstance();if(!e.instrumentationEnabled)return;const t=n.url,i=e.logEndPointUrl.split("?")[0],o=e.flTransportEndpointUrl.split("?")[0];t===i||t===o||!e.loggingEnabled||!e.logNetworkAfterSampling||pA(n,0)}function U2(n,e){return e===0?F2(n):q2(n)}function F2(n){const e={url:n.url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},t={application_info:gA(n.performanceController.app),network_request_metric:e};return JSON.stringify(t)}function q2(n){const e={name:n.name,is_auto:n.isAuto,client_start_time_us:n.startTimeUs,duration_us:n.durationUs};Object.keys(n.counters).length!==0&&(e.counters=n.counters);const t=n.getAttributes();Object.keys(t).length!==0&&(e.custom_attributes=t);const i={application_info:gA(n.performanceController.app),trace_metric:e};return JSON.stringify(i)}function gA(n){return{google_app_id:uA(n),app_instance_id:Kv(),web_app_info:{sdk_version:Wj,page_url:Bt.getInstance().getUrl(),service_worker_status:h2(),visibility_state:f2(),effective_connection_type:m2()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SE(n,e){const t=e;if(!t||t.responseStart===void 0)return;const i=Bt.getInstance().getTimeOrigin(),o=Math.floor((t.startTime+i)*1e3),c=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,d=Math.floor((t.responseEnd-t.startTime)*1e3),f=t.name&&t.name.split("?")[0],p={performanceController:n,url:f,responsePayloadBytes:t.transferSize,startTimeUs:o,timeToResponseInitiatedUs:c,timeToResponseCompletedUs:d};V2(p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2=100,B2="_",H2=[Jj,eA,tA,nA,aA,sA];function G2(n,e){return n.length===0||n.length>z2?!1:e&&e.startsWith(Zj)&&H2.indexOf(n)>-1||!n.startsWith(B2)}function $2(n){const e=Math.floor(n);return e<n&&Mi.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,t,i=!1,o){this.performanceController=e,this.name=t,this.isAuto=i,this.state=1,this.customAttributes={},this.counters={},this.api=Bt.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${ZP}-${this.randomId}-${this.name}`,this.traceStopMark=`${JP}-${this.randomId}-${this.name}`,this.traceMeasure=o||`${Sg}-${this.randomId}-${this.name}`,o&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw mn.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw mn.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),ah(this)}record(e,t,i){if(e<=0)throw mn.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw mn.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(t*1e3),this.startTimeUs=Math.floor(e*1e3),i&&i.attributes&&(this.customAttributes=Object.assign({},i.attributes)),i&&i.metrics)for(const o of Object.keys(i.metrics))isNaN(Number(i.metrics[o]))||(this.counters[o]=Math.floor(Number(i.metrics[o])));ah(this)}incrementMetric(e,t=1){this.counters[e]===void 0?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(G2(e,this.name))this.counters[e]=$2(t??0);else throw mn.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const i=p2(e),o=g2(t);if(i&&o){this.customAttributes[e]=t;return}if(!i)throw mn.create("invalid attribute name",{attributeName:e});if(!o)throw mn.create("invalid attribute value",{attributeValue:t})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(t.duration*1e3),this.startTimeUs=Math.floor((t.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,t,i,o,c){const d=Bt.getInstance().getUrl();if(!d)return;const f=new su(e,Zj+d,!0),p=Math.floor(Bt.getInstance().getTimeOrigin()*1e3);f.setStartTime(p),t&&t[0]&&(f.setDuration(Math.floor(t[0].duration*1e3)),f.putMetric("domInteractive",Math.floor(t[0].domInteractive*1e3)),f.putMetric("domContentLoadedEventEnd",Math.floor(t[0].domContentLoadedEventEnd*1e3)),f.putMetric("loadEventEnd",Math.floor(t[0].loadEventEnd*1e3)));const g="first-paint",y="first-contentful-paint";if(i){const x=i.find(A=>A.name===g);x&&x.startTime&&f.putMetric(Jj,Math.floor(x.startTime*1e3));const _=i.find(A=>A.name===y);_&&_.startTime&&f.putMetric(eA,Math.floor(_.startTime*1e3)),c&&f.putMetric(tA,Math.floor(c*1e3))}this.addWebVitalMetric(f,nA,e2,o.lcp),this.addWebVitalMetric(f,aA,n2,o.cls),this.addWebVitalMetric(f,sA,t2,o.inp),ah(f),L2()}static addWebVitalMetric(e,t,i,o){o&&(e.putMetric(t,Math.floor(o.value*1e3)),o.elementAttribution&&e.putAttribute(i,o.elementAttribution))}static createUserTimingTrace(e,t){const i=new su(e,t,!1,t);ah(i)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gh={},IE=!1,vA;function RE(n){Kv()&&(setTimeout(()=>Q2(n),0),setTimeout(()=>Y2(n),0),setTimeout(()=>K2(n),0))}function Y2(n){const e=Bt.getInstance(),t=e.getEntriesByType("resource");for(const i of t)SE(n,i);e.setupObserver("resource",i=>SE(n,i))}function Q2(n){const e=Bt.getInstance();"onpagehide"in window?e.document.addEventListener("pagehide",()=>Wp(n)):e.document.addEventListener("unload",()=>Wp(n)),e.document.addEventListener("visibilitychange",()=>{e.document.visibilityState==="hidden"&&Wp(n)}),e.onFirstInputDelay&&e.onFirstInputDelay(t=>{vA=t}),e.onLCP(t=>{var i;gh.lcp={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.element}}),e.onCLS(t=>{var i;gh.cls={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.largestShiftTarget}}),e.onINP(t=>{var i;gh.inp={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.interactionTarget}})}function K2(n){const e=Bt.getInstance(),t=e.getEntriesByType("measure");for(const i of t)DE(n,i);e.setupObserver("measure",i=>DE(n,i))}function DE(n,e){const t=e.name;t.substring(0,Sg.length)!==Sg&&su.createUserTimingTrace(n,t)}function Wp(n){if(!IE){IE=!0;const e=Bt.getInstance(),t=e.getEntriesByType("navigation"),i=e.getEntriesByType("paint");setTimeout(()=>{su.createOobTrace(n,t,i,gh,vA)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(e?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),e?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),Bt.getInstance().requiredApisAvailable()?$h().then(t=>{t&&(D2(),dA(this).then(()=>RE(this),()=>RE(this)),this.initialized=!0)}).catch(t=>{Mi.info(`Environment doesn't support IndexedDB: ${t}`)}):Mi.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Bn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Bn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Bn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Bn.getInstance().dataCollectionEnabled}}const W2="[DEFAULT]";function Z2(n=cu()){return n=yt(n),ka(n,"performance").getImmediate()}const J2=(n,{options:e})=>{const t=n.getProvider("app").getImmediate(),i=n.getProvider("installations-internal").getImmediate();if(t.name!==W2)throw mn.create("FB not default");if(typeof window>"u")throw mn.create("no window");i2(window);const o=new X2(t,i);return o._init(e),o};function eL(){ls(new $n("performance",J2,"PUBLIC")),pn(EE,Cg),pn(EE,Cg,"esm2017")}eL();const tL={apiKey:"AIzaSyCbU834quCY8hjSffRwljJLgZrcxK8i2F4",authDomain:"liquidacionapp-62962.firebaseapp.com",projectId:"liquidacionapp-62962",storageBucket:"liquidacionapp-62962.firebasestorage.app",messagingSenderId:"851382130132",appId:"1:851382130132:web:eaba38fab449f14fb5b241",measurementId:void 0},au=sT(tL),Gc=S1(au),me=SO(au);mk(au);let nL=null,sL=null;try{kP().then(n=>{n&&(nL=MP(au))}).catch(()=>{console.warn("Firebase Analytics no est soportado en este entorno")}),typeof window<"u"&&(sL=Z2(au))}catch(n){console.warn("Error al inicializar Firebase Analytics/Performance:",n)}const xs={ADMIN:"admin",CONTADOR:"contador",CLIENTE:"cliente"},dt={MANAGE_INVENTORY:"canManageInventory",CREATE_MOVEMENTS:"canCreateMovements",VIEW_ALL_MOVEMENTS:"canViewAllMovements",MANAGE_VEHICLES:"canManageVehicles",MANAGE_MAINTENANCE:"canManageMaintenance",MANAGE_SUPPLIERS:"canManageSuppliers",VIEW_REPORTS:"canViewReports",EXPORT_REPORTS:"canExportReports",MODIFY_SETTINGS:"canModifySettings"},aL="contacto.evert@gmail.com",yA=n=>{switch(n){case xs.ADMIN:return{[dt.MANAGE_INVENTORY]:!0,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!0,[dt.MANAGE_VEHICLES]:!0,[dt.MANAGE_MAINTENANCE]:!0,[dt.MANAGE_SUPPLIERS]:!0,[dt.VIEW_REPORTS]:!0,[dt.EXPORT_REPORTS]:!0,[dt.MODIFY_SETTINGS]:!0};case xs.CONTADOR:return{[dt.MANAGE_INVENTORY]:!0,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!0,[dt.MANAGE_VEHICLES]:!1,[dt.MANAGE_MAINTENANCE]:!0,[dt.MANAGE_SUPPLIERS]:!1,[dt.VIEW_REPORTS]:!0,[dt.EXPORT_REPORTS]:!0,[dt.MODIFY_SETTINGS]:!1};case xs.CLIENTE:default:return{[dt.MANAGE_INVENTORY]:!1,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!1,[dt.MANAGE_VEHICLES]:!1,[dt.MANAGE_MAINTENANCE]:!1,[dt.MANAGE_SUPPLIERS]:!1,[dt.VIEW_REPORTS]:!1,[dt.EXPORT_REPORTS]:!1,[dt.MODIFY_SETTINGS]:!1}}},iL=n=>n===aL?xs.ADMIN:xs.CLIENTE,al=()=>"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/invitations",rL=()=>{const n="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let e="";for(let t=0;t<8;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},oL=async(n,e)=>{try{const t=await Ef(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden crear invitaciones"};let i,o=!1,c=0;for(;!o&&c<10;){i=rL();const p=Te(Me(me,al()),Ie("code","==",i));(await ft(p)).empty&&(o=!0),c++}if(!o)return{success:!1,error:"No se pudo generar un cdigo nico"};const d=Je(Me(me,al())),f={code:i,targetEmail:n.email.toLowerCase(),targetRole:n.role||xs.CLIENTE,targetName:n.name||"",status:"pending",appContext:"combustibles",expiresAt:new Date(Date.now()+7*24*60*60*1e3),createdAt:Ue(),createdBy:e,usedAt:null,usedBy:null};return await gf(d,f),console.log(" Invitacin creada:",{code:i,email:n.email,role:n.role}),{success:!0,invitation:{id:d.id,code:i,...f}}}catch(t){return console.error("Error creating invitation:",t),{success:!1,error:t.message}}},bA=async n=>{try{const e=Te(Me(me,al()),Ie("code","==",n.toUpperCase()),Ie("status","==","pending")),t=await ft(e);if(t.empty)return{success:!1,error:"Cdigo de invitacin invlido o expirado"};const i=t.docs[0],o=i.data(),c=new Date,d=o.expiresAt.toDate();return c>d?{success:!1,error:"Cdigo de invitacin expirado"}:{success:!0,invitation:{id:i.id,...o}}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},lL=async(n,e)=>{try{const t=Je(me,al(),n);return await js(t,{status:"used",usedAt:Ue(),usedBy:e}),{success:!0}}catch(t){return console.error("Error marking invitation as used:",t),{success:!1,error:t.message}}},cL=async n=>{try{const e=await Ef(n);if(!e.success||e.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden ver invitaciones"};const t=Te(Me(me,al())),i=await ft(t),o=[];return i.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,d)=>{const f=c.createdAt?.toDate()||new Date(0);return(d.createdAt?.toDate()||new Date(0))-f}),{success:!0,invitations:o}}catch(e){return console.error("Error getting invitations:",e),{success:!1,error:e.message}}},uL=async(n,e)=>{try{const t=await Ef(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden cancelar invitaciones"};const i=Je(me,al(),n);return await js(i,{status:"cancelled",cancelledAt:Ue(),cancelledBy:e}),{success:!0}}catch(t){return console.error("Error cancelling invitation:",t),{success:!1,error:t.message}}},dL=n=>yA(n.targetRole),xA=async(n,e={})=>{const t=Je(me,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const i=await Fi(t);if(i.exists())return{success:!0,userData:i.data(),isNewUser:!1};{const o=iL(n.email),c={uid:n.uid,email:n.email,displayName:n.displayName||"",photoURL:n.photoURL||"",role:o,emailVerified:n.emailVerified,combustiblesPermissions:yA(o),createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...e};return await gf(t,c),{success:!0,userData:c,isNewUser:!0}}}catch(i){return console.error("Error creating/updating user profile:",i),{success:!1,error:i.message}}},ME=async(n,e,t={})=>{const i=Je(me,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const o=await Fi(i);if(o.exists())return{success:!0,userData:o.data(),isNewUser:!1};const c=await bA(e);if(!c.success)return c;const d=c.invitation;if(d.targetEmail!==n.email.toLowerCase())return{success:!1,error:"El cdigo de invitacin no corresponde a este email"};const f={uid:n.uid,email:n.email,displayName:n.displayName||d.targetName||"",photoURL:n.photoURL||"",role:d.targetRole,emailVerified:n.emailVerified,combustiblesPermissions:dL(d),invitationUsed:d.id,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...t};return await gf(i,f),await lL(d.id,n.uid),console.log(" Usuario creado con invitacin:",{email:n.email,role:d.targetRole,invitationCode:d.code}),{success:!0,userData:f,isNewUser:!0}}catch(o){return console.error("Error creating user profile with invitation:",o),{success:!1,error:o.message}}},Ef=async n=>{try{const e=Je(me,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n),t=await Fi(e);return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"Usuario no encontrado"}}catch(e){return console.error("Error fetching user profile:",e),{success:!1,error:e.message}}},_n={DIESEL:"diesel",GASOLINE:"gasoline",ACPM:"acpm",LUBRICANTS:"lubricants",TWO_STROKE:"two_stroke",MIXED:"mixed"},il={[_n.DIESEL]:{name:"Disel",description:"Combustible para maquinaria pesada",unit:"galones",category:"Combustible",color:"#fbbf24",icon:"",density:.85,priceUnit:"COP/galn"},[_n.GASOLINE]:{name:"Gasolina",description:"Combustible para vehculos livianos",unit:"galones",category:"Combustible",color:"#ef4444",icon:"",density:.75,priceUnit:"COP/galn"},[_n.ACPM]:{name:"ACPM",description:"Aceite Combustible Para Motor",unit:"galones",category:"Combustible",color:"#8b5cf6",icon:"",density:.85,priceUnit:"COP/galn"},[_n.LUBRICANTS]:{name:"Lubricantes",description:"Aceites y lubricantes para mantenimiento",unit:"litros",category:"Mantenimiento",color:"#06b6d4",icon:"",density:.9,priceUnit:"COP/litro"},[_n.TWO_STROKE]:{name:"Mezcla 2T",description:"Mezcla para motores de 2 tiempos (motosierras)",unit:"litros",category:"Especializado",color:"#10b981",icon:"",density:.78,priceUnit:"COP/litro"},[_n.MIXED]:{name:"Mixto",description:"Compatible con mltiples tipos de combustible",unit:"galones",category:"Flexible",color:"#64748b",icon:"",density:.8,priceUnit:"COP/galn"}},Nn={CRITICAL:"critical",LOW:"low",MEDIUM:"medium",HIGH:"high",FULL:"full"},Ho={[Nn.CRITICAL]:{label:"Crtico",color:"#dc2626",icon:"",threshold:.1},[Nn.LOW]:{label:"Bajo",color:"#ea580c",icon:"",threshold:.25},[Nn.MEDIUM]:{label:"Medio",color:"#ca8a04",icon:"",threshold:.5},[Nn.HIGH]:{label:"Alto",color:"#16a34a",icon:"",threshold:.75},[Nn.FULL]:{label:"Completo",color:"#059669",icon:"",threshold:1}},NA=(n,e)=>{if(e===0)return Nn.CRITICAL;const t=n/e;return t<Ho[Nn.CRITICAL].threshold?Nn.CRITICAL:t<Ho[Nn.LOW].threshold?Nn.LOW:t<Ho[Nn.MEDIUM].threshold?Nn.MEDIUM:t<Ho[Nn.HIGH].threshold?Nn.HIGH:Nn.FULL},hL=(n,e=[])=>{if(!n||!n.fuelType||!n.quantity)return{isValid:!1,error:"Datos de movimiento incompletos",availableStock:0,requiredStock:0};const{fuelType:t,quantity:i,type:o,sourceLocation:c}=n,d=parseFloat(i)||0;if(o!=="outbound"&&o!=="transfer")return{isValid:!0,message:"Movimiento no requiere validacin de stock",availableStock:0,requiredStock:d};const f=e.filter(y=>y.fuelType===t&&y.location?.toLowerCase()===c?.toLowerCase()&&y.status==="active").reduce((y,x)=>y+(parseFloat(x.currentStock)||0),0),p=f>=d,g=f-d;return console.log(`Validacin de stock - Tipo: ${t}, Ubicacin: ${c}`,{itemsEncontrados:e.filter(y=>y.fuelType===t&&y.location?.toLowerCase()===c?.toLowerCase()&&y.status==="active").length,disponible:f,requerido:d,valido:f>=d}),{isValid:p,availableStock:f,requiredStock:d,remainingStock:g,fuelType:t,location:c,error:p?null:`Stock insuficiente. Disponible: ${f}, Requerido: ${d}`,warning:g<f*.2&&g>=0?"Stock quedar bajo despus del movimiento":null}},Dn=n=>typeof n!="number"||isNaN(n)?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),Oe=(n,e=2)=>typeof n!="number"||isNaN(n)?"0":new Intl.NumberFormat("es-CO",{minimumFractionDigits:e,maximumFractionDigits:e}).format(n),Tr=(n,e=1)=>typeof n!="number"||isNaN(n)?"0%":`${(n*100).toFixed(e)}%`,iu=(n,e,t=2)=>{const i=parseFloat(n)||0,o=parseFloat(e)||0;return parseFloat((i+o).toFixed(t))},ru=(n,e,t=2)=>{const i=parseFloat(n)||0,o=parseFloat(e)||0;return parseFloat((i-o).toFixed(t))},rl=(n,e=2)=>{const t=parseFloat(n)||0;return parseFloat(t.toFixed(e))},Ei=["principal","campamento austria","campamento ilusion","bodega austria","bodega ilusion","campo operativo","estacin mvil"],fL=["bodega austria","bodega ilusion"],Gs=n=>n?n.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"",zr="combustibles_movements",rs="combustibles_inventory",ue={ENTRADA:"entrada",SALIDA:"salida",TRANSFERENCIA:"transferencia",AJUSTE:"ajuste"},gt={PENDIENTE:"pendiente",COMPLETADO:"completado",CANCELADO:"cancelado"},_A=async n=>{try{pL(n);const e={...n,createdAt:Ue(),updatedAt:Ue(),status:gt.COMPLETADO,approvedAt:Ue(),totalValue:wA(n),effectiveDate:n.effectiveDate||Ue()},t=await Pv(me,async i=>{const o=Je(Me(me,zr));return i.set(o,e),await CA(i,e,o.id),o.id});return console.log(" Movimiento creado exitosamente:",t),t}catch(e){throw console.error(" Error al crear movimiento:",e),new Error(`Error al crear movimiento: ${e.message}`)}},EA=async(n={})=>{try{let e=Me(me,zr);n.type&&(e=Te(e,Ie("type","==",n.type))),n.status&&(e=Te(e,Ie("status","==",n.status))),n.fuelType&&(e=Te(e,Ie("fuelType","==",n.fuelType))),n.vehicleId&&(e=Te(e,Ie("vehicleId","==",n.vehicleId))),e=Te(e,jn("createdAt","desc"));const t=await ft(e),i=[];return t.forEach(o=>{i.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,effectiveDate:o.data().effectiveDate?.toDate?.()||o.data().effectiveDate})}),i}catch(e){throw console.error(" Error al obtener movimientos:",e),new Error(`Error al obtener movimientos: ${e.message}`)}},Zv=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=Je(me,zr,n),t=await Fi(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate?.()||t.data().createdAt,updatedAt:t.data().updatedAt?.toDate?.()||t.data().updatedAt,effectiveDate:t.data().effectiveDate?.toDate?.()||t.data().effectiveDate}:null}catch(e){throw console.error(" Error al obtener movimiento:",e),new Error(`Error al obtener movimiento: ${e.message}`)}},TA=async(n,e)=>{try{if(!n)throw new Error("ID de movimiento requerido");const t={...e,updatedAt:Ue(),...e.quantity||e.unitPrice?{totalValue:wA(e)}:{}},i=Je(me,zr,n);await js(i,t),console.log(" Movimiento actualizado exitosamente")}catch(t){throw console.error(" Error al actualizar movimiento:",t),new Error(`Error al actualizar movimiento: ${t.message}`)}},mL=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=await Zv(n);if(!e)throw new Error("Movimiento no encontrado");await Pv(me,async t=>{const i=Je(me,zr,n);e.status===gt.COMPLETADO&&await gL(t,e),t.delete(i)}),console.log(" Movimiento eliminado y cambios de inventario revertidos exitosamente")}catch(e){throw console.error(" Error al eliminar movimiento:",e),new Error(`Error al eliminar movimiento: ${e.message}`)}},Jv=(n,e={})=>{try{let t=Me(me,zr);return e.type&&(t=Te(t,Ie("type","==",e.type))),e.status&&(t=Te(t,Ie("status","==",e.status))),t=Te(t,jn("createdAt","desc")),qr(t,i=>{const o=[];i.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,effectiveDate:c.data().effectiveDate?.toDate?.()||c.data().effectiveDate})}),n(o)},i=>{console.error(" Error en suscripcin de movimientos:",i),n([],i)})}catch(t){throw console.error(" Error al configurar suscripcin:",t),new Error(`Error en suscripcin: ${t.message}`)}},jA=async n=>{try{const e=await Zv(n);if(!e)throw new Error("Movimiento no encontrado");if(e.status!==gt.PENDIENTE)throw new Error("Solo se pueden aprobar movimientos pendientes");await Pv(me,async t=>{const i=Je(me,zr,n);t.update(i,{status:gt.COMPLETADO,approvedAt:Ue(),updatedAt:Ue()}),await CA(t,e,n)}),console.log(" Movimiento aprobado exitosamente")}catch(e){throw console.error(" Error al aprobar movimiento:",e),new Error(`Error al aprobar movimiento: ${e.message}`)}},AA=async(n={})=>{try{const e=await EA(n),t={totalMovements:e.length,byType:{},byStatus:{},byFuelType:{},totalValue:0,totalQuantity:0,averageValue:0,thisMonth:0,lastMonth:0,thisWeek:0},i=new Date,o=new Date(i.getFullYear(),i.getMonth(),1),c=new Date(i.getFullYear(),i.getMonth()-1,1),d=new Date(i.setDate(i.getDate()-i.getDay()));return e.forEach(f=>{t.byType[f.type]=(t.byType[f.type]||0)+1,t.byStatus[f.status]=(t.byStatus[f.status]||0)+1,t.byFuelType[f.fuelType]=(t.byFuelType[f.fuelType]||0)+1,t.totalValue+=f.totalValue||0,t.totalQuantity+=f.quantity||0;const p=new Date(f.createdAt);p>=o&&t.thisMonth++,p>=c&&p<o&&t.lastMonth++,p>=d&&t.thisWeek++}),t.averageValue=t.totalMovements>0?t.totalValue/t.totalMovements:0,t}catch(e){throw console.error(" Error al calcular estadsticas:",e),new Error(`Error al calcular estadsticas: ${e.message}`)}},OE=n=>n?Ei.includes(n.toLowerCase()):!1,pL=n=>{const e=["type","fuelType","quantity","unitPrice"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!Object.values(ue).includes(n.type))throw new Error("Tipo de movimiento invlido");if(n.quantity<=0)throw new Error("La cantidad debe ser mayor a cero");if(n.unitPrice<0)throw new Error("El precio unitario no puede ser negativo");if(n.type===ue.SALIDA&&!n.vehicleId)throw new Error("Las salidas deben tener un vehculo asociado");if(n.type===ue.TRANSFERENCIA&&!n.destinationLocation)throw new Error("Las transferencias deben tener una ubicacin destino");if(n.type===ue.ENTRADA){if(!n.supplierName)throw new Error("Las entradas deben tener un proveedor");if(!n.destinationLocation)throw new Error("Las entradas deben tener una ubicacin destino")}if(n.type!==ue.ENTRADA&&n.location&&!OE(n.location))throw new Error(`Ubicacin origen invlida: ${n.location}. Ubicaciones vlidas: ${Ei.join(", ")}`);if(n.destinationLocation&&!OE(n.destinationLocation))throw new Error(`Ubicacin destino invlida: ${n.destinationLocation}. Ubicaciones vlidas: ${Ei.join(", ")}`);if(n.type===ue.TRANSFERENCIA){const t=(n.location||"principal").toLowerCase(),i=n.destinationLocation.toLowerCase();if(t===i)throw new Error("La ubicacin origen y destino no pueden ser la misma en una transferencia")}},wA=n=>(n.quantity||0)*(n.unitPrice||0),CA=async(n,e,t)=>{try{let i=e.location||"principal";e.type===ue.ENTRADA&&(i=e.destinationLocation||"principal");const o=Te(Me(me,rs),Ie("fuelType","==",e.fuelType),Ie("location","==",i)),c=await ft(o);if(c.empty){if(e.type!==ue.ENTRADA)throw new Error(`No se encontr inventario para ${e.fuelType} en ${i} para realizar un movimiento de ${e.type}.`);console.log(` Creando inventario automtico para ${e.fuelType} en ${i}`);const d=Je(Me(me,rs)),f={fuelType:e.fuelType,location:i,name:e.fuelType,maxCapacity:1e4,currentStock:rl(e.quantity,2),minThreshold:1500,pricePerUnit:e.unitPrice||0,createdAt:Ue(),updatedAt:Ue(),status:"active",lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:Ue()}};n.set(d,f)}else{const d=c.docs[0],f=d.data(),p=Je(me,rs,d.id);let g=f.currentStock;switch(e.type){case ue.ENTRADA:g=iu(g,e.quantity);break;case ue.SALIDA:if(g=ru(g,e.quantity),g<0)throw new Error("Stock insuficiente para realizar la salida");break;case ue.AJUSTE:g=iu(g,e.quantity),g<0&&(g=0);break;case ue.TRANSFERENCIA:if(g=ru(g,e.quantity),g<0)throw new Error("Stock insuficiente para realizar la transferencia");await vL(n,e,t);break}g=rl(g,2),n.update(p,{currentStock:g,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:Ue()},updatedAt:Ue()})}e.type===ue.SALIDA&&e.vehicleId&&e.currentHours&&await PE(n,e.vehicleId,e.currentHours),e.type===ue.SALIDA&&e.vehicleId&&e.currentHours&&await PE(n,e.vehicleId,e.currentHours)}catch(i){throw console.error(" Error al actualizar inventario:",i),i}},gL=async(n,e)=>{try{console.log(" Revirtiendo cambios de inventario para movimiento:",e.id);let t;switch(e.type){case ue.ENTRADA:t=e.destinationLocation||"principal";break;case ue.SALIDA:case ue.AJUSTE:t=e.location||"principal";break;case ue.TRANSFERENCIA:t=e.location||"principal";break;default:t=e.location||e.destinationLocation||"principal"}console.log(` Buscando inventario: ${e.fuelType} en ${t}`);const i=Te(Me(me,rs),Ie("fuelType","==",e.fuelType),Ie("location","==",t)),o=await ft(i);if(o.empty){console.warn(` No se encontr inventario para ${e.fuelType} en ${t}`);const p=Te(Me(me,rs),Ie("fuelType","==",e.fuelType)),g=await ft(p);if(g.empty)throw console.error(` No existe inventario para ${e.fuelType} en ninguna ubicacin`),new Error(`No se puede revertir: no existe inventario para ${e.fuelType} en ninguna ubicacin. Movimiento hurfano detectado.`);console.log(` Usando inventario fallback en ${g.docs[0].data().location}`);const y=g.docs[0],x=y.data(),_=Je(me,rs,y.id);await kE(n,_,x,e);return}const c=o.docs[0],d=c.data(),f=Je(me,rs,c.id);await kE(n,f,d,e)}catch(t){throw console.error(" Error al revertir cambios de inventario:",t),new Error(`Error al revertir inventario: ${t.message}`)}},kE=async(n,e,t,i)=>{try{let o=t.currentStock;switch(i.type){case ue.ENTRADA:o=ru(o,i.quantity),o<0&&(console.warn(" Advertencia: La reversin resulta en stock negativo, ajustando a 0"),o=0);break;case ue.SALIDA:o=iu(o,i.quantity);break;case ue.AJUSTE:o=ru(o,i.quantity),o<0&&(console.warn(" Advertencia: La reversin de ajuste resulta en stock negativo, ajustando a 0"),o=0);break;case ue.TRANSFERENCIA:o=iu(o,i.quantity),await yL(n,i);break;default:throw new Error(`Tipo de movimiento no soportado para reversin: ${i.type}`)}o=rl(o,2),n.update(e,{currentStock:o,lastMovement:{movementId:null,type:"reversion",quantity:i.quantity,originalType:i.type,date:Ue(),note:`Reversin de movimiento ${i.id} - Ubicacin original: ${i.location||i.destinationLocation||"no especificada"}`},updatedAt:Ue()}),console.log(` Inventario revertido exitosamente. Stock anterior: ${t.currentStock}, Nuevo stock: ${o}`)}catch(o){throw console.error(" Error en procesamiento de reversin:",o),o}},vL=async(n,e,t)=>{try{if(!e.destinationLocation)throw new Error("Ubicacin destino requerida para transferencias");console.log(` Transfiriendo ${e.quantity} ${e.fuelType} a ${e.destinationLocation}`);const i=Te(Me(me,rs),Ie("fuelType","==",e.fuelType),Ie("location","==",e.destinationLocation)),o=await ft(i);if(o.empty){console.log(` Creando inventario automtico en destino: ${e.fuelType} en ${e.destinationLocation}`);const c=Je(Me(me,rs)),d={fuelType:e.fuelType,location:e.destinationLocation,name:e.fuelType,maxCapacity:1e4,currentStock:rl(e.quantity,2),minThreshold:1500,pricePerUnit:e.unitPrice||0,createdAt:Ue(),updatedAt:Ue(),status:"active",lastMovement:{movementId:t,type:"transferencia_entrada",quantity:e.quantity,date:Ue(),originLocation:e.location}};n.set(c,d)}else{const c=o.docs[0],d=c.data(),f=Je(me,rs,c.id),p=rl(iu(d.currentStock,e.quantity),2);n.update(f,{currentStock:p,lastMovement:{movementId:t,type:"transferencia_entrada",quantity:e.quantity,date:Ue(),originLocation:e.location},updatedAt:Ue()})}console.log(" Transferencia al destino completada exitosamente")}catch(i){throw console.error(" Error al transferir a destino:",i),new Error(`Error en transferencia a destino: ${i.message}`)}},yL=async(n,e)=>{try{if(!e.destinationLocation){console.warn(" No hay ubicacin destino para revertir");return}console.log(` Revirtiendo transferencia en destino: ${e.destinationLocation}`);const t=Te(Me(me,rs),Ie("fuelType","==",e.fuelType),Ie("location","==",e.destinationLocation)),i=await ft(t);if(i.empty){console.warn(` No se encontr inventario destino para revertir: ${e.fuelType} en ${e.destinationLocation}`);return}const o=i.docs[0],c=o.data(),d=Je(me,rs,o.id);let f=ru(c.currentStock,e.quantity);f<0&&(console.warn(" Advertencia: La reversin en destino resulta en stock negativo, ajustando a 0"),f=0),f=rl(f,2),n.update(d,{currentStock:f,lastMovement:{movementId:null,type:"reversion_transferencia",quantity:e.quantity,date:Ue(),note:`Reversin de transferencia desde ${e.location}`},updatedAt:Ue()}),console.log(" Reversin en destino completada exitosamente")}catch(t){throw console.error(" Error al revertir transferencia en destino:",t),new Error(`Error al revertir destino: ${t.message}`)}},PE=async(n,e,t)=>{try{console.log(` Actualizando hormetro del vehculo ${e} a ${t} horas`);const i=Te(Me(me,"combustibles_vehicles"),Ie("vehicleId","==",e)),o=await ft(i);if(o.empty){console.warn(` Vehculo ${e} no encontrado para actualizar hormetro`);return}const c=o.docs[0],d=c.data(),f=Je(me,"combustibles_vehicles",c.id),p=parseFloat(d.currentHours)||0,g=parseFloat(t);g<p&&console.warn(` Nueva lectura hormetro (${g}) menor a la anterior (${p}). Actualizando de todas formas.`);const y=d.hourMeterHistory||[];y.push({previousHours:p,newHours:g,difference:g-p,updatedAt:new Date,updatedBy:"movement_service",source:"fuel_consumption"}),n.update(f,{currentHours:g,hourMeterHistory:y,lastHourMeterUpdate:Ue(),updatedAt:Ue()}),console.log(` Hormetro actualizado: ${e} - ${p}h  ${g}h`)}catch(i){console.error(" Error al actualizar hormetro del vehculo:",i),console.warn(" Continuando con el movimiento sin actualizacin de hormetro")}},LE={createMovement:_A,getAllMovements:EA,getMovement:Zv,updateMovement:TA,deleteMovement:mL,subscribeToMovements:Jv,approveMovement:jA,getMovementsStats:AA,MOVEMENT_TYPES:ue,MOVEMENT_STATUS:gt},ol="combustibles_inventory",bL=async(n,e)=>{try{const t=il[n.fuelType];if(!t)return{success:!1,error:"Tipo de combustible no vlido"};const i=Te(Me(me,ol),Ie("fuelType","==",n.fuelType),Ie("location","==",n.location.toLowerCase()));if(!(await ft(i)).empty)return{success:!1,error:`Ya existe ${t.name} en ${n.location}`};const c={fuelType:n.fuelType,name:t.name,description:n.description||t.description,currentStock:Number(n.currentStock)||0,maxCapacity:Number(n.maxCapacity),minThreshold:Number(n.minThreshold)||n.maxCapacity*.15,unit:t.unit,location:n.location.toLowerCase(),pricePerUnit:Number(n.pricePerUnit)||0,supplier:n.supplier||"",status:n.status||"active",createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await pl(Me(me,ol),c)).id,...c},message:`${t.name} agregado al inventario exitosamente`}}catch(t){return console.error("Error creating inventory item:",t),{success:!1,error:t.message}}},xL=async()=>{try{const n=Te(Me(me,ol),jn("fuelType","asc")),e=await ft(n),t=[];return e.forEach(i=>{const o=i.data();t.push({id:i.id,...o,stockLevel:NA(o.currentStock,o.maxCapacity),stockPercentage:Math.round(o.currentStock/o.maxCapacity*100),needsRestock:o.currentStock<=o.minThreshold})}),{success:!0,data:t}}catch(n){return console.error("Error fetching inventory items:",n),{success:!1,error:n.message}}},NL=async(n,e,t)=>{try{const i=Je(me,ol,n);if(!(await Fi(i)).exists())return{success:!1,error:"Item no encontrado"};const c={...e,lastUpdated:new Date,updatedBy:t};return delete c.id,delete c.createdAt,delete c.createdBy,await js(i,c),{success:!0,message:"Item actualizado exitosamente",data:{id:n,...c}}}catch(i){return console.error("Error updating inventory item:",i),{success:!1,error:i.message}}},_L=async n=>{try{const e=Je(me,ol,n);return(await Fi(e)).exists()?(await vf(e),{success:!0,message:"Item eliminado exitosamente"}):{success:!1,error:"Item no encontrado"}}catch(e){return console.error("Error deleting inventory item:",e),{success:!1,error:e.message}}},SA=n=>{const e=Te(Me(me,ol),jn("fuelType","asc"));return qr(e,t=>{const i=[];t.forEach(o=>{const c=o.data();i.push({id:o.id,...c,stockLevel:NA(c.currentStock,c.maxCapacity),stockPercentage:Math.round(c.currentStock/c.maxCapacity*100),needsRestock:c.currentStock<=c.minThreshold})}),n(i)},t=>{console.error("Error in inventory subscription:",t),n(null,t)})},EL=async()=>{try{const n=await xL();if(!n.success)return n;const e=n.data,t={totalItems:e.length,activeItems:e.filter(i=>i.status==="active").length,lowStockItems:e.filter(i=>i.needsRestock).length,totalValue:e.reduce((i,o)=>i+o.currentStock*o.pricePerUnit,0),averageStockLevel:e.length>0?Math.round(e.reduce((i,o)=>i+o.stockPercentage,0)/e.length):0,byFuelType:{}};return e.forEach(i=>{t.byFuelType[i.fuelType]||(t.byFuelType[i.fuelType]={count:0,totalStock:0,totalCapacity:0,totalValue:0}),t.byFuelType[i.fuelType].count++,t.byFuelType[i.fuelType].totalStock+=i.currentStock,t.byFuelType[i.fuelType].totalCapacity+=i.maxCapacity,t.byFuelType[i.fuelType].totalValue+=i.currentStock*i.pricePerUnit}),{success:!0,data:t}}catch(n){return console.error("Error calculating inventory stats:",n),{success:!1,error:n.message}}},os=[{id:"maquinaria_pesada",name:"Maquinaria Pesada",description:"Excavadoras, bulldozers, cargadores, gras",icon:"",color:"#FF6B35",fuelTypes:["Diesel","ACPM"],fields:["enginePower","operatingWeight","bucketCapacity"]},{id:"transporte",name:"Transporte",description:"Camiones, camionetas, volquetas",icon:"",color:"#2E86AB",fuelTypes:["Diesel","ACPM","Gasolina"],fields:["plateNumber","loadCapacity","enginePower"]},{id:"herramientas_motorizadas",name:"Herramientas Motorizadas",description:"Motosierras, guadaas, fumigadoras",icon:"",color:"#A23B72",fuelTypes:["Gasolina","Mixto"],fields:["enginePower","weight"]},{id:"equipos_bombeo",name:"Equipos de Bombeo",description:"Motobombas, hidrolavadoras, plantas elctricas",icon:"",color:"#F18F01",fuelTypes:["Diesel","Gasolina"],fields:["flow","pressure","enginePower"]},{id:"vehiculos_ligeros",name:"Vehculos Ligeros",description:"Motocicletas, cuatrimotos, vehculos de apoyo",icon:"",color:"#C73E1D",fuelTypes:["Gasolina"],fields:["plateNumber","enginePower"]},{id:"agricola",name:"Agrcola/Forestal",description:"Tractores, asperjadoras, equipos forestales",icon:"",color:"#2F7D32",fuelTypes:["Diesel","ACPM"],fields:["enginePower","hasHourMeter","implementType"]},{id:"otros",name:"Otros",description:"Equipos especializados y otros vehculos",icon:"",color:"#616161",fuelTypes:["Diesel","Gasolina","ACPM","Mixto"],fields:["enginePower"]}],Ve={ACTIVO:"activo",MANTENIMIENTO:"mantenimiento",INACTIVO:"inactivo",REPARACION:"reparacion",FUERA_DE_SERVICIO:"fuera_de_servicio"},IA={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},VE=[{key:"plateNumber",label:"Nmero de Placa",type:"text",icon:""},{key:"enginePower",label:"Potencia del Motor (HP)",type:"number",icon:""},{key:"fuelCapacity",label:"Capacidad de Combustible (Litros)",type:"number",icon:""},{key:"operatingWeight",label:"Peso Operativo (Toneladas)",type:"number",icon:""},{key:"loadCapacity",label:"Capacidad de Carga (Toneladas)",type:"number",icon:""},{key:"bucketCapacity",label:"Capacidad de Balde (m)",type:"number",icon:""},{key:"hasHourMeter",label:"Tiene Hormetro",type:"boolean",icon:""},{key:"currentHours",label:"Horas Actuales",type:"number",icon:"",dependsOn:"hasHourMeter"},{key:"implementType",label:"Tipo de Implemento",type:"text",icon:""},{key:"flow",label:"Caudal (L/min)",type:"number",icon:""},{key:"pressure",label:"Presin (PSI)",type:"number",icon:""},{key:"weight",label:"Peso (Kg)",type:"number",icon:""}],UE=(n,e=[])=>{const t=e.find(i=>i.id===n);return t||os.find(i=>i.id===n)||null},RA=(n=[])=>{const e=os.map(i=>i.id),t=n.filter(i=>!e.includes(i.id));return[...os,...t]},DA=n=>{const e=[];return(!n.id||typeof n.id!="string")&&e.push("ID de categora requerido y debe ser texto"),(!n.name||typeof n.name!="string")&&e.push("Nombre de categora requerido y debe ser texto"),n.name&&n.name.length<2&&e.push("Nombre debe tener al menos 2 caracteres"),n.fuelTypes&&!Array.isArray(n.fuelTypes)&&e.push("Tipos de combustible debe ser un array"),n.fields&&!Array.isArray(n.fields)&&e.push("Campos debe ser un array"),{isValid:e.length===0,errors:e}},MA=(n,e=[])=>{const t=n.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"");let i=t,o=1;for(;e.some(c=>c.id===i);)i=`${t}_${o}`,o++;return i},vl="combustibles_vehicles",vt={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},OA=async n=>{try{if(TL(n),await ey(n.vehicleId))throw new Error(`El cdigo de vehculo '${n.vehicleId}' ya existe`);const t={...n,createdAt:Ue(),updatedAt:Ue(),status:n.status||Ve.ACTIVO,totalFuelConsumed:0,totalHoursWorked:0,totalMovements:0,lastMovementDate:null,estimatedConsumptionPerHour:VA(n)},i=await pl(Me(me,vl),t);return console.log(" Vehculo creado exitosamente:",i.id),i.id}catch(e){throw console.error(" Error al crear vehculo:",e),new Error(`Error al crear vehculo: ${e.message}`)}},kA=async(n={})=>{try{let e=Me(me,vl);n.type&&(e=Te(e,Ie("type","==",n.type))),n.status&&(e=Te(e,Ie("status","==",n.status))),n.fuelType&&(e=Te(e,Ie("fuelType","==",n.fuelType))),n.location&&(e=Te(e,Ie("currentLocation","==",n.location))),e=Te(e,jn("vehicleId","asc"));const t=await ft(e),i=[];return t.forEach(o=>{i.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,lastMovementDate:o.data().lastMovementDate?.toDate?.()||o.data().lastMovementDate,lastMaintenanceDate:o.data().lastMaintenanceDate?.toDate?.()||o.data().lastMaintenanceDate})}),i}catch(e){throw console.error(" Error al obtener vehculos:",e),new Error(`Error al obtener vehculos: ${e.message}`)}},ey=async n=>{try{const e=Te(Me(me,vl),Ie("vehicleId","==",n)),t=await ft(e);if(t.empty)return null;const i=t.docs[0];return{id:i.id,...i.data(),createdAt:i.data().createdAt?.toDate?.()||i.data().createdAt,updatedAt:i.data().updatedAt?.toDate?.()||i.data().updatedAt,lastMovementDate:i.data().lastMovementDate?.toDate?.()||i.data().lastMovementDate,lastMaintenanceDate:i.data().lastMaintenanceDate?.toDate?.()||i.data().lastMaintenanceDate}}catch(e){throw console.error(" Error al buscar vehculo por cdigo:",e),new Error(`Error al buscar vehculo: ${e.message}`)}},PA=async(n,e)=>{try{if(!n)throw new Error("ID de vehculo requerido");if(e.vehicleId){const o=await ey(e.vehicleId);if(o&&o.id!==n)throw new Error(`El cdigo de vehculo '${e.vehicleId}' ya existe`)}const t={...e,updatedAt:Ue(),...e.enginePower||e.type?{estimatedConsumptionPerHour:VA(e)}:{}},i=Je(me,vl,n);await js(i,t),console.log(" Vehculo actualizado exitosamente")}catch(t){throw console.error(" Error al actualizar vehculo:",t),new Error(`Error al actualizar vehculo: ${t.message}`)}},ty=(n,e={})=>{try{let t=Me(me,vl);const i=[];e.category&&i.push(Ie("category","==",e.category)),e.status&&i.push(Ie("status","==",e.status)),e.fuelType&&i.push(Ie("fuelType","==",e.fuelType)),e.currentLocation&&i.push(Ie("currentLocation","==",e.currentLocation)),i.forEach(c=>{t=Te(t,c)}),t=Te(t,jn("updatedAt","desc"));let o=null;return qr(t,c=>{const d=Date.now();if(o&&d-o<500)return;o=d;const f=[],p={added:[],modified:[],removed:[]};c.docChanges().forEach(g=>{const y={id:g.doc.id,...g.doc.data(),createdAt:g.doc.data().createdAt?.toDate?.()||g.doc.data().createdAt,updatedAt:g.doc.data().updatedAt?.toDate?.()||g.doc.data().updatedAt,lastMovementDate:g.doc.data().lastMovementDate?.toDate?.()||g.doc.data().lastMovementDate,lastMaintenanceDate:g.doc.data().lastMaintenanceDate?.toDate?.()||g.doc.data().lastMaintenanceDate,lastHourMeterDate:g.doc.data().lastHourMeterDate?.toDate?.()||g.doc.data().lastHourMeterDate};g.type==="added"?p.added.push(y):g.type==="modified"?p.modified.push(y):g.type==="removed"&&p.removed.push({id:g.doc.id})}),c.forEach(g=>{f.push({id:g.id,...g.data(),createdAt:g.data().createdAt?.toDate?.()||g.data().createdAt,updatedAt:g.data().updatedAt?.toDate?.()||g.data().updatedAt,lastMovementDate:g.data().lastMovementDate?.toDate?.()||g.data().lastMovementDate,lastMaintenanceDate:g.data().lastMaintenanceDate?.toDate?.()||g.data().lastMaintenanceDate,lastHourMeterDate:g.data().lastHourMeterDate?.toDate?.()||g.data().lastHourMeterDate})}),n(f,null,p)},c=>{console.error(" Error en suscripcin de vehculos:",c),n([],c)})}catch(t){throw console.error(" Error al configurar suscripcin:",t),new Error(`Error en suscripcin: ${t.message}`)}},LA=async(n={})=>{try{const e=await kA(n),t={totalVehicles:e.length,byType:{},byStatus:{},byFuelType:{},totalFuelConsumed:0,totalHoursWorked:0,averageConsumption:0,mostActiveVehicle:null,leastActiveVehicle:null};let i=0,o=1/0;return e.forEach(c=>{t.byType[c.type]=(t.byType[c.type]||0)+1,t.byStatus[c.status]=(t.byStatus[c.status]||0)+1,t.byFuelType[c.fuelType]=(t.byFuelType[c.fuelType]||0)+1,t.totalFuelConsumed+=c.totalFuelConsumed||0,t.totalHoursWorked+=c.totalHoursWorked||0;const d=c.totalMovements||0;d>i&&(i=d,t.mostActiveVehicle=c),d<o&&d>0&&(o=d,t.leastActiveVehicle=c)}),t.totalHoursWorked>0&&(t.averageConsumption=t.totalFuelConsumed/t.totalHoursWorked),t}catch(e){throw console.error(" Error al calcular estadsticas:",e),new Error(`Error al calcular estadsticas: ${e.message}`)}},TL=n=>{const e=["vehicleId","name","type","fuelType"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!n.type||n.type.trim().length===0)throw new Error("Tipo de vehculo requerido");if(!Object.values(vt).includes(n.fuelType))throw new Error("Tipo de combustible invlido");if(n.status&&!Object.values(Ve).includes(n.status))throw new Error("Estado de vehculo invlido");if(n.enginePower&&n.enginePower<=0)throw new Error("La potencia del motor debe ser mayor a cero");if(n.fuelCapacity&&n.fuelCapacity<=0)throw new Error("La capacidad de combustible debe ser mayor a cero")},VA=n=>{const{type:e,enginePower:t,fuelType:i}=n,o={excavadora:.04,bulldozer:.05,cargador:.035,camion:.03,camioneta:.03,grua:.045,motosierra:.02,tractor:.025,volqueta:.035,motobomba:.035,fumigadora:.025,guadana:.02,motocicleta:.015,planta_electrica:.08,otros:.03},c={[vt.DIESEL]:1,[vt.GASOLINA]:1.2,[vt.ACPM]:.95,[vt.MIXTO]:1.1},d=o[e]||.03,f=c[i]||1;return d*(t||100)*f},jL=async n=>{try{const e=Te(Me(me,vl),Ie("category","==",n));return(await ft(e)).size}catch(e){return console.error(" Error al contar vehculos por categora:",e),0}},UA=Object.freeze(Object.defineProperty({__proto__:null,FUEL_COMPATIBILITY:vt,FUEL_TYPES:IA,VEHICLE_STATUS:Ve,countVehiclesByCategory:jL,createVehicle:OA,getAllVehicles:kA,getVehicleByCode:ey,getVehiclesStats:LA,subscribeToVehicles:ty,updateVehicle:PA},Symbol.toStringTag,{value:"Module"})),$s="combustibles_suppliers",AL=async(n,e)=>{try{const t=Te(Me(me,$s),Ie("name","==",n.name.trim()));if(!(await ft(t)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${n.name}"`};if(n.taxId){const d=Te(Me(me,$s),Ie("taxId","==",n.taxId.trim()));if(!(await ft(d)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${n.taxId}"`}}const o={name:n.name.trim(),taxId:n.taxId?.trim()||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson?.trim()||"",phone:n.phone?.trim()||"",email:n.email?.trim()||"",address:n.address?.trim()||"",city:n.city?.trim()||"",state:n.state?.trim()||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:Number(n.creditLimit)||0,priceList:n.priceList||{},rating:Number(n.rating)||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1,totalOrders:0,totalPurchased:0,lastOrderDate:null,averageDeliveryTime:0,createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await pl(Me(me,$s),o)).id,...o},message:`Proveedor "${o.name}" creado exitosamente`}}catch(t){return console.error("Error creating supplier:",t),{success:!1,error:t.message}}},wL=async()=>{try{const n=Te(Me(me,$s),jn("name","asc"));return{success:!0,data:(await ft(n)).docs.map(i=>({id:i.id,...i.data()}))}}catch(n){return console.error("Error getting suppliers:",n),{success:!1,error:n.message}}},FA=n=>{const e=Te(Me(me,$s),jn("name","asc"));return qr(e,t=>{const i=t.docs.map(o=>({id:o.id,...o.data()}));n(i)})},CL=async(n,e,t)=>{try{const i=await Fi(Je(me,$s,n));if(!i.exists())return{success:!1,error:"Proveedor no encontrado"};if(e.name&&e.name.trim()!==i.data().name){const c=Te(Me(me,$s),Ie("name","==",e.name.trim()));if(!(await ft(c)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${e.name}"`}}if(e.taxId&&e.taxId.trim()!==i.data().taxId){const c=Te(Me(me,$s),Ie("taxId","==",e.taxId.trim()));if(!(await ft(c)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${e.taxId}"`}}const o={...e,lastUpdated:new Date,updatedBy:t};return o.name&&(o.name=o.name.trim()),o.taxId&&(o.taxId=o.taxId.trim()),o.contactPerson&&(o.contactPerson=o.contactPerson.trim()),o.phone&&(o.phone=o.phone.trim()),o.email&&(o.email=o.email.trim()),await js(Je(me,$s,n),o),{success:!0,message:"Proveedor actualizado exitosamente"}}catch(i){return console.error("Error updating supplier:",i),{success:!1,error:i.message}}},SL=async(n,e)=>{try{return await js(Je(me,$s,n),{status:"inactive",lastUpdated:new Date,updatedBy:e}),{success:!0,message:"Proveedor desactivado exitosamente"}}catch(t){return console.error("Error deleting supplier:",t),{success:!1,error:t.message}}},IL=async()=>{try{const n=await wL();if(!n.success)return n;const e=n.data,t={total:e.length,active:e.filter(i=>i.status==="active").length,inactive:e.filter(i=>i.status==="inactive").length,suspended:e.filter(i=>i.status==="suspended").length,preferred:e.filter(i=>i.isPreferred).length,averageRating:e.length>0?e.reduce((i,o)=>i+(o.rating||0),0)/e.length:0,byCategory:{},byType:{}};return e.forEach(i=>{const o=i.category||"sin_categoria";t.byCategory[o]=(t.byCategory[o]||0)+1}),e.forEach(i=>{const o=i.type||"sin_tipo";t.byType[o]=(t.byType[o]||0)+1}),{success:!0,data:t}}catch(n){return console.error("Error getting suppliers stats:",n),{success:!1,error:n.message}}},qA=$.createContext(),ds=()=>{const n=$.useContext(qA);if(n===void 0)throw new Error("useCombustibles must be used within a CombustiblesProvider");return n},RL=({children:n})=>{const[e,t]=$.useState(null),[i,o]=$.useState(null),[c,d]=$.useState(!0),[f,p]=$.useState(null),[g,y]=$.useState([]),[x,_]=$.useState([]),[A,N]=$.useState([]),[C,T]=$.useState([]);$.useEffect(()=>{const O=vR(Gc,async w=>{try{if(d(!0),w){t(w);let I=await Ef(w.uid);I.success||(I=await xA(w,{provider:"existing_account",appContext:"combustibles"})),I.success?o(I.userData):p("Error cargando perfil de usuario")}else t(null),o(null),y([]),_([]),N([]),T([])}catch(I){console.error("Error en autenticacin:",I),p("Error de autenticacin")}finally{d(!1)}});return()=>O()},[]),$.useEffect(()=>{if(e){const O=SA(y),w=ty(N,de=>p(de.message)),I=FA(T),R=LE.subscribeToMovements(_,de=>p(de.message));return()=>{O(),w(),I(),R()}}},[e]);const L={user:e,userProfile:i,loading:c,error:f,hasPermission:O=>i?.combustiblesPermissions?.[O]||!1,isAdmin:()=>i?.role==="admin",isCounterOrAbove:()=>i?.role==="admin"||i?.role==="contador",inventory:g,movements:x,vehicles:A,suppliers:C,setInventory:y,setMovements:_,setVehicles:N,setSuppliers:T,deleteMovement:async O=>{try{return await LE.deleteMovement(O),{success:!0}}catch(w){return console.error("Error al eliminar el movimiento en el contexto:",w),p(w.message),{success:!1,error:w.message}}},refreshInventory:async()=>{console.log("Refrescando inventario...")},refreshMovements:async()=>{console.log("Refrescando movimientos...")},refreshVehicles:async()=>{console.log("Refrescando vehculos...")},refreshSuppliers:async()=>{console.log("Refrescando proveedores...")}};return a.jsx(qA.Provider,{value:L,children:n})},DL=({children:n,currentView:e,onViewChange:t})=>{const{userProfile:i,isAdmin:o,isCounterOrAbove:c}=ds(),[d,f]=$.useState(!1),p=[{id:"dashboard",name:"Dashboard",icon:"",description:"Vista general",requiredPermission:null},{id:"inventory",name:"Inventario",icon:"",description:"Gestin de stock",requiredPermission:"canManageInventory"},{id:"movements",name:"Movimientos",icon:"",description:"Entradas y salidas",requiredPermission:"canCreateMovements"},{id:"vehicles",name:"Vehculos",icon:"",description:"Maquinaria forestal",requiredPermission:null},{id:"maintenance",name:"Mantenimiento",icon:"",description:"Cambios de aceite y bateras",requiredPermission:null},{id:"products",name:"Productos",icon:"",description:"Tipos de combustibles",requiredPermission:null},{id:"suppliers",name:"Proveedores",icon:"",description:"Gestin de proveedores",requiredPermission:"canManageSuppliers"},{id:"reports",name:"Reportes",icon:"",description:"Anlisis y reportes",requiredPermission:"canViewReports"},{id:"admin",name:"Administracin",icon:"",description:"Gestin de usuarios",requiredPermission:"admin"}],g=A=>{t(A),f(!1)},y=A=>A?A==="admin"?o():i?.combustiblesPermissions?.[A]||!1:!0,x=p.filter(A=>y(A.requiredPermission)),_=async()=>{try{await yR(Gc)}catch(A){console.error("Error al cerrar sesin:",A)}};return a.jsxs("div",{className:"dashboard-layout",children:[a.jsx("header",{className:"dashboard-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"sidebar-toggle",onClick:()=>f(!d),children:""}),a.jsxs("div",{className:"header-title",children:[a.jsx("h1",{children:" Gestin de Combustibles"}),a.jsx("span",{className:"subtitle",children:"Forestech Colombia"})]}),a.jsxs("div",{className:"header-user",children:[a.jsxs("div",{className:"user-info",children:[a.jsx("span",{className:"user-name",children:i?.displayName||i?.email}),a.jsx("span",{className:"user-role",children:i?.role})]}),a.jsx("div",{className:"user-avatar",children:i?.photoURL?a.jsx("img",{src:i.photoURL,alt:"Avatar"}):a.jsx("div",{className:"avatar-placeholder",children:(i?.displayName||i?.email||"U").charAt(0).toUpperCase()})}),a.jsx("button",{className:"logout-button",onClick:_,title:"Cerrar sesin",children:""})]})]})}),a.jsxs("div",{className:"dashboard-body",children:[a.jsxs("aside",{className:`dashboard-sidebar ${d?"open":""}`,children:[a.jsx("nav",{className:"sidebar-nav",children:x.map(A=>a.jsxs("button",{className:`nav-item ${e===A.id?"active":""}`,onClick:()=>g(A.id),children:[a.jsx("span",{className:"nav-icon",children:A.icon}),a.jsxs("div",{className:"nav-content",children:[a.jsx("span",{className:"nav-name",children:A.name}),a.jsx("span",{className:"nav-description",children:A.description})]})]},A.id))}),a.jsx("div",{className:"sidebar-footer",children:a.jsxs("div",{className:"user-permissions",children:[a.jsx("h4",{children:"Permisos Activos:"}),a.jsxs("div",{className:"permission-list",children:[o()&&a.jsx("span",{className:"permission admin",children:" Administrador"}),c()&&a.jsx("span",{className:"permission counter",children:" Gestin Operativa"}),y("canManageInventory")&&a.jsx("span",{className:"permission",children:" Inventario"}),y("canManageVehicles")&&a.jsx("span",{className:"permission",children:" Vehculos"})]})]})})]}),a.jsx("main",{className:"dashboard-main",children:a.jsx("div",{className:"main-content",children:n})})]}),d&&a.jsx("div",{className:"sidebar-overlay",onClick:()=>f(!1)})]})},ML=(n=[])=>{if(!Array.isArray(n)||n.length===0){console.warn(" Inventario vaco o no vlido");return}console.group(" Estado Actual del Inventario"),console.log(`Total de items: ${n.length}`);const e=n.reduce((o,c)=>o+(parseFloat(c.currentStock)||0),0);console.log(`Stock total: ${e.toFixed(2)} galones`);const t=n.filter(o=>typeof o.currentStock>"u"||isNaN(parseFloat(o.currentStock))||o.currentStock!==o.quantity&&typeof o.quantity<"u");t.length>0&&(console.warn(` ${t.length} items con posibles problemas de datos:`),t.forEach(o=>{console.warn(`- ${o.fuelType||o.name||"Item sin nombre"}: currentStock=${o.currentStock}, quantity=${o.quantity}`)}));const i={};n.forEach(o=>{const c=o.fuelType||"Desconocido";i[c]||(i[c]=0),i[c]+=parseFloat(o.currentStock)||0}),console.log("Stock por tipo de combustible:"),Object.entries(i).forEach(([o,c])=>{console.log(`- ${o}: ${c.toFixed(2)} gal`)}),console.groupEnd()},OL=(n=[])=>{if(!Array.isArray(n)||n.length===0)return[];const e={},t=[];return n.forEach(i=>{const o=`${i.fuelType||""}:${i.location||""}`;e[o]?(e[o].push(i),e[o].length===2?t.push(...e[o]):e[o].length>2&&t.push(i)):e[o]=[i]}),t},FE=()=>{const{inventory:n,movements:e,vehicles:t,loading:i,error:o}=ds();$.useEffect(()=>{if(!i&&n.length>0){console.log(" Ejecutando diagnstico del inventario..."),ML(n);const g=OL(n);g.length>0&&(console.warn(` Se detectaron ${g.length} posibles items duplicados:`),console.table(g.map(y=>({id:y.id,tipo:y.fuelType,ubicacion:y.location,stock:y.currentStock}))))}},[i,n]);const c=g=>g?g.toDate&&typeof g.toDate=="function"?g.toDate():g.seconds?new Date(g.seconds*1e3):g instanceof Date?g:new Date(g):new Date,d=$.useMemo(()=>{const g=t.filter(N=>N.status==="activo").length,y=e.filter(N=>N.status==="pendiente").length;console.log("Inventario en DashboardMain:",n.map(N=>({id:N.id,fuelType:N.fuelType,currentStock:N.currentStock,pricePerUnit:N.pricePerUnit||N.unitPrice})));const x=n.filter(N=>N.status==="active").reduce((N,C)=>{const T=parseFloat(C.currentStock)||0;return console.log(`Sumando stock de ${C.fuelType}: ${T} gal`),N+T},0),_=n.filter(N=>N.isActive!==!1).reduce((N,C)=>{const T=parseFloat(C.currentStock)||0,M=parseFloat(C.pricePerUnit||C.unitPrice)||0;return N+T*M},0),A=n.filter(N=>{const C=parseFloat(N.currentStock)||0,T=parseFloat(N.minStock)||parseFloat(N.minThreshold)||20;return N.isActive!==!1&&C<=T}).length;return{totalFuel:x,totalValue:_,lowStockAlerts:A,activeInventoryItems:n.filter(N=>N.isActive!==!1).length,activeVehicles:g,pendingMovements:y,totalMaintenance:0,overdueMaintenance:0}},[n,t,e]),f=$.useMemo(()=>e.sort((g,y)=>c(y.createdAt).getTime()-c(g.createdAt).getTime()).slice(0,5),[e]),p=g=>{const y=g.quantity||0,x=g.fuelType||"N/A";switch(g.type){case"entrada":return`Entrada de ${y} gal de ${x}.`;case"salida":return`Salida de ${y} gal para vehculo ${g.vehicleId||"N/A"}.`;case"transferencia":return`Transferencia de ${y} gal.`;case"ajuste":return`Ajuste de inventario: ${y} gal de ${x}.`;default:return"Movimiento registrado."}};return i?a.jsxs("div",{className:"dashboard-main",children:[a.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),a.jsx("p",{className:"dashboard-subtitle",children:"Cargando datos en tiempo real..."}),a.jsx("div",{className:"loading-spinner-container",children:a.jsx("div",{className:"loading-spinner"})})]}):o?a.jsxs("div",{className:"dashboard-main",children:[a.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),a.jsxs("div",{className:"error-message",children:[a.jsxs("p",{children:[" ",o]}),a.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})]}):a.jsxs("div",{className:"dashboard-main",children:[a.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),a.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del estado de combustibles y maquinaria."}),a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon fuel-icon",children:""}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Combustible Total"}),a.jsxs("h2",{children:[Oe(d.totalFuel)," gal"]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon value-icon",children:""}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Valor Inventario"}),a.jsx("h2",{children:Dn(d.totalValue)})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon vehicle-icon",children:""}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Vehculos Activos"}),a.jsx("h2",{children:Oe(d.activeVehicles)})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon movement-icon",children:""}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Movimientos Pendientes"}),a.jsx("h2",{children:Oe(d.pendingMovements)})]})]}),a.jsxs("div",{className:`stat-card ${d.lowStockAlerts>0?"alert":""}`,children:[a.jsx("div",{className:"stat-icon alert-icon",children:""}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Alertas de Stock"}),a.jsx("h2",{children:Oe(d.lowStockAlerts)})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon maintenance-icon",children:""}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Mantenimientos"}),a.jsx("h2",{children:Oe(d.totalMaintenance)})]})]}),a.jsxs("div",{className:`stat-card ${d.overdueMaintenance>0?"alert":""}`,children:[a.jsx("div",{className:"stat-icon maintenance-alert-icon",children:""}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Mantenimientos Vencidos"}),a.jsx("h2",{children:Oe(d.overdueMaintenance)})]})]})]}),a.jsxs("div",{className:"dashboard-content",children:[a.jsxs("div",{className:"dashboard-widget",children:[a.jsx("h3",{children:"Actividad Reciente"}),f.length>0?a.jsx("ul",{children:f.map(g=>a.jsxs("li",{children:[a.jsx("span",{className:`movement-type-badge ${g.type}`,children:g.type}),p(g),a.jsx("span",{className:"movement-date",children:c(g.createdAt).toLocaleDateString()})]},g.id))}):a.jsx("p",{children:"No hay movimientos recientes."})]}),a.jsxs("div",{className:"dashboard-widget",children:[a.jsx("h3",{children:" Stock por Producto"}),n.length>0?a.jsx("div",{className:"products-summary",children:n.map(g=>{const y=parseFloat(g.currentStock)||0,x=parseFloat(g.minStock||g.minThreshold)||20;return a.jsxs("div",{className:"product-summary-item",children:[a.jsx("div",{className:"product-icon",children:""}),a.jsxs("div",{className:"product-info",children:[a.jsx("span",{className:"product-name",children:g.fuelType||g.name}),a.jsxs("div",{className:"product-stats",children:[a.jsxs("span",{className:"stock-value",children:[Oe(y)," gal"]}),a.jsx("span",{className:`stock-status ${y<=x?"low":"normal"}`,children:y<=x?" Stock bajo":" Normal"})]})]})]},g.id)})}):a.jsx("div",{className:"no-products",children:a.jsx("p",{children:"No hay inventario registrado."})})]})]})]})},kL=({items:n,onEdit:e,onDelete:t,canManage:i})=>{const[o,c]=$.useState("name"),[d,f]=$.useState("asc"),p=N=>new Intl.NumberFormat("es-CO").format(N),g=N=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(N),y=N=>{if(!N)return"N/A";const C=new Date;let T;if(N&&typeof N=="object")if(N.seconds)T=new Date(N.seconds*1e3);else if(N.toDate&&typeof N.toDate=="function")T=N.toDate();else if(N instanceof Date)T=N;else return"N/A";else if(typeof N=="string"||typeof N=="number")T=new Date(N);else return"N/A";if(isNaN(T.getTime()))return"N/A";const M=C-T,q=Math.floor(M/(1e3*60*60)),U=Math.floor(q/24);return U>0?`${U}d`:q>0?`${q}h`:"ahora"},x=N=>{o===N?f(d==="asc"?"desc":"asc"):(c(N),f("asc"))},_=[...n].sort((N,C)=>{let T=N[o],M=C[o];if(o==="lastUpdated"){const q=U=>{if(!U)return new Date(0);if(U&&typeof U=="object"){if(U.seconds)return new Date(U.seconds*1e3);if(U.toDate&&typeof U.toDate=="function")return U.toDate();if(U instanceof Date)return U}return new Date(U)};T=q(T),M=q(M)}return T<M?d==="asc"?-1:1:T>M?d==="asc"?1:-1:0}),A=N=>o!==N?"":d==="asc"?"":"";return a.jsxs("div",{className:"inventory-table-container",children:[a.jsx("div",{className:"table-wrapper",children:a.jsxs("table",{className:"inventory-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{onClick:()=>x("name"),className:"sortable",children:["Combustible ",A("name")]}),a.jsxs("th",{onClick:()=>x("location"),className:"sortable",children:["Ubicacin ",A("location")]}),a.jsxs("th",{onClick:()=>x("currentStock"),className:"sortable",children:["Stock Actual ",A("currentStock")]}),a.jsxs("th",{onClick:()=>x("stockPercentage"),className:"sortable",children:["Nivel ",A("stockPercentage")]}),a.jsxs("th",{onClick:()=>x("pricePerUnit"),className:"sortable",children:["Precio ",A("pricePerUnit")]}),a.jsx("th",{children:"Valor Total"}),a.jsxs("th",{onClick:()=>x("status"),className:"sortable",children:["Estado ",A("status")]}),a.jsxs("th",{onClick:()=>x("lastUpdated"),className:"sortable",children:["Actualizado ",A("lastUpdated")]}),i&&a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:_.map(N=>{const C=il[N.fuelType],T=Ho[N.stockLevel],M=parseFloat(N.currentStock)||0,q=parseFloat(N.pricePerUnit)||0,U=parseFloat(N.maxCapacity)||0,P=parseFloat(N.stockPercentage)||0,F=M*q;return a.jsxs("tr",{className:N.needsRestock?"needs-restock":"",children:[a.jsx("td",{className:"fuel-cell",children:a.jsxs("div",{className:"fuel-info",children:[a.jsx("span",{className:"fuel-icon",style:{color:C?.color},children:C?.icon}),a.jsxs("div",{children:[a.jsx("div",{className:"fuel-name",children:C?.name}),a.jsx("div",{className:"fuel-type",children:N.fuelType})]})]})}),a.jsx("td",{children:N.location}),a.jsxs("td",{className:"stock-cell",children:[a.jsxs("div",{className:"stock-info",children:[a.jsx("span",{className:"stock-amount",children:p(M)}),a.jsxs("span",{className:"stock-unit",children:["/ ",p(U)," ",N.unit||"gal"]})]}),N.needsRestock&&a.jsx("div",{className:"restock-indicator",children:" Bajo mnimo"})]}),a.jsx("td",{className:"level-cell",children:a.jsxs("div",{className:"level-info",children:[a.jsxs("div",{className:"level-badge",style:{backgroundColor:T?.color,color:"white"},children:[P,"%"]}),a.jsx("div",{className:"level-bar",children:a.jsx("div",{className:"level-fill",style:{width:`${P}%`,backgroundColor:T?.color}})})]})}),a.jsx("td",{className:"price-cell",children:a.jsxs("div",{className:"price-info",children:[a.jsx("span",{className:"price-amount",children:g(q)}),a.jsxs("span",{className:"price-unit",children:["/ ",N.unit||"gal"]})]})}),a.jsx("td",{className:"value-cell",children:a.jsx("span",{className:"total-value",children:g(F)})}),a.jsx("td",{className:"status-cell",children:a.jsxs("span",{className:`status-badge ${N.status}`,children:[a.jsx("span",{className:"status-dot"}),N.status==="active"?"Activo":N.status==="inactive"?"Inactivo":N.status==="maintenance"?"Mantenimiento":N.status]})}),a.jsx("td",{className:"updated-cell",children:a.jsx("span",{className:"time-ago",children:y(N.lastUpdated)})}),i&&a.jsx("td",{className:"actions-cell",children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(N),title:"Editar",children:""}),a.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(N),title:"Eliminar",children:""})]})})]},N.id)})})]})}),a.jsxs("div",{className:"table-footer",children:[a.jsxs("div",{className:"table-info",children:[_.length," items ordenados por ",o,"(",d==="asc"?"ascendente":"descendente",")"]}),a.jsxs("div",{className:"table-legend",children:[a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot critical"}),"Crtico"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot low"}),"Bajo"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot normal"}),"Normal"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},PL=({items:n,onEdit:e,onDelete:t,canManage:i})=>{const o=f=>new Intl.NumberFormat("es-CO").format(f),c=f=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(f),d=f=>{if(!f)return"sin fecha";try{const p=new Date;let g;f.seconds?g=new Date(f.seconds*1e3):f.toDate&&typeof f.toDate=="function"?g=f.toDate():g=new Date(f);const y=p-g,x=Math.floor(y/(1e3*60*60)),_=Math.floor(x/24);return _>0?`hace ${_} da${_>1?"s":""}`:x>0?`hace ${x} hora${x>1?"s":""}`:"hace unos minutos"}catch(p){return console.warn("Error al calcular tiempo transcurrido:",p),"fecha invlida"}};return a.jsx("div",{className:"inventory-cards-grid",children:n.map(f=>{const p=il[f.fuelType],g=Ho[f.stockLevel],y=parseFloat(f.currentStock)||0,x=parseFloat(f.pricePerUnit)||parseFloat(f.unitPrice)||0,_=parseFloat(f.maxCapacity)||parseFloat(f.capacity)||0,A=parseFloat(f.stockPercentage)||0,N=y*x;return a.jsxs("div",{className:"inventory-card",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("div",{className:"fuel-info",children:[a.jsx("span",{className:"fuel-icon",style:{color:p?.color},children:p?.icon}),a.jsxs("div",{className:"fuel-details",children:[a.jsx("h3",{children:p?.name}),a.jsx("p",{className:"location",children:f.location})]})]}),a.jsx("div",{className:"stock-status",children:a.jsxs("span",{className:"status-badge",style:{backgroundColor:g?.color,color:"white"},children:[g?.icon," ",g?.label]})})]}),a.jsxs("div",{className:"stock-progress",children:[a.jsxs("div",{className:"progress-header",children:[a.jsxs("span",{className:"stock-text",children:[o(y)," / ",o(_)," ",f.unit||"gal"]}),a.jsxs("span",{className:"percentage",children:[A,"%"]})]}),a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill",style:{width:`${A}%`,backgroundColor:g?.color}})}),f.needsRestock&&a.jsxs("div",{className:"restock-warning",children:[" Bajo nivel mnimo (",o(f.minThreshold||f.minStock||0)," ",f.unit||"gal",")"]})]}),a.jsxs("div",{className:"card-metrics",children:[a.jsxs("div",{className:"metric",children:[a.jsxs("span",{className:"metric-label",children:["Precio por ",f.unit||"gal",":"]}),a.jsx("span",{className:"metric-value",children:c(x)})]}),a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Valor total:"}),a.jsx("span",{className:"metric-value",children:c(N)})]}),f.supplier&&a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Proveedor:"}),a.jsx("span",{className:"metric-value",children:f.supplier})]})]}),a.jsxs("div",{className:"card-footer",children:[a.jsxs("div",{className:"status-info",children:[a.jsx("span",{className:`status-dot ${f.status}`}),a.jsx("span",{className:"status-text",children:f.status==="active"?"Activo":f.status==="inactive"?"Inactivo":f.status==="maintenance"?"Mantenimiento":f.status})]}),a.jsxs("div",{className:"last-update",children:["Actualizado ",d(f.updatedAt||f.lastUpdated)]})]}),i&&a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>e(f),title:"Editar combustible",children:" Editar"}),a.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>t(f),title:"Eliminar combustible",children:" Eliminar"})]}),f.description&&f.description!==p?.description&&a.jsx("div",{className:"card-description",children:a.jsx("p",{children:f.description})})]},f.id)})})},LL=({item:n,onClose:e,onSuccess:t})=>{const{userProfile:i}=ds(),o=!!n,[c,d]=$.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[f,p]=$.useState({}),[g,y]=$.useState(!1);$.useEffect(()=>{o&&n&&d({fuelType:n.fuelType||"",location:n.location||"",currentStock:n.currentStock||"",maxCapacity:n.maxCapacity||"",minThreshold:n.minThreshold||"",pricePerUnit:n.pricePerUnit||"",supplier:n.supplier||"",description:n.description||"",status:n.status||"active"})},[o,n]),$.useEffect(()=>{if(c.maxCapacity&&!c.minThreshold){const C=Math.round(Number(c.maxCapacity)*.15);d(T=>({...T,minThreshold:C}))}},[c.maxCapacity]);const x=C=>{const{name:T,value:M}=C.target;d(q=>({...q,[T]:M})),f[T]&&p(q=>({...q,[T]:null}))},_=()=>{const C={};c.fuelType||(C.fuelType="Tipo de combustible es requerido"),c.location||(C.location="Ubicacin es requerida"),c.maxCapacity||(C.maxCapacity="Capacidad mxima es requerida");const T=Number(c.currentStock),M=Number(c.maxCapacity),q=Number(c.minThreshold),U=Number(c.pricePerUnit);return c.currentStock&&(isNaN(T)||T<0)&&(C.currentStock="Stock actual debe ser un nmero vlido mayor o igual a 0"),c.maxCapacity&&(isNaN(M)||M<=0)&&(C.maxCapacity="Capacidad mxima debe ser un nmero vlido mayor a 0"),c.minThreshold&&(isNaN(q)||q<0)&&(C.minThreshold="Umbral mnimo debe ser un nmero vlido mayor o igual a 0"),c.pricePerUnit&&(isNaN(U)||U<0)&&(C.pricePerUnit="Precio debe ser un nmero vlido mayor o igual a 0"),T>M&&(C.currentStock="Stock actual no puede ser mayor a la capacidad mxima"),q>M&&(C.minThreshold="Umbral mnimo no puede ser mayor a la capacidad mxima"),p(C),Object.keys(C).length===0},A=async C=>{if(C.preventDefault(),!!_()){y(!0);try{let T;o?T=await NL(n.id,{location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},i.uid):T=await bL({fuelType:c.fuelType,location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},i.uid),T.success?(alert(T.message),t()):alert(`Error: ${T.error}`)}catch(T){console.error("Error saving inventory item:",T),alert("Error inesperado al guardar el item")}finally{y(!1)}}},N=il[c.fuelType];return a.jsx("div",{className:"modal-overlay",onClick:e,children:a.jsxs("div",{className:"modal-content inventory-modal",onClick:C=>C.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:o?" Editar Combustible":" Agregar Nuevo Combustible"}),a.jsx("button",{className:"modal-close",onClick:e,children:""})]}),a.jsxs("form",{onSubmit:A,className:"modal-form",children:[a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",N&&a.jsxs("span",{className:"fuel-preview",children:[N.icon," ",N.name]})]}),a.jsxs("select",{id:"fuelType",name:"fuelType",value:c.fuelType,onChange:x,disabled:o,className:f.fuelType?"error":"",required:!0,children:[a.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(_n).map(([C,T])=>{const M=il[T];return a.jsxs("option",{value:T,children:[M.icon," ",M.name," (",M.unit,")"]},C)})]}),f.fuelType&&a.jsx("span",{className:"error-text",children:f.fuelType})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"location",children:"Ubicacin / Tanque *"}),a.jsx("input",{type:"text",id:"location",name:"location",value:c.location,onChange:x,placeholder:"ej. Tanque Principal, Depsito A, Bodega Norte",className:f.location?"error":"",required:!0}),f.location&&a.jsx("span",{className:"error-text",children:f.location})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",N&&`(${N.unit})`]}),a.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:c.currentStock,onChange:x,placeholder:"0",min:"0",step:"0.01",className:f.currentStock?"error":""}),f.currentStock&&a.jsx("span",{className:"error-text",children:f.currentStock})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad Mxima * ",N&&`(${N.unit})`]}),a.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:c.maxCapacity,onChange:x,placeholder:"1000",min:"1",step:"0.01",className:f.maxCapacity?"error":"",required:!0}),f.maxCapacity&&a.jsx("span",{className:"error-text",children:f.maxCapacity})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"minThreshold",children:["Umbral Mnimo ",N&&`(${N.unit})`,a.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),a.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:c.minThreshold,onChange:x,placeholder:"Auto: 15% de capacidad mxima",min:"0",step:"0.01",className:f.minThreshold?"error":""}),f.minThreshold&&a.jsx("span",{className:"error-text",children:f.minThreshold}),c.maxCapacity&&a.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(c.maxCapacity)*.15)," ",N?.unit||"unidades"]})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",N?.unit||"Unidad"]}),a.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:c.pricePerUnit,onChange:x,placeholder:"12000",min:"0",step:"0.01",className:f.pricePerUnit?"error":""}),f.pricePerUnit&&a.jsx("span",{className:"error-text",children:f.pricePerUnit})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),a.jsx("input",{type:"text",id:"supplier",name:"supplier",value:c.supplier,onChange:x,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"status",children:"Estado"}),a.jsxs("select",{id:"status",name:"status",value:c.status,onChange:x,children:[a.jsx("option",{value:"active",children:"Activo"}),a.jsx("option",{value:"inactive",children:"Inactivo"}),a.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),a.jsxs("div",{className:"form-group full-width",children:[a.jsx("label",{htmlFor:"description",children:"Descripcin / Notas"}),a.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:x,placeholder:"Informacin adicional sobre este combustible...",rows:"3"})]})]}),N&&c.maxCapacity&&a.jsxs("div",{className:"form-preview",children:[a.jsx("h4",{children:" Vista Previa"}),a.jsxs("div",{className:"preview-card",children:[a.jsxs("div",{className:"preview-header",children:[a.jsxs("span",{style:{color:N.color},children:[N.icon," ",N.name]}),a.jsx("span",{children:c.location})]}),a.jsxs("div",{className:"preview-capacity",children:[c.currentStock||0," / ",c.maxCapacity," ",N.unit,c.currentStock&&c.maxCapacity&&a.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(c.currentStock)/Number(c.maxCapacity)*100),"%)"]})]}),c.pricePerUnit&&a.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(c.currentStock)||0)*Number(c.pricePerUnit))]})]})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:g,children:g?"Guardando...":o?"Actualizar":"Crear"})]})]})]})})},VL=({stats:n})=>a.jsxs("div",{className:"inventory-stats",children:[a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card primary",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:"Valor Total"}),a.jsx("div",{className:"stat-value",children:Dn(n.totalValue)}),a.jsxs("div",{className:"stat-subtitle",children:[Oe(n.totalItems)," tipos de combustible"]})]})]}),a.jsxs("div",{className:"stat-card success",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:"Items Activos"}),a.jsx("div",{className:"stat-value",children:n.activeItems}),a.jsxs("div",{className:"stat-subtitle",children:[Math.round(n.activeItems/n.totalItems*100),"% del total"]})]})]}),a.jsxs("div",{className:`stat-card ${n.lowStockItems>0?"warning":"info"}`,children:[a.jsx("div",{className:"stat-icon",children:n.lowStockItems>0?"":""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:"Stock Bajo"}),a.jsx("div",{className:"stat-value",children:n.lowStockItems}),a.jsx("div",{className:"stat-subtitle",children:n.lowStockItems>0?"Requieren atencin":"Niveles normales"})]})]}),a.jsxs("div",{className:"stat-card info",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:"Nivel Promedio"}),a.jsxs("div",{className:"stat-value",children:[n.averageStockLevel,"%"]}),a.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),a.jsxs("div",{className:"fuel-type-summary",children:[a.jsx("h4",{children:" Resumen por Tipo de Combustible"}),a.jsx("div",{className:"fuel-types-grid",children:Object.entries(n.byFuelType).map(([e,t])=>{const i=il[e],o=t.totalCapacity>0?Math.round(t.totalStock/t.totalCapacity*100):0;return a.jsxs("div",{className:"fuel-type-card",children:[a.jsxs("div",{className:"fuel-header",children:[a.jsx("span",{className:"fuel-icon",style:{color:i?.color||"#6b7280"},children:i?.icon||""}),a.jsxs("div",{className:"fuel-info",children:[a.jsx("h5",{children:i?.name||e}),a.jsxs("span",{className:"fuel-count",children:[t.count," ubicaciones"]})]})]}),a.jsxs("div",{className:"fuel-metrics",children:[a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Stock Total:"}),a.jsxs("span",{className:"metric-value",children:[Oe(t.totalStock)," ",i?.unit||"unidades"]})]}),a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Capacidad:"}),a.jsxs("span",{className:"metric-value",children:[Oe(t.totalCapacity)," ",i?.unit||"unidades"]})]}),a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Utilizacin:"}),a.jsxs("span",{className:`metric-value ${o<25?"low":o>75?"high":"normal"}`,children:[o,"%"]})]}),a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Valor:"}),a.jsx("span",{className:"metric-value",children:Dn(t.totalValue)})]})]}),a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill",style:{width:`${o}%`,backgroundColor:i?.color||"#6b7280"}})})]},e)})}),Object.keys(n.byFuelType).length===0&&a.jsx("div",{className:"empty-fuel-types",children:a.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),UL=()=>{const{hasPermission:n}=ds(),[e,t]=$.useState([]),[i,o]=$.useState(null),[c,d]=$.useState(!0),[f,p]=$.useState(null),[g,y]=$.useState("cards"),[x,_]=$.useState(!1),[A,N]=$.useState(null),[C,T]=$.useState("all"),[M,q]=$.useState("");$.useEffect(()=>{let S=null;return(()=>{S=SA((O,w)=>{if(w){console.error("Error in inventory subscription:",w),p("Error cargando inventario en tiempo real");return}t(O||[]),d(!1)})})(),()=>{S&&S()}},[]),$.useEffect(()=>{(async()=>{const L=await EL();L.success&&o(L.data)})()},[e]);const U=e.filter(S=>{if(C==="active"&&S.status!=="active"||C==="low-stock"&&!S.needsRestock)return!1;if(M){const L=M.toLowerCase();return S.name.toLowerCase().includes(L)||S.location.toLowerCase().includes(L)||S.fuelType.toLowerCase().includes(L)}return!0}),P=S=>{if(!n("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}N(S),_(!0)},F=async S=>{if(!n("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`Ests seguro de eliminar ${S.name} de ${S.location}?

Esta accin no se puede deshacer.`))return;d(!0);const O=await _L(S.id);O.success?alert("Item eliminado exitosamente"):(p(O.error),alert(`Error al eliminar: ${O.error}`)),d(!1)},G=()=>{_(!1),N(null)},V=()=>{G()};return c&&e.length===0?a.jsxs("div",{className:"inventory-loading",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando inventario..."})]}):a.jsxs("div",{className:"inventory-main",children:[a.jsxs("div",{className:"inventory-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h2",{children:" Gestin de Inventario"}),a.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),a.jsx("div",{className:"inventory-info",children:a.jsxs("span",{className:"info-text",children:[" Los combustibles se agregan automticamente desde la pestaa ",a.jsx("strong",{children:"Movimientos"})]})})]}),i&&a.jsx(VL,{stats:i}),a.jsxs("div",{className:"inventory-controls",children:[a.jsxs("div",{className:"search-filters",children:[a.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicacin o tipo...",value:M,onChange:S=>q(S.target.value),className:"search-input"}),a.jsxs("select",{value:C,onChange:S=>T(S.target.value),className:"filter-select",children:[a.jsx("option",{value:"all",children:"Todos los items"}),a.jsx("option",{value:"active",children:"Solo activos"}),a.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),a.jsxs("div",{className:"view-toggle",children:[a.jsx("button",{className:`toggle-btn ${g==="cards"?"active":""}`,onClick:()=>y("cards"),children:" Cards"}),a.jsx("button",{className:`toggle-btn ${g==="table"?"active":""}`,onClick:()=>y("table"),children:" Tabla"})]})]}),f&&a.jsxs("div",{className:"error-banner",children:[a.jsxs("span",{children:[" ",f]}),a.jsx("button",{onClick:()=>p(null),children:""})]}),a.jsx("div",{className:"inventory-content",children:U.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:""}),a.jsx("h3",{children:"No hay items de inventario"}),a.jsx("p",{children:M||C!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaa Movimientos para crear una ENTRADA de combustible"})]}):a.jsx(a.Fragment,{children:g==="cards"?a.jsx(PL,{items:U,onEdit:P,onDelete:F,canManage:n("canManageInventory")}):a.jsx(kL,{items:U,onEdit:P,onDelete:F,canManage:n("canManageInventory")})})}),U.length>0&&a.jsx("div",{className:"results-footer",children:a.jsxs("p",{children:["Mostrando ",U.length," de ",e.length," items",M&&`  Filtro: "${M}"`,C!=="all"&&`  Estado: ${C}`]})}),x&&a.jsx(LL,{item:A,onClose:G,onSuccess:V})]})},FL=({stats:n,filters:e})=>{if(!n)return null;const t=(d,f)=>f===0?d>0?100:0:((d-f)/f*100).toFixed(1),i=d=>{switch(d){case ue.ENTRADA:return"#10b981";case ue.SALIDA:return"#ef4444";case ue.TRANSFERENCIA:return"#3b82f6";case ue.AJUSTE:return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case ue.ENTRADA:return"";case ue.SALIDA:return"";case ue.TRANSFERENCIA:return"";case ue.AJUSTE:return"";default:return""}},c=t(n.thisMonth,n.lastMonth);return a.jsxs("div",{className:"movements-stats",children:[a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card primary",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:Oe(n.totalMovements)}),a.jsx("div",{className:"stat-label",children:"Total Movimientos"}),a.jsxs("div",{className:"stat-trend",children:[a.jsxs("span",{className:`trend ${c>=0?"positive":"negative"}`,children:[c>=0?"":""," ",Math.abs(c),"%"]}),a.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:Dn(n.totalValue)}),a.jsx("div",{className:"stat-label",children:"Valor Total"}),a.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Dn(n.averageValue)]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:Oe(n.totalQuantity)}),a.jsx("div",{className:"stat-label",children:"Galones Total"}),a.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Oe(n.totalQuantity/(n.totalMovements||1))," gal/mov"]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:Oe(n.thisWeek)}),a.jsx("div",{className:"stat-label",children:"Esta Semana"}),a.jsxs("div",{className:"stat-secondary",children:[Oe(n.thisMonth)," este mes"]})]})]})]}),a.jsxs("div",{className:"stats-breakdown",children:[a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:" Por Tipo de Movimiento"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1);return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:o(d)}),a.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),a.jsx("div",{className:"breakdown-value",children:f}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:i(d)}})}),a.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:" Por Estado"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),g=x=>{switch(x){case gt.COMPLETADO:return"#10b981";case gt.PENDIENTE:return"#f59e0b";case gt.CANCELADO:return"#ef4444";default:return"#6b7280"}},y=x=>{switch(x){case gt.COMPLETADO:return"";case gt.PENDIENTE:return"";case gt.CANCELADO:return"";default:return""}};return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:y(d)}),a.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),a.jsx("div",{className:"breakdown-value",children:f}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:g(d)}})}),a.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:" Por Tipo de Combustible"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),g=y=>{switch(y?.toLowerCase()){case"diesel":return"";case"gasolina":return"";case"acpm":return"";case"lubricante":return"";default:return""}};return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:g(d)}),a.jsx("span",{className:"breakdown-label",children:d})]}),a.jsx("div",{className:"breakdown-value",children:f}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:"#059669"}})}),a.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]})]}),(e.type||e.status||e.fuelType||e.vehicleId)&&a.jsxs("div",{className:"active-filters",children:[a.jsx("h4",{children:" Filtros Activos"}),a.jsxs("div",{className:"filters-list",children:[e.type&&a.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&a.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&a.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.vehicleId&&a.jsxs("span",{className:"filter-tag",children:["Vehculo: ",e.vehicleId]})]})]})]})},qL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:i,onSearchChange:o,totalResults:c})=>{const[d,f]=$.useState(!1),p=[{value:"Diesel",label:"Diesel "},{value:"Gasolina",label:"Gasolina "},{value:"ACPM",label:"ACPM "},{value:"Lubricante",label:"Lubricante "}],g=[{value:"all",label:"Todos los perodos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este ao"}],y=Object.values(n).filter(A=>A&&A!==""&&A!=="all").length,x=(A,N)=>{e({[A]:N})},_=A=>{e(A)};return a.jsxs("div",{className:"movements-filters",children:[a.jsxs("div",{className:"filters-main",children:[a.jsx("div",{className:"search-section",children:a.jsxs("div",{className:"search-box",children:[a.jsx("span",{className:"search-icon",children:""}),a.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehculo, referencia...",value:i,onChange:A=>o(A.target.value),className:"search-input"}),i&&a.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar bsqueda",children:""})]})}),a.jsxs("div",{className:"filters-controls",children:[a.jsxs("div",{className:"quick-filters",children:[a.jsx("button",{className:`quick-filter ${n.type===ue.ENTRADA?"active":""}`,onClick:()=>_({type:ue.ENTRADA}),children:" Entradas"}),a.jsx("button",{className:`quick-filter ${n.type===ue.SALIDA?"active":""}`,onClick:()=>_({type:ue.SALIDA}),children:" Salidas"}),a.jsx("button",{className:`quick-filter ${n.status===gt.PENDIENTE?"active":""}`,onClick:()=>_({status:gt.PENDIENTE}),children:" Pendientes"})]}),a.jsxs("button",{className:`btn-advanced-filters ${d?"active":""}`,onClick:()=>f(!d),children:[" Filtros",y>0&&a.jsx("span",{className:"filters-count",children:y})]}),a.jsx("div",{className:"view-indicator",children:a.jsx("span",{className:"view-info",children:" Vista Tabla"})})]})]}),d&&a.jsxs("div",{className:"filters-advanced",children:[a.jsxs("div",{className:"filters-grid",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Tipo de Movimiento"}),a.jsxs("select",{value:n.type,onChange:A=>x("type",A.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los tipos"}),a.jsx("option",{value:ue.ENTRADA,children:" Entrada"}),a.jsx("option",{value:ue.SALIDA,children:" Salida"}),a.jsx("option",{value:ue.TRANSFERENCIA,children:" Transferencia"}),a.jsx("option",{value:ue.AJUSTE,children:" Ajuste"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Estado"}),a.jsxs("select",{value:n.status,onChange:A=>x("status",A.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los estados"}),a.jsx("option",{value:gt.PENDIENTE,children:" Pendiente"}),a.jsx("option",{value:gt.COMPLETADO,children:" Completado"}),a.jsx("option",{value:gt.CANCELADO,children:" Cancelado"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Tipo de Combustible"}),a.jsxs("select",{value:n.fuelType,onChange:A=>x("fuelType",A.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los combustibles"}),p.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Perodo"}),a.jsx("select",{value:n.dateRange,onChange:A=>x("dateRange",A.target.value),className:"filter-select",children:g.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Vehculo/Equipo"}),a.jsx("input",{type:"text",placeholder:"ID del vehculo...",value:n.vehicleId,onChange:A=>x("vehicleId",A.target.value),className:"filter-input"})]})]}),a.jsxs("div",{className:"filters-actions",children:[a.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:y===0,children:" Limpiar Filtros"}),a.jsxs("div",{className:"filters-info",children:[a.jsxs("span",{className:"results-count",children:[c," resultado",c!==1?"s":""]}),y>0&&a.jsxs("span",{className:"active-filters-text",children:["(",y," filtro",y!==1?"s":""," activo",y!==1?"s":"",")"]})]})]})]}),a.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:a.jsx("small",{children:" Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},zL=({movements:n,onEdit:e,onView:t,onApprove:i,onReject:o,onDelete:c,userRole:d})=>{const[f,p]=$.useState("createdAt"),[g,y]=$.useState("desc"),x=P=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(P),_=P=>P?(P instanceof Date?P:new Date(P)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",A=P=>{switch(P){case ue.ENTRADA:return"";case ue.SALIDA:return"";case ue.TRANSFERENCIA:return"";case ue.AJUSTE:return"";default:return""}},N=P=>{switch(P?.toLowerCase()){case"diesel":return"";case"gasolina":return"";case"acpm":return"";case"lubricante":return"";default:return""}},C=P=>{switch(P){case gt.COMPLETADO:return"";case gt.PENDIENTE:return"";case gt.CANCELADO:return"";default:return""}},T=P=>{switch(P){case gt.COMPLETADO:return"status-completado";case gt.PENDIENTE:return"status-pendiente";case gt.CANCELADO:return"status-cancelado";default:return"status-default"}},M=P=>{f===P?y(g==="asc"?"desc":"asc"):(p(P),y("asc"))},q=[...n].sort((P,F)=>{let G=P[f],V=F[f];return(f.includes("Date")||f.includes("At"))&&(G=new Date(G),V=new Date(V)),typeof G=="number"&&typeof V=="number"?g==="asc"?G-V:V-G:typeof G=="string"&&typeof V=="string"?g==="asc"?G.localeCompare(V):V.localeCompare(G):G instanceof Date&&V instanceof Date?g==="asc"?G-V:V-G:0}),U=P=>f!==P?"":g==="asc"?"":"";return a.jsxs("div",{className:"movements-table-container",children:[a.jsx("div",{className:"table-wrapper",children:a.jsxs("table",{className:"movements-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{className:"sortable",onClick:()=>M("type"),children:["Tipo ",U("type")]}),a.jsxs("th",{className:"sortable",onClick:()=>M("fuelType"),children:["Combustible ",U("fuelType")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>M("quantity"),children:["Cantidad ",U("quantity")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>M("unitPrice"),children:["Precio/Gal ",U("unitPrice")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>M("totalValue"),children:["Valor Total ",U("totalValue")]}),a.jsx("th",{children:"Vehculo"}),a.jsx("th",{children:"Ubicacin"}),a.jsxs("th",{className:"sortable",onClick:()=>M("status"),children:["Estado ",U("status")]}),a.jsxs("th",{className:"sortable",onClick:()=>M("createdAt"),children:["Fecha ",U("createdAt")]}),a.jsx("th",{className:"actions-column",children:"Acciones"})]})}),a.jsx("tbody",{children:q.map(P=>a.jsxs("tr",{className:`movement-row ${P.status===gt.PENDIENTE?"pending-row":""}`,children:[a.jsx("td",{className:"type-cell",children:a.jsxs("div",{className:"type-content",children:[a.jsx("span",{className:"type-icon",children:A(P.type)}),a.jsx("span",{className:"type-text",children:P.type.charAt(0).toUpperCase()+P.type.slice(1)})]})}),a.jsx("td",{className:"fuel-cell",children:a.jsxs("div",{className:"fuel-content",children:[a.jsx("span",{className:"fuel-icon",children:N(P.fuelType)}),a.jsx("span",{className:"fuel-text",children:P.fuelType})]})}),a.jsxs("td",{className:"quantity-cell text-right",children:[a.jsx("span",{className:"quantity-value",children:P.quantity}),a.jsx("span",{className:"quantity-unit",children:"gal"})]}),a.jsx("td",{className:"price-cell text-right",children:x(P.unitPrice)}),a.jsx("td",{className:"value-cell text-right",children:a.jsx("strong",{children:x(P.totalValue)})}),a.jsx("td",{className:"vehicle-cell",children:P.vehicleId?a.jsxs("span",{className:"vehicle-id",children:[" ",P.vehicleId]}):a.jsx("span",{className:"no-vehicle",children:"-"})}),a.jsx("td",{className:"location-cell",children:a.jsxs("span",{className:"location-text",children:[" ",P.type===ue.ENTRADA?P.destinationLocation||"Sin ubicacin":P.location||"Principal"]})}),a.jsx("td",{className:"status-cell",children:a.jsxs("div",{className:`status-badge ${T(P.status)}`,children:[a.jsx("span",{className:"status-icon",children:C(P.status)}),a.jsx("span",{className:"status-text",children:P.status.charAt(0).toUpperCase()+P.status.slice(1)})]})}),a.jsx("td",{className:"date-cell",children:a.jsxs("div",{className:"date-content",children:[a.jsx("span",{className:"date-value",children:_(P.createdAt)}),P.reference&&a.jsxs("span",{className:"reference-small",children:["#",P.reference]})]})}),a.jsx("td",{className:"actions-cell",children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"btn-action btn-view",onClick:()=>t(P),title:"Ver detalles",children:""}),d==="admin"&&P.status===gt.PENDIENTE&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"btn-action btn-approve",onClick:()=>i(P.id),title:"Aprobar movimiento",children:""}),a.jsx("button",{className:"btn-action btn-reject",onClick:()=>o(P.id),title:"Rechazar movimiento",children:""})]}),e&&P.status===gt.PENDIENTE&&a.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(P),title:"Editar movimiento",children:""}),d==="admin"&&a.jsx("button",{className:"btn-action btn-delete",onClick:()=>{window.confirm("Ests seguro de que deseas eliminar este movimiento? Esta accin no se puede deshacer.")&&c(P.id)},title:"Eliminar movimiento",children:""})]})})]},P.id))})]})}),a.jsxs("div",{className:"table-info",children:[a.jsxs("div",{className:"table-summary",children:[a.jsxs("span",{className:"total-rows",children:[n.length," movimiento",n.length!==1?"s":""]}),f&&a.jsxs("span",{className:"sort-info",children:["Ordenado por ",f," (",g==="asc"?"ascendente":"descendente",")"]})]}),a.jsxs("div",{className:"table-legend",children:[a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:""})," Pendiente"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:""})," Completado"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:""})," Cancelado"]})]})]})]})},BL=({movements:n,onEdit:e,onView:t,onApprove:i,onReject:o,onDelete:c,userRole:d})=>a.jsx(zL,{movements:n,onEdit:e,onView:t,onApprove:i,onReject:o,onDelete:c,userRole:d}),Aa={ACPM:"ACPM",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},zA={[Aa.ACPM]:{name:"ACPM",displayName:"ACPM ",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"",description:"Combustible diesel para vehculos pesados"},[Aa.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina ",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"",description:"Gasolina corriente para vehculos livianos"},[Aa.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidrulico ",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"",description:"Aceite hidrulico para sistemas de maquinaria"},[Aa.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 ",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"",description:"Aceite multigrado para motores"},[Aa.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja ",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"",description:"Grasa lubricante multipropsito"},[Aa.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"",description:"Aceite para transmisiones y diferenciales"},[Aa.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Lquido para Frenos ",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"",description:"Lquido de frenos DOT 3/4"},[Aa.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga ",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"",description:"Mezcla de combustible para equipos menores"},[Aa.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 ",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"",description:"Aceite especializado para tractores"}},Bs={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},qE=()=>Object.values(zA),zE="combustibles_products",HL=async()=>{try{console.log(" Verificando productos existentes...");const n=Te(Me(me,zE),LO(1));if(!(await ft(n)).empty){console.log(" Productos ya existen en Firebase");return}console.log(" Creando productos predefinidos...");const t=Object.values(zA).map(async o=>{const c={name:o.name,displayName:o.displayName,category:o.category,unit:o.unit,defaultPrice:o.defaultPrice,color:o.color,icon:o.icon,description:o.description,isActive:!0,createdAt:new Date,updatedAt:new Date,createdBy:"system-initialization"},d=Je(Me(me,zE));return await gf(d,c),console.log(` Producto creado: ${o.displayName}`),{id:d.id,...c}}),i=await Promise.all(t);return console.log(` ${i.length} productos inicializados correctamente`),i}catch(n){throw console.error(" Error inicializando productos:",n),n}},GL=async()=>{try{await HL()}catch(n){console.error(" Error en inicializacin automtica:",n)}},ll="combustibles_products",Zp=async n=>{try{const e={...n,createdAt:Ue(),updatedAt:Ue()},t=await pl(Me(me,ll),e);return console.log("Product created with ID:",t.id),t.id}catch(e){throw console.error("Error creating product:",e),e}},$L=async(n,e)=>{try{const t=Je(me,ll,n);await js(t,{...e,updatedAt:Ue()}),console.log("Product updated successfully")}catch(t){throw console.error("Error updating product:",t),t}},YL=async n=>{try{await vf(Je(me,ll,n)),console.log("Product deleted successfully")}catch(e){throw console.error("Error deleting product:",e),e}},QL=async()=>{try{await GL(),console.log(" Obteniendo productos activos...");const n=Te(Me(me,ll),Ie("isActive","==",!0),jn("name")),t=(await ft(n)).docs.map(i=>({id:i.id,...i.data()}));return console.log(` Productos activos obtenidos: ${t.length}`),t}catch(n){if(console.error(" Error obteniendo productos activos:",n),n.code==="failed-precondition"||n.message.includes("index")){console.warn(" ndice no disponible, usando consulta alternativa...");try{const e=Te(Me(me,ll),Ie("isActive","==",!0)),o=(await ft(e)).docs.map(c=>({id:c.id,...c.data()})).sort((c,d)=>(c.name||"").localeCompare(d.name||""));return console.log(` Productos activos obtenidos (ordenamiento en cliente): ${o.length}`),o}catch(e){throw console.error(" Error en consulta alternativa:",e),e}}throw n}},KL=(n,e)=>{try{const t=Te(Me(me,ll),jn("name"));return qr(t,i=>{const o=i.docs.map(c=>({id:c.id,...c.data()}));n(o)},i=>{console.error("Error in products subscription:",i),e(i)})}catch(t){return console.error("Error setting up products subscription:",t),e(t),()=>{}}},XL=({formData:n,updateFormData:e,setError:t})=>{const i=[{type:ue.ENTRADA,icon:"",title:"Entrada",description:"Compra o reabastecimiento de combustible",color:"entrada",details:"Registra combustible que llega desde proveedores"},{type:ue.SALIDA,icon:"",title:"Salida",description:"Consumo de combustible por vehculos",color:"salida",details:"Asigna combustible a vehculos y equipos"},{type:ue.TRANSFERENCIA,icon:"",title:"Transferencia",description:"Movimiento entre ubicaciones",color:"transferencia",details:"Traslada combustible entre tanques o sitios"},{type:ue.AJUSTE,icon:"",title:"Ajuste",description:"Correccin de inventario",color:"ajuste",details:"Ajusta stock por mermas, prdidas o calibraciones"}],o=c=>{e("type",c),t("")};return a.jsx("div",{className:"wizard-step step-movement-type",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:" Qu tipo de operacin realizars?"}),a.jsx("p",{children:"Selecciona el tipo de movimiento que necesitas registrar:"})]}),a.jsx("div",{className:"movement-options",children:i.map(c=>a.jsxs("div",{className:`movement-option ${n.type===c.type?"selected":""} ${c.color}`,onClick:()=>o(c.type),children:[a.jsx("div",{className:"option-icon",children:c.icon}),a.jsxs("div",{className:"option-content",children:[a.jsx("h4",{children:c.title}),a.jsx("p",{className:"option-description",children:c.description}),a.jsx("small",{className:"option-details",children:c.details})]}),a.jsx("div",{className:"option-selector",children:n.type===c.type&&a.jsx("span",{className:"check-icon",children:""})})]},c.type))}),n.type&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card",children:[a.jsx("span",{className:"confirmation-icon",children:i.find(c=>c.type===n.type)?.icon}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:"Seleccionado:"})," ",i.find(c=>c.type===n.type)?.title,a.jsx("br",{}),a.jsx("small",{children:i.find(c=>c.type===n.type)?.description})]})]})})]})})},WL=({formData:n,updateFormData:e,systemData:t,setError:i})=>{const[o,c]=$.useState(!1),[d,f]=$.useState(null),{products:p}=t;$.useEffect(()=>{if(n.fuelType&&p.length>0){const y=p.find(x=>x.name===n.fuelType||x.displayName===n.fuelType);f(y),y&&y.defaultPrice&&!n.unitPrice&&e("unitPrice",y.defaultPrice.toString())}},[n.fuelType,n.unitPrice,p,e]);const g=async(y,x)=>{c(!0),i("");try{await new Promise(_=>setTimeout(_,800)),e("fuelType",y),f(x),x.defaultPrice&&e("unitPrice",x.defaultPrice.toString()),console.log(" [Step2] Combustible seleccionado:",y,"Precio:",x.defaultPrice),console.log(" [Step2] FormData despus de actualizacin:",{fuelType:y,unitPrice:x.defaultPrice})}catch(_){console.error("Error al cargar combustible:",_),i("Error al cargar informacin del combustible")}finally{c(!1)}};return p.length===0?a.jsx("div",{className:"wizard-step step-fuel-type",children:a.jsx("div",{className:"step-content",children:a.jsxs("div",{className:"loading-state",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:" Cargando productos disponibles..."})]})})}):a.jsx("div",{className:"wizard-step step-fuel-type",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:" Qu combustible vas a mover?"}),a.jsx("p",{children:"Selecciona el producto del inventario:"})]}),o&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:" Solicitando precios actualizados..."})]}),a.jsx("div",{className:"fuel-options",children:p.map(y=>a.jsxs("div",{className:`fuel-option ${n.fuelType===y.name?"selected":""} ${o?"disabled":""}`,onClick:()=>!o&&g(y.name,y),children:[a.jsx("div",{className:"fuel-icon",children:y.icon||""}),a.jsxs("div",{className:"fuel-content",children:[a.jsx("h4",{children:y.displayName||y.name}),a.jsx("p",{className:"fuel-description",children:y.description||"Combustible"}),y.defaultPrice&&a.jsxs("div",{className:"fuel-price",children:[a.jsx("span",{className:"price-label",children:"Precio actual:"}),a.jsxs("span",{className:"price-value",children:["$",y.defaultPrice.toLocaleString("es-CO")," COP/gal"]})]}),y.category&&a.jsx("small",{className:"fuel-category",children:y.category})]}),a.jsx("div",{className:"fuel-selector",children:n.fuelType===y.name&&a.jsx("span",{className:"check-icon",children:""})})]},y.id))}),d&&n.fuelType&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card fuel-confirmation",children:[a.jsxs("div",{className:"confirmation-header",children:[a.jsx("span",{className:"confirmation-icon",children:d.icon||""}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:d.displayName||d.name}),a.jsx("br",{}),a.jsx("small",{children:d.description||"Combustible seleccionado"})]})]}),d.defaultPrice&&a.jsxs("div",{className:"price-confirmation",children:[a.jsxs("div",{className:"price-info",children:[a.jsx("span",{className:"price-label",children:" Precio por galn:"}),a.jsxs("span",{className:"price-amount",children:["$",d.defaultPrice.toLocaleString("es-CO")," COP"]})]}),a.jsx("small",{className:"price-note",children:" Precio aplicado automticamente (puedes modificarlo ms adelante)"})]})]})})]})})},ZL=({formData:n,updateFormData:e,systemData:t,setError:i})=>{const[o,c]=$.useState(!1),[d,f]=$.useState({}),[p,g]=$.useState(!1),{suppliers:y,inventory:x}=t,_=n.type===ue.ENTRADA;$.useEffect(()=>{(async()=>{if(!_&&n.fuelType&&x.length>0){g(!0),await new Promise(T=>setTimeout(T,600));const C={};console.log(" DEBUG Step3 - Datos para validacin:",{fuelType:n.fuelType,inventoryTotal:x.length,inventarioMuestra:x.slice(0,2),operationalLocations:Ei}),Ei.forEach(T=>{const M=x.filter(G=>G.fuelType===n.fuelType&&G.location?.toLowerCase()===T.toLowerCase()&&G.status==="active");console.log(` DEBUG ${T}:`,{itemsEncontrados:M.length,detalles:M.map(G=>({id:G.id,fuelType:G.fuelType,location:G.location,status:G.status,currentStock:G.currentStock,maxCapacity:G.maxCapacity}))});const q=M.reduce((G,V)=>G+(parseFloat(V.currentStock)||0),0),U=x.filter(G=>G.fuelType===n.fuelType&&G.location?.toLowerCase()===T.toLowerCase()&&G.status==="active").reduce((G,V)=>G+(parseFloat(V.maxCapacity)||0),0);let P="available",F=`${q.toFixed(1)} gal disponibles`;q===0?(P="empty",F="Sin stock disponible"):q<U*.2&&(P="low",F=`${q.toFixed(1)} gal (stock bajo)`),C[T]={available:q,maxCapacity:U,status:P,message:F,percentage:U>0?q/U*100:0}}),f(C),g(!1),console.log(" Stock validado por ubicacin:",C)}})()},[n.fuelType,_,x]);const A=async N=>{c(!0),i("");try{await new Promise(C=>setTimeout(C,400)),e(_?"supplierName":"location",N),console.log(" Ubicacin seleccionada:",N)}catch(C){console.error("Error al validar ubicacin:",C),i("Error al validar la ubicacin")}finally{c(!1)}};if(_){const N=y.filter(C=>C.status==="active");return a.jsx("div",{className:"wizard-step step-location",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:" De qu proveedor viene el combustible?"}),a.jsx("p",{children:"Selecciona el proveedor de origen:"})]}),o&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:" Validando proveedor..."})]}),a.jsx("div",{className:"supplier-options",children:N.map(C=>a.jsxs("div",{className:`supplier-option ${n.supplierName===C.name?"selected":""} ${o?"disabled":""}`,onClick:()=>!o&&A(C.name),children:[a.jsx("div",{className:"supplier-icon",children:""}),a.jsxs("div",{className:"supplier-content",children:[a.jsx("h4",{children:C.name}),a.jsx("p",{className:"supplier-location",children:C.city}),C.phone&&a.jsxs("small",{className:"supplier-contact",children:[" ",C.phone]})]}),a.jsx("div",{className:"supplier-selector",children:n.supplierName===C.name&&a.jsx("span",{className:"check-icon",children:""})})]},C.id))}),n.supplierName&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card",children:[a.jsx("span",{className:"confirmation-icon",children:""}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:"Proveedor:"})," ",n.supplierName,a.jsx("br",{}),a.jsx("small",{children:"Origen del combustible confirmado"})]})]})})]})})}return a.jsx("div",{className:"wizard-step step-location",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:" De qu ubicacin sale el combustible?"}),a.jsx("p",{children:"Selecciona la ubicacin de origen:"})]}),p&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:" Verificando stock disponible..."})]}),a.jsx("div",{className:"location-options",children:Ei.map(N=>{const C=d[N],T=!C||C.status!=="empty";return a.jsxs("div",{className:`location-option ${n.location===N?"selected":""} 
                           ${C?.status||"unknown"} ${!T||o?"disabled":""}`,onClick:()=>T&&!o&&A(N),children:[a.jsx("div",{className:"location-icon",children:""}),a.jsxs("div",{className:"location-content",children:[a.jsx("h4",{children:Gs(N)}),C&&a.jsxs("div",{className:"stock-info",children:[a.jsx("p",{className:"stock-message",children:C.message}),C.available>0&&a.jsx("div",{className:"stock-bar-mini",children:a.jsx("div",{className:"stock-fill-mini",style:{width:`${Math.min(100,C.percentage)}%`}})})]}),p&&a.jsx("small",{className:"validating-text",children:" Verificando..."})]}),a.jsxs("div",{className:"location-selector",children:[C?.status==="empty"&&a.jsx("span",{className:"warning-icon",children:""}),C?.status==="low"&&a.jsx("span",{className:"warning-icon",children:""}),C?.status==="available"&&a.jsx("span",{className:"success-icon",children:""}),n.location===N&&a.jsx("span",{className:"check-icon",children:""})]})]},N)})}),n.location&&d[n.location]&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card location-confirmation",children:[a.jsxs("div",{className:"confirmation-header",children:[a.jsx("span",{className:"confirmation-icon",children:""}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:Gs(n.location)}),a.jsx("br",{}),a.jsx("small",{children:"Ubicacin de origen confirmada"})]})]}),a.jsxs("div",{className:"stock-confirmation",children:[a.jsxs("div",{className:"stock-detail",children:[a.jsx("span",{className:"stock-label",children:" Stock disponible:"}),a.jsxs("span",{className:"stock-value",children:[d[n.location].available.toFixed(1)," gal"]})]}),a.jsx("div",{className:"capacity-bar",children:a.jsx("div",{className:"capacity-fill",style:{width:`${d[n.location].percentage}%`}})}),a.jsxs("small",{className:"capacity-text",children:[d[n.location].percentage.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},JL=({formData:n,updateFormData:e,systemData:t,setError:i})=>{const[o,c]=$.useState(!1),[d,f]=$.useState(null),[p,g]=$.useState(""),{inventory:y}=t,x=n.type===ue.SALIDA||n.type===ue.TRANSFERENCIA;$.useEffect(()=>{(async()=>{if(x&&n.fuelType&&n.location&&y.length>0){c(!0),await new Promise(S=>setTimeout(S,500));const C=y.filter(S=>S.fuelType===n.fuelType&&S.location?.toLowerCase()===n.location?.toLowerCase()&&S.status==="active").reduce((S,L)=>S+(parseFloat(L.currentStock)||0),0),T=y.filter(S=>S.fuelType===n.fuelType&&S.location?.toLowerCase()===n.location?.toLowerCase()&&S.status==="active").reduce((S,L)=>S+(parseFloat(L.maxCapacity)||0),0),M=parseFloat(n.quantity)||0,q=C-M,U=T>0?C/T*100:0;let P="available",F="",G="Stock Suficiente",V="Hay suficiente combustible disponible.";if(M>0&&(C<M?(P="critical",F="",G="Stock Insuficiente",V=`Faltan ${(M-C).toFixed(2)} galones.`):q<C*.2?(P="warning",F="",G="Stock Quedar Bajo",V=`Despus del movimiento quedarn ${q.toFixed(2)} galones.`):V=`Despus del movimiento quedarn ${q.toFixed(2)} galones disponibles.`),f({available:C,required:M,remaining:Math.max(0,q),maxCapacity:T,capacityPercentage:U,status:P,icon:F,title:G,message:V,isValid:C>=M}),M>0&&x){const S={type:n.type===ue.SALIDA?"outbound":"transfer",fuelType:n.fuelType,quantity:n.quantity,sourceLocation:n.location},L=hL(S,y);L.isValid?L.warning?g(` ${L.warning}`):g(""):g(` ${L.error}`)}else x||g("");c(!1)}})()},[n.quantity,n.fuelType,n.location,n.type,x,y]);const _=N=>{const C=parseFloat(N);(N===""||!isNaN(C)&&C>=0)&&(e("quantity",N),i(""))},A=()=>{if(!d||!d.available)return[];const N=d.available;return[{label:"25%",value:(N*.25).toFixed(1)},{label:"50%",value:(N*.5).toFixed(1)},{label:"75%",value:(N*.75).toFixed(1)},{label:"Todo",value:N.toFixed(1)}]};return a.jsx("div",{className:"wizard-step step-quantity",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:" Cuntos galones necesitas?"}),a.jsx("p",{children:"Especifica la cantidad de combustible:"})]}),a.jsxs("div",{className:"quantity-input-section",children:[a.jsxs("div",{className:"quantity-input-wrapper",children:[a.jsx("label",{htmlFor:"quantity",children:"Cantidad (galones)"}),a.jsxs("div",{className:"quantity-input-container",children:[a.jsx("input",{id:"quantity",type:"number",step:"0.1",min:"0",value:n.quantity,onChange:N=>_(N.target.value),placeholder:"0.0",className:`quantity-input ${p?"error":""}`}),a.jsx("span",{className:"quantity-unit",children:"gal"})]})]}),d&&d.available>0&&a.jsxs("div",{className:"quantity-suggestions",children:[a.jsx("label",{children:"Cantidades sugeridas:"}),a.jsx("div",{className:"suggestion-buttons",children:A().map((N,C)=>a.jsxs("button",{type:"button",className:"suggestion-btn",onClick:()=>_(N.value),children:[N.label,a.jsx("br",{}),a.jsxs("small",{children:[N.value," gal"]})]},C))})]})]}),o&&a.jsxs("div",{className:"calculating-indicator",children:[a.jsx("div",{className:"loading-spinner small"}),a.jsx("span",{children:" Calculando disponibilidad..."})]}),d&&x&&!o&&a.jsxs("div",{className:`stock-info-container ${d.status}`,children:[a.jsxs("div",{className:"stock-info-header",children:[a.jsx("div",{className:"stock-info-icon",children:d.icon}),a.jsx("h4",{className:"stock-info-title",children:d.title})]}),a.jsxs("div",{className:"stock-info-details",children:[a.jsxs("div",{className:"stock-detail-item",children:[a.jsx("span",{className:"stock-detail-label",children:"Stock Disponible"}),a.jsxs("span",{className:"stock-detail-value",children:[d.available.toFixed(2)," gal"]})]}),d.required>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"stock-detail-item",children:[a.jsx("span",{className:"stock-detail-label",children:"Cantidad Solicitada"}),a.jsxs("span",{className:"stock-detail-value",children:[d.required.toFixed(2)," gal"]})]}),a.jsxs("div",{className:"stock-detail-item",children:[a.jsx("span",{className:"stock-detail-label",children:"Stock Restante"}),a.jsxs("span",{className:"stock-detail-value",children:[d.remaining.toFixed(2)," gal"]})]})]})]}),d.maxCapacity>0&&a.jsxs("div",{className:"stock-bar-container",children:[a.jsxs("div",{className:"stock-bar",children:[a.jsx("div",{className:"stock-bar-current",style:{width:`${Math.min(100,d.capacityPercentage)}%`}}),d.required>0&&d.isValid&&a.jsx("div",{className:"stock-bar-after",style:{width:`${Math.min(100,d.remaining/d.maxCapacity*100)}%`}})]}),a.jsxs("div",{className:"stock-bar-labels",children:[a.jsxs("span",{children:["Actual: ",d.capacityPercentage.toFixed(1),"%"]}),d.required>0&&d.isValid&&a.jsxs("span",{children:["Despus: ",(d.remaining/d.maxCapacity*100).toFixed(1),"%"]})]})]}),a.jsx("div",{className:"stock-info-message",children:d.message})]}),p&&a.jsx("div",{className:"validation-warning",children:p}),!x&&n.quantity&&parseFloat(n.quantity)>0&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card",children:[a.jsx("span",{className:"confirmation-icon",children:""}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:"Cantidad:"})," ",parseFloat(n.quantity).toFixed(2)," galones",a.jsx("br",{}),a.jsxs("small",{children:["Se aadir al inventario de ",n.destinationLocation||"ubicacin no especificada"]})]})]})}),x&&n.quantity&&parseFloat(n.quantity)>0&&d&&d.isValid&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card",children:[a.jsx("span",{className:"confirmation-icon",children:""}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:"Cantidad:"})," ",parseFloat(n.quantity).toFixed(2)," galones",a.jsx("br",{}),a.jsxs("small",{children:["Se restar del inventario de ",n.location]})]})]})})]})})},eV=({formData:n,updateFormData:e,systemData:t,setError:i})=>{const[o,c]=$.useState(!1),[d,f]=$.useState(null),[p,g]=$.useState(!1),[y,x]=$.useState(""),{vehicles:_}=t;$.useEffect(()=>{if(n.vehicleId&&_.length>0){const T=_.find(q=>q.vehicleId===n.vehicleId);f(T);const M=A(T);g(M)}},[n.vehicleId,_]);const A=T=>{if(!T)return!1;const M=T.vehicleId?.toUpperCase(),q=M&&(M.includes("TR1")||M.includes("TR2")||M.includes("TR3")||M==="TR1"||M==="TR2"||M==="TR3"),U=T.category==="tractor"||T.type?.toLowerCase().includes("tractor");return q||U},N=async T=>{c(!0),i("");try{await new Promise(q=>setTimeout(q,600)),e("vehicleId",T.vehicleId),f(T);const M=A(T);g(M),!M&&n.currentHours&&e("currentHours",""),console.log(" [Step5] Vehculo seleccionado:",T.vehicleId,"Es tractor:",M),console.log(" [Step5] FormData despus de seleccin:",{vehicleId:T.vehicleId,type:n.type,fuelType:n.fuelType,location:n.location})}catch(M){console.error("Error al validar vehculo:",M),i("Error al validar el vehculo")}finally{c(!1)}},C=T=>{const M=parseFloat(T);(T===""||!isNaN(M)&&M>=0)&&(e("currentHours",T),d?.currentHours&&M<parseFloat(d.currentHours)?x(`La lectura debe ser mayor a la anterior: ${d.currentHours} hrs`):x(""))};return n.type!==ue.SALIDA?null:_.length===0?a.jsx("div",{className:"wizard-step step-vehicle",children:a.jsx("div",{className:"step-content",children:a.jsxs("div",{className:"loading-state",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:" Cargando vehculos disponibles..."})]})})}):a.jsx("div",{className:"wizard-step step-vehicle",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:" A qu vehculo/equipo va el combustible?"}),a.jsx("p",{children:"Selecciona el vehculo que recibir el combustible:"})]}),o&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:" Validando vehculo..."})]}),a.jsx("div",{className:"vehicle-options",children:_.map(T=>{const M=A(T);return a.jsxs("div",{className:`vehicle-option ${n.vehicleId===T.vehicleId?"selected":""} 
                           ${M?"tractor":""} ${o?"disabled":""}`,onClick:()=>!o&&N(T),children:[a.jsx("div",{className:"vehicle-icon",children:M?"":""}),a.jsxs("div",{className:"vehicle-content",children:[a.jsxs("h4",{children:[T.vehicleId," - ",T.name]}),a.jsx("p",{className:"vehicle-type",children:T.type}),T.currentHours&&M&&a.jsxs("small",{className:"vehicle-hours",children:[" Hormetro: ",T.currentHours," hrs"]}),T.status&&a.jsx("span",{className:`vehicle-status ${T.status}`,children:T.status==="active"?" Activo":" "+T.status})]}),a.jsxs("div",{className:"vehicle-selector",children:[M&&a.jsx("span",{className:"tractor-badge",children:"TRACTOR"}),n.vehicleId===T.vehicleId&&a.jsx("span",{className:"check-icon",children:""})]})]},T.id)})}),p&&d&&a.jsxs("div",{className:"hour-meter-section",children:[a.jsxs("div",{className:"hour-meter-header",children:[a.jsx("h4",{children:" Lectura del Hormetro"}),a.jsx("p",{children:"Los tractores requieren registro de hormetro:"})]}),a.jsxs("div",{className:"hour-meter-input-wrapper",children:[a.jsx("label",{htmlFor:"currentHours",children:"Horas actuales *"}),a.jsxs("div",{className:"hour-meter-input-container",children:[a.jsx("input",{id:"currentHours",type:"number",step:"0.1",min:"0",value:n.currentHours,onChange:T=>C(T.target.value),placeholder:"0.0",className:`hour-meter-input ${y?"error":""}`}),a.jsx("span",{className:"hour-meter-unit",children:"hrs"})]}),d.currentHours&&a.jsxs("small",{className:"hour-meter-hint",children:[" ltima lectura: ",d.currentHours," horas"]}),y&&a.jsx("div",{className:"field-error",children:y})]})]}),d&&n.vehicleId&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card vehicle-confirmation",children:[a.jsxs("div",{className:"confirmation-header",children:[a.jsx("span",{className:"confirmation-icon",children:A(d)?"":""}),a.jsxs("div",{className:"confirmation-text",children:[a.jsxs("strong",{children:[d.vehicleId," - ",d.name]}),a.jsx("br",{}),a.jsx("small",{children:d.type})]})]}),a.jsxs("div",{className:"vehicle-details",children:[a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:" Tipo:"}),a.jsx("span",{className:"detail-value",children:d.type})]}),d.category&&a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:" Categora:"}),a.jsx("span",{className:"detail-value",children:d.category})]}),p&&n.currentHours&&a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:" Hormetro:"}),a.jsxs("span",{className:"detail-value",children:[n.currentHours," hrs"]})]})]}),A(d)&&!n.currentHours&&a.jsx("div",{className:"warning-message",children:" Se requiere lectura del hormetro para tractores"})]})})]})})},BE=({formData:n,updateFormData:e,systemData:t,setError:i,isEntryDestination:o=!1})=>{const[c,d]=$.useState(!1),[f,p]=$.useState({}),[g,y]=$.useState(!1),{inventory:x}=t;$.useEffect(()=>{(async()=>{if(n.fuelType&&n.quantity&&x.length>0&&!o){y(!0),await new Promise(M=>setTimeout(M,700));const C=parseFloat(n.quantity)||0,T={};Ei.filter(M=>o?!0:M!==n.location).forEach(M=>{const q=x.filter(O=>O.fuelType===n.fuelType&&O.location?.toLowerCase()===M.toLowerCase()&&O.status==="active").reduce((O,w)=>O+(parseFloat(w.currentStock)||0),0),U=x.filter(O=>O.fuelType===n.fuelType&&O.location?.toLowerCase()===M.toLowerCase()&&O.status==="active").reduce((O,w)=>O+(parseFloat(w.maxCapacity)||0),0),P=U-q,F=q+C,G=U>0?F/U*100:0;let V="available",S=`Capacidad: ${P.toFixed(1)} gal libres`,L=P>=C;U===0?(V="no_capacity",S="Sin tanques configurados",L=!1):P<C?(V="insufficient",S=`Insuficiente: faltan ${(C-P).toFixed(1)} gal`,L=!1):G>90&&(V="warning",S=`Quedar al ${G.toFixed(1)}% (casi lleno)`),T[M]={currentStock:q,maxCapacity:U,availableCapacity:P,afterTransfer:F,occupancyAfter:G,status:V,message:S,canAcceptTransfer:L}}),p(T),y(!1),console.log(" Capacidad validada por destino:",T)}})()},[n.fuelType,n.quantity,n.location,x,o]);const _=async N=>{const C=f[N];if(!o&&!C?.canAcceptTransfer){i("Esta ubicacin no puede recibir la cantidad solicitada");return}d(!0),i("");try{await new Promise(T=>setTimeout(T,500)),e("destinationLocation",N),console.log(" Destino seleccionado:",N)}catch(T){console.error("Error al validar destino:",T),i("Error al validar el destino")}finally{d(!1)}};if(!o&&n.type!==ue.TRANSFERENCIA)return null;const A=o?fL:Ei.filter(N=>N!==n.location);return a.jsx("div",{className:"wizard-step step-destination",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsxs("h3",{children:[" ",o?"A qu ubicacin llegar el combustible?":"Hacia qu ubicacin se transfiere?"]}),a.jsx("p",{children:"Selecciona la ubicacin de destino:"})]}),g&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:" Verificando capacidad disponible..."})]}),a.jsx("div",{className:"destination-options",children:A.map(N=>{const C=f[N],T=!C||C.canAcceptTransfer;return a.jsxs("div",{className:`destination-option ${n.destinationLocation===N?"selected":""} 
                           ${C?.status||"unknown"} ${!T||c?"disabled":""}`,onClick:()=>T&&!c&&_(N),children:[a.jsx("div",{className:"destination-icon",children:""}),a.jsxs("div",{className:"destination-content",children:[a.jsx("h4",{children:Gs(N)}),C&&a.jsxs("div",{className:"capacity-info",children:[a.jsx("p",{className:"capacity-message",children:C.message}),C.maxCapacity>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"capacity-bar-mini",children:[a.jsx("div",{className:"capacity-current-mini",style:{width:`${Math.min(100,C.currentStock/C.maxCapacity*100)}%`}}),C.canAcceptTransfer&&a.jsx("div",{className:"capacity-after-mini",style:{width:`${Math.min(100,C.occupancyAfter)}%`,left:`${Math.min(100,C.currentStock/C.maxCapacity*100)}%`}})]}),a.jsxs("small",{className:"capacity-details",children:["Actual: ",C.currentStock.toFixed(1),"/",C.maxCapacity.toFixed(1)," gal"]})]})]}),g&&a.jsx("small",{className:"validating-text",children:" Verificando capacidad..."})]}),a.jsxs("div",{className:"destination-selector",children:[C?.status==="insufficient"&&a.jsx("span",{className:"warning-icon",children:""}),C?.status==="no_capacity"&&a.jsx("span",{className:"warning-icon",children:""}),C?.status==="warning"&&a.jsx("span",{className:"warning-icon",children:""}),C?.status==="available"&&a.jsx("span",{className:"success-icon",children:""}),n.destinationLocation===N&&a.jsx("span",{className:"check-icon",children:""})]})]},N)})}),n.location&&n.quantity&&a.jsx("div",{className:"transfer-summary",children:a.jsxs("div",{className:"transfer-flow",children:[a.jsxs("div",{className:"transfer-origin",children:[a.jsx("span",{className:"transfer-icon",children:""}),a.jsxs("div",{className:"transfer-info",children:[a.jsx("strong",{children:Gs(n.location)}),a.jsx("small",{children:"Origen"})]})]}),a.jsxs("div",{className:"transfer-arrow",children:[a.jsx("span",{children:""}),a.jsxs("small",{children:[parseFloat(n.quantity).toFixed(1)," gal"]})]}),a.jsxs("div",{className:"transfer-destination",children:[a.jsx("span",{className:"transfer-icon",children:""}),a.jsxs("div",{className:"transfer-info",children:[a.jsx("strong",{children:n.destinationLocation?Gs(n.destinationLocation):"Seleccionar destino"}),a.jsx("small",{children:"Destino"})]})]})]})}),n.destinationLocation&&f[n.destinationLocation]&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card destination-confirmation",children:[a.jsxs("div",{className:"confirmation-header",children:[a.jsx("span",{className:"confirmation-icon",children:""}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:Gs(n.destinationLocation)}),a.jsx("br",{}),a.jsx("small",{children:"Ubicacin de destino confirmada"})]})]}),a.jsxs("div",{className:"capacity-confirmation",children:[a.jsxs("div",{className:"capacity-detail",children:[a.jsx("span",{className:"capacity-label",children:" Despus de transferir:"}),a.jsxs("span",{className:"capacity-value",children:[f[n.destinationLocation].afterTransfer.toFixed(1)," gal"]})]}),a.jsx("div",{className:"occupancy-bar",children:a.jsx("div",{className:"occupancy-fill",style:{width:`${f[n.destinationLocation].occupancyAfter}%`}})}),a.jsxs("small",{className:"occupancy-text",children:[f[n.destinationLocation].occupancyAfter.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},tV=({formData:n,updateFormData:e,systemData:t,error:i,setError:o})=>{const[c,d]=$.useState(!1),[f,p]=$.useState(!1),{products:g}=t;$.useEffect(()=>{if(n.fuelType&&!n.unitPrice&&g.length>0){const M=g.find(q=>q.name===n.fuelType||q.displayName===n.fuelType);M&&M.defaultPrice&&(e("unitPrice",M.defaultPrice.toString()),p(!0))}},[n.fuelType,n.unitPrice,g,e]);const y=async M=>{const q=parseFloat(M);(M===""||!isNaN(q)&&q>=0)&&(d(!0),await new Promise(U=>setTimeout(U,300)),e("unitPrice",M),p(M!==""),o(""),d(!1))},x=M=>{e("effectiveDate",M)},_=M=>{e("reference",M)},A=M=>{e("description",M)},N=(parseFloat(n.quantity)||0)*(parseFloat(n.unitPrice)||0),C=M=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(M),T=()=>g.find(M=>M.name===n.fuelType||M.displayName===n.fuelType);return a.jsx("div",{className:"wizard-step step-details",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:" Informacin adicional del movimiento"}),a.jsx("p",{children:"Completa los detalles restantes:"})]}),a.jsxs("div",{className:"detail-section",children:[a.jsx("div",{className:"detail-header",children:a.jsx("h4",{children:" Precio Unitario"})}),a.jsxs("div",{className:"price-input-wrapper",children:[a.jsx("label",{htmlFor:"unitPrice",children:"Precio por galn (COP) *"}),a.jsxs("div",{className:"price-input-container",children:[a.jsx("span",{className:"currency-symbol",children:"$"}),a.jsx("input",{id:"unitPrice",type:"number",step:"1",min:"0",value:n.unitPrice,onChange:M=>y(M.target.value),placeholder:"0",className:`price-input ${i?"error":""}`}),a.jsx("span",{className:"currency-unit",children:"COP"})]}),c&&a.jsxs("div",{className:"calculating-price",children:[a.jsx("div",{className:"loading-spinner small"}),a.jsx("span",{children:" Validando precio..."})]}),T()?.defaultPrice&&a.jsxs("small",{className:"price-suggestion",children:[" Precio sugerido: $",T().defaultPrice.toLocaleString("es-CO")," COP"]})]})]}),n.quantity&&n.unitPrice&&f&&a.jsx("div",{className:"total-value-section",children:a.jsxs("div",{className:"total-value-card",children:[a.jsx("div",{className:"total-icon",children:""}),a.jsxs("div",{className:"total-content",children:[a.jsx("h4",{children:"Valor Total Calculado"}),a.jsxs("div",{className:"total-calculation",children:[a.jsxs("span",{className:"calculation-details",children:[parseFloat(n.quantity).toFixed(2)," gal  $",parseFloat(n.unitPrice).toLocaleString("es-CO")," COP"]}),a.jsx("div",{className:"total-amount",children:C(N)})]})]})]})}),a.jsxs("div",{className:"detail-section",children:[a.jsx("div",{className:"detail-header",children:a.jsx("h4",{children:" Fecha y Hora Efectiva"})}),a.jsxs("div",{className:"date-input-wrapper",children:[a.jsx("label",{htmlFor:"effectiveDate",children:"Cundo ocurri este movimiento?"}),a.jsx("input",{id:"effectiveDate",type:"datetime-local",value:n.effectiveDate,onChange:M=>x(M.target.value),className:"date-input"}),a.jsx("small",{className:"date-hint",children:" Por defecto se usa la fecha y hora actual"})]})]}),a.jsxs("div",{className:"detail-section",children:[a.jsx("div",{className:"detail-header",children:a.jsx("h4",{children:" Referencia"})}),a.jsxs("div",{className:"reference-input-wrapper",children:[a.jsx("label",{htmlFor:"reference",children:"Nmero de factura, orden o referencia (opcional)"}),a.jsx("input",{id:"reference",type:"text",value:n.reference,onChange:M=>_(M.target.value),placeholder:"Ej: Factura #12345, Orden #ORD-001",className:"reference-input",maxLength:"100"}),a.jsx("small",{className:"reference-hint",children:" Ayuda a identificar el movimiento en reportes"})]})]}),a.jsxs("div",{className:"detail-section",children:[a.jsx("div",{className:"detail-header",children:a.jsx("h4",{children:" Descripcin"})}),a.jsxs("div",{className:"description-input-wrapper",children:[a.jsx("label",{htmlFor:"description",children:"Detalles adicionales del movimiento (opcional)"}),a.jsx("textarea",{id:"description",value:n.description,onChange:M=>A(M.target.value),placeholder:"Ej: Combustible para operacin en sector norte, mantenimiento programado, etc.",className:"description-input",rows:"3",maxLength:"500"}),a.jsxs("div",{className:"description-counter",children:[n.description.length,"/500 caracteres"]})]})]}),f&&a.jsx("div",{className:"details-summary",children:a.jsxs("div",{className:"summary-card",children:[a.jsx("h4",{children:" Resumen de Detalles"}),a.jsxs("div",{className:"summary-items",children:[a.jsxs("div",{className:"summary-item",children:[a.jsx("span",{className:"summary-label",children:" Precio unitario:"}),a.jsxs("span",{className:"summary-value",children:["$",parseFloat(n.unitPrice).toLocaleString("es-CO")," COP/gal"]})]}),N>0&&a.jsxs("div",{className:"summary-item",children:[a.jsx("span",{className:"summary-label",children:" Valor total:"}),a.jsx("span",{className:"summary-value total",children:C(N)})]}),a.jsxs("div",{className:"summary-item",children:[a.jsx("span",{className:"summary-label",children:" Fecha:"}),a.jsx("span",{className:"summary-value",children:new Date(n.effectiveDate).toLocaleString("es-CO")})]}),n.reference&&a.jsxs("div",{className:"summary-item",children:[a.jsx("span",{className:"summary-label",children:" Referencia:"}),a.jsx("span",{className:"summary-value",children:n.reference})]}),n.description&&a.jsxs("div",{className:"summary-item",children:[a.jsx("span",{className:"summary-label",children:" Descripcin:"}),a.jsx("span",{className:"summary-value description",children:n.description.length>50?n.description.substring(0,50)+"...":n.description})]})]})]})})]})})},nV=({formData:n,systemData:e,onSubmit:t,isLoading:i,error:o,setError:c})=>{const[d,f]=$.useState(!1),[p,g]=$.useState(""),{vehicles:y,products:x,suppliers:_}=e,A=S=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(S),N=()=>({[ue.ENTRADA]:{icon:"",title:"Entrada",color:"entrada"},[ue.SALIDA]:{icon:"",title:"Salida",color:"salida"},[ue.TRANSFERENCIA]:{icon:"",title:"Transferencia",color:"transferencia"},[ue.AJUSTE]:{icon:"",title:"Ajuste",color:"ajuste"}})[n.type]||{icon:"",title:"Desconocido",color:"unknown"},C=()=>x.find(S=>S.name===n.fuelType||S.displayName===n.fuelType),T=()=>y.find(S=>S.vehicleId===n.vehicleId),M=()=>{const S=n.type===ue.ENTRADA?n.supplierName:n.location;return _.find(L=>L.name===S)},q=(parseFloat(n.quantity)||0)*(parseFloat(n.unitPrice)||0),U=N(),P=C(),F=T(),G=M(),V=()=>{if(!d){c("Debes confirmar que la informacin es correcta");return}const S={...n,additionalComments:p.trim()};t(S)};return a.jsx("div",{className:"wizard-step step-summary",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:" Confirma tu movimiento"}),a.jsx("p",{children:"Revisa toda la informacin antes de crear el movimiento:"})]}),a.jsxs("div",{className:"summary-main",children:[a.jsxs("div",{className:`summary-header ${U.color}`,children:[a.jsx("div",{className:"summary-icon",children:U.icon}),a.jsxs("div",{className:"summary-title",children:[a.jsxs("h4",{children:[U.title," de Combustible"]}),a.jsxs("p",{children:[parseFloat(n.quantity).toFixed(2)," galones de ",P?.displayName||n.fuelType]})]}),a.jsx("div",{className:"summary-value",children:A(q)})]}),a.jsxs("div",{className:"summary-details",children:[a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:""}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Combustible:"}),a.jsxs("span",{className:"detail-value",children:[P?.icon," ",P?.displayName||n.fuelType]})]})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:""}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Cantidad:"}),a.jsxs("span",{className:"detail-value",children:[parseFloat(n.quantity).toFixed(2)," gal  $",parseFloat(n.unitPrice).toLocaleString("es-CO")," COP"]})]})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:n.type===ue.ENTRADA?"":""}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:n.type===ue.ENTRADA?"Proveedor:":"Origen:"}),a.jsx("span",{className:"detail-value",children:n.type===ue.ENTRADA?G?`${G.name} - ${G.city}`:n.location:Gs(n.location)})]})]}),n.type===ue.SALIDA&&F&&a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:""}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Vehculo:"}),a.jsxs("span",{className:"detail-value",children:[F.vehicleId," - ",F.name," (",F.type,")"]})]})]}),n.currentHours&&a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:""}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Hormetro:"}),a.jsxs("span",{className:"detail-value",children:[n.currentHours," horas"]})]})]}),n.type===ue.TRANSFERENCIA&&n.destinationLocation&&a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:""}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Destino:"}),a.jsx("span",{className:"detail-value",children:Gs(n.destinationLocation)})]})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:""}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Fecha:"}),a.jsx("span",{className:"detail-value",children:new Date(n.effectiveDate).toLocaleString("es-CO")})]})]}),n.reference&&a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:""}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Referencia:"}),a.jsx("span",{className:"detail-value",children:n.reference})]})]}),n.description&&a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:""}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Descripcin:"}),a.jsx("span",{className:"detail-value description",children:n.description})]})]})]})]}),n.type===ue.TRANSFERENCIA&&a.jsxs("div",{className:"transfer-flow-summary",children:[a.jsx("div",{className:"flow-header",children:" Flujo de Transferencia"}),a.jsxs("div",{className:"flow-diagram",children:[a.jsxs("div",{className:"flow-location origin",children:[a.jsx("div",{className:"flow-icon",children:""}),a.jsxs("div",{className:"flow-text",children:[a.jsx("strong",{children:Gs(n.location)}),a.jsx("small",{children:"Origen"})]})]}),a.jsxs("div",{className:"flow-arrow",children:[a.jsx("div",{className:"arrow-line"}),a.jsx("div",{className:"arrow-head",children:""}),a.jsxs("div",{className:"flow-quantity",children:[parseFloat(n.quantity).toFixed(1)," gal"]})]}),a.jsxs("div",{className:"flow-location destination",children:[a.jsx("div",{className:"flow-icon",children:""}),a.jsxs("div",{className:"flow-text",children:[a.jsx("strong",{children:Gs(n.destinationLocation)}),a.jsx("small",{children:"Destino"})]})]})]})]}),a.jsxs("div",{className:"additional-comments-section",children:[a.jsxs("div",{className:"comments-header",children:[a.jsx("h4",{children:" Comentarios Adicionales"}),a.jsx("small",{children:"Opcional - Agrega informacin adicional sobre este movimiento"})]}),a.jsx("textarea",{className:"comments-textarea",value:p,onChange:S=>g(S.target.value),placeholder:"Ejemplo: Combustible entregado por transporte especial, requiere almacenamiento prioritario, etc.",rows:3,maxLength:500}),a.jsxs("div",{className:"comments-counter",children:[p.length,"/500 caracteres"]})]}),a.jsxs("div",{className:"confirmation-section",children:[a.jsxs("div",{className:"confirmation-checkbox",children:[a.jsx("input",{type:"checkbox",id:"confirmMovement",checked:d,onChange:S=>f(S.target.checked)}),a.jsx("label",{htmlFor:"confirmMovement",children:" Confirmo que toda la informacin es correcta y autorizo crear este movimiento"})]}),a.jsx("div",{className:"confirmation-warning",children:" Una vez creado, el movimiento actualizar automticamente el inventario"})]}),o&&a.jsxs("div",{className:"summary-error",children:[a.jsx("span",{className:"error-icon",children:""}),o]}),a.jsxs("div",{className:"final-actions",children:[a.jsx("button",{type:"button",className:`btn-final-confirm ${!d||i?"disabled":""}`,onClick:V,disabled:!d||i,children:i?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"loading-spinner small"})," Creando movimiento..."]}):a.jsx(a.Fragment,{children:" Crear Movimiento"})}),a.jsx("small",{className:"final-note",children:"El movimiento se guardar inmediatamente y actualizar el inventario"})]})]})})},sV=({isOpen:n,onClose:e,onSuccess:t})=>{const{inventory:i,vehicles:o,suppliers:c}=ds(),[d,f]=$.useState(1),[p,g]=$.useState(!1),[y,x]=$.useState(""),[_,A]=$.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""}),[N,C]=$.useState({vehicles:[],inventory:[],suppliers:[],products:[],loadingData:!0}),T={1:{title:"Tipo de Movimiento",description:"Qu operacin realizars?"},2:{title:"Combustible",description:"Qu producto vas a mover?"},3:{title:"Origen/Proveedor",description:_.type===ue.ENTRADA?"De qu proveedor?":"De dnde proviene?"},"3b":{title:"Ubicacin Destino",description:"A dnde llegar?"},4:{title:"Cantidad",description:"Cunto necesitas?"},5:{title:"Vehculo/Equipo",description:"A qu destino?"},6:{title:"Ubicacin Destino",description:"Hacia dnde va?"},7:{title:"Detalles",description:"Informacin adicional"},8:{title:"Confirmacin",description:"Revisa y confirma"}};$.useEffect(()=>((async()=>{if(n){document.body.style.overflow="hidden",C(de=>({...de,loadingData:!0}));try{console.log(" Cargando productos y sincronizando datos en tiempo real...");const de=await QL();C({vehicles:o||[],inventory:i||[],suppliers:c||[],products:de||[],loadingData:!1}),console.log(" Datos sincronizados para wizard - inventario en tiempo real:",i?.length||0,"items")}catch(de){console.error(" Error al cargar datos del sistema:",de),C(be=>({...be,loadingData:!1}))}}else document.body.style.overflow="unset"})(),()=>{document.body.style.overflow="unset"}),[n,i,o,c]);const M=()=>{if(!_.type)return 8;let R;return _.type===ue.TRANSFERENCIA?R=8:_.type===ue.SALIDA||_.type===ue.ENTRADA?R=7:R=6,console.log(" [TOTAL STEPS]",{type:_.type,totalSteps:R,currentStep:d}),R},q=(R,de)=>{A(be=>({...be,[R]:de})),x("")},U=()=>{let R=!1;switch(d){case 1:R=!!_.type;break;case 2:R=!!_.fuelType,console.log(" [STEP 2 VALIDATION]",{fuelType:_.fuelType,isValid:R,formData:_});break;case 3:_.type===ue.ENTRADA?R=!!_.supplierName:R=!!_.location;break;case"3b":R=!!_.destinationLocation;break;case 4:R=_.quantity&&parseFloat(_.quantity)>0,console.log(" [DEBUG Step 4] Validacin cantidad:",{step:d,quantity:_.quantity,parsedQuantity:parseFloat(_.quantity),isQuantityValid:!!_.quantity,isParsedValid:parseFloat(_.quantity)>0,finalValidation:R,formData:_});break;case 5:_.type===ue.SALIDA?R=!!_.vehicleId:R=!0;break;case 6:_.type===ue.TRANSFERENCIA?R=!!_.destinationLocation:R=!0;break;case 7:R=!!_.unitPrice&&parseFloat(_.unitPrice)>=0;break;case 8:R=!0;break;default:R=!1}return console.log(" [DEBUG General] validateCurrentStep:",{currentStep:d,isValid:R,formDataKeys:Object.keys(_),formData:_}),R},P=$.useMemo(()=>U(),[d,_,ue]),F=()=>{const R=U();if(console.log(" [DEBUG nextStep] Intentando navegar:",{currentStep:d,isValid:R,formData:_,type:_.type}),R){const de=M();let be=d+1;d===3&&_.type===ue.ENTRADA?be="3b":d==="3b"?be=4:d===4&&_.type!==ue.SALIDA?_.type===ue.TRANSFERENCIA?be=6:(_.type,ue.ENTRADA,be=7):d===5&&_.type!==ue.TRANSFERENCIA&&(be=7),console.log(" [DEBUG Navigation] Navegando:",{from:d,to:be,totalSteps:de}),(fe=>_.type===ue.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[fe]||fe:_.type===ue.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[fe]||fe:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[fe]||fe)(be)<=de&&f(be)}else console.log(" [DEBUG] Validacin fall, no se puede navegar"),x("Por favor completa este paso antes de continuar")},G=()=>{if(d>1&&d!=="3b"){let R=d-1;d===4&&_.type===ue.ENTRADA?R="3b":(d===7&&_.type===ue.ENTRADA||d===7&&_.type!==ue.TRANSFERENCIA&&_.type!==ue.SALIDA||d===6&&_.type!==ue.SALIDA)&&(R=4),f(R)}else d==="3b"&&f(3)},V=async(R=null)=>{g(!0),x("");try{const de=R||_;console.log(" [SUBMIT] Datos completos antes de crear movimiento:",de),console.log(" [SUBMIT] FuelType especfico:",de.fuelType),de.type===ue.SALIDA&&console.log(" [SUBMIT SALIDA] Validando campos requeridos:",{type:de.type,fuelType:de.fuelType,vehicleId:de.vehicleId,location:de.location,quantity:de.quantity,unitPrice:de.unitPrice});const be={...de,quantity:parseFloat(de.quantity),unitPrice:parseFloat(de.unitPrice),effectiveDate:new Date(de.effectiveDate)};console.log(" [SUBMIT] MovementData enviado a createMovement:",be),await _A(be),t(),f(1),A({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""})}catch(de){console.error("Error al crear movimiento:",de),x(de.message||"Error al crear el movimiento")}finally{g(!1)}},S=()=>{const R={formData:_,updateFormData:q,systemData:N,error:y,setError:x};switch(d){case 1:return a.jsx(XL,{...R});case 2:return a.jsx(WL,{...R});case 3:return a.jsx(ZL,{...R});case"3b":return a.jsx(BE,{...R,isEntryDestination:!0});case 4:return a.jsx(JL,{...R});case 5:return a.jsx(eV,{...R});case 6:return a.jsx(BE,{...R});case 7:return a.jsx(tV,{...R});case 8:return a.jsx(nV,{...R,onSubmit:V,isLoading:p});default:return a.jsx("div",{children:"Paso no encontrado"})}};if(!n)return null;const L=M(),w=(R=>_.type===ue.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[R]||R:_.type===ue.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[R]||R:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[R]||R)(d),I=w/L*100;return console.log(" [WIZARD DEBUG]",{type:_.type,currentStep:d,currentLogicalStep:w,totalSteps:L,progress:I,isLastStep:d>=L,formDataKeys:Object.keys(_).filter(R=>_[R]),fuelType:_.fuelType}),a.jsx("div",{className:"modal-overlay wizard-overlay",onClick:e,children:a.jsxs("div",{className:"modal-content wizard-modal",onClick:R=>R.stopPropagation(),children:[a.jsxs("div",{className:"wizard-header",children:[a.jsxs("div",{className:"wizard-title",children:[a.jsx("h3",{children:" Asistente de Movimientos"}),a.jsx("button",{className:"modal-close",onClick:e,children:""})]}),a.jsxs("div",{className:"wizard-progress",children:[a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill",style:{width:`${I}%`}})}),a.jsxs("div",{className:"progress-text",children:["Paso ",w," de ",L]})]}),a.jsxs("div",{className:"step-info",children:[a.jsx("h4",{children:T[d]?.title}),a.jsx("p",{children:T[d]?.description})]})]}),a.jsx("div",{className:"wizard-body",children:N.loadingData?a.jsxs("div",{className:"wizard-loading",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:" Cargando datos del sistema..."})]}):S()}),y&&a.jsxs("div",{className:"wizard-error",children:[a.jsx("span",{className:"error-icon",children:""}),y]}),a.jsx("div",{className:"wizard-footer",children:a.jsxs("div",{className:"wizard-navigation",children:[a.jsx("button",{className:"btn-wizard btn-previous",onClick:G,disabled:d===1,children:" Anterior"}),w<L?a.jsx("button",{className:"btn-wizard btn-next",onClick:F,disabled:!P,children:"Siguiente "}):a.jsx("button",{className:"btn-wizard btn-finish",onClick:V,disabled:p||!P,children:p?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"loading-spinner small"}),"Creando..."]}):" Confirmar Movimiento"})]})})]})})},aV=()=>{const{user:n,userProfile:e,deleteMovement:t}=ds(),[i,o]=$.useState([]),[c,d]=$.useState(null),[f,p]=$.useState(!0),[g,y]=$.useState(null),[x,_]=$.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[A,N]=$.useState(""),[C,T]=$.useState(!1);$.useEffect(()=>{if(!n)return;p(!0);const w=Jv((I,R)=>{if(R){console.error("Error en suscripcin de movimientos:",R),y("Error al cargar movimientos"),p(!1);return}o(I),y(null),p(!1)},x);return()=>w()},[n,x]),$.useEffect(()=>{n&&(async()=>{try{const I=await AA(x);d(I)}catch(I){console.error("Error al cargar estadsticas:",I)}})()},[n,i,x]);const M=i.filter(w=>{if(!A)return!0;const I=A.toLowerCase();return w.fuelType?.toLowerCase().includes(I)||w.type?.toLowerCase().includes(I)||w.location?.toLowerCase().includes(I)||w.vehicleId?.toLowerCase().includes(I)||w.description?.toLowerCase().includes(I)||w.reference?.toLowerCase().includes(I)}),q=()=>{T(!0)},U=w=>{alert(` Detalles del movimiento:

Tipo: ${w.type}
Combustible: ${w.fuelType}
Cantidad: ${w.quantity} gal
Fecha: ${new Date(w.createdAt).toLocaleDateString("es-CO")}`)},P=()=>{T(!1)},F=w=>{_(I=>({...I,...w}))},G=()=>{_({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),N("")},V=async w=>{if(window.confirm("Ests seguro de que quieres aprobar este movimiento? Esta accin actualizar el inventario."))try{await jA(w),alert("Movimiento aprobado y stock actualizado.")}catch(I){console.error("Error al aprobar movimiento:",I),alert(`Error al aprobar movimiento: ${I.message}`)}},S=async w=>{if(window.confirm("Ests seguro de que quieres rechazar este movimiento?"))try{await TA(w,{status:gt.CANCELADO}),alert("Movimiento rechazado.")}catch(I){console.error("Error al rechazar movimiento:",I),alert(`Error al rechazar movimiento: ${I.message}`)}},L=async w=>{try{const I=await t(w);if(I.success)alert("Movimiento eliminado exitosamente.");else throw new Error(I.error)}catch(I){console.error("Error al eliminar movimiento:",I),alert(`Error al eliminar movimiento: ${I.message}`)}},O=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente";return f?a.jsx("div",{className:"movements-main",children:a.jsxs("div",{className:"loading-container",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando movimientos..."})]})}):g?a.jsx("div",{className:"movements-main",children:a.jsxs("div",{className:"error-container",children:[a.jsx("div",{className:"error-icon",children:""}),a.jsx("h3",{children:"Error al cargar movimientos"}),a.jsx("p",{children:g}),a.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):a.jsxs("div",{className:"movements-main",children:[a.jsxs("div",{className:"movements-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h2",{children:" Movimientos de Combustibles"}),a.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),O&&a.jsx("div",{className:"create-movement-options",children:a.jsx("button",{className:"btn-create-movement primary",onClick:q,children:" Nuevo Movimiento"})})]}),c&&a.jsx(FL,{stats:c,filters:x}),a.jsx(qL,{filters:x,onFilterChange:F,onClearFilters:G,searchTerm:A,onSearchChange:N,totalResults:M.length}),M.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:""}),a.jsx("h3",{children:i.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),a.jsx("p",{children:i.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de bsqueda"}),i.length===0&&O&&a.jsx("div",{className:"create-first-options",children:a.jsx("button",{className:"btn-create-first primary",onClick:q,children:" Crear Primer Movimiento"})})]}):a.jsx(BL,{movements:M,onEdit:null,onView:U,onApprove:V,onReject:S,onDelete:L,userRole:e?.role}),C&&a.jsx(sV,{isOpen:C,onClose:P,onSuccess:()=>{P()}})]})},iV=({stats:n,filters:e})=>{if(!n)return null;const t=x=>`${Oe(x)} gal`,i=x=>`${Oe(x)} hrs`,o=x=>`${x.toFixed(2)} gal/hr`,c=x=>{let _=0;for(let N=0;N<x.length;N++)_=(_<<5)-_+x.charCodeAt(N)&4294967295;const A=["#059669","#dc2626","#2563eb","#7c3aed","#ea580c","#16a34a","#ca8a04","#9333ea"];return A[Math.abs(_)%A.length]},d=x=>{if(!x)return"";const _=x.toLowerCase();return _.includes("excavadora")?"":_.includes("bulldozer")?"":_.includes("cargador")?"":_.includes("camion")?"":_.includes("grua")?"":_.includes("motosierra")?"":_.includes("tractor")?"":_.includes("volqueta")?"":""},f=x=>{switch(x){case Ve.ACTIVO:return"#10b981";case Ve.MANTENIMIENTO:return"#f59e0b";case Ve.INACTIVO:return"#6b7280";case Ve.REPARACION:return"#ef4444";default:return"#6b7280"}},p=x=>{switch(x){case Ve.ACTIVO:return"";case Ve.MANTENIMIENTO:return"";case Ve.INACTIVO:return"";case Ve.REPARACION:return"";default:return""}},g=x=>{switch(x){case vt.DIESEL:return"";case vt.GASOLINA:return"";case vt.ACPM:return"";case vt.MIXTO:return"";default:return""}},y=n.totalVehicles>0?((n.byStatus[Ve.ACTIVO]||0)/n.totalVehicles*100).toFixed(1):0;return a.jsxs("div",{className:"vehicles-stats",children:[a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card primary",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:Oe(n.totalVehicles)}),a.jsx("div",{className:"stat-label",children:"Total Vehculos"}),a.jsx("div",{className:"stat-trend",children:a.jsxs("span",{className:`trend ${y>=80?"positive":"warning"}`,children:[y>=80?"":""," ",y,"% activos"]})})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:t(n.totalFuelConsumed)}),a.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),a.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(n.averageConsumption||0)]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:i(n.totalHoursWorked)}),a.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),a.jsxs("div",{className:"stat-secondary",children:["Promedio: ",i(n.totalHoursWorked/(n.totalVehicles||1))]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:n.mostActiveVehicle?n.mostActiveVehicle.vehicleId:"N/A"}),a.jsx("div",{className:"stat-label",children:"Ms Activo"}),a.jsx("div",{className:"stat-secondary",children:n.mostActiveVehicle?`${n.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),a.jsxs("div",{className:"stats-breakdown",children:[a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:" Por Tipo de Vehculo"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([x,_])=>{const A=(_/n.totalVehicles*100).toFixed(1);return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:d(x)}),a.jsx("span",{className:"breakdown-label",children:x.charAt(0).toUpperCase()+x.slice(1)})]}),a.jsx("div",{className:"breakdown-value",children:_}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${A}%`,backgroundColor:c(x)}})}),a.jsxs("div",{className:"breakdown-percentage",children:[A,"%"]})]},x)})})]}),a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:" Por Estado"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([x,_])=>{const A=(_/n.totalVehicles*100).toFixed(1);return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:p(x)}),a.jsx("span",{className:"breakdown-label",children:x.charAt(0).toUpperCase()+x.slice(1)})]}),a.jsx("div",{className:"breakdown-value",children:_}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${A}%`,backgroundColor:f(x)}})}),a.jsxs("div",{className:"breakdown-percentage",children:[A,"%"]})]},x)})})]}),a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:" Por Tipo de Combustible"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([x,_])=>{const A=(_/n.totalVehicles*100).toFixed(1);return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:g(x)}),a.jsx("span",{className:"breakdown-label",children:x})]}),a.jsx("div",{className:"breakdown-value",children:_}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${A}%`,backgroundColor:"#059669"}})}),a.jsxs("div",{className:"breakdown-percentage",children:[A,"%"]})]},x)})})]})]}),(n.totalFuelConsumed>0||n.totalHoursWorked>0)&&a.jsxs("div",{className:"performance-metrics",children:[a.jsx("h4",{children:" Mtricas de Rendimiento"}),a.jsxs("div",{className:"metrics-grid",children:[a.jsxs("div",{className:"metric-card",children:[a.jsx("div",{className:"metric-icon",children:""}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),a.jsxs("div",{className:"metric-value",children:[y,"%"]}),a.jsxs("div",{className:"metric-description",children:[n.byStatus[Ve.ACTIVO]||0," de ",n.totalVehicles," activos"]})]})]}),n.averageConsumption>0&&a.jsxs("div",{className:"metric-card",children:[a.jsx("div",{className:"metric-icon",children:""}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),a.jsx("div",{className:"metric-value",children:o(n.averageConsumption)}),a.jsx("div",{className:"metric-description",children:"Por vehculo por hora trabajada"})]})]}),n.mostActiveVehicle&&a.jsxs("div",{className:"metric-card",children:[a.jsx("div",{className:"metric-icon",children:""}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-label",children:"Mayor Utilizacin"}),a.jsx("div",{className:"metric-value",children:n.mostActiveVehicle.vehicleId}),a.jsxs("div",{className:"metric-description",children:[t(n.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),n.leastActiveVehicle&&a.jsxs("div",{className:"metric-card",children:[a.jsx("div",{className:"metric-icon",children:""}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-label",children:"Menor Utilizacin"}),a.jsx("div",{className:"metric-value",children:n.leastActiveVehicle.vehicleId}),a.jsxs("div",{className:"metric-description",children:[t(n.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(e.type||e.status||e.fuelType||e.location)&&a.jsxs("div",{className:"active-filters",children:[a.jsx("h4",{children:" Filtros Activos"}),a.jsxs("div",{className:"filters-list",children:[e.type&&a.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&a.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&a.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.location&&a.jsxs("span",{className:"filter-tag",children:["Ubicacin: ",e.location]})]})]})]})},rV=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:i,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const[p,g]=$.useState(!1),y=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mecnico","Proyecto A","Proyecto B","En Reparacin","Otros"],x=Object.values(n).filter(N=>N&&N!==""&&N!=="all").length,_=(N,C)=>{e({[N]:C})},A=N=>{e(N)};return a.jsxs("div",{className:"vehicles-filters",children:[a.jsxs("div",{className:"filters-main",children:[a.jsx("div",{className:"search-section",children:a.jsxs("div",{className:"search-box",children:[a.jsx("span",{className:"search-icon",children:""}),a.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicacin...",value:i,onChange:N=>o(N.target.value),className:"search-input"}),i&&a.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar bsqueda",children:""})]})}),a.jsxs("div",{className:"filters-controls",children:[a.jsxs("div",{className:"quick-filters",children:[a.jsx("button",{className:`quick-filter ${n.status==="activo"?"active":""}`,onClick:()=>A({status:"activo"}),children:" Activos"}),a.jsx("button",{className:`quick-filter ${n.status==="mantenimiento"?"active":""}`,onClick:()=>A({status:"mantenimiento"}),children:" Mantenimiento"}),a.jsx("button",{className:`quick-filter ${n.type==="excavadora"?"active":""}`,onClick:()=>A({type:"excavadora"}),children:" Excavadoras"}),a.jsx("button",{className:`quick-filter ${n.type==="tractor"?"active":""}`,onClick:()=>A({type:"tractor"}),children:" Tractores"})]}),a.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>g(!p),children:[" Filtros",x>0&&a.jsx("span",{className:"filters-count",children:x})]}),a.jsxs("div",{className:"view-modes",children:[a.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:""}),a.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:""})]})]})]}),p&&a.jsxs("div",{className:"filters-advanced",children:[a.jsxs("div",{className:"filters-grid",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Tipo de Vehculo"}),a.jsxs("select",{value:n.type,onChange:N=>_("type",N.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los tipos"}),a.jsx("option",{value:"excavadora",children:" Excavadora"}),a.jsx("option",{value:"bulldozer",children:" Bulldozer"}),a.jsx("option",{value:"cargador",children:" Cargador"}),a.jsx("option",{value:"camion",children:" Camin"}),a.jsx("option",{value:"grua",children:" Gra"}),a.jsx("option",{value:"motosierra",children:" Motosierra"}),a.jsx("option",{value:"tractor",children:" Tractor"}),a.jsx("option",{value:"volqueta",children:" Volqueta"}),a.jsx("option",{value:"otros",children:" Otros"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Estado"}),a.jsxs("select",{value:n.status,onChange:N=>_("status",N.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los estados"}),a.jsx("option",{value:Ve.ACTIVO,children:" Activo"}),a.jsx("option",{value:Ve.MANTENIMIENTO,children:" Mantenimiento"}),a.jsx("option",{value:Ve.INACTIVO,children:" Inactivo"}),a.jsx("option",{value:Ve.REPARACION,children:" Reparacin"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Tipo de Combustible"}),a.jsxs("select",{value:n.fuelType,onChange:N=>_("fuelType",N.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los combustibles"}),a.jsx("option",{value:vt.DIESEL,children:" Diesel"}),a.jsx("option",{value:vt.GASOLINA,children:" Gasolina"}),a.jsx("option",{value:vt.ACPM,children:" ACPM"}),a.jsx("option",{value:vt.MIXTO,children:" Mixto"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Ubicacin Actual"}),a.jsxs("select",{value:n.location,onChange:N=>_("location",N.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todas las ubicaciones"}),y.map(N=>a.jsxs("option",{value:N,children:[" ",N]},N))]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Mantenimiento"}),a.jsxs("select",{value:n.maintenance,onChange:N=>_("maintenance",N.target.value),className:"filter-select",children:[a.jsx("option",{value:"all",children:"Todos"}),a.jsx("option",{value:"due",children:"Mantenimiento debido"}),a.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),a.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),a.jsxs("div",{className:"filters-actions",children:[a.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:x===0,children:" Limpiar Filtros"}),a.jsxs("div",{className:"filters-info",children:[a.jsxs("span",{className:"results-count",children:[f," resultado",f!==1?"s":""]}),x>0&&a.jsxs("span",{className:"active-filters-text",children:["(",x," filtro",x!==1?"s":""," activo",x!==1?"s":"",")"]})]})]})]}),x>0&&a.jsx("div",{className:"active-filters-summary",children:a.jsxs("div",{className:"summary-content",children:[a.jsx("span",{className:"summary-label",children:"Filtros activos:"}),a.jsxs("div",{className:"summary-tags",children:[n.type&&a.jsxs("span",{className:"summary-tag",onClick:()=>_("type",""),children:["Tipo: ",n.type," "]}),n.status&&a.jsxs("span",{className:"summary-tag",onClick:()=>_("status",""),children:["Estado: ",n.status," "]}),n.fuelType&&a.jsxs("span",{className:"summary-tag",onClick:()=>_("fuelType",""),children:["Combustible: ",n.fuelType," "]}),n.location&&a.jsxs("span",{className:"summary-tag",onClick:()=>_("location",""),children:["Ubicacin: ",n.location," "]}),n.maintenance!=="all"&&a.jsxs("span",{className:"summary-tag",onClick:()=>_("maintenance","all"),children:["Mantenimiento: ",n.maintenance," "]})]})]})}),a.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:a.jsx("small",{children:" Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},oV=({vehicles:n,onEdit:e,onView:t,onMaintenance:i})=>{const o=T=>new Intl.NumberFormat("es-CO").format(T),c=T=>`${o(T)} gal`,d=T=>`${o(T)} hrs`,f=T=>T?(T instanceof Date?T:new Date(T)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",p=T=>{if(!T)return"";const M=new Date,q=T instanceof Date?T:new Date(T),U=Math.abs(M-q),P=Math.ceil(U/(1e3*60*60*24));return P===1?"hace 1 da":P<7?`hace ${P} das`:P<30?`hace ${Math.ceil(P/7)} semanas`:P<365?`hace ${Math.ceil(P/30)} meses`:`hace ${Math.ceil(P/365)} aos`},g=T=>{if(!T)return"vehicle-default";const M=T.toLowerCase();return M.includes("excavadora")?"vehicle-excavadora":M.includes("bulldozer")?"vehicle-bulldozer":M.includes("cargador")?"vehicle-cargador":M.includes("camion")?"vehicle-camion":M.includes("grua")?"vehicle-grua":M.includes("motosierra")?"vehicle-motosierra":M.includes("tractor")?"vehicle-tractor":M.includes("volqueta")?"vehicle-volqueta":"vehicle-default"},y=T=>{switch(T){case Ve.ACTIVO:return"status-activo";case Ve.MANTENIMIENTO:return"status-mantenimiento";case Ve.INACTIVO:return"status-inactivo";case Ve.REPARACION:return"status-reparacion";default:return"status-default"}},x=T=>{if(!T)return"";const M=T.toLowerCase();return M.includes("excavadora")?"":M.includes("bulldozer")?"":M.includes("cargador")?"":M.includes("camion")?"":M.includes("grua")?"":M.includes("motosierra")?"":M.includes("tractor")?"":M.includes("volqueta")?"":""},_=T=>{switch(T){case vt.DIESEL:return"";case vt.GASOLINA:return"";case vt.ACPM:return"";case vt.MIXTO:return"";default:return""}},A=T=>{switch(T){case Ve.ACTIVO:return"";case Ve.MANTENIMIENTO:return"";case Ve.INACTIVO:return"";case Ve.REPARACION:return"";default:return""}},N=T=>!T.totalHoursWorked||T.totalHoursWorked===0?T.estimatedConsumptionPerHour||0:T.totalFuelConsumed/T.totalHoursWorked,C=T=>T.lastMaintenanceDate?Math.floor((new Date-new Date(T.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return a.jsx("div",{className:"vehicles-cards",children:n.map(T=>a.jsxs("div",{className:`vehicle-card ${g(T.type)}`,children:[a.jsx("div",{className:"card-header",children:a.jsxs("div",{className:"vehicle-info",children:[a.jsxs("div",{className:"vehicle-id-section",children:[a.jsx("span",{className:"vehicle-icon",children:x(T.type)}),a.jsxs("div",{className:"vehicle-details",children:[a.jsx("span",{className:"vehicle-id",children:T.vehicleId}),a.jsx("span",{className:"vehicle-name",children:T.name})]})]}),a.jsxs("div",{className:`status-badge ${y(T.status)}`,children:[a.jsx("span",{className:"status-icon",children:A(T.status)}),a.jsx("span",{className:"status-label",children:T.status.charAt(0).toUpperCase()+T.status.slice(1)})]})]})}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"basic-info",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Tipo:"}),a.jsxs("span",{className:"info-value",children:[x(T.type)," ",T.type.charAt(0).toUpperCase()+T.type.slice(1)]})]}),T.brand&&T.model&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),a.jsxs("span",{className:"info-value",children:[T.brand," ",T.model]})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Combustible:"}),a.jsxs("span",{className:"info-value",children:[_(T.fuelType)," ",T.fuelType]})]}),T.currentLocation&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Ubicacin:"}),a.jsxs("span",{className:"info-value",children:[" ",T.currentLocation]})]})]}),a.jsxs("div",{className:"consumption-metrics",children:[a.jsxs("div",{className:"metric-item",children:[a.jsx("div",{className:"metric-icon",children:""}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-value",children:c(T.totalFuelConsumed||0)}),a.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),a.jsxs("div",{className:"metric-item",children:[a.jsx("div",{className:"metric-icon",children:""}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-value",children:d(T.totalHoursWorked||0)}),a.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),a.jsxs("div",{className:"metric-item",children:[a.jsx("div",{className:"metric-icon",children:""}),a.jsxs("div",{className:"metric-content",children:[a.jsxs("div",{className:"metric-value",children:[N(T).toFixed(1)," gal/hr"]}),a.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),a.jsxs("div",{className:"metric-item",children:[a.jsx("div",{className:"metric-icon",children:""}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-value",children:T.totalMovements||0}),a.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(T.enginePower||T.fuelCapacity||T.year)&&a.jsxs("div",{className:"technical-specs",children:[T.enginePower&&a.jsxs("div",{className:"spec-item",children:[a.jsx("span",{className:"spec-icon",children:""}),a.jsxs("span",{className:"spec-value",children:[T.enginePower," HP"]})]}),T.fuelCapacity&&a.jsxs("div",{className:"spec-item",children:[a.jsx("span",{className:"spec-icon",children:""}),a.jsxs("span",{className:"spec-value",children:[T.fuelCapacity," gal"]})]}),T.year&&a.jsxs("div",{className:"spec-item",children:[a.jsx("span",{className:"spec-icon",children:""}),a.jsx("span",{className:"spec-value",children:T.year})]})]}),T.description&&a.jsx("div",{className:"description",children:a.jsx("p",{children:T.description})})]}),a.jsxs("div",{className:"card-footer",children:[a.jsxs("div",{className:"date-info",children:[T.lastMovementDate&&a.jsxs("div",{className:"date-item",children:[a.jsx("span",{className:"date-label",children:"ltimo movimiento:"}),a.jsx("span",{className:"date-value",children:f(T.lastMovementDate)}),a.jsx("span",{className:"date-relative",children:p(T.lastMovementDate)})]}),T.lastMaintenanceDate&&a.jsxs("div",{className:"date-item",children:[a.jsx("span",{className:"date-label",children:"ltimo mantenimiento:"}),a.jsx("span",{className:"date-value",children:f(T.lastMaintenanceDate)}),a.jsx("span",{className:"date-relative",children:p(T.lastMaintenanceDate)})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"btn-view",onClick:()=>t(T),title:"Ver detalles",children:""}),e&&T.status!==Ve.REPARACION&&a.jsx("button",{className:"btn-edit",onClick:()=>e(T),title:"Editar vehculo",children:""}),i&&a.jsx("button",{className:"btn-maintenance",onClick:()=>i(T),title:"Registrar mantenimiento",children:""})]})]}),T.status===Ve.MANTENIMIENTO&&a.jsx("div",{className:"maintenance-indicator",children:a.jsx("div",{className:"maintenance-pulse"})}),C(T)&&T.status===Ve.ACTIVO&&a.jsx("div",{className:"maintenance-due-badge",children:a.jsx("span",{children:"Mantenimiento Debido"})}),T.status===Ve.REPARACION&&a.jsx("div",{className:"repair-badge",children:a.jsx("span",{children:"En Reparacin"})}),T.totalHoursWorked>0&&a.jsxs("div",{className:"efficiency-indicator",children:[a.jsx("div",{className:"efficiency-bar",children:a.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(T.totalHoursWorked/2e3*100,100)}%`}})}),a.jsxs("span",{className:"efficiency-label",children:[(T.totalHoursWorked/2e3*100).toFixed(1),"% utilizacin anual"]})]})]},T.id))})},lV=({vehicles:n,onEdit:e,onView:t,onMaintenance:i})=>{const[o,c]=$.useState("vehicleId"),[d,f]=$.useState("asc"),p=F=>new Intl.NumberFormat("es-CO").format(F),g=F=>`${p(F)} gal`,y=F=>`${p(F)} hrs`,x=F=>F?(F instanceof Date?F:new Date(F)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",_=F=>{if(!F)return"";const G=F.toLowerCase();return G.includes("excavadora")?"":G.includes("bulldozer")?"":G.includes("cargador")?"":G.includes("camion")?"":G.includes("grua")?"":G.includes("motosierra")?"":G.includes("tractor")?"":G.includes("volqueta")?"":""},A=F=>{switch(F){case vt.DIESEL:return"";case vt.GASOLINA:return"";case vt.ACPM:return"";case vt.MIXTO:return"";default:return""}},N=F=>{switch(F){case Ve.ACTIVO:return"";case Ve.MANTENIMIENTO:return"";case Ve.INACTIVO:return"";case Ve.REPARACION:return"";default:return""}},C=F=>{switch(F){case Ve.ACTIVO:return"status-activo";case Ve.MANTENIMIENTO:return"status-mantenimiento";case Ve.INACTIVO:return"status-inactivo";case Ve.REPARACION:return"status-reparacion";default:return"status-default"}},T=F=>{o===F?f(d==="asc"?"desc":"asc"):(c(F),f("asc"))},M=[...n].sort((F,G)=>{let V=F[o],S=G[o];return(o.includes("Date")||o.includes("At"))&&(V=new Date(V||0),S=new Date(S||0)),typeof V=="number"&&typeof S=="number"?d==="asc"?V-S:S-V:typeof V=="string"&&typeof S=="string"?d==="asc"?V.localeCompare(S):S.localeCompare(V):V instanceof Date&&S instanceof Date?d==="asc"?V-S:S-V:!V&&!S?0:V?S?0:d==="asc"?-1:1:d==="asc"?1:-1}),q=F=>o!==F?"":d==="asc"?"":"",U=F=>!F.totalHoursWorked||F.totalHoursWorked===0?F.estimatedConsumptionPerHour||0:F.totalFuelConsumed/F.totalHoursWorked,P=F=>F.lastMaintenanceDate?Math.floor((new Date-new Date(F.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return a.jsxs("div",{className:"vehicles-table-container",children:[a.jsx("div",{className:"table-wrapper",children:a.jsxs("table",{className:"vehicles-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{className:"sortable",onClick:()=>T("vehicleId"),children:["ID Vehculo ",q("vehicleId")]}),a.jsxs("th",{className:"sortable",onClick:()=>T("name"),children:["Nombre ",q("name")]}),a.jsxs("th",{className:"sortable",onClick:()=>T("type"),children:["Tipo ",q("type")]}),a.jsx("th",{children:"Marca/Modelo"}),a.jsxs("th",{className:"sortable",onClick:()=>T("fuelType"),children:["Combustible ",q("fuelType")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>T("totalFuelConsumed"),children:["Consumido ",q("totalFuelConsumed")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>T("totalHoursWorked"),children:["Horas ",q("totalHoursWorked")]}),a.jsx("th",{className:"text-right",children:"Consumo/Hr"}),a.jsx("th",{children:"Ubicacin"}),a.jsxs("th",{className:"sortable",onClick:()=>T("status"),children:["Estado ",q("status")]}),a.jsxs("th",{className:"sortable",onClick:()=>T("lastMovementDate"),children:["ltimo Mov. ",q("lastMovementDate")]}),a.jsx("th",{className:"actions-column",children:"Acciones"})]})}),a.jsx("tbody",{children:M.map(F=>a.jsxs("tr",{className:`vehicle-row ${F.status===Ve.MANTENIMIENTO?"maintenance-row":""} ${P(F)?"needs-maintenance":""}`,children:[a.jsx("td",{className:"vehicle-id-cell",children:a.jsxs("div",{className:"id-content",children:[a.jsx("span",{className:"vehicle-icon",children:_(F.type)}),a.jsx("span",{className:"vehicle-id",children:F.vehicleId})]})}),a.jsx("td",{className:"name-cell",children:a.jsx("span",{className:"vehicle-name",children:F.name})}),a.jsx("td",{className:"type-cell",children:a.jsx("span",{className:"type-text",children:F.type.charAt(0).toUpperCase()+F.type.slice(1)})}),a.jsx("td",{className:"brand-model-cell",children:F.brand&&F.model?a.jsxs("span",{className:"brand-model",children:[F.brand," ",F.model]}):a.jsx("span",{className:"no-data",children:"-"})}),a.jsx("td",{className:"fuel-cell",children:a.jsxs("div",{className:"fuel-content",children:[a.jsx("span",{className:"fuel-icon",children:A(F.fuelType)}),a.jsx("span",{className:"fuel-text",children:F.fuelType})]})}),a.jsx("td",{className:"consumption-cell text-right",children:a.jsx("span",{className:"consumption-value",children:g(F.totalFuelConsumed||0)})}),a.jsx("td",{className:"hours-cell text-right",children:a.jsx("span",{className:"hours-value",children:y(F.totalHoursWorked||0)})}),a.jsx("td",{className:"rate-cell text-right",children:a.jsxs("span",{className:"rate-value",children:[U(F).toFixed(1)," gal/hr"]})}),a.jsx("td",{className:"location-cell",children:a.jsxs("span",{className:"location-text",children:[" ",F.currentLocation||"Sin ubicacin"]})}),a.jsx("td",{className:"status-cell",children:a.jsxs("div",{className:`status-badge ${C(F.status)}`,children:[a.jsx("span",{className:"status-icon",children:N(F.status)}),a.jsx("span",{className:"status-text",children:F.status.charAt(0).toUpperCase()+F.status.slice(1)})]})}),a.jsx("td",{className:"date-cell",children:a.jsxs("div",{className:"date-content",children:[a.jsx("span",{className:"date-value",children:x(F.lastMovementDate)}),P(F)&&a.jsx("span",{className:"maintenance-warning",children:""})]})}),a.jsx("td",{className:"actions-cell",children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"btn-action btn-view",onClick:()=>t(F),title:"Ver detalles",children:""}),e&&F.status!==Ve.REPARACION&&a.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(F),title:"Editar vehculo",children:""}),i&&a.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>i(F),title:"Registrar mantenimiento",children:""})]})})]},F.id))})]})}),a.jsxs("div",{className:"table-info",children:[a.jsxs("div",{className:"table-summary",children:[a.jsxs("span",{className:"total-rows",children:[n.length," vehculo",n.length!==1?"s":""]}),o&&a.jsxs("span",{className:"sort-info",children:["Ordenado por ",o," (",d==="asc"?"ascendente":"descendente",")"]})]}),a.jsxs("div",{className:"table-legend",children:[a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:""})," Activo"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:""})," Mantenimiento"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:""})," Inactivo"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:""})," Reparacin"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:""})," Mantto. Debido"]})]})]})]})},cV=({vehicles:n,viewMode:e,onEdit:t,onView:i,onMaintenance:o})=>e==="table"?a.jsx(lV,{vehicles:n,onEdit:t,onView:i,onMaintenance:o}):a.jsx(oV,{vehicles:n,onEdit:t,onView:i,onMaintenance:o}),uV="modulepreload",dV=function(n){return"/combustibles/"+n},HE={},ny=function(e,t,i){let o=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};var d=g;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");o=g(t.map(y=>{if(y=dV(y),y in HE)return;HE[y]=!0;const x=y.endsWith(".css"),_=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${_}`))return;const A=document.createElement("link");if(A.rel=x?"stylesheet":uV,x||(A.as="script"),A.crossOrigin="",A.href=y,p&&A.setAttribute("nonce",p),document.head.appendChild(A),x)return new Promise((N,C)=>{A.addEventListener("load",N),A.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${y}`)))})}))}function c(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return o.then(f=>{for(const p of f||[])p.status==="rejected"&&c(p.reason);return e().catch(c)})},Tu="combustibles_vehicle_categories",hV=async n=>{try{const e=DA(n);if(!e.isValid)throw new Error(`Datos invlidos: ${e.errors.join(", ")}`);const t=await BA();if(t.some(d=>d.id===n.id||d.name.toLowerCase()===n.name.toLowerCase()))throw new Error("Ya existe una categora con ese nombre o ID");n.id||(n.id=MA(n.name,t));const o={...n,createdAt:Ue(),updatedAt:Ue(),isCustom:!0,vehicleCount:0},c=await pl(Me(me,Tu),o);return console.log(" Categora creada:",n.name),{id:c.id,...o,createdAt:new Date,updatedAt:new Date}}catch(e){throw console.error(" Error al crear categora:",e),new Error(`Error al crear categora: ${e.message}`)}},BA=async()=>{try{const n=Te(Me(me,Tu),jn("name","asc")),e=await ft(n),t=[];return e.forEach(i=>{t.push({id:i.id,...i.data(),createdAt:i.data().createdAt?.toDate?.()||i.data().createdAt,updatedAt:i.data().updatedAt?.toDate?.()||i.data().updatedAt})}),t}catch(n){throw console.error(" Error al obtener categoras personalizadas:",n),new Error(`Error al obtener categoras: ${n.message}`)}},sy=async()=>{try{const n=await BA();return RA(n)}catch(n){return console.error(" Error al obtener todas las categoras:",n),os}},fV=async(n,e)=>{try{if(!n)throw new Error("ID de categora requerido");if(os.some(d=>d.id===n))throw new Error("No se pueden modificar las categoras predeterminadas");if(e.name||e.fuelTypes||e.fields){const d=DA({...e,id:n});if(!d.isValid)throw new Error(`Datos invlidos: ${d.errors.join(", ")}`)}const i={...e,updatedAt:Ue()},o=Je(me,Tu,n);await js(o,i),console.log(" Categora actualizada:",n);const c=await Fi(o);return{id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt}}catch(t){throw console.error(" Error al actualizar categora:",t),new Error(`Error al actualizar categora: ${t.message}`)}},mV=async n=>{try{if(!n)throw new Error("ID de categora requerido");if(os.some(c=>c.id===n))throw new Error("No se pueden eliminar las categoras predeterminadas");const{countVehiclesByCategory:t}=await ny(async()=>{const{countVehiclesByCategory:c}=await Promise.resolve().then(()=>UA);return{countVehiclesByCategory:c}},void 0),i=await t(n);if(i>0)throw new Error(`No se puede eliminar la categora porque tiene ${i} vehculo(s) asignado(s)`);const o=Je(me,Tu,n);return await vf(o),console.log(" Categora eliminada:",n),!0}catch(e){throw console.error(" Error al eliminar categora:",e),new Error(`Error al eliminar categora: ${e.message}`)}},pV=n=>{try{const e=Te(Me(me,Tu),jn("name","asc"));return qr(e,t=>{const i=[];t.forEach(c=>{i.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt})});const o=RA(i);n(o)},t=>{console.error(" Error en suscripcin a categoras:",t),n(os)})}catch(e){return console.error(" Error al suscribirse a categoras:",e),n(os),()=>{}}},GE=async()=>{try{const{getAllVehicles:n}=await ny(async()=>{const{getAllVehicles:i}=await Promise.resolve().then(()=>UA);return{getAllVehicles:i}},void 0),e=await n();return(await sy()).map(i=>{const o=e.filter(c=>c.category===i.id);return{...i,vehicleCount:o.length,activeVehicles:o.filter(c=>c.status==="activo").length,totalFuelCapacity:o.reduce((c,d)=>c+(d.fuelCapacity||0),0),avgEnginepower:o.length>0?o.reduce((c,d)=>c+(d.enginePower||0),0)/o.length:0}}).sort((i,o)=>o.vehicleCount-i.vehicleCount)}catch(n){return console.error(" Error al obtener estadsticas de categoras:",n),[]}},HA=({onClose:n,onCategoryCreated:e})=>{const[t,i]=$.useState([]),[o,c]=$.useState([]),[d,f]=$.useState(!0),[p,g]=$.useState(!1),[y,x]=$.useState(null),[_,A]=$.useState(!1),[N,C]=$.useState(""),[T,M]=$.useState({name:"",description:"",icon:"",color:"#2E86AB",fuelTypes:[],fields:[]});$.useEffect(()=>{q();const w=pV(I=>{i(I),U()});return()=>w&&w()},[]);const q=async()=>{try{f(!0);const[w,I]=await Promise.all([sy(),GE()]);i(w),c(I)}catch(w){console.error("Error cargando categoras:",w),C("Error al cargar categoras")}finally{f(!1)}},U=async()=>{try{const w=await GE();c(w)}catch(w){console.error("Error cargando estadsticas:",w)}},P=()=>{x(null),M({name:"",description:"",icon:"",color:"#2E86AB",fuelTypes:[],fields:[]}),A(!0)},F=w=>{if(os.some(I=>I.id===w.id)){C("No se pueden editar las categoras predeterminadas");return}x(w),M({name:w.name||"",description:w.description||"",icon:w.icon||"",color:w.color||"#2E86AB",fuelTypes:w.fuelTypes||[],fields:w.fields||[]}),A(!0)},G=async w=>{if(os.some(R=>R.id===w.id)){C("No se pueden eliminar las categoras predeterminadas");return}if(window.confirm(`Est seguro de eliminar la categora "${w.name}"?

Esta accin no se puede deshacer.`))try{g(!0),await mV(w.id),C("")}catch(R){console.error("Error eliminando categora:",R),C(R.message)}finally{g(!1)}},V=async w=>{if(w.preventDefault(),!T.name.trim()){C("El nombre de la categora es requerido");return}try{g(!0),C("");const I={...T,name:T.name.trim(),description:T.description.trim()};if(y)await fV(y.id,I);else{I.id=MA(I.name,t);const R=await hV(I);e&&e(R)}A(!1)}catch(I){console.error("Error guardando categora:",I),C(I.message)}finally{g(!1)}},S=w=>{M(I=>({...I,fields:I.fields.includes(w)?I.fields.filter(R=>R!==w):[...I.fields,w]}))},L=w=>{M(I=>({...I,fuelTypes:I.fuelTypes.includes(w)?I.fuelTypes.filter(R=>R!==w):[...I.fuelTypes,w]}))},O=w=>o.find(I=>I.id===w)||{vehicleCount:0,activeVehicles:0};return d?a.jsx("div",{className:"categories-manager",children:a.jsxs("div",{className:"loading",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Cargando categoras..."})]})}):a.jsxs("div",{className:"categories-manager",children:[a.jsxs("div",{className:"categories-header",children:[a.jsx("h3",{children:" Gestin de Categoras"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"btn-primary",onClick:P,disabled:p,children:" Nueva Categora"}),a.jsx("button",{className:"btn-secondary",onClick:n,children:" Cerrar"})]})]}),N&&a.jsxs("div",{className:"error-message",children:[a.jsxs("span",{children:[" ",N]}),a.jsx("button",{onClick:()=>C(""),children:""})]}),a.jsx("div",{className:"categories-grid",children:t.map(w=>{const I=os.some(de=>de.id===w.id),R=O(w.id);return a.jsxs("div",{className:`category-card ${I?"default":"custom"}`,style:{"--category-color":w.color},children:[a.jsxs("div",{className:"category-header",children:[a.jsx("div",{className:"category-icon",style:{color:w.color},children:w.icon}),a.jsxs("div",{className:"category-info",children:[a.jsx("h4",{children:w.name}),a.jsx("p",{children:w.description})]}),I&&a.jsx("span",{className:"default-badge",children:"Predeterminada"})]}),a.jsxs("div",{className:"category-stats",children:[a.jsxs("div",{className:"stat",children:[a.jsx("span",{className:"stat-value",children:R.vehicleCount}),a.jsx("span",{className:"stat-label",children:"Vehculos"})]}),a.jsxs("div",{className:"stat",children:[a.jsx("span",{className:"stat-value",children:R.activeVehicles}),a.jsx("span",{className:"stat-label",children:"Activos"})]})]}),a.jsxs("div",{className:"category-details",children:[a.jsxs("div",{className:"fuel-types",children:[a.jsx("strong",{children:"Combustibles:"}),a.jsx("div",{className:"fuel-list",children:(w.fuelTypes||[]).map(de=>a.jsx("span",{className:"fuel-tag",children:de},de))})]}),a.jsxs("div",{className:"fields",children:[a.jsx("strong",{children:"Campos:"}),a.jsxs("div",{className:"fields-list",children:[(w.fields||[]).slice(0,3).map(de=>{const be=VE.find(Q=>Q.key===de);return be?a.jsxs("span",{className:"field-tag",children:[be.icon," ",be.label]},de):null}),(w.fields||[]).length>3&&a.jsxs("span",{className:"more-fields",children:["+",(w.fields||[]).length-3," ms"]})]})]})]}),a.jsxs("div",{className:"category-actions",children:[a.jsx("button",{className:"btn-edit",onClick:()=>F(w),disabled:I||p,title:I?"No se pueden editar categoras predeterminadas":"Editar categora",children:" Editar"}),a.jsx("button",{className:"btn-delete",onClick:()=>G(w),disabled:I||p||R.vehicleCount>0,title:I?"No se pueden eliminar categoras predeterminadas":R.vehicleCount>0?"No se puede eliminar una categora con vehculos asignados":"Eliminar categora",children:" Eliminar"})]})]},w.id)})}),_&&a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"modal-content",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:y?" Editar Categora":" Nueva Categora"}),a.jsx("button",{onClick:()=>A(!1),children:""})]}),a.jsxs("form",{onSubmit:V,className:"category-form",children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Informacin Bsica"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Nombre *"}),a.jsx("input",{type:"text",value:T.name,onChange:w=>M(I=>({...I,name:w.target.value})),placeholder:"Ej: Maquinaria Pesada",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Icono"}),a.jsx("input",{type:"text",value:T.icon,onChange:w=>M(I=>({...I,icon:w.target.value})),placeholder:"",className:"icon-input"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Descripcin"}),a.jsx("textarea",{value:T.description,onChange:w=>M(I=>({...I,description:w.target.value})),placeholder:"Describe el tipo de vehculos que incluye esta categora",rows:"2"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Color"}),a.jsx("input",{type:"color",value:T.color,onChange:w=>M(I=>({...I,color:w.target.value})),className:"color-input"})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Tipos de Combustible Compatibles"}),a.jsx("div",{className:"fuel-types-grid",children:Object.values(IA).map(w=>a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:T.fuelTypes.includes(w),onChange:()=>L(w)}),a.jsx("span",{children:w})]},w))})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Campos Especficos"}),a.jsx("p",{className:"section-description",children:"Selecciona los campos que sern relevantes para esta categora"}),a.jsx("div",{className:"fields-grid",children:VE.map(w=>a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:T.fields.includes(w.key),onChange:()=>S(w.key)}),a.jsxs("span",{children:[w.icon," ",w.label]})]},w.key))})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Vista Previa"}),a.jsx("div",{className:"category-preview",style:{"--category-color":T.color},children:a.jsxs("div",{className:"category-header",children:[a.jsx("div",{className:"category-icon",style:{color:T.color},children:T.icon}),a.jsxs("div",{className:"category-info",children:[a.jsx("h4",{children:T.name||"Nombre de la categora"}),a.jsx("p",{children:T.description||"Descripcin de la categora"})]})]})})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>A(!1),disabled:p,children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn-primary",disabled:p||!T.name.trim(),children:p?"Guardando...":y?"Actualizar":"Crear"})]})]})]})})]})},gV=({isOpen:n,onClose:e,vehicle:t,onSave:i,mode:o="create"})=>{const[c,d]=$.useState([]),[f,p]=$.useState(null),[g,y]=$.useState(!1),[x,_]=$.useState(!1),[A,N]=$.useState(!1),[C,T]=$.useState({}),M=()=>({vehicleId:t?.vehicleId||"",name:t?.name||"",category:t?.category||"",brand:t?.brand||"",model:t?.model||"",year:t?.year||new Date().getFullYear(),fuelType:t?.fuelType||vt.DIESEL,status:t?.status||Ve.ACTIVO,currentLocation:t?.currentLocation||"",description:t?.description||"",plateNumber:t?.plateNumber||"",enginePower:t?.enginePower||"",fuelCapacity:t?.fuelCapacity||"",operatingWeight:t?.operatingWeight||"",loadCapacity:t?.loadCapacity||"",bucketCapacity:t?.bucketCapacity||"",hasHourMeter:t?.hasHourMeter||!1,currentHours:t?.currentHours||"",implementType:t?.implementType||"",flow:t?.flow||"",pressure:t?.pressure||"",weight:t?.weight||"",lastMaintenanceDate:t?.lastMaintenanceDate?new Date(t.lastMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:t?.purchaseDate?new Date(t.purchaseDate).toISOString().split("T")[0]:""}),[q,U]=$.useState(M());$.useEffect(()=>(n?(P(),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n]),$.useEffect(()=>{if(t&&c.length>0){const w=UE(t.category,c);p(w),U(M())}},[t,c]);const P=async()=>{try{N(!0);const w=await sy();if(d(w),o==="create"&&w.length>0){const I=w[0];p(I),U(R=>({...R,category:I.id}))}}catch(w){console.error("Error cargando categoras:",w)}finally{N(!1)}},F=w=>{const I=UE(w,c);p(I),U(R=>{const de=o==="create"&&R.name&&I?V(R.name,I):R.vehicleId;return{...R,category:w,vehicleId:de,fuelType:I?.fuelTypes?.includes(R.fuelType)?R.fuelType:I?.fuelTypes?.[0]||vt.DIESEL}}),T({})},G=(w,I)=>{if(U(R=>({...R,[w]:I})),C[w]&&T(R=>({...R,[w]:null})),w==="name"&&o==="create"){const R=V(I,f);U(de=>({...de,vehicleId:R}))}if(w==="category"&&o==="create"&&q.name){const R=f;if(R){const de=V(q.name,R);U(be=>({...be,vehicleId:de}))}}},V=(w,I)=>{if(!w||!I)return"";const R=I.name.split(" ").map(se=>se.charAt(0).toUpperCase()).join("").substring(0,3),de=w.replace(/[^a-zA-Z0-9]/g,"").substring(0,4).toUpperCase(),Q=Date.now().toString().slice(-3);return`${R}${de}${Q}`},S=()=>{const w={};return q.vehicleId?.trim()||(w.vehicleId="Cdigo del vehculo es requerido"),q.name?.trim()||(w.name="Nombre del vehculo es requerido"),q.category||(w.category="Categora es requerida"),q.fuelType||(w.fuelType="Tipo de combustible es requerido"),f&&q.fuelType&&(f.fuelTypes?.includes(q.fuelType)||(w.fuelType=`Este combustible no es compatible con la categora ${f.name}`)),["enginePower","fuelCapacity","operatingWeight","loadCapacity","bucketCapacity","flow","pressure","weight"].forEach(R=>{q[R]&&(isNaN(q[R])||Number(q[R])<0)&&(w[R]="Debe ser un nmero vlido mayor o igual a 0")}),q.year&&(q.year<1900||q.year>new Date().getFullYear()+1)&&(w.year=`Ao debe estar entre 1900 y ${new Date().getFullYear()+1}`),q.hasHourMeter&&q.currentHours&&(isNaN(q.currentHours)||Number(q.currentHours)<0)&&(w.currentHours="Horas actuales debe ser un nmero vlido mayor o igual a 0"),T(w),Object.keys(w).length===0},L=async w=>{if(w.preventDefault(),!!S())try{N(!0);const I={...q,type:f?.name||q.category||"Otro",enginePower:q.enginePower?Number(q.enginePower):null,fuelCapacity:q.fuelCapacity?Number(q.fuelCapacity):null,operatingWeight:q.operatingWeight?Number(q.operatingWeight):null,loadCapacity:q.loadCapacity?Number(q.loadCapacity):null,bucketCapacity:q.bucketCapacity?Number(q.bucketCapacity):null,currentHours:q.currentHours?Number(q.currentHours):null,flow:q.flow?Number(q.flow):null,pressure:q.pressure?Number(q.pressure):null,weight:q.weight?Number(q.weight):null,year:Number(q.year),lastMaintenanceDate:q.lastMaintenanceDate?new Date(q.lastMaintenanceDate):null,purchaseDate:q.purchaseDate?new Date(q.purchaseDate):null,categoryName:f?.name,categoryIcon:f?.icon,categoryColor:f?.color};await i(I),e()}catch(I){console.error("Error guardando vehculo:",I),T({submit:I.message})}finally{N(!1)}},O=()=>f&&f.fuelTypes||Object.values(vt);return n?a.jsxs("div",{className:"modal-overlay",children:[a.jsxs("div",{className:"modal-container",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:o==="create"?" Nuevo Vehculo":" Editar Vehculo"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>y(!0),disabled:A,children:" Gestionar Categoras"}),a.jsx("button",{type:"button",className:"btn-close",onClick:e,children:""})]})]}),a.jsxs("form",{onSubmit:L,className:"modal-body",children:[C.submit&&a.jsxs("div",{className:"error-banner",children:[" ",C.submit]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:" Categora del Vehculo"}),A?a.jsxs("div",{className:"loading-categories",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{children:"Cargando categoras..."})]}):a.jsxs("div",{className:"categories-selector",children:[a.jsxs("select",{value:q.category,onChange:w=>F(w.target.value),className:`category-select ${C.category?"error":""}`,children:[a.jsx("option",{value:"",children:"Seleccionar categora del vehculo..."}),c.map(w=>a.jsxs("option",{value:w.id,children:[w.icon," ",w.name,os.some(I=>I.id===w.id)&&" (Predeterminada)"]},w.id))]}),f&&a.jsx(vV,{category:f,isExpanded:x,onToggle:()=>_(!x)})]}),C.category&&a.jsx("span",{className:"field-error",children:C.category})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:" Informacin Bsica"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"vehicleId",className:"form-label",children:" Cdigo del Vehculo *"}),a.jsx("input",{type:"text",id:"vehicleId",value:q.vehicleId,className:`form-input ${C.vehicleId?"error":""} ${o==="create"?"readonly":""}`,placeholder:"Se genera automticamente",readOnly:o==="create",onChange:o==="edit"?w=>G("vehicleId",w.target.value):void 0,required:!0}),C.vehicleId&&a.jsx("span",{className:"field-error",children:C.vehicleId})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"name",className:"form-label",children:" Nombre del Vehculo *"}),a.jsx("input",{type:"text",id:"name",value:q.name,onChange:w=>G("name",w.target.value),className:`form-input ${C.name?"error":""}`,placeholder:"Ej: Excavadora Principal, Tractor TR1",required:!0}),C.name&&a.jsx("span",{className:"field-error",children:C.name})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"brand",className:"form-label",children:" Marca"}),a.jsx("input",{type:"text",id:"brand",value:q.brand,onChange:w=>G("brand",w.target.value),className:"form-input",placeholder:"Ej: Caterpillar, John Deere"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"year",className:"form-label",children:" Ao"}),a.jsx("input",{type:"number",id:"year",value:q.year,onChange:w=>G("year",w.target.value),className:`form-input ${C.year?"error":""}`,min:"1900",max:new Date().getFullYear()+1}),C.year&&a.jsx("span",{className:"field-error",children:C.year})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"fuelType",className:"form-label",children:" Tipo de Combustible *"}),a.jsx("select",{id:"fuelType",value:q.fuelType,onChange:w=>G("fuelType",w.target.value),className:`form-input ${C.fuelType?"error":""}`,required:!0,children:O().map(w=>a.jsx("option",{value:w,children:w},w))}),C.fuelType&&a.jsx("span",{className:"field-error",children:C.fuelType})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"status",className:"form-label",children:" Estado"}),a.jsx("select",{id:"status",value:q.status,onChange:w=>G("status",w.target.value),className:"form-input",children:Object.entries(Ve).map(([w,I])=>a.jsx("option",{value:I,children:I.charAt(0).toUpperCase()+I.slice(1)},w))})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"currentLocation",className:"form-label",children:" Ubicacin Actual"}),a.jsx("input",{type:"text",id:"currentLocation",value:q.currentLocation,onChange:w=>G("currentLocation",w.target.value),className:"form-input",placeholder:"Ej: Sector Norte, Patio Principal"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"description",className:"form-label",children:" Descripcin"}),a.jsx("textarea",{id:"description",value:q.description,onChange:w=>G("description",w.target.value),className:"form-input",rows:"3",placeholder:"Descripcin adicional del vehculo, caractersticas especiales, etc."})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:" Fechas Importantes"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"purchaseDate",className:"form-label",children:" Fecha de Compra"}),a.jsx("input",{type:"date",id:"purchaseDate",value:q.purchaseDate,onChange:w=>G("purchaseDate",w.target.value),className:"form-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"lastMaintenanceDate",className:"form-label",children:" ltimo Mantenimiento"}),a.jsx("input",{type:"date",id:"lastMaintenanceDate",value:q.lastMaintenanceDate,onChange:w=>G("lastMaintenanceDate",w.target.value),className:"form-input"})]})]})]}),f&&a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:" Vista Previa"}),a.jsx("div",{className:"vehicle-preview",style:{"--category-color":f.color},children:a.jsxs("div",{className:"preview-header",children:[a.jsx("div",{className:"preview-icon",style:{color:f.color},children:f.icon}),a.jsxs("div",{className:"preview-info",children:[a.jsx("h4",{children:q.name||"Nombre del vehculo"}),a.jsxs("p",{children:[q.vehicleId||"Cdigo del vehculo","  ",f.name]}),a.jsxs("p",{children:[q.brand," ",q.year]})]})]})})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:A,children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn-primary",disabled:A||!f,children:A?"Guardando...":o==="create"?"Crear Vehculo":"Actualizar Vehculo"})]})]})]}),g&&a.jsx(HA,{onClose:()=>y(!1),onCategoryCreated:w=>{d(I=>[...I,w]),y(!1)}})]}):null},vV=({category:n,isExpanded:e,onToggle:t})=>n?a.jsxs("div",{className:"category-info-panel",children:[a.jsxs("div",{className:"category-compact",children:[a.jsxs("div",{className:"category-summary",children:[a.jsx("span",{className:"category-icon",style:{color:n.color},children:n.icon}),a.jsxs("div",{className:"category-basic-info",children:[a.jsx("span",{className:"category-name",children:n.name}),a.jsx("span",{className:"category-short-desc",children:n.description?.length>50?n.description.substring(0,50)+"...":n.description})]})]}),a.jsx("button",{type:"button",className:"category-toggle-btn",onClick:t,"aria-label":e?"Contraer informacin":"Expandir informacin",children:e?"":""})]}),e&&a.jsxs("div",{className:"category-expanded",children:[a.jsxs("div",{className:"category-detail-section",children:[a.jsx("h4",{children:" Descripcin Completa"}),a.jsx("p",{children:n.description})]}),n.fuelTypes&&n.fuelTypes.length>0&&a.jsxs("div",{className:"category-detail-section",children:[a.jsx("h4",{children:" Combustibles Compatibles"}),a.jsx("div",{className:"fuel-types-list",children:n.fuelTypes.map(i=>a.jsx("span",{className:"fuel-type-badge",children:i},i))})]}),n.fields&&n.fields.length>0&&a.jsxs("div",{className:"category-detail-section",children:[a.jsx("h4",{children:" Campos Especficos"}),a.jsx("div",{className:"fields-list",children:n.fields.map(i=>a.jsx("span",{className:"field-badge",children:i},i))})]}),n.isCustom&&a.jsx("div",{className:"category-detail-section",children:a.jsx("span",{className:"custom-badge",children:" Categora Personalizada"})})]})]}):null,Po={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},fi={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},Lo={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},yV=({isOpen:n,onClose:e,vehicle:t,maintenance:i,onSave:o,mode:c="create",userRole:d})=>{const f=()=>({vehicleId:t?.vehicleId||"",vehicleName:t?.name||"",type:i?.type||Po.PREVENTIVO,title:i?.title||"",description:i?.description||"",priority:i?.priority||Lo.MEDIA,status:i?.status||fi.PROGRAMADO,scheduledDate:i?.scheduledDate?new Date(i.scheduledDate).toISOString().split("T")[0]:"",startDate:i?.startDate?new Date(i.startDate).toISOString().split("T")[0]:"",completedDate:i?.completedDate?new Date(i.completedDate).toISOString().split("T")[0]:"",estimatedHours:i?.estimatedHours||0,actualHours:i?.actualHours||0,estimatedCost:i?.estimatedCost||0,actualCost:i?.actualCost||0,technician:i?.technician||"",workshop:i?.workshop||"",parts:i?.parts||[],notes:i?.notes||"",nextMaintenanceKm:i?.nextMaintenanceKm||0,nextMaintenanceHours:i?.nextMaintenanceHours||0,nextMaintenanceDate:i?.nextMaintenanceDate?new Date(i.nextMaintenanceDate).toISOString().split("T")[0]:""}),[p,g]=$.useState(f()),[y,x]=$.useState({}),[_,A]=$.useState(!1),[N,C]=$.useState({name:"",quantity:1,cost:0});$.useEffect(()=>{n&&(g(f()),x({}))},[n,i,t]);const T=I=>{const{name:R,value:de,type:be}=I.target,Q=be==="number"?parseFloat(de)||0:de;g(se=>({...se,[R]:Q})),y[R]&&x(se=>({...se,[R]:null}))},M=I=>{const{name:R,value:de,type:be}=I.target,Q=be==="number"?parseFloat(de)||0:de;C(se=>({...se,[R]:Q}))},q=()=>{if(!N.name.trim())return;const I={id:Date.now().toString(),name:N.name.trim(),quantity:N.quantity,cost:N.cost,total:N.quantity*N.cost};g(R=>({...R,parts:[...R.parts,I]})),C({name:"",quantity:1,cost:0})},U=I=>{g(R=>({...R,parts:R.parts.filter(de=>de.id!==I)}))},P=()=>{const I={};if(p.title.trim()||(I.title="El ttulo del mantenimiento es obligatorio"),p.description.trim()||(I.description="La descripcin es obligatoria"),p.scheduledDate||(I.scheduledDate="La fecha programada es obligatoria"),p.startDate&&p.completedDate){const R=new Date(p.startDate);new Date(p.completedDate)<R&&(I.completedDate="La fecha de finalizacin debe ser posterior al inicio")}return p.scheduledDate&&p.startDate&&(new Date(p.scheduledDate),new Date(p.startDate)),p.estimatedHours<0&&(I.estimatedHours="Las horas estimadas no pueden ser negativas"),p.actualHours<0&&(I.actualHours="Las horas reales no pueden ser negativas"),p.estimatedCost<0&&(I.estimatedCost="El costo estimado no puede ser negativo"),p.actualCost<0&&(I.actualCost="El costo real no puede ser negativo"),p.status===fi.COMPLETADO&&!p.completedDate&&(I.completedDate="La fecha de finalizacin es obligatoria para mantenimientos completados"),p.status===fi.EN_PROCESO&&!p.startDate&&(I.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),x(I),Object.keys(I).length===0},F=async I=>{if(I.preventDefault(),!!P()){A(!0);try{const R=p.parts.reduce((se,fe)=>se+fe.total,0),de=p.estimatedCost+R,be=p.actualCost+R,Q={...p,vehicleId:t.id,vehicleName:t.name,totalPartsCost:R,totalEstimatedCost:de,totalActualCost:be,scheduledDate:p.scheduledDate||null,startDate:p.startDate||null,completedDate:p.completedDate||null,nextMaintenanceDate:p.nextMaintenanceDate||null,createdAt:i?.createdAt||new Date,updatedAt:new Date};await o(Q),e()}catch(R){console.error("Error guardando mantenimiento:",R),x({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{A(!1)}}},G=I=>{switch(I){case Po.PREVENTIVO:return"";case Po.CORRECTIVO:return"";case Po.PREDICTIVO:return"";case Po.EMERGENCIA:return"";default:return""}},V=I=>{switch(I){case Lo.BAJA:return"priority-low";case Lo.MEDIA:return"priority-medium";case Lo.ALTA:return"priority-high";case Lo.CRITICA:return"priority-critical";default:return"priority-medium"}},S=I=>{switch(I){case fi.PROGRAMADO:return"status-scheduled";case fi.EN_PROCESO:return"status-in-progress";case fi.COMPLETADO:return"status-completed";case fi.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},L=()=>p.parts.reduce((I,R)=>I+R.total,0),O=c==="view",w=d==="admin"||d==="supervisor";return n?a.jsx("div",{className:"modal-overlay",onClick:e,children:a.jsxs("div",{className:"modal-content maintenance-modal",onClick:I=>I.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("div",{className:"modal-title",children:[a.jsx("span",{className:"title-icon",children:c==="create"?"":c==="edit"?"":""}),a.jsxs("div",{className:"title-text",children:[a.jsxs("h3",{children:[c==="create"&&"Registrar Mantenimiento",c==="edit"&&"Editar Mantenimiento",c==="view"&&"Detalles del Mantenimiento"]}),a.jsxs("p",{children:["Vehculo: ",t?.vehicleId," - ",t?.name]})]})]}),a.jsx("button",{className:"btn-close",onClick:e,type:"button",children:""})]}),a.jsxs("form",{onSubmit:F,className:"modal-form",children:[a.jsxs("div",{className:"form-content",children:[y.general&&a.jsxs("div",{className:"error-message general-error",children:[" ",y.general]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:" Informacin del Mantenimiento"}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),a.jsx("select",{id:"type",name:"type",value:p.type,onChange:T,disabled:O||c==="edit"&&!w,children:Object.values(Po).map(I=>a.jsxs("option",{value:I,children:[G(I)," ",I.charAt(0).toUpperCase()+I.slice(1)]},I))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"priority",children:"Prioridad"}),a.jsx("select",{id:"priority",name:"priority",value:p.priority,onChange:T,className:V(p.priority),disabled:O||c==="edit"&&!w,children:Object.values(Lo).map(I=>a.jsx("option",{value:I,children:I.charAt(0).toUpperCase()+I.slice(1)},I))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"status",children:"Estado"}),a.jsx("select",{id:"status",name:"status",value:p.status,onChange:T,className:S(p.status),disabled:O||c==="edit"&&!w,children:Object.values(fi).map(I=>a.jsx("option",{value:I,children:I.charAt(0).toUpperCase()+I.slice(1).replace("_"," ")},I))})]}),a.jsxs("div",{className:"form-group full-width",children:[a.jsx("label",{htmlFor:"title",children:"Ttulo del Mantenimiento *"}),a.jsx("input",{type:"text",id:"title",name:"title",value:p.title,onChange:T,placeholder:"Ej: Cambio de aceite y filtros",className:y.title?"error":"",disabled:O||c==="edit"&&!w,maxLength:100}),y.title&&a.jsx("span",{className:"error-text",children:y.title})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:" Programacin"}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),a.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:p.scheduledDate,onChange:T,className:y.scheduledDate?"error":"",disabled:O||c==="edit"&&!w}),y.scheduledDate&&a.jsx("span",{className:"error-text",children:y.scheduledDate})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),a.jsx("input",{type:"date",id:"startDate",name:"startDate",value:p.startDate,onChange:T,className:y.startDate?"error":"",disabled:O||c==="edit"&&!w}),y.startDate&&a.jsx("span",{className:"error-text",children:y.startDate})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalizacin"}),a.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:p.completedDate,onChange:T,className:y.completedDate?"error":"",disabled:O||c==="edit"&&!w}),y.completedDate&&a.jsx("span",{className:"error-text",children:y.completedDate})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Prximo Mantenimiento"}),a.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:p.nextMaintenanceDate,onChange:T,disabled:O||c==="edit"&&!w})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:" Recursos y Costos"}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"technician",children:"Tcnico Responsable"}),a.jsx("input",{type:"text",id:"technician",name:"technician",value:p.technician,onChange:T,placeholder:"Nombre del tcnico",disabled:O||c==="edit"&&!w,maxLength:100})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicacin"}),a.jsx("input",{type:"text",id:"workshop",name:"workshop",value:p.workshop,onChange:T,placeholder:"Taller donde se realiza",disabled:O||c==="edit"&&!w,maxLength:100})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),a.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:p.estimatedHours,onChange:T,min:"0",step:"0.5",className:y.estimatedHours?"error":"",disabled:O||c==="edit"&&!w}),y.estimatedHours&&a.jsx("span",{className:"error-text",children:y.estimatedHours})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),a.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:p.actualHours,onChange:T,min:"0",step:"0.5",className:y.actualHours?"error":"",disabled:O||c==="edit"&&!w}),y.actualHours&&a.jsx("span",{className:"error-text",children:y.actualHours})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),a.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:p.estimatedCost,onChange:T,min:"0",step:"1000",className:y.estimatedCost?"error":"",disabled:O||c==="edit"&&!w}),y.estimatedCost&&a.jsx("span",{className:"error-text",children:y.estimatedCost})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),a.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:p.actualCost,onChange:T,min:"0",step:"1000",className:y.actualCost?"error":"",disabled:O||c==="edit"&&!w}),y.actualCost&&a.jsx("span",{className:"error-text",children:y.actualCost})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:" Partes y Repuestos"}),!O&&w&&a.jsx("div",{className:"parts-form",children:a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),a.jsx("input",{type:"text",id:"partName",name:"name",value:N.name,onChange:M,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),a.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:N.quantity,onChange:M,min:"1",step:"1"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),a.jsx("input",{type:"number",id:"partCost",name:"cost",value:N.cost,onChange:M,min:"0",step:"1000"})]}),a.jsx("div",{className:"form-group",children:a.jsx("button",{type:"button",className:"btn-add-part",onClick:q,disabled:!N.name.trim(),children:" Agregar"})})]})}),p.parts.length>0&&a.jsx("div",{className:"parts-list",children:a.jsxs("table",{className:"parts-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Parte"}),a.jsx("th",{children:"Cantidad"}),a.jsx("th",{children:"Costo Unit."}),a.jsx("th",{children:"Total"}),!O&&w&&a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:p.parts.map(I=>a.jsxs("tr",{children:[a.jsx("td",{children:I.name}),a.jsx("td",{children:I.quantity}),a.jsxs("td",{children:["$",I.cost.toLocaleString("es-CO")]}),a.jsxs("td",{children:["$",I.total.toLocaleString("es-CO")]}),!O&&w&&a.jsx("td",{children:a.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>U(I.id),title:"Eliminar parte",children:""})})]},I.id))}),a.jsx("tfoot",{children:a.jsxs("tr",{className:"total-row",children:[a.jsx("td",{colSpan:"3",children:a.jsx("strong",{children:"Total Partes:"})}),a.jsx("td",{children:a.jsxs("strong",{children:["$",L().toLocaleString("es-CO")]})}),!O&&w&&a.jsx("td",{})]})})]})})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:" Prximo Mantenimiento"}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Prximo Mantenimiento (Km)"}),a.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:p.nextMaintenanceKm,onChange:T,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:O||c==="edit"&&!w})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Prximo Mantenimiento (Horas)"}),a.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:p.nextMaintenanceHours,onChange:T,min:"0",step:"100",placeholder:"0 = No aplica",disabled:O||c==="edit"&&!w})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:" Descripcin y Notas"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"description",children:"Descripcin del Trabajo *"}),a.jsx("textarea",{id:"description",name:"description",value:p.description,onChange:T,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:y.description?"error":"",disabled:O||c==="edit"&&!w}),y.description&&a.jsx("span",{className:"error-text",children:y.description})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),a.jsx("textarea",{id:"notes",name:"notes",value:p.notes,onChange:T,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:O||c==="edit"&&!w}),a.jsxs("span",{className:"char-count",children:[p.notes.length,"/500 caracteres"]})]})]}),a.jsxs("div",{className:"cost-summary",children:[a.jsx("h4",{children:" Resumen de Costos"}),a.jsxs("div",{className:"cost-grid",children:[a.jsxs("div",{className:"cost-item",children:[a.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),a.jsxs("span",{className:"cost-value",children:["$",p.actualCost.toLocaleString("es-CO")]})]}),a.jsxs("div",{className:"cost-item",children:[a.jsx("span",{className:"cost-label",children:"Partes:"}),a.jsxs("span",{className:"cost-value",children:["$",L().toLocaleString("es-CO")]})]}),a.jsxs("div",{className:"cost-item total-cost",children:[a.jsx("span",{className:"cost-label",children:"Total:"}),a.jsxs("span",{className:"cost-value",children:["$",(p.actualCost+L()).toLocaleString("es-CO")]})]})]})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:_,children:c==="view"?"Cerrar":"Cancelar"}),!O&&w&&a.jsx("button",{type:"submit",className:"btn-primary",disabled:_,children:_?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):a.jsx(a.Fragment,{children:c==="create"?" Registrar Mantenimiento":" Guardar Cambios"})})]})]})]})}):null},bV=()=>{const{user:n,userProfile:e}=ds(),[t,i]=$.useState([]),[o,c]=$.useState(null),[d,f]=$.useState(!0),[p,g]=$.useState(null),[y,x]=$.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[_,A]=$.useState("cards"),[N,C]=$.useState(""),[T,M]=$.useState(!1),[q,U]=$.useState(!1),[P,F]=$.useState(!1),[G,V]=$.useState(null),[S,L]=$.useState("create");$.useEffect(()=>{if(!n)return;f(!0);const ee=ty((le,ce)=>{if(ce){console.error("Error en suscripcin de vehculos:",ce),g("Error al cargar vehculos"),f(!1);return}i(le),g(null),f(!1)},y);return()=>ee()},[n,y]),$.useEffect(()=>{n&&(async()=>{try{const le=await LA(y);c(le)}catch(le){console.error("Error al cargar estadsticas:",le)}})()},[n,t,y]);const O=t.filter(ee=>{if(!N)return!0;const le=N.toLowerCase();return ee.vehicleId?.toLowerCase().includes(le)||ee.name?.toLowerCase().includes(le)||ee.type?.toLowerCase().includes(le)||ee.brand?.toLowerCase().includes(le)||ee.model?.toLowerCase().includes(le)||ee.currentLocation?.toLowerCase().includes(le)||ee.description?.toLowerCase().includes(le)}),w=()=>{V(null),L("create"),M(!0)},I=ee=>{V(ee),L("edit"),M(!0)},R=ee=>{V(ee),L("view"),M(!0)},de=ee=>{V(ee),U(!0)},be=()=>{M(!1),U(!1),V(null)},Q=ee=>{x(le=>({...le,...ee}))},se=()=>{x({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),C("")},fe=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",ke=e?.role==="admin",B=e?.role==="admin"||e?.role==="contador";return d?a.jsx("div",{className:"vehicles-main",children:a.jsxs("div",{className:"loading-container",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando vehculos..."})]})}):p?a.jsx("div",{className:"vehicles-main",children:a.jsxs("div",{className:"error-container",children:[a.jsx("div",{className:"error-icon",children:""}),a.jsx("h3",{children:"Error al cargar vehculos"}),a.jsx("p",{children:p}),a.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):a.jsxs("div",{className:"vehicles-main",children:[a.jsxs("div",{className:"vehicles-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h2",{children:" Gestin de Vehculos"}),a.jsx("p",{children:"Administra la maquinaria y vehculos forestales"})]}),fe&&a.jsx("button",{className:"btn-create-vehicle",onClick:w,children:" Nuevo Vehculo"})]}),o&&a.jsx(iV,{stats:o,filters:y}),a.jsx(rV,{filters:y,onFilterChange:Q,onClearFilters:se,searchTerm:N,onSearchChange:C,viewMode:_,onViewModeChange:A,totalResults:O.length}),O.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:""}),a.jsx("h3",{children:t.length===0?"No hay vehculos registrados":"No se encontraron vehculos"}),a.jsx("p",{children:t.length===0?"Comienza registrando tu primer vehculo o maquinaria forestal":"Intenta ajustar los filtros de bsqueda"}),t.length===0&&fe&&a.jsx("button",{className:"btn-create-first",onClick:w,children:" Registrar Primer Vehculo"})]}):a.jsx(cV,{vehicles:O,viewMode:_,onEdit:ke?I:null,onView:R,onMaintenance:B?de:null,userRole:n?.role}),T&&a.jsx(gV,{isOpen:T,onClose:be,vehicle:G,mode:S,onSave:async ee=>{S==="create"?await OA(ee):await PA(G.id,ee),be()},userRole:e?.role}),P&&a.jsx(HA,{onClose:()=>F(!1),onCategoryCreated:()=>{}}),q&&a.jsx(yV,{isOpen:q,onClose:be,vehicle:G,onSuccess:()=>{be()}})]})},ju="combustibles_maintenance",GA="combustibles_vehicles",pe={OIL_CHANGE:"oil_change",BATTERY_CHANGE:"battery_change",FILTER_CHANGE:"filter_change",GENERAL_MAINTENANCE:"general_maintenance"},Pe={COMPLETED:"completado",PENDING:"pendiente",CANCELLED:"cancelado"},Go={NEW:"nueva",USED:"usada",REPAIRED:"reparada"},ay={OIL_CHANGE_HOURS:250,BATTERY_LIFETIME_MONTHS:24},$A=async n=>{try{NV(n);const e={...n,createdAt:Ue(),updatedAt:Ue(),status:n.status||Pe.COMPLETED,createdBy:n.createdBy||"system"};n.type===pe.OIL_CHANGE&&(e.nextChangeHours=Tf(n.currentHours)),n.type===pe.BATTERY_CHANGE&&(e.nextBatteryChange=ZA(n.date));const t=await pl(Me(me,ju),e);return n.vehicleId&&n.currentHours&&await JA(n.vehicleId,n.currentHours),console.log(" Mantenimiento creado exitosamente:",t.id),t.id}catch(e){throw console.error(" Error al crear mantenimiento:",e),new Error(`Error al crear mantenimiento: ${e.message}`)}},YA=async(n={})=>{try{let e=Me(me,ju);n.type&&(e=Te(e,Ie("type","==",n.type))),n.vehicleId&&(e=Te(e,Ie("vehicleId","==",n.vehicleId))),n.status&&(e=Te(e,Ie("status","==",n.status))),n.dateFrom&&(e=Te(e,Ie("date",">=",new Date(n.dateFrom)))),n.dateTo&&(e=Te(e,Ie("date","<=",new Date(n.dateTo)))),e=Te(e,jn("date","desc"));const t=await ft(e),i=[];return t.forEach(o=>{i.push({id:o.id,...o.data()})}),i}catch(e){throw console.error(" Error al obtener mantenimientos:",e),new Error(`Error al obtener mantenimientos: ${e.message}`)}},QA=async(n,e)=>{try{_V(e);const t=Je(me,ju,n),i={...e,updatedAt:Ue()};e.currentHours&&e.type===pe.OIL_CHANGE&&(i.nextChangeHours=Tf(e.currentHours)),await js(t,i),e.vehicleId&&e.currentHours&&await JA(e.vehicleId,e.currentHours),console.log(" Mantenimiento actualizado exitosamente:",n)}catch(t){throw console.error(" Error al actualizar mantenimiento:",t),new Error(`Error al actualizar mantenimiento: ${t.message}`)}},xV=async n=>{try{const e=Je(me,ju,n);await vf(e),console.log(" Mantenimiento eliminado exitosamente:",n)}catch(e){throw console.error(" Error al eliminar mantenimiento:",e),new Error(`Error al eliminar mantenimiento: ${e.message}`)}},KA=async(n={})=>{try{const e=await YA(n),t={total:e.length,byType:{},byStatus:{},byVehicle:{},totalCost:0,averageCost:0,upcomingCount:0,overdueCount:0};let i=0;return e.forEach(o=>{t.byType[o.type]=(t.byType[o.type]||0)+1,t.byStatus[o.status]=(t.byStatus[o.status]||0)+1,t.byVehicle[o.vehicleId]=(t.byVehicle[o.vehicleId]||0)+1,o.cost&&(i+=parseFloat(o.cost)),o.nextChangeDate&&(new Date(o.nextChangeDate)>new Date?t.upcomingCount++:t.overdueCount++)}),t.totalCost=i,t.averageCost=t.total>0?i/t.total:0,t}catch(e){throw console.error(" Error al obtener estadsticas de mantenimiento:",e),new Error(`Error al obtener estadsticas de mantenimiento: ${e.message}`)}},XA=(n,e={})=>{try{let t=Me(me,ju);return e.type&&(t=Te(t,Ie("type","==",e.type))),e.vehicleId&&(t=Te(t,Ie("vehicleId","==",e.vehicleId))),e.status&&(t=Te(t,Ie("status","==",e.status))),t=Te(t,jn("date","desc")),qr(t,o=>{const c=[];o.forEach(d=>{c.push({id:d.id,...d.data()})}),n(c,null)},o=>{console.error(" Error en suscripcin de mantenimientos:",o),n([],o)})}catch(t){return console.error(" Error al suscribirse a mantenimientos:",t),n([],t),()=>{}}},WA=async()=>{try{const n=Te(Me(me,GA),Ie("status","in",["activo","mantenimiento"]),jn("name","asc")),e=await ft(n),t=[];return e.forEach(i=>{t.push({id:i.id,...i.data()})}),t}catch(n){throw console.error(" Error al obtener vehculos para mantenimiento:",n),new Error(`Error al obtener vehculos para mantenimiento: ${n.message}`)}},Tf=n=>parseInt(n)+ay.OIL_CHANGE_HOURS,ZA=n=>{const e=new Date(n);return e.setMonth(e.getMonth()+ay.BATTERY_LIFETIME_MONTHS),e},JA=async(n,e)=>{try{const t=Te(Me(me,GA),Ie("vehicleId","==",n)),i=await ft(t);if(!i.empty){const o=i.docs[0],c=o.data();if(c.hasHourMeter&&c.type==="tractor"){const d=parseInt(c.currentHours)||0,f=parseInt(e)||0;f>d&&(await js(o.ref,{currentHours:f,lastHourMeterDate:Ue(),updatedAt:Ue()}),console.log(` Hormetro actualizado para ${n}: ${d}  ${f}`))}}}catch(t){console.error(" Error al actualizar hormetro del vehculo:",t)}},NV=n=>{const e=[];if(n.type||e.push("El tipo de mantenimiento es obligatorio"),n.vehicleId||e.push("El vehculo es obligatorio"),n.date||e.push("La fecha es obligatoria"),n.type===pe.OIL_CHANGE&&((!n.quantity||n.quantity<=0)&&e.push("La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!n.currentHours||n.currentHours<0)&&e.push("La lectura del hormetro es obligatoria")),n.type===pe.BATTERY_CHANGE&&(n.batteryType||e.push("El tipo de batera es obligatorio"),(!n.cost||n.cost<=0)&&e.push("El costo de la batera es obligatorio")),e.length>0)throw new Error(e.join(", "))},_V=n=>{const e=[];if(n.type&&!Object.values(pe).includes(n.type)&&e.push("Tipo de mantenimiento invlido"),n.status&&!Object.values(Pe).includes(n.status)&&e.push("Estado de mantenimiento invlido"),n.batteryStatus&&!Object.values(Go).includes(n.batteryStatus)&&e.push("Estado de batera invlido"),e.length>0)throw new Error(e.join(", "))},EV=Object.freeze(Object.defineProperty({__proto__:null,BATTERY_STATUS:Go,MAINTENANCE_CONSTANTS:ay,MAINTENANCE_STATUS:Pe,MAINTENANCE_TYPES:pe,calculateNextBatteryChange:ZA,calculateNextOilChange:Tf,createMaintenanceRecord:$A,deleteMaintenanceRecord:xV,getAllMaintenanceRecords:YA,getMaintenanceStats:KA,getVehiclesForMaintenance:WA,subscribeToMaintenance:XA,updateMaintenanceRecord:QA},Symbol.toStringTag,{value:"Module"})),TV=({stats:n})=>{if(!n)return null;const e=c=>{switch(c){case pe.OIL_CHANGE:return"";case pe.BATTERY_CHANGE:return"";case pe.FILTER_CHANGE:return"";case pe.GENERAL_MAINTENANCE:return"";default:return""}},t=c=>{switch(c){case pe.OIL_CHANGE:return"Cambios de Aceite";case pe.BATTERY_CHANGE:return"Cambios de Batera";case pe.FILTER_CHANGE:return"Cambios de Filtros";case pe.GENERAL_MAINTENANCE:return"Mantenimientos Generales";default:return c}},i=c=>{switch(c){case Pe.COMPLETED:return"#10b981";case Pe.PENDING:return"#f59e0b";case Pe.CANCELLED:return"#ef4444";default:return"#6b7280"}},o=c=>{switch(c){case Pe.COMPLETED:return"Completados";case Pe.PENDING:return"Pendientes";case Pe.CANCELLED:return"Cancelados";default:return c}};return a.jsxs("div",{className:"maintenance-stats",children:[a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card primary",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:Oe(n.total)}),a.jsx("p",{children:"Total Mantenimientos"})]})]}),a.jsxs("div",{className:"stat-card success",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:Dn(n.totalCost)}),a.jsx("p",{children:"Costo Total"})]})]}),a.jsxs("div",{className:"stat-card warning",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:Oe(n.upcomingCount)}),a.jsx("p",{children:"Prximos"})]})]}),a.jsxs("div",{className:"stat-card danger",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:Oe(n.overdueCount)}),a.jsx("p",{children:"Vencidos"})]})]})]}),Object.keys(n.byType).length>0&&a.jsxs("div",{className:"stats-breakdown",children:[a.jsx("h3",{children:" Desglose por Tipo"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([c,d])=>a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:e(c)}),a.jsx("span",{className:"breakdown-label",children:t(c)})]}),a.jsx("div",{className:"breakdown-value",children:Oe(d)}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:"#3b82f6"}})}),a.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),Object.keys(n.byStatus).length>0&&a.jsxs("div",{className:"stats-breakdown",children:[a.jsx("h3",{children:" Desglose por Estado"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([c,d])=>a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:i(c)}}),a.jsx("span",{className:"breakdown-label",children:o(c)})]}),a.jsx("div",{className:"breakdown-value",children:Oe(d)}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:i(c)}})}),a.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),a.jsxs("div",{className:"stats-insights",children:[a.jsx("h3",{children:" Insights"}),a.jsxs("div",{className:"insights-grid",children:[a.jsxs("div",{className:"insight-item",children:[a.jsx("span",{className:"insight-label",children:"Costo Promedio:"}),a.jsx("span",{className:"insight-value",children:Dn(n.averageCost)})]}),n.overdueCount>0&&a.jsxs("div",{className:"insight-item alert",children:[a.jsx("span",{className:"insight-label",children:" Mantenimientos Vencidos:"}),a.jsxs("span",{className:"insight-value",children:[Oe(n.overdueCount)," requieren atencin"]})]}),n.upcomingCount>0&&a.jsxs("div",{className:"insight-item info",children:[a.jsx("span",{className:"insight-label",children:" Prximos Mantenimientos:"}),a.jsxs("span",{className:"insight-value",children:[Oe(n.upcomingCount)," programados"]})]})]})]})]})},jV=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:i,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const p=A=>{switch(A){case pe.OIL_CHANGE:return"Cambio de Aceite";case pe.BATTERY_CHANGE:return"Cambio de Batera";case pe.FILTER_CHANGE:return"Cambio de Filtros";case pe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return A}},g=A=>{switch(A){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return A}},y=(A,N)=>{e({[A]:N})},x=A=>{e(A)},_=()=>Object.values(n).some(A=>A!=="")||i;return a.jsx("div",{className:"maintenance-filters",children:a.jsxs("div",{className:"filters-main",children:[a.jsx("div",{className:"search-section",children:a.jsxs("div",{className:"search-box",children:[a.jsx("span",{className:"search-icon",children:""}),a.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar mantenimientos...",value:i,onChange:A=>o(A.target.value)}),i&&a.jsx("button",{className:"search-clear",onClick:()=>o(""),children:""})]})}),a.jsxs("div",{className:"filters-controls",children:[a.jsxs("div",{className:"quick-filters",children:[a.jsx("button",{className:`quick-filter ${_()?"":"active"}`,onClick:()=>t(),children:"Todos"}),a.jsx("button",{className:`quick-filter ${n.type===pe.OIL_CHANGE?"active":""}`,onClick:()=>x({type:pe.OIL_CHANGE}),children:" Aceite"}),a.jsx("button",{className:`quick-filter ${n.type===pe.BATTERY_CHANGE?"active":""}`,onClick:()=>x({type:pe.BATTERY_CHANGE}),children:" Bateras"}),a.jsx("button",{className:`quick-filter ${n.status===Pe.PENDING?"active":""}`,onClick:()=>x({status:Pe.PENDING}),children:" Pendientes"})]}),a.jsxs("button",{className:`btn-advanced-filters ${_()?"active":""}`,onClick:()=>document.querySelector(".filters-advanced").classList.toggle("show"),children:[" Filtros Avanzados",_()&&a.jsx("span",{className:"filters-count",children:Object.values(n).filter(A=>A!=="").length})]}),a.jsxs("div",{className:"view-modes",children:[a.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),children:" Cards"}),a.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),children:" Tabla"})]})]}),a.jsxs("div",{className:"filters-advanced",children:[a.jsxs("div",{className:"filters-grid",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Tipo de Mantenimiento"}),a.jsxs("select",{value:n.type,onChange:A=>y("type",A.target.value),children:[a.jsx("option",{value:"",children:"Todos los tipos"}),a.jsx("option",{value:pe.OIL_CHANGE,children:p(pe.OIL_CHANGE)}),a.jsx("option",{value:pe.BATTERY_CHANGE,children:p(pe.BATTERY_CHANGE)}),a.jsx("option",{value:pe.FILTER_CHANGE,children:p(pe.FILTER_CHANGE)}),a.jsx("option",{value:pe.GENERAL_MAINTENANCE,children:p(pe.GENERAL_MAINTENANCE)})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Estado"}),a.jsxs("select",{value:n.status,onChange:A=>y("status",A.target.value),children:[a.jsx("option",{value:"",children:"Todos los estados"}),a.jsx("option",{value:Pe.COMPLETED,children:g(Pe.COMPLETED)}),a.jsx("option",{value:Pe.PENDING,children:g(Pe.PENDING)}),a.jsx("option",{value:Pe.CANCELLED,children:g(Pe.CANCELLED)})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Fecha Desde"}),a.jsx("input",{type:"date",value:n.dateFrom,onChange:A=>y("dateFrom",A.target.value)})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Fecha Hasta"}),a.jsx("input",{type:"date",value:n.dateTo,onChange:A=>y("dateTo",A.target.value)})]})]}),a.jsx("div",{className:"filters-actions",children:a.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:!_(),children:" Limpiar Filtros"})})]}),a.jsxs("div",{className:"filters-info",children:[a.jsxs("div",{className:"results-count",children:[f," mantenimiento",f!==1?"s":""," encontrado",f!==1?"s":""]}),_()&&a.jsxs("div",{className:"active-filters",children:[a.jsx("span",{className:"filters-label",children:"Filtros activos:"}),a.jsxs("div",{className:"filter-tags",children:[n.type&&a.jsxs("span",{className:"filter-tag",children:["Tipo: ",p(n.type),a.jsx("button",{onClick:()=>y("type",""),children:""})]}),n.status&&a.jsxs("span",{className:"filter-tag",children:["Estado: ",g(n.status),a.jsx("button",{onClick:()=>y("status",""),children:""})]}),n.dateFrom&&a.jsxs("span",{className:"filter-tag",children:["Desde: ",n.dateFrom,a.jsx("button",{onClick:()=>y("dateFrom",""),children:""})]}),n.dateTo&&a.jsxs("span",{className:"filter-tag",children:["Hasta: ",n.dateTo,a.jsx("button",{onClick:()=>y("dateTo",""),children:""})]}),i&&a.jsxs("span",{className:"filter-tag",children:['Bsqueda: "',i,'"',a.jsx("button",{onClick:()=>o(""),children:""})]})]})]})]})]})})},AV=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:i,userRole:o})=>{const c=N=>N?new Date(N).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"N/A",d=N=>{if(!N)return"";const C=new Date,T=new Date(N),M=Math.abs(C-T),q=Math.ceil(M/(1e3*60*60*24));return q===0?"Hoy":q===1?"Ayer":q<7?`Hace ${q} das`:q<30?`Hace ${Math.floor(q/7)} semanas`:`Hace ${Math.floor(q/30)} meses`},f=N=>{switch(N){case pe.OIL_CHANGE:return"maintenance-oil-change";case pe.BATTERY_CHANGE:return"maintenance-battery-change";case pe.FILTER_CHANGE:return"maintenance-filter-change";case pe.GENERAL_MAINTENANCE:return"maintenance-general";default:return"maintenance-general"}},p=N=>{switch(N){case Pe.COMPLETED:return"status-completado";case Pe.PENDING:return"status-pendiente";case Pe.CANCELLED:return"status-cancelado";default:return"status-unknown"}},g=N=>{switch(N){case pe.OIL_CHANGE:return"";case pe.BATTERY_CHANGE:return"";case pe.FILTER_CHANGE:return"";case pe.GENERAL_MAINTENANCE:return"";default:return""}},y=N=>{switch(N){case pe.OIL_CHANGE:return"Cambio de Aceite";case pe.BATTERY_CHANGE:return"Cambio de Batera";case pe.FILTER_CHANGE:return"Cambio de Filtros";case pe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return N}},x=N=>{switch(N){case Pe.COMPLETED:return"";case Pe.PENDING:return"";case Pe.CANCELLED:return"";default:return""}},_=N=>{switch(N){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return N}},A=o==="admin"||o==="supervisor";return a.jsx("div",{className:"maintenance-cards",children:n.map(N=>a.jsxs("div",{className:`maintenance-card ${f(N.type)}`,children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("div",{className:"maintenance-type",children:[a.jsx("span",{className:"type-icon",children:g(N.type)}),a.jsx("span",{className:"type-label",children:y(N.type)})]}),a.jsxs("div",{className:`status-badge ${p(N.status)}`,children:[x(N.status)," ",_(N.status)]})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"vehicle-info",children:[a.jsx("span",{className:"vehicle-icon",children:""}),a.jsxs("div",{className:"vehicle-details",children:[a.jsx("div",{className:"vehicle-name",children:N.vehicleName}),a.jsx("div",{className:"vehicle-id",children:N.vehicleId})]})]}),a.jsxs("div",{className:"date-info",children:[a.jsx("div",{className:"created-date",children:c(N.date)}),a.jsx("div",{className:"relative-time",children:d(N.date)})]}),N.type===pe.OIL_CHANGE&&a.jsxs("div",{className:"oil-change-info",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Cantidad:"}),a.jsxs("span",{className:"info-value",children:[Oe(N.quantity)," galones"]})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Hormetro:"}),a.jsxs("span",{className:"info-value",children:[Oe(N.currentHours)," horas"]})]}),N.nextChangeHours&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Prximo cambio:"}),a.jsxs("span",{className:"info-value",children:[Oe(N.nextChangeHours)," horas"]})]}),N.filters&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Filtros:"}),a.jsx("span",{className:"info-value",children:N.filters})]})]}),N.type===pe.BATTERY_CHANGE&&a.jsxs("div",{className:"battery-change-info",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Tipo:"}),a.jsx("span",{className:"info-value",children:N.batteryType})]}),N.brand&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Marca:"}),a.jsx("span",{className:"info-value",children:N.brand})]}),N.model&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Modelo:"}),a.jsx("span",{className:"info-value",children:N.model})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Estado:"}),a.jsx("span",{className:"info-value",children:N.batteryStatus})]}),N.cost&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Costo:"}),a.jsx("span",{className:"info-value",children:Dn(N.cost)})]})]}),N.notes&&a.jsxs("div",{className:"notes-section",children:[a.jsx("span",{className:"notes-label",children:"Notas:"}),a.jsx("p",{className:"notes-text",children:N.notes})]})]}),a.jsx("div",{className:"card-footer",children:a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"btn-view",onClick:()=>t(N),title:"Ver detalles",children:" Ver"}),A&&e&&a.jsx("button",{className:"btn-edit",onClick:()=>e(N),title:"Editar",children:" Editar"}),A&&i&&a.jsx("button",{className:"btn-delete",onClick:()=>i(N.id),title:"Eliminar",children:" Eliminar"})]})})]},N.id))})},wV=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:i,userRole:o})=>{const[c,d]=$.useState("date"),[f,p]=$.useState("desc"),g=U=>U?new Date(U).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",y=U=>{switch(U){case pe.OIL_CHANGE:return"";case pe.BATTERY_CHANGE:return"";case pe.FILTER_CHANGE:return"";case pe.GENERAL_MAINTENANCE:return"";default:return""}},x=U=>{switch(U){case pe.OIL_CHANGE:return"Cambio de Aceite";case pe.BATTERY_CHANGE:return"Cambio de Batera";case pe.FILTER_CHANGE:return"Cambio de Filtros";case pe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return U}},_=U=>{switch(U){case Pe.COMPLETED:return"";case Pe.PENDING:return"";case Pe.CANCELLED:return"";default:return""}},A=U=>{switch(U){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return U}},N=U=>{switch(U){case Pe.COMPLETED:return"status-completado";case Pe.PENDING:return"status-pendiente";case Pe.CANCELLED:return"status-cancelado";default:return"status-unknown"}},C=U=>{c===U?p(f==="asc"?"desc":"asc"):(d(U),p("asc"))},T=U=>c!==U?"":f==="asc"?"":"",M=[...n].sort((U,P)=>{let F=U[c],G=P[c];return c==="date"&&(F=new Date(F),G=new Date(G)),["quantity","currentHours","nextChangeHours","cost"].includes(c)&&(F=parseFloat(F)||0,G=parseFloat(G)||0),typeof F=="string"&&(F=F.toLowerCase(),G=G.toLowerCase()),f==="asc"?F>G?1:-1:F<G?1:-1}),q=o==="admin"||o==="supervisor";return a.jsxs("div",{className:"maintenance-table-container",children:[a.jsx("div",{className:"table-wrapper",children:a.jsxs("table",{className:"maintenance-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{className:"sortable",onClick:()=>C("type"),children:["Tipo ",T("type")]}),a.jsxs("th",{className:"sortable",onClick:()=>C("vehicleName"),children:["Vehculo ",T("vehicleName")]}),a.jsxs("th",{className:"sortable",onClick:()=>C("date"),children:["Fecha ",T("date")]}),a.jsx("th",{children:"Detalles"}),a.jsxs("th",{className:"sortable",onClick:()=>C("status"),children:["Estado ",T("status")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>C("cost"),children:["Costo ",T("cost")]}),a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:M.map(U=>a.jsxs("tr",{className:"maintenance-row",children:[a.jsx("td",{className:"type-cell",children:a.jsxs("div",{className:"type-content",children:[a.jsx("span",{className:"type-icon",children:y(U.type)}),a.jsx("span",{className:"type-name",children:x(U.type)})]})}),a.jsx("td",{className:"vehicle-cell",children:a.jsxs("div",{className:"vehicle-info",children:[a.jsx("div",{className:"vehicle-name",children:U.vehicleName}),a.jsx("div",{className:"vehicle-id",children:U.vehicleId})]})}),a.jsx("td",{className:"date-cell",children:a.jsx("div",{className:"date-content",children:a.jsx("div",{className:"date-value",children:g(U.date)})})}),a.jsxs("td",{className:"details-cell",children:[U.type===pe.OIL_CHANGE&&a.jsxs("div",{className:"oil-details",children:[a.jsxs("div",{children:["Qty: ",Oe(U.quantity)," gal"]}),a.jsxs("div",{children:["Hrs: ",Oe(U.currentHours)]}),U.filters&&a.jsxs("div",{children:["Filtros: ",U.filters]})]}),U.type===pe.BATTERY_CHANGE&&a.jsxs("div",{className:"battery-details",children:[a.jsx("div",{children:U.batteryType}),U.brand&&a.jsx("div",{children:U.brand}),a.jsxs("div",{children:["Estado: ",U.batteryStatus]})]}),U.notes&&a.jsx("div",{className:"notes-small",children:U.notes})]}),a.jsx("td",{className:"status-cell",children:a.jsxs("div",{className:`status-badge ${N(U.status)}`,children:[_(U.status)," ",A(U.status)]})}),a.jsx("td",{className:"cost-cell text-right",children:U.cost?Dn(U.cost):"N/A"}),a.jsx("td",{className:"actions-cell",children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"btn-action btn-view",onClick:()=>t(U),title:"Ver detalles",children:""}),q&&e&&a.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(U),title:"Editar",children:""}),q&&i&&a.jsx("button",{className:"btn-action btn-delete",onClick:()=>i(U.id),title:"Eliminar",children:""})]})})]},U.id))})]})}),a.jsxs("div",{className:"table-info",children:[a.jsx("div",{className:"table-summary",children:a.jsxs("span",{className:"total-rows",children:[n.length," mantenimiento",n.length!==1?"s":""," en total"]})}),a.jsxs("div",{className:"table-legend",children:[a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot oil-change"}),a.jsx("span",{children:"Cambio de Aceite"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot battery-change"}),a.jsx("span",{children:"Cambio de Batera"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot filter-change"}),a.jsx("span",{children:"Cambio de Filtros"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot general"}),a.jsx("span",{children:"Mantenimiento General"})]})]})]})]})},CV=({maintenanceRecords:n,viewMode:e,onEdit:t,onView:i,onDelete:o,userRole:c})=>!n||n.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:""}),a.jsx("h3",{children:"No hay mantenimientos registrados"}),a.jsx("p",{children:"Comienza creando el primer mantenimiento para tu flota de vehculos."})]}):a.jsx("div",{className:"maintenance-list",children:e==="cards"?a.jsx(AV,{maintenanceRecords:n,onEdit:t,onView:i,onDelete:o,userRole:c}):a.jsx(wV,{maintenanceRecords:n,onEdit:t,onView:i,onDelete:o,userRole:c})}),SV=({isOpen:n,onClose:e,onSuccess:t,maintenance:i,mode:o="create",userRole:c})=>{const d=()=>({type:i?.type||pe.OIL_CHANGE,vehicleId:i?.vehicleId||"",vehicleName:i?.vehicleName||"",date:i?.date?new Date(i.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:i?.status||Pe.COMPLETED,quantity:i?.quantity||0,currentHours:i?.currentHours||0,nextChangeHours:i?.nextChangeHours||0,filters:i?.filters||"",batteryType:i?.batteryType||"",brand:i?.brand||"",model:i?.model||"",batteryStatus:i?.batteryStatus||Go.NEW,notes:i?.notes||"",cost:i?.cost||0}),[f,p]=$.useState(d()),[g,y]=$.useState({}),[x,_]=$.useState(!1),[A,N]=$.useState([]);$.useEffect(()=>{n&&(async()=>{try{const G=await WA();N(G)}catch(G){console.error("Error al cargar vehculos:",G)}})()},[n]),$.useEffect(()=>{n&&(p(d()),y({}))},[n,i,A]),$.useEffect(()=>{if(f.type===pe.OIL_CHANGE&&f.currentHours>0){const F=Tf(f.currentHours);p(G=>({...G,nextChangeHours:F}))}},[f.currentHours,f.type]);const C=(F,G)=>{const V=typeof G=="number"?parseFloat(G)||0:G;p(S=>({...S,[F]:V})),g[F]&&y(S=>({...S,[F]:null}))},T=F=>{const G=A.find(V=>V.vehicleId===F);p(V=>({...V,vehicleId:F,vehicleName:G?G.name:""})),G&&G.hasHourMeter&&G.currentHours&&p(V=>({...V,currentHours:G.currentHours}))},M=()=>{const F={};return f.type||(F.type="El tipo de mantenimiento es obligatorio"),f.vehicleId||(F.vehicleId="El vehculo es obligatorio"),f.date||(F.date="La fecha es obligatoria"),f.type===pe.OIL_CHANGE&&((!f.quantity||f.quantity<=0)&&(F.quantity="La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!f.currentHours||f.currentHours<0)&&(F.currentHours="La lectura del hormetro es obligatoria")),f.type===pe.BATTERY_CHANGE&&(f.batteryType||(F.batteryType="El tipo de batera es obligatorio"),(!f.cost||f.cost<=0)&&(F.cost="El costo de la batera es obligatorio")),y(F),Object.keys(F).length===0},q=async F=>{if(F.preventDefault(),!!M()){_(!0);try{const G={...f,date:new Date(f.date),createdBy:c||"user"};o==="create"?(await $A(G),console.log(" Mantenimiento creado exitosamente")):o==="edit"&&(await QA(i.id,G),console.log(" Mantenimiento actualizado exitosamente")),t()}catch(G){console.error(" Error al guardar mantenimiento:",G),alert("Error al guardar mantenimiento: "+G.message)}finally{_(!1)}}},U=()=>{switch(o){case"create":return"Crear Mantenimiento";case"edit":return"Editar Mantenimiento";case"view":return"Ver Mantenimiento";default:return"Mantenimiento"}},P=F=>{switch(F){case pe.OIL_CHANGE:return"";case pe.BATTERY_CHANGE:return"";case pe.FILTER_CHANGE:return"";case pe.GENERAL_MAINTENANCE:return"";default:return""}};return n?a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"modal-content maintenance-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:U()}),a.jsx("button",{className:"modal-close",onClick:e,children:""})]}),a.jsx("div",{className:"modal-body",children:a.jsxs("form",{onSubmit:q,className:"maintenance-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Tipo de Mantenimiento *"}),a.jsxs("select",{value:f.type,onChange:F=>C("type",F.target.value),disabled:o==="view",children:[a.jsxs("option",{value:pe.OIL_CHANGE,children:[P(pe.OIL_CHANGE)," Cambio de Aceite"]}),a.jsxs("option",{value:pe.BATTERY_CHANGE,children:[P(pe.BATTERY_CHANGE)," Cambio de Batera"]}),a.jsxs("option",{value:pe.FILTER_CHANGE,children:[P(pe.FILTER_CHANGE)," Cambio de Filtros"]}),a.jsxs("option",{value:pe.GENERAL_MAINTENANCE,children:[P(pe.GENERAL_MAINTENANCE)," Mantenimiento General"]})]}),g.type&&a.jsx("span",{className:"error-text",children:g.type})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Vehculo *"}),a.jsxs("select",{value:f.vehicleId,onChange:F=>T(F.target.value),disabled:o==="view",children:[a.jsx("option",{value:"",children:"Seleccionar vehculo"}),A.map(F=>a.jsxs("option",{value:F.vehicleId,children:[F.vehicleId," - ",F.name," (",F.type,")"]},F.vehicleId))]}),g.vehicleId&&a.jsx("span",{className:"error-text",children:g.vehicleId})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Fecha *"}),a.jsx("input",{type:"date",value:f.date,onChange:F=>C("date",F.target.value),disabled:o==="view"}),g.date&&a.jsx("span",{className:"error-text",children:g.date})]}),f.type===pe.OIL_CHANGE&&a.jsxs("div",{className:"maintenance-section",children:[a.jsx("h3",{children:" Informacin del Cambio de Aceite"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Cantidad (galones) *"}),a.jsx("input",{type:"number",step:"0.1",value:f.quantity,onChange:F=>C("quantity",F.target.value),disabled:o==="view"}),g.quantity&&a.jsx("span",{className:"error-text",children:g.quantity})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Hormetro Actual *"}),a.jsx("input",{type:"number",value:f.currentHours,onChange:F=>C("currentHours",F.target.value),disabled:o==="view"}),g.currentHours&&a.jsx("span",{className:"error-text",children:g.currentHours})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Prximo Cambio (horas)"}),a.jsx("input",{type:"number",value:f.nextChangeHours,disabled:!0,className:"readonly-input"}),a.jsx("small",{children:"Calculado automticamente: actual + 250 horas"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Filtros o Extras"}),a.jsx("textarea",{value:f.filters,onChange:F=>C("filters",F.target.value),disabled:o==="view",placeholder:"Especificar filtros cambiados o extras..."})]})]}),f.type===pe.BATTERY_CHANGE&&a.jsxs("div",{className:"maintenance-section",children:[a.jsx("h3",{children:" Informacin del Cambio de Batera"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Tipo de Batera *"}),a.jsx("input",{type:"text",value:f.batteryType,onChange:F=>C("batteryType",F.target.value),disabled:o==="view",placeholder:"Ej: 12V 60Ah"}),g.batteryType&&a.jsx("span",{className:"error-text",children:g.batteryType})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Estado *"}),a.jsxs("select",{value:f.batteryStatus,onChange:F=>C("batteryStatus",F.target.value),disabled:o==="view",children:[a.jsx("option",{value:Go.NEW,children:"Nueva"}),a.jsx("option",{value:Go.USED,children:"Usada"}),a.jsx("option",{value:Go.REPAIRED,children:"Reparada"})]})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Marca"}),a.jsx("input",{type:"text",value:f.brand,onChange:F=>C("brand",F.target.value),disabled:o==="view",placeholder:"Ej: Bosch, Exide"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Modelo"}),a.jsx("input",{type:"text",value:f.model,onChange:F=>C("model",F.target.value),disabled:o==="view",placeholder:"Ej: S4 005"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Costo *"}),a.jsx("input",{type:"number",step:"1000",value:f.cost,onChange:F=>C("cost",F.target.value),disabled:o==="view",placeholder:"0"}),g.cost&&a.jsx("span",{className:"error-text",children:g.cost})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Notas Adicionales"}),a.jsx("textarea",{value:f.notes,onChange:F=>C("notes",F.target.value),disabled:o==="view",placeholder:"Observaciones adicionales...",rows:"3"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Estado"}),a.jsxs("select",{value:f.status,onChange:F=>C("status",F.target.value),disabled:o==="view",children:[a.jsx("option",{value:Pe.COMPLETED,children:"Completado"}),a.jsx("option",{value:Pe.PENDING,children:"Pendiente"}),a.jsx("option",{value:Pe.CANCELLED,children:"Cancelado"})]})]})]})}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:x,children:"Cancelar"}),o!=="view"&&a.jsx("button",{type:"submit",className:"btn btn-primary",onClick:q,disabled:x,children:x?"Guardando...":o==="create"?"Crear":"Actualizar"})]})]})}):null},IV=()=>{const{user:n,userProfile:e}=ds(),[t,i]=$.useState([]),[o,c]=$.useState(null),[d,f]=$.useState(!0),[p,g]=$.useState(null),[y,x]=$.useState({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),[_,A]=$.useState("cards"),[N,C]=$.useState(""),[T,M]=$.useState(!1),[q,U]=$.useState(null),[P,F]=$.useState("create");$.useEffect(()=>{if(!n)return;f(!0);const Q=XA((se,fe)=>{if(fe){console.error("Error en suscripcin de mantenimientos:",fe),g("Error al cargar mantenimientos"),f(!1);return}i(se),g(null),f(!1)},y);return()=>Q()},[n,y]),$.useEffect(()=>{n&&(async()=>{try{const se=await KA(y);c(se)}catch(se){console.error("Error al cargar estadsticas:",se)}})()},[n,t,y]);const G=t.filter(Q=>{if(!N)return!0;const se=N.toLowerCase();return Q.vehicleName?.toLowerCase().includes(se)||Q.type?.toLowerCase().includes(se)||Q.status?.toLowerCase().includes(se)||Q.notes?.toLowerCase().includes(se)}),V=e?.combustiblesPermissions?.canManageMaintenance||!1,S=()=>{U(null),F("create"),M(!0)},L=Q=>{U(Q),F("edit"),M(!0)},O=Q=>{U(Q),F("view"),M(!0)},w=()=>{M(!1),U(null)},I=()=>{M(!1),U(null)},R=Q=>{x(se=>({...se,...Q}))},de=()=>{x({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),C("")},be=async Q=>{if(!V){alert("No tienes permisos para eliminar mantenimientos");return}if(window.confirm("Ests seguro de que quieres eliminar este mantenimiento?"))try{const{deleteMaintenanceRecord:se}=await ny(async()=>{const{deleteMaintenanceRecord:fe}=await Promise.resolve().then(()=>EV);return{deleteMaintenanceRecord:fe}},void 0);await se(Q),console.log(" Mantenimiento eliminado exitosamente")}catch(se){console.error(" Error al eliminar mantenimiento:",se),alert("Error al eliminar mantenimiento: "+se.message)}};return n?a.jsxs("div",{className:"maintenance-main",children:[a.jsxs("div",{className:"maintenance-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h2",{children:" Mantenimiento de Vehculos"}),a.jsx("p",{children:"Gestin de cambios de aceite, filtros y bateras"})]}),a.jsx("div",{className:"header-actions",children:V&&a.jsx("button",{className:"btn-create-maintenance",onClick:S,children:" Crear Mantenimiento"})})]}),d&&a.jsxs("div",{className:"maintenance-loading",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando mantenimientos..."})]}),p&&a.jsxs("div",{className:"error-banner",children:[a.jsxs("span",{children:[" ",p]}),a.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]}),o&&a.jsx(TV,{stats:o}),a.jsx(jV,{filters:y,onFilterChange:R,onClearFilters:de,searchTerm:N,onSearchChange:C,viewMode:_,onViewModeChange:A,totalResults:G.length}),!d&&!p&&a.jsx(CV,{maintenanceRecords:G,viewMode:_,onEdit:V?L:null,onView:O,onDelete:V?be:null,userRole:e?.role}),T&&a.jsx(SV,{isOpen:T,onClose:w,onSuccess:I,maintenance:q,mode:P,userRole:e?.role})]}):a.jsx("div",{className:"maintenance-main",children:a.jsxs("div",{className:"auth-required",children:[a.jsx("h2",{children:" Autenticacin Requerida"}),a.jsx("p",{children:"Debes iniciar sesin para acceder al mdulo de mantenimiento."})]})})},RV=({isOpen:n,onClose:e,product:t,mode:i="create",onSave:o,userRole:c})=>{const[d,f]=$.useState({name:"",displayName:"",category:Bs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),[p,g]=$.useState({}),[y,x]=$.useState(!1),_=[{value:"gal",label:"Galones (gal)"},{value:"L",label:"Litros (L)"},{value:"kg",label:"Kilogramos (kg)"},{value:"und",label:"Unidades (und)"}],A={[Bs.COMBUSTIBLE]:["","","","",""],[Bs.ACEITE]:["","","","",""],[Bs.LUBRICANTE]:["","","","",""],[Bs.FLUIDO]:["","","","",""]},N=["#FF6B35","#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#E91E63","#795548","#607D8B","#3F51B5"];$.useEffect(()=>{f(t&&(i==="edit"||i==="view")?{name:t.name||"",displayName:t.displayName||"",category:t.category||Bs.COMBUSTIBLE,unit:t.unit||"gal",defaultPrice:t.defaultPrice||0,color:t.color||"#FF6B35",icon:t.icon||"",description:t.description||"",isActive:t.isActive!==void 0?t.isActive:!0,currentStock:t.currentStock||0,minThreshold:t.minThreshold||10,maxCapacity:t.maxCapacity||1e3}:{name:"",displayName:"",category:Bs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),g({})},[t,i,n]);const C=U=>{const{name:P,value:F,type:G,checked:V}=U.target;f(S=>({...S,[P]:G==="checkbox"?V:F})),p[P]&&g(S=>({...S,[P]:""}))},T=()=>{const U={};return d.name.trim()||(U.name="El nombre es requerido"),d.displayName.trim()||(U.displayName="El nombre de visualizacin es requerido"),d.category||(U.category="La categora es requerida"),d.unit||(U.unit="La unidad es requerida"),d.defaultPrice<0&&(U.defaultPrice="El precio debe ser mayor o igual a 0"),d.currentStock<0&&(U.currentStock="El stock debe ser mayor o igual a 0"),d.minThreshold<0&&(U.minThreshold="El umbral mnimo debe ser mayor o igual a 0"),d.maxCapacity<=0&&(U.maxCapacity="La capacidad mxima debe ser mayor a 0"),d.minThreshold>=d.maxCapacity&&(U.minThreshold="El umbral mnimo debe ser menor que la capacidad mxima"),g(U),Object.keys(U).length===0},M=async U=>{if(U.preventDefault(),!!T()){x(!0);try{await o({...d,defaultPrice:parseFloat(d.defaultPrice),currentStock:parseFloat(d.currentStock),minThreshold:parseFloat(d.minThreshold),maxCapacity:parseFloat(d.maxCapacity)}),e()}catch(P){console.error("Error saving product:",P),g({submit:"Error al guardar el producto"})}finally{x(!1)}}};if(!n)return null;const q=["admin","supervisor"].includes(c)&&i!=="view";return a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"modal-content product-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h2",{children:[i==="create"&&" Crear Producto",i==="edit"&&" Editar Producto",i==="view"&&" Ver Producto"]}),a.jsx("button",{className:"modal-close",onClick:e,children:""})]}),a.jsxs("form",{onSubmit:M,className:"modal-body",children:[a.jsx("div",{className:"product-preview",children:a.jsxs("div",{className:"preview-card",children:[a.jsx("div",{className:"preview-icon",style:{color:d.color},children:d.icon}),a.jsxs("div",{className:"preview-info",children:[a.jsx("h3",{children:d.displayName||"Nombre del producto"}),a.jsx("p",{className:"preview-category",children:d.category}),a.jsx("p",{className:"preview-description",children:d.description}),a.jsxs("div",{className:"preview-price",children:["$",new Intl.NumberFormat("es-CO").format(d.defaultPrice)," / ",d.unit]})]})]})}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:" Informacin Bsica"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Nombre Interno *"}),a.jsx("input",{type:"text",name:"name",value:d.name,onChange:C,disabled:!q,placeholder:"Ej: ACPM, GASOLINA"}),p.name&&a.jsx("span",{className:"error",children:p.name})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Nombre de Visualizacin *"}),a.jsx("input",{type:"text",name:"displayName",value:d.displayName,onChange:C,disabled:!q,placeholder:"Ej: ACPM , Gasolina "}),p.displayName&&a.jsx("span",{className:"error",children:p.displayName})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Categora *"}),a.jsx("select",{name:"category",value:d.category,onChange:C,disabled:!q,children:Object.values(Bs).map(U=>a.jsx("option",{value:U,children:U},U))}),p.category&&a.jsx("span",{className:"error",children:p.category})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Descripcin"}),a.jsx("textarea",{name:"description",value:d.description,onChange:C,disabled:!q,placeholder:"Descripcin del producto...",rows:"3"})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:" Configuracin"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Unidad de Medida *"}),a.jsx("select",{name:"unit",value:d.unit,onChange:C,disabled:!q,children:_.map(U=>a.jsx("option",{value:U.value,children:U.label},U.value))}),p.unit&&a.jsx("span",{className:"error",children:p.unit})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Precio por Defecto"}),a.jsx("input",{type:"number",name:"defaultPrice",value:d.defaultPrice,onChange:C,disabled:!q,min:"0",step:"0.01"}),p.defaultPrice&&a.jsx("span",{className:"error",children:p.defaultPrice})]}),a.jsx("div",{className:"form-group",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",name:"isActive",checked:d.isActive,onChange:C,disabled:!q}),"Producto Activo"]})})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:" Stock y Umbrales"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Stock Actual"}),a.jsx("input",{type:"number",name:"currentStock",value:d.currentStock,onChange:C,disabled:!q,min:"0",step:"0.01"}),p.currentStock&&a.jsx("span",{className:"error",children:p.currentStock})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Umbral Mnimo"}),a.jsx("input",{type:"number",name:"minThreshold",value:d.minThreshold,onChange:C,disabled:!q,min:"0",step:"0.01"}),p.minThreshold&&a.jsx("span",{className:"error",children:p.minThreshold})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Capacidad Mxima"}),a.jsx("input",{type:"number",name:"maxCapacity",value:d.maxCapacity,onChange:C,disabled:!q,min:"1",step:"0.01"}),p.maxCapacity&&a.jsx("span",{className:"error",children:p.maxCapacity})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:" Apariencia"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Icono"}),a.jsx("div",{className:"icon-selector",children:A[d.category]?.map(U=>a.jsx("button",{type:"button",className:`icon-option ${d.icon===U?"selected":""}`,onClick:()=>f(P=>({...P,icon:U})),disabled:!q,children:U},U))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Color"}),a.jsx("div",{className:"color-selector",children:N.map(U=>a.jsx("button",{type:"button",className:`color-option ${d.color===U?"selected":""}`,style:{backgroundColor:U},onClick:()=>f(P=>({...P,color:U})),disabled:!q},U))})]})]})]}),p.submit&&a.jsx("div",{className:"error-message",children:p.submit})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:y,children:i==="view"?"Cerrar":"Cancelar"}),q&&a.jsx("button",{type:"submit",className:"btn-primary",onClick:M,disabled:y,children:y?"Guardando...":"Guardar"})]})]})})},DV=({products:n})=>{const[e,t]=$.useState([]),[i,o]=$.useState(!0);$.useEffect(()=>{const N=Jv(C=>{t(C),o(!1)},C=>{console.error("Error loading movements for stats:",C),o(!1)});return()=>N()},[]);const c=()=>n.map(C=>{const T=e.filter(G=>G.fuelType===C.name||G.fuelType===C.displayName),M=T.filter(G=>G.type==="entrada"),q=T.filter(G=>G.type==="salida"),U=M.reduce((G,V)=>G+(V.quantity||0),0),P=q.reduce((G,V)=>G+(V.quantity||0),0),F=(C.currentStock||0)*(C.defaultPrice||0);return{...C,totalEntries:U,totalExits:P,totalValue:F,entriesCount:M.length,exitsCount:q.length,stockStatus:d(C)}}),d=N=>{const C=N.currentStock||0,T=N.minThreshold||0,M=N.maxCapacity||1e3;return C===0?"empty":C<=T?"low":C>=M*.9?"high":"normal"},f=N=>{const C={};return Object.values(Bs).forEach(T=>{const M=N.filter(q=>q.category===T);C[T]={totalProducts:M.length,totalStock:M.reduce((q,U)=>q+(U.currentStock||0),0),totalValue:M.reduce((q,U)=>q+U.totalValue,0),totalEntries:M.reduce((q,U)=>q+U.totalEntries,0),totalExits:M.reduce((q,U)=>q+U.totalExits,0),lowStockCount:M.filter(q=>q.stockStatus==="low"||q.stockStatus==="empty").length}}),C};if(i)return a.jsxs("div",{className:"products-stats loading",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando estadsticas..."})]});const p=c(),g=f(p),y=n.length,x=n.filter(N=>N.isActive).length,_=p.reduce((N,C)=>N+C.totalValue,0),A=p.filter(N=>N.stockStatus==="low"||N.stockStatus==="empty").length;return a.jsxs("div",{className:"products-stats",children:[a.jsx("h2",{children:" Estadsticas de Productos"}),a.jsxs("div",{className:"stats-general",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-info",children:[a.jsx("h3",{children:Oe(y)}),a.jsx("p",{children:"Total Productos"})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-info",children:[a.jsx("h3",{children:Oe(x)}),a.jsx("p",{children:"Productos Activos"})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-info",children:[a.jsx("h3",{children:Dn(_)}),a.jsx("p",{children:"Valor Total Stock"})]})]}),a.jsxs("div",{className:`stat-card ${A>0?"alert":""}`,children:[a.jsx("div",{className:"stat-icon",children:""}),a.jsxs("div",{className:"stat-info",children:[a.jsx("h3",{children:Oe(A)}),a.jsx("p",{children:"Stock Bajo"})]})]})]}),a.jsxs("div",{className:"stats-categories",children:[a.jsx("h3",{children:" Por Categora"}),a.jsx("div",{className:"categories-grid",children:Object.entries(g).map(([N,C])=>a.jsxs("div",{className:"category-card",children:[a.jsx("h4",{children:N}),a.jsxs("div",{className:"category-stats",children:[a.jsxs("div",{className:"stat-row",children:[a.jsx("span",{children:"Productos:"}),a.jsx("span",{children:Oe(C.totalProducts)})]}),a.jsxs("div",{className:"stat-row",children:[a.jsx("span",{children:"Stock Total:"}),a.jsxs("span",{children:[Oe(C.totalStock)," unidades"]})]}),a.jsxs("div",{className:"stat-row",children:[a.jsx("span",{children:"Valor:"}),a.jsx("span",{children:Dn(C.totalValue)})]}),a.jsxs("div",{className:"stat-row",children:[a.jsx("span",{children:"Entradas:"}),a.jsx("span",{className:"positive",children:Oe(C.totalEntries)})]}),a.jsxs("div",{className:"stat-row",children:[a.jsx("span",{children:"Salidas:"}),a.jsx("span",{className:"negative",children:Oe(C.totalExits)})]}),C.lowStockCount>0&&a.jsxs("div",{className:"stat-row alert",children:[a.jsx("span",{children:"Stock Bajo:"}),a.jsx("span",{children:Oe(C.lowStockCount)})]})]})]},N))})]}),a.jsxs("div",{className:"stats-top-products",children:[a.jsx("h3",{children:" Top Productos por Stock"}),a.jsx("div",{className:"top-products-list",children:p.sort((N,C)=>(C.currentStock||0)-(N.currentStock||0)).slice(0,5).map((N,C)=>a.jsxs("div",{className:"top-product-item",children:[a.jsxs("div",{className:"rank",children:["#",C+1]}),a.jsx("div",{className:"product-icon",style:{color:N.color},children:N.icon}),a.jsxs("div",{className:"product-info",children:[a.jsx("span",{className:"product-name",children:N.displayName}),a.jsxs("span",{className:"product-stock",children:[Oe(N.currentStock||0)," ",N.unit]})]}),a.jsx("div",{className:"product-value",children:Dn(N.totalValue)})]},N.id))})]}),A>0&&a.jsxs("div",{className:"stats-alerts",children:[a.jsx("h3",{children:" Alertas de Stock"}),a.jsx("div",{className:"alerts-list",children:p.filter(N=>N.stockStatus==="low"||N.stockStatus==="empty").map(N=>a.jsxs("div",{className:`alert-item ${N.stockStatus}`,children:[a.jsx("div",{className:"alert-icon",children:N.stockStatus==="empty"?"":""}),a.jsxs("div",{className:"alert-info",children:[a.jsx("span",{className:"alert-product",children:N.displayName}),a.jsxs("span",{className:"alert-stock",children:["Stock: ",Oe(N.currentStock||0)," ",N.unit,N.stockStatus==="empty"&&" - SIN STOCK!",N.stockStatus==="low"&&` - Mnimo: ${N.minThreshold}`]})]})]},N.id))})]})]})},MV=({userProfile:n})=>{const[e,t]=$.useState([]),[i,o]=$.useState(!0),[c,d]=$.useState(null),[f,p]=$.useState(!1),[g,y]=$.useState(null),[x,_]=$.useState("create"),[A,N]=$.useState(""),[C,T]=$.useState(""),[M,q]=$.useState(!0),U=["admin","supervisor"].includes(n?.role);$.useEffect(()=>{o(!0);const O=KL(w=>{t(w),o(!1),d(null)},w=>{console.error("Error loading products:",w),d("Error cargando productos"),o(!1)});return()=>O()},[]),$.useEffect(()=>{(async()=>{if(console.log(" Debug - Inicializando productos:",{productsLength:e.length,loading:i,canManageProducts:U}),e.length===0&&!i&&U)try{console.log(" Creando productos predefinidos...");const w=qE();console.log(" Productos predefinidos:",w);for(const I of w)console.log(" Creando producto:",I.name),await Zp({name:I.name,displayName:I.displayName,category:I.category,unit:I.unit,defaultPrice:I.defaultPrice,color:I.color,icon:I.icon,description:I.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});console.log(" Productos predefinidos creados exitosamente")}catch(w){console.error(" Error inicializando productos:",w)}else console.log(" No se inicializan productos:",{reason:e.length>0?"Ya existen productos":i?"Est cargando":U?"Otra razn":"Sin permisos"})})()},[e.length,i,U]);const P=()=>{y(null),_("create"),p(!0)},F=O=>{y(O),_("edit"),p(!0)},G=O=>{y(O),_("view"),p(!0)},V=async O=>{if(window.confirm("Ests seguro de que deseas eliminar este producto?"))try{await YL(O)}catch(w){console.error("Error deleting product:",w),alert("Error al eliminar el producto")}},S=async O=>{try{x==="create"?await Zp(O):x==="edit"&&await $L(g.id,O),p(!1)}catch(w){throw console.error("Error saving product:",w),w}},L=e.filter(O=>{const w=O.displayName?.toLowerCase().includes(A.toLowerCase())||O.name?.toLowerCase().includes(A.toLowerCase()),I=!C||O.category===C;return w&&I});return i?a.jsx("div",{className:"products-main",children:a.jsxs("div",{className:"loading-container",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando productos..."})]})}):c?a.jsx("div",{className:"products-main",children:a.jsxs("div",{className:"error-container",children:[a.jsxs("p",{children:[" ",c]}),a.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})}):a.jsxs("div",{className:"products-main",children:[a.jsxs("div",{className:"products-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h1",{children:" Gestin de Productos"}),a.jsx("p",{children:"Administra los tipos de combustibles y productos disponibles"})]}),U&&a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"btn-primary",onClick:P,children:" Agregar Producto"}),a.jsx("button",{className:"btn-secondary",onClick:async()=>{try{console.log(" Forzando creacin de productos predefinidos...");const O=qE();for(const w of O)await Zp({name:w.name,displayName:w.displayName,category:w.category,unit:w.unit,defaultPrice:w.defaultPrice,color:w.color,icon:w.icon,description:w.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});alert("Productos predefinidos creados exitosamente")}catch(O){console.error("Error:",O),alert("Error creando productos: "+O.message)}},style:{marginLeft:"10px"},children:" Crear Predefinidos"})]})]}),M&&a.jsx(DV,{products:e}),a.jsxs("div",{className:"products-filters",children:[a.jsx("div",{className:"filter-group",children:a.jsx("input",{type:"text",placeholder:" Buscar productos...",value:A,onChange:O=>N(O.target.value),className:"search-input"})}),a.jsx("div",{className:"filter-group",children:a.jsxs("select",{value:C,onChange:O=>T(O.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:" Todas las categoras"}),Object.values(Bs).map(O=>a.jsx("option",{value:O,children:O},O))]})}),a.jsx("div",{className:"filter-group",children:a.jsx("button",{className:`toggle-btn ${M?"active":""}`,onClick:()=>q(!M),children:" Estadsticas"})})]}),a.jsx("div",{className:"products-grid",children:L.map(O=>a.jsxs("div",{className:"product-card",children:[a.jsx("div",{className:"product-icon",style:{color:O.color},children:O.icon}),a.jsxs("div",{className:"product-info",children:[a.jsx("h3",{children:O.displayName}),a.jsx("p",{className:"product-category",children:O.category}),a.jsx("p",{className:"product-description",children:O.description}),a.jsxs("div",{className:"product-stats",children:[a.jsxs("div",{className:"stat",children:[a.jsx("span",{className:"stat-label",children:"Stock:"}),a.jsxs("span",{className:"stat-value",children:[O.currentStock||0," ",O.unit]})]}),a.jsxs("div",{className:"stat",children:[a.jsx("span",{className:"stat-label",children:"Precio:"}),a.jsxs("span",{className:"stat-value",children:["$",new Intl.NumberFormat("es-CO").format(O.defaultPrice||0)]})]})]}),a.jsx("div",{className:`product-status ${O.isActive?"active":"inactive"}`,children:O.isActive?" Activo":" Inactivo"})]}),a.jsxs("div",{className:"product-actions",children:[a.jsx("button",{className:"btn-secondary",onClick:()=>G(O),children:" Ver"}),U&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"btn-primary",onClick:()=>F(O),children:" Editar"}),a.jsx("button",{className:"btn-danger",onClick:()=>V(O.id),children:" Eliminar"})]})]})]},O.id))}),L.length===0&&a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:""}),a.jsx("h3",{children:"No hay productos"}),a.jsx("p",{children:A||C?"No se encontraron productos con los filtros aplicados.":"An no hay productos registrados."}),U&&!A&&!C&&a.jsx("button",{className:"btn-primary",onClick:P,children:" Crear primer producto"})]}),a.jsx(RV,{isOpen:f,onClose:()=>p(!1),product:g,mode:x,onSave:S,userRole:n?.role})]})},OV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:i,hasDeletePermission:o})=>{const[c,d]=$.useState("name"),[f,p]=$.useState("asc"),g=M=>{c===M?p(f==="asc"?"desc":"asc"):(d(M),p("asc"))},y=[...n].sort((M,q)=>{let U=M[c],P=q[c];switch(c){case"rating":U=U||0,P=P||0;break;case"totalOrders":case"totalPurchased":U=U||0,P=P||0;break;case"createdAt":case"lastOrderDate":U=U?U.toDate?U.toDate():new Date(U):new Date(0),P=P?P.toDate?P.toDate():new Date(P):new Date(0);break;default:U=(U||"").toString().toLowerCase(),P=(P||"").toString().toLowerCase()}return U<P?f==="asc"?-1:1:U>P?f==="asc"?1:-1:0}),x=M=>{switch(M){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},_=M=>{switch(M){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},A=M=>M?(M.toDate?M.toDate():new Date(M)).toLocaleDateString("es-CO"):"-",N=M=>{const q=[];for(let U=1;U<=5;U++)q.push(a.jsx("span",{className:`star ${U<=M?"filled":""}`,children:""},U));return a.jsx("div",{className:"rating-stars",children:q})},C=M=>!M||M.length===0?a.jsx("span",{className:"no-data",children:"-"}):a.jsxs("div",{className:"fuel-types-cell",children:[M.slice(0,2).map(q=>a.jsx("span",{className:"fuel-badge-sm",children:_n[q]||q},q)),M.length>2&&a.jsxs("span",{className:"fuel-badge-sm more",title:M.slice(2).map(q=>_n[q]||q).join(", "),children:["+",M.length-2]})]}),T=M=>c!==M?"icon-chevrons-up-down":f==="asc"?"icon-chevron-up":"icon-chevron-down";return a.jsxs("div",{className:"suppliers-table-container",children:[a.jsxs("div",{className:"table-wrapper",children:[a.jsxs("table",{className:"suppliers-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{className:`sortable ${c==="name"?"active":""}`,onClick:()=>g("name"),children:[a.jsx("span",{children:"Proveedor"}),a.jsx("i",{className:T("name")})]}),a.jsxs("th",{className:`sortable ${c==="status"?"active":""}`,onClick:()=>g("status"),children:[a.jsx("span",{children:"Estado"}),a.jsx("i",{className:T("status")})]}),a.jsxs("th",{className:`sortable ${c==="category"?"active":""}`,onClick:()=>g("category"),children:[a.jsx("span",{children:"Categora"}),a.jsx("i",{className:T("category")})]}),a.jsx("th",{children:a.jsx("span",{children:"Combustibles"})}),a.jsx("th",{children:a.jsx("span",{children:"Contacto"})}),a.jsxs("th",{className:`sortable ${c==="rating"?"active":""}`,onClick:()=>g("rating"),children:[a.jsx("span",{children:"Rating"}),a.jsx("i",{className:T("rating")})]}),a.jsxs("th",{className:`sortable ${c==="totalOrders"?"active":""}`,onClick:()=>g("totalOrders"),children:[a.jsx("span",{children:"rdenes"}),a.jsx("i",{className:T("totalOrders")})]}),a.jsxs("th",{className:`sortable ${c==="totalPurchased"?"active":""}`,onClick:()=>g("totalPurchased"),children:[a.jsx("span",{children:"Total Comprado"}),a.jsx("i",{className:T("totalPurchased")})]}),a.jsxs("th",{className:`sortable ${c==="createdAt"?"active":""}`,onClick:()=>g("createdAt"),children:[a.jsx("span",{children:"Creado"}),a.jsx("i",{className:T("createdAt")})]}),a.jsx("th",{className:"actions-column",children:a.jsx("span",{children:"Acciones"})})]})}),a.jsx("tbody",{children:y.map(M=>a.jsxs("tr",{className:`supplier-row ${M.status}`,children:[a.jsx("td",{className:"supplier-info-cell",children:a.jsxs("div",{className:"supplier-main-info",children:[a.jsxs("div",{className:"supplier-name",children:[M.name,M.isPreferred&&a.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:a.jsx("i",{className:"icon-star"})})]}),M.taxId&&a.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",M.taxId]}),M.type&&a.jsx("div",{className:"supplier-type",children:M.type.charAt(0).toUpperCase()+M.type.slice(1)})]})}),a.jsx("td",{className:"status-cell",children:a.jsxs("div",{className:"status-display",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:x(M.status)}}),a.jsx("span",{className:"status-label",children:_(M.status)})]})}),a.jsx("td",{className:"category-cell",children:a.jsx("span",{className:"category-label",children:M.category?.charAt(0).toUpperCase()+M.category?.slice(1)||"-"})}),a.jsx("td",{className:"fuel-types-cell",children:C(M.fuelTypes)}),a.jsx("td",{className:"contact-cell",children:a.jsxs("div",{className:"contact-info",children:[M.contactPerson&&a.jsxs("div",{className:"contact-person",children:[a.jsx("i",{className:"icon-user"}),a.jsx("span",{children:M.contactPerson})]}),M.phone&&a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-phone"}),a.jsx("a",{href:`tel:${M.phone}`,children:M.phone})]}),M.email&&a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-mail"}),a.jsx("a",{href:`mailto:${M.email}`,children:M.email})]}),M.city&&a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-map-pin"}),a.jsx("span",{children:M.city})]})]})}),a.jsx("td",{className:"rating-cell",children:a.jsxs("div",{className:"rating-display",children:[N(M.rating||0),a.jsx("span",{className:"rating-value",children:(M.rating||0).toFixed(1)})]})}),a.jsx("td",{className:"orders-cell",children:a.jsx("span",{className:"orders-count",children:M.totalOrders||0})}),a.jsx("td",{className:"purchased-cell",children:a.jsx("span",{className:"purchased-amount",children:Dn(M.totalPurchased||0)})}),a.jsx("td",{className:"date-cell",children:a.jsx("span",{className:"date-value",children:A(M.createdAt)})}),a.jsx("td",{className:"actions-cell",children:a.jsxs("div",{className:"action-buttons",children:[i&&a.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(M),title:"Editar proveedor",children:a.jsx("i",{className:"icon-edit"})}),o&&M.status==="active"&&a.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(M.id,M.name),title:"Desactivar proveedor",children:a.jsx("i",{className:"icon-x-circle"})}),a.jsxs("div",{className:"quick-actions",children:[M.phone&&a.jsx("a",{href:`tel:${M.phone}`,className:"quick-action-btn",title:"Llamar",children:a.jsx("i",{className:"icon-phone"})}),M.email&&a.jsx("a",{href:`mailto:${M.email}`,className:"quick-action-btn",title:"Enviar email",children:a.jsx("i",{className:"icon-mail"})})]})]})})]},M.id))})]}),y.length===0&&a.jsxs("div",{className:"table-empty-state",children:[a.jsx("i",{className:"icon-truck"}),a.jsx("p",{children:"No hay proveedores para mostrar"})]})]}),a.jsxs("div",{className:"table-footer",children:[a.jsx("div",{className:"table-info",children:a.jsxs("span",{children:["Mostrando ",y.length," proveedor",y.length!==1?"es":""]})}),a.jsx("div",{className:"table-actions",children:a.jsxs("span",{className:"sort-info",children:["Ordenado por: ",c==="name"?"Nombre":c==="status"?"Estado":c==="category"?"Categora":c==="rating"?"Rating":c==="totalOrders"?"rdenes":c==="totalPurchased"?"Total Comprado":c==="createdAt"?"Fecha de Creacin":c," (",f==="asc"?"Ascendente":"Descendente",")"]})})]})]})},kV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:i,hasDeletePermission:o})=>{const c=A=>{switch(A){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},d=A=>{switch(A){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},f=A=>{switch(A){case"combustibles":return"";case"lubricantes":return"";case"aditivos":return"";default:return""}},p=A=>{switch(A){case"proveedor":return"Proveedor";case"distribuidor":return"Distribuidor";case"mayorista":return"Mayorista";default:return"Sin especificar"}},g=A=>A?(A.toDate?A.toDate():new Date(A)).toLocaleDateString("es-CO"):"No disponible",y=A=>{const N=[];for(let C=1;C<=5;C++)N.push(a.jsx("span",{className:`star ${C<=A?"filled":""}`,children:""},C));return a.jsx("div",{className:"rating-stars",children:N})},x=A=>!A||A.length===0?a.jsx("span",{className:"no-fuels",children:"Sin combustibles especificados"}):a.jsxs("div",{className:"fuel-types",children:[A.slice(0,3).map(N=>a.jsx("span",{className:"fuel-badge",title:_n[N],children:_n[N]||N},N)),A.length>3&&a.jsxs("span",{className:"fuel-badge more",title:`+${A.length-3} ms`,children:["+",A.length-3]})]}),_=A=>{const N=[];return A.phone&&N.push(a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-phone"}),a.jsx("span",{children:A.phone})]},"phone")),A.email&&N.push(a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-mail"}),a.jsx("span",{children:A.email})]},"email")),A.city&&N.push(a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-map-pin"}),a.jsx("span",{children:A.city})]},"city")),N.length>0?N:a.jsxs("div",{className:"contact-item no-contact",children:[a.jsx("i",{className:"icon-info-circle"}),a.jsx("span",{children:"Sin informacin de contacto"})]})};return a.jsx("div",{className:"suppliers-cards",children:n.map(A=>a.jsxs("div",{className:`supplier-card ${A.status}`,children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"header-left",children:a.jsxs("div",{className:"supplier-info",children:[a.jsxs("h3",{className:"supplier-name",children:[A.name,A.isPreferred&&a.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:a.jsx("i",{className:"icon-star"})})]}),A.taxId&&a.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",A.taxId]})]})}),a.jsx("div",{className:"header-right",children:a.jsxs("div",{className:"supplier-status",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:c(A.status)}}),a.jsx("span",{className:"status-label",children:d(A.status)})]})})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"supplier-meta",children:[a.jsxs("div",{className:"meta-item",children:[a.jsx("span",{className:"meta-icon",children:f(A.category)}),a.jsx("span",{className:"meta-label",children:A.category?.charAt(0).toUpperCase()+A.category?.slice(1)||"Sin categora"})]}),a.jsxs("div",{className:"meta-item",children:[a.jsx("i",{className:"icon-building meta-icon"}),a.jsx("span",{className:"meta-label",children:p(A.type)})]})]}),A.contactPerson&&a.jsxs("div",{className:"contact-person",children:[a.jsx("i",{className:"icon-user"}),a.jsx("span",{children:A.contactPerson})]}),a.jsx("div",{className:"contact-info",children:_(A)}),a.jsxs("div",{className:"fuel-types-section",children:[a.jsx("div",{className:"section-label",children:"Combustibles Suministrados:"}),x(A.fuelTypes)]}),a.jsxs("div",{className:"rating-section",children:[a.jsxs("div",{className:"rating-display",children:[y(A.rating||0),a.jsxs("span",{className:"rating-value",children:[(A.rating||0).toFixed(1),"/5"]})]}),A.evaluationNotes&&a.jsxs("div",{className:"evaluation-notes",title:A.evaluationNotes,children:[a.jsx("i",{className:"icon-message-square"}),a.jsx("span",{children:"Con evaluacin"})]})]}),A.paymentTerms&&a.jsxs("div",{className:"payment-terms",children:[a.jsx("i",{className:"icon-credit-card"}),a.jsxs("span",{children:["Trminos: ",A.paymentTerms==="contado"?"Contado":A.paymentTerms==="30dias"?"30 das":A.paymentTerms==="60dias"?"60 das":A.paymentTerms==="90dias"?"90 das":A.paymentTerms]})]}),a.jsxs("div",{className:"supplier-stats",children:[a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-label",children:"rdenes:"}),a.jsx("span",{className:"stat-value",children:A.totalOrders||0})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-label",children:"Total Comprado:"}),a.jsx("span",{className:"stat-value",children:Dn(A.totalPurchased||0)})]}),A.lastOrderDate&&a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-label",children:"ltima Orden:"}),a.jsx("span",{className:"stat-value",children:g(A.lastOrderDate)})]})]})]}),a.jsxs("div",{className:"card-footer",children:[a.jsx("div",{className:"footer-info",children:a.jsxs("span",{className:"created-date",children:["Creado: ",g(A.createdAt)]})}),a.jsxs("div",{className:"card-actions",children:[i&&a.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(A),title:"Editar proveedor",children:[a.jsx("i",{className:"icon-edit"}),"Editar"]}),o&&A.status==="active"&&a.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>t(A.id,A.name),title:"Desactivar proveedor",children:[a.jsx("i",{className:"icon-x-circle"}),"Desactivar"]}),a.jsxs("div",{className:"quick-actions",children:[A.phone&&a.jsx("a",{href:`tel:${A.phone}`,className:"quick-action-btn",title:"Llamar",children:a.jsx("i",{className:"icon-phone"})}),A.email&&a.jsx("a",{href:`mailto:${A.email}`,className:"quick-action-btn",title:"Enviar email",children:a.jsx("i",{className:"icon-mail"})})]})]})]})]},A.id))})},PV=({supplier:n,onClose:e,onSuccess:t,onError:i})=>{const{userProfile:o}=ds(),c=!!n,[d,f]=$.useState({name:"",taxId:"",type:"proveedor",category:"combustibles",contactPerson:"",phone:"",email:"",address:"",city:"",state:"Colombia",fuelTypes:[],paymentTerms:"contado",creditLimit:"",priceList:{},rating:5,evaluationNotes:"",status:"active",isPreferred:!1}),[p,g]=$.useState(!1),[y,x]=$.useState({}),[_,A]=$.useState("basic");$.useEffect(()=>{c&&n&&f({name:n.name||"",taxId:n.taxId||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson||"",phone:n.phone||"",email:n.email||"",address:n.address||"",city:n.city||"",state:n.state||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:n.creditLimit||"",priceList:n.priceList||{},rating:n.rating||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1})},[c,n]);const N=(P,F)=>{f(G=>({...G,[P]:F})),y[P]&&x(G=>({...G,[P]:null}))},C=P=>{f(F=>({...F,fuelTypes:F.fuelTypes.includes(P)?F.fuelTypes.filter(G=>G!==P):[...F.fuelTypes,P]}))},T=(P,F)=>{f(G=>({...G,priceList:{...G.priceList,[P]:parseFloat(F)||0}}))},M=()=>{const P={};return d.name.trim()||(P.name="El nombre del proveedor es requerido"),d.category||(P.category="La categora es requerida"),d.type||(P.type="El tipo de proveedor es requerido"),d.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)&&(P.email="El formato del email no es vlido"),d.phone&&!/^[\d\s\-+()]+$/.test(d.phone)&&(P.phone="El formato del telfono no es vlido"),d.creditLimit&&(isNaN(d.creditLimit)||parseFloat(d.creditLimit)<0)&&(P.creditLimit="El lmite de crdito debe ser un nmero positivo"),(d.rating<1||d.rating>5)&&(P.rating="El rating debe estar entre 1 y 5"),d.fuelTypes.forEach(F=>{d.priceList[F]&&(isNaN(d.priceList[F])||parseFloat(d.priceList[F])<0)&&(P[`price_${F}`]=`El precio de ${_n[F]} debe ser un nmero positivo`)}),x(P),Object.keys(P).length===0},q=async P=>{if(P.preventDefault(),!!M()){g(!0);try{const F={...d,creditLimit:parseFloat(d.creditLimit)||0,rating:parseFloat(d.rating)||5,priceList:Object.fromEntries(Object.entries(d.priceList).filter(([V,S])=>d.fuelTypes.includes(V)&&S>0))};let G;c?G=await CL(n.id,F,o?.email):G=await AL(F,o?.email),G.success?t():i(G.error||"Error al guardar proveedor")}catch(F){console.error("Error saving supplier:",F),i("Error inesperado al guardar proveedor")}finally{g(!1)}}},U=[{id:"basic",label:"Informacin Bsica",icon:"icon-info"},{id:"contact",label:"Contacto",icon:"icon-phone"},{id:"products",label:"Productos",icon:"icon-package"},{id:"commercial",label:"Comercial",icon:"icon-credit-card"}];return a.jsx("div",{className:"modal-overlay",onClick:e,children:a.jsxs("div",{className:"modal-container large",onClick:P=>P.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h2",{children:[a.jsx("i",{className:"icon-truck"}),c?"Editar Proveedor":"Nuevo Proveedor"]}),a.jsx("button",{className:"modal-close",onClick:e,children:a.jsx("i",{className:"icon-x"})})]}),a.jsxs("form",{onSubmit:q,children:[a.jsx("div",{className:"modal-tabs",children:U.map(P=>a.jsxs("button",{type:"button",className:`tab-button ${_===P.id?"active":""}`,onClick:()=>A(P.id),children:[a.jsx("i",{className:P.icon}),P.label]},P.id))}),a.jsxs("div",{className:"modal-body",children:[_==="basic"&&a.jsx("div",{className:"tab-content",children:a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"required",children:"Nombre del Proveedor"}),a.jsx("input",{type:"text",value:d.name,onChange:P=>N("name",P.target.value),placeholder:"Ingresa el nombre del proveedor",className:y.name?"error":""}),y.name&&a.jsx("span",{className:"error-message",children:y.name})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"NIT / Documento"}),a.jsx("input",{type:"text",value:d.taxId,onChange:P=>N("taxId",P.target.value),placeholder:"123456789-0",className:y.taxId?"error":""}),y.taxId&&a.jsx("span",{className:"error-message",children:y.taxId})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"required",children:"Tipo de Proveedor"}),a.jsxs("select",{value:d.type,onChange:P=>N("type",P.target.value),className:y.type?"error":"",children:[a.jsx("option",{value:"proveedor",children:"Proveedor"}),a.jsx("option",{value:"distribuidor",children:"Distribuidor"}),a.jsx("option",{value:"mayorista",children:"Mayorista"})]}),y.type&&a.jsx("span",{className:"error-message",children:y.type})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"required",children:"Categora"}),a.jsxs("select",{value:d.category,onChange:P=>N("category",P.target.value),className:y.category?"error":"",children:[a.jsx("option",{value:"combustibles",children:"Combustibles"}),a.jsx("option",{value:"lubricantes",children:"Lubricantes"}),a.jsx("option",{value:"aditivos",children:"Aditivos"})]}),y.category&&a.jsx("span",{className:"error-message",children:y.category})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Estado"}),a.jsxs("select",{value:d.status,onChange:P=>N("status",P.target.value),children:[a.jsx("option",{value:"active",children:"Activo"}),a.jsx("option",{value:"inactive",children:"Inactivo"}),a.jsx("option",{value:"suspended",children:"Suspendido"})]})]}),a.jsx("div",{className:"form-group checkbox",children:a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:d.isPreferred,onChange:P=>N("isPreferred",P.target.checked)}),a.jsx("span",{className:"checkbox-mark"}),"Proveedor Preferido"]})})]})}),_==="contact"&&a.jsx("div",{className:"tab-content",children:a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Persona de Contacto"}),a.jsx("input",{type:"text",value:d.contactPerson,onChange:P=>N("contactPerson",P.target.value),placeholder:"Nombre del contacto principal"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Telfono"}),a.jsx("input",{type:"tel",value:d.phone,onChange:P=>N("phone",P.target.value),placeholder:"+57 300 123 4567",className:y.phone?"error":""}),y.phone&&a.jsx("span",{className:"error-message",children:y.phone})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Email"}),a.jsx("input",{type:"email",value:d.email,onChange:P=>N("email",P.target.value),placeholder:"contacto@proveedor.com",className:y.email?"error":""}),y.email&&a.jsx("span",{className:"error-message",children:y.email})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Ciudad"}),a.jsx("input",{type:"text",value:d.city,onChange:P=>N("city",P.target.value),placeholder:"Bogot"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Estado/Pas"}),a.jsx("input",{type:"text",value:d.state,onChange:P=>N("state",P.target.value),placeholder:"Colombia"})]}),a.jsxs("div",{className:"form-group full-width",children:[a.jsx("label",{children:"Direccin"}),a.jsx("textarea",{value:d.address,onChange:P=>N("address",P.target.value),placeholder:"Direccin completa del proveedor",rows:"3"})]})]})}),_==="products"&&a.jsxs("div",{className:"tab-content",children:[a.jsxs("div",{className:"section",children:[a.jsx("h3",{children:"Tipos de Combustible que Suministra"}),a.jsx("div",{className:"fuel-types-grid",children:Object.entries(_n).map(([P,F])=>a.jsx("div",{className:"fuel-type-item",children:a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:d.fuelTypes.includes(P),onChange:()=>C(P)}),a.jsx("span",{className:"checkbox-mark"}),F]})},P))})]}),d.fuelTypes.length>0&&a.jsxs("div",{className:"section",children:[a.jsx("h3",{children:"Precios por Litro (Opcional)"}),a.jsx("div",{className:"prices-grid",children:d.fuelTypes.map(P=>a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:_n[P]}),a.jsxs("div",{className:"input-with-currency",children:[a.jsx("span",{className:"currency-symbol",children:"$"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:d.priceList[P]||"",onChange:F=>T(P,F.target.value),placeholder:"0.00",className:y[`price_${P}`]?"error":""})]}),y[`price_${P}`]&&a.jsx("span",{className:"error-message",children:y[`price_${P}`]})]},P))})]})]}),_==="commercial"&&a.jsx("div",{className:"tab-content",children:a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Trminos de Pago"}),a.jsxs("select",{value:d.paymentTerms,onChange:P=>N("paymentTerms",P.target.value),children:[a.jsx("option",{value:"contado",children:"Contado"}),a.jsx("option",{value:"30dias",children:"30 das"}),a.jsx("option",{value:"60dias",children:"60 das"}),a.jsx("option",{value:"90dias",children:"90 das"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Lmite de Crdito"}),a.jsxs("div",{className:"input-with-currency",children:[a.jsx("span",{className:"currency-symbol",children:"$"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:d.creditLimit,onChange:P=>N("creditLimit",P.target.value),placeholder:"0.00",className:y.creditLimit?"error":""})]}),y.creditLimit&&a.jsx("span",{className:"error-message",children:y.creditLimit})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Rating"}),a.jsxs("div",{className:"rating-input",children:[a.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:d.rating,onChange:P=>N("rating",parseFloat(P.target.value)),className:y.rating?"error":""}),a.jsxs("div",{className:"rating-display",children:[a.jsx("span",{className:"rating-value",children:d.rating.toFixed(1)}),a.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(P=>a.jsx("span",{className:`star ${P<=Math.round(d.rating)?"filled":""}`,children:""},P))})]})]}),y.rating&&a.jsx("span",{className:"error-message",children:y.rating})]}),a.jsxs("div",{className:"form-group full-width",children:[a.jsx("label",{children:"Notas de Evaluacin"}),a.jsx("textarea",{value:d.evaluationNotes,onChange:P=>N("evaluationNotes",P.target.value),placeholder:"Comentarios sobre el desempeo del proveedor...",rows:"4"})]})]})})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:p,children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"loading-spinner small"}),c?"Actualizando...":"Creando..."]}):a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"icon-save"}),c?"Actualizar Proveedor":"Crear Proveedor"]})})]})]})]})})},LV=({stats:n,suppliersCount:e,totalSuppliers:t})=>{if(!n)return null;const i=d=>{switch(d){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case"combustibles":return"";case"lubricantes":return"";case"aditivos":return"";default:return""}},c=d=>{switch(d){case"proveedor":return"";case"distribuidor":return"";case"mayorista":return"";default:return""}};return a.jsxs("div",{className:"suppliers-stats",children:[a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card primary",children:[a.jsx("div",{className:"stat-icon",children:a.jsx("i",{className:"icon-truck"})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:Oe(n.total)}),a.jsx("div",{className:"stat-label",children:"Total Proveedores"}),t!==e&&a.jsxs("div",{className:"stat-sublabel",children:[Oe(e)," mostrados"]})]})]}),a.jsxs("div",{className:"stat-card success",children:[a.jsx("div",{className:"stat-icon",children:a.jsx("i",{className:"icon-check-circle"})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:Oe(n.active)}),a.jsx("div",{className:"stat-label",children:"Activos"}),a.jsx("div",{className:"stat-sublabel",children:Tr(n.total>0?n.active/n.total:0)})]})]}),a.jsxs("div",{className:"stat-card warning",children:[a.jsx("div",{className:"stat-icon",children:a.jsx("i",{className:"icon-star"})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:Oe(n.preferred)}),a.jsx("div",{className:"stat-label",children:"Preferidos"}),a.jsx("div",{className:"stat-sublabel",children:Tr(n.active>0?n.preferred/n.active:0)})]})]}),a.jsxs("div",{className:"stat-card info",children:[a.jsx("div",{className:"stat-icon",children:a.jsx("i",{className:"icon-award"})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:n.averageRating.toFixed(1)}),a.jsx("div",{className:"stat-label",children:"Rating Promedio"}),a.jsx("div",{className:"stat-sublabel",children:a.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(d=>a.jsx("span",{className:`star ${d<=Math.round(n.averageRating)?"filled":""}`,children:""},d))})})]})]})]}),a.jsxs("div",{className:"stats-details",children:[a.jsxs("div",{className:"stats-section",children:[a.jsx("h3",{children:"Estado de Proveedores"}),a.jsxs("div",{className:"stats-breakdown",children:[a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-label",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:i("active")}}),"Activos"]}),a.jsx("div",{className:"breakdown-value",children:n.active}),a.jsx("div",{className:"breakdown-percentage",children:Tr(n.total>0?n.active/n.total:0)})]}),n.inactive>0&&a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-label",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:i("inactive")}}),"Inactivos"]}),a.jsx("div",{className:"breakdown-value",children:n.inactive}),a.jsx("div",{className:"breakdown-percentage",children:Tr(n.total>0?n.inactive/n.total:0)})]}),n.suspended>0&&a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-label",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:i("suspended")}}),"Suspendidos"]}),a.jsx("div",{className:"breakdown-value",children:n.suspended}),a.jsx("div",{className:"breakdown-percentage",children:Tr(n.total>0?n.suspended/n.total:0)})]})]})]}),Object.keys(n.byCategory).length>0&&a.jsxs("div",{className:"stats-section",children:[a.jsx("h3",{children:"Por Categora"}),a.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byCategory).sort(([,d],[,f])=>f-d).map(([d,f])=>a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-label",children:[a.jsx("span",{className:"category-icon",children:o(d)}),d.charAt(0).toUpperCase()+d.slice(1).replace("_"," ")]}),a.jsx("div",{className:"breakdown-value",children:f}),a.jsx("div",{className:"breakdown-percentage",children:Tr(n.total>0?f/n.total:0)})]},d))})]}),Object.keys(n.byType).length>0&&a.jsxs("div",{className:"stats-section",children:[a.jsx("h3",{children:"Por Tipo"}),a.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byType).sort(([,d],[,f])=>f-d).map(([d,f])=>a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-label",children:[a.jsx("span",{className:"type-icon",children:c(d)}),d.charAt(0).toUpperCase()+d.slice(1)]}),a.jsx("div",{className:"breakdown-value",children:f}),a.jsx("div",{className:"breakdown-percentage",children:Tr(n.total>0?f/n.total:0)})]},d))})]})]}),a.jsxs("div",{className:"stats-insights",children:[a.jsx("h3",{children:"Informacin Rpida"}),a.jsxs("div",{className:"insights-grid",children:[a.jsxs("div",{className:"insight-item",children:[a.jsx("div",{className:"insight-label",children:"Nivel de Satisfaccin"}),a.jsx("div",{className:"insight-value",children:n.averageRating>=4.5?"Excelente":n.averageRating>=4?"Muy Bueno":n.averageRating>=3.5?"Bueno":n.averageRating>=3?"Regular":"Necesita Mejora"})]}),a.jsxs("div",{className:"insight-item",children:[a.jsx("div",{className:"insight-label",children:"Estado General"}),a.jsx("div",{className:"insight-value",children:n.active/n.total>=.9?"Excelente":n.active/n.total>=.8?"Bueno":n.active/n.total>=.7?"Regular":"Revisar"})]}),a.jsxs("div",{className:"insight-item",children:[a.jsx("div",{className:"insight-label",children:"Proveedores Preferidos"}),a.jsx("div",{className:"insight-value",children:n.preferred===0?"Ninguno":n.preferred/n.active>=.3?"Suficientes":n.preferred/n.active>=.2?"Buenos":"Pocos"})]}),a.jsxs("div",{className:"insight-item",children:[a.jsx("div",{className:"insight-label",children:"Diversificacin"}),a.jsx("div",{className:"insight-value",children:Object.keys(n.byCategory).length>=3?"Alta":Object.keys(n.byCategory).length>=2?"Media":"Baja"})]})]})]})]})},VV=({searchTerm:n,setSearchTerm:e,filterStatus:t,setFilterStatus:i,filterCategory:o,setFilterCategory:c,filterFuelType:d,setFilterFuelType:f,viewMode:p,setViewMode:g,onClearFilters:y,resultsCount:x})=>{const _=[{value:"all",label:"Todos los Estados",icon:"list"},{value:"active",label:"Activos",icon:"check-circle"},{value:"inactive",label:"Inactivos",icon:"x-circle"},{value:"suspended",label:"Suspendidos",icon:"alert-circle"},{value:"preferred",label:"Preferidos",icon:"star"}],A=[{value:"all",label:"Todas las Categoras",icon:"grid"},{value:"combustibles",label:"Combustibles",icon:"fuel"},{value:"lubricantes",label:"Lubricantes",icon:"droplets"},{value:"aditivos",label:"Aditivos",icon:"flask"}],N=[{value:"all",label:"Todos los Combustibles",icon:"fuel"},...Object.entries(_n).map(([T,M])=>({value:T,label:M,icon:"droplet"}))],C=n||t!=="all"||o!=="all"||d!=="all";return a.jsxs("div",{className:"suppliers-filters",children:[a.jsxs("div",{className:"filters-top",children:[a.jsx("div",{className:"search-container",children:a.jsxs("div",{className:"search-input-wrapper",children:[a.jsx("i",{className:"icon-search search-icon"}),a.jsx("input",{type:"text",placeholder:"Buscar por nombre, NIT, contacto, ciudad...",value:n,onChange:T=>e(T.target.value),className:"search-input"}),n&&a.jsx("button",{className:"search-clear",onClick:()=>e(""),title:"Limpiar bsqueda",children:a.jsx("i",{className:"icon-x"})})]})}),a.jsxs("div",{className:"view-controls",children:[a.jsxs("div",{className:"view-mode-toggle",children:[a.jsx("button",{className:`view-btn ${p==="cards"?"active":""}`,onClick:()=>g("cards"),title:"Vista de tarjetas",children:a.jsx("i",{className:"icon-grid"})}),a.jsx("button",{className:`view-btn ${p==="table"?"active":""}`,onClick:()=>g("table"),title:"Vista de tabla",children:a.jsx("i",{className:"icon-list"})})]}),C&&a.jsxs("button",{className:"btn btn-secondary clear-filters",onClick:y,title:"Limpiar todos los filtros",children:[a.jsx("i",{className:"icon-filter-x"}),"Limpiar"]})]})]}),a.jsxs("div",{className:"filters-dropdowns",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{className:"filter-label",children:"Estado"}),a.jsxs("div",{className:"select-wrapper",children:[a.jsx("select",{value:t,onChange:T=>i(T.target.value),className:"filter-select",children:_.map(T=>a.jsx("option",{value:T.value,children:T.label},T.value))}),a.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{className:"filter-label",children:"Categora"}),a.jsxs("div",{className:"select-wrapper",children:[a.jsx("select",{value:o,onChange:T=>c(T.target.value),className:"filter-select",children:A.map(T=>a.jsx("option",{value:T.value,children:T.label},T.value))}),a.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),a.jsxs("div",{className:"select-wrapper",children:[a.jsx("select",{value:d,onChange:T=>f(T.target.value),className:"filter-select",children:N.map(T=>a.jsx("option",{value:T.value,children:T.label},T.value))}),a.jsx("i",{className:"icon-chevron-down select-arrow"})]})]})]}),a.jsxs("div",{className:"filters-summary",children:[a.jsxs("div",{className:"results-count",children:[a.jsx("i",{className:"icon-info-circle"}),a.jsx("span",{children:x===0?"No se encontraron proveedores":`Mostrando ${x} proveedor${x!==1?"es":""}`})]}),C&&a.jsxs("div",{className:"active-filters",children:[a.jsx("span",{className:"filters-label",children:"Filtros activos:"}),a.jsxs("div",{className:"filter-tags",children:[n&&a.jsxs("span",{className:"filter-tag",children:[a.jsx("i",{className:"icon-search"}),n,a.jsx("button",{onClick:()=>e(""),children:a.jsx("i",{className:"icon-x"})})]}),t!=="all"&&a.jsxs("span",{className:"filter-tag",children:[a.jsx("i",{className:"icon-filter"}),_.find(T=>T.value===t)?.label,a.jsx("button",{onClick:()=>i("all"),children:a.jsx("i",{className:"icon-x"})})]}),o!=="all"&&a.jsxs("span",{className:"filter-tag",children:[a.jsx("i",{className:"icon-tag"}),A.find(T=>T.value===o)?.label,a.jsx("button",{onClick:()=>c("all"),children:a.jsx("i",{className:"icon-x"})})]}),d!=="all"&&a.jsxs("span",{className:"filter-tag",children:[a.jsx("i",{className:"icon-droplet"}),N.find(T=>T.value===d)?.label,a.jsx("button",{onClick:()=>f("all"),children:a.jsx("i",{className:"icon-x"})})]})]})]})]}),a.jsxs("div",{className:"quick-filters",children:[a.jsx("span",{className:"quick-filters-label",children:"Acceso rpido:"}),a.jsxs("div",{className:"quick-filter-buttons",children:[a.jsxs("button",{className:`quick-filter-btn ${t==="preferred"?"active":""}`,onClick:()=>i(t==="preferred"?"all":"preferred"),children:[a.jsx("i",{className:"icon-star"}),"Preferidos"]}),a.jsxs("button",{className:`quick-filter-btn ${t==="active"?"active":""}`,onClick:()=>i(t==="active"?"all":"active"),children:[a.jsx("i",{className:"icon-check-circle"}),"Activos"]}),a.jsxs("button",{className:`quick-filter-btn ${o==="combustibles"?"active":""}`,onClick:()=>c(o==="combustibles"?"all":"combustibles"),children:[a.jsx("i",{className:"icon-fuel"}),"Combustibles"]}),a.jsxs("button",{className:`quick-filter-btn ${d==="diesel"?"active":""}`,onClick:()=>f(d==="diesel"?"all":"diesel"),children:[a.jsx("i",{className:"icon-droplet"}),"Disel"]})]})]})]})},UV=()=>{const{hasPermission:n,userProfile:e}=ds(),[t,i]=$.useState([]),[o,c]=$.useState(null),[d,f]=$.useState(!0),[p,g]=$.useState(null),[y,x]=$.useState("cards"),[_,A]=$.useState(!1),[N,C]=$.useState(null),[T,M]=$.useState("all"),[q,U]=$.useState("all"),[P,F]=$.useState("all"),[G,V]=$.useState("");$.useEffect(()=>{let Q=null;return(()=>{Q=FA(fe=>{i(fe||[]),f(!1)})})(),()=>{Q&&Q()}},[]),$.useEffect(()=>{const Q=async()=>{const se=await IL();se.success&&c(se.data)};t.length>0&&Q()},[t]);const S=t.filter(Q=>{const se=!G||Q.name?.toLowerCase().includes(G.toLowerCase())||Q.taxId?.toLowerCase().includes(G.toLowerCase())||Q.contactPerson?.toLowerCase().includes(G.toLowerCase())||Q.city?.toLowerCase().includes(G.toLowerCase()),fe=T==="all"||(T==="preferred"?Q.isPreferred:Q.status===T),ke=q==="all"||Q.category===q,B=P==="all"||Q.fuelTypes&&Q.fuelTypes.includes(P);return se&&fe&&ke&&B}),L=()=>{if(!n("canManageSuppliers")){g("No tienes permisos para agregar proveedores");return}C(null),A(!0)},O=Q=>{if(!n("canManageSuppliers")){g("No tienes permisos para editar proveedores");return}C(Q),A(!0)},w=async(Q,se)=>{if(!n("canManageSuppliers")){g("No tienes permisos para eliminar proveedores");return}if(window.confirm(`Ests seguro de que deseas desactivar el proveedor "${se}"?

Esta accin se puede revertir cambiando su estado a activo.`))try{const fe=await SL(Q,e?.email);fe.success?g(null):g(fe.error||"Error al desactivar proveedor")}catch(fe){console.error("Error deleting supplier:",fe),g("Error inesperado al eliminar proveedor")}},I=()=>{A(!1),C(null),g(null)},R=()=>{A(!1),C(null),g(null)},de=()=>{M("all"),U("all"),F("all"),V("")},be=()=>{if(!n("canExportReports")){g("No tienes permisos para exportar datos");return}try{const Q=S.map(ee=>({Nombre:ee.name,"NIT/Documento":ee.taxId,Tipo:ee.type,Categora:ee.category,"Persona de Contacto":ee.contactPerson,Telfono:ee.phone,Email:ee.email,Ciudad:ee.city,Combustibles:ee.fuelTypes?.join(", "),Rating:ee.rating,Estado:ee.status,Preferido:ee.isPreferred?"S":"No","Fecha Creacin":ee.createdAt?.toDate?.()?.toLocaleDateString()||"N/A"})),se=[Object.keys(Q[0]).join(","),...Q.map(ee=>Object.values(ee).map(le=>`"${le||""}"`).join(","))].join(`
`),fe=new Blob([se],{type:"text/csv;charset=utf-8;"}),ke=document.createElement("a"),B=URL.createObjectURL(fe);ke.setAttribute("href",B),ke.setAttribute("download",`proveedores_${new Date().toISOString().split("T")[0]}.csv`),ke.style.visibility="hidden",document.body.appendChild(ke),ke.click(),document.body.removeChild(ke)}catch(Q){console.error("Error exporting suppliers:",Q),g("Error al exportar proveedores")}};return d?a.jsx("div",{className:"suppliers-main",children:a.jsxs("div",{className:"loading-container",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando proveedores..."})]})}):a.jsxs("div",{className:"suppliers-main",children:[a.jsxs("div",{className:"suppliers-header",children:[a.jsxs("div",{className:"header-content",children:[a.jsx("h1",{children:"Gestin de Proveedores"}),a.jsx("p",{className:"header-subtitle",children:"Administra los proveedores de combustibles y materiales"})]}),a.jsxs("div",{className:"header-actions",children:[n("canManageSuppliers")&&a.jsxs("button",{className:"btn btn-primary",onClick:L,children:[a.jsx("i",{className:"icon-plus"}),"Agregar Proveedor"]}),n("canExportReports")&&a.jsxs("button",{className:"btn btn-secondary",onClick:be,disabled:S.length===0,children:[a.jsx("i",{className:"icon-download"}),"Exportar"]})]})]}),p&&a.jsxs("div",{className:"alert alert-error",children:[a.jsx("i",{className:"icon-alert-circle"}),a.jsx("span",{children:p}),a.jsx("button",{onClick:()=>g(null),className:"alert-close",children:a.jsx("i",{className:"icon-x"})})]}),o&&a.jsx(LV,{stats:o,suppliersCount:S.length,totalSuppliers:t.length}),a.jsx(VV,{searchTerm:G,setSearchTerm:V,filterStatus:T,setFilterStatus:M,filterCategory:q,setFilterCategory:U,filterFuelType:P,setFilterFuelType:F,viewMode:y,setViewMode:x,onClearFilters:de,resultsCount:S.length}),S.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:a.jsx("i",{className:"icon-truck"})}),a.jsx("h3",{children:"No hay proveedores"}),a.jsx("p",{children:t.length===0?"Comienza agregando tu primer proveedor de combustibles.":"No se encontraron proveedores que coincidan con los filtros aplicados."}),t.length===0&&n("canManageSuppliers")&&a.jsxs("button",{className:"btn btn-primary",onClick:L,children:[a.jsx("i",{className:"icon-plus"}),"Agregar Primer Proveedor"]}),t.length>0&&a.jsxs("button",{className:"btn btn-secondary",onClick:de,children:[a.jsx("i",{className:"icon-filter-x"}),"Limpiar Filtros"]})]}):a.jsx("div",{className:"suppliers-content",children:y==="cards"?a.jsx(kV,{suppliers:S,onEdit:O,onDelete:w,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")}):a.jsx(OV,{suppliers:S,onEdit:O,onDelete:w,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")})}),_&&a.jsx(PV,{supplier:N,onClose:I,onSuccess:R,onError:g})]})},FV=()=>{const{user:n,userProfile:e}=ds(),[t,i]=$.useState("invitations"),[o,c]=$.useState([]),[d,f]=$.useState(!1),[p,g]=$.useState(!1),[y,x]=$.useState(!1),[_,A]=$.useState({email:"",name:"",role:xs.CLIENTE});$.useEffect(()=>{n&&e?.role==="admin"&&N()},[n,e]);const N=async()=>{f(!0);try{const P=await cL(n.uid);P.success?c(P.invitations):console.error("Error loading invitations:",P.error)}catch(P){console.error("Error loading invitations:",P)}finally{f(!1)}},C=async P=>{P.preventDefault(),x(!0);try{const F=await oL(_,n.uid);F.success?(A({email:"",name:"",role:xs.CLIENTE}),g(!1),await N(),alert(`Invitacin creada exitosamente!
Cdigo: ${F.invitation.code}`)):alert(`Error: ${F.error}`)}catch(F){console.error("Error creating invitation:",F),alert("Error creando invitacin")}finally{x(!1)}},T=async P=>{if(confirm("Ests seguro de cancelar esta invitacin?"))try{const F=await uL(P,n.uid);F.success?(await N(),alert("Invitacin cancelada exitosamente")):alert(`Error: ${F.error}`)}catch(F){console.error("Error cancelling invitation:",F),alert("Error cancelando invitacin")}},M=P=>({pending:{text:"Pendiente",class:"status-pending"},used:{text:"Usada",class:"status-used"},cancelled:{text:"Cancelada",class:"status-cancelled"},expired:{text:"Expirada",class:"status-expired"}})[P]||{text:P,class:"status-unknown"},q=P=>({admin:"Administrador",contador:"Contador",cliente:"Cliente"})[P]||P,U=P=>P?(P.toDate?P.toDate():new Date(P)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e?.role!=="admin"?a.jsxs("div",{className:"admin-unauthorized",children:[a.jsx("h2",{children:" Acceso Denegado"}),a.jsx("p",{children:"Solo los administradores pueden acceder a esta seccin."})]}):a.jsxs("div",{className:"admin-main",children:[a.jsxs("div",{className:"admin-header",children:[a.jsx("h1",{children:" Administracin del Sistema"}),a.jsx("p",{children:"Gestin de usuarios y configuraciones"})]}),a.jsxs("div",{className:"admin-tabs",children:[a.jsx("button",{className:`tab-button ${t==="invitations"?"active":""}`,onClick:()=>i("invitations"),children:" Invitaciones"}),a.jsx("button",{className:`tab-button ${t==="users"?"active":""}`,onClick:()=>i("users"),children:" Usuarios"}),a.jsx("button",{className:`tab-button ${t==="settings"?"active":""}`,onClick:()=>i("settings"),children:" Configuracin"})]}),a.jsxs("div",{className:"admin-content",children:[t==="invitations"&&a.jsxs("div",{className:"invitations-section",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h2",{children:"Gestin de Invitaciones"}),a.jsx("button",{className:"create-button",onClick:()=>g(!0),children:"+ Crear Invitacin"})]}),d?a.jsx("div",{className:"loading",children:"Cargando invitaciones..."}):a.jsxs("div",{className:"invitations-table",children:[a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Cdigo"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Nombre"}),a.jsx("th",{children:"Rol"}),a.jsx("th",{children:"Estado"}),a.jsx("th",{children:"Creada"}),a.jsx("th",{children:"Expira"}),a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:o.map(P=>{const F=M(P.status);return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("code",{className:"invitation-code",children:P.code})}),a.jsx("td",{children:P.targetEmail}),a.jsx("td",{children:P.targetName||"-"}),a.jsx("td",{children:q(P.targetRole)}),a.jsx("td",{children:a.jsx("span",{className:`status-badge ${F.class}`,children:F.text})}),a.jsx("td",{children:U(P.createdAt)}),a.jsx("td",{children:U(P.expiresAt)}),a.jsx("td",{children:P.status==="pending"&&a.jsx("button",{className:"cancel-button",onClick:()=>T(P.id),children:"Cancelar"})})]},P.id)})})]}),o.length===0&&a.jsx("div",{className:"empty-state",children:a.jsx("p",{children:"No hay invitaciones creadas"})})]})]}),t==="users"&&a.jsxs("div",{className:"users-section",children:[a.jsx("h2",{children:" Usuarios del Sistema"}),a.jsxs("div",{className:"coming-soon",children:[a.jsx("span",{children:" En desarrollo"}),a.jsx("p",{children:"Prximamente: Lista de usuarios registrados, edicin de permisos, y estadsticas."})]})]}),t==="settings"&&a.jsxs("div",{className:"settings-section",children:[a.jsx("h2",{children:" Configuracin del Sistema"}),a.jsxs("div",{className:"coming-soon",children:[a.jsx("span",{children:" En desarrollo"}),a.jsx("p",{children:"Prximamente: Configuraciones generales, notificaciones, y parmetros del sistema."})]})]})]}),p&&a.jsx("div",{className:"modal-overlay",onClick:()=>g(!1),children:a.jsxs("div",{className:"modal-content",onClick:P=>P.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:"Crear Nueva Invitacin"}),a.jsx("button",{className:"modal-close",onClick:()=>g(!1),children:""})]}),a.jsxs("form",{onSubmit:C,className:"invitation-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email del usuario:"}),a.jsx("input",{id:"email",type:"email",required:!0,value:_.email,onChange:P=>A({..._,email:P.target.value}),placeholder:"usuario@ejemplo.com"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"name",children:"Nombre (opcional):"}),a.jsx("input",{id:"name",type:"text",value:_.name,onChange:P=>A({..._,name:P.target.value}),placeholder:"Nombre del usuario"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"role",children:"Rol:"}),a.jsxs("select",{id:"role",value:_.role,onChange:P=>A({..._,role:P.target.value}),children:[a.jsx("option",{value:xs.CLIENTE,children:"Cliente"}),a.jsx("option",{value:xs.CONTADOR,children:"Contador"}),a.jsx("option",{value:xs.ADMIN,children:"Administrador"})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"button",className:"cancel-button",onClick:()=>g(!1),children:"Cancelar"}),a.jsx("button",{type:"submit",className:"create-button",disabled:y,children:y?"Creando...":"Crear Invitacin"})]})]})]})})]})},qV=()=>a.jsxs("div",{className:"module-placeholder",children:[a.jsx("h2",{children:" Mdulo de Reportes"}),a.jsx("p",{children:"Anlisis y reportes de combustibles"}),a.jsxs("div",{className:"coming-soon",children:[a.jsx("span",{children:" En desarrollo"}),a.jsx("p",{children:"Prximamente: Reportes personalizables, grficos interactivos, y exportacin."})]})]}),zV=()=>{const[n,e]=$.useState("dashboard"),t=()=>{switch(n){case"dashboard":return a.jsx(FE,{});case"inventory":return a.jsx(UL,{});case"movements":return a.jsx(aV,{});case"vehicles":return a.jsx(bV,{});case"maintenance":return a.jsx(IV,{});case"products":return a.jsx(MV,{});case"suppliers":return a.jsx(UV,{});case"reports":return a.jsx(qV,{});case"admin":return a.jsx(FV,{});default:return a.jsx(FE,{})}};return a.jsx(DL,{currentView:n,onViewChange:e,children:t()})},BV=()=>{const[n,e]=$.useState("login"),[t,i]=$.useState(!1),[o,c]=$.useState(""),[d,f]=$.useState(""),[p,g]=$.useState(""),[y,x]=$.useState(""),[_,A]=$.useState({email:"",password:"",confirmPassword:"",invitationCode:""}),[N,C]=$.useState(""),[T,M]=$.useState(null),q=async L=>{L.preventDefault(),i(!0),c("");try{await mR(Gc,p,y)}catch(O){console.error("Error en login:",O),c(G(O.code))}finally{i(!1)}},U=async()=>{i(!0),c("");try{const L=new wa,O=await VR(Gc,L);T?await ME(O.user,T.code):await xA(O.user)}catch(L){console.error("Error en login con Google:",L),c("Error al iniciar sesin con Google")}finally{i(!1)}},P=async L=>{L.preventDefault(),i(!0),c(""),f("");try{const O=await bA(N);O.success?(M(O.invitation),f(`Invitacin vlida para: ${O.invitation.targetEmail}`),e("register"),A({..._,email:O.invitation.targetEmail,invitationCode:N})):c(O.error)}catch(O){console.error("Error validando invitacin:",O),c("Error validando cdigo de invitacin")}finally{i(!1)}},F=async L=>{if(L.preventDefault(),i(!0),c(""),_.password!==_.confirmPassword){c("Las contraseas no coinciden"),i(!1);return}if(_.password.length<6){c("La contrasea debe tener al menos 6 caracteres"),i(!1);return}try{const O=await fR(Gc,_.email,_.password),w=await ME(O.user,_.invitationCode);w.success?f("Registro exitoso! Bienvenido al sistema."):c(w.error)}catch(O){console.error("Error en registro:",O),c(G(O.code))}finally{i(!1)}},G=L=>{switch(L){case"auth/invalid-email":return"El formato del email es invlido";case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contrasea incorrecta";case"auth/invalid-credential":return"Email o contrasea incorrectos";case"auth/email-already-in-use":return"Este email ya est registrado";case"auth/weak-password":return"La contrasea es muy dbil";default:return"Error de autenticacin. Intntalo de nuevo."}},V=()=>{c(""),f(""),g(""),x(""),C(""),M(null),A({email:"",password:"",confirmPassword:"",invitationCode:""})},S=()=>{switch(n){case"login":return a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:q,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email:"}),a.jsx("input",{id:"email",type:"email",value:p,onChange:L=>g(L.target.value),required:!0,disabled:t,placeholder:"tu-email@ejemplo.com"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Contrasea:"}),a.jsx("input",{id:"password",type:"password",value:y,onChange:L=>x(L.target.value),required:!0,disabled:t,placeholder:"Tu contrasea"})]}),a.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Iniciando sesin...":"Iniciar Sesin"})]}),a.jsx("div",{className:"auth-divider",children:a.jsx("span",{children:"o"})}),a.jsxs("button",{onClick:U,className:"auth-button google",disabled:t,children:[a.jsx("span",{children:""}),"Continuar con Google"]}),a.jsx("div",{className:"auth-actions",children:a.jsx("button",{className:"link-button",onClick:()=>{V(),e("invite")},children:"Tienes un cdigo de invitacin? Regstrate aqu"})})]});case"invite":return a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:P,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"inviteCode",children:"Cdigo de invitacin:"}),a.jsx("input",{id:"inviteCode",type:"text",value:N,onChange:L=>C(L.target.value.toUpperCase()),required:!0,disabled:t,placeholder:"XXXXXXXX",maxLength:8,style:{textTransform:"uppercase",fontFamily:"monospace"}}),a.jsx("small",{children:"Ingresa el cdigo de 8 caracteres que recibiste"})]}),a.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Validando...":"Validar Cdigo"})]}),a.jsx("div",{className:"auth-actions",children:a.jsx("button",{className:"link-button",onClick:()=>{V(),e("login")},children:"Volver al inicio de sesin"})})]});case"register":return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"invitation-info",children:a.jsxs("div",{className:"success-message",children:[" Cdigo vlido para: ",T?.targetEmail]})}),a.jsxs("form",{onSubmit:F,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"registerEmail",children:"Email:"}),a.jsx("input",{id:"registerEmail",type:"email",value:_.email,disabled:!0,className:"disabled-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"registerPassword",children:"Contrasea:"}),a.jsx("input",{id:"registerPassword",type:"password",value:_.password,onChange:L=>A({..._,password:L.target.value}),required:!0,disabled:t,placeholder:"Mnimo 6 caracteres",minLength:6})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar contrasea:"}),a.jsx("input",{id:"confirmPassword",type:"password",value:_.confirmPassword,onChange:L=>A({..._,confirmPassword:L.target.value}),required:!0,disabled:t,placeholder:"Repite tu contrasea"})]}),a.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Registrando...":"Crear Cuenta"})]}),a.jsx("div",{className:"auth-divider",children:a.jsx("span",{children:"o"})}),a.jsxs("button",{onClick:U,className:"auth-button google",disabled:t,children:[a.jsx("span",{children:""}),"Registrarse con Google"]}),a.jsx("div",{className:"auth-actions",children:a.jsx("button",{className:"link-button",onClick:()=>{V(),e("invite")},children:"Usar otro cdigo de invitacin"})})]});default:return null}};return a.jsx("div",{className:"auth-container",children:a.jsxs("div",{className:"auth-card",children:[a.jsxs("div",{className:"auth-header",children:[a.jsx("h1",{children:" Combustibles"}),a.jsx("h2",{children:"Forestech Colombia"}),a.jsxs("p",{children:[n==="login"&&"Sistema de gestin de combustibles",n==="invite"&&"Validar cdigo de invitacin",n==="register"&&"Crear nueva cuenta"]})]}),a.jsxs("div",{className:"auth-form",children:[o&&a.jsx("div",{className:"error-message",children:o}),d&&a.jsx("div",{className:"success-message",children:d}),S(),a.jsx("div",{className:"auth-footer",children:a.jsx("p",{children:a.jsxs("small",{children:["Solo usuarios autorizados pueden acceder al sistema.",a.jsx("br",{}),n==="login"?"Contacta al administrador para obtener un cdigo de invitacin.":"Si no tienes cdigo, contacta al administrador."]})})})]})]})})};function HV(){return a.jsx(RL,{children:a.jsx(GV,{})})}function GV(){const{user:n,loading:e}=ds();return e?a.jsx("div",{className:"loading-container",children:a.jsxs("div",{className:"loader",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Cargando..."})]})}):a.jsxs("div",{className:"App",children:[!n&&a.jsx(BV,{}),n&&a.jsx(zV,{})]})}MC.createRoot(document.getElementById("root")).render(a.jsx($.StrictMode,{children:a.jsx(HV,{})}));
