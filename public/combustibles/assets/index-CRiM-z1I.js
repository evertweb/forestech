(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var gp={exports:{}},Nc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nb;function XC(){if(nb)return Nc;nb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var f in o)f!=="key"&&(c[f]=o[f])}else c=o;return o=c.ref,{$$typeof:n,type:a,key:d,ref:o!==void 0?o:null,props:c}}return Nc.Fragment=e,Nc.jsx=t,Nc.jsxs=t,Nc}var sb;function WC(){return sb||(sb=1,gp.exports=XC()),gp.exports}var r=WC(),vp={exports:{}},Pe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ab;function ZC(){if(ab)return Pe;ab=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),N=Symbol.iterator;function j(B){return B===null||typeof B!="object"?null:(B=N&&B[N]||B["@@iterator"],typeof B=="function"?B:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,M={};function T(B,ne,he){this.props=B,this.context=ne,this.refs=M,this.updater=he||C}T.prototype.isReactComponent={},T.prototype.setState=function(B,ne){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,ne,"setState")},T.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function L(){}L.prototype=T.prototype;function $(B,ne,he){this.props=B,this.context=ne,this.refs=M,this.updater=he||C}var O=$.prototype=new L;O.constructor=$,b(O,T.prototype),O.isPureReactComponent=!0;var U=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},X=Object.prototype.hasOwnProperty;function w(B,ne,he,ue,Ne,Ue){return he=Ue.ref,{$$typeof:n,type:B,key:ne,ref:he!==void 0?he:null,props:Ue}}function A(B,ne){return w(B.type,ne,void 0,void 0,void 0,B.props)}function R(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function I(B){var ne={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(he){return ne[he]})}var P=/\/+/g;function V(B,ne){return typeof B=="object"&&B!==null&&B.key!=null?I(""+B.key):ne.toString(36)}function k(){}function ke(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(k,k):(B.status="pending",B.then(function(ne){B.status==="pending"&&(B.status="fulfilled",B.value=ne)},function(ne){B.status==="pending"&&(B.status="rejected",B.reason=ne)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function ae(B,ne,he,ue,Ne){var Ue=typeof B;(Ue==="undefined"||Ue==="boolean")&&(B=null);var Ie=!1;if(B===null)Ie=!0;else switch(Ue){case"bigint":case"string":case"number":Ie=!0;break;case"object":switch(B.$$typeof){case n:case e:Ie=!0;break;case _:return Ie=B._init,ae(Ie(B._payload),ne,he,ue,Ne)}}if(Ie)return Ne=Ne(B),Ie=ue===""?"."+V(B,0):ue,U(Ne)?(he="",Ie!=null&&(he=Ie.replace(P,"$&/")+"/"),ae(Ne,ne,he,"",function(As){return As})):Ne!=null&&(R(Ne)&&(Ne=A(Ne,he+(Ne.key==null||B&&B.key===Ne.key?"":(""+Ne.key).replace(P,"$&/")+"/")+Ie)),ne.push(Ne)),1;Ie=0;var Gt=ue===""?".":ue+":";if(U(B))for(var ft=0;ft<B.length;ft++)ue=B[ft],Ue=Gt+V(ue,ft),Ie+=ae(ue,ne,he,Ue,Ne);else if(ft=j(B),typeof ft=="function")for(B=ft.call(B),ft=0;!(ue=B.next()).done;)ue=ue.value,Ue=Gt+V(ue,ft++),Ie+=ae(ue,ne,he,Ue,Ne);else if(Ue==="object"){if(typeof B.then=="function")return ae(ke(B),ne,he,ue,Ne);throw ne=String(B),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return Ie}function H(B,ne,he){if(B==null)return B;var ue=[],Ne=0;return ae(B,ue,"","",function(Ue){return ne.call(he,Ue,Ne++)}),ue}function J(B){if(B._status===-1){var ne=B._result;ne=ne(),ne.then(function(he){(B._status===0||B._status===-1)&&(B._status=1,B._result=he)},function(he){(B._status===0||B._status===-1)&&(B._status=2,B._result=he)}),B._status===-1&&(B._status=0,B._result=ne)}if(B._status===1)return B._result.default;throw B._result}var ce=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)};function ve(){}return Pe.Children={map:H,forEach:function(B,ne,he){H(B,function(){ne.apply(this,arguments)},he)},count:function(B){var ne=0;return H(B,function(){ne++}),ne},toArray:function(B){return H(B,function(ne){return ne})||[]},only:function(B){if(!R(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},Pe.Component=T,Pe.Fragment=t,Pe.Profiler=o,Pe.PureComponent=$,Pe.StrictMode=a,Pe.Suspense=p,Pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Pe.__COMPILER_RUNTIME={__proto__:null,c:function(B){return F.H.useMemoCache(B)}},Pe.cache=function(B){return function(){return B.apply(null,arguments)}},Pe.cloneElement=function(B,ne,he){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var ue=b({},B.props),Ne=B.key,Ue=void 0;if(ne!=null)for(Ie in ne.ref!==void 0&&(Ue=void 0),ne.key!==void 0&&(Ne=""+ne.key),ne)!X.call(ne,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&ne.ref===void 0||(ue[Ie]=ne[Ie]);var Ie=arguments.length-2;if(Ie===1)ue.children=he;else if(1<Ie){for(var Gt=Array(Ie),ft=0;ft<Ie;ft++)Gt[ft]=arguments[ft+2];ue.children=Gt}return w(B.type,Ne,void 0,void 0,Ue,ue)},Pe.createContext=function(B){return B={$$typeof:d,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:c,_context:B},B},Pe.createElement=function(B,ne,he){var ue,Ne={},Ue=null;if(ne!=null)for(ue in ne.key!==void 0&&(Ue=""+ne.key),ne)X.call(ne,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(Ne[ue]=ne[ue]);var Ie=arguments.length-2;if(Ie===1)Ne.children=he;else if(1<Ie){for(var Gt=Array(Ie),ft=0;ft<Ie;ft++)Gt[ft]=arguments[ft+2];Ne.children=Gt}if(B&&B.defaultProps)for(ue in Ie=B.defaultProps,Ie)Ne[ue]===void 0&&(Ne[ue]=Ie[ue]);return w(B,Ue,void 0,void 0,null,Ne)},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(B){return{$$typeof:f,render:B}},Pe.isValidElement=R,Pe.lazy=function(B){return{$$typeof:_,_payload:{_status:-1,_result:B},_init:J}},Pe.memo=function(B,ne){return{$$typeof:v,type:B,compare:ne===void 0?null:ne}},Pe.startTransition=function(B){var ne=F.T,he={};F.T=he;try{var ue=B(),Ne=F.S;Ne!==null&&Ne(he,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(ve,ce)}catch(Ue){ce(Ue)}finally{F.T=ne}},Pe.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Pe.use=function(B){return F.H.use(B)},Pe.useActionState=function(B,ne,he){return F.H.useActionState(B,ne,he)},Pe.useCallback=function(B,ne){return F.H.useCallback(B,ne)},Pe.useContext=function(B){return F.H.useContext(B)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(B,ne){return F.H.useDeferredValue(B,ne)},Pe.useEffect=function(B,ne,he){var ue=F.H;if(typeof he=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ue.useEffect(B,ne)},Pe.useId=function(){return F.H.useId()},Pe.useImperativeHandle=function(B,ne,he){return F.H.useImperativeHandle(B,ne,he)},Pe.useInsertionEffect=function(B,ne){return F.H.useInsertionEffect(B,ne)},Pe.useLayoutEffect=function(B,ne){return F.H.useLayoutEffect(B,ne)},Pe.useMemo=function(B,ne){return F.H.useMemo(B,ne)},Pe.useOptimistic=function(B,ne){return F.H.useOptimistic(B,ne)},Pe.useReducer=function(B,ne,he){return F.H.useReducer(B,ne,he)},Pe.useRef=function(B){return F.H.useRef(B)},Pe.useState=function(B){return F.H.useState(B)},Pe.useSyncExternalStore=function(B,ne,he){return F.H.useSyncExternalStore(B,ne,he)},Pe.useTransition=function(){return F.H.useTransition()},Pe.version="19.1.0",Pe}var ib;function bg(){return ib||(ib=1,vp.exports=ZC()),vp.exports}var Y=bg(),yp={exports:{}},xc={},_p={exports:{}},Ep={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rb;function JC(){return rb||(rb=1,function(n){function e(H,J){var ce=H.length;H.push(J);e:for(;0<ce;){var ve=ce-1>>>1,B=H[ve];if(0<o(B,J))H[ve]=J,H[ce]=B,ce=ve;else break e}}function t(H){return H.length===0?null:H[0]}function a(H){if(H.length===0)return null;var J=H[0],ce=H.pop();if(ce!==J){H[0]=ce;e:for(var ve=0,B=H.length,ne=B>>>1;ve<ne;){var he=2*(ve+1)-1,ue=H[he],Ne=he+1,Ue=H[Ne];if(0>o(ue,ce))Ne<B&&0>o(Ue,ue)?(H[ve]=Ue,H[Ne]=ce,ve=Ne):(H[ve]=ue,H[he]=ce,ve=he);else if(Ne<B&&0>o(Ue,ce))H[ve]=Ue,H[Ne]=ce,ve=Ne;else break e}}return J}function o(H,J){var ce=H.sortIndex-J.sortIndex;return ce!==0?ce:H.id-J.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var p=[],v=[],_=1,N=null,j=3,C=!1,b=!1,M=!1,T=!1,L=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function U(H){for(var J=t(v);J!==null;){if(J.callback===null)a(v);else if(J.startTime<=H)a(v),J.sortIndex=J.expirationTime,e(p,J);else break;J=t(v)}}function F(H){if(M=!1,U(H),!b)if(t(p)!==null)b=!0,X||(X=!0,V());else{var J=t(v);J!==null&&ae(F,J.startTime-H)}}var X=!1,w=-1,A=5,R=-1;function I(){return T?!0:!(n.unstable_now()-R<A)}function P(){if(T=!1,X){var H=n.unstable_now();R=H;var J=!0;try{e:{b=!1,M&&(M=!1,$(w),w=-1),C=!0;var ce=j;try{t:{for(U(H),N=t(p);N!==null&&!(N.expirationTime>H&&I());){var ve=N.callback;if(typeof ve=="function"){N.callback=null,j=N.priorityLevel;var B=ve(N.expirationTime<=H);if(H=n.unstable_now(),typeof B=="function"){N.callback=B,U(H),J=!0;break t}N===t(p)&&a(p),U(H)}else a(p);N=t(p)}if(N!==null)J=!0;else{var ne=t(v);ne!==null&&ae(F,ne.startTime-H),J=!1}}break e}finally{N=null,j=ce,C=!1}J=void 0}}finally{J?V():X=!1}}}var V;if(typeof O=="function")V=function(){O(P)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,ke=k.port2;k.port1.onmessage=P,V=function(){ke.postMessage(null)}}else V=function(){L(P,0)};function ae(H,J){w=L(function(){H(n.unstable_now())},J)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return j},n.unstable_next=function(H){switch(j){case 1:case 2:case 3:var J=3;break;default:J=j}var ce=j;j=J;try{return H()}finally{j=ce}},n.unstable_requestPaint=function(){T=!0},n.unstable_runWithPriority=function(H,J){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ce=j;j=H;try{return J()}finally{j=ce}},n.unstable_scheduleCallback=function(H,J,ce){var ve=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ve+ce:ve):ce=ve,H){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=ce+B,H={id:_++,callback:J,priorityLevel:H,startTime:ce,expirationTime:B,sortIndex:-1},ce>ve?(H.sortIndex=ce,e(v,H),t(p)===null&&H===t(v)&&(M?($(w),w=-1):M=!0,ae(F,ce-ve))):(H.sortIndex=B,e(p,H),b||C||(b=!0,X||(X=!0,V()))),H},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(H){var J=j;return function(){var ce=j;j=J;try{return H.apply(this,arguments)}finally{j=ce}}}}(Ep)),Ep}var ob;function eS(){return ob||(ob=1,_p.exports=JC()),_p.exports}var bp={exports:{}},mn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lb;function tS(){if(lb)return mn;lb=1;var n=bg();function e(p){var v="https://react.dev/errors/"+p;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)v+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,v,_){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:N==null?null:""+N,children:p,containerInfo:v,implementation:_}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,v){if(p==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return mn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,mn.createPortal=function(p,v){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(e(299));return c(p,v,null,_)},mn.flushSync=function(p){var v=d.T,_=a.p;try{if(d.T=null,a.p=2,p)return p()}finally{d.T=v,a.p=_,a.d.f()}},mn.preconnect=function(p,v){typeof p=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,a.d.C(p,v))},mn.prefetchDNS=function(p){typeof p=="string"&&a.d.D(p)},mn.preinit=function(p,v){if(typeof p=="string"&&v&&typeof v.as=="string"){var _=v.as,N=f(_,v.crossOrigin),j=typeof v.integrity=="string"?v.integrity:void 0,C=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;_==="style"?a.d.S(p,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:N,integrity:j,fetchPriority:C}):_==="script"&&a.d.X(p,{crossOrigin:N,integrity:j,fetchPriority:C,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},mn.preinitModule=function(p,v){if(typeof p=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var _=f(v.as,v.crossOrigin);a.d.M(p,{crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&a.d.M(p)},mn.preload=function(p,v){if(typeof p=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var _=v.as,N=f(_,v.crossOrigin);a.d.L(p,_,{crossOrigin:N,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},mn.preloadModule=function(p,v){if(typeof p=="string")if(v){var _=f(v.as,v.crossOrigin);a.d.m(p,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else a.d.m(p)},mn.requestFormReset=function(p){a.d.r(p)},mn.unstable_batchedUpdates=function(p,v){return p(v)},mn.useFormState=function(p,v,_){return d.H.useFormState(p,v,_)},mn.useFormStatus=function(){return d.H.useHostTransitionStatus()},mn.version="19.1.0",mn}var cb;function nS(){if(cb)return bp.exports;cb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),bp.exports=tS(),bp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ub;function sS(){if(ub)return xc;ub=1;var n=eS(),e=bg(),t=nS();function a(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var i=s,l=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(l=i.return),s=i.return;while(s)}return i.tag===3?l:null}function d(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function f(s){if(c(s)!==s)throw Error(a(188))}function p(s){var i=s.alternate;if(!i){if(i=c(s),i===null)throw Error(a(188));return i!==s?null:s}for(var l=s,u=i;;){var m=l.return;if(m===null)break;var g=m.alternate;if(g===null){if(u=m.return,u!==null){l=u;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===l)return f(m),s;if(g===u)return f(m),i;g=g.sibling}throw Error(a(188))}if(l.return!==u.return)l=m,u=g;else{for(var x=!1,S=m.child;S;){if(S===l){x=!0,l=m,u=g;break}if(S===u){x=!0,u=m,l=g;break}S=S.sibling}if(!x){for(S=g.child;S;){if(S===l){x=!0,l=g,u=m;break}if(S===u){x=!0,u=g,l=m;break}S=S.sibling}if(!x)throw Error(a(189))}}if(l.alternate!==u)throw Error(a(190))}if(l.tag!==3)throw Error(a(188));return l.stateNode.current===l?s:i}function v(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=v(s),i!==null)return i;s=s.sibling}return null}var _=Object.assign,N=Symbol.for("react.element"),j=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),$=Symbol.for("react.consumer"),O=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function V(s){return s===null||typeof s!="object"?null:(s=P&&s[P]||s["@@iterator"],typeof s=="function"?s:null)}var k=Symbol.for("react.client.reference");function ke(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===k?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case T:return"Profiler";case M:return"StrictMode";case F:return"Suspense";case X:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case C:return"Portal";case O:return(s.displayName||"Context")+".Provider";case $:return(s._context.displayName||"Context")+".Consumer";case U:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case w:return i=s.displayName||null,i!==null?i:ke(s.type)||"Memo";case A:i=s._payload,s=s._init;try{return ke(s(i))}catch{}}return null}var ae=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},ve=[],B=-1;function ne(s){return{current:s}}function he(s){0>B||(s.current=ve[B],ve[B]=null,B--)}function ue(s,i){B++,ve[B]=s.current,s.current=i}var Ne=ne(null),Ue=ne(null),Ie=ne(null),Gt=ne(null);function ft(s,i){switch(ue(Ie,i),ue(Ue,s),ue(Ne,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?IE(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=IE(i),s=RE(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}he(Ne),ue(Ne,s)}function As(){he(Ne),he(Ue),he(Ie)}function La(s){s.memoizedState!==null&&ue(Gt,s);var i=Ne.current,l=RE(i,s.type);i!==l&&(ue(Ue,s),ue(Ne,l))}function Js(s){Ue.current===s&&(he(Ne),he(Ue)),Gt.current===s&&(he(Gt),vc._currentValue=ce)}var Ui=Object.prototype.hasOwnProperty,Fi=n.unstable_scheduleCallback,qi=n.unstable_cancelCallback,ml=n.unstable_shouldYield,_u=n.unstable_requestPaint,Xn=n.unstable_now,gf=n.unstable_getCurrentPriorityLevel,pl=n.unstable_ImmediatePriority,Fr=n.unstable_UserBlockingPriority,Bi=n.unstable_NormalPriority,vf=n.unstable_LowPriority,qr=n.unstable_IdlePriority,gl=n.log,Eu=n.unstable_setDisableYieldValue,Et=null,st=null;function Pn(s){if(typeof gl=="function"&&Eu(s),st&&typeof st.setStrictMode=="function")try{st.setStrictMode(Et,s)}catch{}}var hn=Math.clz32?Math.clz32:Hi,bu=Math.log,yf=Math.LN2;function Hi(s){return s>>>=0,s===0?32:31-(bu(s)/yf|0)|0}var zi=256,Gi=4194304;function hs(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Br(s,i,l){var u=s.pendingLanes;if(u===0)return 0;var m=0,g=s.suspendedLanes,x=s.pingedLanes;s=s.warmLanes;var S=u&134217727;return S!==0?(u=S&~g,u!==0?m=hs(u):(x&=S,x!==0?m=hs(x):l||(l=S&~s,l!==0&&(m=hs(l))))):(S=u&~g,S!==0?m=hs(S):x!==0?m=hs(x):l||(l=u&~s,l!==0&&(m=hs(l)))),m===0?0:i!==0&&i!==m&&(i&g)===0&&(g=m&-m,l=i&-i,g>=l||g===32&&(l&4194048)!==0)?i:m}function $i(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function vl(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yl(){var s=zi;return zi<<=1,(zi&4194048)===0&&(zi=256),s}function _l(){var s=Gi;return Gi<<=1,(Gi&62914560)===0&&(Gi=4194304),s}function ea(s){for(var i=[],l=0;31>l;l++)i.push(s);return i}function ta(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function El(s,i,l,u,m,g){var x=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var S=s.entanglements,q=s.expirationTimes,W=s.hiddenUpdates;for(l=x&~l;0<l;){var se=31-hn(l),oe=1<<se;S[se]=0,q[se]=-1;var Z=W[se];if(Z!==null)for(W[se]=null,se=0;se<Z.length;se++){var ee=Z[se];ee!==null&&(ee.lane&=-536870913)}l&=~oe}u!==0&&js(s,u,0),g!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=g&~(x&~i))}function js(s,i,l){s.pendingLanes|=i,s.suspendedLanes&=~i;var u=31-hn(i);s.entangledLanes|=i,s.entanglements[u]=s.entanglements[u]|1073741824|l&4194090}function bl(s,i){var l=s.entangledLanes|=i;for(s=s.entanglements;l;){var u=31-hn(l),m=1<<u;m&i|s[u]&i&&(s[u]|=i),l&=~m}}function Va(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Hr(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ua(){var s=J.p;return s!==0?s:(s=window.event,s===void 0?32:XE(s.type))}function Nu(s,i){var l=J.p;try{return J.p=s,i()}finally{J.p=l}}var gt=Math.random().toString(36).slice(2),Pt="__reactFiber$"+gt,wt="__reactProps$"+gt,Wn="__reactContainer$"+gt,Nl="__reactEvents$"+gt,_f="__reactListeners$"+gt,Fa="__reactHandles$"+gt,xu="__reactResources$"+gt,Yi="__reactMarker$"+gt;function qa(s){delete s[Pt],delete s[wt],delete s[Nl],delete s[_f],delete s[Fa]}function na(s){var i=s[Pt];if(i)return i;for(var l=s.parentNode;l;){if(i=l[Wn]||l[Pt]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(s=PE(s);s!==null;){if(l=s[Pt])return l;s=PE(s)}return i}s=l,l=s.parentNode}return null}function Cs(s){if(s=s[Pt]||s[Wn]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function Ss(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(a(33))}function En(s){var i=s[xu];return i||(i=s[xu]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function At(s){s[Yi]=!0}var xl=new Set,zr={};function fs(s,i){sa(s,i),sa(s+"Capture",i)}function sa(s,i){for(zr[s]=i,s=0;s<i.length;s++)xl.add(i[s])}var Tu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Au={},Ki={};function ju(s){return Ui.call(Ki,s)?!0:Ui.call(Au,s)?!1:Tu.test(s)?Ki[s]=!0:(Au[s]=!0,!1)}function Ba(s,i,l){if(ju(i))if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+l)}}function ws(s,i,l){if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+l)}}function Jt(s,i,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(i,l,""+u)}}var Qi,Cu;function aa(s){if(Qi===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);Qi=i&&i[1]||"",Cu=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Qi+s+Cu}var Gr=!1;function $r(s,i){if(!s||Gr)return"";Gr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(ee){var Z=ee}Reflect.construct(s,[],oe)}else{try{oe.call()}catch(ee){Z=ee}s.call(oe.prototype)}}else{try{throw Error()}catch(ee){Z=ee}(oe=s())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(ee){if(ee&&Z&&typeof ee.stack=="string")return[ee.stack,Z.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),x=g[0],S=g[1];if(x&&S){var q=x.split(`
`),W=S.split(`
`);for(m=u=0;u<q.length&&!q[u].includes("DetermineComponentFrameRoot");)u++;for(;m<W.length&&!W[m].includes("DetermineComponentFrameRoot");)m++;if(u===q.length||m===W.length)for(u=q.length-1,m=W.length-1;1<=u&&0<=m&&q[u]!==W[m];)m--;for(;1<=u&&0<=m;u--,m--)if(q[u]!==W[m]){if(u!==1||m!==1)do if(u--,m--,0>m||q[u]!==W[m]){var se=`
`+q[u].replace(" at new "," at ");return s.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",s.displayName)),se}while(1<=u&&0<=m);break}}}finally{Gr=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?aa(l):""}function Tl(s){switch(s.tag){case 26:case 27:case 5:return aa(s.type);case 16:return aa("Lazy");case 13:return aa("Suspense");case 19:return aa("SuspenseList");case 0:case 15:return $r(s.type,!1);case 11:return $r(s.type.render,!1);case 1:return $r(s.type,!0);case 31:return aa("Activity");default:return""}}function Yr(s){try{var i="";do i+=Tl(s),s=s.return;while(s);return i}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function bn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Al(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ef(s){var i=Al(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),u=""+s[i];if(!s.hasOwnProperty(i)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,g=l.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return m.call(this)},set:function(x){u=""+x,g.call(this,x)}}),Object.defineProperty(s,i,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(x){u=""+x},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Kr(s){s._valueTracker||(s._valueTracker=Ef(s))}function jl(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var l=i.getValue(),u="";return s&&(u=Al(s)?s.checked?"true":"false":s.value),s=u,s!==l?(i.setValue(s),!0):!1}function Xi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var bf=/[\n"\\]/g;function It(s){return s.replace(bf,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function kn(s,i,l,u,m,g,x,S){s.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?s.type=x:s.removeAttribute("type"),i!=null?x==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+bn(i)):s.value!==""+bn(i)&&(s.value=""+bn(i)):x!=="submit"&&x!=="reset"||s.removeAttribute("value"),i!=null?Ha(s,x,bn(i)):l!=null?Ha(s,x,bn(l)):u!=null&&s.removeAttribute("value"),m==null&&g!=null&&(s.defaultChecked=!!g),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+bn(S):s.removeAttribute("name")}function Wi(s,i,l,u,m,g,x,S){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(s.type=g),i!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||i!=null))return;l=l!=null?""+bn(l):"",i=i!=null?""+bn(i):l,S||i===s.value||(s.value=i),s.defaultValue=i}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=S?s.checked:!!u,s.defaultChecked=!!u,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.name=x)}function Ha(s,i,l){i==="number"&&Xi(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function ia(s,i,l,u){if(s=s.options,i){i={};for(var m=0;m<l.length;m++)i["$"+l[m]]=!0;for(l=0;l<s.length;l++)m=i.hasOwnProperty("$"+s[l].value),s[l].selected!==m&&(s[l].selected=m),m&&u&&(s[l].defaultSelected=!0)}else{for(l=""+bn(l),i=null,m=0;m<s.length;m++){if(s[m].value===l){s[m].selected=!0,u&&(s[m].defaultSelected=!0);return}i!==null||s[m].disabled||(i=s[m])}i!==null&&(i.selected=!0)}}function rt(s,i,l){if(i!=null&&(i=""+bn(i),i!==s.value&&(s.value=i),l==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=l!=null?""+bn(l):""}function Zi(s,i,l,u){if(i==null){if(u!=null){if(l!=null)throw Error(a(92));if(ae(u)){if(1<u.length)throw Error(a(93));u=u[0]}l=u}l==null&&(l=""),i=l}l=bn(i),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u)}function Zn(s,i){if(i){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=i;return}}s.textContent=i}var Ji=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Su(s,i,l){var u=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":u?s.setProperty(i,l):typeof l!="number"||l===0||Ji.has(i)?i==="float"?s.cssFloat=l:s[i]=(""+l).trim():s[i]=l+"px"}function Cl(s,i,l){if(i!=null&&typeof i!="object")throw Error(a(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var m in i)u=i[m],i.hasOwnProperty(m)&&l[m]!==u&&Su(s,m,u)}else for(var g in i)i.hasOwnProperty(g)&&Su(s,g,i[g])}function Sl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qr(s){return xf.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var ra=null;function Jn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var oa=null,la=null;function wl(s){var i=Cs(s);if(i&&(s=i.stateNode)){var l=s[wt]||null;e:switch(s=i.stateNode,i.type){case"input":if(kn(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+It(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var u=l[i];if(u!==s&&u.form===s.form){var m=u[wt]||null;if(!m)throw Error(a(90));kn(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<l.length;i++)u=l[i],u.form===s.form&&jl(u)}break e;case"textarea":rt(s,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&ia(s,!!l.multiple,i,!1)}}}var Is=!1;function wu(s,i,l){if(Is)return s(i,l);Is=!0;try{var u=s(i);return u}finally{if(Is=!1,(oa!==null||la!==null)&&(Nd(),oa&&(i=oa,s=la,la=oa=null,wl(i),s)))for(i=0;i<s.length;i++)wl(s[i])}}function er(s,i){var l=s.stateNode;if(l===null)return null;var u=l[wt]||null;if(u===null)return null;l=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(a(231,i,typeof l));return l}var ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),es=!1;if(ms)try{var tr={};Object.defineProperty(tr,"passive",{get:function(){es=!0}}),window.addEventListener("test",tr,tr),window.removeEventListener("test",tr,tr)}catch{es=!1}var Rs=null,za=null,ca=null;function Il(){if(ca)return ca;var s,i=za,l=i.length,u,m="value"in Rs?Rs.value:Rs.textContent,g=m.length;for(s=0;s<l&&i[s]===m[s];s++);var x=l-s;for(u=1;u<=x&&i[l-u]===m[g-u];u++);return ca=m.slice(s,1<u?1-u:void 0)}function Ds(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Os(){return!0}function Rl(){return!1}function $t(s){function i(l,u,m,g,x){this._reactName=l,this._targetInst=m,this.type=u,this.nativeEvent=g,this.target=x,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(l=s[S],this[S]=l?l(g):g[S]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Os:Rl,this.isPropagationStopped=Rl,this}return _(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Os)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Os)},persist:function(){},isPersistent:Os}),i}var nt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xr=$t(nt),nr=_({},nt,{view:0,detail:0}),Iu=$t(nr),Wr,Zr,Ms,sr=_({},nr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ms&&(Ms&&s.type==="mousemove"?(Wr=s.screenX-Ms.screenX,Zr=s.screenY-Ms.screenY):Zr=Wr=0,Ms=s),Wr)},movementY:function(s){return"movementY"in s?s.movementY:Zr}}),ts=$t(sr),Ru=_({},sr,{dataTransfer:0}),Tf=$t(Ru),ar=_({},nr,{relatedTarget:0}),Jr=$t(ar),Dl=_({},nt,{animationName:0,elapsedTime:0,pseudoElement:0}),eo=$t(Dl),Du=_({},nt,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),to=$t(Du),Af=_({},nt,{data:0}),Ol=$t(Af),ir={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ou={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ml(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Mu[s])?!!i[s]:!1}function rr(){return Ml}var Pu=_({},nr,{key:function(s){if(s.key){var i=ir[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ds(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ou[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rr,charCode:function(s){return s.type==="keypress"?Ds(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ds(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),no=$t(Pu),ku=_({},sr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pl=$t(ku),ua=_({},nr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rr}),Lu=$t(ua),Vu=_({},nt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uu=$t(Vu),Fu=_({},sr,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),so=$t(Fu),Nn=_({},nt,{newState:0,oldState:0}),qu=$t(Nn),Bu=[9,13,27,32],Ps=ms&&"CompositionEvent"in window,h=null;ms&&"documentMode"in document&&(h=document.documentMode);var y=ms&&"TextEvent"in window&&!h,E=ms&&(!Ps||h&&8<h&&11>=h),D=" ",K=!1;function te(s,i){switch(s){case"keyup":return Bu.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function de(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ke=!1;function kt(s,i){switch(s){case"compositionend":return de(i);case"keypress":return i.which!==32?null:(K=!0,D);case"textInput":return s=i.data,s===D&&K?null:s;default:return null}}function Qe(s,i){if(Ke)return s==="compositionend"||!Ps&&te(s,i)?(s=Il(),ca=za=Rs=null,Ke=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return E&&i.locale!=="ko"?null:i.data;default:return null}}var Yt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lt(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!Yt[s.type]:i==="textarea"}function da(s,i,l,u){oa?la?la.push(u):la=[u]:oa=u,i=Sd(i,"onChange"),0<i.length&&(l=new Xr("onChange","change",null,l,u),s.push({event:l,listeners:i}))}var en=null,ks=null;function kl(s){AE(s,0)}function Hu(s){var i=Ss(s);if(jl(i))return s}function $v(s,i){if(s==="change")return i}var Yv=!1;if(ms){var jf;if(ms){var Cf="oninput"in document;if(!Cf){var Kv=document.createElement("div");Kv.setAttribute("oninput","return;"),Cf=typeof Kv.oninput=="function"}jf=Cf}else jf=!1;Yv=jf&&(!document.documentMode||9<document.documentMode)}function Qv(){en&&(en.detachEvent("onpropertychange",Xv),ks=en=null)}function Xv(s){if(s.propertyName==="value"&&Hu(ks)){var i=[];da(i,ks,s,Jn(s)),wu(kl,i)}}function jj(s,i,l){s==="focusin"?(Qv(),en=i,ks=l,en.attachEvent("onpropertychange",Xv)):s==="focusout"&&Qv()}function Cj(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Hu(ks)}function Sj(s,i){if(s==="click")return Hu(i)}function wj(s,i){if(s==="input"||s==="change")return Hu(i)}function Ij(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Ln=typeof Object.is=="function"?Object.is:Ij;function Ll(s,i){if(Ln(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var l=Object.keys(s),u=Object.keys(i);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var m=l[u];if(!Ui.call(i,m)||!Ln(s[m],i[m]))return!1}return!0}function Wv(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Zv(s,i){var l=Wv(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=i&&u>=i)return{node:l,offset:i-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Wv(l)}}function Jv(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?Jv(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function ey(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Xi(s.document);i instanceof s.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)s=i.contentWindow;else break;i=Xi(s.document)}return i}function Sf(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var Rj=ms&&"documentMode"in document&&11>=document.documentMode,ao=null,wf=null,Vl=null,If=!1;function ty(s,i,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;If||ao==null||ao!==Xi(u)||(u=ao,"selectionStart"in u&&Sf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Vl&&Ll(Vl,u)||(Vl=u,u=Sd(wf,"onSelect"),0<u.length&&(i=new Xr("onSelect","select",null,i,l),s.push({event:i,listeners:u}),i.target=ao)))}function or(s,i){var l={};return l[s.toLowerCase()]=i.toLowerCase(),l["Webkit"+s]="webkit"+i,l["Moz"+s]="moz"+i,l}var io={animationend:or("Animation","AnimationEnd"),animationiteration:or("Animation","AnimationIteration"),animationstart:or("Animation","AnimationStart"),transitionrun:or("Transition","TransitionRun"),transitionstart:or("Transition","TransitionStart"),transitioncancel:or("Transition","TransitionCancel"),transitionend:or("Transition","TransitionEnd")},Rf={},ny={};ms&&(ny=document.createElement("div").style,"AnimationEvent"in window||(delete io.animationend.animation,delete io.animationiteration.animation,delete io.animationstart.animation),"TransitionEvent"in window||delete io.transitionend.transition);function lr(s){if(Rf[s])return Rf[s];if(!io[s])return s;var i=io[s],l;for(l in i)if(i.hasOwnProperty(l)&&l in ny)return Rf[s]=i[l];return s}var sy=lr("animationend"),ay=lr("animationiteration"),iy=lr("animationstart"),Dj=lr("transitionrun"),Oj=lr("transitionstart"),Mj=lr("transitioncancel"),ry=lr("transitionend"),oy=new Map,Df="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Df.push("scrollEnd");function ps(s,i){oy.set(s,i),fs(i,[s])}var ly=new WeakMap;function ns(s,i){if(typeof s=="object"&&s!==null){var l=ly.get(s);return l!==void 0?l:(i={value:s,source:i,stack:Yr(i)},ly.set(s,i),i)}return{value:s,source:i,stack:Yr(i)}}var ss=[],ro=0,Of=0;function zu(){for(var s=ro,i=Of=ro=0;i<s;){var l=ss[i];ss[i++]=null;var u=ss[i];ss[i++]=null;var m=ss[i];ss[i++]=null;var g=ss[i];if(ss[i++]=null,u!==null&&m!==null){var x=u.pending;x===null?m.next=m:(m.next=x.next,x.next=m),u.pending=m}g!==0&&cy(l,m,g)}}function Gu(s,i,l,u){ss[ro++]=s,ss[ro++]=i,ss[ro++]=l,ss[ro++]=u,Of|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function Mf(s,i,l,u){return Gu(s,i,l,u),$u(s)}function oo(s,i){return Gu(s,null,null,i),$u(s)}function cy(s,i,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var m=!1,g=s.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(s=g.stateNode,s===null||s._visibility&1||(m=!0)),s=g,g=g.return;return s.tag===3?(g=s.stateNode,m&&i!==null&&(m=31-hn(l),s=g.hiddenUpdates,u=s[m],u===null?s[m]=[i]:u.push(i),i.lane=l|536870912),g):null}function $u(s){if(50<cc)throw cc=0,Fm=null,Error(a(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var lo={};function Pj(s,i,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(s,i,l,u){return new Pj(s,i,l,u)}function Pf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ha(s,i){var l=s.alternate;return l===null?(l=Vn(s.tag,i,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=i,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,i=s.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function uy(s,i){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,i=l.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Yu(s,i,l,u,m,g){var x=0;if(u=s,typeof s=="function")Pf(s)&&(x=1);else if(typeof s=="string")x=LC(s,l,Ne.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=Vn(31,l,i,m),s.elementType=R,s.lanes=g,s;case b:return cr(l.children,m,g,i);case M:x=8,m|=24;break;case T:return s=Vn(12,l,i,m|2),s.elementType=T,s.lanes=g,s;case F:return s=Vn(13,l,i,m),s.elementType=F,s.lanes=g,s;case X:return s=Vn(19,l,i,m),s.elementType=X,s.lanes=g,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case L:case O:x=10;break e;case $:x=9;break e;case U:x=11;break e;case w:x=14;break e;case A:x=16,u=null;break e}x=29,l=Error(a(130,s===null?"null":typeof s,"")),u=null}return i=Vn(x,l,i,m),i.elementType=s,i.type=u,i.lanes=g,i}function cr(s,i,l,u){return s=Vn(7,s,u,i),s.lanes=l,s}function kf(s,i,l){return s=Vn(6,s,null,i),s.lanes=l,s}function Lf(s,i,l){return i=Vn(4,s.children!==null?s.children:[],s.key,i),i.lanes=l,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var co=[],uo=0,Ku=null,Qu=0,as=[],is=0,ur=null,fa=1,ma="";function dr(s,i){co[uo++]=Qu,co[uo++]=Ku,Ku=s,Qu=i}function dy(s,i,l){as[is++]=fa,as[is++]=ma,as[is++]=ur,ur=s;var u=fa;s=ma;var m=32-hn(u)-1;u&=~(1<<m),l+=1;var g=32-hn(i)+m;if(30<g){var x=m-m%5;g=(u&(1<<x)-1).toString(32),u>>=x,m-=x,fa=1<<32-hn(i)+m|l<<m|u,ma=g+s}else fa=1<<g|l<<m|u,ma=s}function Vf(s){s.return!==null&&(dr(s,1),dy(s,1,0))}function Uf(s){for(;s===Ku;)Ku=co[--uo],co[uo]=null,Qu=co[--uo],co[uo]=null;for(;s===ur;)ur=as[--is],as[is]=null,ma=as[--is],as[is]=null,fa=as[--is],as[is]=null}var xn=null,bt=null,tt=!1,hr=null,Ls=!1,Ff=Error(a(519));function fr(s){var i=Error(a(418,""));throw ql(ns(i,s)),Ff}function hy(s){var i=s.stateNode,l=s.type,u=s.memoizedProps;switch(i[Pt]=s,i[wt]=u,l){case"dialog":Be("cancel",i),Be("close",i);break;case"iframe":case"object":case"embed":Be("load",i);break;case"video":case"audio":for(l=0;l<dc.length;l++)Be(dc[l],i);break;case"source":Be("error",i);break;case"img":case"image":case"link":Be("error",i),Be("load",i);break;case"details":Be("toggle",i);break;case"input":Be("invalid",i),Wi(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Kr(i);break;case"select":Be("invalid",i);break;case"textarea":Be("invalid",i),Zi(i,u.value,u.defaultValue,u.children),Kr(i)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||u.suppressHydrationWarning===!0||wE(i.textContent,l)?(u.popover!=null&&(Be("beforetoggle",i),Be("toggle",i)),u.onScroll!=null&&Be("scroll",i),u.onScrollEnd!=null&&Be("scrollend",i),u.onClick!=null&&(i.onclick=wd),i=!0):i=!1,i||fr(s)}function fy(s){for(xn=s.return;xn;)switch(xn.tag){case 5:case 13:Ls=!1;return;case 27:case 3:Ls=!0;return;default:xn=xn.return}}function Ul(s){if(s!==xn)return!1;if(!tt)return fy(s),tt=!0,!1;var i=s.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||np(s.type,s.memoizedProps)),l=!l),l&&bt&&fr(s),fy(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(i===0){bt=vs(s.nextSibling);break e}i--}else l!=="$"&&l!=="$!"&&l!=="$?"||i++;s=s.nextSibling}bt=null}}else i===27?(i=bt,ri(s.type)?(s=rp,rp=null,bt=s):bt=i):bt=xn?vs(s.stateNode.nextSibling):null;return!0}function Fl(){bt=xn=null,tt=!1}function my(){var s=hr;return s!==null&&(In===null?In=s:In.push.apply(In,s),hr=null),s}function ql(s){hr===null?hr=[s]:hr.push(s)}var qf=ne(null),mr=null,pa=null;function Ga(s,i,l){ue(qf,i._currentValue),i._currentValue=l}function ga(s){s._currentValue=qf.current,he(qf)}function Bf(s,i,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),s===l)break;s=s.return}}function Hf(s,i,l,u){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var g=m.dependencies;if(g!==null){var x=m.child;g=g.firstContext;e:for(;g!==null;){var S=g;g=m;for(var q=0;q<i.length;q++)if(S.context===i[q]){g.lanes|=l,S=g.alternate,S!==null&&(S.lanes|=l),Bf(g.return,l,s),u||(x=null);break e}g=S.next}}else if(m.tag===18){if(x=m.return,x===null)throw Error(a(341));x.lanes|=l,g=x.alternate,g!==null&&(g.lanes|=l),Bf(x,l,s),x=null}else x=m.child;if(x!==null)x.return=m;else for(x=m;x!==null;){if(x===s){x=null;break}if(m=x.sibling,m!==null){m.return=x.return,x=m;break}x=x.return}m=x}}function Bl(s,i,l,u){s=null;for(var m=i,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var x=m.alternate;if(x===null)throw Error(a(387));if(x=x.memoizedProps,x!==null){var S=m.type;Ln(m.pendingProps.value,x.value)||(s!==null?s.push(S):s=[S])}}else if(m===Gt.current){if(x=m.alternate,x===null)throw Error(a(387));x.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(vc):s=[vc])}m=m.return}s!==null&&Hf(i,s,l,u),i.flags|=262144}function Xu(s){for(s=s.firstContext;s!==null;){if(!Ln(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function pr(s){mr=s,pa=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function fn(s){return py(mr,s)}function Wu(s,i){return mr===null&&pr(s),py(s,i)}function py(s,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},pa===null){if(s===null)throw Error(a(308));pa=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else pa=pa.next=i;return l}var kj=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){i.aborted=!0,s.forEach(function(l){return l()})}},Lj=n.unstable_scheduleCallback,Vj=n.unstable_NormalPriority,Vt={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zf(){return{controller:new kj,data:new Map,refCount:0}}function Hl(s){s.refCount--,s.refCount===0&&Lj(Vj,function(){s.controller.abort()})}var zl=null,Gf=0,ho=0,fo=null;function Uj(s,i){if(zl===null){var l=zl=[];Gf=0,ho=Ym(),fo={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Gf++,i.then(gy,gy),i}function gy(){if(--Gf===0&&zl!==null){fo!==null&&(fo.status="fulfilled");var s=zl;zl=null,ho=0,fo=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function Fj(s,i){var l=[],u={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return s.then(function(){u.status="fulfilled",u.value=i;for(var m=0;m<l.length;m++)(0,l[m])(i)},function(m){for(u.status="rejected",u.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),u}var vy=H.S;H.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&Uj(s,i),vy!==null&&vy(s,i)};var gr=ne(null);function $f(){var s=gr.current;return s!==null?s:mt.pooledCache}function Zu(s,i){i===null?ue(gr,gr.current):ue(gr,i.pool)}function yy(){var s=$f();return s===null?null:{parent:Vt._currentValue,pool:s}}var Gl=Error(a(460)),_y=Error(a(474)),Ju=Error(a(542)),Yf={then:function(){}};function Ey(s){return s=s.status,s==="fulfilled"||s==="rejected"}function ed(){}function by(s,i,l){switch(l=s[l],l===void 0?s.push(i):l!==i&&(i.then(ed,ed),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,xy(s),s;default:if(typeof i.status=="string")i.then(ed,ed);else{if(s=mt,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=i,s.status="pending",s.then(function(u){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=u}},function(u){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,xy(s),s}throw $l=i,Gl}}var $l=null;function Ny(){if($l===null)throw Error(a(459));var s=$l;return $l=null,s}function xy(s){if(s===Gl||s===Ju)throw Error(a(483))}var $a=!1;function Kf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qf(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ya(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ka(s,i,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(at&2)!==0){var m=u.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),u.pending=i,i=$u(s),cy(s,null,l),i}return Gu(s,u,i,l),$u(s)}function Yl(s,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,bl(s,l)}}function Xf(s,i){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var m=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var x={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?m=g=x:g=g.next=x,l=l.next}while(l!==null);g===null?m=g=i:g=g.next=i}else m=g=i;l={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=i:s.next=i,l.lastBaseUpdate=i}var Wf=!1;function Kl(){if(Wf){var s=fo;if(s!==null)throw s}}function Ql(s,i,l,u){Wf=!1;var m=s.updateQueue;$a=!1;var g=m.firstBaseUpdate,x=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var q=S,W=q.next;q.next=null,x===null?g=W:x.next=W,x=q;var se=s.alternate;se!==null&&(se=se.updateQueue,S=se.lastBaseUpdate,S!==x&&(S===null?se.firstBaseUpdate=W:S.next=W,se.lastBaseUpdate=q))}if(g!==null){var oe=m.baseState;x=0,se=W=q=null,S=g;do{var Z=S.lane&-536870913,ee=Z!==S.lane;if(ee?(Xe&Z)===Z:(u&Z)===Z){Z!==0&&Z===ho&&(Wf=!0),se!==null&&(se=se.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var we=s,Ae=S;Z=i;var ct=l;switch(Ae.tag){case 1:if(we=Ae.payload,typeof we=="function"){oe=we.call(ct,oe,Z);break e}oe=we;break e;case 3:we.flags=we.flags&-65537|128;case 0:if(we=Ae.payload,Z=typeof we=="function"?we.call(ct,oe,Z):we,Z==null)break e;oe=_({},oe,Z);break e;case 2:$a=!0}}Z=S.callback,Z!==null&&(s.flags|=64,ee&&(s.flags|=8192),ee=m.callbacks,ee===null?m.callbacks=[Z]:ee.push(Z))}else ee={lane:Z,tag:S.tag,payload:S.payload,callback:S.callback,next:null},se===null?(W=se=ee,q=oe):se=se.next=ee,x|=Z;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;ee=S,S=ee.next,ee.next=null,m.lastBaseUpdate=ee,m.shared.pending=null}}while(!0);se===null&&(q=oe),m.baseState=q,m.firstBaseUpdate=W,m.lastBaseUpdate=se,g===null&&(m.shared.lanes=0),ni|=x,s.lanes=x,s.memoizedState=oe}}function Ty(s,i){if(typeof s!="function")throw Error(a(191,s));s.call(i)}function Ay(s,i){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)Ty(l[s],i)}var mo=ne(null),td=ne(0);function jy(s,i){s=xa,ue(td,s),ue(mo,i),xa=s|i.baseLanes}function Zf(){ue(td,xa),ue(mo,mo.current)}function Jf(){xa=td.current,he(mo),he(td)}var Qa=0,Le=null,ot=null,Rt=null,nd=!1,po=!1,vr=!1,sd=0,Xl=0,go=null,qj=0;function jt(){throw Error(a(321))}function em(s,i){if(i===null)return!1;for(var l=0;l<i.length&&l<s.length;l++)if(!Ln(s[l],i[l]))return!1;return!0}function tm(s,i,l,u,m,g){return Qa=g,Le=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,H.H=s===null||s.memoizedState===null?c_:u_,vr=!1,g=l(u,m),vr=!1,po&&(g=Sy(i,l,u,m)),Cy(s),g}function Cy(s){H.H=cd;var i=ot!==null&&ot.next!==null;if(Qa=0,Rt=ot=Le=null,nd=!1,Xl=0,go=null,i)throw Error(a(300));s===null||Kt||(s=s.dependencies,s!==null&&Xu(s)&&(Kt=!0))}function Sy(s,i,l,u){Le=s;var m=0;do{if(po&&(go=null),Xl=0,po=!1,25<=m)throw Error(a(301));if(m+=1,Rt=ot=null,s.updateQueue!=null){var g=s.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}H.H=Kj,g=i(l,u)}while(po);return g}function Bj(){var s=H.H,i=s.useState()[0];return i=typeof i.then=="function"?Wl(i):i,s=s.useState()[0],(ot!==null?ot.memoizedState:null)!==s&&(Le.flags|=1024),i}function nm(){var s=sd!==0;return sd=0,s}function sm(s,i,l){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~l}function am(s){if(nd){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}nd=!1}Qa=0,Rt=ot=Le=null,po=!1,Xl=sd=0,go=null}function Sn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?Le.memoizedState=Rt=s:Rt=Rt.next=s,Rt}function Dt(){if(ot===null){var s=Le.alternate;s=s!==null?s.memoizedState:null}else s=ot.next;var i=Rt===null?Le.memoizedState:Rt.next;if(i!==null)Rt=i,ot=s;else{if(s===null)throw Le.alternate===null?Error(a(467)):Error(a(310));ot=s,s={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},Rt===null?Le.memoizedState=Rt=s:Rt=Rt.next=s}return Rt}function im(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wl(s){var i=Xl;return Xl+=1,go===null&&(go=[]),s=by(go,s,i),i=Le,(Rt===null?i.memoizedState:Rt.next)===null&&(i=i.alternate,H.H=i===null||i.memoizedState===null?c_:u_),s}function ad(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Wl(s);if(s.$$typeof===O)return fn(s)}throw Error(a(438,String(s)))}function rm(s){var i=null,l=Le.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var u=Le.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=im(),Le.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(s),u=0;u<s;u++)l[u]=I;return i.index++,l}function va(s,i){return typeof i=="function"?i(s):i}function id(s){var i=Dt();return om(i,ot,s)}function om(s,i,l){var u=s.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=l;var m=s.baseQueue,g=u.pending;if(g!==null){if(m!==null){var x=m.next;m.next=g.next,g.next=x}i.baseQueue=m=g,u.pending=null}if(g=s.baseState,m===null)s.memoizedState=g;else{i=m.next;var S=x=null,q=null,W=i,se=!1;do{var oe=W.lane&-536870913;if(oe!==W.lane?(Xe&oe)===oe:(Qa&oe)===oe){var Z=W.revertLane;if(Z===0)q!==null&&(q=q.next={lane:0,revertLane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),oe===ho&&(se=!0);else if((Qa&Z)===Z){W=W.next,Z===ho&&(se=!0);continue}else oe={lane:0,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},q===null?(S=q=oe,x=g):q=q.next=oe,Le.lanes|=Z,ni|=Z;oe=W.action,vr&&l(g,oe),g=W.hasEagerState?W.eagerState:l(g,oe)}else Z={lane:oe,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},q===null?(S=q=Z,x=g):q=q.next=Z,Le.lanes|=oe,ni|=oe;W=W.next}while(W!==null&&W!==i);if(q===null?x=g:q.next=S,!Ln(g,s.memoizedState)&&(Kt=!0,se&&(l=fo,l!==null)))throw l;s.memoizedState=g,s.baseState=x,s.baseQueue=q,u.lastRenderedState=g}return m===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function lm(s){var i=Dt(),l=i.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=s;var u=l.dispatch,m=l.pending,g=i.memoizedState;if(m!==null){l.pending=null;var x=m=m.next;do g=s(g,x.action),x=x.next;while(x!==m);Ln(g,i.memoizedState)||(Kt=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),l.lastRenderedState=g}return[g,u]}function wy(s,i,l){var u=Le,m=Dt(),g=tt;if(g){if(l===void 0)throw Error(a(407));l=l()}else l=i();var x=!Ln((ot||m).memoizedState,l);x&&(m.memoizedState=l,Kt=!0),m=m.queue;var S=Dy.bind(null,u,m,s);if(Zl(2048,8,S,[s]),m.getSnapshot!==i||x||Rt!==null&&Rt.memoizedState.tag&1){if(u.flags|=2048,vo(9,rd(),Ry.bind(null,u,m,l,i),null),mt===null)throw Error(a(349));g||(Qa&124)!==0||Iy(u,i,l)}return l}function Iy(s,i,l){s.flags|=16384,s={getSnapshot:i,value:l},i=Le.updateQueue,i===null?(i=im(),Le.updateQueue=i,i.stores=[s]):(l=i.stores,l===null?i.stores=[s]:l.push(s))}function Ry(s,i,l,u){i.value=l,i.getSnapshot=u,Oy(i)&&My(s)}function Dy(s,i,l){return l(function(){Oy(i)&&My(s)})}function Oy(s){var i=s.getSnapshot;s=s.value;try{var l=i();return!Ln(s,l)}catch{return!0}}function My(s){var i=oo(s,2);i!==null&&Hn(i,s,2)}function cm(s){var i=Sn();if(typeof s=="function"){var l=s;if(s=l(),vr){Pn(!0);try{l()}finally{Pn(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:s},i}function Py(s,i,l,u){return s.baseState=l,om(s,ot,typeof u=="function"?u:va)}function Hj(s,i,l,u,m){if(ld(s))throw Error(a(485));if(s=i.action,s!==null){var g={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){g.listeners.push(x)}};H.T!==null?l(!0):g.isTransition=!1,u(g),l=i.pending,l===null?(g.next=i.pending=g,ky(i,g)):(g.next=l.next,i.pending=l.next=g)}}function ky(s,i){var l=i.action,u=i.payload,m=s.state;if(i.isTransition){var g=H.T,x={};H.T=x;try{var S=l(m,u),q=H.S;q!==null&&q(x,S),Ly(s,i,S)}catch(W){um(s,i,W)}finally{H.T=g}}else try{g=l(m,u),Ly(s,i,g)}catch(W){um(s,i,W)}}function Ly(s,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Vy(s,i,u)},function(u){return um(s,i,u)}):Vy(s,i,l)}function Vy(s,i,l){i.status="fulfilled",i.value=l,Uy(i),s.state=l,i=s.pending,i!==null&&(l=i.next,l===i?s.pending=null:(l=l.next,i.next=l,ky(s,l)))}function um(s,i,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=l,Uy(i),i=i.next;while(i!==u)}s.action=null}function Uy(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function Fy(s,i){return i}function qy(s,i){if(tt){var l=mt.formState;if(l!==null){e:{var u=Le;if(tt){if(bt){t:{for(var m=bt,g=Ls;m.nodeType!==8;){if(!g){m=null;break t}if(m=vs(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){bt=vs(m.nextSibling),u=m.data==="F!";break e}}fr(u)}u=!1}u&&(i=l[0])}}return l=Sn(),l.memoizedState=l.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fy,lastRenderedState:i},l.queue=u,l=r_.bind(null,Le,u),u.dispatch=l,u=cm(!1),g=pm.bind(null,Le,!1,u.queue),u=Sn(),m={state:i,dispatch:null,action:s,pending:null},u.queue=m,l=Hj.bind(null,Le,m,g,l),m.dispatch=l,u.memoizedState=s,[i,l,!1]}function By(s){var i=Dt();return Hy(i,ot,s)}function Hy(s,i,l){if(i=om(s,i,Fy)[0],s=id(va)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Wl(i)}catch(x){throw x===Gl?Ju:x}else u=i;i=Dt();var m=i.queue,g=m.dispatch;return l!==i.memoizedState&&(Le.flags|=2048,vo(9,rd(),zj.bind(null,m,l),null)),[u,g,s]}function zj(s,i){s.action=i}function zy(s){var i=Dt(),l=ot;if(l!==null)return Hy(i,l,s);Dt(),i=i.memoizedState,l=Dt();var u=l.queue.dispatch;return l.memoizedState=s,[i,u,!1]}function vo(s,i,l,u){return s={tag:s,create:l,deps:u,inst:i,next:null},i=Le.updateQueue,i===null&&(i=im(),Le.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,i.lastEffect=s),s}function rd(){return{destroy:void 0,resource:void 0}}function Gy(){return Dt().memoizedState}function od(s,i,l,u){var m=Sn();u=u===void 0?null:u,Le.flags|=s,m.memoizedState=vo(1|i,rd(),l,u)}function Zl(s,i,l,u){var m=Dt();u=u===void 0?null:u;var g=m.memoizedState.inst;ot!==null&&u!==null&&em(u,ot.memoizedState.deps)?m.memoizedState=vo(i,g,l,u):(Le.flags|=s,m.memoizedState=vo(1|i,g,l,u))}function $y(s,i){od(8390656,8,s,i)}function Yy(s,i){Zl(2048,8,s,i)}function Ky(s,i){return Zl(4,2,s,i)}function Qy(s,i){return Zl(4,4,s,i)}function Xy(s,i){if(typeof i=="function"){s=s();var l=i(s);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Wy(s,i,l){l=l!=null?l.concat([s]):null,Zl(4,4,Xy.bind(null,i,s),l)}function dm(){}function Zy(s,i){var l=Dt();i=i===void 0?null:i;var u=l.memoizedState;return i!==null&&em(i,u[1])?u[0]:(l.memoizedState=[s,i],s)}function Jy(s,i){var l=Dt();i=i===void 0?null:i;var u=l.memoizedState;if(i!==null&&em(i,u[1]))return u[0];if(u=s(),vr){Pn(!0);try{s()}finally{Pn(!1)}}return l.memoizedState=[u,i],u}function hm(s,i,l){return l===void 0||(Qa&1073741824)!==0?s.memoizedState=i:(s.memoizedState=l,s=nE(),Le.lanes|=s,ni|=s,l)}function e_(s,i,l,u){return Ln(l,i)?l:mo.current!==null?(s=hm(s,l,u),Ln(s,i)||(Kt=!0),s):(Qa&42)===0?(Kt=!0,s.memoizedState=l):(s=nE(),Le.lanes|=s,ni|=s,i)}function t_(s,i,l,u,m){var g=J.p;J.p=g!==0&&8>g?g:8;var x=H.T,S={};H.T=S,pm(s,!1,i,l);try{var q=m(),W=H.S;if(W!==null&&W(S,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var se=Fj(q,u);Jl(s,i,se,Bn(s))}else Jl(s,i,u,Bn(s))}catch(oe){Jl(s,i,{then:function(){},status:"rejected",reason:oe},Bn())}finally{J.p=g,H.T=x}}function Gj(){}function fm(s,i,l,u){if(s.tag!==5)throw Error(a(476));var m=n_(s).queue;t_(s,m,i,ce,l===null?Gj:function(){return s_(s),l(u)})}function n_(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:ce},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:l},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function s_(s){var i=n_(s).next.queue;Jl(s,i,{},Bn())}function mm(){return fn(vc)}function a_(){return Dt().memoizedState}function i_(){return Dt().memoizedState}function $j(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var l=Bn();s=Ya(l);var u=Ka(i,s,l);u!==null&&(Hn(u,i,l),Yl(u,i,l)),i={cache:zf()},s.payload=i;return}i=i.return}}function Yj(s,i,l){var u=Bn();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},ld(s)?o_(i,l):(l=Mf(s,i,l,u),l!==null&&(Hn(l,s,u),l_(l,i,u)))}function r_(s,i,l){var u=Bn();Jl(s,i,l,u)}function Jl(s,i,l,u){var m={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(ld(s))o_(i,m);else{var g=s.alternate;if(s.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var x=i.lastRenderedState,S=g(x,l);if(m.hasEagerState=!0,m.eagerState=S,Ln(S,x))return Gu(s,i,m,0),mt===null&&zu(),!1}catch{}finally{}if(l=Mf(s,i,m,u),l!==null)return Hn(l,s,u),l_(l,i,u),!0}return!1}function pm(s,i,l,u){if(u={lane:2,revertLane:Ym(),action:u,hasEagerState:!1,eagerState:null,next:null},ld(s)){if(i)throw Error(a(479))}else i=Mf(s,l,u,2),i!==null&&Hn(i,s,2)}function ld(s){var i=s.alternate;return s===Le||i!==null&&i===Le}function o_(s,i){po=nd=!0;var l=s.pending;l===null?i.next=i:(i.next=l.next,l.next=i),s.pending=i}function l_(s,i,l){if((l&4194048)!==0){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,bl(s,l)}}var cd={readContext:fn,use:ad,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useLayoutEffect:jt,useInsertionEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useSyncExternalStore:jt,useId:jt,useHostTransitionStatus:jt,useFormState:jt,useActionState:jt,useOptimistic:jt,useMemoCache:jt,useCacheRefresh:jt},c_={readContext:fn,use:ad,useCallback:function(s,i){return Sn().memoizedState=[s,i===void 0?null:i],s},useContext:fn,useEffect:$y,useImperativeHandle:function(s,i,l){l=l!=null?l.concat([s]):null,od(4194308,4,Xy.bind(null,i,s),l)},useLayoutEffect:function(s,i){return od(4194308,4,s,i)},useInsertionEffect:function(s,i){od(4,2,s,i)},useMemo:function(s,i){var l=Sn();i=i===void 0?null:i;var u=s();if(vr){Pn(!0);try{s()}finally{Pn(!1)}}return l.memoizedState=[u,i],u},useReducer:function(s,i,l){var u=Sn();if(l!==void 0){var m=l(i);if(vr){Pn(!0);try{l(i)}finally{Pn(!1)}}}else m=i;return u.memoizedState=u.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},u.queue=s,s=s.dispatch=Yj.bind(null,Le,s),[u.memoizedState,s]},useRef:function(s){var i=Sn();return s={current:s},i.memoizedState=s},useState:function(s){s=cm(s);var i=s.queue,l=r_.bind(null,Le,i);return i.dispatch=l,[s.memoizedState,l]},useDebugValue:dm,useDeferredValue:function(s,i){var l=Sn();return hm(l,s,i)},useTransition:function(){var s=cm(!1);return s=t_.bind(null,Le,s.queue,!0,!1),Sn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,l){var u=Le,m=Sn();if(tt){if(l===void 0)throw Error(a(407));l=l()}else{if(l=i(),mt===null)throw Error(a(349));(Xe&124)!==0||Iy(u,i,l)}m.memoizedState=l;var g={value:l,getSnapshot:i};return m.queue=g,$y(Dy.bind(null,u,g,s),[s]),u.flags|=2048,vo(9,rd(),Ry.bind(null,u,g,l,i),null),l},useId:function(){var s=Sn(),i=mt.identifierPrefix;if(tt){var l=ma,u=fa;l=(u&~(1<<32-hn(u)-1)).toString(32)+l,i="«"+i+"R"+l,l=sd++,0<l&&(i+="H"+l.toString(32)),i+="»"}else l=qj++,i="«"+i+"r"+l.toString(32)+"»";return s.memoizedState=i},useHostTransitionStatus:mm,useFormState:qy,useActionState:qy,useOptimistic:function(s){var i=Sn();i.memoizedState=i.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=pm.bind(null,Le,!0,l),l.dispatch=i,[s,i]},useMemoCache:rm,useCacheRefresh:function(){return Sn().memoizedState=$j.bind(null,Le)}},u_={readContext:fn,use:ad,useCallback:Zy,useContext:fn,useEffect:Yy,useImperativeHandle:Wy,useInsertionEffect:Ky,useLayoutEffect:Qy,useMemo:Jy,useReducer:id,useRef:Gy,useState:function(){return id(va)},useDebugValue:dm,useDeferredValue:function(s,i){var l=Dt();return e_(l,ot.memoizedState,s,i)},useTransition:function(){var s=id(va)[0],i=Dt().memoizedState;return[typeof s=="boolean"?s:Wl(s),i]},useSyncExternalStore:wy,useId:a_,useHostTransitionStatus:mm,useFormState:By,useActionState:By,useOptimistic:function(s,i){var l=Dt();return Py(l,ot,s,i)},useMemoCache:rm,useCacheRefresh:i_},Kj={readContext:fn,use:ad,useCallback:Zy,useContext:fn,useEffect:Yy,useImperativeHandle:Wy,useInsertionEffect:Ky,useLayoutEffect:Qy,useMemo:Jy,useReducer:lm,useRef:Gy,useState:function(){return lm(va)},useDebugValue:dm,useDeferredValue:function(s,i){var l=Dt();return ot===null?hm(l,s,i):e_(l,ot.memoizedState,s,i)},useTransition:function(){var s=lm(va)[0],i=Dt().memoizedState;return[typeof s=="boolean"?s:Wl(s),i]},useSyncExternalStore:wy,useId:a_,useHostTransitionStatus:mm,useFormState:zy,useActionState:zy,useOptimistic:function(s,i){var l=Dt();return ot!==null?Py(l,ot,s,i):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:rm,useCacheRefresh:i_},yo=null,ec=0;function ud(s){var i=ec;return ec+=1,yo===null&&(yo=[]),by(yo,s,i)}function tc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function dd(s,i){throw i.$$typeof===N?Error(a(525)):(s=Object.prototype.toString.call(i),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function d_(s){var i=s._init;return i(s._payload)}function h_(s){function i(G,z){if(s){var Q=G.deletions;Q===null?(G.deletions=[z],G.flags|=16):Q.push(z)}}function l(G,z){if(!s)return null;for(;z!==null;)i(G,z),z=z.sibling;return null}function u(G){for(var z=new Map;G!==null;)G.key!==null?z.set(G.key,G):z.set(G.index,G),G=G.sibling;return z}function m(G,z){return G=ha(G,z),G.index=0,G.sibling=null,G}function g(G,z,Q){return G.index=Q,s?(Q=G.alternate,Q!==null?(Q=Q.index,Q<z?(G.flags|=67108866,z):Q):(G.flags|=67108866,z)):(G.flags|=1048576,z)}function x(G){return s&&G.alternate===null&&(G.flags|=67108866),G}function S(G,z,Q,ie){return z===null||z.tag!==6?(z=kf(Q,G.mode,ie),z.return=G,z):(z=m(z,Q),z.return=G,z)}function q(G,z,Q,ie){var ye=Q.type;return ye===b?se(G,z,Q.props.children,ie,Q.key):z!==null&&(z.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===A&&d_(ye)===z.type)?(z=m(z,Q.props),tc(z,Q),z.return=G,z):(z=Yu(Q.type,Q.key,Q.props,null,G.mode,ie),tc(z,Q),z.return=G,z)}function W(G,z,Q,ie){return z===null||z.tag!==4||z.stateNode.containerInfo!==Q.containerInfo||z.stateNode.implementation!==Q.implementation?(z=Lf(Q,G.mode,ie),z.return=G,z):(z=m(z,Q.children||[]),z.return=G,z)}function se(G,z,Q,ie,ye){return z===null||z.tag!==7?(z=cr(Q,G.mode,ie,ye),z.return=G,z):(z=m(z,Q),z.return=G,z)}function oe(G,z,Q){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=kf(""+z,G.mode,Q),z.return=G,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case j:return Q=Yu(z.type,z.key,z.props,null,G.mode,Q),tc(Q,z),Q.return=G,Q;case C:return z=Lf(z,G.mode,Q),z.return=G,z;case A:var ie=z._init;return z=ie(z._payload),oe(G,z,Q)}if(ae(z)||V(z))return z=cr(z,G.mode,Q,null),z.return=G,z;if(typeof z.then=="function")return oe(G,ud(z),Q);if(z.$$typeof===O)return oe(G,Wu(G,z),Q);dd(G,z)}return null}function Z(G,z,Q,ie){var ye=z!==null?z.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return ye!==null?null:S(G,z,""+Q,ie);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case j:return Q.key===ye?q(G,z,Q,ie):null;case C:return Q.key===ye?W(G,z,Q,ie):null;case A:return ye=Q._init,Q=ye(Q._payload),Z(G,z,Q,ie)}if(ae(Q)||V(Q))return ye!==null?null:se(G,z,Q,ie,null);if(typeof Q.then=="function")return Z(G,z,ud(Q),ie);if(Q.$$typeof===O)return Z(G,z,Wu(G,Q),ie);dd(G,Q)}return null}function ee(G,z,Q,ie,ye){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return G=G.get(Q)||null,S(z,G,""+ie,ye);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case j:return G=G.get(ie.key===null?Q:ie.key)||null,q(z,G,ie,ye);case C:return G=G.get(ie.key===null?Q:ie.key)||null,W(z,G,ie,ye);case A:var Fe=ie._init;return ie=Fe(ie._payload),ee(G,z,Q,ie,ye)}if(ae(ie)||V(ie))return G=G.get(Q)||null,se(z,G,ie,ye,null);if(typeof ie.then=="function")return ee(G,z,Q,ud(ie),ye);if(ie.$$typeof===O)return ee(G,z,Q,Wu(z,ie),ye);dd(z,ie)}return null}function we(G,z,Q,ie){for(var ye=null,Fe=null,_e=z,je=z=0,Xt=null;_e!==null&&je<Q.length;je++){_e.index>je?(Xt=_e,_e=null):Xt=_e.sibling;var Je=Z(G,_e,Q[je],ie);if(Je===null){_e===null&&(_e=Xt);break}s&&_e&&Je.alternate===null&&i(G,_e),z=g(Je,z,je),Fe===null?ye=Je:Fe.sibling=Je,Fe=Je,_e=Xt}if(je===Q.length)return l(G,_e),tt&&dr(G,je),ye;if(_e===null){for(;je<Q.length;je++)_e=oe(G,Q[je],ie),_e!==null&&(z=g(_e,z,je),Fe===null?ye=_e:Fe.sibling=_e,Fe=_e);return tt&&dr(G,je),ye}for(_e=u(_e);je<Q.length;je++)Xt=ee(_e,G,je,Q[je],ie),Xt!==null&&(s&&Xt.alternate!==null&&_e.delete(Xt.key===null?je:Xt.key),z=g(Xt,z,je),Fe===null?ye=Xt:Fe.sibling=Xt,Fe=Xt);return s&&_e.forEach(function(di){return i(G,di)}),tt&&dr(G,je),ye}function Ae(G,z,Q,ie){if(Q==null)throw Error(a(151));for(var ye=null,Fe=null,_e=z,je=z=0,Xt=null,Je=Q.next();_e!==null&&!Je.done;je++,Je=Q.next()){_e.index>je?(Xt=_e,_e=null):Xt=_e.sibling;var di=Z(G,_e,Je.value,ie);if(di===null){_e===null&&(_e=Xt);break}s&&_e&&di.alternate===null&&i(G,_e),z=g(di,z,je),Fe===null?ye=di:Fe.sibling=di,Fe=di,_e=Xt}if(Je.done)return l(G,_e),tt&&dr(G,je),ye;if(_e===null){for(;!Je.done;je++,Je=Q.next())Je=oe(G,Je.value,ie),Je!==null&&(z=g(Je,z,je),Fe===null?ye=Je:Fe.sibling=Je,Fe=Je);return tt&&dr(G,je),ye}for(_e=u(_e);!Je.done;je++,Je=Q.next())Je=ee(_e,G,je,Je.value,ie),Je!==null&&(s&&Je.alternate!==null&&_e.delete(Je.key===null?je:Je.key),z=g(Je,z,je),Fe===null?ye=Je:Fe.sibling=Je,Fe=Je);return s&&_e.forEach(function(QC){return i(G,QC)}),tt&&dr(G,je),ye}function ct(G,z,Q,ie){if(typeof Q=="object"&&Q!==null&&Q.type===b&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case j:e:{for(var ye=Q.key;z!==null;){if(z.key===ye){if(ye=Q.type,ye===b){if(z.tag===7){l(G,z.sibling),ie=m(z,Q.props.children),ie.return=G,G=ie;break e}}else if(z.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===A&&d_(ye)===z.type){l(G,z.sibling),ie=m(z,Q.props),tc(ie,Q),ie.return=G,G=ie;break e}l(G,z);break}else i(G,z);z=z.sibling}Q.type===b?(ie=cr(Q.props.children,G.mode,ie,Q.key),ie.return=G,G=ie):(ie=Yu(Q.type,Q.key,Q.props,null,G.mode,ie),tc(ie,Q),ie.return=G,G=ie)}return x(G);case C:e:{for(ye=Q.key;z!==null;){if(z.key===ye)if(z.tag===4&&z.stateNode.containerInfo===Q.containerInfo&&z.stateNode.implementation===Q.implementation){l(G,z.sibling),ie=m(z,Q.children||[]),ie.return=G,G=ie;break e}else{l(G,z);break}else i(G,z);z=z.sibling}ie=Lf(Q,G.mode,ie),ie.return=G,G=ie}return x(G);case A:return ye=Q._init,Q=ye(Q._payload),ct(G,z,Q,ie)}if(ae(Q))return we(G,z,Q,ie);if(V(Q)){if(ye=V(Q),typeof ye!="function")throw Error(a(150));return Q=ye.call(Q),Ae(G,z,Q,ie)}if(typeof Q.then=="function")return ct(G,z,ud(Q),ie);if(Q.$$typeof===O)return ct(G,z,Wu(G,Q),ie);dd(G,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,z!==null&&z.tag===6?(l(G,z.sibling),ie=m(z,Q),ie.return=G,G=ie):(l(G,z),ie=kf(Q,G.mode,ie),ie.return=G,G=ie),x(G)):l(G,z)}return function(G,z,Q,ie){try{ec=0;var ye=ct(G,z,Q,ie);return yo=null,ye}catch(_e){if(_e===Gl||_e===Ju)throw _e;var Fe=Vn(29,_e,null,G.mode);return Fe.lanes=ie,Fe.return=G,Fe}finally{}}}var _o=h_(!0),f_=h_(!1),rs=ne(null),Vs=null;function Xa(s){var i=s.alternate;ue(Ut,Ut.current&1),ue(rs,s),Vs===null&&(i===null||mo.current!==null||i.memoizedState!==null)&&(Vs=s)}function m_(s){if(s.tag===22){if(ue(Ut,Ut.current),ue(rs,s),Vs===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(Vs=s)}}else Wa()}function Wa(){ue(Ut,Ut.current),ue(rs,rs.current)}function ya(s){he(rs),Vs===s&&(Vs=null),he(Ut)}var Ut=ne(0);function hd(s){for(var i=s;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||ip(l)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function gm(s,i,l,u){i=s.memoizedState,l=l(u,i),l=l==null?i:_({},i,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var vm={enqueueSetState:function(s,i,l){s=s._reactInternals;var u=Bn(),m=Ya(u);m.payload=i,l!=null&&(m.callback=l),i=Ka(s,m,u),i!==null&&(Hn(i,s,u),Yl(i,s,u))},enqueueReplaceState:function(s,i,l){s=s._reactInternals;var u=Bn(),m=Ya(u);m.tag=1,m.payload=i,l!=null&&(m.callback=l),i=Ka(s,m,u),i!==null&&(Hn(i,s,u),Yl(i,s,u))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var l=Bn(),u=Ya(l);u.tag=2,i!=null&&(u.callback=i),i=Ka(s,u,l),i!==null&&(Hn(i,s,l),Yl(i,s,l))}};function p_(s,i,l,u,m,g,x){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,g,x):i.prototype&&i.prototype.isPureReactComponent?!Ll(l,u)||!Ll(m,g):!0}function g_(s,i,l,u){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,u),i.state!==s&&vm.enqueueReplaceState(i,i.state,null)}function yr(s,i){var l=i;if("ref"in i){l={};for(var u in i)u!=="ref"&&(l[u]=i[u])}if(s=s.defaultProps){l===i&&(l=_({},l));for(var m in s)l[m]===void 0&&(l[m]=s[m])}return l}var fd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function v_(s){fd(s)}function y_(s){console.error(s)}function __(s){fd(s)}function md(s,i){try{var l=s.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function E_(s,i,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function ym(s,i,l){return l=Ya(l),l.tag=3,l.payload={element:null},l.callback=function(){md(s,i)},l}function b_(s){return s=Ya(s),s.tag=3,s}function N_(s,i,l,u){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var g=u.value;s.payload=function(){return m(g)},s.callback=function(){E_(i,l,u)}}var x=l.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(s.callback=function(){E_(i,l,u),typeof m!="function"&&(si===null?si=new Set([this]):si.add(this));var S=u.stack;this.componentDidCatch(u.value,{componentStack:S!==null?S:""})})}function Qj(s,i,l,u,m){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=l.alternate,i!==null&&Bl(i,l,m,!0),l=rs.current,l!==null){switch(l.tag){case 13:return Vs===null?Bm():l.alternate===null&&Nt===0&&(Nt=3),l.flags&=-257,l.flags|=65536,l.lanes=m,u===Yf?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([u]):i.add(u),zm(s,u,m)),!1;case 22:return l.flags|=65536,u===Yf?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([u]):l.add(u)),zm(s,u,m)),!1}throw Error(a(435,l.tag))}return zm(s,u,m),Bm(),!1}if(tt)return i=rs.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,u!==Ff&&(s=Error(a(422),{cause:u}),ql(ns(s,l)))):(u!==Ff&&(i=Error(a(423),{cause:u}),ql(ns(i,l))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,u=ns(u,l),m=ym(s.stateNode,u,m),Xf(s,m),Nt!==4&&(Nt=2)),!1;var g=Error(a(520),{cause:u});if(g=ns(g,l),lc===null?lc=[g]:lc.push(g),Nt!==4&&(Nt=2),i===null)return!0;u=ns(u,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,s=m&-m,l.lanes|=s,s=ym(l.stateNode,u,s),Xf(l,s),!1;case 1:if(i=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(si===null||!si.has(g))))return l.flags|=65536,m&=-m,l.lanes|=m,m=b_(m),N_(m,s,l,u),Xf(l,m),!1}l=l.return}while(l!==null);return!1}var x_=Error(a(461)),Kt=!1;function tn(s,i,l,u){i.child=s===null?f_(i,null,l,u):_o(i,s.child,l,u)}function T_(s,i,l,u,m){l=l.render;var g=i.ref;if("ref"in u){var x={};for(var S in u)S!=="ref"&&(x[S]=u[S])}else x=u;return pr(i),u=tm(s,i,l,x,g,m),S=nm(),s!==null&&!Kt?(sm(s,i,m),_a(s,i,m)):(tt&&S&&Vf(i),i.flags|=1,tn(s,i,u,m),i.child)}function A_(s,i,l,u,m){if(s===null){var g=l.type;return typeof g=="function"&&!Pf(g)&&g.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=g,j_(s,i,g,u,m)):(s=Yu(l.type,null,u,i,i.mode,m),s.ref=i.ref,s.return=i,i.child=s)}if(g=s.child,!jm(s,m)){var x=g.memoizedProps;if(l=l.compare,l=l!==null?l:Ll,l(x,u)&&s.ref===i.ref)return _a(s,i,m)}return i.flags|=1,s=ha(g,u),s.ref=i.ref,s.return=i,i.child=s}function j_(s,i,l,u,m){if(s!==null){var g=s.memoizedProps;if(Ll(g,u)&&s.ref===i.ref)if(Kt=!1,i.pendingProps=u=g,jm(s,m))(s.flags&131072)!==0&&(Kt=!0);else return i.lanes=s.lanes,_a(s,i,m)}return _m(s,i,l,u,m)}function C_(s,i,l){var u=i.pendingProps,m=u.children,g=s!==null?s.memoizedState:null;if(u.mode==="hidden"){if((i.flags&128)!==0){if(u=g!==null?g.baseLanes|l:l,s!==null){for(m=i.child=s.child,g=0;m!==null;)g=g|m.lanes|m.childLanes,m=m.sibling;i.childLanes=g&~u}else i.childLanes=0,i.child=null;return S_(s,i,u,l)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&Zu(i,g!==null?g.cachePool:null),g!==null?jy(i,g):Zf(),m_(i);else return i.lanes=i.childLanes=536870912,S_(s,i,g!==null?g.baseLanes|l:l,l)}else g!==null?(Zu(i,g.cachePool),jy(i,g),Wa(),i.memoizedState=null):(s!==null&&Zu(i,null),Zf(),Wa());return tn(s,i,m,l),i.child}function S_(s,i,l,u){var m=$f();return m=m===null?null:{parent:Vt._currentValue,pool:m},i.memoizedState={baseLanes:l,cachePool:m},s!==null&&Zu(i,null),Zf(),m_(i),s!==null&&Bl(s,i,u,!0),null}function pd(s,i){var l=i.ref;if(l===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(a(284));(s===null||s.ref!==l)&&(i.flags|=4194816)}}function _m(s,i,l,u,m){return pr(i),l=tm(s,i,l,u,void 0,m),u=nm(),s!==null&&!Kt?(sm(s,i,m),_a(s,i,m)):(tt&&u&&Vf(i),i.flags|=1,tn(s,i,l,m),i.child)}function w_(s,i,l,u,m,g){return pr(i),i.updateQueue=null,l=Sy(i,u,l,m),Cy(s),u=nm(),s!==null&&!Kt?(sm(s,i,g),_a(s,i,g)):(tt&&u&&Vf(i),i.flags|=1,tn(s,i,l,g),i.child)}function I_(s,i,l,u,m){if(pr(i),i.stateNode===null){var g=lo,x=l.contextType;typeof x=="object"&&x!==null&&(g=fn(x)),g=new l(u,g),i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=vm,i.stateNode=g,g._reactInternals=i,g=i.stateNode,g.props=u,g.state=i.memoizedState,g.refs={},Kf(i),x=l.contextType,g.context=typeof x=="object"&&x!==null?fn(x):lo,g.state=i.memoizedState,x=l.getDerivedStateFromProps,typeof x=="function"&&(gm(i,l,x,u),g.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(x=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),x!==g.state&&vm.enqueueReplaceState(g,g.state,null),Ql(i,u,g,m),Kl(),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(s===null){g=i.stateNode;var S=i.memoizedProps,q=yr(l,S);g.props=q;var W=g.context,se=l.contextType;x=lo,typeof se=="object"&&se!==null&&(x=fn(se));var oe=l.getDerivedStateFromProps;se=typeof oe=="function"||typeof g.getSnapshotBeforeUpdate=="function",S=i.pendingProps!==S,se||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(S||W!==x)&&g_(i,g,u,x),$a=!1;var Z=i.memoizedState;g.state=Z,Ql(i,u,g,m),Kl(),W=i.memoizedState,S||Z!==W||$a?(typeof oe=="function"&&(gm(i,l,oe,u),W=i.memoizedState),(q=$a||p_(i,l,q,u,Z,W,x))?(se||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=W),g.props=u,g.state=W,g.context=x,u=q):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{g=i.stateNode,Qf(s,i),x=i.memoizedProps,se=yr(l,x),g.props=se,oe=i.pendingProps,Z=g.context,W=l.contextType,q=lo,typeof W=="object"&&W!==null&&(q=fn(W)),S=l.getDerivedStateFromProps,(W=typeof S=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(x!==oe||Z!==q)&&g_(i,g,u,q),$a=!1,Z=i.memoizedState,g.state=Z,Ql(i,u,g,m),Kl();var ee=i.memoizedState;x!==oe||Z!==ee||$a||s!==null&&s.dependencies!==null&&Xu(s.dependencies)?(typeof S=="function"&&(gm(i,l,S,u),ee=i.memoizedState),(se=$a||p_(i,l,se,u,Z,ee,q)||s!==null&&s.dependencies!==null&&Xu(s.dependencies))?(W||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,ee,q),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,ee,q)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||x===s.memoizedProps&&Z===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&Z===s.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=ee),g.props=u,g.state=ee,g.context=q,u=se):(typeof g.componentDidUpdate!="function"||x===s.memoizedProps&&Z===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&Z===s.memoizedState||(i.flags|=1024),u=!1)}return g=u,pd(s,i),u=(i.flags&128)!==0,g||u?(g=i.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),i.flags|=1,s!==null&&u?(i.child=_o(i,s.child,null,m),i.child=_o(i,null,l,m)):tn(s,i,l,m),i.memoizedState=g.state,s=i.child):s=_a(s,i,m),s}function R_(s,i,l,u){return Fl(),i.flags|=256,tn(s,i,l,u),i.child}var Em={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bm(s){return{baseLanes:s,cachePool:yy()}}function Nm(s,i,l){return s=s!==null?s.childLanes&~l:0,i&&(s|=os),s}function D_(s,i,l){var u=i.pendingProps,m=!1,g=(i.flags&128)!==0,x;if((x=g)||(x=s!==null&&s.memoizedState===null?!1:(Ut.current&2)!==0),x&&(m=!0,i.flags&=-129),x=(i.flags&32)!==0,i.flags&=-33,s===null){if(tt){if(m?Xa(i):Wa(),tt){var S=bt,q;if(q=S){e:{for(q=S,S=Ls;q.nodeType!==8;){if(!S){S=null;break e}if(q=vs(q.nextSibling),q===null){S=null;break e}}S=q}S!==null?(i.memoizedState={dehydrated:S,treeContext:ur!==null?{id:fa,overflow:ma}:null,retryLane:536870912,hydrationErrors:null},q=Vn(18,null,null,0),q.stateNode=S,q.return=i,i.child=q,xn=i,bt=null,q=!0):q=!1}q||fr(i)}if(S=i.memoizedState,S!==null&&(S=S.dehydrated,S!==null))return ip(S)?i.lanes=32:i.lanes=536870912,null;ya(i)}return S=u.children,u=u.fallback,m?(Wa(),m=i.mode,S=gd({mode:"hidden",children:S},m),u=cr(u,m,l,null),S.return=i,u.return=i,S.sibling=u,i.child=S,m=i.child,m.memoizedState=bm(l),m.childLanes=Nm(s,x,l),i.memoizedState=Em,u):(Xa(i),xm(i,S))}if(q=s.memoizedState,q!==null&&(S=q.dehydrated,S!==null)){if(g)i.flags&256?(Xa(i),i.flags&=-257,i=Tm(s,i,l)):i.memoizedState!==null?(Wa(),i.child=s.child,i.flags|=128,i=null):(Wa(),m=u.fallback,S=i.mode,u=gd({mode:"visible",children:u.children},S),m=cr(m,S,l,null),m.flags|=2,u.return=i,m.return=i,u.sibling=m,i.child=u,_o(i,s.child,null,l),u=i.child,u.memoizedState=bm(l),u.childLanes=Nm(s,x,l),i.memoizedState=Em,i=m);else if(Xa(i),ip(S)){if(x=S.nextSibling&&S.nextSibling.dataset,x)var W=x.dgst;x=W,u=Error(a(419)),u.stack="",u.digest=x,ql({value:u,source:null,stack:null}),i=Tm(s,i,l)}else if(Kt||Bl(s,i,l,!1),x=(l&s.childLanes)!==0,Kt||x){if(x=mt,x!==null&&(u=l&-l,u=(u&42)!==0?1:Va(u),u=(u&(x.suspendedLanes|l))!==0?0:u,u!==0&&u!==q.retryLane))throw q.retryLane=u,oo(s,u),Hn(x,s,u),x_;S.data==="$?"||Bm(),i=Tm(s,i,l)}else S.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=q.treeContext,bt=vs(S.nextSibling),xn=i,tt=!0,hr=null,Ls=!1,s!==null&&(as[is++]=fa,as[is++]=ma,as[is++]=ur,fa=s.id,ma=s.overflow,ur=i),i=xm(i,u.children),i.flags|=4096);return i}return m?(Wa(),m=u.fallback,S=i.mode,q=s.child,W=q.sibling,u=ha(q,{mode:"hidden",children:u.children}),u.subtreeFlags=q.subtreeFlags&65011712,W!==null?m=ha(W,m):(m=cr(m,S,l,null),m.flags|=2),m.return=i,u.return=i,u.sibling=m,i.child=u,u=m,m=i.child,S=s.child.memoizedState,S===null?S=bm(l):(q=S.cachePool,q!==null?(W=Vt._currentValue,q=q.parent!==W?{parent:W,pool:W}:q):q=yy(),S={baseLanes:S.baseLanes|l,cachePool:q}),m.memoizedState=S,m.childLanes=Nm(s,x,l),i.memoizedState=Em,u):(Xa(i),l=s.child,s=l.sibling,l=ha(l,{mode:"visible",children:u.children}),l.return=i,l.sibling=null,s!==null&&(x=i.deletions,x===null?(i.deletions=[s],i.flags|=16):x.push(s)),i.child=l,i.memoizedState=null,l)}function xm(s,i){return i=gd({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function gd(s,i){return s=Vn(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Tm(s,i,l){return _o(i,s.child,null,l),s=xm(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function O_(s,i,l){s.lanes|=i;var u=s.alternate;u!==null&&(u.lanes|=i),Bf(s.return,i,l)}function Am(s,i,l,u,m){var g=s.memoizedState;g===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:m}:(g.isBackwards=i,g.rendering=null,g.renderingStartTime=0,g.last=u,g.tail=l,g.tailMode=m)}function M_(s,i,l){var u=i.pendingProps,m=u.revealOrder,g=u.tail;if(tn(s,i,u.children,l),u=Ut.current,(u&2)!==0)u=u&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&O_(s,l,i);else if(s.tag===19)O_(s,l,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}u&=1}switch(ue(Ut,u),m){case"forwards":for(l=i.child,m=null;l!==null;)s=l.alternate,s!==null&&hd(s)===null&&(m=l),l=l.sibling;l=m,l===null?(m=i.child,i.child=null):(m=l.sibling,l.sibling=null),Am(i,!1,m,l,g);break;case"backwards":for(l=null,m=i.child,i.child=null;m!==null;){if(s=m.alternate,s!==null&&hd(s)===null){i.child=m;break}s=m.sibling,m.sibling=l,l=m,m=s}Am(i,!0,l,null,g);break;case"together":Am(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function _a(s,i,l){if(s!==null&&(i.dependencies=s.dependencies),ni|=i.lanes,(l&i.childLanes)===0)if(s!==null){if(Bl(s,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(a(153));if(i.child!==null){for(s=i.child,l=ha(s,s.pendingProps),i.child=l,l.return=i;s.sibling!==null;)s=s.sibling,l=l.sibling=ha(s,s.pendingProps),l.return=i;l.sibling=null}return i.child}function jm(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&Xu(s)))}function Xj(s,i,l){switch(i.tag){case 3:ft(i,i.stateNode.containerInfo),Ga(i,Vt,s.memoizedState.cache),Fl();break;case 27:case 5:La(i);break;case 4:ft(i,i.stateNode.containerInfo);break;case 10:Ga(i,i.type,i.memoizedProps.value);break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(Xa(i),i.flags|=128,null):(l&i.child.childLanes)!==0?D_(s,i,l):(Xa(i),s=_a(s,i,l),s!==null?s.sibling:null);Xa(i);break;case 19:var m=(s.flags&128)!==0;if(u=(l&i.childLanes)!==0,u||(Bl(s,i,l,!1),u=(l&i.childLanes)!==0),m){if(u)return M_(s,i,l);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ue(Ut,Ut.current),u)break;return null;case 22:case 23:return i.lanes=0,C_(s,i,l);case 24:Ga(i,Vt,s.memoizedState.cache)}return _a(s,i,l)}function P_(s,i,l){if(s!==null)if(s.memoizedProps!==i.pendingProps)Kt=!0;else{if(!jm(s,l)&&(i.flags&128)===0)return Kt=!1,Xj(s,i,l);Kt=(s.flags&131072)!==0}else Kt=!1,tt&&(i.flags&1048576)!==0&&dy(i,Qu,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var u=i.elementType,m=u._init;if(u=m(u._payload),i.type=u,typeof u=="function")Pf(u)?(s=yr(u,s),i.tag=1,i=I_(null,i,u,s,l)):(i.tag=0,i=_m(null,i,u,s,l));else{if(u!=null){if(m=u.$$typeof,m===U){i.tag=11,i=T_(null,i,u,s,l);break e}else if(m===w){i.tag=14,i=A_(null,i,u,s,l);break e}}throw i=ke(u)||u,Error(a(306,i,""))}}return i;case 0:return _m(s,i,i.type,i.pendingProps,l);case 1:return u=i.type,m=yr(u,i.pendingProps),I_(s,i,u,m,l);case 3:e:{if(ft(i,i.stateNode.containerInfo),s===null)throw Error(a(387));u=i.pendingProps;var g=i.memoizedState;m=g.element,Qf(s,i),Ql(i,u,null,l);var x=i.memoizedState;if(u=x.cache,Ga(i,Vt,u),u!==g.cache&&Hf(i,[Vt],l,!0),Kl(),u=x.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:x.cache},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){i=R_(s,i,u,l);break e}else if(u!==m){m=ns(Error(a(424)),i),ql(m),i=R_(s,i,u,l);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(bt=vs(s.firstChild),xn=i,tt=!0,hr=null,Ls=!0,l=f_(i,null,u,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Fl(),u===m){i=_a(s,i,l);break e}tn(s,i,u,l)}i=i.child}return i;case 26:return pd(s,i),s===null?(l=UE(i.type,null,i.pendingProps,null))?i.memoizedState=l:tt||(l=i.type,s=i.pendingProps,u=Id(Ie.current).createElement(l),u[Pt]=i,u[wt]=s,sn(u,l,s),At(u),i.stateNode=u):i.memoizedState=UE(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return La(i),s===null&&tt&&(u=i.stateNode=kE(i.type,i.pendingProps,Ie.current),xn=i,Ls=!0,m=bt,ri(i.type)?(rp=m,bt=vs(u.firstChild)):bt=m),tn(s,i,i.pendingProps.children,l),pd(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&tt&&((m=u=bt)&&(u=TC(u,i.type,i.pendingProps,Ls),u!==null?(i.stateNode=u,xn=i,bt=vs(u.firstChild),Ls=!1,m=!0):m=!1),m||fr(i)),La(i),m=i.type,g=i.pendingProps,x=s!==null?s.memoizedProps:null,u=g.children,np(m,g)?u=null:x!==null&&np(m,x)&&(i.flags|=32),i.memoizedState!==null&&(m=tm(s,i,Bj,null,null,l),vc._currentValue=m),pd(s,i),tn(s,i,u,l),i.child;case 6:return s===null&&tt&&((s=l=bt)&&(l=AC(l,i.pendingProps,Ls),l!==null?(i.stateNode=l,xn=i,bt=null,s=!0):s=!1),s||fr(i)),null;case 13:return D_(s,i,l);case 4:return ft(i,i.stateNode.containerInfo),u=i.pendingProps,s===null?i.child=_o(i,null,u,l):tn(s,i,u,l),i.child;case 11:return T_(s,i,i.type,i.pendingProps,l);case 7:return tn(s,i,i.pendingProps,l),i.child;case 8:return tn(s,i,i.pendingProps.children,l),i.child;case 12:return tn(s,i,i.pendingProps.children,l),i.child;case 10:return u=i.pendingProps,Ga(i,i.type,u.value),tn(s,i,u.children,l),i.child;case 9:return m=i.type._context,u=i.pendingProps.children,pr(i),m=fn(m),u=u(m),i.flags|=1,tn(s,i,u,l),i.child;case 14:return A_(s,i,i.type,i.pendingProps,l);case 15:return j_(s,i,i.type,i.pendingProps,l);case 19:return M_(s,i,l);case 31:return u=i.pendingProps,l=i.mode,u={mode:u.mode,children:u.children},s===null?(l=gd(u,l),l.ref=i.ref,i.child=l,l.return=i,i=l):(l=ha(s.child,u),l.ref=i.ref,i.child=l,l.return=i,i=l),i;case 22:return C_(s,i,l);case 24:return pr(i),u=fn(Vt),s===null?(m=$f(),m===null&&(m=mt,g=zf(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=l),m=g),i.memoizedState={parent:u,cache:m},Kf(i),Ga(i,Vt,m)):((s.lanes&l)!==0&&(Qf(s,i),Ql(i,null,null,l),Kl()),m=s.memoizedState,g=i.memoizedState,m.parent!==u?(m={parent:u,cache:u},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),Ga(i,Vt,u)):(u=g.cache,Ga(i,Vt,u),u!==m.cache&&Hf(i,[Vt],l,!0))),tn(s,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function Ea(s){s.flags|=4}function k_(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!zE(i)){if(i=rs.current,i!==null&&((Xe&4194048)===Xe?Vs!==null:(Xe&62914560)!==Xe&&(Xe&536870912)===0||i!==Vs))throw $l=Yf,_y;s.flags|=8192}}function vd(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?_l():536870912,s.lanes|=i,xo|=i)}function nc(s,i){if(!tt)switch(s.tailMode){case"hidden":i=s.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function yt(s){var i=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(i)for(var m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=u,s.childLanes=l,i}function Wj(s,i,l){var u=i.pendingProps;switch(Uf(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(i),null;case 1:return yt(i),null;case 3:return l=i.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),ga(Vt),As(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Ul(i)?Ea(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,my())),yt(i),null;case 26:return l=i.memoizedState,s===null?(Ea(i),l!==null?(yt(i),k_(i,l)):(yt(i),i.flags&=-16777217)):l?l!==s.memoizedState?(Ea(i),yt(i),k_(i,l)):(yt(i),i.flags&=-16777217):(s.memoizedProps!==u&&Ea(i),yt(i),i.flags&=-16777217),null;case 27:Js(i),l=Ie.current;var m=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==u&&Ea(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return yt(i),null}s=Ne.current,Ul(i)?hy(i):(s=kE(m,u,l),i.stateNode=s,Ea(i))}return yt(i),null;case 5:if(Js(i),l=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==u&&Ea(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return yt(i),null}if(s=Ne.current,Ul(i))hy(i);else{switch(m=Id(Ie.current),s){case 1:s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=m.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof u.is=="string"?m.createElement("select",{is:u.is}):m.createElement("select"),u.multiple?s.multiple=!0:u.size&&(s.size=u.size);break;default:s=typeof u.is=="string"?m.createElement(l,{is:u.is}):m.createElement(l)}}s[Pt]=i,s[wt]=u;e:for(m=i.child;m!==null;){if(m.tag===5||m.tag===6)s.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===i)break e;for(;m.sibling===null;){if(m.return===null||m.return===i)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}i.stateNode=s;e:switch(sn(s,l,u),l){case"button":case"input":case"select":case"textarea":s=!!u.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Ea(i)}}return yt(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==u&&Ea(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(a(166));if(s=Ie.current,Ul(i)){if(s=i.stateNode,l=i.memoizedProps,u=null,m=xn,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}s[Pt]=i,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||wE(s.nodeValue,l)),s||fr(i)}else s=Id(s).createTextNode(u),s[Pt]=i,i.stateNode=s}return yt(i),null;case 13:if(u=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=Ul(i),u!==null&&u.dehydrated!==null){if(s===null){if(!m)throw Error(a(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(a(317));m[Pt]=i}else Fl(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;yt(i),m=!1}else m=my(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(ya(i),i):(ya(i),null)}if(ya(i),(i.flags&128)!==0)return i.lanes=l,i;if(l=u!==null,s=s!==null&&s.memoizedState!==null,l){u=i.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool);var g=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==m&&(u.flags|=2048)}return l!==s&&l&&(i.child.flags|=8192),vd(i,i.updateQueue),yt(i),null;case 4:return As(),s===null&&Wm(i.stateNode.containerInfo),yt(i),null;case 10:return ga(i.type),yt(i),null;case 19:if(he(Ut),m=i.memoizedState,m===null)return yt(i),null;if(u=(i.flags&128)!==0,g=m.rendering,g===null)if(u)nc(m,!1);else{if(Nt!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(g=hd(s),g!==null){for(i.flags|=128,nc(m,!1),s=g.updateQueue,i.updateQueue=s,vd(i,s),i.subtreeFlags=0,s=l,l=i.child;l!==null;)uy(l,s),l=l.sibling;return ue(Ut,Ut.current&1|2),i.child}s=s.sibling}m.tail!==null&&Xn()>Ed&&(i.flags|=128,u=!0,nc(m,!1),i.lanes=4194304)}else{if(!u)if(s=hd(g),s!==null){if(i.flags|=128,u=!0,s=s.updateQueue,i.updateQueue=s,vd(i,s),nc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!g.alternate&&!tt)return yt(i),null}else 2*Xn()-m.renderingStartTime>Ed&&l!==536870912&&(i.flags|=128,u=!0,nc(m,!1),i.lanes=4194304);m.isBackwards?(g.sibling=i.child,i.child=g):(s=m.last,s!==null?s.sibling=g:i.child=g,m.last=g)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=Xn(),i.sibling=null,s=Ut.current,ue(Ut,u?s&1|2:s&1),i):(yt(i),null);case 22:case 23:return ya(i),Jf(),u=i.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(l&536870912)!==0&&(i.flags&128)===0&&(yt(i),i.subtreeFlags&6&&(i.flags|=8192)):yt(i),l=i.updateQueue,l!==null&&vd(i,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==l&&(i.flags|=2048),s!==null&&he(gr),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),ga(Vt),yt(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function Zj(s,i){switch(Uf(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return ga(Vt),As(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return Js(i),null;case 13:if(ya(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(a(340));Fl()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return he(Ut),null;case 4:return As(),null;case 10:return ga(i.type),null;case 22:case 23:return ya(i),Jf(),s!==null&&he(gr),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return ga(Vt),null;case 25:return null;default:return null}}function L_(s,i){switch(Uf(i),i.tag){case 3:ga(Vt),As();break;case 26:case 27:case 5:Js(i);break;case 4:As();break;case 13:ya(i);break;case 19:he(Ut);break;case 10:ga(i.type);break;case 22:case 23:ya(i),Jf(),s!==null&&he(gr);break;case 24:ga(Vt)}}function sc(s,i){try{var l=i.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var m=u.next;l=m;do{if((l.tag&s)===s){u=void 0;var g=l.create,x=l.inst;u=g(),x.destroy=u}l=l.next}while(l!==m)}}catch(S){ut(i,i.return,S)}}function Za(s,i,l){try{var u=i.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var g=m.next;u=g;do{if((u.tag&s)===s){var x=u.inst,S=x.destroy;if(S!==void 0){x.destroy=void 0,m=i;var q=l,W=S;try{W()}catch(se){ut(m,q,se)}}}u=u.next}while(u!==g)}}catch(se){ut(i,i.return,se)}}function V_(s){var i=s.updateQueue;if(i!==null){var l=s.stateNode;try{Ay(i,l)}catch(u){ut(s,s.return,u)}}}function U_(s,i,l){l.props=yr(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){ut(s,i,u)}}function ac(s,i){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(m){ut(s,i,m)}}function Us(s,i){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(m){ut(s,i,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){ut(s,i,m)}else l.current=null}function F_(s){var i=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(m){ut(s,s.return,m)}}function Cm(s,i,l){try{var u=s.stateNode;_C(u,s.type,l,i),u[wt]=i}catch(m){ut(s,s.return,m)}}function q_(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ri(s.type)||s.tag===4}function Sm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||q_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ri(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function wm(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(s),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=wd));else if(u!==4&&(u===27&&ri(s.type)&&(l=s.stateNode,i=null),s=s.child,s!==null))for(wm(s,i,l),s=s.sibling;s!==null;)wm(s,i,l),s=s.sibling}function yd(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?l.insertBefore(s,i):l.appendChild(s);else if(u!==4&&(u===27&&ri(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(yd(s,i,l),s=s.sibling;s!==null;)yd(s,i,l),s=s.sibling}function B_(s){var i=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);sn(i,u,l),i[Pt]=s,i[wt]=l}catch(g){ut(s,s.return,g)}}var ba=!1,Ct=!1,Im=!1,H_=typeof WeakSet=="function"?WeakSet:Set,Qt=null;function Jj(s,i){if(s=s.containerInfo,ep=kd,s=ey(s),Sf(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var m=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var x=0,S=-1,q=-1,W=0,se=0,oe=s,Z=null;t:for(;;){for(var ee;oe!==l||m!==0&&oe.nodeType!==3||(S=x+m),oe!==g||u!==0&&oe.nodeType!==3||(q=x+u),oe.nodeType===3&&(x+=oe.nodeValue.length),(ee=oe.firstChild)!==null;)Z=oe,oe=ee;for(;;){if(oe===s)break t;if(Z===l&&++W===m&&(S=x),Z===g&&++se===u&&(q=x),(ee=oe.nextSibling)!==null)break;oe=Z,Z=oe.parentNode}oe=ee}l=S===-1||q===-1?null:{start:S,end:q}}else l=null}l=l||{start:0,end:0}}else l=null;for(tp={focusedElem:s,selectionRange:l},kd=!1,Qt=i;Qt!==null;)if(i=Qt,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,Qt=s;else for(;Qt!==null;){switch(i=Qt,g=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&g!==null){s=void 0,l=i,m=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var we=yr(l.type,m,l.elementType===l.type);s=u.getSnapshotBeforeUpdate(we,g),u.__reactInternalSnapshotBeforeUpdate=s}catch(Ae){ut(l,l.return,Ae)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,l=s.nodeType,l===9)ap(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ap(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=i.sibling,s!==null){s.return=i.return,Qt=s;break}Qt=i.return}}function z_(s,i,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Ja(s,l),u&4&&sc(5,l);break;case 1:if(Ja(s,l),u&4)if(s=l.stateNode,i===null)try{s.componentDidMount()}catch(x){ut(l,l.return,x)}else{var m=yr(l.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(m,i,s.__reactInternalSnapshotBeforeUpdate)}catch(x){ut(l,l.return,x)}}u&64&&V_(l),u&512&&ac(l,l.return);break;case 3:if(Ja(s,l),u&64&&(s=l.updateQueue,s!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{Ay(s,i)}catch(x){ut(l,l.return,x)}}break;case 27:i===null&&u&4&&B_(l);case 26:case 5:Ja(s,l),i===null&&u&4&&F_(l),u&512&&ac(l,l.return);break;case 12:Ja(s,l);break;case 13:Ja(s,l),u&4&&Y_(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=lC.bind(null,l),jC(s,l))));break;case 22:if(u=l.memoizedState!==null||ba,!u){i=i!==null&&i.memoizedState!==null||Ct,m=ba;var g=Ct;ba=u,(Ct=i)&&!g?ei(s,l,(l.subtreeFlags&8772)!==0):Ja(s,l),ba=m,Ct=g}break;case 30:break;default:Ja(s,l)}}function G_(s){var i=s.alternate;i!==null&&(s.alternate=null,G_(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&qa(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var vt=null,wn=!1;function Na(s,i,l){for(l=l.child;l!==null;)$_(s,i,l),l=l.sibling}function $_(s,i,l){if(st&&typeof st.onCommitFiberUnmount=="function")try{st.onCommitFiberUnmount(Et,l)}catch{}switch(l.tag){case 26:Ct||Us(l,i),Na(s,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ct||Us(l,i);var u=vt,m=wn;ri(l.type)&&(vt=l.stateNode,wn=!1),Na(s,i,l),fc(l.stateNode),vt=u,wn=m;break;case 5:Ct||Us(l,i);case 6:if(u=vt,m=wn,vt=null,Na(s,i,l),vt=u,wn=m,vt!==null)if(wn)try{(vt.nodeType===9?vt.body:vt.nodeName==="HTML"?vt.ownerDocument.body:vt).removeChild(l.stateNode)}catch(g){ut(l,i,g)}else try{vt.removeChild(l.stateNode)}catch(g){ut(l,i,g)}break;case 18:vt!==null&&(wn?(s=vt,ME(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),bc(s)):ME(vt,l.stateNode));break;case 4:u=vt,m=wn,vt=l.stateNode.containerInfo,wn=!0,Na(s,i,l),vt=u,wn=m;break;case 0:case 11:case 14:case 15:Ct||Za(2,l,i),Ct||Za(4,l,i),Na(s,i,l);break;case 1:Ct||(Us(l,i),u=l.stateNode,typeof u.componentWillUnmount=="function"&&U_(l,i,u)),Na(s,i,l);break;case 21:Na(s,i,l);break;case 22:Ct=(u=Ct)||l.memoizedState!==null,Na(s,i,l),Ct=u;break;default:Na(s,i,l)}}function Y_(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{bc(s)}catch(l){ut(i,i.return,l)}}function eC(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new H_),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new H_),i;default:throw Error(a(435,s.tag))}}function Rm(s,i){var l=eC(s);i.forEach(function(u){var m=cC.bind(null,s,u);l.has(u)||(l.add(u),u.then(m,m))})}function Un(s,i){var l=i.deletions;if(l!==null)for(var u=0;u<l.length;u++){var m=l[u],g=s,x=i,S=x;e:for(;S!==null;){switch(S.tag){case 27:if(ri(S.type)){vt=S.stateNode,wn=!1;break e}break;case 5:vt=S.stateNode,wn=!1;break e;case 3:case 4:vt=S.stateNode.containerInfo,wn=!0;break e}S=S.return}if(vt===null)throw Error(a(160));$_(g,x,m),vt=null,wn=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)K_(i,s),i=i.sibling}var gs=null;function K_(s,i){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Un(i,s),Fn(s),u&4&&(Za(3,s,s.return),sc(3,s),Za(5,s,s.return));break;case 1:Un(i,s),Fn(s),u&512&&(Ct||l===null||Us(l,l.return)),u&64&&ba&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var m=gs;if(Un(i,s),Fn(s),u&512&&(Ct||l===null||Us(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":g=m.getElementsByTagName("title")[0],(!g||g[Yi]||g[Pt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(u),m.head.insertBefore(g,m.querySelector("head > title"))),sn(g,u,l),g[Pt]=s,At(g),u=g;break e;case"link":var x=BE("link","href",m).get(u+(l.href||""));if(x){for(var S=0;S<x.length;S++)if(g=x[S],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){x.splice(S,1);break t}}g=m.createElement(u),sn(g,u,l),m.head.appendChild(g);break;case"meta":if(x=BE("meta","content",m).get(u+(l.content||""))){for(S=0;S<x.length;S++)if(g=x[S],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){x.splice(S,1);break t}}g=m.createElement(u),sn(g,u,l),m.head.appendChild(g);break;default:throw Error(a(468,u))}g[Pt]=s,At(g),u=g}s.stateNode=u}else HE(m,s.type,s.stateNode);else s.stateNode=qE(m,u,s.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?HE(m,s.type,s.stateNode):qE(m,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Cm(s,s.memoizedProps,l.memoizedProps)}break;case 27:Un(i,s),Fn(s),u&512&&(Ct||l===null||Us(l,l.return)),l!==null&&u&4&&Cm(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Un(i,s),Fn(s),u&512&&(Ct||l===null||Us(l,l.return)),s.flags&32){m=s.stateNode;try{Zn(m,"")}catch(ee){ut(s,s.return,ee)}}u&4&&s.stateNode!=null&&(m=s.memoizedProps,Cm(s,m,l!==null?l.memoizedProps:m)),u&1024&&(Im=!0);break;case 6:if(Un(i,s),Fn(s),u&4){if(s.stateNode===null)throw Error(a(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(ee){ut(s,s.return,ee)}}break;case 3:if(Od=null,m=gs,gs=Rd(i.containerInfo),Un(i,s),gs=m,Fn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{bc(i.containerInfo)}catch(ee){ut(s,s.return,ee)}Im&&(Im=!1,Q_(s));break;case 4:u=gs,gs=Rd(s.stateNode.containerInfo),Un(i,s),Fn(s),gs=u;break;case 12:Un(i,s),Fn(s);break;case 13:Un(i,s),Fn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Lm=Xn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Rm(s,u)));break;case 22:m=s.memoizedState!==null;var q=l!==null&&l.memoizedState!==null,W=ba,se=Ct;if(ba=W||m,Ct=se||q,Un(i,s),Ct=se,ba=W,Fn(s),u&8192)e:for(i=s.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(l===null||q||ba||Ct||_r(s)),l=null,i=s;;){if(i.tag===5||i.tag===26){if(l===null){q=l=i;try{if(g=q.stateNode,m)x=g.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{S=q.stateNode;var oe=q.memoizedProps.style,Z=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;S.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(ee){ut(q,q.return,ee)}}}else if(i.tag===6){if(l===null){q=i;try{q.stateNode.nodeValue=m?"":q.memoizedProps}catch(ee){ut(q,q.return,ee)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Rm(s,l))));break;case 19:Un(i,s),Fn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Rm(s,u)));break;case 30:break;case 21:break;default:Un(i,s),Fn(s)}}function Fn(s){var i=s.flags;if(i&2){try{for(var l,u=s.return;u!==null;){if(q_(u)){l=u;break}u=u.return}if(l==null)throw Error(a(160));switch(l.tag){case 27:var m=l.stateNode,g=Sm(s);yd(s,g,m);break;case 5:var x=l.stateNode;l.flags&32&&(Zn(x,""),l.flags&=-33);var S=Sm(s);yd(s,S,x);break;case 3:case 4:var q=l.stateNode.containerInfo,W=Sm(s);wm(s,W,q);break;default:throw Error(a(161))}}catch(se){ut(s,s.return,se)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Q_(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;Q_(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function Ja(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)z_(s,i.alternate,i),i=i.sibling}function _r(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Za(4,i,i.return),_r(i);break;case 1:Us(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&U_(i,i.return,l),_r(i);break;case 27:fc(i.stateNode);case 26:case 5:Us(i,i.return),_r(i);break;case 22:i.memoizedState===null&&_r(i);break;case 30:_r(i);break;default:_r(i)}s=s.sibling}}function ei(s,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,m=s,g=i,x=g.flags;switch(g.tag){case 0:case 11:case 15:ei(m,g,l),sc(4,g);break;case 1:if(ei(m,g,l),u=g,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(W){ut(u,u.return,W)}if(u=g,m=u.updateQueue,m!==null){var S=u.stateNode;try{var q=m.shared.hiddenCallbacks;if(q!==null)for(m.shared.hiddenCallbacks=null,m=0;m<q.length;m++)Ty(q[m],S)}catch(W){ut(u,u.return,W)}}l&&x&64&&V_(g),ac(g,g.return);break;case 27:B_(g);case 26:case 5:ei(m,g,l),l&&u===null&&x&4&&F_(g),ac(g,g.return);break;case 12:ei(m,g,l);break;case 13:ei(m,g,l),l&&x&4&&Y_(m,g);break;case 22:g.memoizedState===null&&ei(m,g,l),ac(g,g.return);break;case 30:break;default:ei(m,g,l)}i=i.sibling}}function Dm(s,i){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Hl(l))}function Om(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Hl(s))}function Fs(s,i,l,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)X_(s,i,l,u),i=i.sibling}function X_(s,i,l,u){var m=i.flags;switch(i.tag){case 0:case 11:case 15:Fs(s,i,l,u),m&2048&&sc(9,i);break;case 1:Fs(s,i,l,u);break;case 3:Fs(s,i,l,u),m&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Hl(s)));break;case 12:if(m&2048){Fs(s,i,l,u),s=i.stateNode;try{var g=i.memoizedProps,x=g.id,S=g.onPostCommit;typeof S=="function"&&S(x,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(q){ut(i,i.return,q)}}else Fs(s,i,l,u);break;case 13:Fs(s,i,l,u);break;case 23:break;case 22:g=i.stateNode,x=i.alternate,i.memoizedState!==null?g._visibility&2?Fs(s,i,l,u):ic(s,i):g._visibility&2?Fs(s,i,l,u):(g._visibility|=2,Eo(s,i,l,u,(i.subtreeFlags&10256)!==0)),m&2048&&Dm(x,i);break;case 24:Fs(s,i,l,u),m&2048&&Om(i.alternate,i);break;default:Fs(s,i,l,u)}}function Eo(s,i,l,u,m){for(m=m&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var g=s,x=i,S=l,q=u,W=x.flags;switch(x.tag){case 0:case 11:case 15:Eo(g,x,S,q,m),sc(8,x);break;case 23:break;case 22:var se=x.stateNode;x.memoizedState!==null?se._visibility&2?Eo(g,x,S,q,m):ic(g,x):(se._visibility|=2,Eo(g,x,S,q,m)),m&&W&2048&&Dm(x.alternate,x);break;case 24:Eo(g,x,S,q,m),m&&W&2048&&Om(x.alternate,x);break;default:Eo(g,x,S,q,m)}i=i.sibling}}function ic(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=s,u=i,m=u.flags;switch(u.tag){case 22:ic(l,u),m&2048&&Dm(u.alternate,u);break;case 24:ic(l,u),m&2048&&Om(u.alternate,u);break;default:ic(l,u)}i=i.sibling}}var rc=8192;function bo(s){if(s.subtreeFlags&rc)for(s=s.child;s!==null;)W_(s),s=s.sibling}function W_(s){switch(s.tag){case 26:bo(s),s.flags&rc&&s.memoizedState!==null&&UC(gs,s.memoizedState,s.memoizedProps);break;case 5:bo(s);break;case 3:case 4:var i=gs;gs=Rd(s.stateNode.containerInfo),bo(s),gs=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=rc,rc=16777216,bo(s),rc=i):bo(s));break;default:bo(s)}}function Z_(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function oc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];Qt=u,eE(u,s)}Z_(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)J_(s),s=s.sibling}function J_(s){switch(s.tag){case 0:case 11:case 15:oc(s),s.flags&2048&&Za(9,s,s.return);break;case 3:oc(s);break;case 12:oc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,_d(s)):oc(s);break;default:oc(s)}}function _d(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];Qt=u,eE(u,s)}Z_(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Za(8,i,i.return),_d(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,_d(i));break;default:_d(i)}s=s.sibling}}function eE(s,i){for(;Qt!==null;){var l=Qt;switch(l.tag){case 0:case 11:case 15:Za(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Hl(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Qt=u;else e:for(l=s;Qt!==null;){u=Qt;var m=u.sibling,g=u.return;if(G_(u),u===l){Qt=null;break e}if(m!==null){m.return=g,Qt=m;break e}Qt=g}}}var tC={getCacheForType:function(s){var i=fn(Vt),l=i.data.get(s);return l===void 0&&(l=s(),i.data.set(s,l)),l}},nC=typeof WeakMap=="function"?WeakMap:Map,at=0,mt=null,qe=null,Xe=0,it=0,qn=null,ti=!1,No=!1,Mm=!1,xa=0,Nt=0,ni=0,Er=0,Pm=0,os=0,xo=0,lc=null,In=null,km=!1,Lm=0,Ed=1/0,bd=null,si=null,nn=0,ai=null,To=null,Ao=0,Vm=0,Um=null,tE=null,cc=0,Fm=null;function Bn(){if((at&2)!==0&&Xe!==0)return Xe&-Xe;if(H.T!==null){var s=ho;return s!==0?s:Ym()}return Ua()}function nE(){os===0&&(os=(Xe&536870912)===0||tt?yl():536870912);var s=rs.current;return s!==null&&(s.flags|=32),os}function Hn(s,i,l){(s===mt&&(it===2||it===9)||s.cancelPendingCommit!==null)&&(jo(s,0),ii(s,Xe,os,!1)),ta(s,l),((at&2)===0||s!==mt)&&(s===mt&&((at&2)===0&&(Er|=l),Nt===4&&ii(s,Xe,os,!1)),qs(s))}function sE(s,i,l){if((at&6)!==0)throw Error(a(327));var u=!l&&(i&124)===0&&(i&s.expiredLanes)===0||$i(s,i),m=u?iC(s,i):Hm(s,i,!0),g=u;do{if(m===0){No&&!u&&ii(s,i,0,!1);break}else{if(l=s.current.alternate,g&&!sC(l)){m=Hm(s,i,!1),g=!1;continue}if(m===2){if(g=i,s.errorRecoveryDisabledLanes&g)var x=0;else x=s.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){i=x;e:{var S=s;m=lc;var q=S.current.memoizedState.isDehydrated;if(q&&(jo(S,x).flags|=256),x=Hm(S,x,!1),x!==2){if(Mm&&!q){S.errorRecoveryDisabledLanes|=g,Er|=g,m=4;break e}g=In,In=m,g!==null&&(In===null?In=g:In.push.apply(In,g))}m=x}if(g=!1,m!==2)continue}}if(m===1){jo(s,0),ii(s,i,0,!0);break}e:{switch(u=s,g=m,g){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:ii(u,i,os,!ti);break e;case 2:In=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(m=Lm+300-Xn(),10<m)){if(ii(u,i,os,!ti),Br(u,0,!0)!==0)break e;u.timeoutHandle=DE(aE.bind(null,u,l,In,bd,km,i,os,Er,xo,ti,g,2,-0,0),m);break e}aE(u,l,In,bd,km,i,os,Er,xo,ti,g,0,-0,0)}}break}while(!0);qs(s)}function aE(s,i,l,u,m,g,x,S,q,W,se,oe,Z,ee){if(s.timeoutHandle=-1,oe=i.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(gc={stylesheets:null,count:0,unsuspend:VC},W_(i),oe=FC(),oe!==null)){s.cancelPendingCommit=oe(dE.bind(null,s,i,g,l,u,m,x,S,q,se,1,Z,ee)),ii(s,g,x,!W);return}dE(s,i,g,l,u,m,x,S,q)}function sC(s){for(var i=s;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var m=l[u],g=m.getSnapshot;m=m.value;try{if(!Ln(g(),m))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ii(s,i,l,u){i&=~Pm,i&=~Er,s.suspendedLanes|=i,s.pingedLanes&=~i,u&&(s.warmLanes|=i),u=s.expirationTimes;for(var m=i;0<m;){var g=31-hn(m),x=1<<g;u[g]=-1,m&=~x}l!==0&&js(s,l,i)}function Nd(){return(at&6)===0?(uc(0),!1):!0}function qm(){if(qe!==null){if(it===0)var s=qe.return;else s=qe,pa=mr=null,am(s),yo=null,ec=0,s=qe;for(;s!==null;)L_(s.alternate,s),s=s.return;qe=null}}function jo(s,i){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,bC(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),qm(),mt=s,qe=l=ha(s.current,null),Xe=i,it=0,qn=null,ti=!1,No=$i(s,i),Mm=!1,xo=os=Pm=Er=ni=Nt=0,In=lc=null,km=!1,(i&8)!==0&&(i|=i&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=i;0<u;){var m=31-hn(u),g=1<<m;i|=s[m],u&=~g}return xa=i,zu(),l}function iE(s,i){Le=null,H.H=cd,i===Gl||i===Ju?(i=Ny(),it=3):i===_y?(i=Ny(),it=4):it=i===x_?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,qn=i,qe===null&&(Nt=1,md(s,ns(i,s.current)))}function rE(){var s=H.H;return H.H=cd,s===null?cd:s}function oE(){var s=H.A;return H.A=tC,s}function Bm(){Nt=4,ti||(Xe&4194048)!==Xe&&rs.current!==null||(No=!0),(ni&134217727)===0&&(Er&134217727)===0||mt===null||ii(mt,Xe,os,!1)}function Hm(s,i,l){var u=at;at|=2;var m=rE(),g=oE();(mt!==s||Xe!==i)&&(bd=null,jo(s,i)),i=!1;var x=Nt;e:do try{if(it!==0&&qe!==null){var S=qe,q=qn;switch(it){case 8:qm(),x=6;break e;case 3:case 2:case 9:case 6:rs.current===null&&(i=!0);var W=it;if(it=0,qn=null,Co(s,S,q,W),l&&No){x=0;break e}break;default:W=it,it=0,qn=null,Co(s,S,q,W)}}aC(),x=Nt;break}catch(se){iE(s,se)}while(!0);return i&&s.shellSuspendCounter++,pa=mr=null,at=u,H.H=m,H.A=g,qe===null&&(mt=null,Xe=0,zu()),x}function aC(){for(;qe!==null;)lE(qe)}function iC(s,i){var l=at;at|=2;var u=rE(),m=oE();mt!==s||Xe!==i?(bd=null,Ed=Xn()+500,jo(s,i)):No=$i(s,i);e:do try{if(it!==0&&qe!==null){i=qe;var g=qn;t:switch(it){case 1:it=0,qn=null,Co(s,i,g,1);break;case 2:case 9:if(Ey(g)){it=0,qn=null,cE(i);break}i=function(){it!==2&&it!==9||mt!==s||(it=7),qs(s)},g.then(i,i);break e;case 3:it=7;break e;case 4:it=5;break e;case 7:Ey(g)?(it=0,qn=null,cE(i)):(it=0,qn=null,Co(s,i,g,7));break;case 5:var x=null;switch(qe.tag){case 26:x=qe.memoizedState;case 5:case 27:var S=qe;if(!x||zE(x)){it=0,qn=null;var q=S.sibling;if(q!==null)qe=q;else{var W=S.return;W!==null?(qe=W,xd(W)):qe=null}break t}}it=0,qn=null,Co(s,i,g,5);break;case 6:it=0,qn=null,Co(s,i,g,6);break;case 8:qm(),Nt=6;break e;default:throw Error(a(462))}}rC();break}catch(se){iE(s,se)}while(!0);return pa=mr=null,H.H=u,H.A=m,at=l,qe!==null?0:(mt=null,Xe=0,zu(),Nt)}function rC(){for(;qe!==null&&!ml();)lE(qe)}function lE(s){var i=P_(s.alternate,s,xa);s.memoizedProps=s.pendingProps,i===null?xd(s):qe=i}function cE(s){var i=s,l=i.alternate;switch(i.tag){case 15:case 0:i=w_(l,i,i.pendingProps,i.type,void 0,Xe);break;case 11:i=w_(l,i,i.pendingProps,i.type.render,i.ref,Xe);break;case 5:am(i);default:L_(l,i),i=qe=uy(i,xa),i=P_(l,i,xa)}s.memoizedProps=s.pendingProps,i===null?xd(s):qe=i}function Co(s,i,l,u){pa=mr=null,am(i),yo=null,ec=0;var m=i.return;try{if(Qj(s,m,i,l,Xe)){Nt=1,md(s,ns(l,s.current)),qe=null;return}}catch(g){if(m!==null)throw qe=m,g;Nt=1,md(s,ns(l,s.current)),qe=null;return}i.flags&32768?(tt||u===1?s=!0:No||(Xe&536870912)!==0?s=!1:(ti=s=!0,(u===2||u===9||u===3||u===6)&&(u=rs.current,u!==null&&u.tag===13&&(u.flags|=16384))),uE(i,s)):xd(i)}function xd(s){var i=s;do{if((i.flags&32768)!==0){uE(i,ti);return}s=i.return;var l=Wj(i.alternate,i,xa);if(l!==null){qe=l;return}if(i=i.sibling,i!==null){qe=i;return}qe=i=s}while(i!==null);Nt===0&&(Nt=5)}function uE(s,i){do{var l=Zj(s.alternate,s);if(l!==null){l.flags&=32767,qe=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(s=s.sibling,s!==null)){qe=s;return}qe=s=l}while(s!==null);Nt=6,qe=null}function dE(s,i,l,u,m,g,x,S,q){s.cancelPendingCommit=null;do Td();while(nn!==0);if((at&6)!==0)throw Error(a(327));if(i!==null){if(i===s.current)throw Error(a(177));if(g=i.lanes|i.childLanes,g|=Of,El(s,l,g,x,S,q),s===mt&&(qe=mt=null,Xe=0),To=i,ai=s,Ao=l,Vm=g,Um=m,tE=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,uC(Bi,function(){return gE(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=H.T,H.T=null,m=J.p,J.p=2,x=at,at|=4;try{Jj(s,i,l)}finally{at=x,J.p=m,H.T=u}}nn=1,hE(),fE(),mE()}}function hE(){if(nn===1){nn=0;var s=ai,i=To,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=H.T,H.T=null;var u=J.p;J.p=2;var m=at;at|=4;try{K_(i,s);var g=tp,x=ey(s.containerInfo),S=g.focusedElem,q=g.selectionRange;if(x!==S&&S&&S.ownerDocument&&Jv(S.ownerDocument.documentElement,S)){if(q!==null&&Sf(S)){var W=q.start,se=q.end;if(se===void 0&&(se=W),"selectionStart"in S)S.selectionStart=W,S.selectionEnd=Math.min(se,S.value.length);else{var oe=S.ownerDocument||document,Z=oe&&oe.defaultView||window;if(Z.getSelection){var ee=Z.getSelection(),we=S.textContent.length,Ae=Math.min(q.start,we),ct=q.end===void 0?Ae:Math.min(q.end,we);!ee.extend&&Ae>ct&&(x=ct,ct=Ae,Ae=x);var G=Zv(S,Ae),z=Zv(S,ct);if(G&&z&&(ee.rangeCount!==1||ee.anchorNode!==G.node||ee.anchorOffset!==G.offset||ee.focusNode!==z.node||ee.focusOffset!==z.offset)){var Q=oe.createRange();Q.setStart(G.node,G.offset),ee.removeAllRanges(),Ae>ct?(ee.addRange(Q),ee.extend(z.node,z.offset)):(Q.setEnd(z.node,z.offset),ee.addRange(Q))}}}}for(oe=[],ee=S;ee=ee.parentNode;)ee.nodeType===1&&oe.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<oe.length;S++){var ie=oe[S];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}kd=!!ep,tp=ep=null}finally{at=m,J.p=u,H.T=l}}s.current=i,nn=2}}function fE(){if(nn===2){nn=0;var s=ai,i=To,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=H.T,H.T=null;var u=J.p;J.p=2;var m=at;at|=4;try{z_(s,i.alternate,i)}finally{at=m,J.p=u,H.T=l}}nn=3}}function mE(){if(nn===4||nn===3){nn=0,_u();var s=ai,i=To,l=Ao,u=tE;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?nn=5:(nn=0,To=ai=null,pE(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(si=null),Hr(l),i=i.stateNode,st&&typeof st.onCommitFiberRoot=="function")try{st.onCommitFiberRoot(Et,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=H.T,m=J.p,J.p=2,H.T=null;try{for(var g=s.onRecoverableError,x=0;x<u.length;x++){var S=u[x];g(S.value,{componentStack:S.stack})}}finally{H.T=i,J.p=m}}(Ao&3)!==0&&Td(),qs(s),m=s.pendingLanes,(l&4194090)!==0&&(m&42)!==0?s===Fm?cc++:(cc=0,Fm=s):cc=0,uc(0)}}function pE(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,Hl(i)))}function Td(s){return hE(),fE(),mE(),gE()}function gE(){if(nn!==5)return!1;var s=ai,i=Vm;Vm=0;var l=Hr(Ao),u=H.T,m=J.p;try{J.p=32>l?32:l,H.T=null,l=Um,Um=null;var g=ai,x=Ao;if(nn=0,To=ai=null,Ao=0,(at&6)!==0)throw Error(a(331));var S=at;if(at|=4,J_(g.current),X_(g,g.current,x,l),at=S,uc(0,!1),st&&typeof st.onPostCommitFiberRoot=="function")try{st.onPostCommitFiberRoot(Et,g)}catch{}return!0}finally{J.p=m,H.T=u,pE(s,i)}}function vE(s,i,l){i=ns(l,i),i=ym(s.stateNode,i,2),s=Ka(s,i,2),s!==null&&(ta(s,2),qs(s))}function ut(s,i,l){if(s.tag===3)vE(s,s,l);else for(;i!==null;){if(i.tag===3){vE(i,s,l);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(si===null||!si.has(u))){s=ns(l,s),l=b_(2),u=Ka(i,l,2),u!==null&&(N_(l,u,i,s),ta(u,2),qs(u));break}}i=i.return}}function zm(s,i,l){var u=s.pingCache;if(u===null){u=s.pingCache=new nC;var m=new Set;u.set(i,m)}else m=u.get(i),m===void 0&&(m=new Set,u.set(i,m));m.has(l)||(Mm=!0,m.add(l),s=oC.bind(null,s,i,l),i.then(s,s))}function oC(s,i,l){var u=s.pingCache;u!==null&&u.delete(i),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,mt===s&&(Xe&l)===l&&(Nt===4||Nt===3&&(Xe&62914560)===Xe&&300>Xn()-Lm?(at&2)===0&&jo(s,0):Pm|=l,xo===Xe&&(xo=0)),qs(s)}function yE(s,i){i===0&&(i=_l()),s=oo(s,i),s!==null&&(ta(s,i),qs(s))}function lC(s){var i=s.memoizedState,l=0;i!==null&&(l=i.retryLane),yE(s,l)}function cC(s,i){var l=0;switch(s.tag){case 13:var u=s.stateNode,m=s.memoizedState;m!==null&&(l=m.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(i),yE(s,l)}function uC(s,i){return Fi(s,i)}var Ad=null,So=null,Gm=!1,jd=!1,$m=!1,br=0;function qs(s){s!==So&&s.next===null&&(So===null?Ad=So=s:So=So.next=s),jd=!0,Gm||(Gm=!0,hC())}function uc(s,i){if(!$m&&jd){$m=!0;do for(var l=!1,u=Ad;u!==null;){if(s!==0){var m=u.pendingLanes;if(m===0)var g=0;else{var x=u.suspendedLanes,S=u.pingedLanes;g=(1<<31-hn(42|s)+1)-1,g&=m&~(x&~S),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,NE(u,g))}else g=Xe,g=Br(u,u===mt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||$i(u,g)||(l=!0,NE(u,g));u=u.next}while(l);$m=!1}}function dC(){_E()}function _E(){jd=Gm=!1;var s=0;br!==0&&(EC()&&(s=br),br=0);for(var i=Xn(),l=null,u=Ad;u!==null;){var m=u.next,g=EE(u,i);g===0?(u.next=null,l===null?Ad=m:l.next=m,m===null&&(So=l)):(l=u,(s!==0||(g&3)!==0)&&(jd=!0)),u=m}uc(s)}function EE(s,i){for(var l=s.suspendedLanes,u=s.pingedLanes,m=s.expirationTimes,g=s.pendingLanes&-62914561;0<g;){var x=31-hn(g),S=1<<x,q=m[x];q===-1?((S&l)===0||(S&u)!==0)&&(m[x]=vl(S,i)):q<=i&&(s.expiredLanes|=S),g&=~S}if(i=mt,l=Xe,l=Br(s,s===i?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===i&&(it===2||it===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&qi(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||$i(s,l)){if(i=l&-l,i===s.callbackPriority)return i;switch(u!==null&&qi(u),Hr(l)){case 2:case 8:l=Fr;break;case 32:l=Bi;break;case 268435456:l=qr;break;default:l=Bi}return u=bE.bind(null,s),l=Fi(l,u),s.callbackPriority=i,s.callbackNode=l,i}return u!==null&&u!==null&&qi(u),s.callbackPriority=2,s.callbackNode=null,2}function bE(s,i){if(nn!==0&&nn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Td()&&s.callbackNode!==l)return null;var u=Xe;return u=Br(s,s===mt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(sE(s,u,i),EE(s,Xn()),s.callbackNode!=null&&s.callbackNode===l?bE.bind(null,s):null)}function NE(s,i){if(Td())return null;sE(s,i,!0)}function hC(){NC(function(){(at&6)!==0?Fi(pl,dC):_E()})}function Ym(){return br===0&&(br=yl()),br}function xE(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Qr(""+s)}function TE(s,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,s.id&&l.setAttribute("form",s.id),i.parentNode.insertBefore(l,i),s=new FormData(s),l.parentNode.removeChild(l),s}function fC(s,i,l,u,m){if(i==="submit"&&l&&l.stateNode===m){var g=xE((m[wt]||null).action),x=u.submitter;x&&(i=(i=x[wt]||null)?xE(i.formAction):x.getAttribute("formAction"),i!==null&&(g=i,x=null));var S=new Xr("action","action",null,u,m);s.push({event:S,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(br!==0){var q=x?TE(m,x):new FormData(m);fm(l,{pending:!0,data:q,method:m.method,action:g},null,q)}}else typeof g=="function"&&(S.preventDefault(),q=x?TE(m,x):new FormData(m),fm(l,{pending:!0,data:q,method:m.method,action:g},g,q))},currentTarget:m}]})}}for(var Km=0;Km<Df.length;Km++){var Qm=Df[Km],mC=Qm.toLowerCase(),pC=Qm[0].toUpperCase()+Qm.slice(1);ps(mC,"on"+pC)}ps(sy,"onAnimationEnd"),ps(ay,"onAnimationIteration"),ps(iy,"onAnimationStart"),ps("dblclick","onDoubleClick"),ps("focusin","onFocus"),ps("focusout","onBlur"),ps(Dj,"onTransitionRun"),ps(Oj,"onTransitionStart"),ps(Mj,"onTransitionCancel"),ps(ry,"onTransitionEnd"),sa("onMouseEnter",["mouseout","mouseover"]),sa("onMouseLeave",["mouseout","mouseover"]),sa("onPointerEnter",["pointerout","pointerover"]),sa("onPointerLeave",["pointerout","pointerover"]),fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fs("onBeforeInput",["compositionend","keypress","textInput","paste"]),fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(dc));function AE(s,i){i=(i&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],m=u.event;u=u.listeners;e:{var g=void 0;if(i)for(var x=u.length-1;0<=x;x--){var S=u[x],q=S.instance,W=S.currentTarget;if(S=S.listener,q!==g&&m.isPropagationStopped())break e;g=S,m.currentTarget=W;try{g(m)}catch(se){fd(se)}m.currentTarget=null,g=q}else for(x=0;x<u.length;x++){if(S=u[x],q=S.instance,W=S.currentTarget,S=S.listener,q!==g&&m.isPropagationStopped())break e;g=S,m.currentTarget=W;try{g(m)}catch(se){fd(se)}m.currentTarget=null,g=q}}}}function Be(s,i){var l=i[Nl];l===void 0&&(l=i[Nl]=new Set);var u=s+"__bubble";l.has(u)||(jE(i,s,2,!1),l.add(u))}function Xm(s,i,l){var u=0;i&&(u|=4),jE(l,s,u,i)}var Cd="_reactListening"+Math.random().toString(36).slice(2);function Wm(s){if(!s[Cd]){s[Cd]=!0,xl.forEach(function(l){l!=="selectionchange"&&(gC.has(l)||Xm(l,!1,s),Xm(l,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Cd]||(i[Cd]=!0,Xm("selectionchange",!1,i))}}function jE(s,i,l,u){switch(XE(i)){case 2:var m=HC;break;case 8:m=zC;break;default:m=dp}l=m.bind(null,i,l,s),m=void 0,!es||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),u?m!==void 0?s.addEventListener(i,l,{capture:!0,passive:m}):s.addEventListener(i,l,!0):m!==void 0?s.addEventListener(i,l,{passive:m}):s.addEventListener(i,l,!1)}function Zm(s,i,l,u,m){var g=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var x=u.tag;if(x===3||x===4){var S=u.stateNode.containerInfo;if(S===m)break;if(x===4)for(x=u.return;x!==null;){var q=x.tag;if((q===3||q===4)&&x.stateNode.containerInfo===m)return;x=x.return}for(;S!==null;){if(x=na(S),x===null)return;if(q=x.tag,q===5||q===6||q===26||q===27){u=g=x;continue e}S=S.parentNode}}u=u.return}wu(function(){var W=g,se=Jn(l),oe=[];e:{var Z=oy.get(s);if(Z!==void 0){var ee=Xr,we=s;switch(s){case"keypress":if(Ds(l)===0)break e;case"keydown":case"keyup":ee=no;break;case"focusin":we="focus",ee=Jr;break;case"focusout":we="blur",ee=Jr;break;case"beforeblur":case"afterblur":ee=Jr;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=ts;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=Tf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=Lu;break;case sy:case ay:case iy:ee=eo;break;case ry:ee=Uu;break;case"scroll":case"scrollend":ee=Iu;break;case"wheel":ee=so;break;case"copy":case"cut":case"paste":ee=to;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=Pl;break;case"toggle":case"beforetoggle":ee=qu}var Ae=(i&4)!==0,ct=!Ae&&(s==="scroll"||s==="scrollend"),G=Ae?Z!==null?Z+"Capture":null:Z;Ae=[];for(var z=W,Q;z!==null;){var ie=z;if(Q=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||Q===null||G===null||(ie=er(z,G),ie!=null&&Ae.push(hc(z,ie,Q))),ct)break;z=z.return}0<Ae.length&&(Z=new ee(Z,we,null,l,se),oe.push({event:Z,listeners:Ae}))}}if((i&7)===0){e:{if(Z=s==="mouseover"||s==="pointerover",ee=s==="mouseout"||s==="pointerout",Z&&l!==ra&&(we=l.relatedTarget||l.fromElement)&&(na(we)||we[Wn]))break e;if((ee||Z)&&(Z=se.window===se?se:(Z=se.ownerDocument)?Z.defaultView||Z.parentWindow:window,ee?(we=l.relatedTarget||l.toElement,ee=W,we=we?na(we):null,we!==null&&(ct=c(we),Ae=we.tag,we!==ct||Ae!==5&&Ae!==27&&Ae!==6)&&(we=null)):(ee=null,we=W),ee!==we)){if(Ae=ts,ie="onMouseLeave",G="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(Ae=Pl,ie="onPointerLeave",G="onPointerEnter",z="pointer"),ct=ee==null?Z:Ss(ee),Q=we==null?Z:Ss(we),Z=new Ae(ie,z+"leave",ee,l,se),Z.target=ct,Z.relatedTarget=Q,ie=null,na(se)===W&&(Ae=new Ae(G,z+"enter",we,l,se),Ae.target=Q,Ae.relatedTarget=ct,ie=Ae),ct=ie,ee&&we)t:{for(Ae=ee,G=we,z=0,Q=Ae;Q;Q=wo(Q))z++;for(Q=0,ie=G;ie;ie=wo(ie))Q++;for(;0<z-Q;)Ae=wo(Ae),z--;for(;0<Q-z;)G=wo(G),Q--;for(;z--;){if(Ae===G||G!==null&&Ae===G.alternate)break t;Ae=wo(Ae),G=wo(G)}Ae=null}else Ae=null;ee!==null&&CE(oe,Z,ee,Ae,!1),we!==null&&ct!==null&&CE(oe,ct,we,Ae,!0)}}e:{if(Z=W?Ss(W):window,ee=Z.nodeName&&Z.nodeName.toLowerCase(),ee==="select"||ee==="input"&&Z.type==="file")var ye=$v;else if(Lt(Z))if(Yv)ye=wj;else{ye=Cj;var Fe=jj}else ee=Z.nodeName,!ee||ee.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?W&&Sl(W.elementType)&&(ye=$v):ye=Sj;if(ye&&(ye=ye(s,W))){da(oe,ye,l,se);break e}Fe&&Fe(s,Z,W),s==="focusout"&&W&&Z.type==="number"&&W.memoizedProps.value!=null&&Ha(Z,"number",Z.value)}switch(Fe=W?Ss(W):window,s){case"focusin":(Lt(Fe)||Fe.contentEditable==="true")&&(ao=Fe,wf=W,Vl=null);break;case"focusout":Vl=wf=ao=null;break;case"mousedown":If=!0;break;case"contextmenu":case"mouseup":case"dragend":If=!1,ty(oe,l,se);break;case"selectionchange":if(Rj)break;case"keydown":case"keyup":ty(oe,l,se)}var _e;if(Ps)e:{switch(s){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Ke?te(s,l)&&(je="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(je="onCompositionStart");je&&(E&&l.locale!=="ko"&&(Ke||je!=="onCompositionStart"?je==="onCompositionEnd"&&Ke&&(_e=Il()):(Rs=se,za="value"in Rs?Rs.value:Rs.textContent,Ke=!0)),Fe=Sd(W,je),0<Fe.length&&(je=new Ol(je,s,null,l,se),oe.push({event:je,listeners:Fe}),_e?je.data=_e:(_e=de(l),_e!==null&&(je.data=_e)))),(_e=y?kt(s,l):Qe(s,l))&&(je=Sd(W,"onBeforeInput"),0<je.length&&(Fe=new Ol("onBeforeInput","beforeinput",null,l,se),oe.push({event:Fe,listeners:je}),Fe.data=_e)),fC(oe,s,W,l,se)}AE(oe,i)})}function hc(s,i,l){return{instance:s,listener:i,currentTarget:l}}function Sd(s,i){for(var l=i+"Capture",u=[];s!==null;){var m=s,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=er(s,l),m!=null&&u.unshift(hc(s,m,g)),m=er(s,i),m!=null&&u.push(hc(s,m,g))),s.tag===3)return u;s=s.return}return[]}function wo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function CE(s,i,l,u,m){for(var g=i._reactName,x=[];l!==null&&l!==u;){var S=l,q=S.alternate,W=S.stateNode;if(S=S.tag,q!==null&&q===u)break;S!==5&&S!==26&&S!==27||W===null||(q=W,m?(W=er(l,g),W!=null&&x.unshift(hc(l,W,q))):m||(W=er(l,g),W!=null&&x.push(hc(l,W,q)))),l=l.return}x.length!==0&&s.push({event:i,listeners:x})}var vC=/\r\n?/g,yC=/\u0000|\uFFFD/g;function SE(s){return(typeof s=="string"?s:""+s).replace(vC,`
`).replace(yC,"")}function wE(s,i){return i=SE(i),SE(s)===i}function wd(){}function lt(s,i,l,u,m,g){switch(l){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||Zn(s,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&Zn(s,""+u);break;case"className":ws(s,"class",u);break;case"tabIndex":ws(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":ws(s,l,u);break;case"style":Cl(s,u,g);break;case"data":if(i!=="object"){ws(s,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Qr(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(i!=="input"&&lt(s,i,"name",m.name,m,null),lt(s,i,"formEncType",m.formEncType,m,null),lt(s,i,"formMethod",m.formMethod,m,null),lt(s,i,"formTarget",m.formTarget,m,null)):(lt(s,i,"encType",m.encType,m,null),lt(s,i,"method",m.method,m,null),lt(s,i,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Qr(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=wd);break;case"onScroll":u!=null&&Be("scroll",s);break;case"onScrollEnd":u!=null&&Be("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Qr(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":Be("beforetoggle",s),Be("toggle",s),Ba(s,"popover",u);break;case"xlinkActuate":Jt(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Jt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Jt(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Jt(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Jt(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Jt(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ba(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Nf.get(l)||l,Ba(s,l,u))}}function Jm(s,i,l,u,m,g){switch(l){case"style":Cl(s,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"children":typeof u=="string"?Zn(s,u):(typeof u=="number"||typeof u=="bigint")&&Zn(s,""+u);break;case"onScroll":u!=null&&Be("scroll",s);break;case"onScrollEnd":u!=null&&Be("scrollend",s);break;case"onClick":u!=null&&(s.onclick=wd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zr.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),i=l.slice(2,m?l.length-7:void 0),g=s[wt]||null,g=g!=null?g[l]:null,typeof g=="function"&&s.removeEventListener(i,g,m),typeof u=="function")){typeof g!="function"&&g!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(i,u,m);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):Ba(s,l,u)}}}function sn(s,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Be("error",s),Be("load",s);var u=!1,m=!1,g;for(g in l)if(l.hasOwnProperty(g)){var x=l[g];if(x!=null)switch(g){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:lt(s,i,g,x,l,null)}}m&&lt(s,i,"srcSet",l.srcSet,l,null),u&&lt(s,i,"src",l.src,l,null);return;case"input":Be("invalid",s);var S=g=x=m=null,q=null,W=null;for(u in l)if(l.hasOwnProperty(u)){var se=l[u];if(se!=null)switch(u){case"name":m=se;break;case"type":x=se;break;case"checked":q=se;break;case"defaultChecked":W=se;break;case"value":g=se;break;case"defaultValue":S=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(a(137,i));break;default:lt(s,i,u,se,l,null)}}Wi(s,g,S,q,W,x,m,!1),Kr(s);return;case"select":Be("invalid",s),u=x=g=null;for(m in l)if(l.hasOwnProperty(m)&&(S=l[m],S!=null))switch(m){case"value":g=S;break;case"defaultValue":x=S;break;case"multiple":u=S;default:lt(s,i,m,S,l,null)}i=g,l=x,s.multiple=!!u,i!=null?ia(s,!!u,i,!1):l!=null&&ia(s,!!u,l,!0);return;case"textarea":Be("invalid",s),g=m=u=null;for(x in l)if(l.hasOwnProperty(x)&&(S=l[x],S!=null))switch(x){case"value":u=S;break;case"defaultValue":m=S;break;case"children":g=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(a(91));break;default:lt(s,i,x,S,l,null)}Zi(s,u,m,g),Kr(s);return;case"option":for(q in l)if(l.hasOwnProperty(q)&&(u=l[q],u!=null))switch(q){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:lt(s,i,q,u,l,null)}return;case"dialog":Be("beforetoggle",s),Be("toggle",s),Be("cancel",s),Be("close",s);break;case"iframe":case"object":Be("load",s);break;case"video":case"audio":for(u=0;u<dc.length;u++)Be(dc[u],s);break;case"image":Be("error",s),Be("load",s);break;case"details":Be("toggle",s);break;case"embed":case"source":case"link":Be("error",s),Be("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in l)if(l.hasOwnProperty(W)&&(u=l[W],u!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:lt(s,i,W,u,l,null)}return;default:if(Sl(i)){for(se in l)l.hasOwnProperty(se)&&(u=l[se],u!==void 0&&Jm(s,i,se,u,l,void 0));return}}for(S in l)l.hasOwnProperty(S)&&(u=l[S],u!=null&&lt(s,i,S,u,l,null))}function _C(s,i,l,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,x=null,S=null,q=null,W=null,se=null;for(ee in l){var oe=l[ee];if(l.hasOwnProperty(ee)&&oe!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":q=oe;default:u.hasOwnProperty(ee)||lt(s,i,ee,null,u,oe)}}for(var Z in u){var ee=u[Z];if(oe=l[Z],u.hasOwnProperty(Z)&&(ee!=null||oe!=null))switch(Z){case"type":g=ee;break;case"name":m=ee;break;case"checked":W=ee;break;case"defaultChecked":se=ee;break;case"value":x=ee;break;case"defaultValue":S=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(a(137,i));break;default:ee!==oe&&lt(s,i,Z,ee,u,oe)}}kn(s,x,S,q,W,se,g,m);return;case"select":ee=x=S=Z=null;for(g in l)if(q=l[g],l.hasOwnProperty(g)&&q!=null)switch(g){case"value":break;case"multiple":ee=q;default:u.hasOwnProperty(g)||lt(s,i,g,null,u,q)}for(m in u)if(g=u[m],q=l[m],u.hasOwnProperty(m)&&(g!=null||q!=null))switch(m){case"value":Z=g;break;case"defaultValue":S=g;break;case"multiple":x=g;default:g!==q&&lt(s,i,m,g,u,q)}i=S,l=x,u=ee,Z!=null?ia(s,!!l,Z,!1):!!u!=!!l&&(i!=null?ia(s,!!l,i,!0):ia(s,!!l,l?[]:"",!1));return;case"textarea":ee=Z=null;for(S in l)if(m=l[S],l.hasOwnProperty(S)&&m!=null&&!u.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:lt(s,i,S,null,u,m)}for(x in u)if(m=u[x],g=l[x],u.hasOwnProperty(x)&&(m!=null||g!=null))switch(x){case"value":Z=m;break;case"defaultValue":ee=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(a(91));break;default:m!==g&&lt(s,i,x,m,u,g)}rt(s,Z,ee);return;case"option":for(var we in l)if(Z=l[we],l.hasOwnProperty(we)&&Z!=null&&!u.hasOwnProperty(we))switch(we){case"selected":s.selected=!1;break;default:lt(s,i,we,null,u,Z)}for(q in u)if(Z=u[q],ee=l[q],u.hasOwnProperty(q)&&Z!==ee&&(Z!=null||ee!=null))switch(q){case"selected":s.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:lt(s,i,q,Z,u,ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in l)Z=l[Ae],l.hasOwnProperty(Ae)&&Z!=null&&!u.hasOwnProperty(Ae)&&lt(s,i,Ae,null,u,Z);for(W in u)if(Z=u[W],ee=l[W],u.hasOwnProperty(W)&&Z!==ee&&(Z!=null||ee!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(a(137,i));break;default:lt(s,i,W,Z,u,ee)}return;default:if(Sl(i)){for(var ct in l)Z=l[ct],l.hasOwnProperty(ct)&&Z!==void 0&&!u.hasOwnProperty(ct)&&Jm(s,i,ct,void 0,u,Z);for(se in u)Z=u[se],ee=l[se],!u.hasOwnProperty(se)||Z===ee||Z===void 0&&ee===void 0||Jm(s,i,se,Z,u,ee);return}}for(var G in l)Z=l[G],l.hasOwnProperty(G)&&Z!=null&&!u.hasOwnProperty(G)&&lt(s,i,G,null,u,Z);for(oe in u)Z=u[oe],ee=l[oe],!u.hasOwnProperty(oe)||Z===ee||Z==null&&ee==null||lt(s,i,oe,Z,u,ee)}var ep=null,tp=null;function Id(s){return s.nodeType===9?s:s.ownerDocument}function IE(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function RE(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function np(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var sp=null;function EC(){var s=window.event;return s&&s.type==="popstate"?s===sp?!1:(sp=s,!0):(sp=null,!1)}var DE=typeof setTimeout=="function"?setTimeout:void 0,bC=typeof clearTimeout=="function"?clearTimeout:void 0,OE=typeof Promise=="function"?Promise:void 0,NC=typeof queueMicrotask=="function"?queueMicrotask:typeof OE<"u"?function(s){return OE.resolve(null).then(s).catch(xC)}:DE;function xC(s){setTimeout(function(){throw s})}function ri(s){return s==="head"}function ME(s,i){var l=i,u=0,m=0;do{var g=l.nextSibling;if(s.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(0<u&&8>u){l=u;var x=s.ownerDocument;if(l&1&&fc(x.documentElement),l&2&&fc(x.body),l&4)for(l=x.head,fc(l),x=l.firstChild;x;){var S=x.nextSibling,q=x.nodeName;x[Yi]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&x.rel.toLowerCase()==="stylesheet"||l.removeChild(x),x=S}}if(m===0){s.removeChild(g),bc(i);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:u=l.charCodeAt(0)-48;else u=0;l=g}while(l);bc(i)}function ap(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":ap(l),qa(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function TC(s,i,l,u){for(;s.nodeType===1;){var m=l;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Yi])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(g=s.getAttribute("rel"),g==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(g!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(g=s.getAttribute("src"),(g!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===g)return s}else return s;if(s=vs(s.nextSibling),s===null)break}return null}function AC(s,i,l){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=vs(s.nextSibling),s===null))return null;return s}function ip(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function jC(s,i){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")i();else{var u=function(){i(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function vs(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var rp=null;function PE(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(i===0)return s;i--}else l==="/$"&&i++}s=s.previousSibling}return null}function kE(s,i,l){switch(i=Id(l),s){case"html":if(s=i.documentElement,!s)throw Error(a(452));return s;case"head":if(s=i.head,!s)throw Error(a(453));return s;case"body":if(s=i.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function fc(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);qa(s)}var ls=new Map,LE=new Set;function Rd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ta=J.d;J.d={f:CC,r:SC,D:wC,C:IC,L:RC,m:DC,X:MC,S:OC,M:PC};function CC(){var s=Ta.f(),i=Nd();return s||i}function SC(s){var i=Cs(s);i!==null&&i.tag===5&&i.type==="form"?s_(i):Ta.r(s)}var Io=typeof document>"u"?null:document;function VE(s,i,l){var u=Io;if(u&&typeof i=="string"&&i){var m=It(i);m='link[rel="'+s+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),LE.has(m)||(LE.add(m),s={rel:s,crossOrigin:l,href:i},u.querySelector(m)===null&&(i=u.createElement("link"),sn(i,"link",s),At(i),u.head.appendChild(i)))}}function wC(s){Ta.D(s),VE("dns-prefetch",s,null)}function IC(s,i){Ta.C(s,i),VE("preconnect",s,i)}function RC(s,i,l){Ta.L(s,i,l);var u=Io;if(u&&s&&i){var m='link[rel="preload"][as="'+It(i)+'"]';i==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+It(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+It(l.imageSizes)+'"]')):m+='[href="'+It(s)+'"]';var g=m;switch(i){case"style":g=Ro(s);break;case"script":g=Do(s)}ls.has(g)||(s=_({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:s,as:i},l),ls.set(g,s),u.querySelector(m)!==null||i==="style"&&u.querySelector(mc(g))||i==="script"&&u.querySelector(pc(g))||(i=u.createElement("link"),sn(i,"link",s),At(i),u.head.appendChild(i)))}}function DC(s,i){Ta.m(s,i);var l=Io;if(l&&s){var u=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+It(u)+'"][href="'+It(s)+'"]',g=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Do(s)}if(!ls.has(g)&&(s=_({rel:"modulepreload",href:s},i),ls.set(g,s),l.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(pc(g)))return}u=l.createElement("link"),sn(u,"link",s),At(u),l.head.appendChild(u)}}}function OC(s,i,l){Ta.S(s,i,l);var u=Io;if(u&&s){var m=En(u).hoistableStyles,g=Ro(s);i=i||"default";var x=m.get(g);if(!x){var S={loading:0,preload:null};if(x=u.querySelector(mc(g)))S.loading=5;else{s=_({rel:"stylesheet",href:s,"data-precedence":i},l),(l=ls.get(g))&&op(s,l);var q=x=u.createElement("link");At(q),sn(q,"link",s),q._p=new Promise(function(W,se){q.onload=W,q.onerror=se}),q.addEventListener("load",function(){S.loading|=1}),q.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Dd(x,i,u)}x={type:"stylesheet",instance:x,count:1,state:S},m.set(g,x)}}}function MC(s,i){Ta.X(s,i);var l=Io;if(l&&s){var u=En(l).hoistableScripts,m=Do(s),g=u.get(m);g||(g=l.querySelector(pc(m)),g||(s=_({src:s,async:!0},i),(i=ls.get(m))&&lp(s,i),g=l.createElement("script"),At(g),sn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function PC(s,i){Ta.M(s,i);var l=Io;if(l&&s){var u=En(l).hoistableScripts,m=Do(s),g=u.get(m);g||(g=l.querySelector(pc(m)),g||(s=_({src:s,async:!0,type:"module"},i),(i=ls.get(m))&&lp(s,i),g=l.createElement("script"),At(g),sn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function UE(s,i,l,u){var m=(m=Ie.current)?Rd(m):null;if(!m)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=Ro(l.href),l=En(m).hoistableStyles,u=l.get(i),u||(u={type:"style",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Ro(l.href);var g=En(m).hoistableStyles,x=g.get(s);if(x||(m=m.ownerDocument||m,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(s,x),(g=m.querySelector(mc(s)))&&!g._p&&(x.instance=g,x.state.loading=5),ls.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ls.set(s,l),g||kC(m,s,l,x.state))),i&&u===null)throw Error(a(528,""));return x}if(i&&u!==null)throw Error(a(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Do(l),l=En(m).hoistableScripts,u=l.get(i),u||(u={type:"script",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Ro(s){return'href="'+It(s)+'"'}function mc(s){return'link[rel="stylesheet"]['+s+"]"}function FE(s){return _({},s,{"data-precedence":s.precedence,precedence:null})}function kC(s,i,l,u){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=s.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),sn(i,"link",l),At(i),s.head.appendChild(i))}function Do(s){return'[src="'+It(s)+'"]'}function pc(s){return"script[async]"+s}function qE(s,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var u=s.querySelector('style[data-href~="'+It(l.href)+'"]');if(u)return i.instance=u,At(u),u;var m=_({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),At(u),sn(u,"style",m),Dd(u,l.precedence,s),i.instance=u;case"stylesheet":m=Ro(l.href);var g=s.querySelector(mc(m));if(g)return i.state.loading|=4,i.instance=g,At(g),g;u=FE(l),(m=ls.get(m))&&op(u,m),g=(s.ownerDocument||s).createElement("link"),At(g);var x=g;return x._p=new Promise(function(S,q){x.onload=S,x.onerror=q}),sn(g,"link",u),i.state.loading|=4,Dd(g,l.precedence,s),i.instance=g;case"script":return g=Do(l.src),(m=s.querySelector(pc(g)))?(i.instance=m,At(m),m):(u=l,(m=ls.get(g))&&(u=_({},l),lp(u,m)),s=s.ownerDocument||s,m=s.createElement("script"),At(m),sn(m,"link",u),s.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,Dd(u,l.precedence,s));return i.instance}function Dd(s,i,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,g=m,x=0;x<u.length;x++){var S=u[x];if(S.dataset.precedence===i)g=S;else if(g!==m)break}g?g.parentNode.insertBefore(s,g.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(s,i.firstChild))}function op(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function lp(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var Od=null;function BE(s,i,l){if(Od===null){var u=new Map,m=Od=new Map;m.set(l,u)}else m=Od,u=m.get(l),u||(u=new Map,m.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),m=0;m<l.length;m++){var g=l[m];if(!(g[Yi]||g[Pt]||s==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var x=g.getAttribute(i)||"";x=s+x;var S=u.get(x);S?S.push(g):u.set(x,[g])}}return u}function HE(s,i,l){s=s.ownerDocument||s,s.head.insertBefore(l,i==="title"?s.querySelector("head > title"):null)}function LC(s,i,l){if(l===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function zE(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var gc=null;function VC(){}function UC(s,i,l){if(gc===null)throw Error(a(475));var u=gc;if(i.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var m=Ro(l.href),g=s.querySelector(mc(m));if(g){s=g._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(u.count++,u=Md.bind(u),s.then(u,u)),i.state.loading|=4,i.instance=g,At(g);return}g=s.ownerDocument||s,l=FE(l),(m=ls.get(m))&&op(l,m),g=g.createElement("link"),At(g);var x=g;x._p=new Promise(function(S,q){x.onload=S,x.onerror=q}),sn(g,"link",l),i.instance=g}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(u.count++,i=Md.bind(u),s.addEventListener("load",i),s.addEventListener("error",i))}}function FC(){if(gc===null)throw Error(a(475));var s=gc;return s.stylesheets&&s.count===0&&cp(s,s.stylesheets),0<s.count?function(i){var l=setTimeout(function(){if(s.stylesheets&&cp(s,s.stylesheets),s.unsuspend){var u=s.unsuspend;s.unsuspend=null,u()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(l)}}:null}function Md(){if(this.count--,this.count===0){if(this.stylesheets)cp(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Pd=null;function cp(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Pd=new Map,i.forEach(qC,s),Pd=null,Md.call(s))}function qC(s,i){if(!(i.state.loading&4)){var l=Pd.get(s);if(l)var u=l.get(null);else{l=new Map,Pd.set(s,l);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var x=m[g];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(l.set(x.dataset.precedence,x),u=x)}u&&l.set(null,u)}m=i.instance,x=m.getAttribute("data-precedence"),g=l.get(x)||u,g===u&&l.set(null,m),l.set(x,m),this.count++,u=Md.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),g?g.parentNode.insertBefore(m,g.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),i.state.loading|=4}}var vc={$$typeof:O,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function BC(s,i,l,u,m,g,x,S){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ea(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ea(0),this.hiddenUpdates=ea(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=S,this.incompleteTransitions=new Map}function GE(s,i,l,u,m,g,x,S,q,W,se,oe){return s=new BC(s,i,l,x,S,q,W,oe),i=1,g===!0&&(i|=24),g=Vn(3,null,null,i),s.current=g,g.stateNode=s,i=zf(),i.refCount++,s.pooledCache=i,i.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:i},Kf(g),s}function $E(s){return s?(s=lo,s):lo}function YE(s,i,l,u,m,g){m=$E(m),u.context===null?u.context=m:u.pendingContext=m,u=Ya(i),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=Ka(s,u,i),l!==null&&(Hn(l,s,i),Yl(l,s,i))}function KE(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<i?l:i}}function up(s,i){KE(s,i),(s=s.alternate)&&KE(s,i)}function QE(s){if(s.tag===13){var i=oo(s,67108864);i!==null&&Hn(i,s,67108864),up(s,67108864)}}var kd=!0;function HC(s,i,l,u){var m=H.T;H.T=null;var g=J.p;try{J.p=2,dp(s,i,l,u)}finally{J.p=g,H.T=m}}function zC(s,i,l,u){var m=H.T;H.T=null;var g=J.p;try{J.p=8,dp(s,i,l,u)}finally{J.p=g,H.T=m}}function dp(s,i,l,u){if(kd){var m=hp(u);if(m===null)Zm(s,i,u,Ld,l),WE(s,u);else if($C(m,s,i,l,u))u.stopPropagation();else if(WE(s,u),i&4&&-1<GC.indexOf(s)){for(;m!==null;){var g=Cs(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var x=hs(g.pendingLanes);if(x!==0){var S=g;for(S.pendingLanes|=2,S.entangledLanes|=2;x;){var q=1<<31-hn(x);S.entanglements[1]|=q,x&=~q}qs(g),(at&6)===0&&(Ed=Xn()+500,uc(0))}}break;case 13:S=oo(g,2),S!==null&&Hn(S,g,2),Nd(),up(g,2)}if(g=hp(u),g===null&&Zm(s,i,u,Ld,l),g===m)break;m=g}m!==null&&u.stopPropagation()}else Zm(s,i,u,null,l)}}function hp(s){return s=Jn(s),fp(s)}var Ld=null;function fp(s){if(Ld=null,s=na(s),s!==null){var i=c(s);if(i===null)s=null;else{var l=i.tag;if(l===13){if(s=d(i),s!==null)return s;s=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Ld=s,null}function XE(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gf()){case pl:return 2;case Fr:return 8;case Bi:case vf:return 32;case qr:return 268435456;default:return 32}default:return 32}}var mp=!1,oi=null,li=null,ci=null,yc=new Map,_c=new Map,ui=[],GC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function WE(s,i){switch(s){case"focusin":case"focusout":oi=null;break;case"dragenter":case"dragleave":li=null;break;case"mouseover":case"mouseout":ci=null;break;case"pointerover":case"pointerout":yc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":_c.delete(i.pointerId)}}function Ec(s,i,l,u,m,g){return s===null||s.nativeEvent!==g?(s={blockedOn:i,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[m]},i!==null&&(i=Cs(i),i!==null&&QE(i)),s):(s.eventSystemFlags|=u,i=s.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),s)}function $C(s,i,l,u,m){switch(i){case"focusin":return oi=Ec(oi,s,i,l,u,m),!0;case"dragenter":return li=Ec(li,s,i,l,u,m),!0;case"mouseover":return ci=Ec(ci,s,i,l,u,m),!0;case"pointerover":var g=m.pointerId;return yc.set(g,Ec(yc.get(g)||null,s,i,l,u,m)),!0;case"gotpointercapture":return g=m.pointerId,_c.set(g,Ec(_c.get(g)||null,s,i,l,u,m)),!0}return!1}function ZE(s){var i=na(s.target);if(i!==null){var l=c(i);if(l!==null){if(i=l.tag,i===13){if(i=d(l),i!==null){s.blockedOn=i,Nu(s.priority,function(){if(l.tag===13){var u=Bn();u=Va(u);var m=oo(l,u);m!==null&&Hn(m,l,u),up(l,u)}});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Vd(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var l=hp(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);ra=u,l.target.dispatchEvent(u),ra=null}else return i=Cs(l),i!==null&&QE(i),s.blockedOn=l,!1;i.shift()}return!0}function JE(s,i,l){Vd(s)&&l.delete(i)}function YC(){mp=!1,oi!==null&&Vd(oi)&&(oi=null),li!==null&&Vd(li)&&(li=null),ci!==null&&Vd(ci)&&(ci=null),yc.forEach(JE),_c.forEach(JE)}function Ud(s,i){s.blockedOn===i&&(s.blockedOn=null,mp||(mp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,YC)))}var Fd=null;function eb(s){Fd!==s&&(Fd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Fd===s&&(Fd=null);for(var i=0;i<s.length;i+=3){var l=s[i],u=s[i+1],m=s[i+2];if(typeof u!="function"){if(fp(u||l)===null)continue;break}var g=Cs(l);g!==null&&(s.splice(i,3),i-=3,fm(g,{pending:!0,data:m,method:l.method,action:u},u,m))}}))}function bc(s){function i(q){return Ud(q,s)}oi!==null&&Ud(oi,s),li!==null&&Ud(li,s),ci!==null&&Ud(ci,s),yc.forEach(i),_c.forEach(i);for(var l=0;l<ui.length;l++){var u=ui[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<ui.length&&(l=ui[0],l.blockedOn===null);)ZE(l),l.blockedOn===null&&ui.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var m=l[u],g=l[u+1],x=m[wt]||null;if(typeof g=="function")x||eb(l);else if(x){var S=null;if(g&&g.hasAttribute("formAction")){if(m=g,x=g[wt]||null)S=x.formAction;else if(fp(m)!==null)continue}else S=x.action;typeof S=="function"?l[u+1]=S:(l.splice(u,3),u-=3),eb(l)}}}function pp(s){this._internalRoot=s}qd.prototype.render=pp.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(a(409));var l=i.current,u=Bn();YE(l,u,s,i,null,null)},qd.prototype.unmount=pp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;YE(s.current,2,null,s,null,null),Nd(),i[Wn]=null}};function qd(s){this._internalRoot=s}qd.prototype.unstable_scheduleHydration=function(s){if(s){var i=Ua();s={blockedOn:null,target:s,priority:i};for(var l=0;l<ui.length&&i!==0&&i<ui[l].priority;l++);ui.splice(l,0,s),l===0&&ZE(s)}};var tb=e.version;if(tb!=="19.1.0")throw Error(a(527,tb,"19.1.0"));J.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=p(i),s=s!==null?v(s):null,s=s===null?null:s.stateNode,s};var KC={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bd.isDisabled&&Bd.supportsFiber)try{Et=Bd.inject(KC),st=Bd}catch{}}return xc.createRoot=function(s,i){if(!o(s))throw Error(a(299));var l=!1,u="",m=v_,g=y_,x=__,S=null;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(g=i.onCaughtError),i.onRecoverableError!==void 0&&(x=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(S=i.unstable_transitionCallbacks)),i=GE(s,1,!1,null,null,l,u,m,g,x,S,null),s[Wn]=i.current,Wm(s),new pp(i)},xc.hydrateRoot=function(s,i,l){if(!o(s))throw Error(a(299));var u=!1,m="",g=v_,x=y_,S=__,q=null,W=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(x=l.onCaughtError),l.onRecoverableError!==void 0&&(S=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(q=l.unstable_transitionCallbacks),l.formState!==void 0&&(W=l.formState)),i=GE(s,1,!0,i,l??null,u,m,g,x,S,q,W),i.context=$E(null),l=i.current,u=Bn(),u=Va(u),m=Ya(u),m.callback=null,Ka(l,m,u),l=u,i.current.lanes=l,ta(i,l),qs(i),s[Wn]=i.current,Wm(s),new qd(i)},xc.version="19.1.0",xc}var db;function aS(){if(db)return yp.exports;db=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),yp.exports=sS(),yp.exports}var iS=aS();const rS=()=>{};var hb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx=function(n){const e=[];let t=0;for(let a=0;a<n.length;a++){let o=n.charCodeAt(a);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&a+1<n.length&&(n.charCodeAt(a+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++a)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},oS=function(n){const e=[];let t=0,a=0;for(;t<n.length;){const o=n[t++];if(o<128)e[a++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[a++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],f=n[t++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|f&63)-65536;e[a++]=String.fromCharCode(55296+(p>>10)),e[a++]=String.fromCharCode(56320+(p&1023))}else{const c=n[t++],d=n[t++];e[a++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},Sx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,f=d?n[o+1]:0,p=o+2<n.length,v=p?n[o+2]:0,_=c>>2,N=(c&3)<<4|f>>4;let j=(f&15)<<2|v>>6,C=v&63;p||(C=64,d||(j=64)),a.push(t[_],t[N],t[j],t[C])}return a.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Cx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):oS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],f=o<n.length?t[n.charAt(o)]:0;++o;const v=o<n.length?t[n.charAt(o)]:64;++o;const N=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||f==null||v==null||N==null)throw new lS;const j=c<<2|f>>4;if(a.push(j),v!==64){const C=f<<4&240|v>>2;if(a.push(C),N!==64){const b=v<<6&192|N;a.push(b)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class lS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const cS=function(n){const e=Cx(n);return Sx.encodeByteArray(e,!0)},uh=function(n){return cS(n).replace(/\./g,"")},wx=function(n){try{return Sx.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dS=()=>uS().__FIREBASE_DEFAULTS__,hS=()=>{if(typeof process>"u"||typeof hb>"u")return;const n=hb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},fS=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&wx(n[1]);return e&&JSON.parse(e)},Lh=()=>{try{return rS()||dS()||hS()||fS()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ix=n=>{var e,t;return(t=(e=Lh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Rx=n=>{const e=Ix(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},Dx=()=>{var n;return(n=Lh())===null||n===void 0?void 0:n.config},Ox=n=>{var e;return(e=Lh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(n){return n.endsWith(".cloudworkstations.dev")}async function Ng(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mx(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${a}`,aud:a,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},n);return[uh(JSON.stringify(t)),uh(JSON.stringify(d)),""].join(".")}const Ic={};function pS(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ic))Ic[e]?n.emulator.push(e):n.prod.push(e);return n}function gS(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let fb=!1;function xg(n,e){if(typeof window>"u"||typeof document>"u"||!Pr(window.location.host)||Ic[n]===e||Ic[n]||fb)return;Ic[n]=e;function t(j){return`__firebase__banner__${j}`}const a="__firebase__banner",c=pS().prod.length>0;function d(){const j=document.getElementById(a);j&&j.remove()}function f(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function p(j,C){j.setAttribute("width","24"),j.setAttribute("id",C),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function v(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{fb=!0,d()},j}function _(j,C){j.setAttribute("id",C),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function N(){const j=gS(a),C=t("text"),b=document.getElementById(C)||document.createElement("span"),M=t("learnmore"),T=document.getElementById(M)||document.createElement("a"),L=t("preprendIcon"),$=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const O=j.element;f(O),_(T,M);const U=v();p($,L),O.append($,b,T,U),document.body.appendChild(O)}c?(b.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",N):N()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_n())}function yS(){var n;const e=(n=Lh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _S(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Px(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ES(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bS(){const n=_n();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function NS(){return!yS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Tg(){try{return typeof indexedDB=="object"}catch{return!1}}function Ag(){return new Promise((n,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(a);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(a),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}function kx(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS="FirebaseError";class ds extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=xS,Object.setPrototypeOf(this,ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oi.prototype.create)}}class Oi{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?TS(c,a):"Error",f=`${this.serviceName}: ${d} (${o}).`;return new ds(o,f,a)}}function TS(n,e){return n.replace(AS,(t,a)=>{const o=e[a];return o!=null?String(o):`<${a}?>`})}const AS=/\{\$([^}]+)}/g;function jS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function xi(n,e){if(n===e)return!0;const t=Object.keys(n),a=Object.keys(e);for(const o of t){if(!a.includes(o))return!1;const c=n[o],d=e[o];if(mb(c)&&mb(d)){if(!xi(c,d))return!1}else if(c!==d)return!1}for(const o of a)if(!t.includes(o))return!1;return!0}function mb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(n){const e=[];for(const[t,a]of Object.entries(n))Array.isArray(a)?a.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function Tc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[o,c]=a.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Ac(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function CS(n,e){const t=new SS(n,e);return t.subscribe.bind(t)}class SS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let o;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");wS(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:a},o.next===void 0&&(o.next=Np),o.error===void 0&&(o.error=Np),o.complete===void 0&&(o.complete=Np);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Np(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS=1e3,RS=2,DS=4*60*60*1e3,OS=.5;function pb(n,e=IS,t=RS){const a=e*Math.pow(t,n),o=Math.round(OS*a*(Math.random()-.5)*2);return Math.min(DS,a+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(n){return n&&n._delegate?n._delegate:n}class Kn{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new mS;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&a.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const a=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(a)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:a})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kS(e))try{this.getOrInitializeService({instanceIdentifier:xr})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});a.resolve(c)}catch{}}}}clearInstance(e=xr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xr){return this.instances.has(e)}getOptions(e=xr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[c,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(c);a===f&&d.resolve(o)}return o}onInit(e,t){var a;const o=this.normalizeInstanceIdentifier(t),c=(a=this.onInitCallbacks.get(o))!==null&&a!==void 0?a:new Set;c.add(e),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&e(d,o),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const o of a)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:PS(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=xr){return this.component?this.component.multipleInstances?e:xr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function PS(n){return n===xr?void 0:n}function kS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new MS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(He||(He={}));const VS={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},US=He.INFO,FS={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},qS=(n,e,...t)=>{if(e<n.logLevel)return;const a=new Date().toISOString(),o=FS[e];if(o)console[o](`[${a}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class tu{constructor(e){this.name=e,this._logLevel=US,this._logHandler=qS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?VS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const BS=(n,e)=>e.some(t=>n instanceof t);let gb,vb;function HS(){return gb||(gb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function zS(){return vb||(vb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Lx=new WeakMap,zp=new WeakMap,Vx=new WeakMap,xp=new WeakMap,jg=new WeakMap;function GS(n){const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(_i(n.result)),o()},d=()=>{a(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&Lx.set(t,n)}).catch(()=>{}),jg.set(e,n),e}function $S(n){if(zp.has(n))return;const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{a(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});zp.set(n,e)}let Gp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return zp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Vx.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return _i(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function YS(n){Gp=n(Gp)}function KS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=n.call(Tp(this),e,...t);return Vx.set(a,e.sort?e.sort():[e]),_i(a)}:zS().includes(n)?function(...e){return n.apply(Tp(this),e),_i(Lx.get(this))}:function(...e){return _i(n.apply(Tp(this),e))}}function QS(n){return typeof n=="function"?KS(n):(n instanceof IDBTransaction&&$S(n),BS(n,HS())?new Proxy(n,Gp):n)}function _i(n){if(n instanceof IDBRequest)return GS(n);if(xp.has(n))return xp.get(n);const e=QS(n);return e!==n&&(xp.set(n,e),jg.set(e,n)),e}const Tp=n=>jg.get(n);function Ux(n,e,{blocked:t,upgrade:a,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),f=_i(d);return a&&d.addEventListener("upgradeneeded",p=>{a(_i(d.result),p.oldVersion,p.newVersion,_i(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),f.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",v=>o(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const XS=["get","getKey","getAll","getAllKeys","count"],WS=["put","add","delete","clear"],Ap=new Map;function yb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ap.get(e))return Ap.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,o=WS.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(o||XS.includes(t)))return;const c=async function(d,...f){const p=this.transaction(d,o?"readwrite":"readonly");let v=p.store;return a&&(v=v.index(f.shift())),(await Promise.all([v[t](...f),o&&p.done]))[0]};return Ap.set(e,c),c}YS(n=>({...n,get:(e,t,a)=>yb(e,t)||n.get(e,t,a),has:(e,t)=>!!yb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(JS(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function JS(n){const e=n.getComponent();return e?.type==="VERSION"}const $p="@firebase/app",_b="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ia=new tu("@firebase/app"),ew="@firebase/app-compat",tw="@firebase/analytics-compat",nw="@firebase/analytics",sw="@firebase/app-check-compat",aw="@firebase/app-check",iw="@firebase/auth",rw="@firebase/auth-compat",ow="@firebase/database",lw="@firebase/data-connect",cw="@firebase/database-compat",uw="@firebase/functions",dw="@firebase/functions-compat",hw="@firebase/installations",fw="@firebase/installations-compat",mw="@firebase/messaging",pw="@firebase/messaging-compat",gw="@firebase/performance",vw="@firebase/performance-compat",yw="@firebase/remote-config",_w="@firebase/remote-config-compat",Ew="@firebase/storage",bw="@firebase/storage-compat",Nw="@firebase/firestore",xw="@firebase/ai",Tw="@firebase/firestore-compat",Aw="firebase",jw="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="[DEFAULT]",Cw={[$p]:"fire-core",[ew]:"fire-core-compat",[nw]:"fire-analytics",[tw]:"fire-analytics-compat",[aw]:"fire-app-check",[sw]:"fire-app-check-compat",[iw]:"fire-auth",[rw]:"fire-auth-compat",[ow]:"fire-rtdb",[lw]:"fire-data-connect",[cw]:"fire-rtdb-compat",[uw]:"fire-fn",[dw]:"fire-fn-compat",[hw]:"fire-iid",[fw]:"fire-iid-compat",[mw]:"fire-fcm",[pw]:"fire-fcm-compat",[gw]:"fire-perf",[vw]:"fire-perf-compat",[yw]:"fire-rc",[_w]:"fire-rc-compat",[Ew]:"fire-gcs",[bw]:"fire-gcs-compat",[Nw]:"fire-fst",[Tw]:"fire-fst-compat",[xw]:"fire-vertex","fire-js":"fire-js",[Aw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dh=new Map,Sw=new Map,Kp=new Map;function Eb(n,e){try{n.container.addComponent(e)}catch(t){Ia.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function cs(n){const e=n.name;if(Kp.has(e))return Ia.debug(`There were multiple attempts to register component ${e}.`),!1;Kp.set(e,n);for(const t of dh.values())Eb(t,n);for(const t of Sw.values())Eb(t,n);return!0}function Ma(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Dn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ei=new Oi("app","Firebase",ww);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,t,a){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new Kn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ei.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr=jw;function Fx(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const a=Object.assign({name:Yp,automaticDataCollectionEnabled:!0},e),o=a.name;if(typeof o!="string"||!o)throw Ei.create("bad-app-name",{appName:String(o)});if(t||(t=Dx()),!t)throw Ei.create("no-options");const c=dh.get(o);if(c){if(xi(t,c.options)&&xi(a,c.config))return c;throw Ei.create("duplicate-app",{appName:o})}const d=new LS(o);for(const p of Kp.values())d.addComponent(p);const f=new Iw(t,a,d);return dh.set(o,f),f}function nu(n=Yp){const e=dh.get(n);if(!e&&n===Yp&&Dx())return Fx();if(!e)throw Ei.create("no-app",{appName:n});return e}function yn(n,e,t){var a;let o=(a=Cw[n])!==null&&a!==void 0?a:n;t&&(o+=`-${t}`);const c=o.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const f=[`Unable to register library "${o}" with version "${e}":`];c&&f.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ia.warn(f.join(" "));return}cs(new Kn(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw="firebase-heartbeat-database",Dw=1,Bc="firebase-heartbeat-store";let jp=null;function qx(){return jp||(jp=Ux(Rw,Dw,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Bc)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ei.create("idb-open",{originalErrorMessage:n.message})})),jp}async function Ow(n){try{const t=(await qx()).transaction(Bc),a=await t.objectStore(Bc).get(Bx(n));return await t.done,a}catch(e){if(e instanceof ds)Ia.warn(e.message);else{const t=Ei.create("idb-get",{originalErrorMessage:e?.message});Ia.warn(t.message)}}}async function bb(n,e){try{const a=(await qx()).transaction(Bc,"readwrite");await a.objectStore(Bc).put(e,Bx(n)),await a.done}catch(t){if(t instanceof ds)Ia.warn(t.message);else{const a=Ei.create("idb-set",{originalErrorMessage:t?.message});Ia.warn(a.message)}}}function Bx(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw=1024,Pw=30;class kw{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Vw(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=Nb();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>Pw){const d=Uw(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){Ia.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Nb(),{heartbeatsToSend:a,unsentEntries:o}=Lw(this._heartbeatsCache.heartbeats),c=uh(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Ia.warn(t),""}}}function Nb(){return new Date().toISOString().substring(0,10)}function Lw(n,e=Mw){const t=[];let a=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),xb(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),xb(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class Vw{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Tg()?Ag().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Ow(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return bb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return bb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function xb(n){return uh(JSON.stringify({version:2,heartbeats:n})).length}function Uw(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let a=1;a<n.length;a++)n[a].date<t&&(t=n[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(n){cs(new Kn("platform-logger",e=>new ZS(e),"PRIVATE")),cs(new Kn("heartbeat",e=>new kw(e),"PRIVATE")),yn($p,_b,n),yn($p,_b,"esm2017"),yn("fire-js","")}Fw("");function Cg(n,e){var t={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&e.indexOf(a)<0&&(t[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(n);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(n,a[o])&&(t[a[o]]=n[a[o]]);return t}function Hx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const qw=Hx,zx=new Oi("auth","Firebase",Hx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh=new tu("@firebase/auth");function Bw(n,...e){hh.logLevel<=He.WARN&&hh.warn(`Auth (${kr}): ${n}`,...e)}function Zd(n,...e){hh.logLevel<=He.ERROR&&hh.error(`Auth (${kr}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(n,...e){throw wg(n,...e)}function xs(n,...e){return wg(n,...e)}function Sg(n,e,t){const a=Object.assign(Object.assign({},qw()),{[e]:t});return new Oi("auth","Firebase",a).create(e,{appName:n.name})}function wa(n){return Sg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hw(n,e,t){const a=t;if(!(e instanceof a))throw a.name!==e.constructor.name&&us(n,"argument-error"),Sg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function wg(n,...e){if(typeof n!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=n.name),n._errorFactory.create(t,...a)}return zx.create(n,...e)}function Se(n,e,...t){if(!n)throw wg(e,...t)}function Ca(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Zd(e),new Error(e)}function Ra(n,e){n||Ca(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qp(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function zw(){return Tb()==="http:"||Tb()==="https:"}function Tb(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gw(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zw()||Px()||"connection"in navigator)?navigator.onLine:!0}function $w(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ra(t>e,"Short delay should be less than long delay!"),this.isMobile=vS()||ES()}get(){return Gw()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ig(n,e){Ra(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ca("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ca("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ca("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Qw=new su(3e4,6e4);function Mi(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Pi(n,e,t,a,o={}){return $x(n,o,async()=>{let c={},d={};a&&(e==="GET"?d=a:c={body:JSON.stringify(a)});const f=eu(Object.assign({key:n.config.apiKey},d)).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:p},c);return _S()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&Pr(n.emulatorConfig.host)&&(v.credentials="include"),Gx.fetch()(await Yx(n,n.config.apiHost,t,f),v)})}async function $x(n,e,t){n._canInitEmulator=!1;const a=Object.assign(Object.assign({},Yw),e);try{const o=new Ww(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw Hd(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const f=c.ok?d.errorMessage:d.error.message,[p,v]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hd(n,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw Hd(n,"email-already-in-use",d);if(p==="USER_DISABLED")throw Hd(n,"user-disabled",d);const _=a[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw Sg(n,_,v);us(n,_)}}catch(o){if(o instanceof ds)throw o;us(n,"network-request-failed",{message:String(o)})}}async function au(n,e,t,a,o={}){const c=await Pi(n,e,t,a,o);return"mfaPendingCredential"in c&&us(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function Yx(n,e,t,a){const o=`${e}${t}?${a}`,c=n,d=c.config.emulator?Ig(n.config,o):`${n.config.apiScheme}://${o}`;return Kw.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function Xw(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ww{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(xs(this.auth,"network-request-failed")),Qw.get())})}}function Hd(n,e,t){const a={appName:n.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const o=xs(n,e,a);return o.customData._tokenResponse=t,o}function Ab(n){return n!==void 0&&n.enterprise!==void 0}class Zw{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Xw(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Jw(n,e){return Pi(n,"GET","/v2/recaptchaConfig",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eI(n,e){return Pi(n,"POST","/v1/accounts:delete",e)}async function fh(n,e){return Pi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function tI(n,e=!1){const t=pt(n),a=await t.getIdToken(e),o=Rg(a);Se(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:a,authTime:Rc(Cp(o.auth_time)),issuedAtTime:Rc(Cp(o.iat)),expirationTime:Rc(Cp(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Cp(n){return Number(n)*1e3}function Rg(n){const[e,t,a]=n.split(".");if(e===void 0||t===void 0||a===void 0)return Zd("JWT malformed, contained fewer than 3 sections"),null;try{const o=wx(t);return o?JSON.parse(o):(Zd("Failed to decode base64 JWT payload"),null)}catch(o){return Zd("Caught error parsing JWT payload as JSON",o?.toString()),null}}function jb(n){const e=Rg(n);return Se(e,"internal-error"),Se(typeof e.exp<"u","internal-error"),Se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hc(n,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof ds&&nI(a)&&n.auth.currentUser===n&&await n.auth.signOut(),a}}function nI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const a=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),a}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rc(this.lastLoginAt),this.creationTime=Rc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mh(n){var e;const t=n.auth,a=await n.getIdToken(),o=await Hc(n,fh(t,{idToken:a}));Se(o?.users.length,t,"internal-error");const c=o.users[0];n._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?Kx(c.providerUserInfo):[],f=iI(n.providerData,d),p=n.isAnonymous,v=!(n.email&&c.passwordHash)&&!f?.length,_=p?v:!1,N={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:f,metadata:new Xp(c.createdAt,c.lastLoginAt),isAnonymous:_};Object.assign(n,N)}async function aI(n){const e=pt(n);await mh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function iI(n,e){return[...n.filter(a=>!e.some(o=>o.providerId===a.providerId)),...e]}function Kx(n){return n.map(e=>{var{providerId:t}=e,a=Cg(e,["providerId"]);return{providerId:t,uid:a.rawId||"",displayName:a.displayName||null,email:a.email||null,phoneNumber:a.phoneNumber||null,photoURL:a.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rI(n,e){const t=await $x(n,{},async()=>{const a=eu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await Yx(n,o,"/v1/token",`key=${c}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:a};return n.emulatorConfig&&Pr(n.emulatorConfig.host)&&(p.credentials="include"),Gx.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function oI(n,e){return Pi(n,"POST","/v2/accounts:revokeToken",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Se(e.idToken,"internal-error"),Se(typeof e.idToken<"u","internal-error"),Se(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):jb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Se(e.length!==0,"internal-error");const t=jb(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:o,expiresIn:c}=await rI(e,t);this.updateTokensAndExpiration(a,o,Number(c))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:o,expirationTime:c}=t,d=new Ho;return a&&(Se(typeof a=="string","internal-error",{appName:e}),d.refreshToken=a),o&&(Se(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(Se(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ho,this.toJSON())}_performRefresh(){return Ca("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(n,e){Se(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class bs{constructor(e){var{uid:t,auth:a,stsTokenManager:o}=e,c=Cg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=a,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new Xp(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await Hc(this,this.stsTokenManager.getToken(this.auth,e));return Se(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return tI(this,e)}reload(){return aI(this)}_assign(e){this!==e&&(Se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new bs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await mh(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Dn(this.auth.app))return Promise.reject(wa(this.auth));const e=await this.getIdToken();return await Hc(this,eI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var a,o,c,d,f,p,v,_;const N=(a=t.displayName)!==null&&a!==void 0?a:void 0,j=(o=t.email)!==null&&o!==void 0?o:void 0,C=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,b=(d=t.photoURL)!==null&&d!==void 0?d:void 0,M=(f=t.tenantId)!==null&&f!==void 0?f:void 0,T=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,L=(v=t.createdAt)!==null&&v!==void 0?v:void 0,$=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:O,emailVerified:U,isAnonymous:F,providerData:X,stsTokenManager:w}=t;Se(O&&w,e,"internal-error");const A=Ho.fromJSON(this.name,w);Se(typeof O=="string",e,"internal-error"),hi(N,e.name),hi(j,e.name),Se(typeof U=="boolean",e,"internal-error"),Se(typeof F=="boolean",e,"internal-error"),hi(C,e.name),hi(b,e.name),hi(M,e.name),hi(T,e.name),hi(L,e.name),hi($,e.name);const R=new bs({uid:O,auth:e,email:j,emailVerified:U,displayName:N,isAnonymous:F,photoURL:b,phoneNumber:C,tenantId:M,stsTokenManager:A,createdAt:L,lastLoginAt:$});return X&&Array.isArray(X)&&(R.providerData=X.map(I=>Object.assign({},I))),T&&(R._redirectEventId=T),R}static async _fromIdTokenResponse(e,t,a=!1){const o=new Ho;o.updateFromServerResponse(t);const c=new bs({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:a});return await mh(c),c}static async _fromGetAccountInfoResponse(e,t,a){const o=t.users[0];Se(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?Kx(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,f=new Ho;f.updateFromIdToken(a);const p=new bs({uid:o.localId,auth:e,stsTokenManager:f,isAnonymous:d}),v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Xp(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,v),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb=new Map;function Sa(n){Ra(n instanceof Function,"Expected a class definition");let e=Cb.get(n);return e?(Ra(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Cb.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Qx.type="NONE";const Sb=Qx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jd(n,e,t){return`firebase:${n}:${e}:${t}`}class zo{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:o,name:c}=this.auth;this.fullUserKey=Jd(this.userKey,o.apiKey,c),this.fullPersistenceKey=Jd("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await fh(this.auth,{idToken:e}).catch(()=>{});return t?bs._fromGetAccountInfoResponse(this.auth,t,e):null}return bs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new zo(Sa(Sb),e,a);const o=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let c=o[0]||Sa(Sb);const d=Jd(a,e.config.apiKey,e.name);let f=null;for(const v of t)try{const _=await v._get(d);if(_){let N;if(typeof _=="string"){const j=await fh(e,{idToken:_}).catch(()=>{});if(!j)break;N=await bs._fromGetAccountInfoResponse(e,j,_)}else N=bs._fromJSON(e,_);v!==c&&(f=N),c=v;break}}catch{}const p=o.filter(v=>v._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new zo(c,e,a):(c=p[0],f&&await c._set(d,f.toJSON()),await Promise.all(t.map(async v=>{if(v!==c)try{await v._remove(d)}catch{}})),new zo(c,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wb(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Jx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Xx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(tT(e))return"Blackberry";if(nT(e))return"Webos";if(Wx(e))return"Safari";if((e.includes("chrome/")||Zx(e))&&!e.includes("edge/"))return"Chrome";if(eT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=n.match(t);if(a?.length===2)return a[1]}return"Other"}function Xx(n=_n()){return/firefox\//i.test(n)}function Wx(n=_n()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Zx(n=_n()){return/crios\//i.test(n)}function Jx(n=_n()){return/iemobile/i.test(n)}function eT(n=_n()){return/android/i.test(n)}function tT(n=_n()){return/blackberry/i.test(n)}function nT(n=_n()){return/webos/i.test(n)}function Dg(n=_n()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function lI(n=_n()){var e;return Dg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function cI(){return bS()&&document.documentMode===10}function sT(n=_n()){return Dg(n)||eT(n)||nT(n)||tT(n)||/windows phone/i.test(n)||Jx(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aT(n,e=[]){let t;switch(n){case"Browser":t=wb(_n());break;case"Worker":t=`${wb(_n())}-${n}`;break;default:t=n}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${kr}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=c=>new Promise((d,f)=>{try{const p=e(c);d(p)}catch(p){f(p)}});a.onAbort=t,this.queue.push(a);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dI(n,e={}){return Pi(n,"GET","/v2/passwordPolicy",Mi(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI=6;class fI{constructor(e){var t,a,o,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:hI,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(a=e.allowedNonAlphanumericCharacters)===null||a===void 0?void 0:a.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,a,o,c,d,f;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(a=p.meetsMaxPasswordLength)!==null&&a!==void 0?a:!0),p.isValid&&(p.isValid=(o=p.containsLowercaseLetter)!==null&&o!==void 0?o:!0),p.isValid&&(p.isValid=(c=p.containsUppercaseLetter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(d=p.containsNumericCharacter)!==null&&d!==void 0?d:!0),p.isValid&&(p.isValid=(f=p.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),p}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let o=0;o<e.length;o++)a=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(e,t,a,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ib(this),this.idTokenSubscription=new Ib(this),this.beforeStateQueue=new uI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=zx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Sa(t)),this._initializationPromise=this.queue(async()=>{var a,o,c;if(!this._deleted&&(this.persistenceManager=await zo.create(this,e),(a=this._resolvePersistenceManagerAvailable)===null||a===void 0||a.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await fh(this,{idToken:e}),a=await bs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Dn(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const a=await this.assertedPersistence.getCurrentUser();let o=a,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=o?._redirectEventId,p=await this.tryRedirectSignIn(e);(!d||d===f)&&p?.user&&(o=p.user,c=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(o)}catch(d){o=a,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return Se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await mh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$w()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Dn(this.app))return Promise.reject(wa(this));const t=e?pt(e):null;return t&&Se(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Dn(this.app)?Promise.reject(wa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Dn(this.app)?Promise.reject(wa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await dI(this),t=new fI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Oi("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await oI(this,a)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Sa(e)||this._popupRedirectResolver;Se(t,this,"argument-error"),this.redirectPersistenceManager=await zo.create(this,[Sa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,a;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((a=this.redirectUser)===null||a===void 0?void 0:a._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const a=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==a&&(this.lastNotifiedUid=a,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Se(f,this,"internal-error"),f.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,a,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=aT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const a=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());a&&(t["X-Firebase-Client"]=a);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(Dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&Bw(`Error while retrieving App Check token: ${t.error}`),t?.token}}function ki(n){return pt(n)}class Ib{constructor(e){this.auth=e,this.observer=null,this.addObserver=CS(t=>this.observer=t)}get next(){return Se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pI(n){Vh=n}function iT(n){return Vh.loadJS(n)}function gI(){return Vh.recaptchaEnterpriseScript}function vI(){return Vh.gapiScript}function yI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class _I{constructor(){this.enterprise=new EI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class EI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const bI="recaptcha-enterprise",rT="NO_RECAPTCHA";class NI{constructor(e){this.type=bI,this.auth=ki(e)}async verify(e="verify",t=!1){async function a(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,f)=>{Jw(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const v=new Zw(p);return c.tenantId==null?c._agentRecaptchaConfig=v:c._tenantRecaptchaConfigs[c.tenantId]=v,d(v.siteKey)}}).catch(p=>{f(p)})})}function o(c,d,f){const p=window.grecaptcha;Ab(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(v=>{d(v)}).catch(()=>{d(rT)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new _I().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{a(this.auth).then(f=>{if(!t&&Ab(window.grecaptcha))o(f,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=gI();p.length!==0&&(p+=f),iT(p).then(()=>{o(f,c,d)}).catch(v=>{d(v)})}}).catch(f=>{d(f)})})}}async function Rb(n,e,t,a=!1,o=!1){const c=new NI(n);let d;if(o)d=rT;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,v=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return a?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function Wp(n,e,t,a,o){var c;if(!((c=n._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Rb(n,e,t,t==="getOobCode");return a(n,d)}else return a(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Rb(n,e,t,t==="getOobCode");return a(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(n,e){const t=Ma(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(xi(c,e??{}))return o;us(o,"already-initialized")}return t.initialize({options:e})}function TI(n,e){const t=e?.persistence||[],a=(Array.isArray(t)?t:[t]).map(Sa);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(a,e?.popupRedirectResolver)}function AI(n,e,t){const a=ki(n);Se(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const o=!1,c=oT(e),{host:d,port:f}=jI(e),p=f===null?"":`:${f}`,v={url:`${c}//${d}${p}/`},_=Object.freeze({host:d,port:f,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!a._canInitEmulator){Se(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),Se(xi(v,a.config.emulator)&&xi(_,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=v,a.emulatorConfig=_,a.settings.appVerificationDisabledForTesting=!0,Pr(d)?(Ng(`${c}//${d}${p}`),xg("Auth",!0)):CI()}function oT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function jI(n){const e=oT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(a);if(o){const c=o[1];return{host:c,port:Db(a.substr(c.length+1))}}else{const[c,d]=a.split(":");return{host:c,port:Db(d)}}}function Db(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function CI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ca("not implemented")}_getIdTokenResponse(e){return Ca("not implemented")}_linkToIdToken(e,t){return Ca("not implemented")}_getReauthenticationResolver(e){return Ca("not implemented")}}async function SI(n,e){return Pi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wI(n,e){return au(n,"POST","/v1/accounts:signInWithPassword",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function II(n,e){return au(n,"POST","/v1/accounts:signInWithEmailLink",Mi(n,e))}async function RI(n,e){return au(n,"POST","/v1/accounts:signInWithEmailLink",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc extends Og{constructor(e,t,a,o=null){super("password",a),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new zc(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new zc(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wp(e,t,"signInWithPassword",wI);case"emailLink":return II(e,{email:this._email,oobCode:this._password});default:us(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wp(e,a,"signUpPassword",SI);case"emailLink":return RI(e,{idToken:t,email:this._email,oobCode:this._password});default:us(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Go(n,e){return au(n,"POST","/v1/accounts:signInWithIdp",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI="http://localhost";class Sr extends Og{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Sr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):us("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:o}=t,c=Cg(t,["providerId","signInMethod"]);if(!a||!o)return null;const d=new Sr(a,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Go(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,Go(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Go(e,t)}buildRequest(){const e={requestUri:DI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=eu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OI(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function MI(n){const e=Tc(Ac(n)).link,t=e?Tc(Ac(e)).deep_link_id:null,a=Tc(Ac(n)).deep_link_id;return(a?Tc(Ac(a)).link:null)||a||t||e||n}class Mg{constructor(e){var t,a,o,c,d,f;const p=Tc(Ac(e)),v=(t=p.apiKey)!==null&&t!==void 0?t:null,_=(a=p.oobCode)!==null&&a!==void 0?a:null,N=OI((o=p.mode)!==null&&o!==void 0?o:null);Se(v&&_&&N,"argument-error"),this.apiKey=v,this.operation=N,this.code=_,this.continueUrl=(c=p.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=p.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=p.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=MI(e);try{return new Mg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(){this.providerId=il.PROVIDER_ID}static credential(e,t){return zc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=Mg.parseLink(t);return Se(a,"argument-error"),zc._fromEmailAndCode(e,a.code,a.tenantId)}}il.PROVIDER_ID="password";il.EMAIL_PASSWORD_SIGN_IN_METHOD="password";il.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu extends Pg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends iu{constructor(){super("facebook.com")}static credential(e){return Sr._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.FACEBOOK_SIGN_IN_METHOD="facebook.com";mi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja extends iu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Sr._fromParams({providerId:ja.PROVIDER_ID,signInMethod:ja.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ja.credentialFromTaggedObject(e)}static credentialFromError(e){return ja.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return ja.credential(t,a)}catch{return null}}}ja.GOOGLE_SIGN_IN_METHOD="google.com";ja.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends iu{constructor(){super("github.com")}static credential(e){return Sr._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pi.credential(e.oauthAccessToken)}catch{return null}}}pi.GITHUB_SIGN_IN_METHOD="github.com";pi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends iu{constructor(){super("twitter.com")}static credential(e,t){return Sr._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return gi.credential(t,a)}catch{return null}}}gi.TWITTER_SIGN_IN_METHOD="twitter.com";gi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PI(n,e){return au(n,"POST","/v1/accounts:signUp",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,o=!1){const c=await bs._fromIdTokenResponse(e,a,o),d=Ob(a);return new wr({user:c,providerId:d,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const o=Ob(a);return new wr({user:e,providerId:o,_tokenResponse:a,operationType:t})}}function Ob(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph extends ds{constructor(e,t,a,o){var c;super(t.code,t.message),this.operationType=a,this.user=o,Object.setPrototypeOf(this,ph.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,o){return new ph(e,t,a,o)}}function lT(n,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?ph._fromErrorAndOperation(n,c,e,a):c})}async function kI(n,e,t=!1){const a=await Hc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wr._forOperation(n,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LI(n,e,t=!1){const{auth:a}=n;if(Dn(a.app))return Promise.reject(wa(a));const o="reauthenticate";try{const c=await Hc(n,lT(a,o,e,n),t);Se(c.idToken,a,"internal-error");const d=Rg(c.idToken);Se(d,a,"internal-error");const{sub:f}=d;return Se(n.uid===f,a,"user-mismatch"),wr._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&us(a,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cT(n,e,t=!1){if(Dn(n.app))return Promise.reject(wa(n));const a="signIn",o=await lT(n,a,e),c=await wr._fromIdTokenResponse(n,a,o);return t||await n._updateCurrentUser(c.user),c}async function VI(n,e){return cT(ki(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uT(n){const e=ki(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function UI(n,e,t){if(Dn(n.app))return Promise.reject(wa(n));const a=ki(n),d=await Wp(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",PI).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&uT(n),p}),f=await wr._fromIdTokenResponse(a,"signIn",d);return await a._updateCurrentUser(f.user),f}function FI(n,e,t){return Dn(n.app)?Promise.reject(wa(n)):VI(pt(n),il.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&uT(n),a})}function qI(n,e,t,a){return pt(n).onIdTokenChanged(e,t,a)}function BI(n,e,t){return pt(n).beforeAuthStateChanged(e,t)}function HI(n,e,t,a){return pt(n).onAuthStateChanged(e,t,a)}function zI(n){return pt(n).signOut()}const gh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(gh,"1"),this.storage.removeItem(gh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI=1e3,$I=10;class hT extends dT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=sT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),o=this.localCache[t];a!==o&&e(t,o,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,p)=>{this.notifyListeners(d,p)});return}const a=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(a);!t&&this.localCache[a]===d||this.notifyListeners(a,d)},c=this.storage.getItem(a);cI()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,$I):o()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},GI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}hT.type="LOCAL";const YI=hT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT extends dT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}fT.type="SESSION";const mT=fT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const a=new Uh(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:o});const f=Array.from(d).map(async v=>v(t.origin,c)),p=await KI(f);t.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Uh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kg(n="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((f,p)=>{const v=kg("",20);o.port1.start();const _=setTimeout(()=>{p(new Error("unsupported_event"))},a);d={messageChannel:o,onMessage(N){const j=N;if(j.data.eventId===v)switch(j.data.status){case"ack":clearTimeout(_),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),f(j.data.response);break;default:clearTimeout(_),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(){return window}function XI(n){Gs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(){return typeof Gs().WorkerGlobalScope<"u"&&typeof Gs().importScripts=="function"}async function WI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ZI(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function JI(){return pT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT="firebaseLocalStorageDb",eR=1,vh="firebaseLocalStorage",vT="fbase_key";class ru{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Fh(n,e){return n.transaction([vh],e?"readwrite":"readonly").objectStore(vh)}function tR(){const n=indexedDB.deleteDatabase(gT);return new ru(n).toPromise()}function Zp(){const n=indexedDB.open(gT,eR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const a=n.result;try{a.createObjectStore(vh,{keyPath:vT})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const a=n.result;a.objectStoreNames.contains(vh)?e(a):(a.close(),await tR(),e(await Zp()))})})}async function Mb(n,e,t){const a=Fh(n,!0).put({[vT]:e,value:t});return new ru(a).toPromise()}async function nR(n,e){const t=Fh(n,!1).get(e),a=await new ru(t).toPromise();return a===void 0?null:a.value}function Pb(n,e){const t=Fh(n,!0).delete(e);return new ru(t).toPromise()}const sR=800,aR=3;class yT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Zp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>aR)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return pT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Uh._getInstance(JI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await WI(),!this.activeServiceWorker)return;this.sender=new QI(this.activeServiceWorker);const a=await this.sender._send("ping",{},800);a&&!((e=a[0])===null||e===void 0)&&e.fulfilled&&!((t=a[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ZI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Zp();return await Mb(e,gh,"1"),await Pb(e,gh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>Mb(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>nR(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Pb(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Fh(o,!1).getAll();return new ru(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)a.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!a.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),sR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yT.type="LOCAL";const iR=yT;new su(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(n,e){return e?Sa(e):(Se(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg extends Og{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Go(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Go(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Go(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function rR(n){return cT(n.auth,new Lg(n),n.bypassAuthState)}function oR(n){const{auth:e,user:t}=n;return Se(t,e,"internal-error"),LI(t,new Lg(n),n.bypassAuthState)}async function lR(n){const{auth:e,user:t}=n;return Se(t,e,"internal-error"),kI(t,new Lg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e,t,a,o,c=!1){this.auth=e,this.resolver=a,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:o,tenantId:c,error:d,type:f}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:a,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return rR;case"linkViaPopup":case"linkViaRedirect":return lR;case"reauthViaPopup":case"reauthViaRedirect":return oR;default:us(this.auth,"internal-error")}}resolve(e){Ra(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ra(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR=new su(2e3,1e4);async function uR(n,e,t){if(Dn(n.app))return Promise.reject(xs(n,"operation-not-supported-in-this-environment"));const a=ki(n);Hw(n,e,Pg);const o=_T(a,t);return new Tr(a,"signInViaPopup",e,o).executeNotNull()}class Tr extends ET{constructor(e,t,a,o,c){super(e,t,o,c),this.provider=a,this.authWindow=null,this.pollId=null,Tr.currentPopupAction&&Tr.currentPopupAction.cancel(),Tr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Se(e,this.auth,"internal-error"),e}async onExecution(){Ra(this.filter.length===1,"Popup operations only handle one event");const e=kg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(xs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(xs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Tr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,a;if(!((a=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||a===void 0)&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,cR.get())};e()}}Tr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR="pendingRedirect",eh=new Map;class hR extends ET{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=eh.get(this.auth._key());if(!e){try{const a=await fR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}eh.set(this.auth._key(),e)}return this.bypassAuthState||eh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function fR(n,e){const t=gR(e),a=pR(n);if(!await a._isAvailable())return!1;const o=await a._get(t)==="true";return await a._remove(t),o}function mR(n,e){eh.set(n._key(),e)}function pR(n){return Sa(n._redirectPersistence)}function gR(n){return Jd(dR,n.config.apiKey,n.name)}async function vR(n,e,t=!1){if(Dn(n.app))return Promise.reject(wa(n));const a=ki(n),o=_T(a,e),d=await new hR(a,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await a._persistUserIfCurrent(d.user),await a._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yR=10*60*1e3;class _R{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ER(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var a;if(e.error&&!bT(e)){const o=((a=e.error.code)===null||a===void 0?void 0:a.split("auth/")[1])||"internal-error";t.onError(xs(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=yR&&this.cachedEventUids.clear(),this.cachedEventUids.has(kb(e))}saveEventToCache(e){this.cachedEventUids.add(kb(e)),this.lastProcessedEventTime=Date.now()}}function kb(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function bT({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function ER(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bR(n,e={}){return Pi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xR=/^https?/;async function TR(n){if(n.config.emulator)return;const{authorizedDomains:e}=await bR(n);for(const t of e)try{if(AR(t))return}catch{}us(n,"unauthorized-domain")}function AR(n){const e=Qp(),{protocol:t,hostname:a}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&a===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===a}if(!xR.test(t))return!1;if(NR.test(n))return a===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR=new su(3e4,6e4);function Lb(){const n=Gs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function CR(n){return new Promise((e,t)=>{var a,o,c;function d(){Lb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Lb(),t(xs(n,"network-request-failed"))},timeout:jR.get()})}if(!((o=(a=Gs().gapi)===null||a===void 0?void 0:a.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((c=Gs().gapi)===null||c===void 0)&&c.load)d();else{const f=yI("iframefcb");return Gs()[f]=()=>{gapi.load?d():t(xs(n,"network-request-failed"))},iT(`${vI()}?onload=${f}`).catch(p=>t(p))}}).catch(e=>{throw th=null,e})}let th=null;function SR(n){return th=th||CR(n),th}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wR=new su(5e3,15e3),IR="__/auth/iframe",RR="emulator/auth/iframe",DR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},OR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function MR(n){const e=n.config;Se(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ig(e,RR):`https://${n.config.authDomain}/${IR}`,a={apiKey:e.apiKey,appName:n.name,v:kr},o=OR.get(n.config.apiHost);o&&(a.eid=o);const c=n._getFrameworks();return c.length&&(a.fw=c.join(",")),`${t}?${eu(a).slice(1)}`}async function PR(n){const e=await SR(n),t=Gs().gapi;return Se(t,n,"internal-error"),e.open({where:document.body,url:MR(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:DR,dontclear:!0},a=>new Promise(async(o,c)=>{await a.restyle({setHideOnLeave:!1});const d=xs(n,"network-request-failed"),f=Gs().setTimeout(()=>{c(d)},wR.get());function p(){Gs().clearTimeout(f),o(a)}a.ping(p).then(p,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},LR=500,VR=600,UR="_blank",FR="http://localhost";class Vb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function qR(n,e,t,a=LR,o=VR){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-a)/2,0).toString();let f="";const p=Object.assign(Object.assign({},kR),{width:a.toString(),height:o.toString(),top:c,left:d}),v=_n().toLowerCase();t&&(f=Zx(v)?UR:t),Xx(v)&&(e=e||FR,p.scrollbars="yes");const _=Object.entries(p).reduce((j,[C,b])=>`${j}${C}=${b},`,"");if(lI(v)&&f!=="_self")return BR(e||"",f),new Vb(null);const N=window.open(e||"",f,_);Se(N,n,"popup-blocked");try{N.focus()}catch{}return new Vb(N)}function BR(n,e){const t=document.createElement("a");t.href=n,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HR="__/auth/handler",zR="emulator/auth/handler",GR=encodeURIComponent("fac");async function Ub(n,e,t,a,o,c){Se(n.config.authDomain,n,"auth-domain-config-required"),Se(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:a,v:kr,eventId:o};if(e instanceof Pg){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",jS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,N]of Object.entries({}))d[_]=N}if(e instanceof iu){const _=e.getScopes().filter(N=>N!=="");_.length>0&&(d.scopes=_.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const _ of Object.keys(f))f[_]===void 0&&delete f[_];const p=await n._getAppCheckToken(),v=p?`#${GR}=${encodeURIComponent(p)}`:"";return`${$R(n)}?${eu(f).slice(1)}${v}`}function $R({config:n}){return n.emulator?Ig(n,zR):`https://${n.authDomain}/${HR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sp="webStorageSupport";class YR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=mT,this._completeRedirectFn=vR,this._overrideRedirectResult=mR}async _openPopup(e,t,a,o){var c;Ra((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await Ub(e,t,a,Qp(),o);return qR(e,d,kg())}async _openRedirect(e,t,a,o){await this._originValidation(e);const c=await Ub(e,t,a,Qp(),o);return XI(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Ra(c,"If manager is not set, promise should be"),c)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await PR(e),a=new _R(e);return t.register("authEvent",o=>(Se(o?.authEvent,e,"invalid-auth-event"),{status:a.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Sp,{type:Sp},o=>{var c;const d=(c=o?.[0])===null||c===void 0?void 0:c[Sp];d!==void 0&&t(!!d),us(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=TR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return sT()||Wx()||Dg()}}const KR=YR;var Fb="@firebase/auth",qb="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e(a?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function WR(n){cs(new Kn("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=a.options;Se(d&&!d.includes(":"),"invalid-api-key",{appName:a.name});const p={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:aT(n)},v=new mI(a,o,c,p);return TI(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),cs(new Kn("auth-internal",e=>{const t=ki(e.getProvider("auth").getImmediate());return(a=>new QR(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),yn(Fb,qb,XR(n)),yn(Fb,qb,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=5*60,JR=Ox("authIdTokenMaxAge")||ZR;let Bb=null;const e1=n=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>JR)return;const o=t?.token;Bb!==o&&(Bb=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function t1(n=nu()){const e=Ma(n,"auth");if(e.isInitialized())return e.getImmediate();const t=xI(n,{popupRedirectResolver:KR,persistence:[iR,YI,mT]}),a=Ox("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(a,location.origin);if(location.origin===c.origin){const d=e1(c.toString());BI(t,d,()=>d(t.currentUser)),qI(t,f=>d(f))}}const o=Ix("auth");return o&&AI(t,`http://${o}`),t}function n1(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}pI({loadJS(n){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",n),a.onload=e,a.onerror=o=>{const c=xs("internal-error");c.customData=o,t(c)},a.type="text/javascript",a.charset="UTF-8",n1().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});WR("Browser");var s1="firebase",a1="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yn(s1,a1,"app");var Hb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bi,NT;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,A){function R(){}R.prototype=A.prototype,w.D=A.prototype,w.prototype=new R,w.prototype.constructor=w,w.C=function(I,P,V){for(var k=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)k[ke-2]=arguments[ke];return A.prototype[P].apply(I,k)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(a,t),a.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(w,A,R){R||(R=0);var I=Array(16);if(typeof A=="string")for(var P=0;16>P;++P)I[P]=A.charCodeAt(R++)|A.charCodeAt(R++)<<8|A.charCodeAt(R++)<<16|A.charCodeAt(R++)<<24;else for(P=0;16>P;++P)I[P]=A[R++]|A[R++]<<8|A[R++]<<16|A[R++]<<24;A=w.g[0],R=w.g[1],P=w.g[2];var V=w.g[3],k=A+(V^R&(P^V))+I[0]+3614090360&4294967295;A=R+(k<<7&4294967295|k>>>25),k=V+(P^A&(R^P))+I[1]+3905402710&4294967295,V=A+(k<<12&4294967295|k>>>20),k=P+(R^V&(A^R))+I[2]+606105819&4294967295,P=V+(k<<17&4294967295|k>>>15),k=R+(A^P&(V^A))+I[3]+3250441966&4294967295,R=P+(k<<22&4294967295|k>>>10),k=A+(V^R&(P^V))+I[4]+4118548399&4294967295,A=R+(k<<7&4294967295|k>>>25),k=V+(P^A&(R^P))+I[5]+1200080426&4294967295,V=A+(k<<12&4294967295|k>>>20),k=P+(R^V&(A^R))+I[6]+2821735955&4294967295,P=V+(k<<17&4294967295|k>>>15),k=R+(A^P&(V^A))+I[7]+4249261313&4294967295,R=P+(k<<22&4294967295|k>>>10),k=A+(V^R&(P^V))+I[8]+1770035416&4294967295,A=R+(k<<7&4294967295|k>>>25),k=V+(P^A&(R^P))+I[9]+2336552879&4294967295,V=A+(k<<12&4294967295|k>>>20),k=P+(R^V&(A^R))+I[10]+4294925233&4294967295,P=V+(k<<17&4294967295|k>>>15),k=R+(A^P&(V^A))+I[11]+2304563134&4294967295,R=P+(k<<22&4294967295|k>>>10),k=A+(V^R&(P^V))+I[12]+1804603682&4294967295,A=R+(k<<7&4294967295|k>>>25),k=V+(P^A&(R^P))+I[13]+4254626195&4294967295,V=A+(k<<12&4294967295|k>>>20),k=P+(R^V&(A^R))+I[14]+2792965006&4294967295,P=V+(k<<17&4294967295|k>>>15),k=R+(A^P&(V^A))+I[15]+1236535329&4294967295,R=P+(k<<22&4294967295|k>>>10),k=A+(P^V&(R^P))+I[1]+4129170786&4294967295,A=R+(k<<5&4294967295|k>>>27),k=V+(R^P&(A^R))+I[6]+3225465664&4294967295,V=A+(k<<9&4294967295|k>>>23),k=P+(A^R&(V^A))+I[11]+643717713&4294967295,P=V+(k<<14&4294967295|k>>>18),k=R+(V^A&(P^V))+I[0]+3921069994&4294967295,R=P+(k<<20&4294967295|k>>>12),k=A+(P^V&(R^P))+I[5]+3593408605&4294967295,A=R+(k<<5&4294967295|k>>>27),k=V+(R^P&(A^R))+I[10]+38016083&4294967295,V=A+(k<<9&4294967295|k>>>23),k=P+(A^R&(V^A))+I[15]+3634488961&4294967295,P=V+(k<<14&4294967295|k>>>18),k=R+(V^A&(P^V))+I[4]+3889429448&4294967295,R=P+(k<<20&4294967295|k>>>12),k=A+(P^V&(R^P))+I[9]+568446438&4294967295,A=R+(k<<5&4294967295|k>>>27),k=V+(R^P&(A^R))+I[14]+3275163606&4294967295,V=A+(k<<9&4294967295|k>>>23),k=P+(A^R&(V^A))+I[3]+4107603335&4294967295,P=V+(k<<14&4294967295|k>>>18),k=R+(V^A&(P^V))+I[8]+1163531501&4294967295,R=P+(k<<20&4294967295|k>>>12),k=A+(P^V&(R^P))+I[13]+2850285829&4294967295,A=R+(k<<5&4294967295|k>>>27),k=V+(R^P&(A^R))+I[2]+4243563512&4294967295,V=A+(k<<9&4294967295|k>>>23),k=P+(A^R&(V^A))+I[7]+1735328473&4294967295,P=V+(k<<14&4294967295|k>>>18),k=R+(V^A&(P^V))+I[12]+2368359562&4294967295,R=P+(k<<20&4294967295|k>>>12),k=A+(R^P^V)+I[5]+4294588738&4294967295,A=R+(k<<4&4294967295|k>>>28),k=V+(A^R^P)+I[8]+2272392833&4294967295,V=A+(k<<11&4294967295|k>>>21),k=P+(V^A^R)+I[11]+1839030562&4294967295,P=V+(k<<16&4294967295|k>>>16),k=R+(P^V^A)+I[14]+4259657740&4294967295,R=P+(k<<23&4294967295|k>>>9),k=A+(R^P^V)+I[1]+2763975236&4294967295,A=R+(k<<4&4294967295|k>>>28),k=V+(A^R^P)+I[4]+1272893353&4294967295,V=A+(k<<11&4294967295|k>>>21),k=P+(V^A^R)+I[7]+4139469664&4294967295,P=V+(k<<16&4294967295|k>>>16),k=R+(P^V^A)+I[10]+3200236656&4294967295,R=P+(k<<23&4294967295|k>>>9),k=A+(R^P^V)+I[13]+681279174&4294967295,A=R+(k<<4&4294967295|k>>>28),k=V+(A^R^P)+I[0]+3936430074&4294967295,V=A+(k<<11&4294967295|k>>>21),k=P+(V^A^R)+I[3]+3572445317&4294967295,P=V+(k<<16&4294967295|k>>>16),k=R+(P^V^A)+I[6]+76029189&4294967295,R=P+(k<<23&4294967295|k>>>9),k=A+(R^P^V)+I[9]+3654602809&4294967295,A=R+(k<<4&4294967295|k>>>28),k=V+(A^R^P)+I[12]+3873151461&4294967295,V=A+(k<<11&4294967295|k>>>21),k=P+(V^A^R)+I[15]+530742520&4294967295,P=V+(k<<16&4294967295|k>>>16),k=R+(P^V^A)+I[2]+3299628645&4294967295,R=P+(k<<23&4294967295|k>>>9),k=A+(P^(R|~V))+I[0]+4096336452&4294967295,A=R+(k<<6&4294967295|k>>>26),k=V+(R^(A|~P))+I[7]+1126891415&4294967295,V=A+(k<<10&4294967295|k>>>22),k=P+(A^(V|~R))+I[14]+2878612391&4294967295,P=V+(k<<15&4294967295|k>>>17),k=R+(V^(P|~A))+I[5]+4237533241&4294967295,R=P+(k<<21&4294967295|k>>>11),k=A+(P^(R|~V))+I[12]+1700485571&4294967295,A=R+(k<<6&4294967295|k>>>26),k=V+(R^(A|~P))+I[3]+2399980690&4294967295,V=A+(k<<10&4294967295|k>>>22),k=P+(A^(V|~R))+I[10]+4293915773&4294967295,P=V+(k<<15&4294967295|k>>>17),k=R+(V^(P|~A))+I[1]+2240044497&4294967295,R=P+(k<<21&4294967295|k>>>11),k=A+(P^(R|~V))+I[8]+1873313359&4294967295,A=R+(k<<6&4294967295|k>>>26),k=V+(R^(A|~P))+I[15]+4264355552&4294967295,V=A+(k<<10&4294967295|k>>>22),k=P+(A^(V|~R))+I[6]+2734768916&4294967295,P=V+(k<<15&4294967295|k>>>17),k=R+(V^(P|~A))+I[13]+1309151649&4294967295,R=P+(k<<21&4294967295|k>>>11),k=A+(P^(R|~V))+I[4]+4149444226&4294967295,A=R+(k<<6&4294967295|k>>>26),k=V+(R^(A|~P))+I[11]+3174756917&4294967295,V=A+(k<<10&4294967295|k>>>22),k=P+(A^(V|~R))+I[2]+718787259&4294967295,P=V+(k<<15&4294967295|k>>>17),k=R+(V^(P|~A))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+A&4294967295,w.g[1]=w.g[1]+(P+(k<<21&4294967295|k>>>11))&4294967295,w.g[2]=w.g[2]+P&4294967295,w.g[3]=w.g[3]+V&4294967295}a.prototype.u=function(w,A){A===void 0&&(A=w.length);for(var R=A-this.blockSize,I=this.B,P=this.h,V=0;V<A;){if(P==0)for(;V<=R;)o(this,w,V),V+=this.blockSize;if(typeof w=="string"){for(;V<A;)if(I[P++]=w.charCodeAt(V++),P==this.blockSize){o(this,I),P=0;break}}else for(;V<A;)if(I[P++]=w[V++],P==this.blockSize){o(this,I),P=0;break}}this.h=P,this.o+=A},a.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var A=1;A<w.length-8;++A)w[A]=0;var R=8*this.o;for(A=w.length-8;A<w.length;++A)w[A]=R&255,R/=256;for(this.u(w),w=Array(16),A=R=0;4>A;++A)for(var I=0;32>I;I+=8)w[R++]=this.g[A]>>>I&255;return w};function c(w,A){var R=f;return Object.prototype.hasOwnProperty.call(R,w)?R[w]:R[w]=A(w)}function d(w,A){this.h=A;for(var R=[],I=!0,P=w.length-1;0<=P;P--){var V=w[P]|0;I&&V==A||(R[P]=V,I=!1)}this.g=R}var f={};function p(w){return-128<=w&&128>w?c(w,function(A){return new d([A|0],0>A?-1:0)}):new d([w|0],0>w?-1:0)}function v(w){if(isNaN(w)||!isFinite(w))return N;if(0>w)return T(v(-w));for(var A=[],R=1,I=0;w>=R;I++)A[I]=w/R|0,R*=4294967296;return new d(A,0)}function _(w,A){if(w.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(w.charAt(0)=="-")return T(_(w.substring(1),A));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=v(Math.pow(A,8)),I=N,P=0;P<w.length;P+=8){var V=Math.min(8,w.length-P),k=parseInt(w.substring(P,P+V),A);8>V?(V=v(Math.pow(A,V)),I=I.j(V).add(v(k))):(I=I.j(R),I=I.add(v(k)))}return I}var N=p(0),j=p(1),C=p(16777216);n=d.prototype,n.m=function(){if(M(this))return-T(this).m();for(var w=0,A=1,R=0;R<this.g.length;R++){var I=this.i(R);w+=(0<=I?I:4294967296+I)*A,A*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(b(this))return"0";if(M(this))return"-"+T(this).toString(w);for(var A=v(Math.pow(w,6)),R=this,I="";;){var P=U(R,A).g;R=L(R,P.j(A));var V=((0<R.g.length?R.g[0]:R.h)>>>0).toString(w);if(R=P,b(R))return V+I;for(;6>V.length;)V="0"+V;I=V+I}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function b(w){if(w.h!=0)return!1;for(var A=0;A<w.g.length;A++)if(w.g[A]!=0)return!1;return!0}function M(w){return w.h==-1}n.l=function(w){return w=L(this,w),M(w)?-1:b(w)?0:1};function T(w){for(var A=w.g.length,R=[],I=0;I<A;I++)R[I]=~w.g[I];return new d(R,~w.h).add(j)}n.abs=function(){return M(this)?T(this):this},n.add=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0,P=0;P<=A;P++){var V=I+(this.i(P)&65535)+(w.i(P)&65535),k=(V>>>16)+(this.i(P)>>>16)+(w.i(P)>>>16);I=k>>>16,V&=65535,k&=65535,R[P]=k<<16|V}return new d(R,R[R.length-1]&-2147483648?-1:0)};function L(w,A){return w.add(T(A))}n.j=function(w){if(b(this)||b(w))return N;if(M(this))return M(w)?T(this).j(T(w)):T(T(this).j(w));if(M(w))return T(this.j(T(w)));if(0>this.l(C)&&0>w.l(C))return v(this.m()*w.m());for(var A=this.g.length+w.g.length,R=[],I=0;I<2*A;I++)R[I]=0;for(I=0;I<this.g.length;I++)for(var P=0;P<w.g.length;P++){var V=this.i(I)>>>16,k=this.i(I)&65535,ke=w.i(P)>>>16,ae=w.i(P)&65535;R[2*I+2*P]+=k*ae,$(R,2*I+2*P),R[2*I+2*P+1]+=V*ae,$(R,2*I+2*P+1),R[2*I+2*P+1]+=k*ke,$(R,2*I+2*P+1),R[2*I+2*P+2]+=V*ke,$(R,2*I+2*P+2)}for(I=0;I<A;I++)R[I]=R[2*I+1]<<16|R[2*I];for(I=A;I<2*A;I++)R[I]=0;return new d(R,0)};function $(w,A){for(;(w[A]&65535)!=w[A];)w[A+1]+=w[A]>>>16,w[A]&=65535,A++}function O(w,A){this.g=w,this.h=A}function U(w,A){if(b(A))throw Error("division by zero");if(b(w))return new O(N,N);if(M(w))return A=U(T(w),A),new O(T(A.g),T(A.h));if(M(A))return A=U(w,T(A)),new O(T(A.g),A.h);if(30<w.g.length){if(M(w)||M(A))throw Error("slowDivide_ only works with positive integers.");for(var R=j,I=A;0>=I.l(w);)R=F(R),I=F(I);var P=X(R,1),V=X(I,1);for(I=X(I,2),R=X(R,2);!b(I);){var k=V.add(I);0>=k.l(w)&&(P=P.add(R),V=k),I=X(I,1),R=X(R,1)}return A=L(w,P.j(A)),new O(P,A)}for(P=N;0<=w.l(A);){for(R=Math.max(1,Math.floor(w.m()/A.m())),I=Math.ceil(Math.log(R)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),V=v(R),k=V.j(A);M(k)||0<k.l(w);)R-=I,V=v(R),k=V.j(A);b(V)&&(V=j),P=P.add(V),w=L(w,k)}return new O(P,w)}n.A=function(w){return U(this,w).h},n.and=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)&w.i(I);return new d(R,this.h&w.h)},n.or=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)|w.i(I);return new d(R,this.h|w.h)},n.xor=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)^w.i(I);return new d(R,this.h^w.h)};function F(w){for(var A=w.g.length+1,R=[],I=0;I<A;I++)R[I]=w.i(I)<<1|w.i(I-1)>>>31;return new d(R,w.h)}function X(w,A){var R=A>>5;A%=32;for(var I=w.g.length-R,P=[],V=0;V<I;V++)P[V]=0<A?w.i(V+R)>>>A|w.i(V+R+1)<<32-A:w.i(V+R);return new d(P,w.h)}a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,NT=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=_,bi=d}).apply(typeof Hb<"u"?Hb:typeof self<"u"?self:typeof window<"u"?window:{});var zd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xT,jc,TT,nh,Jp,AT,jT,CT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,E){return h==Array.prototype||h==Object.prototype||(h[y]=E.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof zd=="object"&&zd];for(var y=0;y<h.length;++y){var E=h[y];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var a=t(this);function o(h,y){if(y)e:{var E=a;h=h.split(".");for(var D=0;D<h.length-1;D++){var K=h[D];if(!(K in E))break e;E=E[K]}h=h[h.length-1],D=E[h],y=y(D),y!=D&&y!=null&&e(E,h,{configurable:!0,writable:!0,value:y})}}function c(h,y){h instanceof String&&(h+="");var E=0,D=!1,K={next:function(){if(!D&&E<h.length){var te=E++;return{value:y(te,h[te]),done:!1}}return D=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}o("Array.prototype.values",function(h){return h||function(){return c(this,function(y,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function p(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function v(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function _(h,y,E){return h.call.apply(h.bind,arguments)}function N(h,y,E){if(!h)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,D),h.apply(y,K)}}return function(){return h.apply(y,arguments)}}function j(h,y,E){return j=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:N,j.apply(null,arguments)}function C(h,y){var E=Array.prototype.slice.call(arguments,1);return function(){var D=E.slice();return D.push.apply(D,arguments),h.apply(this,D)}}function b(h,y){function E(){}E.prototype=y.prototype,h.aa=y.prototype,h.prototype=new E,h.prototype.constructor=h,h.Qb=function(D,K,te){for(var de=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)de[Ke-2]=arguments[Ke];return y.prototype[K].apply(D,de)}}function M(h){const y=h.length;if(0<y){const E=Array(y);for(let D=0;D<y;D++)E[D]=h[D];return E}return[]}function T(h,y){for(let E=1;E<arguments.length;E++){const D=arguments[E];if(p(D)){const K=h.length||0,te=D.length||0;h.length=K+te;for(let de=0;de<te;de++)h[K+de]=D[de]}else h.push(D)}}class L{constructor(y,E){this.i=y,this.j=E,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function $(h){return/^[\s\xa0]*$/.test(h)}function O(){var h=f.navigator;return h&&(h=h.userAgent)?h:""}function U(h){return U[" "](h),h}U[" "]=function(){};var F=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function X(h,y,E){for(const D in h)y.call(E,h[D],D,h)}function w(h,y){for(const E in h)y.call(void 0,h[E],E,h)}function A(h){const y={};for(const E in h)y[E]=h[E];return y}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(h,y){let E,D;for(let K=1;K<arguments.length;K++){D=arguments[K];for(E in D)h[E]=D[E];for(let te=0;te<R.length;te++)E=R[te],Object.prototype.hasOwnProperty.call(D,E)&&(h[E]=D[E])}}function P(h){var y=1;h=h.split(":");const E=[];for(;0<y&&h.length;)E.push(h.shift()),y--;return h.length&&E.push(h.join(":")),E}function V(h){f.setTimeout(()=>{throw h},0)}function k(){var h=ve;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class ke{constructor(){this.h=this.g=null}add(y,E){const D=ae.get();D.set(y,E),this.h?this.h.next=D:this.g=D,this.h=D}}var ae=new L(()=>new H,h=>h.reset());class H{constructor(){this.next=this.g=this.h=null}set(y,E){this.h=y,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let J,ce=!1,ve=new ke,B=()=>{const h=f.Promise.resolve(void 0);J=()=>{h.then(ne)}};var ne=()=>{for(var h;h=k();){try{h.h.call(h.g)}catch(E){V(E)}var y=ae;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}ce=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var Ne=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};f.addEventListener("test",E,y),f.removeEventListener("test",E,y)}catch{}return h}();function Ue(h,y){if(ue.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var E=this.type=h.type,D=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(F){e:{try{U(y.nodeName);var K=!0;break e}catch{}K=!1}K||(y=null)}}else E=="mouseover"?y=h.fromElement:E=="mouseout"&&(y=h.toElement);this.relatedTarget=y,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Ie[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Ue.aa.h.call(this)}}b(Ue,ue);var Ie={2:"touch",3:"pen",4:"mouse"};Ue.prototype.h=function(){Ue.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Gt="closure_listenable_"+(1e6*Math.random()|0),ft=0;function As(h,y,E,D,K){this.listener=h,this.proxy=null,this.src=y,this.type=E,this.capture=!!D,this.ha=K,this.key=++ft,this.da=this.fa=!1}function La(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Js(h){this.src=h,this.g={},this.h=0}Js.prototype.add=function(h,y,E,D,K){var te=h.toString();h=this.g[te],h||(h=this.g[te]=[],this.h++);var de=Fi(h,y,D,K);return-1<de?(y=h[de],E||(y.fa=!1)):(y=new As(y,this.src,te,!!D,K),y.fa=E,h.push(y)),y};function Ui(h,y){var E=y.type;if(E in h.g){var D=h.g[E],K=Array.prototype.indexOf.call(D,y,void 0),te;(te=0<=K)&&Array.prototype.splice.call(D,K,1),te&&(La(y),h.g[E].length==0&&(delete h.g[E],h.h--))}}function Fi(h,y,E,D){for(var K=0;K<h.length;++K){var te=h[K];if(!te.da&&te.listener==y&&te.capture==!!E&&te.ha==D)return K}return-1}var qi="closure_lm_"+(1e6*Math.random()|0),ml={};function _u(h,y,E,D,K){if(Array.isArray(y)){for(var te=0;te<y.length;te++)_u(h,y[te],E,D,K);return null}return E=Eu(E),h&&h[Gt]?h.K(y,E,v(D)?!!D.capture:!1,K):Xn(h,y,E,!1,D,K)}function Xn(h,y,E,D,K,te){if(!y)throw Error("Invalid event type");var de=v(K)?!!K.capture:!!K,Ke=qr(h);if(Ke||(h[qi]=Ke=new Js(h)),E=Ke.add(y,E,D,de,te),E.proxy)return E;if(D=gf(),E.proxy=D,D.src=h,D.listener=E,h.addEventListener)Ne||(K=de),K===void 0&&(K=!1),h.addEventListener(y.toString(),D,K);else if(h.attachEvent)h.attachEvent(Bi(y.toString()),D);else if(h.addListener&&h.removeListener)h.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return E}function gf(){function h(E){return y.call(h.src,h.listener,E)}const y=vf;return h}function pl(h,y,E,D,K){if(Array.isArray(y))for(var te=0;te<y.length;te++)pl(h,y[te],E,D,K);else D=v(D)?!!D.capture:!!D,E=Eu(E),h&&h[Gt]?(h=h.i,y=String(y).toString(),y in h.g&&(te=h.g[y],E=Fi(te,E,D,K),-1<E&&(La(te[E]),Array.prototype.splice.call(te,E,1),te.length==0&&(delete h.g[y],h.h--)))):h&&(h=qr(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Fi(y,E,D,K)),(E=-1<h?y[h]:null)&&Fr(E))}function Fr(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[Gt])Ui(y.i,h);else{var E=h.type,D=h.proxy;y.removeEventListener?y.removeEventListener(E,D,h.capture):y.detachEvent?y.detachEvent(Bi(E),D):y.addListener&&y.removeListener&&y.removeListener(D),(E=qr(y))?(Ui(E,h),E.h==0&&(E.src=null,y[qi]=null)):La(h)}}}function Bi(h){return h in ml?ml[h]:ml[h]="on"+h}function vf(h,y){if(h.da)h=!0;else{y=new Ue(y,this);var E=h.listener,D=h.ha||h.src;h.fa&&Fr(h),h=E.call(D,y)}return h}function qr(h){return h=h[qi],h instanceof Js?h:null}var gl="__closure_events_fn_"+(1e9*Math.random()>>>0);function Eu(h){return typeof h=="function"?h:(h[gl]||(h[gl]=function(y){return h.handleEvent(y)}),h[gl])}function Et(){he.call(this),this.i=new Js(this),this.M=this,this.F=null}b(Et,he),Et.prototype[Gt]=!0,Et.prototype.removeEventListener=function(h,y,E,D){pl(this,h,y,E,D)};function st(h,y){var E,D=h.F;if(D)for(E=[];D;D=D.F)E.push(D);if(h=h.M,D=y.type||y,typeof y=="string")y=new ue(y,h);else if(y instanceof ue)y.target=y.target||h;else{var K=y;y=new ue(D,h),I(y,K)}if(K=!0,E)for(var te=E.length-1;0<=te;te--){var de=y.g=E[te];K=Pn(de,D,!0,y)&&K}if(de=y.g=h,K=Pn(de,D,!0,y)&&K,K=Pn(de,D,!1,y)&&K,E)for(te=0;te<E.length;te++)de=y.g=E[te],K=Pn(de,D,!1,y)&&K}Et.prototype.N=function(){if(Et.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var E=h.g[y],D=0;D<E.length;D++)La(E[D]);delete h.g[y],h.h--}}this.F=null},Et.prototype.K=function(h,y,E,D){return this.i.add(String(h),y,!1,E,D)},Et.prototype.L=function(h,y,E,D){return this.i.add(String(h),y,!0,E,D)};function Pn(h,y,E,D){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var K=!0,te=0;te<y.length;++te){var de=y[te];if(de&&!de.da&&de.capture==E){var Ke=de.listener,kt=de.ha||de.src;de.fa&&Ui(h.i,de),K=Ke.call(kt,D)!==!1&&K}}return K&&!D.defaultPrevented}function hn(h,y,E){if(typeof h=="function")E&&(h=j(h,E));else if(h&&typeof h.handleEvent=="function")h=j(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:f.setTimeout(h,y||0)}function bu(h){h.g=hn(()=>{h.g=null,h.i&&(h.i=!1,bu(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class yf extends he{constructor(y,E){super(),this.m=y,this.l=E,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:bu(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Hi(h){he.call(this),this.h=h,this.g={}}b(Hi,he);var zi=[];function Gi(h){X(h.g,function(y,E){this.g.hasOwnProperty(E)&&Fr(y)},h),h.g={}}Hi.prototype.N=function(){Hi.aa.N.call(this),Gi(this)},Hi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hs=f.JSON.stringify,Br=f.JSON.parse,$i=class{stringify(h){return f.JSON.stringify(h,void 0)}parse(h){return f.JSON.parse(h,void 0)}};function vl(){}vl.prototype.h=null;function yl(h){return h.h||(h.h=h.i())}function _l(){}var ea={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ta(){ue.call(this,"d")}b(ta,ue);function El(){ue.call(this,"c")}b(El,ue);var js={},bl=null;function Va(){return bl=bl||new Et}js.La="serverreachability";function Hr(h){ue.call(this,js.La,h)}b(Hr,ue);function Ua(h){const y=Va();st(y,new Hr(y))}js.STAT_EVENT="statevent";function Nu(h,y){ue.call(this,js.STAT_EVENT,h),this.stat=y}b(Nu,ue);function gt(h){const y=Va();st(y,new Nu(y,h))}js.Ma="timingevent";function Pt(h,y){ue.call(this,js.Ma,h),this.size=y}b(Pt,ue);function wt(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){h()},y)}function Wn(){this.g=!0}Wn.prototype.xa=function(){this.g=!1};function Nl(h,y,E,D,K,te){h.info(function(){if(h.g)if(te)for(var de="",Ke=te.split("&"),kt=0;kt<Ke.length;kt++){var Qe=Ke[kt].split("=");if(1<Qe.length){var Yt=Qe[0];Qe=Qe[1];var Lt=Yt.split("_");de=2<=Lt.length&&Lt[1]=="type"?de+(Yt+"="+Qe+"&"):de+(Yt+"=redacted&")}}else de=null;else de=te;return"XMLHTTP REQ ("+D+") [attempt "+K+"]: "+y+`
`+E+`
`+de})}function _f(h,y,E,D,K,te,de){h.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+K+"]: "+y+`
`+E+`
`+te+" "+de})}function Fa(h,y,E,D){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+Yi(h,E)+(D?" "+D:"")})}function xu(h,y){h.info(function(){return"TIMEOUT: "+y})}Wn.prototype.info=function(){};function Yi(h,y){if(!h.g)return y;if(!y)return null;try{var E=JSON.parse(y);if(E){for(h=0;h<E.length;h++)if(Array.isArray(E[h])){var D=E[h];if(!(2>D.length)){var K=D[1];if(Array.isArray(K)&&!(1>K.length)){var te=K[0];if(te!="noop"&&te!="stop"&&te!="close")for(var de=1;de<K.length;de++)K[de]=""}}}}return hs(E)}catch{return y}}var qa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},na={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Cs;function Ss(){}b(Ss,vl),Ss.prototype.g=function(){return new XMLHttpRequest},Ss.prototype.i=function(){return{}},Cs=new Ss;function En(h,y,E,D){this.j=h,this.i=y,this.l=E,this.R=D||1,this.U=new Hi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new At}function At(){this.i=null,this.g="",this.h=!1}var xl={},zr={};function fs(h,y,E){h.L=1,h.v=Zi(kn(y)),h.m=E,h.P=!0,sa(h,null)}function sa(h,y){h.F=Date.now(),Ki(h),h.A=kn(h.v);var E=h.A,D=h.R;Array.isArray(D)||(D=[String(D)]),wl(E.i,"t",D),h.C=0,E=h.j.J,h.h=new At,h.g=Uu(h.j,E?y:null,!h.m),0<h.O&&(h.M=new yf(j(h.Y,h,h.g),h.O)),y=h.U,E=h.g,D=h.ca;var K="readystatechange";Array.isArray(K)||(K&&(zi[0]=K.toString()),K=zi);for(var te=0;te<K.length;te++){var de=_u(E,K[te],D||y.handleEvent,!1,y.h||y);if(!de)break;y.g[de.key]=de}y=h.H?A(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),Ua(),Nl(h.i,h.u,h.A,h.l,h.R,h.m)}En.prototype.ca=function(h){h=h.target;const y=this.M;y&&ts(h)==3?y.j():this.Y(h)},En.prototype.Y=function(h){try{if(h==this.g)e:{const Lt=ts(this.g);var y=this.g.Ba();const da=this.g.Z();if(!(3>Lt)&&(Lt!=3||this.g&&(this.h.h||this.g.oa()||Ru(this.g)))){this.J||Lt!=4||y==7||(y==8||0>=da?Ua(3):Ua(2)),Ba(this);var E=this.g.Z();this.X=E;t:if(Tu(this)){var D=Ru(this.g);h="";var K=D.length,te=ts(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Jt(this),ws(this);var de="";break t}this.h.i=new f.TextDecoder}for(y=0;y<K;y++)this.h.h=!0,h+=this.h.i.decode(D[y],{stream:!(te&&y==K-1)});D.length=0,this.h.g+=h,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=E==200,_f(this.i,this.u,this.A,this.l,this.R,Lt,E),this.o){if(this.T&&!this.K){t:{if(this.g){var Ke,kt=this.g;if((Ke=kt.g?kt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(Ke)){var Qe=Ke;break t}}Qe=null}if(E=Qe)Fa(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qi(this,E);else{this.o=!1,this.s=3,gt(12),Jt(this),ws(this);break e}}if(this.P){E=!0;let en;for(;!this.J&&this.C<de.length;)if(en=Au(this,de),en==zr){Lt==4&&(this.s=4,gt(14),E=!1),Fa(this.i,this.l,null,"[Incomplete Response]");break}else if(en==xl){this.s=4,gt(15),Fa(this.i,this.l,de,"[Invalid Chunk]"),E=!1;break}else Fa(this.i,this.l,en,null),Qi(this,en);if(Tu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Lt!=4||de.length!=0||this.h.h||(this.s=1,gt(16),E=!1),this.o=this.o&&E,!E)Fa(this.i,this.l,de,"[Invalid Chunked Response]"),Jt(this),ws(this);else if(0<de.length&&!this.W){this.W=!0;var Yt=this.j;Yt.g==this&&Yt.ba&&!Yt.M&&(Yt.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),rr(Yt),Yt.M=!0,gt(11))}}else Fa(this.i,this.l,de,null),Qi(this,de);Lt==4&&Jt(this),this.o&&!this.J&&(Lt==4?ku(this.j,this):(this.o=!1,Ki(this)))}else Tf(this.g),E==400&&0<de.indexOf("Unknown SID")?(this.s=3,gt(12)):(this.s=0,gt(13)),Jt(this),ws(this)}}}catch{}finally{}};function Tu(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Au(h,y){var E=h.C,D=y.indexOf(`
`,E);return D==-1?zr:(E=Number(y.substring(E,D)),isNaN(E)?xl:(D+=1,D+E>y.length?zr:(y=y.slice(D,D+E),h.C=D+E,y)))}En.prototype.cancel=function(){this.J=!0,Jt(this)};function Ki(h){h.S=Date.now()+h.I,ju(h,h.I)}function ju(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=wt(j(h.ba,h),y)}function Ba(h){h.B&&(f.clearTimeout(h.B),h.B=null)}En.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(xu(this.i,this.A),this.L!=2&&(Ua(),gt(17)),Jt(this),this.s=2,ws(this)):ju(this,this.S-h)};function ws(h){h.j.G==0||h.J||ku(h.j,h)}function Jt(h){Ba(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,Gi(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Qi(h,y){try{var E=h.j;if(E.G!=0&&(E.g==h||Tl(E.h,h))){if(!h.K&&Tl(E.h,h)&&E.G==3){try{var D=E.Da.g.parse(y)}catch{D=null}if(Array.isArray(D)&&D.length==3){var K=D;if(K[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<h.F)no(E),eo(E);else break e;Ml(E),gt(18)}}else E.za=K[1],0<E.za-E.T&&37500>K[2]&&E.F&&E.v==0&&!E.C&&(E.C=wt(j(E.Za,E),6e3));if(1>=$r(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else ua(E,11)}else if((h.K||E.g==h)&&no(E),!$(y))for(K=E.Da.g.parse(y),y=0;y<K.length;y++){let Qe=K[y];if(E.T=Qe[0],Qe=Qe[1],E.G==2)if(Qe[0]=="c"){E.K=Qe[1],E.ia=Qe[2];const Yt=Qe[3];Yt!=null&&(E.la=Yt,E.j.info("VER="+E.la));const Lt=Qe[4];Lt!=null&&(E.Aa=Lt,E.j.info("SVER="+E.Aa));const da=Qe[5];da!=null&&typeof da=="number"&&0<da&&(D=1.5*da,E.L=D,E.j.info("backChannelRequestTimeoutMs_="+D)),D=E;const en=h.g;if(en){const ks=en.g?en.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ks){var te=D.h;te.g||ks.indexOf("spdy")==-1&&ks.indexOf("quic")==-1&&ks.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Yr(te,te.h),te.h=null))}if(D.D){const kl=en.g?en.g.getResponseHeader("X-HTTP-Session-Id"):null;kl&&(D.ya=kl,rt(D.I,D.D,kl))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-h.F,E.j.info("Handshake RTT: "+E.R+"ms")),D=E;var de=h;if(D.qa=Vu(D,D.J?D.ia:null,D.W),de.K){bn(D.h,de);var Ke=de,kt=D.L;kt&&(Ke.I=kt),Ke.B&&(Ba(Ke),Ki(Ke)),D.g=de}else Mu(D);0<E.i.length&&to(E)}else Qe[0]!="stop"&&Qe[0]!="close"||ua(E,7);else E.G==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?ua(E,7):Dl(E):Qe[0]!="noop"&&E.l&&E.l.ta(Qe),E.v=0)}}Ua(4)}catch{}}var Cu=class{constructor(h,y){this.g=h,this.map=y}};function aa(h){this.l=h||10,f.PerformanceNavigationTiming?(h=f.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Gr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function $r(h){return h.h?1:h.g?h.g.size:0}function Tl(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function Yr(h,y){h.g?h.g.add(y):h.h=y}function bn(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}aa.prototype.cancel=function(){if(this.i=Al(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Al(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const E of h.g.values())y=y.concat(E.D);return y}return M(h.i)}function Ef(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var y=[],E=h.length,D=0;D<E;D++)y.push(h[D]);return y}y=[],E=0;for(D in h)y[E++]=h[D];return y}function Kr(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var y=[];h=h.length;for(var E=0;E<h;E++)y.push(E);return y}y=[],E=0;for(const D in h)y[E++]=D;return y}}}function jl(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var E=Kr(h),D=Ef(h),K=D.length,te=0;te<K;te++)y.call(void 0,D[te],E&&E[te],h)}var Xi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bf(h,y){if(h){h=h.split("&");for(var E=0;E<h.length;E++){var D=h[E].indexOf("="),K=null;if(0<=D){var te=h[E].substring(0,D);K=h[E].substring(D+1)}else te=h[E];y(te,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function It(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof It){this.h=h.h,Wi(this,h.j),this.o=h.o,this.g=h.g,Ha(this,h.s),this.l=h.l;var y=h.i,E=new ra;E.i=y.i,y.g&&(E.g=new Map(y.g),E.h=y.h),ia(this,E),this.m=h.m}else h&&(y=String(h).match(Xi))?(this.h=!1,Wi(this,y[1]||"",!0),this.o=Zn(y[2]||""),this.g=Zn(y[3]||"",!0),Ha(this,y[4]),this.l=Zn(y[5]||"",!0),ia(this,y[6]||"",!0),this.m=Zn(y[7]||"")):(this.h=!1,this.i=new ra(null,this.h))}It.prototype.toString=function(){var h=[],y=this.j;y&&h.push(Ji(y,Cl,!0),":");var E=this.g;return(E||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Ji(y,Cl,!0),"@"),h.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&h.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(Ji(E,E.charAt(0)=="/"?Nf:Sl,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",Ji(E,Qr)),h.join("")};function kn(h){return new It(h)}function Wi(h,y,E){h.j=E?Zn(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Ha(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function ia(h,y,E){y instanceof ra?(h.i=y,wu(h.i,h.h)):(E||(y=Ji(y,xf)),h.i=new ra(y,h.h))}function rt(h,y,E){h.i.set(y,E)}function Zi(h){return rt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Zn(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ji(h,y,E){return typeof h=="string"?(h=encodeURI(h).replace(y,Su),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Su(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Cl=/[#\/\?@]/g,Sl=/[#\?:]/g,Nf=/[#\?]/g,xf=/[#\?@]/g,Qr=/#/g;function ra(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function Jn(h){h.g||(h.g=new Map,h.h=0,h.i&&bf(h.i,function(y,E){h.add(decodeURIComponent(y.replace(/\+/g," ")),E)}))}n=ra.prototype,n.add=function(h,y){Jn(this),this.i=null,h=Is(this,h);var E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(y),this.h+=1,this};function oa(h,y){Jn(h),y=Is(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function la(h,y){return Jn(h),y=Is(h,y),h.g.has(y)}n.forEach=function(h,y){Jn(this),this.g.forEach(function(E,D){E.forEach(function(K){h.call(y,K,D,this)},this)},this)},n.na=function(){Jn(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),E=[];for(let D=0;D<y.length;D++){const K=h[D];for(let te=0;te<K.length;te++)E.push(y[D])}return E},n.V=function(h){Jn(this);let y=[];if(typeof h=="string")la(this,h)&&(y=y.concat(this.g.get(Is(this,h))));else{h=Array.from(this.g.values());for(let E=0;E<h.length;E++)y=y.concat(h[E])}return y},n.set=function(h,y){return Jn(this),this.i=null,h=Is(this,h),la(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},n.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function wl(h,y,E){oa(h,y),0<E.length&&(h.i=null,h.g.set(Is(h,y),M(E)),h.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var E=0;E<y.length;E++){var D=y[E];const te=encodeURIComponent(String(D)),de=this.V(D);for(D=0;D<de.length;D++){var K=te;de[D]!==""&&(K+="="+encodeURIComponent(String(de[D]))),h.push(K)}}return this.i=h.join("&")};function Is(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function wu(h,y){y&&!h.j&&(Jn(h),h.i=null,h.g.forEach(function(E,D){var K=D.toLowerCase();D!=K&&(oa(this,D),wl(this,K,E))},h)),h.j=y}function er(h,y){const E=new Wn;if(f.Image){const D=new Image;D.onload=C(es,E,"TestLoadImage: loaded",!0,y,D),D.onerror=C(es,E,"TestLoadImage: error",!1,y,D),D.onabort=C(es,E,"TestLoadImage: abort",!1,y,D),D.ontimeout=C(es,E,"TestLoadImage: timeout",!1,y,D),f.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=h}else y(!1)}function ms(h,y){const E=new Wn,D=new AbortController,K=setTimeout(()=>{D.abort(),es(E,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:D.signal}).then(te=>{clearTimeout(K),te.ok?es(E,"TestPingServer: ok",!0,y):es(E,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(K),es(E,"TestPingServer: error",!1,y)})}function es(h,y,E,D,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),D(E)}catch{}}function tr(){this.g=new $i}function Rs(h,y,E){const D=E||"";try{jl(h,function(K,te){let de=K;v(K)&&(de=hs(K)),y.push(D+te+"="+encodeURIComponent(de))})}catch(K){throw y.push(D+"type="+encodeURIComponent("_badmap")),K}}function za(h){this.l=h.Ub||null,this.j=h.eb||!1}b(za,vl),za.prototype.g=function(){return new ca(this.l,this.j)},za.prototype.i=function(h){return function(){return h}}({});function ca(h,y){Et.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(ca,Et),n=ca.prototype,n.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,Os(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||f).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ds(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Os(this)),this.g&&(this.readyState=3,Os(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Il(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Il(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Ds(this):Os(this),this.readyState==3&&Il(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Ds(this))},n.Qa=function(h){this.g&&(this.response=h,Ds(this))},n.ga=function(){this.g&&Ds(this)};function Ds(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Os(h)}n.setRequestHeader=function(h,y){this.u.append(h,y)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var E=y.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=y.next();return h.join(`\r
`)};function Os(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(ca.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Rl(h){let y="";return X(h,function(E,D){y+=D,y+=":",y+=E,y+=`\r
`}),y}function $t(h,y,E){e:{for(D in E){var D=!1;break e}D=!0}D||(E=Rl(E),typeof h=="string"?E!=null&&encodeURIComponent(String(E)):rt(h,y,E))}function nt(h){Et.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(nt,Et);var Xr=/^https?$/i,nr=["POST","PUT"];n=nt.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,y,E,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Cs.g(),this.v=this.o?yl(this.o):yl(Cs),this.g.onreadystatechange=j(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(te){Iu(this,te);return}if(h=E||"",E=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var K in D)E.set(K,D[K]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const te of D.keys())E.set(te,D.get(te));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(E.keys()).find(te=>te.toLowerCase()=="content-type"),K=f.FormData&&h instanceof f.FormData,!(0<=Array.prototype.indexOf.call(nr,y,void 0))||D||K||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,de]of E)this.g.setRequestHeader(te,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{sr(this),this.u=!0,this.g.send(h),this.u=!1}catch(te){Iu(this,te)}};function Iu(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,Wr(h),Ms(h)}function Wr(h){h.A||(h.A=!0,st(h,"complete"),st(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,st(this,"complete"),st(this,"abort"),Ms(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ms(this,!0)),nt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Zr(this):this.bb())},n.bb=function(){Zr(this)};function Zr(h){if(h.h&&typeof d<"u"&&(!h.v[1]||ts(h)!=4||h.Z()!=2)){if(h.u&&ts(h)==4)hn(h.Ea,0,h);else if(st(h,"readystatechange"),ts(h)==4){h.h=!1;try{const de=h.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var E;if(!(E=y)){var D;if(D=de===0){var K=String(h.D).match(Xi)[1]||null;!K&&f.self&&f.self.location&&(K=f.self.location.protocol.slice(0,-1)),D=!Xr.test(K?K.toLowerCase():"")}E=D}if(E)st(h,"complete"),st(h,"success");else{h.m=6;try{var te=2<ts(h)?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.Z()+"]",Wr(h)}}finally{Ms(h)}}}}function Ms(h,y){if(h.g){sr(h);const E=h.g,D=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||st(h,"ready");try{E.onreadystatechange=D}catch{}}}function sr(h){h.I&&(f.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function ts(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<ts(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),Br(y)}};function Ru(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Tf(h){const y={};h=(h.g&&2<=ts(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<h.length;D++){if($(h[D]))continue;var E=P(h[D]);const K=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const te=y[K]||[];y[K]=te,te.push(E)}w(y,function(D){return D.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ar(h,y,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||y}function Jr(h){this.Aa=0,this.i=[],this.j=new Wn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ar("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ar("baseRetryDelayMs",5e3,h),this.cb=ar("retryDelaySeedMs",1e4,h),this.Wa=ar("forwardChannelMaxRetries",2,h),this.wa=ar("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new aa(h&&h.concurrentRequestLimit),this.Da=new tr,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Jr.prototype,n.la=8,n.G=1,n.connect=function(h,y,E,D){gt(0),this.W=h,this.H=y||{},E&&D!==void 0&&(this.H.OSID=E,this.H.OAID=D),this.F=this.X,this.I=Vu(this,null,this.W),to(this)};function Dl(h){if(Du(h),h.G==3){var y=h.U++,E=kn(h.I);if(rt(E,"SID",h.K),rt(E,"RID",y),rt(E,"TYPE","terminate"),ir(h,E),y=new En(h,h.j,y),y.L=2,y.v=Zi(kn(E)),E=!1,f.navigator&&f.navigator.sendBeacon)try{E=f.navigator.sendBeacon(y.v.toString(),"")}catch{}!E&&f.Image&&(new Image().src=y.v,E=!0),E||(y.g=Uu(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Ki(y)}Lu(h)}function eo(h){h.g&&(rr(h),h.g.cancel(),h.g=null)}function Du(h){eo(h),h.u&&(f.clearTimeout(h.u),h.u=null),no(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&f.clearTimeout(h.s),h.s=null)}function to(h){if(!Gr(h.h)&&!h.s){h.s=!0;var y=h.Ga;J||B(),ce||(J(),ce=!0),ve.add(y,h),h.B=0}}function Af(h,y){return $r(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=wt(j(h.Ga,h,y),Pl(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const K=new En(this,this.j,h);let te=this.o;if(this.S&&(te?(te=A(te),I(te,this.S)):te=this.S),this.m!==null||this.O||(K.H=te,te=null),this.P)e:{for(var y=0,E=0;E<this.i.length;E++){t:{var D=this.i[E];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(y+=D,4096<y){y=E;break e}if(y===4096||E===this.i.length-1){y=E+1;break e}}y=1e3}else y=1e3;y=Ou(this,K,y),E=kn(this.I),rt(E,"RID",h),rt(E,"CVER",22),this.D&&rt(E,"X-HTTP-Session-Id",this.D),ir(this,E),te&&(this.O?y="headers="+encodeURIComponent(String(Rl(te)))+"&"+y:this.m&&$t(E,this.m,te)),Yr(this.h,K),this.Ua&&rt(E,"TYPE","init"),this.P?(rt(E,"$req",y),rt(E,"SID","null"),K.T=!0,fs(K,E,null)):fs(K,E,y),this.G=2}}else this.G==3&&(h?Ol(this,h):this.i.length==0||Gr(this.h)||Ol(this))};function Ol(h,y){var E;y?E=y.l:E=h.U++;const D=kn(h.I);rt(D,"SID",h.K),rt(D,"RID",E),rt(D,"AID",h.T),ir(h,D),h.m&&h.o&&$t(D,h.m,h.o),E=new En(h,h.j,E,h.B+1),h.m===null&&(E.H=h.o),y&&(h.i=y.D.concat(h.i)),y=Ou(h,E,1e3),E.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Yr(h.h,E),fs(E,D,y)}function ir(h,y){h.H&&X(h.H,function(E,D){rt(y,D,E)}),h.l&&jl({},function(E,D){rt(y,D,E)})}function Ou(h,y,E){E=Math.min(h.i.length,E);var D=h.l?j(h.l.Na,h.l,h):null;e:{var K=h.i;let te=-1;for(;;){const de=["count="+E];te==-1?0<E?(te=K[0].g,de.push("ofs="+te)):te=0:de.push("ofs="+te);let Ke=!0;for(let kt=0;kt<E;kt++){let Qe=K[kt].g;const Yt=K[kt].map;if(Qe-=te,0>Qe)te=Math.max(0,K[kt].g-100),Ke=!1;else try{Rs(Yt,de,"req"+Qe+"_")}catch{D&&D(Yt)}}if(Ke){D=de.join("&");break e}}}return h=h.i.splice(0,E),y.D=h,D}function Mu(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;J||B(),ce||(J(),ce=!0),ve.add(y,h),h.v=0}}function Ml(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=wt(j(h.Fa,h),Pl(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,Pu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=wt(j(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gt(10),eo(this),Pu(this))};function rr(h){h.A!=null&&(f.clearTimeout(h.A),h.A=null)}function Pu(h){h.g=new En(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=kn(h.qa);rt(y,"RID","rpc"),rt(y,"SID",h.K),rt(y,"AID",h.T),rt(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&rt(y,"TO",h.ja),rt(y,"TYPE","xmlhttp"),ir(h,y),h.m&&h.o&&$t(y,h.m,h.o),h.L&&(h.g.I=h.L);var E=h.g;h=h.ia,E.L=1,E.v=Zi(kn(y)),E.m=null,E.P=!0,sa(E,h)}n.Za=function(){this.C!=null&&(this.C=null,eo(this),Ml(this),gt(19))};function no(h){h.C!=null&&(f.clearTimeout(h.C),h.C=null)}function ku(h,y){var E=null;if(h.g==y){no(h),rr(h),h.g=null;var D=2}else if(Tl(h.h,y))E=y.D,bn(h.h,y),D=1;else return;if(h.G!=0){if(y.o)if(D==1){E=y.m?y.m.length:0,y=Date.now()-y.F;var K=h.B;D=Va(),st(D,new Pt(D,E)),to(h)}else Mu(h);else if(K=y.s,K==3||K==0&&0<y.X||!(D==1&&Af(h,y)||D==2&&Ml(h)))switch(E&&0<E.length&&(y=h.h,y.i=y.i.concat(E)),K){case 1:ua(h,5);break;case 4:ua(h,10);break;case 3:ua(h,6);break;default:ua(h,2)}}}function Pl(h,y){let E=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(E*=2),E*y}function ua(h,y){if(h.j.info("Error code "+y),y==2){var E=j(h.fb,h),D=h.Xa;const K=!D;D=new It(D||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||Wi(D,"https"),Zi(D),K?er(D.toString(),E):ms(D.toString(),E)}else gt(2);h.G=0,h.l&&h.l.sa(y),Lu(h),Du(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Lu(h){if(h.G=0,h.ka=[],h.l){const y=Al(h.h);(y.length!=0||h.i.length!=0)&&(T(h.ka,y),T(h.ka,h.i),h.h.i.length=0,M(h.i),h.i.length=0),h.l.ra()}}function Vu(h,y,E){var D=E instanceof It?kn(E):new It(E);if(D.g!="")y&&(D.g=y+"."+D.g),Ha(D,D.s);else{var K=f.location;D=K.protocol,y=y?y+"."+K.hostname:K.hostname,K=+K.port;var te=new It(null);D&&Wi(te,D),y&&(te.g=y),K&&Ha(te,K),E&&(te.l=E),D=te}return E=h.D,y=h.ya,E&&y&&rt(D,E,y),rt(D,"VER",h.la),ir(h,D),D}function Uu(h,y,E){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new nt(new za({eb:E})):new nt(h.pa),y.Ha(h.J),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Fu(){}n=Fu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function so(){}so.prototype.g=function(h,y){return new Nn(h,y)};function Nn(h,y){Et.call(this),this.g=new Jr(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!$(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!$(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new Ps(this)}b(Nn,Et),Nn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Nn.prototype.close=function(){Dl(this.g)},Nn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.u&&(E={},E.__data__=hs(h),h=E);y.i.push(new Cu(y.Ya++,h)),y.G==3&&to(y)},Nn.prototype.N=function(){this.g.l=null,delete this.j,Dl(this.g),delete this.g,Nn.aa.N.call(this)};function qu(h){ta.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const E in y){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}b(qu,ta);function Bu(){El.call(this),this.status=1}b(Bu,El);function Ps(h){this.g=h}b(Ps,Fu),Ps.prototype.ua=function(){st(this.g,"a")},Ps.prototype.ta=function(h){st(this.g,new qu(h))},Ps.prototype.sa=function(h){st(this.g,new Bu)},Ps.prototype.ra=function(){st(this.g,"b")},so.prototype.createWebChannel=so.prototype.g,Nn.prototype.send=Nn.prototype.o,Nn.prototype.open=Nn.prototype.m,Nn.prototype.close=Nn.prototype.close,CT=function(){return new so},jT=function(){return Va()},AT=js,Jp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qa.NO_ERROR=0,qa.TIMEOUT=8,qa.HTTP_ERROR=6,nh=qa,na.COMPLETE="complete",TT=na,_l.EventType=ea,ea.OPEN="a",ea.CLOSE="b",ea.ERROR="c",ea.MESSAGE="d",Et.prototype.listen=Et.prototype.K,jc=_l,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,xT=nt}).apply(typeof zd<"u"?zd:typeof self<"u"?self:typeof window<"u"?window:{});const zb="@firebase/firestore",Gb="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gn.UNAUTHENTICATED=new gn(null),gn.GOOGLE_CREDENTIALS=new gn("google-credentials-uid"),gn.FIRST_PARTY=new gn("first-party-uid"),gn.MOCK_USER=new gn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rl="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir=new tu("@firebase/firestore");function Po(){return Ir.logLevel}function pe(n,...e){if(Ir.logLevel<=He.DEBUG){const t=e.map(Vg);Ir.debug(`Firestore (${rl}): ${n}`,...t)}}function Da(n,...e){if(Ir.logLevel<=He.ERROR){const t=e.map(Vg);Ir.error(`Firestore (${rl}): ${n}`,...t)}}function Qo(n,...e){if(Ir.logLevel<=He.WARN){const t=e.map(Vg);Ir.warn(`Firestore (${rl}): ${n}`,...t)}}function Vg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(n,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,ST(n,a,t)}function ST(n,e,t){let a=`FIRESTORE (${rl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw Da(a),new Error(a)}function Ze(n,e,t,a){let o="Unexpected state";typeof t=="string"?o=t:a=t,n||ST(e,o,a)}function Re(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends ds{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class i1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(gn.UNAUTHENTICATED))}shutdown(){}}class r1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class o1{constructor(e){this.t=e,this.currentUser=gn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0,42304);let a=this.i;const o=p=>this.i!==a?(a=this.i,t(p)):Promise.resolve();let c=new $s;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new $s,e.enqueueRetryable(()=>o(this.currentUser))};const d=()=>{const p=c;e.enqueueRetryable(async()=>{await p.promise,await o(this.currentUser)})},f=p=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit(p=>f(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new $s)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(a=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Ze(typeof a.accessToken=="string",31837,{l:a}),new wT(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new gn(e)}}class l1{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=gn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class c1{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new l1(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(gn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class $b{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class u1{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Dn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ze(this.o===void 0,3512);const a=c=>{c.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,pe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>a(c))};const o=c=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>o(c)),setTimeout(()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new $b(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new $b(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d1(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<n;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IT(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const o=d1(40);for(let c=0;c<o.length;++c)a.length<20&&o[c]<t&&(a+=e.charAt(o[c]%62))}return a}}function Ve(n,e){return n<e?-1:n>e?1:0}function eg(n,e){let t=0;for(;t<n.length&&t<e.length;){const a=n.codePointAt(t),o=e.codePointAt(t);if(a!==o){if(a<128&&o<128)return Ve(a,o);{const c=IT(),d=h1(c.encode(Yb(n,t)),c.encode(Yb(e,t)));return d!==0?d:Ve(a,o)}}t+=a>65535?2:1}return Ve(n.length,e.length)}function Yb(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function h1(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Ve(n[t],e[t]);return Ve(n.length,e.length)}function Xo(n,e,t){return n.length===e.length&&n.every((a,o)=>t(a,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb=-62135596800,Qb=1e6;class Ft{static now(){return Ft.fromMillis(Date.now())}static fromDate(e){return Ft.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*Qb);return new Ft(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Kb)throw new me(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Qb}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Kb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{static fromTimestamp(e){return new Ce(e)}static min(){return new Ce(new Ft(0,0))}static max(){return new Ce(new Ft(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb="__name__";class Hs{constructor(e,t,a){t===void 0?t=0:t>e.length&&xe(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&xe(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return Hs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Hs?e.forEach(a=>{t.push(a)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let o=0;o<a;o++){const c=Hs.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Ve(e.length,t.length)}static compareSegments(e,t){const a=Hs.isNumericId(e),o=Hs.isNumericId(t);return a&&!o?-1:!a&&o?1:a&&o?Hs.extractNumericId(e).compare(Hs.extractNumericId(t)):eg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return bi.fromString(e.substring(4,e.length-2))}}class ht extends Hs{construct(e,t,a){return new ht(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new me(re.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter(o=>o.length>0))}return new ht(t)}static emptyPath(){return new ht([])}}const f1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ln extends Hs{construct(e,t,a){return new ln(e,t,a)}static isValidIdentifier(e){return f1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ln.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Xb}static keyField(){return new ln([Xb])}static fromServerFormat(e){const t=[];let a="",o=0;const c=()=>{if(a.length===0)throw new me(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let d=!1;for(;o<e.length;){const f=e[o];if(f==="\\"){if(o+1===e.length)throw new me(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new me(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=p,o+=2}else f==="`"?(d=!d,o++):f!=="."||d?(a+=f,o++):(c(),o++)}if(c(),d)throw new me(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ln(t)}static emptyPath(){return new ln([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.path=e}static fromPath(e){return new be(ht.fromString(e))}static fromName(e){return new be(ht.fromString(e).popFirst(5))}static empty(){return new be(ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ht.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new ht(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gc=-1;function m1(n,e){const t=n.toTimestamp().seconds,a=n.toTimestamp().nanoseconds+1,o=Ce.fromTimestamp(a===1e9?new Ft(t+1,0):new Ft(t,a));return new Ti(o,be.empty(),e)}function p1(n){return new Ti(n.readTime,n.key,Gc)}class Ti{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new Ti(Ce.min(),be.empty(),Gc)}static max(){return new Ti(Ce.max(),be.empty(),Gc)}}function g1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=be.comparator(n.documentKey,e.documentKey),t!==0?t:Ve(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class y1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ol(n){if(n.code!==re.FAILED_PRECONDITION||n.message!==v1)throw n;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&xe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le((a,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(a,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(a,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):le.reject(t)}static resolve(e){return new le((t,a)=>{t(e)})}static reject(e){return new le((t,a)=>{a(e)})}static waitFor(e){return new le((t,a)=>{let o=0,c=0,d=!1;e.forEach(f=>{++o,f.next(()=>{++c,d&&c===o&&t()},p=>a(p))}),d=!0,c===o&&t()})}static or(e){let t=le.resolve(!1);for(const a of e)t=t.next(o=>o?le.resolve(o):a());return t}static forEach(e,t){const a=[];return e.forEach((o,c)=>{a.push(t.call(this,o,c))}),this.waitFor(a)}static mapArray(e,t){return new le((a,o)=>{const c=e.length,d=new Array(c);let f=0;for(let p=0;p<c;p++){const v=p;t(e[v]).next(_=>{d[v]=_,++f,f===c&&a(d)},_=>o(_))}})}static doWhile(e,t){return new le((a,o)=>{const c=()=>{e()===!0?t().next(()=>{c()},o):a()};c()})}}function _1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ll(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ue(a),this.ce=a=>t.writeSequenceNumber(a))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}qh.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ug=-1;function ou(n){return n==null}function yh(n){return n===0&&1/n==-1/0}function E1(n){return typeof n=="number"&&Number.isInteger(n)&&!yh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT="";function b1(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Wb(e)),e=N1(n.get(t),e);return Wb(e)}function N1(n,e){let t=e;const a=n.length;for(let o=0;o<a;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case DT:t+="";break;default:t+=c}}return t}function Wb(n){return n+DT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Li(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function OT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,t){this.comparator=e,this.root=t||on.EMPTY}insert(e,t){return new _t(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,on.BLACK,null,null))}remove(e){return new _t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,on.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const o=this.comparator(e,a.key);if(o===0)return t+a.left.size;o<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,a)=>(e(t,a),!1))}toString(){const e=[];return this.inorderTraversal((t,a)=>(e.push(`${t}:${a}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gd(this.root,e,this.comparator,!0)}}class Gd{constructor(e,t,a,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?a(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class on{constructor(e,t,a,o,c){this.key=e,this.value=t,this.color=a??on.RED,this.left=o??on.EMPTY,this.right=c??on.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,o,c){return new on(e??this.key,t??this.value,a??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let o=this;const c=a(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,a),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,a)),o.fixUp()}removeMin(){if(this.left.isEmpty())return on.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return on.EMPTY;a=o.right.min(),o=o.copy(a.key,a.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,on.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,on.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw xe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw xe(27949);return e+(this.isRed()?0:1)}}on.EMPTY=null,on.RED=!0,on.BLACK=!1;on.EMPTY=new class{constructor(){this.size=0}get key(){throw xe(57766)}get value(){throw xe(16141)}get color(){throw xe(16727)}get left(){throw xe(29726)}get right(){throw xe(36894)}copy(e,t,a,o,c){return this}insert(e,t,a){return new on(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.comparator=e,this.data=new _t(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,a)=>(e(t),!1))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const o=a.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Jb(this.data.getIterator())}getIteratorFrom(e){return new Jb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(a=>{t=t.add(a)}),t}isEqual(e){if(!(e instanceof qt)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new qt(this.comparator);return t.data=e,t}}class Jb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.fields=e,e.sort(ln.comparator)}static empty(){return new zn([])}unionWith(e){let t=new qt(ln.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new zn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xo(this.fields,e.fields,(t,a)=>t.isEqual(a))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new MT("Invalid base64 string: "+c):c}}(e);return new dn(t)}static fromUint8Array(e){const t=function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c}(e);return new dn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const a=new Uint8Array(t.length);for(let o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return a}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}dn.EMPTY_BYTE_STRING=new dn("");const x1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ai(n){if(Ze(!!n,39018),typeof n=="string"){let e=0;const t=x1.exec(n);if(Ze(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const a=new Date(n);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:St(n.seconds),nanos:St(n.nanos)}}function St(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ji(n){return typeof n=="string"?dn.fromBase64String(n):dn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PT="server_timestamp",kT="__type__",LT="__previous_value__",VT="__local_write_time__";function Fg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[kT])===null||t===void 0?void 0:t.stringValue)===PT}function Bh(n){const e=n.mapValue.fields[LT];return Fg(e)?Bh(e):e}function $c(n){const e=Ai(n.mapValue.fields[VT].timestampValue);return new Ft(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(e,t,a,o,c,d,f,p,v,_){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=v,this.isUsingEmulator=_}}const _h="(default)";class Yc{constructor(e,t){this.projectId=e,this.database=t||_h}static empty(){return new Yc("","")}get isDefaultDatabase(){return this.database===_h}isEqual(e){return e instanceof Yc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UT="__type__",A1="__max__",$d={mapValue:{}},FT="__vector__",Eh="value";function Ci(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fg(n)?4:C1(n)?9007199254740991:j1(n)?10:11:xe(28295,{value:n})}function Ks(n,e){if(n===e)return!0;const t=Ci(n);if(t!==Ci(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return $c(n).isEqual($c(e));case 3:return function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=Ai(o.timestampValue),f=Ai(c.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,c){return ji(o.bytesValue).isEqual(ji(c.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,c){return St(o.geoPointValue.latitude)===St(c.geoPointValue.latitude)&&St(o.geoPointValue.longitude)===St(c.geoPointValue.longitude)}(n,e);case 2:return function(o,c){if("integerValue"in o&&"integerValue"in c)return St(o.integerValue)===St(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=St(o.doubleValue),f=St(c.doubleValue);return d===f?yh(d)===yh(f):isNaN(d)&&isNaN(f)}return!1}(n,e);case 9:return Xo(n.arrayValue.values||[],e.arrayValue.values||[],Ks);case 10:case 11:return function(o,c){const d=o.mapValue.fields||{},f=c.mapValue.fields||{};if(Zb(d)!==Zb(f))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(f[p]===void 0||!Ks(d[p],f[p])))return!1;return!0}(n,e);default:return xe(52216,{left:n})}}function Kc(n,e){return(n.values||[]).find(t=>Ks(t,e))!==void 0}function Wo(n,e){if(n===e)return 0;const t=Ci(n),a=Ci(e);if(t!==a)return Ve(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ve(n.booleanValue,e.booleanValue);case 2:return function(c,d){const f=St(c.integerValue||c.doubleValue),p=St(d.integerValue||d.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1}(n,e);case 3:return eN(n.timestampValue,e.timestampValue);case 4:return eN($c(n),$c(e));case 5:return eg(n.stringValue,e.stringValue);case 6:return function(c,d){const f=ji(c),p=ji(d);return f.compareTo(p)}(n.bytesValue,e.bytesValue);case 7:return function(c,d){const f=c.split("/"),p=d.split("/");for(let v=0;v<f.length&&v<p.length;v++){const _=Ve(f[v],p[v]);if(_!==0)return _}return Ve(f.length,p.length)}(n.referenceValue,e.referenceValue);case 8:return function(c,d){const f=Ve(St(c.latitude),St(d.latitude));return f!==0?f:Ve(St(c.longitude),St(d.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return tN(n.arrayValue,e.arrayValue);case 10:return function(c,d){var f,p,v,_;const N=c.fields||{},j=d.fields||{},C=(f=N[Eh])===null||f===void 0?void 0:f.arrayValue,b=(p=j[Eh])===null||p===void 0?void 0:p.arrayValue,M=Ve(((v=C?.values)===null||v===void 0?void 0:v.length)||0,((_=b?.values)===null||_===void 0?void 0:_.length)||0);return M!==0?M:tN(C,b)}(n.mapValue,e.mapValue);case 11:return function(c,d){if(c===$d.mapValue&&d===$d.mapValue)return 0;if(c===$d.mapValue)return 1;if(d===$d.mapValue)return-1;const f=c.fields||{},p=Object.keys(f),v=d.fields||{},_=Object.keys(v);p.sort(),_.sort();for(let N=0;N<p.length&&N<_.length;++N){const j=eg(p[N],_[N]);if(j!==0)return j;const C=Wo(f[p[N]],v[_[N]]);if(C!==0)return C}return Ve(p.length,_.length)}(n.mapValue,e.mapValue);default:throw xe(23264,{Pe:t})}}function eN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ve(n,e);const t=Ai(n),a=Ai(e),o=Ve(t.seconds,a.seconds);return o!==0?o:Ve(t.nanos,a.nanos)}function tN(n,e){const t=n.values||[],a=e.values||[];for(let o=0;o<t.length&&o<a.length;++o){const c=Wo(t[o],a[o]);if(c)return c}return Ve(t.length,a.length)}function Zo(n){return tg(n)}function tg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const a=Ai(t);return`time(${a.seconds},${a.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ji(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return be.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let a="[",o=!0;for(const c of t.values||[])o?o=!1:a+=",",a+=tg(c);return a+"]"}(n.arrayValue):"mapValue"in n?function(t){const a=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of a)c?c=!1:o+=",",o+=`${d}:${tg(t.fields[d])}`;return o+"}"}(n.mapValue):xe(61005,{value:n})}function sh(n){switch(Ci(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Bh(n);return e?16+sh(e):16;case 5:return 2*n.stringValue.length;case 6:return ji(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(a){return(a.values||[]).reduce((o,c)=>o+sh(c),0)}(n.arrayValue);case 10:case 11:return function(a){let o=0;return Li(a.fields,(c,d)=>{o+=c.length+sh(d)}),o}(n.mapValue);default:throw xe(13486,{value:n})}}function nN(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ng(n){return!!n&&"integerValue"in n}function qg(n){return!!n&&"arrayValue"in n}function sN(n){return!!n&&"nullValue"in n}function aN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ah(n){return!!n&&"mapValue"in n}function j1(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[UT])===null||t===void 0?void 0:t.stringValue)===FT}function Dc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Li(n.mapValue.fields,(t,a)=>e.mapValue.fields[t]=Dc(a)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Dc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function C1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===A1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.value=e}static empty(){return new jn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!ah(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dc(t)}setAll(e){let t=ln.emptyPath(),a={},o=[];e.forEach((d,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,a,o),a={},o=[],t=f.popLast()}d?a[f.lastSegment()]=Dc(d):o.push(f.lastSegment())});const c=this.getFieldsMap(t);this.applyChanges(c,a,o)}delete(e){const t=this.field(e.popLast());ah(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ks(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let o=t.mapValue.fields[e.get(a)];ah(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,a){Li(t,(o,c)=>e[o]=c);for(const o of a)delete e[o]}clone(){return new jn(Dc(this.value))}}function qT(n){const e=[];return Li(n.fields,(t,a)=>{const o=new ln([t]);if(ah(a)){const c=qT(a.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)}),new zn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,t,a,o,c,d,f){this.key=e,this.documentType=t,this.version=a,this.readTime=o,this.createTime=c,this.data=d,this.documentState=f}static newInvalidDocument(e){return new Zt(e,0,Ce.min(),Ce.min(),Ce.min(),jn.empty(),0)}static newFoundDocument(e,t,a,o){return new Zt(e,1,t,Ce.min(),a,o,0)}static newNoDocument(e,t){return new Zt(e,2,t,Ce.min(),Ce.min(),jn.empty(),0)}static newUnknownDocument(e,t){return new Zt(e,3,t,Ce.min(),Ce.min(),jn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Zt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Zt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,t){this.position=e,this.inclusive=t}}function iN(n,e,t){let a=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?a=be.comparator(be.fromName(d.referenceValue),t.key):a=Wo(d,t.data.field(c.field)),c.dir==="desc"&&(a*=-1),a!==0)break}return a}function rN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ks(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,t="asc"){this.field=e,this.dir=t}}function S1(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{}class Mt extends BT{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new I1(e,t,a):t==="array-contains"?new O1(e,a):t==="in"?new M1(e,a):t==="not-in"?new P1(e,a):t==="array-contains-any"?new k1(e,a):new Mt(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new R1(e,a):new D1(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Wo(t,this.value)):t!==null&&Ci(this.value)===Ci(t)&&this.matchesComparison(Wo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ts extends BT{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Ts(e,t)}matches(e){return HT(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function HT(n){return n.op==="and"}function zT(n){return w1(n)&&HT(n)}function w1(n){for(const e of n.filters)if(e instanceof Ts)return!1;return!0}function sg(n){if(n instanceof Mt)return n.field.canonicalString()+n.op.toString()+Zo(n.value);if(zT(n))return n.filters.map(e=>sg(e)).join(",");{const e=n.filters.map(t=>sg(t)).join(",");return`${n.op}(${e})`}}function GT(n,e){return n instanceof Mt?function(a,o){return o instanceof Mt&&a.op===o.op&&a.field.isEqual(o.field)&&Ks(a.value,o.value)}(n,e):n instanceof Ts?function(a,o){return o instanceof Ts&&a.op===o.op&&a.filters.length===o.filters.length?a.filters.reduce((c,d,f)=>c&&GT(d,o.filters[f]),!0):!1}(n,e):void xe(19439)}function $T(n){return n instanceof Mt?function(t){return`${t.field.canonicalString()} ${t.op} ${Zo(t.value)}`}(n):n instanceof Ts?function(t){return t.op.toString()+" {"+t.getFilters().map($T).join(" ,")+"}"}(n):"Filter"}class I1 extends Mt{constructor(e,t,a){super(e,t,a),this.key=be.fromName(a.referenceValue)}matches(e){const t=be.comparator(e.key,this.key);return this.matchesComparison(t)}}class R1 extends Mt{constructor(e,t){super(e,"in",t),this.keys=YT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class D1 extends Mt{constructor(e,t){super(e,"not-in",t),this.keys=YT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function YT(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(a=>be.fromName(a.referenceValue))}class O1 extends Mt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return qg(t)&&Kc(t.arrayValue,this.value)}}class M1 extends Mt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Kc(this.value.arrayValue,t)}}class P1 extends Mt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Kc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Kc(this.value.arrayValue,t)}}class k1 extends Mt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!qg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(a=>Kc(this.value.arrayValue,a))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e,t=null,a=[],o=[],c=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=o,this.limit=c,this.startAt=d,this.endAt=f,this.Ie=null}}function oN(n,e=null,t=[],a=[],o=null,c=null,d=null){return new L1(n,e,t,a,o,c,d)}function Bg(n){const e=Re(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(a=>sg(a)).join(","),t+="|ob:",t+=e.orderBy.map(a=>function(c){return c.field.canonicalString()+c.dir}(a)).join(","),ou(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(a=>Zo(a)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(a=>Zo(a)).join(",")),e.Ie=t}return e.Ie}function Hg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!S1(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!GT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!rN(n.startAt,e.startAt)&&rN(n.endAt,e.endAt)}function ag(n){return be.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e,t=null,a=[],o=[],c=null,d="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=o,this.limit=c,this.limitType=d,this.startAt=f,this.endAt=p,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function V1(n,e,t,a,o,c,d,f){return new cl(n,e,t,a,o,c,d,f)}function Hh(n){return new cl(n)}function lN(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function KT(n){return n.collectionGroup!==null}function Oc(n){const e=Re(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ee.push(c),t.add(c.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new qt(ln.comparator);return d.filters.forEach(p=>{p.getFlattenedFilters().forEach(v=>{v.isInequality()&&(f=f.add(v.field))})}),f})(e).forEach(c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ee.push(new Qc(c,a))}),t.has(ln.keyField().canonicalString())||e.Ee.push(new Qc(ln.keyField(),a))}return e.Ee}function Ys(n){const e=Re(n);return e.de||(e.de=U1(e,Oc(n))),e.de}function U1(n,e){if(n.limitType==="F")return oN(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const c=o.dir==="desc"?"asc":"desc";return new Qc(o.field,c)});const t=n.endAt?new bh(n.endAt.position,n.endAt.inclusive):null,a=n.startAt?new bh(n.startAt.position,n.startAt.inclusive):null;return oN(n.path,n.collectionGroup,e,n.filters,n.limit,t,a)}}function ig(n,e){const t=n.filters.concat([e]);return new cl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Nh(n,e,t){return new cl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function zh(n,e){return Hg(Ys(n),Ys(e))&&n.limitType===e.limitType}function QT(n){return`${Bg(Ys(n))}|lt:${n.limitType}`}function ko(n){return`Query(target=${function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map(o=>$T(o)).join(", ")}]`),ou(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map(o=>function(d){return`${d.field.canonicalString()} (${d.dir})`}(o)).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map(o=>Zo(o)).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map(o=>Zo(o)).join(",")),`Target(${a})`}(Ys(n))}; limitType=${n.limitType})`}function Gh(n,e){return e.isFoundDocument()&&function(a,o){const c=o.key.path;return a.collectionGroup!==null?o.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):be.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)}(n,e)&&function(a,o){for(const c of Oc(a))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0}(n,e)&&function(a,o){for(const c of a.filters)if(!c.matches(o))return!1;return!0}(n,e)&&function(a,o){return!(a.startAt&&!function(d,f,p){const v=iN(d,f,p);return d.inclusive?v<=0:v<0}(a.startAt,Oc(a),o)||a.endAt&&!function(d,f,p){const v=iN(d,f,p);return d.inclusive?v>=0:v>0}(a.endAt,Oc(a),o))}(n,e)}function F1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function XT(n){return(e,t)=>{let a=!1;for(const o of Oc(n)){const c=q1(o,e,t);if(c!==0)return c;a=a||o.field.isKeyField()}return 0}}function q1(n,e,t){const a=n.field.isKeyField()?be.comparator(e.key,t.key):function(c,d,f){const p=d.data.field(c),v=f.data.field(c);return p!==null&&v!==null?Wo(p,v):xe(42886)}(n.field,e,t);switch(n.dir){case"asc":return a;case"desc":return-1*a;default:return xe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[o,c]of a)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),o=this.inner[a];if(o===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return a.length===1?delete this.inner[t]:a.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Li(this.inner,(t,a)=>{for(const[o,c]of a)e(o,c)})}isEmpty(){return OT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1=new _t(be.comparator);function Oa(){return B1}const WT=new _t(be.comparator);function Cc(...n){let e=WT;for(const t of n)e=e.insert(t.key,t);return e}function ZT(n){let e=WT;return n.forEach((t,a)=>e=e.insert(t,a.overlayedDocument)),e}function Ar(){return Mc()}function JT(){return Mc()}function Mc(){return new Lr(n=>n.toString(),(n,e)=>n.isEqual(e))}const H1=new _t(be.comparator),z1=new qt(be.comparator);function $e(...n){let e=z1;for(const t of n)e=e.add(t);return e}const G1=new qt(Ve);function $1(){return G1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yh(e)?"-0":e}}function e0(n){return{integerValue:""+n}}function Y1(n,e){return E1(e)?e0(e):zg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(){this._=void 0}}function K1(n,e,t){return n instanceof Xc?function(o,c){const d={fields:{[kT]:{stringValue:PT},[VT]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Fg(c)&&(c=Bh(c)),c&&(d.fields[LT]=c),{mapValue:d}}(t,e):n instanceof Wc?n0(n,e):n instanceof Zc?s0(n,e):function(o,c){const d=t0(o,c),f=cN(d)+cN(o.Re);return ng(d)&&ng(o.Re)?e0(f):zg(o.serializer,f)}(n,e)}function Q1(n,e,t){return n instanceof Wc?n0(n,e):n instanceof Zc?s0(n,e):t}function t0(n,e){return n instanceof xh?function(a){return ng(a)||function(c){return!!c&&"doubleValue"in c}(a)}(e)?e:{integerValue:0}:null}class Xc extends $h{}class Wc extends $h{constructor(e){super(),this.elements=e}}function n0(n,e){const t=a0(e);for(const a of n.elements)t.some(o=>Ks(o,a))||t.push(a);return{arrayValue:{values:t}}}class Zc extends $h{constructor(e){super(),this.elements=e}}function s0(n,e){let t=a0(e);for(const a of n.elements)t=t.filter(o=>!Ks(o,a));return{arrayValue:{values:t}}}class xh extends $h{constructor(e,t){super(),this.serializer=e,this.Re=t}}function cN(n){return St(n.integerValue||n.doubleValue)}function a0(n){return qg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e,t){this.field=e,this.transform=t}}function W1(n,e){return n.field.isEqual(e.field)&&function(a,o){return a instanceof Wc&&o instanceof Wc||a instanceof Zc&&o instanceof Zc?Xo(a.elements,o.elements,Ks):a instanceof xh&&o instanceof xh?Ks(a.Re,o.Re):a instanceof Xc&&o instanceof Xc}(n.transform,e.transform)}class Z1{constructor(e,t){this.version=e,this.transformResults=t}}class cn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new cn}static exists(e){return new cn(void 0,e)}static updateTime(e){return new cn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ih(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Yh{}function i0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Kh(n.key,cn.none()):new lu(n.key,n.data,cn.none());{const t=n.data,a=jn.empty();let o=new qt(ln.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?a.delete(c):a.set(c,d),o=o.add(c)}return new Vi(n.key,a,new zn(o.toArray()),cn.none())}}function J1(n,e,t){n instanceof lu?function(o,c,d){const f=o.value.clone(),p=dN(o.fieldTransforms,c,d.transformResults);f.setAll(p),c.convertToFoundDocument(d.version,f).setHasCommittedMutations()}(n,e,t):n instanceof Vi?function(o,c,d){if(!ih(o.precondition,c))return void c.convertToUnknownDocument(d.version);const f=dN(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(r0(o)),p.setAll(f),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()}(n,e,t):function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()}(0,e,t)}function Pc(n,e,t,a){return n instanceof lu?function(c,d,f,p){if(!ih(c.precondition,d))return f;const v=c.value.clone(),_=hN(c.fieldTransforms,p,d);return v.setAll(_),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null}(n,e,t,a):n instanceof Vi?function(c,d,f,p){if(!ih(c.precondition,d))return f;const v=hN(c.fieldTransforms,p,d),_=d.data;return _.setAll(r0(c)),_.setAll(v),d.convertToFoundDocument(d.version,_).setHasLocalMutations(),f===null?null:f.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(N=>N.field))}(n,e,t,a):function(c,d,f){return ih(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f}(n,e,t)}function eD(n,e){let t=null;for(const a of n.fieldTransforms){const o=e.data.field(a.field),c=t0(a.transform,o||null);c!=null&&(t===null&&(t=jn.empty()),t.set(a.field,c))}return t||null}function uN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(a,o){return a===void 0&&o===void 0||!(!a||!o)&&Xo(a,o,(c,d)=>W1(c,d))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class lu extends Yh{constructor(e,t,a,o=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Vi extends Yh{constructor(e,t,a,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function r0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const a=n.data.field(t);e.set(t,a)}}),e}function dN(n,e,t){const a=new Map;Ze(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,f=e.data.field(c.field);a.set(c.field,Q1(d,f,t[o]))}return a}function hN(n,e,t){const a=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);a.set(o.field,K1(c,d,e))}return a}class Kh extends Yh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class o0 extends Yh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e,t,a,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=o}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&J1(c,e,a[o])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=Pc(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=Pc(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=JT();return this.mutations.forEach(o=>{const c=e.get(o.key),d=c.overlayedDocument;let f=this.applyToLocalView(d,c.mutatedFields);f=t.has(o.key)?null:f;const p=i0(d,f);p!==null&&a.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(Ce.min())}),a}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),$e())}isEqual(e){return this.batchId===e.batchId&&Xo(this.mutations,e.mutations,(t,a)=>uN(t,a))&&Xo(this.baseMutations,e.baseMutations,(t,a)=>uN(t,a))}}class Gg{constructor(e,t,a,o){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=o}static from(e,t,a){Ze(e.mutations.length===a.length,58842,{fe:e.mutations.length,ge:a.length});let o=function(){return H1}();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,a[d].version);return new Gg(e,t,a,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot,We;function l0(n){switch(n){case re.OK:return xe(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return xe(15467,{code:n})}}function c0(n){if(n===void 0)return Da("GRPC error has no .code"),re.UNKNOWN;switch(n){case Ot.OK:return re.OK;case Ot.CANCELLED:return re.CANCELLED;case Ot.UNKNOWN:return re.UNKNOWN;case Ot.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case Ot.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case Ot.INTERNAL:return re.INTERNAL;case Ot.UNAVAILABLE:return re.UNAVAILABLE;case Ot.UNAUTHENTICATED:return re.UNAUTHENTICATED;case Ot.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case Ot.NOT_FOUND:return re.NOT_FOUND;case Ot.ALREADY_EXISTS:return re.ALREADY_EXISTS;case Ot.PERMISSION_DENIED:return re.PERMISSION_DENIED;case Ot.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case Ot.ABORTED:return re.ABORTED;case Ot.OUT_OF_RANGE:return re.OUT_OF_RANGE;case Ot.UNIMPLEMENTED:return re.UNIMPLEMENTED;case Ot.DATA_LOSS:return re.DATA_LOSS;default:return xe(39323,{code:n})}}(We=Ot||(Ot={}))[We.OK=0]="OK",We[We.CANCELLED=1]="CANCELLED",We[We.UNKNOWN=2]="UNKNOWN",We[We.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",We[We.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",We[We.NOT_FOUND=5]="NOT_FOUND",We[We.ALREADY_EXISTS=6]="ALREADY_EXISTS",We[We.PERMISSION_DENIED=7]="PERMISSION_DENIED",We[We.UNAUTHENTICATED=16]="UNAUTHENTICATED",We[We.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",We[We.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",We[We.ABORTED=10]="ABORTED",We[We.OUT_OF_RANGE=11]="OUT_OF_RANGE",We[We.UNIMPLEMENTED=12]="UNIMPLEMENTED",We[We.INTERNAL=13]="INTERNAL",We[We.UNAVAILABLE=14]="UNAVAILABLE",We[We.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD=new bi([4294967295,4294967295],0);function fN(n){const e=IT().encode(n),t=new NT;return t.update(e),new Uint8Array(t.digest())}function mN(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new bi([t,a],0),new bi([o,c],0)]}class $g{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new Sc(`Invalid padding: ${t}`);if(a<0)throw new Sc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new Sc(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new Sc(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=bi.fromNumber(this.pe)}we(e,t,a){let o=e.add(t.multiply(bi.fromNumber(a)));return o.compare(aD)===1&&(o=new bi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=fN(e),[a,o]=mN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);if(!this.be(d))return!1}return!0}static create(e,t,a){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new $g(c,o,t);return a.forEach(f=>d.insert(f)),d}insert(e){if(this.pe===0)return;const t=fN(e),[a,o]=mN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);this.Se(d)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class Sc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,t,a,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const o=new Map;return o.set(e,cu.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new Qh(Ce.min(),o,new _t(Ve),Oa(),$e())}}class cu{constructor(e,t,a,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new cu(a,t,$e(),$e(),$e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,t,a,o){this.De=e,this.removedTargetIds=t,this.key=a,this.ve=o}}class u0{constructor(e,t){this.targetId=e,this.Ce=t}}class d0{constructor(e,t,a=dn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=o}}class pN{constructor(){this.Fe=0,this.Me=gN(),this.xe=dn.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=$e(),t=$e(),a=$e();return this.Me.forEach((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:a=a.add(o);break;default:xe(38017,{changeType:c})}}),new cu(this.xe,this.Oe,e,t,a)}Qe(){this.Ne=!1,this.Me=gN()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Ze(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class iD{constructor(e){this.ze=e,this.je=new Map,this.He=Oa(),this.Je=Yd(),this.Ye=Yd(),this.Ze=new _t(Ve)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const a=this.rt(t);switch(e.state){case 0:this.it(t)&&a.ke(e.resumeToken);break;case 1:a.We(),a.Be||a.Qe(),a.ke(e.resumeToken);break;case 2:a.We(),a.Be||this.removeTarget(t);break;case 3:this.it(t)&&(a.Ge(),a.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),a.ke(e.resumeToken));break;default:xe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((a,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,a=e.Ce.count,o=this._t(t);if(o){const c=o.target;if(ag(c))if(a===0){const d=new be(c.path);this.tt(t,d,Zt.newNoDocument(d,Ce.min()))}else Ze(a===1,20013,{expectedCount:a});else{const d=this.ut(t);if(d!==a){const f=this.ct(e),p=f?this.lt(f,e,d):1;if(p!==0){this.st(t);const v=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,v)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:o=0},hashCount:c=0}=t;let d,f;try{d=ji(a).toUint8Array()}catch(p){if(p instanceof MT)return Qo("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new $g(d,o,c)}catch(p){return Qo(p instanceof Sc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.pe===0?null:f}lt(e,t,a){return t.Ce.count===a-this.Tt(e,t.targetId)?0:2}Tt(e,t){const a=this.ze.getRemoteKeysForTarget(t);let o=0;return a.forEach(c=>{const d=this.ze.Pt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(f)||(this.tt(t,c,null),o++)}),o}It(e){const t=new Map;this.je.forEach((c,d)=>{const f=this._t(d);if(f){if(c.current&&ag(f.target)){const p=new be(f.target.path);this.Et(p).has(d)||this.dt(d,p)||this.tt(d,p,Zt.newNoDocument(p,e))}c.Le&&(t.set(d,c.qe()),c.Qe())}});let a=$e();this.Ye.forEach((c,d)=>{let f=!0;d.forEachWhile(p=>{const v=this._t(p);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)}),f&&(a=a.add(c))}),this.He.forEach((c,d)=>d.setReadTime(e));const o=new Qh(e,t,this.Ze,this.He,a);return this.He=Oa(),this.Je=Yd(),this.Ye=Yd(),this.Ze=new _t(Ve),o}et(e,t){if(!this.it(e))return;const a=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,a),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,a){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),a&&(this.He=this.He.insert(t,a))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new pN,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new qt(Ve),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new qt(Ve),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||pe("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new pN),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Yd(){return new _t(be.comparator)}function gN(){return new _t(be.comparator)}const rD={asc:"ASCENDING",desc:"DESCENDING"},oD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lD={and:"AND",or:"OR"};class cD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function rg(n,e){return n.useProto3Json||ou(e)?e:{value:e}}function Th(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function h0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function uD(n,e){return Th(n,e.toTimestamp())}function $n(n){return Ze(!!n,49232),Ce.fromTimestamp(function(t){const a=Ai(t);return new Ft(a.seconds,a.nanos)}(n))}function Yg(n,e){return og(n,e).canonicalString()}function og(n,e){const t=function(o){return new ht(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function f0(n){const e=ht.fromString(n);return Ze(_0(e),10190,{key:e.toString()}),e}function Ah(n,e){return Yg(n.databaseId,e.path)}function kc(n,e){const t=f0(e);if(t.get(1)!==n.databaseId.projectId)throw new me(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new be(p0(t))}function m0(n,e){return Yg(n.databaseId,e)}function dD(n){const e=f0(n);return e.length===4?ht.emptyPath():p0(e)}function lg(n){return new ht(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function p0(n){return Ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function vN(n,e,t){return{name:Ah(n,e),fields:t.value.mapValue.fields}}function hD(n,e){return"found"in e?function(a,o){Ze(!!o.found,43571),o.found.name,o.found.updateTime;const c=kc(a,o.found.name),d=$n(o.found.updateTime),f=o.found.createTime?$n(o.found.createTime):Ce.min(),p=new jn({mapValue:{fields:o.found.fields}});return Zt.newFoundDocument(c,d,f,p)}(n,e):"missing"in e?function(a,o){Ze(!!o.missing,3894),Ze(!!o.readTime,22933);const c=kc(a,o.missing),d=$n(o.readTime);return Zt.newNoDocument(c,d)}(n,e):xe(7234,{result:e})}function fD(n,e){let t;if("targetChange"in e){e.targetChange;const a=function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:xe(39313,{state:v})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=function(v,_){return v.useProto3Json?(Ze(_===void 0||typeof _=="string",58123),dn.fromBase64String(_||"")):(Ze(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),dn.fromUint8Array(_||new Uint8Array))}(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&function(v){const _=v.code===void 0?re.UNKNOWN:c0(v.code);return new me(_,v.message||"")}(d);t=new d0(a,o,c,f||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const o=kc(n,a.document.name),c=$n(a.document.updateTime),d=a.document.createTime?$n(a.document.createTime):Ce.min(),f=new jn({mapValue:{fields:a.document.fields}}),p=Zt.newFoundDocument(o,c,d,f),v=a.targetIds||[],_=a.removedTargetIds||[];t=new rh(v,_,p.key,p)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const o=kc(n,a.document),c=a.readTime?$n(a.readTime):Ce.min(),d=Zt.newNoDocument(o,c),f=a.removedTargetIds||[];t=new rh([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const o=kc(n,a.document),c=a.removedTargetIds||[];t=new rh([],c,o,null)}else{if(!("filter"in e))return xe(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:o=0,unchangedNames:c}=a,d=new sD(o,c),f=a.targetId;t=new u0(f,d)}}return t}function g0(n,e){let t;if(e instanceof lu)t={update:vN(n,e.key,e.value)};else if(e instanceof Kh)t={delete:Ah(n,e.key)};else if(e instanceof Vi)t={update:vN(n,e.key,e.data),updateMask:ND(e.fieldMask)};else{if(!(e instanceof o0))return xe(16599,{ft:e.type});t={verify:Ah(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(a=>function(c,d){const f=d.transform;if(f instanceof Xc)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Wc)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Zc)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof xh)return{fieldPath:d.field.canonicalString(),increment:f.Re};throw xe(20930,{transform:d.transform})}(0,a))),e.precondition.isNone||(t.currentDocument=function(o,c){return c.updateTime!==void 0?{updateTime:uD(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:xe(27497)}(n,e.precondition)),t}function mD(n,e){return n&&n.length>0?(Ze(e!==void 0,14353),n.map(t=>function(o,c){let d=o.updateTime?$n(o.updateTime):$n(c);return d.isEqual(Ce.min())&&(d=$n(c)),new Z1(d,o.transformResults||[])}(t,e))):[]}function pD(n,e){return{documents:[m0(n,e.path)]}}function gD(n,e){const t={structuredQuery:{}},a=e.path;let o;e.collectionGroup!==null?(o=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=m0(n,o);const c=function(v){if(v.length!==0)return y0(Ts.create(v,"and"))}(e.filters);c&&(t.structuredQuery.where=c);const d=function(v){if(v.length!==0)return v.map(_=>function(j){return{field:Lo(j.field),direction:_D(j.dir)}}(_))}(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=rg(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=function(v){return{before:v.inclusive,values:v.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(v){return{before:!v.inclusive,values:v.position}}(e.endAt)),{gt:t,parent:o}}function vD(n){let e=dD(n.parent);const t=n.structuredQuery,a=t.from?t.from.length:0;let o=null;if(a>0){Ze(a===1,65062);const _=t.from[0];_.allDescendants?o=_.collectionId:e=e.child(_.collectionId)}let c=[];t.where&&(c=function(N){const j=v0(N);return j instanceof Ts&&zT(j)?j.getFilters():[j]}(t.where));let d=[];t.orderBy&&(d=function(N){return N.map(j=>function(b){return new Qc(Vo(b.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(j))}(t.orderBy));let f=null;t.limit&&(f=function(N){let j;return j=typeof N=="object"?N.value:N,ou(j)?null:j}(t.limit));let p=null;t.startAt&&(p=function(N){const j=!!N.before,C=N.values||[];return new bh(C,j)}(t.startAt));let v=null;return t.endAt&&(v=function(N){const j=!N.before,C=N.values||[];return new bh(C,j)}(t.endAt)),V1(e,o,d,c,f,"F",p,v)}function yD(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xe(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function v0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=Vo(t.unaryFilter.field);return Mt.create(a,"==",{doubleValue:NaN});case"IS_NULL":const o=Vo(t.unaryFilter.field);return Mt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Vo(t.unaryFilter.field);return Mt.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Vo(t.unaryFilter.field);return Mt.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xe(61313);default:return xe(60726)}}(n):n.fieldFilter!==void 0?function(t){return Mt.create(Vo(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xe(58110);default:return xe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ts.create(t.compositeFilter.filters.map(a=>v0(a)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return xe(1026)}}(t.compositeFilter.op))}(n):xe(30097,{filter:n})}function _D(n){return rD[n]}function ED(n){return oD[n]}function bD(n){return lD[n]}function Lo(n){return{fieldPath:n.canonicalString()}}function Vo(n){return ln.fromServerFormat(n.fieldPath)}function y0(n){return n instanceof Mt?function(t){if(t.op==="=="){if(aN(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NAN"}};if(sN(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(aN(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NOT_NAN"}};if(sN(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Lo(t.field),op:ED(t.op),value:t.value}}}(n):n instanceof Ts?function(t){const a=t.getFilters().map(o=>y0(o));return a.length===1?a[0]:{compositeFilter:{op:bD(t.op),filters:a}}}(n):xe(54877,{filter:n})}function ND(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function _0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,t,a,o,c=Ce.min(),d=Ce.min(),f=dn.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e){this.wt=e}}function TD(n){const e=vD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Nh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(){this.Cn=new jD}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(Ti.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(Ti.min())}updateCollectionGroup(e,t,a){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class jD{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t]||new qt(ht.comparator),c=!o.has(a);return this.index[t]=o.add(a),c}has(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t];return o&&o.has(a)}getEntries(e){return(this.index[e]||new qt(ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},E0=41943040;class Rn{static withCacheSize(e){return new Rn(e,Rn.DEFAULT_COLLECTION_PERCENTILE,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rn.DEFAULT_COLLECTION_PERCENTILE=10,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rn.DEFAULT=new Rn(E0,Rn.DEFAULT_COLLECTION_PERCENTILE,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rn.DISABLED=new Rn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Jo(0)}static lr(){return new Jo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N="LruGarbageCollector",CD=1048576;function EN([n,e],[t,a]){const o=Ve(n,t);return o===0?Ve(e,a):o}class SD{constructor(e){this.Er=e,this.buffer=new qt(EN),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();EN(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class wD{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){pe(_N,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ll(t)?pe(_N,"Ignoring IndexedDB error during garbage collection: ",t):await ol(t)}await this.mr(3e5)})}}class ID{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(a=>Math.floor(t/100*a))}nthSequenceNumber(e,t){if(t===0)return le.resolve(qh.le);const a=new SD(t);return this.gr.forEachTarget(e,o=>a.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>a.Rr(o))).next(()=>a.maxValue)}removeTargets(e,t,a){return this.gr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(yN)):this.getCacheSize(e).next(a=>a<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yN):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let a,o,c,d,f,p,v;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(N=>(N>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${N}`),o=this.params.maximumSequenceNumbersToCollect):o=N,d=Date.now(),this.nthSequenceNumber(e,o))).next(N=>(a=N,f=Date.now(),this.removeTargets(e,a,t))).next(N=>(c=N,p=Date.now(),this.removeOrphanedDocuments(e,a))).next(N=>(v=Date.now(),Po()<=He.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-_}ms
	Determined least recently used ${o} in `+(f-d)+`ms
	Removed ${c} targets in `+(p-f)+`ms
	Removed ${N} documents in `+(v-p)+`ms
Total Duration: ${v-_}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:N})))}}function RD(n,e){return new ID(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(){this.changes=new Lr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Zt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?le.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e,t,a,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=o}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(a=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(a!==null&&Pc(a.mutation,o,zn.empty(),Ft.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.getLocalViewOfDocuments(e,a,$e()).next(()=>a))}getLocalViewOfDocuments(e,t,a=$e()){const o=Ar();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,a).next(c=>{let d=Cc();return c.forEach((f,p)=>{d=d.insert(f,p.overlayedDocument)}),d}))}getOverlayedDocuments(e,t){const a=Ar();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,$e()))}populateOverlays(e,t,a){const o=[];return a.forEach(c=>{t.has(c)||o.push(c)}),this.documentOverlayCache.getOverlays(e,o).next(c=>{c.forEach((d,f)=>{t.set(d,f)})})}computeViews(e,t,a,o){let c=Oa();const d=Mc(),f=function(){return Mc()}();return t.forEach((p,v)=>{const _=a.get(v.key);o.has(v.key)&&(_===void 0||_.mutation instanceof Vi)?c=c.insert(v.key,v):_!==void 0?(d.set(v.key,_.mutation.getFieldMask()),Pc(_.mutation,v,_.mutation.getFieldMask(),Ft.now())):d.set(v.key,zn.empty())}),this.recalculateAndSaveOverlays(e,c).next(p=>(p.forEach((v,_)=>d.set(v,_)),t.forEach((v,_)=>{var N;return f.set(v,new OD(_,(N=d.get(v))!==null&&N!==void 0?N:null))}),f))}recalculateAndSaveOverlays(e,t){const a=Mc();let o=new _t((d,f)=>d-f),c=$e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(d=>{for(const f of d)f.keys().forEach(p=>{const v=t.get(p);if(v===null)return;let _=a.get(p)||zn.empty();_=f.applyToLocalView(v,_),a.set(p,_);const N=(o.get(f.batchId)||$e()).add(p);o=o.insert(f.batchId,N)})}).next(()=>{const d=[],f=o.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),v=p.key,_=p.value,N=JT();_.forEach(j=>{if(!c.has(j)){const C=i0(t.get(j),a.get(j));C!==null&&N.set(j,C),c=c.add(j)}}),d.push(this.documentOverlayCache.saveOverlays(e,v,N))}return le.waitFor(d)}).next(()=>a)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.recalculateAndSaveOverlays(e,a))}getDocumentsMatchingQuery(e,t,a,o){return function(d){return be.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):KT(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,o):this.getDocumentsMatchingCollectionQuery(e,t,a,o)}getNextDocuments(e,t,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,o).next(c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,o-c.size):le.resolve(Ar());let f=Gc,p=c;return d.next(v=>le.forEach(v,(_,N)=>(f<N.largestBatchId&&(f=N.largestBatchId),c.get(_)?le.resolve():this.remoteDocumentCache.getEntry(e,_).next(j=>{p=p.insert(_,j)}))).next(()=>this.populateOverlays(e,v,c)).next(()=>this.computeViews(e,p,v,$e())).next(_=>({batchId:f,changes:ZT(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new be(t)).next(a=>{let o=Cc();return a.isFoundDocument()&&(o=o.insert(a.key,a)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,a,o){const c=t.collectionGroup;let d=Cc();return this.indexManager.getCollectionParents(e,c).next(f=>le.forEach(f,p=>{const v=function(N,j){return new cl(j,null,N.explicitOrderBy.slice(),N.filters.slice(),N.limit,N.limitType,N.startAt,N.endAt)}(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,v,a,o).next(_=>{_.forEach((N,j)=>{d=d.insert(N,j)})})}).next(()=>d))}getDocumentsMatchingCollectionQuery(e,t,a,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next(d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,c,o))).next(d=>{c.forEach((p,v)=>{const _=v.getKey();d.get(_)===null&&(d=d.insert(_,Zt.newInvalidDocument(_)))});let f=Cc();return d.forEach((p,v)=>{const _=c.get(p);_!==void 0&&Pc(_.mutation,v,zn.empty(),Ft.now()),Gh(t,v)&&(f=f.insert(p,v))}),f})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return le.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:$n(o.createTime)}}(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:TD(o.bundledQuery),readTime:$n(o.readTime)}}(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(){this.overlays=new _t(be.comparator),this.Qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const a=Ar();return le.forEach(t,o=>this.getOverlay(e,o).next(c=>{c!==null&&a.set(o,c)})).next(()=>a)}saveOverlays(e,t,a){return a.forEach((o,c)=>{this.St(e,t,c)}),le.resolve()}removeOverlaysForBatchId(e,t,a){const o=this.Qr.get(a);return o!==void 0&&(o.forEach(c=>this.overlays=this.overlays.remove(c)),this.Qr.delete(a)),le.resolve()}getOverlaysForCollection(e,t,a){const o=Ar(),c=t.length+1,d=new be(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const p=f.getNext().value,v=p.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===c&&p.largestBatchId>a&&o.set(p.getKey(),p)}return le.resolve(o)}getOverlaysForCollectionGroup(e,t,a,o){let c=new _t((v,_)=>v-_);const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>a){let _=c.get(v.largestBatchId);_===null&&(_=Ar(),c=c.insert(v.largestBatchId,_)),_.set(v.getKey(),v)}}const f=Ar(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((v,_)=>f.set(v,_)),!(f.size()>=o)););return le.resolve(f)}St(e,t,a){const o=this.overlays.get(a.key);if(o!==null){const d=this.Qr.get(o.largestBatchId).delete(a.key);this.Qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(a.key,new nD(t,a));let c=this.Qr.get(t);c===void 0&&(c=$e(),this.Qr.set(t,c)),this.Qr.set(t,c.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(){this.sessionToken=dn.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(){this.$r=new qt(Wt.Ur),this.Kr=new qt(Wt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const a=new Wt(e,t);this.$r=this.$r.add(a),this.Kr=this.Kr.add(a)}Gr(e,t){e.forEach(a=>this.addReference(a,t))}removeReference(e,t){this.zr(new Wt(e,t))}jr(e,t){e.forEach(a=>this.removeReference(a,t))}Hr(e){const t=new be(new ht([])),a=new Wt(t,e),o=new Wt(t,e+1),c=[];return this.Kr.forEachInRange([a,o],d=>{this.zr(d),c.push(d.key)}),c}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new be(new ht([])),a=new Wt(t,e),o=new Wt(t,e+1);let c=$e();return this.Kr.forEachInRange([a,o],d=>{c=c.add(d.key)}),c}containsKey(e){const t=new Wt(e,0),a=this.$r.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class Wt{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return be.comparator(e.key,t.key)||Ve(e.Zr,t.Zr)}static Wr(e,t){return Ve(e.Zr,t.Zr)||be.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new qt(Wt.Ur)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,o){const c=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new tD(c,t,a,o);this.mutationQueue.push(d);for(const f of o)this.Xr=this.Xr.add(new Wt(f.key,c)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return le.resolve(d)}lookupMutationBatch(e,t){return le.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,o=this.ti(a),c=o<0?0:o;return le.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?Ug:this.nr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new Wt(t,0),o=new Wt(t,Number.POSITIVE_INFINITY),c=[];return this.Xr.forEachInRange([a,o],d=>{const f=this.ei(d.Zr);c.push(f)}),le.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new qt(Ve);return t.forEach(o=>{const c=new Wt(o,0),d=new Wt(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([c,d],f=>{a=a.add(f.Zr)})}),le.resolve(this.ni(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,o=a.length+1;let c=a;be.isDocumentKey(c)||(c=c.child(""));const d=new Wt(new be(c),0);let f=new qt(Ve);return this.Xr.forEachWhile(p=>{const v=p.key.path;return!!a.isPrefixOf(v)&&(v.length===o&&(f=f.add(p.Zr)),!0)},d),le.resolve(this.ni(f))}ni(e){const t=[];return e.forEach(a=>{const o=this.ei(a);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Ze(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Xr;return le.forEach(t.mutations,o=>{const c=new Wt(o.key,t.batchId);return a=a.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=a})}sr(e){}containsKey(e,t){const a=new Wt(t,0),o=this.Xr.firstAfterOrEqual(a);return le.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(e){this.ii=e,this.docs=function(){return new _t(be.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,o=this.docs.get(a),c=o?o.size:0,d=this.ii(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return le.resolve(a?a.document.mutableCopy():Zt.newInvalidDocument(t))}getEntries(e,t){let a=Oa();return t.forEach(o=>{const c=this.docs.get(o);a=a.insert(o,c?c.document.mutableCopy():Zt.newInvalidDocument(o))}),le.resolve(a)}getDocumentsMatchingQuery(e,t,a,o){let c=Oa();const d=t.path,f=new be(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:v,value:{document:_}}=p.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||g1(p1(_),a)<=0||(o.has(_.key)||Gh(t,_))&&(c=c.insert(_.key,_.mutableCopy()))}return le.resolve(c)}getAllFromCollectionGroup(e,t,a,o){xe(9500)}si(e,t){return le.forEach(this.docs,a=>t(a))}newChangeBuffer(e){return new FD(this)}getSize(e){return le.resolve(this.size)}}class FD extends DD{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((a,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(a)}),le.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qD{constructor(e){this.persistence=e,this.oi=new Lr(t=>Bg(t),Hg),this.lastRemoteSnapshotVersion=Ce.min(),this.highestTargetId=0,this._i=0,this.ai=new Kg,this.targetCount=0,this.ui=Jo.cr()}forEachTarget(e,t){return this.oi.forEach((a,o)=>t(o)),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this._i&&(this._i=t),le.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Jo(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Tr(t),le.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,a){let o=0;const c=[];return this.oi.forEach((d,f)=>{f.sequenceNumber<=t&&a.get(f.targetId)===null&&(this.oi.delete(d),c.push(this.removeMatchingKeysForTargetId(e,f.targetId)),o++)}),le.waitFor(c).next(()=>o)}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const a=this.oi.get(t)||null;return le.resolve(a)}addMatchingKeys(e,t,a){return this.ai.Gr(t,a),le.resolve()}removeMatchingKeys(e,t,a){this.ai.jr(t,a);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach(d=>{c.push(o.markPotentiallyOrphaned(e,d))}),le.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const a=this.ai.Yr(t);return le.resolve(a)}containsKey(e,t){return le.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(e,t){this.ci={},this.overlays={},this.li=new qh(0),this.hi=!1,this.hi=!0,this.Pi=new LD,this.referenceDelegate=e(this),this.Ti=new qD(this),this.indexManager=new AD,this.remoteDocumentCache=function(o){return new UD(o)}(a=>this.referenceDelegate.Ii(a)),this.serializer=new xD(t),this.Ei=new PD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ci[e.toKey()];return a||(a=new VD(t,this.referenceDelegate),this.ci[e.toKey()]=a),a}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,a){pe("MemoryPersistence","Starting transaction:",e);const o=new BD(this.li.next());return this.referenceDelegate.di(),a(o).next(c=>this.referenceDelegate.Ai(o).next(()=>c)).toPromise().then(c=>(o.raiseOnCommittedEvent(),c))}Ri(e,t){return le.or(Object.values(this.ci).map(a=>()=>a.containsKey(e,t)))}}class BD extends y1{constructor(e){super(),this.currentSequenceNumber=e}}class Qg{constructor(e){this.persistence=e,this.Vi=new Kg,this.mi=null}static fi(e){return new Qg(e)}get gi(){if(this.mi)return this.mi;throw xe(60996)}addReference(e,t,a){return this.Vi.addReference(a,t),this.gi.delete(a.toString()),le.resolve()}removeReference(e,t,a){return this.Vi.removeReference(a,t),this.gi.add(a.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(c=>this.gi.add(c.toString()))}).next(()=>a.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.gi,a=>{const o=be.fromPath(a);return this.pi(e,o).next(c=>{c||t.removeEntry(o,Ce.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(a=>{a?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return le.or([()=>le.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class jh{constructor(e,t){this.persistence=e,this.yi=new Lr(a=>b1(a.path),(a,o)=>a.isEqual(o)),this.garbageCollector=RD(this,t)}static fi(e,t){return new jh(e,t)}di(){}Ai(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(a=>t.next(o=>a+o))}br(e){let t=0;return this.yr(e,a=>{t++}).next(()=>t)}yr(e,t){return le.forEach(this.yi,(a,o)=>this.Dr(e,a,o).next(c=>c?le.resolve():t(o)))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.si(e,d=>this.Dr(e,d,t).next(f=>{f||(a++,c.removeEntry(d,Ce.min()))})).next(()=>c.apply(e)).next(()=>a)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}removeReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=sh(e.data.value)),t}Dr(e,t,a){return le.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return le.resolve(o!==void 0&&o>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg{constructor(e,t,a,o){this.targetId=e,this.fromCache=t,this.ds=a,this.As=o}static Rs(e,t){let a=$e(),o=$e();for(const c of t.docChanges)switch(c.type){case 0:a=a.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new Xg(e,t.fromCache,a,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return NS()?8:_1(_n())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,a,o){const c={result:null};return this.ws(e,t).next(d=>{c.result=d}).next(()=>{if(!c.result)return this.bs(e,t,o,a).next(d=>{c.result=d})}).next(()=>{if(c.result)return;const d=new HD;return this.Ss(e,t,d).next(f=>{if(c.result=f,this.fs)return this.Ds(e,t,d,f.size)})}).next(()=>c.result)}Ds(e,t,a,o){return a.documentReadCount<this.gs?(Po()<=He.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",ko(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),le.resolve()):(Po()<=He.DEBUG&&pe("QueryEngine","Query:",ko(t),"scans",a.documentReadCount,"local documents and returns",o,"documents as results."),a.documentReadCount>this.ps*o?(Po()<=He.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",ko(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ys(t))):le.resolve())}ws(e,t){if(lN(t))return le.resolve(null);let a=Ys(t);return this.indexManager.getIndexType(e,a).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Nh(t,null,"F"),a=Ys(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next(c=>{const d=$e(...c);return this.ys.getDocuments(e,d).next(f=>this.indexManager.getMinOffset(e,a).next(p=>{const v=this.vs(t,f);return this.Cs(t,v,d,p.readTime)?this.ws(e,Nh(t,null,"F")):this.Fs(e,v,t,p)}))})))}bs(e,t,a,o){return lN(t)||o.isEqual(Ce.min())?le.resolve(null):this.ys.getDocuments(e,a).next(c=>{const d=this.vs(t,c);return this.Cs(t,d,a,o)?le.resolve(null):(Po()<=He.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),ko(t)),this.Fs(e,d,t,m1(o,Gc)).next(f=>f))})}vs(e,t){let a=new qt(XT(e));return t.forEach((o,c)=>{Gh(e,c)&&(a=a.add(c))}),a}Cs(e,t,a,o){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,a){return Po()<=He.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",ko(t)),this.ys.getDocumentsMatchingQuery(e,t,Ti.min(),a)}Fs(e,t,a,o){return this.ys.getDocumentsMatchingQuery(e,a,o).next(c=>(t.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wg="LocalStore",GD=3e8;class $D{constructor(e,t,a,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new _t(Ve),this.Os=new Lr(c=>Bg(c),Hg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(a)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MD(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function YD(n,e,t,a){return new $D(n,e,t,a)}async function N0(n,e){const t=Re(n);return await t.persistence.runTransaction("Handle user change","readonly",a=>{let o;return t.mutationQueue.getAllMutationBatches(a).next(c=>(o=c,t.Ls(e),t.mutationQueue.getAllMutationBatches(a))).next(c=>{const d=[],f=[];let p=$e();for(const v of o){d.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}for(const v of c){f.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}return t.localDocuments.getDocuments(a,p).next(v=>({ks:v,removedBatchIds:d,addedBatchIds:f}))})})}function KD(n,e){const t=Re(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const o=e.batch.keys(),c=t.Bs.newChangeBuffer({trackRemovals:!0});return function(f,p,v,_){const N=v.batch,j=N.keys();let C=le.resolve();return j.forEach(b=>{C=C.next(()=>_.getEntry(p,b)).next(M=>{const T=v.docVersions.get(b);Ze(T!==null,48541),M.version.compareTo(T)<0&&(N.applyToRemoteDocument(M,v),M.isValidDocument()&&(M.setReadTime(v.commitVersion),_.addEntry(M)))})}),C.next(()=>f.mutationQueue.removeMutationBatch(p,N))}(t,a,e,c).next(()=>c.apply(a)).next(()=>t.mutationQueue.performConsistencyCheck(a)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(a,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,function(f){let p=$e();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(p=p.add(f.batch.mutations[v].key));return p}(e))).next(()=>t.localDocuments.getDocuments(a,o))})}function x0(n){const e=Re(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function QD(n,e){const t=Re(n),a=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const f=[];e.targetChanges.forEach((_,N)=>{const j=o.get(N);if(!j)return;f.push(t.Ti.removeMatchingKeys(c,_.removedDocuments,N).next(()=>t.Ti.addMatchingKeys(c,_.addedDocuments,N)));let C=j.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(N)!==null?C=C.withResumeToken(dn.EMPTY_BYTE_STRING,Ce.min()).withLastLimboFreeSnapshotVersion(Ce.min()):_.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(_.resumeToken,a)),o=o.insert(N,C),function(M,T,L){return M.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=GD?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(j,C,_)&&f.push(t.Ti.updateTargetData(c,C))});let p=Oa(),v=$e();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(c,_))}),f.push(XD(c,d,e.documentUpdates).next(_=>{p=_.qs,v=_.Qs})),!a.isEqual(Ce.min())){const _=t.Ti.getLastRemoteSnapshotVersion(c).next(N=>t.Ti.setTargetsMetadata(c,c.currentSequenceNumber,a));f.push(_)}return le.waitFor(f).next(()=>d.apply(c)).next(()=>t.localDocuments.getLocalViewOfDocuments(c,p,v)).next(()=>p)}).then(c=>(t.xs=o,c))}function XD(n,e,t){let a=$e(),o=$e();return t.forEach(c=>a=a.add(c)),e.getEntries(n,a).next(c=>{let d=Oa();return t.forEach((f,p)=>{const v=c.get(f);p.isFoundDocument()!==v.isFoundDocument()&&(o=o.add(f)),p.isNoDocument()&&p.version.isEqual(Ce.min())?(e.removeEntry(f,p.readTime),d=d.insert(f,p)):!v.isValidDocument()||p.version.compareTo(v.version)>0||p.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(p),d=d.insert(f,p)):pe(Wg,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",p.version)}),{qs:d,Qs:o}})}function WD(n,e){const t=Re(n);return t.persistence.runTransaction("Get next mutation batch","readonly",a=>(e===void 0&&(e=Ug),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e)))}function ZD(n,e){const t=Re(n);return t.persistence.runTransaction("Allocate target","readwrite",a=>{let o;return t.Ti.getTargetData(a,e).next(c=>c?(o=c,le.resolve(o)):t.Ti.allocateTargetId(a).next(d=>(o=new yi(e,d,"TargetPurposeListen",a.currentSequenceNumber),t.Ti.addTargetData(a,o).next(()=>o))))}).then(a=>{const o=t.xs.get(a.targetId);return(o===null||a.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(a.targetId,a),t.Os.set(e,a.targetId)),a})}async function cg(n,e,t){const a=Re(n),o=a.xs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",c,d=>a.persistence.referenceDelegate.removeTarget(d,o))}catch(d){if(!ll(d))throw d;pe(Wg,`Failed to update sequence numbers for target ${e}: ${d}`)}a.xs=a.xs.remove(e),a.Os.delete(o.target)}function bN(n,e,t){const a=Re(n);let o=Ce.min(),c=$e();return a.persistence.runTransaction("Execute query","readwrite",d=>function(p,v,_){const N=Re(p),j=N.Os.get(_);return j!==void 0?le.resolve(N.xs.get(j)):N.Ti.getTargetData(v,_)}(a,d,Ys(e)).next(f=>{if(f)return o=f.lastLimboFreeSnapshotVersion,a.Ti.getMatchingKeysForTargetId(d,f.targetId).next(p=>{c=p})}).next(()=>a.Ms.getDocumentsMatchingQuery(d,e,t?o:Ce.min(),t?c:$e())).next(f=>(JD(a,F1(e),f),{documents:f,$s:c})))}function JD(n,e,t){let a=n.Ns.get(e)||Ce.min();t.forEach((o,c)=>{c.readTime.compareTo(a)>0&&(a=c.readTime)}),n.Ns.set(e,a)}class NN{constructor(){this.activeTargetIds=$1()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class eO{constructor(){this.xo=new NN,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,a){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new NN,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xN="ConnectivityMonitor";class TN{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){pe(xN,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){pe(xN,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kd=null;function ug(){return Kd===null?Kd=function(){return 268435456+Math.round(2147483648*Math.random())}():Kd++,"0x"+Kd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wp="RestConnection",nO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sO{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${a}/databases/${o}`,this.Go=this.databaseId.database===_h?`project_id=${a}`:`project_id=${a}&database_id=${o}`}zo(e,t,a,o,c){const d=ug(),f=this.jo(e,t.toUriEncodedString());pe(wp,`Sending RPC '${e}' ${d}:`,f,a);const p={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(p,o,c);const{host:v}=new URL(f),_=Pr(v);return this.Jo(e,f,p,a,_).then(N=>(pe(wp,`Received RPC '${e}' ${d}: `,N),N),N=>{throw Qo(wp,`RPC '${e}' ${d} failed with error: `,N,"url: ",f,"request:",a),N})}Yo(e,t,a,o,c,d){return this.zo(e,t,a,o,c)}Ho(e,t,a){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+rl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,c)=>e[c]=o),a&&a.headers.forEach((o,c)=>e[c]=o)}jo(e,t){const a=nO[e];return`${this.Ko}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn="WebChannelConnection";class iO extends sO{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,o,c){const d=ug();return new Promise((f,p)=>{const v=new xT;v.setWithCredentials(!0),v.listenOnce(TT.COMPLETE,()=>{try{switch(v.getLastErrorCode()){case nh.NO_ERROR:const N=v.getResponseJson();pe(pn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(N)),f(N);break;case nh.TIMEOUT:pe(pn,`RPC '${e}' ${d} timed out`),p(new me(re.DEADLINE_EXCEEDED,"Request time out"));break;case nh.HTTP_ERROR:const j=v.getStatus();if(pe(pn,`RPC '${e}' ${d} failed with status:`,j,"response text:",v.getResponseText()),j>0){let C=v.getResponseJson();Array.isArray(C)&&(C=C[0]);const b=C?.error;if(b&&b.status&&b.message){const M=function(L){const $=L.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf($)>=0?$:re.UNKNOWN}(b.status);p(new me(M,b.message))}else p(new me(re.UNKNOWN,"Server responded with status "+v.getStatus()))}else p(new me(re.UNAVAILABLE,"Connection failed."));break;default:xe(9055,{h_:e,streamId:d,P_:v.getLastErrorCode(),T_:v.getLastError()})}}finally{pe(pn,`RPC '${e}' ${d} completed.`)}});const _=JSON.stringify(o);pe(pn,`RPC '${e}' ${d} sending request:`,o),v.send(t,"POST",_,a,15)})}I_(e,t,a){const o=ug(),c=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=CT(),f=jT(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(p.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Ho(p.initMessageHeaders,t,a),p.encodeInitMessageHeaders=!0;const _=c.join("");pe(pn,`Creating RPC '${e}' stream ${o}: ${_}`,p);const N=d.createWebChannel(_,p);this.E_(N);let j=!1,C=!1;const b=new aO({Zo:T=>{C?pe(pn,`Not sending because RPC '${e}' stream ${o} is closed:`,T):(j||(pe(pn,`Opening RPC '${e}' stream ${o} transport.`),N.open(),j=!0),pe(pn,`RPC '${e}' stream ${o} sending:`,T),N.send(T))},Xo:()=>N.close()}),M=(T,L,$)=>{T.listen(L,O=>{try{$(O)}catch(U){setTimeout(()=>{throw U},0)}})};return M(N,jc.EventType.OPEN,()=>{C||(pe(pn,`RPC '${e}' stream ${o} transport opened.`),b.__())}),M(N,jc.EventType.CLOSE,()=>{C||(C=!0,pe(pn,`RPC '${e}' stream ${o} transport closed`),b.u_(),this.d_(N))}),M(N,jc.EventType.ERROR,T=>{C||(C=!0,Qo(pn,`RPC '${e}' stream ${o} transport errored. Name:`,T.name,"Message:",T.message),b.u_(new me(re.UNAVAILABLE,"The operation could not be completed")))}),M(N,jc.EventType.MESSAGE,T=>{var L;if(!C){const $=T.data[0];Ze(!!$,16349);const O=$,U=O?.error||((L=O[0])===null||L===void 0?void 0:L.error);if(U){pe(pn,`RPC '${e}' stream ${o} received error:`,U);const F=U.status;let X=function(R){const I=Ot[R];if(I!==void 0)return c0(I)}(F),w=U.message;X===void 0&&(X=re.INTERNAL,w="Unknown error status: "+F+" with message "+U.message),C=!0,b.u_(new me(X,w)),N.close()}else pe(pn,`RPC '${e}' stream ${o} received:`,$),b.c_($)}}),M(f,AT.STAT_EVENT,T=>{T.stat===Jp.PROXY?pe(pn,`RPC '${e}' stream ${o} detected buffering proxy`):T.stat===Jp.NOPROXY&&pe(pn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{b.a_()},0),b}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function Ip(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(n){return new cD(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e,t,a=1e3,o=1.5,c=6e4){this.xi=e,this.timerId=t,this.A_=a,this.R_=o,this.V_=c,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),a=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-a);o>0&&pe("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN="PersistentStream";class T0{constructor(e,t,a,o,c,d,f,p){this.xi=e,this.S_=a,this.D_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Zg(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(Da(t.toString()),Da("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,o])=>{this.v_===t&&this.z_(a,o)},a=>{e(()=>{const o=new me(re.UNKNOWN,"Fetching auth token failed: "+a.message);return this.j_(o)})})}z_(e,t){const a=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{a(()=>this.listener.e_())}),this.stream.n_(()=>{a(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{a(()=>this.j_(o))}),this.stream.onMessage(o=>{a(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return pe(AN,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(pe(AN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class rO extends T0{constructor(e,t,a,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=fD(this.serializer,e),a=function(c){if(!("targetChange"in c))return Ce.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?Ce.min():d.readTime?$n(d.readTime):Ce.min()}(e);return this.listener.Y_(t,a)}Z_(e){const t={};t.database=lg(this.serializer),t.addTarget=function(c,d){let f;const p=d.target;if(f=ag(p)?{documents:pD(c,p)}:{query:gD(c,p).gt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=h0(c,d.resumeToken);const v=rg(c,d.expectedCount);v!==null&&(f.expectedCount=v)}else if(d.snapshotVersion.compareTo(Ce.min())>0){f.readTime=Th(c,d.snapshotVersion.toTimestamp());const v=rg(c,d.expectedCount);v!==null&&(f.expectedCount=v)}return f}(this.serializer,e);const a=yD(this.serializer,e);a&&(t.labels=a),this.Q_(t)}X_(e){const t={};t.database=lg(this.serializer),t.removeTarget=e,this.Q_(t)}}class oO extends T0{constructor(e,t,a,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=mD(e.writeResults,e.commitTime),a=$n(e.commitTime);return this.listener.ra(a,t)}ia(){const e={};e.database=lg(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(a=>g0(this.serializer,a))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{}class cO extends lO{constructor(e,t,a,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new me(re.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,a,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.zo(e,og(t,a),o,c,d)).catch(c=>{throw c.name==="FirebaseError"?(c.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new me(re.UNKNOWN,c.toString())})}Yo(e,t,a,o,c){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,f])=>this.connection.Yo(e,og(t,a),o,d,f,c)).catch(d=>{throw d.name==="FirebaseError"?(d.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new me(re.UNKNOWN,d.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class uO{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Da(t),this.ua=!1):pe("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr="RemoteStore";class dO{constructor(e,t,a,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=c,this.Ra.No(d=>{a.enqueueAndForget(async()=>{Vr(this)&&(pe(Rr,"Restarting streams for network reachability change."),await async function(p){const v=Re(p);v.da.add(4),await uu(v),v.Va.set("Unknown"),v.da.delete(4),await Wh(v)}(this))})}),this.Va=new uO(a,o)}}async function Wh(n){if(Vr(n))for(const e of n.Aa)await e(!0)}async function uu(n){for(const e of n.Aa)await e(!1)}function A0(n,e){const t=Re(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),nv(t)?tv(t):ul(t).N_()&&ev(t,e))}function Jg(n,e){const t=Re(n),a=ul(t);t.Ea.delete(e),a.N_()&&j0(t,e),t.Ea.size===0&&(a.N_()?a.k_():Vr(t)&&t.Va.set("Unknown"))}function ev(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ce.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ul(n).Z_(e)}function j0(n,e){n.ma.Ke(e),ul(n).X_(e)}function tv(n){n.ma=new iD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),ul(n).start(),n.Va.ca()}function nv(n){return Vr(n)&&!ul(n).O_()&&n.Ea.size>0}function Vr(n){return Re(n).da.size===0}function C0(n){n.ma=void 0}async function hO(n){n.Va.set("Online")}async function fO(n){n.Ea.forEach((e,t)=>{ev(n,e)})}async function mO(n,e){C0(n),nv(n)?(n.Va.Pa(e),tv(n)):n.Va.set("Unknown")}async function pO(n,e,t){if(n.Va.set("Online"),e instanceof d0&&e.state===2&&e.cause)try{await async function(o,c){const d=c.cause;for(const f of c.targetIds)o.Ea.has(f)&&(await o.remoteSyncer.rejectListen(f,d),o.Ea.delete(f),o.ma.removeTarget(f))}(n,e)}catch(a){pe(Rr,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await Ch(n,a)}else if(e instanceof rh?n.ma.Xe(e):e instanceof u0?n.ma.ot(e):n.ma.nt(e),!t.isEqual(Ce.min()))try{const a=await x0(n.localStore);t.compareTo(a)>=0&&await function(c,d){const f=c.ma.It(d);return f.targetChanges.forEach((p,v)=>{if(p.resumeToken.approximateByteSize()>0){const _=c.Ea.get(v);_&&c.Ea.set(v,_.withResumeToken(p.resumeToken,d))}}),f.targetMismatches.forEach((p,v)=>{const _=c.Ea.get(p);if(!_)return;c.Ea.set(p,_.withResumeToken(dn.EMPTY_BYTE_STRING,_.snapshotVersion)),j0(c,p);const N=new yi(_.target,p,v,_.sequenceNumber);ev(c,N)}),c.remoteSyncer.applyRemoteEvent(f)}(n,t)}catch(a){pe(Rr,"Failed to raise snapshot:",a),await Ch(n,a)}}async function Ch(n,e,t){if(!ll(e))throw e;n.da.add(1),await uu(n),n.Va.set("Offline"),t||(t=()=>x0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{pe(Rr,"Retrying IndexedDB access"),await t(),n.da.delete(1),await Wh(n)})}function S0(n,e){return e().catch(t=>Ch(n,t,e))}async function Zh(n){const e=Re(n),t=Si(e);let a=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Ug;for(;gO(e);)try{const o=await WD(e.localStore,a);if(o===null){e.Ia.length===0&&t.k_();break}a=o.batchId,vO(e,o)}catch(o){await Ch(e,o)}w0(e)&&I0(e)}function gO(n){return Vr(n)&&n.Ia.length<10}function vO(n,e){n.Ia.push(e);const t=Si(n);t.N_()&&t.ea&&t.ta(e.mutations)}function w0(n){return Vr(n)&&!Si(n).O_()&&n.Ia.length>0}function I0(n){Si(n).start()}async function yO(n){Si(n).ia()}async function _O(n){const e=Si(n);for(const t of n.Ia)e.ta(t.mutations)}async function EO(n,e,t){const a=n.Ia.shift(),o=Gg.from(a,e,t);await S0(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await Zh(n)}async function bO(n,e){e&&Si(n).ea&&await async function(a,o){if(function(d){return l0(d)&&d!==re.ABORTED}(o.code)){const c=a.Ia.shift();Si(a).L_(),await S0(a,()=>a.remoteSyncer.rejectFailedWrite(c.batchId,o)),await Zh(a)}}(n,e),w0(n)&&I0(n)}async function jN(n,e){const t=Re(n);t.asyncQueue.verifyOperationInProgress(),pe(Rr,"RemoteStore received new credentials");const a=Vr(t);t.da.add(3),await uu(t),a&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await Wh(t)}async function NO(n,e){const t=Re(n);e?(t.da.delete(2),await Wh(t)):e||(t.da.add(2),await uu(t),t.Va.set("Unknown"))}function ul(n){return n.fa||(n.fa=function(t,a,o){const c=Re(t);return c.oa(),new rO(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:hO.bind(null,n),n_:fO.bind(null,n),i_:mO.bind(null,n),Y_:pO.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),nv(n)?tv(n):n.Va.set("Unknown")):(await n.fa.stop(),C0(n))})),n.fa}function Si(n){return n.ga||(n.ga=function(t,a,o){const c=Re(t);return c.oa(),new oO(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:yO.bind(null,n),i_:bO.bind(null,n),na:_O.bind(null,n),ra:EO.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await Zh(n)):(await n.ga.stop(),n.Ia.length>0&&(pe(Rr,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e,t,a,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=o,this.removalCallback=c,this.deferred=new $s,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,o,c){const d=Date.now()+a,f=new sv(e,t,d,o,c);return f.start(a),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function av(n,e){if(Da("AsyncQueue",`${e}: ${n}`),ll(n))return new me(re.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{static emptySet(e){return new $o(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||be.comparator(t.key,a.key):(t,a)=>be.comparator(t.key,a.key),this.keyedMap=Cc(),this.sortedSet=new _t(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,a)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $o)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new $o;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(){this.pa=new _t(be.comparator)}track(e){const t=e.doc.key,a=this.pa.get(t);a?e.type!==0&&a.type===3?this.pa=this.pa.insert(t,e):e.type===3&&a.type!==1?this.pa=this.pa.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.pa=this.pa.remove(t):e.type===1&&a.type===2?this.pa=this.pa.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):xe(63341,{Vt:e,ya:a}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,a)=>{e.push(a)}),e}}class el{constructor(e,t,a,o,c,d,f,p,v){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=v}static fromInitialDocuments(e,t,a,o,c){const d=[];return t.forEach(f=>{d.push({type:0,doc:f})}),new el(e,t,$o.emptySet(t),d,a,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&zh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==a[o].type||!t[o].doc.isEqual(a[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class TO{constructor(){this.queries=SN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const o=Re(t),c=o.queries;o.queries=SN(),c.forEach((d,f)=>{for(const p of f.Sa)p.onError(a)})})(this,new me(re.ABORTED,"Firestore shutting down"))}}function SN(){return new Lr(n=>QT(n),zh)}async function iv(n,e){const t=Re(n);let a=3;const o=e.query;let c=t.queries.get(o);c?!c.Da()&&e.va()&&(a=2):(c=new xO,a=e.va()?0:1);try{switch(a){case 0:c.ba=await t.onListen(o,!0);break;case 1:c.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const f=av(d,`Initialization of query '${ko(e.query)}' failed`);return void e.onError(f)}t.queries.set(o,c),c.Sa.push(e),e.Fa(t.onlineState),c.ba&&e.Ma(c.ba)&&ov(t)}async function rv(n,e){const t=Re(n),a=e.query;let o=3;const c=t.queries.get(a);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.va()?0:1:!c.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function AO(n,e){const t=Re(n);let a=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const f of d.Sa)f.Ma(o)&&(a=!0);d.ba=o}}a&&ov(t)}function jO(n,e,t){const a=Re(n),o=a.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);a.queries.delete(e)}function ov(n){n.Ca.forEach(e=>{e.next()})}var dg,wN;(wN=dg||(dg={})).xa="default",wN.Cache="cache";class lv{constructor(e,t,a){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=a||{}}Ma(e){if(!this.options.includeMetadataChanges){const a=[];for(const o of e.docChanges)o.type!==3&&a.push(o);e=new el(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const a=t!=="Offline";return(!this.options.Qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=el.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==dg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(e){this.key=e}}class D0{constructor(e){this.key=e}}class CO{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=$e(),this.mutatedKeys=$e(),this.Za=XT(e),this.Xa=new $o(this.Za)}get eu(){return this.Ha}tu(e,t){const a=t?t.nu:new CN,o=t?t.Xa:this.Xa;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,f=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,v=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((_,N)=>{const j=o.get(_),C=Gh(this.query,N)?N:null,b=!!j&&this.mutatedKeys.has(j.key),M=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let T=!1;j&&C?j.data.isEqual(C.data)?b!==M&&(a.track({type:3,doc:C}),T=!0):this.ru(j,C)||(a.track({type:2,doc:C}),T=!0,(p&&this.Za(C,p)>0||v&&this.Za(C,v)<0)&&(f=!0)):!j&&C?(a.track({type:0,doc:C}),T=!0):j&&!C&&(a.track({type:1,doc:j}),T=!0,(p||v)&&(f=!0)),T&&(C?(d=d.add(C),c=M?c.add(_):c.delete(_)):(d=d.delete(_),c=c.delete(_)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const _=this.query.limitType==="F"?d.last():d.first();d=d.delete(_.key),c=c.delete(_.key),a.track({type:1,doc:_})}return{Xa:d,nu:a,Cs:f,mutatedKeys:c}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,o){const c=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const d=e.nu.wa();d.sort((_,N)=>function(C,b){const M=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xe(20277,{Vt:T})}};return M(C)-M(b)}(_.type,N.type)||this.Za(_.doc,N.doc)),this.iu(a),o=o!=null&&o;const f=t&&!o?this.su():[],p=this.Ya.size===0&&this.current&&!o?1:0,v=p!==this.Ja;return this.Ja=p,d.length!==0||v?{snapshot:new el(this.query,e.Xa,c,d,e.mutatedKeys,p===0,v,!1,!!a&&a.resumeToken.approximateByteSize()>0),ou:f}:{ou:f}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new CN,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=$e(),this.Xa.forEach(a=>{this._u(a.key)&&(this.Ya=this.Ya.add(a.key))});const t=[];return e.forEach(a=>{this.Ya.has(a)||t.push(new D0(a))}),this.Ya.forEach(a=>{e.has(a)||t.push(new R0(a))}),t}au(e){this.Ha=e.$s,this.Ya=$e();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return el.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const cv="SyncEngine";class SO{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class wO{constructor(e){this.key=e,this.cu=!1}}class IO{constructor(e,t,a,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.lu={},this.hu=new Lr(f=>QT(f),zh),this.Pu=new Map,this.Tu=new Set,this.Iu=new _t(be.comparator),this.Eu=new Map,this.du=new Kg,this.Au={},this.Ru=new Map,this.Vu=Jo.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function RO(n,e,t=!0){const a=V0(n);let o;const c=a.hu.get(e);return c?(a.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.uu()):o=await O0(a,e,t,!0),o}async function DO(n,e){const t=V0(n);await O0(t,e,!0,!1)}async function O0(n,e,t,a){const o=await ZD(n.localStore,Ys(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let f;return a&&(f=await OO(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&A0(n.remoteStore,o),f}async function OO(n,e,t,a,o){n.fu=(N,j,C)=>async function(M,T,L,$){let O=T.view.tu(L);O.Cs&&(O=await bN(M.localStore,T.query,!1).then(({documents:w})=>T.view.tu(w,O)));const U=$&&$.targetChanges.get(T.targetId),F=$&&$.targetMismatches.get(T.targetId)!=null,X=T.view.applyChanges(O,M.isPrimaryClient,U,F);return RN(M,T.targetId,X.ou),X.snapshot}(n,N,j,C);const c=await bN(n.localStore,e,!0),d=new CO(e,c.$s),f=d.tu(c.documents),p=cu.createSynthesizedTargetChangeForCurrentChange(t,a&&n.onlineState!=="Offline",o),v=d.applyChanges(f,n.isPrimaryClient,p);RN(n,t,v.ou);const _=new SO(e,t,d);return n.hu.set(e,_),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),v.snapshot}async function MO(n,e,t){const a=Re(n),o=a.hu.get(e),c=a.Pu.get(o.targetId);if(c.length>1)return a.Pu.set(o.targetId,c.filter(d=>!zh(d,e))),void a.hu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(o.targetId),a.sharedClientState.isActiveQueryTarget(o.targetId)||await cg(a.localStore,o.targetId,!1).then(()=>{a.sharedClientState.clearQueryState(o.targetId),t&&Jg(a.remoteStore,o.targetId),hg(a,o.targetId)}).catch(ol)):(hg(a,o.targetId),await cg(a.localStore,o.targetId,!0))}async function PO(n,e){const t=Re(n),a=t.hu.get(e),o=t.Pu.get(a.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),Jg(t.remoteStore,a.targetId))}async function kO(n,e,t){const a=HO(n);try{const o=await function(d,f){const p=Re(d),v=Ft.now(),_=f.reduce((C,b)=>C.add(b.key),$e());let N,j;return p.persistence.runTransaction("Locally write mutations","readwrite",C=>{let b=Oa(),M=$e();return p.Bs.getEntries(C,_).next(T=>{b=T,b.forEach((L,$)=>{$.isValidDocument()||(M=M.add(L))})}).next(()=>p.localDocuments.getOverlayedDocuments(C,b)).next(T=>{N=T;const L=[];for(const $ of f){const O=eD($,N.get($.key).overlayedDocument);O!=null&&L.push(new Vi($.key,O,qT(O.value.mapValue),cn.exists(!0)))}return p.mutationQueue.addMutationBatch(C,v,L,f)}).next(T=>{j=T;const L=T.applyToLocalDocumentSet(N,M);return p.documentOverlayCache.saveOverlays(C,T.batchId,L)})}).then(()=>({batchId:j.batchId,changes:ZT(N)}))}(a.localStore,e);a.sharedClientState.addPendingMutation(o.batchId),function(d,f,p){let v=d.Au[d.currentUser.toKey()];v||(v=new _t(Ve)),v=v.insert(f,p),d.Au[d.currentUser.toKey()]=v}(a,o.batchId,t),await du(a,o.changes),await Zh(a.remoteStore)}catch(o){const c=av(o,"Failed to persist write");t.reject(c)}}async function M0(n,e){const t=Re(n);try{const a=await QD(t.localStore,e);e.targetChanges.forEach((o,c)=>{const d=t.Eu.get(c);d&&(Ze(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.cu=!0:o.modifiedDocuments.size>0?Ze(d.cu,14607):o.removedDocuments.size>0&&(Ze(d.cu,42227),d.cu=!1))}),await du(t,a,e)}catch(a){await ol(a)}}function IN(n,e,t){const a=Re(n);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const o=[];a.hu.forEach((c,d)=>{const f=d.view.Fa(e);f.snapshot&&o.push(f.snapshot)}),function(d,f){const p=Re(d);p.onlineState=f;let v=!1;p.queries.forEach((_,N)=>{for(const j of N.Sa)j.Fa(f)&&(v=!0)}),v&&ov(p)}(a.eventManager,e),o.length&&a.lu.Y_(o),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function LO(n,e,t){const a=Re(n);a.sharedClientState.updateQueryState(e,"rejected",t);const o=a.Eu.get(e),c=o&&o.key;if(c){let d=new _t(be.comparator);d=d.insert(c,Zt.newNoDocument(c,Ce.min()));const f=$e().add(c),p=new Qh(Ce.min(),new Map,new _t(Ve),d,f);await M0(a,p),a.Iu=a.Iu.remove(c),a.Eu.delete(e),uv(a)}else await cg(a.localStore,e,!1).then(()=>hg(a,e,t)).catch(ol)}async function VO(n,e){const t=Re(n),a=e.batch.batchId;try{const o=await KD(t.localStore,e);k0(t,a,null),P0(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await du(t,o)}catch(o){await ol(o)}}async function UO(n,e,t){const a=Re(n);try{const o=await function(d,f){const p=Re(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",v=>{let _;return p.mutationQueue.lookupMutationBatch(v,f).next(N=>(Ze(N!==null,37113),_=N.keys(),p.mutationQueue.removeMutationBatch(v,N))).next(()=>p.mutationQueue.performConsistencyCheck(v)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(v,_,f)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,_)).next(()=>p.localDocuments.getDocuments(v,_))})}(a.localStore,e);k0(a,e,t),P0(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await du(a,o)}catch(o){await ol(o)}}function P0(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function k0(n,e,t){const a=Re(n);let o=a.Au[a.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),a.Au[a.currentUser.toKey()]=o}}function hg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const a of n.Pu.get(e))n.hu.delete(a),t&&n.lu.gu(a,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(a=>{n.du.containsKey(a)||L0(n,a)})}function L0(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(Jg(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),uv(n))}function RN(n,e,t){for(const a of t)a instanceof R0?(n.du.addReference(a.key,e),FO(n,a)):a instanceof D0?(pe(cv,"Document no longer in limbo: "+a.key),n.du.removeReference(a.key,e),n.du.containsKey(a.key)||L0(n,a.key)):xe(19791,{pu:a})}function FO(n,e){const t=e.key,a=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(a)||(pe(cv,"New document in limbo: "+t),n.Tu.add(a),uv(n))}function uv(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new be(ht.fromString(e)),a=n.Vu.next();n.Eu.set(a,new wO(t)),n.Iu=n.Iu.insert(t,a),A0(n.remoteStore,new yi(Ys(Hh(t.path)),a,"TargetPurposeLimboResolution",qh.le))}}async function du(n,e,t){const a=Re(n),o=[],c=[],d=[];a.hu.isEmpty()||(a.hu.forEach((f,p)=>{d.push(a.fu(p,e,t).then(v=>{var _;if((v||t)&&a.isPrimaryClient){const N=v?!v.fromCache:(_=t?.targetChanges.get(p.targetId))===null||_===void 0?void 0:_.current;a.sharedClientState.updateQueryState(p.targetId,N?"current":"not-current")}if(v){o.push(v);const N=Xg.Rs(p.targetId,v);c.push(N)}}))}),await Promise.all(d),a.lu.Y_(o),await async function(p,v){const _=Re(p);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",N=>le.forEach(v,j=>le.forEach(j.ds,C=>_.persistence.referenceDelegate.addReference(N,j.targetId,C)).next(()=>le.forEach(j.As,C=>_.persistence.referenceDelegate.removeReference(N,j.targetId,C)))))}catch(N){if(!ll(N))throw N;pe(Wg,"Failed to update sequence numbers: "+N)}for(const N of v){const j=N.targetId;if(!N.fromCache){const C=_.xs.get(j),b=C.snapshotVersion,M=C.withLastLimboFreeSnapshotVersion(b);_.xs=_.xs.insert(j,M)}}}(a.localStore,c))}async function qO(n,e){const t=Re(n);if(!t.currentUser.isEqual(e)){pe(cv,"User change. New user:",e.toKey());const a=await N0(t.localStore,e);t.currentUser=e,function(c,d){c.Ru.forEach(f=>{f.forEach(p=>{p.reject(new me(re.CANCELLED,d))})}),c.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await du(t,a.ks)}}function BO(n,e){const t=Re(n),a=t.Eu.get(e);if(a&&a.cu)return $e().add(a.key);{let o=$e();const c=t.Pu.get(e);if(!c)return o;for(const d of c){const f=t.hu.get(d);o=o.unionWith(f.view.eu)}return o}}function V0(n){const e=Re(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=M0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=BO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=LO.bind(null,e),e.lu.Y_=AO.bind(null,e.eventManager),e.lu.gu=jO.bind(null,e.eventManager),e}function HO(n){const e=Re(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=UO.bind(null,e),e}class Sh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Xh(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return YD(this.persistence,new zD,e.initialUser,this.serializer)}Su(e){return new b0(Qg.fi,this.serializer)}bu(e){return new eO}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sh.provider={build:()=>new Sh};class zO extends Sh{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Ze(this.persistence.referenceDelegate instanceof jh,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new wD(a,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?Rn.withCacheSize(this.cacheSizeBytes):Rn.DEFAULT;return new b0(a=>jh.fi(a,t),this.serializer)}}class fg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>IN(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=qO.bind(null,this.syncEngine),await NO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new TO}()}createDatastore(e){const t=Xh(e.databaseInfo.databaseId),a=function(c){return new iO(c)}(e.databaseInfo);return function(c,d,f,p){return new cO(c,d,f,p)}(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return function(a,o,c,d,f){return new dO(a,o,c,d,f)}(this.localStore,this.datastore,e.asyncQueue,t=>IN(this.syncEngine,t,0),function(){return TN.C()?new TN:new tO}())}createSyncEngine(e,t){return function(o,c,d,f,p,v,_){const N=new IO(o,c,d,f,p,v);return _&&(N.mu=!0),N}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const c=Re(o);pe(Rr,"RemoteStore shutting down."),c.da.add(5),await uu(c),c.Ra.shutdown(),c.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}fg.provider={build:()=>new fg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Da("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new me(re.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,c){const d=Re(o),f={documents:c.map(N=>Ah(d.serializer,N))},p=await d.Yo("BatchGetDocuments",d.serializer.databaseId,ht.emptyPath(),f,c.length),v=new Map;p.forEach(N=>{const j=hD(d.serializer,N);v.set(j.key.toString(),j)});const _=[];return c.forEach(N=>{const j=v.get(N.toString());Ze(!!j,55234,{key:N}),_.push(j)}),_}(this.datastore,e);return t.forEach(a=>this.recordVersion(a)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(a){this.lastTransactionError=a}this.writtenDocs.add(e.toString())}delete(e){this.write(new Kh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,a)=>{const o=be.fromPath(a);this.mutations.push(new o0(o,this.precondition(o)))}),await async function(a,o){const c=Re(a),d={writes:o.map(f=>g0(c.serializer,f))};await c.zo("Commit",c.serializer.databaseId,ht.emptyPath(),d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw xe(50498,{Uu:e.constructor.name});t=Ce.min()}const a=this.readVersions.get(e.key.toString());if(a){if(!t.isEqual(a))throw new me(re.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ce.min())?cn.exists(!1):cn.updateTime(t):cn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ce.min()))throw new me(re.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return cn.updateTime(t)}return cn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,t,a,o,c){this.asyncQueue=e,this.datastore=t,this.options=a,this.updateFunction=o,this.deferred=c,this.Ku=a.maxAttempts,this.x_=new Zg(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new GO(this.datastore),t=this.zu(e);t&&t.then(a=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(a)}).catch(o=>{this.ju(o)}))}).catch(a=>{this.ju(a)})})}zu(e){try{const t=this.updateFunction(e);return!ou(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!l0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi="FirestoreClient";class YO{constructor(e,t,a,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=o,this.user=gn.UNAUTHENTICATED,this.clientId=RT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(a,async d=>{pe(wi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(a,d=>(pe(wi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $s;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=av(t,"Failed to shutdown persistence");e.reject(a)}}),e.promise}}async function Rp(n,e){n.asyncQueue.verifyOperationInProgress(),pe(wi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let a=t.initialUser;n.setCredentialChangeListener(async o=>{a.isEqual(o)||(await N0(e.localStore,o),a=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function DN(n,e){n.asyncQueue.verifyOperationInProgress();const t=await KO(n);pe(wi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(a=>jN(e.remoteStore,a)),n.setAppCheckTokenChangeListener((a,o)=>jN(e.remoteStore,o)),n._onlineComponents=e}async function KO(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){pe(wi,"Using user provided OfflineComponentProvider");try{await Rp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===re.FAILED_PRECONDITION||o.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Qo("Error using user provided cache. Falling back to memory cache: "+t),await Rp(n,new Sh)}}else pe(wi,"Using default OfflineComponentProvider"),await Rp(n,new zO(void 0));return n._offlineComponents}async function hv(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(pe(wi,"Using user provided OnlineComponentProvider"),await DN(n,n._uninitializedComponentsProvider._online)):(pe(wi,"Using default OnlineComponentProvider"),await DN(n,new fg))),n._onlineComponents}function QO(n){return hv(n).then(e=>e.syncEngine)}function XO(n){return hv(n).then(e=>e.datastore)}async function wh(n){const e=await hv(n),t=e.eventManager;return t.onListen=RO.bind(null,e.syncEngine),t.onUnlisten=MO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=DO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=PO.bind(null,e.syncEngine),t}function WO(n,e,t={}){const a=new $s;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,v){const _=new dv({next:j=>{_.xu(),d.enqueueAndForget(()=>rv(c,N));const C=j.docs.has(f);!C&&j.fromCache?v.reject(new me(re.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&j.fromCache&&p&&p.source==="server"?v.reject(new me(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(j)},error:j=>v.reject(j)}),N=new lv(Hh(f.path),_,{includeMetadataChanges:!0,Qa:!0});return iv(c,N)}(await wh(n),n.asyncQueue,e,t,a)),a.promise}function ZO(n,e,t={}){const a=new $s;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,v){const _=new dv({next:j=>{_.xu(),d.enqueueAndForget(()=>rv(c,N)),j.fromCache&&p.source==="server"?v.reject(new me(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(j)},error:j=>v.reject(j)}),N=new lv(f,_,{includeMetadataChanges:!0,Qa:!0});return iv(c,N)}(await wh(n),n.asyncQueue,e,t,a)),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F0(n,e,t){if(!t)throw new me(re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function JO(n,e,t,a){if(e===!0&&a===!0)throw new me(re.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function MN(n){if(!be.isDocumentKey(n))throw new me(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function PN(n){if(be.isDocumentKey(n))throw new me(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Jh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(a){return a.constructor?a.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":xe(12329,{type:typeof n})}function Cn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Jh(n);throw new me(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q0="firestore.googleapis.com",kN=!0;class LN{constructor(e){var t,a;if(e.host===void 0){if(e.ssl!==void 0)throw new me(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=q0,this.ssl=kN}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:kN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=E0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<CD)throw new me(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}JO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=U0((a=e.experimentalLongPollingOptions)!==null&&a!==void 0?a:{}),function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(a,o){return a.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ef{constructor(e,t,a,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new LN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new LN(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(a){if(!a)return new i1;switch(a.type){case"firstParty":return new c1(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new me(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const a=ON.get(t);a&&(pe("ComponentProvider","Removing Datastore"),ON.delete(t),a.terminate())}(this),Promise.resolve()}}function eM(n,e,t,a={}){var o;n=Cn(n,ef);const c=Pr(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),p=`${e}:${t}`;c&&(Ng(`https://${p}`),xg("Firestore",!0)),d.host!==q0&&d.host!==p&&Qo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:p,ssl:c,emulatorOptions:a});if(!xi(v,f)&&(n._setSettings(v),a.mockUserToken)){let _,N;if(typeof a.mockUserToken=="string")_=a.mockUserToken,N=gn.MOCK_USER;else{_=Mx(a.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const j=a.mockUserToken.sub||a.mockUserToken.user_id;if(!j)throw new me(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");N=new gn(j)}n._authCredentials=new r1(new wT(_,N))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Pa(this.firestore,e,this._query)}}class un{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ni(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new un(this.firestore,e,this._key)}}class Ni extends Pa{constructor(e,t,a){super(e,t,Hh(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new un(this.firestore,null,new be(e))}withConverter(e){return new Ni(this.firestore,e,this._path)}}function et(n,e,...t){if(n=pt(n),F0("collection","path",e),n instanceof ef){const a=ht.fromString(e,...t);return PN(a),new Ni(n,null,a)}{if(!(n instanceof un||n instanceof Ni))throw new me(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ht.fromString(e,...t));return PN(a),new Ni(n.firestore,null,a)}}function Tt(n,e,...t){if(n=pt(n),arguments.length===1&&(e=RT.newId()),F0("doc","path",e),n instanceof ef){const a=ht.fromString(e,...t);return MN(a),new un(n,null,new be(a))}{if(!(n instanceof un||n instanceof Ni))throw new me(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ht.fromString(e,...t));return MN(a),new un(n.firestore,n instanceof Ni?n.converter:null,new be(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN="AsyncQueue";class UN{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Zg(this,"async_queue_retry"),this.rc=()=>{const a=Ip();a&&pe(VN,"Visibility state changed to "+a.visibilityState),this.x_.b_()},this.sc=e;const t=Ip();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Ip();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new $s;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!ll(e))throw e;pe(VN,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(a=>{throw this.Xu=a,this.ec=!1,Da("INTERNAL UNHANDLED ERROR: ",FN(a)),a}).then(a=>(this.ec=!1,a))));return this.sc=t,t}enqueueAfterDelay(e,t,a){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=sv.createAndSchedule(this,e,t,a,c=>this.uc(c));return this.Zu.push(o),o}oc(){this.Xu&&xe(47125,{cc:FN(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,a)=>t.targetTimeMs-a.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function FN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qN(n){return function(t,a){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of a)if(c in o&&typeof o[c]=="function")return!0;return!1}(n,["next","error","complete"])}class Qs extends ef{constructor(e,t,a,o){super(e,t,a,o),this.type="firestore",this._queue=new UN,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new UN(e),this._firestoreClient=void 0,await e}}}function tM(n,e){const t=typeof n=="object"?n:nu(),a=typeof n=="string"?n:_h,o=Ma(t,"firestore").getImmediate({identifier:a});if(!o._initialized){const c=Rx("firestore");c&&eM(o,...c)}return o}function hu(n){if(n._terminated)throw new me(re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||nM(n),n._firestoreClient}function nM(n){var e,t,a;const o=n._freezeSettings(),c=function(f,p,v,_){return new T1(f,p,v,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,U0(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((a=o.localCache)===null||a===void 0)&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new YO(n._authCredentials,n._appCheckCredentials,n._queue,c,n._componentsProvider&&function(f){const p=f?._online.build();return{_offline:f?._offline.build(p),_online:p}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dr(dn.fromBase64String(e))}catch(t){throw new me(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Dr(dn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ln(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(a,o){if(a.length!==o.length)return!1;for(let c=0;c<a.length;++c)if(a[c]!==o[c])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sM=/^__.*__$/;class aM{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new Vi(e,this.data,this.fieldMask,t,this.fieldTransforms):new lu(e,this.data,t,this.fieldTransforms)}}class B0{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return new Vi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function H0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xe(40011,{Ic:n})}}class pv{constructor(e,t,a,o,c,d){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=o,c===void 0&&this.Ec(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new pv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Vc(e),o}mc(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Ih(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(H0(this.Ic)&&sM.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class iM{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||Xh(e)}bc(e,t,a,o=!1){return new pv({Ic:e,methodName:t,wc:a,path:ln.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mu(n){const e=n._freezeSettings(),t=Xh(n._databaseId);return new iM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function gv(n,e,t,a,o,c={}){const d=n.bc(c.merge||c.mergeFields?2:0,e,t,o);yv("Data must be an object, but it was:",d,a);const f=$0(a,d);let p,v;if(c.merge)p=new zn(d.fieldMask),v=d.fieldTransforms;else if(c.mergeFields){const _=[];for(const N of c.mergeFields){const j=mg(e,N,t);if(!d.contains(j))throw new me(re.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);K0(_,j)||_.push(j)}p=new zn(_),v=d.fieldTransforms.filter(N=>p.covers(N.field))}else p=null,v=d.fieldTransforms;return new aM(new jn(f),p,v)}class nf extends tf{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof nf}}class vv extends tf{_toFieldTransform(e){return new X1(e.path,new Xc)}isEqual(e){return e instanceof vv}}function z0(n,e,t,a){const o=n.bc(1,e,t);yv("Data must be an object, but it was:",o,a);const c=[],d=jn.empty();Li(a,(p,v)=>{const _=_v(e,p,t);v=pt(v);const N=o.mc(_);if(v instanceof nf)c.push(_);else{const j=pu(v,N);j!=null&&(c.push(_),d.set(_,j))}});const f=new zn(c);return new B0(d,f,o.fieldTransforms)}function G0(n,e,t,a,o,c){const d=n.bc(1,e,t),f=[mg(e,a,t)],p=[o];if(c.length%2!=0)throw new me(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<c.length;j+=2)f.push(mg(e,c[j])),p.push(c[j+1]);const v=[],_=jn.empty();for(let j=f.length-1;j>=0;--j)if(!K0(v,f[j])){const C=f[j];let b=p[j];b=pt(b);const M=d.mc(C);if(b instanceof nf)v.push(C);else{const T=pu(b,M);T!=null&&(v.push(C),_.set(C,T))}}const N=new zn(v);return new B0(_,N,d.fieldTransforms)}function rM(n,e,t,a=!1){return pu(t,n.bc(a?4:3,e))}function pu(n,e){if(Y0(n=pt(n)))return yv("Unsupported field value:",e,n),$0(n,e);if(n instanceof tf)return function(a,o){if(!H0(o.Ic))throw o.gc(`${a._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${a._methodName}() is not currently supported inside arrays`);const c=a._toFieldTransform(o);c&&o.fieldTransforms.push(c)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(a,o){const c=[];let d=0;for(const f of a){let p=pu(f,o.fc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}}(n,e)}return function(a,o){if((a=pt(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return Y1(o.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const c=Ft.fromDate(a);return{timestampValue:Th(o.serializer,c)}}if(a instanceof Ft){const c=new Ft(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:Th(o.serializer,c)}}if(a instanceof fv)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof Dr)return{bytesValue:h0(o.serializer,a._byteString)};if(a instanceof un){const c=o.databaseId,d=a.firestore._databaseId;if(!d.isEqual(c))throw o.gc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Yg(a.firestore._databaseId||o.databaseId,a._key.path)}}if(a instanceof mv)return function(d,f){return{mapValue:{fields:{[UT]:{stringValue:FT},[Eh]:{arrayValue:{values:d.toArray().map(v=>{if(typeof v!="number")throw f.gc("VectorValues must only contain numeric values.");return zg(f.serializer,v)})}}}}}}(a,o);throw o.gc(`Unsupported field value: ${Jh(a)}`)}(n,e)}function $0(n,e){const t={};return OT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Li(n,(a,o)=>{const c=pu(o,e.Ac(a));c!=null&&(t[a]=c)}),{mapValue:{fields:t}}}function Y0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ft||n instanceof fv||n instanceof Dr||n instanceof un||n instanceof tf||n instanceof mv)}function yv(n,e,t){if(!Y0(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const a=Jh(t);throw a==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+a)}}function mg(n,e,t){if((e=pt(e))instanceof fu)return e._internalPath;if(typeof e=="string")return _v(n,e);throw Ih("Field path arguments must be of type string or ",n,!1,void 0,t)}const oM=new RegExp("[~\\*/\\[\\]]");function _v(n,e,t){if(e.search(oM)>=0)throw Ih(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new fu(...e.split("."))._internalPath}catch{throw Ih(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ih(n,e,t,a,o){const c=a&&!a.isEmpty(),d=o!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${a}`),d&&(p+=` in document ${o}`),p+=")"),new me(re.INVALID_ARGUMENT,f+n+p)}function K0(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,t,a,o,c){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new un(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(sf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class lM extends Rh{data(){return super.data()}}function sf(n,e){return typeof e=="string"?_v(n,e):e instanceof fu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ev{}class bv extends Ev{}function De(n,e,...t){let a=[];e instanceof Ev&&a.push(e),a=a.concat(t),function(c){const d=c.filter(p=>p instanceof Nv).length,f=c.filter(p=>p instanceof af).length;if(d>1||d>0&&f>0)throw new me(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a);for(const o of a)n=o._apply(n);return n}class af extends bv{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new af(e,t,a)}_apply(e){const t=this._parse(e);return X0(e._query,t),new Pa(e.firestore,e.converter,ig(e._query,t))}_parse(e){const t=mu(e.firestore);return function(c,d,f,p,v,_,N){let j;if(v.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new me(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){HN(N,_);const b=[];for(const M of N)b.push(BN(p,c,M));j={arrayValue:{values:b}}}else j=BN(p,c,N)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||HN(N,_),j=rM(f,d,N,_==="in"||_==="not-in");return Mt.create(v,_,j)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ye(n,e,t){const a=e,o=sf("where",n);return af._create(o,a,t)}class Nv extends Ev{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Nv(e,t)}_parse(e){const t=this._queryConstraints.map(a=>a._parse(e)).filter(a=>a.getFilters().length>0);return t.length===1?t[0]:Ts.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,c){let d=o;const f=c.getFlattenedFilters();for(const p of f)X0(d,p),d=ig(d,p)}(e._query,t),new Pa(e.firestore,e.converter,ig(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class xv extends bv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new xv(e,t)}_apply(e){const t=function(o,c,d){if(o.startAt!==null)throw new me(re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new me(re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Qc(c,d)}(e._query,this._field,this._direction);return new Pa(e.firestore,e.converter,function(o,c){const d=o.explicitOrderBy.concat([c]);return new cl(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function Qn(n,e="asc"){const t=e,a=sf("orderBy",n);return xv._create(a,t)}class Tv extends bv{constructor(e,t,a){super(),this.type=e,this._limit=t,this._limitType=a}static _create(e,t,a){return new Tv(e,t,a)}_apply(e){return new Pa(e.firestore,e.converter,Nh(e._query,this._limit,this._limitType))}}function cM(n){return Tv._create("limit",n,"F")}function BN(n,e,t){if(typeof(t=pt(t))=="string"){if(t==="")throw new me(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!KT(e)&&t.indexOf("/")!==-1)throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(ht.fromString(t));if(!be.isDocumentKey(a))throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return nN(n,new be(a))}if(t instanceof un)return nN(n,t._key);throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jh(t)}.`)}function HN(n,e){if(!Array.isArray(n)||n.length===0)throw new me(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function X0(n,e){const t=function(o,c){for(const d of o)for(const f of d.getFlattenedFilters())if(c.indexOf(f.op)>=0)return f.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new me(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class W0{convertValue(e,t="none"){switch(Ci(e)){case 0:return null;case 1:return e.booleanValue;case 2:return St(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ji(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw xe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return Li(e,(o,c)=>{a[o]=this.convertValue(c,t)}),a}convertVectorValue(e){var t,a,o;const c=(o=(a=(t=e.fields)===null||t===void 0?void 0:t[Eh].arrayValue)===null||a===void 0?void 0:a.values)===null||o===void 0?void 0:o.map(d=>St(d.doubleValue));return new mv(c)}convertGeoPoint(e){return new fv(St(e.latitude),St(e.longitude))}convertArray(e,t){return(e.values||[]).map(a=>this.convertValue(a,t))}convertServerTimestamp(e,t){switch(t){case"previous":const a=Bh(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp($c(e));default:return null}}convertTimestamp(e){const t=Ai(e);return new Ft(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=ht.fromString(e);Ze(_0(a),9688,{name:e});const o=new Yc(a.get(1),a.get(3)),c=new be(a.popFirst(5));return o.isEqual(t)||Da(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Av(n,e,t){let a;return a=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,a}class uM extends W0{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new un(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class jv extends Rh{constructor(e,t,a,o,c,d){super(e,t,a,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new oh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(sf("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}}class oh extends jv{data(e={}){return super.data(e)}}class Z0{constructor(e,t,a,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Uo(o.hasPendingWrites,o.fromCache),this.query=a}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(a=>{e.call(t,new oh(this._firestore,this._userDataWriter,a.key,a,new Uo(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map(f=>{const p=new oh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Uo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}})}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(f=>c||f.type!==3).map(f=>{const p=new oh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Uo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);let v=-1,_=-1;return f.type!==0&&(v=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),_=d.indexOf(f.doc.key)),{type:dM(f.type),doc:p,oldIndex:v,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function dM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xe(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(n){n=Cn(n,un);const e=Cn(n.firestore,Qs);return WO(hu(e),n._key).then(t=>J0(e,n,t))}class rf extends W0{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new un(this.firestore,null,t)}}function zt(n){n=Cn(n,Pa);const e=Cn(n.firestore,Qs),t=hu(e),a=new rf(e);return Q0(n._query),ZO(t,n._query).then(o=>new Z0(e,a,n,o))}function of(n,e,t){n=Cn(n,un);const a=Cn(n.firestore,Qs),o=Av(n.converter,e,t);return cf(a,[gv(mu(a),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,cn.none())])}function ka(n,e,t,...a){n=Cn(n,un);const o=Cn(n.firestore,Qs),c=mu(o);let d;return d=typeof(e=pt(e))=="string"||e instanceof fu?G0(c,"updateDoc",n._key,e,t,a):z0(c,"updateDoc",n._key,e),cf(o,[d.toMutation(n._key,cn.exists(!0))])}function Cv(n){return cf(Cn(n.firestore,Qs),[new Kh(n._key,cn.none())])}function lf(n,e){const t=Cn(n.firestore,Qs),a=Tt(n),o=Av(n.converter,e);return cf(t,[gv(mu(n.firestore),"addDoc",a._key,o,n.converter!==null,{}).toMutation(a._key,cn.exists(!1))]).then(()=>a)}function dl(n,...e){var t,a,o;n=pt(n);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||qN(e[d])||(c=e[d],d++);const f={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(qN(e[d])){const N=e[d];e[d]=(t=N.next)===null||t===void 0?void 0:t.bind(N),e[d+1]=(a=N.error)===null||a===void 0?void 0:a.bind(N),e[d+2]=(o=N.complete)===null||o===void 0?void 0:o.bind(N)}let p,v,_;if(n instanceof un)v=Cn(n.firestore,Qs),_=Hh(n._key.path),p={next:N=>{e[d]&&e[d](J0(v,n,N))},error:e[d+1],complete:e[d+2]};else{const N=Cn(n,Pa);v=Cn(N.firestore,Qs),_=N._query;const j=new rf(v);p={next:C=>{e[d]&&e[d](new Z0(v,j,N,C))},error:e[d+1],complete:e[d+2]},Q0(n._query)}return function(j,C,b,M){const T=new dv(M),L=new lv(C,T,b);return j.asyncQueue.enqueueAndForget(async()=>iv(await wh(j),L)),()=>{T.xu(),j.asyncQueue.enqueueAndForget(async()=>rv(await wh(j),L))}}(hu(v),_,f,p)}function cf(n,e){return function(a,o){const c=new $s;return a.asyncQueue.enqueueAndForget(async()=>kO(await QO(a),o,c)),c.promise}(hu(n),e)}function J0(n,e,t){const a=t.docs.get(e._key),o=new rf(n);return new jv(n,o,e._key,a,new Uo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hM={maxAttempts:5};function wc(n,e){if((n=pt(n)).firestore!==e)throw new me(re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=mu(e)}get(e){const t=wc(e,this._firestore),a=new uM(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return xe(24041);const c=o[0];if(c.isFoundDocument())return new Rh(this._firestore,a,c.key,c,t.converter);if(c.isNoDocument())return new Rh(this._firestore,a,t._key,null,t.converter);throw xe(18433,{doc:c})})}set(e,t,a){const o=wc(e,this._firestore),c=Av(o.converter,t,a),d=gv(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,a);return this._transaction.set(o._key,d),this}update(e,t,a,...o){const c=wc(e,this._firestore);let d;return d=typeof(t=pt(t))=="string"||t instanceof fu?G0(this._dataReader,"Transaction.update",c._key,t,a,o):z0(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,d),this}delete(e){const t=wc(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM extends fM{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=wc(e,this._firestore),a=new rf(this._firestore);return super.get(e).then(o=>new jv(this._firestore,a,t._key,o._document,new Uo(!1,!1),t.converter))}}function eA(n,e,t){n=Cn(n,Qs);const a=Object.assign(Object.assign({},hM),t);return function(c){if(c.maxAttempts<1)throw new me(re.INVALID_ARGUMENT,"Max attempts must be at least 1")}(a),function(c,d,f){const p=new $s;return c.asyncQueue.enqueueAndForget(async()=>{const v=await XO(c);new $O(c.asyncQueue,v,f,d,p).Wu()}),p.promise}(hu(n),o=>e(new mM(n,o)),a)}function Bt(){return new vv("serverTimestamp")}(function(e,t=!0){(function(o){rl=o})(kr),cs(new Kn("firestore",(a,{instanceIdentifier:o,options:c})=>{const d=a.getProvider("app").getImmediate(),f=new Qs(new o1(a.getProvider("auth-internal")),new u1(d,a.getProvider("app-check-internal")),function(v,_){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new me(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yc(v.options.projectId,_)}(d,o),d);return c=Object.assign({useFetchStreams:t},c),f._setSettings(c),f},"PUBLIC").setMultipleInstances(!0)),yn(zb,Gb,e),yn(zb,Gb,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA="firebasestorage.googleapis.com",pM="storageBucket",gM=2*60*1e3,vM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws extends ds{constructor(e,t,a=0){super(Dp(e),`Firebase Storage: ${t} (${Dp(e)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ws.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Dp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Xs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Xs||(Xs={}));function Dp(n){return"storage/"+n}function yM(){const n="An unknown error occurred, please check the error payload for server response.";return new Ws(Xs.UNKNOWN,n)}function _M(){return new Ws(Xs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function EM(){return new Ws(Xs.CANCELED,"User canceled the upload/download.")}function bM(n){return new Ws(Xs.INVALID_URL,"Invalid URL '"+n+"'.")}function NM(n){return new Ws(Xs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function zN(n){return new Ws(Xs.INVALID_ARGUMENT,n)}function nA(){return new Ws(Xs.APP_DELETED,"The Firebase app was deleted.")}function xM(n){return new Ws(Xs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let a;try{a=Ns.makeFromUrl(e,t)}catch{return new Ns(e,"")}if(a.path==="")return a;throw NM(e)}static makeFromUrl(e,t){let a=null;const o="([A-Za-z0-9.\\-_]+)";function c(U){U.path.charAt(U.path.length-1)==="/"&&(U.path_=U.path_.slice(0,-1))}const d="(/(.*))?$",f=new RegExp("^gs://"+o+d,"i"),p={bucket:1,path:3};function v(U){U.path_=decodeURIComponent(U.path)}const _="v[A-Za-z0-9_]+",N=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",C=new RegExp(`^https?://${N}/${_}/b/${o}/o${j}`,"i"),b={bucket:1,path:3},M=t===tA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",L=new RegExp(`^https?://${M}/${o}/${T}`,"i"),O=[{regex:f,indices:p,postModify:c},{regex:C,indices:b,postModify:v},{regex:L,indices:{bucket:1,path:2},postModify:v}];for(let U=0;U<O.length;U++){const F=O[U],X=F.regex.exec(e);if(X){const w=X[F.indices.bucket];let A=X[F.indices.path];A||(A=""),a=new Ns(w,A),F.postModify(a);break}}if(a==null)throw bM(e);return a}}class TM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AM(n,e,t){let a=1,o=null,c=null,d=!1,f=0;function p(){return f===2}let v=!1;function _(...T){v||(v=!0,e.apply(null,T))}function N(T){o=setTimeout(()=>{o=null,n(C,p())},T)}function j(){c&&clearTimeout(c)}function C(T,...L){if(v){j();return}if(T){j(),_.call(null,T,...L);return}if(p()||d){j(),_.call(null,T,...L);return}a<64&&(a*=2);let O;f===1?(f=2,O=0):O=(a+Math.random())*1e3,N(O)}let b=!1;function M(T){b||(b=!0,j(),!v&&(o!==null?(T||(f=2),clearTimeout(o),N(0)):T||(f=1)))}return N(0),c=setTimeout(()=>{d=!0,M(!0)},t),M}function jM(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CM(n){return n!==void 0}function GN(n,e,t,a){if(a<e)throw zN(`Invalid value for '${n}'. Expected ${e} or greater.`);if(a>t)throw zN(`Invalid value for '${n}'. Expected ${t} or less.`)}function SM(n){const e=encodeURIComponent;let t="?";for(const a in n)if(n.hasOwnProperty(a)){const o=e(a)+"="+e(n[a]);t=t+o+"&"}return t=t.slice(0,-1),t}var Dh;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Dh||(Dh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wM(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(e,t,a,o,c,d,f,p,v,_,N,j=!0,C=!1){this.url_=e,this.method_=t,this.headers_=a,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=f,this.errorCallback_=p,this.timeout_=v,this.progressCallback_=_,this.connectionFactory_=N,this.retry=j,this.isUsingEmulator=C,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,M)=>{this.resolve_=b,this.reject_=M,this.start_()})}start_(){const e=(a,o)=>{if(o){a(!1,new Qd(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=f=>{const p=f.loaded,v=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,v)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const f=c.getErrorCode()===Dh.NO_ERROR,p=c.getStatus();if(!f||wM(p,this.additionalRetryCodes_)&&this.retry){const _=c.getErrorCode()===Dh.ABORT;a(!1,new Qd(!1,null,_));return}const v=this.successCodes_.indexOf(p)!==-1;a(!0,new Qd(v,c))})},t=(a,o)=>{const c=this.resolve_,d=this.reject_,f=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(f,f.getResponse());CM(p)?c(p):c()}catch(p){d(p)}else if(f!==null){const p=yM();p.serverResponse=f.getErrorText(),this.errorCallback_?d(this.errorCallback_(f,p)):d(p)}else if(o.canceled){const p=this.appDelete_?nA():EM();d(p)}else{const p=_M();d(p)}};this.canceled_?t(!1,new Qd(!1,null,!0)):this.backoffId_=AM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&jM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Qd{constructor(e,t,a){this.wasSuccessCode=e,this.connection=t,this.canceled=!!a}}function RM(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function DM(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function OM(n,e){e&&(n["X-Firebase-GMPID"]=e)}function MM(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function PM(n,e,t,a,o,c,d=!0,f=!1){const p=SM(n.urlParams),v=n.url+p,_=Object.assign({},n.headers);return OM(_,e),RM(_,t),DM(_,c),MM(_,a),new IM(v,n.method,_,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,f)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kM(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function LM(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e,t){this._service=e,t instanceof Ns?this._location=t:this._location=Ns.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Oh(e,t)}get root(){const e=new Ns(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return LM(this._location.path)}get storage(){return this._service}get parent(){const e=kM(this._location.path);if(e===null)return null;const t=new Ns(this._location.bucket,e);return new Oh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw xM(e)}}function $N(n,e){const t=e?.[pM];return t==null?null:Ns.makeFromBucketSpec(t,n)}function VM(n,e,t,a={}){n.host=`${e}:${t}`;const o=Pr(e);o&&(Ng(`https://${n.host}/b`),xg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=a;c&&(n._overrideAuthToken=typeof c=="string"?c:Mx(c,n.app.options.projectId))}class UM{constructor(e,t,a,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=a,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=tA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=gM,this._maxUploadRetryTime=vM,this._requests=new Set,o!=null?this._bucket=Ns.makeFromBucketSpec(o,this._host):this._bucket=$N(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ns.makeFromBucketSpec(this._url,e):this._bucket=$N(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){GN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){GN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Oh(this,e)}_makeRequest(e,t,a,o,c=!0){if(this._deleted)return new TM(nA());{const d=PM(e,this._appId,a,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[a,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,a,o).getPromise()}}const YN="@firebase/storage",KN="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA="storage";function FM(n=nu(),e){n=pt(n);const a=Ma(n,sA).getImmediate({identifier:e}),o=Rx("storage");return o&&qM(a,...o),a}function qM(n,e,t,a={}){VM(n,e,t,a)}function BM(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new UM(t,a,o,e,kr)}function HM(){cs(new Kn(sA,BM,"PUBLIC").setMultipleInstances(!0)),yn(YN,KN,""),yn(YN,KN,"esm2017")}HM();const aA="@firebase/installations",Sv="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA=1e4,rA=`w:${Sv}`,oA="FIS_v2",zM="https://firebaseinstallations.googleapis.com/v1",GM=60*60*1e3,$M="installations",YM="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Or=new Oi($M,YM,KM);function lA(n){return n instanceof ds&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA({projectId:n}){return`${zM}/projects/${n}/installations`}function uA(n){return{token:n.token,requestStatus:2,expiresIn:XM(n.expiresIn),creationTime:Date.now()}}async function dA(n,e){const a=(await e.json()).error;return Or.create("request-failed",{requestName:n,serverCode:a.code,serverMessage:a.message,serverStatus:a.status})}function hA({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function QM(n,{refreshToken:e}){const t=hA(n);return t.append("Authorization",WM(e)),t}async function fA(n){const e=await n();return e.status>=500&&e.status<600?n():e}function XM(n){return Number(n.replace("s","000"))}function WM(n){return`${oA} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZM({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const a=cA(n),o=hA(n),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={fid:t,authVersion:oA,appId:n.appId,sdkVersion:rA},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await fA(()=>fetch(a,f));if(p.ok){const v=await p.json();return{fid:v.fid||t,registrationStatus:2,refreshToken:v.refreshToken,authToken:uA(v.authToken)}}else throw await dA("Create Installation",p)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mA(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JM(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP=/^[cdef][\w-]{21}$/,pg="";function tP(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=nP(n);return eP.test(t)?t:pg}catch{return pg}}function nP(n){return JM(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=new Map;function gA(n,e){const t=uf(n);vA(t,e),sP(t,e)}function vA(n,e){const t=pA.get(n);if(t)for(const a of t)a(e)}function sP(n,e){const t=aP();t&&t.postMessage({key:n,fid:e}),iP()}let jr=null;function aP(){return!jr&&"BroadcastChannel"in self&&(jr=new BroadcastChannel("[Firebase] FID Change"),jr.onmessage=n=>{vA(n.data.key,n.data.fid)}),jr}function iP(){pA.size===0&&jr&&(jr.close(),jr=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP="firebase-installations-database",oP=1,Mr="firebase-installations-store";let Op=null;function wv(){return Op||(Op=Ux(rP,oP,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Mr)}}})),Op}async function Mh(n,e){const t=uf(n),o=(await wv()).transaction(Mr,"readwrite"),c=o.objectStore(Mr),d=await c.get(t);return await c.put(e,t),await o.done,(!d||d.fid!==e.fid)&&gA(n,e.fid),e}async function yA(n){const e=uf(n),a=(await wv()).transaction(Mr,"readwrite");await a.objectStore(Mr).delete(e),await a.done}async function df(n,e){const t=uf(n),o=(await wv()).transaction(Mr,"readwrite"),c=o.objectStore(Mr),d=await c.get(t),f=e(d);return f===void 0?await c.delete(t):await c.put(f,t),await o.done,f&&(!d||d.fid!==f.fid)&&gA(n,f.fid),f}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Iv(n){let e;const t=await df(n.appConfig,a=>{const o=lP(a),c=cP(n,o);return e=c.registrationPromise,c.installationEntry});return t.fid===pg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function lP(n){const e=n||{fid:tP(),registrationStatus:0};return _A(e)}function cP(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject(Or.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},a=uP(n,t);return{installationEntry:t,registrationPromise:a}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:dP(n)}:{installationEntry:e}}async function uP(n,e){try{const t=await ZM(n,e);return Mh(n.appConfig,t)}catch(t){throw lA(t)&&t.customData.serverCode===409?await yA(n.appConfig):await Mh(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function dP(n){let e=await QN(n.appConfig);for(;e.registrationStatus===1;)await mA(100),e=await QN(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:a}=await Iv(n);return a||t}return e}function QN(n){return df(n,e=>{if(!e)throw Or.create("installation-not-found");return _A(e)})}function _A(n){return hP(n)?{fid:n.fid,registrationStatus:0}:n}function hP(n){return n.registrationStatus===1&&n.registrationTime+iA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fP({appConfig:n,heartbeatServiceProvider:e},t){const a=mP(n,t),o=QM(n,t),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={installation:{sdkVersion:rA,appId:n.appId}},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await fA(()=>fetch(a,f));if(p.ok){const v=await p.json();return uA(v)}else throw await dA("Generate Auth Token",p)}function mP(n,{fid:e}){return`${cA(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rv(n,e=!1){let t;const a=await df(n.appConfig,c=>{if(!EA(c))throw Or.create("not-registered");const d=c.authToken;if(!e&&vP(d))return c;if(d.requestStatus===1)return t=pP(n,e),c;{if(!navigator.onLine)throw Or.create("app-offline");const f=_P(c);return t=gP(n,f),f}});return t?await t:a.authToken}async function pP(n,e){let t=await XN(n.appConfig);for(;t.authToken.requestStatus===1;)await mA(100),t=await XN(n.appConfig);const a=t.authToken;return a.requestStatus===0?Rv(n,e):a}function XN(n){return df(n,e=>{if(!EA(e))throw Or.create("not-registered");const t=e.authToken;return EP(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function gP(n,e){try{const t=await fP(n,e),a=Object.assign(Object.assign({},e),{authToken:t});return await Mh(n.appConfig,a),t}catch(t){if(lA(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await yA(n.appConfig);else{const a=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Mh(n.appConfig,a)}throw t}}function EA(n){return n!==void 0&&n.registrationStatus===2}function vP(n){return n.requestStatus===2&&!yP(n)}function yP(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+GM}function _P(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function EP(n){return n.requestStatus===1&&n.requestTime+iA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bP(n){const e=n,{installationEntry:t,registrationPromise:a}=await Iv(e);return a?a.catch(console.error):Rv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NP(n,e=!1){const t=n;return await xP(t),(await Rv(t,e)).token}async function xP(n){const{registrationPromise:e}=await Iv(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TP(n){if(!n||!n.options)throw Mp("App Configuration");if(!n.name)throw Mp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Mp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Mp(n){return Or.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA="installations",AP="installations-internal",jP=n=>{const e=n.getProvider("app").getImmediate(),t=TP(e),a=Ma(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:a,_delete:()=>Promise.resolve()}},CP=n=>{const e=n.getProvider("app").getImmediate(),t=Ma(e,bA).getImmediate();return{getId:()=>bP(t),getToken:o=>NP(t,o)}};function SP(){cs(new Kn(bA,jP,"PUBLIC")),cs(new Kn(AP,CP,"PRIVATE"))}SP();yn(aA,Sv);yn(aA,Sv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph="analytics",wP="firebase_id",IP="origin",RP=60*1e3,DP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Dv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const On=new tu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OP={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Yn=new Oi("analytics","Analytics",OP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MP(n){if(!n.startsWith(Dv)){const e=Yn.create("invalid-gtag-resource",{gtagURL:n});return On.warn(e.message),""}return n}function NA(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function PP(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function kP(n,e){const t=PP("firebase-js-sdk-policy",{createScriptURL:MP}),a=document.createElement("script"),o=`${Dv}?l=${n}&id=${e}`;a.src=t?t?.createScriptURL(o):o,a.async=!0,document.head.appendChild(a)}function LP(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function VP(n,e,t,a,o,c){const d=a[o];try{if(d)await e[d];else{const p=(await NA(t)).find(v=>v.measurementId===o);p&&await e[p.appId]}}catch(f){On.error(f)}n("config",o,c)}async function UP(n,e,t,a,o){try{let c=[];if(o&&o.send_to){let d=o.send_to;Array.isArray(d)||(d=[d]);const f=await NA(t);for(const p of d){const v=f.find(N=>N.measurementId===p),_=v&&e[v.appId];if(_)c.push(_);else{c=[];break}}}c.length===0&&(c=Object.values(e)),await Promise.all(c),n("event",a,o||{})}catch(c){On.error(c)}}function FP(n,e,t,a){async function o(c,...d){try{if(c==="event"){const[f,p]=d;await UP(n,e,t,f,p)}else if(c==="config"){const[f,p]=d;await VP(n,e,t,a,f,p)}else if(c==="consent"){const[f,p]=d;n("consent",f,p)}else if(c==="get"){const[f,p,v]=d;n("get",f,p,v)}else if(c==="set"){const[f]=d;n("set",f)}else n(c,...d)}catch(f){On.error(f)}}return o}function qP(n,e,t,a,o){let c=function(...d){window[a].push(arguments)};return window[o]&&typeof window[o]=="function"&&(c=window[o]),window[o]=FP(c,n,e,t),{gtagCore:c,wrappedGtag:window[o]}}function BP(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Dv)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HP=30,zP=1e3;class GP{constructor(e={},t=zP){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const xA=new GP;function $P(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function YP(n){var e;const{appId:t,apiKey:a}=n,o={method:"GET",headers:$P(a)},c=DP.replace("{app-id}",t),d=await fetch(c,o);if(d.status!==200&&d.status!==304){let f="";try{const p=await d.json();!((e=p.error)===null||e===void 0)&&e.message&&(f=p.error.message)}catch{}throw Yn.create("config-fetch-failed",{httpStatus:d.status,responseMessage:f})}return d.json()}async function KP(n,e=xA,t){const{appId:a,apiKey:o,measurementId:c}=n.options;if(!a)throw Yn.create("no-app-id");if(!o){if(c)return{measurementId:c,appId:a};throw Yn.create("no-api-key")}const d=e.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},f=new WP;return setTimeout(async()=>{f.abort()},RP),TA({appId:a,apiKey:o,measurementId:c},d,f,e)}async function TA(n,{throttleEndTimeMillis:e,backoffCount:t},a,o=xA){var c;const{appId:d,measurementId:f}=n;try{await QP(a,e)}catch(p){if(f)return On.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:d,measurementId:f};throw p}try{const p=await YP(n);return o.deleteThrottleMetadata(d),p}catch(p){const v=p;if(!XP(v)){if(o.deleteThrottleMetadata(d),f)return On.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${v?.message}]`),{appId:d,measurementId:f};throw p}const _=Number((c=v?.customData)===null||c===void 0?void 0:c.httpStatus)===503?pb(t,o.intervalMillis,HP):pb(t,o.intervalMillis),N={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return o.setThrottleMetadata(d,N),On.debug(`Calling attemptFetch again in ${_} millis`),TA(n,N,a,o)}}function QP(n,e){return new Promise((t,a)=>{const o=Math.max(e-Date.now(),0),c=setTimeout(t,o);n.addEventListener(()=>{clearTimeout(c),a(Yn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function XP(n){if(!(n instanceof ds)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class WP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function ZP(n,e,t,a,o){if(o&&o.global){n("event",t,a);return}else{const c=await e,d=Object.assign(Object.assign({},a),{send_to:c});n("event",t,d)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JP(){if(Tg())try{await Ag()}catch(n){return On.warn(Yn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return On.warn(Yn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function ek(n,e,t,a,o,c,d){var f;const p=KP(n);p.then(C=>{t[C.measurementId]=C.appId,n.options.measurementId&&C.measurementId!==n.options.measurementId&&On.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${C.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(C=>On.error(C)),e.push(p);const v=JP().then(C=>{if(C)return a.getId()}),[_,N]=await Promise.all([p,v]);BP(c)||kP(c,_.measurementId),o("js",new Date);const j=(f=d?.config)!==null&&f!==void 0?f:{};return j[IP]="firebase",j.update=!0,N!=null&&(j[wP]=N),o("config",_.measurementId,j),_.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e){this.app=e}_delete(){return delete Lc[this.app.options.appId],Promise.resolve()}}let Lc={},WN=[];const ZN={};let Pp="dataLayer",nk="gtag",JN,AA,ex=!1;function sk(){const n=[];if(Px()&&n.push("This is a browser extension environment."),kx()||n.push("Cookies are not available."),n.length>0){const e=n.map((a,o)=>`(${o+1}) ${a}`).join(" "),t=Yn.create("invalid-analytics-context",{errorInfo:e});On.warn(t.message)}}function ak(n,e,t){sk();const a=n.options.appId;if(!a)throw Yn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)On.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Yn.create("no-api-key");if(Lc[a]!=null)throw Yn.create("already-exists",{id:a});if(!ex){LP(Pp);const{wrappedGtag:c,gtagCore:d}=qP(Lc,WN,ZN,Pp,nk);AA=c,JN=d,ex=!0}return Lc[a]=ek(n,WN,ZN,e,JN,Pp,t),new tk(n)}function ik(n=nu()){n=pt(n);const e=Ma(n,Ph);return e.isInitialized()?e.getImmediate():rk(n)}function rk(n,e={}){const t=Ma(n,Ph);if(t.isInitialized()){const o=t.getImmediate();if(xi(e,t.getOptions()))return o;throw Yn.create("already-initialized")}return t.initialize({options:e})}function ok(n,e,t,a){n=pt(n),ZP(AA,Lc[n.app.options.appId],e,t,a).catch(o=>On.error(o))}const tx="@firebase/analytics",nx="0.10.16";function lk(){cs(new Kn(Ph,(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return ak(a,o,t)},"PUBLIC")),cs(new Kn("analytics-internal",n,"PRIVATE")),yn(tx,nx),yn(tx,nx,"esm2017");function n(e){try{const t=e.getProvider(Ph).getImmediate();return{logEvent:(a,o,c)=>ok(t,a,o,c)}}catch(t){throw Yn.create("interop-component-reg-failed",{reason:t})}}}lk();var gg,sx,hf=function(){var n=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(n&&n.responseStart>0&&n.responseStart<performance.now())return n},jA=function(n){if(document.readyState==="loading")return"loading";var e=hf();if(e){if(n<e.domInteractive)return"loading";if(e.domContentLoadedEventStart===0||n<e.domContentLoadedEventStart)return"dom-interactive";if(e.domComplete===0||n<e.domComplete)return"dom-content-loaded"}return"complete"},ck=function(n){var e=n.nodeName;return n.nodeType===1?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},Ov=function(n,e){var t="";try{for(;n&&n.nodeType!==9;){var a=n,o=a.id?"#"+a.id:ck(a)+(a.classList&&a.classList.value&&a.classList.value.trim()&&a.classList.value.trim().length?"."+a.classList.value.trim().replace(/\s+/g,"."):"");if(t.length+o.length>(e||100)-1)return t||o;if(t=t?o+">"+t:o,a.id)break;n=a.parentNode}}catch{}return t},CA=-1,uk=function(){return CA},gu=function(n){addEventListener("pageshow",function(e){e.persisted&&(CA=e.timeStamp,n(e))},!0)},Mv=function(){var n=hf();return n&&n.activationStart||0},Ii=function(n,e){var t=hf(),a="navigate";return uk()>=0?a="back-forward-cache":t&&(document.prerendering||Mv()>0?a="prerender":document.wasDiscarded?a="restore":t.type&&(a=t.type.replace(/_/g,"-"))),{name:n,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:a}},hl=function(n,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(n)){var a=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return a.observe(Object.assign({type:n,buffered:!0},t||{})),a}}catch{}},Ri=function(n,e,t,a){var o,c;return function(d){e.value>=0&&(d||a)&&((c=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=c,e.rating=function(f,p){return f>p[1]?"poor":f>p[0]?"needs-improvement":"good"}(e.value,t),n(e))}},Pv=function(n){requestAnimationFrame(function(){return requestAnimationFrame(function(){return n()})})},ff=function(n){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&n()})},kv=function(n){var e=!1;return function(){e||(n(),e=!0)}},Fo=-1,ax=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},kh=function(n){document.visibilityState==="hidden"&&Fo>-1&&(Fo=n.type==="visibilitychange"?n.timeStamp:0,dk())},ix=function(){addEventListener("visibilitychange",kh,!0),addEventListener("prerenderingchange",kh,!0)},dk=function(){removeEventListener("visibilitychange",kh,!0),removeEventListener("prerenderingchange",kh,!0)},SA=function(){return Fo<0&&(Fo=ax(),ix(),gu(function(){setTimeout(function(){Fo=ax(),ix()},0)})),{get firstHiddenTime(){return Fo}}},Lv=function(n){document.prerendering?addEventListener("prerenderingchange",function(){return n()},!0):n()},rx=[1800,3e3],hk=function(n,e){e=e||{},Lv(function(){var t,a=SA(),o=Ii("FCP"),c=hl("paint",function(d){d.forEach(function(f){f.name==="first-contentful-paint"&&(c.disconnect(),f.startTime<a.firstHiddenTime&&(o.value=Math.max(f.startTime-Mv(),0),o.entries.push(f),t(!0)))})});c&&(t=Ri(n,o,rx,e.reportAllChanges),gu(function(d){o=Ii("FCP"),t=Ri(n,o,rx,e.reportAllChanges),Pv(function(){o.value=performance.now()-d.timeStamp,t(!0)})}))})},ox=[.1,.25],fk=function(n,e){(function(t,a){a=a||{},hk(kv(function(){var o,c=Ii("CLS",0),d=0,f=[],p=function(_){_.forEach(function(N){if(!N.hadRecentInput){var j=f[0],C=f[f.length-1];d&&N.startTime-C.startTime<1e3&&N.startTime-j.startTime<5e3?(d+=N.value,f.push(N)):(d=N.value,f=[N])}}),d>c.value&&(c.value=d,c.entries=f,o())},v=hl("layout-shift",p);v&&(o=Ri(t,c,ox,a.reportAllChanges),ff(function(){p(v.takeRecords()),o(!0)}),gu(function(){d=0,c=Ii("CLS",0),o=Ri(t,c,ox,a.reportAllChanges),Pv(function(){return o()})}),setTimeout(o,0))}))})(function(t){var a=function(o){var c,d={};if(o.entries.length){var f=o.entries.reduce(function(v,_){return v&&v.value>_.value?v:_});if(f&&f.sources&&f.sources.length){var p=(c=f.sources).find(function(v){return v.node&&v.node.nodeType===1})||c[0];p&&(d={largestShiftTarget:Ov(p.node),largestShiftTime:f.startTime,largestShiftValue:f.value,largestShiftSource:p,largestShiftEntry:f,loadState:jA(f.startTime)})}}return Object.assign(o,{attribution:d})}(t);n(a)},e)},wA=0,kp=1/0,Xd=0,mk=function(n){n.forEach(function(e){e.interactionId&&(kp=Math.min(kp,e.interactionId),Xd=Math.max(Xd,e.interactionId),wA=Xd?(Xd-kp)/7+1:0)})},IA=function(){return gg?wA:performance.interactionCount||0},pk=function(){"interactionCount"in performance||gg||(gg=hl("event",mk,{type:"event",buffered:!0,durationThreshold:0}))},_s=[],Vc=new Map,RA=0,gk=function(){var n=Math.min(_s.length-1,Math.floor((IA()-RA)/50));return _s[n]},DA=[],vk=function(n){if(DA.forEach(function(o){return o(n)}),n.interactionId||n.entryType==="first-input"){var e=_s[_s.length-1],t=Vc.get(n.interactionId);if(t||_s.length<10||n.duration>e.latency){if(t)n.duration>t.latency?(t.entries=[n],t.latency=n.duration):n.duration===t.latency&&n.startTime===t.entries[0].startTime&&t.entries.push(n);else{var a={id:n.interactionId,latency:n.duration,entries:[n]};Vc.set(a.id,a),_s.push(a)}_s.sort(function(o,c){return c.latency-o.latency}),_s.length>10&&_s.splice(10).forEach(function(o){return Vc.delete(o.id)})}}},Vv=function(n){var e=self.requestIdleCallback||self.setTimeout,t=-1;return n=kv(n),document.visibilityState==="hidden"?n():(t=e(n),ff(n)),t},lx=[200,500],yk=function(n,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},Lv(function(){var t;pk();var a,o=Ii("INP"),c=function(f){Vv(function(){f.forEach(vk);var p=gk();p&&p.latency!==o.value&&(o.value=p.latency,o.entries=p.entries,a())})},d=hl("event",c,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});a=Ri(n,o,lx,e.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),ff(function(){c(d.takeRecords()),a(!0)}),gu(function(){RA=IA(),_s.length=0,Vc.clear(),o=Ii("INP"),a=Ri(n,o,lx,e.reportAllChanges)}))}))},Yo=[],vi=[],vg=0,Uv=new WeakMap,Ko=new Map,yg=-1,_k=function(n){Yo=Yo.concat(n),OA()},OA=function(){yg<0&&(yg=Vv(Ek))},Ek=function(){Ko.size>10&&Ko.forEach(function(d,f){Vc.has(f)||Ko.delete(f)});var n=_s.map(function(d){return Uv.get(d.entries[0])}),e=vi.length-50;vi=vi.filter(function(d,f){return f>=e||n.includes(d)});for(var t=new Set,a=0;a<vi.length;a++){var o=vi[a];MA(o.startTime,o.processingEnd).forEach(function(d){t.add(d)})}var c=Yo.length-1-50;Yo=Yo.filter(function(d,f){return d.startTime>vg&&f>c||t.has(d)}),yg=-1};DA.push(function(n){n.interactionId&&n.target&&!Ko.has(n.interactionId)&&Ko.set(n.interactionId,n.target)},function(n){var e,t=n.startTime+n.duration;vg=Math.max(vg,n.processingEnd);for(var a=vi.length-1;a>=0;a--){var o=vi[a];if(Math.abs(t-o.renderTime)<=8){(e=o).startTime=Math.min(n.startTime,e.startTime),e.processingStart=Math.min(n.processingStart,e.processingStart),e.processingEnd=Math.max(n.processingEnd,e.processingEnd),e.entries.push(n);break}}e||(e={startTime:n.startTime,processingStart:n.processingStart,processingEnd:n.processingEnd,renderTime:t,entries:[n]},vi.push(e)),(n.interactionId||n.entryType==="first-input")&&Uv.set(n,e),OA()});var MA=function(n,e){for(var t,a=[],o=0;t=Yo[o];o++)if(!(t.startTime+t.duration<n)){if(t.startTime>e)break;a.push(t)}return a},bk=function(n,e){sx||(sx=hl("long-animation-frame",_k)),yk(function(t){var a=function(o){var c=o.entries[0],d=Uv.get(c),f=c.processingStart,p=d.processingEnd,v=d.entries.sort(function(T,L){return T.processingStart-L.processingStart}),_=MA(c.startTime,p),N=o.entries.find(function(T){return T.target}),j=N&&N.target||Ko.get(c.interactionId),C=[c.startTime+c.duration,p].concat(_.map(function(T){return T.startTime+T.duration})),b=Math.max.apply(Math,C),M={interactionTarget:Ov(j),interactionTargetElement:j,interactionType:c.name.startsWith("key")?"keyboard":"pointer",interactionTime:c.startTime,nextPaintTime:b,processedEventEntries:v,longAnimationFrameEntries:_,inputDelay:f-c.startTime,processingDuration:p-f,presentationDelay:Math.max(b-p,0),loadState:jA(c.startTime)};return Object.assign(o,{attribution:M})}(t);n(a)},e)},cx=[2500,4e3],Lp={},Nk=function(n,e){(function(t,a){a=a||{},Lv(function(){var o,c=SA(),d=Ii("LCP"),f=function(_){a.reportAllChanges||(_=_.slice(-1)),_.forEach(function(N){N.startTime<c.firstHiddenTime&&(d.value=Math.max(N.startTime-Mv(),0),d.entries=[N],o())})},p=hl("largest-contentful-paint",f);if(p){o=Ri(t,d,cx,a.reportAllChanges);var v=kv(function(){Lp[d.id]||(f(p.takeRecords()),p.disconnect(),Lp[d.id]=!0,o(!0))});["keydown","click"].forEach(function(_){addEventListener(_,function(){return Vv(v)},{once:!0,capture:!0})}),ff(v),gu(function(_){d=Ii("LCP"),o=Ri(t,d,cx,a.reportAllChanges),Pv(function(){d.value=performance.now()-_.timeStamp,Lp[d.id]=!0,o(!0)})})}})})(function(t){var a=function(o){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:o.value};if(o.entries.length){var d=hf();if(d){var f=d.activationStart||0,p=o.entries[o.entries.length-1],v=p.url&&performance.getEntriesByType("resource").filter(function(b){return b.name===p.url})[0],_=Math.max(0,d.responseStart-f),N=Math.max(_,v?(v.requestStart||v.startTime)-f:0),j=Math.max(N,v?v.responseEnd-f:0),C=Math.max(j,p.startTime-f);c={element:Ov(p.element),timeToFirstByte:_,resourceLoadDelay:N-_,resourceLoadDuration:j-N,elementRenderDelay:C-j,navigationEntry:d,lcpEntry:p},p.url&&(c.url=p.url),v&&(c.lcpResourceEntry=v)}}return Object.assign(o,{attribution:c})}(t);n(a)},e)};const ux="@firebase/performance",_g="0.7.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PA=_g,xk="FB-PERF-TRACE-START",Tk="FB-PERF-TRACE-STOP",Eg="FB-PERF-TRACE-MEASURE",kA="_wt_",LA="_fp",VA="_fcp",UA="_fid",FA="_lcp",Ak="lcp_element",qA="_inp",jk="inp_interactionTarget",BA="_cls",Ck="cls_largestShiftTarget",HA="@firebase/performance/config",zA="@firebase/performance/configexpire",Sk="performance",GA="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},vn=new Oi(Sk,GA,wk);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di=new tu(GA);Di.logLevel=He.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vp,$A;class Ht{constructor(e){if(this.window=e,!e)throw vn.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=Nk,this.onINP=bk,this.onCLS=fk}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,t,a){!this.performance||!this.performance.measure||this.performance.measure(e,t,a)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!kx()?(Di.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):Tg()?!0:(Di.info("IndexedDB is not supported by current browser"),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(o=>{for(const c of o.getEntries())t(c)}).observe({entryTypes:[e]})}static getInstance(){return Vp===void 0&&(Vp=new Ht($A)),Vp}}function Ik(n){$A=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let YA;function Rk(n){const e=n.getId();return e.then(t=>{YA=t}),e}function Fv(){return YA}function Dk(n){const e=n.getToken();return e.then(t=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dx(n,e){const t=n.length-e.length;if(t<0||t>1)throw vn.create("invalid String merger input");const a=[];for(let o=0;o<n.length;o++)a.push(n.charAt(o)),e.length>o&&a.push(e.charAt(o));return a.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Up;class Gn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=dx("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=dx("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Up===void 0&&(Up=new Gn),Up}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Uc;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.VISIBLE=1]="VISIBLE",n[n.HIDDEN=2]="HIDDEN"})(Uc||(Uc={}));const Ok=["firebase_","google_","ga_"],Mk=new RegExp("^[a-zA-Z]\\w*$"),Pk=40,kk=100;function Lk(){const n=Ht.getInstance().navigator;return n?.serviceWorker?n.serviceWorker.controller?2:3:1}function Vk(){switch(Ht.getInstance().document.visibilityState){case"visible":return Uc.VISIBLE;case"hidden":return Uc.HIDDEN;default:return Uc.UNKNOWN}}function Uk(){const e=Ht.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function Fk(n){return n.length===0||n.length>Pk?!1:!Ok.some(t=>n.startsWith(t))&&!!n.match(Mk)}function qk(n){return n.length!==0&&n.length<=kk}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.appId;if(!t)throw vn.create("no app id");return t}function Bk(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.projectId;if(!t)throw vn.create("no project id");return t}function Hk(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.apiKey;if(!t)throw vn.create("no api key");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk="0.0.1",ys={loggingEnabled:!0},Gk="FIREBASE_INSTALLATIONS_AUTH";function $k(n,e){const t=Yk();return t?(hx(t),Promise.resolve()):Xk(n,e).then(hx).then(a=>Kk(a),()=>{})}function Yk(){const n=Ht.getInstance().localStorage;if(!n)return;const e=n.getItem(zA);if(!e||!Wk(e))return;const t=n.getItem(HA);if(t)try{return JSON.parse(t)}catch{return}}function Kk(n){const e=Ht.getInstance().localStorage;!n||!e||(e.setItem(HA,JSON.stringify(n)),e.setItem(zA,String(Date.now()+Gn.getInstance().configTimeToLive*60*60*1e3)))}const Qk="Could not fetch config, will use default configs";function Xk(n,e){return Dk(n.installations).then(t=>{const a=Bk(n.app),o=Hk(n.app),c=`https://firebaseremoteconfig.googleapis.com/v1/projects/${a}/namespaces/fireperf:fetch?key=${o}`,d=new Request(c,{method:"POST",headers:{Authorization:`${Gk} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:KA(n.app),app_version:PA,sdk_version:zk})});return fetch(d).then(f=>{if(f.ok)return f.json();throw vn.create("RC response not ok")})}).catch(()=>{Di.info(Qk)})}function hx(n){if(!n)return n;const e=Gn.getInstance(),t=n.entries||{};return t.fpr_enabled!==void 0?e.loggingEnabled=String(t.fpr_enabled)==="true":e.loggingEnabled=ys.loggingEnabled,t.fpr_log_source?e.logSource=Number(t.fpr_log_source):ys.logSource&&(e.logSource=ys.logSource),t.fpr_log_endpoint_url?e.logEndPointUrl=t.fpr_log_endpoint_url:ys.logEndPointUrl&&(e.logEndPointUrl=ys.logEndPointUrl),t.fpr_log_transport_key?e.transportKey=t.fpr_log_transport_key:ys.transportKey&&(e.transportKey=ys.transportKey),t.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(t.fpr_vc_network_request_sampling_rate):ys.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=ys.networkRequestsSamplingRate),t.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(t.fpr_vc_trace_sampling_rate):ys.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=ys.tracesSamplingRate),e.logTraceAfterSampling=fx(e.tracesSamplingRate),e.logNetworkAfterSampling=fx(e.networkRequestsSamplingRate),n}function Wk(n){return Number(n)>Date.now()}function fx(n){return Math.random()<=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qv=1,Fp;function QA(n){return qv=2,Fp=Fp||Jk(n),Fp}function Zk(){return qv===3}function Jk(n){return e2().then(()=>Rk(n.installations)).then(e=>$k(n,e)).then(()=>mx(),()=>mx())}function e2(){const n=Ht.getInstance().document;return new Promise(e=>{if(n&&n.readyState!=="complete"){const t=()=>{n.readyState==="complete"&&(n.removeEventListener("readystatechange",t),e())};n.addEventListener("readystatechange",t)}else e()})}function mx(){qv=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XA=10*1e3,t2=5.5*1e3,n2=1e3,WA=3;let lh=WA,Cr=[],px=!1;function s2(){px||(Bv(t2),px=!0)}function Bv(n){setTimeout(()=>{lh<=0||(Cr.length>0&&ZA(),Bv(XA))},n)}function ZA(){const n=Cr.splice(0,n2),e=n.map(a=>({source_extension_json_proto3:a.message,event_time_ms:String(a.eventTime)})),t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Gn.getInstance().logSource,log_event:e};a2(t).then(()=>{lh=WA}).catch(()=>{Cr=[...n,...Cr],lh--,Di.info(`Tries left: ${lh}.`),Bv(XA)})}function a2(n){const e=Gn.getInstance().getFlTransportFullUrl(),t=JSON.stringify(n);return navigator.sendBeacon&&navigator.sendBeacon(e,t)?Promise.resolve():fetch(e,{method:"POST",body:t,keepalive:!0}).then()}function i2(n){if(!n.eventTime||!n.message)throw vn.create("invalid cc log");Cr=[...Cr,n]}function r2(n){return(...e)=>{const t=n(...e);i2({message:t,eventTime:Date.now()})}}function o2(){for(;Cr.length>0;)ZA()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fc;function JA(n,e){Fc||(Fc={send:r2(u2),flush:o2}),Fc.send(n,e)}function Wd(n){const e=Gn.getInstance();!e.instrumentationEnabled&&n.isAuto||!e.dataCollectionEnabled&&!n.isAuto||Ht.getInstance().requiredApisAvailable()&&(Zk()?qp(n):QA(n.performanceController).then(()=>qp(n),()=>qp(n)))}function l2(){Fc&&Fc.flush()}function qp(n){if(!Fv())return;const e=Gn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||JA(n,1)}function c2(n){const e=Gn.getInstance();if(!e.instrumentationEnabled)return;const t=n.url,a=e.logEndPointUrl.split("?")[0],o=e.flTransportEndpointUrl.split("?")[0];t===a||t===o||!e.loggingEnabled||!e.logNetworkAfterSampling||JA(n,0)}function u2(n,e){return e===0?d2(n):h2(n)}function d2(n){const e={url:n.url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},t={application_info:ej(n.performanceController.app),network_request_metric:e};return JSON.stringify(t)}function h2(n){const e={name:n.name,is_auto:n.isAuto,client_start_time_us:n.startTimeUs,duration_us:n.durationUs};Object.keys(n.counters).length!==0&&(e.counters=n.counters);const t=n.getAttributes();Object.keys(t).length!==0&&(e.custom_attributes=t);const a={application_info:ej(n.performanceController.app),trace_metric:e};return JSON.stringify(a)}function ej(n){return{google_app_id:KA(n),app_instance_id:Fv(),web_app_info:{sdk_version:PA,page_url:Ht.getInstance().getUrl(),service_worker_status:Lk(),visibility_state:Vk(),effective_connection_type:Uk()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(n,e){const t=e;if(!t||t.responseStart===void 0)return;const a=Ht.getInstance().getTimeOrigin(),o=Math.floor((t.startTime+a)*1e3),c=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,d=Math.floor((t.responseEnd-t.startTime)*1e3),f=t.name&&t.name.split("?")[0],p={performanceController:n,url:f,responsePayloadBytes:t.transferSize,startTimeUs:o,timeToResponseInitiatedUs:c,timeToResponseCompletedUs:d};c2(p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=100,m2="_",p2=[LA,VA,UA,FA,BA,qA];function g2(n,e){return n.length===0||n.length>f2?!1:e&&e.startsWith(kA)&&p2.indexOf(n)>-1||!n.startsWith(m2)}function v2(n){const e=Math.floor(n);return e<n&&Di.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,t,a=!1,o){this.performanceController=e,this.name=t,this.isAuto=a,this.state=1,this.customAttributes={},this.counters={},this.api=Ht.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${xk}-${this.randomId}-${this.name}`,this.traceStopMark=`${Tk}-${this.randomId}-${this.name}`,this.traceMeasure=o||`${Eg}-${this.randomId}-${this.name}`,o&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw vn.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw vn.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Wd(this)}record(e,t,a){if(e<=0)throw vn.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw vn.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(t*1e3),this.startTimeUs=Math.floor(e*1e3),a&&a.attributes&&(this.customAttributes=Object.assign({},a.attributes)),a&&a.metrics)for(const o of Object.keys(a.metrics))isNaN(Number(a.metrics[o]))||(this.counters[o]=Math.floor(Number(a.metrics[o])));Wd(this)}incrementMetric(e,t=1){this.counters[e]===void 0?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(g2(e,this.name))this.counters[e]=v2(t??0);else throw vn.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const a=Fk(e),o=qk(t);if(a&&o){this.customAttributes[e]=t;return}if(!a)throw vn.create("invalid attribute name",{attributeName:e});if(!o)throw vn.create("invalid attribute value",{attributeValue:t})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(t.duration*1e3),this.startTimeUs=Math.floor((t.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,t,a,o,c){const d=Ht.getInstance().getUrl();if(!d)return;const f=new Jc(e,kA+d,!0),p=Math.floor(Ht.getInstance().getTimeOrigin()*1e3);f.setStartTime(p),t&&t[0]&&(f.setDuration(Math.floor(t[0].duration*1e3)),f.putMetric("domInteractive",Math.floor(t[0].domInteractive*1e3)),f.putMetric("domContentLoadedEventEnd",Math.floor(t[0].domContentLoadedEventEnd*1e3)),f.putMetric("loadEventEnd",Math.floor(t[0].loadEventEnd*1e3)));const v="first-paint",_="first-contentful-paint";if(a){const N=a.find(C=>C.name===v);N&&N.startTime&&f.putMetric(LA,Math.floor(N.startTime*1e3));const j=a.find(C=>C.name===_);j&&j.startTime&&f.putMetric(VA,Math.floor(j.startTime*1e3)),c&&f.putMetric(UA,Math.floor(c*1e3))}this.addWebVitalMetric(f,FA,Ak,o.lcp),this.addWebVitalMetric(f,BA,Ck,o.cls),this.addWebVitalMetric(f,qA,jk,o.inp),Wd(f),l2()}static addWebVitalMetric(e,t,a,o){o&&(e.putMetric(t,Math.floor(o.value*1e3)),o.elementAttribution&&e.putAttribute(a,o.elementAttribution))}static createUserTimingTrace(e,t){const a=new Jc(e,t,!1,t);Wd(a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ch={},vx=!1,tj;function yx(n){Fv()&&(setTimeout(()=>_2(n),0),setTimeout(()=>y2(n),0),setTimeout(()=>E2(n),0))}function y2(n){const e=Ht.getInstance(),t=e.getEntriesByType("resource");for(const a of t)gx(n,a);e.setupObserver("resource",a=>gx(n,a))}function _2(n){const e=Ht.getInstance();"onpagehide"in window?e.document.addEventListener("pagehide",()=>Bp(n)):e.document.addEventListener("unload",()=>Bp(n)),e.document.addEventListener("visibilitychange",()=>{e.document.visibilityState==="hidden"&&Bp(n)}),e.onFirstInputDelay&&e.onFirstInputDelay(t=>{tj=t}),e.onLCP(t=>{var a;ch.lcp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.element}}),e.onCLS(t=>{var a;ch.cls={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.largestShiftTarget}}),e.onINP(t=>{var a;ch.inp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.interactionTarget}})}function E2(n){const e=Ht.getInstance(),t=e.getEntriesByType("measure");for(const a of t)_x(n,a);e.setupObserver("measure",a=>_x(n,a))}function _x(n,e){const t=e.name;t.substring(0,Eg.length)!==Eg&&Jc.createUserTimingTrace(n,t)}function Bp(n){if(!vx){vx=!0;const e=Ht.getInstance(),t=e.getEntriesByType("navigation"),a=e.getEntriesByType("paint");setTimeout(()=>{Jc.createOobTrace(n,t,a,ch,tj)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(e?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),e?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),Ht.getInstance().requiredApisAvailable()?Ag().then(t=>{t&&(s2(),QA(this).then(()=>yx(this),()=>yx(this)),this.initialized=!0)}).catch(t=>{Di.info(`Environment doesn't support IndexedDB: ${t}`)}):Di.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Gn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Gn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Gn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Gn.getInstance().dataCollectionEnabled}}const N2="[DEFAULT]";function x2(n=nu()){return n=pt(n),Ma(n,"performance").getImmediate()}const T2=(n,{options:e})=>{const t=n.getProvider("app").getImmediate(),a=n.getProvider("installations-internal").getImmediate();if(t.name!==N2)throw vn.create("FB not default");if(typeof window>"u")throw vn.create("no window");Ik(window);const o=new b2(t,a);return o._init(e),o};function A2(){cs(new Kn("performance",T2,"PUBLIC")),yn(ux,_g),yn(ux,_g,"esm2017")}A2();const j2={apiKey:"AIzaSyCbU834quCY8hjSffRwljJLgZrcxK8i2F4",authDomain:"liquidacionapp-62962.firebaseapp.com",projectId:"liquidacionapp-62962",storageBucket:"liquidacionapp-62962.firebasestorage.app",messagingSenderId:"851382130132",appId:"1:851382130132:web:eaba38fab449f14fb5b241"},vu=Fx(j2);typeof window<"u"&&ik(vu);typeof window<"u"&&x2(vu);const qc=t1(vu),Te=tM(vu);FM(vu);const Es={ADMIN:"admin",CONTADOR:"contador",CLIENTE:"cliente"},dt={MANAGE_INVENTORY:"canManageInventory",CREATE_MOVEMENTS:"canCreateMovements",VIEW_ALL_MOVEMENTS:"canViewAllMovements",MANAGE_VEHICLES:"canManageVehicles",MANAGE_MAINTENANCE:"canManageMaintenance",MANAGE_SUPPLIERS:"canManageSuppliers",VIEW_REPORTS:"canViewReports",EXPORT_REPORTS:"canExportReports",MODIFY_SETTINGS:"canModifySettings"},C2="contacto.evert@gmail.com",nj=n=>{switch(n){case Es.ADMIN:return{[dt.MANAGE_INVENTORY]:!0,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!0,[dt.MANAGE_VEHICLES]:!0,[dt.MANAGE_MAINTENANCE]:!0,[dt.MANAGE_SUPPLIERS]:!0,[dt.VIEW_REPORTS]:!0,[dt.EXPORT_REPORTS]:!0,[dt.MODIFY_SETTINGS]:!0};case Es.CONTADOR:return{[dt.MANAGE_INVENTORY]:!0,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!0,[dt.MANAGE_VEHICLES]:!1,[dt.MANAGE_MAINTENANCE]:!0,[dt.MANAGE_SUPPLIERS]:!1,[dt.VIEW_REPORTS]:!0,[dt.EXPORT_REPORTS]:!0,[dt.MODIFY_SETTINGS]:!1};case Es.CLIENTE:default:return{[dt.MANAGE_INVENTORY]:!1,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!1,[dt.MANAGE_VEHICLES]:!1,[dt.MANAGE_MAINTENANCE]:!1,[dt.MANAGE_SUPPLIERS]:!1,[dt.VIEW_REPORTS]:!1,[dt.EXPORT_REPORTS]:!1,[dt.MODIFY_SETTINGS]:!1}}},S2=n=>n===C2?Es.ADMIN:Es.CLIENTE,tl=()=>"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/invitations",w2=()=>{const n="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let e="";for(let t=0;t<8;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},I2=async(n,e)=>{try{const t=await mf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden crear invitaciones"};let a,o=!1,c=0;for(;!o&&c<10;){a=w2();const p=De(et(Te,tl()),Ye("code","==",a));(await zt(p)).empty&&(o=!0),c++}if(!o)return{success:!1,error:"No se pudo generar un código único"};const d=Tt(et(Te,tl())),f={code:a,targetEmail:n.email.toLowerCase(),targetRole:n.role||Es.CLIENTE,targetName:n.name||"",status:"pending",appContext:"combustibles",expiresAt:new Date(Date.now()+7*24*60*60*1e3),createdAt:Bt(),createdBy:e,usedAt:null,usedBy:null};return await of(d,f),console.log("🎫 Invitación creada:",{code:a,email:n.email,role:n.role}),{success:!0,invitation:{id:d.id,code:a,...f}}}catch(t){return console.error("Error creating invitation:",t),{success:!1,error:t.message}}},sj=async n=>{try{const e=De(et(Te,tl()),Ye("code","==",n.toUpperCase()),Ye("status","==","pending")),t=await zt(e);if(t.empty)return{success:!1,error:"Código de invitación inválido o expirado"};const a=t.docs[0],o=a.data(),c=new Date,d=o.expiresAt.toDate();return c>d?{success:!1,error:"Código de invitación expirado"}:{success:!0,invitation:{id:a.id,...o}}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},R2=async(n,e)=>{try{const t=Tt(Te,tl(),n);return await ka(t,{status:"used",usedAt:Bt(),usedBy:e}),{success:!0}}catch(t){return console.error("Error marking invitation as used:",t),{success:!1,error:t.message}}},D2=async n=>{try{const e=await mf(n);if(!e.success||e.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden ver invitaciones"};const t=De(et(Te,tl())),a=await zt(t),o=[];return a.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,d)=>{const f=c.createdAt?.toDate()||new Date(0);return(d.createdAt?.toDate()||new Date(0))-f}),{success:!0,invitations:o}}catch(e){return console.error("Error getting invitations:",e),{success:!1,error:e.message}}},O2=async(n,e)=>{try{const t=await mf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden cancelar invitaciones"};const a=Tt(Te,tl(),n);return await ka(a,{status:"cancelled",cancelledAt:Bt(),cancelledBy:e}),{success:!0}}catch(t){return console.error("Error cancelling invitation:",t),{success:!1,error:t.message}}},M2=n=>nj(n.targetRole),aj=async(n,e={})=>{const t=Tt(Te,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const a=await Ur(t);if(a.exists())return{success:!0,userData:a.data(),isNewUser:!1};{const o=S2(n.email),c={uid:n.uid,email:n.email,displayName:n.displayName||"",photoURL:n.photoURL||"",role:o,emailVerified:n.emailVerified,combustiblesPermissions:nj(o),createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...e};return await of(t,c),{success:!0,userData:c,isNewUser:!0}}}catch(a){return console.error("Error creating/updating user profile:",a),{success:!1,error:a.message}}},Ex=async(n,e,t={})=>{const a=Tt(Te,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const o=await Ur(a);if(o.exists())return{success:!0,userData:o.data(),isNewUser:!1};const c=await sj(e);if(!c.success)return c;const d=c.invitation;if(d.targetEmail!==n.email.toLowerCase())return{success:!1,error:"El código de invitación no corresponde a este email"};const f={uid:n.uid,email:n.email,displayName:n.displayName||d.targetName||"",photoURL:n.photoURL||"",role:d.targetRole,emailVerified:n.emailVerified,combustiblesPermissions:M2(d),invitationUsed:d.id,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...t};return await of(a,f),await R2(d.id,n.uid),console.log("👤 Usuario creado con invitación:",{email:n.email,role:d.targetRole,invitationCode:d.code}),{success:!0,userData:f,isNewUser:!0}}catch(o){return console.error("Error creating user profile with invitation:",o),{success:!1,error:o.message}}},mf=async n=>{try{const e=Tt(Te,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n),t=await Ur(e);return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"Usuario no encontrado"}}catch(e){return console.error("Error fetching user profile:",e),{success:!1,error:e.message}}},ij=Y.createContext(),Zs=()=>{const n=Y.useContext(ij);if(n===void 0)throw new Error("useCombustibles must be used within a CombustiblesProvider");return n},P2=({children:n})=>{const[e,t]=Y.useState(null),[a,o]=Y.useState(null),[c,d]=Y.useState(!0),[f,p]=Y.useState(null),[v,_]=Y.useState([]),[N,j]=Y.useState([]),[C,b]=Y.useState([]),[M,T]=Y.useState([]);Y.useEffect(()=>{const R=HI(qc,async I=>{try{if(d(!0),I){t(I);let P=await mf(I.uid);P.success||(P=await aj(I,{provider:"existing_account",appContext:"combustibles"})),P.success?o(P.userData):p("Error cargando perfil de usuario")}else t(null),o(null),_([]),j([]),b([]),T([])}catch(P){console.error("Error en autenticación:",P),p("Error de autenticación")}finally{d(!1)}});return()=>R()},[]);const A={user:e,userProfile:a,loading:c,error:f,hasPermission:R=>a?.combustiblesPermissions?.[R]||!1,isAdmin:()=>a?.role==="admin",isCounterOrAbove:()=>a?.role==="admin"||a?.role==="contador",inventory:v,movements:N,vehicles:C,suppliers:M,setInventory:_,setMovements:j,setVehicles:b,setSuppliers:T,refreshInventory:async()=>{console.log("Refrescando inventario...")},refreshMovements:async()=>{console.log("Refrescando movimientos...")},refreshVehicles:async()=>{console.log("Refrescando vehículos...")},refreshSuppliers:async()=>{console.log("Refrescando proveedores...")}};return r.jsx(ij.Provider,{value:A,children:n})},k2=({children:n,currentView:e,onViewChange:t})=>{const{userProfile:a,isAdmin:o,isCounterOrAbove:c}=Zs(),[d,f]=Y.useState(!1),p=[{id:"dashboard",name:"Dashboard",icon:"📊",description:"Vista general",requiredPermission:null},{id:"inventory",name:"Inventario",icon:"🛢️",description:"Gestión de stock",requiredPermission:"canManageInventory"},{id:"movements",name:"Movimientos",icon:"📈",description:"Entradas y salidas",requiredPermission:"canCreateMovements"},{id:"vehicles",name:"Vehículos",icon:"🚜",description:"Maquinaria forestal",requiredPermission:null},{id:"maintenance",name:"Mantenimiento",icon:"🔧",description:"Cambios de aceite y baterías",requiredPermission:"canManageMaintenance"},{id:"products",name:"Productos",icon:"🛢️",description:"Tipos de combustibles",requiredPermission:null},{id:"suppliers",name:"Proveedores",icon:"🏪",description:"Gestión de proveedores",requiredPermission:"canManageSuppliers"},{id:"reports",name:"Reportes",icon:"📋",description:"Análisis y reportes",requiredPermission:"canViewReports"},{id:"admin",name:"Administración",icon:"⚙️",description:"Gestión de usuarios",requiredPermission:"admin"}],v=C=>{t(C),f(!1)},_=C=>C?C==="admin"?o():a?.combustiblesPermissions?.[C]||!1:!0,N=p.filter(C=>_(C.requiredPermission)),j=async()=>{try{await zI(qc)}catch(C){console.error("Error al cerrar sesión:",C)}};return r.jsxs("div",{className:"dashboard-layout",children:[r.jsx("header",{className:"dashboard-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"sidebar-toggle",onClick:()=>f(!d),children:"☰"}),r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:"⛽ Gestión de Combustibles"}),r.jsx("span",{className:"subtitle",children:"Forestech Colombia"})]}),r.jsxs("div",{className:"header-user",children:[r.jsxs("div",{className:"user-info",children:[r.jsx("span",{className:"user-name",children:a?.displayName||a?.email}),r.jsx("span",{className:"user-role",children:a?.role})]}),r.jsx("div",{className:"user-avatar",children:a?.photoURL?r.jsx("img",{src:a.photoURL,alt:"Avatar"}):r.jsx("div",{className:"avatar-placeholder",children:(a?.displayName||a?.email||"U").charAt(0).toUpperCase()})}),r.jsx("button",{className:"logout-button",onClick:j,title:"Cerrar sesión",children:"🚪"})]})]})}),r.jsxs("div",{className:"dashboard-body",children:[r.jsxs("aside",{className:`dashboard-sidebar ${d?"open":""}`,children:[r.jsx("nav",{className:"sidebar-nav",children:N.map(C=>r.jsxs("button",{className:`nav-item ${e===C.id?"active":""}`,onClick:()=>v(C.id),children:[r.jsx("span",{className:"nav-icon",children:C.icon}),r.jsxs("div",{className:"nav-content",children:[r.jsx("span",{className:"nav-name",children:C.name}),r.jsx("span",{className:"nav-description",children:C.description})]})]},C.id))}),r.jsx("div",{className:"sidebar-footer",children:r.jsxs("div",{className:"user-permissions",children:[r.jsx("h4",{children:"Permisos Activos:"}),r.jsxs("div",{className:"permission-list",children:[o()&&r.jsx("span",{className:"permission admin",children:"👑 Administrador"}),c()&&r.jsx("span",{className:"permission counter",children:"📊 Gestión Operativa"}),_("canManageInventory")&&r.jsx("span",{className:"permission",children:"🛢️ Inventario"}),_("canManageVehicles")&&r.jsx("span",{className:"permission",children:"🚜 Vehículos"})]})]})})]}),r.jsx("main",{className:"dashboard-main",children:r.jsx("div",{className:"main-content",children:n})})]}),d&&r.jsx("div",{className:"sidebar-overlay",onClick:()=>f(!1)})]})},An={DIESEL:"diesel",GASOLINE:"gasoline",ACPM:"acpm",LUBRICANTS:"lubricants",TWO_STROKE:"two_stroke",MIXED:"mixed"},nl={[An.DIESEL]:{name:"Diésel",description:"Combustible para maquinaria pesada",unit:"galones",category:"Combustible",color:"#fbbf24",icon:"🚛",density:.85,priceUnit:"COP/galón"},[An.GASOLINE]:{name:"Gasolina",description:"Combustible para vehículos livianos",unit:"galones",category:"Combustible",color:"#ef4444",icon:"⛽",density:.75,priceUnit:"COP/galón"},[An.ACPM]:{name:"ACPM",description:"Aceite Combustible Para Motor",unit:"galones",category:"Combustible",color:"#8b5cf6",icon:"🚜",density:.85,priceUnit:"COP/galón"},[An.LUBRICANTS]:{name:"Lubricantes",description:"Aceites y lubricantes para mantenimiento",unit:"litros",category:"Mantenimiento",color:"#06b6d4",icon:"🛢️",density:.9,priceUnit:"COP/litro"},[An.TWO_STROKE]:{name:"Mezcla 2T",description:"Mezcla para motores de 2 tiempos (motosierras)",unit:"litros",category:"Especializado",color:"#10b981",icon:"🪚",density:.78,priceUnit:"COP/litro"},[An.MIXED]:{name:"Mixto",description:"Compatible con múltiples tipos de combustible",unit:"galones",category:"Flexible",color:"#64748b",icon:"🔄",density:.8,priceUnit:"COP/galón"}},Tn={CRITICAL:"critical",LOW:"low",MEDIUM:"medium",HIGH:"high",FULL:"full"},qo={[Tn.CRITICAL]:{label:"Crítico",color:"#dc2626",icon:"🚨",threshold:.1},[Tn.LOW]:{label:"Bajo",color:"#ea580c",icon:"⚠️",threshold:.25},[Tn.MEDIUM]:{label:"Medio",color:"#ca8a04",icon:"📊",threshold:.5},[Tn.HIGH]:{label:"Alto",color:"#16a34a",icon:"✅",threshold:.75},[Tn.FULL]:{label:"Completo",color:"#059669",icon:"🟢",threshold:1}},rj=(n,e)=>{if(e===0)return Tn.CRITICAL;const t=n/e;return t<qo[Tn.CRITICAL].threshold?Tn.CRITICAL:t<qo[Tn.LOW].threshold?Tn.LOW:t<qo[Tn.MEDIUM].threshold?Tn.MEDIUM:t<qo[Tn.HIGH].threshold?Tn.HIGH:Tn.FULL},sl="combustibles_inventory",L2=async(n,e)=>{try{const t=nl[n.fuelType];if(!t)return{success:!1,error:"Tipo de combustible no válido"};const a=De(et(Te,sl),Ye("fuelType","==",n.fuelType),Ye("location","==",n.location));if(!(await zt(a)).empty)return{success:!1,error:`Ya existe ${t.name} en ${n.location}`};const c={fuelType:n.fuelType,name:t.name,description:n.description||t.description,currentStock:Number(n.currentStock)||0,maxCapacity:Number(n.maxCapacity),minThreshold:Number(n.minThreshold)||n.maxCapacity*.15,unit:t.unit,location:n.location,pricePerUnit:Number(n.pricePerUnit)||0,supplier:n.supplier||"",status:n.status||"active",createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await lf(et(Te,sl),c)).id,...c},message:`${t.name} agregado al inventario exitosamente`}}catch(t){return console.error("Error creating inventory item:",t),{success:!1,error:t.message}}},oj=async()=>{try{const n=De(et(Te,sl),Qn("fuelType","asc")),e=await zt(n),t=[];return e.forEach(a=>{const o=a.data();t.push({id:a.id,...o,stockLevel:rj(o.currentStock,o.maxCapacity),stockPercentage:Math.round(o.currentStock/o.maxCapacity*100),needsRestock:o.currentStock<=o.minThreshold})}),{success:!0,data:t}}catch(n){return console.error("Error fetching inventory items:",n),{success:!1,error:n.message}}},V2=async(n,e,t)=>{try{const a=Tt(Te,sl,n);if(!(await Ur(a)).exists())return{success:!1,error:"Item no encontrado"};const c={...e,lastUpdated:new Date,updatedBy:t};return delete c.id,delete c.createdAt,delete c.createdBy,await ka(a,c),{success:!0,message:"Item actualizado exitosamente",data:{id:n,...c}}}catch(a){return console.error("Error updating inventory item:",a),{success:!1,error:a.message}}},U2=async n=>{try{const e=Tt(Te,sl,n);return(await Ur(e)).exists()?(await Cv(e),{success:!0,message:"Item eliminado exitosamente"}):{success:!1,error:"Item no encontrado"}}catch(e){return console.error("Error deleting inventory item:",e),{success:!1,error:e.message}}},lj=n=>{const e=De(et(Te,sl),Qn("fuelType","asc"));return dl(e,t=>{const a=[];t.forEach(o=>{const c=o.data();a.push({id:o.id,...c,stockLevel:rj(c.currentStock,c.maxCapacity),stockPercentage:Math.round(c.currentStock/c.maxCapacity*100),needsRestock:c.currentStock<=c.minThreshold})}),n(a)},t=>{console.error("Error in inventory subscription:",t),n(null,t)})},F2=async()=>{try{const n=await oj();if(!n.success)return n;const e=n.data,t={totalItems:e.length,activeItems:e.filter(a=>a.status==="active").length,lowStockItems:e.filter(a=>a.needsRestock).length,totalValue:e.reduce((a,o)=>a+o.currentStock*o.pricePerUnit,0),averageStockLevel:e.length>0?Math.round(e.reduce((a,o)=>a+o.stockPercentage,0)/e.length):0,byFuelType:{}};return e.forEach(a=>{t.byFuelType[a.fuelType]||(t.byFuelType[a.fuelType]={count:0,totalStock:0,totalCapacity:0,totalValue:0}),t.byFuelType[a.fuelType].count++,t.byFuelType[a.fuelType].totalStock+=a.currentStock,t.byFuelType[a.fuelType].totalCapacity+=a.maxCapacity,t.byFuelType[a.fuelType].totalValue+=a.currentStock*a.pricePerUnit}),{success:!0,data:t}}catch(n){return console.error("Error calculating inventory stats:",n),{success:!1,error:n.message}}},fl="combustibles_movements",bx="combustibles_inventory",Ee={ENTRADA:"entrada",SALIDA:"salida",TRANSFERENCIA:"transferencia",AJUSTE:"ajuste"},Ge={PENDIENTE:"pendiente",COMPLETADO:"completado",CANCELADO:"cancelado"},q2=async n=>{try{$2(n);const e={...n,createdAt:Bt(),updatedAt:Bt(),status:Ge.PENDIENTE,totalValue:uj(n),effectiveDate:n.effectiveDate||Bt()},t=await eA(Te,async a=>{const o=Tt(et(Te,fl));return a.set(o,e),await dj(a,e,o.id),o.id});return console.log("✅ Movimiento creado exitosamente:",t),t}catch(e){throw console.error("❌ Error al crear movimiento:",e),new Error(`Error al crear movimiento: ${e.message}`)}},B2=async(n={})=>{try{let e=et(Te,fl);n.type&&(e=De(e,Ye("type","==",n.type))),n.status&&(e=De(e,Ye("status","==",n.status))),n.fuelType&&(e=De(e,Ye("fuelType","==",n.fuelType))),n.vehicleId&&(e=De(e,Ye("vehicleId","==",n.vehicleId))),e=De(e,Qn("createdAt","desc"));const t=await zt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,effectiveDate:o.data().effectiveDate?.toDate?.()||o.data().effectiveDate})}),a}catch(e){throw console.error("❌ Error al obtener movimientos:",e),new Error(`Error al obtener movimientos: ${e.message}`)}},H2=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=Tt(Te,fl,n),t=await Ur(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate?.()||t.data().createdAt,updatedAt:t.data().updatedAt?.toDate?.()||t.data().updatedAt,effectiveDate:t.data().effectiveDate?.toDate?.()||t.data().effectiveDate}:null}catch(e){throw console.error("❌ Error al obtener movimiento:",e),new Error(`Error al obtener movimiento: ${e.message}`)}},cj=async(n,e)=>{try{if(!n)throw new Error("ID de movimiento requerido");const t={...e,updatedAt:Bt(),...e.quantity||e.unitPrice?{totalValue:uj(e)}:{}},a=Tt(Te,fl,n);await ka(a,t),console.log("✅ Movimiento actualizado exitosamente")}catch(t){throw console.error("❌ Error al actualizar movimiento:",t),new Error(`Error al actualizar movimiento: ${t.message}`)}},Hv=(n,e={})=>{try{let t=et(Te,fl);return e.type&&(t=De(t,Ye("type","==",e.type))),e.status&&(t=De(t,Ye("status","==",e.status))),t=De(t,Qn("createdAt","desc")),dl(t,a=>{const o=[];a.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,effectiveDate:c.data().effectiveDate?.toDate?.()||c.data().effectiveDate})}),n(o)},a=>{console.error("❌ Error en suscripción de movimientos:",a),n([],a)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},z2=async n=>{try{const e=await H2(n);if(!e)throw new Error("Movimiento no encontrado");if(e.status!==Ge.PENDIENTE)throw new Error("Solo se pueden aprobar movimientos pendientes");await eA(Te,async t=>{const a=Tt(Te,fl,n);t.update(a,{status:Ge.COMPLETADO,approvedAt:Bt(),updatedAt:Bt()}),await dj(t,e,n)}),console.log("✅ Movimiento aprobado exitosamente")}catch(e){throw console.error("❌ Error al aprobar movimiento:",e),new Error(`Error al aprobar movimiento: ${e.message}`)}},G2=async(n={})=>{try{const e=await B2(n),t={totalMovements:e.length,byType:{},byStatus:{},byFuelType:{},totalValue:0,totalQuantity:0,averageValue:0,thisMonth:0,lastMonth:0,thisWeek:0},a=new Date,o=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()-1,1),d=new Date(a.setDate(a.getDate()-a.getDay()));return e.forEach(f=>{t.byType[f.type]=(t.byType[f.type]||0)+1,t.byStatus[f.status]=(t.byStatus[f.status]||0)+1,t.byFuelType[f.fuelType]=(t.byFuelType[f.fuelType]||0)+1,t.totalValue+=f.totalValue||0,t.totalQuantity+=f.quantity||0;const p=new Date(f.createdAt);p>=o&&t.thisMonth++,p>=c&&p<o&&t.lastMonth++,p>=d&&t.thisWeek++}),t.averageValue=t.totalMovements>0?t.totalValue/t.totalMovements:0,t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},$2=n=>{const e=["type","fuelType","quantity","unitPrice"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!Object.values(Ee).includes(n.type))throw new Error("Tipo de movimiento inválido");if(n.quantity<=0)throw new Error("La cantidad debe ser mayor a cero");if(n.unitPrice<0)throw new Error("El precio unitario no puede ser negativo");if(n.type===Ee.SALIDA&&!n.vehicleId)throw new Error("Las salidas deben tener un vehículo asociado");if(n.type===Ee.TRANSFERENCIA&&!n.destinationLocation)throw new Error("Las transferencias deben tener una ubicación destino")},uj=n=>(n.quantity||0)*(n.unitPrice||0),dj=async(n,e,t)=>{try{const a=De(et(Te,bx),Ye("fuelType","==",e.fuelType),Ye("location","==",e.location||"principal")),o=await zt(a);if(o.empty)throw new Error(`No se encontró inventario para ${e.fuelType} en ${e.location||"ubicación principal"}`);const c=o.docs[0],d=c.data(),f=Tt(Te,bx,c.id);let p=d.currentStock;switch(e.type){case Ee.ENTRADA:p+=e.quantity;break;case Ee.SALIDA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la salida");break;case Ee.AJUSTE:p+=e.quantity,p<0&&(p=0);break;case Ee.TRANSFERENCIA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la transferencia");break}n.update(f,{currentStock:p,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:Bt()},updatedAt:Bt()})}catch(a){throw console.error("❌ Error al actualizar inventario:",a),a}},hj="combustibles_vehicles",ge={EXCAVADORA:"excavadora",BULLDOZER:"bulldozer",CARGADOR:"cargador",CAMION:"camion",GRUA:"grua",MOTOSIERRA:"motosierra",TRACTOR:"tractor",VOLQUETA:"volqueta",OTROS:"otros"},Oe={ACTIVO:"activo",MANTENIMIENTO:"mantenimiento",INACTIVO:"inactivo",REPARACION:"reparacion"},xt={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},fj=async(n={})=>{try{let e=et(Te,hj);n.type&&(e=De(e,Ye("type","==",n.type))),n.status&&(e=De(e,Ye("status","==",n.status))),n.fuelType&&(e=De(e,Ye("fuelType","==",n.fuelType))),n.location&&(e=De(e,Ye("currentLocation","==",n.location))),e=De(e,Qn("vehicleId","asc"));const t=await zt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,lastMovementDate:o.data().lastMovementDate?.toDate?.()||o.data().lastMovementDate,lastMaintenanceDate:o.data().lastMaintenanceDate?.toDate?.()||o.data().lastMaintenanceDate})}),a}catch(e){throw console.error("❌ Error al obtener vehículos:",e),new Error(`Error al obtener vehículos: ${e.message}`)}},mj=(n,e={})=>{try{let t=et(Te,hj);return e.type&&(t=De(t,Ye("type","==",e.type))),e.status&&(t=De(t,Ye("status","==",e.status))),t=De(t,Qn("vehicleId","asc")),dl(t,a=>{const o=[];a.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,lastMovementDate:c.data().lastMovementDate?.toDate?.()||c.data().lastMovementDate,lastMaintenanceDate:c.data().lastMaintenanceDate?.toDate?.()||c.data().lastMaintenanceDate})}),n(o)},a=>{console.error("❌ Error en suscripción de vehículos:",a),n([],a)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},Y2=async(n={})=>{try{const e=await fj(n),t={totalVehicles:e.length,byType:{},byStatus:{},byFuelType:{},totalFuelConsumed:0,totalHoursWorked:0,averageConsumption:0,mostActiveVehicle:null,leastActiveVehicle:null};let a=0,o=1/0;return e.forEach(c=>{t.byType[c.type]=(t.byType[c.type]||0)+1,t.byStatus[c.status]=(t.byStatus[c.status]||0)+1,t.byFuelType[c.fuelType]=(t.byFuelType[c.fuelType]||0)+1,t.totalFuelConsumed+=c.totalFuelConsumed||0,t.totalHoursWorked+=c.totalHoursWorked||0;const d=c.totalMovements||0;d>a&&(a=d,t.mostActiveVehicle=c),d<o&&d>0&&(o=d,t.leastActiveVehicle=c)}),t.totalHoursWorked>0&&(t.averageConsumption=t.totalFuelConsumed/t.totalHoursWorked),t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},Aa={ACPM:"ACPM",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},pj={[Aa.ACPM]:{name:"ACPM",displayName:"ACPM 🚛",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"🚛",description:"Combustible diesel para vehículos pesados"},[Aa.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina 🚗",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"🚗",description:"Gasolina corriente para vehículos livianos"},[Aa.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidráulico 🔧",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"🔧",description:"Aceite hidráulico para sistemas de maquinaria"},[Aa.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 🛢️",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"🛢️",description:"Aceite multigrado para motores"},[Aa.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja 🟥",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"🟥",description:"Grasa lubricante multipropósito"},[Aa.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ⚙️",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"⚙️",description:"Aceite para transmisiones y diferenciales"},[Aa.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Líquido para Frenos 🛑",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"🛑",description:"Líquido de frenos DOT 3/4"},[Aa.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga 🌿",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"🌿",description:"Mezcla de combustible para equipos menores"},[Aa.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 🚜",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"🚜",description:"Aceite especializado para tractores"}},Bs={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},Nx=()=>Object.values(pj),xx="combustibles_products",K2=async()=>{try{console.log("🔄 Verificando productos existentes...");const n=De(et(Te,xx),cM(1));if(!(await zt(n)).empty){console.log("✅ Productos ya existen en Firebase");return}console.log("📦 Creando productos predefinidos...");const t=Object.values(pj).map(async o=>{const c={name:o.name,displayName:o.displayName,category:o.category,unit:o.unit,defaultPrice:o.defaultPrice,color:o.color,icon:o.icon,description:o.description,isActive:!0,createdAt:new Date,updatedAt:new Date,createdBy:"system-initialization"},d=Tt(et(Te,xx));return await of(d,c),console.log(`✅ Producto creado: ${o.displayName}`),{id:d.id,...c}}),a=await Promise.all(t);return console.log(`🎉 ${a.length} productos inicializados correctamente`),a}catch(n){throw console.error("❌ Error inicializando productos:",n),n}},Q2=async()=>{try{await K2()}catch(n){console.error("❌ Error en inicialización automática:",n)}},al="combustibles_products",Hp=async n=>{try{const e={...n,createdAt:Bt(),updatedAt:Bt()},t=await lf(et(Te,al),e);return console.log("Product created with ID:",t.id),t.id}catch(e){throw console.error("Error creating product:",e),e}},X2=async(n,e)=>{try{const t=Tt(Te,al,n);await ka(t,{...e,updatedAt:Bt()}),console.log("Product updated successfully")}catch(t){throw console.error("Error updating product:",t),t}},W2=async n=>{try{await Cv(Tt(Te,al,n)),console.log("Product deleted successfully")}catch(e){throw console.error("Error deleting product:",e),e}},Z2=async()=>{try{await Q2();try{const n=De(et(Te,al),Ye("isActive","==",!0),Qn("name"));return(await zt(n)).docs.map(t=>({id:t.id,...t.data()}))}catch(n){console.warn("⚠️ Índice compuesto no disponible, usando consulta alternativa",n.message);const e=De(et(Te,al),Ye("isActive","==",!0));return(await zt(e)).docs.map(o=>({id:o.id,...o.data()})).sort((o,c)=>(o.name||"").localeCompare(c.name||""))}}catch(n){throw console.error("Error getting active products:",n),n}},gj=(n,e)=>{try{const t=De(et(Te,al),Qn("name"));return dl(t,a=>{const o=a.docs.map(c=>({id:c.id,...c.data()}));n(o)},a=>{console.error("Error in products subscription:",a),e(a)})}catch(t){return console.error("Error setting up products subscription:",t),e(t),()=>{}}},yu="combustibles_maintenance",vj="combustibles_vehicles",fe={OIL_CHANGE:"oil_change",BATTERY_CHANGE:"battery_change",FILTER_CHANGE:"filter_change",GENERAL_MAINTENANCE:"general_maintenance"},Me={COMPLETED:"completado",PENDING:"pendiente",CANCELLED:"cancelado"},Bo={NEW:"nueva",USED:"usada",REPAIRED:"reparada"},zv={OIL_CHANGE_HOURS:250,BATTERY_LIFETIME_MONTHS:24},yj=async n=>{try{eL(n);const e={...n,createdAt:Bt(),updatedAt:Bt(),status:n.status||Me.COMPLETED,createdBy:n.createdBy||"system"};n.type===fe.OIL_CHANGE&&(e.nextChangeHours=pf(n.currentHours)),n.type===fe.BATTERY_CHANGE&&(e.nextBatteryChange=xj(n.date));const t=await lf(et(Te,yu),e);return n.vehicleId&&n.currentHours&&await Tj(n.vehicleId,n.currentHours),console.log("✅ Mantenimiento creado exitosamente:",t.id),t.id}catch(e){throw console.error("❌ Error al crear mantenimiento:",e),new Error(`Error al crear mantenimiento: ${e.message}`)}},_j=async(n={})=>{try{let e=et(Te,yu);n.type&&(e=De(e,Ye("type","==",n.type))),n.vehicleId&&(e=De(e,Ye("vehicleId","==",n.vehicleId))),n.status&&(e=De(e,Ye("status","==",n.status))),n.dateFrom&&(e=De(e,Ye("date",">=",new Date(n.dateFrom)))),n.dateTo&&(e=De(e,Ye("date","<=",new Date(n.dateTo)))),e=De(e,Qn("date","desc"));const t=await zt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data()})}),a}catch(e){throw console.error("❌ Error al obtener mantenimientos:",e),new Error(`Error al obtener mantenimientos: ${e.message}`)}},Ej=async(n,e)=>{try{tL(e);const t=Tt(Te,yu,n),a={...e,updatedAt:Bt()};e.currentHours&&e.type===fe.OIL_CHANGE&&(a.nextChangeHours=pf(e.currentHours)),await ka(t,a),e.vehicleId&&e.currentHours&&await Tj(e.vehicleId,e.currentHours),console.log("✅ Mantenimiento actualizado exitosamente:",n)}catch(t){throw console.error("❌ Error al actualizar mantenimiento:",t),new Error(`Error al actualizar mantenimiento: ${t.message}`)}},J2=async n=>{try{const e=Tt(Te,yu,n);await Cv(e),console.log("✅ Mantenimiento eliminado exitosamente:",n)}catch(e){throw console.error("❌ Error al eliminar mantenimiento:",e),new Error(`Error al eliminar mantenimiento: ${e.message}`)}},bj=async(n={})=>{try{const e=await _j(n),t={total:e.length,byType:{},byStatus:{},byVehicle:{},totalCost:0,averageCost:0,upcomingCount:0,overdueCount:0};let a=0;return e.forEach(o=>{t.byType[o.type]=(t.byType[o.type]||0)+1,t.byStatus[o.status]=(t.byStatus[o.status]||0)+1,t.byVehicle[o.vehicleId]=(t.byVehicle[o.vehicleId]||0)+1,o.cost&&(a+=parseFloat(o.cost)),o.nextChangeDate&&(new Date(o.nextChangeDate)>new Date?t.upcomingCount++:t.overdueCount++)}),t.totalCost=a,t.averageCost=t.total>0?a/t.total:0,t}catch(e){throw console.error("❌ Error al obtener estadísticas de mantenimiento:",e),new Error(`Error al obtener estadísticas de mantenimiento: ${e.message}`)}},Gv=(n,e={})=>{try{let t=et(Te,yu);return e.type&&(t=De(t,Ye("type","==",e.type))),e.vehicleId&&(t=De(t,Ye("vehicleId","==",e.vehicleId))),e.status&&(t=De(t,Ye("status","==",e.status))),t=De(t,Qn("date","desc")),dl(t,o=>{const c=[];o.forEach(d=>{c.push({id:d.id,...d.data()})}),n(c,null)},o=>{console.error("❌ Error en suscripción de mantenimientos:",o),n([],o)})}catch(t){return console.error("❌ Error al suscribirse a mantenimientos:",t),n([],t),()=>{}}},Nj=async()=>{try{const n=De(et(Te,vj),Ye("status","in",["activo","mantenimiento"]),Qn("name","asc")),e=await zt(n),t=[];return e.forEach(a=>{t.push({id:a.id,...a.data()})}),t}catch(n){throw console.error("❌ Error al obtener vehículos para mantenimiento:",n),new Error(`Error al obtener vehículos para mantenimiento: ${n.message}`)}},pf=n=>parseInt(n)+zv.OIL_CHANGE_HOURS,xj=n=>{const e=new Date(n);return e.setMonth(e.getMonth()+zv.BATTERY_LIFETIME_MONTHS),e},Tj=async(n,e)=>{try{const t=De(et(Te,vj),Ye("vehicleId","==",n)),a=await zt(t);if(!a.empty){const o=a.docs[0],c=o.data();if(c.hasHourMeter&&c.type==="tractor"){const d=parseInt(c.currentHours)||0,f=parseInt(e)||0;f>d&&(await ka(o.ref,{currentHours:f,lastHourMeterDate:Bt(),updatedAt:Bt()}),console.log(`✅ Horómetro actualizado para ${n}: ${d} → ${f}`))}}}catch(t){console.error("❌ Error al actualizar horómetro del vehículo:",t)}},eL=n=>{const e=[];if(n.type||e.push("El tipo de mantenimiento es obligatorio"),n.vehicleId||e.push("El vehículo es obligatorio"),n.date||e.push("La fecha es obligatoria"),n.type===fe.OIL_CHANGE&&((!n.quantity||n.quantity<=0)&&e.push("La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!n.currentHours||n.currentHours<0)&&e.push("La lectura del horómetro es obligatoria")),n.type===fe.BATTERY_CHANGE&&(n.batteryType||e.push("El tipo de batería es obligatorio"),(!n.cost||n.cost<=0)&&e.push("El costo de la batería es obligatorio")),e.length>0)throw new Error(e.join(", "))},tL=n=>{const e=[];if(n.type&&!Object.values(fe).includes(n.type)&&e.push("Tipo de mantenimiento inválido"),n.status&&!Object.values(Me).includes(n.status)&&e.push("Estado de mantenimiento inválido"),n.batteryStatus&&!Object.values(Bo).includes(n.batteryStatus)&&e.push("Estado de batería inválido"),e.length>0)throw new Error(e.join(", "))},nL=Object.freeze(Object.defineProperty({__proto__:null,BATTERY_STATUS:Bo,MAINTENANCE_CONSTANTS:zv,MAINTENANCE_STATUS:Me,MAINTENANCE_TYPES:fe,calculateNextBatteryChange:xj,calculateNextOilChange:pf,createMaintenanceRecord:yj,deleteMaintenanceRecord:J2,getAllMaintenanceRecords:_j,getMaintenanceStats:bj,getVehiclesForMaintenance:Nj,subscribeToMaintenance:Gv,updateMaintenanceRecord:Ej},Symbol.toStringTag,{value:"Module"})),Tx=()=>{const[n,e]=Y.useState({totalFuel:0,activeVehicles:0,pendingMovements:0,lowStockAlerts:0,totalProducts:0,totalMaintenance:0,upcomingMaintenance:0,overdueMaintenance:0}),[t,a]=Y.useState([]),[o,c]=Y.useState([]),[d,f]=Y.useState([]),[p,v]=Y.useState(!0),[_,N]=Y.useState(null),[j,C]=Y.useState({inventory:!1,movements:!1,vehicles:!1,products:!1,maintenance:!1});Y.useEffect(()=>{v(!0),N(null);const T=lj(F=>{const X=F.reduce((A,R)=>A+(R.currentStock||0),0),w=F.filter(A=>(A.currentStock||0)<(A.minThreshold||0)).length;e(A=>({...A,totalFuel:X,lowStockAlerts:w})),C(A=>({...A,inventory:!0}))}),L=Hv(F=>{const X=F.filter(A=>A.status==="pending").length,w=F.sort((A,R)=>R.date.toMillis()-A.date.toMillis()).slice(0,5);e(A=>({...A,pendingMovements:X})),a(w),C(A=>({...A,movements:!0}))},F=>{console.error("Error loading movements:",F),N("Error cargando movimientos")}),$=mj(F=>{const X=F.filter(w=>w.status==="active").length;e(w=>({...w,activeVehicles:X})),C(w=>({...w,vehicles:!0}))},F=>{console.error("Error loading vehicles:",F),N("Error cargando vehículos")}),O=gj(F=>{const X=F.length;c(F),e(w=>({...w,totalProducts:X})),C(w=>({...w,products:!0}))},F=>{console.error("Error loading products:",F),C(X=>({...X,products:!0}))}),U=Gv(F=>{const X=F.length,w=F.filter(R=>R.nextChangeDate?new Date(R.nextChangeDate)>new Date:!1).length,A=F.filter(R=>R.nextChangeDate?new Date(R.nextChangeDate)<new Date:!1).length;f(F),e(R=>({...R,totalMaintenance:X,upcomingMaintenance:w,overdueMaintenance:A})),C(R=>({...R,maintenance:!0}))},F=>{console.error("Error loading maintenance:",F),C(X=>({...X,maintenance:!0}))});return()=>{T(),L(),$(),O(),U()}},[]),Y.useEffect(()=>{Object.values(j).every(L=>L)&&v(!1)},[j]);const b=Y.useMemo(()=>T=>new Intl.NumberFormat("es-CO").format(T),[]),M=T=>{switch(T.type){case"entry":return`Entrada de ${T.quantity} ${T.unit} de ${T.fuelType}.`;case"exit":return`Salida de ${T.quantity} ${T.unit} para vehículo ${T.vehicleId||"N/A"}.`;case"transfer":return`Transferencia de ${T.quantity} ${T.unit} de ${T.fromLocation} a ${T.toLocation}.`;case"adjustment":return`Ajuste de inventario: ${T.quantity} ${T.unit} de ${T.fuelType}.`;default:return"Movimiento registrado."}};return p?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Cargando datos en tiempo real..."}),r.jsx("div",{className:"loading-spinner-container",children:r.jsx("div",{className:"loading-spinner"})})]}):_?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsxs("div",{className:"error-message",children:[r.jsxs("p",{children:["⚠️ ",_]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})]}):r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del estado de combustibles y maquinaria."}),r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon fuel-icon",children:"🛢️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Combustible Total"}),r.jsxs("h2",{children:[b(n.totalFuel)," gal"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon vehicle-icon",children:"🚜"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Vehículos Activos"}),r.jsx("h2",{children:b(n.activeVehicles)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon movement-icon",children:"🔄"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Movimientos Pendientes"}),r.jsx("h2",{children:b(n.pendingMovements)})]})]}),r.jsxs("div",{className:`stat-card ${n.lowStockAlerts>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon alert-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Alertas de Stock"}),r.jsx("h2",{children:b(n.lowStockAlerts)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon maintenance-icon",children:"🔧"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Mantenimientos"}),r.jsx("h2",{children:b(n.totalMaintenance)})]})]}),r.jsxs("div",{className:`stat-card ${n.overdueMaintenance>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon maintenance-alert-icon",children:"⏰"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Mantenimientos Vencidos"}),r.jsx("h2",{children:b(n.overdueMaintenance)})]})]})]}),r.jsxs("div",{className:"dashboard-content",children:[r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"Actividad Reciente"}),t.length>0?r.jsx("ul",{children:t.map(T=>r.jsxs("li",{children:[r.jsx("span",{className:`movement-type-badge ${T.type}`,children:T.type}),M(T),r.jsx("span",{className:"movement-date",children:T.date.toDate().toLocaleDateString()})]},T.id))}):r.jsx("p",{children:"No hay movimientos recientes."})]}),r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"🔧 Mantenimientos Recientes"}),d.length>0?r.jsx("ul",{children:d.slice(0,5).map(T=>r.jsxs("li",{children:[r.jsx("span",{className:`maintenance-type-badge ${T.type}`,children:T.type==="oil_change"?"🛢️":T.type==="battery_change"?"🔋":T.type==="filter_change"?"🔧":"⚙️"}),r.jsxs("span",{className:"maintenance-description",children:[T.type==="oil_change"?"Cambio de aceite":T.type==="battery_change"?"Cambio de batería":T.type==="filter_change"?"Cambio de filtros":"Mantenimiento general"," para ",T.vehicleName]}),r.jsx("span",{className:"maintenance-date",children:T.date?new Date(T.date).toLocaleDateString():"N/A"})]},T.id))}):r.jsx("p",{children:"No hay mantenimientos registrados."})]}),r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"📦 Stock por Tipo de Producto"}),o.length>0?r.jsxs("div",{className:"products-summary",children:[o.slice(0,6).map(T=>r.jsxs("div",{className:"product-summary-item",children:[r.jsx("div",{className:"product-icon",style:{color:T.color},children:T.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:T.displayName}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("span",{className:"stock-value",children:[b(T.currentStock||0)," ",T.unit]}),r.jsx("span",{className:`stock-status ${(T.currentStock||0)===0?"empty":(T.currentStock||0)<=(T.minThreshold||0)?"low":"normal"}`,children:(T.currentStock||0)===0?"🔴 Sin stock":(T.currentStock||0)<=(T.minThreshold||0)?"🟡 Stock bajo":"🟢 Normal"})]})]})]},T.id)),o.length>6&&r.jsx("div",{className:"view-all-products",children:r.jsxs("span",{children:["+",o.length-6," productos más"]})})]}):r.jsxs("div",{className:"no-products",children:[r.jsx("p",{children:"No hay productos registrados."}),r.jsx("small",{children:"Ve a la sección Productos para crear los primeros tipos de combustible."})]})]})]})]})},sL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const[o,c]=Y.useState("name"),[d,f]=Y.useState("asc"),p=b=>new Intl.NumberFormat("es-CO").format(b),v=b=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(b),_=b=>{const T=new Date-new Date(b.seconds?b.seconds*1e3:b),L=Math.floor(T/(1e3*60*60)),$=Math.floor(L/24);return $>0?`${$}d`:L>0?`${L}h`:"ahora"},N=b=>{o===b?f(d==="asc"?"desc":"asc"):(c(b),f("asc"))},j=[...n].sort((b,M)=>{let T=b[o],L=M[o];return o==="lastUpdated"&&(T=new Date(T.seconds?T.seconds*1e3:T),L=new Date(L.seconds?L.seconds*1e3:L)),T<L?d==="asc"?-1:1:T>L?d==="asc"?1:-1:0}),C=b=>o!==b?"↕️":d==="asc"?"↑":"↓";return r.jsxs("div",{className:"inventory-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{onClick:()=>N("name"),className:"sortable",children:["Combustible ",C("name")]}),r.jsxs("th",{onClick:()=>N("location"),className:"sortable",children:["Ubicación ",C("location")]}),r.jsxs("th",{onClick:()=>N("currentStock"),className:"sortable",children:["Stock Actual ",C("currentStock")]}),r.jsxs("th",{onClick:()=>N("stockPercentage"),className:"sortable",children:["Nivel ",C("stockPercentage")]}),r.jsxs("th",{onClick:()=>N("pricePerUnit"),className:"sortable",children:["Precio ",C("pricePerUnit")]}),r.jsx("th",{children:"Valor Total"}),r.jsxs("th",{onClick:()=>N("status"),className:"sortable",children:["Estado ",C("status")]}),r.jsxs("th",{onClick:()=>N("lastUpdated"),className:"sortable",children:["Actualizado ",C("lastUpdated")]}),a&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:j.map(b=>{const M=nl[b.fuelType],T=qo[b.stockLevel],L=b.currentStock*b.pricePerUnit;return r.jsxs("tr",{className:b.needsRestock?"needs-restock":"",children:[r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:M?.color},children:M?.icon}),r.jsxs("div",{children:[r.jsx("div",{className:"fuel-name",children:M?.name}),r.jsx("div",{className:"fuel-type",children:b.fuelType})]})]})}),r.jsx("td",{children:b.location}),r.jsxs("td",{className:"stock-cell",children:[r.jsxs("div",{className:"stock-info",children:[r.jsx("span",{className:"stock-amount",children:p(b.currentStock)}),r.jsxs("span",{className:"stock-unit",children:["/ ",p(b.maxCapacity)," ",b.unit]})]}),b.needsRestock&&r.jsx("div",{className:"restock-indicator",children:"⚠️ Bajo mínimo"})]}),r.jsx("td",{className:"level-cell",children:r.jsxs("div",{className:"level-info",children:[r.jsxs("div",{className:"level-badge",style:{backgroundColor:T?.color,color:"white"},children:[b.stockPercentage,"%"]}),r.jsx("div",{className:"level-bar",children:r.jsx("div",{className:"level-fill",style:{width:`${b.stockPercentage}%`,backgroundColor:T?.color}})})]})}),r.jsx("td",{className:"price-cell",children:r.jsxs("div",{className:"price-info",children:[r.jsx("span",{className:"price-amount",children:v(b.pricePerUnit)}),r.jsxs("span",{className:"price-unit",children:["/ ",b.unit]})]})}),r.jsx("td",{className:"value-cell",children:r.jsx("span",{className:"total-value",children:v(L)})}),r.jsx("td",{className:"status-cell",children:r.jsxs("span",{className:`status-badge ${b.status}`,children:[r.jsx("span",{className:"status-dot"}),b.status==="active"?"Activo":b.status==="inactive"?"Inactivo":b.status==="maintenance"?"Mantenimiento":b.status]})}),r.jsx("td",{className:"updated-cell",children:r.jsx("span",{className:"time-ago",children:_(b.lastUpdated)})}),a&&r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(b),title:"Editar",children:"✏️"}),r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(b),title:"Eliminar",children:"🗑️"})]})})]},b.id)})})]})}),r.jsxs("div",{className:"table-footer",children:[r.jsxs("div",{className:"table-info",children:[j.length," items ordenados por ",o,"(",d==="asc"?"ascendente":"descendente",")"]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot critical"}),"Crítico"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot low"}),"Bajo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot normal"}),"Normal"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},aL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const o=f=>new Intl.NumberFormat("es-CO").format(f),c=f=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(f),d=f=>{const v=new Date-new Date(f.seconds?f.seconds*1e3:f),_=Math.floor(v/(1e3*60*60)),N=Math.floor(_/24);return N>0?`hace ${N} día${N>1?"s":""}`:_>0?`hace ${_} hora${_>1?"s":""}`:"hace unos minutos"};return r.jsx("div",{className:"inventory-cards-grid",children:n.map(f=>{const p=nl[f.fuelType],v=qo[f.stockLevel],_=f.currentStock*f.pricePerUnit;return r.jsxs("div",{className:"inventory-card",children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:p?.color},children:p?.icon}),r.jsxs("div",{className:"fuel-details",children:[r.jsx("h3",{children:p?.name}),r.jsx("p",{className:"location",children:f.location})]})]}),r.jsx("div",{className:"stock-status",children:r.jsxs("span",{className:"status-badge",style:{backgroundColor:v?.color,color:"white"},children:[v?.icon," ",v?.label]})})]}),r.jsxs("div",{className:"stock-progress",children:[r.jsxs("div",{className:"progress-header",children:[r.jsxs("span",{className:"stock-text",children:[o(f.currentStock)," / ",o(f.maxCapacity)," ",f.unit]}),r.jsxs("span",{className:"percentage",children:[f.stockPercentage,"%"]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${f.stockPercentage}%`,backgroundColor:v?.color}})}),f.needsRestock&&r.jsxs("div",{className:"restock-warning",children:["⚠️ Bajo nivel mínimo (",o(f.minThreshold)," ",f.unit,")"]})]}),r.jsxs("div",{className:"card-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsxs("span",{className:"metric-label",children:["Precio por ",f.unit,":"]}),r.jsx("span",{className:"metric-value",children:c(f.pricePerUnit)})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor total:"}),r.jsx("span",{className:"metric-value",children:c(_)})]}),f.supplier&&r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Proveedor:"}),r.jsx("span",{className:"metric-value",children:f.supplier})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"status-info",children:[r.jsx("span",{className:`status-dot ${f.status}`}),r.jsx("span",{className:"status-text",children:f.status==="active"?"Activo":f.status==="inactive"?"Inactivo":f.status==="maintenance"?"Mantenimiento":f.status})]}),r.jsxs("div",{className:"last-update",children:["Actualizado ",d(f.lastUpdated)]})]}),a&&r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>e(f),title:"Editar combustible",children:"✏️ Editar"}),r.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>t(f),title:"Eliminar combustible",children:"🗑️ Eliminar"})]}),f.description&&f.description!==p?.description&&r.jsx("div",{className:"card-description",children:r.jsx("p",{children:f.description})})]},f.id)})})},iL=({item:n,onClose:e,onSuccess:t})=>{const{userProfile:a}=Zs(),o=!!n,[c,d]=Y.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[f,p]=Y.useState({}),[v,_]=Y.useState(!1);Y.useEffect(()=>{o&&n&&d({fuelType:n.fuelType||"",location:n.location||"",currentStock:n.currentStock||"",maxCapacity:n.maxCapacity||"",minThreshold:n.minThreshold||"",pricePerUnit:n.pricePerUnit||"",supplier:n.supplier||"",description:n.description||"",status:n.status||"active"})},[o,n]),Y.useEffect(()=>{if(c.maxCapacity&&!c.minThreshold){const M=Math.round(Number(c.maxCapacity)*.15);d(T=>({...T,minThreshold:M}))}},[c.maxCapacity]);const N=M=>{const{name:T,value:L}=M.target;d($=>({...$,[T]:L})),f[T]&&p($=>({...$,[T]:null}))},j=()=>{const M={};c.fuelType||(M.fuelType="Tipo de combustible es requerido"),c.location||(M.location="Ubicación es requerida"),c.maxCapacity||(M.maxCapacity="Capacidad máxima es requerida");const T=Number(c.currentStock),L=Number(c.maxCapacity),$=Number(c.minThreshold),O=Number(c.pricePerUnit);return c.currentStock&&(isNaN(T)||T<0)&&(M.currentStock="Stock actual debe ser un número válido mayor o igual a 0"),c.maxCapacity&&(isNaN(L)||L<=0)&&(M.maxCapacity="Capacidad máxima debe ser un número válido mayor a 0"),c.minThreshold&&(isNaN($)||$<0)&&(M.minThreshold="Umbral mínimo debe ser un número válido mayor o igual a 0"),c.pricePerUnit&&(isNaN(O)||O<0)&&(M.pricePerUnit="Precio debe ser un número válido mayor o igual a 0"),T>L&&(M.currentStock="Stock actual no puede ser mayor a la capacidad máxima"),$>L&&(M.minThreshold="Umbral mínimo no puede ser mayor a la capacidad máxima"),p(M),Object.keys(M).length===0},C=async M=>{if(M.preventDefault(),!!j()){_(!0);try{let T;o?T=await V2(n.id,{location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid):T=await L2({fuelType:c.fuelType,location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid),T.success?(alert(T.message),t()):alert(`Error: ${T.error}`)}catch(T){console.error("Error saving inventory item:",T),alert("Error inesperado al guardar el item")}finally{_(!1)}}},b=nl[c.fuelType];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content inventory-modal",onClick:M=>M.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:o?"✏️ Editar Combustible":"➕ Agregar Nuevo Combustible"}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),r.jsxs("form",{onSubmit:C,className:"modal-form",children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",b&&r.jsxs("span",{className:"fuel-preview",children:[b.icon," ",b.name]})]}),r.jsxs("select",{id:"fuelType",name:"fuelType",value:c.fuelType,onChange:N,disabled:o,className:f.fuelType?"error":"",required:!0,children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(An).map(([M,T])=>{const L=nl[T];return r.jsxs("option",{value:T,children:[L.icon," ",L.name," (",L.unit,")"]},M)})]}),f.fuelType&&r.jsx("span",{className:"error-text",children:f.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"location",children:"Ubicación / Tanque *"}),r.jsx("input",{type:"text",id:"location",name:"location",value:c.location,onChange:N,placeholder:"ej. Tanque Principal, Depósito A, Bodega Norte",className:f.location?"error":"",required:!0}),f.location&&r.jsx("span",{className:"error-text",children:f.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",b&&`(${b.unit})`]}),r.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:c.currentStock,onChange:N,placeholder:"0",min:"0",step:"0.01",className:f.currentStock?"error":""}),f.currentStock&&r.jsx("span",{className:"error-text",children:f.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad Máxima * ",b&&`(${b.unit})`]}),r.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:c.maxCapacity,onChange:N,placeholder:"1000",min:"1",step:"0.01",className:f.maxCapacity?"error":"",required:!0}),f.maxCapacity&&r.jsx("span",{className:"error-text",children:f.maxCapacity})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"minThreshold",children:["Umbral Mínimo ",b&&`(${b.unit})`,r.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),r.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:c.minThreshold,onChange:N,placeholder:"Auto: 15% de capacidad máxima",min:"0",step:"0.01",className:f.minThreshold?"error":""}),f.minThreshold&&r.jsx("span",{className:"error-text",children:f.minThreshold}),c.maxCapacity&&r.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(c.maxCapacity)*.15)," ",b?.unit||"unidades"]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",b?.unit||"Unidad"]}),r.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:c.pricePerUnit,onChange:N,placeholder:"12000",min:"0",step:"0.01",className:f.pricePerUnit?"error":""}),f.pricePerUnit&&r.jsx("span",{className:"error-text",children:f.pricePerUnit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),r.jsx("input",{type:"text",id:"supplier",name:"supplier",value:c.supplier,onChange:N,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsxs("select",{id:"status",name:"status",value:c.status,onChange:N,children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"description",children:"Descripción / Notas"}),r.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:N,placeholder:"Información adicional sobre este combustible...",rows:"3"})]})]}),b&&c.maxCapacity&&r.jsxs("div",{className:"form-preview",children:[r.jsx("h4",{children:"📊 Vista Previa"}),r.jsxs("div",{className:"preview-card",children:[r.jsxs("div",{className:"preview-header",children:[r.jsxs("span",{style:{color:b.color},children:[b.icon," ",b.name]}),r.jsx("span",{children:c.location})]}),r.jsxs("div",{className:"preview-capacity",children:[c.currentStock||0," / ",c.maxCapacity," ",b.unit,c.currentStock&&c.maxCapacity&&r.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(c.currentStock)/Number(c.maxCapacity)*100),"%)"]})]}),c.pricePerUnit&&r.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(c.currentStock)||0)*Number(c.pricePerUnit))]})]})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v,children:v?"Guardando...":o?"Actualizar":"Crear"})]})]})]})})},Ax=(n,e=[])=>{if(!n||!n.fuelType||!n.quantity)return{isValid:!1,error:"Datos de movimiento incompletos",availableStock:0,requiredStock:0};const{fuelType:t,quantity:a,type:o,sourceLocation:c}=n,d=parseFloat(a)||0;if(o!=="outbound"&&o!=="transfer")return{isValid:!0,message:"Movimiento no requiere validación de stock",availableStock:0,requiredStock:d};const f=e.filter(_=>_.fuelType===t&&_.location===c&&_.status==="active").reduce((_,N)=>_+(parseFloat(N.quantity)||0),0),p=f>=d,v=f-d;return{isValid:p,availableStock:f,requiredStock:d,remainingStock:v,fuelType:t,location:c,error:p?null:`Stock insuficiente. Disponible: ${f}, Requerido: ${d}`,warning:v<f*.2&&v>=0?"Stock quedará bajo después del movimiento":null}},Mn=n=>typeof n!="number"||isNaN(n)?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),ze=(n,e=2)=>typeof n!="number"||isNaN(n)?"0":new Intl.NumberFormat("es-CO",{minimumFractionDigits:e,maximumFractionDigits:e}).format(n),Nr=(n,e=1)=>typeof n!="number"||isNaN(n)?"0%":`${(n*100).toFixed(e)}%`,rL=({stats:n})=>r.jsxs("div",{className:"inventory-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Valor Total"}),r.jsx("div",{className:"stat-value",children:Mn(n.totalValue)}),r.jsxs("div",{className:"stat-subtitle",children:[ze(n.totalItems)," tipos de combustible"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:"✅"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Items Activos"}),r.jsx("div",{className:"stat-value",children:n.activeItems}),r.jsxs("div",{className:"stat-subtitle",children:[Math.round(n.activeItems/n.totalItems*100),"% del total"]})]})]}),r.jsxs("div",{className:`stat-card ${n.lowStockItems>0?"warning":"info"}`,children:[r.jsx("div",{className:"stat-icon",children:n.lowStockItems>0?"⚠️":"📊"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Stock Bajo"}),r.jsx("div",{className:"stat-value",children:n.lowStockItems}),r.jsx("div",{className:"stat-subtitle",children:n.lowStockItems>0?"Requieren atención":"Niveles normales"})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:"📈"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Nivel Promedio"}),r.jsxs("div",{className:"stat-value",children:[n.averageStockLevel,"%"]}),r.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),r.jsxs("div",{className:"fuel-type-summary",children:[r.jsx("h4",{children:"📊 Resumen por Tipo de Combustible"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(n.byFuelType).map(([e,t])=>{const a=nl[e],o=t.totalCapacity>0?Math.round(t.totalStock/t.totalCapacity*100):0;return r.jsxs("div",{className:"fuel-type-card",children:[r.jsxs("div",{className:"fuel-header",children:[r.jsx("span",{className:"fuel-icon",style:{color:a?.color||"#6b7280"},children:a?.icon||"⛽"}),r.jsxs("div",{className:"fuel-info",children:[r.jsx("h5",{children:a?.name||e}),r.jsxs("span",{className:"fuel-count",children:[t.count," ubicaciones"]})]})]}),r.jsxs("div",{className:"fuel-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Stock Total:"}),r.jsxs("span",{className:"metric-value",children:[ze(t.totalStock)," ",a?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Capacidad:"}),r.jsxs("span",{className:"metric-value",children:[ze(t.totalCapacity)," ",a?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Utilización:"}),r.jsxs("span",{className:`metric-value ${o<25?"low":o>75?"high":"normal"}`,children:[o,"%"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor:"}),r.jsx("span",{className:"metric-value",children:Mn(t.totalValue)})]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${o}%`,backgroundColor:a?.color||"#6b7280"}})})]},e)})}),Object.keys(n.byFuelType).length===0&&r.jsx("div",{className:"empty-fuel-types",children:r.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),oL=()=>{const{hasPermission:n}=Zs(),[e,t]=Y.useState([]),[a,o]=Y.useState(null),[c,d]=Y.useState(!0),[f,p]=Y.useState(null),[v,_]=Y.useState("cards"),[N,j]=Y.useState(!1),[C,b]=Y.useState(null),[M,T]=Y.useState("all"),[L,$]=Y.useState("");Y.useEffect(()=>{let A=null;return(()=>{A=lj((I,P)=>{if(P){console.error("Error in inventory subscription:",P),p("Error cargando inventario en tiempo real");return}t(I||[]),d(!1)})})(),()=>{A&&A()}},[]),Y.useEffect(()=>{(async()=>{const R=await F2();R.success&&o(R.data)})()},[e]);const O=e.filter(A=>{if(M==="active"&&A.status!=="active"||M==="low-stock"&&!A.needsRestock)return!1;if(L){const R=L.toLowerCase();return A.name.toLowerCase().includes(R)||A.location.toLowerCase().includes(R)||A.fuelType.toLowerCase().includes(R)}return!0}),U=A=>{if(!n("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}b(A),j(!0)},F=async A=>{if(!n("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`¿Estás seguro de eliminar ${A.name} de ${A.location}?

Esta acción no se puede deshacer.`))return;d(!0);const I=await U2(A.id);I.success?alert("Item eliminado exitosamente"):(p(I.error),alert(`Error al eliminar: ${I.error}`)),d(!1)},X=()=>{j(!1),b(null)},w=()=>{X()};return c&&e.length===0?r.jsxs("div",{className:"inventory-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando inventario..."})]}):r.jsxs("div",{className:"inventory-main",children:[r.jsxs("div",{className:"inventory-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🛢️ Gestión de Inventario"}),r.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),r.jsx("div",{className:"inventory-info",children:r.jsxs("span",{className:"info-text",children:["💡 Los combustibles se agregan automáticamente desde la pestaña ",r.jsx("strong",{children:"Movimientos"})]})})]}),a&&r.jsx(rL,{stats:a}),r.jsxs("div",{className:"inventory-controls",children:[r.jsxs("div",{className:"search-filters",children:[r.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicación o tipo...",value:L,onChange:A=>$(A.target.value),className:"search-input"}),r.jsxs("select",{value:M,onChange:A=>T(A.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos los items"}),r.jsx("option",{value:"active",children:"Solo activos"}),r.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),r.jsxs("div",{className:"view-toggle",children:[r.jsx("button",{className:`toggle-btn ${v==="cards"?"active":""}`,onClick:()=>_("cards"),children:"📱 Cards"}),r.jsx("button",{className:`toggle-btn ${v==="table"?"active":""}`,onClick:()=>_("table"),children:"📊 Tabla"})]})]}),f&&r.jsxs("div",{className:"error-banner",children:[r.jsxs("span",{children:["⚠️ ",f]}),r.jsx("button",{onClick:()=>p(null),children:"✕"})]}),r.jsx("div",{className:"inventory-content",children:O.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📦"}),r.jsx("h3",{children:"No hay items de inventario"}),r.jsx("p",{children:L||M!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaña Movimientos para crear una ENTRADA de combustible"})]}):r.jsx(r.Fragment,{children:v==="cards"?r.jsx(aL,{items:O,onEdit:U,onDelete:F,canManage:n("canManageInventory")}):r.jsx(sL,{items:O,onEdit:U,onDelete:F,canManage:n("canManageInventory")})})}),O.length>0&&r.jsx("div",{className:"results-footer",children:r.jsxs("p",{children:["Mostrando ",O.length," de ",e.length," items",L&&` · Filtro: "${L}"`,M!=="all"&&` · Estado: ${M}`]})}),N&&r.jsx(iL,{item:C,onClose:X,onSuccess:w})]})},lL=({stats:n,filters:e})=>{if(!n)return null;const t=(d,f)=>f===0?d>0?100:0:((d-f)/f*100).toFixed(1),a=d=>{switch(d){case Ee.ENTRADA:return"#10b981";case Ee.SALIDA:return"#ef4444";case Ee.TRANSFERENCIA:return"#3b82f6";case Ee.AJUSTE:return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case Ee.ENTRADA:return"📥";case Ee.SALIDA:return"📤";case Ee.TRANSFERENCIA:return"🔄";case Ee.AJUSTE:return"⚖️";default:return"📋"}},c=t(n.thisMonth,n.lastMonth);return r.jsxs("div",{className:"movements-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"📊"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.totalMovements)}),r.jsx("div",{className:"stat-label",children:"Total Movimientos"}),r.jsxs("div",{className:"stat-trend",children:[r.jsxs("span",{className:`trend ${c>=0?"positive":"negative"}`,children:[c>=0?"📈":"📉"," ",Math.abs(c),"%"]}),r.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Mn(n.totalValue)}),r.jsx("div",{className:"stat-label",children:"Valor Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Mn(n.averageValue)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⛽"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.totalQuantity)}),r.jsx("div",{className:"stat-label",children:"Galones Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",ze(n.totalQuantity/(n.totalMovements||1))," gal/mov"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"📅"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.thisWeek)}),r.jsx("div",{className:"stat-label",children:"Esta Semana"}),r.jsxs("div",{className:"stat-secondary",children:[ze(n.thisMonth)," este mes"]})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"📋 Por Tipo de Movimiento"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:o(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:a(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⚡ Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),v=N=>{switch(N){case Ge.COMPLETADO:return"#10b981";case Ge.PENDIENTE:return"#f59e0b";case Ge.CANCELADO:return"#ef4444";default:return"#6b7280"}},_=N=>{switch(N){case Ge.COMPLETADO:return"✅";case Ge.PENDIENTE:return"⏳";case Ge.CANCELADO:return"❌";default:return"❓"}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:_(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:v(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),v=_=>{switch(_?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(d)}),r.jsx("span",{className:"breakdown-label",children:d})]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]})]}),(e.type||e.status||e.fuelType||e.vehicleId)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:"🔍 Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.vehicleId&&r.jsxs("span",{className:"filter-tag",children:["Vehículo: ",e.vehicleId]})]})]})]})},cL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const[p,v]=Y.useState(!1),_=[{value:"Diesel",label:"Diesel 🚛"},{value:"Gasolina",label:"Gasolina 🚗"},{value:"ACPM",label:"ACPM 🚚"},{value:"Lubricante",label:"Lubricante 🛢️"}],N=[{value:"all",label:"Todos los períodos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este año"}],j=Object.values(n).filter(M=>M&&M!==""&&M!=="all").length,C=(M,T)=>{e({[M]:T})},b=M=>{e(M)};return r.jsxs("div",{className:"movements-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehículo, referencia...",value:a,onChange:M=>o(M.target.value),className:"search-input"}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${n.type===Ee.ENTRADA?"active":""}`,onClick:()=>b({type:Ee.ENTRADA}),children:"📥 Entradas"}),r.jsx("button",{className:`quick-filter ${n.type===Ee.SALIDA?"active":""}`,onClick:()=>b({type:Ee.SALIDA}),children:"📤 Salidas"}),r.jsx("button",{className:`quick-filter ${n.status===Ge.PENDIENTE?"active":""}`,onClick:()=>b({status:Ge.PENDIENTE}),children:"⏳ Pendientes"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:["🎛️ Filtros",j>0&&r.jsx("span",{className:"filters-count",children:j})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Movimiento"}),r.jsxs("select",{value:n.type,onChange:M=>C("type",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:Ee.ENTRADA,children:"📥 Entrada"}),r.jsx("option",{value:Ee.SALIDA,children:"📤 Salida"}),r.jsx("option",{value:Ee.TRANSFERENCIA,children:"🔄 Transferencia"}),r.jsx("option",{value:Ee.AJUSTE,children:"⚖️ Ajuste"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:M=>C("status",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:Ge.PENDIENTE,children:"⏳ Pendiente"}),r.jsx("option",{value:Ge.COMPLETADO,children:"✅ Completado"}),r.jsx("option",{value:Ge.CANCELADO,children:"❌ Cancelado"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:n.fuelType,onChange:M=>C("fuelType",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),_.map(M=>r.jsx("option",{value:M.value,children:M.label},M.value))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Período"}),r.jsx("select",{value:n.dateRange,onChange:M=>C("dateRange",M.target.value),className:"filter-select",children:N.map(M=>r.jsx("option",{value:M.value,children:M.label},M.value))})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Vehículo/Equipo"}),r.jsx("input",{type:"text",placeholder:"ID del vehículo...",value:n.vehicleId,onChange:M=>C("vehicleId",M.target.value),className:"filter-input"})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:j===0,children:"🗑️ Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[f," resultado",f!==1?"s":""]}),j>0&&r.jsxs("span",{className:"active-filters-text",children:["(",j," filtro",j!==1?"s":""," activo",j!==1?"s":"",")"]})]})]})]}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},uL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,userRole:c})=>{const d=b=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),f=b=>b?(b instanceof Date?b:new Date(b)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Sin fecha",p=b=>{if(!b)return"";const M=new Date,T=b instanceof Date?b:new Date(b),L=Math.abs(M-T),$=Math.ceil(L/(1e3*60*60*24));return $===1?"hace 1 día":$<7?`hace ${$} días`:$<30?`hace ${Math.ceil($/7)} semanas`:$<365?`hace ${Math.ceil($/30)} meses`:`hace ${Math.ceil($/365)} años`},v=b=>{switch(b){case Ee.ENTRADA:return"movement-entrada";case Ee.SALIDA:return"movement-salida";case Ee.TRANSFERENCIA:return"movement-transferencia";case Ee.AJUSTE:return"movement-ajuste";default:return"movement-default"}},_=b=>{switch(b){case Ge.COMPLETADO:return"status-completado";case Ge.PENDIENTE:return"status-pendiente";case Ge.CANCELADO:return"status-cancelado";default:return"status-default"}},N=b=>{switch(b){case Ee.ENTRADA:return"📥";case Ee.SALIDA:return"📤";case Ee.TRANSFERENCIA:return"🔄";case Ee.AJUSTE:return"⚖️";default:return"📋"}},j=b=>{switch(b?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},C=b=>{switch(b){case Ge.COMPLETADO:return"✅";case Ge.PENDIENTE:return"⏳";case Ge.CANCELADO:return"❌";default:return"❓"}};return r.jsx("div",{className:"movements-cards",children:n.map(b=>r.jsxs("div",{className:`movement-card ${v(b.type)}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"movement-type",children:[r.jsx("span",{className:"type-icon",children:N(b.type)}),r.jsx("span",{className:"type-label",children:b.type.charAt(0).toUpperCase()+b.type.slice(1)})]}),r.jsxs("div",{className:`status-badge ${_(b.status)}`,children:[r.jsx("span",{className:"status-icon",children:C(b.status)}),r.jsx("span",{className:"status-label",children:b.status.charAt(0).toUpperCase()+b.status.slice(1)})]})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",children:j(b.fuelType)}),r.jsx("span",{className:"fuel-type",children:b.fuelType}),r.jsxs("span",{className:"quantity",children:[b.quantity," galones"]})]}),r.jsxs("div",{className:"value-info",children:[r.jsx("div",{className:"total-value",children:d(b.totalValue)}),r.jsxs("div",{className:"unit-price",children:[d(b.unitPrice),"/galón"]})]}),b.vehicleId&&r.jsxs("div",{className:"vehicle-info",children:[r.jsx("span",{className:"vehicle-icon",children:"🚜"}),r.jsxs("span",{className:"vehicle-id",children:["Vehículo: ",b.vehicleId]})]}),b.location&&r.jsxs("div",{className:"location-info",children:[r.jsx("span",{className:"location-icon",children:"📍"}),r.jsx("span",{className:"location",children:b.location})]}),b.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:b.description})}),b.reference&&r.jsxs("div",{className:"reference",children:[r.jsx("span",{className:"reference-label",children:"Ref:"}),r.jsx("span",{className:"reference-value",children:b.reference})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[r.jsx("div",{className:"created-date",children:f(b.createdAt)}),r.jsx("div",{className:"relative-time",children:p(b.createdAt)})]}),r.jsxs("div",{className:"card-actions",children:[c==="admin"&&b.status===Ge.PENDIENTE&&r.jsxs("div",{className:"admin-actions",children:[r.jsx("button",{className:"btn-approve",onClick:()=>a(b.id),title:"Aprobar movimiento",children:"✓ Aprobar"}),r.jsx("button",{className:"btn-reject",onClick:()=>o(b.id),title:"Rechazar movimiento",children:"✗ Rechazar"})]}),r.jsxs("div",{className:"user-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(b),title:"Ver detalles",children:"👁️ Ver"}),e&&b.status===Ge.PENDIENTE&&r.jsx("button",{className:"btn-edit",onClick:()=>e(b),title:"Editar movimiento",children:"✏️ Editar"})]})]})]}),b.status===Ge.PENDIENTE&&r.jsx("div",{className:"urgency-indicator",children:r.jsx("div",{className:"urgency-pulse"})}),b.type===Ee.AJUSTE&&r.jsx("div",{className:"adjustment-badge",children:r.jsx("span",{children:"Ajuste"})}),b.type===Ee.TRANSFERENCIA&&b.destinationLocation&&r.jsxs("div",{className:"transfer-info",children:[r.jsx("span",{className:"transfer-arrow",children:"→"}),r.jsx("span",{className:"destination",children:b.destinationLocation})]})]},b.id))})},dL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,userRole:c})=>{const[d,f]=Y.useState("createdAt"),[p,v]=Y.useState("desc"),_=O=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(O),N=O=>O?(O instanceof Date?O:new Date(O)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",j=O=>{switch(O){case Ee.ENTRADA:return"📥";case Ee.SALIDA:return"📤";case Ee.TRANSFERENCIA:return"🔄";case Ee.AJUSTE:return"⚖️";default:return"📋"}},C=O=>{switch(O?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},b=O=>{switch(O){case Ge.COMPLETADO:return"✅";case Ge.PENDIENTE:return"⏳";case Ge.CANCELADO:return"❌";default:return"❓"}},M=O=>{switch(O){case Ge.COMPLETADO:return"status-completado";case Ge.PENDIENTE:return"status-pendiente";case Ge.CANCELADO:return"status-cancelado";default:return"status-default"}},T=O=>{d===O?v(p==="asc"?"desc":"asc"):(f(O),v("asc"))},L=[...n].sort((O,U)=>{let F=O[d],X=U[d];return(d.includes("Date")||d.includes("At"))&&(F=new Date(F),X=new Date(X)),typeof F=="number"&&typeof X=="number"?p==="asc"?F-X:X-F:typeof F=="string"&&typeof X=="string"?p==="asc"?F.localeCompare(X):X.localeCompare(F):F instanceof Date&&X instanceof Date?p==="asc"?F-X:X-F:0}),$=O=>d!==O?"↕️":p==="asc"?"↑":"↓";return r.jsxs("div",{className:"movements-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"movements-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>T("type"),children:["Tipo ",$("type")]}),r.jsxs("th",{className:"sortable",onClick:()=>T("fuelType"),children:["Combustible ",$("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>T("quantity"),children:["Cantidad ",$("quantity")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>T("unitPrice"),children:["Precio/Gal ",$("unitPrice")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>T("totalValue"),children:["Valor Total ",$("totalValue")]}),r.jsx("th",{children:"Vehículo"}),r.jsx("th",{children:"Ubicación"}),r.jsxs("th",{className:"sortable",onClick:()=>T("status"),children:["Estado ",$("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>T("createdAt"),children:["Fecha ",$("createdAt")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:L.map(O=>r.jsxs("tr",{className:`movement-row ${O.status===Ge.PENDIENTE?"pending-row":""}`,children:[r.jsx("td",{className:"type-cell",children:r.jsxs("div",{className:"type-content",children:[r.jsx("span",{className:"type-icon",children:j(O.type)}),r.jsx("span",{className:"type-text",children:O.type.charAt(0).toUpperCase()+O.type.slice(1)})]})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:C(O.fuelType)}),r.jsx("span",{className:"fuel-text",children:O.fuelType})]})}),r.jsxs("td",{className:"quantity-cell text-right",children:[r.jsx("span",{className:"quantity-value",children:O.quantity}),r.jsx("span",{className:"quantity-unit",children:"gal"})]}),r.jsx("td",{className:"price-cell text-right",children:_(O.unitPrice)}),r.jsx("td",{className:"value-cell text-right",children:r.jsx("strong",{children:_(O.totalValue)})}),r.jsx("td",{className:"vehicle-cell",children:O.vehicleId?r.jsxs("span",{className:"vehicle-id",children:["🚜 ",O.vehicleId]}):r.jsx("span",{className:"no-vehicle",children:"-"})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:["📍 ",O.location||"Principal"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${M(O.status)}`,children:[r.jsx("span",{className:"status-icon",children:b(O.status)}),r.jsx("span",{className:"status-text",children:O.status.charAt(0).toUpperCase()+O.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:N(O.createdAt)}),O.reference&&r.jsxs("span",{className:"reference-small",children:["#",O.reference]})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(O),title:"Ver detalles",children:"👁️"}),c==="admin"&&O.status===Ge.PENDIENTE&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-action btn-approve",onClick:()=>a(O.id),title:"Aprobar movimiento",children:"✓"}),r.jsx("button",{className:"btn-action btn-reject",onClick:()=>o(O.id),title:"Rechazar movimiento",children:"✗"})]}),e&&O.status===Ge.PENDIENTE&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(O),title:"Editar movimiento",children:"✏️"})]})})]},O.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[n.length," movimiento",n.length!==1?"s":""]}),d&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",d," (",p==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⏳"})," Pendiente"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"✅"})," Completado"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"❌"})," Cancelado"]})]})]})]})},hL=({movements:n,viewMode:e,onEdit:t,onView:a,userRole:o})=>e==="table"?r.jsx(dL,{movements:n,onEdit:t,onView:a,userRole:o}):r.jsx(uL,{movements:n,onEdit:t,onView:a,userRole:o}),zs="combustibles_suppliers",fL=async(n,e)=>{try{const t=De(et(Te,zs),Ye("name","==",n.name.trim()));if(!(await zt(t)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${n.name}"`};if(n.taxId){const d=De(et(Te,zs),Ye("taxId","==",n.taxId.trim()));if(!(await zt(d)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${n.taxId}"`}}const o={name:n.name.trim(),taxId:n.taxId?.trim()||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson?.trim()||"",phone:n.phone?.trim()||"",email:n.email?.trim()||"",address:n.address?.trim()||"",city:n.city?.trim()||"",state:n.state?.trim()||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:Number(n.creditLimit)||0,priceList:n.priceList||{},rating:Number(n.rating)||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1,totalOrders:0,totalPurchased:0,lastOrderDate:null,averageDeliveryTime:0,createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await lf(et(Te,zs),o)).id,...o},message:`Proveedor "${o.name}" creado exitosamente`}}catch(t){return console.error("Error creating supplier:",t),{success:!1,error:t.message}}},Aj=async()=>{try{const n=De(et(Te,zs),Qn("name","asc"));return{success:!0,data:(await zt(n)).docs.map(a=>({id:a.id,...a.data()}))}}catch(n){return console.error("Error getting suppliers:",n),{success:!1,error:n.message}}},mL=n=>{const e=De(et(Te,zs),Qn("name","asc"));return dl(e,t=>{const a=t.docs.map(o=>({id:o.id,...o.data()}));n(a)})},pL=async(n,e,t)=>{try{const a=await Ur(Tt(Te,zs,n));if(!a.exists())return{success:!1,error:"Proveedor no encontrado"};if(e.name&&e.name.trim()!==a.data().name){const c=De(et(Te,zs),Ye("name","==",e.name.trim()));if(!(await zt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${e.name}"`}}if(e.taxId&&e.taxId.trim()!==a.data().taxId){const c=De(et(Te,zs),Ye("taxId","==",e.taxId.trim()));if(!(await zt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${e.taxId}"`}}const o={...e,lastUpdated:new Date,updatedBy:t};return o.name&&(o.name=o.name.trim()),o.taxId&&(o.taxId=o.taxId.trim()),o.contactPerson&&(o.contactPerson=o.contactPerson.trim()),o.phone&&(o.phone=o.phone.trim()),o.email&&(o.email=o.email.trim()),await ka(Tt(Te,zs,n),o),{success:!0,message:"Proveedor actualizado exitosamente"}}catch(a){return console.error("Error updating supplier:",a),{success:!1,error:a.message}}},gL=async(n,e)=>{try{return await ka(Tt(Te,zs,n),{status:"inactive",lastUpdated:new Date,updatedBy:e}),{success:!0,message:"Proveedor desactivado exitosamente"}}catch(t){return console.error("Error deleting supplier:",t),{success:!1,error:t.message}}},vL=async()=>{try{const n=await Aj();if(!n.success)return n;const e=n.data,t={total:e.length,active:e.filter(a=>a.status==="active").length,inactive:e.filter(a=>a.status==="inactive").length,suspended:e.filter(a=>a.status==="suspended").length,preferred:e.filter(a=>a.isPreferred).length,averageRating:e.length>0?e.reduce((a,o)=>a+(o.rating||0),0)/e.length:0,byCategory:{},byType:{}};return e.forEach(a=>{const o=a.category||"sin_categoria";t.byCategory[o]=(t.byCategory[o]||0)+1}),e.forEach(a=>{const o=a.type||"sin_tipo";t.byType[o]=(t.byType[o]||0)+1}),{success:!0,data:t}}catch(n){return console.error("Error getting suppliers stats:",n),{success:!1,error:n.message}}},yL=({isOpen:n,onClose:e,movement:t,mode:a,onSuccess:o})=>{const[c,d]=Y.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),[f,p]=Y.useState(!1),[v,_]=Y.useState(""),[N,j]=Y.useState({}),[C,b]=Y.useState([]),[M,T]=Y.useState(!1),[L,$]=Y.useState([]),[O,U]=Y.useState(""),[F,X]=Y.useState([]),[w,A]=Y.useState([]),R=["Principal","Bodega Norte","Bodega Sur","Campo Operativo","Estación Móvil"];Y.useEffect(()=>{(async()=>{if(n){T(!0);try{console.log("🔄 Cargando datos para formulario de movimientos...");const[H,J,ce,ve]=await Promise.all([fj(),oj(),Aj(),Z2()]);console.log("📊 Datos cargados:",{vehicles:H?.length||0,inventory:J?.success?J.data?.length||0:"Error",suppliers:ce?.success?ce.data?.length||0:"Error",products:ve?.length||0}),b(H),$(J.success?J.data:[]),X(ce.success?ce.data:[]),A(ve),console.log("✅ Datos cargados exitosamente")}catch(H){console.error("❌ Error al cargar datos:",H)}finally{T(!1)}}})()},[n]),Y.useEffect(()=>{t&&(a==="edit"||a==="view")?d({type:t.type||"",fuelType:t.fuelType||"",quantity:t.quantity?.toString()||"",unitPrice:t.unitPrice?.toString()||"",location:t.location||"Principal",vehicleId:t.vehicleId||"",destinationLocation:t.destinationLocation||"",description:t.description||"",reference:t.reference||"",effectiveDate:t.effectiveDate?new Date(t.effectiveDate).toISOString().slice(0,16):new Date().toISOString().slice(0,16)}):a==="create"&&d({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),_(""),j({})},[t,a,n]),Y.useEffect(()=>{if(c.fuelType&&!c.unitPrice&&w.length>0){const ae=w.find(H=>H.name===c.fuelType||H.displayName===c.fuelType);ae&&ae.defaultPrice&&d(H=>({...H,unitPrice:ae.defaultPrice.toString()}))}},[c.fuelType,w]),Y.useEffect(()=>{if(U(""),(c.type===Ee.SALIDA||c.type===Ee.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&L.length>0){const ae={type:c.type===Ee.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},H=Ax(ae,L);H.isValid?H.warning&&U(`⚠️ ${H.warning}`):U(`🚫 ${H.error}`)}},[c.type,c.fuelType,c.location,c.quantity,L]);const I=(ae,H)=>{d(ae==="type"?J=>({...J,[ae]:H,location:H===Ee.ENTRADA?"":"Principal"}):J=>({...J,[ae]:H})),N[ae]&&j(J=>({...J,[ae]:""}))},P=()=>{const ae={};if(c.type||(ae.type="Tipo de movimiento requerido"),c.fuelType||(ae.fuelType="Tipo de combustible requerido"),c.quantity?parseFloat(c.quantity)<=0&&(ae.quantity="La cantidad debe ser mayor a cero"):ae.quantity="Cantidad requerida",c.unitPrice?parseFloat(c.unitPrice)<0&&(ae.unitPrice="El precio no puede ser negativo"):ae.unitPrice="Precio unitario requerido",c.type===Ee.ENTRADA&&!c.location&&(ae.location="Las entradas requieren un proveedor"),c.type===Ee.SALIDA&&!c.vehicleId&&(ae.vehicleId="Las salidas requieren un vehículo"),c.type===Ee.TRANSFERENCIA&&!c.destinationLocation&&(ae.destinationLocation="Las transferencias requieren una ubicación destino"),(c.type===Ee.SALIDA||c.type===Ee.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&L.length>0){const H={type:c.type===Ee.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},J=Ax(H,L);J.isValid||(ae.quantity=J.error)}return j(ae),Object.keys(ae).length===0},V=async ae=>{if(ae.preventDefault(),!P()){_("Por favor corrige los errores en el formulario");return}p(!0),_("");try{const H={...c,quantity:parseFloat(c.quantity),unitPrice:parseFloat(c.unitPrice),effectiveDate:new Date(c.effectiveDate)};a==="create"?await q2(H):a==="edit"&&await cj(t.id,H),o()}catch(H){console.error("Error al guardar movimiento:",H),_(H.message||"Error al guardar el movimiento")}finally{p(!1)}},k=(parseFloat(c.quantity)||0)*(parseFloat(c.unitPrice)||0),ke=()=>{switch(a){case"create":return"➕ Nuevo Movimiento";case"edit":return"✏️ Editar Movimiento";case"view":return"👁️ Detalles del Movimiento";default:return"Movimiento"}};return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content movement-modal",onClick:ae=>ae.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:ke()}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),a==="create"&&r.jsx("div",{style:{padding:"10px",background:"#f0f0f0",borderBottom:"1px solid #ddd"},children:r.jsx("button",{onClick:()=>{console.log("🔍 Debug - Estado actual:",{products:w.length,vehicles:C.length,suppliers:F.length,inventory:L.length,loadingVehicles:M}),alert(`Productos: ${w.length}, Vehículos: ${C.length}, Proveedores: ${F.length}`)},style:{background:"#007bff",color:"white",border:"none",padding:"5px 10px",borderRadius:"4px",cursor:"pointer"},children:"🔍 Debug Datos"})}),r.jsxs("div",{className:"modal-body",children:[v&&r.jsxs("div",{className:"error-message",children:[r.jsx("span",{className:"error-icon",children:"⚠️"}),v]}),r.jsxs("form",{onSubmit:V,className:"movement-form",children:[r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Movimiento *"}),r.jsxs("select",{value:c.type,onChange:ae=>I("type",ae.target.value),disabled:a==="view",className:N.type?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),r.jsx("option",{value:Ee.ENTRADA,children:"📥 Entrada"}),r.jsx("option",{value:Ee.SALIDA,children:"📤 Salida"}),r.jsx("option",{value:Ee.TRANSFERENCIA,children:"🔄 Transferencia"}),r.jsx("option",{value:Ee.AJUSTE,children:"⚖️ Ajuste"})]}),N.type&&r.jsx("span",{className:"field-error",children:N.type})]}),a==="view"&&t&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsx("div",{className:"status-display",children:r.jsxs("span",{className:`status-badge status-${t.status}`,children:[t.status===Ge.COMPLETADO&&"✅",t.status===Ge.PENDIENTE&&"⏳",t.status===Ge.CANCELADO&&"❌",t.status.charAt(0).toUpperCase()+t.status.slice(1)]})})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Combustible *"}),r.jsxs("select",{value:c.fuelType,onChange:ae=>I("fuelType",ae.target.value),disabled:a==="view",className:N.fuelType?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar producto/combustible..."}),w.map(ae=>r.jsxs("option",{value:ae.name,children:[ae.icon," ",ae.displayName]},ae.id))]}),N.fuelType&&r.jsx("span",{className:"field-error",children:N.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cantidad (galones) *"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:c.quantity,onChange:ae=>I("quantity",ae.target.value),disabled:a==="view",placeholder:"0.00",className:N.quantity?"error":""}),N.quantity&&r.jsx("span",{className:"field-error",children:N.quantity}),O&&!N.quantity&&r.jsx("div",{className:"stock-warning",children:O})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio Unitario (COP) *"}),r.jsx("input",{type:"number",step:"1",min:"0",value:c.unitPrice,onChange:ae=>I("unitPrice",ae.target.value),disabled:a==="view",placeholder:"0",className:N.unitPrice?"error":""}),N.unitPrice&&r.jsx("span",{className:"field-error",children:N.unitPrice})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Valor Total"}),r.jsx("div",{className:"total-value-display",children:Mn(k)})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:c.type===Ee.ENTRADA?"Proveedor *":"Ubicación"}),c.type===Ee.ENTRADA?r.jsxs("select",{value:c.location,onChange:ae=>I("location",ae.target.value),disabled:a==="view",className:N.location?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar proveedor..."}),F.filter(ae=>ae.status==="active").map(ae=>r.jsxs("option",{value:ae.name,children:["🏪 ",ae.name," - ",ae.city]},ae.id))]}):r.jsx("select",{value:c.location,onChange:ae=>I("location",ae.target.value),disabled:a==="view",children:R.map(ae=>r.jsxs("option",{value:ae,children:["📍 ",ae]},ae))}),N.location&&r.jsx("span",{className:"field-error",children:N.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Vehículo/Equipo ",c.type===Ee.SALIDA&&"*"]}),c.type===Ee.SALIDA?M?r.jsxs("div",{className:"loading-vehicles",children:[r.jsx("span",{className:"loading-spinner small"}),"Cargando vehículos..."]}):r.jsxs("select",{value:c.vehicleId,onChange:ae=>I("vehicleId",ae.target.value),disabled:a==="view",className:N.vehicleId?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar vehículo destino..."}),C.map(ae=>r.jsxs("option",{value:ae.vehicleId,children:["🚜 ",ae.vehicleId," - ",ae.name," (",ae.type,")"]},ae.id))]}):r.jsx("input",{type:"text",value:c.vehicleId,onChange:ae=>I("vehicleId",ae.target.value),disabled:a==="view",placeholder:"ID del vehículo o equipo",className:N.vehicleId?"error":""}),N.vehicleId&&r.jsx("span",{className:"field-error",children:N.vehicleId})]})]}),c.type===Ee.TRANSFERENCIA&&r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ubicación Destino *"}),r.jsxs("select",{value:c.destinationLocation,onChange:ae=>I("destinationLocation",ae.target.value),disabled:a==="view",className:N.destinationLocation?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar destino..."}),R.filter(ae=>ae!==c.location).map(ae=>r.jsxs("option",{value:ae,children:["📍 ",ae]},ae))]}),N.destinationLocation&&r.jsx("span",{className:"field-error",children:N.destinationLocation})]})}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Fecha Efectiva"}),r.jsx("input",{type:"datetime-local",value:c.effectiveDate,onChange:ae=>I("effectiveDate",ae.target.value),disabled:a==="view"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Referencia"}),r.jsx("input",{type:"text",value:c.reference,onChange:ae=>I("reference",ae.target.value),disabled:a==="view",placeholder:"Factura, orden, etc."})]})]}),r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Descripción"}),r.jsx("textarea",{value:c.description,onChange:ae=>I("description",ae.target.value),disabled:a==="view",placeholder:"Detalles adicionales del movimiento...",rows:"3"})]})}),a==="view"&&t&&r.jsx("div",{className:"movement-details",children:r.jsxs("div",{className:"details-section",children:[r.jsx("h4",{children:"📋 Información del Sistema"}),r.jsxs("div",{className:"details-grid",children:[r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"ID:"}),r.jsx("span",{children:t.id})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Creado:"}),r.jsx("span",{children:new Date(t.createdAt).toLocaleString("es-CO")})]}),t.updatedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Actualizado:"}),r.jsx("span",{children:new Date(t.updatedAt).toLocaleString("es-CO")})]}),t.approvedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Aprobado:"}),r.jsx("span",{children:new Date(t.approvedAt).toLocaleString("es-CO")})]})]})]})})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-cancel",onClick:e,children:a==="view"?"Cerrar":"Cancelar"}),a!=="view"&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:V,disabled:f,children:f?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner small"}),"Guardando..."]}):a==="create"?"Crear Movimiento":"Actualizar Movimiento"})]})]})}):null},_L=()=>{const{user:n,userProfile:e}=Zs(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[j,C]=Y.useState("cards"),[b,M]=Y.useState(""),[T,L]=Y.useState(!1),[$,O]=Y.useState(null),[U,F]=Y.useState("create");Y.useEffect(()=>{if(!n)return;f(!0);const J=Hv((ce,ve)=>{if(ve){console.error("Error en suscripción de movimientos:",ve),v("Error al cargar movimientos"),f(!1);return}a(ce),v(null),f(!1)},_);return()=>J()},[n,_]),Y.useEffect(()=>{n&&(async()=>{try{const ce=await G2(_);c(ce)}catch(ce){console.error("Error al cargar estadísticas:",ce)}})()},[n,t,_]);const X=t.filter(J=>{if(!b)return!0;const ce=b.toLowerCase();return J.fuelType?.toLowerCase().includes(ce)||J.type?.toLowerCase().includes(ce)||J.location?.toLowerCase().includes(ce)||J.vehicleId?.toLowerCase().includes(ce)||J.description?.toLowerCase().includes(ce)||J.reference?.toLowerCase().includes(ce)}),w=()=>{O(null),F("create"),L(!0)},A=J=>{O(J),F("edit"),L(!0)},R=J=>{O(J),F("view"),L(!0)},I=()=>{L(!1),O(null)},P=J=>{N(ce=>({...ce,...J}))},V=()=>{N({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),M("")},k=async J=>{if(window.confirm("¿Estás seguro de que quieres aprobar este movimiento? Esta acción actualizará el inventario."))try{await z2(J),alert("Movimiento aprobado y stock actualizado.")}catch(ce){console.error("Error al aprobar movimiento:",ce),alert(`Error al aprobar movimiento: ${ce.message}`)}},ke=async J=>{if(window.confirm("¿Estás seguro de que quieres rechazar este movimiento?"))try{await cj(J,{status:Ge.CANCELADO}),alert("Movimiento rechazado.")}catch(ce){console.error("Error al rechazar movimiento:",ce),alert(`Error al rechazar movimiento: ${ce.message}`)}},ae=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",H=e?.role==="admin";return d?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando movimientos..."})]})}):p?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:"⚠️"}),r.jsx("h3",{children:"Error al cargar movimientos"}),r.jsx("p",{children:p}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"movements-main",children:[r.jsxs("div",{className:"movements-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"📊 Movimientos de Combustibles"}),r.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),ae&&r.jsx("button",{className:"btn-create-movement",onClick:w,children:"➕ Nuevo Movimiento"})]}),o&&r.jsx(lL,{stats:o,filters:_}),r.jsx(cL,{filters:_,onFilterChange:P,onClearFilters:V,searchTerm:b,onSearchChange:M,viewMode:j,onViewModeChange:C,totalResults:X.length}),X.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📋"}),r.jsx("h3",{children:t.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),r.jsx("p",{children:t.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&ae&&r.jsx("button",{className:"btn-create-first",onClick:w,children:"➕ Crear Primer Movimiento"})]}):r.jsx(hL,{movements:X,viewMode:j,onEdit:H?A:null,onView:R,onApprove:k,onReject:ke,userRole:n?.role}),T&&r.jsx(yL,{isOpen:T,onClose:I,movement:$,mode:U,onSuccess:()=>{I()}})]})},EL=({stats:n,filters:e})=>{if(!n)return null;const t=N=>`${ze(N)} gal`,a=N=>`${ze(N)} hrs`,o=N=>`${N.toFixed(2)} gal/hr`,c=N=>{switch(N){case ge.EXCAVADORA:return"#059669";case ge.BULLDOZER:return"#dc2626";case ge.CARGADOR:return"#2563eb";case ge.CAMION:return"#7c3aed";case ge.GRUA:return"#ea580c";case ge.MOTOSIERRA:return"#16a34a";case ge.TRACTOR:return"#ca8a04";case ge.VOLQUETA:return"#9333ea";default:return"#6b7280"}},d=N=>{switch(N){case ge.EXCAVADORA:return"🚚";case ge.BULLDOZER:return"🚜";case ge.CARGADOR:return"🏗️";case ge.CAMION:return"🚛";case ge.GRUA:return"🏗️";case ge.MOTOSIERRA:return"🪚";case ge.TRACTOR:return"🚜";case ge.VOLQUETA:return"🚛";default:return"🚗"}},f=N=>{switch(N){case Oe.ACTIVO:return"#10b981";case Oe.MANTENIMIENTO:return"#f59e0b";case Oe.INACTIVO:return"#6b7280";case Oe.REPARACION:return"#ef4444";default:return"#6b7280"}},p=N=>{switch(N){case Oe.ACTIVO:return"✅";case Oe.MANTENIMIENTO:return"🔧";case Oe.INACTIVO:return"⏸️";case Oe.REPARACION:return"🔴";default:return"❓"}},v=N=>{switch(N){case xt.DIESEL:return"🚛";case xt.GASOLINA:return"🚗";case xt.ACPM:return"🚚";case xt.MIXTO:return"⛽";default:return"⛽"}},_=n.totalVehicles>0?((n.byStatus[Oe.ACTIVO]||0)/n.totalVehicles*100).toFixed(1):0;return r.jsxs("div",{className:"vehicles-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"🚜"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.totalVehicles)}),r.jsx("div",{className:"stat-label",children:"Total Vehículos"}),r.jsx("div",{className:"stat-trend",children:r.jsxs("span",{className:`trend ${_>=80?"positive":"warning"}`,children:[_>=80?"📈":"⚠️"," ",_,"% activos"]})})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⛽"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:t(n.totalFuelConsumed)}),r.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(n.averageConsumption||0)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⏰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:a(n.totalHoursWorked)}),r.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",a(n.totalHoursWorked/(n.totalVehicles||1))]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"🏆"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:n.mostActiveVehicle?n.mostActiveVehicle.vehicleId:"N/A"}),r.jsx("div",{className:"stat-label",children:"Más Activo"}),r.jsx("div",{className:"stat-secondary",children:n.mostActiveVehicle?`${n.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"🚜 Por Tipo de Vehículo"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([N,j])=>{const C=(j/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:d(N)}),r.jsx("span",{className:"breakdown-label",children:N.charAt(0).toUpperCase()+N.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:j}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${C}%`,backgroundColor:c(N)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[C,"%"]})]},N)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⚡ Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([N,j])=>{const C=(j/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:p(N)}),r.jsx("span",{className:"breakdown-label",children:N.charAt(0).toUpperCase()+N.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:j}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${C}%`,backgroundColor:f(N)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[C,"%"]})]},N)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([N,j])=>{const C=(j/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(N)}),r.jsx("span",{className:"breakdown-label",children:N})]}),r.jsx("div",{className:"breakdown-value",children:j}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${C}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[C,"%"]})]},N)})})]})]}),(n.totalFuelConsumed>0||n.totalHoursWorked>0)&&r.jsxs("div",{className:"performance-metrics",children:[r.jsx("h4",{children:"📊 Métricas de Rendimiento"}),r.jsxs("div",{className:"metrics-grid",children:[r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"⚡"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),r.jsxs("div",{className:"metric-value",children:[_,"%"]}),r.jsxs("div",{className:"metric-description",children:[n.byStatus[Oe.ACTIVO]||0," de ",n.totalVehicles," activos"]})]})]}),n.averageConsumption>0&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"📈"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),r.jsx("div",{className:"metric-value",children:o(n.averageConsumption)}),r.jsx("div",{className:"metric-description",children:"Por vehículo por hora trabajada"})]})]}),n.mostActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"🏆"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Mayor Utilización"}),r.jsx("div",{className:"metric-value",children:n.mostActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(n.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),n.leastActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"📉"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Menor Utilización"}),r.jsx("div",{className:"metric-value",children:n.leastActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(n.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(e.type||e.status||e.fuelType||e.location)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:"🔍 Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.location&&r.jsxs("span",{className:"filter-tag",children:["Ubicación: ",e.location]})]})]})]})},bL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const[p,v]=Y.useState(!1),_=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mecánico","Proyecto A","Proyecto B","En Reparación","Otros"],N=Object.values(n).filter(b=>b&&b!==""&&b!=="all").length,j=(b,M)=>{e({[b]:M})},C=b=>{e(b)};return r.jsxs("div",{className:"vehicles-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicación...",value:a,onChange:b=>o(b.target.value),className:"search-input"}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${n.status===Oe.ACTIVO?"active":""}`,onClick:()=>C({status:Oe.ACTIVO}),children:"✅ Activos"}),r.jsx("button",{className:`quick-filter ${n.status===Oe.MANTENIMIENTO?"active":""}`,onClick:()=>C({status:Oe.MANTENIMIENTO}),children:"🔧 Mantenimiento"}),r.jsx("button",{className:`quick-filter ${n.type===ge.EXCAVADORA?"active":""}`,onClick:()=>C({type:ge.EXCAVADORA}),children:"🚚 Excavadoras"}),r.jsx("button",{className:`quick-filter ${n.type===ge.TRACTOR?"active":""}`,onClick:()=>C({type:ge.TRACTOR}),children:"🚜 Tractores"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:["🎛️ Filtros",N>0&&r.jsx("span",{className:"filters-count",children:N})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Vehículo"}),r.jsxs("select",{value:n.type,onChange:b=>j("type",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:ge.EXCAVADORA,children:"🚚 Excavadora"}),r.jsx("option",{value:ge.BULLDOZER,children:"🚜 Bulldozer"}),r.jsx("option",{value:ge.CARGADOR,children:"🏗️ Cargador"}),r.jsx("option",{value:ge.CAMION,children:"🚛 Camión"}),r.jsx("option",{value:ge.GRUA,children:"🏗️ Grúa"}),r.jsx("option",{value:ge.MOTOSIERRA,children:"🪚 Motosierra"}),r.jsx("option",{value:ge.TRACTOR,children:"🚜 Tractor"}),r.jsx("option",{value:ge.VOLQUETA,children:"🚛 Volqueta"}),r.jsx("option",{value:ge.OTROS,children:"🚗 Otros"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:b=>j("status",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:Oe.ACTIVO,children:"✅ Activo"}),r.jsx("option",{value:Oe.MANTENIMIENTO,children:"🔧 Mantenimiento"}),r.jsx("option",{value:Oe.INACTIVO,children:"⏸️ Inactivo"}),r.jsx("option",{value:Oe.REPARACION,children:"🔴 Reparación"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:n.fuelType,onChange:b=>j("fuelType",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),r.jsx("option",{value:xt.DIESEL,children:"🚛 Diesel"}),r.jsx("option",{value:xt.GASOLINA,children:"🚗 Gasolina"}),r.jsx("option",{value:xt.ACPM,children:"🚚 ACPM"}),r.jsx("option",{value:xt.MIXTO,children:"⛽ Mixto"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Ubicación Actual"}),r.jsxs("select",{value:n.location,onChange:b=>j("location",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todas las ubicaciones"}),_.map(b=>r.jsxs("option",{value:b,children:["📍 ",b]},b))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Mantenimiento"}),r.jsxs("select",{value:n.maintenance,onChange:b=>j("maintenance",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos"}),r.jsx("option",{value:"due",children:"Mantenimiento debido"}),r.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),r.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:N===0,children:"🗑️ Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[f," resultado",f!==1?"s":""]}),N>0&&r.jsxs("span",{className:"active-filters-text",children:["(",N," filtro",N!==1?"s":""," activo",N!==1?"s":"",")"]})]})]})]}),N>0&&r.jsx("div",{className:"active-filters-summary",children:r.jsxs("div",{className:"summary-content",children:[r.jsx("span",{className:"summary-label",children:"Filtros activos:"}),r.jsxs("div",{className:"summary-tags",children:[n.type&&r.jsxs("span",{className:"summary-tag",onClick:()=>j("type",""),children:["Tipo: ",n.type," ✕"]}),n.status&&r.jsxs("span",{className:"summary-tag",onClick:()=>j("status",""),children:["Estado: ",n.status," ✕"]}),n.fuelType&&r.jsxs("span",{className:"summary-tag",onClick:()=>j("fuelType",""),children:["Combustible: ",n.fuelType," ✕"]}),n.location&&r.jsxs("span",{className:"summary-tag",onClick:()=>j("location",""),children:["Ubicación: ",n.location," ✕"]}),n.maintenance!=="all"&&r.jsxs("span",{className:"summary-tag",onClick:()=>j("maintenance","all"),children:["Mantenimiento: ",n.maintenance," ✕"]})]})]})}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},NL=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const o=T=>new Intl.NumberFormat("es-CO").format(T),c=T=>`${o(T)} gal`,d=T=>`${o(T)} hrs`,f=T=>T?(T instanceof Date?T:new Date(T)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",p=T=>{if(!T)return"";const L=new Date,$=T instanceof Date?T:new Date(T),O=Math.abs(L-$),U=Math.ceil(O/(1e3*60*60*24));return U===1?"hace 1 día":U<7?`hace ${U} días`:U<30?`hace ${Math.ceil(U/7)} semanas`:U<365?`hace ${Math.ceil(U/30)} meses`:`hace ${Math.ceil(U/365)} años`},v=T=>{switch(T){case ge.EXCAVADORA:return"vehicle-excavadora";case ge.BULLDOZER:return"vehicle-bulldozer";case ge.CARGADOR:return"vehicle-cargador";case ge.CAMION:return"vehicle-camion";case ge.GRUA:return"vehicle-grua";case ge.MOTOSIERRA:return"vehicle-motosierra";case ge.TRACTOR:return"vehicle-tractor";case ge.VOLQUETA:return"vehicle-volqueta";default:return"vehicle-default"}},_=T=>{switch(T){case Oe.ACTIVO:return"status-activo";case Oe.MANTENIMIENTO:return"status-mantenimiento";case Oe.INACTIVO:return"status-inactivo";case Oe.REPARACION:return"status-reparacion";default:return"status-default"}},N=T=>{switch(T){case ge.EXCAVADORA:return"🚚";case ge.BULLDOZER:return"🚜";case ge.CARGADOR:return"🏗️";case ge.CAMION:return"🚛";case ge.GRUA:return"🏗️";case ge.MOTOSIERRA:return"🪚";case ge.TRACTOR:return"🚜";case ge.VOLQUETA:return"🚛";default:return"🚗"}},j=T=>{switch(T){case xt.DIESEL:return"🚛";case xt.GASOLINA:return"🚗";case xt.ACPM:return"🚚";case xt.MIXTO:return"⛽";default:return"⛽"}},C=T=>{switch(T){case Oe.ACTIVO:return"✅";case Oe.MANTENIMIENTO:return"🔧";case Oe.INACTIVO:return"⏸️";case Oe.REPARACION:return"🔴";default:return"❓"}},b=T=>!T.totalHoursWorked||T.totalHoursWorked===0?T.estimatedConsumptionPerHour||0:T.totalFuelConsumed/T.totalHoursWorked,M=T=>T.lastMaintenanceDate?Math.floor((new Date-new Date(T.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsx("div",{className:"vehicles-cards",children:n.map(T=>r.jsxs("div",{className:`vehicle-card ${v(T.type)}`,children:[r.jsx("div",{className:"card-header",children:r.jsxs("div",{className:"vehicle-info",children:[r.jsxs("div",{className:"vehicle-id-section",children:[r.jsx("span",{className:"vehicle-icon",children:N(T.type)}),r.jsxs("div",{className:"vehicle-details",children:[r.jsx("span",{className:"vehicle-id",children:T.vehicleId}),r.jsx("span",{className:"vehicle-name",children:T.name})]})]}),r.jsxs("div",{className:`status-badge ${_(T.status)}`,children:[r.jsx("span",{className:"status-icon",children:C(T.status)}),r.jsx("span",{className:"status-label",children:T.status.charAt(0).toUpperCase()+T.status.slice(1)})]})]})}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"basic-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Tipo:"}),r.jsxs("span",{className:"info-value",children:[N(T.type)," ",T.type.charAt(0).toUpperCase()+T.type.slice(1)]})]}),T.brand&&T.model&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),r.jsxs("span",{className:"info-value",children:[T.brand," ",T.model]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Combustible:"}),r.jsxs("span",{className:"info-value",children:[j(T.fuelType)," ",T.fuelType]})]}),T.currentLocation&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Ubicación:"}),r.jsxs("span",{className:"info-value",children:["📍 ",T.currentLocation]})]})]}),r.jsxs("div",{className:"consumption-metrics",children:[r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"⛽"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:c(T.totalFuelConsumed||0)}),r.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"⏰"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:d(T.totalHoursWorked||0)}),r.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"📊"}),r.jsxs("div",{className:"metric-content",children:[r.jsxs("div",{className:"metric-value",children:[b(T).toFixed(1)," gal/hr"]}),r.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"🔄"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:T.totalMovements||0}),r.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(T.enginePower||T.fuelCapacity||T.year)&&r.jsxs("div",{className:"technical-specs",children:[T.enginePower&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"⚡"}),r.jsxs("span",{className:"spec-value",children:[T.enginePower," HP"]})]}),T.fuelCapacity&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"🛢️"}),r.jsxs("span",{className:"spec-value",children:[T.fuelCapacity," gal"]})]}),T.year&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"📅"}),r.jsx("span",{className:"spec-value",children:T.year})]})]}),T.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:T.description})})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[T.lastMovementDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"Último movimiento:"}),r.jsx("span",{className:"date-value",children:f(T.lastMovementDate)}),r.jsx("span",{className:"date-relative",children:p(T.lastMovementDate)})]}),T.lastMaintenanceDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"Último mantenimiento:"}),r.jsx("span",{className:"date-value",children:f(T.lastMaintenanceDate)}),r.jsx("span",{className:"date-relative",children:p(T.lastMaintenanceDate)})]})]}),r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(T),title:"Ver detalles",children:"👁️"}),e&&T.status!==Oe.REPARACION&&r.jsx("button",{className:"btn-edit",onClick:()=>e(T),title:"Editar vehículo",children:"✏️"}),a&&r.jsx("button",{className:"btn-maintenance",onClick:()=>a(T),title:"Registrar mantenimiento",children:"🔧"})]})]}),T.status===Oe.MANTENIMIENTO&&r.jsx("div",{className:"maintenance-indicator",children:r.jsx("div",{className:"maintenance-pulse"})}),M(T)&&T.status===Oe.ACTIVO&&r.jsx("div",{className:"maintenance-due-badge",children:r.jsx("span",{children:"Mantenimiento Debido"})}),T.status===Oe.REPARACION&&r.jsx("div",{className:"repair-badge",children:r.jsx("span",{children:"En Reparación"})}),T.totalHoursWorked>0&&r.jsxs("div",{className:"efficiency-indicator",children:[r.jsx("div",{className:"efficiency-bar",children:r.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(T.totalHoursWorked/2e3*100,100)}%`}})}),r.jsxs("span",{className:"efficiency-label",children:[(T.totalHoursWorked/2e3*100).toFixed(1),"% utilización anual"]})]})]},T.id))})},xL=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const[o,c]=Y.useState("vehicleId"),[d,f]=Y.useState("asc"),p=F=>new Intl.NumberFormat("es-CO").format(F),v=F=>`${p(F)} gal`,_=F=>`${p(F)} hrs`,N=F=>F?(F instanceof Date?F:new Date(F)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",j=F=>{switch(F){case ge.EXCAVADORA:return"🚚";case ge.BULLDOZER:return"🚜";case ge.CARGADOR:return"🏗️";case ge.CAMION:return"🚛";case ge.GRUA:return"🏗️";case ge.MOTOSIERRA:return"🪚";case ge.TRACTOR:return"🚜";case ge.VOLQUETA:return"🚛";default:return"🚗"}},C=F=>{switch(F){case xt.DIESEL:return"🚛";case xt.GASOLINA:return"🚗";case xt.ACPM:return"🚚";case xt.MIXTO:return"⛽";default:return"⛽"}},b=F=>{switch(F){case Oe.ACTIVO:return"✅";case Oe.MANTENIMIENTO:return"🔧";case Oe.INACTIVO:return"⏸️";case Oe.REPARACION:return"🔴";default:return"❓"}},M=F=>{switch(F){case Oe.ACTIVO:return"status-activo";case Oe.MANTENIMIENTO:return"status-mantenimiento";case Oe.INACTIVO:return"status-inactivo";case Oe.REPARACION:return"status-reparacion";default:return"status-default"}},T=F=>{o===F?f(d==="asc"?"desc":"asc"):(c(F),f("asc"))},L=[...n].sort((F,X)=>{let w=F[o],A=X[o];return(o.includes("Date")||o.includes("At"))&&(w=new Date(w||0),A=new Date(A||0)),typeof w=="number"&&typeof A=="number"?d==="asc"?w-A:A-w:typeof w=="string"&&typeof A=="string"?d==="asc"?w.localeCompare(A):A.localeCompare(w):w instanceof Date&&A instanceof Date?d==="asc"?w-A:A-w:!w&&!A?0:w?A?0:d==="asc"?-1:1:d==="asc"?1:-1}),$=F=>o!==F?"↕️":d==="asc"?"↑":"↓",O=F=>!F.totalHoursWorked||F.totalHoursWorked===0?F.estimatedConsumptionPerHour||0:F.totalFuelConsumed/F.totalHoursWorked,U=F=>F.lastMaintenanceDate?Math.floor((new Date-new Date(F.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsxs("div",{className:"vehicles-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"vehicles-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>T("vehicleId"),children:["ID Vehículo ",$("vehicleId")]}),r.jsxs("th",{className:"sortable",onClick:()=>T("name"),children:["Nombre ",$("name")]}),r.jsxs("th",{className:"sortable",onClick:()=>T("type"),children:["Tipo ",$("type")]}),r.jsx("th",{children:"Marca/Modelo"}),r.jsxs("th",{className:"sortable",onClick:()=>T("fuelType"),children:["Combustible ",$("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>T("totalFuelConsumed"),children:["Consumido ",$("totalFuelConsumed")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>T("totalHoursWorked"),children:["Horas ",$("totalHoursWorked")]}),r.jsx("th",{className:"text-right",children:"Consumo/Hr"}),r.jsx("th",{children:"Ubicación"}),r.jsxs("th",{className:"sortable",onClick:()=>T("status"),children:["Estado ",$("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>T("lastMovementDate"),children:["Último Mov. ",$("lastMovementDate")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:L.map(F=>r.jsxs("tr",{className:`vehicle-row ${F.status===Oe.MANTENIMIENTO?"maintenance-row":""} ${U(F)?"needs-maintenance":""}`,children:[r.jsx("td",{className:"vehicle-id-cell",children:r.jsxs("div",{className:"id-content",children:[r.jsx("span",{className:"vehicle-icon",children:j(F.type)}),r.jsx("span",{className:"vehicle-id",children:F.vehicleId})]})}),r.jsx("td",{className:"name-cell",children:r.jsx("span",{className:"vehicle-name",children:F.name})}),r.jsx("td",{className:"type-cell",children:r.jsx("span",{className:"type-text",children:F.type.charAt(0).toUpperCase()+F.type.slice(1)})}),r.jsx("td",{className:"brand-model-cell",children:F.brand&&F.model?r.jsxs("span",{className:"brand-model",children:[F.brand," ",F.model]}):r.jsx("span",{className:"no-data",children:"-"})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:C(F.fuelType)}),r.jsx("span",{className:"fuel-text",children:F.fuelType})]})}),r.jsx("td",{className:"consumption-cell text-right",children:r.jsx("span",{className:"consumption-value",children:v(F.totalFuelConsumed||0)})}),r.jsx("td",{className:"hours-cell text-right",children:r.jsx("span",{className:"hours-value",children:_(F.totalHoursWorked||0)})}),r.jsx("td",{className:"rate-cell text-right",children:r.jsxs("span",{className:"rate-value",children:[O(F).toFixed(1)," gal/hr"]})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:["📍 ",F.currentLocation||"Sin ubicación"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${M(F.status)}`,children:[r.jsx("span",{className:"status-icon",children:b(F.status)}),r.jsx("span",{className:"status-text",children:F.status.charAt(0).toUpperCase()+F.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:N(F.lastMovementDate)}),U(F)&&r.jsx("span",{className:"maintenance-warning",children:"⚠️"})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(F),title:"Ver detalles",children:"👁️"}),e&&F.status!==Oe.REPARACION&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(F),title:"Editar vehículo",children:"✏️"}),a&&r.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>a(F),title:"Registrar mantenimiento",children:"🔧"})]})})]},F.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[n.length," vehículo",n.length!==1?"s":""]}),o&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",o," (",d==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"✅"})," Activo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"🔧"})," Mantenimiento"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⏸️"})," Inactivo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"🔴"})," Reparación"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⚠️"})," Mantto. Debido"]})]})]})]})},TL=({vehicles:n,viewMode:e,onEdit:t,onView:a,onMaintenance:o})=>e==="table"?r.jsx(xL,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}):r.jsx(NL,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}),an={HARVESTING:"harvesting",TRANSPORT:"transport",MAINTENANCE:"maintenance",SUPPORT:"support"},rn={CHAINSAW:"chainsaw",HARVESTER:"harvester",FORWARDER:"forwarder",SKIDDER:"skidder",LOG_TRUCK:"log_truck",PICKUP_TRUCK:"pickup_truck",CAR:"car",MOTORCYCLE:"motorcycle",ATV:"atv",BULLDOZER:"bulldozer",EXCAVATOR:"excavator",GRADER:"grader",LOADER:"loader",WATER_PUMP:"water_pump",FIRE_PUMP:"fire_pump",GENERATOR:"generator",COMPRESSOR:"compressor"},AL={[rn.CHAINSAW]:{name:"Motosierra",category:an.HARVESTING,fuelType:"two_stroke",avgConsumption:2.5,icon:"🪚",color:"#dc2626",description:"Herramienta para corte de árboles"},[rn.HARVESTER]:{name:"Cosechadora Forestal",category:an.HARVESTING,fuelType:"diesel",avgConsumption:25,icon:"🚜",color:"#059669",description:"Máquina para corte y procesamiento de árboles"},[rn.FORWARDER]:{name:"Forwarder",category:an.HARVESTING,fuelType:"diesel",avgConsumption:20,icon:"🚚",color:"#0891b2",description:"Transporte de troncos dentro del bosque"},[rn.LOG_TRUCK]:{name:"Camión Maderero",category:an.TRANSPORT,fuelType:"acpm",avgConsumption:3.5,icon:"🚚",color:"#ea580c",description:"Transporte de madera a destino"},[rn.PICKUP_TRUCK]:{name:"Camioneta",category:an.TRANSPORT,fuelType:"gasoline",avgConsumption:8,icon:"🚐",color:"#2563eb",description:"Transporte de personal y herramientas"},[rn.CAR]:{name:"Automóvil",category:an.TRANSPORT,fuelType:"gasoline",avgConsumption:12,icon:"🚗",color:"#3b82f6",description:"Vehículo liviano para transporte ejecutivo"},[rn.MOTORCYCLE]:{name:"Motocicleta",category:an.TRANSPORT,fuelType:"gasoline",avgConsumption:25,icon:"🏍️",color:"#6366f1",description:"Transporte ágil para terrenos difíciles"},[rn.ATV]:{name:"Cuatrimoto",category:an.TRANSPORT,fuelType:"gasoline",avgConsumption:15,icon:"🏍️",color:"#84cc16",description:"Vehículo todo terreno para supervisión"},[rn.SKIDDER]:{name:"Skidder",category:an.HARVESTING,fuelType:"diesel",avgConsumption:22,icon:"🚜",color:"#f59e0b",description:"Arrastre de troncos desde el lugar de corte"},[rn.BULLDOZER]:{name:"Bulldozer",category:an.MAINTENANCE,fuelType:"diesel",avgConsumption:30,icon:"🚜",color:"#f97316",description:"Construcción y mantenimiento de caminos"},[rn.EXCAVATOR]:{name:"Excavadora",category:an.MAINTENANCE,fuelType:"diesel",avgConsumption:28,icon:"🏗️",color:"#eab308",description:"Excavación y movimiento de tierra"},[rn.GRADER]:{name:"Motoniveladora",category:an.MAINTENANCE,fuelType:"diesel",avgConsumption:25,icon:"🚜",color:"#a3a3a3",description:"Nivelación y mantenimiento de vías"},[rn.LOADER]:{name:"Cargador Frontal",category:an.MAINTENANCE,fuelType:"diesel",avgConsumption:24,icon:"🚜",color:"#71717a",description:"Carga y descarga de materiales"},[rn.WATER_PUMP]:{name:"Motobomba de Agua",category:an.SUPPORT,fuelType:"gasoline",avgConsumption:3.5,icon:"💧",color:"#0891b2",description:"Bombeo de agua para operaciones"},[rn.FIRE_PUMP]:{name:"Motobomba Contra Incendios",category:an.SUPPORT,fuelType:"gasoline",avgConsumption:4.2,icon:"🔥",color:"#dc2626",description:"Equipo de emergencia contra incendios"},[rn.GENERATOR]:{name:"Generador Eléctrico",category:an.SUPPORT,fuelType:"gasoline",avgConsumption:2.8,icon:"⚡",color:"#7c3aed",description:"Suministro de energía eléctrica"},[rn.COMPRESSOR]:{name:"Compresor de Aire",category:an.SUPPORT,fuelType:"gasoline",avgConsumption:2.5,icon:"💨",color:"#64748b",description:"Suministro de aire comprimido"}},jL=({isOpen:n,onClose:e,vehicle:t,onSave:a,mode:o="create",userRole:c})=>{const d=()=>({vehicleId:t?.vehicleId||"",name:t?.name||"",type:t?.type||ge.EXCAVADORA,brand:t?.brand||"",model:t?.model||"",year:t?.year||new Date().getFullYear(),fuelType:t?.fuelType||xt.DIESEL,fuelCapacity:t?.fuelCapacity||0,enginePower:t?.enginePower||0,status:t?.status||Oe.ACTIVO,currentLocation:t?.currentLocation||"",description:t?.description||"",estimatedConsumptionPerHour:t?.estimatedConsumptionPerHour||0,serialNumber:t?.serialNumber||"",plateNumber:t?.plateNumber||"",hasHourMeter:t?.hasHourMeter||!1,currentHours:t?.currentHours||0,lastMaintenanceDate:t?.lastMaintenanceDate?new Date(t.lastMaintenanceDate).toISOString().split("T")[0]:"",nextMaintenanceDate:t?.nextMaintenanceDate?new Date(t.nextMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:t?.purchaseDate?new Date(t.purchaseDate).toISOString().split("T")[0]:"",warrantyExpiration:t?.warrantyExpiration?new Date(t.warrantyExpiration).toISOString().split("T")[0]:""}),[f,p]=Y.useState(d()),[v,_]=Y.useState({}),[N,j]=Y.useState(!1),[C,b]=Y.useState(""),[M,T]=Y.useState(!1);Y.useEffect(()=>{n&&(p(d()),_({}))},[n,t]);const L=A=>{const{name:R,value:I,type:P}=A.target,V=P==="number"?parseFloat(I)||0:I;p(k=>({...k,[R]:V})),v[R]&&_(k=>({...k,[R]:null}))},$=()=>{const A={};f.vehicleId.trim()?f.vehicleId.length<3&&(A.vehicleId="El ID debe tener al menos 3 caracteres"):A.vehicleId="El ID del vehículo es obligatorio",f.name.trim()?f.name.length<2&&(A.name="El nombre debe tener al menos 2 caracteres"):A.name="El nombre del vehículo es obligatorio",f.fuelCapacity<=0?A.fuelCapacity="La capacidad de combustible debe ser mayor a 0":f.fuelCapacity>1e3&&(A.fuelCapacity="La capacidad no puede ser mayor a 1000 galones"),f.enginePower<0?A.enginePower="La potencia no puede ser negativa":f.enginePower>1e3&&(A.enginePower="La potencia no puede ser mayor a 1000 HP"),f.estimatedConsumptionPerHour<0?A.estimatedConsumptionPerHour="El consumo no puede ser negativo":f.estimatedConsumptionPerHour>50&&(A.estimatedConsumptionPerHour="El consumo no puede ser mayor a 50 gal/hr");const R=new Date().getFullYear();if(f.year<1990?A.year="El año no puede ser anterior a 1990":f.year>R+1&&(A.year=`El año no puede ser mayor a ${R+1}`),f.lastMaintenanceDate&&f.nextMaintenanceDate){const I=new Date(f.lastMaintenanceDate);new Date(f.nextMaintenanceDate)<=I&&(A.nextMaintenanceDate="La próxima fecha debe ser posterior al último mantenimiento")}return f.purchaseDate&&new Date(f.purchaseDate)>new Date&&(A.purchaseDate="La fecha de compra no puede ser futura"),_(A),Object.keys(A).length===0},O=async A=>{if(A.preventDefault(),!!$()){j(!0);try{const R={...f,lastMaintenanceDate:f.lastMaintenanceDate||null,nextMaintenanceDate:f.nextMaintenanceDate||null,purchaseDate:f.purchaseDate||null,warrantyExpiration:f.warrantyExpiration||null};await a(R),e()}catch(R){console.error("Error guardando vehículo:",R),_({general:"Error al guardar el vehículo. Intenta nuevamente."})}finally{j(!1)}}},U=A=>{switch(A){case ge.EXCAVADORA:return"🚚";case ge.BULLDOZER:return"🚜";case ge.CARGADOR:return"🏗️";case ge.CAMION:return"🚛";case ge.GRUA:return"🏗️";case ge.MOTOSIERRA:return"🪚";case ge.TRACTOR:return"🚜";case ge.VOLQUETA:return"🚛";default:return"🚗"}},F=A=>{switch(A){case xt.DIESEL:return"🚛";case xt.GASOLINA:return"🚗";case xt.ACPM:return"🚚";case xt.MIXTO:return"⛽";default:return"⛽"}},X=o==="view",w=c==="admin"||c==="supervisor";return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content vehicle-modal",onClick:A=>A.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("div",{className:"modal-title",children:[r.jsx("span",{className:"title-icon",children:o==="create"?"➕":o==="edit"?"✏️":"👁️"}),r.jsxs("div",{className:"title-text",children:[r.jsxs("h3",{children:[o==="create"&&"Crear Nuevo Vehículo",o==="edit"&&"Editar Vehículo",o==="view"&&"Detalles del Vehículo"]}),r.jsxs("p",{children:[o==="create"&&"Registra un nuevo vehículo en la flota",o==="edit"&&"Modifica la información del vehículo",o==="view"&&"Información completa del vehículo"]})]})]}),r.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),r.jsxs("form",{onSubmit:O,className:"modal-form",children:[r.jsxs("div",{className:"form-content",children:[r.jsxs("div",{className:"vehicle-preview",children:[r.jsxs("div",{className:"preview-header",children:[r.jsx("span",{className:"preview-icon",children:U(f.type)}),r.jsxs("div",{className:"preview-info",children:[r.jsx("span",{className:"preview-id",children:f.vehicleId||"ID-000"}),r.jsx("span",{className:"preview-name",children:f.name||"Nombre del vehículo"})]}),r.jsxs("div",{className:"preview-fuel",children:[r.jsx("span",{className:"fuel-icon",children:F(f.fuelType)}),r.jsx("span",{className:"fuel-text",children:f.fuelType})]})]}),r.jsxs("div",{className:"preview-specs",children:[f.enginePower>0&&r.jsxs("span",{className:"spec",children:["⚡ ",f.enginePower," HP"]}),f.fuelCapacity>0&&r.jsxs("span",{className:"spec",children:["🛢️ ",f.fuelCapacity," gal"]}),f.year&&r.jsxs("span",{className:"spec",children:["📅 ",f.year]})]})]}),v.general&&r.jsxs("div",{className:"error-message general-error",children:["⚠️ ",v.general]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📋 Información Básica"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"vehicleId",children:"ID del Vehículo *"}),r.jsx("input",{type:"text",id:"vehicleId",name:"vehicleId",value:f.vehicleId,onChange:L,placeholder:"Ej: EXC-001",className:v.vehicleId?"error":"",disabled:X||o==="edit"&&!w,maxLength:20}),v.vehicleId&&r.jsx("span",{className:"error-text",children:v.vehicleId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Nombre del Vehículo *"}),r.jsx("input",{type:"text",id:"name",name:"name",value:f.name,onChange:L,placeholder:"Ej: Excavadora Principal",className:v.name?"error":"",disabled:X||o==="edit"&&!w,maxLength:100}),v.name&&r.jsx("span",{className:"error-text",children:v.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"type",children:"Tipo de Vehículo"}),M?r.jsxs("div",{className:"custom-type-input",children:[r.jsx("input",{type:"text",placeholder:"Ej: Montacargas, Grúa Torre, etc.",value:C,onChange:A=>b(A.target.value),onKeyDown:A=>{A.key==="Enter"?(A.preventDefault(),C.trim()&&(p(R=>({...R,type:C.trim()})),T(!1),b(""))):A.key==="Escape"&&(T(!1),b(""))},autoFocus:!0}),r.jsx("button",{type:"button",className:"btn-confirm-custom",onClick:()=>{C.trim()&&(p(A=>({...A,type:C.trim()})),T(!1),b(""))},title:"Confirmar tipo personalizado",children:"✓"}),r.jsx("button",{type:"button",className:"btn-cancel-custom",onClick:()=>{T(!1),b("")},title:"Cancelar",children:"✕"})]}):r.jsxs("div",{className:"select-with-button",children:[r.jsx("select",{id:"type",name:"type",value:f.type,onChange:L,disabled:X||o==="edit"&&!w,children:Object.entries(AL).map(([A,R])=>r.jsxs("option",{value:A,children:[R.icon," ",R.name]},A))}),r.jsx("button",{type:"button",className:"btn-add-custom",onClick:()=>T(!0),disabled:X||o==="edit"&&!w,title:"Agregar tipo personalizado",children:"➕"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsx("select",{id:"status",name:"status",value:f.status,onChange:L,disabled:X||o==="edit"&&!w,children:Object.values(Oe).map(A=>r.jsx("option",{value:A,children:A.charAt(0).toUpperCase()+A.slice(1)},A))})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔧 Especificaciones Técnicas"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"brand",children:"Marca"}),r.jsx("input",{type:"text",id:"brand",name:"brand",value:f.brand,onChange:L,placeholder:"Ej: Caterpillar",disabled:X||o==="edit"&&!w,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"model",children:"Modelo"}),r.jsx("input",{type:"text",id:"model",name:"model",value:f.model,onChange:L,placeholder:"Ej: 320D",disabled:X||o==="edit"&&!w,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"year",children:"Año"}),r.jsx("input",{type:"number",id:"year",name:"year",value:f.year,onChange:L,min:"1990",max:new Date().getFullYear()+1,className:v.year?"error":"",disabled:X||o==="edit"&&!w}),v.year&&r.jsx("span",{className:"error-text",children:v.year})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"serialNumber",children:"Número de Serie"}),r.jsx("input",{type:"text",id:"serialNumber",name:"serialNumber",value:f.serialNumber,onChange:L,placeholder:"Ej: ABC123456789",disabled:X||o==="edit"&&!w,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"plateNumber",children:"Placa"}),r.jsx("input",{type:"text",id:"plateNumber",name:"plateNumber",value:f.plateNumber,onChange:L,placeholder:"Ej: ABC123",disabled:X||o==="edit"&&!w,maxLength:10})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"enginePower",children:"Potencia del Motor (HP)"}),r.jsx("input",{type:"number",id:"enginePower",name:"enginePower",value:f.enginePower,onChange:L,min:"0",max:"1000",step:"0.1",className:v.enginePower?"error":"",disabled:X||o==="edit"&&!w}),v.enginePower&&r.jsx("span",{className:"error-text",children:v.enginePower})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"⛽ Información de Combustible"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"fuelType",children:"Tipo de Combustible"}),r.jsx("select",{id:"fuelType",name:"fuelType",value:f.fuelType,onChange:L,disabled:X||o==="edit"&&!w,children:Object.values(xt).map(A=>r.jsxs("option",{value:A,children:[F(A)," ",A.charAt(0).toUpperCase()+A.slice(1)]},A))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"fuelCapacity",children:"Capacidad de Combustible (gal) *"}),r.jsx("input",{type:"number",id:"fuelCapacity",name:"fuelCapacity",value:f.fuelCapacity,onChange:L,min:"0",max:"1000",step:"0.1",className:v.fuelCapacity?"error":"",disabled:X||o==="edit"&&!w}),v.fuelCapacity&&r.jsx("span",{className:"error-text",children:v.fuelCapacity})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedConsumptionPerHour",children:"Consumo Estimado (gal/hr)"}),r.jsx("input",{type:"number",id:"estimatedConsumptionPerHour",name:"estimatedConsumptionPerHour",value:f.estimatedConsumptionPerHour,onChange:L,min:"0",max:"50",step:"0.1",className:v.estimatedConsumptionPerHour?"error":"",disabled:X||o==="edit"&&!w}),v.estimatedConsumptionPerHour&&r.jsx("span",{className:"error-text",children:v.estimatedConsumptionPerHour})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"currentLocation",children:"Ubicación Actual"}),r.jsx("input",{type:"text",id:"currentLocation",name:"currentLocation",value:f.currentLocation,onChange:L,placeholder:"Ej: Sector Norte - Lote 15",disabled:X||o==="edit"&&!w,maxLength:100})]})]})]}),(f.type===ge.TRACTOR||f.hasHourMeter)&&r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"⏰ Sistema de Horómetro"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"hasHourMeter",children:[r.jsx("input",{type:"checkbox",id:"hasHourMeter",name:"hasHourMeter",checked:f.hasHourMeter,onChange:A=>p(R=>({...R,hasHourMeter:A.target.checked,...f.type===ge.TRACTOR?{hasHourMeter:!0}:{}})),disabled:X||o==="edit"&&!w||f.type===ge.TRACTOR})," ","Tiene Sistema de Horómetro",f.type===ge.TRACTOR&&r.jsx("span",{className:"auto-enabled",children:" (Automático para tractores)"})]}),r.jsx("small",{className:"field-help",children:"Los tractores TR1, TR2, TR3 requieren control de horómetro para reportes de consumo"})]}),f.hasHourMeter&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"currentHours",children:"Lectura Actual del Horómetro (horas)"}),r.jsx("input",{type:"number",id:"currentHours",name:"currentHours",value:f.currentHours,onChange:L,min:"0",max:"50000",step:"0.1",placeholder:"Ej: 1250.5",disabled:X||o==="edit"&&!w}),r.jsx("small",{className:"field-help",children:"Ingrese la lectura actual mostrada en el horómetro del vehículo"})]}),f.currentHours>0&&r.jsx("div",{className:"form-group",children:r.jsxs("div",{className:"hour-meter-info",children:[r.jsx("h5",{children:"📊 Información del Horómetro"}),r.jsxs("div",{className:"info-grid",children:[r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Lectura actual:"}),r.jsxs("span",{className:"info-value",children:[f.currentHours," horas"]})]}),o==="edit"&&t?.totalHoursWorked&&r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Horas trabajadas totales:"}),r.jsxs("span",{className:"info-value",children:[t.totalHoursWorked," horas"]})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Próximo mantenimiento:"}),r.jsxs("span",{className:"info-value",children:[250-f.currentHours%250," horas (",(f.currentHours+(250-f.currentHours%250)).toFixed(1),"h)"]})]})]})]})})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📅 Fechas Importantes"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"purchaseDate",children:"Fecha de Compra"}),r.jsx("input",{type:"date",id:"purchaseDate",name:"purchaseDate",value:f.purchaseDate,onChange:L,max:new Date().toISOString().split("T")[0],className:v.purchaseDate?"error":"",disabled:X||o==="edit"&&!w}),v.purchaseDate&&r.jsx("span",{className:"error-text",children:v.purchaseDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"warrantyExpiration",children:"Vencimiento de Garantía"}),r.jsx("input",{type:"date",id:"warrantyExpiration",name:"warrantyExpiration",value:f.warrantyExpiration,onChange:L,disabled:X||o==="edit"&&!w})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastMaintenanceDate",children:"Último Mantenimiento"}),r.jsx("input",{type:"date",id:"lastMaintenanceDate",name:"lastMaintenanceDate",value:f.lastMaintenanceDate,onChange:L,disabled:X||o==="edit"&&!w})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),r.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:f.nextMaintenanceDate,onChange:L,className:v.nextMaintenanceDate?"error":"",disabled:X||o==="edit"&&!w}),v.nextMaintenanceDate&&r.jsx("span",{className:"error-text",children:v.nextMaintenanceDate})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Descripción"}),r.jsx("textarea",{id:"description",name:"description",value:f.description,onChange:L,placeholder:"Información adicional sobre el vehículo...",rows:"3",maxLength:"500",disabled:X||o==="edit"&&!w}),r.jsxs("span",{className:"char-count",children:[f.description.length,"/500 caracteres"]})]})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:N,children:o==="view"?"Cerrar":"Cancelar"}),!X&&w&&r.jsx("button",{type:"submit",className:"btn-primary",disabled:N,children:N?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):r.jsx(r.Fragment,{children:o==="create"?"➕ Crear Vehículo":"💾 Guardar Cambios"})})]})]})]})}):null},Oo={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},fi={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},Mo={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},CL=({isOpen:n,onClose:e,vehicle:t,maintenance:a,onSave:o,mode:c="create",userRole:d})=>{const f=()=>({vehicleId:t?.vehicleId||"",vehicleName:t?.name||"",type:a?.type||Oo.PREVENTIVO,title:a?.title||"",description:a?.description||"",priority:a?.priority||Mo.MEDIA,status:a?.status||fi.PROGRAMADO,scheduledDate:a?.scheduledDate?new Date(a.scheduledDate).toISOString().split("T")[0]:"",startDate:a?.startDate?new Date(a.startDate).toISOString().split("T")[0]:"",completedDate:a?.completedDate?new Date(a.completedDate).toISOString().split("T")[0]:"",estimatedHours:a?.estimatedHours||0,actualHours:a?.actualHours||0,estimatedCost:a?.estimatedCost||0,actualCost:a?.actualCost||0,technician:a?.technician||"",workshop:a?.workshop||"",parts:a?.parts||[],notes:a?.notes||"",nextMaintenanceKm:a?.nextMaintenanceKm||0,nextMaintenanceHours:a?.nextMaintenanceHours||0,nextMaintenanceDate:a?.nextMaintenanceDate?new Date(a.nextMaintenanceDate).toISOString().split("T")[0]:""}),[p,v]=Y.useState(f()),[_,N]=Y.useState({}),[j,C]=Y.useState(!1),[b,M]=Y.useState({name:"",quantity:1,cost:0});Y.useEffect(()=>{n&&(v(f()),N({}))},[n,a,t]);const T=V=>{const{name:k,value:ke,type:ae}=V.target,H=ae==="number"?parseFloat(ke)||0:ke;v(J=>({...J,[k]:H})),_[k]&&N(J=>({...J,[k]:null}))},L=V=>{const{name:k,value:ke,type:ae}=V.target,H=ae==="number"?parseFloat(ke)||0:ke;M(J=>({...J,[k]:H}))},$=()=>{if(!b.name.trim())return;const V={id:Date.now().toString(),name:b.name.trim(),quantity:b.quantity,cost:b.cost,total:b.quantity*b.cost};v(k=>({...k,parts:[...k.parts,V]})),M({name:"",quantity:1,cost:0})},O=V=>{v(k=>({...k,parts:k.parts.filter(ke=>ke.id!==V)}))},U=()=>{const V={};if(p.title.trim()||(V.title="El título del mantenimiento es obligatorio"),p.description.trim()||(V.description="La descripción es obligatoria"),p.scheduledDate||(V.scheduledDate="La fecha programada es obligatoria"),p.startDate&&p.completedDate){const k=new Date(p.startDate);new Date(p.completedDate)<k&&(V.completedDate="La fecha de finalización debe ser posterior al inicio")}return p.scheduledDate&&p.startDate&&(new Date(p.scheduledDate),new Date(p.startDate)),p.estimatedHours<0&&(V.estimatedHours="Las horas estimadas no pueden ser negativas"),p.actualHours<0&&(V.actualHours="Las horas reales no pueden ser negativas"),p.estimatedCost<0&&(V.estimatedCost="El costo estimado no puede ser negativo"),p.actualCost<0&&(V.actualCost="El costo real no puede ser negativo"),p.status===fi.COMPLETADO&&!p.completedDate&&(V.completedDate="La fecha de finalización es obligatoria para mantenimientos completados"),p.status===fi.EN_PROCESO&&!p.startDate&&(V.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),N(V),Object.keys(V).length===0},F=async V=>{if(V.preventDefault(),!!U()){C(!0);try{const k=p.parts.reduce((J,ce)=>J+ce.total,0),ke=p.estimatedCost+k,ae=p.actualCost+k,H={...p,vehicleId:t.id,vehicleName:t.name,totalPartsCost:k,totalEstimatedCost:ke,totalActualCost:ae,scheduledDate:p.scheduledDate||null,startDate:p.startDate||null,completedDate:p.completedDate||null,nextMaintenanceDate:p.nextMaintenanceDate||null,createdAt:a?.createdAt||new Date,updatedAt:new Date};await o(H),e()}catch(k){console.error("Error guardando mantenimiento:",k),N({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{C(!1)}}},X=V=>{switch(V){case Oo.PREVENTIVO:return"🔧";case Oo.CORRECTIVO:return"🛠️";case Oo.PREDICTIVO:return"📊";case Oo.EMERGENCIA:return"🚨";default:return"⚙️"}},w=V=>{switch(V){case Mo.BAJA:return"priority-low";case Mo.MEDIA:return"priority-medium";case Mo.ALTA:return"priority-high";case Mo.CRITICA:return"priority-critical";default:return"priority-medium"}},A=V=>{switch(V){case fi.PROGRAMADO:return"status-scheduled";case fi.EN_PROCESO:return"status-in-progress";case fi.COMPLETADO:return"status-completed";case fi.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},R=()=>p.parts.reduce((V,k)=>V+k.total,0),I=c==="view",P=d==="admin"||d==="supervisor";return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content maintenance-modal",onClick:V=>V.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("div",{className:"modal-title",children:[r.jsx("span",{className:"title-icon",children:c==="create"?"➕":c==="edit"?"✏️":"👁️"}),r.jsxs("div",{className:"title-text",children:[r.jsxs("h3",{children:[c==="create"&&"Registrar Mantenimiento",c==="edit"&&"Editar Mantenimiento",c==="view"&&"Detalles del Mantenimiento"]}),r.jsxs("p",{children:["Vehículo: ",t?.vehicleId," - ",t?.name]})]})]}),r.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),r.jsxs("form",{onSubmit:F,className:"modal-form",children:[r.jsxs("div",{className:"form-content",children:[_.general&&r.jsxs("div",{className:"error-message general-error",children:["⚠️ ",_.general]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📋 Información del Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),r.jsx("select",{id:"type",name:"type",value:p.type,onChange:T,disabled:I||c==="edit"&&!P,children:Object.values(Oo).map(V=>r.jsxs("option",{value:V,children:[X(V)," ",V.charAt(0).toUpperCase()+V.slice(1)]},V))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"priority",children:"Prioridad"}),r.jsx("select",{id:"priority",name:"priority",value:p.priority,onChange:T,className:w(p.priority),disabled:I||c==="edit"&&!P,children:Object.values(Mo).map(V=>r.jsx("option",{value:V,children:V.charAt(0).toUpperCase()+V.slice(1)},V))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsx("select",{id:"status",name:"status",value:p.status,onChange:T,className:A(p.status),disabled:I||c==="edit"&&!P,children:Object.values(fi).map(V=>r.jsx("option",{value:V,children:V.charAt(0).toUpperCase()+V.slice(1).replace("_"," ")},V))})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"title",children:"Título del Mantenimiento *"}),r.jsx("input",{type:"text",id:"title",name:"title",value:p.title,onChange:T,placeholder:"Ej: Cambio de aceite y filtros",className:_.title?"error":"",disabled:I||c==="edit"&&!P,maxLength:100}),_.title&&r.jsx("span",{className:"error-text",children:_.title})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📅 Programación"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),r.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:p.scheduledDate,onChange:T,className:_.scheduledDate?"error":"",disabled:I||c==="edit"&&!P}),_.scheduledDate&&r.jsx("span",{className:"error-text",children:_.scheduledDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),r.jsx("input",{type:"date",id:"startDate",name:"startDate",value:p.startDate,onChange:T,className:_.startDate?"error":"",disabled:I||c==="edit"&&!P}),_.startDate&&r.jsx("span",{className:"error-text",children:_.startDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalización"}),r.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:p.completedDate,onChange:T,className:_.completedDate?"error":"",disabled:I||c==="edit"&&!P}),_.completedDate&&r.jsx("span",{className:"error-text",children:_.completedDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),r.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:p.nextMaintenanceDate,onChange:T,disabled:I||c==="edit"&&!P})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"💰 Recursos y Costos"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"technician",children:"Técnico Responsable"}),r.jsx("input",{type:"text",id:"technician",name:"technician",value:p.technician,onChange:T,placeholder:"Nombre del técnico",disabled:I||c==="edit"&&!P,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicación"}),r.jsx("input",{type:"text",id:"workshop",name:"workshop",value:p.workshop,onChange:T,placeholder:"Taller donde se realiza",disabled:I||c==="edit"&&!P,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),r.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:p.estimatedHours,onChange:T,min:"0",step:"0.5",className:_.estimatedHours?"error":"",disabled:I||c==="edit"&&!P}),_.estimatedHours&&r.jsx("span",{className:"error-text",children:_.estimatedHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),r.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:p.actualHours,onChange:T,min:"0",step:"0.5",className:_.actualHours?"error":"",disabled:I||c==="edit"&&!P}),_.actualHours&&r.jsx("span",{className:"error-text",children:_.actualHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),r.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:p.estimatedCost,onChange:T,min:"0",step:"1000",className:_.estimatedCost?"error":"",disabled:I||c==="edit"&&!P}),_.estimatedCost&&r.jsx("span",{className:"error-text",children:_.estimatedCost})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),r.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:p.actualCost,onChange:T,min:"0",step:"1000",className:_.actualCost?"error":"",disabled:I||c==="edit"&&!P}),_.actualCost&&r.jsx("span",{className:"error-text",children:_.actualCost})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔧 Partes y Repuestos"}),!I&&P&&r.jsx("div",{className:"parts-form",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),r.jsx("input",{type:"text",id:"partName",name:"name",value:b.name,onChange:L,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),r.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:b.quantity,onChange:L,min:"1",step:"1"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),r.jsx("input",{type:"number",id:"partCost",name:"cost",value:b.cost,onChange:L,min:"0",step:"1000"})]}),r.jsx("div",{className:"form-group",children:r.jsx("button",{type:"button",className:"btn-add-part",onClick:$,disabled:!b.name.trim(),children:"➕ Agregar"})})]})}),p.parts.length>0&&r.jsx("div",{className:"parts-list",children:r.jsxs("table",{className:"parts-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Parte"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo Unit."}),r.jsx("th",{children:"Total"}),!I&&P&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:p.parts.map(V=>r.jsxs("tr",{children:[r.jsx("td",{children:V.name}),r.jsx("td",{children:V.quantity}),r.jsxs("td",{children:["$",V.cost.toLocaleString("es-CO")]}),r.jsxs("td",{children:["$",V.total.toLocaleString("es-CO")]}),!I&&P&&r.jsx("td",{children:r.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>O(V.id),title:"Eliminar parte",children:"🗑️"})})]},V.id))}),r.jsx("tfoot",{children:r.jsxs("tr",{className:"total-row",children:[r.jsx("td",{colSpan:"3",children:r.jsx("strong",{children:"Total Partes:"})}),r.jsx("td",{children:r.jsxs("strong",{children:["$",R().toLocaleString("es-CO")]})}),!I&&P&&r.jsx("td",{})]})})]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔄 Próximo Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Próximo Mantenimiento (Km)"}),r.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:p.nextMaintenanceKm,onChange:T,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:I||c==="edit"&&!P})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Próximo Mantenimiento (Horas)"}),r.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:p.nextMaintenanceHours,onChange:T,min:"0",step:"100",placeholder:"0 = No aplica",disabled:I||c==="edit"&&!P})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Descripción del Trabajo *"}),r.jsx("textarea",{id:"description",name:"description",value:p.description,onChange:T,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:_.description?"error":"",disabled:I||c==="edit"&&!P}),_.description&&r.jsx("span",{className:"error-text",children:_.description})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),r.jsx("textarea",{id:"notes",name:"notes",value:p.notes,onChange:T,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:I||c==="edit"&&!P}),r.jsxs("span",{className:"char-count",children:[p.notes.length,"/500 caracteres"]})]})]}),r.jsxs("div",{className:"cost-summary",children:[r.jsx("h4",{children:"💰 Resumen de Costos"}),r.jsxs("div",{className:"cost-grid",children:[r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),r.jsxs("span",{className:"cost-value",children:["$",p.actualCost.toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Partes:"}),r.jsxs("span",{className:"cost-value",children:["$",R().toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item total-cost",children:[r.jsx("span",{className:"cost-label",children:"Total:"}),r.jsxs("span",{className:"cost-value",children:["$",(p.actualCost+R()).toLocaleString("es-CO")]})]})]})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:j,children:c==="view"?"Cerrar":"Cancelar"}),!I&&P&&r.jsx("button",{type:"submit",className:"btn-primary",disabled:j,children:j?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):r.jsx(r.Fragment,{children:c==="create"?"➕ Registrar Mantenimiento":"💾 Guardar Cambios"})})]})]})]})}):null},SL=()=>{const{user:n,userProfile:e}=Zs(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[j,C]=Y.useState("cards"),[b,M]=Y.useState(""),[T,L]=Y.useState(!1),[$,O]=Y.useState(!1),[U,F]=Y.useState(null),[X,w]=Y.useState("create");Y.useEffect(()=>{if(!n)return;f(!0);const ve=mj((B,ne)=>{if(ne){console.error("Error en suscripción de vehículos:",ne),v("Error al cargar vehículos"),f(!1);return}a(B),v(null),f(!1)},_);return()=>ve()},[n,_]),Y.useEffect(()=>{n&&(async()=>{try{const B=await Y2(_);c(B)}catch(B){console.error("Error al cargar estadísticas:",B)}})()},[n,t,_]);const A=t.filter(ve=>{if(!b)return!0;const B=b.toLowerCase();return ve.vehicleId?.toLowerCase().includes(B)||ve.name?.toLowerCase().includes(B)||ve.type?.toLowerCase().includes(B)||ve.brand?.toLowerCase().includes(B)||ve.model?.toLowerCase().includes(B)||ve.currentLocation?.toLowerCase().includes(B)||ve.description?.toLowerCase().includes(B)}),R=()=>{F(null),w("create"),L(!0)},I=ve=>{F(ve),w("edit"),L(!0)},P=ve=>{F(ve),w("view"),L(!0)},V=ve=>{F(ve),O(!0)},k=()=>{L(!1),O(!1),F(null)},ke=ve=>{N(B=>({...B,...ve}))},ae=()=>{N({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),M("")},H=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",J=e?.role==="admin",ce=e?.role==="admin"||e?.role==="contador";return d?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando vehículos..."})]})}):p?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:"⚠️"}),r.jsx("h3",{children:"Error al cargar vehículos"}),r.jsx("p",{children:p}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"vehicles-main",children:[r.jsxs("div",{className:"vehicles-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🚜 Gestión de Vehículos"}),r.jsx("p",{children:"Administra la maquinaria y vehículos forestales"})]}),H&&r.jsx("button",{className:"btn-create-vehicle",onClick:R,children:"➕ Nuevo Vehículo"})]}),o&&r.jsx(EL,{stats:o,filters:_}),r.jsx(bL,{filters:_,onFilterChange:ke,onClearFilters:ae,searchTerm:b,onSearchChange:M,viewMode:j,onViewModeChange:C,totalResults:A.length}),A.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"🚜"}),r.jsx("h3",{children:t.length===0?"No hay vehículos registrados":"No se encontraron vehículos"}),r.jsx("p",{children:t.length===0?"Comienza registrando tu primer vehículo o maquinaria forestal":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&H&&r.jsx("button",{className:"btn-create-first",onClick:R,children:"➕ Registrar Primer Vehículo"})]}):r.jsx(TL,{vehicles:A,viewMode:j,onEdit:J?I:null,onView:P,onMaintenance:ce?V:null,userRole:n?.role}),T&&r.jsx(jL,{isOpen:T,onClose:k,vehicle:U,mode:X,onSuccess:()=>{k()}}),$&&r.jsx(CL,{isOpen:$,onClose:k,vehicle:U,onSuccess:()=>{k()}})]})},wL="modulepreload",IL=function(n){return"/combustibles/"+n},jx={},RL=function(e,t,a){let o=Promise.resolve();if(t&&t.length>0){let v=function(_){return Promise.all(_.map(N=>Promise.resolve(N).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};var d=v;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");o=v(t.map(_=>{if(_=IL(_),_ in jx)return;jx[_]=!0;const N=_.endsWith(".css"),j=N?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${j}`))return;const C=document.createElement("link");if(C.rel=N?"stylesheet":wL,N||(C.as="script"),C.crossOrigin="",C.href=_,p&&C.setAttribute("nonce",p),document.head.appendChild(C),N)return new Promise((b,M)=>{C.addEventListener("load",b),C.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${_}`)))})}))}function c(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return o.then(f=>{for(const p of f||[])p.status==="rejected"&&c(p.reason);return e().catch(c)})},DL=({stats:n})=>{if(!n)return null;const e=c=>{switch(c){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},t=c=>{switch(c){case fe.OIL_CHANGE:return"Cambios de Aceite";case fe.BATTERY_CHANGE:return"Cambios de Batería";case fe.FILTER_CHANGE:return"Cambios de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimientos Generales";default:return c}},a=c=>{switch(c){case Me.COMPLETED:return"#10b981";case Me.PENDING:return"#f59e0b";case Me.CANCELLED:return"#ef4444";default:return"#6b7280"}},o=c=>{switch(c){case Me.COMPLETED:return"Completados";case Me.PENDING:return"Pendientes";case Me.CANCELLED:return"Cancelados";default:return c}};return r.jsxs("div",{className:"maintenance-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"🔧"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:ze(n.total)}),r.jsx("p",{children:"Total Mantenimientos"})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:Mn(n.totalCost)}),r.jsx("p",{children:"Costo Total"})]})]}),r.jsxs("div",{className:"stat-card warning",children:[r.jsx("div",{className:"stat-icon",children:"⏰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:ze(n.upcomingCount)}),r.jsx("p",{children:"Próximos"})]})]}),r.jsxs("div",{className:"stat-card danger",children:[r.jsx("div",{className:"stat-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:ze(n.overdueCount)}),r.jsx("p",{children:"Vencidos"})]})]})]}),Object.keys(n.byType).length>0&&r.jsxs("div",{className:"stats-breakdown",children:[r.jsx("h3",{children:"📊 Desglose por Tipo"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([c,d])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:e(c)}),r.jsx("span",{className:"breakdown-label",children:t(c)})]}),r.jsx("div",{className:"breakdown-value",children:ze(d)}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:"#3b82f6"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),Object.keys(n.byStatus).length>0&&r.jsxs("div",{className:"stats-breakdown",children:[r.jsx("h3",{children:"📈 Desglose por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([c,d])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a(c)}}),r.jsx("span",{className:"breakdown-label",children:o(c)})]}),r.jsx("div",{className:"breakdown-value",children:ze(d)}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:a(c)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),r.jsxs("div",{className:"stats-insights",children:[r.jsx("h3",{children:"💡 Insights"}),r.jsxs("div",{className:"insights-grid",children:[r.jsxs("div",{className:"insight-item",children:[r.jsx("span",{className:"insight-label",children:"Costo Promedio:"}),r.jsx("span",{className:"insight-value",children:Mn(n.averageCost)})]}),n.overdueCount>0&&r.jsxs("div",{className:"insight-item alert",children:[r.jsx("span",{className:"insight-label",children:"⚠️ Mantenimientos Vencidos:"}),r.jsxs("span",{className:"insight-value",children:[ze(n.overdueCount)," requieren atención"]})]}),n.upcomingCount>0&&r.jsxs("div",{className:"insight-item info",children:[r.jsx("span",{className:"insight-label",children:"⏰ Próximos Mantenimientos:"}),r.jsxs("span",{className:"insight-value",children:[ze(n.upcomingCount)," programados"]})]})]})]})]})},OL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const p=C=>{switch(C){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batería";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return C}},v=C=>{switch(C){case Me.COMPLETED:return"Completado";case Me.PENDING:return"Pendiente";case Me.CANCELLED:return"Cancelado";default:return C}},_=(C,b)=>{e({[C]:b})},N=C=>{e(C)},j=()=>Object.values(n).some(C=>C!=="")||a;return r.jsx("div",{className:"maintenance-filters",children:r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar mantenimientos...",value:a,onChange:C=>o(C.target.value)}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),children:"×"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${j()?"":"active"}`,onClick:()=>t(),children:"Todos"}),r.jsx("button",{className:`quick-filter ${n.type===fe.OIL_CHANGE?"active":""}`,onClick:()=>N({type:fe.OIL_CHANGE}),children:"🛢️ Aceite"}),r.jsx("button",{className:`quick-filter ${n.type===fe.BATTERY_CHANGE?"active":""}`,onClick:()=>N({type:fe.BATTERY_CHANGE}),children:"🔋 Baterías"}),r.jsx("button",{className:`quick-filter ${n.status===Me.PENDING?"active":""}`,onClick:()=>N({status:Me.PENDING}),children:"⏰ Pendientes"})]}),r.jsxs("button",{className:`btn-advanced-filters ${j()?"active":""}`,onClick:()=>document.querySelector(".filters-advanced").classList.toggle("show"),children:["🔧 Filtros Avanzados",j()&&r.jsx("span",{className:"filters-count",children:Object.values(n).filter(C=>C!=="").length})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),children:"📋 Cards"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),children:"📊 Tabla"})]})]}),r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Mantenimiento"}),r.jsxs("select",{value:n.type,onChange:C=>_("type",C.target.value),children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:fe.OIL_CHANGE,children:p(fe.OIL_CHANGE)}),r.jsx("option",{value:fe.BATTERY_CHANGE,children:p(fe.BATTERY_CHANGE)}),r.jsx("option",{value:fe.FILTER_CHANGE,children:p(fe.FILTER_CHANGE)}),r.jsx("option",{value:fe.GENERAL_MAINTENANCE,children:p(fe.GENERAL_MAINTENANCE)})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:C=>_("status",C.target.value),children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:Me.COMPLETED,children:v(Me.COMPLETED)}),r.jsx("option",{value:Me.PENDING,children:v(Me.PENDING)}),r.jsx("option",{value:Me.CANCELLED,children:v(Me.CANCELLED)})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Fecha Desde"}),r.jsx("input",{type:"date",value:n.dateFrom,onChange:C=>_("dateFrom",C.target.value)})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Fecha Hasta"}),r.jsx("input",{type:"date",value:n.dateTo,onChange:C=>_("dateTo",C.target.value)})]})]}),r.jsx("div",{className:"filters-actions",children:r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:!j(),children:"🗑️ Limpiar Filtros"})})]}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("div",{className:"results-count",children:[f," mantenimiento",f!==1?"s":""," encontrado",f!==1?"s":""]}),j()&&r.jsxs("div",{className:"active-filters",children:[r.jsx("span",{className:"filters-label",children:"Filtros activos:"}),r.jsxs("div",{className:"filter-tags",children:[n.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",p(n.type),r.jsx("button",{onClick:()=>_("type",""),children:"×"})]}),n.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",v(n.status),r.jsx("button",{onClick:()=>_("status",""),children:"×"})]}),n.dateFrom&&r.jsxs("span",{className:"filter-tag",children:["Desde: ",n.dateFrom,r.jsx("button",{onClick:()=>_("dateFrom",""),children:"×"})]}),n.dateTo&&r.jsxs("span",{className:"filter-tag",children:["Hasta: ",n.dateTo,r.jsx("button",{onClick:()=>_("dateTo",""),children:"×"})]}),a&&r.jsxs("span",{className:"filter-tag",children:['Búsqueda: "',a,'"',r.jsx("button",{onClick:()=>o(""),children:"×"})]})]})]})]})]})})},ML=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const c=b=>b?new Date(b).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"N/A",d=b=>{if(!b)return"";const M=new Date,T=new Date(b),L=Math.abs(M-T),$=Math.ceil(L/(1e3*60*60*24));return $===0?"Hoy":$===1?"Ayer":$<7?`Hace ${$} días`:$<30?`Hace ${Math.floor($/7)} semanas`:`Hace ${Math.floor($/30)} meses`},f=b=>{switch(b){case fe.OIL_CHANGE:return"maintenance-oil-change";case fe.BATTERY_CHANGE:return"maintenance-battery-change";case fe.FILTER_CHANGE:return"maintenance-filter-change";case fe.GENERAL_MAINTENANCE:return"maintenance-general";default:return"maintenance-general"}},p=b=>{switch(b){case Me.COMPLETED:return"status-completado";case Me.PENDING:return"status-pendiente";case Me.CANCELLED:return"status-cancelado";default:return"status-unknown"}},v=b=>{switch(b){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},_=b=>{switch(b){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batería";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return b}},N=b=>{switch(b){case Me.COMPLETED:return"✅";case Me.PENDING:return"⏰";case Me.CANCELLED:return"❌";default:return"❓"}},j=b=>{switch(b){case Me.COMPLETED:return"Completado";case Me.PENDING:return"Pendiente";case Me.CANCELLED:return"Cancelado";default:return b}},C=o==="admin"||o==="supervisor";return r.jsx("div",{className:"maintenance-cards",children:n.map(b=>r.jsxs("div",{className:`maintenance-card ${f(b.type)}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"maintenance-type",children:[r.jsx("span",{className:"type-icon",children:v(b.type)}),r.jsx("span",{className:"type-label",children:_(b.type)})]}),r.jsxs("div",{className:`status-badge ${p(b.status)}`,children:[N(b.status)," ",j(b.status)]})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"vehicle-info",children:[r.jsx("span",{className:"vehicle-icon",children:"🚜"}),r.jsxs("div",{className:"vehicle-details",children:[r.jsx("div",{className:"vehicle-name",children:b.vehicleName}),r.jsx("div",{className:"vehicle-id",children:b.vehicleId})]})]}),r.jsxs("div",{className:"date-info",children:[r.jsx("div",{className:"created-date",children:c(b.date)}),r.jsx("div",{className:"relative-time",children:d(b.date)})]}),b.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"oil-change-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Cantidad:"}),r.jsxs("span",{className:"info-value",children:[ze(b.quantity)," galones"]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Horómetro:"}),r.jsxs("span",{className:"info-value",children:[ze(b.currentHours)," horas"]})]}),b.nextChangeHours&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Próximo cambio:"}),r.jsxs("span",{className:"info-value",children:[ze(b.nextChangeHours)," horas"]})]}),b.filters&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Filtros:"}),r.jsx("span",{className:"info-value",children:b.filters})]})]}),b.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"battery-change-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Tipo:"}),r.jsx("span",{className:"info-value",children:b.batteryType})]}),b.brand&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Marca:"}),r.jsx("span",{className:"info-value",children:b.brand})]}),b.model&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Modelo:"}),r.jsx("span",{className:"info-value",children:b.model})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Estado:"}),r.jsx("span",{className:"info-value",children:b.batteryStatus})]}),b.cost&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Costo:"}),r.jsx("span",{className:"info-value",children:Mn(b.cost)})]})]}),b.notes&&r.jsxs("div",{className:"notes-section",children:[r.jsx("span",{className:"notes-label",children:"Notas:"}),r.jsx("p",{className:"notes-text",children:b.notes})]})]}),r.jsx("div",{className:"card-footer",children:r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(b),title:"Ver detalles",children:"👁️ Ver"}),C&&e&&r.jsx("button",{className:"btn-edit",onClick:()=>e(b),title:"Editar",children:"✏️ Editar"}),C&&a&&r.jsx("button",{className:"btn-delete",onClick:()=>a(b.id),title:"Eliminar",children:"🗑️ Eliminar"})]})})]},b.id))})},PL=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const[c,d]=Y.useState("date"),[f,p]=Y.useState("desc"),v=O=>O?new Date(O).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",_=O=>{switch(O){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},N=O=>{switch(O){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batería";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return O}},j=O=>{switch(O){case Me.COMPLETED:return"✅";case Me.PENDING:return"⏰";case Me.CANCELLED:return"❌";default:return"❓"}},C=O=>{switch(O){case Me.COMPLETED:return"Completado";case Me.PENDING:return"Pendiente";case Me.CANCELLED:return"Cancelado";default:return O}},b=O=>{switch(O){case Me.COMPLETED:return"status-completado";case Me.PENDING:return"status-pendiente";case Me.CANCELLED:return"status-cancelado";default:return"status-unknown"}},M=O=>{c===O?p(f==="asc"?"desc":"asc"):(d(O),p("asc"))},T=O=>c!==O?"↕️":f==="asc"?"↑":"↓",L=[...n].sort((O,U)=>{let F=O[c],X=U[c];return c==="date"&&(F=new Date(F),X=new Date(X)),["quantity","currentHours","nextChangeHours","cost"].includes(c)&&(F=parseFloat(F)||0,X=parseFloat(X)||0),typeof F=="string"&&(F=F.toLowerCase(),X=X.toLowerCase()),f==="asc"?F>X?1:-1:F<X?1:-1}),$=o==="admin"||o==="supervisor";return r.jsxs("div",{className:"maintenance-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"maintenance-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>M("type"),children:["Tipo ",T("type")]}),r.jsxs("th",{className:"sortable",onClick:()=>M("vehicleName"),children:["Vehículo ",T("vehicleName")]}),r.jsxs("th",{className:"sortable",onClick:()=>M("date"),children:["Fecha ",T("date")]}),r.jsx("th",{children:"Detalles"}),r.jsxs("th",{className:"sortable",onClick:()=>M("status"),children:["Estado ",T("status")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>M("cost"),children:["Costo ",T("cost")]}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:L.map(O=>r.jsxs("tr",{className:"maintenance-row",children:[r.jsx("td",{className:"type-cell",children:r.jsxs("div",{className:"type-content",children:[r.jsx("span",{className:"type-icon",children:_(O.type)}),r.jsx("span",{className:"type-name",children:N(O.type)})]})}),r.jsx("td",{className:"vehicle-cell",children:r.jsxs("div",{className:"vehicle-info",children:[r.jsx("div",{className:"vehicle-name",children:O.vehicleName}),r.jsx("div",{className:"vehicle-id",children:O.vehicleId})]})}),r.jsx("td",{className:"date-cell",children:r.jsx("div",{className:"date-content",children:r.jsx("div",{className:"date-value",children:v(O.date)})})}),r.jsxs("td",{className:"details-cell",children:[O.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"oil-details",children:[r.jsxs("div",{children:["Qty: ",ze(O.quantity)," gal"]}),r.jsxs("div",{children:["Hrs: ",ze(O.currentHours)]}),O.filters&&r.jsxs("div",{children:["Filtros: ",O.filters]})]}),O.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"battery-details",children:[r.jsx("div",{children:O.batteryType}),O.brand&&r.jsx("div",{children:O.brand}),r.jsxs("div",{children:["Estado: ",O.batteryStatus]})]}),O.notes&&r.jsx("div",{className:"notes-small",children:O.notes})]}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${b(O.status)}`,children:[j(O.status)," ",C(O.status)]})}),r.jsx("td",{className:"cost-cell text-right",children:O.cost?Mn(O.cost):"N/A"}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(O),title:"Ver detalles",children:"👁️"}),$&&e&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(O),title:"Editar",children:"✏️"}),$&&a&&r.jsx("button",{className:"btn-action btn-delete",onClick:()=>a(O.id),title:"Eliminar",children:"🗑️"})]})})]},O.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsx("div",{className:"table-summary",children:r.jsxs("span",{className:"total-rows",children:[n.length," mantenimiento",n.length!==1?"s":""," en total"]})}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot oil-change"}),r.jsx("span",{children:"Cambio de Aceite"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot battery-change"}),r.jsx("span",{children:"Cambio de Batería"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot filter-change"}),r.jsx("span",{children:"Cambio de Filtros"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot general"}),r.jsx("span",{children:"Mantenimiento General"})]})]})]})]})},kL=({maintenanceRecords:n,viewMode:e,onEdit:t,onView:a,onDelete:o,userRole:c})=>!n||n.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"🔧"}),r.jsx("h3",{children:"No hay mantenimientos registrados"}),r.jsx("p",{children:"Comienza creando el primer mantenimiento para tu flota de vehículos."})]}):r.jsx("div",{className:"maintenance-list",children:e==="cards"?r.jsx(ML,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c}):r.jsx(PL,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c})}),LL=({isOpen:n,onClose:e,onSuccess:t,maintenance:a,mode:o="create",userRole:c})=>{const d=()=>({type:a?.type||fe.OIL_CHANGE,vehicleId:a?.vehicleId||"",vehicleName:a?.vehicleName||"",date:a?.date?new Date(a.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:a?.status||Me.COMPLETED,quantity:a?.quantity||0,currentHours:a?.currentHours||0,nextChangeHours:a?.nextChangeHours||0,filters:a?.filters||"",batteryType:a?.batteryType||"",brand:a?.brand||"",model:a?.model||"",batteryStatus:a?.batteryStatus||Bo.NEW,notes:a?.notes||"",cost:a?.cost||0}),[f,p]=Y.useState(d()),[v,_]=Y.useState({}),[N,j]=Y.useState(!1),[C,b]=Y.useState([]),[M,T]=Y.useState(null);Y.useEffect(()=>{n&&(async()=>{try{const A=await Nj();b(A)}catch(A){console.error("Error al cargar vehículos:",A)}})()},[n]),Y.useEffect(()=>{if(n&&(p(d()),_({}),a?.vehicleId)){const w=C.find(A=>A.vehicleId===a.vehicleId);T(w)}},[n,a,C]),Y.useEffect(()=>{if(f.type===fe.OIL_CHANGE&&f.currentHours>0){const w=pf(f.currentHours);p(A=>({...A,nextChangeHours:w}))}},[f.currentHours,f.type]);const L=(w,A)=>{const R=typeof A=="number"?parseFloat(A)||0:A;p(I=>({...I,[w]:R})),v[w]&&_(I=>({...I,[w]:null}))},$=w=>{const A=C.find(R=>R.vehicleId===w);T(A),p(R=>({...R,vehicleId:w,vehicleName:A?A.name:""})),A&&A.hasHourMeter&&A.currentHours&&p(R=>({...R,currentHours:A.currentHours}))},O=()=>{const w={};return f.type||(w.type="El tipo de mantenimiento es obligatorio"),f.vehicleId||(w.vehicleId="El vehículo es obligatorio"),f.date||(w.date="La fecha es obligatoria"),f.type===fe.OIL_CHANGE&&((!f.quantity||f.quantity<=0)&&(w.quantity="La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!f.currentHours||f.currentHours<0)&&(w.currentHours="La lectura del horómetro es obligatoria")),f.type===fe.BATTERY_CHANGE&&(f.batteryType||(w.batteryType="El tipo de batería es obligatorio"),(!f.cost||f.cost<=0)&&(w.cost="El costo de la batería es obligatorio")),_(w),Object.keys(w).length===0},U=async w=>{if(w.preventDefault(),!!O()){j(!0);try{const A={...f,date:new Date(f.date),createdBy:c||"user"};o==="create"?(await yj(A),console.log("✅ Mantenimiento creado exitosamente")):o==="edit"&&(await Ej(a.id,A),console.log("✅ Mantenimiento actualizado exitosamente")),t()}catch(A){console.error("❌ Error al guardar mantenimiento:",A),alert("Error al guardar mantenimiento: "+A.message)}finally{j(!1)}}},F=()=>{switch(o){case"create":return"Crear Mantenimiento";case"edit":return"Editar Mantenimiento";case"view":return"Ver Mantenimiento";default:return"Mantenimiento"}},X=w=>{switch(w){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}};return n?r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content maintenance-modal",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:F()}),r.jsx("button",{className:"modal-close",onClick:e,children:"×"})]}),r.jsx("div",{className:"modal-body",children:r.jsxs("form",{onSubmit:U,className:"maintenance-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Mantenimiento *"}),r.jsxs("select",{value:f.type,onChange:w=>L("type",w.target.value),disabled:o==="view",children:[r.jsxs("option",{value:fe.OIL_CHANGE,children:[X(fe.OIL_CHANGE)," Cambio de Aceite"]}),r.jsxs("option",{value:fe.BATTERY_CHANGE,children:[X(fe.BATTERY_CHANGE)," Cambio de Batería"]}),r.jsxs("option",{value:fe.FILTER_CHANGE,children:[X(fe.FILTER_CHANGE)," Cambio de Filtros"]}),r.jsxs("option",{value:fe.GENERAL_MAINTENANCE,children:[X(fe.GENERAL_MAINTENANCE)," Mantenimiento General"]})]}),v.type&&r.jsx("span",{className:"error-text",children:v.type})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Vehículo *"}),r.jsxs("select",{value:f.vehicleId,onChange:w=>$(w.target.value),disabled:o==="view",children:[r.jsx("option",{value:"",children:"Seleccionar vehículo"}),C.map(w=>r.jsxs("option",{value:w.vehicleId,children:[w.vehicleId," - ",w.name," (",w.type,")"]},w.vehicleId))]}),v.vehicleId&&r.jsx("span",{className:"error-text",children:v.vehicleId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Fecha *"}),r.jsx("input",{type:"date",value:f.date,onChange:w=>L("date",w.target.value),disabled:o==="view"}),v.date&&r.jsx("span",{className:"error-text",children:v.date})]}),f.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"maintenance-section",children:[r.jsx("h3",{children:"🛢️ Información del Cambio de Aceite"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cantidad (galones) *"}),r.jsx("input",{type:"number",step:"0.1",value:f.quantity,onChange:w=>L("quantity",w.target.value),disabled:o==="view"}),v.quantity&&r.jsx("span",{className:"error-text",children:v.quantity})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Horómetro Actual *"}),r.jsx("input",{type:"number",value:f.currentHours,onChange:w=>L("currentHours",w.target.value),disabled:o==="view"}),v.currentHours&&r.jsx("span",{className:"error-text",children:v.currentHours})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Próximo Cambio (horas)"}),r.jsx("input",{type:"number",value:f.nextChangeHours,disabled:!0,className:"readonly-input"}),r.jsx("small",{children:"Calculado automáticamente: actual + 250 horas"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Filtros o Extras"}),r.jsx("textarea",{value:f.filters,onChange:w=>L("filters",w.target.value),disabled:o==="view",placeholder:"Especificar filtros cambiados o extras..."})]})]}),f.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"maintenance-section",children:[r.jsx("h3",{children:"🔋 Información del Cambio de Batería"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Batería *"}),r.jsx("input",{type:"text",value:f.batteryType,onChange:w=>L("batteryType",w.target.value),disabled:o==="view",placeholder:"Ej: 12V 60Ah"}),v.batteryType&&r.jsx("span",{className:"error-text",children:v.batteryType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado *"}),r.jsxs("select",{value:f.batteryStatus,onChange:w=>L("batteryStatus",w.target.value),disabled:o==="view",children:[r.jsx("option",{value:Bo.NEW,children:"Nueva"}),r.jsx("option",{value:Bo.USED,children:"Usada"}),r.jsx("option",{value:Bo.REPAIRED,children:"Reparada"})]})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Marca"}),r.jsx("input",{type:"text",value:f.brand,onChange:w=>L("brand",w.target.value),disabled:o==="view",placeholder:"Ej: Bosch, Exide"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Modelo"}),r.jsx("input",{type:"text",value:f.model,onChange:w=>L("model",w.target.value),disabled:o==="view",placeholder:"Ej: S4 005"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Costo *"}),r.jsx("input",{type:"number",step:"1000",value:f.cost,onChange:w=>L("cost",w.target.value),disabled:o==="view",placeholder:"0"}),v.cost&&r.jsx("span",{className:"error-text",children:v.cost})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Notas Adicionales"}),r.jsx("textarea",{value:f.notes,onChange:w=>L("notes",w.target.value),disabled:o==="view",placeholder:"Observaciones adicionales...",rows:"3"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:f.status,onChange:w=>L("status",w.target.value),disabled:o==="view",children:[r.jsx("option",{value:Me.COMPLETED,children:"Completado"}),r.jsx("option",{value:Me.PENDING,children:"Pendiente"}),r.jsx("option",{value:Me.CANCELLED,children:"Cancelado"})]})]})]})}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:N,children:"Cancelar"}),o!=="view"&&r.jsx("button",{type:"submit",className:"btn btn-primary",onClick:U,disabled:N,children:N?"Guardando...":o==="create"?"Crear":"Actualizar"})]})]})}):null},VL=()=>{const{user:n,userProfile:e}=Zs(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),[j,C]=Y.useState("cards"),[b,M]=Y.useState(""),[T,L]=Y.useState(!1),[$,O]=Y.useState(null),[U,F]=Y.useState("create");Y.useEffect(()=>{if(!n)return;f(!0);const H=Gv((J,ce)=>{if(ce){console.error("Error en suscripción de mantenimientos:",ce),v("Error al cargar mantenimientos"),f(!1);return}a(J),v(null),f(!1)},_);return()=>H()},[n,_]),Y.useEffect(()=>{n&&(async()=>{try{const J=await bj(_);c(J)}catch(J){console.error("Error al cargar estadísticas:",J)}})()},[n,t,_]);const X=t.filter(H=>{if(!b)return!0;const J=b.toLowerCase();return H.vehicleName?.toLowerCase().includes(J)||H.type?.toLowerCase().includes(J)||H.status?.toLowerCase().includes(J)||H.notes?.toLowerCase().includes(J)}),w=e?.combustiblesPermissions?.canManageMaintenance||!1,A=()=>{O(null),F("create"),L(!0)},R=H=>{O(H),F("edit"),L(!0)},I=H=>{O(H),F("view"),L(!0)},P=()=>{L(!1),O(null)},V=()=>{L(!1),O(null)},k=H=>{N(J=>({...J,...H}))},ke=()=>{N({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),M("")},ae=async H=>{if(!w){alert("No tienes permisos para eliminar mantenimientos");return}if(window.confirm("¿Estás seguro de que quieres eliminar este mantenimiento?"))try{const{deleteMaintenanceRecord:J}=await RL(async()=>{const{deleteMaintenanceRecord:ce}=await Promise.resolve().then(()=>nL);return{deleteMaintenanceRecord:ce}},void 0);await J(H),console.log("✅ Mantenimiento eliminado exitosamente")}catch(J){console.error("❌ Error al eliminar mantenimiento:",J),alert("Error al eliminar mantenimiento: "+J.message)}};return n?r.jsxs("div",{className:"maintenance-main",children:[r.jsxs("div",{className:"maintenance-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🔧 Mantenimiento de Vehículos"}),r.jsx("p",{children:"Gestión de cambios de aceite, filtros y baterías"})]}),r.jsx("div",{className:"header-actions",children:w&&r.jsx("button",{className:"btn-create-maintenance",onClick:A,children:"➕ Crear Mantenimiento"})})]}),d&&r.jsxs("div",{className:"maintenance-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando mantenimientos..."})]}),p&&r.jsxs("div",{className:"error-banner",children:[r.jsxs("span",{children:["❌ ",p]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]}),o&&r.jsx(DL,{stats:o}),r.jsx(OL,{filters:_,onFilterChange:k,onClearFilters:ke,searchTerm:b,onSearchChange:M,viewMode:j,onViewModeChange:C,totalResults:X.length}),!d&&!p&&r.jsx(kL,{maintenanceRecords:X,viewMode:j,onEdit:w?R:null,onView:I,onDelete:w?ae:null,userRole:e?.role}),T&&r.jsx(LL,{isOpen:T,onClose:P,onSuccess:V,maintenance:$,mode:U,userRole:e?.role})]}):r.jsx("div",{className:"maintenance-main",children:r.jsxs("div",{className:"auth-required",children:[r.jsx("h2",{children:"🔐 Autenticación Requerida"}),r.jsx("p",{children:"Debes iniciar sesión para acceder al módulo de mantenimiento."})]})})},UL=({isOpen:n,onClose:e,product:t,mode:a="create",onSave:o,userRole:c})=>{const[d,f]=Y.useState({name:"",displayName:"",category:Bs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),[p,v]=Y.useState({}),[_,N]=Y.useState(!1),j=[{value:"gal",label:"Galones (gal)"},{value:"L",label:"Litros (L)"},{value:"kg",label:"Kilogramos (kg)"},{value:"und",label:"Unidades (und)"}],C={[Bs.COMBUSTIBLE]:["🛢️","🚛","🚗","⛽","🌿"],[Bs.ACEITE]:["🛢️","⚙️","🔧","🚜","🏭"],[Bs.LUBRICANTE]:["🟥","🟡","🔵","⚫","🟤"],[Bs.FLUIDO]:["🛑","💧","🔴","🟢","🔵"]},b=["#FF6B35","#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#E91E63","#795548","#607D8B","#3F51B5"];Y.useEffect(()=>{f(t&&(a==="edit"||a==="view")?{name:t.name||"",displayName:t.displayName||"",category:t.category||Bs.COMBUSTIBLE,unit:t.unit||"gal",defaultPrice:t.defaultPrice||0,color:t.color||"#FF6B35",icon:t.icon||"🛢️",description:t.description||"",isActive:t.isActive!==void 0?t.isActive:!0,currentStock:t.currentStock||0,minThreshold:t.minThreshold||10,maxCapacity:t.maxCapacity||1e3}:{name:"",displayName:"",category:Bs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),v({})},[t,a,n]);const M=O=>{const{name:U,value:F,type:X,checked:w}=O.target;f(A=>({...A,[U]:X==="checkbox"?w:F})),p[U]&&v(A=>({...A,[U]:""}))},T=()=>{const O={};return d.name.trim()||(O.name="El nombre es requerido"),d.displayName.trim()||(O.displayName="El nombre de visualización es requerido"),d.category||(O.category="La categoría es requerida"),d.unit||(O.unit="La unidad es requerida"),d.defaultPrice<0&&(O.defaultPrice="El precio debe ser mayor o igual a 0"),d.currentStock<0&&(O.currentStock="El stock debe ser mayor o igual a 0"),d.minThreshold<0&&(O.minThreshold="El umbral mínimo debe ser mayor o igual a 0"),d.maxCapacity<=0&&(O.maxCapacity="La capacidad máxima debe ser mayor a 0"),d.minThreshold>=d.maxCapacity&&(O.minThreshold="El umbral mínimo debe ser menor que la capacidad máxima"),v(O),Object.keys(O).length===0},L=async O=>{if(O.preventDefault(),!!T()){N(!0);try{await o({...d,defaultPrice:parseFloat(d.defaultPrice),currentStock:parseFloat(d.currentStock),minThreshold:parseFloat(d.minThreshold),maxCapacity:parseFloat(d.maxCapacity)}),e()}catch(U){console.error("Error saving product:",U),v({submit:"Error al guardar el producto"})}finally{N(!1)}}};if(!n)return null;const $=["admin","supervisor"].includes(c)&&a!=="view";return r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content product-modal",children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[a==="create"&&"➕ Crear Producto",a==="edit"&&"✏️ Editar Producto",a==="view"&&"👁️ Ver Producto"]}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),r.jsxs("form",{onSubmit:L,className:"modal-body",children:[r.jsx("div",{className:"product-preview",children:r.jsxs("div",{className:"preview-card",children:[r.jsx("div",{className:"preview-icon",style:{color:d.color},children:d.icon}),r.jsxs("div",{className:"preview-info",children:[r.jsx("h3",{children:d.displayName||"Nombre del producto"}),r.jsx("p",{className:"preview-category",children:d.category}),r.jsx("p",{className:"preview-description",children:d.description}),r.jsxs("div",{className:"preview-price",children:["$",new Intl.NumberFormat("es-CO").format(d.defaultPrice)," / ",d.unit]})]})]})}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📝 Información Básica"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre Interno *"}),r.jsx("input",{type:"text",name:"name",value:d.name,onChange:M,disabled:!$,placeholder:"Ej: ACPM, GASOLINA"}),p.name&&r.jsx("span",{className:"error",children:p.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre de Visualización *"}),r.jsx("input",{type:"text",name:"displayName",value:d.displayName,onChange:M,disabled:!$,placeholder:"Ej: ACPM 🚛, Gasolina 🚗"}),p.displayName&&r.jsx("span",{className:"error",children:p.displayName})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Categoría *"}),r.jsx("select",{name:"category",value:d.category,onChange:M,disabled:!$,children:Object.values(Bs).map(O=>r.jsx("option",{value:O,children:O},O))}),p.category&&r.jsx("span",{className:"error",children:p.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Descripción"}),r.jsx("textarea",{name:"description",value:d.description,onChange:M,disabled:!$,placeholder:"Descripción del producto...",rows:"3"})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"⚙️ Configuración"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Unidad de Medida *"}),r.jsx("select",{name:"unit",value:d.unit,onChange:M,disabled:!$,children:j.map(O=>r.jsx("option",{value:O.value,children:O.label},O.value))}),p.unit&&r.jsx("span",{className:"error",children:p.unit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio por Defecto"}),r.jsx("input",{type:"number",name:"defaultPrice",value:d.defaultPrice,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.defaultPrice&&r.jsx("span",{className:"error",children:p.defaultPrice})]}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",name:"isActive",checked:d.isActive,onChange:M,disabled:!$}),"Producto Activo"]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📊 Stock y Umbrales"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Stock Actual"}),r.jsx("input",{type:"number",name:"currentStock",value:d.currentStock,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.currentStock&&r.jsx("span",{className:"error",children:p.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Umbral Mínimo"}),r.jsx("input",{type:"number",name:"minThreshold",value:d.minThreshold,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.minThreshold&&r.jsx("span",{className:"error",children:p.minThreshold})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Capacidad Máxima"}),r.jsx("input",{type:"number",name:"maxCapacity",value:d.maxCapacity,onChange:M,disabled:!$,min:"1",step:"0.01"}),p.maxCapacity&&r.jsx("span",{className:"error",children:p.maxCapacity})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"🎨 Apariencia"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Icono"}),r.jsx("div",{className:"icon-selector",children:C[d.category]?.map(O=>r.jsx("button",{type:"button",className:`icon-option ${d.icon===O?"selected":""}`,onClick:()=>f(U=>({...U,icon:O})),disabled:!$,children:O},O))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Color"}),r.jsx("div",{className:"color-selector",children:b.map(O=>r.jsx("button",{type:"button",className:`color-option ${d.color===O?"selected":""}`,style:{backgroundColor:O},onClick:()=>f(U=>({...U,color:O})),disabled:!$},O))})]})]})]}),p.submit&&r.jsx("div",{className:"error-message",children:p.submit})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:_,children:a==="view"?"Cerrar":"Cancelar"}),$&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:L,disabled:_,children:_?"Guardando...":"Guardar"})]})]})})},FL=({products:n})=>{const[e,t]=Y.useState([]),[a,o]=Y.useState(!0);Y.useEffect(()=>{const b=Hv(M=>{t(M),o(!1)},M=>{console.error("Error loading movements for stats:",M),o(!1)});return()=>b()},[]);const c=()=>n.map(M=>{const T=e.filter(X=>X.fuelType===M.name||X.fuelType===M.displayName),L=T.filter(X=>X.type==="entrada"),$=T.filter(X=>X.type==="salida"),O=L.reduce((X,w)=>X+(w.quantity||0),0),U=$.reduce((X,w)=>X+(w.quantity||0),0),F=(M.currentStock||0)*(M.defaultPrice||0);return{...M,totalEntries:O,totalExits:U,totalValue:F,entriesCount:L.length,exitsCount:$.length,stockStatus:d(M)}}),d=b=>{const M=b.currentStock||0,T=b.minThreshold||0,L=b.maxCapacity||1e3;return M===0?"empty":M<=T?"low":M>=L*.9?"high":"normal"},f=b=>{const M={};return Object.values(Bs).forEach(T=>{const L=b.filter($=>$.category===T);M[T]={totalProducts:L.length,totalStock:L.reduce(($,O)=>$+(O.currentStock||0),0),totalValue:L.reduce(($,O)=>$+O.totalValue,0),totalEntries:L.reduce(($,O)=>$+O.totalEntries,0),totalExits:L.reduce(($,O)=>$+O.totalExits,0),lowStockCount:L.filter($=>$.stockStatus==="low"||$.stockStatus==="empty").length}}),M};if(a)return r.jsxs("div",{className:"products-stats loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando estadísticas..."})]});const p=c(),v=f(p),_=n.length,N=n.filter(b=>b.isActive).length,j=p.reduce((b,M)=>b+M.totalValue,0),C=p.filter(b=>b.stockStatus==="low"||b.stockStatus==="empty").length;return r.jsxs("div",{className:"products-stats",children:[r.jsx("h2",{children:"📊 Estadísticas de Productos"}),r.jsxs("div",{className:"stats-general",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"📦"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:ze(_)}),r.jsx("p",{children:"Total Productos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"✅"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:ze(N)}),r.jsx("p",{children:"Productos Activos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Mn(j)}),r.jsx("p",{children:"Valor Total Stock"})]})]}),r.jsxs("div",{className:`stat-card ${C>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:ze(C)}),r.jsx("p",{children:"Stock Bajo"})]})]})]}),r.jsxs("div",{className:"stats-categories",children:[r.jsx("h3",{children:"📈 Por Categoría"}),r.jsx("div",{className:"categories-grid",children:Object.entries(v).map(([b,M])=>r.jsxs("div",{className:"category-card",children:[r.jsx("h4",{children:b}),r.jsxs("div",{className:"category-stats",children:[r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Productos:"}),r.jsx("span",{children:ze(M.totalProducts)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Stock Total:"}),r.jsxs("span",{children:[ze(M.totalStock)," unidades"]})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Valor:"}),r.jsx("span",{children:Mn(M.totalValue)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Entradas:"}),r.jsx("span",{className:"positive",children:ze(M.totalEntries)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Salidas:"}),r.jsx("span",{className:"negative",children:ze(M.totalExits)})]}),M.lowStockCount>0&&r.jsxs("div",{className:"stat-row alert",children:[r.jsx("span",{children:"Stock Bajo:"}),r.jsx("span",{children:ze(M.lowStockCount)})]})]})]},b))})]}),r.jsxs("div",{className:"stats-top-products",children:[r.jsx("h3",{children:"🏆 Top Productos por Stock"}),r.jsx("div",{className:"top-products-list",children:p.sort((b,M)=>(M.currentStock||0)-(b.currentStock||0)).slice(0,5).map((b,M)=>r.jsxs("div",{className:"top-product-item",children:[r.jsxs("div",{className:"rank",children:["#",M+1]}),r.jsx("div",{className:"product-icon",style:{color:b.color},children:b.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:b.displayName}),r.jsxs("span",{className:"product-stock",children:[ze(b.currentStock||0)," ",b.unit]})]}),r.jsx("div",{className:"product-value",children:Mn(b.totalValue)})]},b.id))})]}),C>0&&r.jsxs("div",{className:"stats-alerts",children:[r.jsx("h3",{children:"⚠️ Alertas de Stock"}),r.jsx("div",{className:"alerts-list",children:p.filter(b=>b.stockStatus==="low"||b.stockStatus==="empty").map(b=>r.jsxs("div",{className:`alert-item ${b.stockStatus}`,children:[r.jsx("div",{className:"alert-icon",children:b.stockStatus==="empty"?"🔴":"🟡"}),r.jsxs("div",{className:"alert-info",children:[r.jsx("span",{className:"alert-product",children:b.displayName}),r.jsxs("span",{className:"alert-stock",children:["Stock: ",ze(b.currentStock||0)," ",b.unit,b.stockStatus==="empty"&&" - ¡SIN STOCK!",b.stockStatus==="low"&&` - Mínimo: ${b.minThreshold}`]})]})]},b.id))})]})]})},qL=({userProfile:n})=>{const[e,t]=Y.useState([]),[a,o]=Y.useState(!0),[c,d]=Y.useState(null),[f,p]=Y.useState(!1),[v,_]=Y.useState(null),[N,j]=Y.useState("create"),[C,b]=Y.useState(""),[M,T]=Y.useState(""),[L,$]=Y.useState(!0),O=["admin","supervisor"].includes(n?.role);Y.useEffect(()=>{o(!0);const I=gj(P=>{t(P),o(!1),d(null)},P=>{console.error("Error loading products:",P),d("Error cargando productos"),o(!1)});return()=>I()},[]),Y.useEffect(()=>{(async()=>{if(console.log("🔍 Debug - Inicializando productos:",{productsLength:e.length,loading:a,canManageProducts:O}),e.length===0&&!a&&O)try{console.log("🚀 Creando productos predefinidos...");const P=Nx();console.log("📦 Productos predefinidos:",P);for(const V of P)console.log("➕ Creando producto:",V.name),await Hp({name:V.name,displayName:V.displayName,category:V.category,unit:V.unit,defaultPrice:V.defaultPrice,color:V.color,icon:V.icon,description:V.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});console.log("✅ Productos predefinidos creados exitosamente")}catch(P){console.error("❌ Error inicializando productos:",P)}else console.log("ℹ️ No se inicializan productos:",{reason:e.length>0?"Ya existen productos":a?"Está cargando":O?"Otra razón":"Sin permisos"})})()},[e.length,a,O]);const U=()=>{_(null),j("create"),p(!0)},F=I=>{_(I),j("edit"),p(!0)},X=I=>{_(I),j("view"),p(!0)},w=async I=>{if(window.confirm("¿Estás seguro de que deseas eliminar este producto?"))try{await W2(I)}catch(P){console.error("Error deleting product:",P),alert("Error al eliminar el producto")}},A=async I=>{try{N==="create"?await Hp(I):N==="edit"&&await X2(v.id,I),p(!1)}catch(P){throw console.error("Error saving product:",P),P}},R=e.filter(I=>{const P=I.displayName?.toLowerCase().includes(C.toLowerCase())||I.name?.toLowerCase().includes(C.toLowerCase()),V=!M||I.category===M;return P&&V});return a?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando productos..."})]})}):c?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"error-container",children:[r.jsxs("p",{children:["⚠️ ",c]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"products-main",children:[r.jsxs("div",{className:"products-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:"🛢️ Gestión de Productos"}),r.jsx("p",{children:"Administra los tipos de combustibles y productos disponibles"})]}),O&&r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{className:"btn-primary",onClick:U,children:"➕ Agregar Producto"}),r.jsx("button",{className:"btn-secondary",onClick:async()=>{try{console.log("🧪 Forzando creación de productos predefinidos...");const I=Nx();for(const P of I)await Hp({name:P.name,displayName:P.displayName,category:P.category,unit:P.unit,defaultPrice:P.defaultPrice,color:P.color,icon:P.icon,description:P.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});alert("Productos predefinidos creados exitosamente")}catch(I){console.error("Error:",I),alert("Error creando productos: "+I.message)}},style:{marginLeft:"10px"},children:"🧪 Crear Predefinidos"})]})]}),L&&r.jsx(FL,{products:e}),r.jsxs("div",{className:"products-filters",children:[r.jsx("div",{className:"filter-group",children:r.jsx("input",{type:"text",placeholder:"🔍 Buscar productos...",value:C,onChange:I=>b(I.target.value),className:"search-input"})}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:M,onChange:I=>T(I.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"🏷️ Todas las categorías"}),Object.values(Bs).map(I=>r.jsx("option",{value:I,children:I},I))]})}),r.jsx("div",{className:"filter-group",children:r.jsx("button",{className:`toggle-btn ${L?"active":""}`,onClick:()=>$(!L),children:"📊 Estadísticas"})})]}),r.jsx("div",{className:"products-grid",children:R.map(I=>r.jsxs("div",{className:"product-card",children:[r.jsx("div",{className:"product-icon",style:{color:I.color},children:I.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("h3",{children:I.displayName}),r.jsx("p",{className:"product-category",children:I.category}),r.jsx("p",{className:"product-description",children:I.description}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Stock:"}),r.jsxs("span",{className:"stat-value",children:[I.currentStock||0," ",I.unit]})]}),r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Precio:"}),r.jsxs("span",{className:"stat-value",children:["$",new Intl.NumberFormat("es-CO").format(I.defaultPrice||0)]})]})]}),r.jsx("div",{className:`product-status ${I.isActive?"active":"inactive"}`,children:I.isActive?"✅ Activo":"❌ Inactivo"})]}),r.jsxs("div",{className:"product-actions",children:[r.jsx("button",{className:"btn-secondary",onClick:()=>X(I),children:"👁️ Ver"}),O&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-primary",onClick:()=>F(I),children:"✏️ Editar"}),r.jsx("button",{className:"btn-danger",onClick:()=>w(I.id),children:"🗑️ Eliminar"})]})]})]},I.id))}),R.length===0&&r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📦"}),r.jsx("h3",{children:"No hay productos"}),r.jsx("p",{children:C||M?"No se encontraron productos con los filtros aplicados.":"Aún no hay productos registrados."}),O&&!C&&!M&&r.jsx("button",{className:"btn-primary",onClick:U,children:"➕ Crear primer producto"})]}),r.jsx(UL,{isOpen:f,onClose:()=>p(!1),product:v,mode:N,onSave:A,userRole:n?.role})]})},BL=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const[c,d]=Y.useState("name"),[f,p]=Y.useState("asc"),v=L=>{c===L?p(f==="asc"?"desc":"asc"):(d(L),p("asc"))},_=[...n].sort((L,$)=>{let O=L[c],U=$[c];switch(c){case"rating":O=O||0,U=U||0;break;case"totalOrders":case"totalPurchased":O=O||0,U=U||0;break;case"createdAt":case"lastOrderDate":O=O?O.toDate?O.toDate():new Date(O):new Date(0),U=U?U.toDate?U.toDate():new Date(U):new Date(0);break;default:O=(O||"").toString().toLowerCase(),U=(U||"").toString().toLowerCase()}return O<U?f==="asc"?-1:1:O>U?f==="asc"?1:-1:0}),N=L=>{switch(L){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},j=L=>{switch(L){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},C=L=>L?(L.toDate?L.toDate():new Date(L)).toLocaleDateString("es-CO"):"-",b=L=>{const $=[];for(let O=1;O<=5;O++)$.push(r.jsx("span",{className:`star ${O<=L?"filled":""}`,children:"★"},O));return r.jsx("div",{className:"rating-stars",children:$})},M=L=>!L||L.length===0?r.jsx("span",{className:"no-data",children:"-"}):r.jsxs("div",{className:"fuel-types-cell",children:[L.slice(0,2).map($=>r.jsx("span",{className:"fuel-badge-sm",children:An[$]||$},$)),L.length>2&&r.jsxs("span",{className:"fuel-badge-sm more",title:L.slice(2).map($=>An[$]||$).join(", "),children:["+",L.length-2]})]}),T=L=>c!==L?"icon-chevrons-up-down":f==="asc"?"icon-chevron-up":"icon-chevron-down";return r.jsxs("div",{className:"suppliers-table-container",children:[r.jsxs("div",{className:"table-wrapper",children:[r.jsxs("table",{className:"suppliers-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:`sortable ${c==="name"?"active":""}`,onClick:()=>v("name"),children:[r.jsx("span",{children:"Proveedor"}),r.jsx("i",{className:T("name")})]}),r.jsxs("th",{className:`sortable ${c==="status"?"active":""}`,onClick:()=>v("status"),children:[r.jsx("span",{children:"Estado"}),r.jsx("i",{className:T("status")})]}),r.jsxs("th",{className:`sortable ${c==="category"?"active":""}`,onClick:()=>v("category"),children:[r.jsx("span",{children:"Categoría"}),r.jsx("i",{className:T("category")})]}),r.jsx("th",{children:r.jsx("span",{children:"Combustibles"})}),r.jsx("th",{children:r.jsx("span",{children:"Contacto"})}),r.jsxs("th",{className:`sortable ${c==="rating"?"active":""}`,onClick:()=>v("rating"),children:[r.jsx("span",{children:"Rating"}),r.jsx("i",{className:T("rating")})]}),r.jsxs("th",{className:`sortable ${c==="totalOrders"?"active":""}`,onClick:()=>v("totalOrders"),children:[r.jsx("span",{children:"Órdenes"}),r.jsx("i",{className:T("totalOrders")})]}),r.jsxs("th",{className:`sortable ${c==="totalPurchased"?"active":""}`,onClick:()=>v("totalPurchased"),children:[r.jsx("span",{children:"Total Comprado"}),r.jsx("i",{className:T("totalPurchased")})]}),r.jsxs("th",{className:`sortable ${c==="createdAt"?"active":""}`,onClick:()=>v("createdAt"),children:[r.jsx("span",{children:"Creado"}),r.jsx("i",{className:T("createdAt")})]}),r.jsx("th",{className:"actions-column",children:r.jsx("span",{children:"Acciones"})})]})}),r.jsx("tbody",{children:_.map(L=>r.jsxs("tr",{className:`supplier-row ${L.status}`,children:[r.jsx("td",{className:"supplier-info-cell",children:r.jsxs("div",{className:"supplier-main-info",children:[r.jsxs("div",{className:"supplier-name",children:[L.name,L.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),L.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",L.taxId]}),L.type&&r.jsx("div",{className:"supplier-type",children:L.type.charAt(0).toUpperCase()+L.type.slice(1)})]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:"status-display",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:N(L.status)}}),r.jsx("span",{className:"status-label",children:j(L.status)})]})}),r.jsx("td",{className:"category-cell",children:r.jsx("span",{className:"category-label",children:L.category?.charAt(0).toUpperCase()+L.category?.slice(1)||"-"})}),r.jsx("td",{className:"fuel-types-cell",children:M(L.fuelTypes)}),r.jsx("td",{className:"contact-cell",children:r.jsxs("div",{className:"contact-info",children:[L.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:L.contactPerson})]}),L.phone&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("a",{href:`tel:${L.phone}`,children:L.phone})]}),L.email&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("a",{href:`mailto:${L.email}`,children:L.email})]}),L.city&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:L.city})]})]})}),r.jsx("td",{className:"rating-cell",children:r.jsxs("div",{className:"rating-display",children:[b(L.rating||0),r.jsx("span",{className:"rating-value",children:(L.rating||0).toFixed(1)})]})}),r.jsx("td",{className:"orders-cell",children:r.jsx("span",{className:"orders-count",children:L.totalOrders||0})}),r.jsx("td",{className:"purchased-cell",children:r.jsx("span",{className:"purchased-amount",children:Mn(L.totalPurchased||0)})}),r.jsx("td",{className:"date-cell",children:r.jsx("span",{className:"date-value",children:C(L.createdAt)})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[a&&r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(L),title:"Editar proveedor",children:r.jsx("i",{className:"icon-edit"})}),o&&L.status==="active"&&r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(L.id,L.name),title:"Desactivar proveedor",children:r.jsx("i",{className:"icon-x-circle"})}),r.jsxs("div",{className:"quick-actions",children:[L.phone&&r.jsx("a",{href:`tel:${L.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),L.email&&r.jsx("a",{href:`mailto:${L.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})})]},L.id))})]}),_.length===0&&r.jsxs("div",{className:"table-empty-state",children:[r.jsx("i",{className:"icon-truck"}),r.jsx("p",{children:"No hay proveedores para mostrar"})]})]}),r.jsxs("div",{className:"table-footer",children:[r.jsx("div",{className:"table-info",children:r.jsxs("span",{children:["Mostrando ",_.length," proveedor",_.length!==1?"es":""]})}),r.jsx("div",{className:"table-actions",children:r.jsxs("span",{className:"sort-info",children:["Ordenado por: ",c==="name"?"Nombre":c==="status"?"Estado":c==="category"?"Categoría":c==="rating"?"Rating":c==="totalOrders"?"Órdenes":c==="totalPurchased"?"Total Comprado":c==="createdAt"?"Fecha de Creación":c," (",f==="asc"?"Ascendente":"Descendente",")"]})})]})]})},HL=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const c=C=>{switch(C){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},d=C=>{switch(C){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},f=C=>{switch(C){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},p=C=>{switch(C){case"proveedor":return"Proveedor";case"distribuidor":return"Distribuidor";case"mayorista":return"Mayorista";default:return"Sin especificar"}},v=C=>C?(C.toDate?C.toDate():new Date(C)).toLocaleDateString("es-CO"):"No disponible",_=C=>{const b=[];for(let M=1;M<=5;M++)b.push(r.jsx("span",{className:`star ${M<=C?"filled":""}`,children:"★"},M));return r.jsx("div",{className:"rating-stars",children:b})},N=C=>!C||C.length===0?r.jsx("span",{className:"no-fuels",children:"Sin combustibles especificados"}):r.jsxs("div",{className:"fuel-types",children:[C.slice(0,3).map(b=>r.jsx("span",{className:"fuel-badge",title:An[b],children:An[b]||b},b)),C.length>3&&r.jsxs("span",{className:"fuel-badge more",title:`+${C.length-3} más`,children:["+",C.length-3]})]}),j=C=>{const b=[];return C.phone&&b.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("span",{children:C.phone})]},"phone")),C.email&&b.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("span",{children:C.email})]},"email")),C.city&&b.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:C.city})]},"city")),b.length>0?b:r.jsxs("div",{className:"contact-item no-contact",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:"Sin información de contacto"})]})};return r.jsx("div",{className:"suppliers-cards",children:n.map(C=>r.jsxs("div",{className:`supplier-card ${C.status}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsx("div",{className:"header-left",children:r.jsxs("div",{className:"supplier-info",children:[r.jsxs("h3",{className:"supplier-name",children:[C.name,C.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),C.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",C.taxId]})]})}),r.jsx("div",{className:"header-right",children:r.jsxs("div",{className:"supplier-status",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:c(C.status)}}),r.jsx("span",{className:"status-label",children:d(C.status)})]})})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"supplier-meta",children:[r.jsxs("div",{className:"meta-item",children:[r.jsx("span",{className:"meta-icon",children:f(C.category)}),r.jsx("span",{className:"meta-label",children:C.category?.charAt(0).toUpperCase()+C.category?.slice(1)||"Sin categoría"})]}),r.jsxs("div",{className:"meta-item",children:[r.jsx("i",{className:"icon-building meta-icon"}),r.jsx("span",{className:"meta-label",children:p(C.type)})]})]}),C.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:C.contactPerson})]}),r.jsx("div",{className:"contact-info",children:j(C)}),r.jsxs("div",{className:"fuel-types-section",children:[r.jsx("div",{className:"section-label",children:"Combustibles Suministrados:"}),N(C.fuelTypes)]}),r.jsxs("div",{className:"rating-section",children:[r.jsxs("div",{className:"rating-display",children:[_(C.rating||0),r.jsxs("span",{className:"rating-value",children:[(C.rating||0).toFixed(1),"/5"]})]}),C.evaluationNotes&&r.jsxs("div",{className:"evaluation-notes",title:C.evaluationNotes,children:[r.jsx("i",{className:"icon-message-square"}),r.jsx("span",{children:"Con evaluación"})]})]}),C.paymentTerms&&r.jsxs("div",{className:"payment-terms",children:[r.jsx("i",{className:"icon-credit-card"}),r.jsxs("span",{children:["Términos: ",C.paymentTerms==="contado"?"Contado":C.paymentTerms==="30dias"?"30 días":C.paymentTerms==="60dias"?"60 días":C.paymentTerms==="90dias"?"90 días":C.paymentTerms]})]}),r.jsxs("div",{className:"supplier-stats",children:[r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Órdenes:"}),r.jsx("span",{className:"stat-value",children:C.totalOrders||0})]}),r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Total Comprado:"}),r.jsx("span",{className:"stat-value",children:Mn(C.totalPurchased||0)})]}),C.lastOrderDate&&r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Última Orden:"}),r.jsx("span",{className:"stat-value",children:v(C.lastOrderDate)})]})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsx("div",{className:"footer-info",children:r.jsxs("span",{className:"created-date",children:["Creado: ",v(C.createdAt)]})}),r.jsxs("div",{className:"card-actions",children:[a&&r.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(C),title:"Editar proveedor",children:[r.jsx("i",{className:"icon-edit"}),"Editar"]}),o&&C.status==="active"&&r.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>t(C.id,C.name),title:"Desactivar proveedor",children:[r.jsx("i",{className:"icon-x-circle"}),"Desactivar"]}),r.jsxs("div",{className:"quick-actions",children:[C.phone&&r.jsx("a",{href:`tel:${C.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),C.email&&r.jsx("a",{href:`mailto:${C.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})]})]},C.id))})},zL=({supplier:n,onClose:e,onSuccess:t,onError:a})=>{const{userProfile:o}=Zs(),c=!!n,[d,f]=Y.useState({name:"",taxId:"",type:"proveedor",category:"combustibles",contactPerson:"",phone:"",email:"",address:"",city:"",state:"Colombia",fuelTypes:[],paymentTerms:"contado",creditLimit:"",priceList:{},rating:5,evaluationNotes:"",status:"active",isPreferred:!1}),[p,v]=Y.useState(!1),[_,N]=Y.useState({}),[j,C]=Y.useState("basic");Y.useEffect(()=>{c&&n&&f({name:n.name||"",taxId:n.taxId||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson||"",phone:n.phone||"",email:n.email||"",address:n.address||"",city:n.city||"",state:n.state||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:n.creditLimit||"",priceList:n.priceList||{},rating:n.rating||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1})},[c,n]);const b=(U,F)=>{f(X=>({...X,[U]:F})),_[U]&&N(X=>({...X,[U]:null}))},M=U=>{f(F=>({...F,fuelTypes:F.fuelTypes.includes(U)?F.fuelTypes.filter(X=>X!==U):[...F.fuelTypes,U]}))},T=(U,F)=>{f(X=>({...X,priceList:{...X.priceList,[U]:parseFloat(F)||0}}))},L=()=>{const U={};return d.name.trim()||(U.name="El nombre del proveedor es requerido"),d.category||(U.category="La categoría es requerida"),d.type||(U.type="El tipo de proveedor es requerido"),d.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)&&(U.email="El formato del email no es válido"),d.phone&&!/^[\d\s\-+()]+$/.test(d.phone)&&(U.phone="El formato del teléfono no es válido"),d.creditLimit&&(isNaN(d.creditLimit)||parseFloat(d.creditLimit)<0)&&(U.creditLimit="El límite de crédito debe ser un número positivo"),(d.rating<1||d.rating>5)&&(U.rating="El rating debe estar entre 1 y 5"),d.fuelTypes.forEach(F=>{d.priceList[F]&&(isNaN(d.priceList[F])||parseFloat(d.priceList[F])<0)&&(U[`price_${F}`]=`El precio de ${An[F]} debe ser un número positivo`)}),N(U),Object.keys(U).length===0},$=async U=>{if(U.preventDefault(),!!L()){v(!0);try{const F={...d,creditLimit:parseFloat(d.creditLimit)||0,rating:parseFloat(d.rating)||5,priceList:Object.fromEntries(Object.entries(d.priceList).filter(([w,A])=>d.fuelTypes.includes(w)&&A>0))};let X;c?X=await pL(n.id,F,o?.email):X=await fL(F,o?.email),X.success?t():a(X.error||"Error al guardar proveedor")}catch(F){console.error("Error saving supplier:",F),a("Error inesperado al guardar proveedor")}finally{v(!1)}}},O=[{id:"basic",label:"Información Básica",icon:"icon-info"},{id:"contact",label:"Contacto",icon:"icon-phone"},{id:"products",label:"Productos",icon:"icon-package"},{id:"commercial",label:"Comercial",icon:"icon-credit-card"}];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-container large",onClick:U=>U.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[r.jsx("i",{className:"icon-truck"}),c?"Editar Proveedor":"Nuevo Proveedor"]}),r.jsx("button",{className:"modal-close",onClick:e,children:r.jsx("i",{className:"icon-x"})})]}),r.jsxs("form",{onSubmit:$,children:[r.jsx("div",{className:"modal-tabs",children:O.map(U=>r.jsxs("button",{type:"button",className:`tab-button ${j===U.id?"active":""}`,onClick:()=>C(U.id),children:[r.jsx("i",{className:U.icon}),U.label]},U.id))}),r.jsxs("div",{className:"modal-body",children:[j==="basic"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Nombre del Proveedor"}),r.jsx("input",{type:"text",value:d.name,onChange:U=>b("name",U.target.value),placeholder:"Ingresa el nombre del proveedor",className:_.name?"error":""}),_.name&&r.jsx("span",{className:"error-message",children:_.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"NIT / Documento"}),r.jsx("input",{type:"text",value:d.taxId,onChange:U=>b("taxId",U.target.value),placeholder:"123456789-0",className:_.taxId?"error":""}),_.taxId&&r.jsx("span",{className:"error-message",children:_.taxId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Tipo de Proveedor"}),r.jsxs("select",{value:d.type,onChange:U=>b("type",U.target.value),className:_.type?"error":"",children:[r.jsx("option",{value:"proveedor",children:"Proveedor"}),r.jsx("option",{value:"distribuidor",children:"Distribuidor"}),r.jsx("option",{value:"mayorista",children:"Mayorista"})]}),_.type&&r.jsx("span",{className:"error-message",children:_.type})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Categoría"}),r.jsxs("select",{value:d.category,onChange:U=>b("category",U.target.value),className:_.category?"error":"",children:[r.jsx("option",{value:"combustibles",children:"Combustibles"}),r.jsx("option",{value:"lubricantes",children:"Lubricantes"}),r.jsx("option",{value:"aditivos",children:"Aditivos"})]}),_.category&&r.jsx("span",{className:"error-message",children:_.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:d.status,onChange:U=>b("status",U.target.value),children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"suspended",children:"Suspendido"})]})]}),r.jsx("div",{className:"form-group checkbox",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.isPreferred,onChange:U=>b("isPreferred",U.target.checked)}),r.jsx("span",{className:"checkbox-mark"}),"Proveedor Preferido"]})})]})}),j==="contact"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Persona de Contacto"}),r.jsx("input",{type:"text",value:d.contactPerson,onChange:U=>b("contactPerson",U.target.value),placeholder:"Nombre del contacto principal"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Teléfono"}),r.jsx("input",{type:"tel",value:d.phone,onChange:U=>b("phone",U.target.value),placeholder:"+57 300 123 4567",className:_.phone?"error":""}),_.phone&&r.jsx("span",{className:"error-message",children:_.phone})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{type:"email",value:d.email,onChange:U=>b("email",U.target.value),placeholder:"contacto@proveedor.com",className:_.email?"error":""}),_.email&&r.jsx("span",{className:"error-message",children:_.email})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ciudad"}),r.jsx("input",{type:"text",value:d.city,onChange:U=>b("city",U.target.value),placeholder:"Bogotá"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado/País"}),r.jsx("input",{type:"text",value:d.state,onChange:U=>b("state",U.target.value),placeholder:"Colombia"})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Dirección"}),r.jsx("textarea",{value:d.address,onChange:U=>b("address",U.target.value),placeholder:"Dirección completa del proveedor",rows:"3"})]})]})}),j==="products"&&r.jsxs("div",{className:"tab-content",children:[r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Tipos de Combustible que Suministra"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(An).map(([U,F])=>r.jsx("div",{className:"fuel-type-item",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.fuelTypes.includes(U),onChange:()=>M(U)}),r.jsx("span",{className:"checkbox-mark"}),F]})},U))})]}),d.fuelTypes.length>0&&r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Precios por Litro (Opcional)"}),r.jsx("div",{className:"prices-grid",children:d.fuelTypes.map(U=>r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:An[U]}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.priceList[U]||"",onChange:F=>T(U,F.target.value),placeholder:"0.00",className:_[`price_${U}`]?"error":""})]}),_[`price_${U}`]&&r.jsx("span",{className:"error-message",children:_[`price_${U}`]})]},U))})]})]}),j==="commercial"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Términos de Pago"}),r.jsxs("select",{value:d.paymentTerms,onChange:U=>b("paymentTerms",U.target.value),children:[r.jsx("option",{value:"contado",children:"Contado"}),r.jsx("option",{value:"30dias",children:"30 días"}),r.jsx("option",{value:"60dias",children:"60 días"}),r.jsx("option",{value:"90dias",children:"90 días"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Límite de Crédito"}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.creditLimit,onChange:U=>b("creditLimit",U.target.value),placeholder:"0.00",className:_.creditLimit?"error":""})]}),_.creditLimit&&r.jsx("span",{className:"error-message",children:_.creditLimit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Rating"}),r.jsxs("div",{className:"rating-input",children:[r.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:d.rating,onChange:U=>b("rating",parseFloat(U.target.value)),className:_.rating?"error":""}),r.jsxs("div",{className:"rating-display",children:[r.jsx("span",{className:"rating-value",children:d.rating.toFixed(1)}),r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(U=>r.jsx("span",{className:`star ${U<=Math.round(d.rating)?"filled":""}`,children:"★"},U))})]})]}),_.rating&&r.jsx("span",{className:"error-message",children:_.rating})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Notas de Evaluación"}),r.jsx("textarea",{value:d.evaluationNotes,onChange:U=>b("evaluationNotes",U.target.value),placeholder:"Comentarios sobre el desempeño del proveedor...",rows:"4"})]})]})})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"loading-spinner small"}),c?"Actualizando...":"Creando..."]}):r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"icon-save"}),c?"Actualizar Proveedor":"Crear Proveedor"]})})]})]})]})})},GL=({stats:n,suppliersCount:e,totalSuppliers:t})=>{if(!n)return null;const a=d=>{switch(d){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},c=d=>{switch(d){case"proveedor":return"🏪";case"distribuidor":return"🚛";case"mayorista":return"🏭";default:return"🏢"}};return r.jsxs("div",{className:"suppliers-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.total)}),r.jsx("div",{className:"stat-label",children:"Total Proveedores"}),t!==e&&r.jsxs("div",{className:"stat-sublabel",children:[ze(e)," mostrados"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-check-circle"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.active)}),r.jsx("div",{className:"stat-label",children:"Activos"}),r.jsx("div",{className:"stat-sublabel",children:Nr(n.total>0?n.active/n.total:0)})]})]}),r.jsxs("div",{className:"stat-card warning",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-star"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ze(n.preferred)}),r.jsx("div",{className:"stat-label",children:"Preferidos"}),r.jsx("div",{className:"stat-sublabel",children:Nr(n.active>0?n.preferred/n.active:0)})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-award"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:n.averageRating.toFixed(1)}),r.jsx("div",{className:"stat-label",children:"Rating Promedio"}),r.jsx("div",{className:"stat-sublabel",children:r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(d=>r.jsx("span",{className:`star ${d<=Math.round(n.averageRating)?"filled":""}`,children:"★"},d))})})]})]})]}),r.jsxs("div",{className:"stats-details",children:[r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Estado de Proveedores"}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("active")}}),"Activos"]}),r.jsx("div",{className:"breakdown-value",children:n.active}),r.jsx("div",{className:"breakdown-percentage",children:Nr(n.total>0?n.active/n.total:0)})]}),n.inactive>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("inactive")}}),"Inactivos"]}),r.jsx("div",{className:"breakdown-value",children:n.inactive}),r.jsx("div",{className:"breakdown-percentage",children:Nr(n.total>0?n.inactive/n.total:0)})]}),n.suspended>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("suspended")}}),"Suspendidos"]}),r.jsx("div",{className:"breakdown-value",children:n.suspended}),r.jsx("div",{className:"breakdown-percentage",children:Nr(n.total>0?n.suspended/n.total:0)})]})]})]}),Object.keys(n.byCategory).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Categoría"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byCategory).sort(([,d],[,f])=>f-d).map(([d,f])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"category-icon",children:o(d)}),d.charAt(0).toUpperCase()+d.slice(1).replace("_"," ")]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-percentage",children:Nr(n.total>0?f/n.total:0)})]},d))})]}),Object.keys(n.byType).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Tipo"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byType).sort(([,d],[,f])=>f-d).map(([d,f])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"type-icon",children:c(d)}),d.charAt(0).toUpperCase()+d.slice(1)]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-percentage",children:Nr(n.total>0?f/n.total:0)})]},d))})]})]}),r.jsxs("div",{className:"stats-insights",children:[r.jsx("h3",{children:"Información Rápida"}),r.jsxs("div",{className:"insights-grid",children:[r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Nivel de Satisfacción"}),r.jsx("div",{className:"insight-value",children:n.averageRating>=4.5?"Excelente":n.averageRating>=4?"Muy Bueno":n.averageRating>=3.5?"Bueno":n.averageRating>=3?"Regular":"Necesita Mejora"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Estado General"}),r.jsx("div",{className:"insight-value",children:n.active/n.total>=.9?"Excelente":n.active/n.total>=.8?"Bueno":n.active/n.total>=.7?"Regular":"Revisar"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Proveedores Preferidos"}),r.jsx("div",{className:"insight-value",children:n.preferred===0?"Ninguno":n.preferred/n.active>=.3?"Suficientes":n.preferred/n.active>=.2?"Buenos":"Pocos"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Diversificación"}),r.jsx("div",{className:"insight-value",children:Object.keys(n.byCategory).length>=3?"Alta":Object.keys(n.byCategory).length>=2?"Media":"Baja"})]})]})]})]})},$L=({searchTerm:n,setSearchTerm:e,filterStatus:t,setFilterStatus:a,filterCategory:o,setFilterCategory:c,filterFuelType:d,setFilterFuelType:f,viewMode:p,setViewMode:v,onClearFilters:_,resultsCount:N})=>{const j=[{value:"all",label:"Todos los Estados",icon:"list"},{value:"active",label:"Activos",icon:"check-circle"},{value:"inactive",label:"Inactivos",icon:"x-circle"},{value:"suspended",label:"Suspendidos",icon:"alert-circle"},{value:"preferred",label:"Preferidos",icon:"star"}],C=[{value:"all",label:"Todas las Categorías",icon:"grid"},{value:"combustibles",label:"Combustibles",icon:"fuel"},{value:"lubricantes",label:"Lubricantes",icon:"droplets"},{value:"aditivos",label:"Aditivos",icon:"flask"}],b=[{value:"all",label:"Todos los Combustibles",icon:"fuel"},...Object.entries(An).map(([T,L])=>({value:T,label:L,icon:"droplet"}))],M=n||t!=="all"||o!=="all"||d!=="all";return r.jsxs("div",{className:"suppliers-filters",children:[r.jsxs("div",{className:"filters-top",children:[r.jsx("div",{className:"search-container",children:r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx("i",{className:"icon-search search-icon"}),r.jsx("input",{type:"text",placeholder:"Buscar por nombre, NIT, contacto, ciudad...",value:n,onChange:T=>e(T.target.value),className:"search-input"}),n&&r.jsx("button",{className:"search-clear",onClick:()=>e(""),title:"Limpiar búsqueda",children:r.jsx("i",{className:"icon-x"})})]})}),r.jsxs("div",{className:"view-controls",children:[r.jsxs("div",{className:"view-mode-toggle",children:[r.jsx("button",{className:`view-btn ${p==="cards"?"active":""}`,onClick:()=>v("cards"),title:"Vista de tarjetas",children:r.jsx("i",{className:"icon-grid"})}),r.jsx("button",{className:`view-btn ${p==="table"?"active":""}`,onClick:()=>v("table"),title:"Vista de tabla",children:r.jsx("i",{className:"icon-list"})})]}),M&&r.jsxs("button",{className:"btn btn-secondary clear-filters",onClick:_,title:"Limpiar todos los filtros",children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar"]})]})]}),r.jsxs("div",{className:"filters-dropdowns",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Estado"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:t,onChange:T=>a(T.target.value),className:"filter-select",children:j.map(T=>r.jsx("option",{value:T.value,children:T.label},T.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Categoría"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:o,onChange:T=>c(T.target.value),className:"filter-select",children:C.map(T=>r.jsx("option",{value:T.value,children:T.label},T.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:d,onChange:T=>f(T.target.value),className:"filter-select",children:b.map(T=>r.jsx("option",{value:T.value,children:T.label},T.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]})]}),r.jsxs("div",{className:"filters-summary",children:[r.jsxs("div",{className:"results-count",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:N===0?"No se encontraron proveedores":`Mostrando ${N} proveedor${N!==1?"es":""}`})]}),M&&r.jsxs("div",{className:"active-filters",children:[r.jsx("span",{className:"filters-label",children:"Filtros activos:"}),r.jsxs("div",{className:"filter-tags",children:[n&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-search"}),n,r.jsx("button",{onClick:()=>e(""),children:r.jsx("i",{className:"icon-x"})})]}),t!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-filter"}),j.find(T=>T.value===t)?.label,r.jsx("button",{onClick:()=>a("all"),children:r.jsx("i",{className:"icon-x"})})]}),o!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-tag"}),C.find(T=>T.value===o)?.label,r.jsx("button",{onClick:()=>c("all"),children:r.jsx("i",{className:"icon-x"})})]}),d!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-droplet"}),b.find(T=>T.value===d)?.label,r.jsx("button",{onClick:()=>f("all"),children:r.jsx("i",{className:"icon-x"})})]})]})]})]}),r.jsxs("div",{className:"quick-filters",children:[r.jsx("span",{className:"quick-filters-label",children:"Acceso rápido:"}),r.jsxs("div",{className:"quick-filter-buttons",children:[r.jsxs("button",{className:`quick-filter-btn ${t==="preferred"?"active":""}`,onClick:()=>a(t==="preferred"?"all":"preferred"),children:[r.jsx("i",{className:"icon-star"}),"Preferidos"]}),r.jsxs("button",{className:`quick-filter-btn ${t==="active"?"active":""}`,onClick:()=>a(t==="active"?"all":"active"),children:[r.jsx("i",{className:"icon-check-circle"}),"Activos"]}),r.jsxs("button",{className:`quick-filter-btn ${o==="combustibles"?"active":""}`,onClick:()=>c(o==="combustibles"?"all":"combustibles"),children:[r.jsx("i",{className:"icon-fuel"}),"Combustibles"]}),r.jsxs("button",{className:`quick-filter-btn ${d==="diesel"?"active":""}`,onClick:()=>f(d==="diesel"?"all":"diesel"),children:[r.jsx("i",{className:"icon-droplet"}),"Diésel"]})]})]})]})},YL=()=>{const{hasPermission:n,userProfile:e}=Zs(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState("cards"),[j,C]=Y.useState(!1),[b,M]=Y.useState(null),[T,L]=Y.useState("all"),[$,O]=Y.useState("all"),[U,F]=Y.useState("all"),[X,w]=Y.useState("");Y.useEffect(()=>{let H=null;return(()=>{H=mL(ce=>{a(ce||[]),f(!1)})})(),()=>{H&&H()}},[]),Y.useEffect(()=>{const H=async()=>{const J=await vL();J.success&&c(J.data)};t.length>0&&H()},[t]);const A=t.filter(H=>{const J=!X||H.name?.toLowerCase().includes(X.toLowerCase())||H.taxId?.toLowerCase().includes(X.toLowerCase())||H.contactPerson?.toLowerCase().includes(X.toLowerCase())||H.city?.toLowerCase().includes(X.toLowerCase()),ce=T==="all"||(T==="preferred"?H.isPreferred:H.status===T),ve=$==="all"||H.category===$,B=U==="all"||H.fuelTypes&&H.fuelTypes.includes(U);return J&&ce&&ve&&B}),R=()=>{if(!n("canManageSuppliers")){v("No tienes permisos para agregar proveedores");return}M(null),C(!0)},I=H=>{if(!n("canManageSuppliers")){v("No tienes permisos para editar proveedores");return}M(H),C(!0)},P=async(H,J)=>{if(!n("canManageSuppliers")){v("No tienes permisos para eliminar proveedores");return}if(window.confirm(`¿Estás seguro de que deseas desactivar el proveedor "${J}"?

Esta acción se puede revertir cambiando su estado a activo.`))try{const ce=await gL(H,e?.email);ce.success?v(null):v(ce.error||"Error al desactivar proveedor")}catch(ce){console.error("Error deleting supplier:",ce),v("Error inesperado al eliminar proveedor")}},V=()=>{C(!1),M(null),v(null)},k=()=>{C(!1),M(null),v(null)},ke=()=>{L("all"),O("all"),F("all"),w("")},ae=()=>{if(!n("canExportReports")){v("No tienes permisos para exportar datos");return}try{const H=A.map(ne=>({Nombre:ne.name,"NIT/Documento":ne.taxId,Tipo:ne.type,Categoría:ne.category,"Persona de Contacto":ne.contactPerson,Teléfono:ne.phone,Email:ne.email,Ciudad:ne.city,Combustibles:ne.fuelTypes?.join(", "),Rating:ne.rating,Estado:ne.status,Preferido:ne.isPreferred?"Sí":"No","Fecha Creación":ne.createdAt?.toDate?.()?.toLocaleDateString()||"N/A"})),J=[Object.keys(H[0]).join(","),...H.map(ne=>Object.values(ne).map(he=>`"${he||""}"`).join(","))].join(`
`),ce=new Blob([J],{type:"text/csv;charset=utf-8;"}),ve=document.createElement("a"),B=URL.createObjectURL(ce);ve.setAttribute("href",B),ve.setAttribute("download",`proveedores_${new Date().toISOString().split("T")[0]}.csv`),ve.style.visibility="hidden",document.body.appendChild(ve),ve.click(),document.body.removeChild(ve)}catch(H){console.error("Error exporting suppliers:",H),v("Error al exportar proveedores")}};return d?r.jsx("div",{className:"suppliers-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando proveedores..."})]})}):r.jsxs("div",{className:"suppliers-main",children:[r.jsxs("div",{className:"suppliers-header",children:[r.jsxs("div",{className:"header-content",children:[r.jsx("h1",{children:"Gestión de Proveedores"}),r.jsx("p",{className:"header-subtitle",children:"Administra los proveedores de combustibles y materiales"})]}),r.jsxs("div",{className:"header-actions",children:[n("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:R,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Proveedor"]}),n("canExportReports")&&r.jsxs("button",{className:"btn btn-secondary",onClick:ae,disabled:A.length===0,children:[r.jsx("i",{className:"icon-download"}),"Exportar"]})]})]}),p&&r.jsxs("div",{className:"alert alert-error",children:[r.jsx("i",{className:"icon-alert-circle"}),r.jsx("span",{children:p}),r.jsx("button",{onClick:()=>v(null),className:"alert-close",children:r.jsx("i",{className:"icon-x"})})]}),o&&r.jsx(GL,{stats:o,suppliersCount:A.length,totalSuppliers:t.length}),r.jsx($L,{searchTerm:X,setSearchTerm:w,filterStatus:T,setFilterStatus:L,filterCategory:$,setFilterCategory:O,filterFuelType:U,setFilterFuelType:F,viewMode:_,setViewMode:N,onClearFilters:ke,resultsCount:A.length}),A.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsx("h3",{children:"No hay proveedores"}),r.jsx("p",{children:t.length===0?"Comienza agregando tu primer proveedor de combustibles.":"No se encontraron proveedores que coincidan con los filtros aplicados."}),t.length===0&&n("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:R,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Primer Proveedor"]}),t.length>0&&r.jsxs("button",{className:"btn btn-secondary",onClick:ke,children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar Filtros"]})]}):r.jsx("div",{className:"suppliers-content",children:_==="cards"?r.jsx(HL,{suppliers:A,onEdit:I,onDelete:P,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")}):r.jsx(BL,{suppliers:A,onEdit:I,onDelete:P,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")})}),j&&r.jsx(zL,{supplier:b,onClose:V,onSuccess:k,onError:v})]})},KL=()=>{const{user:n,userProfile:e}=Zs(),[t,a]=Y.useState("invitations"),[o,c]=Y.useState([]),[d,f]=Y.useState(!1),[p,v]=Y.useState(!1),[_,N]=Y.useState(!1),[j,C]=Y.useState({email:"",name:"",role:Es.CLIENTE});Y.useEffect(()=>{n&&e?.role==="admin"&&b()},[n,e]);const b=async()=>{f(!0);try{const U=await D2(n.uid);U.success?c(U.invitations):console.error("Error loading invitations:",U.error)}catch(U){console.error("Error loading invitations:",U)}finally{f(!1)}},M=async U=>{U.preventDefault(),N(!0);try{const F=await I2(j,n.uid);F.success?(C({email:"",name:"",role:Es.CLIENTE}),v(!1),await b(),alert(`Invitación creada exitosamente!
Código: ${F.invitation.code}`)):alert(`Error: ${F.error}`)}catch(F){console.error("Error creating invitation:",F),alert("Error creando invitación")}finally{N(!1)}},T=async U=>{if(confirm("¿Estás seguro de cancelar esta invitación?"))try{const F=await O2(U,n.uid);F.success?(await b(),alert("Invitación cancelada exitosamente")):alert(`Error: ${F.error}`)}catch(F){console.error("Error cancelling invitation:",F),alert("Error cancelando invitación")}},L=U=>({pending:{text:"Pendiente",class:"status-pending"},used:{text:"Usada",class:"status-used"},cancelled:{text:"Cancelada",class:"status-cancelled"},expired:{text:"Expirada",class:"status-expired"}})[U]||{text:U,class:"status-unknown"},$=U=>({admin:"Administrador",contador:"Contador",cliente:"Cliente"})[U]||U,O=U=>U?(U.toDate?U.toDate():new Date(U)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e?.role!=="admin"?r.jsxs("div",{className:"admin-unauthorized",children:[r.jsx("h2",{children:"⛔ Acceso Denegado"}),r.jsx("p",{children:"Solo los administradores pueden acceder a esta sección."})]}):r.jsxs("div",{className:"admin-main",children:[r.jsxs("div",{className:"admin-header",children:[r.jsx("h1",{children:"⚙️ Administración del Sistema"}),r.jsx("p",{children:"Gestión de usuarios y configuraciones"})]}),r.jsxs("div",{className:"admin-tabs",children:[r.jsx("button",{className:`tab-button ${t==="invitations"?"active":""}`,onClick:()=>a("invitations"),children:"🎫 Invitaciones"}),r.jsx("button",{className:`tab-button ${t==="users"?"active":""}`,onClick:()=>a("users"),children:"👥 Usuarios"}),r.jsx("button",{className:`tab-button ${t==="settings"?"active":""}`,onClick:()=>a("settings"),children:"⚙️ Configuración"})]}),r.jsxs("div",{className:"admin-content",children:[t==="invitations"&&r.jsxs("div",{className:"invitations-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h2",{children:"Gestión de Invitaciones"}),r.jsx("button",{className:"create-button",onClick:()=>v(!0),children:"+ Crear Invitación"})]}),d?r.jsx("div",{className:"loading",children:"Cargando invitaciones..."}):r.jsxs("div",{className:"invitations-table",children:[r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Código"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Rol"}),r.jsx("th",{children:"Estado"}),r.jsx("th",{children:"Creada"}),r.jsx("th",{children:"Expira"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(U=>{const F=L(U.status);return r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("code",{className:"invitation-code",children:U.code})}),r.jsx("td",{children:U.targetEmail}),r.jsx("td",{children:U.targetName||"-"}),r.jsx("td",{children:$(U.targetRole)}),r.jsx("td",{children:r.jsx("span",{className:`status-badge ${F.class}`,children:F.text})}),r.jsx("td",{children:O(U.createdAt)}),r.jsx("td",{children:O(U.expiresAt)}),r.jsx("td",{children:U.status==="pending"&&r.jsx("button",{className:"cancel-button",onClick:()=>T(U.id),children:"Cancelar"})})]},U.id)})})]}),o.length===0&&r.jsx("div",{className:"empty-state",children:r.jsx("p",{children:"No hay invitaciones creadas"})})]})]}),t==="users"&&r.jsxs("div",{className:"users-section",children:[r.jsx("h2",{children:"👥 Usuarios del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Lista de usuarios registrados, edición de permisos, y estadísticas."})]})]}),t==="settings"&&r.jsxs("div",{className:"settings-section",children:[r.jsx("h2",{children:"⚙️ Configuración del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Configuraciones generales, notificaciones, y parámetros del sistema."})]})]})]}),p&&r.jsx("div",{className:"modal-overlay",onClick:()=>v(!1),children:r.jsxs("div",{className:"modal-content",onClick:U=>U.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Crear Nueva Invitación"}),r.jsx("button",{className:"modal-close",onClick:()=>v(!1),children:"×"})]}),r.jsxs("form",{onSubmit:M,className:"invitation-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email del usuario:"}),r.jsx("input",{id:"email",type:"email",required:!0,value:j.email,onChange:U=>C({...j,email:U.target.value}),placeholder:"usuario@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Nombre (opcional):"}),r.jsx("input",{id:"name",type:"text",value:j.name,onChange:U=>C({...j,name:U.target.value}),placeholder:"Nombre del usuario"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"role",children:"Rol:"}),r.jsxs("select",{id:"role",value:j.role,onChange:U=>C({...j,role:U.target.value}),children:[r.jsx("option",{value:Es.CLIENTE,children:"Cliente"}),r.jsx("option",{value:Es.CONTADOR,children:"Contador"}),r.jsx("option",{value:Es.ADMIN,children:"Administrador"})]})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"cancel-button",onClick:()=>v(!1),children:"Cancelar"}),r.jsx("button",{type:"submit",className:"create-button",disabled:_,children:_?"Creando...":"Crear Invitación"})]})]})]})})]})},QL=()=>r.jsxs("div",{className:"module-placeholder",children:[r.jsx("h2",{children:"📋 Módulo de Reportes"}),r.jsx("p",{children:"Análisis y reportes de combustibles"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Reportes personalizables, gráficos interactivos, y exportación."})]})]}),XL=()=>{const[n,e]=Y.useState("dashboard"),t=()=>{switch(n){case"dashboard":return r.jsx(Tx,{});case"inventory":return r.jsx(oL,{});case"movements":return r.jsx(_L,{});case"vehicles":return r.jsx(SL,{});case"maintenance":return r.jsx(VL,{});case"products":return r.jsx(qL,{});case"suppliers":return r.jsx(YL,{});case"reports":return r.jsx(QL,{});case"admin":return r.jsx(KL,{});default:return r.jsx(Tx,{})}};return r.jsx(k2,{currentView:n,onViewChange:e,children:t()})},WL=()=>{const[n,e]=Y.useState("login"),[t,a]=Y.useState(!1),[o,c]=Y.useState(""),[d,f]=Y.useState(""),[p,v]=Y.useState(""),[_,N]=Y.useState(""),[j,C]=Y.useState({email:"",password:"",confirmPassword:"",invitationCode:""}),[b,M]=Y.useState(""),[T,L]=Y.useState(null),$=async R=>{R.preventDefault(),a(!0),c("");try{await FI(qc,p,_)}catch(I){console.error("Error en login:",I),c(X(I.code))}finally{a(!1)}},O=async()=>{a(!0),c("");try{const R=new ja,I=await uR(qc,R);T?await Ex(I.user,T.code):await aj(I.user)}catch(R){console.error("Error en login con Google:",R),c("Error al iniciar sesión con Google")}finally{a(!1)}},U=async R=>{R.preventDefault(),a(!0),c(""),f("");try{const I=await sj(b);I.success?(L(I.invitation),f(`Invitación válida para: ${I.invitation.targetEmail}`),e("register"),C({...j,email:I.invitation.targetEmail,invitationCode:b})):c(I.error)}catch(I){console.error("Error validando invitación:",I),c("Error validando código de invitación")}finally{a(!1)}},F=async R=>{if(R.preventDefault(),a(!0),c(""),j.password!==j.confirmPassword){c("Las contraseñas no coinciden"),a(!1);return}if(j.password.length<6){c("La contraseña debe tener al menos 6 caracteres"),a(!1);return}try{const I=await UI(qc,j.email,j.password),P=await Ex(I.user,j.invitationCode);P.success?f("¡Registro exitoso! Bienvenido al sistema."):c(P.error)}catch(I){console.error("Error en registro:",I),c(X(I.code))}finally{a(!1)}},X=R=>{switch(R){case"auth/invalid-email":return"El formato del email es inválido";case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contraseña incorrecta";case"auth/invalid-credential":return"Email o contraseña incorrectos";case"auth/email-already-in-use":return"Este email ya está registrado";case"auth/weak-password":return"La contraseña es muy débil";default:return"Error de autenticación. Inténtalo de nuevo."}},w=()=>{c(""),f(""),v(""),N(""),M(""),L(null),C({email:"",password:"",confirmPassword:"",invitationCode:""})},A=()=>{switch(n){case"login":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:$,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email:"}),r.jsx("input",{id:"email",type:"email",value:p,onChange:R=>v(R.target.value),required:!0,disabled:t,placeholder:"tu-email@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Contraseña:"}),r.jsx("input",{id:"password",type:"password",value:_,onChange:R=>N(R.target.value),required:!0,disabled:t,placeholder:"Tu contraseña"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Iniciando sesión...":"Iniciar Sesión"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:O,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:"🔗"}),"Continuar con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{w(),e("invite")},children:"¿Tienes un código de invitación? Regístrate aquí"})})]});case"invite":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:U,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"inviteCode",children:"Código de invitación:"}),r.jsx("input",{id:"inviteCode",type:"text",value:b,onChange:R=>M(R.target.value.toUpperCase()),required:!0,disabled:t,placeholder:"XXXXXXXX",maxLength:8,style:{textTransform:"uppercase",fontFamily:"monospace"}}),r.jsx("small",{children:"Ingresa el código de 8 caracteres que recibiste"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Validando...":"Validar Código"})]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{w(),e("login")},children:"Volver al inicio de sesión"})})]});case"register":return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"invitation-info",children:r.jsxs("div",{className:"success-message",children:["✅ Código válido para: ",T?.targetEmail]})}),r.jsxs("form",{onSubmit:F,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerEmail",children:"Email:"}),r.jsx("input",{id:"registerEmail",type:"email",value:j.email,disabled:!0,className:"disabled-input"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerPassword",children:"Contraseña:"}),r.jsx("input",{id:"registerPassword",type:"password",value:j.password,onChange:R=>C({...j,password:R.target.value}),required:!0,disabled:t,placeholder:"Mínimo 6 caracteres",minLength:6})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar contraseña:"}),r.jsx("input",{id:"confirmPassword",type:"password",value:j.confirmPassword,onChange:R=>C({...j,confirmPassword:R.target.value}),required:!0,disabled:t,placeholder:"Repite tu contraseña"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Registrando...":"Crear Cuenta"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:O,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:"🔗"}),"Registrarse con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{w(),e("invite")},children:"Usar otro código de invitación"})})]});default:return null}};return r.jsx("div",{className:"auth-container",children:r.jsxs("div",{className:"auth-card",children:[r.jsxs("div",{className:"auth-header",children:[r.jsx("h1",{children:"⛽ Combustibles"}),r.jsx("h2",{children:"Forestech Colombia"}),r.jsxs("p",{children:[n==="login"&&"Sistema de gestión de combustibles",n==="invite"&&"Validar código de invitación",n==="register"&&"Crear nueva cuenta"]})]}),r.jsxs("div",{className:"auth-form",children:[o&&r.jsx("div",{className:"error-message",children:o}),d&&r.jsx("div",{className:"success-message",children:d}),A(),r.jsx("div",{className:"auth-footer",children:r.jsx("p",{children:r.jsxs("small",{children:["Solo usuarios autorizados pueden acceder al sistema.",r.jsx("br",{}),n==="login"?"Contacta al administrador para obtener un código de invitación.":"Si no tienes código, contacta al administrador."]})})})]})]})})};function ZL(){return r.jsx(P2,{children:r.jsx(JL,{})})}function JL(){const{user:n,loading:e}=Zs();return e?r.jsx("div",{className:"loading-container",children:r.jsxs("div",{className:"loader",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Cargando..."})]})}):r.jsxs("div",{className:"App",children:[!n&&r.jsx(WL,{}),n&&r.jsx(XL,{})]})}iS.createRoot(document.getElementById("root")).render(r.jsx(Y.StrictMode,{children:r.jsx(ZL,{})}));
