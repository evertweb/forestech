(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var bp={exports:{}},xc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hE;function _C(){if(hE)return xc;hE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var m in o)m!=="key"&&(c[m]=o[m])}else c=o;return o=c.ref,{$$typeof:n,type:a,key:d,ref:o!==void 0?o:null,props:c}}return xc.Fragment=e,xc.jsx=t,xc.jsxs=t,xc}var fE;function bC(){return fE||(fE=1,bp.exports=_C()),bp.exports}var r=bC(),Ep={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mE;function EC(){if(mE)return Le;mE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),b=Symbol.iterator;function T(q){return q===null||typeof q!="object"?null:(q=b&&q[b]||q["@@iterator"],typeof q=="function"?q:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,C={};function w(q,ee,ce){this.props=q,this.context=ee,this.refs=C,this.updater=ce||j}w.prototype.isReactComponent={},w.prototype.setState=function(q,ee){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,ee,"setState")},w.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function F(){}F.prototype=w.prototype;function H(q,ee,ce){this.props=q,this.context=ee,this.refs=C,this.updater=ce||j}var V=H.prototype=new F;V.constructor=H,x(V,w.prototype),V.isPureReactComponent=!0;var k=Array.isArray,U={H:null,A:null,T:null,S:null,V:null},Q=Object.prototype.hasOwnProperty;function L(q,ee,ce,ue,Ne,qe){return ce=qe.ref,{$$typeof:n,type:q,key:ee,ref:ce!==void 0?ce:null,props:qe}}function R(q,ee){return L(q.type,ee,void 0,void 0,void 0,q.props)}function P(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function D(q){var ee={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(ce){return ee[ce]})}var A=/\/+/g;function I(q,ee){return typeof q=="object"&&q!==null&&q.key!=null?D(""+q.key):ee.toString(36)}function O(){}function _e(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(O,O):(q.status="pending",q.then(function(ee){q.status==="pending"&&(q.status="fulfilled",q.value=ee)},function(ee){q.status==="pending"&&(q.status="rejected",q.reason=ee)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function Se(q,ee,ce,ue,Ne){var qe=typeof q;(qe==="undefined"||qe==="boolean")&&(q=null);var Re=!1;if(q===null)Re=!0;else switch(qe){case"bigint":case"string":case"number":Re=!0;break;case"object":switch(q.$$typeof){case n:case e:Re=!0;break;case _:return Re=q._init,Se(Re(q._payload),ee,ce,ue,Ne)}}if(Re)return Ne=Ne(q),Re=ue===""?"."+I(q,0):ue,k(Ne)?(ce="",Re!=null&&(ce=Re.replace(A,"$&/")+"/"),Se(Ne,ee,ce,"",function(As){return As})):Ne!=null&&(P(Ne)&&(Ne=R(Ne,ce+(Ne.key==null||q&&q.key===Ne.key?"":(""+Ne.key).replace(A,"$&/")+"/")+Re)),ee.push(Ne)),1;Re=0;var zt=ue===""?".":ue+":";if(k(q))for(var mt=0;mt<q.length;mt++)ue=q[mt],qe=zt+I(ue,mt),Re+=Se(ue,ee,ce,qe,Ne);else if(mt=T(q),typeof mt=="function")for(q=mt.call(q),mt=0;!(ue=q.next()).done;)ue=ue.value,qe=zt+I(ue,mt++),Re+=Se(ue,ee,ce,qe,Ne);else if(qe==="object"){if(typeof q.then=="function")return Se(_e(q),ee,ce,ue,Ne);throw ee=String(q),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return Re}function $(q,ee,ce){if(q==null)return q;var ue=[],Ne=0;return Se(q,ue,"","",function(qe){return ee.call(ce,qe,Ne++)}),ue}function z(q){if(q._status===-1){var ee=q._result;ee=ee(),ee.then(function(ce){(q._status===0||q._status===-1)&&(q._status=1,q._result=ce)},function(ce){(q._status===0||q._status===-1)&&(q._status=2,q._result=ce)}),q._status===-1&&(q._status=0,q._result=ee)}if(q._status===1)return q._result.default;throw q._result}var ae=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)};function he(){}return Le.Children={map:$,forEach:function(q,ee,ce){$(q,function(){ee.apply(this,arguments)},ce)},count:function(q){var ee=0;return $(q,function(){ee++}),ee},toArray:function(q){return $(q,function(ee){return ee})||[]},only:function(q){if(!P(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},Le.Component=w,Le.Fragment=t,Le.Profiler=o,Le.PureComponent=H,Le.StrictMode=a,Le.Suspense=p,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,Le.__COMPILER_RUNTIME={__proto__:null,c:function(q){return U.H.useMemoCache(q)}},Le.cache=function(q){return function(){return q.apply(null,arguments)}},Le.cloneElement=function(q,ee,ce){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var ue=x({},q.props),Ne=q.key,qe=void 0;if(ee!=null)for(Re in ee.ref!==void 0&&(qe=void 0),ee.key!==void 0&&(Ne=""+ee.key),ee)!Q.call(ee,Re)||Re==="key"||Re==="__self"||Re==="__source"||Re==="ref"&&ee.ref===void 0||(ue[Re]=ee[Re]);var Re=arguments.length-2;if(Re===1)ue.children=ce;else if(1<Re){for(var zt=Array(Re),mt=0;mt<Re;mt++)zt[mt]=arguments[mt+2];ue.children=zt}return L(q.type,Ne,void 0,void 0,qe,ue)},Le.createContext=function(q){return q={$$typeof:d,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:c,_context:q},q},Le.createElement=function(q,ee,ce){var ue,Ne={},qe=null;if(ee!=null)for(ue in ee.key!==void 0&&(qe=""+ee.key),ee)Q.call(ee,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(Ne[ue]=ee[ue]);var Re=arguments.length-2;if(Re===1)Ne.children=ce;else if(1<Re){for(var zt=Array(Re),mt=0;mt<Re;mt++)zt[mt]=arguments[mt+2];Ne.children=zt}if(q&&q.defaultProps)for(ue in Re=q.defaultProps,Re)Ne[ue]===void 0&&(Ne[ue]=Re[ue]);return L(q,qe,void 0,void 0,null,Ne)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(q){return{$$typeof:m,render:q}},Le.isValidElement=P,Le.lazy=function(q){return{$$typeof:_,_payload:{_status:-1,_result:q},_init:z}},Le.memo=function(q,ee){return{$$typeof:v,type:q,compare:ee===void 0?null:ee}},Le.startTransition=function(q){var ee=U.T,ce={};U.T=ce;try{var ue=q(),Ne=U.S;Ne!==null&&Ne(ce,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(he,ae)}catch(qe){ae(qe)}finally{U.T=ee}},Le.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},Le.use=function(q){return U.H.use(q)},Le.useActionState=function(q,ee,ce){return U.H.useActionState(q,ee,ce)},Le.useCallback=function(q,ee){return U.H.useCallback(q,ee)},Le.useContext=function(q){return U.H.useContext(q)},Le.useDebugValue=function(){},Le.useDeferredValue=function(q,ee){return U.H.useDeferredValue(q,ee)},Le.useEffect=function(q,ee,ce){var ue=U.H;if(typeof ce=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ue.useEffect(q,ee)},Le.useId=function(){return U.H.useId()},Le.useImperativeHandle=function(q,ee,ce){return U.H.useImperativeHandle(q,ee,ce)},Le.useInsertionEffect=function(q,ee){return U.H.useInsertionEffect(q,ee)},Le.useLayoutEffect=function(q,ee){return U.H.useLayoutEffect(q,ee)},Le.useMemo=function(q,ee){return U.H.useMemo(q,ee)},Le.useOptimistic=function(q,ee){return U.H.useOptimistic(q,ee)},Le.useReducer=function(q,ee,ce){return U.H.useReducer(q,ee,ce)},Le.useRef=function(q){return U.H.useRef(q)},Le.useState=function(q){return U.H.useState(q)},Le.useSyncExternalStore=function(q,ee,ce){return U.H.useSyncExternalStore(q,ee,ce)},Le.useTransition=function(){return U.H.useTransition()},Le.version="19.1.0",Le}var pE;function Ag(){return pE||(pE=1,Ep.exports=EC()),Ep.exports}var Y=Ag(),Np={exports:{}},Tc={},xp={exports:{}},Tp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gE;function NC(){return gE||(gE=1,function(n){function e($,z){var ae=$.length;$.push(z);e:for(;0<ae;){var he=ae-1>>>1,q=$[he];if(0<o(q,z))$[he]=z,$[ae]=q,ae=he;else break e}}function t($){return $.length===0?null:$[0]}function a($){if($.length===0)return null;var z=$[0],ae=$.pop();if(ae!==z){$[0]=ae;e:for(var he=0,q=$.length,ee=q>>>1;he<ee;){var ce=2*(he+1)-1,ue=$[ce],Ne=ce+1,qe=$[Ne];if(0>o(ue,ae))Ne<q&&0>o(qe,ue)?($[he]=qe,$[Ne]=ae,he=Ne):($[he]=ue,$[ce]=ae,he=ce);else if(Ne<q&&0>o(qe,ae))$[he]=qe,$[Ne]=ae,he=Ne;else break e}}return z}function o($,z){var ae=$.sortIndex-z.sortIndex;return ae!==0?ae:$.id-z.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,m=d.now();n.unstable_now=function(){return d.now()-m}}var p=[],v=[],_=1,b=null,T=3,j=!1,x=!1,C=!1,w=!1,F=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;function k($){for(var z=t(v);z!==null;){if(z.callback===null)a(v);else if(z.startTime<=$)a(v),z.sortIndex=z.expirationTime,e(p,z);else break;z=t(v)}}function U($){if(C=!1,k($),!x)if(t(p)!==null)x=!0,Q||(Q=!0,I());else{var z=t(v);z!==null&&Se(U,z.startTime-$)}}var Q=!1,L=-1,R=5,P=-1;function D(){return w?!0:!(n.unstable_now()-P<R)}function A(){if(w=!1,Q){var $=n.unstable_now();P=$;var z=!0;try{e:{x=!1,C&&(C=!1,H(L),L=-1),j=!0;var ae=T;try{t:{for(k($),b=t(p);b!==null&&!(b.expirationTime>$&&D());){var he=b.callback;if(typeof he=="function"){b.callback=null,T=b.priorityLevel;var q=he(b.expirationTime<=$);if($=n.unstable_now(),typeof q=="function"){b.callback=q,k($),z=!0;break t}b===t(p)&&a(p),k($)}else a(p);b=t(p)}if(b!==null)z=!0;else{var ee=t(v);ee!==null&&Se(U,ee.startTime-$),z=!1}}break e}finally{b=null,T=ae,j=!1}z=void 0}}finally{z?I():Q=!1}}}var I;if(typeof V=="function")I=function(){V(A)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,_e=O.port2;O.port1.onmessage=A,I=function(){_e.postMessage(null)}}else I=function(){F(A,0)};function Se($,z){L=F(function(){$(n.unstable_now())},z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function($){switch(T){case 1:case 2:case 3:var z=3;break;default:z=T}var ae=T;T=z;try{return $()}finally{T=ae}},n.unstable_requestPaint=function(){w=!0},n.unstable_runWithPriority=function($,z){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ae=T;T=$;try{return z()}finally{T=ae}},n.unstable_scheduleCallback=function($,z,ae){var he=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?he+ae:he):ae=he,$){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=ae+q,$={id:_++,callback:z,priorityLevel:$,startTime:ae,expirationTime:q,sortIndex:-1},ae>he?($.sortIndex=ae,e(v,$),t(p)===null&&$===t(v)&&(C?(H(L),L=-1):C=!0,Se(U,ae-he))):($.sortIndex=q,e(p,$),x||j||(x=!0,Q||(Q=!0,I()))),$},n.unstable_shouldYield=D,n.unstable_wrapCallback=function($){var z=T;return function(){var ae=T;T=z;try{return $.apply(this,arguments)}finally{T=ae}}}}(Tp)),Tp}var vE;function xC(){return vE||(vE=1,xp.exports=NC()),xp.exports}var Ap={exports:{}},dn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yE;function TC(){if(yE)return dn;yE=1;var n=Ag();function e(p){var v="https://react.dev/errors/"+p;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)v+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,v,_){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:b==null?null:""+b,children:p,containerInfo:v,implementation:_}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(p,v){if(p==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,dn.createPortal=function(p,v){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(e(299));return c(p,v,null,_)},dn.flushSync=function(p){var v=d.T,_=a.p;try{if(d.T=null,a.p=2,p)return p()}finally{d.T=v,a.p=_,a.d.f()}},dn.preconnect=function(p,v){typeof p=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,a.d.C(p,v))},dn.prefetchDNS=function(p){typeof p=="string"&&a.d.D(p)},dn.preinit=function(p,v){if(typeof p=="string"&&v&&typeof v.as=="string"){var _=v.as,b=m(_,v.crossOrigin),T=typeof v.integrity=="string"?v.integrity:void 0,j=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;_==="style"?a.d.S(p,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:b,integrity:T,fetchPriority:j}):_==="script"&&a.d.X(p,{crossOrigin:b,integrity:T,fetchPriority:j,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},dn.preinitModule=function(p,v){if(typeof p=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var _=m(v.as,v.crossOrigin);a.d.M(p,{crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&a.d.M(p)},dn.preload=function(p,v){if(typeof p=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var _=v.as,b=m(_,v.crossOrigin);a.d.L(p,_,{crossOrigin:b,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},dn.preloadModule=function(p,v){if(typeof p=="string")if(v){var _=m(v.as,v.crossOrigin);a.d.m(p,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else a.d.m(p)},dn.requestFormReset=function(p){a.d.r(p)},dn.unstable_batchedUpdates=function(p,v){return p(v)},dn.useFormState=function(p,v,_){return d.H.useFormState(p,v,_)},dn.useFormStatus=function(){return d.H.useHostTransitionStatus()},dn.version="19.1.0",dn}var _E;function AC(){if(_E)return Ap.exports;_E=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ap.exports=TC(),Ap.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bE;function jC(){if(bE)return Tc;bE=1;var n=xC(),e=Ag(),t=AC();function a(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var i=s,l=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(l=i.return),s=i.return;while(s)}return i.tag===3?l:null}function d(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function m(s){if(c(s)!==s)throw Error(a(188))}function p(s){var i=s.alternate;if(!i){if(i=c(s),i===null)throw Error(a(188));return i!==s?null:s}for(var l=s,u=i;;){var f=l.return;if(f===null)break;var g=f.alternate;if(g===null){if(u=f.return,u!==null){l=u;continue}break}if(f.child===g.child){for(g=f.child;g;){if(g===l)return m(f),s;if(g===u)return m(f),i;g=g.sibling}throw Error(a(188))}if(l.return!==u.return)l=f,u=g;else{for(var N=!1,S=f.child;S;){if(S===l){N=!0,l=f,u=g;break}if(S===u){N=!0,u=f,l=g;break}S=S.sibling}if(!N){for(S=g.child;S;){if(S===l){N=!0,l=g,u=f;break}if(S===u){N=!0,u=g,l=f;break}S=S.sibling}if(!N)throw Error(a(189))}}if(l.alternate!==u)throw Error(a(190))}if(l.tag!==3)throw Error(a(188));return l.stateNode.current===l?s:i}function v(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=v(s),i!==null)return i;s=s.sibling}return null}var _=Object.assign,b=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),H=Symbol.for("react.consumer"),V=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function I(s){return s===null||typeof s!="object"?null:(s=A&&s[A]||s["@@iterator"],typeof s=="function"?s:null)}var O=Symbol.for("react.client.reference");function _e(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===O?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case x:return"Fragment";case w:return"Profiler";case C:return"StrictMode";case U:return"Suspense";case Q:return"SuspenseList";case P:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case j:return"Portal";case V:return(s.displayName||"Context")+".Provider";case H:return(s._context.displayName||"Context")+".Consumer";case k:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case L:return i=s.displayName||null,i!==null?i:_e(s.type)||"Memo";case R:i=s._payload,s=s._init;try{return _e(s(i))}catch{}}return null}var Se=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},he=[],q=-1;function ee(s){return{current:s}}function ce(s){0>q||(s.current=he[q],he[q]=null,q--)}function ue(s,i){q++,he[q]=s.current,s.current=i}var Ne=ee(null),qe=ee(null),Re=ee(null),zt=ee(null);function mt(s,i){switch(ue(Re,i),ue(qe,s),ue(Ne,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?Fb(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=Fb(i),s=qb(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ce(Ne),ue(Ne,s)}function As(){ce(Ne),ce(qe),ce(Re)}function ka(s){s.memoizedState!==null&&ue(zt,s);var i=Ne.current,l=qb(i,s.type);i!==l&&(ue(qe,s),ue(Ne,l))}function Zs(s){qe.current===s&&(ce(Ne),ce(qe)),zt.current===s&&(ce(zt),yc._currentValue=ae)}var Vi=Object.prototype.hasOwnProperty,Ui=n.unstable_scheduleCallback,Fi=n.unstable_cancelCallback,pl=n.unstable_shouldYield,Eu=n.unstable_requestPaint,Yn=n.unstable_now,bf=n.unstable_getCurrentPriorityLevel,gl=n.unstable_ImmediatePriority,qr=n.unstable_UserBlockingPriority,qi=n.unstable_NormalPriority,Ef=n.unstable_LowPriority,Br=n.unstable_IdlePriority,vl=n.log,Nu=n.unstable_setDisableYieldValue,xt=null,at=null;function Mn(s){if(typeof vl=="function"&&Nu(s),at&&typeof at.setStrictMode=="function")try{at.setStrictMode(xt,s)}catch{}}var cn=Math.clz32?Math.clz32:Bi,xu=Math.log,Nf=Math.LN2;function Bi(s){return s>>>=0,s===0?32:31-(xu(s)/Nf|0)|0}var Hi=256,zi=4194304;function us(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Hr(s,i,l){var u=s.pendingLanes;if(u===0)return 0;var f=0,g=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var S=u&134217727;return S!==0?(u=S&~g,u!==0?f=us(u):(N&=S,N!==0?f=us(N):l||(l=S&~s,l!==0&&(f=us(l))))):(S=u&~g,S!==0?f=us(S):N!==0?f=us(N):l||(l=u&~s,l!==0&&(f=us(l)))),f===0?0:i!==0&&i!==f&&(i&g)===0&&(g=f&-f,l=i&-i,g>=l||g===32&&(l&4194048)!==0)?i:f}function Gi(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function yl(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _l(){var s=Hi;return Hi<<=1,(Hi&4194048)===0&&(Hi=256),s}function bl(){var s=zi;return zi<<=1,(zi&62914560)===0&&(zi=4194304),s}function Js(s){for(var i=[],l=0;31>l;l++)i.push(s);return i}function ea(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function El(s,i,l,u,f,g){var N=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var S=s.entanglements,B=s.expirationTimes,Z=s.hiddenUpdates;for(l=N&~l;0<l;){var se=31-cn(l),oe=1<<se;S[se]=0,B[se]=-1;var J=Z[se];if(J!==null)for(Z[se]=null,se=0;se<J.length;se++){var te=J[se];te!==null&&(te.lane&=-536870913)}l&=~oe}u!==0&&js(s,u,0),g!==0&&f===0&&s.tag!==0&&(s.suspendedLanes|=g&~(N&~i))}function js(s,i,l){s.pendingLanes|=i,s.suspendedLanes&=~i;var u=31-cn(i);s.entangledLanes|=i,s.entanglements[u]=s.entanglements[u]|1073741824|l&4194090}function Nl(s,i){var l=s.entangledLanes|=i;for(s=s.entanglements;l;){var u=31-cn(l),f=1<<u;f&i|s[u]&i&&(s[u]|=i),l&=~f}}function Pa(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function zr(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function La(){var s=z.p;return s!==0?s:(s=window.event,s===void 0?32:rE(s.type))}function Tu(s,i){var l=z.p;try{return z.p=s,i()}finally{z.p=l}}var _t=Math.random().toString(36).slice(2),Pt="__reactFiber$"+_t,It="__reactProps$"+_t,Kn="__reactContainer$"+_t,xl="__reactEvents$"+_t,xf="__reactListeners$"+_t,Va="__reactHandles$"+_t,Au="__reactResources$"+_t,$i="__reactMarker$"+_t;function Ua(s){delete s[Pt],delete s[It],delete s[xl],delete s[xf],delete s[Va]}function ta(s){var i=s[Pt];if(i)return i;for(var l=s.parentNode;l;){if(i=l[Kn]||l[Pt]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(s=Gb(s);s!==null;){if(l=s[Pt])return l;s=Gb(s)}return i}s=l,l=s.parentNode}return null}function ws(s){if(s=s[Pt]||s[Kn]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function Cs(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(a(33))}function vn(s){var i=s[Au];return i||(i=s[Au]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function jt(s){s[$i]=!0}var Tl=new Set,Gr={};function ds(s,i){na(s,i),na(s+"Capture",i)}function na(s,i){for(Gr[s]=i,s=0;s<i.length;s++)Tl.add(i[s])}var ju=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wu={},Yi={};function Cu(s){return Vi.call(Yi,s)?!0:Vi.call(wu,s)?!1:ju.test(s)?Yi[s]=!0:(wu[s]=!0,!1)}function Fa(s,i,l){if(Cu(i))if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+l)}}function Ss(s,i,l){if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+l)}}function Zt(s,i,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(i,l,""+u)}}var Ki,Su;function sa(s){if(Ki===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);Ki=i&&i[1]||"",Su=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ki+s+Su}var $r=!1;function Yr(s,i){if(!s||$r)return"";$r=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(te){var J=te}Reflect.construct(s,[],oe)}else{try{oe.call()}catch(te){J=te}s.call(oe.prototype)}}else{try{throw Error()}catch(te){J=te}(oe=s())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(te){if(te&&J&&typeof te.stack=="string")return[te.stack,J.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),N=g[0],S=g[1];if(N&&S){var B=N.split(`
`),Z=S.split(`
`);for(f=u=0;u<B.length&&!B[u].includes("DetermineComponentFrameRoot");)u++;for(;f<Z.length&&!Z[f].includes("DetermineComponentFrameRoot");)f++;if(u===B.length||f===Z.length)for(u=B.length-1,f=Z.length-1;1<=u&&0<=f&&B[u]!==Z[f];)f--;for(;1<=u&&0<=f;u--,f--)if(B[u]!==Z[f]){if(u!==1||f!==1)do if(u--,f--,0>f||B[u]!==Z[f]){var se=`
`+B[u].replace(" at new "," at ");return s.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",s.displayName)),se}while(1<=u&&0<=f);break}}}finally{$r=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?sa(l):""}function Al(s){switch(s.tag){case 26:case 27:case 5:return sa(s.type);case 16:return sa("Lazy");case 13:return sa("Suspense");case 19:return sa("SuspenseList");case 0:case 15:return Yr(s.type,!1);case 11:return Yr(s.type.render,!1);case 1:return Yr(s.type,!0);case 31:return sa("Activity");default:return""}}function Kr(s){try{var i="";do i+=Al(s),s=s.return;while(s);return i}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function yn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function jl(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Tf(s){var i=jl(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),u=""+s[i];if(!s.hasOwnProperty(i)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var f=l.get,g=l.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return f.call(this)},set:function(N){u=""+N,g.call(this,N)}}),Object.defineProperty(s,i,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(N){u=""+N},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Qr(s){s._valueTracker||(s._valueTracker=Tf(s))}function wl(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var l=i.getValue(),u="";return s&&(u=jl(s)?s.checked?"true":"false":s.value),s=u,s!==l?(i.setValue(s),!0):!1}function Qi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Af=/[\n"\\]/g;function Rt(s){return s.replace(Af,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function On(s,i,l,u,f,g,N,S){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),i!=null?N==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+yn(i)):s.value!==""+yn(i)&&(s.value=""+yn(i)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),i!=null?qa(s,N,yn(i)):l!=null?qa(s,N,yn(l)):u!=null&&s.removeAttribute("value"),f==null&&g!=null&&(s.defaultChecked=!!g),f!=null&&(s.checked=f&&typeof f!="function"&&typeof f!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+yn(S):s.removeAttribute("name")}function Xi(s,i,l,u,f,g,N,S){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(s.type=g),i!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||i!=null))return;l=l!=null?""+yn(l):"",i=i!=null?""+yn(i):l,S||i===s.value||(s.value=i),s.defaultValue=i}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=S?s.checked:!!u,s.defaultChecked=!!u,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N)}function qa(s,i,l){i==="number"&&Qi(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function aa(s,i,l,u){if(s=s.options,i){i={};for(var f=0;f<l.length;f++)i["$"+l[f]]=!0;for(l=0;l<s.length;l++)f=i.hasOwnProperty("$"+s[l].value),s[l].selected!==f&&(s[l].selected=f),f&&u&&(s[l].defaultSelected=!0)}else{for(l=""+yn(l),i=null,f=0;f<s.length;f++){if(s[f].value===l){s[f].selected=!0,u&&(s[f].defaultSelected=!0);return}i!==null||s[f].disabled||(i=s[f])}i!==null&&(i.selected=!0)}}function ot(s,i,l){if(i!=null&&(i=""+yn(i),i!==s.value&&(s.value=i),l==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=l!=null?""+yn(l):""}function Wi(s,i,l,u){if(i==null){if(u!=null){if(l!=null)throw Error(a(92));if(Se(u)){if(1<u.length)throw Error(a(93));u=u[0]}l=u}l==null&&(l=""),i=l}l=yn(i),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u)}function Qn(s,i){if(i){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=i;return}}s.textContent=i}var Zi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Iu(s,i,l){var u=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":u?s.setProperty(i,l):typeof l!="number"||l===0||Zi.has(i)?i==="float"?s.cssFloat=l:s[i]=(""+l).trim():s[i]=l+"px"}function Cl(s,i,l){if(i!=null&&typeof i!="object")throw Error(a(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var f in i)u=i[f],i.hasOwnProperty(f)&&l[f]!==u&&Iu(s,f,u)}else for(var g in i)i.hasOwnProperty(g)&&Iu(s,g,i[g])}function Sl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xr(s){return wf.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var ia=null;function Xn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ra=null,oa=null;function Il(s){var i=ws(s);if(i&&(s=i.stateNode)){var l=s[It]||null;e:switch(s=i.stateNode,i.type){case"input":if(On(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Rt(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var u=l[i];if(u!==s&&u.form===s.form){var f=u[It]||null;if(!f)throw Error(a(90));On(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(i=0;i<l.length;i++)u=l[i],u.form===s.form&&wl(u)}break e;case"textarea":ot(s,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&aa(s,!!l.multiple,i,!1)}}}var Is=!1;function Ru(s,i,l){if(Is)return s(i,l);Is=!0;try{var u=s(i);return u}finally{if(Is=!1,(ra!==null||oa!==null)&&(Td(),ra&&(i=ra,s=oa,oa=ra=null,Il(i),s)))for(i=0;i<s.length;i++)Il(s[i])}}function Ji(s,i){var l=s.stateNode;if(l===null)return null;var u=l[It]||null;if(u===null)return null;l=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(a(231,i,typeof l));return l}var hs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wn=!1;if(hs)try{var er={};Object.defineProperty(er,"passive",{get:function(){Wn=!0}}),window.addEventListener("test",er,er),window.removeEventListener("test",er,er)}catch{Wn=!1}var Rs=null,Ba=null,la=null;function Rl(){if(la)return la;var s,i=Ba,l=i.length,u,f="value"in Rs?Rs.value:Rs.textContent,g=f.length;for(s=0;s<l&&i[s]===f[s];s++);var N=l-s;for(u=1;u<=N&&i[l-u]===f[g-u];u++);return la=f.slice(s,1<u?1-u:void 0)}function Ds(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Ms(){return!0}function Dl(){return!1}function Gt(s){function i(l,u,f,g,N){this._reactName=l,this._targetInst=f,this.type=u,this.nativeEvent=g,this.target=N,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(l=s[S],this[S]=l?l(g):g[S]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Ms:Dl,this.isPropagationStopped=Dl,this}return _(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ms)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ms)},persist:function(){},isPersistent:Ms}),i}var nt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wr=Gt(nt),tr=_({},nt,{view:0,detail:0}),Du=Gt(tr),Zr,Jr,Os,nr=_({},tr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ir,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Os&&(Os&&s.type==="mousemove"?(Zr=s.screenX-Os.screenX,Jr=s.screenY-Os.screenY):Jr=Zr=0,Os=s),Zr)},movementY:function(s){return"movementY"in s?s.movementY:Jr}}),Zn=Gt(nr),Mu=_({},nr,{dataTransfer:0}),Cf=Gt(Mu),sr=_({},tr,{relatedTarget:0}),eo=Gt(sr),Ml=_({},nt,{animationName:0,elapsedTime:0,pseudoElement:0}),to=Gt(Ml),Ou=_({},nt,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),no=Gt(Ou),Sf=_({},nt,{data:0}),Ol=Gt(Sf),ar={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ku={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kl(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Pu[s])?!!i[s]:!1}function ir(){return kl}var Lu=_({},tr,{key:function(s){if(s.key){var i=ar[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ds(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ku[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ir,charCode:function(s){return s.type==="keypress"?Ds(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ds(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),so=Gt(Lu),Vu=_({},nr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pl=Gt(Vu),ca=_({},tr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ir}),Uu=Gt(ca),Fu=_({},nt,{propertyName:0,elapsedTime:0,pseudoElement:0}),qu=Gt(Fu),Bu=_({},nr,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ao=Gt(Bu),_n=_({},nt,{newState:0,oldState:0}),Hu=Gt(_n),zu=[9,13,27,32],ks=hs&&"CompositionEvent"in window,h=null;hs&&"documentMode"in document&&(h=document.documentMode);var y=hs&&"TextEvent"in window&&!h,E=hs&&(!ks||h&&8<h&&11>=h),M=" ",X=!1;function ne(s,i){switch(s){case"keyup":return zu.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function de(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ke=!1;function Lt(s,i){switch(s){case"compositionend":return de(i);case"keypress":return i.which!==32?null:(X=!0,M);case"textInput":return s=i.data,s===M&&X?null:s;default:return null}}function Qe(s,i){if(Ke)return s==="compositionend"||!ks&&ne(s,i)?(s=Rl(),la=Ba=Rs=null,Ke=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return E&&i.locale!=="ko"?null:i.data;default:return null}}var $t={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vt(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!$t[s.type]:i==="textarea"}function ua(s,i,l,u){ra?oa?oa.push(u):oa=[u]:ra=u,i=Id(i,"onChange"),0<i.length&&(l=new Wr("onChange","change",null,l,u),s.push({event:l,listeners:i}))}var Jt=null,Ps=null;function Ll(s){kb(s,0)}function Gu(s){var i=Cs(s);if(wl(i))return s}function ny(s,i){if(s==="change")return i}var sy=!1;if(hs){var If;if(hs){var Rf="oninput"in document;if(!Rf){var ay=document.createElement("div");ay.setAttribute("oninput","return;"),Rf=typeof ay.oninput=="function"}If=Rf}else If=!1;sy=If&&(!document.documentMode||9<document.documentMode)}function iy(){Jt&&(Jt.detachEvent("onpropertychange",ry),Ps=Jt=null)}function ry(s){if(s.propertyName==="value"&&Gu(Ps)){var i=[];ua(i,Ps,s,Xn(s)),Ru(Ll,i)}}function Qj(s,i,l){s==="focusin"?(iy(),Jt=i,Ps=l,Jt.attachEvent("onpropertychange",ry)):s==="focusout"&&iy()}function Xj(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Gu(Ps)}function Wj(s,i){if(s==="click")return Gu(i)}function Zj(s,i){if(s==="input"||s==="change")return Gu(i)}function Jj(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var kn=typeof Object.is=="function"?Object.is:Jj;function Vl(s,i){if(kn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var l=Object.keys(s),u=Object.keys(i);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var f=l[u];if(!Vi.call(i,f)||!kn(s[f],i[f]))return!1}return!0}function oy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ly(s,i){var l=oy(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=i&&u>=i)return{node:l,offset:i-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=oy(l)}}function cy(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?cy(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function uy(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Qi(s.document);i instanceof s.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)s=i.contentWindow;else break;i=Qi(s.document)}return i}function Df(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var ew=hs&&"documentMode"in document&&11>=document.documentMode,io=null,Mf=null,Ul=null,Of=!1;function dy(s,i,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Of||io==null||io!==Qi(u)||(u=io,"selectionStart"in u&&Df(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ul&&Vl(Ul,u)||(Ul=u,u=Id(Mf,"onSelect"),0<u.length&&(i=new Wr("onSelect","select",null,i,l),s.push({event:i,listeners:u}),i.target=io)))}function rr(s,i){var l={};return l[s.toLowerCase()]=i.toLowerCase(),l["Webkit"+s]="webkit"+i,l["Moz"+s]="moz"+i,l}var ro={animationend:rr("Animation","AnimationEnd"),animationiteration:rr("Animation","AnimationIteration"),animationstart:rr("Animation","AnimationStart"),transitionrun:rr("Transition","TransitionRun"),transitionstart:rr("Transition","TransitionStart"),transitioncancel:rr("Transition","TransitionCancel"),transitionend:rr("Transition","TransitionEnd")},kf={},hy={};hs&&(hy=document.createElement("div").style,"AnimationEvent"in window||(delete ro.animationend.animation,delete ro.animationiteration.animation,delete ro.animationstart.animation),"TransitionEvent"in window||delete ro.transitionend.transition);function or(s){if(kf[s])return kf[s];if(!ro[s])return s;var i=ro[s],l;for(l in i)if(i.hasOwnProperty(l)&&l in hy)return kf[s]=i[l];return s}var fy=or("animationend"),my=or("animationiteration"),py=or("animationstart"),tw=or("transitionrun"),nw=or("transitionstart"),sw=or("transitioncancel"),gy=or("transitionend"),vy=new Map,Pf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pf.push("scrollEnd");function fs(s,i){vy.set(s,i),ds(i,[s])}var yy=new WeakMap;function Jn(s,i){if(typeof s=="object"&&s!==null){var l=yy.get(s);return l!==void 0?l:(i={value:s,source:i,stack:Kr(i)},yy.set(s,i),i)}return{value:s,source:i,stack:Kr(i)}}var es=[],oo=0,Lf=0;function $u(){for(var s=oo,i=Lf=oo=0;i<s;){var l=es[i];es[i++]=null;var u=es[i];es[i++]=null;var f=es[i];es[i++]=null;var g=es[i];if(es[i++]=null,u!==null&&f!==null){var N=u.pending;N===null?f.next=f:(f.next=N.next,N.next=f),u.pending=f}g!==0&&_y(l,f,g)}}function Yu(s,i,l,u){es[oo++]=s,es[oo++]=i,es[oo++]=l,es[oo++]=u,Lf|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function Vf(s,i,l,u){return Yu(s,i,l,u),Ku(s)}function lo(s,i){return Yu(s,null,null,i),Ku(s)}function _y(s,i,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var f=!1,g=s.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(s=g.stateNode,s===null||s._visibility&1||(f=!0)),s=g,g=g.return;return s.tag===3?(g=s.stateNode,f&&i!==null&&(f=31-cn(l),s=g.hiddenUpdates,u=s[f],u===null?s[f]=[i]:u.push(i),i.lane=l|536870912),g):null}function Ku(s){if(50<uc)throw uc=0,zm=null,Error(a(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var co={};function aw(s,i,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(s,i,l,u){return new aw(s,i,l,u)}function Uf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function da(s,i){var l=s.alternate;return l===null?(l=Pn(s.tag,i,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=i,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,i=s.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function by(s,i){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,i=l.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Qu(s,i,l,u,f,g){var N=0;if(u=s,typeof s=="function")Uf(s)&&(N=1);else if(typeof s=="string")N=rC(s,l,Ne.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case P:return s=Pn(31,l,i,f),s.elementType=P,s.lanes=g,s;case x:return lr(l.children,f,g,i);case C:N=8,f|=24;break;case w:return s=Pn(12,l,i,f|2),s.elementType=w,s.lanes=g,s;case U:return s=Pn(13,l,i,f),s.elementType=U,s.lanes=g,s;case Q:return s=Pn(19,l,i,f),s.elementType=Q,s.lanes=g,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case F:case V:N=10;break e;case H:N=9;break e;case k:N=11;break e;case L:N=14;break e;case R:N=16,u=null;break e}N=29,l=Error(a(130,s===null?"null":typeof s,"")),u=null}return i=Pn(N,l,i,f),i.elementType=s,i.type=u,i.lanes=g,i}function lr(s,i,l,u){return s=Pn(7,s,u,i),s.lanes=l,s}function Ff(s,i,l){return s=Pn(6,s,null,i),s.lanes=l,s}function qf(s,i,l){return i=Pn(4,s.children!==null?s.children:[],s.key,i),i.lanes=l,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var uo=[],ho=0,Xu=null,Wu=0,ts=[],ns=0,cr=null,ha=1,fa="";function ur(s,i){uo[ho++]=Wu,uo[ho++]=Xu,Xu=s,Wu=i}function Ey(s,i,l){ts[ns++]=ha,ts[ns++]=fa,ts[ns++]=cr,cr=s;var u=ha;s=fa;var f=32-cn(u)-1;u&=~(1<<f),l+=1;var g=32-cn(i)+f;if(30<g){var N=f-f%5;g=(u&(1<<N)-1).toString(32),u>>=N,f-=N,ha=1<<32-cn(i)+f|l<<f|u,fa=g+s}else ha=1<<g|l<<f|u,fa=s}function Bf(s){s.return!==null&&(ur(s,1),Ey(s,1,0))}function Hf(s){for(;s===Xu;)Xu=uo[--ho],uo[ho]=null,Wu=uo[--ho],uo[ho]=null;for(;s===cr;)cr=ts[--ns],ts[ns]=null,fa=ts[--ns],ts[ns]=null,ha=ts[--ns],ts[ns]=null}var bn=null,Tt=null,tt=!1,dr=null,Ls=!1,zf=Error(a(519));function hr(s){var i=Error(a(418,""));throw Bl(Jn(i,s)),zf}function Ny(s){var i=s.stateNode,l=s.type,u=s.memoizedProps;switch(i[Pt]=s,i[It]=u,l){case"dialog":Ge("cancel",i),Ge("close",i);break;case"iframe":case"object":case"embed":Ge("load",i);break;case"video":case"audio":for(l=0;l<hc.length;l++)Ge(hc[l],i);break;case"source":Ge("error",i);break;case"img":case"image":case"link":Ge("error",i),Ge("load",i);break;case"details":Ge("toggle",i);break;case"input":Ge("invalid",i),Xi(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Qr(i);break;case"select":Ge("invalid",i);break;case"textarea":Ge("invalid",i),Wi(i,u.value,u.defaultValue,u.children),Qr(i)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||u.suppressHydrationWarning===!0||Ub(i.textContent,l)?(u.popover!=null&&(Ge("beforetoggle",i),Ge("toggle",i)),u.onScroll!=null&&Ge("scroll",i),u.onScrollEnd!=null&&Ge("scrollend",i),u.onClick!=null&&(i.onclick=Rd),i=!0):i=!1,i||hr(s)}function xy(s){for(bn=s.return;bn;)switch(bn.tag){case 5:case 13:Ls=!1;return;case 27:case 3:Ls=!0;return;default:bn=bn.return}}function Fl(s){if(s!==bn)return!1;if(!tt)return xy(s),tt=!0,!1;var i=s.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||rp(s.type,s.memoizedProps)),l=!l),l&&Tt&&hr(s),xy(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(i===0){Tt=ps(s.nextSibling);break e}i--}else l!=="$"&&l!=="$!"&&l!=="$?"||i++;s=s.nextSibling}Tt=null}}else i===27?(i=Tt,ai(s.type)?(s=up,up=null,Tt=s):Tt=i):Tt=bn?ps(s.stateNode.nextSibling):null;return!0}function ql(){Tt=bn=null,tt=!1}function Ty(){var s=dr;return s!==null&&(Sn===null?Sn=s:Sn.push.apply(Sn,s),dr=null),s}function Bl(s){dr===null?dr=[s]:dr.push(s)}var Gf=ee(null),fr=null,ma=null;function Ha(s,i,l){ue(Gf,i._currentValue),i._currentValue=l}function pa(s){s._currentValue=Gf.current,ce(Gf)}function $f(s,i,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),s===l)break;s=s.return}}function Yf(s,i,l,u){var f=s.child;for(f!==null&&(f.return=s);f!==null;){var g=f.dependencies;if(g!==null){var N=f.child;g=g.firstContext;e:for(;g!==null;){var S=g;g=f;for(var B=0;B<i.length;B++)if(S.context===i[B]){g.lanes|=l,S=g.alternate,S!==null&&(S.lanes|=l),$f(g.return,l,s),u||(N=null);break e}g=S.next}}else if(f.tag===18){if(N=f.return,N===null)throw Error(a(341));N.lanes|=l,g=N.alternate,g!==null&&(g.lanes|=l),$f(N,l,s),N=null}else N=f.child;if(N!==null)N.return=f;else for(N=f;N!==null;){if(N===s){N=null;break}if(f=N.sibling,f!==null){f.return=N.return,N=f;break}N=N.return}f=N}}function Hl(s,i,l,u){s=null;for(var f=i,g=!1;f!==null;){if(!g){if((f.flags&524288)!==0)g=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var N=f.alternate;if(N===null)throw Error(a(387));if(N=N.memoizedProps,N!==null){var S=f.type;kn(f.pendingProps.value,N.value)||(s!==null?s.push(S):s=[S])}}else if(f===zt.current){if(N=f.alternate,N===null)throw Error(a(387));N.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(s!==null?s.push(yc):s=[yc])}f=f.return}s!==null&&Yf(i,s,l,u),i.flags|=262144}function Zu(s){for(s=s.firstContext;s!==null;){if(!kn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function mr(s){fr=s,ma=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function un(s){return Ay(fr,s)}function Ju(s,i){return fr===null&&mr(s),Ay(s,i)}function Ay(s,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},ma===null){if(s===null)throw Error(a(308));ma=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else ma=ma.next=i;return l}var iw=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){i.aborted=!0,s.forEach(function(l){return l()})}},rw=n.unstable_scheduleCallback,ow=n.unstable_NormalPriority,Ut={$$typeof:V,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kf(){return{controller:new iw,data:new Map,refCount:0}}function zl(s){s.refCount--,s.refCount===0&&rw(ow,function(){s.controller.abort()})}var Gl=null,Qf=0,fo=0,mo=null;function lw(s,i){if(Gl===null){var l=Gl=[];Qf=0,fo=Wm(),mo={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Qf++,i.then(jy,jy),i}function jy(){if(--Qf===0&&Gl!==null){mo!==null&&(mo.status="fulfilled");var s=Gl;Gl=null,fo=0,mo=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function cw(s,i){var l=[],u={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return s.then(function(){u.status="fulfilled",u.value=i;for(var f=0;f<l.length;f++)(0,l[f])(i)},function(f){for(u.status="rejected",u.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),u}var wy=$.S;$.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&lw(s,i),wy!==null&&wy(s,i)};var pr=ee(null);function Xf(){var s=pr.current;return s!==null?s:pt.pooledCache}function ed(s,i){i===null?ue(pr,pr.current):ue(pr,i.pool)}function Cy(){var s=Xf();return s===null?null:{parent:Ut._currentValue,pool:s}}var $l=Error(a(460)),Sy=Error(a(474)),td=Error(a(542)),Wf={then:function(){}};function Iy(s){return s=s.status,s==="fulfilled"||s==="rejected"}function nd(){}function Ry(s,i,l){switch(l=s[l],l===void 0?s.push(i):l!==i&&(i.then(nd,nd),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,My(s),s;default:if(typeof i.status=="string")i.then(nd,nd);else{if(s=pt,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=i,s.status="pending",s.then(function(u){if(i.status==="pending"){var f=i;f.status="fulfilled",f.value=u}},function(u){if(i.status==="pending"){var f=i;f.status="rejected",f.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,My(s),s}throw Yl=i,$l}}var Yl=null;function Dy(){if(Yl===null)throw Error(a(459));var s=Yl;return Yl=null,s}function My(s){if(s===$l||s===td)throw Error(a(483))}var za=!1;function Zf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jf(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ga(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function $a(s,i,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(it&2)!==0){var f=u.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),u.pending=i,i=Ku(s),_y(s,null,l),i}return Yu(s,u,i,l),Ku(s)}function Kl(s,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,Nl(s,l)}}function em(s,i){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var f=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var N={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?f=g=N:g=g.next=N,l=l.next}while(l!==null);g===null?f=g=i:g=g.next=i}else f=g=i;l={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=i:s.next=i,l.lastBaseUpdate=i}var tm=!1;function Ql(){if(tm){var s=mo;if(s!==null)throw s}}function Xl(s,i,l,u){tm=!1;var f=s.updateQueue;za=!1;var g=f.firstBaseUpdate,N=f.lastBaseUpdate,S=f.shared.pending;if(S!==null){f.shared.pending=null;var B=S,Z=B.next;B.next=null,N===null?g=Z:N.next=Z,N=B;var se=s.alternate;se!==null&&(se=se.updateQueue,S=se.lastBaseUpdate,S!==N&&(S===null?se.firstBaseUpdate=Z:S.next=Z,se.lastBaseUpdate=B))}if(g!==null){var oe=f.baseState;N=0,se=Z=B=null,S=g;do{var J=S.lane&-536870913,te=J!==S.lane;if(te?(Xe&J)===J:(u&J)===J){J!==0&&J===fo&&(tm=!0),se!==null&&(se=se.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var Ie=s,Te=S;J=i;var ut=l;switch(Te.tag){case 1:if(Ie=Te.payload,typeof Ie=="function"){oe=Ie.call(ut,oe,J);break e}oe=Ie;break e;case 3:Ie.flags=Ie.flags&-65537|128;case 0:if(Ie=Te.payload,J=typeof Ie=="function"?Ie.call(ut,oe,J):Ie,J==null)break e;oe=_({},oe,J);break e;case 2:za=!0}}J=S.callback,J!==null&&(s.flags|=64,te&&(s.flags|=8192),te=f.callbacks,te===null?f.callbacks=[J]:te.push(J))}else te={lane:J,tag:S.tag,payload:S.payload,callback:S.callback,next:null},se===null?(Z=se=te,B=oe):se=se.next=te,N|=J;if(S=S.next,S===null){if(S=f.shared.pending,S===null)break;te=S,S=te.next,te.next=null,f.lastBaseUpdate=te,f.shared.pending=null}}while(!0);se===null&&(B=oe),f.baseState=B,f.firstBaseUpdate=Z,f.lastBaseUpdate=se,g===null&&(f.shared.lanes=0),ei|=N,s.lanes=N,s.memoizedState=oe}}function Oy(s,i){if(typeof s!="function")throw Error(a(191,s));s.call(i)}function ky(s,i){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)Oy(l[s],i)}var po=ee(null),sd=ee(0);function Py(s,i){s=Na,ue(sd,s),ue(po,i),Na=s|i.baseLanes}function nm(){ue(sd,Na),ue(po,po.current)}function sm(){Na=sd.current,ce(po),ce(sd)}var Ya=0,Ue=null,lt=null,Dt=null,ad=!1,go=!1,gr=!1,id=0,Wl=0,vo=null,uw=0;function wt(){throw Error(a(321))}function am(s,i){if(i===null)return!1;for(var l=0;l<i.length&&l<s.length;l++)if(!kn(s[l],i[l]))return!1;return!0}function im(s,i,l,u,f,g){return Ya=g,Ue=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,$.H=s===null||s.memoizedState===null?__:b_,gr=!1,g=l(u,f),gr=!1,go&&(g=Vy(i,l,u,f)),Ly(s),g}function Ly(s){$.H=dd;var i=lt!==null&&lt.next!==null;if(Ya=0,Dt=lt=Ue=null,ad=!1,Wl=0,vo=null,i)throw Error(a(300));s===null||Yt||(s=s.dependencies,s!==null&&Zu(s)&&(Yt=!0))}function Vy(s,i,l,u){Ue=s;var f=0;do{if(go&&(vo=null),Wl=0,go=!1,25<=f)throw Error(a(301));if(f+=1,Dt=lt=null,s.updateQueue!=null){var g=s.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}$.H=vw,g=i(l,u)}while(go);return g}function dw(){var s=$.H,i=s.useState()[0];return i=typeof i.then=="function"?Zl(i):i,s=s.useState()[0],(lt!==null?lt.memoizedState:null)!==s&&(Ue.flags|=1024),i}function rm(){var s=id!==0;return id=0,s}function om(s,i,l){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~l}function lm(s){if(ad){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}ad=!1}Ya=0,Dt=lt=Ue=null,go=!1,Wl=id=0,vo=null}function wn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?Ue.memoizedState=Dt=s:Dt=Dt.next=s,Dt}function Mt(){if(lt===null){var s=Ue.alternate;s=s!==null?s.memoizedState:null}else s=lt.next;var i=Dt===null?Ue.memoizedState:Dt.next;if(i!==null)Dt=i,lt=s;else{if(s===null)throw Ue.alternate===null?Error(a(467)):Error(a(310));lt=s,s={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},Dt===null?Ue.memoizedState=Dt=s:Dt=Dt.next=s}return Dt}function cm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zl(s){var i=Wl;return Wl+=1,vo===null&&(vo=[]),s=Ry(vo,s,i),i=Ue,(Dt===null?i.memoizedState:Dt.next)===null&&(i=i.alternate,$.H=i===null||i.memoizedState===null?__:b_),s}function rd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Zl(s);if(s.$$typeof===V)return un(s)}throw Error(a(438,String(s)))}function um(s){var i=null,l=Ue.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var u=Ue.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(f){return f.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=cm(),Ue.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(s),u=0;u<s;u++)l[u]=D;return i.index++,l}function ga(s,i){return typeof i=="function"?i(s):i}function od(s){var i=Mt();return dm(i,lt,s)}function dm(s,i,l){var u=s.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=l;var f=s.baseQueue,g=u.pending;if(g!==null){if(f!==null){var N=f.next;f.next=g.next,g.next=N}i.baseQueue=f=g,u.pending=null}if(g=s.baseState,f===null)s.memoizedState=g;else{i=f.next;var S=N=null,B=null,Z=i,se=!1;do{var oe=Z.lane&-536870913;if(oe!==Z.lane?(Xe&oe)===oe:(Ya&oe)===oe){var J=Z.revertLane;if(J===0)B!==null&&(B=B.next={lane:0,revertLane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),oe===fo&&(se=!0);else if((Ya&J)===J){Z=Z.next,J===fo&&(se=!0);continue}else oe={lane:0,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},B===null?(S=B=oe,N=g):B=B.next=oe,Ue.lanes|=J,ei|=J;oe=Z.action,gr&&l(g,oe),g=Z.hasEagerState?Z.eagerState:l(g,oe)}else J={lane:oe,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},B===null?(S=B=J,N=g):B=B.next=J,Ue.lanes|=oe,ei|=oe;Z=Z.next}while(Z!==null&&Z!==i);if(B===null?N=g:B.next=S,!kn(g,s.memoizedState)&&(Yt=!0,se&&(l=mo,l!==null)))throw l;s.memoizedState=g,s.baseState=N,s.baseQueue=B,u.lastRenderedState=g}return f===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function hm(s){var i=Mt(),l=i.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=s;var u=l.dispatch,f=l.pending,g=i.memoizedState;if(f!==null){l.pending=null;var N=f=f.next;do g=s(g,N.action),N=N.next;while(N!==f);kn(g,i.memoizedState)||(Yt=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),l.lastRenderedState=g}return[g,u]}function Uy(s,i,l){var u=Ue,f=Mt(),g=tt;if(g){if(l===void 0)throw Error(a(407));l=l()}else l=i();var N=!kn((lt||f).memoizedState,l);N&&(f.memoizedState=l,Yt=!0),f=f.queue;var S=By.bind(null,u,f,s);if(Jl(2048,8,S,[s]),f.getSnapshot!==i||N||Dt!==null&&Dt.memoizedState.tag&1){if(u.flags|=2048,yo(9,ld(),qy.bind(null,u,f,l,i),null),pt===null)throw Error(a(349));g||(Ya&124)!==0||Fy(u,i,l)}return l}function Fy(s,i,l){s.flags|=16384,s={getSnapshot:i,value:l},i=Ue.updateQueue,i===null?(i=cm(),Ue.updateQueue=i,i.stores=[s]):(l=i.stores,l===null?i.stores=[s]:l.push(s))}function qy(s,i,l,u){i.value=l,i.getSnapshot=u,Hy(i)&&zy(s)}function By(s,i,l){return l(function(){Hy(i)&&zy(s)})}function Hy(s){var i=s.getSnapshot;s=s.value;try{var l=i();return!kn(s,l)}catch{return!0}}function zy(s){var i=lo(s,2);i!==null&&qn(i,s,2)}function fm(s){var i=wn();if(typeof s=="function"){var l=s;if(s=l(),gr){Mn(!0);try{l()}finally{Mn(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:s},i}function Gy(s,i,l,u){return s.baseState=l,dm(s,lt,typeof u=="function"?u:ga)}function hw(s,i,l,u,f){if(ud(s))throw Error(a(485));if(s=i.action,s!==null){var g={payload:f,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){g.listeners.push(N)}};$.T!==null?l(!0):g.isTransition=!1,u(g),l=i.pending,l===null?(g.next=i.pending=g,$y(i,g)):(g.next=l.next,i.pending=l.next=g)}}function $y(s,i){var l=i.action,u=i.payload,f=s.state;if(i.isTransition){var g=$.T,N={};$.T=N;try{var S=l(f,u),B=$.S;B!==null&&B(N,S),Yy(s,i,S)}catch(Z){mm(s,i,Z)}finally{$.T=g}}else try{g=l(f,u),Yy(s,i,g)}catch(Z){mm(s,i,Z)}}function Yy(s,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Ky(s,i,u)},function(u){return mm(s,i,u)}):Ky(s,i,l)}function Ky(s,i,l){i.status="fulfilled",i.value=l,Qy(i),s.state=l,i=s.pending,i!==null&&(l=i.next,l===i?s.pending=null:(l=l.next,i.next=l,$y(s,l)))}function mm(s,i,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=l,Qy(i),i=i.next;while(i!==u)}s.action=null}function Qy(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function Xy(s,i){return i}function Wy(s,i){if(tt){var l=pt.formState;if(l!==null){e:{var u=Ue;if(tt){if(Tt){t:{for(var f=Tt,g=Ls;f.nodeType!==8;){if(!g){f=null;break t}if(f=ps(f.nextSibling),f===null){f=null;break t}}g=f.data,f=g==="F!"||g==="F"?f:null}if(f){Tt=ps(f.nextSibling),u=f.data==="F!";break e}}hr(u)}u=!1}u&&(i=l[0])}}return l=wn(),l.memoizedState=l.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xy,lastRenderedState:i},l.queue=u,l=g_.bind(null,Ue,u),u.dispatch=l,u=fm(!1),g=_m.bind(null,Ue,!1,u.queue),u=wn(),f={state:i,dispatch:null,action:s,pending:null},u.queue=f,l=hw.bind(null,Ue,f,g,l),f.dispatch=l,u.memoizedState=s,[i,l,!1]}function Zy(s){var i=Mt();return Jy(i,lt,s)}function Jy(s,i,l){if(i=dm(s,i,Xy)[0],s=od(ga)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Zl(i)}catch(N){throw N===$l?td:N}else u=i;i=Mt();var f=i.queue,g=f.dispatch;return l!==i.memoizedState&&(Ue.flags|=2048,yo(9,ld(),fw.bind(null,f,l),null)),[u,g,s]}function fw(s,i){s.action=i}function e_(s){var i=Mt(),l=lt;if(l!==null)return Jy(i,l,s);Mt(),i=i.memoizedState,l=Mt();var u=l.queue.dispatch;return l.memoizedState=s,[i,u,!1]}function yo(s,i,l,u){return s={tag:s,create:l,deps:u,inst:i,next:null},i=Ue.updateQueue,i===null&&(i=cm(),Ue.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,i.lastEffect=s),s}function ld(){return{destroy:void 0,resource:void 0}}function t_(){return Mt().memoizedState}function cd(s,i,l,u){var f=wn();u=u===void 0?null:u,Ue.flags|=s,f.memoizedState=yo(1|i,ld(),l,u)}function Jl(s,i,l,u){var f=Mt();u=u===void 0?null:u;var g=f.memoizedState.inst;lt!==null&&u!==null&&am(u,lt.memoizedState.deps)?f.memoizedState=yo(i,g,l,u):(Ue.flags|=s,f.memoizedState=yo(1|i,g,l,u))}function n_(s,i){cd(8390656,8,s,i)}function s_(s,i){Jl(2048,8,s,i)}function a_(s,i){return Jl(4,2,s,i)}function i_(s,i){return Jl(4,4,s,i)}function r_(s,i){if(typeof i=="function"){s=s();var l=i(s);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function o_(s,i,l){l=l!=null?l.concat([s]):null,Jl(4,4,r_.bind(null,i,s),l)}function pm(){}function l_(s,i){var l=Mt();i=i===void 0?null:i;var u=l.memoizedState;return i!==null&&am(i,u[1])?u[0]:(l.memoizedState=[s,i],s)}function c_(s,i){var l=Mt();i=i===void 0?null:i;var u=l.memoizedState;if(i!==null&&am(i,u[1]))return u[0];if(u=s(),gr){Mn(!0);try{s()}finally{Mn(!1)}}return l.memoizedState=[u,i],u}function gm(s,i,l){return l===void 0||(Ya&1073741824)!==0?s.memoizedState=i:(s.memoizedState=l,s=hb(),Ue.lanes|=s,ei|=s,l)}function u_(s,i,l,u){return kn(l,i)?l:po.current!==null?(s=gm(s,l,u),kn(s,i)||(Yt=!0),s):(Ya&42)===0?(Yt=!0,s.memoizedState=l):(s=hb(),Ue.lanes|=s,ei|=s,i)}function d_(s,i,l,u,f){var g=z.p;z.p=g!==0&&8>g?g:8;var N=$.T,S={};$.T=S,_m(s,!1,i,l);try{var B=f(),Z=$.S;if(Z!==null&&Z(S,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var se=cw(B,u);ec(s,i,se,Fn(s))}else ec(s,i,u,Fn(s))}catch(oe){ec(s,i,{then:function(){},status:"rejected",reason:oe},Fn())}finally{z.p=g,$.T=N}}function mw(){}function vm(s,i,l,u){if(s.tag!==5)throw Error(a(476));var f=h_(s).queue;d_(s,f,i,ae,l===null?mw:function(){return f_(s),l(u)})}function h_(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:ae},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:l},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function f_(s){var i=h_(s).next.queue;ec(s,i,{},Fn())}function ym(){return un(yc)}function m_(){return Mt().memoizedState}function p_(){return Mt().memoizedState}function pw(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var l=Fn();s=Ga(l);var u=$a(i,s,l);u!==null&&(qn(u,i,l),Kl(u,i,l)),i={cache:Kf()},s.payload=i;return}i=i.return}}function gw(s,i,l){var u=Fn();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},ud(s)?v_(i,l):(l=Vf(s,i,l,u),l!==null&&(qn(l,s,u),y_(l,i,u)))}function g_(s,i,l){var u=Fn();ec(s,i,l,u)}function ec(s,i,l,u){var f={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(ud(s))v_(i,f);else{var g=s.alternate;if(s.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var N=i.lastRenderedState,S=g(N,l);if(f.hasEagerState=!0,f.eagerState=S,kn(S,N))return Yu(s,i,f,0),pt===null&&$u(),!1}catch{}finally{}if(l=Vf(s,i,f,u),l!==null)return qn(l,s,u),y_(l,i,u),!0}return!1}function _m(s,i,l,u){if(u={lane:2,revertLane:Wm(),action:u,hasEagerState:!1,eagerState:null,next:null},ud(s)){if(i)throw Error(a(479))}else i=Vf(s,l,u,2),i!==null&&qn(i,s,2)}function ud(s){var i=s.alternate;return s===Ue||i!==null&&i===Ue}function v_(s,i){go=ad=!0;var l=s.pending;l===null?i.next=i:(i.next=l.next,l.next=i),s.pending=i}function y_(s,i,l){if((l&4194048)!==0){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,Nl(s,l)}}var dd={readContext:un,use:rd,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useLayoutEffect:wt,useInsertionEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useSyncExternalStore:wt,useId:wt,useHostTransitionStatus:wt,useFormState:wt,useActionState:wt,useOptimistic:wt,useMemoCache:wt,useCacheRefresh:wt},__={readContext:un,use:rd,useCallback:function(s,i){return wn().memoizedState=[s,i===void 0?null:i],s},useContext:un,useEffect:n_,useImperativeHandle:function(s,i,l){l=l!=null?l.concat([s]):null,cd(4194308,4,r_.bind(null,i,s),l)},useLayoutEffect:function(s,i){return cd(4194308,4,s,i)},useInsertionEffect:function(s,i){cd(4,2,s,i)},useMemo:function(s,i){var l=wn();i=i===void 0?null:i;var u=s();if(gr){Mn(!0);try{s()}finally{Mn(!1)}}return l.memoizedState=[u,i],u},useReducer:function(s,i,l){var u=wn();if(l!==void 0){var f=l(i);if(gr){Mn(!0);try{l(i)}finally{Mn(!1)}}}else f=i;return u.memoizedState=u.baseState=f,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:f},u.queue=s,s=s.dispatch=gw.bind(null,Ue,s),[u.memoizedState,s]},useRef:function(s){var i=wn();return s={current:s},i.memoizedState=s},useState:function(s){s=fm(s);var i=s.queue,l=g_.bind(null,Ue,i);return i.dispatch=l,[s.memoizedState,l]},useDebugValue:pm,useDeferredValue:function(s,i){var l=wn();return gm(l,s,i)},useTransition:function(){var s=fm(!1);return s=d_.bind(null,Ue,s.queue,!0,!1),wn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,l){var u=Ue,f=wn();if(tt){if(l===void 0)throw Error(a(407));l=l()}else{if(l=i(),pt===null)throw Error(a(349));(Xe&124)!==0||Fy(u,i,l)}f.memoizedState=l;var g={value:l,getSnapshot:i};return f.queue=g,n_(By.bind(null,u,g,s),[s]),u.flags|=2048,yo(9,ld(),qy.bind(null,u,g,l,i),null),l},useId:function(){var s=wn(),i=pt.identifierPrefix;if(tt){var l=fa,u=ha;l=(u&~(1<<32-cn(u)-1)).toString(32)+l,i="«"+i+"R"+l,l=id++,0<l&&(i+="H"+l.toString(32)),i+="»"}else l=uw++,i="«"+i+"r"+l.toString(32)+"»";return s.memoizedState=i},useHostTransitionStatus:ym,useFormState:Wy,useActionState:Wy,useOptimistic:function(s){var i=wn();i.memoizedState=i.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=_m.bind(null,Ue,!0,l),l.dispatch=i,[s,i]},useMemoCache:um,useCacheRefresh:function(){return wn().memoizedState=pw.bind(null,Ue)}},b_={readContext:un,use:rd,useCallback:l_,useContext:un,useEffect:s_,useImperativeHandle:o_,useInsertionEffect:a_,useLayoutEffect:i_,useMemo:c_,useReducer:od,useRef:t_,useState:function(){return od(ga)},useDebugValue:pm,useDeferredValue:function(s,i){var l=Mt();return u_(l,lt.memoizedState,s,i)},useTransition:function(){var s=od(ga)[0],i=Mt().memoizedState;return[typeof s=="boolean"?s:Zl(s),i]},useSyncExternalStore:Uy,useId:m_,useHostTransitionStatus:ym,useFormState:Zy,useActionState:Zy,useOptimistic:function(s,i){var l=Mt();return Gy(l,lt,s,i)},useMemoCache:um,useCacheRefresh:p_},vw={readContext:un,use:rd,useCallback:l_,useContext:un,useEffect:s_,useImperativeHandle:o_,useInsertionEffect:a_,useLayoutEffect:i_,useMemo:c_,useReducer:hm,useRef:t_,useState:function(){return hm(ga)},useDebugValue:pm,useDeferredValue:function(s,i){var l=Mt();return lt===null?gm(l,s,i):u_(l,lt.memoizedState,s,i)},useTransition:function(){var s=hm(ga)[0],i=Mt().memoizedState;return[typeof s=="boolean"?s:Zl(s),i]},useSyncExternalStore:Uy,useId:m_,useHostTransitionStatus:ym,useFormState:e_,useActionState:e_,useOptimistic:function(s,i){var l=Mt();return lt!==null?Gy(l,lt,s,i):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:um,useCacheRefresh:p_},_o=null,tc=0;function hd(s){var i=tc;return tc+=1,_o===null&&(_o=[]),Ry(_o,s,i)}function nc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function fd(s,i){throw i.$$typeof===b?Error(a(525)):(s=Object.prototype.toString.call(i),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function E_(s){var i=s._init;return i(s._payload)}function N_(s){function i(K,G){if(s){var W=K.deletions;W===null?(K.deletions=[G],K.flags|=16):W.push(G)}}function l(K,G){if(!s)return null;for(;G!==null;)i(K,G),G=G.sibling;return null}function u(K){for(var G=new Map;K!==null;)K.key!==null?G.set(K.key,K):G.set(K.index,K),K=K.sibling;return G}function f(K,G){return K=da(K,G),K.index=0,K.sibling=null,K}function g(K,G,W){return K.index=W,s?(W=K.alternate,W!==null?(W=W.index,W<G?(K.flags|=67108866,G):W):(K.flags|=67108866,G)):(K.flags|=1048576,G)}function N(K){return s&&K.alternate===null&&(K.flags|=67108866),K}function S(K,G,W,ie){return G===null||G.tag!==6?(G=Ff(W,K.mode,ie),G.return=K,G):(G=f(G,W),G.return=K,G)}function B(K,G,W,ie){var ye=W.type;return ye===x?se(K,G,W.props.children,ie,W.key):G!==null&&(G.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===R&&E_(ye)===G.type)?(G=f(G,W.props),nc(G,W),G.return=K,G):(G=Qu(W.type,W.key,W.props,null,K.mode,ie),nc(G,W),G.return=K,G)}function Z(K,G,W,ie){return G===null||G.tag!==4||G.stateNode.containerInfo!==W.containerInfo||G.stateNode.implementation!==W.implementation?(G=qf(W,K.mode,ie),G.return=K,G):(G=f(G,W.children||[]),G.return=K,G)}function se(K,G,W,ie,ye){return G===null||G.tag!==7?(G=lr(W,K.mode,ie,ye),G.return=K,G):(G=f(G,W),G.return=K,G)}function oe(K,G,W){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Ff(""+G,K.mode,W),G.return=K,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case T:return W=Qu(G.type,G.key,G.props,null,K.mode,W),nc(W,G),W.return=K,W;case j:return G=qf(G,K.mode,W),G.return=K,G;case R:var ie=G._init;return G=ie(G._payload),oe(K,G,W)}if(Se(G)||I(G))return G=lr(G,K.mode,W,null),G.return=K,G;if(typeof G.then=="function")return oe(K,hd(G),W);if(G.$$typeof===V)return oe(K,Ju(K,G),W);fd(K,G)}return null}function J(K,G,W,ie){var ye=G!==null?G.key:null;if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return ye!==null?null:S(K,G,""+W,ie);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case T:return W.key===ye?B(K,G,W,ie):null;case j:return W.key===ye?Z(K,G,W,ie):null;case R:return ye=W._init,W=ye(W._payload),J(K,G,W,ie)}if(Se(W)||I(W))return ye!==null?null:se(K,G,W,ie,null);if(typeof W.then=="function")return J(K,G,hd(W),ie);if(W.$$typeof===V)return J(K,G,Ju(K,W),ie);fd(K,W)}return null}function te(K,G,W,ie,ye){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return K=K.get(W)||null,S(G,K,""+ie,ye);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case T:return K=K.get(ie.key===null?W:ie.key)||null,B(G,K,ie,ye);case j:return K=K.get(ie.key===null?W:ie.key)||null,Z(G,K,ie,ye);case R:var Be=ie._init;return ie=Be(ie._payload),te(K,G,W,ie,ye)}if(Se(ie)||I(ie))return K=K.get(W)||null,se(G,K,ie,ye,null);if(typeof ie.then=="function")return te(K,G,W,hd(ie),ye);if(ie.$$typeof===V)return te(K,G,W,Ju(G,ie),ye);fd(G,ie)}return null}function Ie(K,G,W,ie){for(var ye=null,Be=null,be=G,je=G=0,Qt=null;be!==null&&je<W.length;je++){be.index>je?(Qt=be,be=null):Qt=be.sibling;var Je=J(K,be,W[je],ie);if(Je===null){be===null&&(be=Qt);break}s&&be&&Je.alternate===null&&i(K,be),G=g(Je,G,je),Be===null?ye=Je:Be.sibling=Je,Be=Je,be=Qt}if(je===W.length)return l(K,be),tt&&ur(K,je),ye;if(be===null){for(;je<W.length;je++)be=oe(K,W[je],ie),be!==null&&(G=g(be,G,je),Be===null?ye=be:Be.sibling=be,Be=be);return tt&&ur(K,je),ye}for(be=u(be);je<W.length;je++)Qt=te(be,K,je,W[je],ie),Qt!==null&&(s&&Qt.alternate!==null&&be.delete(Qt.key===null?je:Qt.key),G=g(Qt,G,je),Be===null?ye=Qt:Be.sibling=Qt,Be=Qt);return s&&be.forEach(function(ci){return i(K,ci)}),tt&&ur(K,je),ye}function Te(K,G,W,ie){if(W==null)throw Error(a(151));for(var ye=null,Be=null,be=G,je=G=0,Qt=null,Je=W.next();be!==null&&!Je.done;je++,Je=W.next()){be.index>je?(Qt=be,be=null):Qt=be.sibling;var ci=J(K,be,Je.value,ie);if(ci===null){be===null&&(be=Qt);break}s&&be&&ci.alternate===null&&i(K,be),G=g(ci,G,je),Be===null?ye=ci:Be.sibling=ci,Be=ci,be=Qt}if(Je.done)return l(K,be),tt&&ur(K,je),ye;if(be===null){for(;!Je.done;je++,Je=W.next())Je=oe(K,Je.value,ie),Je!==null&&(G=g(Je,G,je),Be===null?ye=Je:Be.sibling=Je,Be=Je);return tt&&ur(K,je),ye}for(be=u(be);!Je.done;je++,Je=W.next())Je=te(be,K,je,Je.value,ie),Je!==null&&(s&&Je.alternate!==null&&be.delete(Je.key===null?je:Je.key),G=g(Je,G,je),Be===null?ye=Je:Be.sibling=Je,Be=Je);return s&&be.forEach(function(yC){return i(K,yC)}),tt&&ur(K,je),ye}function ut(K,G,W,ie){if(typeof W=="object"&&W!==null&&W.type===x&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case T:e:{for(var ye=W.key;G!==null;){if(G.key===ye){if(ye=W.type,ye===x){if(G.tag===7){l(K,G.sibling),ie=f(G,W.props.children),ie.return=K,K=ie;break e}}else if(G.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===R&&E_(ye)===G.type){l(K,G.sibling),ie=f(G,W.props),nc(ie,W),ie.return=K,K=ie;break e}l(K,G);break}else i(K,G);G=G.sibling}W.type===x?(ie=lr(W.props.children,K.mode,ie,W.key),ie.return=K,K=ie):(ie=Qu(W.type,W.key,W.props,null,K.mode,ie),nc(ie,W),ie.return=K,K=ie)}return N(K);case j:e:{for(ye=W.key;G!==null;){if(G.key===ye)if(G.tag===4&&G.stateNode.containerInfo===W.containerInfo&&G.stateNode.implementation===W.implementation){l(K,G.sibling),ie=f(G,W.children||[]),ie.return=K,K=ie;break e}else{l(K,G);break}else i(K,G);G=G.sibling}ie=qf(W,K.mode,ie),ie.return=K,K=ie}return N(K);case R:return ye=W._init,W=ye(W._payload),ut(K,G,W,ie)}if(Se(W))return Ie(K,G,W,ie);if(I(W)){if(ye=I(W),typeof ye!="function")throw Error(a(150));return W=ye.call(W),Te(K,G,W,ie)}if(typeof W.then=="function")return ut(K,G,hd(W),ie);if(W.$$typeof===V)return ut(K,G,Ju(K,W),ie);fd(K,W)}return typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint"?(W=""+W,G!==null&&G.tag===6?(l(K,G.sibling),ie=f(G,W),ie.return=K,K=ie):(l(K,G),ie=Ff(W,K.mode,ie),ie.return=K,K=ie),N(K)):l(K,G)}return function(K,G,W,ie){try{tc=0;var ye=ut(K,G,W,ie);return _o=null,ye}catch(be){if(be===$l||be===td)throw be;var Be=Pn(29,be,null,K.mode);return Be.lanes=ie,Be.return=K,Be}finally{}}}var bo=N_(!0),x_=N_(!1),ss=ee(null),Vs=null;function Ka(s){var i=s.alternate;ue(Ft,Ft.current&1),ue(ss,s),Vs===null&&(i===null||po.current!==null||i.memoizedState!==null)&&(Vs=s)}function T_(s){if(s.tag===22){if(ue(Ft,Ft.current),ue(ss,s),Vs===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(Vs=s)}}else Qa()}function Qa(){ue(Ft,Ft.current),ue(ss,ss.current)}function va(s){ce(ss),Vs===s&&(Vs=null),ce(Ft)}var Ft=ee(0);function md(s){for(var i=s;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||cp(l)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function bm(s,i,l,u){i=s.memoizedState,l=l(u,i),l=l==null?i:_({},i,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Em={enqueueSetState:function(s,i,l){s=s._reactInternals;var u=Fn(),f=Ga(u);f.payload=i,l!=null&&(f.callback=l),i=$a(s,f,u),i!==null&&(qn(i,s,u),Kl(i,s,u))},enqueueReplaceState:function(s,i,l){s=s._reactInternals;var u=Fn(),f=Ga(u);f.tag=1,f.payload=i,l!=null&&(f.callback=l),i=$a(s,f,u),i!==null&&(qn(i,s,u),Kl(i,s,u))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var l=Fn(),u=Ga(l);u.tag=2,i!=null&&(u.callback=i),i=$a(s,u,l),i!==null&&(qn(i,s,l),Kl(i,s,l))}};function A_(s,i,l,u,f,g,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,g,N):i.prototype&&i.prototype.isPureReactComponent?!Vl(l,u)||!Vl(f,g):!0}function j_(s,i,l,u){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,u),i.state!==s&&Em.enqueueReplaceState(i,i.state,null)}function vr(s,i){var l=i;if("ref"in i){l={};for(var u in i)u!=="ref"&&(l[u]=i[u])}if(s=s.defaultProps){l===i&&(l=_({},l));for(var f in s)l[f]===void 0&&(l[f]=s[f])}return l}var pd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function w_(s){pd(s)}function C_(s){console.error(s)}function S_(s){pd(s)}function gd(s,i){try{var l=s.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function I_(s,i,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Nm(s,i,l){return l=Ga(l),l.tag=3,l.payload={element:null},l.callback=function(){gd(s,i)},l}function R_(s){return s=Ga(s),s.tag=3,s}function D_(s,i,l,u){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var g=u.value;s.payload=function(){return f(g)},s.callback=function(){I_(i,l,u)}}var N=l.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){I_(i,l,u),typeof f!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var S=u.stack;this.componentDidCatch(u.value,{componentStack:S!==null?S:""})})}function yw(s,i,l,u,f){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=l.alternate,i!==null&&Hl(i,l,f,!0),l=ss.current,l!==null){switch(l.tag){case 13:return Vs===null?$m():l.alternate===null&&At===0&&(At=3),l.flags&=-257,l.flags|=65536,l.lanes=f,u===Wf?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([u]):i.add(u),Km(s,u,f)),!1;case 22:return l.flags|=65536,u===Wf?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([u]):l.add(u)),Km(s,u,f)),!1}throw Error(a(435,l.tag))}return Km(s,u,f),$m(),!1}if(tt)return i=ss.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=f,u!==zf&&(s=Error(a(422),{cause:u}),Bl(Jn(s,l)))):(u!==zf&&(i=Error(a(423),{cause:u}),Bl(Jn(i,l))),s=s.current.alternate,s.flags|=65536,f&=-f,s.lanes|=f,u=Jn(u,l),f=Nm(s.stateNode,u,f),em(s,f),At!==4&&(At=2)),!1;var g=Error(a(520),{cause:u});if(g=Jn(g,l),cc===null?cc=[g]:cc.push(g),At!==4&&(At=2),i===null)return!0;u=Jn(u,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,s=f&-f,l.lanes|=s,s=Nm(l.stateNode,u,s),em(l,s),!1;case 1:if(i=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(ti===null||!ti.has(g))))return l.flags|=65536,f&=-f,l.lanes|=f,f=R_(f),D_(f,s,l,u),em(l,f),!1}l=l.return}while(l!==null);return!1}var M_=Error(a(461)),Yt=!1;function en(s,i,l,u){i.child=s===null?x_(i,null,l,u):bo(i,s.child,l,u)}function O_(s,i,l,u,f){l=l.render;var g=i.ref;if("ref"in u){var N={};for(var S in u)S!=="ref"&&(N[S]=u[S])}else N=u;return mr(i),u=im(s,i,l,N,g,f),S=rm(),s!==null&&!Yt?(om(s,i,f),ya(s,i,f)):(tt&&S&&Bf(i),i.flags|=1,en(s,i,u,f),i.child)}function k_(s,i,l,u,f){if(s===null){var g=l.type;return typeof g=="function"&&!Uf(g)&&g.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=g,P_(s,i,g,u,f)):(s=Qu(l.type,null,u,i,i.mode,f),s.ref=i.ref,s.return=i,i.child=s)}if(g=s.child,!Im(s,f)){var N=g.memoizedProps;if(l=l.compare,l=l!==null?l:Vl,l(N,u)&&s.ref===i.ref)return ya(s,i,f)}return i.flags|=1,s=da(g,u),s.ref=i.ref,s.return=i,i.child=s}function P_(s,i,l,u,f){if(s!==null){var g=s.memoizedProps;if(Vl(g,u)&&s.ref===i.ref)if(Yt=!1,i.pendingProps=u=g,Im(s,f))(s.flags&131072)!==0&&(Yt=!0);else return i.lanes=s.lanes,ya(s,i,f)}return xm(s,i,l,u,f)}function L_(s,i,l){var u=i.pendingProps,f=u.children,g=s!==null?s.memoizedState:null;if(u.mode==="hidden"){if((i.flags&128)!==0){if(u=g!==null?g.baseLanes|l:l,s!==null){for(f=i.child=s.child,g=0;f!==null;)g=g|f.lanes|f.childLanes,f=f.sibling;i.childLanes=g&~u}else i.childLanes=0,i.child=null;return V_(s,i,u,l)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&ed(i,g!==null?g.cachePool:null),g!==null?Py(i,g):nm(),T_(i);else return i.lanes=i.childLanes=536870912,V_(s,i,g!==null?g.baseLanes|l:l,l)}else g!==null?(ed(i,g.cachePool),Py(i,g),Qa(),i.memoizedState=null):(s!==null&&ed(i,null),nm(),Qa());return en(s,i,f,l),i.child}function V_(s,i,l,u){var f=Xf();return f=f===null?null:{parent:Ut._currentValue,pool:f},i.memoizedState={baseLanes:l,cachePool:f},s!==null&&ed(i,null),nm(),T_(i),s!==null&&Hl(s,i,u,!0),null}function vd(s,i){var l=i.ref;if(l===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(a(284));(s===null||s.ref!==l)&&(i.flags|=4194816)}}function xm(s,i,l,u,f){return mr(i),l=im(s,i,l,u,void 0,f),u=rm(),s!==null&&!Yt?(om(s,i,f),ya(s,i,f)):(tt&&u&&Bf(i),i.flags|=1,en(s,i,l,f),i.child)}function U_(s,i,l,u,f,g){return mr(i),i.updateQueue=null,l=Vy(i,u,l,f),Ly(s),u=rm(),s!==null&&!Yt?(om(s,i,g),ya(s,i,g)):(tt&&u&&Bf(i),i.flags|=1,en(s,i,l,g),i.child)}function F_(s,i,l,u,f){if(mr(i),i.stateNode===null){var g=co,N=l.contextType;typeof N=="object"&&N!==null&&(g=un(N)),g=new l(u,g),i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Em,i.stateNode=g,g._reactInternals=i,g=i.stateNode,g.props=u,g.state=i.memoizedState,g.refs={},Zf(i),N=l.contextType,g.context=typeof N=="object"&&N!==null?un(N):co,g.state=i.memoizedState,N=l.getDerivedStateFromProps,typeof N=="function"&&(bm(i,l,N,u),g.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(N=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),N!==g.state&&Em.enqueueReplaceState(g,g.state,null),Xl(i,u,g,f),Ql(),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(s===null){g=i.stateNode;var S=i.memoizedProps,B=vr(l,S);g.props=B;var Z=g.context,se=l.contextType;N=co,typeof se=="object"&&se!==null&&(N=un(se));var oe=l.getDerivedStateFromProps;se=typeof oe=="function"||typeof g.getSnapshotBeforeUpdate=="function",S=i.pendingProps!==S,se||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(S||Z!==N)&&j_(i,g,u,N),za=!1;var J=i.memoizedState;g.state=J,Xl(i,u,g,f),Ql(),Z=i.memoizedState,S||J!==Z||za?(typeof oe=="function"&&(bm(i,l,oe,u),Z=i.memoizedState),(B=za||A_(i,l,B,u,J,Z,N))?(se||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=Z),g.props=u,g.state=Z,g.context=N,u=B):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{g=i.stateNode,Jf(s,i),N=i.memoizedProps,se=vr(l,N),g.props=se,oe=i.pendingProps,J=g.context,Z=l.contextType,B=co,typeof Z=="object"&&Z!==null&&(B=un(Z)),S=l.getDerivedStateFromProps,(Z=typeof S=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(N!==oe||J!==B)&&j_(i,g,u,B),za=!1,J=i.memoizedState,g.state=J,Xl(i,u,g,f),Ql();var te=i.memoizedState;N!==oe||J!==te||za||s!==null&&s.dependencies!==null&&Zu(s.dependencies)?(typeof S=="function"&&(bm(i,l,S,u),te=i.memoizedState),(se=za||A_(i,l,se,u,J,te,B)||s!==null&&s.dependencies!==null&&Zu(s.dependencies))?(Z||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,te,B),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,te,B)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||N===s.memoizedProps&&J===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&J===s.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=te),g.props=u,g.state=te,g.context=B,u=se):(typeof g.componentDidUpdate!="function"||N===s.memoizedProps&&J===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&J===s.memoizedState||(i.flags|=1024),u=!1)}return g=u,vd(s,i),u=(i.flags&128)!==0,g||u?(g=i.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),i.flags|=1,s!==null&&u?(i.child=bo(i,s.child,null,f),i.child=bo(i,null,l,f)):en(s,i,l,f),i.memoizedState=g.state,s=i.child):s=ya(s,i,f),s}function q_(s,i,l,u){return ql(),i.flags|=256,en(s,i,l,u),i.child}var Tm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Am(s){return{baseLanes:s,cachePool:Cy()}}function jm(s,i,l){return s=s!==null?s.childLanes&~l:0,i&&(s|=as),s}function B_(s,i,l){var u=i.pendingProps,f=!1,g=(i.flags&128)!==0,N;if((N=g)||(N=s!==null&&s.memoizedState===null?!1:(Ft.current&2)!==0),N&&(f=!0,i.flags&=-129),N=(i.flags&32)!==0,i.flags&=-33,s===null){if(tt){if(f?Ka(i):Qa(),tt){var S=Tt,B;if(B=S){e:{for(B=S,S=Ls;B.nodeType!==8;){if(!S){S=null;break e}if(B=ps(B.nextSibling),B===null){S=null;break e}}S=B}S!==null?(i.memoizedState={dehydrated:S,treeContext:cr!==null?{id:ha,overflow:fa}:null,retryLane:536870912,hydrationErrors:null},B=Pn(18,null,null,0),B.stateNode=S,B.return=i,i.child=B,bn=i,Tt=null,B=!0):B=!1}B||hr(i)}if(S=i.memoizedState,S!==null&&(S=S.dehydrated,S!==null))return cp(S)?i.lanes=32:i.lanes=536870912,null;va(i)}return S=u.children,u=u.fallback,f?(Qa(),f=i.mode,S=yd({mode:"hidden",children:S},f),u=lr(u,f,l,null),S.return=i,u.return=i,S.sibling=u,i.child=S,f=i.child,f.memoizedState=Am(l),f.childLanes=jm(s,N,l),i.memoizedState=Tm,u):(Ka(i),wm(i,S))}if(B=s.memoizedState,B!==null&&(S=B.dehydrated,S!==null)){if(g)i.flags&256?(Ka(i),i.flags&=-257,i=Cm(s,i,l)):i.memoizedState!==null?(Qa(),i.child=s.child,i.flags|=128,i=null):(Qa(),f=u.fallback,S=i.mode,u=yd({mode:"visible",children:u.children},S),f=lr(f,S,l,null),f.flags|=2,u.return=i,f.return=i,u.sibling=f,i.child=u,bo(i,s.child,null,l),u=i.child,u.memoizedState=Am(l),u.childLanes=jm(s,N,l),i.memoizedState=Tm,i=f);else if(Ka(i),cp(S)){if(N=S.nextSibling&&S.nextSibling.dataset,N)var Z=N.dgst;N=Z,u=Error(a(419)),u.stack="",u.digest=N,Bl({value:u,source:null,stack:null}),i=Cm(s,i,l)}else if(Yt||Hl(s,i,l,!1),N=(l&s.childLanes)!==0,Yt||N){if(N=pt,N!==null&&(u=l&-l,u=(u&42)!==0?1:Pa(u),u=(u&(N.suspendedLanes|l))!==0?0:u,u!==0&&u!==B.retryLane))throw B.retryLane=u,lo(s,u),qn(N,s,u),M_;S.data==="$?"||$m(),i=Cm(s,i,l)}else S.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=B.treeContext,Tt=ps(S.nextSibling),bn=i,tt=!0,dr=null,Ls=!1,s!==null&&(ts[ns++]=ha,ts[ns++]=fa,ts[ns++]=cr,ha=s.id,fa=s.overflow,cr=i),i=wm(i,u.children),i.flags|=4096);return i}return f?(Qa(),f=u.fallback,S=i.mode,B=s.child,Z=B.sibling,u=da(B,{mode:"hidden",children:u.children}),u.subtreeFlags=B.subtreeFlags&65011712,Z!==null?f=da(Z,f):(f=lr(f,S,l,null),f.flags|=2),f.return=i,u.return=i,u.sibling=f,i.child=u,u=f,f=i.child,S=s.child.memoizedState,S===null?S=Am(l):(B=S.cachePool,B!==null?(Z=Ut._currentValue,B=B.parent!==Z?{parent:Z,pool:Z}:B):B=Cy(),S={baseLanes:S.baseLanes|l,cachePool:B}),f.memoizedState=S,f.childLanes=jm(s,N,l),i.memoizedState=Tm,u):(Ka(i),l=s.child,s=l.sibling,l=da(l,{mode:"visible",children:u.children}),l.return=i,l.sibling=null,s!==null&&(N=i.deletions,N===null?(i.deletions=[s],i.flags|=16):N.push(s)),i.child=l,i.memoizedState=null,l)}function wm(s,i){return i=yd({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function yd(s,i){return s=Pn(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Cm(s,i,l){return bo(i,s.child,null,l),s=wm(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function H_(s,i,l){s.lanes|=i;var u=s.alternate;u!==null&&(u.lanes|=i),$f(s.return,i,l)}function Sm(s,i,l,u,f){var g=s.memoizedState;g===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:f}:(g.isBackwards=i,g.rendering=null,g.renderingStartTime=0,g.last=u,g.tail=l,g.tailMode=f)}function z_(s,i,l){var u=i.pendingProps,f=u.revealOrder,g=u.tail;if(en(s,i,u.children,l),u=Ft.current,(u&2)!==0)u=u&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&H_(s,l,i);else if(s.tag===19)H_(s,l,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}u&=1}switch(ue(Ft,u),f){case"forwards":for(l=i.child,f=null;l!==null;)s=l.alternate,s!==null&&md(s)===null&&(f=l),l=l.sibling;l=f,l===null?(f=i.child,i.child=null):(f=l.sibling,l.sibling=null),Sm(i,!1,f,l,g);break;case"backwards":for(l=null,f=i.child,i.child=null;f!==null;){if(s=f.alternate,s!==null&&md(s)===null){i.child=f;break}s=f.sibling,f.sibling=l,l=f,f=s}Sm(i,!0,l,null,g);break;case"together":Sm(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ya(s,i,l){if(s!==null&&(i.dependencies=s.dependencies),ei|=i.lanes,(l&i.childLanes)===0)if(s!==null){if(Hl(s,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(a(153));if(i.child!==null){for(s=i.child,l=da(s,s.pendingProps),i.child=l,l.return=i;s.sibling!==null;)s=s.sibling,l=l.sibling=da(s,s.pendingProps),l.return=i;l.sibling=null}return i.child}function Im(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&Zu(s)))}function _w(s,i,l){switch(i.tag){case 3:mt(i,i.stateNode.containerInfo),Ha(i,Ut,s.memoizedState.cache),ql();break;case 27:case 5:ka(i);break;case 4:mt(i,i.stateNode.containerInfo);break;case 10:Ha(i,i.type,i.memoizedProps.value);break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(Ka(i),i.flags|=128,null):(l&i.child.childLanes)!==0?B_(s,i,l):(Ka(i),s=ya(s,i,l),s!==null?s.sibling:null);Ka(i);break;case 19:var f=(s.flags&128)!==0;if(u=(l&i.childLanes)!==0,u||(Hl(s,i,l,!1),u=(l&i.childLanes)!==0),f){if(u)return z_(s,i,l);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ue(Ft,Ft.current),u)break;return null;case 22:case 23:return i.lanes=0,L_(s,i,l);case 24:Ha(i,Ut,s.memoizedState.cache)}return ya(s,i,l)}function G_(s,i,l){if(s!==null)if(s.memoizedProps!==i.pendingProps)Yt=!0;else{if(!Im(s,l)&&(i.flags&128)===0)return Yt=!1,_w(s,i,l);Yt=(s.flags&131072)!==0}else Yt=!1,tt&&(i.flags&1048576)!==0&&Ey(i,Wu,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var u=i.elementType,f=u._init;if(u=f(u._payload),i.type=u,typeof u=="function")Uf(u)?(s=vr(u,s),i.tag=1,i=F_(null,i,u,s,l)):(i.tag=0,i=xm(null,i,u,s,l));else{if(u!=null){if(f=u.$$typeof,f===k){i.tag=11,i=O_(null,i,u,s,l);break e}else if(f===L){i.tag=14,i=k_(null,i,u,s,l);break e}}throw i=_e(u)||u,Error(a(306,i,""))}}return i;case 0:return xm(s,i,i.type,i.pendingProps,l);case 1:return u=i.type,f=vr(u,i.pendingProps),F_(s,i,u,f,l);case 3:e:{if(mt(i,i.stateNode.containerInfo),s===null)throw Error(a(387));u=i.pendingProps;var g=i.memoizedState;f=g.element,Jf(s,i),Xl(i,u,null,l);var N=i.memoizedState;if(u=N.cache,Ha(i,Ut,u),u!==g.cache&&Yf(i,[Ut],l,!0),Ql(),u=N.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:N.cache},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){i=q_(s,i,u,l);break e}else if(u!==f){f=Jn(Error(a(424)),i),Bl(f),i=q_(s,i,u,l);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Tt=ps(s.firstChild),bn=i,tt=!0,dr=null,Ls=!0,l=x_(i,null,u,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(ql(),u===f){i=ya(s,i,l);break e}en(s,i,u,l)}i=i.child}return i;case 26:return vd(s,i),s===null?(l=Qb(i.type,null,i.pendingProps,null))?i.memoizedState=l:tt||(l=i.type,s=i.pendingProps,u=Dd(Re.current).createElement(l),u[Pt]=i,u[It]=s,nn(u,l,s),jt(u),i.stateNode=u):i.memoizedState=Qb(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return ka(i),s===null&&tt&&(u=i.stateNode=$b(i.type,i.pendingProps,Re.current),bn=i,Ls=!0,f=Tt,ai(i.type)?(up=f,Tt=ps(u.firstChild)):Tt=f),en(s,i,i.pendingProps.children,l),vd(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&tt&&((f=u=Tt)&&(u=Yw(u,i.type,i.pendingProps,Ls),u!==null?(i.stateNode=u,bn=i,Tt=ps(u.firstChild),Ls=!1,f=!0):f=!1),f||hr(i)),ka(i),f=i.type,g=i.pendingProps,N=s!==null?s.memoizedProps:null,u=g.children,rp(f,g)?u=null:N!==null&&rp(f,N)&&(i.flags|=32),i.memoizedState!==null&&(f=im(s,i,dw,null,null,l),yc._currentValue=f),vd(s,i),en(s,i,u,l),i.child;case 6:return s===null&&tt&&((s=l=Tt)&&(l=Kw(l,i.pendingProps,Ls),l!==null?(i.stateNode=l,bn=i,Tt=null,s=!0):s=!1),s||hr(i)),null;case 13:return B_(s,i,l);case 4:return mt(i,i.stateNode.containerInfo),u=i.pendingProps,s===null?i.child=bo(i,null,u,l):en(s,i,u,l),i.child;case 11:return O_(s,i,i.type,i.pendingProps,l);case 7:return en(s,i,i.pendingProps,l),i.child;case 8:return en(s,i,i.pendingProps.children,l),i.child;case 12:return en(s,i,i.pendingProps.children,l),i.child;case 10:return u=i.pendingProps,Ha(i,i.type,u.value),en(s,i,u.children,l),i.child;case 9:return f=i.type._context,u=i.pendingProps.children,mr(i),f=un(f),u=u(f),i.flags|=1,en(s,i,u,l),i.child;case 14:return k_(s,i,i.type,i.pendingProps,l);case 15:return P_(s,i,i.type,i.pendingProps,l);case 19:return z_(s,i,l);case 31:return u=i.pendingProps,l=i.mode,u={mode:u.mode,children:u.children},s===null?(l=yd(u,l),l.ref=i.ref,i.child=l,l.return=i,i=l):(l=da(s.child,u),l.ref=i.ref,i.child=l,l.return=i,i=l),i;case 22:return L_(s,i,l);case 24:return mr(i),u=un(Ut),s===null?(f=Xf(),f===null&&(f=pt,g=Kf(),f.pooledCache=g,g.refCount++,g!==null&&(f.pooledCacheLanes|=l),f=g),i.memoizedState={parent:u,cache:f},Zf(i),Ha(i,Ut,f)):((s.lanes&l)!==0&&(Jf(s,i),Xl(i,null,null,l),Ql()),f=s.memoizedState,g=i.memoizedState,f.parent!==u?(f={parent:u,cache:u},i.memoizedState=f,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=f),Ha(i,Ut,u)):(u=g.cache,Ha(i,Ut,u),u!==f.cache&&Yf(i,[Ut],l,!0))),en(s,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function _a(s){s.flags|=4}function $_(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!eE(i)){if(i=ss.current,i!==null&&((Xe&4194048)===Xe?Vs!==null:(Xe&62914560)!==Xe&&(Xe&536870912)===0||i!==Vs))throw Yl=Wf,Sy;s.flags|=8192}}function _d(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?bl():536870912,s.lanes|=i,To|=i)}function sc(s,i){if(!tt)switch(s.tailMode){case"hidden":i=s.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function Et(s){var i=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(i)for(var f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=s,f=f.sibling;else for(f=s.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=s,f=f.sibling;return s.subtreeFlags|=u,s.childLanes=l,i}function bw(s,i,l){var u=i.pendingProps;switch(Hf(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(i),null;case 1:return Et(i),null;case 3:return l=i.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),pa(Ut),As(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Fl(i)?_a(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Ty())),Et(i),null;case 26:return l=i.memoizedState,s===null?(_a(i),l!==null?(Et(i),$_(i,l)):(Et(i),i.flags&=-16777217)):l?l!==s.memoizedState?(_a(i),Et(i),$_(i,l)):(Et(i),i.flags&=-16777217):(s.memoizedProps!==u&&_a(i),Et(i),i.flags&=-16777217),null;case 27:Zs(i),l=Re.current;var f=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==u&&_a(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return Et(i),null}s=Ne.current,Fl(i)?Ny(i):(s=$b(f,u,l),i.stateNode=s,_a(i))}return Et(i),null;case 5:if(Zs(i),l=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==u&&_a(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return Et(i),null}if(s=Ne.current,Fl(i))Ny(i);else{switch(f=Dd(Re.current),s){case 1:s=f.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=f.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=f.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=f.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=f.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof u.is=="string"?f.createElement("select",{is:u.is}):f.createElement("select"),u.multiple?s.multiple=!0:u.size&&(s.size=u.size);break;default:s=typeof u.is=="string"?f.createElement(l,{is:u.is}):f.createElement(l)}}s[Pt]=i,s[It]=u;e:for(f=i.child;f!==null;){if(f.tag===5||f.tag===6)s.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===i)break e;for(;f.sibling===null;){if(f.return===null||f.return===i)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}i.stateNode=s;e:switch(nn(s,l,u),l){case"button":case"input":case"select":case"textarea":s=!!u.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&_a(i)}}return Et(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==u&&_a(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(a(166));if(s=Re.current,Fl(i)){if(s=i.stateNode,l=i.memoizedProps,u=null,f=bn,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}s[Pt]=i,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||Ub(s.nodeValue,l)),s||hr(i)}else s=Dd(s).createTextNode(u),s[Pt]=i,i.stateNode=s}return Et(i),null;case 13:if(u=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(f=Fl(i),u!==null&&u.dehydrated!==null){if(s===null){if(!f)throw Error(a(318));if(f=i.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[Pt]=i}else ql(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Et(i),f=!1}else f=Ty(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),f=!0;if(!f)return i.flags&256?(va(i),i):(va(i),null)}if(va(i),(i.flags&128)!==0)return i.lanes=l,i;if(l=u!==null,s=s!==null&&s.memoizedState!==null,l){u=i.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool);var g=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==f&&(u.flags|=2048)}return l!==s&&l&&(i.child.flags|=8192),_d(i,i.updateQueue),Et(i),null;case 4:return As(),s===null&&tp(i.stateNode.containerInfo),Et(i),null;case 10:return pa(i.type),Et(i),null;case 19:if(ce(Ft),f=i.memoizedState,f===null)return Et(i),null;if(u=(i.flags&128)!==0,g=f.rendering,g===null)if(u)sc(f,!1);else{if(At!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(g=md(s),g!==null){for(i.flags|=128,sc(f,!1),s=g.updateQueue,i.updateQueue=s,_d(i,s),i.subtreeFlags=0,s=l,l=i.child;l!==null;)by(l,s),l=l.sibling;return ue(Ft,Ft.current&1|2),i.child}s=s.sibling}f.tail!==null&&Yn()>Nd&&(i.flags|=128,u=!0,sc(f,!1),i.lanes=4194304)}else{if(!u)if(s=md(g),s!==null){if(i.flags|=128,u=!0,s=s.updateQueue,i.updateQueue=s,_d(i,s),sc(f,!0),f.tail===null&&f.tailMode==="hidden"&&!g.alternate&&!tt)return Et(i),null}else 2*Yn()-f.renderingStartTime>Nd&&l!==536870912&&(i.flags|=128,u=!0,sc(f,!1),i.lanes=4194304);f.isBackwards?(g.sibling=i.child,i.child=g):(s=f.last,s!==null?s.sibling=g:i.child=g,f.last=g)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Yn(),i.sibling=null,s=Ft.current,ue(Ft,u?s&1|2:s&1),i):(Et(i),null);case 22:case 23:return va(i),sm(),u=i.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(l&536870912)!==0&&(i.flags&128)===0&&(Et(i),i.subtreeFlags&6&&(i.flags|=8192)):Et(i),l=i.updateQueue,l!==null&&_d(i,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==l&&(i.flags|=2048),s!==null&&ce(pr),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),pa(Ut),Et(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function Ew(s,i){switch(Hf(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return pa(Ut),As(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return Zs(i),null;case 13:if(va(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(a(340));ql()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return ce(Ft),null;case 4:return As(),null;case 10:return pa(i.type),null;case 22:case 23:return va(i),sm(),s!==null&&ce(pr),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return pa(Ut),null;case 25:return null;default:return null}}function Y_(s,i){switch(Hf(i),i.tag){case 3:pa(Ut),As();break;case 26:case 27:case 5:Zs(i);break;case 4:As();break;case 13:va(i);break;case 19:ce(Ft);break;case 10:pa(i.type);break;case 22:case 23:va(i),sm(),s!==null&&ce(pr);break;case 24:pa(Ut)}}function ac(s,i){try{var l=i.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&s)===s){u=void 0;var g=l.create,N=l.inst;u=g(),N.destroy=u}l=l.next}while(l!==f)}}catch(S){dt(i,i.return,S)}}function Xa(s,i,l){try{var u=i.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var g=f.next;u=g;do{if((u.tag&s)===s){var N=u.inst,S=N.destroy;if(S!==void 0){N.destroy=void 0,f=i;var B=l,Z=S;try{Z()}catch(se){dt(f,B,se)}}}u=u.next}while(u!==g)}}catch(se){dt(i,i.return,se)}}function K_(s){var i=s.updateQueue;if(i!==null){var l=s.stateNode;try{ky(i,l)}catch(u){dt(s,s.return,u)}}}function Q_(s,i,l){l.props=vr(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){dt(s,i,u)}}function ic(s,i){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(f){dt(s,i,f)}}function Us(s,i){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(f){dt(s,i,f)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){dt(s,i,f)}else l.current=null}function X_(s){var i=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(f){dt(s,s.return,f)}}function Rm(s,i,l){try{var u=s.stateNode;Bw(u,s.type,l,i),u[It]=i}catch(f){dt(s,s.return,f)}}function W_(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ai(s.type)||s.tag===4}function Dm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||W_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ai(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Mm(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(s),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=Rd));else if(u!==4&&(u===27&&ai(s.type)&&(l=s.stateNode,i=null),s=s.child,s!==null))for(Mm(s,i,l),s=s.sibling;s!==null;)Mm(s,i,l),s=s.sibling}function bd(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?l.insertBefore(s,i):l.appendChild(s);else if(u!==4&&(u===27&&ai(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(bd(s,i,l),s=s.sibling;s!==null;)bd(s,i,l),s=s.sibling}function Z_(s){var i=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,f=i.attributes;f.length;)i.removeAttributeNode(f[0]);nn(i,u,l),i[Pt]=s,i[It]=l}catch(g){dt(s,s.return,g)}}var ba=!1,Ct=!1,Om=!1,J_=typeof WeakSet=="function"?WeakSet:Set,Kt=null;function Nw(s,i){if(s=s.containerInfo,ap=Vd,s=uy(s),Df(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var f=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var N=0,S=-1,B=-1,Z=0,se=0,oe=s,J=null;t:for(;;){for(var te;oe!==l||f!==0&&oe.nodeType!==3||(S=N+f),oe!==g||u!==0&&oe.nodeType!==3||(B=N+u),oe.nodeType===3&&(N+=oe.nodeValue.length),(te=oe.firstChild)!==null;)J=oe,oe=te;for(;;){if(oe===s)break t;if(J===l&&++Z===f&&(S=N),J===g&&++se===u&&(B=N),(te=oe.nextSibling)!==null)break;oe=J,J=oe.parentNode}oe=te}l=S===-1||B===-1?null:{start:S,end:B}}else l=null}l=l||{start:0,end:0}}else l=null;for(ip={focusedElem:s,selectionRange:l},Vd=!1,Kt=i;Kt!==null;)if(i=Kt,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,Kt=s;else for(;Kt!==null;){switch(i=Kt,g=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&g!==null){s=void 0,l=i,f=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var Ie=vr(l.type,f,l.elementType===l.type);s=u.getSnapshotBeforeUpdate(Ie,g),u.__reactInternalSnapshotBeforeUpdate=s}catch(Te){dt(l,l.return,Te)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,l=s.nodeType,l===9)lp(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":lp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=i.sibling,s!==null){s.return=i.return,Kt=s;break}Kt=i.return}}function eb(s,i,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Wa(s,l),u&4&&ac(5,l);break;case 1:if(Wa(s,l),u&4)if(s=l.stateNode,i===null)try{s.componentDidMount()}catch(N){dt(l,l.return,N)}else{var f=vr(l.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(f,i,s.__reactInternalSnapshotBeforeUpdate)}catch(N){dt(l,l.return,N)}}u&64&&K_(l),u&512&&ic(l,l.return);break;case 3:if(Wa(s,l),u&64&&(s=l.updateQueue,s!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{ky(s,i)}catch(N){dt(l,l.return,N)}}break;case 27:i===null&&u&4&&Z_(l);case 26:case 5:Wa(s,l),i===null&&u&4&&X_(l),u&512&&ic(l,l.return);break;case 12:Wa(s,l);break;case 13:Wa(s,l),u&4&&sb(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=Rw.bind(null,l),Qw(s,l))));break;case 22:if(u=l.memoizedState!==null||ba,!u){i=i!==null&&i.memoizedState!==null||Ct,f=ba;var g=Ct;ba=u,(Ct=i)&&!g?Za(s,l,(l.subtreeFlags&8772)!==0):Wa(s,l),ba=f,Ct=g}break;case 30:break;default:Wa(s,l)}}function tb(s){var i=s.alternate;i!==null&&(s.alternate=null,tb(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&Ua(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var bt=null,Cn=!1;function Ea(s,i,l){for(l=l.child;l!==null;)nb(s,i,l),l=l.sibling}function nb(s,i,l){if(at&&typeof at.onCommitFiberUnmount=="function")try{at.onCommitFiberUnmount(xt,l)}catch{}switch(l.tag){case 26:Ct||Us(l,i),Ea(s,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ct||Us(l,i);var u=bt,f=Cn;ai(l.type)&&(bt=l.stateNode,Cn=!1),Ea(s,i,l),mc(l.stateNode),bt=u,Cn=f;break;case 5:Ct||Us(l,i);case 6:if(u=bt,f=Cn,bt=null,Ea(s,i,l),bt=u,Cn=f,bt!==null)if(Cn)try{(bt.nodeType===9?bt.body:bt.nodeName==="HTML"?bt.ownerDocument.body:bt).removeChild(l.stateNode)}catch(g){dt(l,i,g)}else try{bt.removeChild(l.stateNode)}catch(g){dt(l,i,g)}break;case 18:bt!==null&&(Cn?(s=bt,zb(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Nc(s)):zb(bt,l.stateNode));break;case 4:u=bt,f=Cn,bt=l.stateNode.containerInfo,Cn=!0,Ea(s,i,l),bt=u,Cn=f;break;case 0:case 11:case 14:case 15:Ct||Xa(2,l,i),Ct||Xa(4,l,i),Ea(s,i,l);break;case 1:Ct||(Us(l,i),u=l.stateNode,typeof u.componentWillUnmount=="function"&&Q_(l,i,u)),Ea(s,i,l);break;case 21:Ea(s,i,l);break;case 22:Ct=(u=Ct)||l.memoizedState!==null,Ea(s,i,l),Ct=u;break;default:Ea(s,i,l)}}function sb(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Nc(s)}catch(l){dt(i,i.return,l)}}function xw(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new J_),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new J_),i;default:throw Error(a(435,s.tag))}}function km(s,i){var l=xw(s);i.forEach(function(u){var f=Dw.bind(null,s,u);l.has(u)||(l.add(u),u.then(f,f))})}function Ln(s,i){var l=i.deletions;if(l!==null)for(var u=0;u<l.length;u++){var f=l[u],g=s,N=i,S=N;e:for(;S!==null;){switch(S.tag){case 27:if(ai(S.type)){bt=S.stateNode,Cn=!1;break e}break;case 5:bt=S.stateNode,Cn=!1;break e;case 3:case 4:bt=S.stateNode.containerInfo,Cn=!0;break e}S=S.return}if(bt===null)throw Error(a(160));nb(g,N,f),bt=null,Cn=!1,g=f.alternate,g!==null&&(g.return=null),f.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)ab(i,s),i=i.sibling}var ms=null;function ab(s,i){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ln(i,s),Vn(s),u&4&&(Xa(3,s,s.return),ac(3,s),Xa(5,s,s.return));break;case 1:Ln(i,s),Vn(s),u&512&&(Ct||l===null||Us(l,l.return)),u&64&&ba&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var f=ms;if(Ln(i,s),Vn(s),u&512&&(Ct||l===null||Us(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":g=f.getElementsByTagName("title")[0],(!g||g[$i]||g[Pt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=f.createElement(u),f.head.insertBefore(g,f.querySelector("head > title"))),nn(g,u,l),g[Pt]=s,jt(g),u=g;break e;case"link":var N=Zb("link","href",f).get(u+(l.href||""));if(N){for(var S=0;S<N.length;S++)if(g=N[S],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){N.splice(S,1);break t}}g=f.createElement(u),nn(g,u,l),f.head.appendChild(g);break;case"meta":if(N=Zb("meta","content",f).get(u+(l.content||""))){for(S=0;S<N.length;S++)if(g=N[S],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){N.splice(S,1);break t}}g=f.createElement(u),nn(g,u,l),f.head.appendChild(g);break;default:throw Error(a(468,u))}g[Pt]=s,jt(g),u=g}s.stateNode=u}else Jb(f,s.type,s.stateNode);else s.stateNode=Wb(f,u,s.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?Jb(f,s.type,s.stateNode):Wb(f,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Rm(s,s.memoizedProps,l.memoizedProps)}break;case 27:Ln(i,s),Vn(s),u&512&&(Ct||l===null||Us(l,l.return)),l!==null&&u&4&&Rm(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Ln(i,s),Vn(s),u&512&&(Ct||l===null||Us(l,l.return)),s.flags&32){f=s.stateNode;try{Qn(f,"")}catch(te){dt(s,s.return,te)}}u&4&&s.stateNode!=null&&(f=s.memoizedProps,Rm(s,f,l!==null?l.memoizedProps:f)),u&1024&&(Om=!0);break;case 6:if(Ln(i,s),Vn(s),u&4){if(s.stateNode===null)throw Error(a(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(te){dt(s,s.return,te)}}break;case 3:if(kd=null,f=ms,ms=Md(i.containerInfo),Ln(i,s),ms=f,Vn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Nc(i.containerInfo)}catch(te){dt(s,s.return,te)}Om&&(Om=!1,ib(s));break;case 4:u=ms,ms=Md(s.stateNode.containerInfo),Ln(i,s),Vn(s),ms=u;break;case 12:Ln(i,s),Vn(s);break;case 13:Ln(i,s),Vn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(qm=Yn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,km(s,u)));break;case 22:f=s.memoizedState!==null;var B=l!==null&&l.memoizedState!==null,Z=ba,se=Ct;if(ba=Z||f,Ct=se||B,Ln(i,s),Ct=se,ba=Z,Vn(s),u&8192)e:for(i=s.stateNode,i._visibility=f?i._visibility&-2:i._visibility|1,f&&(l===null||B||ba||Ct||yr(s)),l=null,i=s;;){if(i.tag===5||i.tag===26){if(l===null){B=l=i;try{if(g=B.stateNode,f)N=g.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{S=B.stateNode;var oe=B.memoizedProps.style,J=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;S.style.display=J==null||typeof J=="boolean"?"":(""+J).trim()}}catch(te){dt(B,B.return,te)}}}else if(i.tag===6){if(l===null){B=i;try{B.stateNode.nodeValue=f?"":B.memoizedProps}catch(te){dt(B,B.return,te)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,km(s,l))));break;case 19:Ln(i,s),Vn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,km(s,u)));break;case 30:break;case 21:break;default:Ln(i,s),Vn(s)}}function Vn(s){var i=s.flags;if(i&2){try{for(var l,u=s.return;u!==null;){if(W_(u)){l=u;break}u=u.return}if(l==null)throw Error(a(160));switch(l.tag){case 27:var f=l.stateNode,g=Dm(s);bd(s,g,f);break;case 5:var N=l.stateNode;l.flags&32&&(Qn(N,""),l.flags&=-33);var S=Dm(s);bd(s,S,N);break;case 3:case 4:var B=l.stateNode.containerInfo,Z=Dm(s);Mm(s,Z,B);break;default:throw Error(a(161))}}catch(se){dt(s,s.return,se)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function ib(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;ib(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function Wa(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)eb(s,i.alternate,i),i=i.sibling}function yr(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Xa(4,i,i.return),yr(i);break;case 1:Us(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&Q_(i,i.return,l),yr(i);break;case 27:mc(i.stateNode);case 26:case 5:Us(i,i.return),yr(i);break;case 22:i.memoizedState===null&&yr(i);break;case 30:yr(i);break;default:yr(i)}s=s.sibling}}function Za(s,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,f=s,g=i,N=g.flags;switch(g.tag){case 0:case 11:case 15:Za(f,g,l),ac(4,g);break;case 1:if(Za(f,g,l),u=g,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Z){dt(u,u.return,Z)}if(u=g,f=u.updateQueue,f!==null){var S=u.stateNode;try{var B=f.shared.hiddenCallbacks;if(B!==null)for(f.shared.hiddenCallbacks=null,f=0;f<B.length;f++)Oy(B[f],S)}catch(Z){dt(u,u.return,Z)}}l&&N&64&&K_(g),ic(g,g.return);break;case 27:Z_(g);case 26:case 5:Za(f,g,l),l&&u===null&&N&4&&X_(g),ic(g,g.return);break;case 12:Za(f,g,l);break;case 13:Za(f,g,l),l&&N&4&&sb(f,g);break;case 22:g.memoizedState===null&&Za(f,g,l),ic(g,g.return);break;case 30:break;default:Za(f,g,l)}i=i.sibling}}function Pm(s,i){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&zl(l))}function Lm(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&zl(s))}function Fs(s,i,l,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)rb(s,i,l,u),i=i.sibling}function rb(s,i,l,u){var f=i.flags;switch(i.tag){case 0:case 11:case 15:Fs(s,i,l,u),f&2048&&ac(9,i);break;case 1:Fs(s,i,l,u);break;case 3:Fs(s,i,l,u),f&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&zl(s)));break;case 12:if(f&2048){Fs(s,i,l,u),s=i.stateNode;try{var g=i.memoizedProps,N=g.id,S=g.onPostCommit;typeof S=="function"&&S(N,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(B){dt(i,i.return,B)}}else Fs(s,i,l,u);break;case 13:Fs(s,i,l,u);break;case 23:break;case 22:g=i.stateNode,N=i.alternate,i.memoizedState!==null?g._visibility&2?Fs(s,i,l,u):rc(s,i):g._visibility&2?Fs(s,i,l,u):(g._visibility|=2,Eo(s,i,l,u,(i.subtreeFlags&10256)!==0)),f&2048&&Pm(N,i);break;case 24:Fs(s,i,l,u),f&2048&&Lm(i.alternate,i);break;default:Fs(s,i,l,u)}}function Eo(s,i,l,u,f){for(f=f&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var g=s,N=i,S=l,B=u,Z=N.flags;switch(N.tag){case 0:case 11:case 15:Eo(g,N,S,B,f),ac(8,N);break;case 23:break;case 22:var se=N.stateNode;N.memoizedState!==null?se._visibility&2?Eo(g,N,S,B,f):rc(g,N):(se._visibility|=2,Eo(g,N,S,B,f)),f&&Z&2048&&Pm(N.alternate,N);break;case 24:Eo(g,N,S,B,f),f&&Z&2048&&Lm(N.alternate,N);break;default:Eo(g,N,S,B,f)}i=i.sibling}}function rc(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=s,u=i,f=u.flags;switch(u.tag){case 22:rc(l,u),f&2048&&Pm(u.alternate,u);break;case 24:rc(l,u),f&2048&&Lm(u.alternate,u);break;default:rc(l,u)}i=i.sibling}}var oc=8192;function No(s){if(s.subtreeFlags&oc)for(s=s.child;s!==null;)ob(s),s=s.sibling}function ob(s){switch(s.tag){case 26:No(s),s.flags&oc&&s.memoizedState!==null&&lC(ms,s.memoizedState,s.memoizedProps);break;case 5:No(s);break;case 3:case 4:var i=ms;ms=Md(s.stateNode.containerInfo),No(s),ms=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=oc,oc=16777216,No(s),oc=i):No(s));break;default:No(s)}}function lb(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function lc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];Kt=u,ub(u,s)}lb(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)cb(s),s=s.sibling}function cb(s){switch(s.tag){case 0:case 11:case 15:lc(s),s.flags&2048&&Xa(9,s,s.return);break;case 3:lc(s);break;case 12:lc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,Ed(s)):lc(s);break;default:lc(s)}}function Ed(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];Kt=u,ub(u,s)}lb(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Xa(8,i,i.return),Ed(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,Ed(i));break;default:Ed(i)}s=s.sibling}}function ub(s,i){for(;Kt!==null;){var l=Kt;switch(l.tag){case 0:case 11:case 15:Xa(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:zl(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Kt=u;else e:for(l=s;Kt!==null;){u=Kt;var f=u.sibling,g=u.return;if(tb(u),u===l){Kt=null;break e}if(f!==null){f.return=g,Kt=f;break e}Kt=g}}}var Tw={getCacheForType:function(s){var i=un(Ut),l=i.data.get(s);return l===void 0&&(l=s(),i.data.set(s,l)),l}},Aw=typeof WeakMap=="function"?WeakMap:Map,it=0,pt=null,ze=null,Xe=0,rt=0,Un=null,Ja=!1,xo=!1,Vm=!1,Na=0,At=0,ei=0,_r=0,Um=0,as=0,To=0,cc=null,Sn=null,Fm=!1,qm=0,Nd=1/0,xd=null,ti=null,tn=0,ni=null,Ao=null,jo=0,Bm=0,Hm=null,db=null,uc=0,zm=null;function Fn(){if((it&2)!==0&&Xe!==0)return Xe&-Xe;if($.T!==null){var s=fo;return s!==0?s:Wm()}return La()}function hb(){as===0&&(as=(Xe&536870912)===0||tt?_l():536870912);var s=ss.current;return s!==null&&(s.flags|=32),as}function qn(s,i,l){(s===pt&&(rt===2||rt===9)||s.cancelPendingCommit!==null)&&(wo(s,0),si(s,Xe,as,!1)),ea(s,l),((it&2)===0||s!==pt)&&(s===pt&&((it&2)===0&&(_r|=l),At===4&&si(s,Xe,as,!1)),qs(s))}function fb(s,i,l){if((it&6)!==0)throw Error(a(327));var u=!l&&(i&124)===0&&(i&s.expiredLanes)===0||Gi(s,i),f=u?Cw(s,i):Ym(s,i,!0),g=u;do{if(f===0){xo&&!u&&si(s,i,0,!1);break}else{if(l=s.current.alternate,g&&!jw(l)){f=Ym(s,i,!1),g=!1;continue}if(f===2){if(g=i,s.errorRecoveryDisabledLanes&g)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){i=N;e:{var S=s;f=cc;var B=S.current.memoizedState.isDehydrated;if(B&&(wo(S,N).flags|=256),N=Ym(S,N,!1),N!==2){if(Vm&&!B){S.errorRecoveryDisabledLanes|=g,_r|=g,f=4;break e}g=Sn,Sn=f,g!==null&&(Sn===null?Sn=g:Sn.push.apply(Sn,g))}f=N}if(g=!1,f!==2)continue}}if(f===1){wo(s,0),si(s,i,0,!0);break}e:{switch(u=s,g=f,g){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:si(u,i,as,!Ja);break e;case 2:Sn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(f=qm+300-Yn(),10<f)){if(si(u,i,as,!Ja),Hr(u,0,!0)!==0)break e;u.timeoutHandle=Bb(mb.bind(null,u,l,Sn,xd,Fm,i,as,_r,To,Ja,g,2,-0,0),f);break e}mb(u,l,Sn,xd,Fm,i,as,_r,To,Ja,g,0,-0,0)}}break}while(!0);qs(s)}function mb(s,i,l,u,f,g,N,S,B,Z,se,oe,J,te){if(s.timeoutHandle=-1,oe=i.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(vc={stylesheets:null,count:0,unsuspend:oC},ob(i),oe=cC(),oe!==null)){s.cancelPendingCommit=oe(Eb.bind(null,s,i,g,l,u,f,N,S,B,se,1,J,te)),si(s,g,N,!Z);return}Eb(s,i,g,l,u,f,N,S,B)}function jw(s){for(var i=s;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var f=l[u],g=f.getSnapshot;f=f.value;try{if(!kn(g(),f))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function si(s,i,l,u){i&=~Um,i&=~_r,s.suspendedLanes|=i,s.pingedLanes&=~i,u&&(s.warmLanes|=i),u=s.expirationTimes;for(var f=i;0<f;){var g=31-cn(f),N=1<<g;u[g]=-1,f&=~N}l!==0&&js(s,l,i)}function Td(){return(it&6)===0?(dc(0),!1):!0}function Gm(){if(ze!==null){if(rt===0)var s=ze.return;else s=ze,ma=fr=null,lm(s),_o=null,tc=0,s=ze;for(;s!==null;)Y_(s.alternate,s),s=s.return;ze=null}}function wo(s,i){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,zw(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Gm(),pt=s,ze=l=da(s.current,null),Xe=i,rt=0,Un=null,Ja=!1,xo=Gi(s,i),Vm=!1,To=as=Um=_r=ei=At=0,Sn=cc=null,Fm=!1,(i&8)!==0&&(i|=i&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=i;0<u;){var f=31-cn(u),g=1<<f;i|=s[f],u&=~g}return Na=i,$u(),l}function pb(s,i){Ue=null,$.H=dd,i===$l||i===td?(i=Dy(),rt=3):i===Sy?(i=Dy(),rt=4):rt=i===M_?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Un=i,ze===null&&(At=1,gd(s,Jn(i,s.current)))}function gb(){var s=$.H;return $.H=dd,s===null?dd:s}function vb(){var s=$.A;return $.A=Tw,s}function $m(){At=4,Ja||(Xe&4194048)!==Xe&&ss.current!==null||(xo=!0),(ei&134217727)===0&&(_r&134217727)===0||pt===null||si(pt,Xe,as,!1)}function Ym(s,i,l){var u=it;it|=2;var f=gb(),g=vb();(pt!==s||Xe!==i)&&(xd=null,wo(s,i)),i=!1;var N=At;e:do try{if(rt!==0&&ze!==null){var S=ze,B=Un;switch(rt){case 8:Gm(),N=6;break e;case 3:case 2:case 9:case 6:ss.current===null&&(i=!0);var Z=rt;if(rt=0,Un=null,Co(s,S,B,Z),l&&xo){N=0;break e}break;default:Z=rt,rt=0,Un=null,Co(s,S,B,Z)}}ww(),N=At;break}catch(se){pb(s,se)}while(!0);return i&&s.shellSuspendCounter++,ma=fr=null,it=u,$.H=f,$.A=g,ze===null&&(pt=null,Xe=0,$u()),N}function ww(){for(;ze!==null;)yb(ze)}function Cw(s,i){var l=it;it|=2;var u=gb(),f=vb();pt!==s||Xe!==i?(xd=null,Nd=Yn()+500,wo(s,i)):xo=Gi(s,i);e:do try{if(rt!==0&&ze!==null){i=ze;var g=Un;t:switch(rt){case 1:rt=0,Un=null,Co(s,i,g,1);break;case 2:case 9:if(Iy(g)){rt=0,Un=null,_b(i);break}i=function(){rt!==2&&rt!==9||pt!==s||(rt=7),qs(s)},g.then(i,i);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:Iy(g)?(rt=0,Un=null,_b(i)):(rt=0,Un=null,Co(s,i,g,7));break;case 5:var N=null;switch(ze.tag){case 26:N=ze.memoizedState;case 5:case 27:var S=ze;if(!N||eE(N)){rt=0,Un=null;var B=S.sibling;if(B!==null)ze=B;else{var Z=S.return;Z!==null?(ze=Z,Ad(Z)):ze=null}break t}}rt=0,Un=null,Co(s,i,g,5);break;case 6:rt=0,Un=null,Co(s,i,g,6);break;case 8:Gm(),At=6;break e;default:throw Error(a(462))}}Sw();break}catch(se){pb(s,se)}while(!0);return ma=fr=null,$.H=u,$.A=f,it=l,ze!==null?0:(pt=null,Xe=0,$u(),At)}function Sw(){for(;ze!==null&&!pl();)yb(ze)}function yb(s){var i=G_(s.alternate,s,Na);s.memoizedProps=s.pendingProps,i===null?Ad(s):ze=i}function _b(s){var i=s,l=i.alternate;switch(i.tag){case 15:case 0:i=U_(l,i,i.pendingProps,i.type,void 0,Xe);break;case 11:i=U_(l,i,i.pendingProps,i.type.render,i.ref,Xe);break;case 5:lm(i);default:Y_(l,i),i=ze=by(i,Na),i=G_(l,i,Na)}s.memoizedProps=s.pendingProps,i===null?Ad(s):ze=i}function Co(s,i,l,u){ma=fr=null,lm(i),_o=null,tc=0;var f=i.return;try{if(yw(s,f,i,l,Xe)){At=1,gd(s,Jn(l,s.current)),ze=null;return}}catch(g){if(f!==null)throw ze=f,g;At=1,gd(s,Jn(l,s.current)),ze=null;return}i.flags&32768?(tt||u===1?s=!0:xo||(Xe&536870912)!==0?s=!1:(Ja=s=!0,(u===2||u===9||u===3||u===6)&&(u=ss.current,u!==null&&u.tag===13&&(u.flags|=16384))),bb(i,s)):Ad(i)}function Ad(s){var i=s;do{if((i.flags&32768)!==0){bb(i,Ja);return}s=i.return;var l=bw(i.alternate,i,Na);if(l!==null){ze=l;return}if(i=i.sibling,i!==null){ze=i;return}ze=i=s}while(i!==null);At===0&&(At=5)}function bb(s,i){do{var l=Ew(s.alternate,s);if(l!==null){l.flags&=32767,ze=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(s=s.sibling,s!==null)){ze=s;return}ze=s=l}while(s!==null);At=6,ze=null}function Eb(s,i,l,u,f,g,N,S,B){s.cancelPendingCommit=null;do jd();while(tn!==0);if((it&6)!==0)throw Error(a(327));if(i!==null){if(i===s.current)throw Error(a(177));if(g=i.lanes|i.childLanes,g|=Lf,El(s,l,g,N,S,B),s===pt&&(ze=pt=null,Xe=0),Ao=i,ni=s,jo=l,Bm=g,Hm=f,db=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Mw(qi,function(){return jb(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=$.T,$.T=null,f=z.p,z.p=2,N=it,it|=4;try{Nw(s,i,l)}finally{it=N,z.p=f,$.T=u}}tn=1,Nb(),xb(),Tb()}}function Nb(){if(tn===1){tn=0;var s=ni,i=Ao,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=$.T,$.T=null;var u=z.p;z.p=2;var f=it;it|=4;try{ab(i,s);var g=ip,N=uy(s.containerInfo),S=g.focusedElem,B=g.selectionRange;if(N!==S&&S&&S.ownerDocument&&cy(S.ownerDocument.documentElement,S)){if(B!==null&&Df(S)){var Z=B.start,se=B.end;if(se===void 0&&(se=Z),"selectionStart"in S)S.selectionStart=Z,S.selectionEnd=Math.min(se,S.value.length);else{var oe=S.ownerDocument||document,J=oe&&oe.defaultView||window;if(J.getSelection){var te=J.getSelection(),Ie=S.textContent.length,Te=Math.min(B.start,Ie),ut=B.end===void 0?Te:Math.min(B.end,Ie);!te.extend&&Te>ut&&(N=ut,ut=Te,Te=N);var K=ly(S,Te),G=ly(S,ut);if(K&&G&&(te.rangeCount!==1||te.anchorNode!==K.node||te.anchorOffset!==K.offset||te.focusNode!==G.node||te.focusOffset!==G.offset)){var W=oe.createRange();W.setStart(K.node,K.offset),te.removeAllRanges(),Te>ut?(te.addRange(W),te.extend(G.node,G.offset)):(W.setEnd(G.node,G.offset),te.addRange(W))}}}}for(oe=[],te=S;te=te.parentNode;)te.nodeType===1&&oe.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<oe.length;S++){var ie=oe[S];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Vd=!!ap,ip=ap=null}finally{it=f,z.p=u,$.T=l}}s.current=i,tn=2}}function xb(){if(tn===2){tn=0;var s=ni,i=Ao,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=$.T,$.T=null;var u=z.p;z.p=2;var f=it;it|=4;try{eb(s,i.alternate,i)}finally{it=f,z.p=u,$.T=l}}tn=3}}function Tb(){if(tn===4||tn===3){tn=0,Eu();var s=ni,i=Ao,l=jo,u=db;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?tn=5:(tn=0,Ao=ni=null,Ab(s,s.pendingLanes));var f=s.pendingLanes;if(f===0&&(ti=null),zr(l),i=i.stateNode,at&&typeof at.onCommitFiberRoot=="function")try{at.onCommitFiberRoot(xt,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=$.T,f=z.p,z.p=2,$.T=null;try{for(var g=s.onRecoverableError,N=0;N<u.length;N++){var S=u[N];g(S.value,{componentStack:S.stack})}}finally{$.T=i,z.p=f}}(jo&3)!==0&&jd(),qs(s),f=s.pendingLanes,(l&4194090)!==0&&(f&42)!==0?s===zm?uc++:(uc=0,zm=s):uc=0,dc(0)}}function Ab(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,zl(i)))}function jd(s){return Nb(),xb(),Tb(),jb()}function jb(){if(tn!==5)return!1;var s=ni,i=Bm;Bm=0;var l=zr(jo),u=$.T,f=z.p;try{z.p=32>l?32:l,$.T=null,l=Hm,Hm=null;var g=ni,N=jo;if(tn=0,Ao=ni=null,jo=0,(it&6)!==0)throw Error(a(331));var S=it;if(it|=4,cb(g.current),rb(g,g.current,N,l),it=S,dc(0,!1),at&&typeof at.onPostCommitFiberRoot=="function")try{at.onPostCommitFiberRoot(xt,g)}catch{}return!0}finally{z.p=f,$.T=u,Ab(s,i)}}function wb(s,i,l){i=Jn(l,i),i=Nm(s.stateNode,i,2),s=$a(s,i,2),s!==null&&(ea(s,2),qs(s))}function dt(s,i,l){if(s.tag===3)wb(s,s,l);else for(;i!==null;){if(i.tag===3){wb(i,s,l);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ti===null||!ti.has(u))){s=Jn(l,s),l=R_(2),u=$a(i,l,2),u!==null&&(D_(l,u,i,s),ea(u,2),qs(u));break}}i=i.return}}function Km(s,i,l){var u=s.pingCache;if(u===null){u=s.pingCache=new Aw;var f=new Set;u.set(i,f)}else f=u.get(i),f===void 0&&(f=new Set,u.set(i,f));f.has(l)||(Vm=!0,f.add(l),s=Iw.bind(null,s,i,l),i.then(s,s))}function Iw(s,i,l){var u=s.pingCache;u!==null&&u.delete(i),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,pt===s&&(Xe&l)===l&&(At===4||At===3&&(Xe&62914560)===Xe&&300>Yn()-qm?(it&2)===0&&wo(s,0):Um|=l,To===Xe&&(To=0)),qs(s)}function Cb(s,i){i===0&&(i=bl()),s=lo(s,i),s!==null&&(ea(s,i),qs(s))}function Rw(s){var i=s.memoizedState,l=0;i!==null&&(l=i.retryLane),Cb(s,l)}function Dw(s,i){var l=0;switch(s.tag){case 13:var u=s.stateNode,f=s.memoizedState;f!==null&&(l=f.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(i),Cb(s,l)}function Mw(s,i){return Ui(s,i)}var wd=null,So=null,Qm=!1,Cd=!1,Xm=!1,br=0;function qs(s){s!==So&&s.next===null&&(So===null?wd=So=s:So=So.next=s),Cd=!0,Qm||(Qm=!0,kw())}function dc(s,i){if(!Xm&&Cd){Xm=!0;do for(var l=!1,u=wd;u!==null;){if(s!==0){var f=u.pendingLanes;if(f===0)var g=0;else{var N=u.suspendedLanes,S=u.pingedLanes;g=(1<<31-cn(42|s)+1)-1,g&=f&~(N&~S),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,Db(u,g))}else g=Xe,g=Hr(u,u===pt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||Gi(u,g)||(l=!0,Db(u,g));u=u.next}while(l);Xm=!1}}function Ow(){Sb()}function Sb(){Cd=Qm=!1;var s=0;br!==0&&(Hw()&&(s=br),br=0);for(var i=Yn(),l=null,u=wd;u!==null;){var f=u.next,g=Ib(u,i);g===0?(u.next=null,l===null?wd=f:l.next=f,f===null&&(So=l)):(l=u,(s!==0||(g&3)!==0)&&(Cd=!0)),u=f}dc(s)}function Ib(s,i){for(var l=s.suspendedLanes,u=s.pingedLanes,f=s.expirationTimes,g=s.pendingLanes&-62914561;0<g;){var N=31-cn(g),S=1<<N,B=f[N];B===-1?((S&l)===0||(S&u)!==0)&&(f[N]=yl(S,i)):B<=i&&(s.expiredLanes|=S),g&=~S}if(i=pt,l=Xe,l=Hr(s,s===i?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===i&&(rt===2||rt===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Fi(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Gi(s,l)){if(i=l&-l,i===s.callbackPriority)return i;switch(u!==null&&Fi(u),zr(l)){case 2:case 8:l=qr;break;case 32:l=qi;break;case 268435456:l=Br;break;default:l=qi}return u=Rb.bind(null,s),l=Ui(l,u),s.callbackPriority=i,s.callbackNode=l,i}return u!==null&&u!==null&&Fi(u),s.callbackPriority=2,s.callbackNode=null,2}function Rb(s,i){if(tn!==0&&tn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(jd()&&s.callbackNode!==l)return null;var u=Xe;return u=Hr(s,s===pt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(fb(s,u,i),Ib(s,Yn()),s.callbackNode!=null&&s.callbackNode===l?Rb.bind(null,s):null)}function Db(s,i){if(jd())return null;fb(s,i,!0)}function kw(){Gw(function(){(it&6)!==0?Ui(gl,Ow):Sb()})}function Wm(){return br===0&&(br=_l()),br}function Mb(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Xr(""+s)}function Ob(s,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,s.id&&l.setAttribute("form",s.id),i.parentNode.insertBefore(l,i),s=new FormData(s),l.parentNode.removeChild(l),s}function Pw(s,i,l,u,f){if(i==="submit"&&l&&l.stateNode===f){var g=Mb((f[It]||null).action),N=u.submitter;N&&(i=(i=N[It]||null)?Mb(i.formAction):N.getAttribute("formAction"),i!==null&&(g=i,N=null));var S=new Wr("action","action",null,u,f);s.push({event:S,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(br!==0){var B=N?Ob(f,N):new FormData(f);vm(l,{pending:!0,data:B,method:f.method,action:g},null,B)}}else typeof g=="function"&&(S.preventDefault(),B=N?Ob(f,N):new FormData(f),vm(l,{pending:!0,data:B,method:f.method,action:g},g,B))},currentTarget:f}]})}}for(var Zm=0;Zm<Pf.length;Zm++){var Jm=Pf[Zm],Lw=Jm.toLowerCase(),Vw=Jm[0].toUpperCase()+Jm.slice(1);fs(Lw,"on"+Vw)}fs(fy,"onAnimationEnd"),fs(my,"onAnimationIteration"),fs(py,"onAnimationStart"),fs("dblclick","onDoubleClick"),fs("focusin","onFocus"),fs("focusout","onBlur"),fs(tw,"onTransitionRun"),fs(nw,"onTransitionStart"),fs(sw,"onTransitionCancel"),fs(gy,"onTransitionEnd"),na("onMouseEnter",["mouseout","mouseover"]),na("onMouseLeave",["mouseout","mouseover"]),na("onPointerEnter",["pointerout","pointerover"]),na("onPointerLeave",["pointerout","pointerover"]),ds("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ds("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ds("onBeforeInput",["compositionend","keypress","textInput","paste"]),ds("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ds("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ds("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Uw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hc));function kb(s,i){i=(i&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],f=u.event;u=u.listeners;e:{var g=void 0;if(i)for(var N=u.length-1;0<=N;N--){var S=u[N],B=S.instance,Z=S.currentTarget;if(S=S.listener,B!==g&&f.isPropagationStopped())break e;g=S,f.currentTarget=Z;try{g(f)}catch(se){pd(se)}f.currentTarget=null,g=B}else for(N=0;N<u.length;N++){if(S=u[N],B=S.instance,Z=S.currentTarget,S=S.listener,B!==g&&f.isPropagationStopped())break e;g=S,f.currentTarget=Z;try{g(f)}catch(se){pd(se)}f.currentTarget=null,g=B}}}}function Ge(s,i){var l=i[xl];l===void 0&&(l=i[xl]=new Set);var u=s+"__bubble";l.has(u)||(Pb(i,s,2,!1),l.add(u))}function ep(s,i,l){var u=0;i&&(u|=4),Pb(l,s,u,i)}var Sd="_reactListening"+Math.random().toString(36).slice(2);function tp(s){if(!s[Sd]){s[Sd]=!0,Tl.forEach(function(l){l!=="selectionchange"&&(Uw.has(l)||ep(l,!1,s),ep(l,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Sd]||(i[Sd]=!0,ep("selectionchange",!1,i))}}function Pb(s,i,l,u){switch(rE(i)){case 2:var f=hC;break;case 8:f=fC;break;default:f=pp}l=f.bind(null,i,l,s),f=void 0,!Wn||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),u?f!==void 0?s.addEventListener(i,l,{capture:!0,passive:f}):s.addEventListener(i,l,!0):f!==void 0?s.addEventListener(i,l,{passive:f}):s.addEventListener(i,l,!1)}function np(s,i,l,u,f){var g=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var N=u.tag;if(N===3||N===4){var S=u.stateNode.containerInfo;if(S===f)break;if(N===4)for(N=u.return;N!==null;){var B=N.tag;if((B===3||B===4)&&N.stateNode.containerInfo===f)return;N=N.return}for(;S!==null;){if(N=ta(S),N===null)return;if(B=N.tag,B===5||B===6||B===26||B===27){u=g=N;continue e}S=S.parentNode}}u=u.return}Ru(function(){var Z=g,se=Xn(l),oe=[];e:{var J=vy.get(s);if(J!==void 0){var te=Wr,Ie=s;switch(s){case"keypress":if(Ds(l)===0)break e;case"keydown":case"keyup":te=so;break;case"focusin":Ie="focus",te=eo;break;case"focusout":Ie="blur",te=eo;break;case"beforeblur":case"afterblur":te=eo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=Zn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=Cf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=Uu;break;case fy:case my:case py:te=to;break;case gy:te=qu;break;case"scroll":case"scrollend":te=Du;break;case"wheel":te=ao;break;case"copy":case"cut":case"paste":te=no;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=Pl;break;case"toggle":case"beforetoggle":te=Hu}var Te=(i&4)!==0,ut=!Te&&(s==="scroll"||s==="scrollend"),K=Te?J!==null?J+"Capture":null:J;Te=[];for(var G=Z,W;G!==null;){var ie=G;if(W=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||W===null||K===null||(ie=Ji(G,K),ie!=null&&Te.push(fc(G,ie,W))),ut)break;G=G.return}0<Te.length&&(J=new te(J,Ie,null,l,se),oe.push({event:J,listeners:Te}))}}if((i&7)===0){e:{if(J=s==="mouseover"||s==="pointerover",te=s==="mouseout"||s==="pointerout",J&&l!==ia&&(Ie=l.relatedTarget||l.fromElement)&&(ta(Ie)||Ie[Kn]))break e;if((te||J)&&(J=se.window===se?se:(J=se.ownerDocument)?J.defaultView||J.parentWindow:window,te?(Ie=l.relatedTarget||l.toElement,te=Z,Ie=Ie?ta(Ie):null,Ie!==null&&(ut=c(Ie),Te=Ie.tag,Ie!==ut||Te!==5&&Te!==27&&Te!==6)&&(Ie=null)):(te=null,Ie=Z),te!==Ie)){if(Te=Zn,ie="onMouseLeave",K="onMouseEnter",G="mouse",(s==="pointerout"||s==="pointerover")&&(Te=Pl,ie="onPointerLeave",K="onPointerEnter",G="pointer"),ut=te==null?J:Cs(te),W=Ie==null?J:Cs(Ie),J=new Te(ie,G+"leave",te,l,se),J.target=ut,J.relatedTarget=W,ie=null,ta(se)===Z&&(Te=new Te(K,G+"enter",Ie,l,se),Te.target=W,Te.relatedTarget=ut,ie=Te),ut=ie,te&&Ie)t:{for(Te=te,K=Ie,G=0,W=Te;W;W=Io(W))G++;for(W=0,ie=K;ie;ie=Io(ie))W++;for(;0<G-W;)Te=Io(Te),G--;for(;0<W-G;)K=Io(K),W--;for(;G--;){if(Te===K||K!==null&&Te===K.alternate)break t;Te=Io(Te),K=Io(K)}Te=null}else Te=null;te!==null&&Lb(oe,J,te,Te,!1),Ie!==null&&ut!==null&&Lb(oe,ut,Ie,Te,!0)}}e:{if(J=Z?Cs(Z):window,te=J.nodeName&&J.nodeName.toLowerCase(),te==="select"||te==="input"&&J.type==="file")var ye=ny;else if(Vt(J))if(sy)ye=Zj;else{ye=Xj;var Be=Qj}else te=J.nodeName,!te||te.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?Z&&Sl(Z.elementType)&&(ye=ny):ye=Wj;if(ye&&(ye=ye(s,Z))){ua(oe,ye,l,se);break e}Be&&Be(s,J,Z),s==="focusout"&&Z&&J.type==="number"&&Z.memoizedProps.value!=null&&qa(J,"number",J.value)}switch(Be=Z?Cs(Z):window,s){case"focusin":(Vt(Be)||Be.contentEditable==="true")&&(io=Be,Mf=Z,Ul=null);break;case"focusout":Ul=Mf=io=null;break;case"mousedown":Of=!0;break;case"contextmenu":case"mouseup":case"dragend":Of=!1,dy(oe,l,se);break;case"selectionchange":if(ew)break;case"keydown":case"keyup":dy(oe,l,se)}var be;if(ks)e:{switch(s){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Ke?ne(s,l)&&(je="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(je="onCompositionStart");je&&(E&&l.locale!=="ko"&&(Ke||je!=="onCompositionStart"?je==="onCompositionEnd"&&Ke&&(be=Rl()):(Rs=se,Ba="value"in Rs?Rs.value:Rs.textContent,Ke=!0)),Be=Id(Z,je),0<Be.length&&(je=new Ol(je,s,null,l,se),oe.push({event:je,listeners:Be}),be?je.data=be:(be=de(l),be!==null&&(je.data=be)))),(be=y?Lt(s,l):Qe(s,l))&&(je=Id(Z,"onBeforeInput"),0<je.length&&(Be=new Ol("onBeforeInput","beforeinput",null,l,se),oe.push({event:Be,listeners:je}),Be.data=be)),Pw(oe,s,Z,l,se)}kb(oe,i)})}function fc(s,i,l){return{instance:s,listener:i,currentTarget:l}}function Id(s,i){for(var l=i+"Capture",u=[];s!==null;){var f=s,g=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||g===null||(f=Ji(s,l),f!=null&&u.unshift(fc(s,f,g)),f=Ji(s,i),f!=null&&u.push(fc(s,f,g))),s.tag===3)return u;s=s.return}return[]}function Io(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Lb(s,i,l,u,f){for(var g=i._reactName,N=[];l!==null&&l!==u;){var S=l,B=S.alternate,Z=S.stateNode;if(S=S.tag,B!==null&&B===u)break;S!==5&&S!==26&&S!==27||Z===null||(B=Z,f?(Z=Ji(l,g),Z!=null&&N.unshift(fc(l,Z,B))):f||(Z=Ji(l,g),Z!=null&&N.push(fc(l,Z,B)))),l=l.return}N.length!==0&&s.push({event:i,listeners:N})}var Fw=/\r\n?/g,qw=/\u0000|\uFFFD/g;function Vb(s){return(typeof s=="string"?s:""+s).replace(Fw,`
`).replace(qw,"")}function Ub(s,i){return i=Vb(i),Vb(s)===i}function Rd(){}function ct(s,i,l,u,f,g){switch(l){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||Qn(s,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&Qn(s,""+u);break;case"className":Ss(s,"class",u);break;case"tabIndex":Ss(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ss(s,l,u);break;case"style":Cl(s,u,g);break;case"data":if(i!=="object"){Ss(s,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Xr(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(i!=="input"&&ct(s,i,"name",f.name,f,null),ct(s,i,"formEncType",f.formEncType,f,null),ct(s,i,"formMethod",f.formMethod,f,null),ct(s,i,"formTarget",f.formTarget,f,null)):(ct(s,i,"encType",f.encType,f,null),ct(s,i,"method",f.method,f,null),ct(s,i,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Xr(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=Rd);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Xr(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":Ge("beforetoggle",s),Ge("toggle",s),Fa(s,"popover",u);break;case"xlinkActuate":Zt(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Zt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Zt(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Zt(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Zt(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Zt(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Fa(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=jf.get(l)||l,Fa(s,l,u))}}function sp(s,i,l,u,f,g){switch(l){case"style":Cl(s,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"children":typeof u=="string"?Qn(s,u):(typeof u=="number"||typeof u=="bigint")&&Qn(s,""+u);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"onClick":u!=null&&(s.onclick=Rd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gr.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),i=l.slice(2,f?l.length-7:void 0),g=s[It]||null,g=g!=null?g[l]:null,typeof g=="function"&&s.removeEventListener(i,g,f),typeof u=="function")){typeof g!="function"&&g!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(i,u,f);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):Fa(s,l,u)}}}function nn(s,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",s),Ge("load",s);var u=!1,f=!1,g;for(g in l)if(l.hasOwnProperty(g)){var N=l[g];if(N!=null)switch(g){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:ct(s,i,g,N,l,null)}}f&&ct(s,i,"srcSet",l.srcSet,l,null),u&&ct(s,i,"src",l.src,l,null);return;case"input":Ge("invalid",s);var S=g=N=f=null,B=null,Z=null;for(u in l)if(l.hasOwnProperty(u)){var se=l[u];if(se!=null)switch(u){case"name":f=se;break;case"type":N=se;break;case"checked":B=se;break;case"defaultChecked":Z=se;break;case"value":g=se;break;case"defaultValue":S=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(a(137,i));break;default:ct(s,i,u,se,l,null)}}Xi(s,g,S,B,Z,N,f,!1),Qr(s);return;case"select":Ge("invalid",s),u=N=g=null;for(f in l)if(l.hasOwnProperty(f)&&(S=l[f],S!=null))switch(f){case"value":g=S;break;case"defaultValue":N=S;break;case"multiple":u=S;default:ct(s,i,f,S,l,null)}i=g,l=N,s.multiple=!!u,i!=null?aa(s,!!u,i,!1):l!=null&&aa(s,!!u,l,!0);return;case"textarea":Ge("invalid",s),g=f=u=null;for(N in l)if(l.hasOwnProperty(N)&&(S=l[N],S!=null))switch(N){case"value":u=S;break;case"defaultValue":f=S;break;case"children":g=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(a(91));break;default:ct(s,i,N,S,l,null)}Wi(s,u,f,g),Qr(s);return;case"option":for(B in l)if(l.hasOwnProperty(B)&&(u=l[B],u!=null))switch(B){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:ct(s,i,B,u,l,null)}return;case"dialog":Ge("beforetoggle",s),Ge("toggle",s),Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":Ge("load",s);break;case"video":case"audio":for(u=0;u<hc.length;u++)Ge(hc[u],s);break;case"image":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"embed":case"source":case"link":Ge("error",s),Ge("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Z in l)if(l.hasOwnProperty(Z)&&(u=l[Z],u!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:ct(s,i,Z,u,l,null)}return;default:if(Sl(i)){for(se in l)l.hasOwnProperty(se)&&(u=l[se],u!==void 0&&sp(s,i,se,u,l,void 0));return}}for(S in l)l.hasOwnProperty(S)&&(u=l[S],u!=null&&ct(s,i,S,u,l,null))}function Bw(s,i,l,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,g=null,N=null,S=null,B=null,Z=null,se=null;for(te in l){var oe=l[te];if(l.hasOwnProperty(te)&&oe!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":B=oe;default:u.hasOwnProperty(te)||ct(s,i,te,null,u,oe)}}for(var J in u){var te=u[J];if(oe=l[J],u.hasOwnProperty(J)&&(te!=null||oe!=null))switch(J){case"type":g=te;break;case"name":f=te;break;case"checked":Z=te;break;case"defaultChecked":se=te;break;case"value":N=te;break;case"defaultValue":S=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(a(137,i));break;default:te!==oe&&ct(s,i,J,te,u,oe)}}On(s,N,S,B,Z,se,g,f);return;case"select":te=N=S=J=null;for(g in l)if(B=l[g],l.hasOwnProperty(g)&&B!=null)switch(g){case"value":break;case"multiple":te=B;default:u.hasOwnProperty(g)||ct(s,i,g,null,u,B)}for(f in u)if(g=u[f],B=l[f],u.hasOwnProperty(f)&&(g!=null||B!=null))switch(f){case"value":J=g;break;case"defaultValue":S=g;break;case"multiple":N=g;default:g!==B&&ct(s,i,f,g,u,B)}i=S,l=N,u=te,J!=null?aa(s,!!l,J,!1):!!u!=!!l&&(i!=null?aa(s,!!l,i,!0):aa(s,!!l,l?[]:"",!1));return;case"textarea":te=J=null;for(S in l)if(f=l[S],l.hasOwnProperty(S)&&f!=null&&!u.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:ct(s,i,S,null,u,f)}for(N in u)if(f=u[N],g=l[N],u.hasOwnProperty(N)&&(f!=null||g!=null))switch(N){case"value":J=f;break;case"defaultValue":te=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==g&&ct(s,i,N,f,u,g)}ot(s,J,te);return;case"option":for(var Ie in l)if(J=l[Ie],l.hasOwnProperty(Ie)&&J!=null&&!u.hasOwnProperty(Ie))switch(Ie){case"selected":s.selected=!1;break;default:ct(s,i,Ie,null,u,J)}for(B in u)if(J=u[B],te=l[B],u.hasOwnProperty(B)&&J!==te&&(J!=null||te!=null))switch(B){case"selected":s.selected=J&&typeof J!="function"&&typeof J!="symbol";break;default:ct(s,i,B,J,u,te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Te in l)J=l[Te],l.hasOwnProperty(Te)&&J!=null&&!u.hasOwnProperty(Te)&&ct(s,i,Te,null,u,J);for(Z in u)if(J=u[Z],te=l[Z],u.hasOwnProperty(Z)&&J!==te&&(J!=null||te!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(a(137,i));break;default:ct(s,i,Z,J,u,te)}return;default:if(Sl(i)){for(var ut in l)J=l[ut],l.hasOwnProperty(ut)&&J!==void 0&&!u.hasOwnProperty(ut)&&sp(s,i,ut,void 0,u,J);for(se in u)J=u[se],te=l[se],!u.hasOwnProperty(se)||J===te||J===void 0&&te===void 0||sp(s,i,se,J,u,te);return}}for(var K in l)J=l[K],l.hasOwnProperty(K)&&J!=null&&!u.hasOwnProperty(K)&&ct(s,i,K,null,u,J);for(oe in u)J=u[oe],te=l[oe],!u.hasOwnProperty(oe)||J===te||J==null&&te==null||ct(s,i,oe,J,u,te)}var ap=null,ip=null;function Dd(s){return s.nodeType===9?s:s.ownerDocument}function Fb(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qb(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function rp(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var op=null;function Hw(){var s=window.event;return s&&s.type==="popstate"?s===op?!1:(op=s,!0):(op=null,!1)}var Bb=typeof setTimeout=="function"?setTimeout:void 0,zw=typeof clearTimeout=="function"?clearTimeout:void 0,Hb=typeof Promise=="function"?Promise:void 0,Gw=typeof queueMicrotask=="function"?queueMicrotask:typeof Hb<"u"?function(s){return Hb.resolve(null).then(s).catch($w)}:Bb;function $w(s){setTimeout(function(){throw s})}function ai(s){return s==="head"}function zb(s,i){var l=i,u=0,f=0;do{var g=l.nextSibling;if(s.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(0<u&&8>u){l=u;var N=s.ownerDocument;if(l&1&&mc(N.documentElement),l&2&&mc(N.body),l&4)for(l=N.head,mc(l),N=l.firstChild;N;){var S=N.nextSibling,B=N.nodeName;N[$i]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&N.rel.toLowerCase()==="stylesheet"||l.removeChild(N),N=S}}if(f===0){s.removeChild(g),Nc(i);return}f--}else l==="$"||l==="$?"||l==="$!"?f++:u=l.charCodeAt(0)-48;else u=0;l=g}while(l);Nc(i)}function lp(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":lp(l),Ua(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function Yw(s,i,l,u){for(;s.nodeType===1;){var f=l;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[$i])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(g=s.getAttribute("rel"),g==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(g!==f.rel||s.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||s.getAttribute("title")!==(f.title==null?null:f.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(g=s.getAttribute("src"),(g!==(f.src==null?null:f.src)||s.getAttribute("type")!==(f.type==null?null:f.type)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&g&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var g=f.name==null?null:""+f.name;if(f.type==="hidden"&&s.getAttribute("name")===g)return s}else return s;if(s=ps(s.nextSibling),s===null)break}return null}function Kw(s,i,l){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=ps(s.nextSibling),s===null))return null;return s}function cp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Qw(s,i){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")i();else{var u=function(){i(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function ps(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var up=null;function Gb(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(i===0)return s;i--}else l==="/$"&&i++}s=s.previousSibling}return null}function $b(s,i,l){switch(i=Dd(l),s){case"html":if(s=i.documentElement,!s)throw Error(a(452));return s;case"head":if(s=i.head,!s)throw Error(a(453));return s;case"body":if(s=i.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function mc(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);Ua(s)}var is=new Map,Yb=new Set;function Md(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var xa=z.d;z.d={f:Xw,r:Ww,D:Zw,C:Jw,L:eC,m:tC,X:sC,S:nC,M:aC};function Xw(){var s=xa.f(),i=Td();return s||i}function Ww(s){var i=ws(s);i!==null&&i.tag===5&&i.type==="form"?f_(i):xa.r(s)}var Ro=typeof document>"u"?null:document;function Kb(s,i,l){var u=Ro;if(u&&typeof i=="string"&&i){var f=Rt(i);f='link[rel="'+s+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),Yb.has(f)||(Yb.add(f),s={rel:s,crossOrigin:l,href:i},u.querySelector(f)===null&&(i=u.createElement("link"),nn(i,"link",s),jt(i),u.head.appendChild(i)))}}function Zw(s){xa.D(s),Kb("dns-prefetch",s,null)}function Jw(s,i){xa.C(s,i),Kb("preconnect",s,i)}function eC(s,i,l){xa.L(s,i,l);var u=Ro;if(u&&s&&i){var f='link[rel="preload"][as="'+Rt(i)+'"]';i==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+Rt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+Rt(l.imageSizes)+'"]')):f+='[href="'+Rt(s)+'"]';var g=f;switch(i){case"style":g=Do(s);break;case"script":g=Mo(s)}is.has(g)||(s=_({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:s,as:i},l),is.set(g,s),u.querySelector(f)!==null||i==="style"&&u.querySelector(pc(g))||i==="script"&&u.querySelector(gc(g))||(i=u.createElement("link"),nn(i,"link",s),jt(i),u.head.appendChild(i)))}}function tC(s,i){xa.m(s,i);var l=Ro;if(l&&s){var u=i&&typeof i.as=="string"?i.as:"script",f='link[rel="modulepreload"][as="'+Rt(u)+'"][href="'+Rt(s)+'"]',g=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Mo(s)}if(!is.has(g)&&(s=_({rel:"modulepreload",href:s},i),is.set(g,s),l.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(gc(g)))return}u=l.createElement("link"),nn(u,"link",s),jt(u),l.head.appendChild(u)}}}function nC(s,i,l){xa.S(s,i,l);var u=Ro;if(u&&s){var f=vn(u).hoistableStyles,g=Do(s);i=i||"default";var N=f.get(g);if(!N){var S={loading:0,preload:null};if(N=u.querySelector(pc(g)))S.loading=5;else{s=_({rel:"stylesheet",href:s,"data-precedence":i},l),(l=is.get(g))&&dp(s,l);var B=N=u.createElement("link");jt(B),nn(B,"link",s),B._p=new Promise(function(Z,se){B.onload=Z,B.onerror=se}),B.addEventListener("load",function(){S.loading|=1}),B.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Od(N,i,u)}N={type:"stylesheet",instance:N,count:1,state:S},f.set(g,N)}}}function sC(s,i){xa.X(s,i);var l=Ro;if(l&&s){var u=vn(l).hoistableScripts,f=Mo(s),g=u.get(f);g||(g=l.querySelector(gc(f)),g||(s=_({src:s,async:!0},i),(i=is.get(f))&&hp(s,i),g=l.createElement("script"),jt(g),nn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(f,g))}}function aC(s,i){xa.M(s,i);var l=Ro;if(l&&s){var u=vn(l).hoistableScripts,f=Mo(s),g=u.get(f);g||(g=l.querySelector(gc(f)),g||(s=_({src:s,async:!0,type:"module"},i),(i=is.get(f))&&hp(s,i),g=l.createElement("script"),jt(g),nn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(f,g))}}function Qb(s,i,l,u){var f=(f=Re.current)?Md(f):null;if(!f)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=Do(l.href),l=vn(f).hoistableStyles,u=l.get(i),u||(u={type:"style",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Do(l.href);var g=vn(f).hoistableStyles,N=g.get(s);if(N||(f=f.ownerDocument||f,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(s,N),(g=f.querySelector(pc(s)))&&!g._p&&(N.instance=g,N.state.loading=5),is.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},is.set(s,l),g||iC(f,s,l,N.state))),i&&u===null)throw Error(a(528,""));return N}if(i&&u!==null)throw Error(a(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Mo(l),l=vn(f).hoistableScripts,u=l.get(i),u||(u={type:"script",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Do(s){return'href="'+Rt(s)+'"'}function pc(s){return'link[rel="stylesheet"]['+s+"]"}function Xb(s){return _({},s,{"data-precedence":s.precedence,precedence:null})}function iC(s,i,l,u){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=s.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),nn(i,"link",l),jt(i),s.head.appendChild(i))}function Mo(s){return'[src="'+Rt(s)+'"]'}function gc(s){return"script[async]"+s}function Wb(s,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var u=s.querySelector('style[data-href~="'+Rt(l.href)+'"]');if(u)return i.instance=u,jt(u),u;var f=_({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),jt(u),nn(u,"style",f),Od(u,l.precedence,s),i.instance=u;case"stylesheet":f=Do(l.href);var g=s.querySelector(pc(f));if(g)return i.state.loading|=4,i.instance=g,jt(g),g;u=Xb(l),(f=is.get(f))&&dp(u,f),g=(s.ownerDocument||s).createElement("link"),jt(g);var N=g;return N._p=new Promise(function(S,B){N.onload=S,N.onerror=B}),nn(g,"link",u),i.state.loading|=4,Od(g,l.precedence,s),i.instance=g;case"script":return g=Mo(l.src),(f=s.querySelector(gc(g)))?(i.instance=f,jt(f),f):(u=l,(f=is.get(g))&&(u=_({},l),hp(u,f)),s=s.ownerDocument||s,f=s.createElement("script"),jt(f),nn(f,"link",u),s.head.appendChild(f),i.instance=f);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,Od(u,l.precedence,s));return i.instance}function Od(s,i,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,g=f,N=0;N<u.length;N++){var S=u[N];if(S.dataset.precedence===i)g=S;else if(g!==f)break}g?g.parentNode.insertBefore(s,g.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(s,i.firstChild))}function dp(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function hp(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var kd=null;function Zb(s,i,l){if(kd===null){var u=new Map,f=kd=new Map;f.set(l,u)}else f=kd,u=f.get(l),u||(u=new Map,f.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),f=0;f<l.length;f++){var g=l[f];if(!(g[$i]||g[Pt]||s==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var N=g.getAttribute(i)||"";N=s+N;var S=u.get(N);S?S.push(g):u.set(N,[g])}}return u}function Jb(s,i,l){s=s.ownerDocument||s,s.head.insertBefore(l,i==="title"?s.querySelector("head > title"):null)}function rC(s,i,l){if(l===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function eE(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var vc=null;function oC(){}function lC(s,i,l){if(vc===null)throw Error(a(475));var u=vc;if(i.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var f=Do(l.href),g=s.querySelector(pc(f));if(g){s=g._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(u.count++,u=Pd.bind(u),s.then(u,u)),i.state.loading|=4,i.instance=g,jt(g);return}g=s.ownerDocument||s,l=Xb(l),(f=is.get(f))&&dp(l,f),g=g.createElement("link"),jt(g);var N=g;N._p=new Promise(function(S,B){N.onload=S,N.onerror=B}),nn(g,"link",l),i.instance=g}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(u.count++,i=Pd.bind(u),s.addEventListener("load",i),s.addEventListener("error",i))}}function cC(){if(vc===null)throw Error(a(475));var s=vc;return s.stylesheets&&s.count===0&&fp(s,s.stylesheets),0<s.count?function(i){var l=setTimeout(function(){if(s.stylesheets&&fp(s,s.stylesheets),s.unsuspend){var u=s.unsuspend;s.unsuspend=null,u()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(l)}}:null}function Pd(){if(this.count--,this.count===0){if(this.stylesheets)fp(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Ld=null;function fp(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Ld=new Map,i.forEach(uC,s),Ld=null,Pd.call(s))}function uC(s,i){if(!(i.state.loading&4)){var l=Ld.get(s);if(l)var u=l.get(null);else{l=new Map,Ld.set(s,l);for(var f=s.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<f.length;g++){var N=f[g];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(l.set(N.dataset.precedence,N),u=N)}u&&l.set(null,u)}f=i.instance,N=f.getAttribute("data-precedence"),g=l.get(N)||u,g===u&&l.set(null,f),l.set(N,f),this.count++,u=Pd.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),g?g.parentNode.insertBefore(f,g.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(f,s.firstChild)),i.state.loading|=4}}var yc={$$typeof:V,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function dC(s,i,l,u,f,g,N,S){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Js(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Js(0),this.hiddenUpdates=Js(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=g,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=S,this.incompleteTransitions=new Map}function tE(s,i,l,u,f,g,N,S,B,Z,se,oe){return s=new dC(s,i,l,N,S,B,Z,oe),i=1,g===!0&&(i|=24),g=Pn(3,null,null,i),s.current=g,g.stateNode=s,i=Kf(),i.refCount++,s.pooledCache=i,i.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:i},Zf(g),s}function nE(s){return s?(s=co,s):co}function sE(s,i,l,u,f,g){f=nE(f),u.context===null?u.context=f:u.pendingContext=f,u=Ga(i),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=$a(s,u,i),l!==null&&(qn(l,s,i),Kl(l,s,i))}function aE(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<i?l:i}}function mp(s,i){aE(s,i),(s=s.alternate)&&aE(s,i)}function iE(s){if(s.tag===13){var i=lo(s,67108864);i!==null&&qn(i,s,67108864),mp(s,67108864)}}var Vd=!0;function hC(s,i,l,u){var f=$.T;$.T=null;var g=z.p;try{z.p=2,pp(s,i,l,u)}finally{z.p=g,$.T=f}}function fC(s,i,l,u){var f=$.T;$.T=null;var g=z.p;try{z.p=8,pp(s,i,l,u)}finally{z.p=g,$.T=f}}function pp(s,i,l,u){if(Vd){var f=gp(u);if(f===null)np(s,i,u,Ud,l),oE(s,u);else if(pC(f,s,i,l,u))u.stopPropagation();else if(oE(s,u),i&4&&-1<mC.indexOf(s)){for(;f!==null;){var g=ws(f);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var N=us(g.pendingLanes);if(N!==0){var S=g;for(S.pendingLanes|=2,S.entangledLanes|=2;N;){var B=1<<31-cn(N);S.entanglements[1]|=B,N&=~B}qs(g),(it&6)===0&&(Nd=Yn()+500,dc(0))}}break;case 13:S=lo(g,2),S!==null&&qn(S,g,2),Td(),mp(g,2)}if(g=gp(u),g===null&&np(s,i,u,Ud,l),g===f)break;f=g}f!==null&&u.stopPropagation()}else np(s,i,u,null,l)}}function gp(s){return s=Xn(s),vp(s)}var Ud=null;function vp(s){if(Ud=null,s=ta(s),s!==null){var i=c(s);if(i===null)s=null;else{var l=i.tag;if(l===13){if(s=d(i),s!==null)return s;s=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Ud=s,null}function rE(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(bf()){case gl:return 2;case qr:return 8;case qi:case Ef:return 32;case Br:return 268435456;default:return 32}default:return 32}}var yp=!1,ii=null,ri=null,oi=null,_c=new Map,bc=new Map,li=[],mC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function oE(s,i){switch(s){case"focusin":case"focusout":ii=null;break;case"dragenter":case"dragleave":ri=null;break;case"mouseover":case"mouseout":oi=null;break;case"pointerover":case"pointerout":_c.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":bc.delete(i.pointerId)}}function Ec(s,i,l,u,f,g){return s===null||s.nativeEvent!==g?(s={blockedOn:i,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[f]},i!==null&&(i=ws(i),i!==null&&iE(i)),s):(s.eventSystemFlags|=u,i=s.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),s)}function pC(s,i,l,u,f){switch(i){case"focusin":return ii=Ec(ii,s,i,l,u,f),!0;case"dragenter":return ri=Ec(ri,s,i,l,u,f),!0;case"mouseover":return oi=Ec(oi,s,i,l,u,f),!0;case"pointerover":var g=f.pointerId;return _c.set(g,Ec(_c.get(g)||null,s,i,l,u,f)),!0;case"gotpointercapture":return g=f.pointerId,bc.set(g,Ec(bc.get(g)||null,s,i,l,u,f)),!0}return!1}function lE(s){var i=ta(s.target);if(i!==null){var l=c(i);if(l!==null){if(i=l.tag,i===13){if(i=d(l),i!==null){s.blockedOn=i,Tu(s.priority,function(){if(l.tag===13){var u=Fn();u=Pa(u);var f=lo(l,u);f!==null&&qn(f,l,u),mp(l,u)}});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Fd(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var l=gp(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);ia=u,l.target.dispatchEvent(u),ia=null}else return i=ws(l),i!==null&&iE(i),s.blockedOn=l,!1;i.shift()}return!0}function cE(s,i,l){Fd(s)&&l.delete(i)}function gC(){yp=!1,ii!==null&&Fd(ii)&&(ii=null),ri!==null&&Fd(ri)&&(ri=null),oi!==null&&Fd(oi)&&(oi=null),_c.forEach(cE),bc.forEach(cE)}function qd(s,i){s.blockedOn===i&&(s.blockedOn=null,yp||(yp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,gC)))}var Bd=null;function uE(s){Bd!==s&&(Bd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Bd===s&&(Bd=null);for(var i=0;i<s.length;i+=3){var l=s[i],u=s[i+1],f=s[i+2];if(typeof u!="function"){if(vp(u||l)===null)continue;break}var g=ws(l);g!==null&&(s.splice(i,3),i-=3,vm(g,{pending:!0,data:f,method:l.method,action:u},u,f))}}))}function Nc(s){function i(B){return qd(B,s)}ii!==null&&qd(ii,s),ri!==null&&qd(ri,s),oi!==null&&qd(oi,s),_c.forEach(i),bc.forEach(i);for(var l=0;l<li.length;l++){var u=li[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<li.length&&(l=li[0],l.blockedOn===null);)lE(l),l.blockedOn===null&&li.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var f=l[u],g=l[u+1],N=f[It]||null;if(typeof g=="function")N||uE(l);else if(N){var S=null;if(g&&g.hasAttribute("formAction")){if(f=g,N=g[It]||null)S=N.formAction;else if(vp(f)!==null)continue}else S=N.action;typeof S=="function"?l[u+1]=S:(l.splice(u,3),u-=3),uE(l)}}}function _p(s){this._internalRoot=s}Hd.prototype.render=_p.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(a(409));var l=i.current,u=Fn();sE(l,u,s,i,null,null)},Hd.prototype.unmount=_p.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;sE(s.current,2,null,s,null,null),Td(),i[Kn]=null}};function Hd(s){this._internalRoot=s}Hd.prototype.unstable_scheduleHydration=function(s){if(s){var i=La();s={blockedOn:null,target:s,priority:i};for(var l=0;l<li.length&&i!==0&&i<li[l].priority;l++);li.splice(l,0,s),l===0&&lE(s)}};var dE=e.version;if(dE!=="19.1.0")throw Error(a(527,dE,"19.1.0"));z.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=p(i),s=s!==null?v(s):null,s=s===null?null:s.stateNode,s};var vC={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zd.isDisabled&&zd.supportsFiber)try{xt=zd.inject(vC),at=zd}catch{}}return Tc.createRoot=function(s,i){if(!o(s))throw Error(a(299));var l=!1,u="",f=w_,g=C_,N=S_,S=null;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(f=i.onUncaughtError),i.onCaughtError!==void 0&&(g=i.onCaughtError),i.onRecoverableError!==void 0&&(N=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(S=i.unstable_transitionCallbacks)),i=tE(s,1,!1,null,null,l,u,f,g,N,S,null),s[Kn]=i.current,tp(s),new _p(i)},Tc.hydrateRoot=function(s,i,l){if(!o(s))throw Error(a(299));var u=!1,f="",g=w_,N=C_,S=S_,B=null,Z=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(N=l.onCaughtError),l.onRecoverableError!==void 0&&(S=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(B=l.unstable_transitionCallbacks),l.formState!==void 0&&(Z=l.formState)),i=tE(s,1,!0,i,l??null,u,f,g,N,S,B,Z),i.context=nE(null),l=i.current,u=Fn(),u=Pa(u),f=Ga(u),f.callback=null,$a(l,f,u),l=u,i.current.lanes=l,ea(i,l),qs(i),s[Kn]=i.current,tp(s),new Hd(i)},Tc.version="19.1.0",Tc}var EE;function wC(){if(EE)return Np.exports;EE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Np.exports=jC(),Np.exports}var CC=wC();const SC=()=>{};var NE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx=function(n){const e=[];let t=0;for(let a=0;a<n.length;a++){let o=n.charCodeAt(a);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&a+1<n.length&&(n.charCodeAt(a+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++a)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},IC=function(n){const e=[];let t=0,a=0;for(;t<n.length;){const o=n[t++];if(o<128)e[a++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[a++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],m=n[t++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|m&63)-65536;e[a++]=String.fromCharCode(55296+(p>>10)),e[a++]=String.fromCharCode(56320+(p&1023))}else{const c=n[t++],d=n[t++];e[a++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},Bx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,m=d?n[o+1]:0,p=o+2<n.length,v=p?n[o+2]:0,_=c>>2,b=(c&3)<<4|m>>4;let T=(m&15)<<2|v>>6,j=v&63;p||(j=64,d||(T=64)),a.push(t[_],t[b],t[T],t[j])}return a.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(qx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):IC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],m=o<n.length?t[n.charAt(o)]:0;++o;const v=o<n.length?t[n.charAt(o)]:64;++o;const b=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||m==null||v==null||b==null)throw new RC;const T=c<<2|m>>4;if(a.push(T),v!==64){const j=m<<4&240|v>>2;if(a.push(j),b!==64){const x=v<<6&192|b;a.push(x)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class RC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const DC=function(n){const e=qx(n);return Bx.encodeByteArray(e,!0)},hh=function(n){return DC(n).replace(/\./g,"")},Hx=function(n){try{return Bx.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC=()=>MC().__FIREBASE_DEFAULTS__,kC=()=>{if(typeof process>"u"||typeof NE>"u")return;const n=NE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},PC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Hx(n[1]);return e&&JSON.parse(e)},Uh=()=>{try{return SC()||OC()||kC()||PC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},zx=n=>{var e,t;return(t=(e=Uh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Gx=n=>{const e=zx(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},$x=()=>{var n;return(n=Uh())===null||n===void 0?void 0:n.config},Yx=n=>{var e;return(e=Uh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(n){return n.endsWith(".cloudworkstations.dev")}async function jg(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${a}`,aud:a,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},n);return[hh(JSON.stringify(t)),hh(JSON.stringify(d)),""].join(".")}const Rc={};function VC(){const n={prod:[],emulator:[]};for(const e of Object.keys(Rc))Rc[e]?n.emulator.push(e):n.prod.push(e);return n}function UC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let xE=!1;function wg(n,e){if(typeof window>"u"||typeof document>"u"||!kr(window.location.host)||Rc[n]===e||Rc[n]||xE)return;Rc[n]=e;function t(T){return`__firebase__banner__${T}`}const a="__firebase__banner",c=VC().prod.length>0;function d(){const T=document.getElementById(a);T&&T.remove()}function m(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function p(T,j){T.setAttribute("width","24"),T.setAttribute("id",j),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function v(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{xE=!0,d()},T}function _(T,j){T.setAttribute("id",j),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function b(){const T=UC(a),j=t("text"),x=document.getElementById(j)||document.createElement("span"),C=t("learnmore"),w=document.getElementById(C)||document.createElement("a"),F=t("preprendIcon"),H=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const V=T.element;m(V),_(w,C);const k=v();p(H,F),V.append(H,x,w,k),document.body.appendChild(V)}c?(x.innerText="Preview backend disconnected.",H.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(H.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",j)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function FC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gn())}function qC(){var n;const e=(n=Uh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Cg(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function HC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zC(){const n=gn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function GC(){return!qC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fh(){try{return typeof indexedDB=="object"}catch{return!1}}function qh(){return new Promise((n,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(a);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(a),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}function Sg(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C="FirebaseError";class cs extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=$C,Object.setPrototypeOf(this,cs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ri.prototype.create)}}class Ri{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?YC(c,a):"Error",m=`${this.serviceName}: ${d} (${o}).`;return new cs(o,m,a)}}function YC(n,e){return n.replace(KC,(t,a)=>{const o=e[a];return o!=null?String(o):`<${a}?>`})}const KC=/\{\$([^}]+)}/g;function QC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ei(n,e){if(n===e)return!0;const t=Object.keys(n),a=Object.keys(e);for(const o of t){if(!a.includes(o))return!1;const c=n[o],d=e[o];if(TE(c)&&TE(d)){if(!Ei(c,d))return!1}else if(c!==d)return!1}for(const o of a)if(!t.includes(o))return!1;return!0}function TE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(n){const e=[];for(const[t,a]of Object.entries(n))Array.isArray(a)?a.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function Ac(n){const e={};return n.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[o,c]=a.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function jc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function XC(n,e){const t=new WC(n,e);return t.subscribe.bind(t)}class WC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let o;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");ZC(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:a},o.next===void 0&&(o.next=jp),o.error===void 0&&(o.error=jp),o.complete===void 0&&(o.complete=jp);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ZC(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function jp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC=1e3,eS=2,tS=4*60*60*1e3,nS=.5;function AE(n,e=JC,t=eS){const a=e*Math.pow(t,n),o=Math.round(nS*a*(Math.random()-.5)*2);return Math.min(tS,a+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(n){return n&&n._delegate?n._delegate:n}class $n{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new LC;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&a.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const a=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(a)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:a})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(iS(e))try{this.getOrInitializeService({instanceIdentifier:Nr})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});a.resolve(c)}catch{}}}}clearInstance(e=Nr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Nr){return this.instances.has(e)}getOptions(e=Nr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[c,d]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(c);a===m&&d.resolve(o)}return o}onInit(e,t){var a;const o=this.normalizeInstanceIdentifier(t),c=(a=this.onInitCallbacks.get(o))!==null&&a!==void 0?a:new Set;c.add(e),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&e(d,o),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const o of a)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:aS(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=Nr){return this.component?this.component.multipleInstances?e:Nr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aS(n){return n===Nr?void 0:n}function iS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new sS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})($e||($e={}));const oS={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},lS=$e.INFO,cS={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},uS=(n,e,...t)=>{if(e<n.logLevel)return;const a=new Date().toISOString(),o=cS[e];if(o)console[o](`[${a}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class su{constructor(e){this.name=e,this._logLevel=lS,this._logHandler=uS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?oS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const dS=(n,e)=>e.some(t=>n instanceof t);let jE,wE;function hS(){return jE||(jE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fS(){return wE||(wE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Qx=new WeakMap,Kp=new WeakMap,Xx=new WeakMap,wp=new WeakMap,Ig=new WeakMap;function mS(n){const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(vi(n.result)),o()},d=()=>{a(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&Qx.set(t,n)}).catch(()=>{}),Ig.set(e,n),e}function pS(n){if(Kp.has(n))return;const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{a(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});Kp.set(n,e)}let Qp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Kp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Xx.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return vi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function gS(n){Qp=n(Qp)}function vS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=n.call(Cp(this),e,...t);return Xx.set(a,e.sort?e.sort():[e]),vi(a)}:fS().includes(n)?function(...e){return n.apply(Cp(this),e),vi(Qx.get(this))}:function(...e){return vi(n.apply(Cp(this),e))}}function yS(n){return typeof n=="function"?vS(n):(n instanceof IDBTransaction&&pS(n),dS(n,hS())?new Proxy(n,Qp):n)}function vi(n){if(n instanceof IDBRequest)return mS(n);if(wp.has(n))return wp.get(n);const e=yS(n);return e!==n&&(wp.set(n,e),Ig.set(e,n)),e}const Cp=n=>Ig.get(n);function Wx(n,e,{blocked:t,upgrade:a,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),m=vi(d);return a&&d.addEventListener("upgradeneeded",p=>{a(vi(d.result),p.oldVersion,p.newVersion,vi(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),m.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",v=>o(v.oldVersion,v.newVersion,v))}).catch(()=>{}),m}const _S=["get","getKey","getAll","getAllKeys","count"],bS=["put","add","delete","clear"],Sp=new Map;function CE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Sp.get(e))return Sp.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,o=bS.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(o||_S.includes(t)))return;const c=async function(d,...m){const p=this.transaction(d,o?"readwrite":"readonly");let v=p.store;return a&&(v=v.index(m.shift())),(await Promise.all([v[t](...m),o&&p.done]))[0]};return Sp.set(e,c),c}gS(n=>({...n,get:(e,t,a)=>CE(e,t)||n.get(e,t,a),has:(e,t)=>!!CE(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(NS(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function NS(n){const e=n.getComponent();return e?.type==="VERSION"}const Xp="@firebase/app",SE="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sa=new su("@firebase/app"),xS="@firebase/app-compat",TS="@firebase/analytics-compat",AS="@firebase/analytics",jS="@firebase/app-check-compat",wS="@firebase/app-check",CS="@firebase/auth",SS="@firebase/auth-compat",IS="@firebase/database",RS="@firebase/data-connect",DS="@firebase/database-compat",MS="@firebase/functions",OS="@firebase/functions-compat",kS="@firebase/installations",PS="@firebase/installations-compat",LS="@firebase/messaging",VS="@firebase/messaging-compat",US="@firebase/performance",FS="@firebase/performance-compat",qS="@firebase/remote-config",BS="@firebase/remote-config-compat",HS="@firebase/storage",zS="@firebase/storage-compat",GS="@firebase/firestore",$S="@firebase/ai",YS="@firebase/firestore-compat",KS="firebase",QS="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp="[DEFAULT]",XS={[Xp]:"fire-core",[xS]:"fire-core-compat",[AS]:"fire-analytics",[TS]:"fire-analytics-compat",[wS]:"fire-app-check",[jS]:"fire-app-check-compat",[CS]:"fire-auth",[SS]:"fire-auth-compat",[IS]:"fire-rtdb",[RS]:"fire-data-connect",[DS]:"fire-rtdb-compat",[MS]:"fire-fn",[OS]:"fire-fn-compat",[kS]:"fire-iid",[PS]:"fire-iid-compat",[LS]:"fire-fcm",[VS]:"fire-fcm-compat",[US]:"fire-perf",[FS]:"fire-perf-compat",[qS]:"fire-rc",[BS]:"fire-rc-compat",[HS]:"fire-gcs",[zS]:"fire-gcs-compat",[GS]:"fire-fst",[YS]:"fire-fst-compat",[$S]:"fire-vertex","fire-js":"fire-js",[KS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fh=new Map,WS=new Map,Zp=new Map;function IE(n,e){try{n.container.addComponent(e)}catch(t){Sa.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function os(n){const e=n.name;if(Zp.has(e))return Sa.debug(`There were multiple attempts to register component ${e}.`),!1;Zp.set(e,n);for(const t of fh.values())IE(t,n);for(const t of WS.values())IE(t,n);return!0}function Ma(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Rn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yi=new Ri("app","Firebase",ZS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e,t,a){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pr=QS;function Zx(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const a=Object.assign({name:Wp,automaticDataCollectionEnabled:!0},e),o=a.name;if(typeof o!="string"||!o)throw yi.create("bad-app-name",{appName:String(o)});if(t||(t=$x()),!t)throw yi.create("no-options");const c=fh.get(o);if(c){if(Ei(t,c.options)&&Ei(a,c.config))return c;throw yi.create("duplicate-app",{appName:o})}const d=new rS(o);for(const p of Zp.values())d.addComponent(p);const m=new JS(t,a,d);return fh.set(o,m),m}function au(n=Wp){const e=fh.get(n);if(!e&&n===Wp&&$x())return Zx();if(!e)throw yi.create("no-app",{appName:n});return e}function pn(n,e,t){var a;let o=(a=XS[n])!==null&&a!==void 0?a:n;t&&(o+=`-${t}`);const c=o.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const m=[`Unable to register library "${o}" with version "${e}":`];c&&m.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&m.push("and"),d&&m.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Sa.warn(m.join(" "));return}os(new $n(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI="firebase-heartbeat-database",tI=1,Hc="firebase-heartbeat-store";let Ip=null;function Jx(){return Ip||(Ip=Wx(eI,tI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Hc)}catch(t){console.warn(t)}}}}).catch(n=>{throw yi.create("idb-open",{originalErrorMessage:n.message})})),Ip}async function nI(n){try{const t=(await Jx()).transaction(Hc),a=await t.objectStore(Hc).get(eT(n));return await t.done,a}catch(e){if(e instanceof cs)Sa.warn(e.message);else{const t=yi.create("idb-get",{originalErrorMessage:e?.message});Sa.warn(t.message)}}}async function RE(n,e){try{const a=(await Jx()).transaction(Hc,"readwrite");await a.objectStore(Hc).put(e,eT(n)),await a.done}catch(t){if(t instanceof cs)Sa.warn(t.message);else{const a=yi.create("idb-set",{originalErrorMessage:t?.message});Sa.warn(a.message)}}}function eT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI=1024,aI=30;class iI{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new oI(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=DE();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>aI){const d=lI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){Sa.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=DE(),{heartbeatsToSend:a,unsentEntries:o}=rI(this._heartbeatsCache.heartbeats),c=hh(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Sa.warn(t),""}}}function DE(){return new Date().toISOString().substring(0,10)}function rI(n,e=sI){const t=[];let a=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),ME(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),ME(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class oI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fh()?qh().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await nI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return RE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return RE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function ME(n){return hh(JSON.stringify({version:2,heartbeats:n})).length}function lI(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let a=1;a<n.length;a++)n[a].date<t&&(t=n[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(n){os(new $n("platform-logger",e=>new ES(e),"PRIVATE")),os(new $n("heartbeat",e=>new iI(e),"PRIVATE")),pn(Xp,SE,n),pn(Xp,SE,"esm2017"),pn("fire-js","")}cI("");function Rg(n,e){var t={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&e.indexOf(a)<0&&(t[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(n);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(n,a[o])&&(t[a[o]]=n[a[o]]);return t}function tT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const uI=tT,nT=new Ri("auth","Firebase",tT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh=new su("@firebase/auth");function dI(n,...e){mh.logLevel<=$e.WARN&&mh.warn(`Auth (${Pr}): ${n}`,...e)}function eh(n,...e){mh.logLevel<=$e.ERROR&&mh.error(`Auth (${Pr}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(n,...e){throw Mg(n,...e)}function Es(n,...e){return Mg(n,...e)}function Dg(n,e,t){const a=Object.assign(Object.assign({},uI()),{[e]:t});return new Ri("auth","Firebase",a).create(e,{appName:n.name})}function Ca(n){return Dg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hI(n,e,t){const a=t;if(!(e instanceof a))throw a.name!==e.constructor.name&&ls(n,"argument-error"),Dg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Mg(n,...e){if(typeof n!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=n.name),n._errorFactory.create(t,...a)}return nT.create(n,...e)}function Ce(n,e,...t){if(!n)throw Mg(e,...t)}function ja(n){const e="INTERNAL ASSERTION FAILED: "+n;throw eh(e),new Error(e)}function Ia(n,e){n||ja(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jp(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function fI(){return OE()==="http:"||OE()==="https:"}function OE(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fI()||Cg()||"connection"in navigator)?navigator.onLine:!0}function pI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ia(t>e,"Short delay should be less than long delay!"),this.isMobile=FC()||HC()}get(){return mI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Og(n,e){Ia(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ja("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ja("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ja("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],yI=new iu(3e4,6e4);function Di(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Mi(n,e,t,a,o={}){return aT(n,o,async()=>{let c={},d={};a&&(e==="GET"?d=a:c={body:JSON.stringify(a)});const m=nu(Object.assign({key:n.config.apiKey},d)).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:p},c);return BC()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&kr(n.emulatorConfig.host)&&(v.credentials="include"),sT.fetch()(await iT(n,n.config.apiHost,t,m),v)})}async function aT(n,e,t){n._canInitEmulator=!1;const a=Object.assign(Object.assign({},gI),e);try{const o=new bI(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw Gd(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const m=c.ok?d.errorMessage:d.error.message,[p,v]=m.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gd(n,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw Gd(n,"email-already-in-use",d);if(p==="USER_DISABLED")throw Gd(n,"user-disabled",d);const _=a[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw Dg(n,_,v);ls(n,_)}}catch(o){if(o instanceof cs)throw o;ls(n,"network-request-failed",{message:String(o)})}}async function ru(n,e,t,a,o={}){const c=await Mi(n,e,t,a,o);return"mfaPendingCredential"in c&&ls(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function iT(n,e,t,a){const o=`${e}${t}?${a}`,c=n,d=c.config.emulator?Og(n.config,o):`${n.config.apiScheme}://${o}`;return vI.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function _I(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class bI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(Es(this.auth,"network-request-failed")),yI.get())})}}function Gd(n,e,t){const a={appName:n.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const o=Es(n,e,a);return o.customData._tokenResponse=t,o}function kE(n){return n!==void 0&&n.enterprise!==void 0}class EI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return _I(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function NI(n,e){return Mi(n,"GET","/v2/recaptchaConfig",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xI(n,e){return Mi(n,"POST","/v1/accounts:delete",e)}async function ph(n,e){return Mi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function TI(n,e=!1){const t=vt(n),a=await t.getIdToken(e),o=kg(a);Ce(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:a,authTime:Dc(Rp(o.auth_time)),issuedAtTime:Dc(Rp(o.iat)),expirationTime:Dc(Rp(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Rp(n){return Number(n)*1e3}function kg(n){const[e,t,a]=n.split(".");if(e===void 0||t===void 0||a===void 0)return eh("JWT malformed, contained fewer than 3 sections"),null;try{const o=Hx(t);return o?JSON.parse(o):(eh("Failed to decode base64 JWT payload"),null)}catch(o){return eh("Caught error parsing JWT payload as JSON",o?.toString()),null}}function PE(n){const e=kg(n);return Ce(e,"internal-error"),Ce(typeof e.exp<"u","internal-error"),Ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zc(n,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof cs&&AI(a)&&n.auth.currentUser===n&&await n.auth.signOut(),a}}function AI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const a=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),a}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Dc(this.lastLoginAt),this.creationTime=Dc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gh(n){var e;const t=n.auth,a=await n.getIdToken(),o=await zc(n,ph(t,{idToken:a}));Ce(o?.users.length,t,"internal-error");const c=o.users[0];n._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?rT(c.providerUserInfo):[],m=CI(n.providerData,d),p=n.isAnonymous,v=!(n.email&&c.passwordHash)&&!m?.length,_=p?v:!1,b={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:m,metadata:new eg(c.createdAt,c.lastLoginAt),isAnonymous:_};Object.assign(n,b)}async function wI(n){const e=vt(n);await gh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function CI(n,e){return[...n.filter(a=>!e.some(o=>o.providerId===a.providerId)),...e]}function rT(n){return n.map(e=>{var{providerId:t}=e,a=Rg(e,["providerId"]);return{providerId:t,uid:a.rawId||"",displayName:a.displayName||null,email:a.email||null,phoneNumber:a.phoneNumber||null,photoURL:a.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SI(n,e){const t=await aT(n,{},async()=>{const a=nu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await iT(n,o,"/v1/token",`key=${c}`),m=await n._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:m,body:a};return n.emulatorConfig&&kr(n.emulatorConfig.host)&&(p.credentials="include"),sT.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function II(n,e){return Mi(n,"POST","/v2/accounts:revokeToken",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ce(e.idToken,"internal-error"),Ce(typeof e.idToken<"u","internal-error"),Ce(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):PE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ce(e.length!==0,"internal-error");const t=PE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:o,expiresIn:c}=await SI(e,t);this.updateTokensAndExpiration(a,o,Number(c))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:o,expirationTime:c}=t,d=new zo;return a&&(Ce(typeof a=="string","internal-error",{appName:e}),d.refreshToken=a),o&&(Ce(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(Ce(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zo,this.toJSON())}_performRefresh(){return ja("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(n,e){Ce(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class _s{constructor(e){var{uid:t,auth:a,stsTokenManager:o}=e,c=Rg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new jI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=a,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new eg(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await zc(this,this.stsTokenManager.getToken(this.auth,e));return Ce(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return TI(this,e)}reload(){return wI(this)}_assign(e){this!==e&&(Ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _s(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await gh(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Rn(this.auth.app))return Promise.reject(Ca(this.auth));const e=await this.getIdToken();return await zc(this,xI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var a,o,c,d,m,p,v,_;const b=(a=t.displayName)!==null&&a!==void 0?a:void 0,T=(o=t.email)!==null&&o!==void 0?o:void 0,j=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,x=(d=t.photoURL)!==null&&d!==void 0?d:void 0,C=(m=t.tenantId)!==null&&m!==void 0?m:void 0,w=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,F=(v=t.createdAt)!==null&&v!==void 0?v:void 0,H=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:V,emailVerified:k,isAnonymous:U,providerData:Q,stsTokenManager:L}=t;Ce(V&&L,e,"internal-error");const R=zo.fromJSON(this.name,L);Ce(typeof V=="string",e,"internal-error"),ui(b,e.name),ui(T,e.name),Ce(typeof k=="boolean",e,"internal-error"),Ce(typeof U=="boolean",e,"internal-error"),ui(j,e.name),ui(x,e.name),ui(C,e.name),ui(w,e.name),ui(F,e.name),ui(H,e.name);const P=new _s({uid:V,auth:e,email:T,emailVerified:k,displayName:b,isAnonymous:U,photoURL:x,phoneNumber:j,tenantId:C,stsTokenManager:R,createdAt:F,lastLoginAt:H});return Q&&Array.isArray(Q)&&(P.providerData=Q.map(D=>Object.assign({},D))),w&&(P._redirectEventId=w),P}static async _fromIdTokenResponse(e,t,a=!1){const o=new zo;o.updateFromServerResponse(t);const c=new _s({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:a});return await gh(c),c}static async _fromGetAccountInfoResponse(e,t,a){const o=t.users[0];Ce(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?rT(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,m=new zo;m.updateFromIdToken(a);const p=new _s({uid:o.localId,auth:e,stsTokenManager:m,isAnonymous:d}),v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new eg(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,v),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE=new Map;function wa(n){Ia(n instanceof Function,"Expected a class definition");let e=LE.get(n);return e?(Ia(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,LE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}oT.type="NONE";const VE=oT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(n,e,t){return`firebase:${n}:${e}:${t}`}class Go{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:o,name:c}=this.auth;this.fullUserKey=th(this.userKey,o.apiKey,c),this.fullPersistenceKey=th("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ph(this.auth,{idToken:e}).catch(()=>{});return t?_s._fromGetAccountInfoResponse(this.auth,t,e):null}return _s._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new Go(wa(VE),e,a);const o=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let c=o[0]||wa(VE);const d=th(a,e.config.apiKey,e.name);let m=null;for(const v of t)try{const _=await v._get(d);if(_){let b;if(typeof _=="string"){const T=await ph(e,{idToken:_}).catch(()=>{});if(!T)break;b=await _s._fromGetAccountInfoResponse(e,T,_)}else b=_s._fromJSON(e,_);v!==c&&(m=b),c=v;break}}catch{}const p=o.filter(v=>v._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new Go(c,e,a):(c=p[0],m&&await c._set(d,m.toJSON()),await Promise.all(t.map(async v=>{if(v!==c)try{await v._remove(d)}catch{}})),new Go(c,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(fT(e))return"Blackberry";if(mT(e))return"Webos";if(cT(e))return"Safari";if((e.includes("chrome/")||uT(e))&&!e.includes("edge/"))return"Chrome";if(hT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=n.match(t);if(a?.length===2)return a[1]}return"Other"}function lT(n=gn()){return/firefox\//i.test(n)}function cT(n=gn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function uT(n=gn()){return/crios\//i.test(n)}function dT(n=gn()){return/iemobile/i.test(n)}function hT(n=gn()){return/android/i.test(n)}function fT(n=gn()){return/blackberry/i.test(n)}function mT(n=gn()){return/webos/i.test(n)}function Pg(n=gn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function RI(n=gn()){var e;return Pg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function DI(){return zC()&&document.documentMode===10}function pT(n=gn()){return Pg(n)||hT(n)||mT(n)||fT(n)||/windows phone/i.test(n)||dT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gT(n,e=[]){let t;switch(n){case"Browser":t=UE(gn());break;case"Worker":t=`${UE(gn())}-${n}`;break;default:t=n}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Pr}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=c=>new Promise((d,m)=>{try{const p=e(c);d(p)}catch(p){m(p)}});a.onAbort=t,this.queue.push(a);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OI(n,e={}){return Mi(n,"GET","/v2/passwordPolicy",Di(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI=6;class PI{constructor(e){var t,a,o,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:kI,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(a=e.allowedNonAlphanumericCharacters)===null||a===void 0?void 0:a.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,a,o,c,d,m;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(a=p.meetsMaxPasswordLength)!==null&&a!==void 0?a:!0),p.isValid&&(p.isValid=(o=p.containsLowercaseLetter)!==null&&o!==void 0?o:!0),p.isValid&&(p.isValid=(c=p.containsUppercaseLetter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(d=p.containsNumericCharacter)!==null&&d!==void 0?d:!0),p.isValid&&(p.isValid=(m=p.containsNonAlphanumericCharacter)!==null&&m!==void 0?m:!0),p}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let o=0;o<e.length;o++)a=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e,t,a,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new FE(this),this.idTokenSubscription=new FE(this),this.beforeStateQueue=new MI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=wa(t)),this._initializationPromise=this.queue(async()=>{var a,o,c;if(!this._deleted&&(this.persistenceManager=await Go.create(this,e),(a=this._resolvePersistenceManagerAvailable)===null||a===void 0||a.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ph(this,{idToken:e}),a=await _s._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Rn(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(m=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(m,m))}):this.directlySetCurrentUser(null)}const a=await this.assertedPersistence.getCurrentUser();let o=a,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,m=o?._redirectEventId,p=await this.tryRedirectSignIn(e);(!d||d===m)&&p?.user&&(o=p.user,c=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(o)}catch(d){o=a,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return Ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await gh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=pI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Rn(this.app))return Promise.reject(Ca(this));const t=e?vt(e):null;return t&&Ce(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Rn(this.app)?Promise.reject(Ca(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Rn(this.app)?Promise.reject(Ca(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(wa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await OI(this),t=new PI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ri("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await II(this,a)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&wa(e)||this._popupRedirectResolver;Ce(t,this,"argument-error"),this.redirectPersistenceManager=await Go.create(this,[wa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,a;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((a=this.redirectUser)===null||a===void 0?void 0:a._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const a=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==a&&(this.lastNotifiedUid=a,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ce(m,this,"internal-error"),m.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,a,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=gT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const a=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());a&&(t["X-Firebase-Client"]=a);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(Rn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&dI(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Oi(n){return vt(n)}class FE{constructor(e){this.auth=e,this.observer=null,this.addObserver=XC(t=>this.observer=t)}get next(){return Ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function VI(n){Bh=n}function vT(n){return Bh.loadJS(n)}function UI(){return Bh.recaptchaEnterpriseScript}function FI(){return Bh.gapiScript}function qI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class BI{constructor(){this.enterprise=new HI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class HI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const zI="recaptcha-enterprise",yT="NO_RECAPTCHA";class GI{constructor(e){this.type=zI,this.auth=Oi(e)}async verify(e="verify",t=!1){async function a(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,m)=>{NI(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)m(new Error("recaptcha Enterprise site key undefined"));else{const v=new EI(p);return c.tenantId==null?c._agentRecaptchaConfig=v:c._tenantRecaptchaConfigs[c.tenantId]=v,d(v.siteKey)}}).catch(p=>{m(p)})})}function o(c,d,m){const p=window.grecaptcha;kE(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(v=>{d(v)}).catch(()=>{d(yT)})}):m(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new BI().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{a(this.auth).then(m=>{if(!t&&kE(window.grecaptcha))o(m,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=UI();p.length!==0&&(p+=m),vT(p).then(()=>{o(m,c,d)}).catch(v=>{d(v)})}}).catch(m=>{d(m)})})}}async function qE(n,e,t,a=!1,o=!1){const c=new GI(n);let d;if(o)d=yT;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const m=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in m){const p=m.phoneEnrollmentInfo.phoneNumber,v=m.phoneEnrollmentInfo.recaptchaToken;Object.assign(m,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in m){const p=m.phoneSignInInfo.recaptchaToken;Object.assign(m,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return m}return a?Object.assign(m,{captchaResp:d}):Object.assign(m,{captchaResponse:d}),Object.assign(m,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(m,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),m}async function tg(n,e,t,a,o){var c;if(!((c=n._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await qE(n,e,t,t==="getOobCode");return a(n,d)}else return a(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const m=await qE(n,e,t,t==="getOobCode");return a(n,m)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $I(n,e){const t=Ma(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Ei(c,e??{}))return o;ls(o,"already-initialized")}return t.initialize({options:e})}function YI(n,e){const t=e?.persistence||[],a=(Array.isArray(t)?t:[t]).map(wa);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(a,e?.popupRedirectResolver)}function KI(n,e,t){const a=Oi(n);Ce(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const o=!1,c=_T(e),{host:d,port:m}=QI(e),p=m===null?"":`:${m}`,v={url:`${c}//${d}${p}/`},_=Object.freeze({host:d,port:m,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!a._canInitEmulator){Ce(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),Ce(Ei(v,a.config.emulator)&&Ei(_,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=v,a.emulatorConfig=_,a.settings.appVerificationDisabledForTesting=!0,kr(d)?(jg(`${c}//${d}${p}`),wg("Auth",!0)):XI()}function _T(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function QI(n){const e=_T(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(a);if(o){const c=o[1];return{host:c,port:BE(a.substr(c.length+1))}}else{const[c,d]=a.split(":");return{host:c,port:BE(d)}}}function BE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function XI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ja("not implemented")}_getIdTokenResponse(e){return ja("not implemented")}_linkToIdToken(e,t){return ja("not implemented")}_getReauthenticationResolver(e){return ja("not implemented")}}async function WI(n,e){return Mi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZI(n,e){return ru(n,"POST","/v1/accounts:signInWithPassword",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JI(n,e){return ru(n,"POST","/v1/accounts:signInWithEmailLink",Di(n,e))}async function eR(n,e){return ru(n,"POST","/v1/accounts:signInWithEmailLink",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc extends Lg{constructor(e,t,a,o=null){super("password",a),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Gc(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new Gc(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tg(e,t,"signInWithPassword",ZI);case"emailLink":return JI(e,{email:this._email,oobCode:this._password});default:ls(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tg(e,a,"signUpPassword",WI);case"emailLink":return eR(e,{idToken:t,email:this._email,oobCode:this._password});default:ls(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $o(n,e){return ru(n,"POST","/v1/accounts:signInWithIdp",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR="http://localhost";class Cr extends Lg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Cr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ls("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:o}=t,c=Rg(t,["providerId","signInMethod"]);if(!a||!o)return null;const d=new Cr(a,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return $o(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,$o(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$o(e,t)}buildRequest(){const e={requestUri:tR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=nu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nR(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function sR(n){const e=Ac(jc(n)).link,t=e?Ac(jc(e)).deep_link_id:null,a=Ac(jc(n)).deep_link_id;return(a?Ac(jc(a)).link:null)||a||t||e||n}class Vg{constructor(e){var t,a,o,c,d,m;const p=Ac(jc(e)),v=(t=p.apiKey)!==null&&t!==void 0?t:null,_=(a=p.oobCode)!==null&&a!==void 0?a:null,b=nR((o=p.mode)!==null&&o!==void 0?o:null);Ce(v&&_&&b,"argument-error"),this.apiKey=v,this.operation=b,this.code=_,this.continueUrl=(c=p.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=p.lang)!==null&&d!==void 0?d:null,this.tenantId=(m=p.tenantId)!==null&&m!==void 0?m:null}static parseLink(e){const t=sR(e);try{return new Vg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(){this.providerId=rl.PROVIDER_ID}static credential(e,t){return Gc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=Vg.parseLink(t);return Ce(a,"argument-error"),Gc._fromEmailAndCode(e,a.code,a.tenantId)}}rl.PROVIDER_ID="password";rl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou extends Ug{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi extends ou{constructor(){super("facebook.com")}static credential(e){return Cr._fromParams({providerId:hi.PROVIDER_ID,signInMethod:hi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hi.credentialFromTaggedObject(e)}static credentialFromError(e){return hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hi.credential(e.oauthAccessToken)}catch{return null}}}hi.FACEBOOK_SIGN_IN_METHOD="facebook.com";hi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa extends ou{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Cr._fromParams({providerId:Aa.PROVIDER_ID,signInMethod:Aa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Aa.credentialFromTaggedObject(e)}static credentialFromError(e){return Aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return Aa.credential(t,a)}catch{return null}}}Aa.GOOGLE_SIGN_IN_METHOD="google.com";Aa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi extends ou{constructor(){super("github.com")}static credential(e){return Cr._fromParams({providerId:fi.PROVIDER_ID,signInMethod:fi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fi.credentialFromTaggedObject(e)}static credentialFromError(e){return fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fi.credential(e.oauthAccessToken)}catch{return null}}}fi.GITHUB_SIGN_IN_METHOD="github.com";fi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends ou{constructor(){super("twitter.com")}static credential(e,t){return Cr._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return mi.credential(t,a)}catch{return null}}}mi.TWITTER_SIGN_IN_METHOD="twitter.com";mi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aR(n,e){return ru(n,"POST","/v1/accounts:signUp",Di(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,o=!1){const c=await _s._fromIdTokenResponse(e,a,o),d=HE(a);return new Sr({user:c,providerId:d,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const o=HE(a);return new Sr({user:e,providerId:o,_tokenResponse:a,operationType:t})}}function HE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh extends cs{constructor(e,t,a,o){var c;super(t.code,t.message),this.operationType=a,this.user=o,Object.setPrototypeOf(this,vh.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,o){return new vh(e,t,a,o)}}function bT(n,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?vh._fromErrorAndOperation(n,c,e,a):c})}async function iR(n,e,t=!1){const a=await zc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Sr._forOperation(n,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rR(n,e,t=!1){const{auth:a}=n;if(Rn(a.app))return Promise.reject(Ca(a));const o="reauthenticate";try{const c=await zc(n,bT(a,o,e,n),t);Ce(c.idToken,a,"internal-error");const d=kg(c.idToken);Ce(d,a,"internal-error");const{sub:m}=d;return Ce(n.uid===m,a,"user-mismatch"),Sr._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&ls(a,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ET(n,e,t=!1){if(Rn(n.app))return Promise.reject(Ca(n));const a="signIn",o=await bT(n,a,e),c=await Sr._fromIdTokenResponse(n,a,o);return t||await n._updateCurrentUser(c.user),c}async function oR(n,e){return ET(Oi(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NT(n){const e=Oi(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function lR(n,e,t){if(Rn(n.app))return Promise.reject(Ca(n));const a=Oi(n),d=await tg(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",aR).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&NT(n),p}),m=await Sr._fromIdTokenResponse(a,"signIn",d);return await a._updateCurrentUser(m.user),m}function cR(n,e,t){return Rn(n.app)?Promise.reject(Ca(n)):oR(vt(n),rl.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&NT(n),a})}function uR(n,e,t,a){return vt(n).onIdTokenChanged(e,t,a)}function dR(n,e,t){return vt(n).beforeAuthStateChanged(e,t)}function hR(n,e,t,a){return vt(n).onAuthStateChanged(e,t,a)}function fR(n){return vt(n).signOut()}const yh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(yh,"1"),this.storage.removeItem(yh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mR=1e3,pR=10;class TT extends xT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),o=this.localCache[t];a!==o&&e(t,o,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,m,p)=>{this.notifyListeners(d,p)});return}const a=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(a);!t&&this.localCache[a]===d||this.notifyListeners(a,d)},c=this.storage.getItem(a);DI()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,pR):o()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},mR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}TT.type="LOCAL";const gR=TT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT extends xT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}AT.type="SESSION";const jT=AT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const a=new Hh(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:o});const m=Array.from(d).map(async v=>v(t.origin,c)),p=await vR(m);t.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(n="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((m,p)=>{const v=Fg("",20);o.port1.start();const _=setTimeout(()=>{p(new Error("unsupported_event"))},a);d={messageChannel:o,onMessage(b){const T=b;if(T.data.eventId===v)switch(T.data.status){case"ack":clearTimeout(_),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),m(T.data.response);break;default:clearTimeout(_),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(){return window}function _R(n){Gs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(){return typeof Gs().WorkerGlobalScope<"u"&&typeof Gs().importScripts=="function"}async function bR(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ER(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function NR(){return wT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT="firebaseLocalStorageDb",xR=1,_h="firebaseLocalStorage",ST="fbase_key";class lu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function zh(n,e){return n.transaction([_h],e?"readwrite":"readonly").objectStore(_h)}function TR(){const n=indexedDB.deleteDatabase(CT);return new lu(n).toPromise()}function ng(){const n=indexedDB.open(CT,xR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const a=n.result;try{a.createObjectStore(_h,{keyPath:ST})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const a=n.result;a.objectStoreNames.contains(_h)?e(a):(a.close(),await TR(),e(await ng()))})})}async function zE(n,e,t){const a=zh(n,!0).put({[ST]:e,value:t});return new lu(a).toPromise()}async function AR(n,e){const t=zh(n,!1).get(e),a=await new lu(t).toPromise();return a===void 0?null:a.value}function GE(n,e){const t=zh(n,!0).delete(e);return new lu(t).toPromise()}const jR=800,wR=3;class IT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ng(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>wR)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hh._getInstance(NR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await bR(),!this.activeServiceWorker)return;this.sender=new yR(this.activeServiceWorker);const a=await this.sender._send("ping",{},800);a&&!((e=a[0])===null||e===void 0)&&e.fulfilled&&!((t=a[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ER()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ng();return await zE(e,yh,"1"),await GE(e,yh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>zE(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>AR(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>GE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=zh(o,!1).getAll();return new lu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)a.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!a.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IT.type="LOCAL";const CR=IT;new iu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RT(n,e){return e?wa(e):(Ce(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg extends Lg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $o(e,this._buildIdpRequest())}_linkToIdToken(e,t){return $o(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return $o(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function SR(n){return ET(n.auth,new qg(n),n.bypassAuthState)}function IR(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),rR(t,new qg(n),n.bypassAuthState)}async function RR(n){const{auth:e,user:t}=n;return Ce(t,e,"internal-error"),iR(t,new qg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(e,t,a,o,c=!1){this.auth=e,this.resolver=a,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:o,tenantId:c,error:d,type:m}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:a,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(p))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return SR;case"linkViaPopup":case"linkViaRedirect":return RR;case"reauthViaPopup":case"reauthViaRedirect":return IR;default:ls(this.auth,"internal-error")}}resolve(e){Ia(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ia(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR=new iu(2e3,1e4);async function MR(n,e,t){if(Rn(n.app))return Promise.reject(Es(n,"operation-not-supported-in-this-environment"));const a=Oi(n);hI(n,e,Ug);const o=RT(a,t);return new xr(a,"signInViaPopup",e,o).executeNotNull()}class xr extends DT{constructor(e,t,a,o,c){super(e,t,o,c),this.provider=a,this.authWindow=null,this.pollId=null,xr.currentPopupAction&&xr.currentPopupAction.cancel(),xr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ce(e,this.auth,"internal-error"),e}async onExecution(){Ia(this.filter.length===1,"Popup operations only handle one event");const e=Fg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Es(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Es(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,a;if(!((a=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||a===void 0)&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Es(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,DR.get())};e()}}xr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR="pendingRedirect",nh=new Map;class kR extends DT{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=nh.get(this.auth._key());if(!e){try{const a=await PR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}nh.set(this.auth._key(),e)}return this.bypassAuthState||nh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PR(n,e){const t=UR(e),a=VR(n);if(!await a._isAvailable())return!1;const o=await a._get(t)==="true";return await a._remove(t),o}function LR(n,e){nh.set(n._key(),e)}function VR(n){return wa(n._redirectPersistence)}function UR(n){return th(OR,n.config.apiKey,n.name)}async function FR(n,e,t=!1){if(Rn(n.app))return Promise.reject(Ca(n));const a=Oi(n),o=RT(a,e),d=await new kR(a,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await a._persistUserIfCurrent(d.user),await a._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR=10*60*1e3;class BR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!HR(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var a;if(e.error&&!MT(e)){const o=((a=e.error.code)===null||a===void 0?void 0:a.split("auth/")[1])||"internal-error";t.onError(Es(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qR&&this.cachedEventUids.clear(),this.cachedEventUids.has($E(e))}saveEventToCache(e){this.cachedEventUids.add($E(e)),this.lastProcessedEventTime=Date.now()}}function $E(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function MT({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function HR(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return MT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zR(n,e={}){return Mi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$R=/^https?/;async function YR(n){if(n.config.emulator)return;const{authorizedDomains:e}=await zR(n);for(const t of e)try{if(KR(t))return}catch{}ls(n,"unauthorized-domain")}function KR(n){const e=Jp(),{protocol:t,hostname:a}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&a===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===a}if(!$R.test(t))return!1;if(GR.test(n))return a===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=new iu(3e4,6e4);function YE(){const n=Gs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function XR(n){return new Promise((e,t)=>{var a,o,c;function d(){YE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{YE(),t(Es(n,"network-request-failed"))},timeout:QR.get()})}if(!((o=(a=Gs().gapi)===null||a===void 0?void 0:a.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((c=Gs().gapi)===null||c===void 0)&&c.load)d();else{const m=qI("iframefcb");return Gs()[m]=()=>{gapi.load?d():t(Es(n,"network-request-failed"))},vT(`${FI()}?onload=${m}`).catch(p=>t(p))}}).catch(e=>{throw sh=null,e})}let sh=null;function WR(n){return sh=sh||XR(n),sh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=new iu(5e3,15e3),JR="__/auth/iframe",e1="emulator/auth/iframe",t1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},n1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function s1(n){const e=n.config;Ce(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Og(e,e1):`https://${n.config.authDomain}/${JR}`,a={apiKey:e.apiKey,appName:n.name,v:Pr},o=n1.get(n.config.apiHost);o&&(a.eid=o);const c=n._getFrameworks();return c.length&&(a.fw=c.join(",")),`${t}?${nu(a).slice(1)}`}async function a1(n){const e=await WR(n),t=Gs().gapi;return Ce(t,n,"internal-error"),e.open({where:document.body,url:s1(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:t1,dontclear:!0},a=>new Promise(async(o,c)=>{await a.restyle({setHideOnLeave:!1});const d=Es(n,"network-request-failed"),m=Gs().setTimeout(()=>{c(d)},ZR.get());function p(){Gs().clearTimeout(m),o(a)}a.ping(p).then(p,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},r1=500,o1=600,l1="_blank",c1="http://localhost";class KE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function u1(n,e,t,a=r1,o=o1){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-a)/2,0).toString();let m="";const p=Object.assign(Object.assign({},i1),{width:a.toString(),height:o.toString(),top:c,left:d}),v=gn().toLowerCase();t&&(m=uT(v)?l1:t),lT(v)&&(e=e||c1,p.scrollbars="yes");const _=Object.entries(p).reduce((T,[j,x])=>`${T}${j}=${x},`,"");if(RI(v)&&m!=="_self")return d1(e||"",m),new KE(null);const b=window.open(e||"",m,_);Ce(b,n,"popup-blocked");try{b.focus()}catch{}return new KE(b)}function d1(n,e){const t=document.createElement("a");t.href=n,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1="__/auth/handler",f1="emulator/auth/handler",m1=encodeURIComponent("fac");async function QE(n,e,t,a,o,c){Ce(n.config.authDomain,n,"auth-domain-config-required"),Ce(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:a,v:Pr,eventId:o};if(e instanceof Ug){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",QC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,b]of Object.entries({}))d[_]=b}if(e instanceof ou){const _=e.getScopes().filter(b=>b!=="");_.length>0&&(d.scopes=_.join(","))}n.tenantId&&(d.tid=n.tenantId);const m=d;for(const _ of Object.keys(m))m[_]===void 0&&delete m[_];const p=await n._getAppCheckToken(),v=p?`#${m1}=${encodeURIComponent(p)}`:"";return`${p1(n)}?${nu(m).slice(1)}${v}`}function p1({config:n}){return n.emulator?Og(n,f1):`https://${n.authDomain}/${h1}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp="webStorageSupport";class g1{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=jT,this._completeRedirectFn=FR,this._overrideRedirectResult=LR}async _openPopup(e,t,a,o){var c;Ia((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await QE(e,t,a,Jp(),o);return u1(e,d,Fg())}async _openRedirect(e,t,a,o){await this._originValidation(e);const c=await QE(e,t,a,Jp(),o);return _R(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Ia(c,"If manager is not set, promise should be"),c)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await a1(e),a=new BR(e);return t.register("authEvent",o=>(Ce(o?.authEvent,e,"invalid-auth-event"),{status:a.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Dp,{type:Dp},o=>{var c;const d=(c=o?.[0])===null||c===void 0?void 0:c[Dp];d!==void 0&&t(!!d),ls(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=YR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return pT()||cT()||Pg()}}const v1=g1;var XE="@firebase/auth",WE="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e(a?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _1(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function b1(n){os(new $n("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:m}=a.options;Ce(d&&!d.includes(":"),"invalid-api-key",{appName:a.name});const p={apiKey:d,authDomain:m,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:gT(n)},v=new LI(a,o,c,p);return YI(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),os(new $n("auth-internal",e=>{const t=Oi(e.getProvider("auth").getImmediate());return(a=>new y1(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pn(XE,WE,_1(n)),pn(XE,WE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1=5*60,N1=Yx("authIdTokenMaxAge")||E1;let ZE=null;const x1=n=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>N1)return;const o=t?.token;ZE!==o&&(ZE=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function T1(n=au()){const e=Ma(n,"auth");if(e.isInitialized())return e.getImmediate();const t=$I(n,{popupRedirectResolver:v1,persistence:[CR,gR,jT]}),a=Yx("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(a,location.origin);if(location.origin===c.origin){const d=x1(c.toString());dR(t,d,()=>d(t.currentUser)),uR(t,m=>d(m))}}const o=zx("auth");return o&&KI(t,`http://${o}`),t}function A1(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}VI({loadJS(n){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",n),a.onload=e,a.onerror=o=>{const c=Es("internal-error");c.customData=o,t(c)},a.type="text/javascript",a.charset="UTF-8",A1().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});b1("Browser");var j1="firebase",w1="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn(j1,w1,"app");var JE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _i,OT;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(L,R){function P(){}P.prototype=R.prototype,L.D=R.prototype,L.prototype=new P,L.prototype.constructor=L,L.C=function(D,A,I){for(var O=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)O[_e-2]=arguments[_e];return R.prototype[A].apply(D,O)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(a,t),a.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(L,R,P){P||(P=0);var D=Array(16);if(typeof R=="string")for(var A=0;16>A;++A)D[A]=R.charCodeAt(P++)|R.charCodeAt(P++)<<8|R.charCodeAt(P++)<<16|R.charCodeAt(P++)<<24;else for(A=0;16>A;++A)D[A]=R[P++]|R[P++]<<8|R[P++]<<16|R[P++]<<24;R=L.g[0],P=L.g[1],A=L.g[2];var I=L.g[3],O=R+(I^P&(A^I))+D[0]+3614090360&4294967295;R=P+(O<<7&4294967295|O>>>25),O=I+(A^R&(P^A))+D[1]+3905402710&4294967295,I=R+(O<<12&4294967295|O>>>20),O=A+(P^I&(R^P))+D[2]+606105819&4294967295,A=I+(O<<17&4294967295|O>>>15),O=P+(R^A&(I^R))+D[3]+3250441966&4294967295,P=A+(O<<22&4294967295|O>>>10),O=R+(I^P&(A^I))+D[4]+4118548399&4294967295,R=P+(O<<7&4294967295|O>>>25),O=I+(A^R&(P^A))+D[5]+1200080426&4294967295,I=R+(O<<12&4294967295|O>>>20),O=A+(P^I&(R^P))+D[6]+2821735955&4294967295,A=I+(O<<17&4294967295|O>>>15),O=P+(R^A&(I^R))+D[7]+4249261313&4294967295,P=A+(O<<22&4294967295|O>>>10),O=R+(I^P&(A^I))+D[8]+1770035416&4294967295,R=P+(O<<7&4294967295|O>>>25),O=I+(A^R&(P^A))+D[9]+2336552879&4294967295,I=R+(O<<12&4294967295|O>>>20),O=A+(P^I&(R^P))+D[10]+4294925233&4294967295,A=I+(O<<17&4294967295|O>>>15),O=P+(R^A&(I^R))+D[11]+2304563134&4294967295,P=A+(O<<22&4294967295|O>>>10),O=R+(I^P&(A^I))+D[12]+1804603682&4294967295,R=P+(O<<7&4294967295|O>>>25),O=I+(A^R&(P^A))+D[13]+4254626195&4294967295,I=R+(O<<12&4294967295|O>>>20),O=A+(P^I&(R^P))+D[14]+2792965006&4294967295,A=I+(O<<17&4294967295|O>>>15),O=P+(R^A&(I^R))+D[15]+1236535329&4294967295,P=A+(O<<22&4294967295|O>>>10),O=R+(A^I&(P^A))+D[1]+4129170786&4294967295,R=P+(O<<5&4294967295|O>>>27),O=I+(P^A&(R^P))+D[6]+3225465664&4294967295,I=R+(O<<9&4294967295|O>>>23),O=A+(R^P&(I^R))+D[11]+643717713&4294967295,A=I+(O<<14&4294967295|O>>>18),O=P+(I^R&(A^I))+D[0]+3921069994&4294967295,P=A+(O<<20&4294967295|O>>>12),O=R+(A^I&(P^A))+D[5]+3593408605&4294967295,R=P+(O<<5&4294967295|O>>>27),O=I+(P^A&(R^P))+D[10]+38016083&4294967295,I=R+(O<<9&4294967295|O>>>23),O=A+(R^P&(I^R))+D[15]+3634488961&4294967295,A=I+(O<<14&4294967295|O>>>18),O=P+(I^R&(A^I))+D[4]+3889429448&4294967295,P=A+(O<<20&4294967295|O>>>12),O=R+(A^I&(P^A))+D[9]+568446438&4294967295,R=P+(O<<5&4294967295|O>>>27),O=I+(P^A&(R^P))+D[14]+3275163606&4294967295,I=R+(O<<9&4294967295|O>>>23),O=A+(R^P&(I^R))+D[3]+4107603335&4294967295,A=I+(O<<14&4294967295|O>>>18),O=P+(I^R&(A^I))+D[8]+1163531501&4294967295,P=A+(O<<20&4294967295|O>>>12),O=R+(A^I&(P^A))+D[13]+2850285829&4294967295,R=P+(O<<5&4294967295|O>>>27),O=I+(P^A&(R^P))+D[2]+4243563512&4294967295,I=R+(O<<9&4294967295|O>>>23),O=A+(R^P&(I^R))+D[7]+1735328473&4294967295,A=I+(O<<14&4294967295|O>>>18),O=P+(I^R&(A^I))+D[12]+2368359562&4294967295,P=A+(O<<20&4294967295|O>>>12),O=R+(P^A^I)+D[5]+4294588738&4294967295,R=P+(O<<4&4294967295|O>>>28),O=I+(R^P^A)+D[8]+2272392833&4294967295,I=R+(O<<11&4294967295|O>>>21),O=A+(I^R^P)+D[11]+1839030562&4294967295,A=I+(O<<16&4294967295|O>>>16),O=P+(A^I^R)+D[14]+4259657740&4294967295,P=A+(O<<23&4294967295|O>>>9),O=R+(P^A^I)+D[1]+2763975236&4294967295,R=P+(O<<4&4294967295|O>>>28),O=I+(R^P^A)+D[4]+1272893353&4294967295,I=R+(O<<11&4294967295|O>>>21),O=A+(I^R^P)+D[7]+4139469664&4294967295,A=I+(O<<16&4294967295|O>>>16),O=P+(A^I^R)+D[10]+3200236656&4294967295,P=A+(O<<23&4294967295|O>>>9),O=R+(P^A^I)+D[13]+681279174&4294967295,R=P+(O<<4&4294967295|O>>>28),O=I+(R^P^A)+D[0]+3936430074&4294967295,I=R+(O<<11&4294967295|O>>>21),O=A+(I^R^P)+D[3]+3572445317&4294967295,A=I+(O<<16&4294967295|O>>>16),O=P+(A^I^R)+D[6]+76029189&4294967295,P=A+(O<<23&4294967295|O>>>9),O=R+(P^A^I)+D[9]+3654602809&4294967295,R=P+(O<<4&4294967295|O>>>28),O=I+(R^P^A)+D[12]+3873151461&4294967295,I=R+(O<<11&4294967295|O>>>21),O=A+(I^R^P)+D[15]+530742520&4294967295,A=I+(O<<16&4294967295|O>>>16),O=P+(A^I^R)+D[2]+3299628645&4294967295,P=A+(O<<23&4294967295|O>>>9),O=R+(A^(P|~I))+D[0]+4096336452&4294967295,R=P+(O<<6&4294967295|O>>>26),O=I+(P^(R|~A))+D[7]+1126891415&4294967295,I=R+(O<<10&4294967295|O>>>22),O=A+(R^(I|~P))+D[14]+2878612391&4294967295,A=I+(O<<15&4294967295|O>>>17),O=P+(I^(A|~R))+D[5]+4237533241&4294967295,P=A+(O<<21&4294967295|O>>>11),O=R+(A^(P|~I))+D[12]+1700485571&4294967295,R=P+(O<<6&4294967295|O>>>26),O=I+(P^(R|~A))+D[3]+2399980690&4294967295,I=R+(O<<10&4294967295|O>>>22),O=A+(R^(I|~P))+D[10]+4293915773&4294967295,A=I+(O<<15&4294967295|O>>>17),O=P+(I^(A|~R))+D[1]+2240044497&4294967295,P=A+(O<<21&4294967295|O>>>11),O=R+(A^(P|~I))+D[8]+1873313359&4294967295,R=P+(O<<6&4294967295|O>>>26),O=I+(P^(R|~A))+D[15]+4264355552&4294967295,I=R+(O<<10&4294967295|O>>>22),O=A+(R^(I|~P))+D[6]+2734768916&4294967295,A=I+(O<<15&4294967295|O>>>17),O=P+(I^(A|~R))+D[13]+1309151649&4294967295,P=A+(O<<21&4294967295|O>>>11),O=R+(A^(P|~I))+D[4]+4149444226&4294967295,R=P+(O<<6&4294967295|O>>>26),O=I+(P^(R|~A))+D[11]+3174756917&4294967295,I=R+(O<<10&4294967295|O>>>22),O=A+(R^(I|~P))+D[2]+718787259&4294967295,A=I+(O<<15&4294967295|O>>>17),O=P+(I^(A|~R))+D[9]+3951481745&4294967295,L.g[0]=L.g[0]+R&4294967295,L.g[1]=L.g[1]+(A+(O<<21&4294967295|O>>>11))&4294967295,L.g[2]=L.g[2]+A&4294967295,L.g[3]=L.g[3]+I&4294967295}a.prototype.u=function(L,R){R===void 0&&(R=L.length);for(var P=R-this.blockSize,D=this.B,A=this.h,I=0;I<R;){if(A==0)for(;I<=P;)o(this,L,I),I+=this.blockSize;if(typeof L=="string"){for(;I<R;)if(D[A++]=L.charCodeAt(I++),A==this.blockSize){o(this,D),A=0;break}}else for(;I<R;)if(D[A++]=L[I++],A==this.blockSize){o(this,D),A=0;break}}this.h=A,this.o+=R},a.prototype.v=function(){var L=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);L[0]=128;for(var R=1;R<L.length-8;++R)L[R]=0;var P=8*this.o;for(R=L.length-8;R<L.length;++R)L[R]=P&255,P/=256;for(this.u(L),L=Array(16),R=P=0;4>R;++R)for(var D=0;32>D;D+=8)L[P++]=this.g[R]>>>D&255;return L};function c(L,R){var P=m;return Object.prototype.hasOwnProperty.call(P,L)?P[L]:P[L]=R(L)}function d(L,R){this.h=R;for(var P=[],D=!0,A=L.length-1;0<=A;A--){var I=L[A]|0;D&&I==R||(P[A]=I,D=!1)}this.g=P}var m={};function p(L){return-128<=L&&128>L?c(L,function(R){return new d([R|0],0>R?-1:0)}):new d([L|0],0>L?-1:0)}function v(L){if(isNaN(L)||!isFinite(L))return b;if(0>L)return w(v(-L));for(var R=[],P=1,D=0;L>=P;D++)R[D]=L/P|0,P*=4294967296;return new d(R,0)}function _(L,R){if(L.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(L.charAt(0)=="-")return w(_(L.substring(1),R));if(0<=L.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=v(Math.pow(R,8)),D=b,A=0;A<L.length;A+=8){var I=Math.min(8,L.length-A),O=parseInt(L.substring(A,A+I),R);8>I?(I=v(Math.pow(R,I)),D=D.j(I).add(v(O))):(D=D.j(P),D=D.add(v(O)))}return D}var b=p(0),T=p(1),j=p(16777216);n=d.prototype,n.m=function(){if(C(this))return-w(this).m();for(var L=0,R=1,P=0;P<this.g.length;P++){var D=this.i(P);L+=(0<=D?D:4294967296+D)*R,R*=4294967296}return L},n.toString=function(L){if(L=L||10,2>L||36<L)throw Error("radix out of range: "+L);if(x(this))return"0";if(C(this))return"-"+w(this).toString(L);for(var R=v(Math.pow(L,6)),P=this,D="";;){var A=k(P,R).g;P=F(P,A.j(R));var I=((0<P.g.length?P.g[0]:P.h)>>>0).toString(L);if(P=A,x(P))return I+D;for(;6>I.length;)I="0"+I;D=I+D}},n.i=function(L){return 0>L?0:L<this.g.length?this.g[L]:this.h};function x(L){if(L.h!=0)return!1;for(var R=0;R<L.g.length;R++)if(L.g[R]!=0)return!1;return!0}function C(L){return L.h==-1}n.l=function(L){return L=F(this,L),C(L)?-1:x(L)?0:1};function w(L){for(var R=L.g.length,P=[],D=0;D<R;D++)P[D]=~L.g[D];return new d(P,~L.h).add(T)}n.abs=function(){return C(this)?w(this):this},n.add=function(L){for(var R=Math.max(this.g.length,L.g.length),P=[],D=0,A=0;A<=R;A++){var I=D+(this.i(A)&65535)+(L.i(A)&65535),O=(I>>>16)+(this.i(A)>>>16)+(L.i(A)>>>16);D=O>>>16,I&=65535,O&=65535,P[A]=O<<16|I}return new d(P,P[P.length-1]&-2147483648?-1:0)};function F(L,R){return L.add(w(R))}n.j=function(L){if(x(this)||x(L))return b;if(C(this))return C(L)?w(this).j(w(L)):w(w(this).j(L));if(C(L))return w(this.j(w(L)));if(0>this.l(j)&&0>L.l(j))return v(this.m()*L.m());for(var R=this.g.length+L.g.length,P=[],D=0;D<2*R;D++)P[D]=0;for(D=0;D<this.g.length;D++)for(var A=0;A<L.g.length;A++){var I=this.i(D)>>>16,O=this.i(D)&65535,_e=L.i(A)>>>16,Se=L.i(A)&65535;P[2*D+2*A]+=O*Se,H(P,2*D+2*A),P[2*D+2*A+1]+=I*Se,H(P,2*D+2*A+1),P[2*D+2*A+1]+=O*_e,H(P,2*D+2*A+1),P[2*D+2*A+2]+=I*_e,H(P,2*D+2*A+2)}for(D=0;D<R;D++)P[D]=P[2*D+1]<<16|P[2*D];for(D=R;D<2*R;D++)P[D]=0;return new d(P,0)};function H(L,R){for(;(L[R]&65535)!=L[R];)L[R+1]+=L[R]>>>16,L[R]&=65535,R++}function V(L,R){this.g=L,this.h=R}function k(L,R){if(x(R))throw Error("division by zero");if(x(L))return new V(b,b);if(C(L))return R=k(w(L),R),new V(w(R.g),w(R.h));if(C(R))return R=k(L,w(R)),new V(w(R.g),R.h);if(30<L.g.length){if(C(L)||C(R))throw Error("slowDivide_ only works with positive integers.");for(var P=T,D=R;0>=D.l(L);)P=U(P),D=U(D);var A=Q(P,1),I=Q(D,1);for(D=Q(D,2),P=Q(P,2);!x(D);){var O=I.add(D);0>=O.l(L)&&(A=A.add(P),I=O),D=Q(D,1),P=Q(P,1)}return R=F(L,A.j(R)),new V(A,R)}for(A=b;0<=L.l(R);){for(P=Math.max(1,Math.floor(L.m()/R.m())),D=Math.ceil(Math.log(P)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),I=v(P),O=I.j(R);C(O)||0<O.l(L);)P-=D,I=v(P),O=I.j(R);x(I)&&(I=T),A=A.add(I),L=F(L,O)}return new V(A,L)}n.A=function(L){return k(this,L).h},n.and=function(L){for(var R=Math.max(this.g.length,L.g.length),P=[],D=0;D<R;D++)P[D]=this.i(D)&L.i(D);return new d(P,this.h&L.h)},n.or=function(L){for(var R=Math.max(this.g.length,L.g.length),P=[],D=0;D<R;D++)P[D]=this.i(D)|L.i(D);return new d(P,this.h|L.h)},n.xor=function(L){for(var R=Math.max(this.g.length,L.g.length),P=[],D=0;D<R;D++)P[D]=this.i(D)^L.i(D);return new d(P,this.h^L.h)};function U(L){for(var R=L.g.length+1,P=[],D=0;D<R;D++)P[D]=L.i(D)<<1|L.i(D-1)>>>31;return new d(P,L.h)}function Q(L,R){var P=R>>5;R%=32;for(var D=L.g.length-P,A=[],I=0;I<D;I++)A[I]=0<R?L.i(I+P)>>>R|L.i(I+P+1)<<32-R:L.i(I+P);return new d(A,L.h)}a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,OT=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=_,_i=d}).apply(typeof JE<"u"?JE:typeof self<"u"?self:typeof window<"u"?window:{});var $d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kT,wc,PT,ah,sg,LT,VT,UT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,E){return h==Array.prototype||h==Object.prototype||(h[y]=E.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof $d=="object"&&$d];for(var y=0;y<h.length;++y){var E=h[y];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var a=t(this);function o(h,y){if(y)e:{var E=a;h=h.split(".");for(var M=0;M<h.length-1;M++){var X=h[M];if(!(X in E))break e;E=E[X]}h=h[h.length-1],M=E[h],y=y(M),y!=M&&y!=null&&e(E,h,{configurable:!0,writable:!0,value:y})}}function c(h,y){h instanceof String&&(h+="");var E=0,M=!1,X={next:function(){if(!M&&E<h.length){var ne=E++;return{value:y(ne,h[ne]),done:!1}}return M=!0,{done:!0,value:void 0}}};return X[Symbol.iterator]=function(){return X},X}o("Array.prototype.values",function(h){return h||function(){return c(this,function(y,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},m=this||self;function p(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function v(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function _(h,y,E){return h.call.apply(h.bind,arguments)}function b(h,y,E){if(!h)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var X=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(X,M),h.apply(y,X)}}return function(){return h.apply(y,arguments)}}function T(h,y,E){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:b,T.apply(null,arguments)}function j(h,y){var E=Array.prototype.slice.call(arguments,1);return function(){var M=E.slice();return M.push.apply(M,arguments),h.apply(this,M)}}function x(h,y){function E(){}E.prototype=y.prototype,h.aa=y.prototype,h.prototype=new E,h.prototype.constructor=h,h.Qb=function(M,X,ne){for(var de=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)de[Ke-2]=arguments[Ke];return y.prototype[X].apply(M,de)}}function C(h){const y=h.length;if(0<y){const E=Array(y);for(let M=0;M<y;M++)E[M]=h[M];return E}return[]}function w(h,y){for(let E=1;E<arguments.length;E++){const M=arguments[E];if(p(M)){const X=h.length||0,ne=M.length||0;h.length=X+ne;for(let de=0;de<ne;de++)h[X+de]=M[de]}else h.push(M)}}class F{constructor(y,E){this.i=y,this.j=E,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function H(h){return/^[\s\xa0]*$/.test(h)}function V(){var h=m.navigator;return h&&(h=h.userAgent)?h:""}function k(h){return k[" "](h),h}k[" "]=function(){};var U=V().indexOf("Gecko")!=-1&&!(V().toLowerCase().indexOf("webkit")!=-1&&V().indexOf("Edge")==-1)&&!(V().indexOf("Trident")!=-1||V().indexOf("MSIE")!=-1)&&V().indexOf("Edge")==-1;function Q(h,y,E){for(const M in h)y.call(E,h[M],M,h)}function L(h,y){for(const E in h)y.call(void 0,h[E],E,h)}function R(h){const y={};for(const E in h)y[E]=h[E];return y}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(h,y){let E,M;for(let X=1;X<arguments.length;X++){M=arguments[X];for(E in M)h[E]=M[E];for(let ne=0;ne<P.length;ne++)E=P[ne],Object.prototype.hasOwnProperty.call(M,E)&&(h[E]=M[E])}}function A(h){var y=1;h=h.split(":");const E=[];for(;0<y&&h.length;)E.push(h.shift()),y--;return h.length&&E.push(h.join(":")),E}function I(h){m.setTimeout(()=>{throw h},0)}function O(){var h=he;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class _e{constructor(){this.h=this.g=null}add(y,E){const M=Se.get();M.set(y,E),this.h?this.h.next=M:this.g=M,this.h=M}}var Se=new F(()=>new $,h=>h.reset());class ${constructor(){this.next=this.g=this.h=null}set(y,E){this.h=y,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let z,ae=!1,he=new _e,q=()=>{const h=m.Promise.resolve(void 0);z=()=>{h.then(ee)}};var ee=()=>{for(var h;h=O();){try{h.h.call(h.g)}catch(E){I(E)}var y=Se;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}ae=!1};function ce(){this.s=this.s,this.C=this.C}ce.prototype.s=!1,ce.prototype.ma=function(){this.s||(this.s=!0,this.N())},ce.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var Ne=function(){if(!m.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};m.addEventListener("test",E,y),m.removeEventListener("test",E,y)}catch{}return h}();function qe(h,y){if(ue.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var E=this.type=h.type,M=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(U){e:{try{k(y.nodeName);var X=!0;break e}catch{}X=!1}X||(y=null)}}else E=="mouseover"?y=h.fromElement:E=="mouseout"&&(y=h.toElement);this.relatedTarget=y,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Re[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&qe.aa.h.call(this)}}x(qe,ue);var Re={2:"touch",3:"pen",4:"mouse"};qe.prototype.h=function(){qe.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var zt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function As(h,y,E,M,X){this.listener=h,this.proxy=null,this.src=y,this.type=E,this.capture=!!M,this.ha=X,this.key=++mt,this.da=this.fa=!1}function ka(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Zs(h){this.src=h,this.g={},this.h=0}Zs.prototype.add=function(h,y,E,M,X){var ne=h.toString();h=this.g[ne],h||(h=this.g[ne]=[],this.h++);var de=Ui(h,y,M,X);return-1<de?(y=h[de],E||(y.fa=!1)):(y=new As(y,this.src,ne,!!M,X),y.fa=E,h.push(y)),y};function Vi(h,y){var E=y.type;if(E in h.g){var M=h.g[E],X=Array.prototype.indexOf.call(M,y,void 0),ne;(ne=0<=X)&&Array.prototype.splice.call(M,X,1),ne&&(ka(y),h.g[E].length==0&&(delete h.g[E],h.h--))}}function Ui(h,y,E,M){for(var X=0;X<h.length;++X){var ne=h[X];if(!ne.da&&ne.listener==y&&ne.capture==!!E&&ne.ha==M)return X}return-1}var Fi="closure_lm_"+(1e6*Math.random()|0),pl={};function Eu(h,y,E,M,X){if(Array.isArray(y)){for(var ne=0;ne<y.length;ne++)Eu(h,y[ne],E,M,X);return null}return E=Nu(E),h&&h[zt]?h.K(y,E,v(M)?!!M.capture:!1,X):Yn(h,y,E,!1,M,X)}function Yn(h,y,E,M,X,ne){if(!y)throw Error("Invalid event type");var de=v(X)?!!X.capture:!!X,Ke=Br(h);if(Ke||(h[Fi]=Ke=new Zs(h)),E=Ke.add(y,E,M,de,ne),E.proxy)return E;if(M=bf(),E.proxy=M,M.src=h,M.listener=E,h.addEventListener)Ne||(X=de),X===void 0&&(X=!1),h.addEventListener(y.toString(),M,X);else if(h.attachEvent)h.attachEvent(qi(y.toString()),M);else if(h.addListener&&h.removeListener)h.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return E}function bf(){function h(E){return y.call(h.src,h.listener,E)}const y=Ef;return h}function gl(h,y,E,M,X){if(Array.isArray(y))for(var ne=0;ne<y.length;ne++)gl(h,y[ne],E,M,X);else M=v(M)?!!M.capture:!!M,E=Nu(E),h&&h[zt]?(h=h.i,y=String(y).toString(),y in h.g&&(ne=h.g[y],E=Ui(ne,E,M,X),-1<E&&(ka(ne[E]),Array.prototype.splice.call(ne,E,1),ne.length==0&&(delete h.g[y],h.h--)))):h&&(h=Br(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Ui(y,E,M,X)),(E=-1<h?y[h]:null)&&qr(E))}function qr(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[zt])Vi(y.i,h);else{var E=h.type,M=h.proxy;y.removeEventListener?y.removeEventListener(E,M,h.capture):y.detachEvent?y.detachEvent(qi(E),M):y.addListener&&y.removeListener&&y.removeListener(M),(E=Br(y))?(Vi(E,h),E.h==0&&(E.src=null,y[Fi]=null)):ka(h)}}}function qi(h){return h in pl?pl[h]:pl[h]="on"+h}function Ef(h,y){if(h.da)h=!0;else{y=new qe(y,this);var E=h.listener,M=h.ha||h.src;h.fa&&qr(h),h=E.call(M,y)}return h}function Br(h){return h=h[Fi],h instanceof Zs?h:null}var vl="__closure_events_fn_"+(1e9*Math.random()>>>0);function Nu(h){return typeof h=="function"?h:(h[vl]||(h[vl]=function(y){return h.handleEvent(y)}),h[vl])}function xt(){ce.call(this),this.i=new Zs(this),this.M=this,this.F=null}x(xt,ce),xt.prototype[zt]=!0,xt.prototype.removeEventListener=function(h,y,E,M){gl(this,h,y,E,M)};function at(h,y){var E,M=h.F;if(M)for(E=[];M;M=M.F)E.push(M);if(h=h.M,M=y.type||y,typeof y=="string")y=new ue(y,h);else if(y instanceof ue)y.target=y.target||h;else{var X=y;y=new ue(M,h),D(y,X)}if(X=!0,E)for(var ne=E.length-1;0<=ne;ne--){var de=y.g=E[ne];X=Mn(de,M,!0,y)&&X}if(de=y.g=h,X=Mn(de,M,!0,y)&&X,X=Mn(de,M,!1,y)&&X,E)for(ne=0;ne<E.length;ne++)de=y.g=E[ne],X=Mn(de,M,!1,y)&&X}xt.prototype.N=function(){if(xt.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var E=h.g[y],M=0;M<E.length;M++)ka(E[M]);delete h.g[y],h.h--}}this.F=null},xt.prototype.K=function(h,y,E,M){return this.i.add(String(h),y,!1,E,M)},xt.prototype.L=function(h,y,E,M){return this.i.add(String(h),y,!0,E,M)};function Mn(h,y,E,M){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var X=!0,ne=0;ne<y.length;++ne){var de=y[ne];if(de&&!de.da&&de.capture==E){var Ke=de.listener,Lt=de.ha||de.src;de.fa&&Vi(h.i,de),X=Ke.call(Lt,M)!==!1&&X}}return X&&!M.defaultPrevented}function cn(h,y,E){if(typeof h=="function")E&&(h=T(h,E));else if(h&&typeof h.handleEvent=="function")h=T(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:m.setTimeout(h,y||0)}function xu(h){h.g=cn(()=>{h.g=null,h.i&&(h.i=!1,xu(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class Nf extends ce{constructor(y,E){super(),this.m=y,this.l=E,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:xu(this)}N(){super.N(),this.g&&(m.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bi(h){ce.call(this),this.h=h,this.g={}}x(Bi,ce);var Hi=[];function zi(h){Q(h.g,function(y,E){this.g.hasOwnProperty(E)&&qr(y)},h),h.g={}}Bi.prototype.N=function(){Bi.aa.N.call(this),zi(this)},Bi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var us=m.JSON.stringify,Hr=m.JSON.parse,Gi=class{stringify(h){return m.JSON.stringify(h,void 0)}parse(h){return m.JSON.parse(h,void 0)}};function yl(){}yl.prototype.h=null;function _l(h){return h.h||(h.h=h.i())}function bl(){}var Js={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ea(){ue.call(this,"d")}x(ea,ue);function El(){ue.call(this,"c")}x(El,ue);var js={},Nl=null;function Pa(){return Nl=Nl||new xt}js.La="serverreachability";function zr(h){ue.call(this,js.La,h)}x(zr,ue);function La(h){const y=Pa();at(y,new zr(y))}js.STAT_EVENT="statevent";function Tu(h,y){ue.call(this,js.STAT_EVENT,h),this.stat=y}x(Tu,ue);function _t(h){const y=Pa();at(y,new Tu(y,h))}js.Ma="timingevent";function Pt(h,y){ue.call(this,js.Ma,h),this.size=y}x(Pt,ue);function It(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return m.setTimeout(function(){h()},y)}function Kn(){this.g=!0}Kn.prototype.xa=function(){this.g=!1};function xl(h,y,E,M,X,ne){h.info(function(){if(h.g)if(ne)for(var de="",Ke=ne.split("&"),Lt=0;Lt<Ke.length;Lt++){var Qe=Ke[Lt].split("=");if(1<Qe.length){var $t=Qe[0];Qe=Qe[1];var Vt=$t.split("_");de=2<=Vt.length&&Vt[1]=="type"?de+($t+"="+Qe+"&"):de+($t+"=redacted&")}}else de=null;else de=ne;return"XMLHTTP REQ ("+M+") [attempt "+X+"]: "+y+`
`+E+`
`+de})}function xf(h,y,E,M,X,ne,de){h.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+X+"]: "+y+`
`+E+`
`+ne+" "+de})}function Va(h,y,E,M){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+$i(h,E)+(M?" "+M:"")})}function Au(h,y){h.info(function(){return"TIMEOUT: "+y})}Kn.prototype.info=function(){};function $i(h,y){if(!h.g)return y;if(!y)return null;try{var E=JSON.parse(y);if(E){for(h=0;h<E.length;h++)if(Array.isArray(E[h])){var M=E[h];if(!(2>M.length)){var X=M[1];if(Array.isArray(X)&&!(1>X.length)){var ne=X[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(var de=1;de<X.length;de++)X[de]=""}}}}return us(E)}catch{return y}}var Ua={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ta={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ws;function Cs(){}x(Cs,yl),Cs.prototype.g=function(){return new XMLHttpRequest},Cs.prototype.i=function(){return{}},ws=new Cs;function vn(h,y,E,M){this.j=h,this.i=y,this.l=E,this.R=M||1,this.U=new Bi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new jt}function jt(){this.i=null,this.g="",this.h=!1}var Tl={},Gr={};function ds(h,y,E){h.L=1,h.v=Wi(On(y)),h.m=E,h.P=!0,na(h,null)}function na(h,y){h.F=Date.now(),Yi(h),h.A=On(h.v);var E=h.A,M=h.R;Array.isArray(M)||(M=[String(M)]),Il(E.i,"t",M),h.C=0,E=h.j.J,h.h=new jt,h.g=qu(h.j,E?y:null,!h.m),0<h.O&&(h.M=new Nf(T(h.Y,h,h.g),h.O)),y=h.U,E=h.g,M=h.ca;var X="readystatechange";Array.isArray(X)||(X&&(Hi[0]=X.toString()),X=Hi);for(var ne=0;ne<X.length;ne++){var de=Eu(E,X[ne],M||y.handleEvent,!1,y.h||y);if(!de)break;y.g[de.key]=de}y=h.H?R(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),La(),xl(h.i,h.u,h.A,h.l,h.R,h.m)}vn.prototype.ca=function(h){h=h.target;const y=this.M;y&&Zn(h)==3?y.j():this.Y(h)},vn.prototype.Y=function(h){try{if(h==this.g)e:{const Vt=Zn(this.g);var y=this.g.Ba();const ua=this.g.Z();if(!(3>Vt)&&(Vt!=3||this.g&&(this.h.h||this.g.oa()||Mu(this.g)))){this.J||Vt!=4||y==7||(y==8||0>=ua?La(3):La(2)),Fa(this);var E=this.g.Z();this.X=E;t:if(ju(this)){var M=Mu(this.g);h="";var X=M.length,ne=Zn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zt(this),Ss(this);var de="";break t}this.h.i=new m.TextDecoder}for(y=0;y<X;y++)this.h.h=!0,h+=this.h.i.decode(M[y],{stream:!(ne&&y==X-1)});M.length=0,this.h.g+=h,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=E==200,xf(this.i,this.u,this.A,this.l,this.R,Vt,E),this.o){if(this.T&&!this.K){t:{if(this.g){var Ke,Lt=this.g;if((Ke=Lt.g?Lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Ke)){var Qe=Ke;break t}}Qe=null}if(E=Qe)Va(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ki(this,E);else{this.o=!1,this.s=3,_t(12),Zt(this),Ss(this);break e}}if(this.P){E=!0;let Jt;for(;!this.J&&this.C<de.length;)if(Jt=wu(this,de),Jt==Gr){Vt==4&&(this.s=4,_t(14),E=!1),Va(this.i,this.l,null,"[Incomplete Response]");break}else if(Jt==Tl){this.s=4,_t(15),Va(this.i,this.l,de,"[Invalid Chunk]"),E=!1;break}else Va(this.i,this.l,Jt,null),Ki(this,Jt);if(ju(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vt!=4||de.length!=0||this.h.h||(this.s=1,_t(16),E=!1),this.o=this.o&&E,!E)Va(this.i,this.l,de,"[Invalid Chunked Response]"),Zt(this),Ss(this);else if(0<de.length&&!this.W){this.W=!0;var $t=this.j;$t.g==this&&$t.ba&&!$t.M&&($t.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),ir($t),$t.M=!0,_t(11))}}else Va(this.i,this.l,de,null),Ki(this,de);Vt==4&&Zt(this),this.o&&!this.J&&(Vt==4?Vu(this.j,this):(this.o=!1,Yi(this)))}else Cf(this.g),E==400&&0<de.indexOf("Unknown SID")?(this.s=3,_t(12)):(this.s=0,_t(13)),Zt(this),Ss(this)}}}catch{}finally{}};function ju(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function wu(h,y){var E=h.C,M=y.indexOf(`
`,E);return M==-1?Gr:(E=Number(y.substring(E,M)),isNaN(E)?Tl:(M+=1,M+E>y.length?Gr:(y=y.slice(M,M+E),h.C=M+E,y)))}vn.prototype.cancel=function(){this.J=!0,Zt(this)};function Yi(h){h.S=Date.now()+h.I,Cu(h,h.I)}function Cu(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=It(T(h.ba,h),y)}function Fa(h){h.B&&(m.clearTimeout(h.B),h.B=null)}vn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Au(this.i,this.A),this.L!=2&&(La(),_t(17)),Zt(this),this.s=2,Ss(this)):Cu(this,this.S-h)};function Ss(h){h.j.G==0||h.J||Vu(h.j,h)}function Zt(h){Fa(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,zi(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Ki(h,y){try{var E=h.j;if(E.G!=0&&(E.g==h||Al(E.h,h))){if(!h.K&&Al(E.h,h)&&E.G==3){try{var M=E.Da.g.parse(y)}catch{M=null}if(Array.isArray(M)&&M.length==3){var X=M;if(X[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<h.F)so(E),to(E);else break e;kl(E),_t(18)}}else E.za=X[1],0<E.za-E.T&&37500>X[2]&&E.F&&E.v==0&&!E.C&&(E.C=It(T(E.Za,E),6e3));if(1>=Yr(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else ca(E,11)}else if((h.K||E.g==h)&&so(E),!H(y))for(X=E.Da.g.parse(y),y=0;y<X.length;y++){let Qe=X[y];if(E.T=Qe[0],Qe=Qe[1],E.G==2)if(Qe[0]=="c"){E.K=Qe[1],E.ia=Qe[2];const $t=Qe[3];$t!=null&&(E.la=$t,E.j.info("VER="+E.la));const Vt=Qe[4];Vt!=null&&(E.Aa=Vt,E.j.info("SVER="+E.Aa));const ua=Qe[5];ua!=null&&typeof ua=="number"&&0<ua&&(M=1.5*ua,E.L=M,E.j.info("backChannelRequestTimeoutMs_="+M)),M=E;const Jt=h.g;if(Jt){const Ps=Jt.g?Jt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ps){var ne=M.h;ne.g||Ps.indexOf("spdy")==-1&&Ps.indexOf("quic")==-1&&Ps.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(Kr(ne,ne.h),ne.h=null))}if(M.D){const Ll=Jt.g?Jt.g.getResponseHeader("X-HTTP-Session-Id"):null;Ll&&(M.ya=Ll,ot(M.I,M.D,Ll))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-h.F,E.j.info("Handshake RTT: "+E.R+"ms")),M=E;var de=h;if(M.qa=Fu(M,M.J?M.ia:null,M.W),de.K){yn(M.h,de);var Ke=de,Lt=M.L;Lt&&(Ke.I=Lt),Ke.B&&(Fa(Ke),Yi(Ke)),M.g=de}else Pu(M);0<E.i.length&&no(E)}else Qe[0]!="stop"&&Qe[0]!="close"||ca(E,7);else E.G==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?ca(E,7):Ml(E):Qe[0]!="noop"&&E.l&&E.l.ta(Qe),E.v=0)}}La(4)}catch{}}var Su=class{constructor(h,y){this.g=h,this.map=y}};function sa(h){this.l=h||10,m.PerformanceNavigationTiming?(h=m.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(m.chrome&&m.chrome.loadTimes&&m.chrome.loadTimes()&&m.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function $r(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Yr(h){return h.h?1:h.g?h.g.size:0}function Al(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function Kr(h,y){h.g?h.g.add(y):h.h=y}function yn(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}sa.prototype.cancel=function(){if(this.i=jl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function jl(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const E of h.g.values())y=y.concat(E.D);return y}return C(h.i)}function Tf(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var y=[],E=h.length,M=0;M<E;M++)y.push(h[M]);return y}y=[],E=0;for(M in h)y[E++]=h[M];return y}function Qr(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var y=[];h=h.length;for(var E=0;E<h;E++)y.push(E);return y}y=[],E=0;for(const M in h)y[E++]=M;return y}}}function wl(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var E=Qr(h),M=Tf(h),X=M.length,ne=0;ne<X;ne++)y.call(void 0,M[ne],E&&E[ne],h)}var Qi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Af(h,y){if(h){h=h.split("&");for(var E=0;E<h.length;E++){var M=h[E].indexOf("="),X=null;if(0<=M){var ne=h[E].substring(0,M);X=h[E].substring(M+1)}else ne=h[E];y(ne,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function Rt(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Rt){this.h=h.h,Xi(this,h.j),this.o=h.o,this.g=h.g,qa(this,h.s),this.l=h.l;var y=h.i,E=new ia;E.i=y.i,y.g&&(E.g=new Map(y.g),E.h=y.h),aa(this,E),this.m=h.m}else h&&(y=String(h).match(Qi))?(this.h=!1,Xi(this,y[1]||"",!0),this.o=Qn(y[2]||""),this.g=Qn(y[3]||"",!0),qa(this,y[4]),this.l=Qn(y[5]||"",!0),aa(this,y[6]||"",!0),this.m=Qn(y[7]||"")):(this.h=!1,this.i=new ia(null,this.h))}Rt.prototype.toString=function(){var h=[],y=this.j;y&&h.push(Zi(y,Cl,!0),":");var E=this.g;return(E||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Zi(y,Cl,!0),"@"),h.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&h.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(Zi(E,E.charAt(0)=="/"?jf:Sl,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",Zi(E,Xr)),h.join("")};function On(h){return new Rt(h)}function Xi(h,y,E){h.j=E?Qn(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function qa(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function aa(h,y,E){y instanceof ia?(h.i=y,Ru(h.i,h.h)):(E||(y=Zi(y,wf)),h.i=new ia(y,h.h))}function ot(h,y,E){h.i.set(y,E)}function Wi(h){return ot(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Qn(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Zi(h,y,E){return typeof h=="string"?(h=encodeURI(h).replace(y,Iu),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Iu(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Cl=/[#\/\?@]/g,Sl=/[#\?:]/g,jf=/[#\?]/g,wf=/[#\?@]/g,Xr=/#/g;function ia(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function Xn(h){h.g||(h.g=new Map,h.h=0,h.i&&Af(h.i,function(y,E){h.add(decodeURIComponent(y.replace(/\+/g," ")),E)}))}n=ia.prototype,n.add=function(h,y){Xn(this),this.i=null,h=Is(this,h);var E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(y),this.h+=1,this};function ra(h,y){Xn(h),y=Is(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function oa(h,y){return Xn(h),y=Is(h,y),h.g.has(y)}n.forEach=function(h,y){Xn(this),this.g.forEach(function(E,M){E.forEach(function(X){h.call(y,X,M,this)},this)},this)},n.na=function(){Xn(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),E=[];for(let M=0;M<y.length;M++){const X=h[M];for(let ne=0;ne<X.length;ne++)E.push(y[M])}return E},n.V=function(h){Xn(this);let y=[];if(typeof h=="string")oa(this,h)&&(y=y.concat(this.g.get(Is(this,h))));else{h=Array.from(this.g.values());for(let E=0;E<h.length;E++)y=y.concat(h[E])}return y},n.set=function(h,y){return Xn(this),this.i=null,h=Is(this,h),oa(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},n.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function Il(h,y,E){ra(h,y),0<E.length&&(h.i=null,h.g.set(Is(h,y),C(E)),h.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var E=0;E<y.length;E++){var M=y[E];const ne=encodeURIComponent(String(M)),de=this.V(M);for(M=0;M<de.length;M++){var X=ne;de[M]!==""&&(X+="="+encodeURIComponent(String(de[M]))),h.push(X)}}return this.i=h.join("&")};function Is(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Ru(h,y){y&&!h.j&&(Xn(h),h.i=null,h.g.forEach(function(E,M){var X=M.toLowerCase();M!=X&&(ra(this,M),Il(this,X,E))},h)),h.j=y}function Ji(h,y){const E=new Kn;if(m.Image){const M=new Image;M.onload=j(Wn,E,"TestLoadImage: loaded",!0,y,M),M.onerror=j(Wn,E,"TestLoadImage: error",!1,y,M),M.onabort=j(Wn,E,"TestLoadImage: abort",!1,y,M),M.ontimeout=j(Wn,E,"TestLoadImage: timeout",!1,y,M),m.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=h}else y(!1)}function hs(h,y){const E=new Kn,M=new AbortController,X=setTimeout(()=>{M.abort(),Wn(E,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:M.signal}).then(ne=>{clearTimeout(X),ne.ok?Wn(E,"TestPingServer: ok",!0,y):Wn(E,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(X),Wn(E,"TestPingServer: error",!1,y)})}function Wn(h,y,E,M,X){try{X&&(X.onload=null,X.onerror=null,X.onabort=null,X.ontimeout=null),M(E)}catch{}}function er(){this.g=new Gi}function Rs(h,y,E){const M=E||"";try{wl(h,function(X,ne){let de=X;v(X)&&(de=us(X)),y.push(M+ne+"="+encodeURIComponent(de))})}catch(X){throw y.push(M+"type="+encodeURIComponent("_badmap")),X}}function Ba(h){this.l=h.Ub||null,this.j=h.eb||!1}x(Ba,yl),Ba.prototype.g=function(){return new la(this.l,this.j)},Ba.prototype.i=function(h){return function(){return h}}({});function la(h,y){xt.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(la,xt),n=la.prototype,n.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,Ms(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||m).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ds(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Ms(this)),this.g&&(this.readyState=3,Ms(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof m.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rl(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Rl(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Ds(this):Ms(this),this.readyState==3&&Rl(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Ds(this))},n.Qa=function(h){this.g&&(this.response=h,Ds(this))},n.ga=function(){this.g&&Ds(this)};function Ds(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Ms(h)}n.setRequestHeader=function(h,y){this.u.append(h,y)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var E=y.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=y.next();return h.join(`\r
`)};function Ms(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(la.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Dl(h){let y="";return Q(h,function(E,M){y+=M,y+=":",y+=E,y+=`\r
`}),y}function Gt(h,y,E){e:{for(M in E){var M=!1;break e}M=!0}M||(E=Dl(E),typeof h=="string"?E!=null&&encodeURIComponent(String(E)):ot(h,y,E))}function nt(h){xt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(nt,xt);var Wr=/^https?$/i,tr=["POST","PUT"];n=nt.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,y,E,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ws.g(),this.v=this.o?_l(this.o):_l(ws),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(ne){Du(this,ne);return}if(h=E||"",E=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var X in M)E.set(X,M[X]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const ne of M.keys())E.set(ne,M.get(ne));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(E.keys()).find(ne=>ne.toLowerCase()=="content-type"),X=m.FormData&&h instanceof m.FormData,!(0<=Array.prototype.indexOf.call(tr,y,void 0))||M||X||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,de]of E)this.g.setRequestHeader(ne,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{nr(this),this.u=!0,this.g.send(h),this.u=!1}catch(ne){Du(this,ne)}};function Du(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,Zr(h),Os(h)}function Zr(h){h.A||(h.A=!0,at(h,"complete"),at(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,at(this,"complete"),at(this,"abort"),Os(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Os(this,!0)),nt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Jr(this):this.bb())},n.bb=function(){Jr(this)};function Jr(h){if(h.h&&typeof d<"u"&&(!h.v[1]||Zn(h)!=4||h.Z()!=2)){if(h.u&&Zn(h)==4)cn(h.Ea,0,h);else if(at(h,"readystatechange"),Zn(h)==4){h.h=!1;try{const de=h.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var E;if(!(E=y)){var M;if(M=de===0){var X=String(h.D).match(Qi)[1]||null;!X&&m.self&&m.self.location&&(X=m.self.location.protocol.slice(0,-1)),M=!Wr.test(X?X.toLowerCase():"")}E=M}if(E)at(h,"complete"),at(h,"success");else{h.m=6;try{var ne=2<Zn(h)?h.g.statusText:""}catch{ne=""}h.l=ne+" ["+h.Z()+"]",Zr(h)}}finally{Os(h)}}}}function Os(h,y){if(h.g){nr(h);const E=h.g,M=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||at(h,"ready");try{E.onreadystatechange=M}catch{}}}function nr(h){h.I&&(m.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function Zn(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<Zn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),Hr(y)}};function Mu(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Cf(h){const y={};h=(h.g&&2<=Zn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<h.length;M++){if(H(h[M]))continue;var E=A(h[M]);const X=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const ne=y[X]||[];y[X]=ne,ne.push(E)}L(y,function(M){return M.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function sr(h,y,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||y}function eo(h){this.Aa=0,this.i=[],this.j=new Kn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=sr("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=sr("baseRetryDelayMs",5e3,h),this.cb=sr("retryDelaySeedMs",1e4,h),this.Wa=sr("forwardChannelMaxRetries",2,h),this.wa=sr("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new sa(h&&h.concurrentRequestLimit),this.Da=new er,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=eo.prototype,n.la=8,n.G=1,n.connect=function(h,y,E,M){_t(0),this.W=h,this.H=y||{},E&&M!==void 0&&(this.H.OSID=E,this.H.OAID=M),this.F=this.X,this.I=Fu(this,null,this.W),no(this)};function Ml(h){if(Ou(h),h.G==3){var y=h.U++,E=On(h.I);if(ot(E,"SID",h.K),ot(E,"RID",y),ot(E,"TYPE","terminate"),ar(h,E),y=new vn(h,h.j,y),y.L=2,y.v=Wi(On(E)),E=!1,m.navigator&&m.navigator.sendBeacon)try{E=m.navigator.sendBeacon(y.v.toString(),"")}catch{}!E&&m.Image&&(new Image().src=y.v,E=!0),E||(y.g=qu(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Yi(y)}Uu(h)}function to(h){h.g&&(ir(h),h.g.cancel(),h.g=null)}function Ou(h){to(h),h.u&&(m.clearTimeout(h.u),h.u=null),so(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&m.clearTimeout(h.s),h.s=null)}function no(h){if(!$r(h.h)&&!h.s){h.s=!0;var y=h.Ga;z||q(),ae||(z(),ae=!0),he.add(y,h),h.B=0}}function Sf(h,y){return Yr(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=It(T(h.Ga,h,y),Pl(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const X=new vn(this,this.j,h);let ne=this.o;if(this.S&&(ne?(ne=R(ne),D(ne,this.S)):ne=this.S),this.m!==null||this.O||(X.H=ne,ne=null),this.P)e:{for(var y=0,E=0;E<this.i.length;E++){t:{var M=this.i[E];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(y+=M,4096<y){y=E;break e}if(y===4096||E===this.i.length-1){y=E+1;break e}}y=1e3}else y=1e3;y=ku(this,X,y),E=On(this.I),ot(E,"RID",h),ot(E,"CVER",22),this.D&&ot(E,"X-HTTP-Session-Id",this.D),ar(this,E),ne&&(this.O?y="headers="+encodeURIComponent(String(Dl(ne)))+"&"+y:this.m&&Gt(E,this.m,ne)),Kr(this.h,X),this.Ua&&ot(E,"TYPE","init"),this.P?(ot(E,"$req",y),ot(E,"SID","null"),X.T=!0,ds(X,E,null)):ds(X,E,y),this.G=2}}else this.G==3&&(h?Ol(this,h):this.i.length==0||$r(this.h)||Ol(this))};function Ol(h,y){var E;y?E=y.l:E=h.U++;const M=On(h.I);ot(M,"SID",h.K),ot(M,"RID",E),ot(M,"AID",h.T),ar(h,M),h.m&&h.o&&Gt(M,h.m,h.o),E=new vn(h,h.j,E,h.B+1),h.m===null&&(E.H=h.o),y&&(h.i=y.D.concat(h.i)),y=ku(h,E,1e3),E.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Kr(h.h,E),ds(E,M,y)}function ar(h,y){h.H&&Q(h.H,function(E,M){ot(y,M,E)}),h.l&&wl({},function(E,M){ot(y,M,E)})}function ku(h,y,E){E=Math.min(h.i.length,E);var M=h.l?T(h.l.Na,h.l,h):null;e:{var X=h.i;let ne=-1;for(;;){const de=["count="+E];ne==-1?0<E?(ne=X[0].g,de.push("ofs="+ne)):ne=0:de.push("ofs="+ne);let Ke=!0;for(let Lt=0;Lt<E;Lt++){let Qe=X[Lt].g;const $t=X[Lt].map;if(Qe-=ne,0>Qe)ne=Math.max(0,X[Lt].g-100),Ke=!1;else try{Rs($t,de,"req"+Qe+"_")}catch{M&&M($t)}}if(Ke){M=de.join("&");break e}}}return h=h.i.splice(0,E),y.D=h,M}function Pu(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;z||q(),ae||(z(),ae=!0),he.add(y,h),h.v=0}}function kl(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=It(T(h.Fa,h),Pl(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,Lu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=It(T(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_t(10),to(this),Lu(this))};function ir(h){h.A!=null&&(m.clearTimeout(h.A),h.A=null)}function Lu(h){h.g=new vn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=On(h.qa);ot(y,"RID","rpc"),ot(y,"SID",h.K),ot(y,"AID",h.T),ot(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&ot(y,"TO",h.ja),ot(y,"TYPE","xmlhttp"),ar(h,y),h.m&&h.o&&Gt(y,h.m,h.o),h.L&&(h.g.I=h.L);var E=h.g;h=h.ia,E.L=1,E.v=Wi(On(y)),E.m=null,E.P=!0,na(E,h)}n.Za=function(){this.C!=null&&(this.C=null,to(this),kl(this),_t(19))};function so(h){h.C!=null&&(m.clearTimeout(h.C),h.C=null)}function Vu(h,y){var E=null;if(h.g==y){so(h),ir(h),h.g=null;var M=2}else if(Al(h.h,y))E=y.D,yn(h.h,y),M=1;else return;if(h.G!=0){if(y.o)if(M==1){E=y.m?y.m.length:0,y=Date.now()-y.F;var X=h.B;M=Pa(),at(M,new Pt(M,E)),no(h)}else Pu(h);else if(X=y.s,X==3||X==0&&0<y.X||!(M==1&&Sf(h,y)||M==2&&kl(h)))switch(E&&0<E.length&&(y=h.h,y.i=y.i.concat(E)),X){case 1:ca(h,5);break;case 4:ca(h,10);break;case 3:ca(h,6);break;default:ca(h,2)}}}function Pl(h,y){let E=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(E*=2),E*y}function ca(h,y){if(h.j.info("Error code "+y),y==2){var E=T(h.fb,h),M=h.Xa;const X=!M;M=new Rt(M||"//www.google.com/images/cleardot.gif"),m.location&&m.location.protocol=="http"||Xi(M,"https"),Wi(M),X?Ji(M.toString(),E):hs(M.toString(),E)}else _t(2);h.G=0,h.l&&h.l.sa(y),Uu(h),Ou(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),_t(2)):(this.j.info("Failed to ping google.com"),_t(1))};function Uu(h){if(h.G=0,h.ka=[],h.l){const y=jl(h.h);(y.length!=0||h.i.length!=0)&&(w(h.ka,y),w(h.ka,h.i),h.h.i.length=0,C(h.i),h.i.length=0),h.l.ra()}}function Fu(h,y,E){var M=E instanceof Rt?On(E):new Rt(E);if(M.g!="")y&&(M.g=y+"."+M.g),qa(M,M.s);else{var X=m.location;M=X.protocol,y=y?y+"."+X.hostname:X.hostname,X=+X.port;var ne=new Rt(null);M&&Xi(ne,M),y&&(ne.g=y),X&&qa(ne,X),E&&(ne.l=E),M=ne}return E=h.D,y=h.ya,E&&y&&ot(M,E,y),ot(M,"VER",h.la),ar(h,M),M}function qu(h,y,E){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new nt(new Ba({eb:E})):new nt(h.pa),y.Ha(h.J),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Bu(){}n=Bu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ao(){}ao.prototype.g=function(h,y){return new _n(h,y)};function _n(h,y){xt.call(this),this.g=new eo(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!H(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!H(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new ks(this)}x(_n,xt),_n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},_n.prototype.close=function(){Ml(this.g)},_n.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.u&&(E={},E.__data__=us(h),h=E);y.i.push(new Su(y.Ya++,h)),y.G==3&&no(y)},_n.prototype.N=function(){this.g.l=null,delete this.j,Ml(this.g),delete this.g,_n.aa.N.call(this)};function Hu(h){ea.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const E in y){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}x(Hu,ea);function zu(){El.call(this),this.status=1}x(zu,El);function ks(h){this.g=h}x(ks,Bu),ks.prototype.ua=function(){at(this.g,"a")},ks.prototype.ta=function(h){at(this.g,new Hu(h))},ks.prototype.sa=function(h){at(this.g,new zu)},ks.prototype.ra=function(){at(this.g,"b")},ao.prototype.createWebChannel=ao.prototype.g,_n.prototype.send=_n.prototype.o,_n.prototype.open=_n.prototype.m,_n.prototype.close=_n.prototype.close,UT=function(){return new ao},VT=function(){return Pa()},LT=js,sg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ua.NO_ERROR=0,Ua.TIMEOUT=8,Ua.HTTP_ERROR=6,ah=Ua,ta.COMPLETE="complete",PT=ta,bl.EventType=Js,Js.OPEN="a",Js.CLOSE="b",Js.ERROR="c",Js.MESSAGE="d",xt.prototype.listen=xt.prototype.K,wc=bl,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,kT=nt}).apply(typeof $d<"u"?$d:typeof self<"u"?self:typeof window<"u"?window:{});const eN="@firebase/firestore",tN="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ol="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir=new su("@firebase/firestore");function Po(){return Ir.logLevel}function ve(n,...e){if(Ir.logLevel<=$e.DEBUG){const t=e.map(Bg);Ir.debug(`Firestore (${ol}): ${n}`,...t)}}function Ra(n,...e){if(Ir.logLevel<=$e.ERROR){const t=e.map(Bg);Ir.error(`Firestore (${ol}): ${n}`,...t)}}function Xo(n,...e){if(Ir.logLevel<=$e.WARN){const t=e.map(Bg);Ir.warn(`Firestore (${ol}): ${n}`,...t)}}function Bg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(n,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,FT(n,a,t)}function FT(n,e,t){let a=`FIRESTORE (${ol}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw Ra(a),new Error(a)}function Ze(n,e,t,a){let o="Unexpected state";typeof t=="string"?o=t:a=t,n||FT(e,o,a)}function De(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends cs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class C1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(fn.UNAUTHENTICATED))}shutdown(){}}class S1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class I1{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0,42304);let a=this.i;const o=p=>this.i!==a?(a=this.i,t(p)):Promise.resolve();let c=new $s;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new $s,e.enqueueRetryable(()=>o(this.currentUser))};const d=()=>{const p=c;e.enqueueRetryable(async()=>{await p.promise,await o(this.currentUser)})},m=p=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit(p=>m(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?m(p):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new $s)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(a=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Ze(typeof a.accessToken=="string",31837,{l:a}),new qT(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new fn(e)}}class R1{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class D1{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new R1(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(fn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class M1{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Rn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ze(this.o===void 0,3512);const a=c=>{c.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,ve("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>a(c))};const o=c=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>o(c)),setTimeout(()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new nN(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new nN(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O1(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<n;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BT(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const o=O1(40);for(let c=0;c<o.length;++c)a.length<20&&o[c]<t&&(a+=e.charAt(o[c]%62))}return a}}function Fe(n,e){return n<e?-1:n>e?1:0}function ag(n,e){let t=0;for(;t<n.length&&t<e.length;){const a=n.codePointAt(t),o=e.codePointAt(t);if(a!==o){if(a<128&&o<128)return Fe(a,o);{const c=BT(),d=k1(c.encode(sN(n,t)),c.encode(sN(e,t)));return d!==0?d:Fe(a,o)}}t+=a>65535?2:1}return Fe(n.length,e.length)}function sN(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function k1(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Fe(n[t],e[t]);return Fe(n.length,e.length)}function Wo(n,e,t){return n.length===e.length&&n.every((a,o)=>t(a,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aN=-62135596800,iN=1e6;class qt{static now(){return qt.fromMillis(Date.now())}static fromDate(e){return qt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*iN);return new qt(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<aN)throw new me(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/iN}_compareTo(e){return this.seconds===e.seconds?Fe(this.nanoseconds,e.nanoseconds):Fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-aN;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{static fromTimestamp(e){return new we(e)}static min(){return new we(new qt(0,0))}static max(){return new we(new qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN="__name__";class Hs{constructor(e,t,a){t===void 0?t=0:t>e.length&&xe(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&xe(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return Hs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Hs?e.forEach(a=>{t.push(a)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let o=0;o<a;o++){const c=Hs.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Fe(e.length,t.length)}static compareSegments(e,t){const a=Hs.isNumericId(e),o=Hs.isNumericId(t);return a&&!o?-1:!a&&o?1:a&&o?Hs.extractNumericId(e).compare(Hs.extractNumericId(t)):ag(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _i.fromString(e.substring(4,e.length-2))}}class ft extends Hs{construct(e,t,a){return new ft(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new me(re.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter(o=>o.length>0))}return new ft(t)}static emptyPath(){return new ft([])}}const P1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class an extends Hs{construct(e,t,a){return new an(e,t,a)}static isValidIdentifier(e){return P1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),an.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rN}static keyField(){return new an([rN])}static fromServerFormat(e){const t=[];let a="",o=0;const c=()=>{if(a.length===0)throw new me(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let d=!1;for(;o<e.length;){const m=e[o];if(m==="\\"){if(o+1===e.length)throw new me(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new me(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=p,o+=2}else m==="`"?(d=!d,o++):m!=="."||d?(a+=m,o++):(c(),o++)}if(c(),d)throw new me(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new an(t)}static emptyPath(){return new an([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(ft.fromString(e))}static fromName(e){return new Ee(ft.fromString(e).popFirst(5))}static empty(){return new Ee(ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ft.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new ft(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c=-1;function L1(n,e){const t=n.toTimestamp().seconds,a=n.toTimestamp().nanoseconds+1,o=we.fromTimestamp(a===1e9?new qt(t+1,0):new qt(t,a));return new Ni(o,Ee.empty(),e)}function V1(n){return new Ni(n.readTime,n.key,$c)}class Ni{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new Ni(we.min(),Ee.empty(),$c)}static max(){return new Ni(we.max(),Ee.empty(),$c)}}function U1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:Fe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class q1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ll(n){if(n.code!==re.FAILED_PRECONDITION||n.message!==F1)throw n;ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&xe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le((a,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(a,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(a,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):le.reject(t)}static resolve(e){return new le((t,a)=>{t(e)})}static reject(e){return new le((t,a)=>{a(e)})}static waitFor(e){return new le((t,a)=>{let o=0,c=0,d=!1;e.forEach(m=>{++o,m.next(()=>{++c,d&&c===o&&t()},p=>a(p))}),d=!0,c===o&&t()})}static or(e){let t=le.resolve(!1);for(const a of e)t=t.next(o=>o?le.resolve(o):a());return t}static forEach(e,t){const a=[];return e.forEach((o,c)=>{a.push(t.call(this,o,c))}),this.waitFor(a)}static mapArray(e,t){return new le((a,o)=>{const c=e.length,d=new Array(c);let m=0;for(let p=0;p<c;p++){const v=p;t(e[v]).next(_=>{d[v]=_,++m,m===c&&a(d)},_=>o(_))}})}static doWhile(e,t){return new le((a,o)=>{const c=()=>{e()===!0?t().next(()=>{c()},o):a()};c()})}}function B1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function cl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ue(a),this.ce=a=>t.writeSequenceNumber(a))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Gh.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg=-1;function cu(n){return n==null}function bh(n){return n===0&&1/n==-1/0}function H1(n){return typeof n=="number"&&Number.isInteger(n)&&!bh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT="";function z1(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=oN(e)),e=G1(n.get(t),e);return oN(e)}function G1(n,e){let t=e;const a=n.length;for(let o=0;o<a;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case zT:t+="";break;default:t+=c}}return t}function oN(n){return n+zT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lN(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ki(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function GT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,t){this.comparator=e,this.root=t||sn.EMPTY}insert(e,t){return new Nt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,sn.BLACK,null,null))}remove(e){return new Nt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const o=this.comparator(e,a.key);if(o===0)return t+a.left.size;o<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,a)=>(e(t,a),!1))}toString(){const e=[];return this.inorderTraversal((t,a)=>(e.push(`${t}:${a}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Yd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Yd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Yd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Yd(this.root,e,this.comparator,!0)}}class Yd{constructor(e,t,a,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?a(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sn{constructor(e,t,a,o,c){this.key=e,this.value=t,this.color=a??sn.RED,this.left=o??sn.EMPTY,this.right=c??sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,o,c){return new sn(e??this.key,t??this.value,a??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let o=this;const c=a(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,a),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,a)),o.fixUp()}removeMin(){if(this.left.isEmpty())return sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return sn.EMPTY;a=o.right.min(),o=o.copy(a.key,a.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw xe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw xe(27949);return e+(this.isRed()?0:1)}}sn.EMPTY=null,sn.RED=!0,sn.BLACK=!1;sn.EMPTY=new class{constructor(){this.size=0}get key(){throw xe(57766)}get value(){throw xe(16141)}get color(){throw xe(16727)}get left(){throw xe(29726)}get right(){throw xe(36894)}copy(e,t,a,o,c){return this}insert(e,t,a){return new sn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.comparator=e,this.data=new Nt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,a)=>(e(t),!1))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const o=a.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new cN(this.data.getIterator())}getIteratorFrom(e){return new cN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(a=>{t=t.add(a)}),t}isEqual(e){if(!(e instanceof Bt)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Bt(this.comparator);return t.data=e,t}}class cN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.fields=e,e.sort(an.comparator)}static empty(){return new Bn([])}unionWith(e){let t=new Bt(an.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new Bn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Wo(this.fields,e.fields,(t,a)=>t.isEqual(a))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new $T("Invalid base64 string: "+c):c}}(e);return new ln(t)}static fromUint8Array(e){const t=function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c}(e);return new ln(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const a=new Uint8Array(t.length);for(let o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return a}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ln.EMPTY_BYTE_STRING=new ln("");const $1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xi(n){if(Ze(!!n,39018),typeof n=="string"){let e=0;const t=$1.exec(n);if(Ze(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const a=new Date(n);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:St(n.seconds),nanos:St(n.nanos)}}function St(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ti(n){return typeof n=="string"?ln.fromBase64String(n):ln.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT="server_timestamp",KT="__type__",QT="__previous_value__",XT="__local_write_time__";function zg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[KT])===null||t===void 0?void 0:t.stringValue)===YT}function $h(n){const e=n.mapValue.fields[QT];return zg(e)?$h(e):e}function Yc(n){const e=xi(n.mapValue.fields[XT].timestampValue);return new qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e,t,a,o,c,d,m,p,v,_){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=m,this.longPollingOptions=p,this.useFetchStreams=v,this.isUsingEmulator=_}}const Eh="(default)";class Kc{constructor(e,t){this.projectId=e,this.database=t||Eh}static empty(){return new Kc("","")}get isDefaultDatabase(){return this.database===Eh}isEqual(e){return e instanceof Kc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT="__type__",K1="__max__",Kd={mapValue:{}},ZT="__vector__",Nh="value";function Ai(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?zg(n)?4:X1(n)?9007199254740991:Q1(n)?10:11:xe(28295,{value:n})}function Ks(n,e){if(n===e)return!0;const t=Ai(n);if(t!==Ai(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Yc(n).isEqual(Yc(e));case 3:return function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=xi(o.timestampValue),m=xi(c.timestampValue);return d.seconds===m.seconds&&d.nanos===m.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,c){return Ti(o.bytesValue).isEqual(Ti(c.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,c){return St(o.geoPointValue.latitude)===St(c.geoPointValue.latitude)&&St(o.geoPointValue.longitude)===St(c.geoPointValue.longitude)}(n,e);case 2:return function(o,c){if("integerValue"in o&&"integerValue"in c)return St(o.integerValue)===St(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=St(o.doubleValue),m=St(c.doubleValue);return d===m?bh(d)===bh(m):isNaN(d)&&isNaN(m)}return!1}(n,e);case 9:return Wo(n.arrayValue.values||[],e.arrayValue.values||[],Ks);case 10:case 11:return function(o,c){const d=o.mapValue.fields||{},m=c.mapValue.fields||{};if(lN(d)!==lN(m))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(m[p]===void 0||!Ks(d[p],m[p])))return!1;return!0}(n,e);default:return xe(52216,{left:n})}}function Qc(n,e){return(n.values||[]).find(t=>Ks(t,e))!==void 0}function Zo(n,e){if(n===e)return 0;const t=Ai(n),a=Ai(e);if(t!==a)return Fe(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return Fe(n.booleanValue,e.booleanValue);case 2:return function(c,d){const m=St(c.integerValue||c.doubleValue),p=St(d.integerValue||d.doubleValue);return m<p?-1:m>p?1:m===p?0:isNaN(m)?isNaN(p)?0:-1:1}(n,e);case 3:return uN(n.timestampValue,e.timestampValue);case 4:return uN(Yc(n),Yc(e));case 5:return ag(n.stringValue,e.stringValue);case 6:return function(c,d){const m=Ti(c),p=Ti(d);return m.compareTo(p)}(n.bytesValue,e.bytesValue);case 7:return function(c,d){const m=c.split("/"),p=d.split("/");for(let v=0;v<m.length&&v<p.length;v++){const _=Fe(m[v],p[v]);if(_!==0)return _}return Fe(m.length,p.length)}(n.referenceValue,e.referenceValue);case 8:return function(c,d){const m=Fe(St(c.latitude),St(d.latitude));return m!==0?m:Fe(St(c.longitude),St(d.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return dN(n.arrayValue,e.arrayValue);case 10:return function(c,d){var m,p,v,_;const b=c.fields||{},T=d.fields||{},j=(m=b[Nh])===null||m===void 0?void 0:m.arrayValue,x=(p=T[Nh])===null||p===void 0?void 0:p.arrayValue,C=Fe(((v=j?.values)===null||v===void 0?void 0:v.length)||0,((_=x?.values)===null||_===void 0?void 0:_.length)||0);return C!==0?C:dN(j,x)}(n.mapValue,e.mapValue);case 11:return function(c,d){if(c===Kd.mapValue&&d===Kd.mapValue)return 0;if(c===Kd.mapValue)return 1;if(d===Kd.mapValue)return-1;const m=c.fields||{},p=Object.keys(m),v=d.fields||{},_=Object.keys(v);p.sort(),_.sort();for(let b=0;b<p.length&&b<_.length;++b){const T=ag(p[b],_[b]);if(T!==0)return T;const j=Zo(m[p[b]],v[_[b]]);if(j!==0)return j}return Fe(p.length,_.length)}(n.mapValue,e.mapValue);default:throw xe(23264,{Pe:t})}}function uN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Fe(n,e);const t=xi(n),a=xi(e),o=Fe(t.seconds,a.seconds);return o!==0?o:Fe(t.nanos,a.nanos)}function dN(n,e){const t=n.values||[],a=e.values||[];for(let o=0;o<t.length&&o<a.length;++o){const c=Zo(t[o],a[o]);if(c)return c}return Fe(t.length,a.length)}function Jo(n){return ig(n)}function ig(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const a=xi(t);return`time(${a.seconds},${a.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ti(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ee.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let a="[",o=!0;for(const c of t.values||[])o?o=!1:a+=",",a+=ig(c);return a+"]"}(n.arrayValue):"mapValue"in n?function(t){const a=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of a)c?c=!1:o+=",",o+=`${d}:${ig(t.fields[d])}`;return o+"}"}(n.mapValue):xe(61005,{value:n})}function ih(n){switch(Ai(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$h(n);return e?16+ih(e):16;case 5:return 2*n.stringValue.length;case 6:return Ti(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(a){return(a.values||[]).reduce((o,c)=>o+ih(c),0)}(n.arrayValue);case 10:case 11:return function(a){let o=0;return ki(a.fields,(c,d)=>{o+=c.length+ih(d)}),o}(n.mapValue);default:throw xe(13486,{value:n})}}function hN(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function rg(n){return!!n&&"integerValue"in n}function Gg(n){return!!n&&"arrayValue"in n}function fN(n){return!!n&&"nullValue"in n}function mN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function rh(n){return!!n&&"mapValue"in n}function Q1(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[WT])===null||t===void 0?void 0:t.stringValue)===ZT}function Mc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ki(n.mapValue.fields,(t,a)=>e.mapValue.fields[t]=Mc(a)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Mc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function X1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===K1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.value=e}static empty(){return new xn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!rh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mc(t)}setAll(e){let t=an.emptyPath(),a={},o=[];e.forEach((d,m)=>{if(!t.isImmediateParentOf(m)){const p=this.getFieldsMap(t);this.applyChanges(p,a,o),a={},o=[],t=m.popLast()}d?a[m.lastSegment()]=Mc(d):o.push(m.lastSegment())});const c=this.getFieldsMap(t);this.applyChanges(c,a,o)}delete(e){const t=this.field(e.popLast());rh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ks(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let o=t.mapValue.fields[e.get(a)];rh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,a){ki(t,(o,c)=>e[o]=c);for(const o of a)delete e[o]}clone(){return new xn(Mc(this.value))}}function JT(n){const e=[];return ki(n.fields,(t,a)=>{const o=new an([t]);if(rh(a)){const c=JT(a.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)}),new Bn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,t,a,o,c,d,m){this.key=e,this.documentType=t,this.version=a,this.readTime=o,this.createTime=c,this.data=d,this.documentState=m}static newInvalidDocument(e){return new Wt(e,0,we.min(),we.min(),we.min(),xn.empty(),0)}static newFoundDocument(e,t,a,o){return new Wt(e,1,t,we.min(),a,o,0)}static newNoDocument(e,t){return new Wt(e,2,t,we.min(),we.min(),xn.empty(),0)}static newUnknownDocument(e,t){return new Wt(e,3,t,we.min(),we.min(),xn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(we.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,t){this.position=e,this.inclusive=t}}function pN(n,e,t){let a=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?a=Ee.comparator(Ee.fromName(d.referenceValue),t.key):a=Zo(d,t.data.field(c.field)),c.dir==="desc"&&(a*=-1),a!==0)break}return a}function gN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ks(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,t="asc"){this.field=e,this.dir=t}}function W1(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{}class kt extends e0{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new J1(e,t,a):t==="array-contains"?new nD(e,a):t==="in"?new sD(e,a):t==="not-in"?new aD(e,a):t==="array-contains-any"?new iD(e,a):new kt(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new eD(e,a):new tD(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Zo(t,this.value)):t!==null&&Ai(this.value)===Ai(t)&&this.matchesComparison(Zo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ns extends e0{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Ns(e,t)}matches(e){return t0(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function t0(n){return n.op==="and"}function n0(n){return Z1(n)&&t0(n)}function Z1(n){for(const e of n.filters)if(e instanceof Ns)return!1;return!0}function og(n){if(n instanceof kt)return n.field.canonicalString()+n.op.toString()+Jo(n.value);if(n0(n))return n.filters.map(e=>og(e)).join(",");{const e=n.filters.map(t=>og(t)).join(",");return`${n.op}(${e})`}}function s0(n,e){return n instanceof kt?function(a,o){return o instanceof kt&&a.op===o.op&&a.field.isEqual(o.field)&&Ks(a.value,o.value)}(n,e):n instanceof Ns?function(a,o){return o instanceof Ns&&a.op===o.op&&a.filters.length===o.filters.length?a.filters.reduce((c,d,m)=>c&&s0(d,o.filters[m]),!0):!1}(n,e):void xe(19439)}function a0(n){return n instanceof kt?function(t){return`${t.field.canonicalString()} ${t.op} ${Jo(t.value)}`}(n):n instanceof Ns?function(t){return t.op.toString()+" {"+t.getFilters().map(a0).join(" ,")+"}"}(n):"Filter"}class J1 extends kt{constructor(e,t,a){super(e,t,a),this.key=Ee.fromName(a.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class eD extends kt{constructor(e,t){super(e,"in",t),this.keys=i0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class tD extends kt{constructor(e,t){super(e,"not-in",t),this.keys=i0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function i0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(a=>Ee.fromName(a.referenceValue))}class nD extends kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Gg(t)&&Qc(t.arrayValue,this.value)}}class sD extends kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Qc(this.value.arrayValue,t)}}class aD extends kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Qc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Qc(this.value.arrayValue,t)}}class iD extends kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Gg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(a=>Qc(this.value.arrayValue,a))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e,t=null,a=[],o=[],c=null,d=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=o,this.limit=c,this.startAt=d,this.endAt=m,this.Ie=null}}function vN(n,e=null,t=[],a=[],o=null,c=null,d=null){return new rD(n,e,t,a,o,c,d)}function $g(n){const e=De(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(a=>og(a)).join(","),t+="|ob:",t+=e.orderBy.map(a=>function(c){return c.field.canonicalString()+c.dir}(a)).join(","),cu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(a=>Jo(a)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(a=>Jo(a)).join(",")),e.Ie=t}return e.Ie}function Yg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!W1(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!s0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!gN(n.startAt,e.startAt)&&gN(n.endAt,e.endAt)}function lg(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,t=null,a=[],o=[],c=null,d="F",m=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=o,this.limit=c,this.limitType=d,this.startAt=m,this.endAt=p,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function oD(n,e,t,a,o,c,d,m){return new ul(n,e,t,a,o,c,d,m)}function Yh(n){return new ul(n)}function yN(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function r0(n){return n.collectionGroup!==null}function Oc(n){const e=De(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ee.push(c),t.add(c.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let m=new Bt(an.comparator);return d.filters.forEach(p=>{p.getFlattenedFilters().forEach(v=>{v.isInequality()&&(m=m.add(v.field))})}),m})(e).forEach(c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ee.push(new Xc(c,a))}),t.has(an.keyField().canonicalString())||e.Ee.push(new Xc(an.keyField(),a))}return e.Ee}function Ys(n){const e=De(n);return e.de||(e.de=lD(e,Oc(n))),e.de}function lD(n,e){if(n.limitType==="F")return vN(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const c=o.dir==="desc"?"asc":"desc";return new Xc(o.field,c)});const t=n.endAt?new xh(n.endAt.position,n.endAt.inclusive):null,a=n.startAt?new xh(n.startAt.position,n.startAt.inclusive):null;return vN(n.path,n.collectionGroup,e,n.filters,n.limit,t,a)}}function cg(n,e){const t=n.filters.concat([e]);return new ul(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Th(n,e,t){return new ul(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Kh(n,e){return Yg(Ys(n),Ys(e))&&n.limitType===e.limitType}function o0(n){return`${$g(Ys(n))}|lt:${n.limitType}`}function Lo(n){return`Query(target=${function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map(o=>a0(o)).join(", ")}]`),cu(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map(o=>function(d){return`${d.field.canonicalString()} (${d.dir})`}(o)).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map(o=>Jo(o)).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map(o=>Jo(o)).join(",")),`Target(${a})`}(Ys(n))}; limitType=${n.limitType})`}function Qh(n,e){return e.isFoundDocument()&&function(a,o){const c=o.key.path;return a.collectionGroup!==null?o.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):Ee.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)}(n,e)&&function(a,o){for(const c of Oc(a))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0}(n,e)&&function(a,o){for(const c of a.filters)if(!c.matches(o))return!1;return!0}(n,e)&&function(a,o){return!(a.startAt&&!function(d,m,p){const v=pN(d,m,p);return d.inclusive?v<=0:v<0}(a.startAt,Oc(a),o)||a.endAt&&!function(d,m,p){const v=pN(d,m,p);return d.inclusive?v>=0:v>0}(a.endAt,Oc(a),o))}(n,e)}function cD(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function l0(n){return(e,t)=>{let a=!1;for(const o of Oc(n)){const c=uD(o,e,t);if(c!==0)return c;a=a||o.field.isKeyField()}return 0}}function uD(n,e,t){const a=n.field.isKeyField()?Ee.comparator(e.key,t.key):function(c,d,m){const p=d.data.field(c),v=m.data.field(c);return p!==null&&v!==null?Zo(p,v):xe(42886)}(n.field,e,t);switch(n.dir){case"asc":return a;case"desc":return-1*a;default:return xe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[o,c]of a)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),o=this.inner[a];if(o===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return a.length===1?delete this.inner[t]:a.splice(o,1),this.innerSize--,!0;return!1}forEach(e){ki(this.inner,(t,a)=>{for(const[o,c]of a)e(o,c)})}isEmpty(){return GT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dD=new Nt(Ee.comparator);function Da(){return dD}const c0=new Nt(Ee.comparator);function Cc(...n){let e=c0;for(const t of n)e=e.insert(t.key,t);return e}function u0(n){let e=c0;return n.forEach((t,a)=>e=e.insert(t,a.overlayedDocument)),e}function Tr(){return kc()}function d0(){return kc()}function kc(){return new Lr(n=>n.toString(),(n,e)=>n.isEqual(e))}const hD=new Nt(Ee.comparator),fD=new Bt(Ee.comparator);function Ye(...n){let e=fD;for(const t of n)e=e.add(t);return e}const mD=new Bt(Fe);function pD(){return mD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bh(e)?"-0":e}}function h0(n){return{integerValue:""+n}}function gD(n,e){return H1(e)?h0(e):Kg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(){this._=void 0}}function vD(n,e,t){return n instanceof Wc?function(o,c){const d={fields:{[KT]:{stringValue:YT},[XT]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&zg(c)&&(c=$h(c)),c&&(d.fields[QT]=c),{mapValue:d}}(t,e):n instanceof Zc?m0(n,e):n instanceof Jc?p0(n,e):function(o,c){const d=f0(o,c),m=_N(d)+_N(o.Re);return rg(d)&&rg(o.Re)?h0(m):Kg(o.serializer,m)}(n,e)}function yD(n,e,t){return n instanceof Zc?m0(n,e):n instanceof Jc?p0(n,e):t}function f0(n,e){return n instanceof Ah?function(a){return rg(a)||function(c){return!!c&&"doubleValue"in c}(a)}(e)?e:{integerValue:0}:null}class Wc extends Xh{}class Zc extends Xh{constructor(e){super(),this.elements=e}}function m0(n,e){const t=g0(e);for(const a of n.elements)t.some(o=>Ks(o,a))||t.push(a);return{arrayValue:{values:t}}}class Jc extends Xh{constructor(e){super(),this.elements=e}}function p0(n,e){let t=g0(e);for(const a of n.elements)t=t.filter(o=>!Ks(o,a));return{arrayValue:{values:t}}}class Ah extends Xh{constructor(e,t){super(),this.serializer=e,this.Re=t}}function _N(n){return St(n.integerValue||n.doubleValue)}function g0(n){return Gg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e,t){this.field=e,this.transform=t}}function bD(n,e){return n.field.isEqual(e.field)&&function(a,o){return a instanceof Zc&&o instanceof Zc||a instanceof Jc&&o instanceof Jc?Wo(a.elements,o.elements,Ks):a instanceof Ah&&o instanceof Ah?Ks(a.Re,o.Re):a instanceof Wc&&o instanceof Wc}(n.transform,e.transform)}class ED{constructor(e,t){this.version=e,this.transformResults=t}}class rn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function oh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Wh{}function v0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Zh(n.key,rn.none()):new uu(n.key,n.data,rn.none());{const t=n.data,a=xn.empty();let o=new Bt(an.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?a.delete(c):a.set(c,d),o=o.add(c)}return new Pi(n.key,a,new Bn(o.toArray()),rn.none())}}function ND(n,e,t){n instanceof uu?function(o,c,d){const m=o.value.clone(),p=EN(o.fieldTransforms,c,d.transformResults);m.setAll(p),c.convertToFoundDocument(d.version,m).setHasCommittedMutations()}(n,e,t):n instanceof Pi?function(o,c,d){if(!oh(o.precondition,c))return void c.convertToUnknownDocument(d.version);const m=EN(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(y0(o)),p.setAll(m),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()}(n,e,t):function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()}(0,e,t)}function Pc(n,e,t,a){return n instanceof uu?function(c,d,m,p){if(!oh(c.precondition,d))return m;const v=c.value.clone(),_=NN(c.fieldTransforms,p,d);return v.setAll(_),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null}(n,e,t,a):n instanceof Pi?function(c,d,m,p){if(!oh(c.precondition,d))return m;const v=NN(c.fieldTransforms,p,d),_=d.data;return _.setAll(y0(c)),_.setAll(v),d.convertToFoundDocument(d.version,_).setHasLocalMutations(),m===null?null:m.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(b=>b.field))}(n,e,t,a):function(c,d,m){return oh(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):m}(n,e,t)}function xD(n,e){let t=null;for(const a of n.fieldTransforms){const o=e.data.field(a.field),c=f0(a.transform,o||null);c!=null&&(t===null&&(t=xn.empty()),t.set(a.field,c))}return t||null}function bN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(a,o){return a===void 0&&o===void 0||!(!a||!o)&&Wo(a,o,(c,d)=>bD(c,d))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class uu extends Wh{constructor(e,t,a,o=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Pi extends Wh{constructor(e,t,a,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function y0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const a=n.data.field(t);e.set(t,a)}}),e}function EN(n,e,t){const a=new Map;Ze(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,m=e.data.field(c.field);a.set(c.field,yD(d,m,t[o]))}return a}function NN(n,e,t){const a=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);a.set(o.field,vD(c,d,e))}return a}class Zh extends Wh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _0 extends Wh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e,t,a,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=o}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&ND(c,e,a[o])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=Pc(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=Pc(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=d0();return this.mutations.forEach(o=>{const c=e.get(o.key),d=c.overlayedDocument;let m=this.applyToLocalView(d,c.mutatedFields);m=t.has(o.key)?null:m;const p=v0(d,m);p!==null&&a.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(we.min())}),a}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ye())}isEqual(e){return this.batchId===e.batchId&&Wo(this.mutations,e.mutations,(t,a)=>bN(t,a))&&Wo(this.baseMutations,e.baseMutations,(t,a)=>bN(t,a))}}class Qg{constructor(e,t,a,o){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=o}static from(e,t,a){Ze(e.mutations.length===a.length,58842,{fe:e.mutations.length,ge:a.length});let o=function(){return hD}();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,a[d].version);return new Qg(e,t,a,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot,We;function b0(n){switch(n){case re.OK:return xe(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return xe(15467,{code:n})}}function E0(n){if(n===void 0)return Ra("GRPC error has no .code"),re.UNKNOWN;switch(n){case Ot.OK:return re.OK;case Ot.CANCELLED:return re.CANCELLED;case Ot.UNKNOWN:return re.UNKNOWN;case Ot.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case Ot.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case Ot.INTERNAL:return re.INTERNAL;case Ot.UNAVAILABLE:return re.UNAVAILABLE;case Ot.UNAUTHENTICATED:return re.UNAUTHENTICATED;case Ot.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case Ot.NOT_FOUND:return re.NOT_FOUND;case Ot.ALREADY_EXISTS:return re.ALREADY_EXISTS;case Ot.PERMISSION_DENIED:return re.PERMISSION_DENIED;case Ot.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case Ot.ABORTED:return re.ABORTED;case Ot.OUT_OF_RANGE:return re.OUT_OF_RANGE;case Ot.UNIMPLEMENTED:return re.UNIMPLEMENTED;case Ot.DATA_LOSS:return re.DATA_LOSS;default:return xe(39323,{code:n})}}(We=Ot||(Ot={}))[We.OK=0]="OK",We[We.CANCELLED=1]="CANCELLED",We[We.UNKNOWN=2]="UNKNOWN",We[We.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",We[We.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",We[We.NOT_FOUND=5]="NOT_FOUND",We[We.ALREADY_EXISTS=6]="ALREADY_EXISTS",We[We.PERMISSION_DENIED=7]="PERMISSION_DENIED",We[We.UNAUTHENTICATED=16]="UNAUTHENTICATED",We[We.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",We[We.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",We[We.ABORTED=10]="ABORTED",We[We.OUT_OF_RANGE=11]="OUT_OF_RANGE",We[We.UNIMPLEMENTED=12]="UNIMPLEMENTED",We[We.INTERNAL=13]="INTERNAL",We[We.UNAVAILABLE=14]="UNAVAILABLE",We[We.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD=new _i([4294967295,4294967295],0);function xN(n){const e=BT().encode(n),t=new OT;return t.update(e),new Uint8Array(t.digest())}function TN(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new _i([t,a],0),new _i([o,c],0)]}class Xg{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new Sc(`Invalid padding: ${t}`);if(a<0)throw new Sc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new Sc(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new Sc(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=_i.fromNumber(this.pe)}we(e,t,a){let o=e.add(t.multiply(_i.fromNumber(a)));return o.compare(wD)===1&&(o=new _i([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=xN(e),[a,o]=TN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);if(!this.be(d))return!1}return!0}static create(e,t,a){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new Xg(c,o,t);return a.forEach(m=>d.insert(m)),d}insert(e){if(this.pe===0)return;const t=xN(e),[a,o]=TN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);this.Se(d)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class Sc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,t,a,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const o=new Map;return o.set(e,du.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new Jh(we.min(),o,new Nt(Fe),Da(),Ye())}}class du{constructor(e,t,a,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new du(a,t,Ye(),Ye(),Ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,t,a,o){this.De=e,this.removedTargetIds=t,this.key=a,this.ve=o}}class N0{constructor(e,t){this.targetId=e,this.Ce=t}}class x0{constructor(e,t,a=ln.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=o}}class AN{constructor(){this.Fe=0,this.Me=jN(),this.xe=ln.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Ye(),t=Ye(),a=Ye();return this.Me.forEach((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:a=a.add(o);break;default:xe(38017,{changeType:c})}}),new du(this.xe,this.Oe,e,t,a)}Qe(){this.Ne=!1,this.Me=jN()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Ze(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class CD{constructor(e){this.ze=e,this.je=new Map,this.He=Da(),this.Je=Qd(),this.Ye=Qd(),this.Ze=new Nt(Fe)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const a=this.rt(t);switch(e.state){case 0:this.it(t)&&a.ke(e.resumeToken);break;case 1:a.We(),a.Be||a.Qe(),a.ke(e.resumeToken);break;case 2:a.We(),a.Be||this.removeTarget(t);break;case 3:this.it(t)&&(a.Ge(),a.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),a.ke(e.resumeToken));break;default:xe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((a,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,a=e.Ce.count,o=this._t(t);if(o){const c=o.target;if(lg(c))if(a===0){const d=new Ee(c.path);this.tt(t,d,Wt.newNoDocument(d,we.min()))}else Ze(a===1,20013,{expectedCount:a});else{const d=this.ut(t);if(d!==a){const m=this.ct(e),p=m?this.lt(m,e,d):1;if(p!==0){this.st(t);const v=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,v)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:o=0},hashCount:c=0}=t;let d,m;try{d=Ti(a).toUint8Array()}catch(p){if(p instanceof $T)return Xo("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{m=new Xg(d,o,c)}catch(p){return Xo(p instanceof Sc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return m.pe===0?null:m}lt(e,t,a){return t.Ce.count===a-this.Tt(e,t.targetId)?0:2}Tt(e,t){const a=this.ze.getRemoteKeysForTarget(t);let o=0;return a.forEach(c=>{const d=this.ze.Pt(),m=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(m)||(this.tt(t,c,null),o++)}),o}It(e){const t=new Map;this.je.forEach((c,d)=>{const m=this._t(d);if(m){if(c.current&&lg(m.target)){const p=new Ee(m.target.path);this.Et(p).has(d)||this.dt(d,p)||this.tt(d,p,Wt.newNoDocument(p,e))}c.Le&&(t.set(d,c.qe()),c.Qe())}});let a=Ye();this.Ye.forEach((c,d)=>{let m=!0;d.forEachWhile(p=>{const v=this._t(p);return!v||v.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)}),m&&(a=a.add(c))}),this.He.forEach((c,d)=>d.setReadTime(e));const o=new Jh(e,t,this.Ze,this.He,a);return this.He=Da(),this.Je=Qd(),this.Ye=Qd(),this.Ze=new Nt(Fe),o}et(e,t){if(!this.it(e))return;const a=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,a),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,a){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),a&&(this.He=this.He.insert(t,a))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new AN,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Bt(Fe),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Bt(Fe),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||ve("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new AN),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Qd(){return new Nt(Ee.comparator)}function jN(){return new Nt(Ee.comparator)}const SD={asc:"ASCENDING",desc:"DESCENDING"},ID={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},RD={and:"AND",or:"OR"};class DD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ug(n,e){return n.useProto3Json||cu(e)?e:{value:e}}function jh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function T0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function MD(n,e){return jh(n,e.toTimestamp())}function zn(n){return Ze(!!n,49232),we.fromTimestamp(function(t){const a=xi(t);return new qt(a.seconds,a.nanos)}(n))}function Wg(n,e){return dg(n,e).canonicalString()}function dg(n,e){const t=function(o){return new ft(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function A0(n){const e=ft.fromString(n);return Ze(R0(e),10190,{key:e.toString()}),e}function wh(n,e){return Wg(n.databaseId,e.path)}function Lc(n,e){const t=A0(e);if(t.get(1)!==n.databaseId.projectId)throw new me(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee(w0(t))}function j0(n,e){return Wg(n.databaseId,e)}function OD(n){const e=A0(n);return e.length===4?ft.emptyPath():w0(e)}function hg(n){return new ft(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function w0(n){return Ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function wN(n,e,t){return{name:wh(n,e),fields:t.value.mapValue.fields}}function kD(n,e){return"found"in e?function(a,o){Ze(!!o.found,43571),o.found.name,o.found.updateTime;const c=Lc(a,o.found.name),d=zn(o.found.updateTime),m=o.found.createTime?zn(o.found.createTime):we.min(),p=new xn({mapValue:{fields:o.found.fields}});return Wt.newFoundDocument(c,d,m,p)}(n,e):"missing"in e?function(a,o){Ze(!!o.missing,3894),Ze(!!o.readTime,22933);const c=Lc(a,o.missing),d=zn(o.readTime);return Wt.newNoDocument(c,d)}(n,e):xe(7234,{result:e})}function PD(n,e){let t;if("targetChange"in e){e.targetChange;const a=function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:xe(39313,{state:v})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=function(v,_){return v.useProto3Json?(Ze(_===void 0||typeof _=="string",58123),ln.fromBase64String(_||"")):(Ze(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),ln.fromUint8Array(_||new Uint8Array))}(n,e.targetChange.resumeToken),d=e.targetChange.cause,m=d&&function(v){const _=v.code===void 0?re.UNKNOWN:E0(v.code);return new me(_,v.message||"")}(d);t=new x0(a,o,c,m||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const o=Lc(n,a.document.name),c=zn(a.document.updateTime),d=a.document.createTime?zn(a.document.createTime):we.min(),m=new xn({mapValue:{fields:a.document.fields}}),p=Wt.newFoundDocument(o,c,d,m),v=a.targetIds||[],_=a.removedTargetIds||[];t=new lh(v,_,p.key,p)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const o=Lc(n,a.document),c=a.readTime?zn(a.readTime):we.min(),d=Wt.newNoDocument(o,c),m=a.removedTargetIds||[];t=new lh([],m,d.key,d)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const o=Lc(n,a.document),c=a.removedTargetIds||[];t=new lh([],c,o,null)}else{if(!("filter"in e))return xe(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:o=0,unchangedNames:c}=a,d=new jD(o,c),m=a.targetId;t=new N0(m,d)}}return t}function C0(n,e){let t;if(e instanceof uu)t={update:wN(n,e.key,e.value)};else if(e instanceof Zh)t={delete:wh(n,e.key)};else if(e instanceof Pi)t={update:wN(n,e.key,e.data),updateMask:GD(e.fieldMask)};else{if(!(e instanceof _0))return xe(16599,{ft:e.type});t={verify:wh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(a=>function(c,d){const m=d.transform;if(m instanceof Wc)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Zc)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Jc)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof Ah)return{fieldPath:d.field.canonicalString(),increment:m.Re};throw xe(20930,{transform:d.transform})}(0,a))),e.precondition.isNone||(t.currentDocument=function(o,c){return c.updateTime!==void 0?{updateTime:MD(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:xe(27497)}(n,e.precondition)),t}function LD(n,e){return n&&n.length>0?(Ze(e!==void 0,14353),n.map(t=>function(o,c){let d=o.updateTime?zn(o.updateTime):zn(c);return d.isEqual(we.min())&&(d=zn(c)),new ED(d,o.transformResults||[])}(t,e))):[]}function VD(n,e){return{documents:[j0(n,e.path)]}}function UD(n,e){const t={structuredQuery:{}},a=e.path;let o;e.collectionGroup!==null?(o=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=j0(n,o);const c=function(v){if(v.length!==0)return I0(Ns.create(v,"and"))}(e.filters);c&&(t.structuredQuery.where=c);const d=function(v){if(v.length!==0)return v.map(_=>function(T){return{field:Vo(T.field),direction:BD(T.dir)}}(_))}(e.orderBy);d&&(t.structuredQuery.orderBy=d);const m=ug(n,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=function(v){return{before:v.inclusive,values:v.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(v){return{before:!v.inclusive,values:v.position}}(e.endAt)),{gt:t,parent:o}}function FD(n){let e=OD(n.parent);const t=n.structuredQuery,a=t.from?t.from.length:0;let o=null;if(a>0){Ze(a===1,65062);const _=t.from[0];_.allDescendants?o=_.collectionId:e=e.child(_.collectionId)}let c=[];t.where&&(c=function(b){const T=S0(b);return T instanceof Ns&&n0(T)?T.getFilters():[T]}(t.where));let d=[];t.orderBy&&(d=function(b){return b.map(T=>function(x){return new Xc(Uo(x.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(T))}(t.orderBy));let m=null;t.limit&&(m=function(b){let T;return T=typeof b=="object"?b.value:b,cu(T)?null:T}(t.limit));let p=null;t.startAt&&(p=function(b){const T=!!b.before,j=b.values||[];return new xh(j,T)}(t.startAt));let v=null;return t.endAt&&(v=function(b){const T=!b.before,j=b.values||[];return new xh(j,T)}(t.endAt)),oD(e,o,d,c,m,"F",p,v)}function qD(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xe(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function S0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=Uo(t.unaryFilter.field);return kt.create(a,"==",{doubleValue:NaN});case"IS_NULL":const o=Uo(t.unaryFilter.field);return kt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Uo(t.unaryFilter.field);return kt.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Uo(t.unaryFilter.field);return kt.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xe(61313);default:return xe(60726)}}(n):n.fieldFilter!==void 0?function(t){return kt.create(Uo(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xe(58110);default:return xe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ns.create(t.compositeFilter.filters.map(a=>S0(a)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return xe(1026)}}(t.compositeFilter.op))}(n):xe(30097,{filter:n})}function BD(n){return SD[n]}function HD(n){return ID[n]}function zD(n){return RD[n]}function Vo(n){return{fieldPath:n.canonicalString()}}function Uo(n){return an.fromServerFormat(n.fieldPath)}function I0(n){return n instanceof kt?function(t){if(t.op==="=="){if(mN(t.value))return{unaryFilter:{field:Vo(t.field),op:"IS_NAN"}};if(fN(t.value))return{unaryFilter:{field:Vo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(mN(t.value))return{unaryFilter:{field:Vo(t.field),op:"IS_NOT_NAN"}};if(fN(t.value))return{unaryFilter:{field:Vo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vo(t.field),op:HD(t.op),value:t.value}}}(n):n instanceof Ns?function(t){const a=t.getFilters().map(o=>I0(o));return a.length===1?a[0]:{compositeFilter:{op:zD(t.op),filters:a}}}(n):xe(54877,{filter:n})}function GD(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function R0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,t,a,o,c=we.min(),d=we.min(),m=ln.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=m,this.expectedCount=p}withSequenceNumber(e){return new gi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e){this.wt=e}}function YD(n){const e=FD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Th(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(){this.Cn=new QD}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(Ni.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(Ni.min())}updateCollectionGroup(e,t,a){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class QD{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t]||new Bt(ft.comparator),c=!o.has(a);return this.index[t]=o.add(a),c}has(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t];return o&&o.has(a)}getEntries(e){return(this.index[e]||new Bt(ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},D0=41943040;class In{static withCacheSize(e){return new In(e,In.DEFAULT_COLLECTION_PERCENTILE,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */In.DEFAULT_COLLECTION_PERCENTILE=10,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,In.DEFAULT=new In(D0,In.DEFAULT_COLLECTION_PERCENTILE,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),In.DISABLED=new In(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new el(0)}static lr(){return new el(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN="LruGarbageCollector",XD=1048576;function IN([n,e],[t,a]){const o=Fe(n,t);return o===0?Fe(e,a):o}class WD{constructor(e){this.Er=e,this.buffer=new Bt(IN),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();IN(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ZD{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){ve(SN,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){cl(t)?ve(SN,"Ignoring IndexedDB error during garbage collection: ",t):await ll(t)}await this.mr(3e5)})}}class JD{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(a=>Math.floor(t/100*a))}nthSequenceNumber(e,t){if(t===0)return le.resolve(Gh.le);const a=new WD(t);return this.gr.forEachTarget(e,o=>a.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>a.Rr(o))).next(()=>a.maxValue)}removeTargets(e,t,a){return this.gr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(CN)):this.getCacheSize(e).next(a=>a<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),CN):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let a,o,c,d,m,p,v;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(b=>(b>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),o=this.params.maximumSequenceNumbersToCollect):o=b,d=Date.now(),this.nthSequenceNumber(e,o))).next(b=>(a=b,m=Date.now(),this.removeTargets(e,a,t))).next(b=>(c=b,p=Date.now(),this.removeOrphanedDocuments(e,a))).next(b=>(v=Date.now(),Po()<=$e.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-_}ms
	Determined least recently used ${o} in `+(m-d)+`ms
	Removed ${c} targets in `+(p-m)+`ms
	Removed ${b} documents in `+(v-p)+`ms
Total Duration: ${v-_}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:b})))}}function eM(n,e){return new JD(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(){this.changes=new Lr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Wt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?le.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(e,t,a,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=o}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(a=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(a!==null&&Pc(a.mutation,o,Bn.empty(),qt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.getLocalViewOfDocuments(e,a,Ye()).next(()=>a))}getLocalViewOfDocuments(e,t,a=Ye()){const o=Tr();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,a).next(c=>{let d=Cc();return c.forEach((m,p)=>{d=d.insert(m,p.overlayedDocument)}),d}))}getOverlayedDocuments(e,t){const a=Tr();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,Ye()))}populateOverlays(e,t,a){const o=[];return a.forEach(c=>{t.has(c)||o.push(c)}),this.documentOverlayCache.getOverlays(e,o).next(c=>{c.forEach((d,m)=>{t.set(d,m)})})}computeViews(e,t,a,o){let c=Da();const d=kc(),m=function(){return kc()}();return t.forEach((p,v)=>{const _=a.get(v.key);o.has(v.key)&&(_===void 0||_.mutation instanceof Pi)?c=c.insert(v.key,v):_!==void 0?(d.set(v.key,_.mutation.getFieldMask()),Pc(_.mutation,v,_.mutation.getFieldMask(),qt.now())):d.set(v.key,Bn.empty())}),this.recalculateAndSaveOverlays(e,c).next(p=>(p.forEach((v,_)=>d.set(v,_)),t.forEach((v,_)=>{var b;return m.set(v,new nM(_,(b=d.get(v))!==null&&b!==void 0?b:null))}),m))}recalculateAndSaveOverlays(e,t){const a=kc();let o=new Nt((d,m)=>d-m),c=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(d=>{for(const m of d)m.keys().forEach(p=>{const v=t.get(p);if(v===null)return;let _=a.get(p)||Bn.empty();_=m.applyToLocalView(v,_),a.set(p,_);const b=(o.get(m.batchId)||Ye()).add(p);o=o.insert(m.batchId,b)})}).next(()=>{const d=[],m=o.getReverseIterator();for(;m.hasNext();){const p=m.getNext(),v=p.key,_=p.value,b=d0();_.forEach(T=>{if(!c.has(T)){const j=v0(t.get(T),a.get(T));j!==null&&b.set(T,j),c=c.add(T)}}),d.push(this.documentOverlayCache.saveOverlays(e,v,b))}return le.waitFor(d)}).next(()=>a)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.recalculateAndSaveOverlays(e,a))}getDocumentsMatchingQuery(e,t,a,o){return function(d){return Ee.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):r0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,o):this.getDocumentsMatchingCollectionQuery(e,t,a,o)}getNextDocuments(e,t,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,o).next(c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,o-c.size):le.resolve(Tr());let m=$c,p=c;return d.next(v=>le.forEach(v,(_,b)=>(m<b.largestBatchId&&(m=b.largestBatchId),c.get(_)?le.resolve():this.remoteDocumentCache.getEntry(e,_).next(T=>{p=p.insert(_,T)}))).next(()=>this.populateOverlays(e,v,c)).next(()=>this.computeViews(e,p,v,Ye())).next(_=>({batchId:m,changes:u0(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next(a=>{let o=Cc();return a.isFoundDocument()&&(o=o.insert(a.key,a)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,a,o){const c=t.collectionGroup;let d=Cc();return this.indexManager.getCollectionParents(e,c).next(m=>le.forEach(m,p=>{const v=function(b,T){return new ul(T,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)}(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,v,a,o).next(_=>{_.forEach((b,T)=>{d=d.insert(b,T)})})}).next(()=>d))}getDocumentsMatchingCollectionQuery(e,t,a,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next(d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,c,o))).next(d=>{c.forEach((p,v)=>{const _=v.getKey();d.get(_)===null&&(d=d.insert(_,Wt.newInvalidDocument(_)))});let m=Cc();return d.forEach((p,v)=>{const _=c.get(p);_!==void 0&&Pc(_.mutation,v,Bn.empty(),qt.now()),Qh(t,v)&&(m=m.insert(p,v))}),m})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return le.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:zn(o.createTime)}}(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:YD(o.bundledQuery),readTime:zn(o.readTime)}}(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(){this.overlays=new Nt(Ee.comparator),this.Qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const a=Tr();return le.forEach(t,o=>this.getOverlay(e,o).next(c=>{c!==null&&a.set(o,c)})).next(()=>a)}saveOverlays(e,t,a){return a.forEach((o,c)=>{this.St(e,t,c)}),le.resolve()}removeOverlaysForBatchId(e,t,a){const o=this.Qr.get(a);return o!==void 0&&(o.forEach(c=>this.overlays=this.overlays.remove(c)),this.Qr.delete(a)),le.resolve()}getOverlaysForCollection(e,t,a){const o=Tr(),c=t.length+1,d=new Ee(t.child("")),m=this.overlays.getIteratorFrom(d);for(;m.hasNext();){const p=m.getNext().value,v=p.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===c&&p.largestBatchId>a&&o.set(p.getKey(),p)}return le.resolve(o)}getOverlaysForCollectionGroup(e,t,a,o){let c=new Nt((v,_)=>v-_);const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>a){let _=c.get(v.largestBatchId);_===null&&(_=Tr(),c=c.insert(v.largestBatchId,_)),_.set(v.getKey(),v)}}const m=Tr(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((v,_)=>m.set(v,_)),!(m.size()>=o)););return le.resolve(m)}St(e,t,a){const o=this.overlays.get(a.key);if(o!==null){const d=this.Qr.get(o.largestBatchId).delete(a.key);this.Qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(a.key,new AD(t,a));let c=this.Qr.get(t);c===void 0&&(c=Ye(),this.Qr.set(t,c)),this.Qr.set(t,c.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(){this.sessionToken=ln.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(){this.$r=new Bt(Xt.Ur),this.Kr=new Bt(Xt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const a=new Xt(e,t);this.$r=this.$r.add(a),this.Kr=this.Kr.add(a)}Gr(e,t){e.forEach(a=>this.addReference(a,t))}removeReference(e,t){this.zr(new Xt(e,t))}jr(e,t){e.forEach(a=>this.removeReference(a,t))}Hr(e){const t=new Ee(new ft([])),a=new Xt(t,e),o=new Xt(t,e+1),c=[];return this.Kr.forEachInRange([a,o],d=>{this.zr(d),c.push(d.key)}),c}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new Ee(new ft([])),a=new Xt(t,e),o=new Xt(t,e+1);let c=Ye();return this.Kr.forEachInRange([a,o],d=>{c=c.add(d.key)}),c}containsKey(e){const t=new Xt(e,0),a=this.$r.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class Xt{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return Ee.comparator(e.key,t.key)||Fe(e.Zr,t.Zr)}static Wr(e,t){return Fe(e.Zr,t.Zr)||Ee.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Bt(Xt.Ur)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,o){const c=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new TD(c,t,a,o);this.mutationQueue.push(d);for(const m of o)this.Xr=this.Xr.add(new Xt(m.key,c)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return le.resolve(d)}lookupMutationBatch(e,t){return le.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,o=this.ti(a),c=o<0?0:o;return le.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?Hg:this.nr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new Xt(t,0),o=new Xt(t,Number.POSITIVE_INFINITY),c=[];return this.Xr.forEachInRange([a,o],d=>{const m=this.ei(d.Zr);c.push(m)}),le.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new Bt(Fe);return t.forEach(o=>{const c=new Xt(o,0),d=new Xt(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([c,d],m=>{a=a.add(m.Zr)})}),le.resolve(this.ni(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,o=a.length+1;let c=a;Ee.isDocumentKey(c)||(c=c.child(""));const d=new Xt(new Ee(c),0);let m=new Bt(Fe);return this.Xr.forEachWhile(p=>{const v=p.key.path;return!!a.isPrefixOf(v)&&(v.length===o&&(m=m.add(p.Zr)),!0)},d),le.resolve(this.ni(m))}ni(e){const t=[];return e.forEach(a=>{const o=this.ei(a);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Ze(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Xr;return le.forEach(t.mutations,o=>{const c=new Xt(o.key,t.batchId);return a=a.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=a})}sr(e){}containsKey(e,t){const a=new Xt(t,0),o=this.Xr.firstAfterOrEqual(a);return le.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lM{constructor(e){this.ii=e,this.docs=function(){return new Nt(Ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,o=this.docs.get(a),c=o?o.size:0,d=this.ii(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return le.resolve(a?a.document.mutableCopy():Wt.newInvalidDocument(t))}getEntries(e,t){let a=Da();return t.forEach(o=>{const c=this.docs.get(o);a=a.insert(o,c?c.document.mutableCopy():Wt.newInvalidDocument(o))}),le.resolve(a)}getDocumentsMatchingQuery(e,t,a,o){let c=Da();const d=t.path,m=new Ee(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(m);for(;p.hasNext();){const{key:v,value:{document:_}}=p.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||U1(V1(_),a)<=0||(o.has(_.key)||Qh(t,_))&&(c=c.insert(_.key,_.mutableCopy()))}return le.resolve(c)}getAllFromCollectionGroup(e,t,a,o){xe(9500)}si(e,t){return le.forEach(this.docs,a=>t(a))}newChangeBuffer(e){return new cM(this)}getSize(e){return le.resolve(this.size)}}class cM extends tM{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((a,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(a)}),le.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(e){this.persistence=e,this.oi=new Lr(t=>$g(t),Yg),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this._i=0,this.ai=new Zg,this.targetCount=0,this.ui=el.cr()}forEachTarget(e,t){return this.oi.forEach((a,o)=>t(o)),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this._i&&(this._i=t),le.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new el(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Tr(t),le.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,a){let o=0;const c=[];return this.oi.forEach((d,m)=>{m.sequenceNumber<=t&&a.get(m.targetId)===null&&(this.oi.delete(d),c.push(this.removeMatchingKeysForTargetId(e,m.targetId)),o++)}),le.waitFor(c).next(()=>o)}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const a=this.oi.get(t)||null;return le.resolve(a)}addMatchingKeys(e,t,a){return this.ai.Gr(t,a),le.resolve()}removeMatchingKeys(e,t,a){this.ai.jr(t,a);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach(d=>{c.push(o.markPotentiallyOrphaned(e,d))}),le.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const a=this.ai.Yr(t);return le.resolve(a)}containsKey(e,t){return le.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e,t){this.ci={},this.overlays={},this.li=new Gh(0),this.hi=!1,this.hi=!0,this.Pi=new rM,this.referenceDelegate=e(this),this.Ti=new uM(this),this.indexManager=new KD,this.remoteDocumentCache=function(o){return new lM(o)}(a=>this.referenceDelegate.Ii(a)),this.serializer=new $D(t),this.Ei=new aM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new iM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ci[e.toKey()];return a||(a=new oM(t,this.referenceDelegate),this.ci[e.toKey()]=a),a}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,a){ve("MemoryPersistence","Starting transaction:",e);const o=new dM(this.li.next());return this.referenceDelegate.di(),a(o).next(c=>this.referenceDelegate.Ai(o).next(()=>c)).toPromise().then(c=>(o.raiseOnCommittedEvent(),c))}Ri(e,t){return le.or(Object.values(this.ci).map(a=>()=>a.containsKey(e,t)))}}class dM extends q1{constructor(e){super(),this.currentSequenceNumber=e}}class Jg{constructor(e){this.persistence=e,this.Vi=new Zg,this.mi=null}static fi(e){return new Jg(e)}get gi(){if(this.mi)return this.mi;throw xe(60996)}addReference(e,t,a){return this.Vi.addReference(a,t),this.gi.delete(a.toString()),le.resolve()}removeReference(e,t,a){return this.Vi.removeReference(a,t),this.gi.add(a.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(c=>this.gi.add(c.toString()))}).next(()=>a.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.gi,a=>{const o=Ee.fromPath(a);return this.pi(e,o).next(c=>{c||t.removeEntry(o,we.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(a=>{a?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return le.or([()=>le.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Ch{constructor(e,t){this.persistence=e,this.yi=new Lr(a=>z1(a.path),(a,o)=>a.isEqual(o)),this.garbageCollector=eM(this,t)}static fi(e,t){return new Ch(e,t)}di(){}Ai(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(a=>t.next(o=>a+o))}br(e){let t=0;return this.yr(e,a=>{t++}).next(()=>t)}yr(e,t){return le.forEach(this.yi,(a,o)=>this.Dr(e,a,o).next(c=>c?le.resolve():t(o)))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.si(e,d=>this.Dr(e,d,t).next(m=>{m||(a++,c.removeEntry(d,we.min()))})).next(()=>c.apply(e)).next(()=>a)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}removeReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ih(e.data.value)),t}Dr(e,t,a){return le.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return le.resolve(o!==void 0&&o>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(e,t,a,o){this.targetId=e,this.fromCache=t,this.ds=a,this.As=o}static Rs(e,t){let a=Ye(),o=Ye();for(const c of t.docChanges)switch(c.type){case 0:a=a.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new ev(e,t.fromCache,a,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return GC()?8:B1(gn())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,a,o){const c={result:null};return this.ws(e,t).next(d=>{c.result=d}).next(()=>{if(!c.result)return this.bs(e,t,o,a).next(d=>{c.result=d})}).next(()=>{if(c.result)return;const d=new hM;return this.Ss(e,t,d).next(m=>{if(c.result=m,this.fs)return this.Ds(e,t,d,m.size)})}).next(()=>c.result)}Ds(e,t,a,o){return a.documentReadCount<this.gs?(Po()<=$e.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",Lo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),le.resolve()):(Po()<=$e.DEBUG&&ve("QueryEngine","Query:",Lo(t),"scans",a.documentReadCount,"local documents and returns",o,"documents as results."),a.documentReadCount>this.ps*o?(Po()<=$e.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",Lo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ys(t))):le.resolve())}ws(e,t){if(yN(t))return le.resolve(null);let a=Ys(t);return this.indexManager.getIndexType(e,a).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Th(t,null,"F"),a=Ys(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next(c=>{const d=Ye(...c);return this.ys.getDocuments(e,d).next(m=>this.indexManager.getMinOffset(e,a).next(p=>{const v=this.vs(t,m);return this.Cs(t,v,d,p.readTime)?this.ws(e,Th(t,null,"F")):this.Fs(e,v,t,p)}))})))}bs(e,t,a,o){return yN(t)||o.isEqual(we.min())?le.resolve(null):this.ys.getDocuments(e,a).next(c=>{const d=this.vs(t,c);return this.Cs(t,d,a,o)?le.resolve(null):(Po()<=$e.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Lo(t)),this.Fs(e,d,t,L1(o,$c)).next(m=>m))})}vs(e,t){let a=new Bt(l0(e));return t.forEach((o,c)=>{Qh(e,c)&&(a=a.add(c))}),a}Cs(e,t,a,o){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,a){return Po()<=$e.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",Lo(t)),this.ys.getDocumentsMatchingQuery(e,t,Ni.min(),a)}Fs(e,t,a,o){return this.ys.getDocumentsMatchingQuery(e,a,o).next(c=>(t.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tv="LocalStore",mM=3e8;class pM{constructor(e,t,a,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new Nt(Fe),this.Os=new Lr(c=>$g(c),Yg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(a)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sM(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function gM(n,e,t,a){return new pM(n,e,t,a)}async function O0(n,e){const t=De(n);return await t.persistence.runTransaction("Handle user change","readonly",a=>{let o;return t.mutationQueue.getAllMutationBatches(a).next(c=>(o=c,t.Ls(e),t.mutationQueue.getAllMutationBatches(a))).next(c=>{const d=[],m=[];let p=Ye();for(const v of o){d.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}for(const v of c){m.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}return t.localDocuments.getDocuments(a,p).next(v=>({ks:v,removedBatchIds:d,addedBatchIds:m}))})})}function vM(n,e){const t=De(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const o=e.batch.keys(),c=t.Bs.newChangeBuffer({trackRemovals:!0});return function(m,p,v,_){const b=v.batch,T=b.keys();let j=le.resolve();return T.forEach(x=>{j=j.next(()=>_.getEntry(p,x)).next(C=>{const w=v.docVersions.get(x);Ze(w!==null,48541),C.version.compareTo(w)<0&&(b.applyToRemoteDocument(C,v),C.isValidDocument()&&(C.setReadTime(v.commitVersion),_.addEntry(C)))})}),j.next(()=>m.mutationQueue.removeMutationBatch(p,b))}(t,a,e,c).next(()=>c.apply(a)).next(()=>t.mutationQueue.performConsistencyCheck(a)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(a,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,function(m){let p=Ye();for(let v=0;v<m.mutationResults.length;++v)m.mutationResults[v].transformResults.length>0&&(p=p.add(m.batch.mutations[v].key));return p}(e))).next(()=>t.localDocuments.getDocuments(a,o))})}function k0(n){const e=De(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function yM(n,e){const t=De(n),a=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const m=[];e.targetChanges.forEach((_,b)=>{const T=o.get(b);if(!T)return;m.push(t.Ti.removeMatchingKeys(c,_.removedDocuments,b).next(()=>t.Ti.addMatchingKeys(c,_.addedDocuments,b)));let j=T.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(b)!==null?j=j.withResumeToken(ln.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):_.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(_.resumeToken,a)),o=o.insert(b,j),function(C,w,F){return C.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=mM?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0}(T,j,_)&&m.push(t.Ti.updateTargetData(c,j))});let p=Da(),v=Ye();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(c,_))}),m.push(_M(c,d,e.documentUpdates).next(_=>{p=_.qs,v=_.Qs})),!a.isEqual(we.min())){const _=t.Ti.getLastRemoteSnapshotVersion(c).next(b=>t.Ti.setTargetsMetadata(c,c.currentSequenceNumber,a));m.push(_)}return le.waitFor(m).next(()=>d.apply(c)).next(()=>t.localDocuments.getLocalViewOfDocuments(c,p,v)).next(()=>p)}).then(c=>(t.xs=o,c))}function _M(n,e,t){let a=Ye(),o=Ye();return t.forEach(c=>a=a.add(c)),e.getEntries(n,a).next(c=>{let d=Da();return t.forEach((m,p)=>{const v=c.get(m);p.isFoundDocument()!==v.isFoundDocument()&&(o=o.add(m)),p.isNoDocument()&&p.version.isEqual(we.min())?(e.removeEntry(m,p.readTime),d=d.insert(m,p)):!v.isValidDocument()||p.version.compareTo(v.version)>0||p.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(p),d=d.insert(m,p)):ve(tv,"Ignoring outdated watch update for ",m,". Current version:",v.version," Watch version:",p.version)}),{qs:d,Qs:o}})}function bM(n,e){const t=De(n);return t.persistence.runTransaction("Get next mutation batch","readonly",a=>(e===void 0&&(e=Hg),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e)))}function EM(n,e){const t=De(n);return t.persistence.runTransaction("Allocate target","readwrite",a=>{let o;return t.Ti.getTargetData(a,e).next(c=>c?(o=c,le.resolve(o)):t.Ti.allocateTargetId(a).next(d=>(o=new gi(e,d,"TargetPurposeListen",a.currentSequenceNumber),t.Ti.addTargetData(a,o).next(()=>o))))}).then(a=>{const o=t.xs.get(a.targetId);return(o===null||a.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(a.targetId,a),t.Os.set(e,a.targetId)),a})}async function fg(n,e,t){const a=De(n),o=a.xs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",c,d=>a.persistence.referenceDelegate.removeTarget(d,o))}catch(d){if(!cl(d))throw d;ve(tv,`Failed to update sequence numbers for target ${e}: ${d}`)}a.xs=a.xs.remove(e),a.Os.delete(o.target)}function RN(n,e,t){const a=De(n);let o=we.min(),c=Ye();return a.persistence.runTransaction("Execute query","readwrite",d=>function(p,v,_){const b=De(p),T=b.Os.get(_);return T!==void 0?le.resolve(b.xs.get(T)):b.Ti.getTargetData(v,_)}(a,d,Ys(e)).next(m=>{if(m)return o=m.lastLimboFreeSnapshotVersion,a.Ti.getMatchingKeysForTargetId(d,m.targetId).next(p=>{c=p})}).next(()=>a.Ms.getDocumentsMatchingQuery(d,e,t?o:we.min(),t?c:Ye())).next(m=>(NM(a,cD(e),m),{documents:m,$s:c})))}function NM(n,e,t){let a=n.Ns.get(e)||we.min();t.forEach((o,c)=>{c.readTime.compareTo(a)>0&&(a=c.readTime)}),n.Ns.set(e,a)}class DN{constructor(){this.activeTargetIds=pD()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xM{constructor(){this.xo=new DN,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,a){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new DN,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TM{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN="ConnectivityMonitor";class ON{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){ve(MN,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){ve(MN,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xd=null;function mg(){return Xd===null?Xd=function(){return 268435456+Math.round(2147483648*Math.random())}():Xd++,"0x"+Xd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp="RestConnection",AM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class jM{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${a}/databases/${o}`,this.Go=this.databaseId.database===Eh?`project_id=${a}`:`project_id=${a}&database_id=${o}`}zo(e,t,a,o,c){const d=mg(),m=this.jo(e,t.toUriEncodedString());ve(Mp,`Sending RPC '${e}' ${d}:`,m,a);const p={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(p,o,c);const{host:v}=new URL(m),_=kr(v);return this.Jo(e,m,p,a,_).then(b=>(ve(Mp,`Received RPC '${e}' ${d}: `,b),b),b=>{throw Xo(Mp,`RPC '${e}' ${d} failed with error: `,b,"url: ",m,"request:",a),b})}Yo(e,t,a,o,c,d){return this.zo(e,t,a,o,c)}Ho(e,t,a){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ol}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,c)=>e[c]=o),a&&a.headers.forEach((o,c)=>e[c]=o)}jo(e,t){const a=AM[e];return`${this.Ko}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hn="WebChannelConnection";class CM extends jM{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,o,c){const d=mg();return new Promise((m,p)=>{const v=new kT;v.setWithCredentials(!0),v.listenOnce(PT.COMPLETE,()=>{try{switch(v.getLastErrorCode()){case ah.NO_ERROR:const b=v.getResponseJson();ve(hn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(b)),m(b);break;case ah.TIMEOUT:ve(hn,`RPC '${e}' ${d} timed out`),p(new me(re.DEADLINE_EXCEEDED,"Request time out"));break;case ah.HTTP_ERROR:const T=v.getStatus();if(ve(hn,`RPC '${e}' ${d} failed with status:`,T,"response text:",v.getResponseText()),T>0){let j=v.getResponseJson();Array.isArray(j)&&(j=j[0]);const x=j?.error;if(x&&x.status&&x.message){const C=function(F){const H=F.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf(H)>=0?H:re.UNKNOWN}(x.status);p(new me(C,x.message))}else p(new me(re.UNKNOWN,"Server responded with status "+v.getStatus()))}else p(new me(re.UNAVAILABLE,"Connection failed."));break;default:xe(9055,{h_:e,streamId:d,P_:v.getLastErrorCode(),T_:v.getLastError()})}}finally{ve(hn,`RPC '${e}' ${d} completed.`)}});const _=JSON.stringify(o);ve(hn,`RPC '${e}' ${d} sending request:`,o),v.send(t,"POST",_,a,15)})}I_(e,t,a){const o=mg(),c=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=UT(),m=VT(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(p.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Ho(p.initMessageHeaders,t,a),p.encodeInitMessageHeaders=!0;const _=c.join("");ve(hn,`Creating RPC '${e}' stream ${o}: ${_}`,p);const b=d.createWebChannel(_,p);this.E_(b);let T=!1,j=!1;const x=new wM({Zo:w=>{j?ve(hn,`Not sending because RPC '${e}' stream ${o} is closed:`,w):(T||(ve(hn,`Opening RPC '${e}' stream ${o} transport.`),b.open(),T=!0),ve(hn,`RPC '${e}' stream ${o} sending:`,w),b.send(w))},Xo:()=>b.close()}),C=(w,F,H)=>{w.listen(F,V=>{try{H(V)}catch(k){setTimeout(()=>{throw k},0)}})};return C(b,wc.EventType.OPEN,()=>{j||(ve(hn,`RPC '${e}' stream ${o} transport opened.`),x.__())}),C(b,wc.EventType.CLOSE,()=>{j||(j=!0,ve(hn,`RPC '${e}' stream ${o} transport closed`),x.u_(),this.d_(b))}),C(b,wc.EventType.ERROR,w=>{j||(j=!0,Xo(hn,`RPC '${e}' stream ${o} transport errored. Name:`,w.name,"Message:",w.message),x.u_(new me(re.UNAVAILABLE,"The operation could not be completed")))}),C(b,wc.EventType.MESSAGE,w=>{var F;if(!j){const H=w.data[0];Ze(!!H,16349);const V=H,k=V?.error||((F=V[0])===null||F===void 0?void 0:F.error);if(k){ve(hn,`RPC '${e}' stream ${o} received error:`,k);const U=k.status;let Q=function(P){const D=Ot[P];if(D!==void 0)return E0(D)}(U),L=k.message;Q===void 0&&(Q=re.INTERNAL,L="Unknown error status: "+U+" with message "+k.message),j=!0,x.u_(new me(Q,L)),b.close()}else ve(hn,`RPC '${e}' stream ${o} received:`,H),x.c_(H)}}),C(m,LT.STAT_EVENT,w=>{w.stat===sg.PROXY?ve(hn,`RPC '${e}' stream ${o} detected buffering proxy`):w.stat===sg.NOPROXY&&ve(hn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{x.a_()},0),x}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function Op(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ef(n){return new DD(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,t,a=1e3,o=1.5,c=6e4){this.xi=e,this.timerId=t,this.A_=a,this.R_=o,this.V_=c,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),a=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-a);o>0&&ve("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN="PersistentStream";class P0{constructor(e,t,a,o,c,d,m,p){this.xi=e,this.S_=a,this.D_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=m,this.listener=p,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new nv(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(Ra(t.toString()),Ra("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,o])=>{this.v_===t&&this.z_(a,o)},a=>{e(()=>{const o=new me(re.UNKNOWN,"Fetching auth token failed: "+a.message);return this.j_(o)})})}z_(e,t){const a=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{a(()=>this.listener.e_())}),this.stream.n_(()=>{a(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{a(()=>this.j_(o))}),this.stream.onMessage(o=>{a(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return ve(kN,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(ve(kN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class SM extends P0{constructor(e,t,a,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=PD(this.serializer,e),a=function(c){if(!("targetChange"in c))return we.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?we.min():d.readTime?zn(d.readTime):we.min()}(e);return this.listener.Y_(t,a)}Z_(e){const t={};t.database=hg(this.serializer),t.addTarget=function(c,d){let m;const p=d.target;if(m=lg(p)?{documents:VD(c,p)}:{query:UD(c,p).gt},m.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){m.resumeToken=T0(c,d.resumeToken);const v=ug(c,d.expectedCount);v!==null&&(m.expectedCount=v)}else if(d.snapshotVersion.compareTo(we.min())>0){m.readTime=jh(c,d.snapshotVersion.toTimestamp());const v=ug(c,d.expectedCount);v!==null&&(m.expectedCount=v)}return m}(this.serializer,e);const a=qD(this.serializer,e);a&&(t.labels=a),this.Q_(t)}X_(e){const t={};t.database=hg(this.serializer),t.removeTarget=e,this.Q_(t)}}class IM extends P0{constructor(e,t,a,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=LD(e.writeResults,e.commitTime),a=zn(e.commitTime);return this.listener.ra(a,t)}ia(){const e={};e.database=hg(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(a=>C0(this.serializer,a))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RM{}class DM extends RM{constructor(e,t,a,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new me(re.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,a,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.zo(e,dg(t,a),o,c,d)).catch(c=>{throw c.name==="FirebaseError"?(c.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new me(re.UNKNOWN,c.toString())})}Yo(e,t,a,o,c){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,m])=>this.connection.Yo(e,dg(t,a),o,d,m,c)).catch(d=>{throw d.name==="FirebaseError"?(d.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new me(re.UNKNOWN,d.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class MM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Ra(t),this.ua=!1):ve("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr="RemoteStore";class OM{constructor(e,t,a,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=c,this.Ra.No(d=>{a.enqueueAndForget(async()=>{Vr(this)&&(ve(Rr,"Restarting streams for network reachability change."),await async function(p){const v=De(p);v.da.add(4),await hu(v),v.Va.set("Unknown"),v.da.delete(4),await tf(v)}(this))})}),this.Va=new MM(a,o)}}async function tf(n){if(Vr(n))for(const e of n.Aa)await e(!0)}async function hu(n){for(const e of n.Aa)await e(!1)}function L0(n,e){const t=De(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),rv(t)?iv(t):dl(t).N_()&&av(t,e))}function sv(n,e){const t=De(n),a=dl(t);t.Ea.delete(e),a.N_()&&V0(t,e),t.Ea.size===0&&(a.N_()?a.k_():Vr(t)&&t.Va.set("Unknown"))}function av(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(we.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}dl(n).Z_(e)}function V0(n,e){n.ma.Ke(e),dl(n).X_(e)}function iv(n){n.ma=new CD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),dl(n).start(),n.Va.ca()}function rv(n){return Vr(n)&&!dl(n).O_()&&n.Ea.size>0}function Vr(n){return De(n).da.size===0}function U0(n){n.ma=void 0}async function kM(n){n.Va.set("Online")}async function PM(n){n.Ea.forEach((e,t)=>{av(n,e)})}async function LM(n,e){U0(n),rv(n)?(n.Va.Pa(e),iv(n)):n.Va.set("Unknown")}async function VM(n,e,t){if(n.Va.set("Online"),e instanceof x0&&e.state===2&&e.cause)try{await async function(o,c){const d=c.cause;for(const m of c.targetIds)o.Ea.has(m)&&(await o.remoteSyncer.rejectListen(m,d),o.Ea.delete(m),o.ma.removeTarget(m))}(n,e)}catch(a){ve(Rr,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await Sh(n,a)}else if(e instanceof lh?n.ma.Xe(e):e instanceof N0?n.ma.ot(e):n.ma.nt(e),!t.isEqual(we.min()))try{const a=await k0(n.localStore);t.compareTo(a)>=0&&await function(c,d){const m=c.ma.It(d);return m.targetChanges.forEach((p,v)=>{if(p.resumeToken.approximateByteSize()>0){const _=c.Ea.get(v);_&&c.Ea.set(v,_.withResumeToken(p.resumeToken,d))}}),m.targetMismatches.forEach((p,v)=>{const _=c.Ea.get(p);if(!_)return;c.Ea.set(p,_.withResumeToken(ln.EMPTY_BYTE_STRING,_.snapshotVersion)),V0(c,p);const b=new gi(_.target,p,v,_.sequenceNumber);av(c,b)}),c.remoteSyncer.applyRemoteEvent(m)}(n,t)}catch(a){ve(Rr,"Failed to raise snapshot:",a),await Sh(n,a)}}async function Sh(n,e,t){if(!cl(e))throw e;n.da.add(1),await hu(n),n.Va.set("Offline"),t||(t=()=>k0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ve(Rr,"Retrying IndexedDB access"),await t(),n.da.delete(1),await tf(n)})}function F0(n,e){return e().catch(t=>Sh(n,t,e))}async function nf(n){const e=De(n),t=ji(e);let a=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Hg;for(;UM(e);)try{const o=await bM(e.localStore,a);if(o===null){e.Ia.length===0&&t.k_();break}a=o.batchId,FM(e,o)}catch(o){await Sh(e,o)}q0(e)&&B0(e)}function UM(n){return Vr(n)&&n.Ia.length<10}function FM(n,e){n.Ia.push(e);const t=ji(n);t.N_()&&t.ea&&t.ta(e.mutations)}function q0(n){return Vr(n)&&!ji(n).O_()&&n.Ia.length>0}function B0(n){ji(n).start()}async function qM(n){ji(n).ia()}async function BM(n){const e=ji(n);for(const t of n.Ia)e.ta(t.mutations)}async function HM(n,e,t){const a=n.Ia.shift(),o=Qg.from(a,e,t);await F0(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await nf(n)}async function zM(n,e){e&&ji(n).ea&&await async function(a,o){if(function(d){return b0(d)&&d!==re.ABORTED}(o.code)){const c=a.Ia.shift();ji(a).L_(),await F0(a,()=>a.remoteSyncer.rejectFailedWrite(c.batchId,o)),await nf(a)}}(n,e),q0(n)&&B0(n)}async function PN(n,e){const t=De(n);t.asyncQueue.verifyOperationInProgress(),ve(Rr,"RemoteStore received new credentials");const a=Vr(t);t.da.add(3),await hu(t),a&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await tf(t)}async function GM(n,e){const t=De(n);e?(t.da.delete(2),await tf(t)):e||(t.da.add(2),await hu(t),t.Va.set("Unknown"))}function dl(n){return n.fa||(n.fa=function(t,a,o){const c=De(t);return c.oa(),new SM(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:kM.bind(null,n),n_:PM.bind(null,n),i_:LM.bind(null,n),Y_:VM.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),rv(n)?iv(n):n.Va.set("Unknown")):(await n.fa.stop(),U0(n))})),n.fa}function ji(n){return n.ga||(n.ga=function(t,a,o){const c=De(t);return c.oa(),new IM(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:qM.bind(null,n),i_:zM.bind(null,n),na:BM.bind(null,n),ra:HM.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await nf(n)):(await n.ga.stop(),n.Ia.length>0&&(ve(Rr,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,t,a,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=o,this.removalCallback=c,this.deferred=new $s,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,o,c){const d=Date.now()+a,m=new ov(e,t,d,o,c);return m.start(a),m}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function lv(n,e){if(Ra("AsyncQueue",`${e}: ${n}`),cl(n))return new me(re.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{static emptySet(e){return new Yo(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||Ee.comparator(t.key,a.key):(t,a)=>Ee.comparator(t.key,a.key),this.keyedMap=Cc(),this.sortedSet=new Nt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,a)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Yo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new Yo;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(){this.pa=new Nt(Ee.comparator)}track(e){const t=e.doc.key,a=this.pa.get(t);a?e.type!==0&&a.type===3?this.pa=this.pa.insert(t,e):e.type===3&&a.type!==1?this.pa=this.pa.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.pa=this.pa.remove(t):e.type===1&&a.type===2?this.pa=this.pa.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):xe(63341,{Vt:e,ya:a}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,a)=>{e.push(a)}),e}}class tl{constructor(e,t,a,o,c,d,m,p,v){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=m,this.excludesMetadataChanges=p,this.hasCachedResults=v}static fromInitialDocuments(e,t,a,o,c){const d=[];return t.forEach(m=>{d.push({type:0,doc:m})}),new tl(e,t,Yo.emptySet(t),d,a,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==a[o].type||!t[o].doc.isEqual(a[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class YM{constructor(){this.queries=VN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const o=De(t),c=o.queries;o.queries=VN(),c.forEach((d,m)=>{for(const p of m.Sa)p.onError(a)})})(this,new me(re.ABORTED,"Firestore shutting down"))}}function VN(){return new Lr(n=>o0(n),Kh)}async function cv(n,e){const t=De(n);let a=3;const o=e.query;let c=t.queries.get(o);c?!c.Da()&&e.va()&&(a=2):(c=new $M,a=e.va()?0:1);try{switch(a){case 0:c.ba=await t.onListen(o,!0);break;case 1:c.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const m=lv(d,`Initialization of query '${Lo(e.query)}' failed`);return void e.onError(m)}t.queries.set(o,c),c.Sa.push(e),e.Fa(t.onlineState),c.ba&&e.Ma(c.ba)&&dv(t)}async function uv(n,e){const t=De(n),a=e.query;let o=3;const c=t.queries.get(a);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.va()?0:1:!c.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function KM(n,e){const t=De(n);let a=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const m of d.Sa)m.Ma(o)&&(a=!0);d.ba=o}}a&&dv(t)}function QM(n,e,t){const a=De(n),o=a.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);a.queries.delete(e)}function dv(n){n.Ca.forEach(e=>{e.next()})}var pg,UN;(UN=pg||(pg={})).xa="default",UN.Cache="cache";class hv{constructor(e,t,a){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=a||{}}Ma(e){if(!this.options.includeMetadataChanges){const a=[];for(const o of e.docChanges)o.type!==3&&a.push(o);e=new tl(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const a=t!=="Offline";return(!this.options.Qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=tl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==pg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(e){this.key=e}}class z0{constructor(e){this.key=e}}class XM{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ye(),this.mutatedKeys=Ye(),this.Za=l0(e),this.Xa=new Yo(this.Za)}get eu(){return this.Ha}tu(e,t){const a=t?t.nu:new LN,o=t?t.Xa:this.Xa;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,m=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,v=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((_,b)=>{const T=o.get(_),j=Qh(this.query,b)?b:null,x=!!T&&this.mutatedKeys.has(T.key),C=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let w=!1;T&&j?T.data.isEqual(j.data)?x!==C&&(a.track({type:3,doc:j}),w=!0):this.ru(T,j)||(a.track({type:2,doc:j}),w=!0,(p&&this.Za(j,p)>0||v&&this.Za(j,v)<0)&&(m=!0)):!T&&j?(a.track({type:0,doc:j}),w=!0):T&&!j&&(a.track({type:1,doc:T}),w=!0,(p||v)&&(m=!0)),w&&(j?(d=d.add(j),c=C?c.add(_):c.delete(_)):(d=d.delete(_),c=c.delete(_)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const _=this.query.limitType==="F"?d.last():d.first();d=d.delete(_.key),c=c.delete(_.key),a.track({type:1,doc:_})}return{Xa:d,nu:a,Cs:m,mutatedKeys:c}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,o){const c=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const d=e.nu.wa();d.sort((_,b)=>function(j,x){const C=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xe(20277,{Vt:w})}};return C(j)-C(x)}(_.type,b.type)||this.Za(_.doc,b.doc)),this.iu(a),o=o!=null&&o;const m=t&&!o?this.su():[],p=this.Ya.size===0&&this.current&&!o?1:0,v=p!==this.Ja;return this.Ja=p,d.length!==0||v?{snapshot:new tl(this.query,e.Xa,c,d,e.mutatedKeys,p===0,v,!1,!!a&&a.resumeToken.approximateByteSize()>0),ou:m}:{ou:m}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new LN,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Ye(),this.Xa.forEach(a=>{this._u(a.key)&&(this.Ya=this.Ya.add(a.key))});const t=[];return e.forEach(a=>{this.Ya.has(a)||t.push(new z0(a))}),this.Ya.forEach(a=>{e.has(a)||t.push(new H0(a))}),t}au(e){this.Ha=e.$s,this.Ya=Ye();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return tl.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const fv="SyncEngine";class WM{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class ZM{constructor(e){this.key=e,this.cu=!1}}class JM{constructor(e,t,a,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.lu={},this.hu=new Lr(m=>o0(m),Kh),this.Pu=new Map,this.Tu=new Set,this.Iu=new Nt(Ee.comparator),this.Eu=new Map,this.du=new Zg,this.Au={},this.Ru=new Map,this.Vu=el.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function eO(n,e,t=!0){const a=X0(n);let o;const c=a.hu.get(e);return c?(a.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.uu()):o=await G0(a,e,t,!0),o}async function tO(n,e){const t=X0(n);await G0(t,e,!0,!1)}async function G0(n,e,t,a){const o=await EM(n.localStore,Ys(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let m;return a&&(m=await nO(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&L0(n.remoteStore,o),m}async function nO(n,e,t,a,o){n.fu=(b,T,j)=>async function(C,w,F,H){let V=w.view.tu(F);V.Cs&&(V=await RN(C.localStore,w.query,!1).then(({documents:L})=>w.view.tu(L,V)));const k=H&&H.targetChanges.get(w.targetId),U=H&&H.targetMismatches.get(w.targetId)!=null,Q=w.view.applyChanges(V,C.isPrimaryClient,k,U);return qN(C,w.targetId,Q.ou),Q.snapshot}(n,b,T,j);const c=await RN(n.localStore,e,!0),d=new XM(e,c.$s),m=d.tu(c.documents),p=du.createSynthesizedTargetChangeForCurrentChange(t,a&&n.onlineState!=="Offline",o),v=d.applyChanges(m,n.isPrimaryClient,p);qN(n,t,v.ou);const _=new WM(e,t,d);return n.hu.set(e,_),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),v.snapshot}async function sO(n,e,t){const a=De(n),o=a.hu.get(e),c=a.Pu.get(o.targetId);if(c.length>1)return a.Pu.set(o.targetId,c.filter(d=>!Kh(d,e))),void a.hu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(o.targetId),a.sharedClientState.isActiveQueryTarget(o.targetId)||await fg(a.localStore,o.targetId,!1).then(()=>{a.sharedClientState.clearQueryState(o.targetId),t&&sv(a.remoteStore,o.targetId),gg(a,o.targetId)}).catch(ll)):(gg(a,o.targetId),await fg(a.localStore,o.targetId,!0))}async function aO(n,e){const t=De(n),a=t.hu.get(e),o=t.Pu.get(a.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),sv(t.remoteStore,a.targetId))}async function iO(n,e,t){const a=hO(n);try{const o=await function(d,m){const p=De(d),v=qt.now(),_=m.reduce((j,x)=>j.add(x.key),Ye());let b,T;return p.persistence.runTransaction("Locally write mutations","readwrite",j=>{let x=Da(),C=Ye();return p.Bs.getEntries(j,_).next(w=>{x=w,x.forEach((F,H)=>{H.isValidDocument()||(C=C.add(F))})}).next(()=>p.localDocuments.getOverlayedDocuments(j,x)).next(w=>{b=w;const F=[];for(const H of m){const V=xD(H,b.get(H.key).overlayedDocument);V!=null&&F.push(new Pi(H.key,V,JT(V.value.mapValue),rn.exists(!0)))}return p.mutationQueue.addMutationBatch(j,v,F,m)}).next(w=>{T=w;const F=w.applyToLocalDocumentSet(b,C);return p.documentOverlayCache.saveOverlays(j,w.batchId,F)})}).then(()=>({batchId:T.batchId,changes:u0(b)}))}(a.localStore,e);a.sharedClientState.addPendingMutation(o.batchId),function(d,m,p){let v=d.Au[d.currentUser.toKey()];v||(v=new Nt(Fe)),v=v.insert(m,p),d.Au[d.currentUser.toKey()]=v}(a,o.batchId,t),await fu(a,o.changes),await nf(a.remoteStore)}catch(o){const c=lv(o,"Failed to persist write");t.reject(c)}}async function $0(n,e){const t=De(n);try{const a=await yM(t.localStore,e);e.targetChanges.forEach((o,c)=>{const d=t.Eu.get(c);d&&(Ze(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.cu=!0:o.modifiedDocuments.size>0?Ze(d.cu,14607):o.removedDocuments.size>0&&(Ze(d.cu,42227),d.cu=!1))}),await fu(t,a,e)}catch(a){await ll(a)}}function FN(n,e,t){const a=De(n);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const o=[];a.hu.forEach((c,d)=>{const m=d.view.Fa(e);m.snapshot&&o.push(m.snapshot)}),function(d,m){const p=De(d);p.onlineState=m;let v=!1;p.queries.forEach((_,b)=>{for(const T of b.Sa)T.Fa(m)&&(v=!0)}),v&&dv(p)}(a.eventManager,e),o.length&&a.lu.Y_(o),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function rO(n,e,t){const a=De(n);a.sharedClientState.updateQueryState(e,"rejected",t);const o=a.Eu.get(e),c=o&&o.key;if(c){let d=new Nt(Ee.comparator);d=d.insert(c,Wt.newNoDocument(c,we.min()));const m=Ye().add(c),p=new Jh(we.min(),new Map,new Nt(Fe),d,m);await $0(a,p),a.Iu=a.Iu.remove(c),a.Eu.delete(e),mv(a)}else await fg(a.localStore,e,!1).then(()=>gg(a,e,t)).catch(ll)}async function oO(n,e){const t=De(n),a=e.batch.batchId;try{const o=await vM(t.localStore,e);K0(t,a,null),Y0(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await fu(t,o)}catch(o){await ll(o)}}async function lO(n,e,t){const a=De(n);try{const o=await function(d,m){const p=De(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",v=>{let _;return p.mutationQueue.lookupMutationBatch(v,m).next(b=>(Ze(b!==null,37113),_=b.keys(),p.mutationQueue.removeMutationBatch(v,b))).next(()=>p.mutationQueue.performConsistencyCheck(v)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(v,_,m)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,_)).next(()=>p.localDocuments.getDocuments(v,_))})}(a.localStore,e);K0(a,e,t),Y0(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await fu(a,o)}catch(o){await ll(o)}}function Y0(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function K0(n,e,t){const a=De(n);let o=a.Au[a.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),a.Au[a.currentUser.toKey()]=o}}function gg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const a of n.Pu.get(e))n.hu.delete(a),t&&n.lu.gu(a,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(a=>{n.du.containsKey(a)||Q0(n,a)})}function Q0(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(sv(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),mv(n))}function qN(n,e,t){for(const a of t)a instanceof H0?(n.du.addReference(a.key,e),cO(n,a)):a instanceof z0?(ve(fv,"Document no longer in limbo: "+a.key),n.du.removeReference(a.key,e),n.du.containsKey(a.key)||Q0(n,a.key)):xe(19791,{pu:a})}function cO(n,e){const t=e.key,a=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(a)||(ve(fv,"New document in limbo: "+t),n.Tu.add(a),mv(n))}function mv(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new Ee(ft.fromString(e)),a=n.Vu.next();n.Eu.set(a,new ZM(t)),n.Iu=n.Iu.insert(t,a),L0(n.remoteStore,new gi(Ys(Yh(t.path)),a,"TargetPurposeLimboResolution",Gh.le))}}async function fu(n,e,t){const a=De(n),o=[],c=[],d=[];a.hu.isEmpty()||(a.hu.forEach((m,p)=>{d.push(a.fu(p,e,t).then(v=>{var _;if((v||t)&&a.isPrimaryClient){const b=v?!v.fromCache:(_=t?.targetChanges.get(p.targetId))===null||_===void 0?void 0:_.current;a.sharedClientState.updateQueryState(p.targetId,b?"current":"not-current")}if(v){o.push(v);const b=ev.Rs(p.targetId,v);c.push(b)}}))}),await Promise.all(d),a.lu.Y_(o),await async function(p,v){const _=De(p);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",b=>le.forEach(v,T=>le.forEach(T.ds,j=>_.persistence.referenceDelegate.addReference(b,T.targetId,j)).next(()=>le.forEach(T.As,j=>_.persistence.referenceDelegate.removeReference(b,T.targetId,j)))))}catch(b){if(!cl(b))throw b;ve(tv,"Failed to update sequence numbers: "+b)}for(const b of v){const T=b.targetId;if(!b.fromCache){const j=_.xs.get(T),x=j.snapshotVersion,C=j.withLastLimboFreeSnapshotVersion(x);_.xs=_.xs.insert(T,C)}}}(a.localStore,c))}async function uO(n,e){const t=De(n);if(!t.currentUser.isEqual(e)){ve(fv,"User change. New user:",e.toKey());const a=await O0(t.localStore,e);t.currentUser=e,function(c,d){c.Ru.forEach(m=>{m.forEach(p=>{p.reject(new me(re.CANCELLED,d))})}),c.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await fu(t,a.ks)}}function dO(n,e){const t=De(n),a=t.Eu.get(e);if(a&&a.cu)return Ye().add(a.key);{let o=Ye();const c=t.Pu.get(e);if(!c)return o;for(const d of c){const m=t.hu.get(d);o=o.unionWith(m.view.eu)}return o}}function X0(n){const e=De(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=$0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=dO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rO.bind(null,e),e.lu.Y_=KM.bind(null,e.eventManager),e.lu.gu=QM.bind(null,e.eventManager),e}function hO(n){const e=De(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=oO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lO.bind(null,e),e}class Ih{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ef(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return gM(this.persistence,new fM,e.initialUser,this.serializer)}Su(e){return new M0(Jg.fi,this.serializer)}bu(e){return new xM}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ih.provider={build:()=>new Ih};class fO extends Ih{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Ze(this.persistence.referenceDelegate instanceof Ch,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new ZD(a,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?In.withCacheSize(this.cacheSizeBytes):In.DEFAULT;return new M0(a=>Ch.fi(a,t),this.serializer)}}class vg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>FN(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=uO.bind(null,this.syncEngine),await GM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new YM}()}createDatastore(e){const t=ef(e.databaseInfo.databaseId),a=function(c){return new CM(c)}(e.databaseInfo);return function(c,d,m,p){return new DM(c,d,m,p)}(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return function(a,o,c,d,m){return new OM(a,o,c,d,m)}(this.localStore,this.datastore,e.asyncQueue,t=>FN(this.syncEngine,t,0),function(){return ON.C()?new ON:new TM}())}createSyncEngine(e,t){return function(o,c,d,m,p,v,_){const b=new JM(o,c,d,m,p,v);return _&&(b.mu=!0),b}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const c=De(o);ve(Rr,"RemoteStore shutting down."),c.da.add(5),await hu(c),c.Ra.shutdown(),c.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}vg.provider={build:()=>new vg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Ra("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new me(re.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,c){const d=De(o),m={documents:c.map(b=>wh(d.serializer,b))},p=await d.Yo("BatchGetDocuments",d.serializer.databaseId,ft.emptyPath(),m,c.length),v=new Map;p.forEach(b=>{const T=kD(d.serializer,b);v.set(T.key.toString(),T)});const _=[];return c.forEach(b=>{const T=v.get(b.toString());Ze(!!T,55234,{key:b}),_.push(T)}),_}(this.datastore,e);return t.forEach(a=>this.recordVersion(a)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(a){this.lastTransactionError=a}this.writtenDocs.add(e.toString())}delete(e){this.write(new Zh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,a)=>{const o=Ee.fromPath(a);this.mutations.push(new _0(o,this.precondition(o)))}),await async function(a,o){const c=De(a),d={writes:o.map(m=>C0(c.serializer,m))};await c.zo("Commit",c.serializer.databaseId,ft.emptyPath(),d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw xe(50498,{Uu:e.constructor.name});t=we.min()}const a=this.readVersions.get(e.key.toString());if(a){if(!t.isEqual(a))throw new me(re.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(we.min())?rn.exists(!1):rn.updateTime(t):rn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(we.min()))throw new me(re.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rn.updateTime(t)}return rn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e,t,a,o,c){this.asyncQueue=e,this.datastore=t,this.options=a,this.updateFunction=o,this.deferred=c,this.Ku=a.maxAttempts,this.x_=new nv(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new mO(this.datastore),t=this.zu(e);t&&t.then(a=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(a)}).catch(o=>{this.ju(o)}))}).catch(a=>{this.ju(a)})})}zu(e){try{const t=this.updateFunction(e);return!cu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!b0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi="FirestoreClient";class gO{constructor(e,t,a,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=o,this.user=fn.UNAUTHENTICATED,this.clientId=HT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(a,async d=>{ve(wi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(a,d=>(ve(wi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $s;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=lv(t,"Failed to shutdown persistence");e.reject(a)}}),e.promise}}async function kp(n,e){n.asyncQueue.verifyOperationInProgress(),ve(wi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let a=t.initialUser;n.setCredentialChangeListener(async o=>{a.isEqual(o)||(await O0(e.localStore,o),a=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function BN(n,e){n.asyncQueue.verifyOperationInProgress();const t=await vO(n);ve(wi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(a=>PN(e.remoteStore,a)),n.setAppCheckTokenChangeListener((a,o)=>PN(e.remoteStore,o)),n._onlineComponents=e}async function vO(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ve(wi,"Using user provided OfflineComponentProvider");try{await kp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===re.FAILED_PRECONDITION||o.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Xo("Error using user provided cache. Falling back to memory cache: "+t),await kp(n,new Ih)}}else ve(wi,"Using default OfflineComponentProvider"),await kp(n,new fO(void 0));return n._offlineComponents}async function gv(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ve(wi,"Using user provided OnlineComponentProvider"),await BN(n,n._uninitializedComponentsProvider._online)):(ve(wi,"Using default OnlineComponentProvider"),await BN(n,new vg))),n._onlineComponents}function yO(n){return gv(n).then(e=>e.syncEngine)}function _O(n){return gv(n).then(e=>e.datastore)}async function Rh(n){const e=await gv(n),t=e.eventManager;return t.onListen=eO.bind(null,e.syncEngine),t.onUnlisten=sO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=tO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=aO.bind(null,e.syncEngine),t}function bO(n,e,t={}){const a=new $s;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,m,p,v){const _=new pv({next:T=>{_.xu(),d.enqueueAndForget(()=>uv(c,b));const j=T.docs.has(m);!j&&T.fromCache?v.reject(new me(re.UNAVAILABLE,"Failed to get document because the client is offline.")):j&&T.fromCache&&p&&p.source==="server"?v.reject(new me(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(T)},error:T=>v.reject(T)}),b=new hv(Yh(m.path),_,{includeMetadataChanges:!0,Qa:!0});return cv(c,b)}(await Rh(n),n.asyncQueue,e,t,a)),a.promise}function EO(n,e,t={}){const a=new $s;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,m,p,v){const _=new pv({next:T=>{_.xu(),d.enqueueAndForget(()=>uv(c,b)),T.fromCache&&p.source==="server"?v.reject(new me(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(T)},error:T=>v.reject(T)}),b=new hv(m,_,{includeMetadataChanges:!0,Qa:!0});return cv(c,b)}(await Rh(n),n.asyncQueue,e,t,a)),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z0(n,e,t){if(!t)throw new me(re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function NO(n,e,t,a){if(e===!0&&a===!0)throw new me(re.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function zN(n){if(!Ee.isDocumentKey(n))throw new me(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function GN(n){if(Ee.isDocumentKey(n))throw new me(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function sf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(a){return a.constructor?a.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":xe(12329,{type:typeof n})}function Tn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=sf(n);throw new me(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0="firestore.googleapis.com",$N=!0;class YN{constructor(e){var t,a;if(e.host===void 0){if(e.ssl!==void 0)throw new me(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=J0,this.ssl=$N}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:$N;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=D0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<XD)throw new me(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}NO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=W0((a=e.experimentalLongPollingOptions)!==null&&a!==void 0?a:{}),function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new me(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(a,o){return a.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class af{constructor(e,t,a,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new YN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new YN(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(a){if(!a)return new C1;switch(a.type){case"firstParty":return new D1(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new me(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const a=HN.get(t);a&&(ve("ComponentProvider","Removing Datastore"),HN.delete(t),a.terminate())}(this),Promise.resolve()}}function xO(n,e,t,a={}){var o;n=Tn(n,af);const c=kr(e),d=n._getSettings(),m=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),p=`${e}:${t}`;c&&(jg(`https://${p}`),wg("Firestore",!0)),d.host!==J0&&d.host!==p&&Xo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:p,ssl:c,emulatorOptions:a});if(!Ei(v,m)&&(n._setSettings(v),a.mockUserToken)){let _,b;if(typeof a.mockUserToken=="string")_=a.mockUserToken,b=fn.MOCK_USER;else{_=Kx(a.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const T=a.mockUserToken.sub||a.mockUserToken.user_id;if(!T)throw new me(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new fn(T)}n._authCredentials=new S1(new qT(_,b))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Oa(this.firestore,e,this._query)}}class on{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new bi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new on(this.firestore,e,this._key)}}class bi extends Oa{constructor(e,t,a){super(e,t,Yh(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new on(this.firestore,null,new Ee(e))}withConverter(e){return new bi(this.firestore,e,this._path)}}function Pe(n,e,...t){if(n=vt(n),Z0("collection","path",e),n instanceof af){const a=ft.fromString(e,...t);return GN(a),new bi(n,null,a)}{if(!(n instanceof on||n instanceof bi))throw new me(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ft.fromString(e,...t));return GN(a),new bi(n.firestore,null,a)}}function st(n,e,...t){if(n=vt(n),arguments.length===1&&(e=HT.newId()),Z0("doc","path",e),n instanceof af){const a=ft.fromString(e,...t);return zN(a),new on(n,null,new Ee(a))}{if(!(n instanceof on||n instanceof bi))throw new me(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ft.fromString(e,...t));return zN(a),new on(n.firestore,n instanceof bi?n.converter:null,new Ee(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KN="AsyncQueue";class QN{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new nv(this,"async_queue_retry"),this.rc=()=>{const a=Op();a&&ve(KN,"Visibility state changed to "+a.visibilityState),this.x_.b_()},this.sc=e;const t=Op();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Op();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new $s;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!cl(e))throw e;ve(KN,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(a=>{throw this.Xu=a,this.ec=!1,Ra("INTERNAL UNHANDLED ERROR: ",XN(a)),a}).then(a=>(this.ec=!1,a))));return this.sc=t,t}enqueueAfterDelay(e,t,a){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=ov.createAndSchedule(this,e,t,a,c=>this.uc(c));return this.Zu.push(o),o}oc(){this.Xu&&xe(47125,{cc:XN(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,a)=>t.targetTimeMs-a.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function XN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WN(n){return function(t,a){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of a)if(c in o&&typeof o[c]=="function")return!0;return!1}(n,["next","error","complete"])}class Qs extends af{constructor(e,t,a,o){super(e,t,a,o),this.type="firestore",this._queue=new QN,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new QN(e),this._firestoreClient=void 0,await e}}}function TO(n,e){const t=typeof n=="object"?n:au(),a=typeof n=="string"?n:Eh,o=Ma(t,"firestore").getImmediate({identifier:a});if(!o._initialized){const c=Gx("firestore");c&&xO(o,...c)}return o}function mu(n){if(n._terminated)throw new me(re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||AO(n),n._firestoreClient}function AO(n){var e,t,a;const o=n._freezeSettings(),c=function(m,p,v,_){return new Y1(m,p,v,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,W0(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((a=o.localCache)===null||a===void 0)&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new gO(n._authCredentials,n._appCheckCredentials,n._queue,c,n._componentsProvider&&function(m){const p=m?._online.build();return{_offline:m?._offline.build(p),_online:p}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dr(ln.fromBase64String(e))}catch(t){throw new me(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Dr(ln.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new an(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Fe(this._lat,e._lat)||Fe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(a,o){if(a.length!==o.length)return!1;for(let c=0;c<a.length;++c)if(a[c]!==o[c])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO=/^__.*__$/;class wO{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new Pi(e,this.data,this.fieldMask,t,this.fieldTransforms):new uu(e,this.data,t,this.fieldTransforms)}}class eA{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return new Pi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function tA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xe(40011,{Ic:n})}}class _v{constructor(e,t,a,o,c,d){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=o,c===void 0&&this.Ec(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new _v(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Vc(e),o}mc(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Dh(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(tA(this.Ic)&&jO.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class CO{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||ef(e)}bc(e,t,a,o=!1){return new _v({Ic:e,methodName:t,wc:a,path:an.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gu(n){const e=n._freezeSettings(),t=ef(n._databaseId);return new CO(n._databaseId,!!e.ignoreUndefinedProperties,t)}function bv(n,e,t,a,o,c={}){const d=n.bc(c.merge||c.mergeFields?2:0,e,t,o);Nv("Data must be an object, but it was:",d,a);const m=aA(a,d);let p,v;if(c.merge)p=new Bn(d.fieldMask),v=d.fieldTransforms;else if(c.mergeFields){const _=[];for(const b of c.mergeFields){const T=yg(e,b,t);if(!d.contains(T))throw new me(re.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);rA(_,T)||_.push(T)}p=new Bn(_),v=d.fieldTransforms.filter(b=>p.covers(b.field))}else p=null,v=d.fieldTransforms;return new wO(new xn(m),p,v)}class of extends rf{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof of}}class Ev extends rf{_toFieldTransform(e){return new _D(e.path,new Wc)}isEqual(e){return e instanceof Ev}}function nA(n,e,t,a){const o=n.bc(1,e,t);Nv("Data must be an object, but it was:",o,a);const c=[],d=xn.empty();ki(a,(p,v)=>{const _=xv(e,p,t);v=vt(v);const b=o.mc(_);if(v instanceof of)c.push(_);else{const T=vu(v,b);T!=null&&(c.push(_),d.set(_,T))}});const m=new Bn(c);return new eA(d,m,o.fieldTransforms)}function sA(n,e,t,a,o,c){const d=n.bc(1,e,t),m=[yg(e,a,t)],p=[o];if(c.length%2!=0)throw new me(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<c.length;T+=2)m.push(yg(e,c[T])),p.push(c[T+1]);const v=[],_=xn.empty();for(let T=m.length-1;T>=0;--T)if(!rA(v,m[T])){const j=m[T];let x=p[T];x=vt(x);const C=d.mc(j);if(x instanceof of)v.push(j);else{const w=vu(x,C);w!=null&&(v.push(j),_.set(j,w))}}const b=new Bn(v);return new eA(_,b,d.fieldTransforms)}function SO(n,e,t,a=!1){return vu(t,n.bc(a?4:3,e))}function vu(n,e){if(iA(n=vt(n)))return Nv("Unsupported field value:",e,n),aA(n,e);if(n instanceof rf)return function(a,o){if(!tA(o.Ic))throw o.gc(`${a._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${a._methodName}() is not currently supported inside arrays`);const c=a._toFieldTransform(o);c&&o.fieldTransforms.push(c)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(a,o){const c=[];let d=0;for(const m of a){let p=vu(m,o.fc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}}(n,e)}return function(a,o){if((a=vt(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return gD(o.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const c=qt.fromDate(a);return{timestampValue:jh(o.serializer,c)}}if(a instanceof qt){const c=new qt(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:jh(o.serializer,c)}}if(a instanceof vv)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof Dr)return{bytesValue:T0(o.serializer,a._byteString)};if(a instanceof on){const c=o.databaseId,d=a.firestore._databaseId;if(!d.isEqual(c))throw o.gc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Wg(a.firestore._databaseId||o.databaseId,a._key.path)}}if(a instanceof yv)return function(d,m){return{mapValue:{fields:{[WT]:{stringValue:ZT},[Nh]:{arrayValue:{values:d.toArray().map(v=>{if(typeof v!="number")throw m.gc("VectorValues must only contain numeric values.");return Kg(m.serializer,v)})}}}}}}(a,o);throw o.gc(`Unsupported field value: ${sf(a)}`)}(n,e)}function aA(n,e){const t={};return GT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ki(n,(a,o)=>{const c=vu(o,e.Ac(a));c!=null&&(t[a]=c)}),{mapValue:{fields:t}}}function iA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qt||n instanceof vv||n instanceof Dr||n instanceof on||n instanceof rf||n instanceof yv)}function Nv(n,e,t){if(!iA(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const a=sf(t);throw a==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+a)}}function yg(n,e,t){if((e=vt(e))instanceof pu)return e._internalPath;if(typeof e=="string")return xv(n,e);throw Dh("Field path arguments must be of type string or ",n,!1,void 0,t)}const IO=new RegExp("[~\\*/\\[\\]]");function xv(n,e,t){if(e.search(IO)>=0)throw Dh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new pu(...e.split("."))._internalPath}catch{throw Dh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Dh(n,e,t,a,o){const c=a&&!a.isEmpty(),d=o!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${a}`),d&&(p+=` in document ${o}`),p+=")"),new me(re.INVALID_ARGUMENT,m+n+p)}function rA(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,t,a,o,c){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new on(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new RO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(lf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class RO extends Mh{data(){return super.data()}}function lf(n,e){return typeof e=="string"?xv(n,e):e instanceof pu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Tv{}class Av extends Tv{}function Ae(n,e,...t){let a=[];e instanceof Tv&&a.push(e),a=a.concat(t),function(c){const d=c.filter(p=>p instanceof jv).length,m=c.filter(p=>p instanceof cf).length;if(d>1||d>0&&m>0)throw new me(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a);for(const o of a)n=o._apply(n);return n}class cf extends Av{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new cf(e,t,a)}_apply(e){const t=this._parse(e);return lA(e._query,t),new Oa(e.firestore,e.converter,cg(e._query,t))}_parse(e){const t=gu(e.firestore);return function(c,d,m,p,v,_,b){let T;if(v.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new me(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){JN(b,_);const x=[];for(const C of b)x.push(ZN(p,c,C));T={arrayValue:{values:x}}}else T=ZN(p,c,b)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||JN(b,_),T=SO(m,d,b,_==="in"||_==="not-in");return kt.create(v,_,T)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Oe(n,e,t){const a=e,o=lf("where",n);return cf._create(o,a,t)}class jv extends Tv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new jv(e,t)}_parse(e){const t=this._queryConstraints.map(a=>a._parse(e)).filter(a=>a.getFilters().length>0);return t.length===1?t[0]:Ns.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,c){let d=o;const m=c.getFlattenedFilters();for(const p of m)lA(d,p),d=cg(d,p)}(e._query,t),new Oa(e.firestore,e.converter,cg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class wv extends Av{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new wv(e,t)}_apply(e){const t=function(o,c,d){if(o.startAt!==null)throw new me(re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new me(re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Xc(c,d)}(e._query,this._field,this._direction);return new Oa(e.firestore,e.converter,function(o,c){const d=o.explicitOrderBy.concat([c]);return new ul(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function jn(n,e="asc"){const t=e,a=lf("orderBy",n);return wv._create(a,t)}class Cv extends Av{constructor(e,t,a){super(),this.type=e,this._limit=t,this._limitType=a}static _create(e,t,a){return new Cv(e,t,a)}_apply(e){return new Oa(e.firestore,e.converter,Th(e._query,this._limit,this._limitType))}}function DO(n){return Cv._create("limit",n,"F")}function ZN(n,e,t){if(typeof(t=vt(t))=="string"){if(t==="")throw new me(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!r0(e)&&t.indexOf("/")!==-1)throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(ft.fromString(t));if(!Ee.isDocumentKey(a))throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return hN(n,new Ee(a))}if(t instanceof on)return hN(n,t._key);throw new me(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sf(t)}.`)}function JN(n,e){if(!Array.isArray(n)||n.length===0)throw new me(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function lA(n,e){const t=function(o,c){for(const d of o)for(const m of d.getFlattenedFilters())if(c.indexOf(m.op)>=0)return m.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new me(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class cA{convertValue(e,t="none"){switch(Ai(e)){case 0:return null;case 1:return e.booleanValue;case 2:return St(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ti(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw xe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return ki(e,(o,c)=>{a[o]=this.convertValue(c,t)}),a}convertVectorValue(e){var t,a,o;const c=(o=(a=(t=e.fields)===null||t===void 0?void 0:t[Nh].arrayValue)===null||a===void 0?void 0:a.values)===null||o===void 0?void 0:o.map(d=>St(d.doubleValue));return new yv(c)}convertGeoPoint(e){return new vv(St(e.latitude),St(e.longitude))}convertArray(e,t){return(e.values||[]).map(a=>this.convertValue(a,t))}convertServerTimestamp(e,t){switch(t){case"previous":const a=$h(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp(Yc(e));default:return null}}convertTimestamp(e){const t=xi(e);return new qt(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=ft.fromString(e);Ze(R0(a),9688,{name:e});const o=new Kc(a.get(1),a.get(3)),c=new Ee(a.popFirst(5));return o.isEqual(t)||Ra(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sv(n,e,t){let a;return a=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,a}class MO extends cA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Iv extends Mh{constructor(e,t,a,o,c,d){super(e,t,a,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ch(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(lf("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}}class ch extends Iv{data(e={}){return super.data(e)}}class uA{constructor(e,t,a,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Fo(o.hasPendingWrites,o.fromCache),this.query=a}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(a=>{e.call(t,new ch(this._firestore,this._userDataWriter,a.key,a,new Fo(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map(m=>{const p=new ch(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Fo(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}})}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(m=>c||m.type!==3).map(m=>{const p=new ch(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Fo(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let v=-1,_=-1;return m.type!==0&&(v=d.indexOf(m.doc.key),d=d.delete(m.doc.key)),m.type!==1&&(d=d.add(m.doc),_=d.indexOf(m.doc.key)),{type:OO(m.type),doc:p,oldIndex:v,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function OO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xe(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(n){n=Tn(n,on);const e=Tn(n.firestore,Qs);return bO(mu(e),n._key).then(t=>dA(e,n,t))}class uf extends cA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}function yt(n){n=Tn(n,Oa);const e=Tn(n.firestore,Qs),t=mu(e),a=new uf(e);return oA(n._query),EO(t,n._query).then(o=>new uA(e,a,n,o))}function df(n,e,t){n=Tn(n,on);const a=Tn(n.firestore,Qs),o=Sv(n.converter,e,t);return ff(a,[bv(gu(a),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,rn.none())])}function xs(n,e,t,...a){n=Tn(n,on);const o=Tn(n.firestore,Qs),c=gu(o);let d;return d=typeof(e=vt(e))=="string"||e instanceof pu?sA(c,"updateDoc",n._key,e,t,a):nA(c,"updateDoc",n._key,e),ff(o,[d.toMutation(n._key,rn.exists(!0))])}function hf(n){return ff(Tn(n.firestore,Qs),[new Zh(n._key,rn.none())])}function hl(n,e){const t=Tn(n.firestore,Qs),a=st(n),o=Sv(n.converter,e);return ff(t,[bv(gu(n.firestore),"addDoc",a._key,o,n.converter!==null,{}).toMutation(a._key,rn.exists(!1))]).then(()=>a)}function Ur(n,...e){var t,a,o;n=vt(n);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||WN(e[d])||(c=e[d],d++);const m={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(WN(e[d])){const b=e[d];e[d]=(t=b.next)===null||t===void 0?void 0:t.bind(b),e[d+1]=(a=b.error)===null||a===void 0?void 0:a.bind(b),e[d+2]=(o=b.complete)===null||o===void 0?void 0:o.bind(b)}let p,v,_;if(n instanceof on)v=Tn(n.firestore,Qs),_=Yh(n._key.path),p={next:b=>{e[d]&&e[d](dA(v,n,b))},error:e[d+1],complete:e[d+2]};else{const b=Tn(n,Oa);v=Tn(b.firestore,Qs),_=b._query;const T=new uf(v);p={next:j=>{e[d]&&e[d](new uA(v,T,b,j))},error:e[d+1],complete:e[d+2]},oA(n._query)}return function(T,j,x,C){const w=new pv(C),F=new hv(j,w,x);return T.asyncQueue.enqueueAndForget(async()=>cv(await Rh(T),F)),()=>{w.xu(),T.asyncQueue.enqueueAndForget(async()=>uv(await Rh(T),F))}}(mu(v),_,m,p)}function ff(n,e){return function(a,o){const c=new $s;return a.asyncQueue.enqueueAndForget(async()=>iO(await yO(a),o,c)),c.promise}(mu(n),e)}function dA(n,e,t){const a=t.docs.get(e._key),o=new uf(n);return new Iv(n,o,e._key,a,new Fo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO={maxAttempts:5};function Ic(n,e){if((n=vt(n)).firestore!==e)throw new me(re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=gu(e)}get(e){const t=Ic(e,this._firestore),a=new MO(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return xe(24041);const c=o[0];if(c.isFoundDocument())return new Mh(this._firestore,a,c.key,c,t.converter);if(c.isNoDocument())return new Mh(this._firestore,a,t._key,null,t.converter);throw xe(18433,{doc:c})})}set(e,t,a){const o=Ic(e,this._firestore),c=Sv(o.converter,t,a),d=bv(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,a);return this._transaction.set(o._key,d),this}update(e,t,a,...o){const c=Ic(e,this._firestore);let d;return d=typeof(t=vt(t))=="string"||t instanceof pu?sA(this._dataReader,"Transaction.update",c._key,t,a,o):nA(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,d),this}delete(e){const t=Ic(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO extends PO{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Ic(e,this._firestore),a=new uf(this._firestore);return super.get(e).then(o=>new Iv(this._firestore,a,t._key,o._document,new Fo(!1,!1),t.converter))}}function Rv(n,e,t){n=Tn(n,Qs);const a=Object.assign(Object.assign({},kO),t);return function(c){if(c.maxAttempts<1)throw new me(re.INVALID_ARGUMENT,"Max attempts must be at least 1")}(a),function(c,d,m){const p=new $s;return c.asyncQueue.enqueueAndForget(async()=>{const v=await _O(c);new pO(c.asyncQueue,v,m,d,p).Wu()}),p.promise}(mu(n),o=>e(new LO(n,o)),a)}function et(){return new Ev("serverTimestamp")}(function(e,t=!0){(function(o){ol=o})(Pr),os(new $n("firestore",(a,{instanceIdentifier:o,options:c})=>{const d=a.getProvider("app").getImmediate(),m=new Qs(new I1(a.getProvider("auth-internal")),new M1(d,a.getProvider("app-check-internal")),function(v,_){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new me(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Kc(v.options.projectId,_)}(d,o),d);return c=Object.assign({useFetchStreams:t},c),m._setSettings(c),m},"PUBLIC").setMultipleInstances(!0)),pn(eN,tN,e),pn(eN,tN,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA="firebasestorage.googleapis.com",VO="storageBucket",UO=2*60*1e3,FO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws extends cs{constructor(e,t,a=0){super(Pp(e),`Firebase Storage: ${t} (${Pp(e)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ws.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Pp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Xs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Xs||(Xs={}));function Pp(n){return"storage/"+n}function qO(){const n="An unknown error occurred, please check the error payload for server response.";return new Ws(Xs.UNKNOWN,n)}function BO(){return new Ws(Xs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function HO(){return new Ws(Xs.CANCELED,"User canceled the upload/download.")}function zO(n){return new Ws(Xs.INVALID_URL,"Invalid URL '"+n+"'.")}function GO(n){return new Ws(Xs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function ex(n){return new Ws(Xs.INVALID_ARGUMENT,n)}function fA(){return new Ws(Xs.APP_DELETED,"The Firebase app was deleted.")}function $O(n){return new Ws(Xs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let a;try{a=bs.makeFromUrl(e,t)}catch{return new bs(e,"")}if(a.path==="")return a;throw GO(e)}static makeFromUrl(e,t){let a=null;const o="([A-Za-z0-9.\\-_]+)";function c(k){k.path.charAt(k.path.length-1)==="/"&&(k.path_=k.path_.slice(0,-1))}const d="(/(.*))?$",m=new RegExp("^gs://"+o+d,"i"),p={bucket:1,path:3};function v(k){k.path_=decodeURIComponent(k.path)}const _="v[A-Za-z0-9_]+",b=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",j=new RegExp(`^https?://${b}/${_}/b/${o}/o${T}`,"i"),x={bucket:1,path:3},C=t===hA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",F=new RegExp(`^https?://${C}/${o}/${w}`,"i"),V=[{regex:m,indices:p,postModify:c},{regex:j,indices:x,postModify:v},{regex:F,indices:{bucket:1,path:2},postModify:v}];for(let k=0;k<V.length;k++){const U=V[k],Q=U.regex.exec(e);if(Q){const L=Q[U.indices.bucket];let R=Q[U.indices.path];R||(R=""),a=new bs(L,R),U.postModify(a);break}}if(a==null)throw zO(e);return a}}class YO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KO(n,e,t){let a=1,o=null,c=null,d=!1,m=0;function p(){return m===2}let v=!1;function _(...w){v||(v=!0,e.apply(null,w))}function b(w){o=setTimeout(()=>{o=null,n(j,p())},w)}function T(){c&&clearTimeout(c)}function j(w,...F){if(v){T();return}if(w){T(),_.call(null,w,...F);return}if(p()||d){T(),_.call(null,w,...F);return}a<64&&(a*=2);let V;m===1?(m=2,V=0):V=(a+Math.random())*1e3,b(V)}let x=!1;function C(w){x||(x=!0,T(),!v&&(o!==null?(w||(m=2),clearTimeout(o),b(0)):w||(m=1)))}return b(0),c=setTimeout(()=>{d=!0,C(!0)},t),C}function QO(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XO(n){return n!==void 0}function tx(n,e,t,a){if(a<e)throw ex(`Invalid value for '${n}'. Expected ${e} or greater.`);if(a>t)throw ex(`Invalid value for '${n}'. Expected ${t} or less.`)}function WO(n){const e=encodeURIComponent;let t="?";for(const a in n)if(n.hasOwnProperty(a)){const o=e(a)+"="+e(n[a]);t=t+o+"&"}return t=t.slice(0,-1),t}var Oh;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Oh||(Oh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZO(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(e,t,a,o,c,d,m,p,v,_,b,T=!0,j=!1){this.url_=e,this.method_=t,this.headers_=a,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=m,this.errorCallback_=p,this.timeout_=v,this.progressCallback_=_,this.connectionFactory_=b,this.retry=T,this.isUsingEmulator=j,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,C)=>{this.resolve_=x,this.reject_=C,this.start_()})}start_(){const e=(a,o)=>{if(o){a(!1,new Wd(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=m=>{const p=m.loaded,v=m.lengthComputable?m.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,v)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const m=c.getErrorCode()===Oh.NO_ERROR,p=c.getStatus();if(!m||ZO(p,this.additionalRetryCodes_)&&this.retry){const _=c.getErrorCode()===Oh.ABORT;a(!1,new Wd(!1,null,_));return}const v=this.successCodes_.indexOf(p)!==-1;a(!0,new Wd(v,c))})},t=(a,o)=>{const c=this.resolve_,d=this.reject_,m=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(m,m.getResponse());XO(p)?c(p):c()}catch(p){d(p)}else if(m!==null){const p=qO();p.serverResponse=m.getErrorText(),this.errorCallback_?d(this.errorCallback_(m,p)):d(p)}else if(o.canceled){const p=this.appDelete_?fA():HO();d(p)}else{const p=BO();d(p)}};this.canceled_?t(!1,new Wd(!1,null,!0)):this.backoffId_=KO(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&QO(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Wd{constructor(e,t,a){this.wasSuccessCode=e,this.connection=t,this.canceled=!!a}}function ek(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function tk(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function nk(n,e){e&&(n["X-Firebase-GMPID"]=e)}function sk(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function ak(n,e,t,a,o,c,d=!0,m=!1){const p=WO(n.urlParams),v=n.url+p,_=Object.assign({},n.headers);return nk(_,e),ek(_,t),tk(_,c),sk(_,a),new JO(v,n.method,_,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,m)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ik(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function rk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,t){this._service=e,t instanceof bs?this._location=t:this._location=bs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new kh(e,t)}get root(){const e=new bs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return rk(this._location.path)}get storage(){return this._service}get parent(){const e=ik(this._location.path);if(e===null)return null;const t=new bs(this._location.bucket,e);return new kh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw $O(e)}}function nx(n,e){const t=e?.[VO];return t==null?null:bs.makeFromBucketSpec(t,n)}function ok(n,e,t,a={}){n.host=`${e}:${t}`;const o=kr(e);o&&(jg(`https://${n.host}/b`),wg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=a;c&&(n._overrideAuthToken=typeof c=="string"?c:Kx(c,n.app.options.projectId))}class lk{constructor(e,t,a,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=a,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=hA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=UO,this._maxUploadRetryTime=FO,this._requests=new Set,o!=null?this._bucket=bs.makeFromBucketSpec(o,this._host):this._bucket=nx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=bs.makeFromBucketSpec(this._url,e):this._bucket=nx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){tx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){tx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Rn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new kh(this,e)}_makeRequest(e,t,a,o,c=!0){if(this._deleted)return new YO(fA());{const d=ak(e,this._appId,a,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[a,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,a,o).getPromise()}}const sx="@firebase/storage",ax="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA="storage";function ck(n=au(),e){n=vt(n);const a=Ma(n,mA).getImmediate({identifier:e}),o=Gx("storage");return o&&uk(a,...o),a}function uk(n,e,t,a={}){ok(n,e,t,a)}function dk(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new lk(t,a,o,e,Pr)}function hk(){os(new $n(mA,dk,"PUBLIC").setMultipleInstances(!0)),pn(sx,ax,""),pn(sx,ax,"esm2017")}hk();const pA="@firebase/installations",Dv="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA=1e4,vA=`w:${Dv}`,yA="FIS_v2",fk="https://firebaseinstallations.googleapis.com/v1",mk=60*60*1e3,pk="installations",gk="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vk={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Mr=new Ri(pk,gk,vk);function _A(n){return n instanceof cs&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA({projectId:n}){return`${fk}/projects/${n}/installations`}function EA(n){return{token:n.token,requestStatus:2,expiresIn:_k(n.expiresIn),creationTime:Date.now()}}async function NA(n,e){const a=(await e.json()).error;return Mr.create("request-failed",{requestName:n,serverCode:a.code,serverMessage:a.message,serverStatus:a.status})}function xA({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function yk(n,{refreshToken:e}){const t=xA(n);return t.append("Authorization",bk(e)),t}async function TA(n){const e=await n();return e.status>=500&&e.status<600?n():e}function _k(n){return Number(n.replace("s","000"))}function bk(n){return`${yA} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ek({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const a=bA(n),o=xA(n),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={fid:t,authVersion:yA,appId:n.appId,sdkVersion:vA},m={method:"POST",headers:o,body:JSON.stringify(d)},p=await TA(()=>fetch(a,m));if(p.ok){const v=await p.json();return{fid:v.fid||t,registrationStatus:2,refreshToken:v.refreshToken,authToken:EA(v.authToken)}}else throw await NA("Create Installation",p)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AA(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nk(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xk=/^[cdef][\w-]{21}$/,_g="";function Tk(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=Ak(n);return xk.test(t)?t:_g}catch{return _g}}function Ak(n){return Nk(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA=new Map;function wA(n,e){const t=mf(n);CA(t,e),jk(t,e)}function CA(n,e){const t=jA.get(n);if(t)for(const a of t)a(e)}function jk(n,e){const t=wk();t&&t.postMessage({key:n,fid:e}),Ck()}let Ar=null;function wk(){return!Ar&&"BroadcastChannel"in self&&(Ar=new BroadcastChannel("[Firebase] FID Change"),Ar.onmessage=n=>{CA(n.data.key,n.data.fid)}),Ar}function Ck(){jA.size===0&&Ar&&(Ar.close(),Ar=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk="firebase-installations-database",Ik=1,Or="firebase-installations-store";let Lp=null;function Mv(){return Lp||(Lp=Wx(Sk,Ik,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Or)}}})),Lp}async function Ph(n,e){const t=mf(n),o=(await Mv()).transaction(Or,"readwrite"),c=o.objectStore(Or),d=await c.get(t);return await c.put(e,t),await o.done,(!d||d.fid!==e.fid)&&wA(n,e.fid),e}async function SA(n){const e=mf(n),a=(await Mv()).transaction(Or,"readwrite");await a.objectStore(Or).delete(e),await a.done}async function pf(n,e){const t=mf(n),o=(await Mv()).transaction(Or,"readwrite"),c=o.objectStore(Or),d=await c.get(t),m=e(d);return m===void 0?await c.delete(t):await c.put(m,t),await o.done,m&&(!d||d.fid!==m.fid)&&wA(n,m.fid),m}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ov(n){let e;const t=await pf(n.appConfig,a=>{const o=Rk(a),c=Dk(n,o);return e=c.registrationPromise,c.installationEntry});return t.fid===_g?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function Rk(n){const e=n||{fid:Tk(),registrationStatus:0};return IA(e)}function Dk(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject(Mr.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},a=Mk(n,t);return{installationEntry:t,registrationPromise:a}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Ok(n)}:{installationEntry:e}}async function Mk(n,e){try{const t=await Ek(n,e);return Ph(n.appConfig,t)}catch(t){throw _A(t)&&t.customData.serverCode===409?await SA(n.appConfig):await Ph(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Ok(n){let e=await ix(n.appConfig);for(;e.registrationStatus===1;)await AA(100),e=await ix(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:a}=await Ov(n);return a||t}return e}function ix(n){return pf(n,e=>{if(!e)throw Mr.create("installation-not-found");return IA(e)})}function IA(n){return kk(n)?{fid:n.fid,registrationStatus:0}:n}function kk(n){return n.registrationStatus===1&&n.registrationTime+gA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pk({appConfig:n,heartbeatServiceProvider:e},t){const a=Lk(n,t),o=yk(n,t),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={installation:{sdkVersion:vA,appId:n.appId}},m={method:"POST",headers:o,body:JSON.stringify(d)},p=await TA(()=>fetch(a,m));if(p.ok){const v=await p.json();return EA(v)}else throw await NA("Generate Auth Token",p)}function Lk(n,{fid:e}){return`${bA(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kv(n,e=!1){let t;const a=await pf(n.appConfig,c=>{if(!RA(c))throw Mr.create("not-registered");const d=c.authToken;if(!e&&Fk(d))return c;if(d.requestStatus===1)return t=Vk(n,e),c;{if(!navigator.onLine)throw Mr.create("app-offline");const m=Bk(c);return t=Uk(n,m),m}});return t?await t:a.authToken}async function Vk(n,e){let t=await rx(n.appConfig);for(;t.authToken.requestStatus===1;)await AA(100),t=await rx(n.appConfig);const a=t.authToken;return a.requestStatus===0?kv(n,e):a}function rx(n){return pf(n,e=>{if(!RA(e))throw Mr.create("not-registered");const t=e.authToken;return Hk(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Uk(n,e){try{const t=await Pk(n,e),a=Object.assign(Object.assign({},e),{authToken:t});return await Ph(n.appConfig,a),t}catch(t){if(_A(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await SA(n.appConfig);else{const a=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Ph(n.appConfig,a)}throw t}}function RA(n){return n!==void 0&&n.registrationStatus===2}function Fk(n){return n.requestStatus===2&&!qk(n)}function qk(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+mk}function Bk(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function Hk(n){return n.requestStatus===1&&n.requestTime+gA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zk(n){const e=n,{installationEntry:t,registrationPromise:a}=await Ov(e);return a?a.catch(console.error):kv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gk(n,e=!1){const t=n;return await $k(t),(await kv(t,e)).token}async function $k(n){const{registrationPromise:e}=await Ov(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yk(n){if(!n||!n.options)throw Vp("App Configuration");if(!n.name)throw Vp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Vp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Vp(n){return Mr.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA="installations",Kk="installations-internal",Qk=n=>{const e=n.getProvider("app").getImmediate(),t=Yk(e),a=Ma(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:a,_delete:()=>Promise.resolve()}},Xk=n=>{const e=n.getProvider("app").getImmediate(),t=Ma(e,DA).getImmediate();return{getId:()=>zk(t),getToken:o=>Gk(t,o)}};function Wk(){os(new $n(DA,Qk,"PUBLIC")),os(new $n(Kk,Xk,"PRIVATE"))}Wk();pn(pA,Dv);pn(pA,Dv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh="analytics",Zk="firebase_id",Jk="origin",eP=60*1e3,tP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Pv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dn=new su("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Gn=new Ri("analytics","Analytics",nP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(n){if(!n.startsWith(Pv)){const e=Gn.create("invalid-gtag-resource",{gtagURL:n});return Dn.warn(e.message),""}return n}function MA(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function aP(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function iP(n,e){const t=aP("firebase-js-sdk-policy",{createScriptURL:sP}),a=document.createElement("script"),o=`${Pv}?l=${n}&id=${e}`;a.src=t?t?.createScriptURL(o):o,a.async=!0,document.head.appendChild(a)}function rP(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function oP(n,e,t,a,o,c){const d=a[o];try{if(d)await e[d];else{const p=(await MA(t)).find(v=>v.measurementId===o);p&&await e[p.appId]}}catch(m){Dn.error(m)}n("config",o,c)}async function lP(n,e,t,a,o){try{let c=[];if(o&&o.send_to){let d=o.send_to;Array.isArray(d)||(d=[d]);const m=await MA(t);for(const p of d){const v=m.find(b=>b.measurementId===p),_=v&&e[v.appId];if(_)c.push(_);else{c=[];break}}}c.length===0&&(c=Object.values(e)),await Promise.all(c),n("event",a,o||{})}catch(c){Dn.error(c)}}function cP(n,e,t,a){async function o(c,...d){try{if(c==="event"){const[m,p]=d;await lP(n,e,t,m,p)}else if(c==="config"){const[m,p]=d;await oP(n,e,t,a,m,p)}else if(c==="consent"){const[m,p]=d;n("consent",m,p)}else if(c==="get"){const[m,p,v]=d;n("get",m,p,v)}else if(c==="set"){const[m]=d;n("set",m)}else n(c,...d)}catch(m){Dn.error(m)}}return o}function uP(n,e,t,a,o){let c=function(...d){window[a].push(arguments)};return window[o]&&typeof window[o]=="function"&&(c=window[o]),window[o]=cP(c,n,e,t),{gtagCore:c,wrappedGtag:window[o]}}function dP(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Pv)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP=30,fP=1e3;class mP{constructor(e={},t=fP){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const OA=new mP;function pP(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function gP(n){var e;const{appId:t,apiKey:a}=n,o={method:"GET",headers:pP(a)},c=tP.replace("{app-id}",t),d=await fetch(c,o);if(d.status!==200&&d.status!==304){let m="";try{const p=await d.json();!((e=p.error)===null||e===void 0)&&e.message&&(m=p.error.message)}catch{}throw Gn.create("config-fetch-failed",{httpStatus:d.status,responseMessage:m})}return d.json()}async function vP(n,e=OA,t){const{appId:a,apiKey:o,measurementId:c}=n.options;if(!a)throw Gn.create("no-app-id");if(!o){if(c)return{measurementId:c,appId:a};throw Gn.create("no-api-key")}const d=e.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},m=new bP;return setTimeout(async()=>{m.abort()},eP),kA({appId:a,apiKey:o,measurementId:c},d,m,e)}async function kA(n,{throttleEndTimeMillis:e,backoffCount:t},a,o=OA){var c;const{appId:d,measurementId:m}=n;try{await yP(a,e)}catch(p){if(m)return Dn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:d,measurementId:m};throw p}try{const p=await gP(n);return o.deleteThrottleMetadata(d),p}catch(p){const v=p;if(!_P(v)){if(o.deleteThrottleMetadata(d),m)return Dn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${v?.message}]`),{appId:d,measurementId:m};throw p}const _=Number((c=v?.customData)===null||c===void 0?void 0:c.httpStatus)===503?AE(t,o.intervalMillis,hP):AE(t,o.intervalMillis),b={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return o.setThrottleMetadata(d,b),Dn.debug(`Calling attemptFetch again in ${_} millis`),kA(n,b,a,o)}}function yP(n,e){return new Promise((t,a)=>{const o=Math.max(e-Date.now(),0),c=setTimeout(t,o);n.addEventListener(()=>{clearTimeout(c),a(Gn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function _P(n){if(!(n instanceof cs)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class bP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function EP(n,e,t,a,o){if(o&&o.global){n("event",t,a);return}else{const c=await e,d=Object.assign(Object.assign({},a),{send_to:c});n("event",t,d)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NP(){if(Fh())try{await qh()}catch(n){return Dn.warn(Gn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Dn.warn(Gn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function xP(n,e,t,a,o,c,d){var m;const p=vP(n);p.then(j=>{t[j.measurementId]=j.appId,n.options.measurementId&&j.measurementId!==n.options.measurementId&&Dn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${j.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(j=>Dn.error(j)),e.push(p);const v=NP().then(j=>{if(j)return a.getId()}),[_,b]=await Promise.all([p,v]);dP(c)||iP(c,_.measurementId),o("js",new Date);const T=(m=d?.config)!==null&&m!==void 0?m:{};return T[Jk]="firebase",T.update=!0,b!=null&&(T[Zk]=b),o("config",_.measurementId,T),_.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e){this.app=e}_delete(){return delete Vc[this.app.options.appId],Promise.resolve()}}let Vc={},ox=[];const lx={};let Up="dataLayer",AP="gtag",cx,PA,ux=!1;function jP(){const n=[];if(Cg()&&n.push("This is a browser extension environment."),Sg()||n.push("Cookies are not available."),n.length>0){const e=n.map((a,o)=>`(${o+1}) ${a}`).join(" "),t=Gn.create("invalid-analytics-context",{errorInfo:e});Dn.warn(t.message)}}function wP(n,e,t){jP();const a=n.options.appId;if(!a)throw Gn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Dn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Gn.create("no-api-key");if(Vc[a]!=null)throw Gn.create("already-exists",{id:a});if(!ux){rP(Up);const{wrappedGtag:c,gtagCore:d}=uP(Vc,ox,lx,Up,AP);PA=c,cx=d,ux=!0}return Vc[a]=xP(n,ox,lx,e,cx,Up,t),new TP(n)}function CP(n=au()){n=vt(n);const e=Ma(n,Lh);return e.isInitialized()?e.getImmediate():SP(n)}function SP(n,e={}){const t=Ma(n,Lh);if(t.isInitialized()){const o=t.getImmediate();if(Ei(e,t.getOptions()))return o;throw Gn.create("already-initialized")}return t.initialize({options:e})}async function IP(){if(Cg()||!Sg()||!Fh())return!1;try{return await qh()}catch{return!1}}function RP(n,e,t,a){n=vt(n),EP(PA,Vc[n.app.options.appId],e,t,a).catch(o=>Dn.error(o))}const dx="@firebase/analytics",hx="0.10.16";function DP(){os(new $n(Lh,(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return wP(a,o,t)},"PUBLIC")),os(new $n("analytics-internal",n,"PRIVATE")),pn(dx,hx),pn(dx,hx,"esm2017");function n(e){try{const t=e.getProvider(Lh).getImmediate();return{logEvent:(a,o,c)=>RP(t,a,o,c)}}catch(t){throw Gn.create("interop-component-reg-failed",{reason:t})}}}DP();var bg,fx,gf=function(){var n=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(n&&n.responseStart>0&&n.responseStart<performance.now())return n},LA=function(n){if(document.readyState==="loading")return"loading";var e=gf();if(e){if(n<e.domInteractive)return"loading";if(e.domContentLoadedEventStart===0||n<e.domContentLoadedEventStart)return"dom-interactive";if(e.domComplete===0||n<e.domComplete)return"dom-content-loaded"}return"complete"},MP=function(n){var e=n.nodeName;return n.nodeType===1?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},Lv=function(n,e){var t="";try{for(;n&&n.nodeType!==9;){var a=n,o=a.id?"#"+a.id:MP(a)+(a.classList&&a.classList.value&&a.classList.value.trim()&&a.classList.value.trim().length?"."+a.classList.value.trim().replace(/\s+/g,"."):"");if(t.length+o.length>(e||100)-1)return t||o;if(t=t?o+">"+t:o,a.id)break;n=a.parentNode}}catch{}return t},VA=-1,OP=function(){return VA},yu=function(n){addEventListener("pageshow",function(e){e.persisted&&(VA=e.timeStamp,n(e))},!0)},Vv=function(){var n=gf();return n&&n.activationStart||0},Ci=function(n,e){var t=gf(),a="navigate";return OP()>=0?a="back-forward-cache":t&&(document.prerendering||Vv()>0?a="prerender":document.wasDiscarded?a="restore":t.type&&(a=t.type.replace(/_/g,"-"))),{name:n,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:a}},fl=function(n,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(n)){var a=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return a.observe(Object.assign({type:n,buffered:!0},t||{})),a}}catch{}},Si=function(n,e,t,a){var o,c;return function(d){e.value>=0&&(d||a)&&((c=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=c,e.rating=function(m,p){return m>p[1]?"poor":m>p[0]?"needs-improvement":"good"}(e.value,t),n(e))}},Uv=function(n){requestAnimationFrame(function(){return requestAnimationFrame(function(){return n()})})},vf=function(n){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&n()})},Fv=function(n){var e=!1;return function(){e||(n(),e=!0)}},qo=-1,mx=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},Vh=function(n){document.visibilityState==="hidden"&&qo>-1&&(qo=n.type==="visibilitychange"?n.timeStamp:0,kP())},px=function(){addEventListener("visibilitychange",Vh,!0),addEventListener("prerenderingchange",Vh,!0)},kP=function(){removeEventListener("visibilitychange",Vh,!0),removeEventListener("prerenderingchange",Vh,!0)},UA=function(){return qo<0&&(qo=mx(),px(),yu(function(){setTimeout(function(){qo=mx(),px()},0)})),{get firstHiddenTime(){return qo}}},qv=function(n){document.prerendering?addEventListener("prerenderingchange",function(){return n()},!0):n()},gx=[1800,3e3],PP=function(n,e){e=e||{},qv(function(){var t,a=UA(),o=Ci("FCP"),c=fl("paint",function(d){d.forEach(function(m){m.name==="first-contentful-paint"&&(c.disconnect(),m.startTime<a.firstHiddenTime&&(o.value=Math.max(m.startTime-Vv(),0),o.entries.push(m),t(!0)))})});c&&(t=Si(n,o,gx,e.reportAllChanges),yu(function(d){o=Ci("FCP"),t=Si(n,o,gx,e.reportAllChanges),Uv(function(){o.value=performance.now()-d.timeStamp,t(!0)})}))})},vx=[.1,.25],LP=function(n,e){(function(t,a){a=a||{},PP(Fv(function(){var o,c=Ci("CLS",0),d=0,m=[],p=function(_){_.forEach(function(b){if(!b.hadRecentInput){var T=m[0],j=m[m.length-1];d&&b.startTime-j.startTime<1e3&&b.startTime-T.startTime<5e3?(d+=b.value,m.push(b)):(d=b.value,m=[b])}}),d>c.value&&(c.value=d,c.entries=m,o())},v=fl("layout-shift",p);v&&(o=Si(t,c,vx,a.reportAllChanges),vf(function(){p(v.takeRecords()),o(!0)}),yu(function(){d=0,c=Ci("CLS",0),o=Si(t,c,vx,a.reportAllChanges),Uv(function(){return o()})}),setTimeout(o,0))}))})(function(t){var a=function(o){var c,d={};if(o.entries.length){var m=o.entries.reduce(function(v,_){return v&&v.value>_.value?v:_});if(m&&m.sources&&m.sources.length){var p=(c=m.sources).find(function(v){return v.node&&v.node.nodeType===1})||c[0];p&&(d={largestShiftTarget:Lv(p.node),largestShiftTime:m.startTime,largestShiftValue:m.value,largestShiftSource:p,largestShiftEntry:m,loadState:LA(m.startTime)})}}return Object.assign(o,{attribution:d})}(t);n(a)},e)},FA=0,Fp=1/0,Zd=0,VP=function(n){n.forEach(function(e){e.interactionId&&(Fp=Math.min(Fp,e.interactionId),Zd=Math.max(Zd,e.interactionId),FA=Zd?(Zd-Fp)/7+1:0)})},qA=function(){return bg?FA:performance.interactionCount||0},UP=function(){"interactionCount"in performance||bg||(bg=fl("event",VP,{type:"event",buffered:!0,durationThreshold:0}))},vs=[],Uc=new Map,BA=0,FP=function(){var n=Math.min(vs.length-1,Math.floor((qA()-BA)/50));return vs[n]},HA=[],qP=function(n){if(HA.forEach(function(o){return o(n)}),n.interactionId||n.entryType==="first-input"){var e=vs[vs.length-1],t=Uc.get(n.interactionId);if(t||vs.length<10||n.duration>e.latency){if(t)n.duration>t.latency?(t.entries=[n],t.latency=n.duration):n.duration===t.latency&&n.startTime===t.entries[0].startTime&&t.entries.push(n);else{var a={id:n.interactionId,latency:n.duration,entries:[n]};Uc.set(a.id,a),vs.push(a)}vs.sort(function(o,c){return c.latency-o.latency}),vs.length>10&&vs.splice(10).forEach(function(o){return Uc.delete(o.id)})}}},Bv=function(n){var e=self.requestIdleCallback||self.setTimeout,t=-1;return n=Fv(n),document.visibilityState==="hidden"?n():(t=e(n),vf(n)),t},yx=[200,500],BP=function(n,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},qv(function(){var t;UP();var a,o=Ci("INP"),c=function(m){Bv(function(){m.forEach(qP);var p=FP();p&&p.latency!==o.value&&(o.value=p.latency,o.entries=p.entries,a())})},d=fl("event",c,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});a=Si(n,o,yx,e.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),vf(function(){c(d.takeRecords()),a(!0)}),yu(function(){BA=qA(),vs.length=0,Uc.clear(),o=Ci("INP"),a=Si(n,o,yx,e.reportAllChanges)}))}))},Ko=[],pi=[],Eg=0,Hv=new WeakMap,Qo=new Map,Ng=-1,HP=function(n){Ko=Ko.concat(n),zA()},zA=function(){Ng<0&&(Ng=Bv(zP))},zP=function(){Qo.size>10&&Qo.forEach(function(d,m){Uc.has(m)||Qo.delete(m)});var n=vs.map(function(d){return Hv.get(d.entries[0])}),e=pi.length-50;pi=pi.filter(function(d,m){return m>=e||n.includes(d)});for(var t=new Set,a=0;a<pi.length;a++){var o=pi[a];GA(o.startTime,o.processingEnd).forEach(function(d){t.add(d)})}var c=Ko.length-1-50;Ko=Ko.filter(function(d,m){return d.startTime>Eg&&m>c||t.has(d)}),Ng=-1};HA.push(function(n){n.interactionId&&n.target&&!Qo.has(n.interactionId)&&Qo.set(n.interactionId,n.target)},function(n){var e,t=n.startTime+n.duration;Eg=Math.max(Eg,n.processingEnd);for(var a=pi.length-1;a>=0;a--){var o=pi[a];if(Math.abs(t-o.renderTime)<=8){(e=o).startTime=Math.min(n.startTime,e.startTime),e.processingStart=Math.min(n.processingStart,e.processingStart),e.processingEnd=Math.max(n.processingEnd,e.processingEnd),e.entries.push(n);break}}e||(e={startTime:n.startTime,processingStart:n.processingStart,processingEnd:n.processingEnd,renderTime:t,entries:[n]},pi.push(e)),(n.interactionId||n.entryType==="first-input")&&Hv.set(n,e),zA()});var GA=function(n,e){for(var t,a=[],o=0;t=Ko[o];o++)if(!(t.startTime+t.duration<n)){if(t.startTime>e)break;a.push(t)}return a},GP=function(n,e){fx||(fx=fl("long-animation-frame",HP)),BP(function(t){var a=function(o){var c=o.entries[0],d=Hv.get(c),m=c.processingStart,p=d.processingEnd,v=d.entries.sort(function(w,F){return w.processingStart-F.processingStart}),_=GA(c.startTime,p),b=o.entries.find(function(w){return w.target}),T=b&&b.target||Qo.get(c.interactionId),j=[c.startTime+c.duration,p].concat(_.map(function(w){return w.startTime+w.duration})),x=Math.max.apply(Math,j),C={interactionTarget:Lv(T),interactionTargetElement:T,interactionType:c.name.startsWith("key")?"keyboard":"pointer",interactionTime:c.startTime,nextPaintTime:x,processedEventEntries:v,longAnimationFrameEntries:_,inputDelay:m-c.startTime,processingDuration:p-m,presentationDelay:Math.max(x-p,0),loadState:LA(c.startTime)};return Object.assign(o,{attribution:C})}(t);n(a)},e)},_x=[2500,4e3],qp={},$P=function(n,e){(function(t,a){a=a||{},qv(function(){var o,c=UA(),d=Ci("LCP"),m=function(_){a.reportAllChanges||(_=_.slice(-1)),_.forEach(function(b){b.startTime<c.firstHiddenTime&&(d.value=Math.max(b.startTime-Vv(),0),d.entries=[b],o())})},p=fl("largest-contentful-paint",m);if(p){o=Si(t,d,_x,a.reportAllChanges);var v=Fv(function(){qp[d.id]||(m(p.takeRecords()),p.disconnect(),qp[d.id]=!0,o(!0))});["keydown","click"].forEach(function(_){addEventListener(_,function(){return Bv(v)},{once:!0,capture:!0})}),vf(v),yu(function(_){d=Ci("LCP"),o=Si(t,d,_x,a.reportAllChanges),Uv(function(){d.value=performance.now()-_.timeStamp,qp[d.id]=!0,o(!0)})})}})})(function(t){var a=function(o){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:o.value};if(o.entries.length){var d=gf();if(d){var m=d.activationStart||0,p=o.entries[o.entries.length-1],v=p.url&&performance.getEntriesByType("resource").filter(function(x){return x.name===p.url})[0],_=Math.max(0,d.responseStart-m),b=Math.max(_,v?(v.requestStart||v.startTime)-m:0),T=Math.max(b,v?v.responseEnd-m:0),j=Math.max(T,p.startTime-m);c={element:Lv(p.element),timeToFirstByte:_,resourceLoadDelay:b-_,resourceLoadDuration:T-b,elementRenderDelay:j-T,navigationEntry:d,lcpEntry:p},p.url&&(c.url=p.url),v&&(c.lcpResourceEntry=v)}}return Object.assign(o,{attribution:c})}(t);n(a)},e)};const bx="@firebase/performance",xg="0.7.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A=xg,YP="FB-PERF-TRACE-START",KP="FB-PERF-TRACE-STOP",Tg="FB-PERF-TRACE-MEASURE",YA="_wt_",KA="_fp",QA="_fcp",XA="_fid",WA="_lcp",QP="lcp_element",ZA="_inp",XP="inp_interactionTarget",JA="_cls",WP="cls_largestShiftTarget",ej="@firebase/performance/config",tj="@firebase/performance/configexpire",ZP="performance",nj="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},mn=new Ri(ZP,nj,JP);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii=new su(nj);Ii.logLevel=$e.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bp,sj;class Ht{constructor(e){if(this.window=e,!e)throw mn.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=$P,this.onINP=GP,this.onCLS=LP}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,t,a){!this.performance||!this.performance.measure||this.performance.measure(e,t,a)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!Sg()?(Ii.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):Fh()?!0:(Ii.info("IndexedDB is not supported by current browser"),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(o=>{for(const c of o.getEntries())t(c)}).observe({entryTypes:[e]})}static getInstance(){return Bp===void 0&&(Bp=new Ht(sj)),Bp}}function e2(n){sj=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aj;function t2(n){const e=n.getId();return e.then(t=>{aj=t}),e}function zv(){return aj}function n2(n){const e=n.getToken();return e.then(t=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ex(n,e){const t=n.length-e.length;if(t<0||t>1)throw mn.create("invalid String merger input");const a=[];for(let o=0;o<n.length;o++)a.push(n.charAt(o)),e.length>o&&a.push(e.charAt(o));return a.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hp;class Hn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Ex("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Ex("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Hp===void 0&&(Hp=new Hn),Hp}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fc;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.VISIBLE=1]="VISIBLE",n[n.HIDDEN=2]="HIDDEN"})(Fc||(Fc={}));const s2=["firebase_","google_","ga_"],a2=new RegExp("^[a-zA-Z]\\w*$"),i2=40,r2=100;function o2(){const n=Ht.getInstance().navigator;return n?.serviceWorker?n.serviceWorker.controller?2:3:1}function l2(){switch(Ht.getInstance().document.visibilityState){case"visible":return Fc.VISIBLE;case"hidden":return Fc.HIDDEN;default:return Fc.UNKNOWN}}function c2(){const e=Ht.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function u2(n){return n.length===0||n.length>i2?!1:!s2.some(t=>n.startsWith(t))&&!!n.match(a2)}function d2(n){return n.length!==0&&n.length<=r2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ij(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.appId;if(!t)throw mn.create("no app id");return t}function h2(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.projectId;if(!t)throw mn.create("no project id");return t}function f2(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.apiKey;if(!t)throw mn.create("no api key");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2="0.0.1",gs={loggingEnabled:!0},p2="FIREBASE_INSTALLATIONS_AUTH";function g2(n,e){const t=v2();return t?(Nx(t),Promise.resolve()):b2(n,e).then(Nx).then(a=>y2(a),()=>{})}function v2(){const n=Ht.getInstance().localStorage;if(!n)return;const e=n.getItem(tj);if(!e||!E2(e))return;const t=n.getItem(ej);if(t)try{return JSON.parse(t)}catch{return}}function y2(n){const e=Ht.getInstance().localStorage;!n||!e||(e.setItem(ej,JSON.stringify(n)),e.setItem(tj,String(Date.now()+Hn.getInstance().configTimeToLive*60*60*1e3)))}const _2="Could not fetch config, will use default configs";function b2(n,e){return n2(n.installations).then(t=>{const a=h2(n.app),o=f2(n.app),c=`https://firebaseremoteconfig.googleapis.com/v1/projects/${a}/namespaces/fireperf:fetch?key=${o}`,d=new Request(c,{method:"POST",headers:{Authorization:`${p2} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:ij(n.app),app_version:$A,sdk_version:m2})});return fetch(d).then(m=>{if(m.ok)return m.json();throw mn.create("RC response not ok")})}).catch(()=>{Ii.info(_2)})}function Nx(n){if(!n)return n;const e=Hn.getInstance(),t=n.entries||{};return t.fpr_enabled!==void 0?e.loggingEnabled=String(t.fpr_enabled)==="true":e.loggingEnabled=gs.loggingEnabled,t.fpr_log_source?e.logSource=Number(t.fpr_log_source):gs.logSource&&(e.logSource=gs.logSource),t.fpr_log_endpoint_url?e.logEndPointUrl=t.fpr_log_endpoint_url:gs.logEndPointUrl&&(e.logEndPointUrl=gs.logEndPointUrl),t.fpr_log_transport_key?e.transportKey=t.fpr_log_transport_key:gs.transportKey&&(e.transportKey=gs.transportKey),t.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(t.fpr_vc_network_request_sampling_rate):gs.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=gs.networkRequestsSamplingRate),t.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(t.fpr_vc_trace_sampling_rate):gs.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=gs.tracesSamplingRate),e.logTraceAfterSampling=xx(e.tracesSamplingRate),e.logNetworkAfterSampling=xx(e.networkRequestsSamplingRate),n}function E2(n){return Number(n)>Date.now()}function xx(n){return Math.random()<=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gv=1,zp;function rj(n){return Gv=2,zp=zp||x2(n),zp}function N2(){return Gv===3}function x2(n){return T2().then(()=>t2(n.installations)).then(e=>g2(n,e)).then(()=>Tx(),()=>Tx())}function T2(){const n=Ht.getInstance().document;return new Promise(e=>{if(n&&n.readyState!=="complete"){const t=()=>{n.readyState==="complete"&&(n.removeEventListener("readystatechange",t),e())};n.addEventListener("readystatechange",t)}else e()})}function Tx(){Gv=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oj=10*1e3,A2=5.5*1e3,j2=1e3,lj=3;let uh=lj,wr=[],Ax=!1;function w2(){Ax||($v(A2),Ax=!0)}function $v(n){setTimeout(()=>{uh<=0||(wr.length>0&&cj(),$v(oj))},n)}function cj(){const n=wr.splice(0,j2),e=n.map(a=>({source_extension_json_proto3:a.message,event_time_ms:String(a.eventTime)})),t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Hn.getInstance().logSource,log_event:e};C2(t).then(()=>{uh=lj}).catch(()=>{wr=[...n,...wr],uh--,Ii.info(`Tries left: ${uh}.`),$v(oj)})}function C2(n){const e=Hn.getInstance().getFlTransportFullUrl(),t=JSON.stringify(n);return navigator.sendBeacon&&navigator.sendBeacon(e,t)?Promise.resolve():fetch(e,{method:"POST",body:t,keepalive:!0}).then()}function S2(n){if(!n.eventTime||!n.message)throw mn.create("invalid cc log");wr=[...wr,n]}function I2(n){return(...e)=>{const t=n(...e);S2({message:t,eventTime:Date.now()})}}function R2(){for(;wr.length>0;)cj()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qc;function uj(n,e){qc||(qc={send:I2(O2),flush:R2}),qc.send(n,e)}function Jd(n){const e=Hn.getInstance();!e.instrumentationEnabled&&n.isAuto||!e.dataCollectionEnabled&&!n.isAuto||Ht.getInstance().requiredApisAvailable()&&(N2()?Gp(n):rj(n.performanceController).then(()=>Gp(n),()=>Gp(n)))}function D2(){qc&&qc.flush()}function Gp(n){if(!zv())return;const e=Hn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||uj(n,1)}function M2(n){const e=Hn.getInstance();if(!e.instrumentationEnabled)return;const t=n.url,a=e.logEndPointUrl.split("?")[0],o=e.flTransportEndpointUrl.split("?")[0];t===a||t===o||!e.loggingEnabled||!e.logNetworkAfterSampling||uj(n,0)}function O2(n,e){return e===0?k2(n):P2(n)}function k2(n){const e={url:n.url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},t={application_info:dj(n.performanceController.app),network_request_metric:e};return JSON.stringify(t)}function P2(n){const e={name:n.name,is_auto:n.isAuto,client_start_time_us:n.startTimeUs,duration_us:n.durationUs};Object.keys(n.counters).length!==0&&(e.counters=n.counters);const t=n.getAttributes();Object.keys(t).length!==0&&(e.custom_attributes=t);const a={application_info:dj(n.performanceController.app),trace_metric:e};return JSON.stringify(a)}function dj(n){return{google_app_id:ij(n),app_instance_id:zv(),web_app_info:{sdk_version:$A,page_url:Ht.getInstance().getUrl(),service_worker_status:o2(),visibility_state:l2(),effective_connection_type:c2()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jx(n,e){const t=e;if(!t||t.responseStart===void 0)return;const a=Ht.getInstance().getTimeOrigin(),o=Math.floor((t.startTime+a)*1e3),c=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,d=Math.floor((t.responseEnd-t.startTime)*1e3),m=t.name&&t.name.split("?")[0],p={performanceController:n,url:m,responsePayloadBytes:t.transferSize,startTimeUs:o,timeToResponseInitiatedUs:c,timeToResponseCompletedUs:d};M2(p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2=100,V2="_",U2=[KA,QA,XA,WA,JA,ZA];function F2(n,e){return n.length===0||n.length>L2?!1:e&&e.startsWith(YA)&&U2.indexOf(n)>-1||!n.startsWith(V2)}function q2(n){const e=Math.floor(n);return e<n&&Ii.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,t,a=!1,o){this.performanceController=e,this.name=t,this.isAuto=a,this.state=1,this.customAttributes={},this.counters={},this.api=Ht.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${YP}-${this.randomId}-${this.name}`,this.traceStopMark=`${KP}-${this.randomId}-${this.name}`,this.traceMeasure=o||`${Tg}-${this.randomId}-${this.name}`,o&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw mn.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw mn.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Jd(this)}record(e,t,a){if(e<=0)throw mn.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw mn.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(t*1e3),this.startTimeUs=Math.floor(e*1e3),a&&a.attributes&&(this.customAttributes=Object.assign({},a.attributes)),a&&a.metrics)for(const o of Object.keys(a.metrics))isNaN(Number(a.metrics[o]))||(this.counters[o]=Math.floor(Number(a.metrics[o])));Jd(this)}incrementMetric(e,t=1){this.counters[e]===void 0?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(F2(e,this.name))this.counters[e]=q2(t??0);else throw mn.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const a=u2(e),o=d2(t);if(a&&o){this.customAttributes[e]=t;return}if(!a)throw mn.create("invalid attribute name",{attributeName:e});if(!o)throw mn.create("invalid attribute value",{attributeValue:t})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(t.duration*1e3),this.startTimeUs=Math.floor((t.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,t,a,o,c){const d=Ht.getInstance().getUrl();if(!d)return;const m=new eu(e,YA+d,!0),p=Math.floor(Ht.getInstance().getTimeOrigin()*1e3);m.setStartTime(p),t&&t[0]&&(m.setDuration(Math.floor(t[0].duration*1e3)),m.putMetric("domInteractive",Math.floor(t[0].domInteractive*1e3)),m.putMetric("domContentLoadedEventEnd",Math.floor(t[0].domContentLoadedEventEnd*1e3)),m.putMetric("loadEventEnd",Math.floor(t[0].loadEventEnd*1e3)));const v="first-paint",_="first-contentful-paint";if(a){const b=a.find(j=>j.name===v);b&&b.startTime&&m.putMetric(KA,Math.floor(b.startTime*1e3));const T=a.find(j=>j.name===_);T&&T.startTime&&m.putMetric(QA,Math.floor(T.startTime*1e3)),c&&m.putMetric(XA,Math.floor(c*1e3))}this.addWebVitalMetric(m,WA,QP,o.lcp),this.addWebVitalMetric(m,JA,WP,o.cls),this.addWebVitalMetric(m,ZA,XP,o.inp),Jd(m),D2()}static addWebVitalMetric(e,t,a,o){o&&(e.putMetric(t,Math.floor(o.value*1e3)),o.elementAttribution&&e.putAttribute(a,o.elementAttribution))}static createUserTimingTrace(e,t){const a=new eu(e,t,!1,t);Jd(a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dh={},wx=!1,hj;function Cx(n){zv()&&(setTimeout(()=>H2(n),0),setTimeout(()=>B2(n),0),setTimeout(()=>z2(n),0))}function B2(n){const e=Ht.getInstance(),t=e.getEntriesByType("resource");for(const a of t)jx(n,a);e.setupObserver("resource",a=>jx(n,a))}function H2(n){const e=Ht.getInstance();"onpagehide"in window?e.document.addEventListener("pagehide",()=>$p(n)):e.document.addEventListener("unload",()=>$p(n)),e.document.addEventListener("visibilitychange",()=>{e.document.visibilityState==="hidden"&&$p(n)}),e.onFirstInputDelay&&e.onFirstInputDelay(t=>{hj=t}),e.onLCP(t=>{var a;dh.lcp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.element}}),e.onCLS(t=>{var a;dh.cls={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.largestShiftTarget}}),e.onINP(t=>{var a;dh.inp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.interactionTarget}})}function z2(n){const e=Ht.getInstance(),t=e.getEntriesByType("measure");for(const a of t)Sx(n,a);e.setupObserver("measure",a=>Sx(n,a))}function Sx(n,e){const t=e.name;t.substring(0,Tg.length)!==Tg&&eu.createUserTimingTrace(n,t)}function $p(n){if(!wx){wx=!0;const e=Ht.getInstance(),t=e.getEntriesByType("navigation"),a=e.getEntriesByType("paint");setTimeout(()=>{eu.createOobTrace(n,t,a,dh,hj)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(e?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),e?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),Ht.getInstance().requiredApisAvailable()?qh().then(t=>{t&&(w2(),rj(this).then(()=>Cx(this),()=>Cx(this)),this.initialized=!0)}).catch(t=>{Ii.info(`Environment doesn't support IndexedDB: ${t}`)}):Ii.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Hn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Hn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Hn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Hn.getInstance().dataCollectionEnabled}}const $2="[DEFAULT]";function Y2(n=au()){return n=vt(n),Ma(n,"performance").getImmediate()}const K2=(n,{options:e})=>{const t=n.getProvider("app").getImmediate(),a=n.getProvider("installations-internal").getImmediate();if(t.name!==$2)throw mn.create("FB not default");if(typeof window>"u")throw mn.create("no window");e2(window);const o=new G2(t,a);return o._init(e),o};function Q2(){os(new $n("performance",K2,"PUBLIC")),pn(bx,xg),pn(bx,xg,"esm2017")}Q2();const X2={apiKey:"AIzaSyCbU834quCY8hjSffRwljJLgZrcxK8i2F4",authDomain:"liquidacionapp-62962.firebaseapp.com",projectId:"liquidacionapp-62962",storageBucket:"liquidacionapp-62962.firebasestorage.app",messagingSenderId:"851382130132",appId:"1:851382130132:web:eaba38fab449f14fb5b241",measurementId:void 0},tu=Zx(X2),Bc=T1(tu),ge=TO(tu);ck(tu);let W2=null,Z2=null;try{IP().then(n=>{n&&(W2=CP(tu))}).catch(()=>{console.warn("Firebase Analytics no está soportado en este entorno")}),typeof window<"u"&&(Z2=Y2(tu))}catch(n){console.warn("Error al inicializar Firebase Analytics/Performance:",n)}const ys={ADMIN:"admin",CONTADOR:"contador",CLIENTE:"cliente"},ht={MANAGE_INVENTORY:"canManageInventory",CREATE_MOVEMENTS:"canCreateMovements",VIEW_ALL_MOVEMENTS:"canViewAllMovements",MANAGE_VEHICLES:"canManageVehicles",MANAGE_MAINTENANCE:"canManageMaintenance",MANAGE_SUPPLIERS:"canManageSuppliers",VIEW_REPORTS:"canViewReports",EXPORT_REPORTS:"canExportReports",MODIFY_SETTINGS:"canModifySettings"},J2="contacto.evert@gmail.com",fj=n=>{switch(n){case ys.ADMIN:return{[ht.MANAGE_INVENTORY]:!0,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!0,[ht.MANAGE_VEHICLES]:!0,[ht.MANAGE_MAINTENANCE]:!0,[ht.MANAGE_SUPPLIERS]:!0,[ht.VIEW_REPORTS]:!0,[ht.EXPORT_REPORTS]:!0,[ht.MODIFY_SETTINGS]:!0};case ys.CONTADOR:return{[ht.MANAGE_INVENTORY]:!0,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!0,[ht.MANAGE_VEHICLES]:!1,[ht.MANAGE_MAINTENANCE]:!0,[ht.MANAGE_SUPPLIERS]:!1,[ht.VIEW_REPORTS]:!0,[ht.EXPORT_REPORTS]:!0,[ht.MODIFY_SETTINGS]:!1};case ys.CLIENTE:default:return{[ht.MANAGE_INVENTORY]:!1,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!1,[ht.MANAGE_VEHICLES]:!1,[ht.MANAGE_MAINTENANCE]:!1,[ht.MANAGE_SUPPLIERS]:!1,[ht.VIEW_REPORTS]:!1,[ht.EXPORT_REPORTS]:!1,[ht.MODIFY_SETTINGS]:!1}}},eL=n=>n===J2?ys.ADMIN:ys.CLIENTE,nl=()=>"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/invitations",tL=()=>{const n="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let e="";for(let t=0;t<8;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},nL=async(n,e)=>{try{const t=await yf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden crear invitaciones"};let a,o=!1,c=0;for(;!o&&c<10;){a=tL();const p=Ae(Pe(ge,nl()),Oe("code","==",a));(await yt(p)).empty&&(o=!0),c++}if(!o)return{success:!1,error:"No se pudo generar un código único"};const d=st(Pe(ge,nl())),m={code:a,targetEmail:n.email.toLowerCase(),targetRole:n.role||ys.CLIENTE,targetName:n.name||"",status:"pending",appContext:"combustibles",expiresAt:new Date(Date.now()+7*24*60*60*1e3),createdAt:et(),createdBy:e,usedAt:null,usedBy:null};return await df(d,m),console.log("🎫 Invitación creada:",{code:a,email:n.email,role:n.role}),{success:!0,invitation:{id:d.id,code:a,...m}}}catch(t){return console.error("Error creating invitation:",t),{success:!1,error:t.message}}},mj=async n=>{try{const e=Ae(Pe(ge,nl()),Oe("code","==",n.toUpperCase()),Oe("status","==","pending")),t=await yt(e);if(t.empty)return{success:!1,error:"Código de invitación inválido o expirado"};const a=t.docs[0],o=a.data(),c=new Date,d=o.expiresAt.toDate();return c>d?{success:!1,error:"Código de invitación expirado"}:{success:!0,invitation:{id:a.id,...o}}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},sL=async(n,e)=>{try{const t=st(ge,nl(),n);return await xs(t,{status:"used",usedAt:et(),usedBy:e}),{success:!0}}catch(t){return console.error("Error marking invitation as used:",t),{success:!1,error:t.message}}},aL=async n=>{try{const e=await yf(n);if(!e.success||e.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden ver invitaciones"};const t=Ae(Pe(ge,nl())),a=await yt(t),o=[];return a.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,d)=>{const m=c.createdAt?.toDate()||new Date(0);return(d.createdAt?.toDate()||new Date(0))-m}),{success:!0,invitations:o}}catch(e){return console.error("Error getting invitations:",e),{success:!1,error:e.message}}},iL=async(n,e)=>{try{const t=await yf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden cancelar invitaciones"};const a=st(ge,nl(),n);return await xs(a,{status:"cancelled",cancelledAt:et(),cancelledBy:e}),{success:!0}}catch(t){return console.error("Error cancelling invitation:",t),{success:!1,error:t.message}}},rL=n=>fj(n.targetRole),pj=async(n,e={})=>{const t=st(ge,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const a=await Li(t);if(a.exists())return{success:!0,userData:a.data(),isNewUser:!1};{const o=eL(n.email),c={uid:n.uid,email:n.email,displayName:n.displayName||"",photoURL:n.photoURL||"",role:o,emailVerified:n.emailVerified,combustiblesPermissions:fj(o),createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...e};return await df(t,c),{success:!0,userData:c,isNewUser:!0}}}catch(a){return console.error("Error creating/updating user profile:",a),{success:!1,error:a.message}}},Ix=async(n,e,t={})=>{const a=st(ge,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const o=await Li(a);if(o.exists())return{success:!0,userData:o.data(),isNewUser:!1};const c=await mj(e);if(!c.success)return c;const d=c.invitation;if(d.targetEmail!==n.email.toLowerCase())return{success:!1,error:"El código de invitación no corresponde a este email"};const m={uid:n.uid,email:n.email,displayName:n.displayName||d.targetName||"",photoURL:n.photoURL||"",role:d.targetRole,emailVerified:n.emailVerified,combustiblesPermissions:rL(d),invitationUsed:d.id,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...t};return await df(a,m),await sL(d.id,n.uid),console.log("👤 Usuario creado con invitación:",{email:n.email,role:d.targetRole,invitationCode:d.code}),{success:!0,userData:m,isNewUser:!0}}catch(o){return console.error("Error creating user profile with invitation:",o),{success:!1,error:o.message}}},yf=async n=>{try{const e=st(ge,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n),t=await Li(e);return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"Usuario no encontrado"}}catch(e){return console.error("Error fetching user profile:",e),{success:!1,error:e.message}}},Fr="combustibles_movements",jr="combustibles_inventory",pe={ENTRADA:"entrada",SALIDA:"salida",TRANSFERENCIA:"transferencia",AJUSTE:"ajuste"},He={PENDIENTE:"pendiente",COMPLETADO:"completado",CANCELADO:"cancelado"},gj=async n=>{try{lL(n);const e={...n,createdAt:et(),updatedAt:et(),status:He.COMPLETADO,approvedAt:et(),totalValue:bj(n),effectiveDate:n.effectiveDate||et()},t=await Rv(ge,async a=>{const o=st(Pe(ge,Fr));return a.set(o,e),await Ej(a,e,o.id),o.id});return console.log("✅ Movimiento creado exitosamente:",t),t}catch(e){throw console.error("❌ Error al crear movimiento:",e),new Error(`Error al crear movimiento: ${e.message}`)}},vj=async(n={})=>{try{let e=Pe(ge,Fr);n.type&&(e=Ae(e,Oe("type","==",n.type))),n.status&&(e=Ae(e,Oe("status","==",n.status))),n.fuelType&&(e=Ae(e,Oe("fuelType","==",n.fuelType))),n.vehicleId&&(e=Ae(e,Oe("vehicleId","==",n.vehicleId))),e=Ae(e,jn("createdAt","desc"));const t=await yt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,effectiveDate:o.data().effectiveDate?.toDate?.()||o.data().effectiveDate})}),a}catch(e){throw console.error("❌ Error al obtener movimientos:",e),new Error(`Error al obtener movimientos: ${e.message}`)}},Yv=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=st(ge,Fr,n),t=await Li(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate?.()||t.data().createdAt,updatedAt:t.data().updatedAt?.toDate?.()||t.data().updatedAt,effectiveDate:t.data().effectiveDate?.toDate?.()||t.data().effectiveDate}:null}catch(e){throw console.error("❌ Error al obtener movimiento:",e),new Error(`Error al obtener movimiento: ${e.message}`)}},Kv=async(n,e)=>{try{if(!n)throw new Error("ID de movimiento requerido");const t={...e,updatedAt:et(),...e.quantity||e.unitPrice?{totalValue:bj(e)}:{}},a=st(ge,Fr,n);await xs(a,t),console.log("✅ Movimiento actualizado exitosamente")}catch(t){throw console.error("❌ Error al actualizar movimiento:",t),new Error(`Error al actualizar movimiento: ${t.message}`)}},oL=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=await Yv(n);if(!e)throw new Error("Movimiento no encontrado");await Rv(ge,async t=>{const a=st(ge,Fr,n);e.status===He.COMPLETADO&&await cL(t,e),t.delete(a)}),console.log("✅ Movimiento eliminado y cambios de inventario revertidos exitosamente")}catch(e){throw console.error("❌ Error al eliminar movimiento:",e),new Error(`Error al eliminar movimiento: ${e.message}`)}},Qv=(n,e={})=>{try{let t=Pe(ge,Fr);return e.type&&(t=Ae(t,Oe("type","==",e.type))),e.status&&(t=Ae(t,Oe("status","==",e.status))),t=Ae(t,jn("createdAt","desc")),Ur(t,a=>{const o=[];a.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,effectiveDate:c.data().effectiveDate?.toDate?.()||c.data().effectiveDate})}),n(o)},a=>{console.error("❌ Error en suscripción de movimientos:",a),n([],a)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},yj=async n=>{try{const e=await Yv(n);if(!e)throw new Error("Movimiento no encontrado");if(e.status!==He.PENDIENTE)throw new Error("Solo se pueden aprobar movimientos pendientes");await Rv(ge,async t=>{const a=st(ge,Fr,n);t.update(a,{status:He.COMPLETADO,approvedAt:et(),updatedAt:et()}),await Ej(t,e,n)}),console.log("✅ Movimiento aprobado exitosamente")}catch(e){throw console.error("❌ Error al aprobar movimiento:",e),new Error(`Error al aprobar movimiento: ${e.message}`)}},_j=async(n={})=>{try{const e=await vj(n),t={totalMovements:e.length,byType:{},byStatus:{},byFuelType:{},totalValue:0,totalQuantity:0,averageValue:0,thisMonth:0,lastMonth:0,thisWeek:0},a=new Date,o=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()-1,1),d=new Date(a.setDate(a.getDate()-a.getDay()));return e.forEach(m=>{t.byType[m.type]=(t.byType[m.type]||0)+1,t.byStatus[m.status]=(t.byStatus[m.status]||0)+1,t.byFuelType[m.fuelType]=(t.byFuelType[m.fuelType]||0)+1,t.totalValue+=m.totalValue||0,t.totalQuantity+=m.quantity||0;const p=new Date(m.createdAt);p>=o&&t.thisMonth++,p>=c&&p<o&&t.lastMonth++,p>=d&&t.thisWeek++}),t.averageValue=t.totalMovements>0?t.totalValue/t.totalMovements:0,t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},lL=n=>{const e=["type","fuelType","quantity","unitPrice"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!Object.values(pe).includes(n.type))throw new Error("Tipo de movimiento inválido");if(n.quantity<=0)throw new Error("La cantidad debe ser mayor a cero");if(n.unitPrice<0)throw new Error("El precio unitario no puede ser negativo");if(n.type===pe.SALIDA&&!n.vehicleId)throw new Error("Las salidas deben tener un vehículo asociado");if(n.type===pe.TRANSFERENCIA&&!n.destinationLocation)throw new Error("Las transferencias deben tener una ubicación destino")},bj=n=>(n.quantity||0)*(n.unitPrice||0),Ej=async(n,e,t)=>{try{let a=e.location||"principal";e.type===pe.ENTRADA&&(a=e.destinationLocation||"principal");const o=Ae(Pe(ge,jr),Oe("fuelType","==",e.fuelType),Oe("location","==",a)),c=await yt(o);let d,m,p=0;if(c.empty)if(e.type===pe.ENTRADA)console.log(`📦 Creando inventario automático para ${e.fuelType} en ${a}`),d=st(Pe(ge,jr)),m={fuelType:e.fuelType,location:a,capacity:1e3,currentStock:0,minStock:50,unitPrice:e.unitPrice||0,createdAt:et(),updatedAt:et(),isActive:!0},n.set(d,m),p=e.quantity;else throw new Error(`No se encontró inventario para ${e.fuelType} en ${a}`);else{const v=c.docs[0];m=v.data(),d=st(ge,jr,v.id),p=m.currentStock}switch(e.type){case pe.ENTRADA:p+=e.quantity;break;case pe.SALIDA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la salida");break;case pe.AJUSTE:p+=e.quantity,p<0&&(p=0);break;case pe.TRANSFERENCIA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la transferencia");break}n.update(d,{currentStock:p,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:et()},updatedAt:et()}),e.type===pe.SALIDA&&e.vehicleId&&e.currentHours&&await uL(n,e.vehicleId,e.currentHours)}catch(a){throw console.error("❌ Error al actualizar inventario:",a),a}},cL=async(n,e)=>{try{console.log("🔄 Revirtiendo cambios de inventario para movimiento:",e.id);let t;switch(e.type){case pe.ENTRADA:t=e.destinationLocation||"principal";break;case pe.SALIDA:case pe.AJUSTE:t=e.location||"principal";break;case pe.TRANSFERENCIA:t=e.location||"principal";break;default:t=e.location||e.destinationLocation||"principal"}console.log(`🔍 Buscando inventario: ${e.fuelType} en ${t}`);const a=Ae(Pe(ge,jr),Oe("fuelType","==",e.fuelType),Oe("location","==",t)),o=await yt(a);if(o.empty){console.warn(`⚠️ No se encontró inventario para ${e.fuelType} en ${t}`);const p=Ae(Pe(ge,jr),Oe("fuelType","==",e.fuelType)),v=await yt(p);if(v.empty)throw console.error(`❌ No existe inventario para ${e.fuelType} en ninguna ubicación`),new Error(`No se puede revertir: no existe inventario para ${e.fuelType} en ninguna ubicación. Movimiento huérfano detectado.`);console.log(`🔄 Usando inventario fallback en ${v.docs[0].data().location}`);const _=v.docs[0],b=_.data(),T=st(ge,jr,_.id);await Rx(n,T,b,e);return}const c=o.docs[0],d=c.data(),m=st(ge,jr,c.id);await Rx(n,m,d,e)}catch(t){throw console.error("❌ Error al revertir cambios de inventario:",t),new Error(`Error al revertir inventario: ${t.message}`)}},Rx=async(n,e,t,a)=>{try{let o=t.currentStock;switch(a.type){case pe.ENTRADA:o-=a.quantity,o<0&&(console.warn("⚠️ Advertencia: La reversión resulta en stock negativo, ajustando a 0"),o=0);break;case pe.SALIDA:o+=a.quantity;break;case pe.AJUSTE:o-=a.quantity,o<0&&(console.warn("⚠️ Advertencia: La reversión de ajuste resulta en stock negativo, ajustando a 0"),o=0);break;case pe.TRANSFERENCIA:o+=a.quantity;break;default:throw new Error(`Tipo de movimiento no soportado para reversión: ${a.type}`)}n.update(e,{currentStock:o,lastMovement:{movementId:null,type:"reversion",quantity:a.quantity,originalType:a.type,date:et(),note:`Reversión de movimiento ${a.id} - Ubicación original: ${a.location||a.destinationLocation||"no especificada"}`},updatedAt:et()}),console.log(`✅ Inventario revertido exitosamente. Stock anterior: ${t.currentStock}, Nuevo stock: ${o}`)}catch(o){throw console.error("❌ Error en procesamiento de reversión:",o),o}},uL=async(n,e,t)=>{try{console.log(`🕒 Actualizando horómetro del vehículo ${e} a ${t} horas`);const a=Ae(Pe(ge,"combustibles_vehicles"),Oe("vehicleId","==",e)),o=await yt(a);if(o.empty){console.warn(`⚠️ Vehículo ${e} no encontrado para actualizar horómetro`);return}const c=o.docs[0],d=c.data(),m=st(ge,"combustibles_vehicles",c.id),p=parseFloat(d.currentHours)||0,v=parseFloat(t);v<p&&console.warn(`⚠️ Nueva lectura horómetro (${v}) menor a la anterior (${p}). Actualizando de todas formas.`);const _=d.hourMeterHistory||[];_.push({previousHours:p,newHours:v,difference:v-p,updatedAt:new Date,updatedBy:"movement_service",source:"fuel_consumption"}),n.update(m,{currentHours:v,hourMeterHistory:_,lastHourMeterUpdate:et(),updatedAt:et()}),console.log(`✅ Horómetro actualizado: ${e} - ${p}h → ${v}h`)}catch(a){console.error("❌ Error al actualizar horómetro del vehículo:",a),console.warn("⚠️ Continuando con el movimiento sin actualización de horómetro")}},Dx={createMovement:gj,getAllMovements:vj,getMovement:Yv,updateMovement:Kv,deleteMovement:oL,subscribeToMovements:Qv,approveMovement:yj,getMovementsStats:_j,MOVEMENT_TYPES:pe,MOVEMENT_STATUS:He},Nn={DIESEL:"diesel",GASOLINE:"gasoline",ACPM:"acpm",LUBRICANTS:"lubricants",TWO_STROKE:"two_stroke",MIXED:"mixed"},sl={[Nn.DIESEL]:{name:"Diésel",description:"Combustible para maquinaria pesada",unit:"galones",category:"Combustible",color:"#fbbf24",icon:"🚛",density:.85,priceUnit:"COP/galón"},[Nn.GASOLINE]:{name:"Gasolina",description:"Combustible para vehículos livianos",unit:"galones",category:"Combustible",color:"#ef4444",icon:"⛽",density:.75,priceUnit:"COP/galón"},[Nn.ACPM]:{name:"ACPM",description:"Aceite Combustible Para Motor",unit:"galones",category:"Combustible",color:"#8b5cf6",icon:"🚜",density:.85,priceUnit:"COP/galón"},[Nn.LUBRICANTS]:{name:"Lubricantes",description:"Aceites y lubricantes para mantenimiento",unit:"litros",category:"Mantenimiento",color:"#06b6d4",icon:"🛢️",density:.9,priceUnit:"COP/litro"},[Nn.TWO_STROKE]:{name:"Mezcla 2T",description:"Mezcla para motores de 2 tiempos (motosierras)",unit:"litros",category:"Especializado",color:"#10b981",icon:"🪚",density:.78,priceUnit:"COP/litro"},[Nn.MIXED]:{name:"Mixto",description:"Compatible con múltiples tipos de combustible",unit:"galones",category:"Flexible",color:"#64748b",icon:"🔄",density:.8,priceUnit:"COP/galón"}},En={CRITICAL:"critical",LOW:"low",MEDIUM:"medium",HIGH:"high",FULL:"full"},Bo={[En.CRITICAL]:{label:"Crítico",color:"#dc2626",icon:"🚨",threshold:.1},[En.LOW]:{label:"Bajo",color:"#ea580c",icon:"⚠️",threshold:.25},[En.MEDIUM]:{label:"Medio",color:"#ca8a04",icon:"📊",threshold:.5},[En.HIGH]:{label:"Alto",color:"#16a34a",icon:"✅",threshold:.75},[En.FULL]:{label:"Completo",color:"#059669",icon:"🟢",threshold:1}},Nj=(n,e)=>{if(e===0)return En.CRITICAL;const t=n/e;return t<Bo[En.CRITICAL].threshold?En.CRITICAL:t<Bo[En.LOW].threshold?En.LOW:t<Bo[En.MEDIUM].threshold?En.MEDIUM:t<Bo[En.HIGH].threshold?En.HIGH:En.FULL},al="combustibles_inventory",dL=async(n,e)=>{try{const t=sl[n.fuelType];if(!t)return{success:!1,error:"Tipo de combustible no válido"};const a=Ae(Pe(ge,al),Oe("fuelType","==",n.fuelType),Oe("location","==",n.location));if(!(await yt(a)).empty)return{success:!1,error:`Ya existe ${t.name} en ${n.location}`};const c={fuelType:n.fuelType,name:t.name,description:n.description||t.description,currentStock:Number(n.currentStock)||0,maxCapacity:Number(n.maxCapacity),minThreshold:Number(n.minThreshold)||n.maxCapacity*.15,unit:t.unit,location:n.location,pricePerUnit:Number(n.pricePerUnit)||0,supplier:n.supplier||"",status:n.status||"active",createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await hl(Pe(ge,al),c)).id,...c},message:`${t.name} agregado al inventario exitosamente`}}catch(t){return console.error("Error creating inventory item:",t),{success:!1,error:t.message}}},xj=async()=>{try{const n=Ae(Pe(ge,al),jn("fuelType","asc")),e=await yt(n),t=[];return e.forEach(a=>{const o=a.data();t.push({id:a.id,...o,stockLevel:Nj(o.currentStock,o.maxCapacity),stockPercentage:Math.round(o.currentStock/o.maxCapacity*100),needsRestock:o.currentStock<=o.minThreshold})}),{success:!0,data:t}}catch(n){return console.error("Error fetching inventory items:",n),{success:!1,error:n.message}}},hL=async(n,e,t)=>{try{const a=st(ge,al,n);if(!(await Li(a)).exists())return{success:!1,error:"Item no encontrado"};const c={...e,lastUpdated:new Date,updatedBy:t};return delete c.id,delete c.createdAt,delete c.createdBy,await xs(a,c),{success:!0,message:"Item actualizado exitosamente",data:{id:n,...c}}}catch(a){return console.error("Error updating inventory item:",a),{success:!1,error:a.message}}},fL=async n=>{try{const e=st(ge,al,n);return(await Li(e)).exists()?(await hf(e),{success:!0,message:"Item eliminado exitosamente"}):{success:!1,error:"Item no encontrado"}}catch(e){return console.error("Error deleting inventory item:",e),{success:!1,error:e.message}}},Tj=n=>{const e=Ae(Pe(ge,al),jn("fuelType","asc"));return Ur(e,t=>{const a=[];t.forEach(o=>{const c=o.data();a.push({id:o.id,...c,stockLevel:Nj(c.currentStock,c.maxCapacity),stockPercentage:Math.round(c.currentStock/c.maxCapacity*100),needsRestock:c.currentStock<=c.minThreshold})}),n(a)},t=>{console.error("Error in inventory subscription:",t),n(null,t)})},mL=async()=>{try{const n=await xj();if(!n.success)return n;const e=n.data,t={totalItems:e.length,activeItems:e.filter(a=>a.status==="active").length,lowStockItems:e.filter(a=>a.needsRestock).length,totalValue:e.reduce((a,o)=>a+o.currentStock*o.pricePerUnit,0),averageStockLevel:e.length>0?Math.round(e.reduce((a,o)=>a+o.stockPercentage,0)/e.length):0,byFuelType:{}};return e.forEach(a=>{t.byFuelType[a.fuelType]||(t.byFuelType[a.fuelType]={count:0,totalStock:0,totalCapacity:0,totalValue:0}),t.byFuelType[a.fuelType].count++,t.byFuelType[a.fuelType].totalStock+=a.currentStock,t.byFuelType[a.fuelType].totalCapacity+=a.maxCapacity,t.byFuelType[a.fuelType].totalValue+=a.currentStock*a.pricePerUnit}),{success:!0,data:t}}catch(n){return console.error("Error calculating inventory stats:",n),{success:!1,error:n.message}}},rs=[{id:"maquinaria_pesada",name:"Maquinaria Pesada",description:"Excavadoras, bulldozers, cargadores, grúas",icon:"🏗️",color:"#FF6B35",fuelTypes:["Diesel","ACPM"],fields:["enginePower","operatingWeight","bucketCapacity"]},{id:"transporte",name:"Transporte",description:"Camiones, camionetas, volquetas",icon:"🚛",color:"#2E86AB",fuelTypes:["Diesel","ACPM","Gasolina"],fields:["plateNumber","loadCapacity","enginePower"]},{id:"herramientas_motorizadas",name:"Herramientas Motorizadas",description:"Motosierras, guadañas, fumigadoras",icon:"🔧",color:"#A23B72",fuelTypes:["Gasolina","Mixto"],fields:["enginePower","weight"]},{id:"equipos_bombeo",name:"Equipos de Bombeo",description:"Motobombas, hidrolavadoras, plantas eléctricas",icon:"💧",color:"#F18F01",fuelTypes:["Diesel","Gasolina"],fields:["flow","pressure","enginePower"]},{id:"vehiculos_ligeros",name:"Vehículos Ligeros",description:"Motocicletas, cuatrimotos, vehículos de apoyo",icon:"🏍️",color:"#C73E1D",fuelTypes:["Gasolina"],fields:["plateNumber","enginePower"]},{id:"agricola",name:"Agrícola/Forestal",description:"Tractores, asperjadoras, equipos forestales",icon:"🚜",color:"#2F7D32",fuelTypes:["Diesel","ACPM"],fields:["enginePower","hasHourMeter","implementType"]},{id:"otros",name:"Otros",description:"Equipos especializados y otros vehículos",icon:"⚙️",color:"#616161",fuelTypes:["Diesel","Gasolina","ACPM","Mixto"],fields:["enginePower"]}],Ve={ACTIVO:"activo",MANTENIMIENTO:"mantenimiento",INACTIVO:"inactivo",REPARACION:"reparacion",FUERA_DE_SERVICIO:"fuera_de_servicio"},Aj={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},Mx=[{key:"plateNumber",label:"Número de Placa",type:"text",icon:"🏷️"},{key:"enginePower",label:"Potencia del Motor (HP)",type:"number",icon:"⚡"},{key:"fuelCapacity",label:"Capacidad de Combustible (Litros)",type:"number",icon:"⛽"},{key:"operatingWeight",label:"Peso Operativo (Toneladas)",type:"number",icon:"⚖️"},{key:"loadCapacity",label:"Capacidad de Carga (Toneladas)",type:"number",icon:"📦"},{key:"bucketCapacity",label:"Capacidad de Balde (m³)",type:"number",icon:"🪣"},{key:"hasHourMeter",label:"Tiene Horómetro",type:"boolean",icon:"⏰"},{key:"currentHours",label:"Horas Actuales",type:"number",icon:"🕐",dependsOn:"hasHourMeter"},{key:"implementType",label:"Tipo de Implemento",type:"text",icon:"🔧"},{key:"flow",label:"Caudal (L/min)",type:"number",icon:"💧"},{key:"pressure",label:"Presión (PSI)",type:"number",icon:"💨"},{key:"weight",label:"Peso (Kg)",type:"number",icon:"⚖️"}],Ox=(n,e=[])=>{const t=e.find(a=>a.id===n);return t||rs.find(a=>a.id===n)||null},jj=(n=[])=>{const e=rs.map(a=>a.id),t=n.filter(a=>!e.includes(a.id));return[...rs,...t]},wj=n=>{const e=[];return(!n.id||typeof n.id!="string")&&e.push("ID de categoría requerido y debe ser texto"),(!n.name||typeof n.name!="string")&&e.push("Nombre de categoría requerido y debe ser texto"),n.name&&n.name.length<2&&e.push("Nombre debe tener al menos 2 caracteres"),n.fuelTypes&&!Array.isArray(n.fuelTypes)&&e.push("Tipos de combustible debe ser un array"),n.fields&&!Array.isArray(n.fields)&&e.push("Campos debe ser un array"),{isValid:e.length===0,errors:e}},Cj=(n,e=[])=>{const t=n.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"");let a=t,o=1;for(;e.some(c=>c.id===a);)a=`${t}_${o}`,o++;return a},ml="combustibles_vehicles",gt={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},Sj=async n=>{try{if(pL(n),await Wv(n.vehicleId))throw new Error(`El código de vehículo '${n.vehicleId}' ya existe`);const t={...n,createdAt:et(),updatedAt:et(),status:n.status||Ve.ACTIVO,totalFuelConsumed:0,totalHoursWorked:0,totalMovements:0,lastMovementDate:null,estimatedConsumptionPerHour:Dj(n)},a=await hl(Pe(ge,ml),t);return console.log("✅ Vehículo creado exitosamente:",a.id),a.id}catch(e){throw console.error("❌ Error al crear vehículo:",e),new Error(`Error al crear vehículo: ${e.message}`)}},Xv=async(n={})=>{try{let e=Pe(ge,ml);n.type&&(e=Ae(e,Oe("type","==",n.type))),n.status&&(e=Ae(e,Oe("status","==",n.status))),n.fuelType&&(e=Ae(e,Oe("fuelType","==",n.fuelType))),n.location&&(e=Ae(e,Oe("currentLocation","==",n.location))),e=Ae(e,jn("vehicleId","asc"));const t=await yt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,lastMovementDate:o.data().lastMovementDate?.toDate?.()||o.data().lastMovementDate,lastMaintenanceDate:o.data().lastMaintenanceDate?.toDate?.()||o.data().lastMaintenanceDate})}),a}catch(e){throw console.error("❌ Error al obtener vehículos:",e),new Error(`Error al obtener vehículos: ${e.message}`)}},Wv=async n=>{try{const e=Ae(Pe(ge,ml),Oe("vehicleId","==",n)),t=await yt(e);if(t.empty)return null;const a=t.docs[0];return{id:a.id,...a.data(),createdAt:a.data().createdAt?.toDate?.()||a.data().createdAt,updatedAt:a.data().updatedAt?.toDate?.()||a.data().updatedAt,lastMovementDate:a.data().lastMovementDate?.toDate?.()||a.data().lastMovementDate,lastMaintenanceDate:a.data().lastMaintenanceDate?.toDate?.()||a.data().lastMaintenanceDate}}catch(e){throw console.error("❌ Error al buscar vehículo por código:",e),new Error(`Error al buscar vehículo: ${e.message}`)}},Ij=async(n,e)=>{try{if(!n)throw new Error("ID de vehículo requerido");if(e.vehicleId){const o=await Wv(e.vehicleId);if(o&&o.id!==n)throw new Error(`El código de vehículo '${e.vehicleId}' ya existe`)}const t={...e,updatedAt:et(),...e.enginePower||e.type?{estimatedConsumptionPerHour:Dj(e)}:{}},a=st(ge,ml,n);await xs(a,t),console.log("✅ Vehículo actualizado exitosamente")}catch(t){throw console.error("❌ Error al actualizar vehículo:",t),new Error(`Error al actualizar vehículo: ${t.message}`)}},Zv=(n,e={})=>{try{let t=Pe(ge,ml);const a=[];e.category&&a.push(Oe("category","==",e.category)),e.status&&a.push(Oe("status","==",e.status)),e.fuelType&&a.push(Oe("fuelType","==",e.fuelType)),e.currentLocation&&a.push(Oe("currentLocation","==",e.currentLocation)),a.forEach(c=>{t=Ae(t,c)}),t=Ae(t,jn("updatedAt","desc"));let o=null;return Ur(t,c=>{const d=Date.now();if(o&&d-o<500)return;o=d;const m=[],p={added:[],modified:[],removed:[]};c.docChanges().forEach(v=>{const _={id:v.doc.id,...v.doc.data(),createdAt:v.doc.data().createdAt?.toDate?.()||v.doc.data().createdAt,updatedAt:v.doc.data().updatedAt?.toDate?.()||v.doc.data().updatedAt,lastMovementDate:v.doc.data().lastMovementDate?.toDate?.()||v.doc.data().lastMovementDate,lastMaintenanceDate:v.doc.data().lastMaintenanceDate?.toDate?.()||v.doc.data().lastMaintenanceDate,lastHourMeterDate:v.doc.data().lastHourMeterDate?.toDate?.()||v.doc.data().lastHourMeterDate};v.type==="added"?p.added.push(_):v.type==="modified"?p.modified.push(_):v.type==="removed"&&p.removed.push({id:v.doc.id})}),c.forEach(v=>{m.push({id:v.id,...v.data(),createdAt:v.data().createdAt?.toDate?.()||v.data().createdAt,updatedAt:v.data().updatedAt?.toDate?.()||v.data().updatedAt,lastMovementDate:v.data().lastMovementDate?.toDate?.()||v.data().lastMovementDate,lastMaintenanceDate:v.data().lastMaintenanceDate?.toDate?.()||v.data().lastMaintenanceDate,lastHourMeterDate:v.data().lastHourMeterDate?.toDate?.()||v.data().lastHourMeterDate})}),n(m,null,p)},c=>{console.error("❌ Error en suscripción de vehículos:",c),n([],c)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},Rj=async(n={})=>{try{const e=await Xv(n),t={totalVehicles:e.length,byType:{},byStatus:{},byFuelType:{},totalFuelConsumed:0,totalHoursWorked:0,averageConsumption:0,mostActiveVehicle:null,leastActiveVehicle:null};let a=0,o=1/0;return e.forEach(c=>{t.byType[c.type]=(t.byType[c.type]||0)+1,t.byStatus[c.status]=(t.byStatus[c.status]||0)+1,t.byFuelType[c.fuelType]=(t.byFuelType[c.fuelType]||0)+1,t.totalFuelConsumed+=c.totalFuelConsumed||0,t.totalHoursWorked+=c.totalHoursWorked||0;const d=c.totalMovements||0;d>a&&(a=d,t.mostActiveVehicle=c),d<o&&d>0&&(o=d,t.leastActiveVehicle=c)}),t.totalHoursWorked>0&&(t.averageConsumption=t.totalFuelConsumed/t.totalHoursWorked),t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},pL=n=>{const e=["vehicleId","name","type","fuelType"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!n.type||n.type.trim().length===0)throw new Error("Tipo de vehículo requerido");if(!Object.values(gt).includes(n.fuelType))throw new Error("Tipo de combustible inválido");if(n.status&&!Object.values(Ve).includes(n.status))throw new Error("Estado de vehículo inválido");if(n.enginePower&&n.enginePower<=0)throw new Error("La potencia del motor debe ser mayor a cero");if(n.fuelCapacity&&n.fuelCapacity<=0)throw new Error("La capacidad de combustible debe ser mayor a cero")},Dj=n=>{const{type:e,enginePower:t,fuelType:a}=n,o={excavadora:.04,bulldozer:.05,cargador:.035,camion:.03,camioneta:.03,grua:.045,motosierra:.02,tractor:.025,volqueta:.035,motobomba:.035,fumigadora:.025,guadana:.02,motocicleta:.015,planta_electrica:.08,otros:.03},c={[gt.DIESEL]:1,[gt.GASOLINA]:1.2,[gt.ACPM]:.95,[gt.MIXTO]:1.1},d=o[e]||.03,m=c[a]||1;return d*(t||100)*m},gL=async n=>{try{const e=Ae(Pe(ge,ml),Oe("category","==",n));return(await yt(e)).size}catch(e){return console.error("❌ Error al contar vehículos por categoría:",e),0}},Mj=Object.freeze(Object.defineProperty({__proto__:null,FUEL_COMPATIBILITY:gt,FUEL_TYPES:Aj,VEHICLE_STATUS:Ve,countVehiclesByCategory:gL,createVehicle:Sj,getAllVehicles:Xv,getVehicleByCode:Wv,getVehiclesStats:Rj,subscribeToVehicles:Zv,updateVehicle:Ij},Symbol.toStringTag,{value:"Module"})),zs="combustibles_suppliers",vL=async(n,e)=>{try{const t=Ae(Pe(ge,zs),Oe("name","==",n.name.trim()));if(!(await yt(t)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${n.name}"`};if(n.taxId){const d=Ae(Pe(ge,zs),Oe("taxId","==",n.taxId.trim()));if(!(await yt(d)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${n.taxId}"`}}const o={name:n.name.trim(),taxId:n.taxId?.trim()||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson?.trim()||"",phone:n.phone?.trim()||"",email:n.email?.trim()||"",address:n.address?.trim()||"",city:n.city?.trim()||"",state:n.state?.trim()||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:Number(n.creditLimit)||0,priceList:n.priceList||{},rating:Number(n.rating)||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1,totalOrders:0,totalPurchased:0,lastOrderDate:null,averageDeliveryTime:0,createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await hl(Pe(ge,zs),o)).id,...o},message:`Proveedor "${o.name}" creado exitosamente`}}catch(t){return console.error("Error creating supplier:",t),{success:!1,error:t.message}}},Oj=async()=>{try{const n=Ae(Pe(ge,zs),jn("name","asc"));return{success:!0,data:(await yt(n)).docs.map(a=>({id:a.id,...a.data()}))}}catch(n){return console.error("Error getting suppliers:",n),{success:!1,error:n.message}}},kj=n=>{const e=Ae(Pe(ge,zs),jn("name","asc"));return Ur(e,t=>{const a=t.docs.map(o=>({id:o.id,...o.data()}));n(a)})},yL=async(n,e,t)=>{try{const a=await Li(st(ge,zs,n));if(!a.exists())return{success:!1,error:"Proveedor no encontrado"};if(e.name&&e.name.trim()!==a.data().name){const c=Ae(Pe(ge,zs),Oe("name","==",e.name.trim()));if(!(await yt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${e.name}"`}}if(e.taxId&&e.taxId.trim()!==a.data().taxId){const c=Ae(Pe(ge,zs),Oe("taxId","==",e.taxId.trim()));if(!(await yt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${e.taxId}"`}}const o={...e,lastUpdated:new Date,updatedBy:t};return o.name&&(o.name=o.name.trim()),o.taxId&&(o.taxId=o.taxId.trim()),o.contactPerson&&(o.contactPerson=o.contactPerson.trim()),o.phone&&(o.phone=o.phone.trim()),o.email&&(o.email=o.email.trim()),await xs(st(ge,zs,n),o),{success:!0,message:"Proveedor actualizado exitosamente"}}catch(a){return console.error("Error updating supplier:",a),{success:!1,error:a.message}}},_L=async(n,e)=>{try{return await xs(st(ge,zs,n),{status:"inactive",lastUpdated:new Date,updatedBy:e}),{success:!0,message:"Proveedor desactivado exitosamente"}}catch(t){return console.error("Error deleting supplier:",t),{success:!1,error:t.message}}},bL=async()=>{try{const n=await Oj();if(!n.success)return n;const e=n.data,t={total:e.length,active:e.filter(a=>a.status==="active").length,inactive:e.filter(a=>a.status==="inactive").length,suspended:e.filter(a=>a.status==="suspended").length,preferred:e.filter(a=>a.isPreferred).length,averageRating:e.length>0?e.reduce((a,o)=>a+(o.rating||0),0)/e.length:0,byCategory:{},byType:{}};return e.forEach(a=>{const o=a.category||"sin_categoria";t.byCategory[o]=(t.byCategory[o]||0)+1}),e.forEach(a=>{const o=a.type||"sin_tipo";t.byType[o]=(t.byType[o]||0)+1}),{success:!0,data:t}}catch(n){return console.error("Error getting suppliers stats:",n),{success:!1,error:n.message}}},Pj=Y.createContext(),Ts=()=>{const n=Y.useContext(Pj);if(n===void 0)throw new Error("useCombustibles must be used within a CombustiblesProvider");return n},EL=({children:n})=>{const[e,t]=Y.useState(null),[a,o]=Y.useState(null),[c,d]=Y.useState(!0),[m,p]=Y.useState(null),[v,_]=Y.useState([]),[b,T]=Y.useState([]),[j,x]=Y.useState([]),[C,w]=Y.useState([]);Y.useEffect(()=>{const D=hR(Bc,async A=>{try{if(d(!0),A){t(A);let I=await yf(A.uid);I.success||(I=await pj(A,{provider:"existing_account",appContext:"combustibles"})),I.success?o(I.userData):p("Error cargando perfil de usuario")}else t(null),o(null),_([]),T([]),x([]),w([])}catch(I){console.error("Error en autenticación:",I),p("Error de autenticación")}finally{d(!1)}});return()=>D()},[]),Y.useEffect(()=>{if(e){const D=Tj(_),A=Zv(x,_e=>p(_e.message)),I=kj(w),O=Dx.subscribeToMovements(T,_e=>p(_e.message));return()=>{D(),A(),I(),O()}}},[e]);const P={user:e,userProfile:a,loading:c,error:m,hasPermission:D=>a?.combustiblesPermissions?.[D]||!1,isAdmin:()=>a?.role==="admin",isCounterOrAbove:()=>a?.role==="admin"||a?.role==="contador",inventory:v,movements:b,vehicles:j,suppliers:C,setInventory:_,setMovements:T,setVehicles:x,setSuppliers:w,deleteMovement:async D=>{try{return await Dx.deleteMovement(D),{success:!0}}catch(A){return console.error("Error al eliminar el movimiento en el contexto:",A),p(A.message),{success:!1,error:A.message}}},refreshInventory:async()=>{console.log("Refrescando inventario...")},refreshMovements:async()=>{console.log("Refrescando movimientos...")},refreshVehicles:async()=>{console.log("Refrescando vehículos...")},refreshSuppliers:async()=>{console.log("Refrescando proveedores...")}};return r.jsx(Pj.Provider,{value:P,children:n})},NL=({children:n,currentView:e,onViewChange:t})=>{const{userProfile:a,isAdmin:o,isCounterOrAbove:c}=Ts(),[d,m]=Y.useState(!1),p=[{id:"dashboard",name:"Dashboard",icon:"📊",description:"Vista general",requiredPermission:null},{id:"inventory",name:"Inventario",icon:"🛢️",description:"Gestión de stock",requiredPermission:"canManageInventory"},{id:"movements",name:"Movimientos",icon:"📈",description:"Entradas y salidas",requiredPermission:"canCreateMovements"},{id:"vehicles",name:"Vehículos",icon:"🚜",description:"Maquinaria forestal",requiredPermission:null},{id:"maintenance",name:"Mantenimiento",icon:"🔧",description:"Cambios de aceite y baterías",requiredPermission:null},{id:"products",name:"Productos",icon:"🛢️",description:"Tipos de combustibles",requiredPermission:null},{id:"suppliers",name:"Proveedores",icon:"🏪",description:"Gestión de proveedores",requiredPermission:"canManageSuppliers"},{id:"reports",name:"Reportes",icon:"📋",description:"Análisis y reportes",requiredPermission:"canViewReports"},{id:"admin",name:"Administración",icon:"⚙️",description:"Gestión de usuarios",requiredPermission:"admin"}],v=j=>{t(j),m(!1)},_=j=>j?j==="admin"?o():a?.combustiblesPermissions?.[j]||!1:!0,b=p.filter(j=>_(j.requiredPermission)),T=async()=>{try{await fR(Bc)}catch(j){console.error("Error al cerrar sesión:",j)}};return r.jsxs("div",{className:"dashboard-layout",children:[r.jsx("header",{className:"dashboard-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"sidebar-toggle",onClick:()=>m(!d),children:"☰"}),r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:"⛽ Gestión de Combustibles"}),r.jsx("span",{className:"subtitle",children:"Forestech Colombia"})]}),r.jsxs("div",{className:"header-user",children:[r.jsxs("div",{className:"user-info",children:[r.jsx("span",{className:"user-name",children:a?.displayName||a?.email}),r.jsx("span",{className:"user-role",children:a?.role})]}),r.jsx("div",{className:"user-avatar",children:a?.photoURL?r.jsx("img",{src:a.photoURL,alt:"Avatar"}):r.jsx("div",{className:"avatar-placeholder",children:(a?.displayName||a?.email||"U").charAt(0).toUpperCase()})}),r.jsx("button",{className:"logout-button",onClick:T,title:"Cerrar sesión",children:"🚪"})]})]})}),r.jsxs("div",{className:"dashboard-body",children:[r.jsxs("aside",{className:`dashboard-sidebar ${d?"open":""}`,children:[r.jsx("nav",{className:"sidebar-nav",children:b.map(j=>r.jsxs("button",{className:`nav-item ${e===j.id?"active":""}`,onClick:()=>v(j.id),children:[r.jsx("span",{className:"nav-icon",children:j.icon}),r.jsxs("div",{className:"nav-content",children:[r.jsx("span",{className:"nav-name",children:j.name}),r.jsx("span",{className:"nav-description",children:j.description})]})]},j.id))}),r.jsx("div",{className:"sidebar-footer",children:r.jsxs("div",{className:"user-permissions",children:[r.jsx("h4",{children:"Permisos Activos:"}),r.jsxs("div",{className:"permission-list",children:[o()&&r.jsx("span",{className:"permission admin",children:"👑 Administrador"}),c()&&r.jsx("span",{className:"permission counter",children:"📊 Gestión Operativa"}),_("canManageInventory")&&r.jsx("span",{className:"permission",children:"🛢️ Inventario"}),_("canManageVehicles")&&r.jsx("span",{className:"permission",children:"🚜 Vehículos"})]})]})})]}),r.jsx("main",{className:"dashboard-main",children:r.jsx("div",{className:"main-content",children:n})})]}),d&&r.jsx("div",{className:"sidebar-overlay",onClick:()=>m(!1)})]})},kx=(n,e=[])=>{if(!n||!n.fuelType||!n.quantity)return{isValid:!1,error:"Datos de movimiento incompletos",availableStock:0,requiredStock:0};const{fuelType:t,quantity:a,type:o,sourceLocation:c}=n,d=parseFloat(a)||0;if(o!=="outbound"&&o!=="transfer")return{isValid:!0,message:"Movimiento no requiere validación de stock",availableStock:0,requiredStock:d};const m=e.filter(_=>_.fuelType===t&&_.location===c&&_.status==="active").reduce((_,b)=>_+(parseFloat(b.quantity)||0),0),p=m>=d,v=m-d;return{isValid:p,availableStock:m,requiredStock:d,remainingStock:v,fuelType:t,location:c,error:p?null:`Stock insuficiente. Disponible: ${m}, Requerido: ${d}`,warning:v<m*.2&&v>=0?"Stock quedará bajo después del movimiento":null}},An=n=>typeof n!="number"||isNaN(n)?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),Me=(n,e=2)=>typeof n!="number"||isNaN(n)?"0":new Intl.NumberFormat("es-CO",{minimumFractionDigits:e,maximumFractionDigits:e}).format(n),Er=(n,e=1)=>typeof n!="number"||isNaN(n)?"0%":`${(n*100).toFixed(e)}%`,Px=()=>{const{inventory:n,movements:e,vehicles:t,loading:a,error:o}=Ts(),c=v=>v?v.toDate&&typeof v.toDate=="function"?v.toDate():v.seconds?new Date(v.seconds*1e3):v instanceof Date?v:new Date(v):new Date,d=Y.useMemo(()=>{const v=t.filter(x=>x.status==="activo").length,_=e.filter(x=>x.status==="pendiente").length,b=n.filter(x=>x.isActive!==!1).reduce((x,C)=>x+(parseFloat(C.currentStock)||0),0),T=n.filter(x=>x.isActive!==!1).reduce((x,C)=>{const w=parseFloat(C.currentStock)||0,F=parseFloat(C.unitPrice)||0;return x+w*F},0),j=n.filter(x=>{const C=parseFloat(x.currentStock)||0,w=parseFloat(x.minStock)||parseFloat(x.minThreshold)||20;return x.isActive!==!1&&C<=w}).length;return{totalFuel:b,totalValue:T,lowStockAlerts:j,activeInventoryItems:n.filter(x=>x.isActive!==!1).length,activeVehicles:v,pendingMovements:_,totalMaintenance:0,overdueMaintenance:0}},[n,t,e]),m=Y.useMemo(()=>e.sort((v,_)=>c(_.createdAt).getTime()-c(v.createdAt).getTime()).slice(0,5),[e]),p=v=>{const _=v.quantity||0,b=v.fuelType||"N/A";switch(v.type){case"entrada":return`Entrada de ${_} gal de ${b}.`;case"salida":return`Salida de ${_} gal para vehículo ${v.vehicleId||"N/A"}.`;case"transferencia":return`Transferencia de ${_} gal.`;case"ajuste":return`Ajuste de inventario: ${_} gal de ${b}.`;default:return"Movimiento registrado."}};return a?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Cargando datos en tiempo real..."}),r.jsx("div",{className:"loading-spinner-container",children:r.jsx("div",{className:"loading-spinner"})})]}):o?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsxs("div",{className:"error-message",children:[r.jsxs("p",{children:["⚠️ ",o]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})]}):r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del estado de combustibles y maquinaria."}),r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon fuel-icon",children:"🛢️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Combustible Total"}),r.jsxs("h2",{children:[Me(d.totalFuel)," gal"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon value-icon",children:"💰"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Valor Inventario"}),r.jsx("h2",{children:An(d.totalValue)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon vehicle-icon",children:"🚜"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Vehículos Activos"}),r.jsx("h2",{children:Me(d.activeVehicles)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon movement-icon",children:"🔄"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Movimientos Pendientes"}),r.jsx("h2",{children:Me(d.pendingMovements)})]})]}),r.jsxs("div",{className:`stat-card ${d.lowStockAlerts>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon alert-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Alertas de Stock"}),r.jsx("h2",{children:Me(d.lowStockAlerts)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon maintenance-icon",children:"🔧"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Mantenimientos"}),r.jsx("h2",{children:Me(d.totalMaintenance)})]})]}),r.jsxs("div",{className:`stat-card ${d.overdueMaintenance>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon maintenance-alert-icon",children:"⏰"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Mantenimientos Vencidos"}),r.jsx("h2",{children:Me(d.overdueMaintenance)})]})]})]}),r.jsxs("div",{className:"dashboard-content",children:[r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"Actividad Reciente"}),m.length>0?r.jsx("ul",{children:m.map(v=>r.jsxs("li",{children:[r.jsx("span",{className:`movement-type-badge ${v.type}`,children:v.type}),p(v),r.jsx("span",{className:"movement-date",children:c(v.createdAt).toLocaleDateString()})]},v.id))}):r.jsx("p",{children:"No hay movimientos recientes."})]}),r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"📦 Stock por Producto"}),n.length>0?r.jsx("div",{className:"products-summary",children:n.map(v=>r.jsxs("div",{className:"product-summary-item",children:[r.jsx("div",{className:"product-icon",children:"⛽"}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:v.fuelType}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("span",{className:"stock-value",children:[Me(v.currentStock||0)," gal"]}),r.jsx("span",{className:`stock-status ${(v.currentStock||0)<=(v.minStock||20)?"low":"normal"}`,children:(v.currentStock||0)<=(v.minStock||20)?"🟡 Stock bajo":"🟢 Normal"})]})]})]},v.id))}):r.jsx("div",{className:"no-products",children:r.jsx("p",{children:"No hay inventario registrado."})})]})]})]})},xL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const[o,c]=Y.useState("name"),[d,m]=Y.useState("asc"),p=x=>new Intl.NumberFormat("es-CO").format(x),v=x=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(x),_=x=>{if(!x)return"N/A";const C=new Date;let w;if(x&&typeof x=="object")if(x.seconds)w=new Date(x.seconds*1e3);else if(x.toDate&&typeof x.toDate=="function")w=x.toDate();else if(x instanceof Date)w=x;else return"N/A";else if(typeof x=="string"||typeof x=="number")w=new Date(x);else return"N/A";if(isNaN(w.getTime()))return"N/A";const F=C-w,H=Math.floor(F/(1e3*60*60)),V=Math.floor(H/24);return V>0?`${V}d`:H>0?`${H}h`:"ahora"},b=x=>{o===x?m(d==="asc"?"desc":"asc"):(c(x),m("asc"))},T=[...n].sort((x,C)=>{let w=x[o],F=C[o];if(o==="lastUpdated"){const H=V=>{if(!V)return new Date(0);if(V&&typeof V=="object"){if(V.seconds)return new Date(V.seconds*1e3);if(V.toDate&&typeof V.toDate=="function")return V.toDate();if(V instanceof Date)return V}return new Date(V)};w=H(w),F=H(F)}return w<F?d==="asc"?-1:1:w>F?d==="asc"?1:-1:0}),j=x=>o!==x?"↕️":d==="asc"?"↑":"↓";return r.jsxs("div",{className:"inventory-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{onClick:()=>b("name"),className:"sortable",children:["Combustible ",j("name")]}),r.jsxs("th",{onClick:()=>b("location"),className:"sortable",children:["Ubicación ",j("location")]}),r.jsxs("th",{onClick:()=>b("currentStock"),className:"sortable",children:["Stock Actual ",j("currentStock")]}),r.jsxs("th",{onClick:()=>b("stockPercentage"),className:"sortable",children:["Nivel ",j("stockPercentage")]}),r.jsxs("th",{onClick:()=>b("pricePerUnit"),className:"sortable",children:["Precio ",j("pricePerUnit")]}),r.jsx("th",{children:"Valor Total"}),r.jsxs("th",{onClick:()=>b("status"),className:"sortable",children:["Estado ",j("status")]}),r.jsxs("th",{onClick:()=>b("lastUpdated"),className:"sortable",children:["Actualizado ",j("lastUpdated")]}),a&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:T.map(x=>{const C=sl[x.fuelType],w=Bo[x.stockLevel],F=parseFloat(x.currentStock)||0,H=parseFloat(x.pricePerUnit)||0,V=parseFloat(x.maxCapacity)||0,k=parseFloat(x.stockPercentage)||0,U=F*H;return r.jsxs("tr",{className:x.needsRestock?"needs-restock":"",children:[r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:C?.color},children:C?.icon}),r.jsxs("div",{children:[r.jsx("div",{className:"fuel-name",children:C?.name}),r.jsx("div",{className:"fuel-type",children:x.fuelType})]})]})}),r.jsx("td",{children:x.location}),r.jsxs("td",{className:"stock-cell",children:[r.jsxs("div",{className:"stock-info",children:[r.jsx("span",{className:"stock-amount",children:p(F)}),r.jsxs("span",{className:"stock-unit",children:["/ ",p(V)," ",x.unit||"gal"]})]}),x.needsRestock&&r.jsx("div",{className:"restock-indicator",children:"⚠️ Bajo mínimo"})]}),r.jsx("td",{className:"level-cell",children:r.jsxs("div",{className:"level-info",children:[r.jsxs("div",{className:"level-badge",style:{backgroundColor:w?.color,color:"white"},children:[k,"%"]}),r.jsx("div",{className:"level-bar",children:r.jsx("div",{className:"level-fill",style:{width:`${k}%`,backgroundColor:w?.color}})})]})}),r.jsx("td",{className:"price-cell",children:r.jsxs("div",{className:"price-info",children:[r.jsx("span",{className:"price-amount",children:v(H)}),r.jsxs("span",{className:"price-unit",children:["/ ",x.unit||"gal"]})]})}),r.jsx("td",{className:"value-cell",children:r.jsx("span",{className:"total-value",children:v(U)})}),r.jsx("td",{className:"status-cell",children:r.jsxs("span",{className:`status-badge ${x.status}`,children:[r.jsx("span",{className:"status-dot"}),x.status==="active"?"Activo":x.status==="inactive"?"Inactivo":x.status==="maintenance"?"Mantenimiento":x.status]})}),r.jsx("td",{className:"updated-cell",children:r.jsx("span",{className:"time-ago",children:_(x.lastUpdated)})}),a&&r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(x),title:"Editar",children:"✏️"}),r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(x),title:"Eliminar",children:"🗑️"})]})})]},x.id)})})]})}),r.jsxs("div",{className:"table-footer",children:[r.jsxs("div",{className:"table-info",children:[T.length," items ordenados por ",o,"(",d==="asc"?"ascendente":"descendente",")"]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot critical"}),"Crítico"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot low"}),"Bajo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot normal"}),"Normal"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},TL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const o=m=>new Intl.NumberFormat("es-CO").format(m),c=m=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(m),d=m=>{if(!m)return"sin fecha";try{const p=new Date;let v;m.seconds?v=new Date(m.seconds*1e3):m.toDate&&typeof m.toDate=="function"?v=m.toDate():v=new Date(m);const _=p-v,b=Math.floor(_/(1e3*60*60)),T=Math.floor(b/24);return T>0?`hace ${T} día${T>1?"s":""}`:b>0?`hace ${b} hora${b>1?"s":""}`:"hace unos minutos"}catch(p){return console.warn("Error al calcular tiempo transcurrido:",p),"fecha inválida"}};return r.jsx("div",{className:"inventory-cards-grid",children:n.map(m=>{const p=sl[m.fuelType],v=Bo[m.stockLevel],_=parseFloat(m.currentStock)||0,b=parseFloat(m.pricePerUnit)||parseFloat(m.unitPrice)||0,T=parseFloat(m.maxCapacity)||parseFloat(m.capacity)||0,j=parseFloat(m.stockPercentage)||0,x=_*b;return r.jsxs("div",{className:"inventory-card",children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:p?.color},children:p?.icon}),r.jsxs("div",{className:"fuel-details",children:[r.jsx("h3",{children:p?.name}),r.jsx("p",{className:"location",children:m.location})]})]}),r.jsx("div",{className:"stock-status",children:r.jsxs("span",{className:"status-badge",style:{backgroundColor:v?.color,color:"white"},children:[v?.icon," ",v?.label]})})]}),r.jsxs("div",{className:"stock-progress",children:[r.jsxs("div",{className:"progress-header",children:[r.jsxs("span",{className:"stock-text",children:[o(_)," / ",o(T)," ",m.unit||"gal"]}),r.jsxs("span",{className:"percentage",children:[j,"%"]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${j}%`,backgroundColor:v?.color}})}),m.needsRestock&&r.jsxs("div",{className:"restock-warning",children:["⚠️ Bajo nivel mínimo (",o(m.minThreshold||m.minStock||0)," ",m.unit||"gal",")"]})]}),r.jsxs("div",{className:"card-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsxs("span",{className:"metric-label",children:["Precio por ",m.unit||"gal",":"]}),r.jsx("span",{className:"metric-value",children:c(b)})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor total:"}),r.jsx("span",{className:"metric-value",children:c(x)})]}),m.supplier&&r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Proveedor:"}),r.jsx("span",{className:"metric-value",children:m.supplier})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"status-info",children:[r.jsx("span",{className:`status-dot ${m.status}`}),r.jsx("span",{className:"status-text",children:m.status==="active"?"Activo":m.status==="inactive"?"Inactivo":m.status==="maintenance"?"Mantenimiento":m.status})]}),r.jsxs("div",{className:"last-update",children:["Actualizado ",d(m.updatedAt||m.lastUpdated)]})]}),a&&r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>e(m),title:"Editar combustible",children:"✏️ Editar"}),r.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>t(m),title:"Eliminar combustible",children:"🗑️ Eliminar"})]}),m.description&&m.description!==p?.description&&r.jsx("div",{className:"card-description",children:r.jsx("p",{children:m.description})})]},m.id)})})},AL=({item:n,onClose:e,onSuccess:t})=>{const{userProfile:a}=Ts(),o=!!n,[c,d]=Y.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[m,p]=Y.useState({}),[v,_]=Y.useState(!1);Y.useEffect(()=>{o&&n&&d({fuelType:n.fuelType||"",location:n.location||"",currentStock:n.currentStock||"",maxCapacity:n.maxCapacity||"",minThreshold:n.minThreshold||"",pricePerUnit:n.pricePerUnit||"",supplier:n.supplier||"",description:n.description||"",status:n.status||"active"})},[o,n]),Y.useEffect(()=>{if(c.maxCapacity&&!c.minThreshold){const C=Math.round(Number(c.maxCapacity)*.15);d(w=>({...w,minThreshold:C}))}},[c.maxCapacity]);const b=C=>{const{name:w,value:F}=C.target;d(H=>({...H,[w]:F})),m[w]&&p(H=>({...H,[w]:null}))},T=()=>{const C={};c.fuelType||(C.fuelType="Tipo de combustible es requerido"),c.location||(C.location="Ubicación es requerida"),c.maxCapacity||(C.maxCapacity="Capacidad máxima es requerida");const w=Number(c.currentStock),F=Number(c.maxCapacity),H=Number(c.minThreshold),V=Number(c.pricePerUnit);return c.currentStock&&(isNaN(w)||w<0)&&(C.currentStock="Stock actual debe ser un número válido mayor o igual a 0"),c.maxCapacity&&(isNaN(F)||F<=0)&&(C.maxCapacity="Capacidad máxima debe ser un número válido mayor a 0"),c.minThreshold&&(isNaN(H)||H<0)&&(C.minThreshold="Umbral mínimo debe ser un número válido mayor o igual a 0"),c.pricePerUnit&&(isNaN(V)||V<0)&&(C.pricePerUnit="Precio debe ser un número válido mayor o igual a 0"),w>F&&(C.currentStock="Stock actual no puede ser mayor a la capacidad máxima"),H>F&&(C.minThreshold="Umbral mínimo no puede ser mayor a la capacidad máxima"),p(C),Object.keys(C).length===0},j=async C=>{if(C.preventDefault(),!!T()){_(!0);try{let w;o?w=await hL(n.id,{location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid):w=await dL({fuelType:c.fuelType,location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid),w.success?(alert(w.message),t()):alert(`Error: ${w.error}`)}catch(w){console.error("Error saving inventory item:",w),alert("Error inesperado al guardar el item")}finally{_(!1)}}},x=sl[c.fuelType];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content inventory-modal",onClick:C=>C.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:o?"✏️ Editar Combustible":"➕ Agregar Nuevo Combustible"}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),r.jsxs("form",{onSubmit:j,className:"modal-form",children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",x&&r.jsxs("span",{className:"fuel-preview",children:[x.icon," ",x.name]})]}),r.jsxs("select",{id:"fuelType",name:"fuelType",value:c.fuelType,onChange:b,disabled:o,className:m.fuelType?"error":"",required:!0,children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(Nn).map(([C,w])=>{const F=sl[w];return r.jsxs("option",{value:w,children:[F.icon," ",F.name," (",F.unit,")"]},C)})]}),m.fuelType&&r.jsx("span",{className:"error-text",children:m.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"location",children:"Ubicación / Tanque *"}),r.jsx("input",{type:"text",id:"location",name:"location",value:c.location,onChange:b,placeholder:"ej. Tanque Principal, Depósito A, Bodega Norte",className:m.location?"error":"",required:!0}),m.location&&r.jsx("span",{className:"error-text",children:m.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",x&&`(${x.unit})`]}),r.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:c.currentStock,onChange:b,placeholder:"0",min:"0",step:"0.01",className:m.currentStock?"error":""}),m.currentStock&&r.jsx("span",{className:"error-text",children:m.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad Máxima * ",x&&`(${x.unit})`]}),r.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:c.maxCapacity,onChange:b,placeholder:"1000",min:"1",step:"0.01",className:m.maxCapacity?"error":"",required:!0}),m.maxCapacity&&r.jsx("span",{className:"error-text",children:m.maxCapacity})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"minThreshold",children:["Umbral Mínimo ",x&&`(${x.unit})`,r.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),r.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:c.minThreshold,onChange:b,placeholder:"Auto: 15% de capacidad máxima",min:"0",step:"0.01",className:m.minThreshold?"error":""}),m.minThreshold&&r.jsx("span",{className:"error-text",children:m.minThreshold}),c.maxCapacity&&r.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(c.maxCapacity)*.15)," ",x?.unit||"unidades"]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",x?.unit||"Unidad"]}),r.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:c.pricePerUnit,onChange:b,placeholder:"12000",min:"0",step:"0.01",className:m.pricePerUnit?"error":""}),m.pricePerUnit&&r.jsx("span",{className:"error-text",children:m.pricePerUnit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),r.jsx("input",{type:"text",id:"supplier",name:"supplier",value:c.supplier,onChange:b,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsxs("select",{id:"status",name:"status",value:c.status,onChange:b,children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"description",children:"Descripción / Notas"}),r.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:b,placeholder:"Información adicional sobre este combustible...",rows:"3"})]})]}),x&&c.maxCapacity&&r.jsxs("div",{className:"form-preview",children:[r.jsx("h4",{children:"📊 Vista Previa"}),r.jsxs("div",{className:"preview-card",children:[r.jsxs("div",{className:"preview-header",children:[r.jsxs("span",{style:{color:x.color},children:[x.icon," ",x.name]}),r.jsx("span",{children:c.location})]}),r.jsxs("div",{className:"preview-capacity",children:[c.currentStock||0," / ",c.maxCapacity," ",x.unit,c.currentStock&&c.maxCapacity&&r.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(c.currentStock)/Number(c.maxCapacity)*100),"%)"]})]}),c.pricePerUnit&&r.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(c.currentStock)||0)*Number(c.pricePerUnit))]})]})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v,children:v?"Guardando...":o?"Actualizar":"Crear"})]})]})]})})},jL=({stats:n})=>r.jsxs("div",{className:"inventory-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Valor Total"}),r.jsx("div",{className:"stat-value",children:An(n.totalValue)}),r.jsxs("div",{className:"stat-subtitle",children:[Me(n.totalItems)," tipos de combustible"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:"✅"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Items Activos"}),r.jsx("div",{className:"stat-value",children:n.activeItems}),r.jsxs("div",{className:"stat-subtitle",children:[Math.round(n.activeItems/n.totalItems*100),"% del total"]})]})]}),r.jsxs("div",{className:`stat-card ${n.lowStockItems>0?"warning":"info"}`,children:[r.jsx("div",{className:"stat-icon",children:n.lowStockItems>0?"⚠️":"📊"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Stock Bajo"}),r.jsx("div",{className:"stat-value",children:n.lowStockItems}),r.jsx("div",{className:"stat-subtitle",children:n.lowStockItems>0?"Requieren atención":"Niveles normales"})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:"📈"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Nivel Promedio"}),r.jsxs("div",{className:"stat-value",children:[n.averageStockLevel,"%"]}),r.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),r.jsxs("div",{className:"fuel-type-summary",children:[r.jsx("h4",{children:"📊 Resumen por Tipo de Combustible"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(n.byFuelType).map(([e,t])=>{const a=sl[e],o=t.totalCapacity>0?Math.round(t.totalStock/t.totalCapacity*100):0;return r.jsxs("div",{className:"fuel-type-card",children:[r.jsxs("div",{className:"fuel-header",children:[r.jsx("span",{className:"fuel-icon",style:{color:a?.color||"#6b7280"},children:a?.icon||"⛽"}),r.jsxs("div",{className:"fuel-info",children:[r.jsx("h5",{children:a?.name||e}),r.jsxs("span",{className:"fuel-count",children:[t.count," ubicaciones"]})]})]}),r.jsxs("div",{className:"fuel-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Stock Total:"}),r.jsxs("span",{className:"metric-value",children:[Me(t.totalStock)," ",a?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Capacidad:"}),r.jsxs("span",{className:"metric-value",children:[Me(t.totalCapacity)," ",a?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Utilización:"}),r.jsxs("span",{className:`metric-value ${o<25?"low":o>75?"high":"normal"}`,children:[o,"%"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor:"}),r.jsx("span",{className:"metric-value",children:An(t.totalValue)})]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${o}%`,backgroundColor:a?.color||"#6b7280"}})})]},e)})}),Object.keys(n.byFuelType).length===0&&r.jsx("div",{className:"empty-fuel-types",children:r.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),wL=()=>{const{hasPermission:n}=Ts(),[e,t]=Y.useState([]),[a,o]=Y.useState(null),[c,d]=Y.useState(!0),[m,p]=Y.useState(null),[v,_]=Y.useState("cards"),[b,T]=Y.useState(!1),[j,x]=Y.useState(null),[C,w]=Y.useState("all"),[F,H]=Y.useState("");Y.useEffect(()=>{let R=null;return(()=>{R=Tj((D,A)=>{if(A){console.error("Error in inventory subscription:",A),p("Error cargando inventario en tiempo real");return}t(D||[]),d(!1)})})(),()=>{R&&R()}},[]),Y.useEffect(()=>{(async()=>{const P=await mL();P.success&&o(P.data)})()},[e]);const V=e.filter(R=>{if(C==="active"&&R.status!=="active"||C==="low-stock"&&!R.needsRestock)return!1;if(F){const P=F.toLowerCase();return R.name.toLowerCase().includes(P)||R.location.toLowerCase().includes(P)||R.fuelType.toLowerCase().includes(P)}return!0}),k=R=>{if(!n("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}x(R),T(!0)},U=async R=>{if(!n("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`¿Estás seguro de eliminar ${R.name} de ${R.location}?

Esta acción no se puede deshacer.`))return;d(!0);const D=await fL(R.id);D.success?alert("Item eliminado exitosamente"):(p(D.error),alert(`Error al eliminar: ${D.error}`)),d(!1)},Q=()=>{T(!1),x(null)},L=()=>{Q()};return c&&e.length===0?r.jsxs("div",{className:"inventory-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando inventario..."})]}):r.jsxs("div",{className:"inventory-main",children:[r.jsxs("div",{className:"inventory-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🛢️ Gestión de Inventario"}),r.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),r.jsx("div",{className:"inventory-info",children:r.jsxs("span",{className:"info-text",children:["💡 Los combustibles se agregan automáticamente desde la pestaña ",r.jsx("strong",{children:"Movimientos"})]})})]}),a&&r.jsx(jL,{stats:a}),r.jsxs("div",{className:"inventory-controls",children:[r.jsxs("div",{className:"search-filters",children:[r.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicación o tipo...",value:F,onChange:R=>H(R.target.value),className:"search-input"}),r.jsxs("select",{value:C,onChange:R=>w(R.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos los items"}),r.jsx("option",{value:"active",children:"Solo activos"}),r.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),r.jsxs("div",{className:"view-toggle",children:[r.jsx("button",{className:`toggle-btn ${v==="cards"?"active":""}`,onClick:()=>_("cards"),children:"📱 Cards"}),r.jsx("button",{className:`toggle-btn ${v==="table"?"active":""}`,onClick:()=>_("table"),children:"📊 Tabla"})]})]}),m&&r.jsxs("div",{className:"error-banner",children:[r.jsxs("span",{children:["⚠️ ",m]}),r.jsx("button",{onClick:()=>p(null),children:"✕"})]}),r.jsx("div",{className:"inventory-content",children:V.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📦"}),r.jsx("h3",{children:"No hay items de inventario"}),r.jsx("p",{children:F||C!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaña Movimientos para crear una ENTRADA de combustible"})]}):r.jsx(r.Fragment,{children:v==="cards"?r.jsx(TL,{items:V,onEdit:k,onDelete:U,canManage:n("canManageInventory")}):r.jsx(xL,{items:V,onEdit:k,onDelete:U,canManage:n("canManageInventory")})})}),V.length>0&&r.jsx("div",{className:"results-footer",children:r.jsxs("p",{children:["Mostrando ",V.length," de ",e.length," items",F&&` · Filtro: "${F}"`,C!=="all"&&` · Estado: ${C}`]})}),b&&r.jsx(AL,{item:j,onClose:Q,onSuccess:L})]})},CL=({stats:n,filters:e})=>{if(!n)return null;const t=(d,m)=>m===0?d>0?100:0:((d-m)/m*100).toFixed(1),a=d=>{switch(d){case pe.ENTRADA:return"#10b981";case pe.SALIDA:return"#ef4444";case pe.TRANSFERENCIA:return"#3b82f6";case pe.AJUSTE:return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case pe.ENTRADA:return"📥";case pe.SALIDA:return"📤";case pe.TRANSFERENCIA:return"🔄";case pe.AJUSTE:return"⚖️";default:return"📋"}},c=t(n.thisMonth,n.lastMonth);return r.jsxs("div",{className:"movements-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"📊"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.totalMovements)}),r.jsx("div",{className:"stat-label",children:"Total Movimientos"}),r.jsxs("div",{className:"stat-trend",children:[r.jsxs("span",{className:`trend ${c>=0?"positive":"negative"}`,children:[c>=0?"📈":"📉"," ",Math.abs(c),"%"]}),r.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:An(n.totalValue)}),r.jsx("div",{className:"stat-label",children:"Valor Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",An(n.averageValue)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⛽"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.totalQuantity)}),r.jsx("div",{className:"stat-label",children:"Galones Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Me(n.totalQuantity/(n.totalMovements||1))," gal/mov"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"📅"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.thisWeek)}),r.jsx("div",{className:"stat-label",children:"Esta Semana"}),r.jsxs("div",{className:"stat-secondary",children:[Me(n.thisMonth)," este mes"]})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"📋 Por Tipo de Movimiento"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([d,m])=>{const p=(m/n.totalMovements*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:o(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:a(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⚡ Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([d,m])=>{const p=(m/n.totalMovements*100).toFixed(1),v=b=>{switch(b){case He.COMPLETADO:return"#10b981";case He.PENDIENTE:return"#f59e0b";case He.CANCELADO:return"#ef4444";default:return"#6b7280"}},_=b=>{switch(b){case He.COMPLETADO:return"✅";case He.PENDIENTE:return"⏳";case He.CANCELADO:return"❌";default:return"❓"}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:_(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:v(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([d,m])=>{const p=(m/n.totalMovements*100).toFixed(1),v=_=>{switch(_?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(d)}),r.jsx("span",{className:"breakdown-label",children:d})]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]})]}),(e.type||e.status||e.fuelType||e.vehicleId)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:"🔍 Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.vehicleId&&r.jsxs("span",{className:"filter-tag",children:["Vehículo: ",e.vehicleId]})]})]})]})},SL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:m})=>{const[p,v]=Y.useState(!1),_=[{value:"Diesel",label:"Diesel 🚛"},{value:"Gasolina",label:"Gasolina 🚗"},{value:"ACPM",label:"ACPM 🚚"},{value:"Lubricante",label:"Lubricante 🛢️"}],b=[{value:"all",label:"Todos los períodos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este año"}],T=Object.values(n).filter(C=>C&&C!==""&&C!=="all").length,j=(C,w)=>{e({[C]:w})},x=C=>{e(C)};return r.jsxs("div",{className:"movements-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehículo, referencia...",value:a,onChange:C=>o(C.target.value),className:"search-input"}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${n.type===pe.ENTRADA?"active":""}`,onClick:()=>x({type:pe.ENTRADA}),children:"📥 Entradas"}),r.jsx("button",{className:`quick-filter ${n.type===pe.SALIDA?"active":""}`,onClick:()=>x({type:pe.SALIDA}),children:"📤 Salidas"}),r.jsx("button",{className:`quick-filter ${n.status===He.PENDIENTE?"active":""}`,onClick:()=>x({status:He.PENDIENTE}),children:"⏳ Pendientes"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:["🎛️ Filtros",T>0&&r.jsx("span",{className:"filters-count",children:T})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Movimiento"}),r.jsxs("select",{value:n.type,onChange:C=>j("type",C.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:pe.ENTRADA,children:"📥 Entrada"}),r.jsx("option",{value:pe.SALIDA,children:"📤 Salida"}),r.jsx("option",{value:pe.TRANSFERENCIA,children:"🔄 Transferencia"}),r.jsx("option",{value:pe.AJUSTE,children:"⚖️ Ajuste"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:C=>j("status",C.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:He.PENDIENTE,children:"⏳ Pendiente"}),r.jsx("option",{value:He.COMPLETADO,children:"✅ Completado"}),r.jsx("option",{value:He.CANCELADO,children:"❌ Cancelado"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:n.fuelType,onChange:C=>j("fuelType",C.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),_.map(C=>r.jsx("option",{value:C.value,children:C.label},C.value))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Período"}),r.jsx("select",{value:n.dateRange,onChange:C=>j("dateRange",C.target.value),className:"filter-select",children:b.map(C=>r.jsx("option",{value:C.value,children:C.label},C.value))})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Vehículo/Equipo"}),r.jsx("input",{type:"text",placeholder:"ID del vehículo...",value:n.vehicleId,onChange:C=>j("vehicleId",C.target.value),className:"filter-input"})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:T===0,children:"🗑️ Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[m," resultado",m!==1?"s":""]}),T>0&&r.jsxs("span",{className:"active-filters-text",children:["(",T," filtro",T!==1?"s":""," activo",T!==1?"s":"",")"]})]})]})]}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},IL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,onDelete:c,userRole:d})=>{const m=C=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(C),p=C=>C?(C instanceof Date?C:new Date(C)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Sin fecha",v=C=>{if(!C)return"";const w=new Date,F=C instanceof Date?C:new Date(C),H=Math.abs(w-F),V=Math.ceil(H/(1e3*60*60*24));return V===1?"hace 1 día":V<7?`hace ${V} días`:V<30?`hace ${Math.ceil(V/7)} semanas`:V<365?`hace ${Math.ceil(V/30)} meses`:`hace ${Math.ceil(V/365)} años`},_=C=>{switch(C){case pe.ENTRADA:return"movement-entrada";case pe.SALIDA:return"movement-salida";case pe.TRANSFERENCIA:return"movement-transferencia";case pe.AJUSTE:return"movement-ajuste";default:return"movement-default"}},b=C=>{switch(C){case He.COMPLETADO:return"status-completado";case He.PENDIENTE:return"status-pendiente";case He.CANCELADO:return"status-cancelado";default:return"status-default"}},T=C=>{switch(C){case pe.ENTRADA:return"📥";case pe.SALIDA:return"📤";case pe.TRANSFERENCIA:return"🔄";case pe.AJUSTE:return"⚖️";default:return"📋"}},j=C=>{switch(C?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},x=C=>{switch(C){case He.COMPLETADO:return"✅";case He.PENDIENTE:return"⏳";case He.CANCELADO:return"❌";default:return"❓"}};return r.jsx("div",{className:"movements-cards",children:n.map(C=>r.jsxs("div",{className:`movement-card ${_(C.type)}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"movement-type",children:[r.jsx("span",{className:"type-icon",children:T(C.type)}),r.jsx("span",{className:"type-label",children:C.type.charAt(0).toUpperCase()+C.type.slice(1)})]}),r.jsxs("div",{className:`status-badge ${b(C.status)}`,children:[r.jsx("span",{className:"status-icon",children:x(C.status)}),r.jsx("span",{className:"status-label",children:C.status.charAt(0).toUpperCase()+C.status.slice(1)})]})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",children:j(C.fuelType)}),r.jsx("span",{className:"fuel-type",children:C.fuelType}),r.jsxs("span",{className:"quantity",children:[C.quantity," galones"]})]}),r.jsxs("div",{className:"value-info",children:[r.jsx("div",{className:"total-value",children:m(C.totalValue)}),r.jsxs("div",{className:"unit-price",children:[m(C.unitPrice),"/galón"]})]}),C.vehicleId&&r.jsxs("div",{className:"vehicle-info",children:[r.jsx("span",{className:"vehicle-icon",children:"🚜"}),r.jsxs("span",{className:"vehicle-id",children:["Vehículo: ",C.vehicleId]})]}),C.location&&r.jsxs("div",{className:"location-info",children:[r.jsx("span",{className:"location-icon",children:"📍"}),r.jsx("span",{className:"location",children:C.location})]}),C.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:C.description})}),C.reference&&r.jsxs("div",{className:"reference",children:[r.jsx("span",{className:"reference-label",children:"Ref:"}),r.jsx("span",{className:"reference-value",children:C.reference})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[r.jsx("div",{className:"created-date",children:p(C.createdAt)}),r.jsx("div",{className:"relative-time",children:v(C.createdAt)})]}),r.jsxs("div",{className:"card-actions",children:[d==="admin"&&C.status===He.PENDIENTE&&r.jsxs("div",{className:"admin-actions",children:[r.jsx("button",{className:"btn-approve",onClick:()=>a(C.id),title:"Aprobar movimiento",children:"✓ Aprobar"}),r.jsx("button",{className:"btn-reject",onClick:()=>o(C.id),title:"Rechazar movimiento",children:"✗ Rechazar"})]}),r.jsxs("div",{className:"user-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(C),title:"Ver detalles",children:"👁️ Ver"}),e&&C.status===He.PENDIENTE&&r.jsx("button",{className:"btn-edit",onClick:()=>e(C),title:"Editar movimiento",children:"✏️ Editar"}),d==="admin"&&r.jsx("button",{className:"btn-delete",onClick:()=>{window.confirm("¿Estás seguro de que deseas eliminar este movimiento? Esta acción no se puede deshacer.")&&c(C.id)},title:"Eliminar movimiento",children:"🗑️ Eliminar"})]})]})]}),C.status===He.PENDIENTE&&r.jsx("div",{className:"urgency-indicator",children:r.jsx("div",{className:"urgency-pulse"})}),C.type===pe.AJUSTE&&r.jsx("div",{className:"adjustment-badge",children:r.jsx("span",{children:"Ajuste"})}),C.type===pe.TRANSFERENCIA&&C.destinationLocation&&r.jsxs("div",{className:"transfer-info",children:[r.jsx("span",{className:"transfer-arrow",children:"→"}),r.jsx("span",{className:"destination",children:C.destinationLocation})]})]},C.id))})},RL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,onDelete:c,userRole:d})=>{const[m,p]=Y.useState("createdAt"),[v,_]=Y.useState("desc"),b=k=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(k),T=k=>k?(k instanceof Date?k:new Date(k)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",j=k=>{switch(k){case pe.ENTRADA:return"📥";case pe.SALIDA:return"📤";case pe.TRANSFERENCIA:return"🔄";case pe.AJUSTE:return"⚖️";default:return"📋"}},x=k=>{switch(k?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},C=k=>{switch(k){case He.COMPLETADO:return"✅";case He.PENDIENTE:return"⏳";case He.CANCELADO:return"❌";default:return"❓"}},w=k=>{switch(k){case He.COMPLETADO:return"status-completado";case He.PENDIENTE:return"status-pendiente";case He.CANCELADO:return"status-cancelado";default:return"status-default"}},F=k=>{m===k?_(v==="asc"?"desc":"asc"):(p(k),_("asc"))},H=[...n].sort((k,U)=>{let Q=k[m],L=U[m];return(m.includes("Date")||m.includes("At"))&&(Q=new Date(Q),L=new Date(L)),typeof Q=="number"&&typeof L=="number"?v==="asc"?Q-L:L-Q:typeof Q=="string"&&typeof L=="string"?v==="asc"?Q.localeCompare(L):L.localeCompare(Q):Q instanceof Date&&L instanceof Date?v==="asc"?Q-L:L-Q:0}),V=k=>m!==k?"↕️":v==="asc"?"↑":"↓";return r.jsxs("div",{className:"movements-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"movements-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>F("type"),children:["Tipo ",V("type")]}),r.jsxs("th",{className:"sortable",onClick:()=>F("fuelType"),children:["Combustible ",V("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>F("quantity"),children:["Cantidad ",V("quantity")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>F("unitPrice"),children:["Precio/Gal ",V("unitPrice")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>F("totalValue"),children:["Valor Total ",V("totalValue")]}),r.jsx("th",{children:"Vehículo"}),r.jsx("th",{children:"Ubicación"}),r.jsxs("th",{className:"sortable",onClick:()=>F("status"),children:["Estado ",V("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>F("createdAt"),children:["Fecha ",V("createdAt")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:H.map(k=>r.jsxs("tr",{className:`movement-row ${k.status===He.PENDIENTE?"pending-row":""}`,children:[r.jsx("td",{className:"type-cell",children:r.jsxs("div",{className:"type-content",children:[r.jsx("span",{className:"type-icon",children:j(k.type)}),r.jsx("span",{className:"type-text",children:k.type.charAt(0).toUpperCase()+k.type.slice(1)})]})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:x(k.fuelType)}),r.jsx("span",{className:"fuel-text",children:k.fuelType})]})}),r.jsxs("td",{className:"quantity-cell text-right",children:[r.jsx("span",{className:"quantity-value",children:k.quantity}),r.jsx("span",{className:"quantity-unit",children:"gal"})]}),r.jsx("td",{className:"price-cell text-right",children:b(k.unitPrice)}),r.jsx("td",{className:"value-cell text-right",children:r.jsx("strong",{children:b(k.totalValue)})}),r.jsx("td",{className:"vehicle-cell",children:k.vehicleId?r.jsxs("span",{className:"vehicle-id",children:["🚜 ",k.vehicleId]}):r.jsx("span",{className:"no-vehicle",children:"-"})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:["📍 ",k.location||"Principal"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${w(k.status)}`,children:[r.jsx("span",{className:"status-icon",children:C(k.status)}),r.jsx("span",{className:"status-text",children:k.status.charAt(0).toUpperCase()+k.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:T(k.createdAt)}),k.reference&&r.jsxs("span",{className:"reference-small",children:["#",k.reference]})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(k),title:"Ver detalles",children:"👁️"}),d==="admin"&&k.status===He.PENDIENTE&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-action btn-approve",onClick:()=>a(k.id),title:"Aprobar movimiento",children:"✓"}),r.jsx("button",{className:"btn-action btn-reject",onClick:()=>o(k.id),title:"Rechazar movimiento",children:"✗"})]}),e&&k.status===He.PENDIENTE&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(k),title:"Editar movimiento",children:"✏️"}),d==="admin"&&r.jsx("button",{className:"btn-action btn-delete",onClick:()=>{window.confirm("¿Estás seguro de que deseas eliminar este movimiento? Esta acción no se puede deshacer.")&&c(k.id)},title:"Eliminar movimiento",children:"🗑️"})]})})]},k.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[n.length," movimiento",n.length!==1?"s":""]}),m&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",m," (",v==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⏳"})," Pendiente"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"✅"})," Completado"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"❌"})," Cancelado"]})]})]})]})},DL=({movements:n,viewMode:e,onEdit:t,onView:a,onApprove:o,onReject:c,onDelete:d,userRole:m})=>e==="table"?r.jsx(RL,{movements:n,onEdit:t,onView:a,onApprove:o,onReject:c,onDelete:d,userRole:m}):r.jsx(IL,{movements:n,onEdit:t,onView:a,onApprove:o,onReject:c,onDelete:d,userRole:m}),Ta={ACPM:"ACPM",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},Lj={[Ta.ACPM]:{name:"ACPM",displayName:"ACPM 🚛",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"🚛",description:"Combustible diesel para vehículos pesados"},[Ta.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina 🚗",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"🚗",description:"Gasolina corriente para vehículos livianos"},[Ta.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidráulico 🔧",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"🔧",description:"Aceite hidráulico para sistemas de maquinaria"},[Ta.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 🛢️",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"🛢️",description:"Aceite multigrado para motores"},[Ta.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja 🟥",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"🟥",description:"Grasa lubricante multipropósito"},[Ta.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ⚙️",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"⚙️",description:"Aceite para transmisiones y diferenciales"},[Ta.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Líquido para Frenos 🛑",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"🛑",description:"Líquido de frenos DOT 3/4"},[Ta.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga 🌿",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"🌿",description:"Mezcla de combustible para equipos menores"},[Ta.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 🚜",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"🚜",description:"Aceite especializado para tractores"}},Bs={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},Lx=()=>Object.values(Lj),Vx="combustibles_products",ML=async()=>{try{console.log("🔄 Verificando productos existentes...");const n=Ae(Pe(ge,Vx),DO(1));if(!(await yt(n)).empty){console.log("✅ Productos ya existen en Firebase");return}console.log("📦 Creando productos predefinidos...");const t=Object.values(Lj).map(async o=>{const c={name:o.name,displayName:o.displayName,category:o.category,unit:o.unit,defaultPrice:o.defaultPrice,color:o.color,icon:o.icon,description:o.description,isActive:!0,createdAt:new Date,updatedAt:new Date,createdBy:"system-initialization"},d=st(Pe(ge,Vx));return await df(d,c),console.log(`✅ Producto creado: ${o.displayName}`),{id:d.id,...c}}),a=await Promise.all(t);return console.log(`🎉 ${a.length} productos inicializados correctamente`),a}catch(n){throw console.error("❌ Error inicializando productos:",n),n}},OL=async()=>{try{await ML()}catch(n){console.error("❌ Error en inicialización automática:",n)}},il="combustibles_products",Yp=async n=>{try{const e={...n,createdAt:et(),updatedAt:et()},t=await hl(Pe(ge,il),e);return console.log("Product created with ID:",t.id),t.id}catch(e){throw console.error("Error creating product:",e),e}},kL=async(n,e)=>{try{const t=st(ge,il,n);await xs(t,{...e,updatedAt:et()}),console.log("Product updated successfully")}catch(t){throw console.error("Error updating product:",t),t}},PL=async n=>{try{await hf(st(ge,il,n)),console.log("Product deleted successfully")}catch(e){throw console.error("Error deleting product:",e),e}},LL=async()=>{try{await OL(),console.log("🔍 Obteniendo productos activos...");const n=Ae(Pe(ge,il),Oe("isActive","==",!0),jn("name")),t=(await yt(n)).docs.map(a=>({id:a.id,...a.data()}));return console.log(`✅ Productos activos obtenidos: ${t.length}`),t}catch(n){if(console.error("❌ Error obteniendo productos activos:",n),n.code==="failed-precondition"||n.message.includes("index")){console.warn("⚠️ Índice no disponible, usando consulta alternativa...");try{const e=Ae(Pe(ge,il),Oe("isActive","==",!0)),o=(await yt(e)).docs.map(c=>({id:c.id,...c.data()})).sort((c,d)=>(c.name||"").localeCompare(d.name||""));return console.log(`✅ Productos activos obtenidos (ordenamiento en cliente): ${o.length}`),o}catch(e){throw console.error("❌ Error en consulta alternativa:",e),e}}throw n}},VL=(n,e)=>{try{const t=Ae(Pe(ge,il),jn("name"));return Ur(t,a=>{const o=a.docs.map(c=>({id:c.id,...c.data()}));n(o)},a=>{console.error("Error in products subscription:",a),e(a)})}catch(t){return console.error("Error setting up products subscription:",t),e(t),()=>{}}},UL=({isOpen:n,onClose:e,movement:t,mode:a,onSuccess:o})=>{const[c,d]=Y.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""}),[m,p]=Y.useState(!1),[v,_]=Y.useState(""),[b,T]=Y.useState({}),[j,x]=Y.useState([]),[C,w]=Y.useState(!1),[F,H]=Y.useState([]),[V,k]=Y.useState(""),[U,Q]=Y.useState([]),[L,R]=Y.useState([]),P=["Bodega Austria","Bodega Ilusion","Campo Operativo","Estación Móvil"];Y.useEffect(()=>((async()=>{if(n){document.body.style.overflow="hidden",w(!0);try{console.log("🔄 Cargando datos para formulario de movimientos...");const[ae,he,q,ee]=await Promise.all([Xv(),xj(),Oj(),LL()]);console.log("📊 Datos cargados:",{vehicles:ae?.length||0,inventory:he?.success?he.data?.length||0:"Error",suppliers:q?.success?q.data?.length||0:"Error",products:ee?.length||0}),x(ae),H(he.success?he.data:[]),Q(q.success?q.data:[]),R(ee),console.log("✅ Datos cargados exitosamente")}catch(ae){console.error("❌ Error al cargar datos:",ae)}finally{w(!1)}}else document.body.style.overflow="unset"})(),()=>{document.body.style.overflow="unset"}),[n]),Y.useEffect(()=>{t&&(a==="edit"||a==="view")?d({type:t.type||"",fuelType:t.fuelType||"",quantity:t.quantity?.toString()||"",unitPrice:t.unitPrice?.toString()||"",location:t.location||"Principal",vehicleId:t.vehicleId||"",destinationLocation:t.destinationLocation||"",description:t.description||"",reference:t.reference||"",effectiveDate:t.effectiveDate?new Date(t.effectiveDate).toISOString().slice(0,16):new Date().toISOString().slice(0,16)}):a==="create"&&d({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""}),_(""),T({})},[t,a,n]),Y.useEffect(()=>{if(c.fuelType&&!c.unitPrice&&L.length>0){const z=L.find(ae=>ae.name===c.fuelType||ae.displayName===c.fuelType);z&&z.defaultPrice&&d(ae=>({...ae,unitPrice:z.defaultPrice.toString()}))}},[c.fuelType,L]),Y.useEffect(()=>{if(k(""),(c.type===pe.SALIDA||c.type===pe.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&F.length>0){const z={type:c.type===pe.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},ae=kx(z,F);ae.isValid?ae.warning&&k(`⚠️ ${ae.warning}`):k(`🚫 ${ae.error}`)}},[c.type,c.fuelType,c.location,c.quantity,F]);const D=(z,ae)=>{d(z==="type"?he=>({...he,[z]:ae,location:ae===pe.ENTRADA?"":"Principal"}):he=>({...he,[z]:ae})),b[z]&&T(he=>({...he,[z]:""}))},A=()=>!c.vehicleId||!j.length?null:j.find(z=>z.vehicleId===c.vehicleId),I=()=>{const z=A();if(!z)return!1;const ae=z.vehicleId?.toUpperCase(),he=ae&&(ae.includes("TR1")||ae.includes("TR2")||ae.includes("TR3")||ae==="TR1"||ae==="TR2"||ae==="TR3"),q=z.category==="tractor"||z.type?.toLowerCase().includes("tractor");return he||q},O=()=>{const z={};if(c.type||(z.type="Tipo de movimiento requerido"),c.fuelType||(z.fuelType="Tipo de combustible requerido"),c.quantity?parseFloat(c.quantity)<=0&&(z.quantity="La cantidad debe ser mayor a cero"):z.quantity="Cantidad requerida",c.unitPrice?parseFloat(c.unitPrice)<0&&(z.unitPrice="El precio no puede ser negativo"):z.unitPrice="Precio unitario requerido",c.type===pe.ENTRADA&&!c.location&&(z.location="Las entradas requieren un proveedor"),c.type===pe.SALIDA&&!c.vehicleId&&(z.vehicleId="Las salidas requieren un vehículo"),c.type===pe.TRANSFERENCIA&&!c.destinationLocation&&(z.destinationLocation="Las transferencias requieren una ubicación destino"),c.type===pe.SALIDA&&I())if(!c.currentHours)z.currentHours="La lectura del horómetro es requerida para tractores";else if(parseFloat(c.currentHours)<0)z.currentHours="La lectura del horómetro debe ser mayor a 0";else{const ae=A();ae?.currentHours&&parseFloat(c.currentHours)<parseFloat(ae.currentHours)&&(z.currentHours=`La lectura debe ser mayor a la anterior: ${ae.currentHours} hrs`)}if((c.type===pe.SALIDA||c.type===pe.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&F.length>0){const ae={type:c.type===pe.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},he=kx(ae,F);he.isValid||(z.quantity=he.error)}return T(z),Object.keys(z).length===0},_e=async z=>{if(z.preventDefault(),!O()){_("Por favor corrige los errores en el formulario");return}p(!0),_("");try{const ae={...c,quantity:parseFloat(c.quantity),unitPrice:parseFloat(c.unitPrice),effectiveDate:new Date(c.effectiveDate)};a==="create"?await gj(ae):a==="edit"&&await Kv(t.id,ae),o()}catch(ae){console.error("Error al guardar movimiento:",ae),_(ae.message||"Error al guardar el movimiento")}finally{p(!1)}},Se=(parseFloat(c.quantity)||0)*(parseFloat(c.unitPrice)||0),$=()=>{switch(a){case"create":return"➕ Nuevo Movimiento";case"edit":return"✏️ Editar Movimiento";case"view":return"👁️ Detalles del Movimiento";default:return"Movimiento"}};return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content movement-modal",onClick:z=>z.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:$()}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),a==="create"&&r.jsx("div",{style:{padding:"10px",background:"#f0f0f0",borderBottom:"1px solid #ddd"},children:r.jsx("button",{onClick:()=>{console.log("🔍 Debug - Estado actual:",{products:L.length,vehicles:j.length,suppliers:U.length,inventory:F.length,loadingVehicles:C}),alert(`Productos: ${L.length}, Vehículos: ${j.length}, Proveedores: ${U.length}`)},style:{background:"#007bff",color:"white",border:"none",padding:"5px 10px",borderRadius:"4px",cursor:"pointer"},children:"🔍 Debug Datos"})}),r.jsxs("div",{className:"modal-body",children:[v&&r.jsxs("div",{className:"error-message",children:[r.jsx("span",{className:"error-icon",children:"⚠️"}),v]}),r.jsxs("form",{onSubmit:_e,className:"movement-form",children:[r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Movimiento *"}),r.jsxs("select",{value:c.type,onChange:z=>D("type",z.target.value),disabled:a==="view",className:b.type?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),r.jsx("option",{value:pe.ENTRADA,children:"📥 Entrada"}),r.jsx("option",{value:pe.SALIDA,children:"📤 Salida"}),r.jsx("option",{value:pe.TRANSFERENCIA,children:"🔄 Transferencia"}),r.jsx("option",{value:pe.AJUSTE,children:"⚖️ Ajuste"})]}),b.type&&r.jsx("span",{className:"field-error",children:b.type})]}),a==="view"&&t&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsx("div",{className:"status-display",children:r.jsxs("span",{className:`status-badge status-${t.status}`,children:[t.status===He.COMPLETADO&&"✅",t.status===He.PENDIENTE&&"⏳",t.status===He.CANCELADO&&"❌",t.status.charAt(0).toUpperCase()+t.status.slice(1)]})})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Combustible *"}),r.jsxs("select",{value:c.fuelType,onChange:z=>D("fuelType",z.target.value),disabled:a==="view",className:b.fuelType?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar producto/combustible..."}),L.map(z=>r.jsxs("option",{value:z.name,children:[z.icon," ",z.displayName]},z.id))]}),b.fuelType&&r.jsx("span",{className:"field-error",children:b.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cantidad (galones) *"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:c.quantity,onChange:z=>D("quantity",z.target.value),disabled:a==="view",placeholder:"0.00",className:b.quantity?"error":""}),b.quantity&&r.jsx("span",{className:"field-error",children:b.quantity}),V&&!b.quantity&&r.jsx("div",{className:"stock-warning",children:V})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio Unitario (COP) *"}),r.jsx("input",{type:"number",step:"1",min:"0",value:c.unitPrice,onChange:z=>D("unitPrice",z.target.value),disabled:a==="view",placeholder:"0",className:b.unitPrice?"error":""}),b.unitPrice&&r.jsx("span",{className:"field-error",children:b.unitPrice})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Valor Total"}),r.jsx("div",{className:"total-value-display",children:An(Se)})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:c.type===pe.ENTRADA?"Proveedor *":"Ubicación"}),c.type===pe.ENTRADA?r.jsxs("select",{value:c.location,onChange:z=>D("location",z.target.value),disabled:a==="view",className:b.location?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar proveedor..."}),U.filter(z=>z.status==="active").map(z=>r.jsxs("option",{value:z.name,children:["🏪 ",z.name," - ",z.city]},z.id))]}):r.jsx("select",{value:c.location,onChange:z=>D("location",z.target.value),disabled:a==="view",children:P.map(z=>r.jsxs("option",{value:z,children:["📍 ",z]},z))}),b.location&&r.jsx("span",{className:"field-error",children:b.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:c.type===pe.ENTRADA?"Vehículo que hizo el transporte":`Vehículo/Equipo ${c.type===pe.SALIDA?"*":""}`}),c.type===pe.SALIDA?C?r.jsxs("div",{className:"loading-vehicles",children:[r.jsx("span",{className:"loading-spinner small"}),"Cargando vehículos..."]}):r.jsxs("select",{value:c.vehicleId,onChange:z=>D("vehicleId",z.target.value),disabled:a==="view",className:b.vehicleId?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar vehículo destino..."}),j.map(z=>r.jsxs("option",{value:z.vehicleId,children:["🚜 ",z.vehicleId," - ",z.name," (",z.type,")"]},z.id))]}):r.jsx("input",{type:"text",value:c.vehicleId,onChange:z=>D("vehicleId",z.target.value),disabled:a==="view",placeholder:"ID del vehículo o equipo",className:b.vehicleId?"error":""}),b.vehicleId&&r.jsx("span",{className:"field-error",children:b.vehicleId})]})]}),c.type===pe.SALIDA&&I()&&r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"⏱️ Lectura Horómetro *"}),r.jsx("input",{type:"number",min:"0",step:"0.1",value:c.currentHours,onChange:z=>D("currentHours",z.target.value),disabled:a==="view",placeholder:"Horas actuales del tractor",className:b.currentHours?"error":""}),b.currentHours&&r.jsx("span",{className:"field-error",children:b.currentHours}),A()?.currentHours&&r.jsxs("small",{className:"field-hint",children:["Última lectura: ",A().currentHours," horas"]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"ℹ️ Información del Tractor"}),r.jsxs("div",{className:"tractor-info",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Vehículo:"})," ",A()?.name||c.vehicleId]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Tipo:"})," ",A()?.type||"Tractor"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Estado:"})," ",A()?.status||"Activo"]})]})]})]}),c.type===pe.ENTRADA&&r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ubicación Destino"}),r.jsxs("select",{value:c.destinationLocation,onChange:z=>D("destinationLocation",z.target.value),disabled:a==="view",className:b.destinationLocation?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar ubicación destino (opcional)..."}),P.map(z=>r.jsxs("option",{value:z,children:["📍 ",z]},z))]}),b.destinationLocation&&r.jsx("span",{className:"field-error",children:b.destinationLocation}),r.jsx("small",{className:"field-hint",children:'Si no se especifica, se usará la ubicación "Principal"'})]})}),c.type===pe.TRANSFERENCIA&&r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ubicación Destino *"}),r.jsxs("select",{value:c.destinationLocation,onChange:z=>D("destinationLocation",z.target.value),disabled:a==="view",className:b.destinationLocation?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar destino..."}),P.filter(z=>z!==c.location).map(z=>r.jsxs("option",{value:z,children:["📍 ",z]},z))]}),b.destinationLocation&&r.jsx("span",{className:"field-error",children:b.destinationLocation})]})}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Fecha Efectiva"}),r.jsx("input",{type:"datetime-local",value:c.effectiveDate,onChange:z=>D("effectiveDate",z.target.value),disabled:a==="view"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Referencia"}),r.jsx("input",{type:"text",value:c.reference,onChange:z=>D("reference",z.target.value),disabled:a==="view",placeholder:"Factura, orden, etc."})]})]}),r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Descripción"}),r.jsx("textarea",{value:c.description,onChange:z=>D("description",z.target.value),disabled:a==="view",placeholder:"Detalles adicionales del movimiento...",rows:"3"})]})}),a==="view"&&t&&r.jsx("div",{className:"movement-details",children:r.jsxs("div",{className:"details-section",children:[r.jsx("h4",{children:"📋 Información del Sistema"}),r.jsxs("div",{className:"details-grid",children:[r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"ID:"}),r.jsx("span",{children:t.id})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Creado:"}),r.jsx("span",{children:new Date(t.createdAt).toLocaleString("es-CO")})]}),t.updatedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Actualizado:"}),r.jsx("span",{children:new Date(t.updatedAt).toLocaleString("es-CO")})]}),t.approvedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Aprobado:"}),r.jsx("span",{children:new Date(t.approvedAt).toLocaleString("es-CO")})]})]})]})})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-cancel",onClick:e,children:a==="view"?"Cerrar":"Cancelar"}),a!=="view"&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:_e,disabled:m,children:m?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner small"}),"Guardando..."]}):a==="create"?"Crear Movimiento":"Actualizar Movimiento"})]})]})}):null},FL=()=>{const{user:n,userProfile:e,deleteMovement:t}=Ts(),[a,o]=Y.useState([]),[c,d]=Y.useState(null),[m,p]=Y.useState(!0),[v,_]=Y.useState(null),[b,T]=Y.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[j,x]=Y.useState("cards"),[C,w]=Y.useState(""),[F,H]=Y.useState(!1),[V,k]=Y.useState(null),[U,Q]=Y.useState("create");Y.useEffect(()=>{if(!n)return;p(!0);const he=Qv((q,ee)=>{if(ee){console.error("Error en suscripción de movimientos:",ee),_("Error al cargar movimientos"),p(!1);return}o(q),_(null),p(!1)},b);return()=>he()},[n,b]),Y.useEffect(()=>{n&&(async()=>{try{const q=await _j(b);d(q)}catch(q){console.error("Error al cargar estadísticas:",q)}})()},[n,a,b]);const L=a.filter(he=>{if(!C)return!0;const q=C.toLowerCase();return he.fuelType?.toLowerCase().includes(q)||he.type?.toLowerCase().includes(q)||he.location?.toLowerCase().includes(q)||he.vehicleId?.toLowerCase().includes(q)||he.description?.toLowerCase().includes(q)||he.reference?.toLowerCase().includes(q)}),R=()=>{k(null),Q("create"),H(!0)},P=he=>{k(he),Q("edit"),H(!0)},D=he=>{k(he),Q("view"),H(!0)},A=()=>{H(!1),k(null)},I=he=>{T(q=>({...q,...he}))},O=()=>{T({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),w("")},_e=async he=>{if(window.confirm("¿Estás seguro de que quieres aprobar este movimiento? Esta acción actualizará el inventario."))try{await yj(he),alert("Movimiento aprobado y stock actualizado.")}catch(q){console.error("Error al aprobar movimiento:",q),alert(`Error al aprobar movimiento: ${q.message}`)}},Se=async he=>{if(window.confirm("¿Estás seguro de que quieres rechazar este movimiento?"))try{await Kv(he,{status:He.CANCELADO}),alert("Movimiento rechazado.")}catch(q){console.error("Error al rechazar movimiento:",q),alert(`Error al rechazar movimiento: ${q.message}`)}},$=async he=>{try{const q=await t(he);if(q.success)alert("Movimiento eliminado exitosamente.");else throw new Error(q.error)}catch(q){console.error("Error al eliminar movimiento:",q),alert(`Error al eliminar movimiento: ${q.message}`)}},z=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",ae=e?.role==="admin";return m?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando movimientos..."})]})}):v?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:"⚠️"}),r.jsx("h3",{children:"Error al cargar movimientos"}),r.jsx("p",{children:v}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"movements-main",children:[r.jsxs("div",{className:"movements-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"📊 Movimientos de Combustibles"}),r.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),z&&r.jsx("button",{className:"btn-create-movement",onClick:R,children:"➕ Nuevo Movimiento"})]}),c&&r.jsx(CL,{stats:c,filters:b}),r.jsx(SL,{filters:b,onFilterChange:I,onClearFilters:O,searchTerm:C,onSearchChange:w,viewMode:j,onViewModeChange:x,totalResults:L.length}),L.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📋"}),r.jsx("h3",{children:a.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),r.jsx("p",{children:a.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de búsqueda"}),a.length===0&&z&&r.jsx("button",{className:"btn-create-first",onClick:R,children:"➕ Crear Primer Movimiento"})]}):r.jsx(DL,{movements:L,viewMode:j,onEdit:ae?P:null,onView:D,onApprove:_e,onReject:Se,onDelete:$,userRole:e?.role}),F&&r.jsx(UL,{isOpen:F,onClose:A,movement:V,mode:U,onSuccess:()=>{A()}})]})},qL=({stats:n,filters:e})=>{if(!n)return null;const t=b=>`${Me(b)} gal`,a=b=>`${Me(b)} hrs`,o=b=>`${b.toFixed(2)} gal/hr`,c=b=>{let T=0;for(let x=0;x<b.length;x++)T=(T<<5)-T+b.charCodeAt(x)&4294967295;const j=["#059669","#dc2626","#2563eb","#7c3aed","#ea580c","#16a34a","#ca8a04","#9333ea"];return j[Math.abs(T)%j.length]},d=b=>{if(!b)return"🚗";const T=b.toLowerCase();return T.includes("excavadora")?"🚚":T.includes("bulldozer")?"🚜":T.includes("cargador")?"🏗️":T.includes("camion")?"🚛":T.includes("grua")?"🏗️":T.includes("motosierra")?"🪚":T.includes("tractor")?"🚜":T.includes("volqueta")?"🚛":"🚗"},m=b=>{switch(b){case Ve.ACTIVO:return"#10b981";case Ve.MANTENIMIENTO:return"#f59e0b";case Ve.INACTIVO:return"#6b7280";case Ve.REPARACION:return"#ef4444";default:return"#6b7280"}},p=b=>{switch(b){case Ve.ACTIVO:return"✅";case Ve.MANTENIMIENTO:return"🔧";case Ve.INACTIVO:return"⏸️";case Ve.REPARACION:return"🔴";default:return"❓"}},v=b=>{switch(b){case gt.DIESEL:return"🚛";case gt.GASOLINA:return"🚗";case gt.ACPM:return"🚚";case gt.MIXTO:return"⛽";default:return"⛽"}},_=n.totalVehicles>0?((n.byStatus[Ve.ACTIVO]||0)/n.totalVehicles*100).toFixed(1):0;return r.jsxs("div",{className:"vehicles-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"🚜"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.totalVehicles)}),r.jsx("div",{className:"stat-label",children:"Total Vehículos"}),r.jsx("div",{className:"stat-trend",children:r.jsxs("span",{className:`trend ${_>=80?"positive":"warning"}`,children:[_>=80?"📈":"⚠️"," ",_,"% activos"]})})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⛽"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:t(n.totalFuelConsumed)}),r.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(n.averageConsumption||0)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⏰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:a(n.totalHoursWorked)}),r.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",a(n.totalHoursWorked/(n.totalVehicles||1))]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"🏆"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:n.mostActiveVehicle?n.mostActiveVehicle.vehicleId:"N/A"}),r.jsx("div",{className:"stat-label",children:"Más Activo"}),r.jsx("div",{className:"stat-secondary",children:n.mostActiveVehicle?`${n.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"🚜 Por Tipo de Vehículo"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([b,T])=>{const j=(T/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:d(b)}),r.jsx("span",{className:"breakdown-label",children:b.charAt(0).toUpperCase()+b.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:T}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:c(b)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},b)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⚡ Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([b,T])=>{const j=(T/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:p(b)}),r.jsx("span",{className:"breakdown-label",children:b.charAt(0).toUpperCase()+b.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:T}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:m(b)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},b)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([b,T])=>{const j=(T/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(b)}),r.jsx("span",{className:"breakdown-label",children:b})]}),r.jsx("div",{className:"breakdown-value",children:T}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},b)})})]})]}),(n.totalFuelConsumed>0||n.totalHoursWorked>0)&&r.jsxs("div",{className:"performance-metrics",children:[r.jsx("h4",{children:"📊 Métricas de Rendimiento"}),r.jsxs("div",{className:"metrics-grid",children:[r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"⚡"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),r.jsxs("div",{className:"metric-value",children:[_,"%"]}),r.jsxs("div",{className:"metric-description",children:[n.byStatus[Ve.ACTIVO]||0," de ",n.totalVehicles," activos"]})]})]}),n.averageConsumption>0&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"📈"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),r.jsx("div",{className:"metric-value",children:o(n.averageConsumption)}),r.jsx("div",{className:"metric-description",children:"Por vehículo por hora trabajada"})]})]}),n.mostActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"🏆"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Mayor Utilización"}),r.jsx("div",{className:"metric-value",children:n.mostActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(n.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),n.leastActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"📉"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Menor Utilización"}),r.jsx("div",{className:"metric-value",children:n.leastActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(n.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(e.type||e.status||e.fuelType||e.location)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:"🔍 Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.location&&r.jsxs("span",{className:"filter-tag",children:["Ubicación: ",e.location]})]})]})]})},BL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:m})=>{const[p,v]=Y.useState(!1),_=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mecánico","Proyecto A","Proyecto B","En Reparación","Otros"],b=Object.values(n).filter(x=>x&&x!==""&&x!=="all").length,T=(x,C)=>{e({[x]:C})},j=x=>{e(x)};return r.jsxs("div",{className:"vehicles-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicación...",value:a,onChange:x=>o(x.target.value),className:"search-input"}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${n.status==="activo"?"active":""}`,onClick:()=>j({status:"activo"}),children:"✅ Activos"}),r.jsx("button",{className:`quick-filter ${n.status==="mantenimiento"?"active":""}`,onClick:()=>j({status:"mantenimiento"}),children:"🔧 Mantenimiento"}),r.jsx("button",{className:`quick-filter ${n.type==="excavadora"?"active":""}`,onClick:()=>j({type:"excavadora"}),children:"🚚 Excavadoras"}),r.jsx("button",{className:`quick-filter ${n.type==="tractor"?"active":""}`,onClick:()=>j({type:"tractor"}),children:"🚜 Tractores"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:["🎛️ Filtros",b>0&&r.jsx("span",{className:"filters-count",children:b})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Vehículo"}),r.jsxs("select",{value:n.type,onChange:x=>T("type",x.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:"excavadora",children:"🚚 Excavadora"}),r.jsx("option",{value:"bulldozer",children:"🚜 Bulldozer"}),r.jsx("option",{value:"cargador",children:"🏗️ Cargador"}),r.jsx("option",{value:"camion",children:"🚛 Camión"}),r.jsx("option",{value:"grua",children:"🏗️ Grúa"}),r.jsx("option",{value:"motosierra",children:"🪚 Motosierra"}),r.jsx("option",{value:"tractor",children:"🚜 Tractor"}),r.jsx("option",{value:"volqueta",children:"🚛 Volqueta"}),r.jsx("option",{value:"otros",children:"🚗 Otros"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:x=>T("status",x.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:Ve.ACTIVO,children:"✅ Activo"}),r.jsx("option",{value:Ve.MANTENIMIENTO,children:"🔧 Mantenimiento"}),r.jsx("option",{value:Ve.INACTIVO,children:"⏸️ Inactivo"}),r.jsx("option",{value:Ve.REPARACION,children:"🔴 Reparación"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:n.fuelType,onChange:x=>T("fuelType",x.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),r.jsx("option",{value:gt.DIESEL,children:"🚛 Diesel"}),r.jsx("option",{value:gt.GASOLINA,children:"🚗 Gasolina"}),r.jsx("option",{value:gt.ACPM,children:"🚚 ACPM"}),r.jsx("option",{value:gt.MIXTO,children:"⛽ Mixto"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Ubicación Actual"}),r.jsxs("select",{value:n.location,onChange:x=>T("location",x.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todas las ubicaciones"}),_.map(x=>r.jsxs("option",{value:x,children:["📍 ",x]},x))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Mantenimiento"}),r.jsxs("select",{value:n.maintenance,onChange:x=>T("maintenance",x.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos"}),r.jsx("option",{value:"due",children:"Mantenimiento debido"}),r.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),r.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:b===0,children:"🗑️ Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[m," resultado",m!==1?"s":""]}),b>0&&r.jsxs("span",{className:"active-filters-text",children:["(",b," filtro",b!==1?"s":""," activo",b!==1?"s":"",")"]})]})]})]}),b>0&&r.jsx("div",{className:"active-filters-summary",children:r.jsxs("div",{className:"summary-content",children:[r.jsx("span",{className:"summary-label",children:"Filtros activos:"}),r.jsxs("div",{className:"summary-tags",children:[n.type&&r.jsxs("span",{className:"summary-tag",onClick:()=>T("type",""),children:["Tipo: ",n.type," ✕"]}),n.status&&r.jsxs("span",{className:"summary-tag",onClick:()=>T("status",""),children:["Estado: ",n.status," ✕"]}),n.fuelType&&r.jsxs("span",{className:"summary-tag",onClick:()=>T("fuelType",""),children:["Combustible: ",n.fuelType," ✕"]}),n.location&&r.jsxs("span",{className:"summary-tag",onClick:()=>T("location",""),children:["Ubicación: ",n.location," ✕"]}),n.maintenance!=="all"&&r.jsxs("span",{className:"summary-tag",onClick:()=>T("maintenance","all"),children:["Mantenimiento: ",n.maintenance," ✕"]})]})]})}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},HL=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const o=w=>new Intl.NumberFormat("es-CO").format(w),c=w=>`${o(w)} gal`,d=w=>`${o(w)} hrs`,m=w=>w?(w instanceof Date?w:new Date(w)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",p=w=>{if(!w)return"";const F=new Date,H=w instanceof Date?w:new Date(w),V=Math.abs(F-H),k=Math.ceil(V/(1e3*60*60*24));return k===1?"hace 1 día":k<7?`hace ${k} días`:k<30?`hace ${Math.ceil(k/7)} semanas`:k<365?`hace ${Math.ceil(k/30)} meses`:`hace ${Math.ceil(k/365)} años`},v=w=>{if(!w)return"vehicle-default";const F=w.toLowerCase();return F.includes("excavadora")?"vehicle-excavadora":F.includes("bulldozer")?"vehicle-bulldozer":F.includes("cargador")?"vehicle-cargador":F.includes("camion")?"vehicle-camion":F.includes("grua")?"vehicle-grua":F.includes("motosierra")?"vehicle-motosierra":F.includes("tractor")?"vehicle-tractor":F.includes("volqueta")?"vehicle-volqueta":"vehicle-default"},_=w=>{switch(w){case Ve.ACTIVO:return"status-activo";case Ve.MANTENIMIENTO:return"status-mantenimiento";case Ve.INACTIVO:return"status-inactivo";case Ve.REPARACION:return"status-reparacion";default:return"status-default"}},b=w=>{if(!w)return"🚗";const F=w.toLowerCase();return F.includes("excavadora")?"🚚":F.includes("bulldozer")?"🚜":F.includes("cargador")?"🏗️":F.includes("camion")?"🚛":F.includes("grua")?"🏗️":F.includes("motosierra")?"🪚":F.includes("tractor")?"🚜":F.includes("volqueta")?"🚛":"🚗"},T=w=>{switch(w){case gt.DIESEL:return"🚛";case gt.GASOLINA:return"🚗";case gt.ACPM:return"🚚";case gt.MIXTO:return"⛽";default:return"⛽"}},j=w=>{switch(w){case Ve.ACTIVO:return"✅";case Ve.MANTENIMIENTO:return"🔧";case Ve.INACTIVO:return"⏸️";case Ve.REPARACION:return"🔴";default:return"❓"}},x=w=>!w.totalHoursWorked||w.totalHoursWorked===0?w.estimatedConsumptionPerHour||0:w.totalFuelConsumed/w.totalHoursWorked,C=w=>w.lastMaintenanceDate?Math.floor((new Date-new Date(w.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsx("div",{className:"vehicles-cards",children:n.map(w=>r.jsxs("div",{className:`vehicle-card ${v(w.type)}`,children:[r.jsx("div",{className:"card-header",children:r.jsxs("div",{className:"vehicle-info",children:[r.jsxs("div",{className:"vehicle-id-section",children:[r.jsx("span",{className:"vehicle-icon",children:b(w.type)}),r.jsxs("div",{className:"vehicle-details",children:[r.jsx("span",{className:"vehicle-id",children:w.vehicleId}),r.jsx("span",{className:"vehicle-name",children:w.name})]})]}),r.jsxs("div",{className:`status-badge ${_(w.status)}`,children:[r.jsx("span",{className:"status-icon",children:j(w.status)}),r.jsx("span",{className:"status-label",children:w.status.charAt(0).toUpperCase()+w.status.slice(1)})]})]})}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"basic-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Tipo:"}),r.jsxs("span",{className:"info-value",children:[b(w.type)," ",w.type.charAt(0).toUpperCase()+w.type.slice(1)]})]}),w.brand&&w.model&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),r.jsxs("span",{className:"info-value",children:[w.brand," ",w.model]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Combustible:"}),r.jsxs("span",{className:"info-value",children:[T(w.fuelType)," ",w.fuelType]})]}),w.currentLocation&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Ubicación:"}),r.jsxs("span",{className:"info-value",children:["📍 ",w.currentLocation]})]})]}),r.jsxs("div",{className:"consumption-metrics",children:[r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"⛽"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:c(w.totalFuelConsumed||0)}),r.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"⏰"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:d(w.totalHoursWorked||0)}),r.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"📊"}),r.jsxs("div",{className:"metric-content",children:[r.jsxs("div",{className:"metric-value",children:[x(w).toFixed(1)," gal/hr"]}),r.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"🔄"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:w.totalMovements||0}),r.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(w.enginePower||w.fuelCapacity||w.year)&&r.jsxs("div",{className:"technical-specs",children:[w.enginePower&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"⚡"}),r.jsxs("span",{className:"spec-value",children:[w.enginePower," HP"]})]}),w.fuelCapacity&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"🛢️"}),r.jsxs("span",{className:"spec-value",children:[w.fuelCapacity," gal"]})]}),w.year&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"📅"}),r.jsx("span",{className:"spec-value",children:w.year})]})]}),w.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:w.description})})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[w.lastMovementDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"Último movimiento:"}),r.jsx("span",{className:"date-value",children:m(w.lastMovementDate)}),r.jsx("span",{className:"date-relative",children:p(w.lastMovementDate)})]}),w.lastMaintenanceDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"Último mantenimiento:"}),r.jsx("span",{className:"date-value",children:m(w.lastMaintenanceDate)}),r.jsx("span",{className:"date-relative",children:p(w.lastMaintenanceDate)})]})]}),r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(w),title:"Ver detalles",children:"👁️"}),e&&w.status!==Ve.REPARACION&&r.jsx("button",{className:"btn-edit",onClick:()=>e(w),title:"Editar vehículo",children:"✏️"}),a&&r.jsx("button",{className:"btn-maintenance",onClick:()=>a(w),title:"Registrar mantenimiento",children:"🔧"})]})]}),w.status===Ve.MANTENIMIENTO&&r.jsx("div",{className:"maintenance-indicator",children:r.jsx("div",{className:"maintenance-pulse"})}),C(w)&&w.status===Ve.ACTIVO&&r.jsx("div",{className:"maintenance-due-badge",children:r.jsx("span",{children:"Mantenimiento Debido"})}),w.status===Ve.REPARACION&&r.jsx("div",{className:"repair-badge",children:r.jsx("span",{children:"En Reparación"})}),w.totalHoursWorked>0&&r.jsxs("div",{className:"efficiency-indicator",children:[r.jsx("div",{className:"efficiency-bar",children:r.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(w.totalHoursWorked/2e3*100,100)}%`}})}),r.jsxs("span",{className:"efficiency-label",children:[(w.totalHoursWorked/2e3*100).toFixed(1),"% utilización anual"]})]})]},w.id))})},zL=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const[o,c]=Y.useState("vehicleId"),[d,m]=Y.useState("asc"),p=U=>new Intl.NumberFormat("es-CO").format(U),v=U=>`${p(U)} gal`,_=U=>`${p(U)} hrs`,b=U=>U?(U instanceof Date?U:new Date(U)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",T=U=>{if(!U)return"🚗";const Q=U.toLowerCase();return Q.includes("excavadora")?"🚚":Q.includes("bulldozer")?"🚜":Q.includes("cargador")?"🏗️":Q.includes("camion")?"🚛":Q.includes("grua")?"🏗️":Q.includes("motosierra")?"🪚":Q.includes("tractor")?"🚜":Q.includes("volqueta")?"🚛":"🚗"},j=U=>{switch(U){case gt.DIESEL:return"🚛";case gt.GASOLINA:return"🚗";case gt.ACPM:return"🚚";case gt.MIXTO:return"⛽";default:return"⛽"}},x=U=>{switch(U){case Ve.ACTIVO:return"✅";case Ve.MANTENIMIENTO:return"🔧";case Ve.INACTIVO:return"⏸️";case Ve.REPARACION:return"🔴";default:return"❓"}},C=U=>{switch(U){case Ve.ACTIVO:return"status-activo";case Ve.MANTENIMIENTO:return"status-mantenimiento";case Ve.INACTIVO:return"status-inactivo";case Ve.REPARACION:return"status-reparacion";default:return"status-default"}},w=U=>{o===U?m(d==="asc"?"desc":"asc"):(c(U),m("asc"))},F=[...n].sort((U,Q)=>{let L=U[o],R=Q[o];return(o.includes("Date")||o.includes("At"))&&(L=new Date(L||0),R=new Date(R||0)),typeof L=="number"&&typeof R=="number"?d==="asc"?L-R:R-L:typeof L=="string"&&typeof R=="string"?d==="asc"?L.localeCompare(R):R.localeCompare(L):L instanceof Date&&R instanceof Date?d==="asc"?L-R:R-L:!L&&!R?0:L?R?0:d==="asc"?-1:1:d==="asc"?1:-1}),H=U=>o!==U?"↕️":d==="asc"?"↑":"↓",V=U=>!U.totalHoursWorked||U.totalHoursWorked===0?U.estimatedConsumptionPerHour||0:U.totalFuelConsumed/U.totalHoursWorked,k=U=>U.lastMaintenanceDate?Math.floor((new Date-new Date(U.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsxs("div",{className:"vehicles-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"vehicles-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>w("vehicleId"),children:["ID Vehículo ",H("vehicleId")]}),r.jsxs("th",{className:"sortable",onClick:()=>w("name"),children:["Nombre ",H("name")]}),r.jsxs("th",{className:"sortable",onClick:()=>w("type"),children:["Tipo ",H("type")]}),r.jsx("th",{children:"Marca/Modelo"}),r.jsxs("th",{className:"sortable",onClick:()=>w("fuelType"),children:["Combustible ",H("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>w("totalFuelConsumed"),children:["Consumido ",H("totalFuelConsumed")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>w("totalHoursWorked"),children:["Horas ",H("totalHoursWorked")]}),r.jsx("th",{className:"text-right",children:"Consumo/Hr"}),r.jsx("th",{children:"Ubicación"}),r.jsxs("th",{className:"sortable",onClick:()=>w("status"),children:["Estado ",H("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>w("lastMovementDate"),children:["Último Mov. ",H("lastMovementDate")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:F.map(U=>r.jsxs("tr",{className:`vehicle-row ${U.status===Ve.MANTENIMIENTO?"maintenance-row":""} ${k(U)?"needs-maintenance":""}`,children:[r.jsx("td",{className:"vehicle-id-cell",children:r.jsxs("div",{className:"id-content",children:[r.jsx("span",{className:"vehicle-icon",children:T(U.type)}),r.jsx("span",{className:"vehicle-id",children:U.vehicleId})]})}),r.jsx("td",{className:"name-cell",children:r.jsx("span",{className:"vehicle-name",children:U.name})}),r.jsx("td",{className:"type-cell",children:r.jsx("span",{className:"type-text",children:U.type.charAt(0).toUpperCase()+U.type.slice(1)})}),r.jsx("td",{className:"brand-model-cell",children:U.brand&&U.model?r.jsxs("span",{className:"brand-model",children:[U.brand," ",U.model]}):r.jsx("span",{className:"no-data",children:"-"})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:j(U.fuelType)}),r.jsx("span",{className:"fuel-text",children:U.fuelType})]})}),r.jsx("td",{className:"consumption-cell text-right",children:r.jsx("span",{className:"consumption-value",children:v(U.totalFuelConsumed||0)})}),r.jsx("td",{className:"hours-cell text-right",children:r.jsx("span",{className:"hours-value",children:_(U.totalHoursWorked||0)})}),r.jsx("td",{className:"rate-cell text-right",children:r.jsxs("span",{className:"rate-value",children:[V(U).toFixed(1)," gal/hr"]})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:["📍 ",U.currentLocation||"Sin ubicación"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${C(U.status)}`,children:[r.jsx("span",{className:"status-icon",children:x(U.status)}),r.jsx("span",{className:"status-text",children:U.status.charAt(0).toUpperCase()+U.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:b(U.lastMovementDate)}),k(U)&&r.jsx("span",{className:"maintenance-warning",children:"⚠️"})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(U),title:"Ver detalles",children:"👁️"}),e&&U.status!==Ve.REPARACION&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(U),title:"Editar vehículo",children:"✏️"}),a&&r.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>a(U),title:"Registrar mantenimiento",children:"🔧"})]})})]},U.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[n.length," vehículo",n.length!==1?"s":""]}),o&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",o," (",d==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"✅"})," Activo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"🔧"})," Mantenimiento"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⏸️"})," Inactivo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"🔴"})," Reparación"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⚠️"})," Mantto. Debido"]})]})]})]})},GL=({vehicles:n,viewMode:e,onEdit:t,onView:a,onMaintenance:o})=>e==="table"?r.jsx(zL,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}):r.jsx(HL,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}),$L="modulepreload",YL=function(n){return"/combustibles/"+n},Ux={},Jv=function(e,t,a){let o=Promise.resolve();if(t&&t.length>0){let v=function(_){return Promise.all(_.map(b=>Promise.resolve(b).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};var d=v;document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),p=m?.nonce||m?.getAttribute("nonce");o=v(t.map(_=>{if(_=YL(_),_ in Ux)return;Ux[_]=!0;const b=_.endsWith(".css"),T=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${T}`))return;const j=document.createElement("link");if(j.rel=b?"stylesheet":$L,b||(j.as="script"),j.crossOrigin="",j.href=_,p&&j.setAttribute("nonce",p),document.head.appendChild(j),b)return new Promise((x,C)=>{j.addEventListener("load",x),j.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${_}`)))})}))}function c(m){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=m,window.dispatchEvent(p),!p.defaultPrevented)throw m}return o.then(m=>{for(const p of m||[])p.status==="rejected"&&c(p.reason);return e().catch(c)})},_u="combustibles_vehicle_categories",KL=async n=>{try{const e=wj(n);if(!e.isValid)throw new Error(`Datos inválidos: ${e.errors.join(", ")}`);const t=await Vj();if(t.some(d=>d.id===n.id||d.name.toLowerCase()===n.name.toLowerCase()))throw new Error("Ya existe una categoría con ese nombre o ID");n.id||(n.id=Cj(n.name,t));const o={...n,createdAt:et(),updatedAt:et(),isCustom:!0,vehicleCount:0},c=await hl(Pe(ge,_u),o);return console.log("✅ Categoría creada:",n.name),{id:c.id,...o,createdAt:new Date,updatedAt:new Date}}catch(e){throw console.error("❌ Error al crear categoría:",e),new Error(`Error al crear categoría: ${e.message}`)}},Vj=async()=>{try{const n=Ae(Pe(ge,_u),jn("name","asc")),e=await yt(n),t=[];return e.forEach(a=>{t.push({id:a.id,...a.data(),createdAt:a.data().createdAt?.toDate?.()||a.data().createdAt,updatedAt:a.data().updatedAt?.toDate?.()||a.data().updatedAt})}),t}catch(n){throw console.error("❌ Error al obtener categorías personalizadas:",n),new Error(`Error al obtener categorías: ${n.message}`)}},ey=async()=>{try{const n=await Vj();return jj(n)}catch(n){return console.error("❌ Error al obtener todas las categorías:",n),rs}},QL=async(n,e)=>{try{if(!n)throw new Error("ID de categoría requerido");if(rs.some(d=>d.id===n))throw new Error("No se pueden modificar las categorías predeterminadas");if(e.name||e.fuelTypes||e.fields){const d=wj({...e,id:n});if(!d.isValid)throw new Error(`Datos inválidos: ${d.errors.join(", ")}`)}const a={...e,updatedAt:et()},o=st(ge,_u,n);await xs(o,a),console.log("✅ Categoría actualizada:",n);const c=await Li(o);return{id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt}}catch(t){throw console.error("❌ Error al actualizar categoría:",t),new Error(`Error al actualizar categoría: ${t.message}`)}},XL=async n=>{try{if(!n)throw new Error("ID de categoría requerido");if(rs.some(c=>c.id===n))throw new Error("No se pueden eliminar las categorías predeterminadas");const{countVehiclesByCategory:t}=await Jv(async()=>{const{countVehiclesByCategory:c}=await Promise.resolve().then(()=>Mj);return{countVehiclesByCategory:c}},void 0),a=await t(n);if(a>0)throw new Error(`No se puede eliminar la categoría porque tiene ${a} vehículo(s) asignado(s)`);const o=st(ge,_u,n);return await hf(o),console.log("✅ Categoría eliminada:",n),!0}catch(e){throw console.error("❌ Error al eliminar categoría:",e),new Error(`Error al eliminar categoría: ${e.message}`)}},WL=n=>{try{const e=Ae(Pe(ge,_u),jn("name","asc"));return Ur(e,t=>{const a=[];t.forEach(c=>{a.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt})});const o=jj(a);n(o)},t=>{console.error("❌ Error en suscripción a categorías:",t),n(rs)})}catch(e){return console.error("❌ Error al suscribirse a categorías:",e),n(rs),()=>{}}},Fx=async()=>{try{const{getAllVehicles:n}=await Jv(async()=>{const{getAllVehicles:a}=await Promise.resolve().then(()=>Mj);return{getAllVehicles:a}},void 0),e=await n();return(await ey()).map(a=>{const o=e.filter(c=>c.category===a.id);return{...a,vehicleCount:o.length,activeVehicles:o.filter(c=>c.status==="activo").length,totalFuelCapacity:o.reduce((c,d)=>c+(d.fuelCapacity||0),0),avgEnginepower:o.length>0?o.reduce((c,d)=>c+(d.enginePower||0),0)/o.length:0}}).sort((a,o)=>o.vehicleCount-a.vehicleCount)}catch(n){return console.error("❌ Error al obtener estadísticas de categorías:",n),[]}},Uj=({onClose:n,onCategoryCreated:e})=>{const[t,a]=Y.useState([]),[o,c]=Y.useState([]),[d,m]=Y.useState(!0),[p,v]=Y.useState(!1),[_,b]=Y.useState(null),[T,j]=Y.useState(!1),[x,C]=Y.useState(""),[w,F]=Y.useState({name:"",description:"",icon:"🚗",color:"#2E86AB",fuelTypes:[],fields:[]});Y.useEffect(()=>{H();const A=WL(I=>{a(I),V()});return()=>A&&A()},[]);const H=async()=>{try{m(!0);const[A,I]=await Promise.all([ey(),Fx()]);a(A),c(I)}catch(A){console.error("Error cargando categorías:",A),C("Error al cargar categorías")}finally{m(!1)}},V=async()=>{try{const A=await Fx();c(A)}catch(A){console.error("Error cargando estadísticas:",A)}},k=()=>{b(null),F({name:"",description:"",icon:"🚗",color:"#2E86AB",fuelTypes:[],fields:[]}),j(!0)},U=A=>{if(rs.some(I=>I.id===A.id)){C("No se pueden editar las categorías predeterminadas");return}b(A),F({name:A.name||"",description:A.description||"",icon:A.icon||"🚗",color:A.color||"#2E86AB",fuelTypes:A.fuelTypes||[],fields:A.fields||[]}),j(!0)},Q=async A=>{if(rs.some(O=>O.id===A.id)){C("No se pueden eliminar las categorías predeterminadas");return}if(window.confirm(`¿Está seguro de eliminar la categoría "${A.name}"?

Esta acción no se puede deshacer.`))try{v(!0),await XL(A.id),C("")}catch(O){console.error("Error eliminando categoría:",O),C(O.message)}finally{v(!1)}},L=async A=>{if(A.preventDefault(),!w.name.trim()){C("El nombre de la categoría es requerido");return}try{v(!0),C("");const I={...w,name:w.name.trim(),description:w.description.trim()};if(_)await QL(_.id,I);else{I.id=Cj(I.name,t);const O=await KL(I);e&&e(O)}j(!1)}catch(I){console.error("Error guardando categoría:",I),C(I.message)}finally{v(!1)}},R=A=>{F(I=>({...I,fields:I.fields.includes(A)?I.fields.filter(O=>O!==A):[...I.fields,A]}))},P=A=>{F(I=>({...I,fuelTypes:I.fuelTypes.includes(A)?I.fuelTypes.filter(O=>O!==A):[...I.fuelTypes,A]}))},D=A=>o.find(I=>I.id===A)||{vehicleCount:0,activeVehicles:0};return d?r.jsx("div",{className:"categories-manager",children:r.jsxs("div",{className:"loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Cargando categorías..."})]})}):r.jsxs("div",{className:"categories-manager",children:[r.jsxs("div",{className:"categories-header",children:[r.jsx("h3",{children:"📋 Gestión de Categorías"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{className:"btn-primary",onClick:k,disabled:p,children:"➕ Nueva Categoría"}),r.jsx("button",{className:"btn-secondary",onClick:n,children:"✕ Cerrar"})]})]}),x&&r.jsxs("div",{className:"error-message",children:[r.jsxs("span",{children:["⚠️ ",x]}),r.jsx("button",{onClick:()=>C(""),children:"✕"})]}),r.jsx("div",{className:"categories-grid",children:t.map(A=>{const I=rs.some(_e=>_e.id===A.id),O=D(A.id);return r.jsxs("div",{className:`category-card ${I?"default":"custom"}`,style:{"--category-color":A.color},children:[r.jsxs("div",{className:"category-header",children:[r.jsx("div",{className:"category-icon",style:{color:A.color},children:A.icon}),r.jsxs("div",{className:"category-info",children:[r.jsx("h4",{children:A.name}),r.jsx("p",{children:A.description})]}),I&&r.jsx("span",{className:"default-badge",children:"Predeterminada"})]}),r.jsxs("div",{className:"category-stats",children:[r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-value",children:O.vehicleCount}),r.jsx("span",{className:"stat-label",children:"Vehículos"})]}),r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-value",children:O.activeVehicles}),r.jsx("span",{className:"stat-label",children:"Activos"})]})]}),r.jsxs("div",{className:"category-details",children:[r.jsxs("div",{className:"fuel-types",children:[r.jsx("strong",{children:"Combustibles:"}),r.jsx("div",{className:"fuel-list",children:(A.fuelTypes||[]).map(_e=>r.jsx("span",{className:"fuel-tag",children:_e},_e))})]}),r.jsxs("div",{className:"fields",children:[r.jsx("strong",{children:"Campos:"}),r.jsxs("div",{className:"fields-list",children:[(A.fields||[]).slice(0,3).map(_e=>{const Se=Mx.find($=>$.key===_e);return Se?r.jsxs("span",{className:"field-tag",children:[Se.icon," ",Se.label]},_e):null}),(A.fields||[]).length>3&&r.jsxs("span",{className:"more-fields",children:["+",(A.fields||[]).length-3," más"]})]})]})]}),r.jsxs("div",{className:"category-actions",children:[r.jsx("button",{className:"btn-edit",onClick:()=>U(A),disabled:I||p,title:I?"No se pueden editar categorías predeterminadas":"Editar categoría",children:"✏️ Editar"}),r.jsx("button",{className:"btn-delete",onClick:()=>Q(A),disabled:I||p||O.vehicleCount>0,title:I?"No se pueden eliminar categorías predeterminadas":O.vehicleCount>0?"No se puede eliminar una categoría con vehículos asignados":"Eliminar categoría",children:"🗑️ Eliminar"})]})]},A.id)})}),T&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:_?"✏️ Editar Categoría":"➕ Nueva Categoría"}),r.jsx("button",{onClick:()=>j(!1),children:"✕"})]}),r.jsxs("form",{onSubmit:L,className:"category-form",children:[r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{children:"Información Básica"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre *"}),r.jsx("input",{type:"text",value:w.name,onChange:A=>F(I=>({...I,name:A.target.value})),placeholder:"Ej: Maquinaria Pesada",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Icono"}),r.jsx("input",{type:"text",value:w.icon,onChange:A=>F(I=>({...I,icon:A.target.value})),placeholder:"🚗",className:"icon-input"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Descripción"}),r.jsx("textarea",{value:w.description,onChange:A=>F(I=>({...I,description:A.target.value})),placeholder:"Describe el tipo de vehículos que incluye esta categoría",rows:"2"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Color"}),r.jsx("input",{type:"color",value:w.color,onChange:A=>F(I=>({...I,color:A.target.value})),className:"color-input"})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{children:"Tipos de Combustible Compatibles"}),r.jsx("div",{className:"fuel-types-grid",children:Object.values(Aj).map(A=>r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:w.fuelTypes.includes(A),onChange:()=>P(A)}),r.jsx("span",{children:A})]},A))})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{children:"Campos Específicos"}),r.jsx("p",{className:"section-description",children:"Selecciona los campos que serán relevantes para esta categoría"}),r.jsx("div",{className:"fields-grid",children:Mx.map(A=>r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:w.fields.includes(A.key),onChange:()=>R(A.key)}),r.jsxs("span",{children:[A.icon," ",A.label]})]},A.key))})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{children:"Vista Previa"}),r.jsx("div",{className:"category-preview",style:{"--category-color":w.color},children:r.jsxs("div",{className:"category-header",children:[r.jsx("div",{className:"category-icon",style:{color:w.color},children:w.icon}),r.jsxs("div",{className:"category-info",children:[r.jsx("h4",{children:w.name||"Nombre de la categoría"}),r.jsx("p",{children:w.description||"Descripción de la categoría"})]})]})})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>j(!1),disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:p||!w.name.trim(),children:p?"Guardando...":_?"Actualizar":"Crear"})]})]})]})})]})},ZL=({isOpen:n,onClose:e,vehicle:t,onSave:a,mode:o="create"})=>{const[c,d]=Y.useState([]),[m,p]=Y.useState(null),[v,_]=Y.useState(!1),[b,T]=Y.useState(!1),[j,x]=Y.useState(!1),[C,w]=Y.useState({}),F=()=>({vehicleId:t?.vehicleId||"",name:t?.name||"",category:t?.category||"",brand:t?.brand||"",model:t?.model||"",year:t?.year||new Date().getFullYear(),fuelType:t?.fuelType||gt.DIESEL,status:t?.status||Ve.ACTIVO,currentLocation:t?.currentLocation||"",description:t?.description||"",plateNumber:t?.plateNumber||"",enginePower:t?.enginePower||"",fuelCapacity:t?.fuelCapacity||"",operatingWeight:t?.operatingWeight||"",loadCapacity:t?.loadCapacity||"",bucketCapacity:t?.bucketCapacity||"",hasHourMeter:t?.hasHourMeter||!1,currentHours:t?.currentHours||"",implementType:t?.implementType||"",flow:t?.flow||"",pressure:t?.pressure||"",weight:t?.weight||"",lastMaintenanceDate:t?.lastMaintenanceDate?new Date(t.lastMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:t?.purchaseDate?new Date(t.purchaseDate).toISOString().split("T")[0]:""}),[H,V]=Y.useState(F());Y.useEffect(()=>(n?(k(),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n]),Y.useEffect(()=>{if(t&&c.length>0){const A=Ox(t.category,c);p(A),V(F())}},[t,c]);const k=async()=>{try{x(!0);const A=await ey();if(d(A),o==="create"&&A.length>0){const I=A[0];p(I),V(O=>({...O,category:I.id}))}}catch(A){console.error("Error cargando categorías:",A)}finally{x(!1)}},U=A=>{const I=Ox(A,c);p(I),V(O=>{const _e=o==="create"&&O.name&&I?L(O.name,I):O.vehicleId;return{...O,category:A,vehicleId:_e,fuelType:I?.fuelTypes?.includes(O.fuelType)?O.fuelType:I?.fuelTypes?.[0]||gt.DIESEL}}),w({})},Q=(A,I)=>{if(V(O=>({...O,[A]:I})),C[A]&&w(O=>({...O,[A]:null})),A==="name"&&o==="create"){const O=L(I,m);V(_e=>({..._e,vehicleId:O}))}if(A==="category"&&o==="create"&&H.name){const O=m;if(O){const _e=L(H.name,O);V(Se=>({...Se,vehicleId:_e}))}}},L=(A,I)=>{if(!A||!I)return"";const O=I.name.split(" ").map(z=>z.charAt(0).toUpperCase()).join("").substring(0,3),_e=A.replace(/[^a-zA-Z0-9]/g,"").substring(0,4).toUpperCase(),$=Date.now().toString().slice(-3);return`${O}${_e}${$}`},R=()=>{const A={};return H.vehicleId?.trim()||(A.vehicleId="Código del vehículo es requerido"),H.name?.trim()||(A.name="Nombre del vehículo es requerido"),H.category||(A.category="Categoría es requerida"),H.fuelType||(A.fuelType="Tipo de combustible es requerido"),m&&H.fuelType&&(m.fuelTypes?.includes(H.fuelType)||(A.fuelType=`Este combustible no es compatible con la categoría ${m.name}`)),["enginePower","fuelCapacity","operatingWeight","loadCapacity","bucketCapacity","flow","pressure","weight"].forEach(O=>{H[O]&&(isNaN(H[O])||Number(H[O])<0)&&(A[O]="Debe ser un número válido mayor o igual a 0")}),H.year&&(H.year<1900||H.year>new Date().getFullYear()+1)&&(A.year=`Año debe estar entre 1900 y ${new Date().getFullYear()+1}`),H.hasHourMeter&&H.currentHours&&(isNaN(H.currentHours)||Number(H.currentHours)<0)&&(A.currentHours="Horas actuales debe ser un número válido mayor o igual a 0"),w(A),Object.keys(A).length===0},P=async A=>{if(A.preventDefault(),!!R())try{x(!0);const I={...H,type:m?.name||H.category||"Otro",enginePower:H.enginePower?Number(H.enginePower):null,fuelCapacity:H.fuelCapacity?Number(H.fuelCapacity):null,operatingWeight:H.operatingWeight?Number(H.operatingWeight):null,loadCapacity:H.loadCapacity?Number(H.loadCapacity):null,bucketCapacity:H.bucketCapacity?Number(H.bucketCapacity):null,currentHours:H.currentHours?Number(H.currentHours):null,flow:H.flow?Number(H.flow):null,pressure:H.pressure?Number(H.pressure):null,weight:H.weight?Number(H.weight):null,year:Number(H.year),lastMaintenanceDate:H.lastMaintenanceDate?new Date(H.lastMaintenanceDate):null,purchaseDate:H.purchaseDate?new Date(H.purchaseDate):null,categoryName:m?.name,categoryIcon:m?.icon,categoryColor:m?.color};await a(I),e()}catch(I){console.error("Error guardando vehículo:",I),w({submit:I.message})}finally{x(!1)}},D=()=>m&&m.fuelTypes||Object.values(gt);return n?r.jsxs("div",{className:"modal-overlay",children:[r.jsxs("div",{className:"modal-container",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:o==="create"?"🚗 Nuevo Vehículo":"✏️ Editar Vehículo"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>_(!0),disabled:j,children:"📋 Gestionar Categorías"}),r.jsx("button",{type:"button",className:"btn-close",onClick:e,children:"✕"})]})]}),r.jsxs("form",{onSubmit:P,className:"modal-body",children:[C.submit&&r.jsxs("div",{className:"error-banner",children:["⚠️ ",C.submit]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📂 Categoría del Vehículo"}),j?r.jsxs("div",{className:"loading-categories",children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{children:"Cargando categorías..."})]}):r.jsxs("div",{className:"categories-selector",children:[r.jsxs("select",{value:H.category,onChange:A=>U(A.target.value),className:`category-select ${C.category?"error":""}`,children:[r.jsx("option",{value:"",children:"Seleccionar categoría del vehículo..."}),c.map(A=>r.jsxs("option",{value:A.id,children:[A.icon," ",A.name,rs.some(I=>I.id===A.id)&&" (Predeterminada)"]},A.id))]}),m&&r.jsx(JL,{category:m,isExpanded:b,onToggle:()=>T(!b)})]}),C.category&&r.jsx("span",{className:"field-error",children:C.category})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📝 Información Básica"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"vehicleId",className:"form-label",children:"🏷️ Código del Vehículo *"}),r.jsx("input",{type:"text",id:"vehicleId",value:H.vehicleId,className:`form-input ${C.vehicleId?"error":""} ${o==="create"?"readonly":""}`,placeholder:"Se genera automáticamente",readOnly:o==="create",onChange:o==="edit"?A=>Q("vehicleId",A.target.value):void 0,required:!0}),C.vehicleId&&r.jsx("span",{className:"field-error",children:C.vehicleId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",className:"form-label",children:"📛 Nombre del Vehículo *"}),r.jsx("input",{type:"text",id:"name",value:H.name,onChange:A=>Q("name",A.target.value),className:`form-input ${C.name?"error":""}`,placeholder:"Ej: Excavadora Principal, Tractor TR1",required:!0}),C.name&&r.jsx("span",{className:"field-error",children:C.name})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"brand",className:"form-label",children:"🏭 Marca"}),r.jsx("input",{type:"text",id:"brand",value:H.brand,onChange:A=>Q("brand",A.target.value),className:"form-input",placeholder:"Ej: Caterpillar, John Deere"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"year",className:"form-label",children:"📅 Año"}),r.jsx("input",{type:"number",id:"year",value:H.year,onChange:A=>Q("year",A.target.value),className:`form-input ${C.year?"error":""}`,min:"1900",max:new Date().getFullYear()+1}),C.year&&r.jsx("span",{className:"field-error",children:C.year})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"fuelType",className:"form-label",children:"⛽ Tipo de Combustible *"}),r.jsx("select",{id:"fuelType",value:H.fuelType,onChange:A=>Q("fuelType",A.target.value),className:`form-input ${C.fuelType?"error":""}`,required:!0,children:D().map(A=>r.jsx("option",{value:A,children:A},A))}),C.fuelType&&r.jsx("span",{className:"field-error",children:C.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",className:"form-label",children:"🚦 Estado"}),r.jsx("select",{id:"status",value:H.status,onChange:A=>Q("status",A.target.value),className:"form-input",children:Object.entries(Ve).map(([A,I])=>r.jsx("option",{value:I,children:I.charAt(0).toUpperCase()+I.slice(1)},A))})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"currentLocation",className:"form-label",children:"📍 Ubicación Actual"}),r.jsx("input",{type:"text",id:"currentLocation",value:H.currentLocation,onChange:A=>Q("currentLocation",A.target.value),className:"form-input",placeholder:"Ej: Sector Norte, Patio Principal"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",className:"form-label",children:"📄 Descripción"}),r.jsx("textarea",{id:"description",value:H.description,onChange:A=>Q("description",A.target.value),className:"form-input",rows:"3",placeholder:"Descripción adicional del vehículo, características especiales, etc."})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📅 Fechas Importantes"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"purchaseDate",className:"form-label",children:"💰 Fecha de Compra"}),r.jsx("input",{type:"date",id:"purchaseDate",value:H.purchaseDate,onChange:A=>Q("purchaseDate",A.target.value),className:"form-input"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastMaintenanceDate",className:"form-label",children:"🔧 Último Mantenimiento"}),r.jsx("input",{type:"date",id:"lastMaintenanceDate",value:H.lastMaintenanceDate,onChange:A=>Q("lastMaintenanceDate",A.target.value),className:"form-input"})]})]})]}),m&&r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"👁️ Vista Previa"}),r.jsx("div",{className:"vehicle-preview",style:{"--category-color":m.color},children:r.jsxs("div",{className:"preview-header",children:[r.jsx("div",{className:"preview-icon",style:{color:m.color},children:m.icon}),r.jsxs("div",{className:"preview-info",children:[r.jsx("h4",{children:H.name||"Nombre del vehículo"}),r.jsxs("p",{children:[H.vehicleId||"Código del vehículo"," • ",m.name]}),r.jsxs("p",{children:[H.brand," ",H.year]})]})]})})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:j,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:j||!m,children:j?"Guardando...":o==="create"?"Crear Vehículo":"Actualizar Vehículo"})]})]})]}),v&&r.jsx(Uj,{onClose:()=>_(!1),onCategoryCreated:A=>{d(I=>[...I,A]),_(!1)}})]}):null},JL=({category:n,isExpanded:e,onToggle:t})=>n?r.jsxs("div",{className:"category-info-panel",children:[r.jsxs("div",{className:"category-compact",children:[r.jsxs("div",{className:"category-summary",children:[r.jsx("span",{className:"category-icon",style:{color:n.color},children:n.icon}),r.jsxs("div",{className:"category-basic-info",children:[r.jsx("span",{className:"category-name",children:n.name}),r.jsx("span",{className:"category-short-desc",children:n.description?.length>50?n.description.substring(0,50)+"...":n.description})]})]}),r.jsx("button",{type:"button",className:"category-toggle-btn",onClick:t,"aria-label":e?"Contraer información":"Expandir información",children:e?"▲":"▼"})]}),e&&r.jsxs("div",{className:"category-expanded",children:[r.jsxs("div",{className:"category-detail-section",children:[r.jsx("h4",{children:"📋 Descripción Completa"}),r.jsx("p",{children:n.description})]}),n.fuelTypes&&n.fuelTypes.length>0&&r.jsxs("div",{className:"category-detail-section",children:[r.jsx("h4",{children:"⛽ Combustibles Compatibles"}),r.jsx("div",{className:"fuel-types-list",children:n.fuelTypes.map(a=>r.jsx("span",{className:"fuel-type-badge",children:a},a))})]}),n.fields&&n.fields.length>0&&r.jsxs("div",{className:"category-detail-section",children:[r.jsx("h4",{children:"🔧 Campos Específicos"}),r.jsx("div",{className:"fields-list",children:n.fields.map(a=>r.jsx("span",{className:"field-badge",children:a},a))})]}),n.isCustom&&r.jsx("div",{className:"category-detail-section",children:r.jsx("span",{className:"custom-badge",children:"✨ Categoría Personalizada"})})]})]}):null,Oo={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},di={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},ko={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},eV=({isOpen:n,onClose:e,vehicle:t,maintenance:a,onSave:o,mode:c="create",userRole:d})=>{const m=()=>({vehicleId:t?.vehicleId||"",vehicleName:t?.name||"",type:a?.type||Oo.PREVENTIVO,title:a?.title||"",description:a?.description||"",priority:a?.priority||ko.MEDIA,status:a?.status||di.PROGRAMADO,scheduledDate:a?.scheduledDate?new Date(a.scheduledDate).toISOString().split("T")[0]:"",startDate:a?.startDate?new Date(a.startDate).toISOString().split("T")[0]:"",completedDate:a?.completedDate?new Date(a.completedDate).toISOString().split("T")[0]:"",estimatedHours:a?.estimatedHours||0,actualHours:a?.actualHours||0,estimatedCost:a?.estimatedCost||0,actualCost:a?.actualCost||0,technician:a?.technician||"",workshop:a?.workshop||"",parts:a?.parts||[],notes:a?.notes||"",nextMaintenanceKm:a?.nextMaintenanceKm||0,nextMaintenanceHours:a?.nextMaintenanceHours||0,nextMaintenanceDate:a?.nextMaintenanceDate?new Date(a.nextMaintenanceDate).toISOString().split("T")[0]:""}),[p,v]=Y.useState(m()),[_,b]=Y.useState({}),[T,j]=Y.useState(!1),[x,C]=Y.useState({name:"",quantity:1,cost:0});Y.useEffect(()=>{n&&(v(m()),b({}))},[n,a,t]);const w=I=>{const{name:O,value:_e,type:Se}=I.target,$=Se==="number"?parseFloat(_e)||0:_e;v(z=>({...z,[O]:$})),_[O]&&b(z=>({...z,[O]:null}))},F=I=>{const{name:O,value:_e,type:Se}=I.target,$=Se==="number"?parseFloat(_e)||0:_e;C(z=>({...z,[O]:$}))},H=()=>{if(!x.name.trim())return;const I={id:Date.now().toString(),name:x.name.trim(),quantity:x.quantity,cost:x.cost,total:x.quantity*x.cost};v(O=>({...O,parts:[...O.parts,I]})),C({name:"",quantity:1,cost:0})},V=I=>{v(O=>({...O,parts:O.parts.filter(_e=>_e.id!==I)}))},k=()=>{const I={};if(p.title.trim()||(I.title="El título del mantenimiento es obligatorio"),p.description.trim()||(I.description="La descripción es obligatoria"),p.scheduledDate||(I.scheduledDate="La fecha programada es obligatoria"),p.startDate&&p.completedDate){const O=new Date(p.startDate);new Date(p.completedDate)<O&&(I.completedDate="La fecha de finalización debe ser posterior al inicio")}return p.scheduledDate&&p.startDate&&(new Date(p.scheduledDate),new Date(p.startDate)),p.estimatedHours<0&&(I.estimatedHours="Las horas estimadas no pueden ser negativas"),p.actualHours<0&&(I.actualHours="Las horas reales no pueden ser negativas"),p.estimatedCost<0&&(I.estimatedCost="El costo estimado no puede ser negativo"),p.actualCost<0&&(I.actualCost="El costo real no puede ser negativo"),p.status===di.COMPLETADO&&!p.completedDate&&(I.completedDate="La fecha de finalización es obligatoria para mantenimientos completados"),p.status===di.EN_PROCESO&&!p.startDate&&(I.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),b(I),Object.keys(I).length===0},U=async I=>{if(I.preventDefault(),!!k()){j(!0);try{const O=p.parts.reduce((z,ae)=>z+ae.total,0),_e=p.estimatedCost+O,Se=p.actualCost+O,$={...p,vehicleId:t.id,vehicleName:t.name,totalPartsCost:O,totalEstimatedCost:_e,totalActualCost:Se,scheduledDate:p.scheduledDate||null,startDate:p.startDate||null,completedDate:p.completedDate||null,nextMaintenanceDate:p.nextMaintenanceDate||null,createdAt:a?.createdAt||new Date,updatedAt:new Date};await o($),e()}catch(O){console.error("Error guardando mantenimiento:",O),b({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{j(!1)}}},Q=I=>{switch(I){case Oo.PREVENTIVO:return"🔧";case Oo.CORRECTIVO:return"🛠️";case Oo.PREDICTIVO:return"📊";case Oo.EMERGENCIA:return"🚨";default:return"⚙️"}},L=I=>{switch(I){case ko.BAJA:return"priority-low";case ko.MEDIA:return"priority-medium";case ko.ALTA:return"priority-high";case ko.CRITICA:return"priority-critical";default:return"priority-medium"}},R=I=>{switch(I){case di.PROGRAMADO:return"status-scheduled";case di.EN_PROCESO:return"status-in-progress";case di.COMPLETADO:return"status-completed";case di.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},P=()=>p.parts.reduce((I,O)=>I+O.total,0),D=c==="view",A=d==="admin"||d==="supervisor";return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content maintenance-modal",onClick:I=>I.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("div",{className:"modal-title",children:[r.jsx("span",{className:"title-icon",children:c==="create"?"➕":c==="edit"?"✏️":"👁️"}),r.jsxs("div",{className:"title-text",children:[r.jsxs("h3",{children:[c==="create"&&"Registrar Mantenimiento",c==="edit"&&"Editar Mantenimiento",c==="view"&&"Detalles del Mantenimiento"]}),r.jsxs("p",{children:["Vehículo: ",t?.vehicleId," - ",t?.name]})]})]}),r.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),r.jsxs("form",{onSubmit:U,className:"modal-form",children:[r.jsxs("div",{className:"form-content",children:[_.general&&r.jsxs("div",{className:"error-message general-error",children:["⚠️ ",_.general]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📋 Información del Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),r.jsx("select",{id:"type",name:"type",value:p.type,onChange:w,disabled:D||c==="edit"&&!A,children:Object.values(Oo).map(I=>r.jsxs("option",{value:I,children:[Q(I)," ",I.charAt(0).toUpperCase()+I.slice(1)]},I))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"priority",children:"Prioridad"}),r.jsx("select",{id:"priority",name:"priority",value:p.priority,onChange:w,className:L(p.priority),disabled:D||c==="edit"&&!A,children:Object.values(ko).map(I=>r.jsx("option",{value:I,children:I.charAt(0).toUpperCase()+I.slice(1)},I))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsx("select",{id:"status",name:"status",value:p.status,onChange:w,className:R(p.status),disabled:D||c==="edit"&&!A,children:Object.values(di).map(I=>r.jsx("option",{value:I,children:I.charAt(0).toUpperCase()+I.slice(1).replace("_"," ")},I))})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"title",children:"Título del Mantenimiento *"}),r.jsx("input",{type:"text",id:"title",name:"title",value:p.title,onChange:w,placeholder:"Ej: Cambio de aceite y filtros",className:_.title?"error":"",disabled:D||c==="edit"&&!A,maxLength:100}),_.title&&r.jsx("span",{className:"error-text",children:_.title})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📅 Programación"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),r.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:p.scheduledDate,onChange:w,className:_.scheduledDate?"error":"",disabled:D||c==="edit"&&!A}),_.scheduledDate&&r.jsx("span",{className:"error-text",children:_.scheduledDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),r.jsx("input",{type:"date",id:"startDate",name:"startDate",value:p.startDate,onChange:w,className:_.startDate?"error":"",disabled:D||c==="edit"&&!A}),_.startDate&&r.jsx("span",{className:"error-text",children:_.startDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalización"}),r.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:p.completedDate,onChange:w,className:_.completedDate?"error":"",disabled:D||c==="edit"&&!A}),_.completedDate&&r.jsx("span",{className:"error-text",children:_.completedDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),r.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:p.nextMaintenanceDate,onChange:w,disabled:D||c==="edit"&&!A})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"💰 Recursos y Costos"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"technician",children:"Técnico Responsable"}),r.jsx("input",{type:"text",id:"technician",name:"technician",value:p.technician,onChange:w,placeholder:"Nombre del técnico",disabled:D||c==="edit"&&!A,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicación"}),r.jsx("input",{type:"text",id:"workshop",name:"workshop",value:p.workshop,onChange:w,placeholder:"Taller donde se realiza",disabled:D||c==="edit"&&!A,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),r.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:p.estimatedHours,onChange:w,min:"0",step:"0.5",className:_.estimatedHours?"error":"",disabled:D||c==="edit"&&!A}),_.estimatedHours&&r.jsx("span",{className:"error-text",children:_.estimatedHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),r.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:p.actualHours,onChange:w,min:"0",step:"0.5",className:_.actualHours?"error":"",disabled:D||c==="edit"&&!A}),_.actualHours&&r.jsx("span",{className:"error-text",children:_.actualHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),r.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:p.estimatedCost,onChange:w,min:"0",step:"1000",className:_.estimatedCost?"error":"",disabled:D||c==="edit"&&!A}),_.estimatedCost&&r.jsx("span",{className:"error-text",children:_.estimatedCost})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),r.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:p.actualCost,onChange:w,min:"0",step:"1000",className:_.actualCost?"error":"",disabled:D||c==="edit"&&!A}),_.actualCost&&r.jsx("span",{className:"error-text",children:_.actualCost})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔧 Partes y Repuestos"}),!D&&A&&r.jsx("div",{className:"parts-form",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),r.jsx("input",{type:"text",id:"partName",name:"name",value:x.name,onChange:F,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),r.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:x.quantity,onChange:F,min:"1",step:"1"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),r.jsx("input",{type:"number",id:"partCost",name:"cost",value:x.cost,onChange:F,min:"0",step:"1000"})]}),r.jsx("div",{className:"form-group",children:r.jsx("button",{type:"button",className:"btn-add-part",onClick:H,disabled:!x.name.trim(),children:"➕ Agregar"})})]})}),p.parts.length>0&&r.jsx("div",{className:"parts-list",children:r.jsxs("table",{className:"parts-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Parte"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo Unit."}),r.jsx("th",{children:"Total"}),!D&&A&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:p.parts.map(I=>r.jsxs("tr",{children:[r.jsx("td",{children:I.name}),r.jsx("td",{children:I.quantity}),r.jsxs("td",{children:["$",I.cost.toLocaleString("es-CO")]}),r.jsxs("td",{children:["$",I.total.toLocaleString("es-CO")]}),!D&&A&&r.jsx("td",{children:r.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>V(I.id),title:"Eliminar parte",children:"🗑️"})})]},I.id))}),r.jsx("tfoot",{children:r.jsxs("tr",{className:"total-row",children:[r.jsx("td",{colSpan:"3",children:r.jsx("strong",{children:"Total Partes:"})}),r.jsx("td",{children:r.jsxs("strong",{children:["$",P().toLocaleString("es-CO")]})}),!D&&A&&r.jsx("td",{})]})})]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔄 Próximo Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Próximo Mantenimiento (Km)"}),r.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:p.nextMaintenanceKm,onChange:w,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:D||c==="edit"&&!A})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Próximo Mantenimiento (Horas)"}),r.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:p.nextMaintenanceHours,onChange:w,min:"0",step:"100",placeholder:"0 = No aplica",disabled:D||c==="edit"&&!A})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Descripción del Trabajo *"}),r.jsx("textarea",{id:"description",name:"description",value:p.description,onChange:w,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:_.description?"error":"",disabled:D||c==="edit"&&!A}),_.description&&r.jsx("span",{className:"error-text",children:_.description})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),r.jsx("textarea",{id:"notes",name:"notes",value:p.notes,onChange:w,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:D||c==="edit"&&!A}),r.jsxs("span",{className:"char-count",children:[p.notes.length,"/500 caracteres"]})]})]}),r.jsxs("div",{className:"cost-summary",children:[r.jsx("h4",{children:"💰 Resumen de Costos"}),r.jsxs("div",{className:"cost-grid",children:[r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),r.jsxs("span",{className:"cost-value",children:["$",p.actualCost.toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Partes:"}),r.jsxs("span",{className:"cost-value",children:["$",P().toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item total-cost",children:[r.jsx("span",{className:"cost-label",children:"Total:"}),r.jsxs("span",{className:"cost-value",children:["$",(p.actualCost+P()).toLocaleString("es-CO")]})]})]})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:T,children:c==="view"?"Cerrar":"Cancelar"}),!D&&A&&r.jsx("button",{type:"submit",className:"btn-primary",disabled:T,children:T?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):r.jsx(r.Fragment,{children:c==="create"?"➕ Registrar Mantenimiento":"💾 Guardar Cambios"})})]})]})]})}):null},tV=()=>{const{user:n,userProfile:e}=Ts(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,m]=Y.useState(!0),[p,v]=Y.useState(null),[_,b]=Y.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[T,j]=Y.useState("cards"),[x,C]=Y.useState(""),[w,F]=Y.useState(!1),[H,V]=Y.useState(!1),[k,U]=Y.useState(!1),[Q,L]=Y.useState(null),[R,P]=Y.useState("create");Y.useEffect(()=>{if(!n)return;m(!0);const ee=Zv((ce,ue)=>{if(ue){console.error("Error en suscripción de vehículos:",ue),v("Error al cargar vehículos"),m(!1);return}a(ce),v(null),m(!1)},_);return()=>ee()},[n,_]),Y.useEffect(()=>{n&&(async()=>{try{const ce=await Rj(_);c(ce)}catch(ce){console.error("Error al cargar estadísticas:",ce)}})()},[n,t,_]);const D=t.filter(ee=>{if(!x)return!0;const ce=x.toLowerCase();return ee.vehicleId?.toLowerCase().includes(ce)||ee.name?.toLowerCase().includes(ce)||ee.type?.toLowerCase().includes(ce)||ee.brand?.toLowerCase().includes(ce)||ee.model?.toLowerCase().includes(ce)||ee.currentLocation?.toLowerCase().includes(ce)||ee.description?.toLowerCase().includes(ce)}),A=()=>{L(null),P("create"),F(!0)},I=ee=>{L(ee),P("edit"),F(!0)},O=ee=>{L(ee),P("view"),F(!0)},_e=ee=>{L(ee),V(!0)},Se=()=>{F(!1),V(!1),L(null)},$=ee=>{b(ce=>({...ce,...ee}))},z=()=>{b({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),C("")},ae=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",he=e?.role==="admin",q=e?.role==="admin"||e?.role==="contador";return d?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando vehículos..."})]})}):p?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:"⚠️"}),r.jsx("h3",{children:"Error al cargar vehículos"}),r.jsx("p",{children:p}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"vehicles-main",children:[r.jsxs("div",{className:"vehicles-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🚜 Gestión de Vehículos"}),r.jsx("p",{children:"Administra la maquinaria y vehículos forestales"})]}),ae&&r.jsx("button",{className:"btn-create-vehicle",onClick:A,children:"➕ Nuevo Vehículo"})]}),o&&r.jsx(qL,{stats:o,filters:_}),r.jsx(BL,{filters:_,onFilterChange:$,onClearFilters:z,searchTerm:x,onSearchChange:C,viewMode:T,onViewModeChange:j,totalResults:D.length}),D.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"🚜"}),r.jsx("h3",{children:t.length===0?"No hay vehículos registrados":"No se encontraron vehículos"}),r.jsx("p",{children:t.length===0?"Comienza registrando tu primer vehículo o maquinaria forestal":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&ae&&r.jsx("button",{className:"btn-create-first",onClick:A,children:"➕ Registrar Primer Vehículo"})]}):r.jsx(GL,{vehicles:D,viewMode:T,onEdit:he?I:null,onView:O,onMaintenance:q?_e:null,userRole:n?.role}),w&&r.jsx(ZL,{isOpen:w,onClose:Se,vehicle:Q,mode:R,onSave:async ee=>{R==="create"?await Sj(ee):await Ij(Q.id,ee),Se()},userRole:e?.role}),k&&r.jsx(Uj,{onClose:()=>U(!1),onCategoryCreated:()=>{}}),H&&r.jsx(eV,{isOpen:H,onClose:Se,vehicle:Q,onSuccess:()=>{Se()}})]})},bu="combustibles_maintenance",Fj="combustibles_vehicles",fe={OIL_CHANGE:"oil_change",BATTERY_CHANGE:"battery_change",FILTER_CHANGE:"filter_change",GENERAL_MAINTENANCE:"general_maintenance"},ke={COMPLETED:"completado",PENDING:"pendiente",CANCELLED:"cancelado"},Ho={NEW:"nueva",USED:"usada",REPAIRED:"reparada"},ty={OIL_CHANGE_HOURS:250,BATTERY_LIFETIME_MONTHS:24},qj=async n=>{try{sV(n);const e={...n,createdAt:et(),updatedAt:et(),status:n.status||ke.COMPLETED,createdBy:n.createdBy||"system"};n.type===fe.OIL_CHANGE&&(e.nextChangeHours=_f(n.currentHours)),n.type===fe.BATTERY_CHANGE&&(e.nextBatteryChange=Yj(n.date));const t=await hl(Pe(ge,bu),e);return n.vehicleId&&n.currentHours&&await Kj(n.vehicleId,n.currentHours),console.log("✅ Mantenimiento creado exitosamente:",t.id),t.id}catch(e){throw console.error("❌ Error al crear mantenimiento:",e),new Error(`Error al crear mantenimiento: ${e.message}`)}},Bj=async(n={})=>{try{let e=Pe(ge,bu);n.type&&(e=Ae(e,Oe("type","==",n.type))),n.vehicleId&&(e=Ae(e,Oe("vehicleId","==",n.vehicleId))),n.status&&(e=Ae(e,Oe("status","==",n.status))),n.dateFrom&&(e=Ae(e,Oe("date",">=",new Date(n.dateFrom)))),n.dateTo&&(e=Ae(e,Oe("date","<=",new Date(n.dateTo)))),e=Ae(e,jn("date","desc"));const t=await yt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data()})}),a}catch(e){throw console.error("❌ Error al obtener mantenimientos:",e),new Error(`Error al obtener mantenimientos: ${e.message}`)}},Hj=async(n,e)=>{try{aV(e);const t=st(ge,bu,n),a={...e,updatedAt:et()};e.currentHours&&e.type===fe.OIL_CHANGE&&(a.nextChangeHours=_f(e.currentHours)),await xs(t,a),e.vehicleId&&e.currentHours&&await Kj(e.vehicleId,e.currentHours),console.log("✅ Mantenimiento actualizado exitosamente:",n)}catch(t){throw console.error("❌ Error al actualizar mantenimiento:",t),new Error(`Error al actualizar mantenimiento: ${t.message}`)}},nV=async n=>{try{const e=st(ge,bu,n);await hf(e),console.log("✅ Mantenimiento eliminado exitosamente:",n)}catch(e){throw console.error("❌ Error al eliminar mantenimiento:",e),new Error(`Error al eliminar mantenimiento: ${e.message}`)}},zj=async(n={})=>{try{const e=await Bj(n),t={total:e.length,byType:{},byStatus:{},byVehicle:{},totalCost:0,averageCost:0,upcomingCount:0,overdueCount:0};let a=0;return e.forEach(o=>{t.byType[o.type]=(t.byType[o.type]||0)+1,t.byStatus[o.status]=(t.byStatus[o.status]||0)+1,t.byVehicle[o.vehicleId]=(t.byVehicle[o.vehicleId]||0)+1,o.cost&&(a+=parseFloat(o.cost)),o.nextChangeDate&&(new Date(o.nextChangeDate)>new Date?t.upcomingCount++:t.overdueCount++)}),t.totalCost=a,t.averageCost=t.total>0?a/t.total:0,t}catch(e){throw console.error("❌ Error al obtener estadísticas de mantenimiento:",e),new Error(`Error al obtener estadísticas de mantenimiento: ${e.message}`)}},Gj=(n,e={})=>{try{let t=Pe(ge,bu);return e.type&&(t=Ae(t,Oe("type","==",e.type))),e.vehicleId&&(t=Ae(t,Oe("vehicleId","==",e.vehicleId))),e.status&&(t=Ae(t,Oe("status","==",e.status))),t=Ae(t,jn("date","desc")),Ur(t,o=>{const c=[];o.forEach(d=>{c.push({id:d.id,...d.data()})}),n(c,null)},o=>{console.error("❌ Error en suscripción de mantenimientos:",o),n([],o)})}catch(t){return console.error("❌ Error al suscribirse a mantenimientos:",t),n([],t),()=>{}}},$j=async()=>{try{const n=Ae(Pe(ge,Fj),Oe("status","in",["activo","mantenimiento"]),jn("name","asc")),e=await yt(n),t=[];return e.forEach(a=>{t.push({id:a.id,...a.data()})}),t}catch(n){throw console.error("❌ Error al obtener vehículos para mantenimiento:",n),new Error(`Error al obtener vehículos para mantenimiento: ${n.message}`)}},_f=n=>parseInt(n)+ty.OIL_CHANGE_HOURS,Yj=n=>{const e=new Date(n);return e.setMonth(e.getMonth()+ty.BATTERY_LIFETIME_MONTHS),e},Kj=async(n,e)=>{try{const t=Ae(Pe(ge,Fj),Oe("vehicleId","==",n)),a=await yt(t);if(!a.empty){const o=a.docs[0],c=o.data();if(c.hasHourMeter&&c.type==="tractor"){const d=parseInt(c.currentHours)||0,m=parseInt(e)||0;m>d&&(await xs(o.ref,{currentHours:m,lastHourMeterDate:et(),updatedAt:et()}),console.log(`✅ Horómetro actualizado para ${n}: ${d} → ${m}`))}}}catch(t){console.error("❌ Error al actualizar horómetro del vehículo:",t)}},sV=n=>{const e=[];if(n.type||e.push("El tipo de mantenimiento es obligatorio"),n.vehicleId||e.push("El vehículo es obligatorio"),n.date||e.push("La fecha es obligatoria"),n.type===fe.OIL_CHANGE&&((!n.quantity||n.quantity<=0)&&e.push("La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!n.currentHours||n.currentHours<0)&&e.push("La lectura del horómetro es obligatoria")),n.type===fe.BATTERY_CHANGE&&(n.batteryType||e.push("El tipo de batería es obligatorio"),(!n.cost||n.cost<=0)&&e.push("El costo de la batería es obligatorio")),e.length>0)throw new Error(e.join(", "))},aV=n=>{const e=[];if(n.type&&!Object.values(fe).includes(n.type)&&e.push("Tipo de mantenimiento inválido"),n.status&&!Object.values(ke).includes(n.status)&&e.push("Estado de mantenimiento inválido"),n.batteryStatus&&!Object.values(Ho).includes(n.batteryStatus)&&e.push("Estado de batería inválido"),e.length>0)throw new Error(e.join(", "))},iV=Object.freeze(Object.defineProperty({__proto__:null,BATTERY_STATUS:Ho,MAINTENANCE_CONSTANTS:ty,MAINTENANCE_STATUS:ke,MAINTENANCE_TYPES:fe,calculateNextBatteryChange:Yj,calculateNextOilChange:_f,createMaintenanceRecord:qj,deleteMaintenanceRecord:nV,getAllMaintenanceRecords:Bj,getMaintenanceStats:zj,getVehiclesForMaintenance:$j,subscribeToMaintenance:Gj,updateMaintenanceRecord:Hj},Symbol.toStringTag,{value:"Module"})),rV=({stats:n})=>{if(!n)return null;const e=c=>{switch(c){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},t=c=>{switch(c){case fe.OIL_CHANGE:return"Cambios de Aceite";case fe.BATTERY_CHANGE:return"Cambios de Batería";case fe.FILTER_CHANGE:return"Cambios de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimientos Generales";default:return c}},a=c=>{switch(c){case ke.COMPLETED:return"#10b981";case ke.PENDING:return"#f59e0b";case ke.CANCELLED:return"#ef4444";default:return"#6b7280"}},o=c=>{switch(c){case ke.COMPLETED:return"Completados";case ke.PENDING:return"Pendientes";case ke.CANCELLED:return"Cancelados";default:return c}};return r.jsxs("div",{className:"maintenance-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"🔧"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:Me(n.total)}),r.jsx("p",{children:"Total Mantenimientos"})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:An(n.totalCost)}),r.jsx("p",{children:"Costo Total"})]})]}),r.jsxs("div",{className:"stat-card warning",children:[r.jsx("div",{className:"stat-icon",children:"⏰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:Me(n.upcomingCount)}),r.jsx("p",{children:"Próximos"})]})]}),r.jsxs("div",{className:"stat-card danger",children:[r.jsx("div",{className:"stat-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:Me(n.overdueCount)}),r.jsx("p",{children:"Vencidos"})]})]})]}),Object.keys(n.byType).length>0&&r.jsxs("div",{className:"stats-breakdown",children:[r.jsx("h3",{children:"📊 Desglose por Tipo"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([c,d])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:e(c)}),r.jsx("span",{className:"breakdown-label",children:t(c)})]}),r.jsx("div",{className:"breakdown-value",children:Me(d)}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:"#3b82f6"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),Object.keys(n.byStatus).length>0&&r.jsxs("div",{className:"stats-breakdown",children:[r.jsx("h3",{children:"📈 Desglose por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([c,d])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a(c)}}),r.jsx("span",{className:"breakdown-label",children:o(c)})]}),r.jsx("div",{className:"breakdown-value",children:Me(d)}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:a(c)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),r.jsxs("div",{className:"stats-insights",children:[r.jsx("h3",{children:"💡 Insights"}),r.jsxs("div",{className:"insights-grid",children:[r.jsxs("div",{className:"insight-item",children:[r.jsx("span",{className:"insight-label",children:"Costo Promedio:"}),r.jsx("span",{className:"insight-value",children:An(n.averageCost)})]}),n.overdueCount>0&&r.jsxs("div",{className:"insight-item alert",children:[r.jsx("span",{className:"insight-label",children:"⚠️ Mantenimientos Vencidos:"}),r.jsxs("span",{className:"insight-value",children:[Me(n.overdueCount)," requieren atención"]})]}),n.upcomingCount>0&&r.jsxs("div",{className:"insight-item info",children:[r.jsx("span",{className:"insight-label",children:"⏰ Próximos Mantenimientos:"}),r.jsxs("span",{className:"insight-value",children:[Me(n.upcomingCount)," programados"]})]})]})]})]})},oV=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:m})=>{const p=j=>{switch(j){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batería";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return j}},v=j=>{switch(j){case ke.COMPLETED:return"Completado";case ke.PENDING:return"Pendiente";case ke.CANCELLED:return"Cancelado";default:return j}},_=(j,x)=>{e({[j]:x})},b=j=>{e(j)},T=()=>Object.values(n).some(j=>j!=="")||a;return r.jsx("div",{className:"maintenance-filters",children:r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar mantenimientos...",value:a,onChange:j=>o(j.target.value)}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),children:"×"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${T()?"":"active"}`,onClick:()=>t(),children:"Todos"}),r.jsx("button",{className:`quick-filter ${n.type===fe.OIL_CHANGE?"active":""}`,onClick:()=>b({type:fe.OIL_CHANGE}),children:"🛢️ Aceite"}),r.jsx("button",{className:`quick-filter ${n.type===fe.BATTERY_CHANGE?"active":""}`,onClick:()=>b({type:fe.BATTERY_CHANGE}),children:"🔋 Baterías"}),r.jsx("button",{className:`quick-filter ${n.status===ke.PENDING?"active":""}`,onClick:()=>b({status:ke.PENDING}),children:"⏰ Pendientes"})]}),r.jsxs("button",{className:`btn-advanced-filters ${T()?"active":""}`,onClick:()=>document.querySelector(".filters-advanced").classList.toggle("show"),children:["🔧 Filtros Avanzados",T()&&r.jsx("span",{className:"filters-count",children:Object.values(n).filter(j=>j!=="").length})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),children:"📋 Cards"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),children:"📊 Tabla"})]})]}),r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Mantenimiento"}),r.jsxs("select",{value:n.type,onChange:j=>_("type",j.target.value),children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:fe.OIL_CHANGE,children:p(fe.OIL_CHANGE)}),r.jsx("option",{value:fe.BATTERY_CHANGE,children:p(fe.BATTERY_CHANGE)}),r.jsx("option",{value:fe.FILTER_CHANGE,children:p(fe.FILTER_CHANGE)}),r.jsx("option",{value:fe.GENERAL_MAINTENANCE,children:p(fe.GENERAL_MAINTENANCE)})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:j=>_("status",j.target.value),children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:ke.COMPLETED,children:v(ke.COMPLETED)}),r.jsx("option",{value:ke.PENDING,children:v(ke.PENDING)}),r.jsx("option",{value:ke.CANCELLED,children:v(ke.CANCELLED)})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Fecha Desde"}),r.jsx("input",{type:"date",value:n.dateFrom,onChange:j=>_("dateFrom",j.target.value)})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Fecha Hasta"}),r.jsx("input",{type:"date",value:n.dateTo,onChange:j=>_("dateTo",j.target.value)})]})]}),r.jsx("div",{className:"filters-actions",children:r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:!T(),children:"🗑️ Limpiar Filtros"})})]}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("div",{className:"results-count",children:[m," mantenimiento",m!==1?"s":""," encontrado",m!==1?"s":""]}),T()&&r.jsxs("div",{className:"active-filters",children:[r.jsx("span",{className:"filters-label",children:"Filtros activos:"}),r.jsxs("div",{className:"filter-tags",children:[n.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",p(n.type),r.jsx("button",{onClick:()=>_("type",""),children:"×"})]}),n.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",v(n.status),r.jsx("button",{onClick:()=>_("status",""),children:"×"})]}),n.dateFrom&&r.jsxs("span",{className:"filter-tag",children:["Desde: ",n.dateFrom,r.jsx("button",{onClick:()=>_("dateFrom",""),children:"×"})]}),n.dateTo&&r.jsxs("span",{className:"filter-tag",children:["Hasta: ",n.dateTo,r.jsx("button",{onClick:()=>_("dateTo",""),children:"×"})]}),a&&r.jsxs("span",{className:"filter-tag",children:['Búsqueda: "',a,'"',r.jsx("button",{onClick:()=>o(""),children:"×"})]})]})]})]})]})})},lV=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const c=x=>x?new Date(x).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"N/A",d=x=>{if(!x)return"";const C=new Date,w=new Date(x),F=Math.abs(C-w),H=Math.ceil(F/(1e3*60*60*24));return H===0?"Hoy":H===1?"Ayer":H<7?`Hace ${H} días`:H<30?`Hace ${Math.floor(H/7)} semanas`:`Hace ${Math.floor(H/30)} meses`},m=x=>{switch(x){case fe.OIL_CHANGE:return"maintenance-oil-change";case fe.BATTERY_CHANGE:return"maintenance-battery-change";case fe.FILTER_CHANGE:return"maintenance-filter-change";case fe.GENERAL_MAINTENANCE:return"maintenance-general";default:return"maintenance-general"}},p=x=>{switch(x){case ke.COMPLETED:return"status-completado";case ke.PENDING:return"status-pendiente";case ke.CANCELLED:return"status-cancelado";default:return"status-unknown"}},v=x=>{switch(x){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},_=x=>{switch(x){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batería";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return x}},b=x=>{switch(x){case ke.COMPLETED:return"✅";case ke.PENDING:return"⏰";case ke.CANCELLED:return"❌";default:return"❓"}},T=x=>{switch(x){case ke.COMPLETED:return"Completado";case ke.PENDING:return"Pendiente";case ke.CANCELLED:return"Cancelado";default:return x}},j=o==="admin"||o==="supervisor";return r.jsx("div",{className:"maintenance-cards",children:n.map(x=>r.jsxs("div",{className:`maintenance-card ${m(x.type)}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"maintenance-type",children:[r.jsx("span",{className:"type-icon",children:v(x.type)}),r.jsx("span",{className:"type-label",children:_(x.type)})]}),r.jsxs("div",{className:`status-badge ${p(x.status)}`,children:[b(x.status)," ",T(x.status)]})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"vehicle-info",children:[r.jsx("span",{className:"vehicle-icon",children:"🚜"}),r.jsxs("div",{className:"vehicle-details",children:[r.jsx("div",{className:"vehicle-name",children:x.vehicleName}),r.jsx("div",{className:"vehicle-id",children:x.vehicleId})]})]}),r.jsxs("div",{className:"date-info",children:[r.jsx("div",{className:"created-date",children:c(x.date)}),r.jsx("div",{className:"relative-time",children:d(x.date)})]}),x.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"oil-change-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Cantidad:"}),r.jsxs("span",{className:"info-value",children:[Me(x.quantity)," galones"]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Horómetro:"}),r.jsxs("span",{className:"info-value",children:[Me(x.currentHours)," horas"]})]}),x.nextChangeHours&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Próximo cambio:"}),r.jsxs("span",{className:"info-value",children:[Me(x.nextChangeHours)," horas"]})]}),x.filters&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Filtros:"}),r.jsx("span",{className:"info-value",children:x.filters})]})]}),x.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"battery-change-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Tipo:"}),r.jsx("span",{className:"info-value",children:x.batteryType})]}),x.brand&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Marca:"}),r.jsx("span",{className:"info-value",children:x.brand})]}),x.model&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Modelo:"}),r.jsx("span",{className:"info-value",children:x.model})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Estado:"}),r.jsx("span",{className:"info-value",children:x.batteryStatus})]}),x.cost&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Costo:"}),r.jsx("span",{className:"info-value",children:An(x.cost)})]})]}),x.notes&&r.jsxs("div",{className:"notes-section",children:[r.jsx("span",{className:"notes-label",children:"Notas:"}),r.jsx("p",{className:"notes-text",children:x.notes})]})]}),r.jsx("div",{className:"card-footer",children:r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(x),title:"Ver detalles",children:"👁️ Ver"}),j&&e&&r.jsx("button",{className:"btn-edit",onClick:()=>e(x),title:"Editar",children:"✏️ Editar"}),j&&a&&r.jsx("button",{className:"btn-delete",onClick:()=>a(x.id),title:"Eliminar",children:"🗑️ Eliminar"})]})})]},x.id))})},cV=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const[c,d]=Y.useState("date"),[m,p]=Y.useState("desc"),v=V=>V?new Date(V).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",_=V=>{switch(V){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},b=V=>{switch(V){case fe.OIL_CHANGE:return"Cambio de Aceite";case fe.BATTERY_CHANGE:return"Cambio de Batería";case fe.FILTER_CHANGE:return"Cambio de Filtros";case fe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return V}},T=V=>{switch(V){case ke.COMPLETED:return"✅";case ke.PENDING:return"⏰";case ke.CANCELLED:return"❌";default:return"❓"}},j=V=>{switch(V){case ke.COMPLETED:return"Completado";case ke.PENDING:return"Pendiente";case ke.CANCELLED:return"Cancelado";default:return V}},x=V=>{switch(V){case ke.COMPLETED:return"status-completado";case ke.PENDING:return"status-pendiente";case ke.CANCELLED:return"status-cancelado";default:return"status-unknown"}},C=V=>{c===V?p(m==="asc"?"desc":"asc"):(d(V),p("asc"))},w=V=>c!==V?"↕️":m==="asc"?"↑":"↓",F=[...n].sort((V,k)=>{let U=V[c],Q=k[c];return c==="date"&&(U=new Date(U),Q=new Date(Q)),["quantity","currentHours","nextChangeHours","cost"].includes(c)&&(U=parseFloat(U)||0,Q=parseFloat(Q)||0),typeof U=="string"&&(U=U.toLowerCase(),Q=Q.toLowerCase()),m==="asc"?U>Q?1:-1:U<Q?1:-1}),H=o==="admin"||o==="supervisor";return r.jsxs("div",{className:"maintenance-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"maintenance-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>C("type"),children:["Tipo ",w("type")]}),r.jsxs("th",{className:"sortable",onClick:()=>C("vehicleName"),children:["Vehículo ",w("vehicleName")]}),r.jsxs("th",{className:"sortable",onClick:()=>C("date"),children:["Fecha ",w("date")]}),r.jsx("th",{children:"Detalles"}),r.jsxs("th",{className:"sortable",onClick:()=>C("status"),children:["Estado ",w("status")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>C("cost"),children:["Costo ",w("cost")]}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:F.map(V=>r.jsxs("tr",{className:"maintenance-row",children:[r.jsx("td",{className:"type-cell",children:r.jsxs("div",{className:"type-content",children:[r.jsx("span",{className:"type-icon",children:_(V.type)}),r.jsx("span",{className:"type-name",children:b(V.type)})]})}),r.jsx("td",{className:"vehicle-cell",children:r.jsxs("div",{className:"vehicle-info",children:[r.jsx("div",{className:"vehicle-name",children:V.vehicleName}),r.jsx("div",{className:"vehicle-id",children:V.vehicleId})]})}),r.jsx("td",{className:"date-cell",children:r.jsx("div",{className:"date-content",children:r.jsx("div",{className:"date-value",children:v(V.date)})})}),r.jsxs("td",{className:"details-cell",children:[V.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"oil-details",children:[r.jsxs("div",{children:["Qty: ",Me(V.quantity)," gal"]}),r.jsxs("div",{children:["Hrs: ",Me(V.currentHours)]}),V.filters&&r.jsxs("div",{children:["Filtros: ",V.filters]})]}),V.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"battery-details",children:[r.jsx("div",{children:V.batteryType}),V.brand&&r.jsx("div",{children:V.brand}),r.jsxs("div",{children:["Estado: ",V.batteryStatus]})]}),V.notes&&r.jsx("div",{className:"notes-small",children:V.notes})]}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${x(V.status)}`,children:[T(V.status)," ",j(V.status)]})}),r.jsx("td",{className:"cost-cell text-right",children:V.cost?An(V.cost):"N/A"}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(V),title:"Ver detalles",children:"👁️"}),H&&e&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(V),title:"Editar",children:"✏️"}),H&&a&&r.jsx("button",{className:"btn-action btn-delete",onClick:()=>a(V.id),title:"Eliminar",children:"🗑️"})]})})]},V.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsx("div",{className:"table-summary",children:r.jsxs("span",{className:"total-rows",children:[n.length," mantenimiento",n.length!==1?"s":""," en total"]})}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot oil-change"}),r.jsx("span",{children:"Cambio de Aceite"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot battery-change"}),r.jsx("span",{children:"Cambio de Batería"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot filter-change"}),r.jsx("span",{children:"Cambio de Filtros"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot general"}),r.jsx("span",{children:"Mantenimiento General"})]})]})]})]})},uV=({maintenanceRecords:n,viewMode:e,onEdit:t,onView:a,onDelete:o,userRole:c})=>!n||n.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"🔧"}),r.jsx("h3",{children:"No hay mantenimientos registrados"}),r.jsx("p",{children:"Comienza creando el primer mantenimiento para tu flota de vehículos."})]}):r.jsx("div",{className:"maintenance-list",children:e==="cards"?r.jsx(lV,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c}):r.jsx(cV,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c})}),dV=({isOpen:n,onClose:e,onSuccess:t,maintenance:a,mode:o="create",userRole:c})=>{const d=()=>({type:a?.type||fe.OIL_CHANGE,vehicleId:a?.vehicleId||"",vehicleName:a?.vehicleName||"",date:a?.date?new Date(a.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:a?.status||ke.COMPLETED,quantity:a?.quantity||0,currentHours:a?.currentHours||0,nextChangeHours:a?.nextChangeHours||0,filters:a?.filters||"",batteryType:a?.batteryType||"",brand:a?.brand||"",model:a?.model||"",batteryStatus:a?.batteryStatus||Ho.NEW,notes:a?.notes||"",cost:a?.cost||0}),[m,p]=Y.useState(d()),[v,_]=Y.useState({}),[b,T]=Y.useState(!1),[j,x]=Y.useState([]);Y.useEffect(()=>{n&&(async()=>{try{const Q=await $j();x(Q)}catch(Q){console.error("Error al cargar vehículos:",Q)}})()},[n]),Y.useEffect(()=>{n&&(p(d()),_({}))},[n,a,j]),Y.useEffect(()=>{if(m.type===fe.OIL_CHANGE&&m.currentHours>0){const U=_f(m.currentHours);p(Q=>({...Q,nextChangeHours:U}))}},[m.currentHours,m.type]);const C=(U,Q)=>{const L=typeof Q=="number"?parseFloat(Q)||0:Q;p(R=>({...R,[U]:L})),v[U]&&_(R=>({...R,[U]:null}))},w=U=>{const Q=j.find(L=>L.vehicleId===U);p(L=>({...L,vehicleId:U,vehicleName:Q?Q.name:""})),Q&&Q.hasHourMeter&&Q.currentHours&&p(L=>({...L,currentHours:Q.currentHours}))},F=()=>{const U={};return m.type||(U.type="El tipo de mantenimiento es obligatorio"),m.vehicleId||(U.vehicleId="El vehículo es obligatorio"),m.date||(U.date="La fecha es obligatoria"),m.type===fe.OIL_CHANGE&&((!m.quantity||m.quantity<=0)&&(U.quantity="La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!m.currentHours||m.currentHours<0)&&(U.currentHours="La lectura del horómetro es obligatoria")),m.type===fe.BATTERY_CHANGE&&(m.batteryType||(U.batteryType="El tipo de batería es obligatorio"),(!m.cost||m.cost<=0)&&(U.cost="El costo de la batería es obligatorio")),_(U),Object.keys(U).length===0},H=async U=>{if(U.preventDefault(),!!F()){T(!0);try{const Q={...m,date:new Date(m.date),createdBy:c||"user"};o==="create"?(await qj(Q),console.log("✅ Mantenimiento creado exitosamente")):o==="edit"&&(await Hj(a.id,Q),console.log("✅ Mantenimiento actualizado exitosamente")),t()}catch(Q){console.error("❌ Error al guardar mantenimiento:",Q),alert("Error al guardar mantenimiento: "+Q.message)}finally{T(!1)}}},V=()=>{switch(o){case"create":return"Crear Mantenimiento";case"edit":return"Editar Mantenimiento";case"view":return"Ver Mantenimiento";default:return"Mantenimiento"}},k=U=>{switch(U){case fe.OIL_CHANGE:return"🛢️";case fe.BATTERY_CHANGE:return"🔋";case fe.FILTER_CHANGE:return"🔧";case fe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}};return n?r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content maintenance-modal",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:V()}),r.jsx("button",{className:"modal-close",onClick:e,children:"×"})]}),r.jsx("div",{className:"modal-body",children:r.jsxs("form",{onSubmit:H,className:"maintenance-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Mantenimiento *"}),r.jsxs("select",{value:m.type,onChange:U=>C("type",U.target.value),disabled:o==="view",children:[r.jsxs("option",{value:fe.OIL_CHANGE,children:[k(fe.OIL_CHANGE)," Cambio de Aceite"]}),r.jsxs("option",{value:fe.BATTERY_CHANGE,children:[k(fe.BATTERY_CHANGE)," Cambio de Batería"]}),r.jsxs("option",{value:fe.FILTER_CHANGE,children:[k(fe.FILTER_CHANGE)," Cambio de Filtros"]}),r.jsxs("option",{value:fe.GENERAL_MAINTENANCE,children:[k(fe.GENERAL_MAINTENANCE)," Mantenimiento General"]})]}),v.type&&r.jsx("span",{className:"error-text",children:v.type})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Vehículo *"}),r.jsxs("select",{value:m.vehicleId,onChange:U=>w(U.target.value),disabled:o==="view",children:[r.jsx("option",{value:"",children:"Seleccionar vehículo"}),j.map(U=>r.jsxs("option",{value:U.vehicleId,children:[U.vehicleId," - ",U.name," (",U.type,")"]},U.vehicleId))]}),v.vehicleId&&r.jsx("span",{className:"error-text",children:v.vehicleId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Fecha *"}),r.jsx("input",{type:"date",value:m.date,onChange:U=>C("date",U.target.value),disabled:o==="view"}),v.date&&r.jsx("span",{className:"error-text",children:v.date})]}),m.type===fe.OIL_CHANGE&&r.jsxs("div",{className:"maintenance-section",children:[r.jsx("h3",{children:"🛢️ Información del Cambio de Aceite"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cantidad (galones) *"}),r.jsx("input",{type:"number",step:"0.1",value:m.quantity,onChange:U=>C("quantity",U.target.value),disabled:o==="view"}),v.quantity&&r.jsx("span",{className:"error-text",children:v.quantity})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Horómetro Actual *"}),r.jsx("input",{type:"number",value:m.currentHours,onChange:U=>C("currentHours",U.target.value),disabled:o==="view"}),v.currentHours&&r.jsx("span",{className:"error-text",children:v.currentHours})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Próximo Cambio (horas)"}),r.jsx("input",{type:"number",value:m.nextChangeHours,disabled:!0,className:"readonly-input"}),r.jsx("small",{children:"Calculado automáticamente: actual + 250 horas"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Filtros o Extras"}),r.jsx("textarea",{value:m.filters,onChange:U=>C("filters",U.target.value),disabled:o==="view",placeholder:"Especificar filtros cambiados o extras..."})]})]}),m.type===fe.BATTERY_CHANGE&&r.jsxs("div",{className:"maintenance-section",children:[r.jsx("h3",{children:"🔋 Información del Cambio de Batería"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Batería *"}),r.jsx("input",{type:"text",value:m.batteryType,onChange:U=>C("batteryType",U.target.value),disabled:o==="view",placeholder:"Ej: 12V 60Ah"}),v.batteryType&&r.jsx("span",{className:"error-text",children:v.batteryType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado *"}),r.jsxs("select",{value:m.batteryStatus,onChange:U=>C("batteryStatus",U.target.value),disabled:o==="view",children:[r.jsx("option",{value:Ho.NEW,children:"Nueva"}),r.jsx("option",{value:Ho.USED,children:"Usada"}),r.jsx("option",{value:Ho.REPAIRED,children:"Reparada"})]})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Marca"}),r.jsx("input",{type:"text",value:m.brand,onChange:U=>C("brand",U.target.value),disabled:o==="view",placeholder:"Ej: Bosch, Exide"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Modelo"}),r.jsx("input",{type:"text",value:m.model,onChange:U=>C("model",U.target.value),disabled:o==="view",placeholder:"Ej: S4 005"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Costo *"}),r.jsx("input",{type:"number",step:"1000",value:m.cost,onChange:U=>C("cost",U.target.value),disabled:o==="view",placeholder:"0"}),v.cost&&r.jsx("span",{className:"error-text",children:v.cost})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Notas Adicionales"}),r.jsx("textarea",{value:m.notes,onChange:U=>C("notes",U.target.value),disabled:o==="view",placeholder:"Observaciones adicionales...",rows:"3"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:m.status,onChange:U=>C("status",U.target.value),disabled:o==="view",children:[r.jsx("option",{value:ke.COMPLETED,children:"Completado"}),r.jsx("option",{value:ke.PENDING,children:"Pendiente"}),r.jsx("option",{value:ke.CANCELLED,children:"Cancelado"})]})]})]})}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:b,children:"Cancelar"}),o!=="view"&&r.jsx("button",{type:"submit",className:"btn btn-primary",onClick:H,disabled:b,children:b?"Guardando...":o==="create"?"Crear":"Actualizar"})]})]})}):null},hV=()=>{const{user:n,userProfile:e}=Ts(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,m]=Y.useState(!0),[p,v]=Y.useState(null),[_,b]=Y.useState({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),[T,j]=Y.useState("cards"),[x,C]=Y.useState(""),[w,F]=Y.useState(!1),[H,V]=Y.useState(null),[k,U]=Y.useState("create");Y.useEffect(()=>{if(!n)return;m(!0);const $=Gj((z,ae)=>{if(ae){console.error("Error en suscripción de mantenimientos:",ae),v("Error al cargar mantenimientos"),m(!1);return}a(z),v(null),m(!1)},_);return()=>$()},[n,_]),Y.useEffect(()=>{n&&(async()=>{try{const z=await zj(_);c(z)}catch(z){console.error("Error al cargar estadísticas:",z)}})()},[n,t,_]);const Q=t.filter($=>{if(!x)return!0;const z=x.toLowerCase();return $.vehicleName?.toLowerCase().includes(z)||$.type?.toLowerCase().includes(z)||$.status?.toLowerCase().includes(z)||$.notes?.toLowerCase().includes(z)}),L=e?.combustiblesPermissions?.canManageMaintenance||!1,R=()=>{V(null),U("create"),F(!0)},P=$=>{V($),U("edit"),F(!0)},D=$=>{V($),U("view"),F(!0)},A=()=>{F(!1),V(null)},I=()=>{F(!1),V(null)},O=$=>{b(z=>({...z,...$}))},_e=()=>{b({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),C("")},Se=async $=>{if(!L){alert("No tienes permisos para eliminar mantenimientos");return}if(window.confirm("¿Estás seguro de que quieres eliminar este mantenimiento?"))try{const{deleteMaintenanceRecord:z}=await Jv(async()=>{const{deleteMaintenanceRecord:ae}=await Promise.resolve().then(()=>iV);return{deleteMaintenanceRecord:ae}},void 0);await z($),console.log("✅ Mantenimiento eliminado exitosamente")}catch(z){console.error("❌ Error al eliminar mantenimiento:",z),alert("Error al eliminar mantenimiento: "+z.message)}};return n?r.jsxs("div",{className:"maintenance-main",children:[r.jsxs("div",{className:"maintenance-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🔧 Mantenimiento de Vehículos"}),r.jsx("p",{children:"Gestión de cambios de aceite, filtros y baterías"})]}),r.jsx("div",{className:"header-actions",children:L&&r.jsx("button",{className:"btn-create-maintenance",onClick:R,children:"➕ Crear Mantenimiento"})})]}),d&&r.jsxs("div",{className:"maintenance-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando mantenimientos..."})]}),p&&r.jsxs("div",{className:"error-banner",children:[r.jsxs("span",{children:["❌ ",p]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]}),o&&r.jsx(rV,{stats:o}),r.jsx(oV,{filters:_,onFilterChange:O,onClearFilters:_e,searchTerm:x,onSearchChange:C,viewMode:T,onViewModeChange:j,totalResults:Q.length}),!d&&!p&&r.jsx(uV,{maintenanceRecords:Q,viewMode:T,onEdit:L?P:null,onView:D,onDelete:L?Se:null,userRole:e?.role}),w&&r.jsx(dV,{isOpen:w,onClose:A,onSuccess:I,maintenance:H,mode:k,userRole:e?.role})]}):r.jsx("div",{className:"maintenance-main",children:r.jsxs("div",{className:"auth-required",children:[r.jsx("h2",{children:"🔐 Autenticación Requerida"}),r.jsx("p",{children:"Debes iniciar sesión para acceder al módulo de mantenimiento."})]})})},fV=({isOpen:n,onClose:e,product:t,mode:a="create",onSave:o,userRole:c})=>{const[d,m]=Y.useState({name:"",displayName:"",category:Bs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),[p,v]=Y.useState({}),[_,b]=Y.useState(!1),T=[{value:"gal",label:"Galones (gal)"},{value:"L",label:"Litros (L)"},{value:"kg",label:"Kilogramos (kg)"},{value:"und",label:"Unidades (und)"}],j={[Bs.COMBUSTIBLE]:["🛢️","🚛","🚗","⛽","🌿"],[Bs.ACEITE]:["🛢️","⚙️","🔧","🚜","🏭"],[Bs.LUBRICANTE]:["🟥","🟡","🔵","⚫","🟤"],[Bs.FLUIDO]:["🛑","💧","🔴","🟢","🔵"]},x=["#FF6B35","#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#E91E63","#795548","#607D8B","#3F51B5"];Y.useEffect(()=>{m(t&&(a==="edit"||a==="view")?{name:t.name||"",displayName:t.displayName||"",category:t.category||Bs.COMBUSTIBLE,unit:t.unit||"gal",defaultPrice:t.defaultPrice||0,color:t.color||"#FF6B35",icon:t.icon||"🛢️",description:t.description||"",isActive:t.isActive!==void 0?t.isActive:!0,currentStock:t.currentStock||0,minThreshold:t.minThreshold||10,maxCapacity:t.maxCapacity||1e3}:{name:"",displayName:"",category:Bs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),v({})},[t,a,n]);const C=V=>{const{name:k,value:U,type:Q,checked:L}=V.target;m(R=>({...R,[k]:Q==="checkbox"?L:U})),p[k]&&v(R=>({...R,[k]:""}))},w=()=>{const V={};return d.name.trim()||(V.name="El nombre es requerido"),d.displayName.trim()||(V.displayName="El nombre de visualización es requerido"),d.category||(V.category="La categoría es requerida"),d.unit||(V.unit="La unidad es requerida"),d.defaultPrice<0&&(V.defaultPrice="El precio debe ser mayor o igual a 0"),d.currentStock<0&&(V.currentStock="El stock debe ser mayor o igual a 0"),d.minThreshold<0&&(V.minThreshold="El umbral mínimo debe ser mayor o igual a 0"),d.maxCapacity<=0&&(V.maxCapacity="La capacidad máxima debe ser mayor a 0"),d.minThreshold>=d.maxCapacity&&(V.minThreshold="El umbral mínimo debe ser menor que la capacidad máxima"),v(V),Object.keys(V).length===0},F=async V=>{if(V.preventDefault(),!!w()){b(!0);try{await o({...d,defaultPrice:parseFloat(d.defaultPrice),currentStock:parseFloat(d.currentStock),minThreshold:parseFloat(d.minThreshold),maxCapacity:parseFloat(d.maxCapacity)}),e()}catch(k){console.error("Error saving product:",k),v({submit:"Error al guardar el producto"})}finally{b(!1)}}};if(!n)return null;const H=["admin","supervisor"].includes(c)&&a!=="view";return r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content product-modal",children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[a==="create"&&"➕ Crear Producto",a==="edit"&&"✏️ Editar Producto",a==="view"&&"👁️ Ver Producto"]}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),r.jsxs("form",{onSubmit:F,className:"modal-body",children:[r.jsx("div",{className:"product-preview",children:r.jsxs("div",{className:"preview-card",children:[r.jsx("div",{className:"preview-icon",style:{color:d.color},children:d.icon}),r.jsxs("div",{className:"preview-info",children:[r.jsx("h3",{children:d.displayName||"Nombre del producto"}),r.jsx("p",{className:"preview-category",children:d.category}),r.jsx("p",{className:"preview-description",children:d.description}),r.jsxs("div",{className:"preview-price",children:["$",new Intl.NumberFormat("es-CO").format(d.defaultPrice)," / ",d.unit]})]})]})}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📝 Información Básica"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre Interno *"}),r.jsx("input",{type:"text",name:"name",value:d.name,onChange:C,disabled:!H,placeholder:"Ej: ACPM, GASOLINA"}),p.name&&r.jsx("span",{className:"error",children:p.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre de Visualización *"}),r.jsx("input",{type:"text",name:"displayName",value:d.displayName,onChange:C,disabled:!H,placeholder:"Ej: ACPM 🚛, Gasolina 🚗"}),p.displayName&&r.jsx("span",{className:"error",children:p.displayName})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Categoría *"}),r.jsx("select",{name:"category",value:d.category,onChange:C,disabled:!H,children:Object.values(Bs).map(V=>r.jsx("option",{value:V,children:V},V))}),p.category&&r.jsx("span",{className:"error",children:p.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Descripción"}),r.jsx("textarea",{name:"description",value:d.description,onChange:C,disabled:!H,placeholder:"Descripción del producto...",rows:"3"})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"⚙️ Configuración"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Unidad de Medida *"}),r.jsx("select",{name:"unit",value:d.unit,onChange:C,disabled:!H,children:T.map(V=>r.jsx("option",{value:V.value,children:V.label},V.value))}),p.unit&&r.jsx("span",{className:"error",children:p.unit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio por Defecto"}),r.jsx("input",{type:"number",name:"defaultPrice",value:d.defaultPrice,onChange:C,disabled:!H,min:"0",step:"0.01"}),p.defaultPrice&&r.jsx("span",{className:"error",children:p.defaultPrice})]}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",name:"isActive",checked:d.isActive,onChange:C,disabled:!H}),"Producto Activo"]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📊 Stock y Umbrales"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Stock Actual"}),r.jsx("input",{type:"number",name:"currentStock",value:d.currentStock,onChange:C,disabled:!H,min:"0",step:"0.01"}),p.currentStock&&r.jsx("span",{className:"error",children:p.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Umbral Mínimo"}),r.jsx("input",{type:"number",name:"minThreshold",value:d.minThreshold,onChange:C,disabled:!H,min:"0",step:"0.01"}),p.minThreshold&&r.jsx("span",{className:"error",children:p.minThreshold})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Capacidad Máxima"}),r.jsx("input",{type:"number",name:"maxCapacity",value:d.maxCapacity,onChange:C,disabled:!H,min:"1",step:"0.01"}),p.maxCapacity&&r.jsx("span",{className:"error",children:p.maxCapacity})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"🎨 Apariencia"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Icono"}),r.jsx("div",{className:"icon-selector",children:j[d.category]?.map(V=>r.jsx("button",{type:"button",className:`icon-option ${d.icon===V?"selected":""}`,onClick:()=>m(k=>({...k,icon:V})),disabled:!H,children:V},V))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Color"}),r.jsx("div",{className:"color-selector",children:x.map(V=>r.jsx("button",{type:"button",className:`color-option ${d.color===V?"selected":""}`,style:{backgroundColor:V},onClick:()=>m(k=>({...k,color:V})),disabled:!H},V))})]})]})]}),p.submit&&r.jsx("div",{className:"error-message",children:p.submit})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:_,children:a==="view"?"Cerrar":"Cancelar"}),H&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:F,disabled:_,children:_?"Guardando...":"Guardar"})]})]})})},mV=({products:n})=>{const[e,t]=Y.useState([]),[a,o]=Y.useState(!0);Y.useEffect(()=>{const x=Qv(C=>{t(C),o(!1)},C=>{console.error("Error loading movements for stats:",C),o(!1)});return()=>x()},[]);const c=()=>n.map(C=>{const w=e.filter(Q=>Q.fuelType===C.name||Q.fuelType===C.displayName),F=w.filter(Q=>Q.type==="entrada"),H=w.filter(Q=>Q.type==="salida"),V=F.reduce((Q,L)=>Q+(L.quantity||0),0),k=H.reduce((Q,L)=>Q+(L.quantity||0),0),U=(C.currentStock||0)*(C.defaultPrice||0);return{...C,totalEntries:V,totalExits:k,totalValue:U,entriesCount:F.length,exitsCount:H.length,stockStatus:d(C)}}),d=x=>{const C=x.currentStock||0,w=x.minThreshold||0,F=x.maxCapacity||1e3;return C===0?"empty":C<=w?"low":C>=F*.9?"high":"normal"},m=x=>{const C={};return Object.values(Bs).forEach(w=>{const F=x.filter(H=>H.category===w);C[w]={totalProducts:F.length,totalStock:F.reduce((H,V)=>H+(V.currentStock||0),0),totalValue:F.reduce((H,V)=>H+V.totalValue,0),totalEntries:F.reduce((H,V)=>H+V.totalEntries,0),totalExits:F.reduce((H,V)=>H+V.totalExits,0),lowStockCount:F.filter(H=>H.stockStatus==="low"||H.stockStatus==="empty").length}}),C};if(a)return r.jsxs("div",{className:"products-stats loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando estadísticas..."})]});const p=c(),v=m(p),_=n.length,b=n.filter(x=>x.isActive).length,T=p.reduce((x,C)=>x+C.totalValue,0),j=p.filter(x=>x.stockStatus==="low"||x.stockStatus==="empty").length;return r.jsxs("div",{className:"products-stats",children:[r.jsx("h2",{children:"📊 Estadísticas de Productos"}),r.jsxs("div",{className:"stats-general",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"📦"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Me(_)}),r.jsx("p",{children:"Total Productos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"✅"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Me(b)}),r.jsx("p",{children:"Productos Activos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:An(T)}),r.jsx("p",{children:"Valor Total Stock"})]})]}),r.jsxs("div",{className:`stat-card ${j>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Me(j)}),r.jsx("p",{children:"Stock Bajo"})]})]})]}),r.jsxs("div",{className:"stats-categories",children:[r.jsx("h3",{children:"📈 Por Categoría"}),r.jsx("div",{className:"categories-grid",children:Object.entries(v).map(([x,C])=>r.jsxs("div",{className:"category-card",children:[r.jsx("h4",{children:x}),r.jsxs("div",{className:"category-stats",children:[r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Productos:"}),r.jsx("span",{children:Me(C.totalProducts)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Stock Total:"}),r.jsxs("span",{children:[Me(C.totalStock)," unidades"]})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Valor:"}),r.jsx("span",{children:An(C.totalValue)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Entradas:"}),r.jsx("span",{className:"positive",children:Me(C.totalEntries)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Salidas:"}),r.jsx("span",{className:"negative",children:Me(C.totalExits)})]}),C.lowStockCount>0&&r.jsxs("div",{className:"stat-row alert",children:[r.jsx("span",{children:"Stock Bajo:"}),r.jsx("span",{children:Me(C.lowStockCount)})]})]})]},x))})]}),r.jsxs("div",{className:"stats-top-products",children:[r.jsx("h3",{children:"🏆 Top Productos por Stock"}),r.jsx("div",{className:"top-products-list",children:p.sort((x,C)=>(C.currentStock||0)-(x.currentStock||0)).slice(0,5).map((x,C)=>r.jsxs("div",{className:"top-product-item",children:[r.jsxs("div",{className:"rank",children:["#",C+1]}),r.jsx("div",{className:"product-icon",style:{color:x.color},children:x.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:x.displayName}),r.jsxs("span",{className:"product-stock",children:[Me(x.currentStock||0)," ",x.unit]})]}),r.jsx("div",{className:"product-value",children:An(x.totalValue)})]},x.id))})]}),j>0&&r.jsxs("div",{className:"stats-alerts",children:[r.jsx("h3",{children:"⚠️ Alertas de Stock"}),r.jsx("div",{className:"alerts-list",children:p.filter(x=>x.stockStatus==="low"||x.stockStatus==="empty").map(x=>r.jsxs("div",{className:`alert-item ${x.stockStatus}`,children:[r.jsx("div",{className:"alert-icon",children:x.stockStatus==="empty"?"🔴":"🟡"}),r.jsxs("div",{className:"alert-info",children:[r.jsx("span",{className:"alert-product",children:x.displayName}),r.jsxs("span",{className:"alert-stock",children:["Stock: ",Me(x.currentStock||0)," ",x.unit,x.stockStatus==="empty"&&" - ¡SIN STOCK!",x.stockStatus==="low"&&` - Mínimo: ${x.minThreshold}`]})]})]},x.id))})]})]})},pV=({userProfile:n})=>{const[e,t]=Y.useState([]),[a,o]=Y.useState(!0),[c,d]=Y.useState(null),[m,p]=Y.useState(!1),[v,_]=Y.useState(null),[b,T]=Y.useState("create"),[j,x]=Y.useState(""),[C,w]=Y.useState(""),[F,H]=Y.useState(!0),V=["admin","supervisor"].includes(n?.role);Y.useEffect(()=>{o(!0);const D=VL(A=>{t(A),o(!1),d(null)},A=>{console.error("Error loading products:",A),d("Error cargando productos"),o(!1)});return()=>D()},[]),Y.useEffect(()=>{(async()=>{if(console.log("🔍 Debug - Inicializando productos:",{productsLength:e.length,loading:a,canManageProducts:V}),e.length===0&&!a&&V)try{console.log("🚀 Creando productos predefinidos...");const A=Lx();console.log("📦 Productos predefinidos:",A);for(const I of A)console.log("➕ Creando producto:",I.name),await Yp({name:I.name,displayName:I.displayName,category:I.category,unit:I.unit,defaultPrice:I.defaultPrice,color:I.color,icon:I.icon,description:I.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});console.log("✅ Productos predefinidos creados exitosamente")}catch(A){console.error("❌ Error inicializando productos:",A)}else console.log("ℹ️ No se inicializan productos:",{reason:e.length>0?"Ya existen productos":a?"Está cargando":V?"Otra razón":"Sin permisos"})})()},[e.length,a,V]);const k=()=>{_(null),T("create"),p(!0)},U=D=>{_(D),T("edit"),p(!0)},Q=D=>{_(D),T("view"),p(!0)},L=async D=>{if(window.confirm("¿Estás seguro de que deseas eliminar este producto?"))try{await PL(D)}catch(A){console.error("Error deleting product:",A),alert("Error al eliminar el producto")}},R=async D=>{try{b==="create"?await Yp(D):b==="edit"&&await kL(v.id,D),p(!1)}catch(A){throw console.error("Error saving product:",A),A}},P=e.filter(D=>{const A=D.displayName?.toLowerCase().includes(j.toLowerCase())||D.name?.toLowerCase().includes(j.toLowerCase()),I=!C||D.category===C;return A&&I});return a?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando productos..."})]})}):c?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"error-container",children:[r.jsxs("p",{children:["⚠️ ",c]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"products-main",children:[r.jsxs("div",{className:"products-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:"🛢️ Gestión de Productos"}),r.jsx("p",{children:"Administra los tipos de combustibles y productos disponibles"})]}),V&&r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{className:"btn-primary",onClick:k,children:"➕ Agregar Producto"}),r.jsx("button",{className:"btn-secondary",onClick:async()=>{try{console.log("🧪 Forzando creación de productos predefinidos...");const D=Lx();for(const A of D)await Yp({name:A.name,displayName:A.displayName,category:A.category,unit:A.unit,defaultPrice:A.defaultPrice,color:A.color,icon:A.icon,description:A.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});alert("Productos predefinidos creados exitosamente")}catch(D){console.error("Error:",D),alert("Error creando productos: "+D.message)}},style:{marginLeft:"10px"},children:"🧪 Crear Predefinidos"})]})]}),F&&r.jsx(mV,{products:e}),r.jsxs("div",{className:"products-filters",children:[r.jsx("div",{className:"filter-group",children:r.jsx("input",{type:"text",placeholder:"🔍 Buscar productos...",value:j,onChange:D=>x(D.target.value),className:"search-input"})}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:C,onChange:D=>w(D.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"🏷️ Todas las categorías"}),Object.values(Bs).map(D=>r.jsx("option",{value:D,children:D},D))]})}),r.jsx("div",{className:"filter-group",children:r.jsx("button",{className:`toggle-btn ${F?"active":""}`,onClick:()=>H(!F),children:"📊 Estadísticas"})})]}),r.jsx("div",{className:"products-grid",children:P.map(D=>r.jsxs("div",{className:"product-card",children:[r.jsx("div",{className:"product-icon",style:{color:D.color},children:D.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("h3",{children:D.displayName}),r.jsx("p",{className:"product-category",children:D.category}),r.jsx("p",{className:"product-description",children:D.description}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Stock:"}),r.jsxs("span",{className:"stat-value",children:[D.currentStock||0," ",D.unit]})]}),r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Precio:"}),r.jsxs("span",{className:"stat-value",children:["$",new Intl.NumberFormat("es-CO").format(D.defaultPrice||0)]})]})]}),r.jsx("div",{className:`product-status ${D.isActive?"active":"inactive"}`,children:D.isActive?"✅ Activo":"❌ Inactivo"})]}),r.jsxs("div",{className:"product-actions",children:[r.jsx("button",{className:"btn-secondary",onClick:()=>Q(D),children:"👁️ Ver"}),V&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-primary",onClick:()=>U(D),children:"✏️ Editar"}),r.jsx("button",{className:"btn-danger",onClick:()=>L(D.id),children:"🗑️ Eliminar"})]})]})]},D.id))}),P.length===0&&r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📦"}),r.jsx("h3",{children:"No hay productos"}),r.jsx("p",{children:j||C?"No se encontraron productos con los filtros aplicados.":"Aún no hay productos registrados."}),V&&!j&&!C&&r.jsx("button",{className:"btn-primary",onClick:k,children:"➕ Crear primer producto"})]}),r.jsx(fV,{isOpen:m,onClose:()=>p(!1),product:v,mode:b,onSave:R,userRole:n?.role})]})},gV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const[c,d]=Y.useState("name"),[m,p]=Y.useState("asc"),v=F=>{c===F?p(m==="asc"?"desc":"asc"):(d(F),p("asc"))},_=[...n].sort((F,H)=>{let V=F[c],k=H[c];switch(c){case"rating":V=V||0,k=k||0;break;case"totalOrders":case"totalPurchased":V=V||0,k=k||0;break;case"createdAt":case"lastOrderDate":V=V?V.toDate?V.toDate():new Date(V):new Date(0),k=k?k.toDate?k.toDate():new Date(k):new Date(0);break;default:V=(V||"").toString().toLowerCase(),k=(k||"").toString().toLowerCase()}return V<k?m==="asc"?-1:1:V>k?m==="asc"?1:-1:0}),b=F=>{switch(F){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},T=F=>{switch(F){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},j=F=>F?(F.toDate?F.toDate():new Date(F)).toLocaleDateString("es-CO"):"-",x=F=>{const H=[];for(let V=1;V<=5;V++)H.push(r.jsx("span",{className:`star ${V<=F?"filled":""}`,children:"★"},V));return r.jsx("div",{className:"rating-stars",children:H})},C=F=>!F||F.length===0?r.jsx("span",{className:"no-data",children:"-"}):r.jsxs("div",{className:"fuel-types-cell",children:[F.slice(0,2).map(H=>r.jsx("span",{className:"fuel-badge-sm",children:Nn[H]||H},H)),F.length>2&&r.jsxs("span",{className:"fuel-badge-sm more",title:F.slice(2).map(H=>Nn[H]||H).join(", "),children:["+",F.length-2]})]}),w=F=>c!==F?"icon-chevrons-up-down":m==="asc"?"icon-chevron-up":"icon-chevron-down";return r.jsxs("div",{className:"suppliers-table-container",children:[r.jsxs("div",{className:"table-wrapper",children:[r.jsxs("table",{className:"suppliers-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:`sortable ${c==="name"?"active":""}`,onClick:()=>v("name"),children:[r.jsx("span",{children:"Proveedor"}),r.jsx("i",{className:w("name")})]}),r.jsxs("th",{className:`sortable ${c==="status"?"active":""}`,onClick:()=>v("status"),children:[r.jsx("span",{children:"Estado"}),r.jsx("i",{className:w("status")})]}),r.jsxs("th",{className:`sortable ${c==="category"?"active":""}`,onClick:()=>v("category"),children:[r.jsx("span",{children:"Categoría"}),r.jsx("i",{className:w("category")})]}),r.jsx("th",{children:r.jsx("span",{children:"Combustibles"})}),r.jsx("th",{children:r.jsx("span",{children:"Contacto"})}),r.jsxs("th",{className:`sortable ${c==="rating"?"active":""}`,onClick:()=>v("rating"),children:[r.jsx("span",{children:"Rating"}),r.jsx("i",{className:w("rating")})]}),r.jsxs("th",{className:`sortable ${c==="totalOrders"?"active":""}`,onClick:()=>v("totalOrders"),children:[r.jsx("span",{children:"Órdenes"}),r.jsx("i",{className:w("totalOrders")})]}),r.jsxs("th",{className:`sortable ${c==="totalPurchased"?"active":""}`,onClick:()=>v("totalPurchased"),children:[r.jsx("span",{children:"Total Comprado"}),r.jsx("i",{className:w("totalPurchased")})]}),r.jsxs("th",{className:`sortable ${c==="createdAt"?"active":""}`,onClick:()=>v("createdAt"),children:[r.jsx("span",{children:"Creado"}),r.jsx("i",{className:w("createdAt")})]}),r.jsx("th",{className:"actions-column",children:r.jsx("span",{children:"Acciones"})})]})}),r.jsx("tbody",{children:_.map(F=>r.jsxs("tr",{className:`supplier-row ${F.status}`,children:[r.jsx("td",{className:"supplier-info-cell",children:r.jsxs("div",{className:"supplier-main-info",children:[r.jsxs("div",{className:"supplier-name",children:[F.name,F.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),F.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",F.taxId]}),F.type&&r.jsx("div",{className:"supplier-type",children:F.type.charAt(0).toUpperCase()+F.type.slice(1)})]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:"status-display",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:b(F.status)}}),r.jsx("span",{className:"status-label",children:T(F.status)})]})}),r.jsx("td",{className:"category-cell",children:r.jsx("span",{className:"category-label",children:F.category?.charAt(0).toUpperCase()+F.category?.slice(1)||"-"})}),r.jsx("td",{className:"fuel-types-cell",children:C(F.fuelTypes)}),r.jsx("td",{className:"contact-cell",children:r.jsxs("div",{className:"contact-info",children:[F.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:F.contactPerson})]}),F.phone&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("a",{href:`tel:${F.phone}`,children:F.phone})]}),F.email&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("a",{href:`mailto:${F.email}`,children:F.email})]}),F.city&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:F.city})]})]})}),r.jsx("td",{className:"rating-cell",children:r.jsxs("div",{className:"rating-display",children:[x(F.rating||0),r.jsx("span",{className:"rating-value",children:(F.rating||0).toFixed(1)})]})}),r.jsx("td",{className:"orders-cell",children:r.jsx("span",{className:"orders-count",children:F.totalOrders||0})}),r.jsx("td",{className:"purchased-cell",children:r.jsx("span",{className:"purchased-amount",children:An(F.totalPurchased||0)})}),r.jsx("td",{className:"date-cell",children:r.jsx("span",{className:"date-value",children:j(F.createdAt)})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[a&&r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(F),title:"Editar proveedor",children:r.jsx("i",{className:"icon-edit"})}),o&&F.status==="active"&&r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(F.id,F.name),title:"Desactivar proveedor",children:r.jsx("i",{className:"icon-x-circle"})}),r.jsxs("div",{className:"quick-actions",children:[F.phone&&r.jsx("a",{href:`tel:${F.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),F.email&&r.jsx("a",{href:`mailto:${F.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})})]},F.id))})]}),_.length===0&&r.jsxs("div",{className:"table-empty-state",children:[r.jsx("i",{className:"icon-truck"}),r.jsx("p",{children:"No hay proveedores para mostrar"})]})]}),r.jsxs("div",{className:"table-footer",children:[r.jsx("div",{className:"table-info",children:r.jsxs("span",{children:["Mostrando ",_.length," proveedor",_.length!==1?"es":""]})}),r.jsx("div",{className:"table-actions",children:r.jsxs("span",{className:"sort-info",children:["Ordenado por: ",c==="name"?"Nombre":c==="status"?"Estado":c==="category"?"Categoría":c==="rating"?"Rating":c==="totalOrders"?"Órdenes":c==="totalPurchased"?"Total Comprado":c==="createdAt"?"Fecha de Creación":c," (",m==="asc"?"Ascendente":"Descendente",")"]})})]})]})},vV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const c=j=>{switch(j){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},d=j=>{switch(j){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},m=j=>{switch(j){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},p=j=>{switch(j){case"proveedor":return"Proveedor";case"distribuidor":return"Distribuidor";case"mayorista":return"Mayorista";default:return"Sin especificar"}},v=j=>j?(j.toDate?j.toDate():new Date(j)).toLocaleDateString("es-CO"):"No disponible",_=j=>{const x=[];for(let C=1;C<=5;C++)x.push(r.jsx("span",{className:`star ${C<=j?"filled":""}`,children:"★"},C));return r.jsx("div",{className:"rating-stars",children:x})},b=j=>!j||j.length===0?r.jsx("span",{className:"no-fuels",children:"Sin combustibles especificados"}):r.jsxs("div",{className:"fuel-types",children:[j.slice(0,3).map(x=>r.jsx("span",{className:"fuel-badge",title:Nn[x],children:Nn[x]||x},x)),j.length>3&&r.jsxs("span",{className:"fuel-badge more",title:`+${j.length-3} más`,children:["+",j.length-3]})]}),T=j=>{const x=[];return j.phone&&x.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("span",{children:j.phone})]},"phone")),j.email&&x.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("span",{children:j.email})]},"email")),j.city&&x.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:j.city})]},"city")),x.length>0?x:r.jsxs("div",{className:"contact-item no-contact",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:"Sin información de contacto"})]})};return r.jsx("div",{className:"suppliers-cards",children:n.map(j=>r.jsxs("div",{className:`supplier-card ${j.status}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsx("div",{className:"header-left",children:r.jsxs("div",{className:"supplier-info",children:[r.jsxs("h3",{className:"supplier-name",children:[j.name,j.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),j.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",j.taxId]})]})}),r.jsx("div",{className:"header-right",children:r.jsxs("div",{className:"supplier-status",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:c(j.status)}}),r.jsx("span",{className:"status-label",children:d(j.status)})]})})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"supplier-meta",children:[r.jsxs("div",{className:"meta-item",children:[r.jsx("span",{className:"meta-icon",children:m(j.category)}),r.jsx("span",{className:"meta-label",children:j.category?.charAt(0).toUpperCase()+j.category?.slice(1)||"Sin categoría"})]}),r.jsxs("div",{className:"meta-item",children:[r.jsx("i",{className:"icon-building meta-icon"}),r.jsx("span",{className:"meta-label",children:p(j.type)})]})]}),j.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:j.contactPerson})]}),r.jsx("div",{className:"contact-info",children:T(j)}),r.jsxs("div",{className:"fuel-types-section",children:[r.jsx("div",{className:"section-label",children:"Combustibles Suministrados:"}),b(j.fuelTypes)]}),r.jsxs("div",{className:"rating-section",children:[r.jsxs("div",{className:"rating-display",children:[_(j.rating||0),r.jsxs("span",{className:"rating-value",children:[(j.rating||0).toFixed(1),"/5"]})]}),j.evaluationNotes&&r.jsxs("div",{className:"evaluation-notes",title:j.evaluationNotes,children:[r.jsx("i",{className:"icon-message-square"}),r.jsx("span",{children:"Con evaluación"})]})]}),j.paymentTerms&&r.jsxs("div",{className:"payment-terms",children:[r.jsx("i",{className:"icon-credit-card"}),r.jsxs("span",{children:["Términos: ",j.paymentTerms==="contado"?"Contado":j.paymentTerms==="30dias"?"30 días":j.paymentTerms==="60dias"?"60 días":j.paymentTerms==="90dias"?"90 días":j.paymentTerms]})]}),r.jsxs("div",{className:"supplier-stats",children:[r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Órdenes:"}),r.jsx("span",{className:"stat-value",children:j.totalOrders||0})]}),r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Total Comprado:"}),r.jsx("span",{className:"stat-value",children:An(j.totalPurchased||0)})]}),j.lastOrderDate&&r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Última Orden:"}),r.jsx("span",{className:"stat-value",children:v(j.lastOrderDate)})]})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsx("div",{className:"footer-info",children:r.jsxs("span",{className:"created-date",children:["Creado: ",v(j.createdAt)]})}),r.jsxs("div",{className:"card-actions",children:[a&&r.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(j),title:"Editar proveedor",children:[r.jsx("i",{className:"icon-edit"}),"Editar"]}),o&&j.status==="active"&&r.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>t(j.id,j.name),title:"Desactivar proveedor",children:[r.jsx("i",{className:"icon-x-circle"}),"Desactivar"]}),r.jsxs("div",{className:"quick-actions",children:[j.phone&&r.jsx("a",{href:`tel:${j.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),j.email&&r.jsx("a",{href:`mailto:${j.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})]})]},j.id))})},yV=({supplier:n,onClose:e,onSuccess:t,onError:a})=>{const{userProfile:o}=Ts(),c=!!n,[d,m]=Y.useState({name:"",taxId:"",type:"proveedor",category:"combustibles",contactPerson:"",phone:"",email:"",address:"",city:"",state:"Colombia",fuelTypes:[],paymentTerms:"contado",creditLimit:"",priceList:{},rating:5,evaluationNotes:"",status:"active",isPreferred:!1}),[p,v]=Y.useState(!1),[_,b]=Y.useState({}),[T,j]=Y.useState("basic");Y.useEffect(()=>{c&&n&&m({name:n.name||"",taxId:n.taxId||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson||"",phone:n.phone||"",email:n.email||"",address:n.address||"",city:n.city||"",state:n.state||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:n.creditLimit||"",priceList:n.priceList||{},rating:n.rating||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1})},[c,n]);const x=(k,U)=>{m(Q=>({...Q,[k]:U})),_[k]&&b(Q=>({...Q,[k]:null}))},C=k=>{m(U=>({...U,fuelTypes:U.fuelTypes.includes(k)?U.fuelTypes.filter(Q=>Q!==k):[...U.fuelTypes,k]}))},w=(k,U)=>{m(Q=>({...Q,priceList:{...Q.priceList,[k]:parseFloat(U)||0}}))},F=()=>{const k={};return d.name.trim()||(k.name="El nombre del proveedor es requerido"),d.category||(k.category="La categoría es requerida"),d.type||(k.type="El tipo de proveedor es requerido"),d.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)&&(k.email="El formato del email no es válido"),d.phone&&!/^[\d\s\-+()]+$/.test(d.phone)&&(k.phone="El formato del teléfono no es válido"),d.creditLimit&&(isNaN(d.creditLimit)||parseFloat(d.creditLimit)<0)&&(k.creditLimit="El límite de crédito debe ser un número positivo"),(d.rating<1||d.rating>5)&&(k.rating="El rating debe estar entre 1 y 5"),d.fuelTypes.forEach(U=>{d.priceList[U]&&(isNaN(d.priceList[U])||parseFloat(d.priceList[U])<0)&&(k[`price_${U}`]=`El precio de ${Nn[U]} debe ser un número positivo`)}),b(k),Object.keys(k).length===0},H=async k=>{if(k.preventDefault(),!!F()){v(!0);try{const U={...d,creditLimit:parseFloat(d.creditLimit)||0,rating:parseFloat(d.rating)||5,priceList:Object.fromEntries(Object.entries(d.priceList).filter(([L,R])=>d.fuelTypes.includes(L)&&R>0))};let Q;c?Q=await yL(n.id,U,o?.email):Q=await vL(U,o?.email),Q.success?t():a(Q.error||"Error al guardar proveedor")}catch(U){console.error("Error saving supplier:",U),a("Error inesperado al guardar proveedor")}finally{v(!1)}}},V=[{id:"basic",label:"Información Básica",icon:"icon-info"},{id:"contact",label:"Contacto",icon:"icon-phone"},{id:"products",label:"Productos",icon:"icon-package"},{id:"commercial",label:"Comercial",icon:"icon-credit-card"}];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-container large",onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[r.jsx("i",{className:"icon-truck"}),c?"Editar Proveedor":"Nuevo Proveedor"]}),r.jsx("button",{className:"modal-close",onClick:e,children:r.jsx("i",{className:"icon-x"})})]}),r.jsxs("form",{onSubmit:H,children:[r.jsx("div",{className:"modal-tabs",children:V.map(k=>r.jsxs("button",{type:"button",className:`tab-button ${T===k.id?"active":""}`,onClick:()=>j(k.id),children:[r.jsx("i",{className:k.icon}),k.label]},k.id))}),r.jsxs("div",{className:"modal-body",children:[T==="basic"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Nombre del Proveedor"}),r.jsx("input",{type:"text",value:d.name,onChange:k=>x("name",k.target.value),placeholder:"Ingresa el nombre del proveedor",className:_.name?"error":""}),_.name&&r.jsx("span",{className:"error-message",children:_.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"NIT / Documento"}),r.jsx("input",{type:"text",value:d.taxId,onChange:k=>x("taxId",k.target.value),placeholder:"123456789-0",className:_.taxId?"error":""}),_.taxId&&r.jsx("span",{className:"error-message",children:_.taxId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Tipo de Proveedor"}),r.jsxs("select",{value:d.type,onChange:k=>x("type",k.target.value),className:_.type?"error":"",children:[r.jsx("option",{value:"proveedor",children:"Proveedor"}),r.jsx("option",{value:"distribuidor",children:"Distribuidor"}),r.jsx("option",{value:"mayorista",children:"Mayorista"})]}),_.type&&r.jsx("span",{className:"error-message",children:_.type})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Categoría"}),r.jsxs("select",{value:d.category,onChange:k=>x("category",k.target.value),className:_.category?"error":"",children:[r.jsx("option",{value:"combustibles",children:"Combustibles"}),r.jsx("option",{value:"lubricantes",children:"Lubricantes"}),r.jsx("option",{value:"aditivos",children:"Aditivos"})]}),_.category&&r.jsx("span",{className:"error-message",children:_.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:d.status,onChange:k=>x("status",k.target.value),children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"suspended",children:"Suspendido"})]})]}),r.jsx("div",{className:"form-group checkbox",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.isPreferred,onChange:k=>x("isPreferred",k.target.checked)}),r.jsx("span",{className:"checkbox-mark"}),"Proveedor Preferido"]})})]})}),T==="contact"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Persona de Contacto"}),r.jsx("input",{type:"text",value:d.contactPerson,onChange:k=>x("contactPerson",k.target.value),placeholder:"Nombre del contacto principal"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Teléfono"}),r.jsx("input",{type:"tel",value:d.phone,onChange:k=>x("phone",k.target.value),placeholder:"+57 300 123 4567",className:_.phone?"error":""}),_.phone&&r.jsx("span",{className:"error-message",children:_.phone})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{type:"email",value:d.email,onChange:k=>x("email",k.target.value),placeholder:"contacto@proveedor.com",className:_.email?"error":""}),_.email&&r.jsx("span",{className:"error-message",children:_.email})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ciudad"}),r.jsx("input",{type:"text",value:d.city,onChange:k=>x("city",k.target.value),placeholder:"Bogotá"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado/País"}),r.jsx("input",{type:"text",value:d.state,onChange:k=>x("state",k.target.value),placeholder:"Colombia"})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Dirección"}),r.jsx("textarea",{value:d.address,onChange:k=>x("address",k.target.value),placeholder:"Dirección completa del proveedor",rows:"3"})]})]})}),T==="products"&&r.jsxs("div",{className:"tab-content",children:[r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Tipos de Combustible que Suministra"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(Nn).map(([k,U])=>r.jsx("div",{className:"fuel-type-item",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.fuelTypes.includes(k),onChange:()=>C(k)}),r.jsx("span",{className:"checkbox-mark"}),U]})},k))})]}),d.fuelTypes.length>0&&r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Precios por Litro (Opcional)"}),r.jsx("div",{className:"prices-grid",children:d.fuelTypes.map(k=>r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:Nn[k]}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.priceList[k]||"",onChange:U=>w(k,U.target.value),placeholder:"0.00",className:_[`price_${k}`]?"error":""})]}),_[`price_${k}`]&&r.jsx("span",{className:"error-message",children:_[`price_${k}`]})]},k))})]})]}),T==="commercial"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Términos de Pago"}),r.jsxs("select",{value:d.paymentTerms,onChange:k=>x("paymentTerms",k.target.value),children:[r.jsx("option",{value:"contado",children:"Contado"}),r.jsx("option",{value:"30dias",children:"30 días"}),r.jsx("option",{value:"60dias",children:"60 días"}),r.jsx("option",{value:"90dias",children:"90 días"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Límite de Crédito"}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.creditLimit,onChange:k=>x("creditLimit",k.target.value),placeholder:"0.00",className:_.creditLimit?"error":""})]}),_.creditLimit&&r.jsx("span",{className:"error-message",children:_.creditLimit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Rating"}),r.jsxs("div",{className:"rating-input",children:[r.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:d.rating,onChange:k=>x("rating",parseFloat(k.target.value)),className:_.rating?"error":""}),r.jsxs("div",{className:"rating-display",children:[r.jsx("span",{className:"rating-value",children:d.rating.toFixed(1)}),r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(k=>r.jsx("span",{className:`star ${k<=Math.round(d.rating)?"filled":""}`,children:"★"},k))})]})]}),_.rating&&r.jsx("span",{className:"error-message",children:_.rating})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Notas de Evaluación"}),r.jsx("textarea",{value:d.evaluationNotes,onChange:k=>x("evaluationNotes",k.target.value),placeholder:"Comentarios sobre el desempeño del proveedor...",rows:"4"})]})]})})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"loading-spinner small"}),c?"Actualizando...":"Creando..."]}):r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"icon-save"}),c?"Actualizar Proveedor":"Crear Proveedor"]})})]})]})]})})},_V=({stats:n,suppliersCount:e,totalSuppliers:t})=>{if(!n)return null;const a=d=>{switch(d){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},c=d=>{switch(d){case"proveedor":return"🏪";case"distribuidor":return"🚛";case"mayorista":return"🏭";default:return"🏢"}};return r.jsxs("div",{className:"suppliers-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.total)}),r.jsx("div",{className:"stat-label",children:"Total Proveedores"}),t!==e&&r.jsxs("div",{className:"stat-sublabel",children:[Me(e)," mostrados"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-check-circle"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.active)}),r.jsx("div",{className:"stat-label",children:"Activos"}),r.jsx("div",{className:"stat-sublabel",children:Er(n.total>0?n.active/n.total:0)})]})]}),r.jsxs("div",{className:"stat-card warning",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-star"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Me(n.preferred)}),r.jsx("div",{className:"stat-label",children:"Preferidos"}),r.jsx("div",{className:"stat-sublabel",children:Er(n.active>0?n.preferred/n.active:0)})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-award"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:n.averageRating.toFixed(1)}),r.jsx("div",{className:"stat-label",children:"Rating Promedio"}),r.jsx("div",{className:"stat-sublabel",children:r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(d=>r.jsx("span",{className:`star ${d<=Math.round(n.averageRating)?"filled":""}`,children:"★"},d))})})]})]})]}),r.jsxs("div",{className:"stats-details",children:[r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Estado de Proveedores"}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("active")}}),"Activos"]}),r.jsx("div",{className:"breakdown-value",children:n.active}),r.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?n.active/n.total:0)})]}),n.inactive>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("inactive")}}),"Inactivos"]}),r.jsx("div",{className:"breakdown-value",children:n.inactive}),r.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?n.inactive/n.total:0)})]}),n.suspended>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("suspended")}}),"Suspendidos"]}),r.jsx("div",{className:"breakdown-value",children:n.suspended}),r.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?n.suspended/n.total:0)})]})]})]}),Object.keys(n.byCategory).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Categoría"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byCategory).sort(([,d],[,m])=>m-d).map(([d,m])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"category-icon",children:o(d)}),d.charAt(0).toUpperCase()+d.slice(1).replace("_"," ")]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?m/n.total:0)})]},d))})]}),Object.keys(n.byType).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Tipo"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byType).sort(([,d],[,m])=>m-d).map(([d,m])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"type-icon",children:c(d)}),d.charAt(0).toUpperCase()+d.slice(1)]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?m/n.total:0)})]},d))})]})]}),r.jsxs("div",{className:"stats-insights",children:[r.jsx("h3",{children:"Información Rápida"}),r.jsxs("div",{className:"insights-grid",children:[r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Nivel de Satisfacción"}),r.jsx("div",{className:"insight-value",children:n.averageRating>=4.5?"Excelente":n.averageRating>=4?"Muy Bueno":n.averageRating>=3.5?"Bueno":n.averageRating>=3?"Regular":"Necesita Mejora"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Estado General"}),r.jsx("div",{className:"insight-value",children:n.active/n.total>=.9?"Excelente":n.active/n.total>=.8?"Bueno":n.active/n.total>=.7?"Regular":"Revisar"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Proveedores Preferidos"}),r.jsx("div",{className:"insight-value",children:n.preferred===0?"Ninguno":n.preferred/n.active>=.3?"Suficientes":n.preferred/n.active>=.2?"Buenos":"Pocos"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Diversificación"}),r.jsx("div",{className:"insight-value",children:Object.keys(n.byCategory).length>=3?"Alta":Object.keys(n.byCategory).length>=2?"Media":"Baja"})]})]})]})]})},bV=({searchTerm:n,setSearchTerm:e,filterStatus:t,setFilterStatus:a,filterCategory:o,setFilterCategory:c,filterFuelType:d,setFilterFuelType:m,viewMode:p,setViewMode:v,onClearFilters:_,resultsCount:b})=>{const T=[{value:"all",label:"Todos los Estados",icon:"list"},{value:"active",label:"Activos",icon:"check-circle"},{value:"inactive",label:"Inactivos",icon:"x-circle"},{value:"suspended",label:"Suspendidos",icon:"alert-circle"},{value:"preferred",label:"Preferidos",icon:"star"}],j=[{value:"all",label:"Todas las Categorías",icon:"grid"},{value:"combustibles",label:"Combustibles",icon:"fuel"},{value:"lubricantes",label:"Lubricantes",icon:"droplets"},{value:"aditivos",label:"Aditivos",icon:"flask"}],x=[{value:"all",label:"Todos los Combustibles",icon:"fuel"},...Object.entries(Nn).map(([w,F])=>({value:w,label:F,icon:"droplet"}))],C=n||t!=="all"||o!=="all"||d!=="all";return r.jsxs("div",{className:"suppliers-filters",children:[r.jsxs("div",{className:"filters-top",children:[r.jsx("div",{className:"search-container",children:r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx("i",{className:"icon-search search-icon"}),r.jsx("input",{type:"text",placeholder:"Buscar por nombre, NIT, contacto, ciudad...",value:n,onChange:w=>e(w.target.value),className:"search-input"}),n&&r.jsx("button",{className:"search-clear",onClick:()=>e(""),title:"Limpiar búsqueda",children:r.jsx("i",{className:"icon-x"})})]})}),r.jsxs("div",{className:"view-controls",children:[r.jsxs("div",{className:"view-mode-toggle",children:[r.jsx("button",{className:`view-btn ${p==="cards"?"active":""}`,onClick:()=>v("cards"),title:"Vista de tarjetas",children:r.jsx("i",{className:"icon-grid"})}),r.jsx("button",{className:`view-btn ${p==="table"?"active":""}`,onClick:()=>v("table"),title:"Vista de tabla",children:r.jsx("i",{className:"icon-list"})})]}),C&&r.jsxs("button",{className:"btn btn-secondary clear-filters",onClick:_,title:"Limpiar todos los filtros",children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar"]})]})]}),r.jsxs("div",{className:"filters-dropdowns",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Estado"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:t,onChange:w=>a(w.target.value),className:"filter-select",children:T.map(w=>r.jsx("option",{value:w.value,children:w.label},w.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Categoría"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:o,onChange:w=>c(w.target.value),className:"filter-select",children:j.map(w=>r.jsx("option",{value:w.value,children:w.label},w.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:d,onChange:w=>m(w.target.value),className:"filter-select",children:x.map(w=>r.jsx("option",{value:w.value,children:w.label},w.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]})]}),r.jsxs("div",{className:"filters-summary",children:[r.jsxs("div",{className:"results-count",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:b===0?"No se encontraron proveedores":`Mostrando ${b} proveedor${b!==1?"es":""}`})]}),C&&r.jsxs("div",{className:"active-filters",children:[r.jsx("span",{className:"filters-label",children:"Filtros activos:"}),r.jsxs("div",{className:"filter-tags",children:[n&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-search"}),n,r.jsx("button",{onClick:()=>e(""),children:r.jsx("i",{className:"icon-x"})})]}),t!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-filter"}),T.find(w=>w.value===t)?.label,r.jsx("button",{onClick:()=>a("all"),children:r.jsx("i",{className:"icon-x"})})]}),o!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-tag"}),j.find(w=>w.value===o)?.label,r.jsx("button",{onClick:()=>c("all"),children:r.jsx("i",{className:"icon-x"})})]}),d!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-droplet"}),x.find(w=>w.value===d)?.label,r.jsx("button",{onClick:()=>m("all"),children:r.jsx("i",{className:"icon-x"})})]})]})]})]}),r.jsxs("div",{className:"quick-filters",children:[r.jsx("span",{className:"quick-filters-label",children:"Acceso rápido:"}),r.jsxs("div",{className:"quick-filter-buttons",children:[r.jsxs("button",{className:`quick-filter-btn ${t==="preferred"?"active":""}`,onClick:()=>a(t==="preferred"?"all":"preferred"),children:[r.jsx("i",{className:"icon-star"}),"Preferidos"]}),r.jsxs("button",{className:`quick-filter-btn ${t==="active"?"active":""}`,onClick:()=>a(t==="active"?"all":"active"),children:[r.jsx("i",{className:"icon-check-circle"}),"Activos"]}),r.jsxs("button",{className:`quick-filter-btn ${o==="combustibles"?"active":""}`,onClick:()=>c(o==="combustibles"?"all":"combustibles"),children:[r.jsx("i",{className:"icon-fuel"}),"Combustibles"]}),r.jsxs("button",{className:`quick-filter-btn ${d==="diesel"?"active":""}`,onClick:()=>m(d==="diesel"?"all":"diesel"),children:[r.jsx("i",{className:"icon-droplet"}),"Diésel"]})]})]})]})},EV=()=>{const{hasPermission:n,userProfile:e}=Ts(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,m]=Y.useState(!0),[p,v]=Y.useState(null),[_,b]=Y.useState("cards"),[T,j]=Y.useState(!1),[x,C]=Y.useState(null),[w,F]=Y.useState("all"),[H,V]=Y.useState("all"),[k,U]=Y.useState("all"),[Q,L]=Y.useState("");Y.useEffect(()=>{let $=null;return(()=>{$=kj(ae=>{a(ae||[]),m(!1)})})(),()=>{$&&$()}},[]),Y.useEffect(()=>{const $=async()=>{const z=await bL();z.success&&c(z.data)};t.length>0&&$()},[t]);const R=t.filter($=>{const z=!Q||$.name?.toLowerCase().includes(Q.toLowerCase())||$.taxId?.toLowerCase().includes(Q.toLowerCase())||$.contactPerson?.toLowerCase().includes(Q.toLowerCase())||$.city?.toLowerCase().includes(Q.toLowerCase()),ae=w==="all"||(w==="preferred"?$.isPreferred:$.status===w),he=H==="all"||$.category===H,q=k==="all"||$.fuelTypes&&$.fuelTypes.includes(k);return z&&ae&&he&&q}),P=()=>{if(!n("canManageSuppliers")){v("No tienes permisos para agregar proveedores");return}C(null),j(!0)},D=$=>{if(!n("canManageSuppliers")){v("No tienes permisos para editar proveedores");return}C($),j(!0)},A=async($,z)=>{if(!n("canManageSuppliers")){v("No tienes permisos para eliminar proveedores");return}if(window.confirm(`¿Estás seguro de que deseas desactivar el proveedor "${z}"?

Esta acción se puede revertir cambiando su estado a activo.`))try{const ae=await _L($,e?.email);ae.success?v(null):v(ae.error||"Error al desactivar proveedor")}catch(ae){console.error("Error deleting supplier:",ae),v("Error inesperado al eliminar proveedor")}},I=()=>{j(!1),C(null),v(null)},O=()=>{j(!1),C(null),v(null)},_e=()=>{F("all"),V("all"),U("all"),L("")},Se=()=>{if(!n("canExportReports")){v("No tienes permisos para exportar datos");return}try{const $=R.map(ee=>({Nombre:ee.name,"NIT/Documento":ee.taxId,Tipo:ee.type,Categoría:ee.category,"Persona de Contacto":ee.contactPerson,Teléfono:ee.phone,Email:ee.email,Ciudad:ee.city,Combustibles:ee.fuelTypes?.join(", "),Rating:ee.rating,Estado:ee.status,Preferido:ee.isPreferred?"Sí":"No","Fecha Creación":ee.createdAt?.toDate?.()?.toLocaleDateString()||"N/A"})),z=[Object.keys($[0]).join(","),...$.map(ee=>Object.values(ee).map(ce=>`"${ce||""}"`).join(","))].join(`
`),ae=new Blob([z],{type:"text/csv;charset=utf-8;"}),he=document.createElement("a"),q=URL.createObjectURL(ae);he.setAttribute("href",q),he.setAttribute("download",`proveedores_${new Date().toISOString().split("T")[0]}.csv`),he.style.visibility="hidden",document.body.appendChild(he),he.click(),document.body.removeChild(he)}catch($){console.error("Error exporting suppliers:",$),v("Error al exportar proveedores")}};return d?r.jsx("div",{className:"suppliers-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando proveedores..."})]})}):r.jsxs("div",{className:"suppliers-main",children:[r.jsxs("div",{className:"suppliers-header",children:[r.jsxs("div",{className:"header-content",children:[r.jsx("h1",{children:"Gestión de Proveedores"}),r.jsx("p",{className:"header-subtitle",children:"Administra los proveedores de combustibles y materiales"})]}),r.jsxs("div",{className:"header-actions",children:[n("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:P,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Proveedor"]}),n("canExportReports")&&r.jsxs("button",{className:"btn btn-secondary",onClick:Se,disabled:R.length===0,children:[r.jsx("i",{className:"icon-download"}),"Exportar"]})]})]}),p&&r.jsxs("div",{className:"alert alert-error",children:[r.jsx("i",{className:"icon-alert-circle"}),r.jsx("span",{children:p}),r.jsx("button",{onClick:()=>v(null),className:"alert-close",children:r.jsx("i",{className:"icon-x"})})]}),o&&r.jsx(_V,{stats:o,suppliersCount:R.length,totalSuppliers:t.length}),r.jsx(bV,{searchTerm:Q,setSearchTerm:L,filterStatus:w,setFilterStatus:F,filterCategory:H,setFilterCategory:V,filterFuelType:k,setFilterFuelType:U,viewMode:_,setViewMode:b,onClearFilters:_e,resultsCount:R.length}),R.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsx("h3",{children:"No hay proveedores"}),r.jsx("p",{children:t.length===0?"Comienza agregando tu primer proveedor de combustibles.":"No se encontraron proveedores que coincidan con los filtros aplicados."}),t.length===0&&n("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:P,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Primer Proveedor"]}),t.length>0&&r.jsxs("button",{className:"btn btn-secondary",onClick:_e,children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar Filtros"]})]}):r.jsx("div",{className:"suppliers-content",children:_==="cards"?r.jsx(vV,{suppliers:R,onEdit:D,onDelete:A,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")}):r.jsx(gV,{suppliers:R,onEdit:D,onDelete:A,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")})}),T&&r.jsx(yV,{supplier:x,onClose:I,onSuccess:O,onError:v})]})},NV=()=>{const{user:n,userProfile:e}=Ts(),[t,a]=Y.useState("invitations"),[o,c]=Y.useState([]),[d,m]=Y.useState(!1),[p,v]=Y.useState(!1),[_,b]=Y.useState(!1),[T,j]=Y.useState({email:"",name:"",role:ys.CLIENTE});Y.useEffect(()=>{n&&e?.role==="admin"&&x()},[n,e]);const x=async()=>{m(!0);try{const k=await aL(n.uid);k.success?c(k.invitations):console.error("Error loading invitations:",k.error)}catch(k){console.error("Error loading invitations:",k)}finally{m(!1)}},C=async k=>{k.preventDefault(),b(!0);try{const U=await nL(T,n.uid);U.success?(j({email:"",name:"",role:ys.CLIENTE}),v(!1),await x(),alert(`Invitación creada exitosamente!
Código: ${U.invitation.code}`)):alert(`Error: ${U.error}`)}catch(U){console.error("Error creating invitation:",U),alert("Error creando invitación")}finally{b(!1)}},w=async k=>{if(confirm("¿Estás seguro de cancelar esta invitación?"))try{const U=await iL(k,n.uid);U.success?(await x(),alert("Invitación cancelada exitosamente")):alert(`Error: ${U.error}`)}catch(U){console.error("Error cancelling invitation:",U),alert("Error cancelando invitación")}},F=k=>({pending:{text:"Pendiente",class:"status-pending"},used:{text:"Usada",class:"status-used"},cancelled:{text:"Cancelada",class:"status-cancelled"},expired:{text:"Expirada",class:"status-expired"}})[k]||{text:k,class:"status-unknown"},H=k=>({admin:"Administrador",contador:"Contador",cliente:"Cliente"})[k]||k,V=k=>k?(k.toDate?k.toDate():new Date(k)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e?.role!=="admin"?r.jsxs("div",{className:"admin-unauthorized",children:[r.jsx("h2",{children:"⛔ Acceso Denegado"}),r.jsx("p",{children:"Solo los administradores pueden acceder a esta sección."})]}):r.jsxs("div",{className:"admin-main",children:[r.jsxs("div",{className:"admin-header",children:[r.jsx("h1",{children:"⚙️ Administración del Sistema"}),r.jsx("p",{children:"Gestión de usuarios y configuraciones"})]}),r.jsxs("div",{className:"admin-tabs",children:[r.jsx("button",{className:`tab-button ${t==="invitations"?"active":""}`,onClick:()=>a("invitations"),children:"🎫 Invitaciones"}),r.jsx("button",{className:`tab-button ${t==="users"?"active":""}`,onClick:()=>a("users"),children:"👥 Usuarios"}),r.jsx("button",{className:`tab-button ${t==="settings"?"active":""}`,onClick:()=>a("settings"),children:"⚙️ Configuración"})]}),r.jsxs("div",{className:"admin-content",children:[t==="invitations"&&r.jsxs("div",{className:"invitations-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h2",{children:"Gestión de Invitaciones"}),r.jsx("button",{className:"create-button",onClick:()=>v(!0),children:"+ Crear Invitación"})]}),d?r.jsx("div",{className:"loading",children:"Cargando invitaciones..."}):r.jsxs("div",{className:"invitations-table",children:[r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Código"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Rol"}),r.jsx("th",{children:"Estado"}),r.jsx("th",{children:"Creada"}),r.jsx("th",{children:"Expira"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(k=>{const U=F(k.status);return r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("code",{className:"invitation-code",children:k.code})}),r.jsx("td",{children:k.targetEmail}),r.jsx("td",{children:k.targetName||"-"}),r.jsx("td",{children:H(k.targetRole)}),r.jsx("td",{children:r.jsx("span",{className:`status-badge ${U.class}`,children:U.text})}),r.jsx("td",{children:V(k.createdAt)}),r.jsx("td",{children:V(k.expiresAt)}),r.jsx("td",{children:k.status==="pending"&&r.jsx("button",{className:"cancel-button",onClick:()=>w(k.id),children:"Cancelar"})})]},k.id)})})]}),o.length===0&&r.jsx("div",{className:"empty-state",children:r.jsx("p",{children:"No hay invitaciones creadas"})})]})]}),t==="users"&&r.jsxs("div",{className:"users-section",children:[r.jsx("h2",{children:"👥 Usuarios del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Lista de usuarios registrados, edición de permisos, y estadísticas."})]})]}),t==="settings"&&r.jsxs("div",{className:"settings-section",children:[r.jsx("h2",{children:"⚙️ Configuración del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Configuraciones generales, notificaciones, y parámetros del sistema."})]})]})]}),p&&r.jsx("div",{className:"modal-overlay",onClick:()=>v(!1),children:r.jsxs("div",{className:"modal-content",onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Crear Nueva Invitación"}),r.jsx("button",{className:"modal-close",onClick:()=>v(!1),children:"×"})]}),r.jsxs("form",{onSubmit:C,className:"invitation-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email del usuario:"}),r.jsx("input",{id:"email",type:"email",required:!0,value:T.email,onChange:k=>j({...T,email:k.target.value}),placeholder:"usuario@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Nombre (opcional):"}),r.jsx("input",{id:"name",type:"text",value:T.name,onChange:k=>j({...T,name:k.target.value}),placeholder:"Nombre del usuario"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"role",children:"Rol:"}),r.jsxs("select",{id:"role",value:T.role,onChange:k=>j({...T,role:k.target.value}),children:[r.jsx("option",{value:ys.CLIENTE,children:"Cliente"}),r.jsx("option",{value:ys.CONTADOR,children:"Contador"}),r.jsx("option",{value:ys.ADMIN,children:"Administrador"})]})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"cancel-button",onClick:()=>v(!1),children:"Cancelar"}),r.jsx("button",{type:"submit",className:"create-button",disabled:_,children:_?"Creando...":"Crear Invitación"})]})]})]})})]})},xV=()=>r.jsxs("div",{className:"module-placeholder",children:[r.jsx("h2",{children:"📋 Módulo de Reportes"}),r.jsx("p",{children:"Análisis y reportes de combustibles"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Reportes personalizables, gráficos interactivos, y exportación."})]})]}),TV=()=>{const[n,e]=Y.useState("dashboard"),t=()=>{switch(n){case"dashboard":return r.jsx(Px,{});case"inventory":return r.jsx(wL,{});case"movements":return r.jsx(FL,{});case"vehicles":return r.jsx(tV,{});case"maintenance":return r.jsx(hV,{});case"products":return r.jsx(pV,{});case"suppliers":return r.jsx(EV,{});case"reports":return r.jsx(xV,{});case"admin":return r.jsx(NV,{});default:return r.jsx(Px,{})}};return r.jsx(NL,{currentView:n,onViewChange:e,children:t()})},AV=()=>{const[n,e]=Y.useState("login"),[t,a]=Y.useState(!1),[o,c]=Y.useState(""),[d,m]=Y.useState(""),[p,v]=Y.useState(""),[_,b]=Y.useState(""),[T,j]=Y.useState({email:"",password:"",confirmPassword:"",invitationCode:""}),[x,C]=Y.useState(""),[w,F]=Y.useState(null),H=async P=>{P.preventDefault(),a(!0),c("");try{await cR(Bc,p,_)}catch(D){console.error("Error en login:",D),c(Q(D.code))}finally{a(!1)}},V=async()=>{a(!0),c("");try{const P=new Aa,D=await MR(Bc,P);w?await Ix(D.user,w.code):await pj(D.user)}catch(P){console.error("Error en login con Google:",P),c("Error al iniciar sesión con Google")}finally{a(!1)}},k=async P=>{P.preventDefault(),a(!0),c(""),m("");try{const D=await mj(x);D.success?(F(D.invitation),m(`Invitación válida para: ${D.invitation.targetEmail}`),e("register"),j({...T,email:D.invitation.targetEmail,invitationCode:x})):c(D.error)}catch(D){console.error("Error validando invitación:",D),c("Error validando código de invitación")}finally{a(!1)}},U=async P=>{if(P.preventDefault(),a(!0),c(""),T.password!==T.confirmPassword){c("Las contraseñas no coinciden"),a(!1);return}if(T.password.length<6){c("La contraseña debe tener al menos 6 caracteres"),a(!1);return}try{const D=await lR(Bc,T.email,T.password),A=await Ix(D.user,T.invitationCode);A.success?m("¡Registro exitoso! Bienvenido al sistema."):c(A.error)}catch(D){console.error("Error en registro:",D),c(Q(D.code))}finally{a(!1)}},Q=P=>{switch(P){case"auth/invalid-email":return"El formato del email es inválido";case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contraseña incorrecta";case"auth/invalid-credential":return"Email o contraseña incorrectos";case"auth/email-already-in-use":return"Este email ya está registrado";case"auth/weak-password":return"La contraseña es muy débil";default:return"Error de autenticación. Inténtalo de nuevo."}},L=()=>{c(""),m(""),v(""),b(""),C(""),F(null),j({email:"",password:"",confirmPassword:"",invitationCode:""})},R=()=>{switch(n){case"login":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:H,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email:"}),r.jsx("input",{id:"email",type:"email",value:p,onChange:P=>v(P.target.value),required:!0,disabled:t,placeholder:"tu-email@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Contraseña:"}),r.jsx("input",{id:"password",type:"password",value:_,onChange:P=>b(P.target.value),required:!0,disabled:t,placeholder:"Tu contraseña"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Iniciando sesión...":"Iniciar Sesión"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:V,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:"🔗"}),"Continuar con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{L(),e("invite")},children:"¿Tienes un código de invitación? Regístrate aquí"})})]});case"invite":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:k,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"inviteCode",children:"Código de invitación:"}),r.jsx("input",{id:"inviteCode",type:"text",value:x,onChange:P=>C(P.target.value.toUpperCase()),required:!0,disabled:t,placeholder:"XXXXXXXX",maxLength:8,style:{textTransform:"uppercase",fontFamily:"monospace"}}),r.jsx("small",{children:"Ingresa el código de 8 caracteres que recibiste"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Validando...":"Validar Código"})]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{L(),e("login")},children:"Volver al inicio de sesión"})})]});case"register":return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"invitation-info",children:r.jsxs("div",{className:"success-message",children:["✅ Código válido para: ",w?.targetEmail]})}),r.jsxs("form",{onSubmit:U,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerEmail",children:"Email:"}),r.jsx("input",{id:"registerEmail",type:"email",value:T.email,disabled:!0,className:"disabled-input"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerPassword",children:"Contraseña:"}),r.jsx("input",{id:"registerPassword",type:"password",value:T.password,onChange:P=>j({...T,password:P.target.value}),required:!0,disabled:t,placeholder:"Mínimo 6 caracteres",minLength:6})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar contraseña:"}),r.jsx("input",{id:"confirmPassword",type:"password",value:T.confirmPassword,onChange:P=>j({...T,confirmPassword:P.target.value}),required:!0,disabled:t,placeholder:"Repite tu contraseña"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Registrando...":"Crear Cuenta"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:V,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:"🔗"}),"Registrarse con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{L(),e("invite")},children:"Usar otro código de invitación"})})]});default:return null}};return r.jsx("div",{className:"auth-container",children:r.jsxs("div",{className:"auth-card",children:[r.jsxs("div",{className:"auth-header",children:[r.jsx("h1",{children:"⛽ Combustibles"}),r.jsx("h2",{children:"Forestech Colombia"}),r.jsxs("p",{children:[n==="login"&&"Sistema de gestión de combustibles",n==="invite"&&"Validar código de invitación",n==="register"&&"Crear nueva cuenta"]})]}),r.jsxs("div",{className:"auth-form",children:[o&&r.jsx("div",{className:"error-message",children:o}),d&&r.jsx("div",{className:"success-message",children:d}),R(),r.jsx("div",{className:"auth-footer",children:r.jsx("p",{children:r.jsxs("small",{children:["Solo usuarios autorizados pueden acceder al sistema.",r.jsx("br",{}),n==="login"?"Contacta al administrador para obtener un código de invitación.":"Si no tienes código, contacta al administrador."]})})})]})]})})};function jV(){return r.jsx(EL,{children:r.jsx(wV,{})})}function wV(){const{user:n,loading:e}=Ts();return e?r.jsx("div",{className:"loading-container",children:r.jsxs("div",{className:"loader",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Cargando..."})]})}):r.jsxs("div",{className:"App",children:[!n&&r.jsx(AV,{}),n&&r.jsx(TV,{})]})}CC.createRoot(document.getElementById("root")).render(r.jsx(Y.StrictMode,{children:r.jsx(jV,{})}));
