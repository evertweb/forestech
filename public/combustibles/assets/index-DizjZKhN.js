(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var ap={exports:{}},pc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FE;function xw(){if(FE)return pc;FE=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var m in o)m!=="key"&&(c[m]=o[m])}else c=o;return o=c.ref,{$$typeof:s,type:a,key:d,ref:o!==void 0?o:null,props:c}}return pc.Fragment=e,pc.jsx=t,pc.jsxs=t,pc}var qE;function Aw(){return qE||(qE=1,ap.exports=xw()),ap.exports}var l=Aw(),rp={exports:{}},De={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zE;function Sw(){if(zE)return De;zE=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),T=Symbol.iterator;function N(V){return V===null||typeof V!="object"?null:(V=T&&V[T]||V["@@iterator"],typeof V=="function"?V:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,F={};function A(V,ee,he){this.props=V,this.context=ee,this.refs=F,this.updater=he||C}A.prototype.isReactComponent={},A.prototype.setState=function(V,ee){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,ee,"setState")},A.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function L(){}L.prototype=A.prototype;function W(V,ee,he){this.props=V,this.context=ee,this.refs=F,this.updater=he||C}var H=W.prototype=new L;H.constructor=W,w(H,A.prototype),H.isPureReactComponent=!0;var U=Array.isArray,z={H:null,A:null,T:null,S:null,V:null},ae=Object.prototype.hasOwnProperty;function O(V,ee,he,ue,Te,Pe){return he=Pe.ref,{$$typeof:s,type:V,key:ee,ref:he!==void 0?he:null,props:Pe}}function x(V,ee){return O(V.type,ee,void 0,void 0,void 0,V.props)}function j(V){return typeof V=="object"&&V!==null&&V.$$typeof===s}function R(V){var ee={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(he){return ee[he]})}var P=/\/+/g;function M(V,ee){return typeof V=="object"&&V!==null&&V.key!=null?R(""+V.key):ee.toString(36)}function D(){}function re(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(D,D):(V.status="pending",V.then(function(ee){V.status==="pending"&&(V.status="fulfilled",V.value=ee)},function(ee){V.status==="pending"&&(V.status="rejected",V.reason=ee)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function ye(V,ee,he,ue,Te){var Pe=typeof V;(Pe==="undefined"||Pe==="boolean")&&(V=null);var Ie=!1;if(V===null)Ie=!0;else switch(Pe){case"bigint":case"string":case"number":Ie=!0;break;case"object":switch(V.$$typeof){case s:case e:Ie=!0;break;case _:return Ie=V._init,ye(Ie(V._payload),ee,he,ue,Te)}}if(Ie)return Te=Te(V),Ie=ue===""?"."+M(V,0):ue,U(Te)?(he="",Ie!=null&&(he=Ie.replace(P,"$&/")+"/"),ye(Te,ee,he,"",function(bs){return bs})):Te!=null&&(j(Te)&&(Te=x(Te,he+(Te.key==null||V&&V.key===Te.key?"":(""+Te.key).replace(P,"$&/")+"/")+Ie)),ee.push(Te)),1;Ie=0;var Ut=ue===""?".":ue+":";if(U(V))for(var ot=0;ot<V.length;ot++)ue=V[ot],Pe=Ut+M(ue,ot),Ie+=ye(ue,ee,he,Pe,Te);else if(ot=N(V),typeof ot=="function")for(V=ot.call(V),ot=0;!(ue=V.next()).done;)ue=ue.value,Pe=Ut+M(ue,ot++),Ie+=ye(ue,ee,he,Pe,Te);else if(Pe==="object"){if(typeof V.then=="function")return ye(re(V),ee,he,ue,Te);throw ee=String(V),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return Ie}function G(V,ee,he){if(V==null)return V;var ue=[],Te=0;return ye(V,ue,"","",function(Pe){return ee.call(he,Pe,Te++)}),ue}function ne(V){if(V._status===-1){var ee=V._result;ee=ee(),ee.then(function(he){(V._status===0||V._status===-1)&&(V._status=1,V._result=he)},function(he){(V._status===0||V._status===-1)&&(V._status=2,V._result=he)}),V._status===-1&&(V._status=0,V._result=ee)}if(V._status===1)return V._result.default;throw V._result}var ce=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)};function ge(){}return De.Children={map:G,forEach:function(V,ee,he){G(V,function(){ee.apply(this,arguments)},he)},count:function(V){var ee=0;return G(V,function(){ee++}),ee},toArray:function(V){return G(V,function(ee){return ee})||[]},only:function(V){if(!j(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},De.Component=A,De.Fragment=t,De.Profiler=o,De.PureComponent=W,De.StrictMode=a,De.Suspense=g,De.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=z,De.__COMPILER_RUNTIME={__proto__:null,c:function(V){return z.H.useMemoCache(V)}},De.cache=function(V){return function(){return V.apply(null,arguments)}},De.cloneElement=function(V,ee,he){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var ue=w({},V.props),Te=V.key,Pe=void 0;if(ee!=null)for(Ie in ee.ref!==void 0&&(Pe=void 0),ee.key!==void 0&&(Te=""+ee.key),ee)!ae.call(ee,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&ee.ref===void 0||(ue[Ie]=ee[Ie]);var Ie=arguments.length-2;if(Ie===1)ue.children=he;else if(1<Ie){for(var Ut=Array(Ie),ot=0;ot<Ie;ot++)Ut[ot]=arguments[ot+2];ue.children=Ut}return O(V.type,Te,void 0,void 0,Pe,ue)},De.createContext=function(V){return V={$$typeof:d,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:c,_context:V},V},De.createElement=function(V,ee,he){var ue,Te={},Pe=null;if(ee!=null)for(ue in ee.key!==void 0&&(Pe=""+ee.key),ee)ae.call(ee,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(Te[ue]=ee[ue]);var Ie=arguments.length-2;if(Ie===1)Te.children=he;else if(1<Ie){for(var Ut=Array(Ie),ot=0;ot<Ie;ot++)Ut[ot]=arguments[ot+2];Te.children=Ut}if(V&&V.defaultProps)for(ue in Ie=V.defaultProps,Ie)Te[ue]===void 0&&(Te[ue]=Ie[ue]);return O(V,Pe,void 0,void 0,null,Te)},De.createRef=function(){return{current:null}},De.forwardRef=function(V){return{$$typeof:m,render:V}},De.isValidElement=j,De.lazy=function(V){return{$$typeof:_,_payload:{_status:-1,_result:V},_init:ne}},De.memo=function(V,ee){return{$$typeof:v,type:V,compare:ee===void 0?null:ee}},De.startTransition=function(V){var ee=z.T,he={};z.T=he;try{var ue=V(),Te=z.S;Te!==null&&Te(he,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(ge,ce)}catch(Pe){ce(Pe)}finally{z.T=ee}},De.unstable_useCacheRefresh=function(){return z.H.useCacheRefresh()},De.use=function(V){return z.H.use(V)},De.useActionState=function(V,ee,he){return z.H.useActionState(V,ee,he)},De.useCallback=function(V,ee){return z.H.useCallback(V,ee)},De.useContext=function(V){return z.H.useContext(V)},De.useDebugValue=function(){},De.useDeferredValue=function(V,ee){return z.H.useDeferredValue(V,ee)},De.useEffect=function(V,ee,he){var ue=z.H;if(typeof he=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ue.useEffect(V,ee)},De.useId=function(){return z.H.useId()},De.useImperativeHandle=function(V,ee,he){return z.H.useImperativeHandle(V,ee,he)},De.useInsertionEffect=function(V,ee){return z.H.useInsertionEffect(V,ee)},De.useLayoutEffect=function(V,ee){return z.H.useLayoutEffect(V,ee)},De.useMemo=function(V,ee){return z.H.useMemo(V,ee)},De.useOptimistic=function(V,ee){return z.H.useOptimistic(V,ee)},De.useReducer=function(V,ee,he){return z.H.useReducer(V,ee,he)},De.useRef=function(V){return z.H.useRef(V)},De.useState=function(V){return z.H.useState(V)},De.useSyncExternalStore=function(V,ee,he){return z.H.useSyncExternalStore(V,ee,he)},De.useTransition=function(){return z.H.useTransition()},De.version="19.1.0",De}var BE;function ug(){return BE||(BE=1,rp.exports=Sw()),rp.exports}var J=ug(),op={exports:{}},gc={},lp={exports:{}},cp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HE;function ww(){return HE||(HE=1,function(s){function e(G,ne){var ce=G.length;G.push(ne);e:for(;0<ce;){var ge=ce-1>>>1,V=G[ge];if(0<o(V,ne))G[ge]=ne,G[ce]=V,ce=ge;else break e}}function t(G){return G.length===0?null:G[0]}function a(G){if(G.length===0)return null;var ne=G[0],ce=G.pop();if(ce!==ne){G[0]=ce;e:for(var ge=0,V=G.length,ee=V>>>1;ge<ee;){var he=2*(ge+1)-1,ue=G[he],Te=he+1,Pe=G[Te];if(0>o(ue,ce))Te<V&&0>o(Pe,ue)?(G[ge]=Pe,G[Te]=ce,ge=Te):(G[ge]=ue,G[he]=ce,ge=he);else if(Te<V&&0>o(Pe,ce))G[ge]=Pe,G[Te]=ce,ge=Te;else break e}}return ne}function o(G,ne){var ce=G.sortIndex-ne.sortIndex;return ce!==0?ce:G.id-ne.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;s.unstable_now=function(){return c.now()}}else{var d=Date,m=d.now();s.unstable_now=function(){return d.now()-m}}var g=[],v=[],_=1,T=null,N=3,C=!1,w=!1,F=!1,A=!1,L=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;function U(G){for(var ne=t(v);ne!==null;){if(ne.callback===null)a(v);else if(ne.startTime<=G)a(v),ne.sortIndex=ne.expirationTime,e(g,ne);else break;ne=t(v)}}function z(G){if(F=!1,U(G),!w)if(t(g)!==null)w=!0,ae||(ae=!0,M());else{var ne=t(v);ne!==null&&ye(z,ne.startTime-G)}}var ae=!1,O=-1,x=5,j=-1;function R(){return A?!0:!(s.unstable_now()-j<x)}function P(){if(A=!1,ae){var G=s.unstable_now();j=G;var ne=!0;try{e:{w=!1,F&&(F=!1,W(O),O=-1),C=!0;var ce=N;try{t:{for(U(G),T=t(g);T!==null&&!(T.expirationTime>G&&R());){var ge=T.callback;if(typeof ge=="function"){T.callback=null,N=T.priorityLevel;var V=ge(T.expirationTime<=G);if(G=s.unstable_now(),typeof V=="function"){T.callback=V,U(G),ne=!0;break t}T===t(g)&&a(g),U(G)}else a(g);T=t(g)}if(T!==null)ne=!0;else{var ee=t(v);ee!==null&&ye(z,ee.startTime-G),ne=!1}}break e}finally{T=null,N=ce,C=!1}ne=void 0}}finally{ne?M():ae=!1}}}var M;if(typeof H=="function")M=function(){H(P)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,re=D.port2;D.port1.onmessage=P,M=function(){re.postMessage(null)}}else M=function(){L(P,0)};function ye(G,ne){O=L(function(){G(s.unstable_now())},ne)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(G){G.callback=null},s.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<G?Math.floor(1e3/G):5},s.unstable_getCurrentPriorityLevel=function(){return N},s.unstable_next=function(G){switch(N){case 1:case 2:case 3:var ne=3;break;default:ne=N}var ce=N;N=ne;try{return G()}finally{N=ce}},s.unstable_requestPaint=function(){A=!0},s.unstable_runWithPriority=function(G,ne){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ce=N;N=G;try{return ne()}finally{N=ce}},s.unstable_scheduleCallback=function(G,ne,ce){var ge=s.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ge+ce:ge):ce=ge,G){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=ce+V,G={id:_++,callback:ne,priorityLevel:G,startTime:ce,expirationTime:V,sortIndex:-1},ce>ge?(G.sortIndex=ce,e(v,G),t(g)===null&&G===t(v)&&(F?(W(O),O=-1):F=!0,ye(z,ce-ge))):(G.sortIndex=V,e(g,G),w||C||(w=!0,ae||(ae=!0,M()))),G},s.unstable_shouldYield=R,s.unstable_wrapCallback=function(G){var ne=N;return function(){var ce=N;N=ne;try{return G.apply(this,arguments)}finally{N=ce}}}}(cp)),cp}var GE;function Cw(){return GE||(GE=1,lp.exports=ww()),lp.exports}var up={exports:{}},cn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $E;function Iw(){if($E)return cn;$E=1;var s=ug();function e(g){var v="https://react.dev/errors/"+g;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)v+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(g,v,_){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:T==null?null:""+T,children:g,containerInfo:v,implementation:_}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(g,v){if(g==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return cn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,cn.createPortal=function(g,v){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(e(299));return c(g,v,null,_)},cn.flushSync=function(g){var v=d.T,_=a.p;try{if(d.T=null,a.p=2,g)return g()}finally{d.T=v,a.p=_,a.d.f()}},cn.preconnect=function(g,v){typeof g=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,a.d.C(g,v))},cn.prefetchDNS=function(g){typeof g=="string"&&a.d.D(g)},cn.preinit=function(g,v){if(typeof g=="string"&&v&&typeof v.as=="string"){var _=v.as,T=m(_,v.crossOrigin),N=typeof v.integrity=="string"?v.integrity:void 0,C=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;_==="style"?a.d.S(g,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:T,integrity:N,fetchPriority:C}):_==="script"&&a.d.X(g,{crossOrigin:T,integrity:N,fetchPriority:C,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},cn.preinitModule=function(g,v){if(typeof g=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var _=m(v.as,v.crossOrigin);a.d.M(g,{crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&a.d.M(g)},cn.preload=function(g,v){if(typeof g=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var _=v.as,T=m(_,v.crossOrigin);a.d.L(g,_,{crossOrigin:T,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},cn.preloadModule=function(g,v){if(typeof g=="string")if(v){var _=m(v.as,v.crossOrigin);a.d.m(g,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else a.d.m(g)},cn.requestFormReset=function(g){a.d.r(g)},cn.unstable_batchedUpdates=function(g,v){return g(v)},cn.useFormState=function(g,v,_){return d.H.useFormState(g,v,_)},cn.useFormStatus=function(){return d.H.useHostTransitionStatus()},cn.version="19.1.0",cn}var KE;function jw(){if(KE)return up.exports;KE=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),up.exports=Iw(),up.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YE;function Rw(){if(YE)return gc;YE=1;var s=Cw(),e=ug(),t=jw();function a(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)i+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function c(n){var i=n,r=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(r=i.return),n=i.return;while(n)}return i.tag===3?r:null}function d(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function m(n){if(c(n)!==n)throw Error(a(188))}function g(n){var i=n.alternate;if(!i){if(i=c(n),i===null)throw Error(a(188));return i!==n?null:n}for(var r=n,u=i;;){var f=r.return;if(f===null)break;var p=f.alternate;if(p===null){if(u=f.return,u!==null){r=u;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===r)return m(f),n;if(p===u)return m(f),i;p=p.sibling}throw Error(a(188))}if(r.return!==u.return)r=f,u=p;else{for(var b=!1,S=f.child;S;){if(S===r){b=!0,r=f,u=p;break}if(S===u){b=!0,u=f,r=p;break}S=S.sibling}if(!b){for(S=p.child;S;){if(S===r){b=!0,r=p,u=f;break}if(S===u){b=!0,u=p,r=f;break}S=S.sibling}if(!b)throw Error(a(189))}}if(r.alternate!==u)throw Error(a(190))}if(r.tag!==3)throw Error(a(188));return r.stateNode.current===r?n:i}function v(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=v(n),i!==null)return i;n=n.sibling}return null}var _=Object.assign,T=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),W=Symbol.for("react.consumer"),H=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function M(n){return n===null||typeof n!="object"?null:(n=P&&n[P]||n["@@iterator"],typeof n=="function"?n:null)}var D=Symbol.for("react.client.reference");function re(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===D?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case w:return"Fragment";case A:return"Profiler";case F:return"StrictMode";case z:return"Suspense";case ae:return"SuspenseList";case j:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case C:return"Portal";case H:return(n.displayName||"Context")+".Provider";case W:return(n._context.displayName||"Context")+".Consumer";case U:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case O:return i=n.displayName||null,i!==null?i:re(n.type)||"Memo";case x:i=n._payload,n=n._init;try{return re(n(i))}catch{}}return null}var ye=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},ge=[],V=-1;function ee(n){return{current:n}}function he(n){0>V||(n.current=ge[V],ge[V]=null,V--)}function ue(n,i){V++,ge[V]=n.current,n.current=i}var Te=ee(null),Pe=ee(null),Ie=ee(null),Ut=ee(null);function ot(n,i){switch(ue(Ie,i),ue(Pe,n),ue(Te,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?mE(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=mE(i),n=pE(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}he(Te),ue(Te,n)}function bs(){he(Te),he(Pe),he(Ie)}function Ii(n){n.memoizedState!==null&&ue(Ut,n);var i=Te.current,r=pE(i,n.type);i!==r&&(ue(Pe,n),ue(Te,r))}function Ks(n){Pe.current===n&&(he(Te),he(Pe)),Ut.current===n&&(he(Ut),uc._currentValue=ce)}var Oa=Object.prototype.hasOwnProperty,Ma=s.unstable_scheduleCallback,Pa=s.unstable_cancelCallback,ol=s.unstable_shouldYield,du=s.unstable_requestPaint,Gn=s.unstable_now,af=s.unstable_getCurrentPriorityLevel,ll=s.unstable_ImmediatePriority,Pr=s.unstable_UserBlockingPriority,ka=s.unstable_NormalPriority,rf=s.unstable_LowPriority,kr=s.unstable_IdlePriority,cl=s.log,hu=s.unstable_setDisableYieldValue,gt=null,We=null;function jn(n){if(typeof cl=="function"&&hu(n),We&&typeof We.setStrictMode=="function")try{We.setStrictMode(gt,n)}catch{}}var on=Math.clz32?Math.clz32:Va,fu=Math.log,of=Math.LN2;function Va(n){return n>>>=0,n===0?32:31-(fu(n)/of|0)|0}var La=256,Ua=4194304;function os(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Vr(n,i,r){var u=n.pendingLanes;if(u===0)return 0;var f=0,p=n.suspendedLanes,b=n.pingedLanes;n=n.warmLanes;var S=u&134217727;return S!==0?(u=S&~p,u!==0?f=os(u):(b&=S,b!==0?f=os(b):r||(r=S&~n,r!==0&&(f=os(r))))):(S=u&~p,S!==0?f=os(S):b!==0?f=os(b):r||(r=u&~n,r!==0&&(f=os(r)))),f===0?0:i!==0&&i!==f&&(i&p)===0&&(p=f&-f,r=i&-i,p>=r||p===32&&(r&4194048)!==0)?i:f}function Fa(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function ul(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dl(){var n=La;return La<<=1,(La&4194048)===0&&(La=256),n}function hl(){var n=Ua;return Ua<<=1,(Ua&62914560)===0&&(Ua=4194304),n}function Ys(n){for(var i=[],r=0;31>r;r++)i.push(n);return i}function Qs(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function fl(n,i,r,u,f,p){var b=n.pendingLanes;n.pendingLanes=r,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=r,n.entangledLanes&=r,n.errorRecoveryDisabledLanes&=r,n.shellSuspendCounter=0;var S=n.entanglements,k=n.expirationTimes,Y=n.hiddenUpdates;for(r=b&~r;0<r;){var te=31-on(r),oe=1<<te;S[te]=0,k[te]=-1;var Q=Y[te];if(Q!==null)for(Y[te]=null,te=0;te<Q.length;te++){var X=Q[te];X!==null&&(X.lane&=-536870913)}r&=~oe}u!==0&&Ts(n,u,0),p!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=p&~(b&~i))}function Ts(n,i,r){n.pendingLanes|=i,n.suspendedLanes&=~i;var u=31-on(i);n.entangledLanes|=i,n.entanglements[u]=n.entanglements[u]|1073741824|r&4194090}function ml(n,i){var r=n.entangledLanes|=i;for(n=n.entanglements;r;){var u=31-on(r),f=1<<u;f&i|n[u]&i&&(n[u]|=i),r&=~f}}function ji(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Lr(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Ri(){var n=ne.p;return n!==0?n:(n=window.event,n===void 0?32:ME(n.type))}function mu(n,i){var r=ne.p;try{return ne.p=n,i()}finally{ne.p=r}}var ut=Math.random().toString(36).slice(2),Rt="__reactFiber$"+ut,At="__reactProps$"+ut,$n="__reactContainer$"+ut,pl="__reactEvents$"+ut,lf="__reactListeners$"+ut,Di="__reactHandles$"+ut,pu="__reactResources$"+ut,qa="__reactMarker$"+ut;function Oi(n){delete n[Rt],delete n[At],delete n[pl],delete n[lf],delete n[Di]}function Xs(n){var i=n[Rt];if(i)return i;for(var r=n.parentNode;r;){if(i=r[$n]||r[Rt]){if(r=i.alternate,i.child!==null||r!==null&&r.child!==null)for(n=_E(n);n!==null;){if(r=n[Rt])return r;n=_E(n)}return i}n=r,r=n.parentNode}return null}function Ns(n){if(n=n[Rt]||n[$n]){var i=n.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return n}return null}function xs(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(a(33))}function pn(n){var i=n[pu];return i||(i=n[pu]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Et(n){n[qa]=!0}var gl=new Set,Ur={};function ls(n,i){Ws(n,i),Ws(n+"Capture",i)}function Ws(n,i){for(Ur[n]=i,n=0;n<i.length;n++)gl.add(i[n])}var gu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),vu={},za={};function yu(n){return Oa.call(za,n)?!0:Oa.call(vu,n)?!1:gu.test(n)?za[n]=!0:(vu[n]=!0,!1)}function Mi(n,i,r){if(yu(i))if(r===null)n.removeAttribute(i);else{switch(typeof r){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+r)}}function As(n,i,r){if(r===null)n.removeAttribute(i);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+r)}}function Kt(n,i,r,u){if(u===null)n.removeAttribute(r);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttributeNS(i,r,""+u)}}var Ba,_u;function Zs(n){if(Ba===void 0)try{throw Error()}catch(r){var i=r.stack.trim().match(/\n( *(at )?)/);Ba=i&&i[1]||"",_u=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ba+n+_u}var Fr=!1;function qr(n,i){if(!n||Fr)return"";Fr=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(X){var Q=X}Reflect.construct(n,[],oe)}else{try{oe.call()}catch(X){Q=X}n.call(oe.prototype)}}else{try{throw Error()}catch(X){Q=X}(oe=n())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(X){if(X&&Q&&typeof X.stack=="string")return[X.stack,Q.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=u.DetermineComponentFrameRoot(),b=p[0],S=p[1];if(b&&S){var k=b.split(`
`),Y=S.split(`
`);for(f=u=0;u<k.length&&!k[u].includes("DetermineComponentFrameRoot");)u++;for(;f<Y.length&&!Y[f].includes("DetermineComponentFrameRoot");)f++;if(u===k.length||f===Y.length)for(u=k.length-1,f=Y.length-1;1<=u&&0<=f&&k[u]!==Y[f];)f--;for(;1<=u&&0<=f;u--,f--)if(k[u]!==Y[f]){if(u!==1||f!==1)do if(u--,f--,0>f||k[u]!==Y[f]){var te=`
`+k[u].replace(" at new "," at ");return n.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",n.displayName)),te}while(1<=u&&0<=f);break}}}finally{Fr=!1,Error.prepareStackTrace=r}return(r=n?n.displayName||n.name:"")?Zs(r):""}function vl(n){switch(n.tag){case 26:case 27:case 5:return Zs(n.type);case 16:return Zs("Lazy");case 13:return Zs("Suspense");case 19:return Zs("SuspenseList");case 0:case 15:return qr(n.type,!1);case 11:return qr(n.type.render,!1);case 1:return qr(n.type,!0);case 31:return Zs("Activity");default:return""}}function zr(n){try{var i="";do i+=vl(n),n=n.return;while(n);return i}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}function gn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function yl(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function cf(n){var i=yl(n)?"checked":"value",r=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),u=""+n[i];if(!n.hasOwnProperty(i)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var f=r.get,p=r.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return f.call(this)},set:function(b){u=""+b,p.call(this,b)}}),Object.defineProperty(n,i,{enumerable:r.enumerable}),{getValue:function(){return u},setValue:function(b){u=""+b},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Br(n){n._valueTracker||(n._valueTracker=cf(n))}function _l(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var r=i.getValue(),u="";return n&&(u=yl(n)?n.checked?"true":"false":n.value),n=u,n!==r?(i.setValue(n),!0):!1}function Ha(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var uf=/[\n"\\]/g;function St(n){return n.replace(uf,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Rn(n,i,r,u,f,p,b,S){n.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?n.type=b:n.removeAttribute("type"),i!=null?b==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+gn(i)):n.value!==""+gn(i)&&(n.value=""+gn(i)):b!=="submit"&&b!=="reset"||n.removeAttribute("value"),i!=null?Pi(n,b,gn(i)):r!=null?Pi(n,b,gn(r)):u!=null&&n.removeAttribute("value"),f==null&&p!=null&&(n.defaultChecked=!!p),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?n.name=""+gn(S):n.removeAttribute("name")}function Ga(n,i,r,u,f,p,b,S){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(n.type=p),i!=null||r!=null){if(!(p!=="submit"&&p!=="reset"||i!=null))return;r=r!=null?""+gn(r):"",i=i!=null?""+gn(i):r,S||i===n.value||(n.value=i),n.defaultValue=i}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,n.checked=S?n.checked:!!u,n.defaultChecked=!!u,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(n.name=b)}function Pi(n,i,r){i==="number"&&Ha(n.ownerDocument)===n||n.defaultValue===""+r||(n.defaultValue=""+r)}function Js(n,i,r,u){if(n=n.options,i){i={};for(var f=0;f<r.length;f++)i["$"+r[f]]=!0;for(r=0;r<n.length;r++)f=i.hasOwnProperty("$"+n[r].value),n[r].selected!==f&&(n[r].selected=f),f&&u&&(n[r].defaultSelected=!0)}else{for(r=""+gn(r),i=null,f=0;f<n.length;f++){if(n[f].value===r){n[f].selected=!0,u&&(n[f].defaultSelected=!0);return}i!==null||n[f].disabled||(i=n[f])}i!==null&&(i.selected=!0)}}function tt(n,i,r){if(i!=null&&(i=""+gn(i),i!==n.value&&(n.value=i),r==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=r!=null?""+gn(r):""}function $a(n,i,r,u){if(i==null){if(u!=null){if(r!=null)throw Error(a(92));if(ye(u)){if(1<u.length)throw Error(a(93));u=u[0]}r=u}r==null&&(r=""),i=r}r=gn(i),n.defaultValue=r,u=n.textContent,u===r&&u!==""&&u!==null&&(n.value=u)}function Kn(n,i){if(i){var r=n.firstChild;if(r&&r===n.lastChild&&r.nodeType===3){r.nodeValue=i;return}}n.textContent=i}var Ka=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Eu(n,i,r){var u=i.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?u?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":u?n.setProperty(i,r):typeof r!="number"||r===0||Ka.has(i)?i==="float"?n.cssFloat=r:n[i]=(""+r).trim():n[i]=r+"px"}function El(n,i,r){if(i!=null&&typeof i!="object")throw Error(a(62));if(n=n.style,r!=null){for(var u in r)!r.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?n.setProperty(u,""):u==="float"?n.cssFloat="":n[u]="");for(var f in i)u=i[f],i.hasOwnProperty(f)&&r[f]!==u&&Eu(n,f,u)}else for(var p in i)i.hasOwnProperty(p)&&Eu(n,p,i[p])}function bl(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var df=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Hr(n){return hf.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var ei=null;function Yn(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var ti=null,ni=null;function Tl(n){var i=Ns(n);if(i&&(n=i.stateNode)){var r=n[At]||null;e:switch(n=i.stateNode,i.type){case"input":if(Rn(n,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),i=r.name,r.type==="radio"&&i!=null){for(r=n;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+St(""+i)+'"][type="radio"]'),i=0;i<r.length;i++){var u=r[i];if(u!==n&&u.form===n.form){var f=u[At]||null;if(!f)throw Error(a(90));Rn(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(i=0;i<r.length;i++)u=r[i],u.form===n.form&&_l(u)}break e;case"textarea":tt(n,r.value,r.defaultValue);break e;case"select":i=r.value,i!=null&&Js(n,!!r.multiple,i,!1)}}}var Ss=!1;function bu(n,i,r){if(Ss)return n(i,r);Ss=!0;try{var u=n(i);return u}finally{if(Ss=!1,(ti!==null||ni!==null)&&(md(),ti&&(i=ti,n=ni,ni=ti=null,Tl(i),n)))for(i=0;i<n.length;i++)Tl(n[i])}}function Ya(n,i){var r=n.stateNode;if(r===null)return null;var u=r[At]||null;if(u===null)return null;r=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(n=n.type,u=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!u;break e;default:n=!1}if(n)return null;if(r&&typeof r!="function")throw Error(a(231,i,typeof r));return r}var cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qn=!1;if(cs)try{var Qa={};Object.defineProperty(Qa,"passive",{get:function(){Qn=!0}}),window.addEventListener("test",Qa,Qa),window.removeEventListener("test",Qa,Qa)}catch{Qn=!1}var ws=null,ki=null,si=null;function Nl(){if(si)return si;var n,i=ki,r=i.length,u,f="value"in ws?ws.value:ws.textContent,p=f.length;for(n=0;n<r&&i[n]===f[n];n++);var b=r-n;for(u=1;u<=b&&i[r-u]===f[p-u];u++);return si=f.slice(n,1<u?1-u:void 0)}function Cs(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Is(){return!0}function xl(){return!1}function Ft(n){function i(r,u,f,p,b){this._reactName=r,this._targetInst=f,this.type=u,this.nativeEvent=p,this.target=b,this.currentTarget=null;for(var S in n)n.hasOwnProperty(S)&&(r=n[S],this[S]=r?r(p):p[S]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Is:xl,this.isPropagationStopped=xl,this}return _(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Is)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Is)},persist:function(){},isPersistent:Is}),i}var Xe={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gr=Ft(Xe),Xa=_({},Xe,{view:0,detail:0}),Tu=Ft(Xa),$r,Kr,js,Wa=_({},Xa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:er,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==js&&(js&&n.type==="mousemove"?($r=n.screenX-js.screenX,Kr=n.screenY-js.screenY):Kr=$r=0,js=n),$r)},movementY:function(n){return"movementY"in n?n.movementY:Kr}}),Xn=Ft(Wa),Nu=_({},Wa,{dataTransfer:0}),ff=Ft(Nu),Za=_({},Xa,{relatedTarget:0}),Yr=Ft(Za),Al=_({},Xe,{animationName:0,elapsedTime:0,pseudoElement:0}),Qr=Ft(Al),xu=_({},Xe,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Xr=Ft(xu),mf=_({},Xe,{data:0}),Sl=Ft(mf),Ja={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Au={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Su={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wl(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=Su[n])?!!i[n]:!1}function er(){return wl}var wu=_({},Xa,{key:function(n){if(n.key){var i=Ja[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Cs(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Au[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:er,charCode:function(n){return n.type==="keypress"?Cs(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Cs(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Wr=Ft(wu),Cu=_({},Wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cl=Ft(Cu),ii=_({},Xa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:er}),Iu=Ft(ii),ju=_({},Xe,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ru=Ft(ju),Du=_({},Wa,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Zr=Ft(Du),vn=_({},Xe,{newState:0,oldState:0}),Ou=Ft(vn),Mu=[9,13,27,32],Rs=cs&&"CompositionEvent"in window,h=null;cs&&"documentMode"in document&&(h=document.documentMode);var y=cs&&"TextEvent"in window&&!h,E=cs&&(!Rs||h&&8<h&&11>=h),I=" ",$=!1;function Z(n,i){switch(n){case"keyup":return Mu.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function de(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Be=!1;function Dt(n,i){switch(n){case"compositionend":return de(i);case"keypress":return i.which!==32?null:($=!0,I);case"textInput":return n=i.data,n===I&&$?null:n;default:return null}}function He(n,i){if(Be)return n==="compositionend"||!Rs&&Z(n,i)?(n=Nl(),si=ki=ws=null,Be=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return E&&i.locale!=="ko"?null:i.data;default:return null}}var qt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ot(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!qt[n.type]:i==="textarea"}function ai(n,i,r,u){ti?ni?ni.push(u):ni=[u]:ti=u,i=Ed(i,"onChange"),0<i.length&&(r=new Gr("onChange","change",null,r,u),n.push({event:r,listeners:i}))}var Yt=null,Ds=null;function Il(n){cE(n,0)}function Pu(n){var i=xs(n);if(_l(i))return n}function jv(n,i){if(n==="change")return i}var Rv=!1;if(cs){var pf;if(cs){var gf="oninput"in document;if(!gf){var Dv=document.createElement("div");Dv.setAttribute("oninput","return;"),gf=typeof Dv.oninput=="function"}pf=gf}else pf=!1;Rv=pf&&(!document.documentMode||9<document.documentMode)}function Ov(){Yt&&(Yt.detachEvent("onpropertychange",Mv),Ds=Yt=null)}function Mv(n){if(n.propertyName==="value"&&Pu(Ds)){var i=[];ai(i,Ds,n,Yn(n)),bu(Il,i)}}function eS(n,i,r){n==="focusin"?(Ov(),Yt=i,Ds=r,Yt.attachEvent("onpropertychange",Mv)):n==="focusout"&&Ov()}function tS(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Pu(Ds)}function nS(n,i){if(n==="click")return Pu(i)}function sS(n,i){if(n==="input"||n==="change")return Pu(i)}function iS(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var Dn=typeof Object.is=="function"?Object.is:iS;function jl(n,i){if(Dn(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var r=Object.keys(n),u=Object.keys(i);if(r.length!==u.length)return!1;for(u=0;u<r.length;u++){var f=r[u];if(!Oa.call(i,f)||!Dn(n[f],i[f]))return!1}return!0}function Pv(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function kv(n,i){var r=Pv(n);n=0;for(var u;r;){if(r.nodeType===3){if(u=n+r.textContent.length,n<=i&&u>=i)return{node:r,offset:i-n};n=u}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Pv(r)}}function Vv(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?Vv(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Lv(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=Ha(n.document);i instanceof n.HTMLIFrameElement;){try{var r=typeof i.contentWindow.location.href=="string"}catch{r=!1}if(r)n=i.contentWindow;else break;i=Ha(n.document)}return i}function vf(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var aS=cs&&"documentMode"in document&&11>=document.documentMode,Jr=null,yf=null,Rl=null,_f=!1;function Uv(n,i,r){var u=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;_f||Jr==null||Jr!==Ha(u)||(u=Jr,"selectionStart"in u&&vf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Rl&&jl(Rl,u)||(Rl=u,u=Ed(yf,"onSelect"),0<u.length&&(i=new Gr("onSelect","select",null,i,r),n.push({event:i,listeners:u}),i.target=Jr)))}function tr(n,i){var r={};return r[n.toLowerCase()]=i.toLowerCase(),r["Webkit"+n]="webkit"+i,r["Moz"+n]="moz"+i,r}var eo={animationend:tr("Animation","AnimationEnd"),animationiteration:tr("Animation","AnimationIteration"),animationstart:tr("Animation","AnimationStart"),transitionrun:tr("Transition","TransitionRun"),transitionstart:tr("Transition","TransitionStart"),transitioncancel:tr("Transition","TransitionCancel"),transitionend:tr("Transition","TransitionEnd")},Ef={},Fv={};cs&&(Fv=document.createElement("div").style,"AnimationEvent"in window||(delete eo.animationend.animation,delete eo.animationiteration.animation,delete eo.animationstart.animation),"TransitionEvent"in window||delete eo.transitionend.transition);function nr(n){if(Ef[n])return Ef[n];if(!eo[n])return n;var i=eo[n],r;for(r in i)if(i.hasOwnProperty(r)&&r in Fv)return Ef[n]=i[r];return n}var qv=nr("animationend"),zv=nr("animationiteration"),Bv=nr("animationstart"),rS=nr("transitionrun"),oS=nr("transitionstart"),lS=nr("transitioncancel"),Hv=nr("transitionend"),Gv=new Map,bf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");bf.push("scrollEnd");function us(n,i){Gv.set(n,i),ls(i,[n])}var $v=new WeakMap;function Wn(n,i){if(typeof n=="object"&&n!==null){var r=$v.get(n);return r!==void 0?r:(i={value:n,source:i,stack:zr(i)},$v.set(n,i),i)}return{value:n,source:i,stack:zr(i)}}var Zn=[],to=0,Tf=0;function ku(){for(var n=to,i=Tf=to=0;i<n;){var r=Zn[i];Zn[i++]=null;var u=Zn[i];Zn[i++]=null;var f=Zn[i];Zn[i++]=null;var p=Zn[i];if(Zn[i++]=null,u!==null&&f!==null){var b=u.pending;b===null?f.next=f:(f.next=b.next,b.next=f),u.pending=f}p!==0&&Kv(r,f,p)}}function Vu(n,i,r,u){Zn[to++]=n,Zn[to++]=i,Zn[to++]=r,Zn[to++]=u,Tf|=u,n.lanes|=u,n=n.alternate,n!==null&&(n.lanes|=u)}function Nf(n,i,r,u){return Vu(n,i,r,u),Lu(n)}function no(n,i){return Vu(n,null,null,i),Lu(n)}function Kv(n,i,r){n.lanes|=r;var u=n.alternate;u!==null&&(u.lanes|=r);for(var f=!1,p=n.return;p!==null;)p.childLanes|=r,u=p.alternate,u!==null&&(u.childLanes|=r),p.tag===22&&(n=p.stateNode,n===null||n._visibility&1||(f=!0)),n=p,p=p.return;return n.tag===3?(p=n.stateNode,f&&i!==null&&(f=31-on(r),n=p.hiddenUpdates,u=n[f],u===null?n[f]=[i]:u.push(i),i.lane=r|536870912),p):null}function Lu(n){if(50<nc)throw nc=0,Im=null,Error(a(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var so={};function cS(n,i,r,u){this.tag=n,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(n,i,r,u){return new cS(n,i,r,u)}function xf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function ri(n,i){var r=n.alternate;return r===null?(r=On(n.tag,i,n.key,n.mode),r.elementType=n.elementType,r.type=n.type,r.stateNode=n.stateNode,r.alternate=n,n.alternate=r):(r.pendingProps=i,r.type=n.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=n.flags&65011712,r.childLanes=n.childLanes,r.lanes=n.lanes,r.child=n.child,r.memoizedProps=n.memoizedProps,r.memoizedState=n.memoizedState,r.updateQueue=n.updateQueue,i=n.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},r.sibling=n.sibling,r.index=n.index,r.ref=n.ref,r.refCleanup=n.refCleanup,r}function Yv(n,i){n.flags&=65011714;var r=n.alternate;return r===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=r.childLanes,n.lanes=r.lanes,n.child=r.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=r.memoizedProps,n.memoizedState=r.memoizedState,n.updateQueue=r.updateQueue,n.type=r.type,i=r.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function Uu(n,i,r,u,f,p){var b=0;if(u=n,typeof n=="function")xf(n)&&(b=1);else if(typeof n=="string")b=dw(n,r,Te.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case j:return n=On(31,r,i,f),n.elementType=j,n.lanes=p,n;case w:return sr(r.children,f,p,i);case F:b=8,f|=24;break;case A:return n=On(12,r,i,f|2),n.elementType=A,n.lanes=p,n;case z:return n=On(13,r,i,f),n.elementType=z,n.lanes=p,n;case ae:return n=On(19,r,i,f),n.elementType=ae,n.lanes=p,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case L:case H:b=10;break e;case W:b=9;break e;case U:b=11;break e;case O:b=14;break e;case x:b=16,u=null;break e}b=29,r=Error(a(130,n===null?"null":typeof n,"")),u=null}return i=On(b,r,i,f),i.elementType=n,i.type=u,i.lanes=p,i}function sr(n,i,r,u){return n=On(7,n,u,i),n.lanes=r,n}function Af(n,i,r){return n=On(6,n,null,i),n.lanes=r,n}function Sf(n,i,r){return i=On(4,n.children!==null?n.children:[],n.key,i),i.lanes=r,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var io=[],ao=0,Fu=null,qu=0,Jn=[],es=0,ir=null,oi=1,li="";function ar(n,i){io[ao++]=qu,io[ao++]=Fu,Fu=n,qu=i}function Qv(n,i,r){Jn[es++]=oi,Jn[es++]=li,Jn[es++]=ir,ir=n;var u=oi;n=li;var f=32-on(u)-1;u&=~(1<<f),r+=1;var p=32-on(i)+f;if(30<p){var b=f-f%5;p=(u&(1<<b)-1).toString(32),u>>=b,f-=b,oi=1<<32-on(i)+f|r<<f|u,li=p+n}else oi=1<<p|r<<f|u,li=n}function wf(n){n.return!==null&&(ar(n,1),Qv(n,1,0))}function Cf(n){for(;n===Fu;)Fu=io[--ao],io[ao]=null,qu=io[--ao],io[ao]=null;for(;n===ir;)ir=Jn[--es],Jn[es]=null,li=Jn[--es],Jn[es]=null,oi=Jn[--es],Jn[es]=null}var yn=null,vt=null,Qe=!1,rr=null,Os=!1,If=Error(a(519));function or(n){var i=Error(a(418,""));throw Ml(Wn(i,n)),If}function Xv(n){var i=n.stateNode,r=n.type,u=n.memoizedProps;switch(i[Rt]=n,i[At]=u,r){case"dialog":Le("cancel",i),Le("close",i);break;case"iframe":case"object":case"embed":Le("load",i);break;case"video":case"audio":for(r=0;r<ic.length;r++)Le(ic[r],i);break;case"source":Le("error",i);break;case"img":case"image":case"link":Le("error",i),Le("load",i);break;case"details":Le("toggle",i);break;case"input":Le("invalid",i),Ga(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Br(i);break;case"select":Le("invalid",i);break;case"textarea":Le("invalid",i),$a(i,u.value,u.defaultValue,u.children),Br(i)}r=u.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||i.textContent===""+r||u.suppressHydrationWarning===!0||fE(i.textContent,r)?(u.popover!=null&&(Le("beforetoggle",i),Le("toggle",i)),u.onScroll!=null&&Le("scroll",i),u.onScrollEnd!=null&&Le("scrollend",i),u.onClick!=null&&(i.onclick=bd),i=!0):i=!1,i||or(n)}function Wv(n){for(yn=n.return;yn;)switch(yn.tag){case 5:case 13:Os=!1;return;case 27:case 3:Os=!0;return;default:yn=yn.return}}function Dl(n){if(n!==yn)return!1;if(!Qe)return Wv(n),Qe=!0,!1;var i=n.tag,r;if((r=i!==3&&i!==27)&&((r=i===5)&&(r=n.type,r=!(r!=="form"&&r!=="button")||Gm(n.type,n.memoizedProps)),r=!r),r&&vt&&or(n),Wv(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));e:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8)if(r=n.data,r==="/$"){if(i===0){vt=hs(n.nextSibling);break e}i--}else r!=="$"&&r!=="$!"&&r!=="$?"||i++;n=n.nextSibling}vt=null}}else i===27?(i=vt,Zi(n.type)?(n=Qm,Qm=null,vt=n):vt=i):vt=yn?hs(n.stateNode.nextSibling):null;return!0}function Ol(){vt=yn=null,Qe=!1}function Zv(){var n=rr;return n!==null&&(Sn===null?Sn=n:Sn.push.apply(Sn,n),rr=null),n}function Ml(n){rr===null?rr=[n]:rr.push(n)}var jf=ee(null),lr=null,ci=null;function Vi(n,i,r){ue(jf,i._currentValue),i._currentValue=r}function ui(n){n._currentValue=jf.current,he(jf)}function Rf(n,i,r){for(;n!==null;){var u=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),n===r)break;n=n.return}}function Df(n,i,r,u){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var p=f.dependencies;if(p!==null){var b=f.child;p=p.firstContext;e:for(;p!==null;){var S=p;p=f;for(var k=0;k<i.length;k++)if(S.context===i[k]){p.lanes|=r,S=p.alternate,S!==null&&(S.lanes|=r),Rf(p.return,r,n),u||(b=null);break e}p=S.next}}else if(f.tag===18){if(b=f.return,b===null)throw Error(a(341));b.lanes|=r,p=b.alternate,p!==null&&(p.lanes|=r),Rf(b,r,n),b=null}else b=f.child;if(b!==null)b.return=f;else for(b=f;b!==null;){if(b===n){b=null;break}if(f=b.sibling,f!==null){f.return=b.return,b=f;break}b=b.return}f=b}}function Pl(n,i,r,u){n=null;for(var f=i,p=!1;f!==null;){if(!p){if((f.flags&524288)!==0)p=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var b=f.alternate;if(b===null)throw Error(a(387));if(b=b.memoizedProps,b!==null){var S=f.type;Dn(f.pendingProps.value,b.value)||(n!==null?n.push(S):n=[S])}}else if(f===Ut.current){if(b=f.alternate,b===null)throw Error(a(387));b.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(uc):n=[uc])}f=f.return}n!==null&&Df(i,n,r,u),i.flags|=262144}function zu(n){for(n=n.firstContext;n!==null;){if(!Dn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function cr(n){lr=n,ci=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function ln(n){return Jv(lr,n)}function Bu(n,i){return lr===null&&cr(n),Jv(n,i)}function Jv(n,i){var r=i._currentValue;if(i={context:i,memoizedValue:r,next:null},ci===null){if(n===null)throw Error(a(308));ci=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else ci=ci.next=i;return r}var uS=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(r,u){n.push(u)}};this.abort=function(){i.aborted=!0,n.forEach(function(r){return r()})}},dS=s.unstable_scheduleCallback,hS=s.unstable_NormalPriority,Mt={$$typeof:H,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Of(){return{controller:new uS,data:new Map,refCount:0}}function kl(n){n.refCount--,n.refCount===0&&dS(hS,function(){n.controller.abort()})}var Vl=null,Mf=0,ro=0,oo=null;function fS(n,i){if(Vl===null){var r=Vl=[];Mf=0,ro=km(),oo={status:"pending",value:void 0,then:function(u){r.push(u)}}}return Mf++,i.then(ey,ey),i}function ey(){if(--Mf===0&&Vl!==null){oo!==null&&(oo.status="fulfilled");var n=Vl;Vl=null,ro=0,oo=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function mS(n,i){var r=[],u={status:"pending",value:null,reason:null,then:function(f){r.push(f)}};return n.then(function(){u.status="fulfilled",u.value=i;for(var f=0;f<r.length;f++)(0,r[f])(i)},function(f){for(u.status="rejected",u.reason=f,f=0;f<r.length;f++)(0,r[f])(void 0)}),u}var ty=G.S;G.S=function(n,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&fS(n,i),ty!==null&&ty(n,i)};var ur=ee(null);function Pf(){var n=ur.current;return n!==null?n:lt.pooledCache}function Hu(n,i){i===null?ue(ur,ur.current):ue(ur,i.pool)}function ny(){var n=Pf();return n===null?null:{parent:Mt._currentValue,pool:n}}var Ll=Error(a(460)),sy=Error(a(474)),Gu=Error(a(542)),kf={then:function(){}};function iy(n){return n=n.status,n==="fulfilled"||n==="rejected"}function $u(){}function ay(n,i,r){switch(r=n[r],r===void 0?n.push(i):r!==i&&(i.then($u,$u),i=r),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,oy(n),n;default:if(typeof i.status=="string")i.then($u,$u);else{if(n=lt,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=i,n.status="pending",n.then(function(u){if(i.status==="pending"){var f=i;f.status="fulfilled",f.value=u}},function(u){if(i.status==="pending"){var f=i;f.status="rejected",f.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,oy(n),n}throw Ul=i,Ll}}var Ul=null;function ry(){if(Ul===null)throw Error(a(459));var n=Ul;return Ul=null,n}function oy(n){if(n===Ll||n===Gu)throw Error(a(483))}var Li=!1;function Vf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Lf(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ui(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Fi(n,i,r){var u=n.updateQueue;if(u===null)return null;if(u=u.shared,(Ze&2)!==0){var f=u.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),u.pending=i,i=Lu(n),Kv(n,null,r),i}return Vu(n,u,i,r),Lu(n)}function Fl(n,i,r){if(i=i.updateQueue,i!==null&&(i=i.shared,(r&4194048)!==0)){var u=i.lanes;u&=n.pendingLanes,r|=u,i.lanes=r,ml(n,r)}}function Uf(n,i){var r=n.updateQueue,u=n.alternate;if(u!==null&&(u=u.updateQueue,r===u)){var f=null,p=null;if(r=r.firstBaseUpdate,r!==null){do{var b={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};p===null?f=p=b:p=p.next=b,r=r.next}while(r!==null);p===null?f=p=i:p=p.next=i}else f=p=i;r={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:u.shared,callbacks:u.callbacks},n.updateQueue=r;return}n=r.lastBaseUpdate,n===null?r.firstBaseUpdate=i:n.next=i,r.lastBaseUpdate=i}var Ff=!1;function ql(){if(Ff){var n=oo;if(n!==null)throw n}}function zl(n,i,r,u){Ff=!1;var f=n.updateQueue;Li=!1;var p=f.firstBaseUpdate,b=f.lastBaseUpdate,S=f.shared.pending;if(S!==null){f.shared.pending=null;var k=S,Y=k.next;k.next=null,b===null?p=Y:b.next=Y,b=k;var te=n.alternate;te!==null&&(te=te.updateQueue,S=te.lastBaseUpdate,S!==b&&(S===null?te.firstBaseUpdate=Y:S.next=Y,te.lastBaseUpdate=k))}if(p!==null){var oe=f.baseState;b=0,te=Y=k=null,S=p;do{var Q=S.lane&-536870913,X=Q!==S.lane;if(X?(Ge&Q)===Q:(u&Q)===Q){Q!==0&&Q===ro&&(Ff=!0),te!==null&&(te=te.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var Ce=n,xe=S;Q=i;var it=r;switch(xe.tag){case 1:if(Ce=xe.payload,typeof Ce=="function"){oe=Ce.call(it,oe,Q);break e}oe=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=xe.payload,Q=typeof Ce=="function"?Ce.call(it,oe,Q):Ce,Q==null)break e;oe=_({},oe,Q);break e;case 2:Li=!0}}Q=S.callback,Q!==null&&(n.flags|=64,X&&(n.flags|=8192),X=f.callbacks,X===null?f.callbacks=[Q]:X.push(Q))}else X={lane:Q,tag:S.tag,payload:S.payload,callback:S.callback,next:null},te===null?(Y=te=X,k=oe):te=te.next=X,b|=Q;if(S=S.next,S===null){if(S=f.shared.pending,S===null)break;X=S,S=X.next,X.next=null,f.lastBaseUpdate=X,f.shared.pending=null}}while(!0);te===null&&(k=oe),f.baseState=k,f.firstBaseUpdate=Y,f.lastBaseUpdate=te,p===null&&(f.shared.lanes=0),Yi|=b,n.lanes=b,n.memoizedState=oe}}function ly(n,i){if(typeof n!="function")throw Error(a(191,n));n.call(i)}function cy(n,i){var r=n.callbacks;if(r!==null)for(n.callbacks=null,n=0;n<r.length;n++)ly(r[n],i)}var lo=ee(null),Ku=ee(0);function uy(n,i){n=vi,ue(Ku,n),ue(lo,i),vi=n|i.baseLanes}function qf(){ue(Ku,vi),ue(lo,lo.current)}function zf(){vi=Ku.current,he(lo),he(Ku)}var qi=0,Oe=null,nt=null,wt=null,Yu=!1,co=!1,dr=!1,Qu=0,Bl=0,uo=null,pS=0;function bt(){throw Error(a(321))}function Bf(n,i){if(i===null)return!1;for(var r=0;r<i.length&&r<n.length;r++)if(!Dn(n[r],i[r]))return!1;return!0}function Hf(n,i,r,u,f,p){return qi=p,Oe=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,G.H=n===null||n.memoizedState===null?Ky:Yy,dr=!1,p=r(u,f),dr=!1,co&&(p=hy(i,r,u,f)),dy(n),p}function dy(n){G.H=td;var i=nt!==null&&nt.next!==null;if(qi=0,wt=nt=Oe=null,Yu=!1,Bl=0,uo=null,i)throw Error(a(300));n===null||zt||(n=n.dependencies,n!==null&&zu(n)&&(zt=!0))}function hy(n,i,r,u){Oe=n;var f=0;do{if(co&&(uo=null),Bl=0,co=!1,25<=f)throw Error(a(301));if(f+=1,wt=nt=null,n.updateQueue!=null){var p=n.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}G.H=TS,p=i(r,u)}while(co);return p}function gS(){var n=G.H,i=n.useState()[0];return i=typeof i.then=="function"?Hl(i):i,n=n.useState()[0],(nt!==null?nt.memoizedState:null)!==n&&(Oe.flags|=1024),i}function Gf(){var n=Qu!==0;return Qu=0,n}function $f(n,i,r){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~r}function Kf(n){if(Yu){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Yu=!1}qi=0,wt=nt=Oe=null,co=!1,Bl=Qu=0,uo=null}function xn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?Oe.memoizedState=wt=n:wt=wt.next=n,wt}function Ct(){if(nt===null){var n=Oe.alternate;n=n!==null?n.memoizedState:null}else n=nt.next;var i=wt===null?Oe.memoizedState:wt.next;if(i!==null)wt=i,nt=n;else{if(n===null)throw Oe.alternate===null?Error(a(467)):Error(a(310));nt=n,n={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},wt===null?Oe.memoizedState=wt=n:wt=wt.next=n}return wt}function Yf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Hl(n){var i=Bl;return Bl+=1,uo===null&&(uo=[]),n=ay(uo,n,i),i=Oe,(wt===null?i.memoizedState:wt.next)===null&&(i=i.alternate,G.H=i===null||i.memoizedState===null?Ky:Yy),n}function Xu(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Hl(n);if(n.$$typeof===H)return ln(n)}throw Error(a(438,String(n)))}function Qf(n){var i=null,r=Oe.updateQueue;if(r!==null&&(i=r.memoCache),i==null){var u=Oe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(f){return f.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),r===null&&(r=Yf(),Oe.updateQueue=r),r.memoCache=i,r=i.data[i.index],r===void 0)for(r=i.data[i.index]=Array(n),u=0;u<n;u++)r[u]=R;return i.index++,r}function di(n,i){return typeof i=="function"?i(n):i}function Wu(n){var i=Ct();return Xf(i,nt,n)}function Xf(n,i,r){var u=n.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=r;var f=n.baseQueue,p=u.pending;if(p!==null){if(f!==null){var b=f.next;f.next=p.next,p.next=b}i.baseQueue=f=p,u.pending=null}if(p=n.baseState,f===null)n.memoizedState=p;else{i=f.next;var S=b=null,k=null,Y=i,te=!1;do{var oe=Y.lane&-536870913;if(oe!==Y.lane?(Ge&oe)===oe:(qi&oe)===oe){var Q=Y.revertLane;if(Q===0)k!==null&&(k=k.next={lane:0,revertLane:0,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),oe===ro&&(te=!0);else if((qi&Q)===Q){Y=Y.next,Q===ro&&(te=!0);continue}else oe={lane:0,revertLane:Y.revertLane,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},k===null?(S=k=oe,b=p):k=k.next=oe,Oe.lanes|=Q,Yi|=Q;oe=Y.action,dr&&r(p,oe),p=Y.hasEagerState?Y.eagerState:r(p,oe)}else Q={lane:oe,revertLane:Y.revertLane,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},k===null?(S=k=Q,b=p):k=k.next=Q,Oe.lanes|=oe,Yi|=oe;Y=Y.next}while(Y!==null&&Y!==i);if(k===null?b=p:k.next=S,!Dn(p,n.memoizedState)&&(zt=!0,te&&(r=oo,r!==null)))throw r;n.memoizedState=p,n.baseState=b,n.baseQueue=k,u.lastRenderedState=p}return f===null&&(u.lanes=0),[n.memoizedState,u.dispatch]}function Wf(n){var i=Ct(),r=i.queue;if(r===null)throw Error(a(311));r.lastRenderedReducer=n;var u=r.dispatch,f=r.pending,p=i.memoizedState;if(f!==null){r.pending=null;var b=f=f.next;do p=n(p,b.action),b=b.next;while(b!==f);Dn(p,i.memoizedState)||(zt=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),r.lastRenderedState=p}return[p,u]}function fy(n,i,r){var u=Oe,f=Ct(),p=Qe;if(p){if(r===void 0)throw Error(a(407));r=r()}else r=i();var b=!Dn((nt||f).memoizedState,r);b&&(f.memoizedState=r,zt=!0),f=f.queue;var S=gy.bind(null,u,f,n);if(Gl(2048,8,S,[n]),f.getSnapshot!==i||b||wt!==null&&wt.memoizedState.tag&1){if(u.flags|=2048,ho(9,Zu(),py.bind(null,u,f,r,i),null),lt===null)throw Error(a(349));p||(qi&124)!==0||my(u,i,r)}return r}function my(n,i,r){n.flags|=16384,n={getSnapshot:i,value:r},i=Oe.updateQueue,i===null?(i=Yf(),Oe.updateQueue=i,i.stores=[n]):(r=i.stores,r===null?i.stores=[n]:r.push(n))}function py(n,i,r,u){i.value=r,i.getSnapshot=u,vy(i)&&yy(n)}function gy(n,i,r){return r(function(){vy(i)&&yy(n)})}function vy(n){var i=n.getSnapshot;n=n.value;try{var r=i();return!Dn(n,r)}catch{return!0}}function yy(n){var i=no(n,2);i!==null&&Ln(i,n,2)}function Zf(n){var i=xn();if(typeof n=="function"){var r=n;if(n=r(),dr){jn(!0);try{r()}finally{jn(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:di,lastRenderedState:n},i}function _y(n,i,r,u){return n.baseState=r,Xf(n,nt,typeof u=="function"?u:di)}function vS(n,i,r,u,f){if(ed(n))throw Error(a(485));if(n=i.action,n!==null){var p={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){p.listeners.push(b)}};G.T!==null?r(!0):p.isTransition=!1,u(p),r=i.pending,r===null?(p.next=i.pending=p,Ey(i,p)):(p.next=r.next,i.pending=r.next=p)}}function Ey(n,i){var r=i.action,u=i.payload,f=n.state;if(i.isTransition){var p=G.T,b={};G.T=b;try{var S=r(f,u),k=G.S;k!==null&&k(b,S),by(n,i,S)}catch(Y){Jf(n,i,Y)}finally{G.T=p}}else try{p=r(f,u),by(n,i,p)}catch(Y){Jf(n,i,Y)}}function by(n,i,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(u){Ty(n,i,u)},function(u){return Jf(n,i,u)}):Ty(n,i,r)}function Ty(n,i,r){i.status="fulfilled",i.value=r,Ny(i),n.state=r,i=n.pending,i!==null&&(r=i.next,r===i?n.pending=null:(r=r.next,i.next=r,Ey(n,r)))}function Jf(n,i,r){var u=n.pending;if(n.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=r,Ny(i),i=i.next;while(i!==u)}n.action=null}function Ny(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function xy(n,i){return i}function Ay(n,i){if(Qe){var r=lt.formState;if(r!==null){e:{var u=Oe;if(Qe){if(vt){t:{for(var f=vt,p=Os;f.nodeType!==8;){if(!p){f=null;break t}if(f=hs(f.nextSibling),f===null){f=null;break t}}p=f.data,f=p==="F!"||p==="F"?f:null}if(f){vt=hs(f.nextSibling),u=f.data==="F!";break e}}or(u)}u=!1}u&&(i=r[0])}}return r=xn(),r.memoizedState=r.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xy,lastRenderedState:i},r.queue=u,r=Hy.bind(null,Oe,u),u.dispatch=r,u=Zf(!1),p=im.bind(null,Oe,!1,u.queue),u=xn(),f={state:i,dispatch:null,action:n,pending:null},u.queue=f,r=vS.bind(null,Oe,f,p,r),f.dispatch=r,u.memoizedState=n,[i,r,!1]}function Sy(n){var i=Ct();return wy(i,nt,n)}function wy(n,i,r){if(i=Xf(n,i,xy)[0],n=Wu(di)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Hl(i)}catch(b){throw b===Ll?Gu:b}else u=i;i=Ct();var f=i.queue,p=f.dispatch;return r!==i.memoizedState&&(Oe.flags|=2048,ho(9,Zu(),yS.bind(null,f,r),null)),[u,p,n]}function yS(n,i){n.action=i}function Cy(n){var i=Ct(),r=nt;if(r!==null)return wy(i,r,n);Ct(),i=i.memoizedState,r=Ct();var u=r.queue.dispatch;return r.memoizedState=n,[i,u,!1]}function ho(n,i,r,u){return n={tag:n,create:r,deps:u,inst:i,next:null},i=Oe.updateQueue,i===null&&(i=Yf(),Oe.updateQueue=i),r=i.lastEffect,r===null?i.lastEffect=n.next=n:(u=r.next,r.next=n,n.next=u,i.lastEffect=n),n}function Zu(){return{destroy:void 0,resource:void 0}}function Iy(){return Ct().memoizedState}function Ju(n,i,r,u){var f=xn();u=u===void 0?null:u,Oe.flags|=n,f.memoizedState=ho(1|i,Zu(),r,u)}function Gl(n,i,r,u){var f=Ct();u=u===void 0?null:u;var p=f.memoizedState.inst;nt!==null&&u!==null&&Bf(u,nt.memoizedState.deps)?f.memoizedState=ho(i,p,r,u):(Oe.flags|=n,f.memoizedState=ho(1|i,p,r,u))}function jy(n,i){Ju(8390656,8,n,i)}function Ry(n,i){Gl(2048,8,n,i)}function Dy(n,i){return Gl(4,2,n,i)}function Oy(n,i){return Gl(4,4,n,i)}function My(n,i){if(typeof i=="function"){n=n();var r=i(n);return function(){typeof r=="function"?r():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function Py(n,i,r){r=r!=null?r.concat([n]):null,Gl(4,4,My.bind(null,i,n),r)}function em(){}function ky(n,i){var r=Ct();i=i===void 0?null:i;var u=r.memoizedState;return i!==null&&Bf(i,u[1])?u[0]:(r.memoizedState=[n,i],n)}function Vy(n,i){var r=Ct();i=i===void 0?null:i;var u=r.memoizedState;if(i!==null&&Bf(i,u[1]))return u[0];if(u=n(),dr){jn(!0);try{n()}finally{jn(!1)}}return r.memoizedState=[u,i],u}function tm(n,i,r){return r===void 0||(qi&1073741824)!==0?n.memoizedState=i:(n.memoizedState=r,n=F_(),Oe.lanes|=n,Yi|=n,r)}function Ly(n,i,r,u){return Dn(r,i)?r:lo.current!==null?(n=tm(n,r,u),Dn(n,i)||(zt=!0),n):(qi&42)===0?(zt=!0,n.memoizedState=r):(n=F_(),Oe.lanes|=n,Yi|=n,i)}function Uy(n,i,r,u,f){var p=ne.p;ne.p=p!==0&&8>p?p:8;var b=G.T,S={};G.T=S,im(n,!1,i,r);try{var k=f(),Y=G.S;if(Y!==null&&Y(S,k),k!==null&&typeof k=="object"&&typeof k.then=="function"){var te=mS(k,u);$l(n,i,te,Vn(n))}else $l(n,i,u,Vn(n))}catch(oe){$l(n,i,{then:function(){},status:"rejected",reason:oe},Vn())}finally{ne.p=p,G.T=b}}function _S(){}function nm(n,i,r,u){if(n.tag!==5)throw Error(a(476));var f=Fy(n).queue;Uy(n,f,i,ce,r===null?_S:function(){return qy(n),r(u)})}function Fy(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:di,lastRenderedState:ce},next:null};var r={};return i.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:di,lastRenderedState:r},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function qy(n){var i=Fy(n).next.queue;$l(n,i,{},Vn())}function sm(){return ln(uc)}function zy(){return Ct().memoizedState}function By(){return Ct().memoizedState}function ES(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var r=Vn();n=Ui(r);var u=Fi(i,n,r);u!==null&&(Ln(u,i,r),Fl(u,i,r)),i={cache:Of()},n.payload=i;return}i=i.return}}function bS(n,i,r){var u=Vn();r={lane:u,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},ed(n)?Gy(i,r):(r=Nf(n,i,r,u),r!==null&&(Ln(r,n,u),$y(r,i,u)))}function Hy(n,i,r){var u=Vn();$l(n,i,r,u)}function $l(n,i,r,u){var f={lane:u,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(ed(n))Gy(i,f);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var b=i.lastRenderedState,S=p(b,r);if(f.hasEagerState=!0,f.eagerState=S,Dn(S,b))return Vu(n,i,f,0),lt===null&&ku(),!1}catch{}finally{}if(r=Nf(n,i,f,u),r!==null)return Ln(r,n,u),$y(r,i,u),!0}return!1}function im(n,i,r,u){if(u={lane:2,revertLane:km(),action:u,hasEagerState:!1,eagerState:null,next:null},ed(n)){if(i)throw Error(a(479))}else i=Nf(n,r,u,2),i!==null&&Ln(i,n,2)}function ed(n){var i=n.alternate;return n===Oe||i!==null&&i===Oe}function Gy(n,i){co=Yu=!0;var r=n.pending;r===null?i.next=i:(i.next=r.next,r.next=i),n.pending=i}function $y(n,i,r){if((r&4194048)!==0){var u=i.lanes;u&=n.pendingLanes,r|=u,i.lanes=r,ml(n,r)}}var td={readContext:ln,use:Xu,useCallback:bt,useContext:bt,useEffect:bt,useImperativeHandle:bt,useLayoutEffect:bt,useInsertionEffect:bt,useMemo:bt,useReducer:bt,useRef:bt,useState:bt,useDebugValue:bt,useDeferredValue:bt,useTransition:bt,useSyncExternalStore:bt,useId:bt,useHostTransitionStatus:bt,useFormState:bt,useActionState:bt,useOptimistic:bt,useMemoCache:bt,useCacheRefresh:bt},Ky={readContext:ln,use:Xu,useCallback:function(n,i){return xn().memoizedState=[n,i===void 0?null:i],n},useContext:ln,useEffect:jy,useImperativeHandle:function(n,i,r){r=r!=null?r.concat([n]):null,Ju(4194308,4,My.bind(null,i,n),r)},useLayoutEffect:function(n,i){return Ju(4194308,4,n,i)},useInsertionEffect:function(n,i){Ju(4,2,n,i)},useMemo:function(n,i){var r=xn();i=i===void 0?null:i;var u=n();if(dr){jn(!0);try{n()}finally{jn(!1)}}return r.memoizedState=[u,i],u},useReducer:function(n,i,r){var u=xn();if(r!==void 0){var f=r(i);if(dr){jn(!0);try{r(i)}finally{jn(!1)}}}else f=i;return u.memoizedState=u.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},u.queue=n,n=n.dispatch=bS.bind(null,Oe,n),[u.memoizedState,n]},useRef:function(n){var i=xn();return n={current:n},i.memoizedState=n},useState:function(n){n=Zf(n);var i=n.queue,r=Hy.bind(null,Oe,i);return i.dispatch=r,[n.memoizedState,r]},useDebugValue:em,useDeferredValue:function(n,i){var r=xn();return tm(r,n,i)},useTransition:function(){var n=Zf(!1);return n=Uy.bind(null,Oe,n.queue,!0,!1),xn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,r){var u=Oe,f=xn();if(Qe){if(r===void 0)throw Error(a(407));r=r()}else{if(r=i(),lt===null)throw Error(a(349));(Ge&124)!==0||my(u,i,r)}f.memoizedState=r;var p={value:r,getSnapshot:i};return f.queue=p,jy(gy.bind(null,u,p,n),[n]),u.flags|=2048,ho(9,Zu(),py.bind(null,u,p,r,i),null),r},useId:function(){var n=xn(),i=lt.identifierPrefix;if(Qe){var r=li,u=oi;r=(u&~(1<<32-on(u)-1)).toString(32)+r,i="«"+i+"R"+r,r=Qu++,0<r&&(i+="H"+r.toString(32)),i+="»"}else r=pS++,i="«"+i+"r"+r.toString(32)+"»";return n.memoizedState=i},useHostTransitionStatus:sm,useFormState:Ay,useActionState:Ay,useOptimistic:function(n){var i=xn();i.memoizedState=i.baseState=n;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=r,i=im.bind(null,Oe,!0,r),r.dispatch=i,[n,i]},useMemoCache:Qf,useCacheRefresh:function(){return xn().memoizedState=ES.bind(null,Oe)}},Yy={readContext:ln,use:Xu,useCallback:ky,useContext:ln,useEffect:Ry,useImperativeHandle:Py,useInsertionEffect:Dy,useLayoutEffect:Oy,useMemo:Vy,useReducer:Wu,useRef:Iy,useState:function(){return Wu(di)},useDebugValue:em,useDeferredValue:function(n,i){var r=Ct();return Ly(r,nt.memoizedState,n,i)},useTransition:function(){var n=Wu(di)[0],i=Ct().memoizedState;return[typeof n=="boolean"?n:Hl(n),i]},useSyncExternalStore:fy,useId:zy,useHostTransitionStatus:sm,useFormState:Sy,useActionState:Sy,useOptimistic:function(n,i){var r=Ct();return _y(r,nt,n,i)},useMemoCache:Qf,useCacheRefresh:By},TS={readContext:ln,use:Xu,useCallback:ky,useContext:ln,useEffect:Ry,useImperativeHandle:Py,useInsertionEffect:Dy,useLayoutEffect:Oy,useMemo:Vy,useReducer:Wf,useRef:Iy,useState:function(){return Wf(di)},useDebugValue:em,useDeferredValue:function(n,i){var r=Ct();return nt===null?tm(r,n,i):Ly(r,nt.memoizedState,n,i)},useTransition:function(){var n=Wf(di)[0],i=Ct().memoizedState;return[typeof n=="boolean"?n:Hl(n),i]},useSyncExternalStore:fy,useId:zy,useHostTransitionStatus:sm,useFormState:Cy,useActionState:Cy,useOptimistic:function(n,i){var r=Ct();return nt!==null?_y(r,nt,n,i):(r.baseState=n,[n,r.queue.dispatch])},useMemoCache:Qf,useCacheRefresh:By},fo=null,Kl=0;function nd(n){var i=Kl;return Kl+=1,fo===null&&(fo=[]),ay(fo,n,i)}function Yl(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function sd(n,i){throw i.$$typeof===T?Error(a(525)):(n=Object.prototype.toString.call(i),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Qy(n){var i=n._init;return i(n._payload)}function Xy(n){function i(B,q){if(n){var K=B.deletions;K===null?(B.deletions=[q],B.flags|=16):K.push(q)}}function r(B,q){if(!n)return null;for(;q!==null;)i(B,q),q=q.sibling;return null}function u(B){for(var q=new Map;B!==null;)B.key!==null?q.set(B.key,B):q.set(B.index,B),B=B.sibling;return q}function f(B,q){return B=ri(B,q),B.index=0,B.sibling=null,B}function p(B,q,K){return B.index=K,n?(K=B.alternate,K!==null?(K=K.index,K<q?(B.flags|=67108866,q):K):(B.flags|=67108866,q)):(B.flags|=1048576,q)}function b(B){return n&&B.alternate===null&&(B.flags|=67108866),B}function S(B,q,K,se){return q===null||q.tag!==6?(q=Af(K,B.mode,se),q.return=B,q):(q=f(q,K),q.return=B,q)}function k(B,q,K,se){var pe=K.type;return pe===w?te(B,q,K.props.children,se,K.key):q!==null&&(q.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===x&&Qy(pe)===q.type)?(q=f(q,K.props),Yl(q,K),q.return=B,q):(q=Uu(K.type,K.key,K.props,null,B.mode,se),Yl(q,K),q.return=B,q)}function Y(B,q,K,se){return q===null||q.tag!==4||q.stateNode.containerInfo!==K.containerInfo||q.stateNode.implementation!==K.implementation?(q=Sf(K,B.mode,se),q.return=B,q):(q=f(q,K.children||[]),q.return=B,q)}function te(B,q,K,se,pe){return q===null||q.tag!==7?(q=sr(K,B.mode,se,pe),q.return=B,q):(q=f(q,K),q.return=B,q)}function oe(B,q,K){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=Af(""+q,B.mode,K),q.return=B,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case N:return K=Uu(q.type,q.key,q.props,null,B.mode,K),Yl(K,q),K.return=B,K;case C:return q=Sf(q,B.mode,K),q.return=B,q;case x:var se=q._init;return q=se(q._payload),oe(B,q,K)}if(ye(q)||M(q))return q=sr(q,B.mode,K,null),q.return=B,q;if(typeof q.then=="function")return oe(B,nd(q),K);if(q.$$typeof===H)return oe(B,Bu(B,q),K);sd(B,q)}return null}function Q(B,q,K,se){var pe=q!==null?q.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return pe!==null?null:S(B,q,""+K,se);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case N:return K.key===pe?k(B,q,K,se):null;case C:return K.key===pe?Y(B,q,K,se):null;case x:return pe=K._init,K=pe(K._payload),Q(B,q,K,se)}if(ye(K)||M(K))return pe!==null?null:te(B,q,K,se,null);if(typeof K.then=="function")return Q(B,q,nd(K),se);if(K.$$typeof===H)return Q(B,q,Bu(B,K),se);sd(B,K)}return null}function X(B,q,K,se,pe){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return B=B.get(K)||null,S(q,B,""+se,pe);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case N:return B=B.get(se.key===null?K:se.key)||null,k(q,B,se,pe);case C:return B=B.get(se.key===null?K:se.key)||null,Y(q,B,se,pe);case x:var ke=se._init;return se=ke(se._payload),X(B,q,K,se,pe)}if(ye(se)||M(se))return B=B.get(K)||null,te(q,B,se,pe,null);if(typeof se.then=="function")return X(B,q,K,nd(se),pe);if(se.$$typeof===H)return X(B,q,K,Bu(q,se),pe);sd(q,se)}return null}function Ce(B,q,K,se){for(var pe=null,ke=null,_e=q,Ae=q=0,Ht=null;_e!==null&&Ae<K.length;Ae++){_e.index>Ae?(Ht=_e,_e=null):Ht=_e.sibling;var Ye=Q(B,_e,K[Ae],se);if(Ye===null){_e===null&&(_e=Ht);break}n&&_e&&Ye.alternate===null&&i(B,_e),q=p(Ye,q,Ae),ke===null?pe=Ye:ke.sibling=Ye,ke=Ye,_e=Ht}if(Ae===K.length)return r(B,_e),Qe&&ar(B,Ae),pe;if(_e===null){for(;Ae<K.length;Ae++)_e=oe(B,K[Ae],se),_e!==null&&(q=p(_e,q,Ae),ke===null?pe=_e:ke.sibling=_e,ke=_e);return Qe&&ar(B,Ae),pe}for(_e=u(_e);Ae<K.length;Ae++)Ht=X(_e,B,Ae,K[Ae],se),Ht!==null&&(n&&Ht.alternate!==null&&_e.delete(Ht.key===null?Ae:Ht.key),q=p(Ht,q,Ae),ke===null?pe=Ht:ke.sibling=Ht,ke=Ht);return n&&_e.forEach(function(sa){return i(B,sa)}),Qe&&ar(B,Ae),pe}function xe(B,q,K,se){if(K==null)throw Error(a(151));for(var pe=null,ke=null,_e=q,Ae=q=0,Ht=null,Ye=K.next();_e!==null&&!Ye.done;Ae++,Ye=K.next()){_e.index>Ae?(Ht=_e,_e=null):Ht=_e.sibling;var sa=Q(B,_e,Ye.value,se);if(sa===null){_e===null&&(_e=Ht);break}n&&_e&&sa.alternate===null&&i(B,_e),q=p(sa,q,Ae),ke===null?pe=sa:ke.sibling=sa,ke=sa,_e=Ht}if(Ye.done)return r(B,_e),Qe&&ar(B,Ae),pe;if(_e===null){for(;!Ye.done;Ae++,Ye=K.next())Ye=oe(B,Ye.value,se),Ye!==null&&(q=p(Ye,q,Ae),ke===null?pe=Ye:ke.sibling=Ye,ke=Ye);return Qe&&ar(B,Ae),pe}for(_e=u(_e);!Ye.done;Ae++,Ye=K.next())Ye=X(_e,B,Ae,Ye.value,se),Ye!==null&&(n&&Ye.alternate!==null&&_e.delete(Ye.key===null?Ae:Ye.key),q=p(Ye,q,Ae),ke===null?pe=Ye:ke.sibling=Ye,ke=Ye);return n&&_e.forEach(function(Nw){return i(B,Nw)}),Qe&&ar(B,Ae),pe}function it(B,q,K,se){if(typeof K=="object"&&K!==null&&K.type===w&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case N:e:{for(var pe=K.key;q!==null;){if(q.key===pe){if(pe=K.type,pe===w){if(q.tag===7){r(B,q.sibling),se=f(q,K.props.children),se.return=B,B=se;break e}}else if(q.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===x&&Qy(pe)===q.type){r(B,q.sibling),se=f(q,K.props),Yl(se,K),se.return=B,B=se;break e}r(B,q);break}else i(B,q);q=q.sibling}K.type===w?(se=sr(K.props.children,B.mode,se,K.key),se.return=B,B=se):(se=Uu(K.type,K.key,K.props,null,B.mode,se),Yl(se,K),se.return=B,B=se)}return b(B);case C:e:{for(pe=K.key;q!==null;){if(q.key===pe)if(q.tag===4&&q.stateNode.containerInfo===K.containerInfo&&q.stateNode.implementation===K.implementation){r(B,q.sibling),se=f(q,K.children||[]),se.return=B,B=se;break e}else{r(B,q);break}else i(B,q);q=q.sibling}se=Sf(K,B.mode,se),se.return=B,B=se}return b(B);case x:return pe=K._init,K=pe(K._payload),it(B,q,K,se)}if(ye(K))return Ce(B,q,K,se);if(M(K)){if(pe=M(K),typeof pe!="function")throw Error(a(150));return K=pe.call(K),xe(B,q,K,se)}if(typeof K.then=="function")return it(B,q,nd(K),se);if(K.$$typeof===H)return it(B,q,Bu(B,K),se);sd(B,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,q!==null&&q.tag===6?(r(B,q.sibling),se=f(q,K),se.return=B,B=se):(r(B,q),se=Af(K,B.mode,se),se.return=B,B=se),b(B)):r(B,q)}return function(B,q,K,se){try{Kl=0;var pe=it(B,q,K,se);return fo=null,pe}catch(_e){if(_e===Ll||_e===Gu)throw _e;var ke=On(29,_e,null,B.mode);return ke.lanes=se,ke.return=B,ke}finally{}}}var mo=Xy(!0),Wy=Xy(!1),ts=ee(null),Ms=null;function zi(n){var i=n.alternate;ue(Pt,Pt.current&1),ue(ts,n),Ms===null&&(i===null||lo.current!==null||i.memoizedState!==null)&&(Ms=n)}function Zy(n){if(n.tag===22){if(ue(Pt,Pt.current),ue(ts,n),Ms===null){var i=n.alternate;i!==null&&i.memoizedState!==null&&(Ms=n)}}else Bi()}function Bi(){ue(Pt,Pt.current),ue(ts,ts.current)}function hi(n){he(ts),Ms===n&&(Ms=null),he(Pt)}var Pt=ee(0);function id(n){for(var i=n;i!==null;){if(i.tag===13){var r=i.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||Ym(r)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function am(n,i,r,u){i=n.memoizedState,r=r(u,i),r=r==null?i:_({},i,r),n.memoizedState=r,n.lanes===0&&(n.updateQueue.baseState=r)}var rm={enqueueSetState:function(n,i,r){n=n._reactInternals;var u=Vn(),f=Ui(u);f.payload=i,r!=null&&(f.callback=r),i=Fi(n,f,u),i!==null&&(Ln(i,n,u),Fl(i,n,u))},enqueueReplaceState:function(n,i,r){n=n._reactInternals;var u=Vn(),f=Ui(u);f.tag=1,f.payload=i,r!=null&&(f.callback=r),i=Fi(n,f,u),i!==null&&(Ln(i,n,u),Fl(i,n,u))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var r=Vn(),u=Ui(r);u.tag=2,i!=null&&(u.callback=i),i=Fi(n,u,r),i!==null&&(Ln(i,n,r),Fl(i,n,r))}};function Jy(n,i,r,u,f,p,b){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(u,p,b):i.prototype&&i.prototype.isPureReactComponent?!jl(r,u)||!jl(f,p):!0}function e_(n,i,r,u){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(r,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(r,u),i.state!==n&&rm.enqueueReplaceState(i,i.state,null)}function hr(n,i){var r=i;if("ref"in i){r={};for(var u in i)u!=="ref"&&(r[u]=i[u])}if(n=n.defaultProps){r===i&&(r=_({},r));for(var f in n)r[f]===void 0&&(r[f]=n[f])}return r}var ad=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function t_(n){ad(n)}function n_(n){console.error(n)}function s_(n){ad(n)}function rd(n,i){try{var r=n.onUncaughtError;r(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function i_(n,i,r){try{var u=n.onCaughtError;u(r.value,{componentStack:r.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function om(n,i,r){return r=Ui(r),r.tag=3,r.payload={element:null},r.callback=function(){rd(n,i)},r}function a_(n){return n=Ui(n),n.tag=3,n}function r_(n,i,r,u){var f=r.type.getDerivedStateFromError;if(typeof f=="function"){var p=u.value;n.payload=function(){return f(p)},n.callback=function(){i_(i,r,u)}}var b=r.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(n.callback=function(){i_(i,r,u),typeof f!="function"&&(Qi===null?Qi=new Set([this]):Qi.add(this));var S=u.stack;this.componentDidCatch(u.value,{componentStack:S!==null?S:""})})}function NS(n,i,r,u,f){if(r.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=r.alternate,i!==null&&Pl(i,r,f,!0),r=ts.current,r!==null){switch(r.tag){case 13:return Ms===null?Rm():r.alternate===null&&yt===0&&(yt=3),r.flags&=-257,r.flags|=65536,r.lanes=f,u===kf?r.flags|=16384:(i=r.updateQueue,i===null?r.updateQueue=new Set([u]):i.add(u),Om(n,u,f)),!1;case 22:return r.flags|=65536,u===kf?r.flags|=16384:(i=r.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},r.updateQueue=i):(r=i.retryQueue,r===null?i.retryQueue=new Set([u]):r.add(u)),Om(n,u,f)),!1}throw Error(a(435,r.tag))}return Om(n,u,f),Rm(),!1}if(Qe)return i=ts.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=f,u!==If&&(n=Error(a(422),{cause:u}),Ml(Wn(n,r)))):(u!==If&&(i=Error(a(423),{cause:u}),Ml(Wn(i,r))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,u=Wn(u,r),f=om(n.stateNode,u,f),Uf(n,f),yt!==4&&(yt=2)),!1;var p=Error(a(520),{cause:u});if(p=Wn(p,r),tc===null?tc=[p]:tc.push(p),yt!==4&&(yt=2),i===null)return!0;u=Wn(u,r),r=i;do{switch(r.tag){case 3:return r.flags|=65536,n=f&-f,r.lanes|=n,n=om(r.stateNode,u,n),Uf(r,n),!1;case 1:if(i=r.type,p=r.stateNode,(r.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Qi===null||!Qi.has(p))))return r.flags|=65536,f&=-f,r.lanes|=f,f=a_(f),r_(f,n,r,u),Uf(r,f),!1}r=r.return}while(r!==null);return!1}var o_=Error(a(461)),zt=!1;function Qt(n,i,r,u){i.child=n===null?Wy(i,null,r,u):mo(i,n.child,r,u)}function l_(n,i,r,u,f){r=r.render;var p=i.ref;if("ref"in u){var b={};for(var S in u)S!=="ref"&&(b[S]=u[S])}else b=u;return cr(i),u=Hf(n,i,r,b,p,f),S=Gf(),n!==null&&!zt?($f(n,i,f),fi(n,i,f)):(Qe&&S&&wf(i),i.flags|=1,Qt(n,i,u,f),i.child)}function c_(n,i,r,u,f){if(n===null){var p=r.type;return typeof p=="function"&&!xf(p)&&p.defaultProps===void 0&&r.compare===null?(i.tag=15,i.type=p,u_(n,i,p,u,f)):(n=Uu(r.type,null,u,i,i.mode,f),n.ref=i.ref,n.return=i,i.child=n)}if(p=n.child,!pm(n,f)){var b=p.memoizedProps;if(r=r.compare,r=r!==null?r:jl,r(b,u)&&n.ref===i.ref)return fi(n,i,f)}return i.flags|=1,n=ri(p,u),n.ref=i.ref,n.return=i,i.child=n}function u_(n,i,r,u,f){if(n!==null){var p=n.memoizedProps;if(jl(p,u)&&n.ref===i.ref)if(zt=!1,i.pendingProps=u=p,pm(n,f))(n.flags&131072)!==0&&(zt=!0);else return i.lanes=n.lanes,fi(n,i,f)}return lm(n,i,r,u,f)}function d_(n,i,r){var u=i.pendingProps,f=u.children,p=n!==null?n.memoizedState:null;if(u.mode==="hidden"){if((i.flags&128)!==0){if(u=p!==null?p.baseLanes|r:r,n!==null){for(f=i.child=n.child,p=0;f!==null;)p=p|f.lanes|f.childLanes,f=f.sibling;i.childLanes=p&~u}else i.childLanes=0,i.child=null;return h_(n,i,u,r)}if((r&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&Hu(i,p!==null?p.cachePool:null),p!==null?uy(i,p):qf(),Zy(i);else return i.lanes=i.childLanes=536870912,h_(n,i,p!==null?p.baseLanes|r:r,r)}else p!==null?(Hu(i,p.cachePool),uy(i,p),Bi(),i.memoizedState=null):(n!==null&&Hu(i,null),qf(),Bi());return Qt(n,i,f,r),i.child}function h_(n,i,r,u){var f=Pf();return f=f===null?null:{parent:Mt._currentValue,pool:f},i.memoizedState={baseLanes:r,cachePool:f},n!==null&&Hu(i,null),qf(),Zy(i),n!==null&&Pl(n,i,u,!0),null}function od(n,i){var r=i.ref;if(r===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(a(284));(n===null||n.ref!==r)&&(i.flags|=4194816)}}function lm(n,i,r,u,f){return cr(i),r=Hf(n,i,r,u,void 0,f),u=Gf(),n!==null&&!zt?($f(n,i,f),fi(n,i,f)):(Qe&&u&&wf(i),i.flags|=1,Qt(n,i,r,f),i.child)}function f_(n,i,r,u,f,p){return cr(i),i.updateQueue=null,r=hy(i,u,r,f),dy(n),u=Gf(),n!==null&&!zt?($f(n,i,p),fi(n,i,p)):(Qe&&u&&wf(i),i.flags|=1,Qt(n,i,r,p),i.child)}function m_(n,i,r,u,f){if(cr(i),i.stateNode===null){var p=so,b=r.contextType;typeof b=="object"&&b!==null&&(p=ln(b)),p=new r(u,p),i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=rm,i.stateNode=p,p._reactInternals=i,p=i.stateNode,p.props=u,p.state=i.memoizedState,p.refs={},Vf(i),b=r.contextType,p.context=typeof b=="object"&&b!==null?ln(b):so,p.state=i.memoizedState,b=r.getDerivedStateFromProps,typeof b=="function"&&(am(i,r,b,u),p.state=i.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(b=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),b!==p.state&&rm.enqueueReplaceState(p,p.state,null),zl(i,u,p,f),ql(),p.state=i.memoizedState),typeof p.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(n===null){p=i.stateNode;var S=i.memoizedProps,k=hr(r,S);p.props=k;var Y=p.context,te=r.contextType;b=so,typeof te=="object"&&te!==null&&(b=ln(te));var oe=r.getDerivedStateFromProps;te=typeof oe=="function"||typeof p.getSnapshotBeforeUpdate=="function",S=i.pendingProps!==S,te||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S||Y!==b)&&e_(i,p,u,b),Li=!1;var Q=i.memoizedState;p.state=Q,zl(i,u,p,f),ql(),Y=i.memoizedState,S||Q!==Y||Li?(typeof oe=="function"&&(am(i,r,oe,u),Y=i.memoizedState),(k=Li||Jy(i,r,k,u,Q,Y,b))?(te||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(i.flags|=4194308)):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=Y),p.props=u,p.state=Y,p.context=b,u=k):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{p=i.stateNode,Lf(n,i),b=i.memoizedProps,te=hr(r,b),p.props=te,oe=i.pendingProps,Q=p.context,Y=r.contextType,k=so,typeof Y=="object"&&Y!==null&&(k=ln(Y)),S=r.getDerivedStateFromProps,(Y=typeof S=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(b!==oe||Q!==k)&&e_(i,p,u,k),Li=!1,Q=i.memoizedState,p.state=Q,zl(i,u,p,f),ql();var X=i.memoizedState;b!==oe||Q!==X||Li||n!==null&&n.dependencies!==null&&zu(n.dependencies)?(typeof S=="function"&&(am(i,r,S,u),X=i.memoizedState),(te=Li||Jy(i,r,te,u,Q,X,k)||n!==null&&n.dependencies!==null&&zu(n.dependencies))?(Y||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(u,X,k),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(u,X,k)),typeof p.componentDidUpdate=="function"&&(i.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof p.componentDidUpdate!="function"||b===n.memoizedProps&&Q===n.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===n.memoizedProps&&Q===n.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=X),p.props=u,p.state=X,p.context=k,u=te):(typeof p.componentDidUpdate!="function"||b===n.memoizedProps&&Q===n.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===n.memoizedProps&&Q===n.memoizedState||(i.flags|=1024),u=!1)}return p=u,od(n,i),u=(i.flags&128)!==0,p||u?(p=i.stateNode,r=u&&typeof r.getDerivedStateFromError!="function"?null:p.render(),i.flags|=1,n!==null&&u?(i.child=mo(i,n.child,null,f),i.child=mo(i,null,r,f)):Qt(n,i,r,f),i.memoizedState=p.state,n=i.child):n=fi(n,i,f),n}function p_(n,i,r,u){return Ol(),i.flags|=256,Qt(n,i,r,u),i.child}var cm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function um(n){return{baseLanes:n,cachePool:ny()}}function dm(n,i,r){return n=n!==null?n.childLanes&~r:0,i&&(n|=ns),n}function g_(n,i,r){var u=i.pendingProps,f=!1,p=(i.flags&128)!==0,b;if((b=p)||(b=n!==null&&n.memoizedState===null?!1:(Pt.current&2)!==0),b&&(f=!0,i.flags&=-129),b=(i.flags&32)!==0,i.flags&=-33,n===null){if(Qe){if(f?zi(i):Bi(),Qe){var S=vt,k;if(k=S){e:{for(k=S,S=Os;k.nodeType!==8;){if(!S){S=null;break e}if(k=hs(k.nextSibling),k===null){S=null;break e}}S=k}S!==null?(i.memoizedState={dehydrated:S,treeContext:ir!==null?{id:oi,overflow:li}:null,retryLane:536870912,hydrationErrors:null},k=On(18,null,null,0),k.stateNode=S,k.return=i,i.child=k,yn=i,vt=null,k=!0):k=!1}k||or(i)}if(S=i.memoizedState,S!==null&&(S=S.dehydrated,S!==null))return Ym(S)?i.lanes=32:i.lanes=536870912,null;hi(i)}return S=u.children,u=u.fallback,f?(Bi(),f=i.mode,S=ld({mode:"hidden",children:S},f),u=sr(u,f,r,null),S.return=i,u.return=i,S.sibling=u,i.child=S,f=i.child,f.memoizedState=um(r),f.childLanes=dm(n,b,r),i.memoizedState=cm,u):(zi(i),hm(i,S))}if(k=n.memoizedState,k!==null&&(S=k.dehydrated,S!==null)){if(p)i.flags&256?(zi(i),i.flags&=-257,i=fm(n,i,r)):i.memoizedState!==null?(Bi(),i.child=n.child,i.flags|=128,i=null):(Bi(),f=u.fallback,S=i.mode,u=ld({mode:"visible",children:u.children},S),f=sr(f,S,r,null),f.flags|=2,u.return=i,f.return=i,u.sibling=f,i.child=u,mo(i,n.child,null,r),u=i.child,u.memoizedState=um(r),u.childLanes=dm(n,b,r),i.memoizedState=cm,i=f);else if(zi(i),Ym(S)){if(b=S.nextSibling&&S.nextSibling.dataset,b)var Y=b.dgst;b=Y,u=Error(a(419)),u.stack="",u.digest=b,Ml({value:u,source:null,stack:null}),i=fm(n,i,r)}else if(zt||Pl(n,i,r,!1),b=(r&n.childLanes)!==0,zt||b){if(b=lt,b!==null&&(u=r&-r,u=(u&42)!==0?1:ji(u),u=(u&(b.suspendedLanes|r))!==0?0:u,u!==0&&u!==k.retryLane))throw k.retryLane=u,no(n,u),Ln(b,n,u),o_;S.data==="$?"||Rm(),i=fm(n,i,r)}else S.data==="$?"?(i.flags|=192,i.child=n.child,i=null):(n=k.treeContext,vt=hs(S.nextSibling),yn=i,Qe=!0,rr=null,Os=!1,n!==null&&(Jn[es++]=oi,Jn[es++]=li,Jn[es++]=ir,oi=n.id,li=n.overflow,ir=i),i=hm(i,u.children),i.flags|=4096);return i}return f?(Bi(),f=u.fallback,S=i.mode,k=n.child,Y=k.sibling,u=ri(k,{mode:"hidden",children:u.children}),u.subtreeFlags=k.subtreeFlags&65011712,Y!==null?f=ri(Y,f):(f=sr(f,S,r,null),f.flags|=2),f.return=i,u.return=i,u.sibling=f,i.child=u,u=f,f=i.child,S=n.child.memoizedState,S===null?S=um(r):(k=S.cachePool,k!==null?(Y=Mt._currentValue,k=k.parent!==Y?{parent:Y,pool:Y}:k):k=ny(),S={baseLanes:S.baseLanes|r,cachePool:k}),f.memoizedState=S,f.childLanes=dm(n,b,r),i.memoizedState=cm,u):(zi(i),r=n.child,n=r.sibling,r=ri(r,{mode:"visible",children:u.children}),r.return=i,r.sibling=null,n!==null&&(b=i.deletions,b===null?(i.deletions=[n],i.flags|=16):b.push(n)),i.child=r,i.memoizedState=null,r)}function hm(n,i){return i=ld({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function ld(n,i){return n=On(22,n,null,i),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function fm(n,i,r){return mo(i,n.child,null,r),n=hm(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function v_(n,i,r){n.lanes|=i;var u=n.alternate;u!==null&&(u.lanes|=i),Rf(n.return,i,r)}function mm(n,i,r,u,f){var p=n.memoizedState;p===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:r,tailMode:f}:(p.isBackwards=i,p.rendering=null,p.renderingStartTime=0,p.last=u,p.tail=r,p.tailMode=f)}function y_(n,i,r){var u=i.pendingProps,f=u.revealOrder,p=u.tail;if(Qt(n,i,u.children,r),u=Pt.current,(u&2)!==0)u=u&1|2,i.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&v_(n,r,i);else if(n.tag===19)v_(n,r,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}u&=1}switch(ue(Pt,u),f){case"forwards":for(r=i.child,f=null;r!==null;)n=r.alternate,n!==null&&id(n)===null&&(f=r),r=r.sibling;r=f,r===null?(f=i.child,i.child=null):(f=r.sibling,r.sibling=null),mm(i,!1,f,r,p);break;case"backwards":for(r=null,f=i.child,i.child=null;f!==null;){if(n=f.alternate,n!==null&&id(n)===null){i.child=f;break}n=f.sibling,f.sibling=r,r=f,f=n}mm(i,!0,r,null,p);break;case"together":mm(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function fi(n,i,r){if(n!==null&&(i.dependencies=n.dependencies),Yi|=i.lanes,(r&i.childLanes)===0)if(n!==null){if(Pl(n,i,r,!1),(r&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(a(153));if(i.child!==null){for(n=i.child,r=ri(n,n.pendingProps),i.child=r,r.return=i;n.sibling!==null;)n=n.sibling,r=r.sibling=ri(n,n.pendingProps),r.return=i;r.sibling=null}return i.child}function pm(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&zu(n)))}function xS(n,i,r){switch(i.tag){case 3:ot(i,i.stateNode.containerInfo),Vi(i,Mt,n.memoizedState.cache),Ol();break;case 27:case 5:Ii(i);break;case 4:ot(i,i.stateNode.containerInfo);break;case 10:Vi(i,i.type,i.memoizedProps.value);break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(zi(i),i.flags|=128,null):(r&i.child.childLanes)!==0?g_(n,i,r):(zi(i),n=fi(n,i,r),n!==null?n.sibling:null);zi(i);break;case 19:var f=(n.flags&128)!==0;if(u=(r&i.childLanes)!==0,u||(Pl(n,i,r,!1),u=(r&i.childLanes)!==0),f){if(u)return y_(n,i,r);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ue(Pt,Pt.current),u)break;return null;case 22:case 23:return i.lanes=0,d_(n,i,r);case 24:Vi(i,Mt,n.memoizedState.cache)}return fi(n,i,r)}function __(n,i,r){if(n!==null)if(n.memoizedProps!==i.pendingProps)zt=!0;else{if(!pm(n,r)&&(i.flags&128)===0)return zt=!1,xS(n,i,r);zt=(n.flags&131072)!==0}else zt=!1,Qe&&(i.flags&1048576)!==0&&Qv(i,qu,i.index);switch(i.lanes=0,i.tag){case 16:e:{n=i.pendingProps;var u=i.elementType,f=u._init;if(u=f(u._payload),i.type=u,typeof u=="function")xf(u)?(n=hr(u,n),i.tag=1,i=m_(null,i,u,n,r)):(i.tag=0,i=lm(null,i,u,n,r));else{if(u!=null){if(f=u.$$typeof,f===U){i.tag=11,i=l_(null,i,u,n,r);break e}else if(f===O){i.tag=14,i=c_(null,i,u,n,r);break e}}throw i=re(u)||u,Error(a(306,i,""))}}return i;case 0:return lm(n,i,i.type,i.pendingProps,r);case 1:return u=i.type,f=hr(u,i.pendingProps),m_(n,i,u,f,r);case 3:e:{if(ot(i,i.stateNode.containerInfo),n===null)throw Error(a(387));u=i.pendingProps;var p=i.memoizedState;f=p.element,Lf(n,i),zl(i,u,null,r);var b=i.memoizedState;if(u=b.cache,Vi(i,Mt,u),u!==p.cache&&Df(i,[Mt],r,!0),ql(),u=b.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:b.cache},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){i=p_(n,i,u,r);break e}else if(u!==f){f=Wn(Error(a(424)),i),Ml(f),i=p_(n,i,u,r);break e}else{switch(n=i.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(vt=hs(n.firstChild),yn=i,Qe=!0,rr=null,Os=!0,r=Wy(i,null,u,r),i.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(Ol(),u===f){i=fi(n,i,r);break e}Qt(n,i,u,r)}i=i.child}return i;case 26:return od(n,i),n===null?(r=NE(i.type,null,i.pendingProps,null))?i.memoizedState=r:Qe||(r=i.type,n=i.pendingProps,u=Td(Ie.current).createElement(r),u[Rt]=i,u[At]=n,Wt(u,r,n),Et(u),i.stateNode=u):i.memoizedState=NE(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return Ii(i),n===null&&Qe&&(u=i.stateNode=EE(i.type,i.pendingProps,Ie.current),yn=i,Os=!0,f=vt,Zi(i.type)?(Qm=f,vt=hs(u.firstChild)):vt=f),Qt(n,i,i.pendingProps.children,r),od(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&Qe&&((f=u=vt)&&(u=ZS(u,i.type,i.pendingProps,Os),u!==null?(i.stateNode=u,yn=i,vt=hs(u.firstChild),Os=!1,f=!0):f=!1),f||or(i)),Ii(i),f=i.type,p=i.pendingProps,b=n!==null?n.memoizedProps:null,u=p.children,Gm(f,p)?u=null:b!==null&&Gm(f,b)&&(i.flags|=32),i.memoizedState!==null&&(f=Hf(n,i,gS,null,null,r),uc._currentValue=f),od(n,i),Qt(n,i,u,r),i.child;case 6:return n===null&&Qe&&((n=r=vt)&&(r=JS(r,i.pendingProps,Os),r!==null?(i.stateNode=r,yn=i,vt=null,n=!0):n=!1),n||or(i)),null;case 13:return g_(n,i,r);case 4:return ot(i,i.stateNode.containerInfo),u=i.pendingProps,n===null?i.child=mo(i,null,u,r):Qt(n,i,u,r),i.child;case 11:return l_(n,i,i.type,i.pendingProps,r);case 7:return Qt(n,i,i.pendingProps,r),i.child;case 8:return Qt(n,i,i.pendingProps.children,r),i.child;case 12:return Qt(n,i,i.pendingProps.children,r),i.child;case 10:return u=i.pendingProps,Vi(i,i.type,u.value),Qt(n,i,u.children,r),i.child;case 9:return f=i.type._context,u=i.pendingProps.children,cr(i),f=ln(f),u=u(f),i.flags|=1,Qt(n,i,u,r),i.child;case 14:return c_(n,i,i.type,i.pendingProps,r);case 15:return u_(n,i,i.type,i.pendingProps,r);case 19:return y_(n,i,r);case 31:return u=i.pendingProps,r=i.mode,u={mode:u.mode,children:u.children},n===null?(r=ld(u,r),r.ref=i.ref,i.child=r,r.return=i,i=r):(r=ri(n.child,u),r.ref=i.ref,i.child=r,r.return=i,i=r),i;case 22:return d_(n,i,r);case 24:return cr(i),u=ln(Mt),n===null?(f=Pf(),f===null&&(f=lt,p=Of(),f.pooledCache=p,p.refCount++,p!==null&&(f.pooledCacheLanes|=r),f=p),i.memoizedState={parent:u,cache:f},Vf(i),Vi(i,Mt,f)):((n.lanes&r)!==0&&(Lf(n,i),zl(i,null,null,r),ql()),f=n.memoizedState,p=i.memoizedState,f.parent!==u?(f={parent:u,cache:u},i.memoizedState=f,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=f),Vi(i,Mt,u)):(u=p.cache,Vi(i,Mt,u),u!==f.cache&&Df(i,[Mt],r,!0))),Qt(n,i,i.pendingProps.children,r),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function mi(n){n.flags|=4}function E_(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!CE(i)){if(i=ts.current,i!==null&&((Ge&4194048)===Ge?Ms!==null:(Ge&62914560)!==Ge&&(Ge&536870912)===0||i!==Ms))throw Ul=kf,sy;n.flags|=8192}}function cd(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?hl():536870912,n.lanes|=i,yo|=i)}function Ql(n,i){if(!Qe)switch(n.tailMode){case"hidden":i=n.tail;for(var r=null;i!==null;)i.alternate!==null&&(r=i),i=i.sibling;r===null?n.tail=null:r.sibling=null;break;case"collapsed":r=n.tail;for(var u=null;r!==null;)r.alternate!==null&&(u=r),r=r.sibling;u===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:u.sibling=null}}function ft(n){var i=n.alternate!==null&&n.alternate.child===n.child,r=0,u=0;if(i)for(var f=n.child;f!==null;)r|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)r|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=u,n.childLanes=r,i}function AS(n,i,r){var u=i.pendingProps;switch(Cf(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ft(i),null;case 1:return ft(i),null;case 3:return r=i.stateNode,u=null,n!==null&&(u=n.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),ui(Mt),bs(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Dl(i)?mi(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Zv())),ft(i),null;case 26:return r=i.memoizedState,n===null?(mi(i),r!==null?(ft(i),E_(i,r)):(ft(i),i.flags&=-16777217)):r?r!==n.memoizedState?(mi(i),ft(i),E_(i,r)):(ft(i),i.flags&=-16777217):(n.memoizedProps!==u&&mi(i),ft(i),i.flags&=-16777217),null;case 27:Ks(i),r=Ie.current;var f=i.type;if(n!==null&&i.stateNode!=null)n.memoizedProps!==u&&mi(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return ft(i),null}n=Te.current,Dl(i)?Xv(i):(n=EE(f,u,r),i.stateNode=n,mi(i))}return ft(i),null;case 5:if(Ks(i),r=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==u&&mi(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return ft(i),null}if(n=Te.current,Dl(i))Xv(i);else{switch(f=Td(Ie.current),n){case 1:n=f.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:n=f.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":n=f.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":n=f.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":n=f.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof u.is=="string"?f.createElement("select",{is:u.is}):f.createElement("select"),u.multiple?n.multiple=!0:u.size&&(n.size=u.size);break;default:n=typeof u.is=="string"?f.createElement(r,{is:u.is}):f.createElement(r)}}n[Rt]=i,n[At]=u;e:for(f=i.child;f!==null;){if(f.tag===5||f.tag===6)n.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===i)break e;for(;f.sibling===null;){if(f.return===null||f.return===i)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}i.stateNode=n;e:switch(Wt(n,r,u),r){case"button":case"input":case"select":case"textarea":n=!!u.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&mi(i)}}return ft(i),i.flags&=-16777217,null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==u&&mi(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(a(166));if(n=Ie.current,Dl(i)){if(n=i.stateNode,r=i.memoizedProps,u=null,f=yn,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}n[Rt]=i,n=!!(n.nodeValue===r||u!==null&&u.suppressHydrationWarning===!0||fE(n.nodeValue,r)),n||or(i)}else n=Td(n).createTextNode(u),n[Rt]=i,i.stateNode=n}return ft(i),null;case 13:if(u=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=Dl(i),u!==null&&u.dehydrated!==null){if(n===null){if(!f)throw Error(a(318));if(f=i.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[Rt]=i}else Ol(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ft(i),f=!1}else f=Zv(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return i.flags&256?(hi(i),i):(hi(i),null)}if(hi(i),(i.flags&128)!==0)return i.lanes=r,i;if(r=u!==null,n=n!==null&&n.memoizedState!==null,r){u=i.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool);var p=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==f&&(u.flags|=2048)}return r!==n&&r&&(i.child.flags|=8192),cd(i,i.updateQueue),ft(i),null;case 4:return bs(),n===null&&Fm(i.stateNode.containerInfo),ft(i),null;case 10:return ui(i.type),ft(i),null;case 19:if(he(Pt),f=i.memoizedState,f===null)return ft(i),null;if(u=(i.flags&128)!==0,p=f.rendering,p===null)if(u)Ql(f,!1);else{if(yt!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(p=id(n),p!==null){for(i.flags|=128,Ql(f,!1),n=p.updateQueue,i.updateQueue=n,cd(i,n),i.subtreeFlags=0,n=r,r=i.child;r!==null;)Yv(r,n),r=r.sibling;return ue(Pt,Pt.current&1|2),i.child}n=n.sibling}f.tail!==null&&Gn()>hd&&(i.flags|=128,u=!0,Ql(f,!1),i.lanes=4194304)}else{if(!u)if(n=id(p),n!==null){if(i.flags|=128,u=!0,n=n.updateQueue,i.updateQueue=n,cd(i,n),Ql(f,!0),f.tail===null&&f.tailMode==="hidden"&&!p.alternate&&!Qe)return ft(i),null}else 2*Gn()-f.renderingStartTime>hd&&r!==536870912&&(i.flags|=128,u=!0,Ql(f,!1),i.lanes=4194304);f.isBackwards?(p.sibling=i.child,i.child=p):(n=f.last,n!==null?n.sibling=p:i.child=p,f.last=p)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Gn(),i.sibling=null,n=Pt.current,ue(Pt,u?n&1|2:n&1),i):(ft(i),null);case 22:case 23:return hi(i),zf(),u=i.memoizedState!==null,n!==null?n.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(r&536870912)!==0&&(i.flags&128)===0&&(ft(i),i.subtreeFlags&6&&(i.flags|=8192)):ft(i),r=i.updateQueue,r!==null&&cd(i,r.retryQueue),r=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==r&&(i.flags|=2048),n!==null&&he(ur),null;case 24:return r=null,n!==null&&(r=n.memoizedState.cache),i.memoizedState.cache!==r&&(i.flags|=2048),ui(Mt),ft(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function SS(n,i){switch(Cf(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return ui(Mt),bs(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return Ks(i),null;case 13:if(hi(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(a(340));Ol()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return he(Pt),null;case 4:return bs(),null;case 10:return ui(i.type),null;case 22:case 23:return hi(i),zf(),n!==null&&he(ur),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return ui(Mt),null;case 25:return null;default:return null}}function b_(n,i){switch(Cf(i),i.tag){case 3:ui(Mt),bs();break;case 26:case 27:case 5:Ks(i);break;case 4:bs();break;case 13:hi(i);break;case 19:he(Pt);break;case 10:ui(i.type);break;case 22:case 23:hi(i),zf(),n!==null&&he(ur);break;case 24:ui(Mt)}}function Xl(n,i){try{var r=i.updateQueue,u=r!==null?r.lastEffect:null;if(u!==null){var f=u.next;r=f;do{if((r.tag&n)===n){u=void 0;var p=r.create,b=r.inst;u=p(),b.destroy=u}r=r.next}while(r!==f)}}catch(S){at(i,i.return,S)}}function Hi(n,i,r){try{var u=i.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var p=f.next;u=p;do{if((u.tag&n)===n){var b=u.inst,S=b.destroy;if(S!==void 0){b.destroy=void 0,f=i;var k=r,Y=S;try{Y()}catch(te){at(f,k,te)}}}u=u.next}while(u!==p)}}catch(te){at(i,i.return,te)}}function T_(n){var i=n.updateQueue;if(i!==null){var r=n.stateNode;try{cy(i,r)}catch(u){at(n,n.return,u)}}}function N_(n,i,r){r.props=hr(n.type,n.memoizedProps),r.state=n.memoizedState;try{r.componentWillUnmount()}catch(u){at(n,i,u)}}function Wl(n,i){try{var r=n.ref;if(r!==null){switch(n.tag){case 26:case 27:case 5:var u=n.stateNode;break;case 30:u=n.stateNode;break;default:u=n.stateNode}typeof r=="function"?n.refCleanup=r(u):r.current=u}}catch(f){at(n,i,f)}}function Ps(n,i){var r=n.ref,u=n.refCleanup;if(r!==null)if(typeof u=="function")try{u()}catch(f){at(n,i,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(f){at(n,i,f)}else r.current=null}function x_(n){var i=n.type,r=n.memoizedProps,u=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":r.autoFocus&&u.focus();break e;case"img":r.src?u.src=r.src:r.srcSet&&(u.srcset=r.srcSet)}}catch(f){at(n,n.return,f)}}function gm(n,i,r){try{var u=n.stateNode;KS(u,n.type,r,i),u[At]=i}catch(f){at(n,n.return,f)}}function A_(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Zi(n.type)||n.tag===4}function vm(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||A_(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Zi(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ym(n,i,r){var u=n.tag;if(u===5||u===6)n=n.stateNode,i?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(n,i):(i=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,i.appendChild(n),r=r._reactRootContainer,r!=null||i.onclick!==null||(i.onclick=bd));else if(u!==4&&(u===27&&Zi(n.type)&&(r=n.stateNode,i=null),n=n.child,n!==null))for(ym(n,i,r),n=n.sibling;n!==null;)ym(n,i,r),n=n.sibling}function ud(n,i,r){var u=n.tag;if(u===5||u===6)n=n.stateNode,i?r.insertBefore(n,i):r.appendChild(n);else if(u!==4&&(u===27&&Zi(n.type)&&(r=n.stateNode),n=n.child,n!==null))for(ud(n,i,r),n=n.sibling;n!==null;)ud(n,i,r),n=n.sibling}function S_(n){var i=n.stateNode,r=n.memoizedProps;try{for(var u=n.type,f=i.attributes;f.length;)i.removeAttributeNode(f[0]);Wt(i,u,r),i[Rt]=n,i[At]=r}catch(p){at(n,n.return,p)}}var pi=!1,Tt=!1,_m=!1,w_=typeof WeakSet=="function"?WeakSet:Set,Bt=null;function wS(n,i){if(n=n.containerInfo,Bm=Cd,n=Lv(n),vf(n)){if("selectionStart"in n)var r={start:n.selectionStart,end:n.selectionEnd};else e:{r=(r=n.ownerDocument)&&r.defaultView||window;var u=r.getSelection&&r.getSelection();if(u&&u.rangeCount!==0){r=u.anchorNode;var f=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{r.nodeType,p.nodeType}catch{r=null;break e}var b=0,S=-1,k=-1,Y=0,te=0,oe=n,Q=null;t:for(;;){for(var X;oe!==r||f!==0&&oe.nodeType!==3||(S=b+f),oe!==p||u!==0&&oe.nodeType!==3||(k=b+u),oe.nodeType===3&&(b+=oe.nodeValue.length),(X=oe.firstChild)!==null;)Q=oe,oe=X;for(;;){if(oe===n)break t;if(Q===r&&++Y===f&&(S=b),Q===p&&++te===u&&(k=b),(X=oe.nextSibling)!==null)break;oe=Q,Q=oe.parentNode}oe=X}r=S===-1||k===-1?null:{start:S,end:k}}else r=null}r=r||{start:0,end:0}}else r=null;for(Hm={focusedElem:n,selectionRange:r},Cd=!1,Bt=i;Bt!==null;)if(i=Bt,n=i.child,(i.subtreeFlags&1024)!==0&&n!==null)n.return=i,Bt=n;else for(;Bt!==null;){switch(i=Bt,p=i.alternate,n=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&p!==null){n=void 0,r=i,f=p.memoizedProps,p=p.memoizedState,u=r.stateNode;try{var Ce=hr(r.type,f,r.elementType===r.type);n=u.getSnapshotBeforeUpdate(Ce,p),u.__reactInternalSnapshotBeforeUpdate=n}catch(xe){at(r,r.return,xe)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,r=n.nodeType,r===9)Km(n);else if(r===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Km(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=i.sibling,n!==null){n.return=i.return,Bt=n;break}Bt=i.return}}function C_(n,i,r){var u=r.flags;switch(r.tag){case 0:case 11:case 15:Gi(n,r),u&4&&Xl(5,r);break;case 1:if(Gi(n,r),u&4)if(n=r.stateNode,i===null)try{n.componentDidMount()}catch(b){at(r,r.return,b)}else{var f=hr(r.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(f,i,n.__reactInternalSnapshotBeforeUpdate)}catch(b){at(r,r.return,b)}}u&64&&T_(r),u&512&&Wl(r,r.return);break;case 3:if(Gi(n,r),u&64&&(n=r.updateQueue,n!==null)){if(i=null,r.child!==null)switch(r.child.tag){case 27:case 5:i=r.child.stateNode;break;case 1:i=r.child.stateNode}try{cy(n,i)}catch(b){at(r,r.return,b)}}break;case 27:i===null&&u&4&&S_(r);case 26:case 5:Gi(n,r),i===null&&u&4&&x_(r),u&512&&Wl(r,r.return);break;case 12:Gi(n,r);break;case 13:Gi(n,r),u&4&&R_(n,r),u&64&&(n=r.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(r=kS.bind(null,r),ew(n,r))));break;case 22:if(u=r.memoizedState!==null||pi,!u){i=i!==null&&i.memoizedState!==null||Tt,f=pi;var p=Tt;pi=u,(Tt=i)&&!p?$i(n,r,(r.subtreeFlags&8772)!==0):Gi(n,r),pi=f,Tt=p}break;case 30:break;default:Gi(n,r)}}function I_(n){var i=n.alternate;i!==null&&(n.alternate=null,I_(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&Oi(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var dt=null,An=!1;function gi(n,i,r){for(r=r.child;r!==null;)j_(n,i,r),r=r.sibling}function j_(n,i,r){if(We&&typeof We.onCommitFiberUnmount=="function")try{We.onCommitFiberUnmount(gt,r)}catch{}switch(r.tag){case 26:Tt||Ps(r,i),gi(n,i,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:Tt||Ps(r,i);var u=dt,f=An;Zi(r.type)&&(dt=r.stateNode,An=!1),gi(n,i,r),rc(r.stateNode),dt=u,An=f;break;case 5:Tt||Ps(r,i);case 6:if(u=dt,f=An,dt=null,gi(n,i,r),dt=u,An=f,dt!==null)if(An)try{(dt.nodeType===9?dt.body:dt.nodeName==="HTML"?dt.ownerDocument.body:dt).removeChild(r.stateNode)}catch(p){at(r,i,p)}else try{dt.removeChild(r.stateNode)}catch(p){at(r,i,p)}break;case 18:dt!==null&&(An?(n=dt,yE(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,r.stateNode),mc(n)):yE(dt,r.stateNode));break;case 4:u=dt,f=An,dt=r.stateNode.containerInfo,An=!0,gi(n,i,r),dt=u,An=f;break;case 0:case 11:case 14:case 15:Tt||Hi(2,r,i),Tt||Hi(4,r,i),gi(n,i,r);break;case 1:Tt||(Ps(r,i),u=r.stateNode,typeof u.componentWillUnmount=="function"&&N_(r,i,u)),gi(n,i,r);break;case 21:gi(n,i,r);break;case 22:Tt=(u=Tt)||r.memoizedState!==null,gi(n,i,r),Tt=u;break;default:gi(n,i,r)}}function R_(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{mc(n)}catch(r){at(i,i.return,r)}}function CS(n){switch(n.tag){case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new w_),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new w_),i;default:throw Error(a(435,n.tag))}}function Em(n,i){var r=CS(n);i.forEach(function(u){var f=VS.bind(null,n,u);r.has(u)||(r.add(u),u.then(f,f))})}function Mn(n,i){var r=i.deletions;if(r!==null)for(var u=0;u<r.length;u++){var f=r[u],p=n,b=i,S=b;e:for(;S!==null;){switch(S.tag){case 27:if(Zi(S.type)){dt=S.stateNode,An=!1;break e}break;case 5:dt=S.stateNode,An=!1;break e;case 3:case 4:dt=S.stateNode.containerInfo,An=!0;break e}S=S.return}if(dt===null)throw Error(a(160));j_(p,b,f),dt=null,An=!1,p=f.alternate,p!==null&&(p.return=null),f.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)D_(i,n),i=i.sibling}var ds=null;function D_(n,i){var r=n.alternate,u=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Mn(i,n),Pn(n),u&4&&(Hi(3,n,n.return),Xl(3,n),Hi(5,n,n.return));break;case 1:Mn(i,n),Pn(n),u&512&&(Tt||r===null||Ps(r,r.return)),u&64&&pi&&(n=n.updateQueue,n!==null&&(u=n.callbacks,u!==null&&(r=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=r===null?u:r.concat(u))));break;case 26:var f=ds;if(Mn(i,n),Pn(n),u&512&&(Tt||r===null||Ps(r,r.return)),u&4){var p=r!==null?r.memoizedState:null;if(u=n.memoizedState,r===null)if(u===null)if(n.stateNode===null){e:{u=n.type,r=n.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":p=f.getElementsByTagName("title")[0],(!p||p[qa]||p[Rt]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=f.createElement(u),f.head.insertBefore(p,f.querySelector("head > title"))),Wt(p,u,r),p[Rt]=n,Et(p),u=p;break e;case"link":var b=SE("link","href",f).get(u+(r.href||""));if(b){for(var S=0;S<b.length;S++)if(p=b[S],p.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&p.getAttribute("rel")===(r.rel==null?null:r.rel)&&p.getAttribute("title")===(r.title==null?null:r.title)&&p.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){b.splice(S,1);break t}}p=f.createElement(u),Wt(p,u,r),f.head.appendChild(p);break;case"meta":if(b=SE("meta","content",f).get(u+(r.content||""))){for(S=0;S<b.length;S++)if(p=b[S],p.getAttribute("content")===(r.content==null?null:""+r.content)&&p.getAttribute("name")===(r.name==null?null:r.name)&&p.getAttribute("property")===(r.property==null?null:r.property)&&p.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&p.getAttribute("charset")===(r.charSet==null?null:r.charSet)){b.splice(S,1);break t}}p=f.createElement(u),Wt(p,u,r),f.head.appendChild(p);break;default:throw Error(a(468,u))}p[Rt]=n,Et(p),u=p}n.stateNode=u}else wE(f,n.type,n.stateNode);else n.stateNode=AE(f,u,n.memoizedProps);else p!==u?(p===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):p.count--,u===null?wE(f,n.type,n.stateNode):AE(f,u,n.memoizedProps)):u===null&&n.stateNode!==null&&gm(n,n.memoizedProps,r.memoizedProps)}break;case 27:Mn(i,n),Pn(n),u&512&&(Tt||r===null||Ps(r,r.return)),r!==null&&u&4&&gm(n,n.memoizedProps,r.memoizedProps);break;case 5:if(Mn(i,n),Pn(n),u&512&&(Tt||r===null||Ps(r,r.return)),n.flags&32){f=n.stateNode;try{Kn(f,"")}catch(X){at(n,n.return,X)}}u&4&&n.stateNode!=null&&(f=n.memoizedProps,gm(n,f,r!==null?r.memoizedProps:f)),u&1024&&(_m=!0);break;case 6:if(Mn(i,n),Pn(n),u&4){if(n.stateNode===null)throw Error(a(162));u=n.memoizedProps,r=n.stateNode;try{r.nodeValue=u}catch(X){at(n,n.return,X)}}break;case 3:if(Ad=null,f=ds,ds=Nd(i.containerInfo),Mn(i,n),ds=f,Pn(n),u&4&&r!==null&&r.memoizedState.isDehydrated)try{mc(i.containerInfo)}catch(X){at(n,n.return,X)}_m&&(_m=!1,O_(n));break;case 4:u=ds,ds=Nd(n.stateNode.containerInfo),Mn(i,n),Pn(n),ds=u;break;case 12:Mn(i,n),Pn(n);break;case 13:Mn(i,n),Pn(n),n.child.flags&8192&&n.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Sm=Gn()),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Em(n,u)));break;case 22:f=n.memoizedState!==null;var k=r!==null&&r.memoizedState!==null,Y=pi,te=Tt;if(pi=Y||f,Tt=te||k,Mn(i,n),Tt=te,pi=Y,Pn(n),u&8192)e:for(i=n.stateNode,i._visibility=f?i._visibility&-2:i._visibility|1,f&&(r===null||k||pi||Tt||fr(n)),r=null,i=n;;){if(i.tag===5||i.tag===26){if(r===null){k=r=i;try{if(p=k.stateNode,f)b=p.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{S=k.stateNode;var oe=k.memoizedProps.style,Q=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;S.style.display=Q==null||typeof Q=="boolean"?"":(""+Q).trim()}}catch(X){at(k,k.return,X)}}}else if(i.tag===6){if(r===null){k=i;try{k.stateNode.nodeValue=f?"":k.memoizedProps}catch(X){at(k,k.return,X)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;r===i&&(r=null),i=i.return}r===i&&(r=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=n.updateQueue,u!==null&&(r=u.retryQueue,r!==null&&(u.retryQueue=null,Em(n,r))));break;case 19:Mn(i,n),Pn(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Em(n,u)));break;case 30:break;case 21:break;default:Mn(i,n),Pn(n)}}function Pn(n){var i=n.flags;if(i&2){try{for(var r,u=n.return;u!==null;){if(A_(u)){r=u;break}u=u.return}if(r==null)throw Error(a(160));switch(r.tag){case 27:var f=r.stateNode,p=vm(n);ud(n,p,f);break;case 5:var b=r.stateNode;r.flags&32&&(Kn(b,""),r.flags&=-33);var S=vm(n);ud(n,S,b);break;case 3:case 4:var k=r.stateNode.containerInfo,Y=vm(n);ym(n,Y,k);break;default:throw Error(a(161))}}catch(te){at(n,n.return,te)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function O_(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;O_(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function Gi(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)C_(n,i.alternate,i),i=i.sibling}function fr(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:Hi(4,i,i.return),fr(i);break;case 1:Ps(i,i.return);var r=i.stateNode;typeof r.componentWillUnmount=="function"&&N_(i,i.return,r),fr(i);break;case 27:rc(i.stateNode);case 26:case 5:Ps(i,i.return),fr(i);break;case 22:i.memoizedState===null&&fr(i);break;case 30:fr(i);break;default:fr(i)}n=n.sibling}}function $i(n,i,r){for(r=r&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,f=n,p=i,b=p.flags;switch(p.tag){case 0:case 11:case 15:$i(f,p,r),Xl(4,p);break;case 1:if($i(f,p,r),u=p,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Y){at(u,u.return,Y)}if(u=p,f=u.updateQueue,f!==null){var S=u.stateNode;try{var k=f.shared.hiddenCallbacks;if(k!==null)for(f.shared.hiddenCallbacks=null,f=0;f<k.length;f++)ly(k[f],S)}catch(Y){at(u,u.return,Y)}}r&&b&64&&T_(p),Wl(p,p.return);break;case 27:S_(p);case 26:case 5:$i(f,p,r),r&&u===null&&b&4&&x_(p),Wl(p,p.return);break;case 12:$i(f,p,r);break;case 13:$i(f,p,r),r&&b&4&&R_(f,p);break;case 22:p.memoizedState===null&&$i(f,p,r),Wl(p,p.return);break;case 30:break;default:$i(f,p,r)}i=i.sibling}}function bm(n,i){var r=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==r&&(n!=null&&n.refCount++,r!=null&&kl(r))}function Tm(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&kl(n))}function ks(n,i,r,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)M_(n,i,r,u),i=i.sibling}function M_(n,i,r,u){var f=i.flags;switch(i.tag){case 0:case 11:case 15:ks(n,i,r,u),f&2048&&Xl(9,i);break;case 1:ks(n,i,r,u);break;case 3:ks(n,i,r,u),f&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&kl(n)));break;case 12:if(f&2048){ks(n,i,r,u),n=i.stateNode;try{var p=i.memoizedProps,b=p.id,S=p.onPostCommit;typeof S=="function"&&S(b,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(k){at(i,i.return,k)}}else ks(n,i,r,u);break;case 13:ks(n,i,r,u);break;case 23:break;case 22:p=i.stateNode,b=i.alternate,i.memoizedState!==null?p._visibility&2?ks(n,i,r,u):Zl(n,i):p._visibility&2?ks(n,i,r,u):(p._visibility|=2,po(n,i,r,u,(i.subtreeFlags&10256)!==0)),f&2048&&bm(b,i);break;case 24:ks(n,i,r,u),f&2048&&Tm(i.alternate,i);break;default:ks(n,i,r,u)}}function po(n,i,r,u,f){for(f=f&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var p=n,b=i,S=r,k=u,Y=b.flags;switch(b.tag){case 0:case 11:case 15:po(p,b,S,k,f),Xl(8,b);break;case 23:break;case 22:var te=b.stateNode;b.memoizedState!==null?te._visibility&2?po(p,b,S,k,f):Zl(p,b):(te._visibility|=2,po(p,b,S,k,f)),f&&Y&2048&&bm(b.alternate,b);break;case 24:po(p,b,S,k,f),f&&Y&2048&&Tm(b.alternate,b);break;default:po(p,b,S,k,f)}i=i.sibling}}function Zl(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var r=n,u=i,f=u.flags;switch(u.tag){case 22:Zl(r,u),f&2048&&bm(u.alternate,u);break;case 24:Zl(r,u),f&2048&&Tm(u.alternate,u);break;default:Zl(r,u)}i=i.sibling}}var Jl=8192;function go(n){if(n.subtreeFlags&Jl)for(n=n.child;n!==null;)P_(n),n=n.sibling}function P_(n){switch(n.tag){case 26:go(n),n.flags&Jl&&n.memoizedState!==null&&fw(ds,n.memoizedState,n.memoizedProps);break;case 5:go(n);break;case 3:case 4:var i=ds;ds=Nd(n.stateNode.containerInfo),go(n),ds=i;break;case 22:n.memoizedState===null&&(i=n.alternate,i!==null&&i.memoizedState!==null?(i=Jl,Jl=16777216,go(n),Jl=i):go(n));break;default:go(n)}}function k_(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function ec(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var r=0;r<i.length;r++){var u=i[r];Bt=u,L_(u,n)}k_(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)V_(n),n=n.sibling}function V_(n){switch(n.tag){case 0:case 11:case 15:ec(n),n.flags&2048&&Hi(9,n,n.return);break;case 3:ec(n);break;case 12:ec(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,dd(n)):ec(n);break;default:ec(n)}}function dd(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var r=0;r<i.length;r++){var u=i[r];Bt=u,L_(u,n)}k_(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:Hi(8,i,i.return),dd(i);break;case 22:r=i.stateNode,r._visibility&2&&(r._visibility&=-3,dd(i));break;default:dd(i)}n=n.sibling}}function L_(n,i){for(;Bt!==null;){var r=Bt;switch(r.tag){case 0:case 11:case 15:Hi(8,r,i);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var u=r.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:kl(r.memoizedState.cache)}if(u=r.child,u!==null)u.return=r,Bt=u;else e:for(r=n;Bt!==null;){u=Bt;var f=u.sibling,p=u.return;if(I_(u),u===r){Bt=null;break e}if(f!==null){f.return=p,Bt=f;break e}Bt=p}}}var IS={getCacheForType:function(n){var i=ln(Mt),r=i.data.get(n);return r===void 0&&(r=n(),i.data.set(n,r)),r}},jS=typeof WeakMap=="function"?WeakMap:Map,Ze=0,lt=null,Ve=null,Ge=0,Je=0,kn=null,Ki=!1,vo=!1,Nm=!1,vi=0,yt=0,Yi=0,mr=0,xm=0,ns=0,yo=0,tc=null,Sn=null,Am=!1,Sm=0,hd=1/0,fd=null,Qi=null,Xt=0,Xi=null,_o=null,Eo=0,wm=0,Cm=null,U_=null,nc=0,Im=null;function Vn(){if((Ze&2)!==0&&Ge!==0)return Ge&-Ge;if(G.T!==null){var n=ro;return n!==0?n:km()}return Ri()}function F_(){ns===0&&(ns=(Ge&536870912)===0||Qe?dl():536870912);var n=ts.current;return n!==null&&(n.flags|=32),ns}function Ln(n,i,r){(n===lt&&(Je===2||Je===9)||n.cancelPendingCommit!==null)&&(bo(n,0),Wi(n,Ge,ns,!1)),Qs(n,r),((Ze&2)===0||n!==lt)&&(n===lt&&((Ze&2)===0&&(mr|=r),yt===4&&Wi(n,Ge,ns,!1)),Vs(n))}function q_(n,i,r){if((Ze&6)!==0)throw Error(a(327));var u=!r&&(i&124)===0&&(i&n.expiredLanes)===0||Fa(n,i),f=u?OS(n,i):Dm(n,i,!0),p=u;do{if(f===0){vo&&!u&&Wi(n,i,0,!1);break}else{if(r=n.current.alternate,p&&!RS(r)){f=Dm(n,i,!1),p=!1;continue}if(f===2){if(p=i,n.errorRecoveryDisabledLanes&p)var b=0;else b=n.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){i=b;e:{var S=n;f=tc;var k=S.current.memoizedState.isDehydrated;if(k&&(bo(S,b).flags|=256),b=Dm(S,b,!1),b!==2){if(Nm&&!k){S.errorRecoveryDisabledLanes|=p,mr|=p,f=4;break e}p=Sn,Sn=f,p!==null&&(Sn===null?Sn=p:Sn.push.apply(Sn,p))}f=b}if(p=!1,f!==2)continue}}if(f===1){bo(n,0),Wi(n,i,0,!0);break}e:{switch(u=n,p=f,p){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:Wi(u,i,ns,!Ki);break e;case 2:Sn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(f=Sm+300-Gn(),10<f)){if(Wi(u,i,ns,!Ki),Vr(u,0,!0)!==0)break e;u.timeoutHandle=gE(z_.bind(null,u,r,Sn,fd,Am,i,ns,mr,yo,Ki,p,2,-0,0),f);break e}z_(u,r,Sn,fd,Am,i,ns,mr,yo,Ki,p,0,-0,0)}}break}while(!0);Vs(n)}function z_(n,i,r,u,f,p,b,S,k,Y,te,oe,Q,X){if(n.timeoutHandle=-1,oe=i.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(cc={stylesheets:null,count:0,unsuspend:hw},P_(i),oe=mw(),oe!==null)){n.cancelPendingCommit=oe(Q_.bind(null,n,i,p,r,u,f,b,S,k,te,1,Q,X)),Wi(n,p,b,!Y);return}Q_(n,i,p,r,u,f,b,S,k)}function RS(n){for(var i=n;;){var r=i.tag;if((r===0||r===11||r===15)&&i.flags&16384&&(r=i.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var u=0;u<r.length;u++){var f=r[u],p=f.getSnapshot;f=f.value;try{if(!Dn(p(),f))return!1}catch{return!1}}if(r=i.child,i.subtreeFlags&16384&&r!==null)r.return=i,i=r;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Wi(n,i,r,u){i&=~xm,i&=~mr,n.suspendedLanes|=i,n.pingedLanes&=~i,u&&(n.warmLanes|=i),u=n.expirationTimes;for(var f=i;0<f;){var p=31-on(f),b=1<<p;u[p]=-1,f&=~b}r!==0&&Ts(n,r,i)}function md(){return(Ze&6)===0?(sc(0),!1):!0}function jm(){if(Ve!==null){if(Je===0)var n=Ve.return;else n=Ve,ci=lr=null,Kf(n),fo=null,Kl=0,n=Ve;for(;n!==null;)b_(n.alternate,n),n=n.return;Ve=null}}function bo(n,i){var r=n.timeoutHandle;r!==-1&&(n.timeoutHandle=-1,QS(r)),r=n.cancelPendingCommit,r!==null&&(n.cancelPendingCommit=null,r()),jm(),lt=n,Ve=r=ri(n.current,null),Ge=i,Je=0,kn=null,Ki=!1,vo=Fa(n,i),Nm=!1,yo=ns=xm=mr=Yi=yt=0,Sn=tc=null,Am=!1,(i&8)!==0&&(i|=i&32);var u=n.entangledLanes;if(u!==0)for(n=n.entanglements,u&=i;0<u;){var f=31-on(u),p=1<<f;i|=n[f],u&=~p}return vi=i,ku(),r}function B_(n,i){Oe=null,G.H=td,i===Ll||i===Gu?(i=ry(),Je=3):i===sy?(i=ry(),Je=4):Je=i===o_?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,kn=i,Ve===null&&(yt=1,rd(n,Wn(i,n.current)))}function H_(){var n=G.H;return G.H=td,n===null?td:n}function G_(){var n=G.A;return G.A=IS,n}function Rm(){yt=4,Ki||(Ge&4194048)!==Ge&&ts.current!==null||(vo=!0),(Yi&134217727)===0&&(mr&134217727)===0||lt===null||Wi(lt,Ge,ns,!1)}function Dm(n,i,r){var u=Ze;Ze|=2;var f=H_(),p=G_();(lt!==n||Ge!==i)&&(fd=null,bo(n,i)),i=!1;var b=yt;e:do try{if(Je!==0&&Ve!==null){var S=Ve,k=kn;switch(Je){case 8:jm(),b=6;break e;case 3:case 2:case 9:case 6:ts.current===null&&(i=!0);var Y=Je;if(Je=0,kn=null,To(n,S,k,Y),r&&vo){b=0;break e}break;default:Y=Je,Je=0,kn=null,To(n,S,k,Y)}}DS(),b=yt;break}catch(te){B_(n,te)}while(!0);return i&&n.shellSuspendCounter++,ci=lr=null,Ze=u,G.H=f,G.A=p,Ve===null&&(lt=null,Ge=0,ku()),b}function DS(){for(;Ve!==null;)$_(Ve)}function OS(n,i){var r=Ze;Ze|=2;var u=H_(),f=G_();lt!==n||Ge!==i?(fd=null,hd=Gn()+500,bo(n,i)):vo=Fa(n,i);e:do try{if(Je!==0&&Ve!==null){i=Ve;var p=kn;t:switch(Je){case 1:Je=0,kn=null,To(n,i,p,1);break;case 2:case 9:if(iy(p)){Je=0,kn=null,K_(i);break}i=function(){Je!==2&&Je!==9||lt!==n||(Je=7),Vs(n)},p.then(i,i);break e;case 3:Je=7;break e;case 4:Je=5;break e;case 7:iy(p)?(Je=0,kn=null,K_(i)):(Je=0,kn=null,To(n,i,p,7));break;case 5:var b=null;switch(Ve.tag){case 26:b=Ve.memoizedState;case 5:case 27:var S=Ve;if(!b||CE(b)){Je=0,kn=null;var k=S.sibling;if(k!==null)Ve=k;else{var Y=S.return;Y!==null?(Ve=Y,pd(Y)):Ve=null}break t}}Je=0,kn=null,To(n,i,p,5);break;case 6:Je=0,kn=null,To(n,i,p,6);break;case 8:jm(),yt=6;break e;default:throw Error(a(462))}}MS();break}catch(te){B_(n,te)}while(!0);return ci=lr=null,G.H=u,G.A=f,Ze=r,Ve!==null?0:(lt=null,Ge=0,ku(),yt)}function MS(){for(;Ve!==null&&!ol();)$_(Ve)}function $_(n){var i=__(n.alternate,n,vi);n.memoizedProps=n.pendingProps,i===null?pd(n):Ve=i}function K_(n){var i=n,r=i.alternate;switch(i.tag){case 15:case 0:i=f_(r,i,i.pendingProps,i.type,void 0,Ge);break;case 11:i=f_(r,i,i.pendingProps,i.type.render,i.ref,Ge);break;case 5:Kf(i);default:b_(r,i),i=Ve=Yv(i,vi),i=__(r,i,vi)}n.memoizedProps=n.pendingProps,i===null?pd(n):Ve=i}function To(n,i,r,u){ci=lr=null,Kf(i),fo=null,Kl=0;var f=i.return;try{if(NS(n,f,i,r,Ge)){yt=1,rd(n,Wn(r,n.current)),Ve=null;return}}catch(p){if(f!==null)throw Ve=f,p;yt=1,rd(n,Wn(r,n.current)),Ve=null;return}i.flags&32768?(Qe||u===1?n=!0:vo||(Ge&536870912)!==0?n=!1:(Ki=n=!0,(u===2||u===9||u===3||u===6)&&(u=ts.current,u!==null&&u.tag===13&&(u.flags|=16384))),Y_(i,n)):pd(i)}function pd(n){var i=n;do{if((i.flags&32768)!==0){Y_(i,Ki);return}n=i.return;var r=AS(i.alternate,i,vi);if(r!==null){Ve=r;return}if(i=i.sibling,i!==null){Ve=i;return}Ve=i=n}while(i!==null);yt===0&&(yt=5)}function Y_(n,i){do{var r=SS(n.alternate,n);if(r!==null){r.flags&=32767,Ve=r;return}if(r=n.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!i&&(n=n.sibling,n!==null)){Ve=n;return}Ve=n=r}while(n!==null);yt=6,Ve=null}function Q_(n,i,r,u,f,p,b,S,k){n.cancelPendingCommit=null;do gd();while(Xt!==0);if((Ze&6)!==0)throw Error(a(327));if(i!==null){if(i===n.current)throw Error(a(177));if(p=i.lanes|i.childLanes,p|=Tf,fl(n,r,p,b,S,k),n===lt&&(Ve=lt=null,Ge=0),_o=i,Xi=n,Eo=r,wm=p,Cm=f,U_=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,LS(ka,function(){return eE(),null})):(n.callbackNode=null,n.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=G.T,G.T=null,f=ne.p,ne.p=2,b=Ze,Ze|=4;try{wS(n,i,r)}finally{Ze=b,ne.p=f,G.T=u}}Xt=1,X_(),W_(),Z_()}}function X_(){if(Xt===1){Xt=0;var n=Xi,i=_o,r=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||r){r=G.T,G.T=null;var u=ne.p;ne.p=2;var f=Ze;Ze|=4;try{D_(i,n);var p=Hm,b=Lv(n.containerInfo),S=p.focusedElem,k=p.selectionRange;if(b!==S&&S&&S.ownerDocument&&Vv(S.ownerDocument.documentElement,S)){if(k!==null&&vf(S)){var Y=k.start,te=k.end;if(te===void 0&&(te=Y),"selectionStart"in S)S.selectionStart=Y,S.selectionEnd=Math.min(te,S.value.length);else{var oe=S.ownerDocument||document,Q=oe&&oe.defaultView||window;if(Q.getSelection){var X=Q.getSelection(),Ce=S.textContent.length,xe=Math.min(k.start,Ce),it=k.end===void 0?xe:Math.min(k.end,Ce);!X.extend&&xe>it&&(b=it,it=xe,xe=b);var B=kv(S,xe),q=kv(S,it);if(B&&q&&(X.rangeCount!==1||X.anchorNode!==B.node||X.anchorOffset!==B.offset||X.focusNode!==q.node||X.focusOffset!==q.offset)){var K=oe.createRange();K.setStart(B.node,B.offset),X.removeAllRanges(),xe>it?(X.addRange(K),X.extend(q.node,q.offset)):(K.setEnd(q.node,q.offset),X.addRange(K))}}}}for(oe=[],X=S;X=X.parentNode;)X.nodeType===1&&oe.push({element:X,left:X.scrollLeft,top:X.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<oe.length;S++){var se=oe[S];se.element.scrollLeft=se.left,se.element.scrollTop=se.top}}Cd=!!Bm,Hm=Bm=null}finally{Ze=f,ne.p=u,G.T=r}}n.current=i,Xt=2}}function W_(){if(Xt===2){Xt=0;var n=Xi,i=_o,r=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||r){r=G.T,G.T=null;var u=ne.p;ne.p=2;var f=Ze;Ze|=4;try{C_(n,i.alternate,i)}finally{Ze=f,ne.p=u,G.T=r}}Xt=3}}function Z_(){if(Xt===4||Xt===3){Xt=0,du();var n=Xi,i=_o,r=Eo,u=U_;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Xt=5:(Xt=0,_o=Xi=null,J_(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Qi=null),Lr(r),i=i.stateNode,We&&typeof We.onCommitFiberRoot=="function")try{We.onCommitFiberRoot(gt,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=G.T,f=ne.p,ne.p=2,G.T=null;try{for(var p=n.onRecoverableError,b=0;b<u.length;b++){var S=u[b];p(S.value,{componentStack:S.stack})}}finally{G.T=i,ne.p=f}}(Eo&3)!==0&&gd(),Vs(n),f=n.pendingLanes,(r&4194090)!==0&&(f&42)!==0?n===Im?nc++:(nc=0,Im=n):nc=0,sc(0)}}function J_(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,kl(i)))}function gd(n){return X_(),W_(),Z_(),eE()}function eE(){if(Xt!==5)return!1;var n=Xi,i=wm;wm=0;var r=Lr(Eo),u=G.T,f=ne.p;try{ne.p=32>r?32:r,G.T=null,r=Cm,Cm=null;var p=Xi,b=Eo;if(Xt=0,_o=Xi=null,Eo=0,(Ze&6)!==0)throw Error(a(331));var S=Ze;if(Ze|=4,V_(p.current),M_(p,p.current,b,r),Ze=S,sc(0,!1),We&&typeof We.onPostCommitFiberRoot=="function")try{We.onPostCommitFiberRoot(gt,p)}catch{}return!0}finally{ne.p=f,G.T=u,J_(n,i)}}function tE(n,i,r){i=Wn(r,i),i=om(n.stateNode,i,2),n=Fi(n,i,2),n!==null&&(Qs(n,2),Vs(n))}function at(n,i,r){if(n.tag===3)tE(n,n,r);else for(;i!==null;){if(i.tag===3){tE(i,n,r);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Qi===null||!Qi.has(u))){n=Wn(r,n),r=a_(2),u=Fi(i,r,2),u!==null&&(r_(r,u,i,n),Qs(u,2),Vs(u));break}}i=i.return}}function Om(n,i,r){var u=n.pingCache;if(u===null){u=n.pingCache=new jS;var f=new Set;u.set(i,f)}else f=u.get(i),f===void 0&&(f=new Set,u.set(i,f));f.has(r)||(Nm=!0,f.add(r),n=PS.bind(null,n,i,r),i.then(n,n))}function PS(n,i,r){var u=n.pingCache;u!==null&&u.delete(i),n.pingedLanes|=n.suspendedLanes&r,n.warmLanes&=~r,lt===n&&(Ge&r)===r&&(yt===4||yt===3&&(Ge&62914560)===Ge&&300>Gn()-Sm?(Ze&2)===0&&bo(n,0):xm|=r,yo===Ge&&(yo=0)),Vs(n)}function nE(n,i){i===0&&(i=hl()),n=no(n,i),n!==null&&(Qs(n,i),Vs(n))}function kS(n){var i=n.memoizedState,r=0;i!==null&&(r=i.retryLane),nE(n,r)}function VS(n,i){var r=0;switch(n.tag){case 13:var u=n.stateNode,f=n.memoizedState;f!==null&&(r=f.retryLane);break;case 19:u=n.stateNode;break;case 22:u=n.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(i),nE(n,r)}function LS(n,i){return Ma(n,i)}var vd=null,No=null,Mm=!1,yd=!1,Pm=!1,pr=0;function Vs(n){n!==No&&n.next===null&&(No===null?vd=No=n:No=No.next=n),yd=!0,Mm||(Mm=!0,FS())}function sc(n,i){if(!Pm&&yd){Pm=!0;do for(var r=!1,u=vd;u!==null;){if(n!==0){var f=u.pendingLanes;if(f===0)var p=0;else{var b=u.suspendedLanes,S=u.pingedLanes;p=(1<<31-on(42|n)+1)-1,p&=f&~(b&~S),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(r=!0,rE(u,p))}else p=Ge,p=Vr(u,u===lt?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(p&3)===0||Fa(u,p)||(r=!0,rE(u,p));u=u.next}while(r);Pm=!1}}function US(){sE()}function sE(){yd=Mm=!1;var n=0;pr!==0&&(YS()&&(n=pr),pr=0);for(var i=Gn(),r=null,u=vd;u!==null;){var f=u.next,p=iE(u,i);p===0?(u.next=null,r===null?vd=f:r.next=f,f===null&&(No=r)):(r=u,(n!==0||(p&3)!==0)&&(yd=!0)),u=f}sc(n)}function iE(n,i){for(var r=n.suspendedLanes,u=n.pingedLanes,f=n.expirationTimes,p=n.pendingLanes&-62914561;0<p;){var b=31-on(p),S=1<<b,k=f[b];k===-1?((S&r)===0||(S&u)!==0)&&(f[b]=ul(S,i)):k<=i&&(n.expiredLanes|=S),p&=~S}if(i=lt,r=Ge,r=Vr(n,n===i?r:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u=n.callbackNode,r===0||n===i&&(Je===2||Je===9)||n.cancelPendingCommit!==null)return u!==null&&u!==null&&Pa(u),n.callbackNode=null,n.callbackPriority=0;if((r&3)===0||Fa(n,r)){if(i=r&-r,i===n.callbackPriority)return i;switch(u!==null&&Pa(u),Lr(r)){case 2:case 8:r=Pr;break;case 32:r=ka;break;case 268435456:r=kr;break;default:r=ka}return u=aE.bind(null,n),r=Ma(r,u),n.callbackPriority=i,n.callbackNode=r,i}return u!==null&&u!==null&&Pa(u),n.callbackPriority=2,n.callbackNode=null,2}function aE(n,i){if(Xt!==0&&Xt!==5)return n.callbackNode=null,n.callbackPriority=0,null;var r=n.callbackNode;if(gd()&&n.callbackNode!==r)return null;var u=Ge;return u=Vr(n,n===lt?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u===0?null:(q_(n,u,i),iE(n,Gn()),n.callbackNode!=null&&n.callbackNode===r?aE.bind(null,n):null)}function rE(n,i){if(gd())return null;q_(n,i,!0)}function FS(){XS(function(){(Ze&6)!==0?Ma(ll,US):sE()})}function km(){return pr===0&&(pr=dl()),pr}function oE(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Hr(""+n)}function lE(n,i){var r=i.ownerDocument.createElement("input");return r.name=i.name,r.value=i.value,n.id&&r.setAttribute("form",n.id),i.parentNode.insertBefore(r,i),n=new FormData(n),r.parentNode.removeChild(r),n}function qS(n,i,r,u,f){if(i==="submit"&&r&&r.stateNode===f){var p=oE((f[At]||null).action),b=u.submitter;b&&(i=(i=b[At]||null)?oE(i.formAction):b.getAttribute("formAction"),i!==null&&(p=i,b=null));var S=new Gr("action","action",null,u,f);n.push({event:S,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(pr!==0){var k=b?lE(f,b):new FormData(f);nm(r,{pending:!0,data:k,method:f.method,action:p},null,k)}}else typeof p=="function"&&(S.preventDefault(),k=b?lE(f,b):new FormData(f),nm(r,{pending:!0,data:k,method:f.method,action:p},p,k))},currentTarget:f}]})}}for(var Vm=0;Vm<bf.length;Vm++){var Lm=bf[Vm],zS=Lm.toLowerCase(),BS=Lm[0].toUpperCase()+Lm.slice(1);us(zS,"on"+BS)}us(qv,"onAnimationEnd"),us(zv,"onAnimationIteration"),us(Bv,"onAnimationStart"),us("dblclick","onDoubleClick"),us("focusin","onFocus"),us("focusout","onBlur"),us(rS,"onTransitionRun"),us(oS,"onTransitionStart"),us(lS,"onTransitionCancel"),us(Hv,"onTransitionEnd"),Ws("onMouseEnter",["mouseout","mouseover"]),Ws("onMouseLeave",["mouseout","mouseover"]),Ws("onPointerEnter",["pointerout","pointerover"]),Ws("onPointerLeave",["pointerout","pointerover"]),ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ls("onBeforeInput",["compositionend","keypress","textInput","paste"]),ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ic="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ic));function cE(n,i){i=(i&4)!==0;for(var r=0;r<n.length;r++){var u=n[r],f=u.event;u=u.listeners;e:{var p=void 0;if(i)for(var b=u.length-1;0<=b;b--){var S=u[b],k=S.instance,Y=S.currentTarget;if(S=S.listener,k!==p&&f.isPropagationStopped())break e;p=S,f.currentTarget=Y;try{p(f)}catch(te){ad(te)}f.currentTarget=null,p=k}else for(b=0;b<u.length;b++){if(S=u[b],k=S.instance,Y=S.currentTarget,S=S.listener,k!==p&&f.isPropagationStopped())break e;p=S,f.currentTarget=Y;try{p(f)}catch(te){ad(te)}f.currentTarget=null,p=k}}}}function Le(n,i){var r=i[pl];r===void 0&&(r=i[pl]=new Set);var u=n+"__bubble";r.has(u)||(uE(i,n,2,!1),r.add(u))}function Um(n,i,r){var u=0;i&&(u|=4),uE(r,n,u,i)}var _d="_reactListening"+Math.random().toString(36).slice(2);function Fm(n){if(!n[_d]){n[_d]=!0,gl.forEach(function(r){r!=="selectionchange"&&(HS.has(r)||Um(r,!1,n),Um(r,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[_d]||(i[_d]=!0,Um("selectionchange",!1,i))}}function uE(n,i,r,u){switch(ME(i)){case 2:var f=vw;break;case 8:f=yw;break;default:f=ep}r=f.bind(null,i,r,n),f=void 0,!Qn||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),u?f!==void 0?n.addEventListener(i,r,{capture:!0,passive:f}):n.addEventListener(i,r,!0):f!==void 0?n.addEventListener(i,r,{passive:f}):n.addEventListener(i,r,!1)}function qm(n,i,r,u,f){var p=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var b=u.tag;if(b===3||b===4){var S=u.stateNode.containerInfo;if(S===f)break;if(b===4)for(b=u.return;b!==null;){var k=b.tag;if((k===3||k===4)&&b.stateNode.containerInfo===f)return;b=b.return}for(;S!==null;){if(b=Xs(S),b===null)return;if(k=b.tag,k===5||k===6||k===26||k===27){u=p=b;continue e}S=S.parentNode}}u=u.return}bu(function(){var Y=p,te=Yn(r),oe=[];e:{var Q=Gv.get(n);if(Q!==void 0){var X=Gr,Ce=n;switch(n){case"keypress":if(Cs(r)===0)break e;case"keydown":case"keyup":X=Wr;break;case"focusin":Ce="focus",X=Yr;break;case"focusout":Ce="blur",X=Yr;break;case"beforeblur":case"afterblur":X=Yr;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=Xn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=ff;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=Iu;break;case qv:case zv:case Bv:X=Qr;break;case Hv:X=Ru;break;case"scroll":case"scrollend":X=Tu;break;case"wheel":X=Zr;break;case"copy":case"cut":case"paste":X=Xr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=Cl;break;case"toggle":case"beforetoggle":X=Ou}var xe=(i&4)!==0,it=!xe&&(n==="scroll"||n==="scrollend"),B=xe?Q!==null?Q+"Capture":null:Q;xe=[];for(var q=Y,K;q!==null;){var se=q;if(K=se.stateNode,se=se.tag,se!==5&&se!==26&&se!==27||K===null||B===null||(se=Ya(q,B),se!=null&&xe.push(ac(q,se,K))),it)break;q=q.return}0<xe.length&&(Q=new X(Q,Ce,null,r,te),oe.push({event:Q,listeners:xe}))}}if((i&7)===0){e:{if(Q=n==="mouseover"||n==="pointerover",X=n==="mouseout"||n==="pointerout",Q&&r!==ei&&(Ce=r.relatedTarget||r.fromElement)&&(Xs(Ce)||Ce[$n]))break e;if((X||Q)&&(Q=te.window===te?te:(Q=te.ownerDocument)?Q.defaultView||Q.parentWindow:window,X?(Ce=r.relatedTarget||r.toElement,X=Y,Ce=Ce?Xs(Ce):null,Ce!==null&&(it=c(Ce),xe=Ce.tag,Ce!==it||xe!==5&&xe!==27&&xe!==6)&&(Ce=null)):(X=null,Ce=Y),X!==Ce)){if(xe=Xn,se="onMouseLeave",B="onMouseEnter",q="mouse",(n==="pointerout"||n==="pointerover")&&(xe=Cl,se="onPointerLeave",B="onPointerEnter",q="pointer"),it=X==null?Q:xs(X),K=Ce==null?Q:xs(Ce),Q=new xe(se,q+"leave",X,r,te),Q.target=it,Q.relatedTarget=K,se=null,Xs(te)===Y&&(xe=new xe(B,q+"enter",Ce,r,te),xe.target=K,xe.relatedTarget=it,se=xe),it=se,X&&Ce)t:{for(xe=X,B=Ce,q=0,K=xe;K;K=xo(K))q++;for(K=0,se=B;se;se=xo(se))K++;for(;0<q-K;)xe=xo(xe),q--;for(;0<K-q;)B=xo(B),K--;for(;q--;){if(xe===B||B!==null&&xe===B.alternate)break t;xe=xo(xe),B=xo(B)}xe=null}else xe=null;X!==null&&dE(oe,Q,X,xe,!1),Ce!==null&&it!==null&&dE(oe,it,Ce,xe,!0)}}e:{if(Q=Y?xs(Y):window,X=Q.nodeName&&Q.nodeName.toLowerCase(),X==="select"||X==="input"&&Q.type==="file")var pe=jv;else if(Ot(Q))if(Rv)pe=sS;else{pe=tS;var ke=eS}else X=Q.nodeName,!X||X.toLowerCase()!=="input"||Q.type!=="checkbox"&&Q.type!=="radio"?Y&&bl(Y.elementType)&&(pe=jv):pe=nS;if(pe&&(pe=pe(n,Y))){ai(oe,pe,r,te);break e}ke&&ke(n,Q,Y),n==="focusout"&&Y&&Q.type==="number"&&Y.memoizedProps.value!=null&&Pi(Q,"number",Q.value)}switch(ke=Y?xs(Y):window,n){case"focusin":(Ot(ke)||ke.contentEditable==="true")&&(Jr=ke,yf=Y,Rl=null);break;case"focusout":Rl=yf=Jr=null;break;case"mousedown":_f=!0;break;case"contextmenu":case"mouseup":case"dragend":_f=!1,Uv(oe,r,te);break;case"selectionchange":if(aS)break;case"keydown":case"keyup":Uv(oe,r,te)}var _e;if(Rs)e:{switch(n){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else Be?Z(n,r)&&(Ae="onCompositionEnd"):n==="keydown"&&r.keyCode===229&&(Ae="onCompositionStart");Ae&&(E&&r.locale!=="ko"&&(Be||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&Be&&(_e=Nl()):(ws=te,ki="value"in ws?ws.value:ws.textContent,Be=!0)),ke=Ed(Y,Ae),0<ke.length&&(Ae=new Sl(Ae,n,null,r,te),oe.push({event:Ae,listeners:ke}),_e?Ae.data=_e:(_e=de(r),_e!==null&&(Ae.data=_e)))),(_e=y?Dt(n,r):He(n,r))&&(Ae=Ed(Y,"onBeforeInput"),0<Ae.length&&(ke=new Sl("onBeforeInput","beforeinput",null,r,te),oe.push({event:ke,listeners:Ae}),ke.data=_e)),qS(oe,n,Y,r,te)}cE(oe,i)})}function ac(n,i,r){return{instance:n,listener:i,currentTarget:r}}function Ed(n,i){for(var r=i+"Capture",u=[];n!==null;){var f=n,p=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||p===null||(f=Ya(n,r),f!=null&&u.unshift(ac(n,f,p)),f=Ya(n,i),f!=null&&u.push(ac(n,f,p))),n.tag===3)return u;n=n.return}return[]}function xo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function dE(n,i,r,u,f){for(var p=i._reactName,b=[];r!==null&&r!==u;){var S=r,k=S.alternate,Y=S.stateNode;if(S=S.tag,k!==null&&k===u)break;S!==5&&S!==26&&S!==27||Y===null||(k=Y,f?(Y=Ya(r,p),Y!=null&&b.unshift(ac(r,Y,k))):f||(Y=Ya(r,p),Y!=null&&b.push(ac(r,Y,k)))),r=r.return}b.length!==0&&n.push({event:i,listeners:b})}var GS=/\r\n?/g,$S=/\u0000|\uFFFD/g;function hE(n){return(typeof n=="string"?n:""+n).replace(GS,`
`).replace($S,"")}function fE(n,i){return i=hE(i),hE(n)===i}function bd(){}function st(n,i,r,u,f,p){switch(r){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||Kn(n,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&Kn(n,""+u);break;case"className":As(n,"class",u);break;case"tabIndex":As(n,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":As(n,r,u);break;case"style":El(n,u,p);break;case"data":if(i!=="object"){As(n,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||r!=="href")){n.removeAttribute(r);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(r);break}u=Hr(""+u),n.setAttribute(r,u);break;case"action":case"formAction":if(typeof u=="function"){n.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(r==="formAction"?(i!=="input"&&st(n,i,"name",f.name,f,null),st(n,i,"formEncType",f.formEncType,f,null),st(n,i,"formMethod",f.formMethod,f,null),st(n,i,"formTarget",f.formTarget,f,null)):(st(n,i,"encType",f.encType,f,null),st(n,i,"method",f.method,f,null),st(n,i,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(r);break}u=Hr(""+u),n.setAttribute(r,u);break;case"onClick":u!=null&&(n.onclick=bd);break;case"onScroll":u!=null&&Le("scroll",n);break;case"onScrollEnd":u!=null&&Le("scrollend",n);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(r=u.__html,r!=null){if(f.children!=null)throw Error(a(60));n.innerHTML=r}}break;case"multiple":n.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":n.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){n.removeAttribute("xlink:href");break}r=Hr(""+u),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(r,""+u):n.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(r,""):n.removeAttribute(r);break;case"capture":case"download":u===!0?n.setAttribute(r,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(r,u):n.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?n.setAttribute(r,u):n.removeAttribute(r);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?n.removeAttribute(r):n.setAttribute(r,u);break;case"popover":Le("beforetoggle",n),Le("toggle",n),Mi(n,"popover",u);break;case"xlinkActuate":Kt(n,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Kt(n,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Kt(n,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Kt(n,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Kt(n,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Kt(n,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Kt(n,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Kt(n,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Kt(n,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Mi(n,"is",u);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=df.get(r)||r,Mi(n,r,u))}}function zm(n,i,r,u,f,p){switch(r){case"style":El(n,u,p);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(r=u.__html,r!=null){if(f.children!=null)throw Error(a(60));n.innerHTML=r}}break;case"children":typeof u=="string"?Kn(n,u):(typeof u=="number"||typeof u=="bigint")&&Kn(n,""+u);break;case"onScroll":u!=null&&Le("scroll",n);break;case"onScrollEnd":u!=null&&Le("scrollend",n);break;case"onClick":u!=null&&(n.onclick=bd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ur.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(f=r.endsWith("Capture"),i=r.slice(2,f?r.length-7:void 0),p=n[At]||null,p=p!=null?p[r]:null,typeof p=="function"&&n.removeEventListener(i,p,f),typeof u=="function")){typeof p!="function"&&p!==null&&(r in n?n[r]=null:n.hasAttribute(r)&&n.removeAttribute(r)),n.addEventListener(i,u,f);break e}r in n?n[r]=u:u===!0?n.setAttribute(r,""):Mi(n,r,u)}}}function Wt(n,i,r){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Le("error",n),Le("load",n);var u=!1,f=!1,p;for(p in r)if(r.hasOwnProperty(p)){var b=r[p];if(b!=null)switch(p){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:st(n,i,p,b,r,null)}}f&&st(n,i,"srcSet",r.srcSet,r,null),u&&st(n,i,"src",r.src,r,null);return;case"input":Le("invalid",n);var S=p=b=f=null,k=null,Y=null;for(u in r)if(r.hasOwnProperty(u)){var te=r[u];if(te!=null)switch(u){case"name":f=te;break;case"type":b=te;break;case"checked":k=te;break;case"defaultChecked":Y=te;break;case"value":p=te;break;case"defaultValue":S=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(a(137,i));break;default:st(n,i,u,te,r,null)}}Ga(n,p,S,k,Y,b,f,!1),Br(n);return;case"select":Le("invalid",n),u=b=p=null;for(f in r)if(r.hasOwnProperty(f)&&(S=r[f],S!=null))switch(f){case"value":p=S;break;case"defaultValue":b=S;break;case"multiple":u=S;default:st(n,i,f,S,r,null)}i=p,r=b,n.multiple=!!u,i!=null?Js(n,!!u,i,!1):r!=null&&Js(n,!!u,r,!0);return;case"textarea":Le("invalid",n),p=f=u=null;for(b in r)if(r.hasOwnProperty(b)&&(S=r[b],S!=null))switch(b){case"value":u=S;break;case"defaultValue":f=S;break;case"children":p=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(a(91));break;default:st(n,i,b,S,r,null)}$a(n,u,f,p),Br(n);return;case"option":for(k in r)if(r.hasOwnProperty(k)&&(u=r[k],u!=null))switch(k){case"selected":n.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:st(n,i,k,u,r,null)}return;case"dialog":Le("beforetoggle",n),Le("toggle",n),Le("cancel",n),Le("close",n);break;case"iframe":case"object":Le("load",n);break;case"video":case"audio":for(u=0;u<ic.length;u++)Le(ic[u],n);break;case"image":Le("error",n),Le("load",n);break;case"details":Le("toggle",n);break;case"embed":case"source":case"link":Le("error",n),Le("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Y in r)if(r.hasOwnProperty(Y)&&(u=r[Y],u!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:st(n,i,Y,u,r,null)}return;default:if(bl(i)){for(te in r)r.hasOwnProperty(te)&&(u=r[te],u!==void 0&&zm(n,i,te,u,r,void 0));return}}for(S in r)r.hasOwnProperty(S)&&(u=r[S],u!=null&&st(n,i,S,u,r,null))}function KS(n,i,r,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,p=null,b=null,S=null,k=null,Y=null,te=null;for(X in r){var oe=r[X];if(r.hasOwnProperty(X)&&oe!=null)switch(X){case"checked":break;case"value":break;case"defaultValue":k=oe;default:u.hasOwnProperty(X)||st(n,i,X,null,u,oe)}}for(var Q in u){var X=u[Q];if(oe=r[Q],u.hasOwnProperty(Q)&&(X!=null||oe!=null))switch(Q){case"type":p=X;break;case"name":f=X;break;case"checked":Y=X;break;case"defaultChecked":te=X;break;case"value":b=X;break;case"defaultValue":S=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(a(137,i));break;default:X!==oe&&st(n,i,Q,X,u,oe)}}Rn(n,b,S,k,Y,te,p,f);return;case"select":X=b=S=Q=null;for(p in r)if(k=r[p],r.hasOwnProperty(p)&&k!=null)switch(p){case"value":break;case"multiple":X=k;default:u.hasOwnProperty(p)||st(n,i,p,null,u,k)}for(f in u)if(p=u[f],k=r[f],u.hasOwnProperty(f)&&(p!=null||k!=null))switch(f){case"value":Q=p;break;case"defaultValue":S=p;break;case"multiple":b=p;default:p!==k&&st(n,i,f,p,u,k)}i=S,r=b,u=X,Q!=null?Js(n,!!r,Q,!1):!!u!=!!r&&(i!=null?Js(n,!!r,i,!0):Js(n,!!r,r?[]:"",!1));return;case"textarea":X=Q=null;for(S in r)if(f=r[S],r.hasOwnProperty(S)&&f!=null&&!u.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:st(n,i,S,null,u,f)}for(b in u)if(f=u[b],p=r[b],u.hasOwnProperty(b)&&(f!=null||p!=null))switch(b){case"value":Q=f;break;case"defaultValue":X=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==p&&st(n,i,b,f,u,p)}tt(n,Q,X);return;case"option":for(var Ce in r)if(Q=r[Ce],r.hasOwnProperty(Ce)&&Q!=null&&!u.hasOwnProperty(Ce))switch(Ce){case"selected":n.selected=!1;break;default:st(n,i,Ce,null,u,Q)}for(k in u)if(Q=u[k],X=r[k],u.hasOwnProperty(k)&&Q!==X&&(Q!=null||X!=null))switch(k){case"selected":n.selected=Q&&typeof Q!="function"&&typeof Q!="symbol";break;default:st(n,i,k,Q,u,X)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xe in r)Q=r[xe],r.hasOwnProperty(xe)&&Q!=null&&!u.hasOwnProperty(xe)&&st(n,i,xe,null,u,Q);for(Y in u)if(Q=u[Y],X=r[Y],u.hasOwnProperty(Y)&&Q!==X&&(Q!=null||X!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(a(137,i));break;default:st(n,i,Y,Q,u,X)}return;default:if(bl(i)){for(var it in r)Q=r[it],r.hasOwnProperty(it)&&Q!==void 0&&!u.hasOwnProperty(it)&&zm(n,i,it,void 0,u,Q);for(te in u)Q=u[te],X=r[te],!u.hasOwnProperty(te)||Q===X||Q===void 0&&X===void 0||zm(n,i,te,Q,u,X);return}}for(var B in r)Q=r[B],r.hasOwnProperty(B)&&Q!=null&&!u.hasOwnProperty(B)&&st(n,i,B,null,u,Q);for(oe in u)Q=u[oe],X=r[oe],!u.hasOwnProperty(oe)||Q===X||Q==null&&X==null||st(n,i,oe,Q,u,X)}var Bm=null,Hm=null;function Td(n){return n.nodeType===9?n:n.ownerDocument}function mE(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function pE(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function Gm(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var $m=null;function YS(){var n=window.event;return n&&n.type==="popstate"?n===$m?!1:($m=n,!0):($m=null,!1)}var gE=typeof setTimeout=="function"?setTimeout:void 0,QS=typeof clearTimeout=="function"?clearTimeout:void 0,vE=typeof Promise=="function"?Promise:void 0,XS=typeof queueMicrotask=="function"?queueMicrotask:typeof vE<"u"?function(n){return vE.resolve(null).then(n).catch(WS)}:gE;function WS(n){setTimeout(function(){throw n})}function Zi(n){return n==="head"}function yE(n,i){var r=i,u=0,f=0;do{var p=r.nextSibling;if(n.removeChild(r),p&&p.nodeType===8)if(r=p.data,r==="/$"){if(0<u&&8>u){r=u;var b=n.ownerDocument;if(r&1&&rc(b.documentElement),r&2&&rc(b.body),r&4)for(r=b.head,rc(r),b=r.firstChild;b;){var S=b.nextSibling,k=b.nodeName;b[qa]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&b.rel.toLowerCase()==="stylesheet"||r.removeChild(b),b=S}}if(f===0){n.removeChild(p),mc(i);return}f--}else r==="$"||r==="$?"||r==="$!"?f++:u=r.charCodeAt(0)-48;else u=0;r=p}while(r);mc(i)}function Km(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var r=i;switch(i=i.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Km(r),Oi(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}n.removeChild(r)}}function ZS(n,i,r,u){for(;n.nodeType===1;){var f=r;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(u){if(!n[qa])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(p=n.getAttribute("rel"),p==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(p!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(p=n.getAttribute("src"),(p!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&p&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var p=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===p)return n}else return n;if(n=hs(n.nextSibling),n===null)break}return null}function JS(n,i,r){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=hs(n.nextSibling),n===null))return null;return n}function Ym(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function ew(n,i){var r=n.ownerDocument;if(n.data!=="$?"||r.readyState==="complete")i();else{var u=function(){i(),r.removeEventListener("DOMContentLoaded",u)};r.addEventListener("DOMContentLoaded",u),n._reactRetry=u}}function hs(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return n}var Qm=null;function _E(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var r=n.data;if(r==="$"||r==="$!"||r==="$?"){if(i===0)return n;i--}else r==="/$"&&i++}n=n.previousSibling}return null}function EE(n,i,r){switch(i=Td(r),n){case"html":if(n=i.documentElement,!n)throw Error(a(452));return n;case"head":if(n=i.head,!n)throw Error(a(453));return n;case"body":if(n=i.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function rc(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);Oi(n)}var ss=new Map,bE=new Set;function Nd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var yi=ne.d;ne.d={f:tw,r:nw,D:sw,C:iw,L:aw,m:rw,X:lw,S:ow,M:cw};function tw(){var n=yi.f(),i=md();return n||i}function nw(n){var i=Ns(n);i!==null&&i.tag===5&&i.type==="form"?qy(i):yi.r(n)}var Ao=typeof document>"u"?null:document;function TE(n,i,r){var u=Ao;if(u&&typeof i=="string"&&i){var f=St(i);f='link[rel="'+n+'"][href="'+f+'"]',typeof r=="string"&&(f+='[crossorigin="'+r+'"]'),bE.has(f)||(bE.add(f),n={rel:n,crossOrigin:r,href:i},u.querySelector(f)===null&&(i=u.createElement("link"),Wt(i,"link",n),Et(i),u.head.appendChild(i)))}}function sw(n){yi.D(n),TE("dns-prefetch",n,null)}function iw(n,i){yi.C(n,i),TE("preconnect",n,i)}function aw(n,i,r){yi.L(n,i,r);var u=Ao;if(u&&n&&i){var f='link[rel="preload"][as="'+St(i)+'"]';i==="image"&&r&&r.imageSrcSet?(f+='[imagesrcset="'+St(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(f+='[imagesizes="'+St(r.imageSizes)+'"]')):f+='[href="'+St(n)+'"]';var p=f;switch(i){case"style":p=So(n);break;case"script":p=wo(n)}ss.has(p)||(n=_({rel:"preload",href:i==="image"&&r&&r.imageSrcSet?void 0:n,as:i},r),ss.set(p,n),u.querySelector(f)!==null||i==="style"&&u.querySelector(oc(p))||i==="script"&&u.querySelector(lc(p))||(i=u.createElement("link"),Wt(i,"link",n),Et(i),u.head.appendChild(i)))}}function rw(n,i){yi.m(n,i);var r=Ao;if(r&&n){var u=i&&typeof i.as=="string"?i.as:"script",f='link[rel="modulepreload"][as="'+St(u)+'"][href="'+St(n)+'"]',p=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=wo(n)}if(!ss.has(p)&&(n=_({rel:"modulepreload",href:n},i),ss.set(p,n),r.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(lc(p)))return}u=r.createElement("link"),Wt(u,"link",n),Et(u),r.head.appendChild(u)}}}function ow(n,i,r){yi.S(n,i,r);var u=Ao;if(u&&n){var f=pn(u).hoistableStyles,p=So(n);i=i||"default";var b=f.get(p);if(!b){var S={loading:0,preload:null};if(b=u.querySelector(oc(p)))S.loading=5;else{n=_({rel:"stylesheet",href:n,"data-precedence":i},r),(r=ss.get(p))&&Xm(n,r);var k=b=u.createElement("link");Et(k),Wt(k,"link",n),k._p=new Promise(function(Y,te){k.onload=Y,k.onerror=te}),k.addEventListener("load",function(){S.loading|=1}),k.addEventListener("error",function(){S.loading|=2}),S.loading|=4,xd(b,i,u)}b={type:"stylesheet",instance:b,count:1,state:S},f.set(p,b)}}}function lw(n,i){yi.X(n,i);var r=Ao;if(r&&n){var u=pn(r).hoistableScripts,f=wo(n),p=u.get(f);p||(p=r.querySelector(lc(f)),p||(n=_({src:n,async:!0},i),(i=ss.get(f))&&Wm(n,i),p=r.createElement("script"),Et(p),Wt(p,"link",n),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function cw(n,i){yi.M(n,i);var r=Ao;if(r&&n){var u=pn(r).hoistableScripts,f=wo(n),p=u.get(f);p||(p=r.querySelector(lc(f)),p||(n=_({src:n,async:!0,type:"module"},i),(i=ss.get(f))&&Wm(n,i),p=r.createElement("script"),Et(p),Wt(p,"link",n),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function NE(n,i,r,u){var f=(f=Ie.current)?Nd(f):null;if(!f)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(i=So(r.href),r=pn(f).hoistableStyles,u=r.get(i),u||(u={type:"style",instance:null,count:0,state:null},r.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){n=So(r.href);var p=pn(f).hoistableStyles,b=p.get(n);if(b||(f=f.ownerDocument||f,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(n,b),(p=f.querySelector(oc(n)))&&!p._p&&(b.instance=p,b.state.loading=5),ss.has(n)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},ss.set(n,r),p||uw(f,n,r,b.state))),i&&u===null)throw Error(a(528,""));return b}if(i&&u!==null)throw Error(a(529,""));return null;case"script":return i=r.async,r=r.src,typeof r=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=wo(r),r=pn(f).hoistableScripts,u=r.get(i),u||(u={type:"script",instance:null,count:0,state:null},r.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function So(n){return'href="'+St(n)+'"'}function oc(n){return'link[rel="stylesheet"]['+n+"]"}function xE(n){return _({},n,{"data-precedence":n.precedence,precedence:null})}function uw(n,i,r,u){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=n.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),Wt(i,"link",r),Et(i),n.head.appendChild(i))}function wo(n){return'[src="'+St(n)+'"]'}function lc(n){return"script[async]"+n}function AE(n,i,r){if(i.count++,i.instance===null)switch(i.type){case"style":var u=n.querySelector('style[data-href~="'+St(r.href)+'"]');if(u)return i.instance=u,Et(u),u;var f=_({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return u=(n.ownerDocument||n).createElement("style"),Et(u),Wt(u,"style",f),xd(u,r.precedence,n),i.instance=u;case"stylesheet":f=So(r.href);var p=n.querySelector(oc(f));if(p)return i.state.loading|=4,i.instance=p,Et(p),p;u=xE(r),(f=ss.get(f))&&Xm(u,f),p=(n.ownerDocument||n).createElement("link"),Et(p);var b=p;return b._p=new Promise(function(S,k){b.onload=S,b.onerror=k}),Wt(p,"link",u),i.state.loading|=4,xd(p,r.precedence,n),i.instance=p;case"script":return p=wo(r.src),(f=n.querySelector(lc(p)))?(i.instance=f,Et(f),f):(u=r,(f=ss.get(p))&&(u=_({},r),Wm(u,f)),n=n.ownerDocument||n,f=n.createElement("script"),Et(f),Wt(f,"link",u),n.head.appendChild(f),i.instance=f);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,xd(u,r.precedence,n));return i.instance}function xd(n,i,r){for(var u=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,p=f,b=0;b<u.length;b++){var S=u[b];if(S.dataset.precedence===i)p=S;else if(p!==f)break}p?p.parentNode.insertBefore(n,p.nextSibling):(i=r.nodeType===9?r.head:r,i.insertBefore(n,i.firstChild))}function Xm(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function Wm(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var Ad=null;function SE(n,i,r){if(Ad===null){var u=new Map,f=Ad=new Map;f.set(r,u)}else f=Ad,u=f.get(r),u||(u=new Map,f.set(r,u));if(u.has(n))return u;for(u.set(n,null),r=r.getElementsByTagName(n),f=0;f<r.length;f++){var p=r[f];if(!(p[qa]||p[Rt]||n==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var b=p.getAttribute(i)||"";b=n+b;var S=u.get(b);S?S.push(p):u.set(b,[p])}}return u}function wE(n,i,r){n=n.ownerDocument||n,n.head.insertBefore(r,i==="title"?n.querySelector("head > title"):null)}function dw(n,i,r){if(r===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return n=i.disabled,typeof i.precedence=="string"&&n==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function CE(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var cc=null;function hw(){}function fw(n,i,r){if(cc===null)throw Error(a(475));var u=cc;if(i.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var f=So(r.href),p=n.querySelector(oc(f));if(p){n=p._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(u.count++,u=Sd.bind(u),n.then(u,u)),i.state.loading|=4,i.instance=p,Et(p);return}p=n.ownerDocument||n,r=xE(r),(f=ss.get(f))&&Xm(r,f),p=p.createElement("link"),Et(p);var b=p;b._p=new Promise(function(S,k){b.onload=S,b.onerror=k}),Wt(p,"link",r),i.instance=p}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(i,n),(n=i.state.preload)&&(i.state.loading&3)===0&&(u.count++,i=Sd.bind(u),n.addEventListener("load",i),n.addEventListener("error",i))}}function mw(){if(cc===null)throw Error(a(475));var n=cc;return n.stylesheets&&n.count===0&&Zm(n,n.stylesheets),0<n.count?function(i){var r=setTimeout(function(){if(n.stylesheets&&Zm(n,n.stylesheets),n.unsuspend){var u=n.unsuspend;n.unsuspend=null,u()}},6e4);return n.unsuspend=i,function(){n.unsuspend=null,clearTimeout(r)}}:null}function Sd(){if(this.count--,this.count===0){if(this.stylesheets)Zm(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var wd=null;function Zm(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,wd=new Map,i.forEach(pw,n),wd=null,Sd.call(n))}function pw(n,i){if(!(i.state.loading&4)){var r=wd.get(n);if(r)var u=r.get(null);else{r=new Map,wd.set(n,r);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<f.length;p++){var b=f[p];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(r.set(b.dataset.precedence,b),u=b)}u&&r.set(null,u)}f=i.instance,b=f.getAttribute("data-precedence"),p=r.get(b)||u,p===u&&r.set(null,f),r.set(b,f),this.count++,u=Sd.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),p?p.parentNode.insertBefore(f,p.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),i.state.loading|=4}}var uc={$$typeof:H,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function gw(n,i,r,u,f,p,b,S){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ys(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ys(0),this.hiddenUpdates=Ys(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=p,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=S,this.incompleteTransitions=new Map}function IE(n,i,r,u,f,p,b,S,k,Y,te,oe){return n=new gw(n,i,r,b,S,k,Y,oe),i=1,p===!0&&(i|=24),p=On(3,null,null,i),n.current=p,p.stateNode=n,i=Of(),i.refCount++,n.pooledCache=i,i.refCount++,p.memoizedState={element:u,isDehydrated:r,cache:i},Vf(p),n}function jE(n){return n?(n=so,n):so}function RE(n,i,r,u,f,p){f=jE(f),u.context===null?u.context=f:u.pendingContext=f,u=Ui(i),u.payload={element:r},p=p===void 0?null:p,p!==null&&(u.callback=p),r=Fi(n,u,i),r!==null&&(Ln(r,n,i),Fl(r,n,i))}function DE(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var r=n.retryLane;n.retryLane=r!==0&&r<i?r:i}}function Jm(n,i){DE(n,i),(n=n.alternate)&&DE(n,i)}function OE(n){if(n.tag===13){var i=no(n,67108864);i!==null&&Ln(i,n,67108864),Jm(n,67108864)}}var Cd=!0;function vw(n,i,r,u){var f=G.T;G.T=null;var p=ne.p;try{ne.p=2,ep(n,i,r,u)}finally{ne.p=p,G.T=f}}function yw(n,i,r,u){var f=G.T;G.T=null;var p=ne.p;try{ne.p=8,ep(n,i,r,u)}finally{ne.p=p,G.T=f}}function ep(n,i,r,u){if(Cd){var f=tp(u);if(f===null)qm(n,i,u,Id,r),PE(n,u);else if(Ew(f,n,i,r,u))u.stopPropagation();else if(PE(n,u),i&4&&-1<_w.indexOf(n)){for(;f!==null;){var p=Ns(f);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var b=os(p.pendingLanes);if(b!==0){var S=p;for(S.pendingLanes|=2,S.entangledLanes|=2;b;){var k=1<<31-on(b);S.entanglements[1]|=k,b&=~k}Vs(p),(Ze&6)===0&&(hd=Gn()+500,sc(0))}}break;case 13:S=no(p,2),S!==null&&Ln(S,p,2),md(),Jm(p,2)}if(p=tp(u),p===null&&qm(n,i,u,Id,r),p===f)break;f=p}f!==null&&u.stopPropagation()}else qm(n,i,u,null,r)}}function tp(n){return n=Yn(n),np(n)}var Id=null;function np(n){if(Id=null,n=Xs(n),n!==null){var i=c(n);if(i===null)n=null;else{var r=i.tag;if(r===13){if(n=d(i),n!==null)return n;n=null}else if(r===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return Id=n,null}function ME(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(af()){case ll:return 2;case Pr:return 8;case ka:case rf:return 32;case kr:return 268435456;default:return 32}default:return 32}}var sp=!1,Ji=null,ea=null,ta=null,dc=new Map,hc=new Map,na=[],_w="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function PE(n,i){switch(n){case"focusin":case"focusout":Ji=null;break;case"dragenter":case"dragleave":ea=null;break;case"mouseover":case"mouseout":ta=null;break;case"pointerover":case"pointerout":dc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":hc.delete(i.pointerId)}}function fc(n,i,r,u,f,p){return n===null||n.nativeEvent!==p?(n={blockedOn:i,domEventName:r,eventSystemFlags:u,nativeEvent:p,targetContainers:[f]},i!==null&&(i=Ns(i),i!==null&&OE(i)),n):(n.eventSystemFlags|=u,i=n.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),n)}function Ew(n,i,r,u,f){switch(i){case"focusin":return Ji=fc(Ji,n,i,r,u,f),!0;case"dragenter":return ea=fc(ea,n,i,r,u,f),!0;case"mouseover":return ta=fc(ta,n,i,r,u,f),!0;case"pointerover":var p=f.pointerId;return dc.set(p,fc(dc.get(p)||null,n,i,r,u,f)),!0;case"gotpointercapture":return p=f.pointerId,hc.set(p,fc(hc.get(p)||null,n,i,r,u,f)),!0}return!1}function kE(n){var i=Xs(n.target);if(i!==null){var r=c(i);if(r!==null){if(i=r.tag,i===13){if(i=d(r),i!==null){n.blockedOn=i,mu(n.priority,function(){if(r.tag===13){var u=Vn();u=ji(u);var f=no(r,u);f!==null&&Ln(f,r,u),Jm(r,u)}});return}}else if(i===3&&r.stateNode.current.memoizedState.isDehydrated){n.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}n.blockedOn=null}function jd(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var r=tp(n.nativeEvent);if(r===null){r=n.nativeEvent;var u=new r.constructor(r.type,r);ei=u,r.target.dispatchEvent(u),ei=null}else return i=Ns(r),i!==null&&OE(i),n.blockedOn=r,!1;i.shift()}return!0}function VE(n,i,r){jd(n)&&r.delete(i)}function bw(){sp=!1,Ji!==null&&jd(Ji)&&(Ji=null),ea!==null&&jd(ea)&&(ea=null),ta!==null&&jd(ta)&&(ta=null),dc.forEach(VE),hc.forEach(VE)}function Rd(n,i){n.blockedOn===i&&(n.blockedOn=null,sp||(sp=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,bw)))}var Dd=null;function LE(n){Dd!==n&&(Dd=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Dd===n&&(Dd=null);for(var i=0;i<n.length;i+=3){var r=n[i],u=n[i+1],f=n[i+2];if(typeof u!="function"){if(np(u||r)===null)continue;break}var p=Ns(r);p!==null&&(n.splice(i,3),i-=3,nm(p,{pending:!0,data:f,method:r.method,action:u},u,f))}}))}function mc(n){function i(k){return Rd(k,n)}Ji!==null&&Rd(Ji,n),ea!==null&&Rd(ea,n),ta!==null&&Rd(ta,n),dc.forEach(i),hc.forEach(i);for(var r=0;r<na.length;r++){var u=na[r];u.blockedOn===n&&(u.blockedOn=null)}for(;0<na.length&&(r=na[0],r.blockedOn===null);)kE(r),r.blockedOn===null&&na.shift();if(r=(n.ownerDocument||n).$$reactFormReplay,r!=null)for(u=0;u<r.length;u+=3){var f=r[u],p=r[u+1],b=f[At]||null;if(typeof p=="function")b||LE(r);else if(b){var S=null;if(p&&p.hasAttribute("formAction")){if(f=p,b=p[At]||null)S=b.formAction;else if(np(f)!==null)continue}else S=b.action;typeof S=="function"?r[u+1]=S:(r.splice(u,3),u-=3),LE(r)}}}function ip(n){this._internalRoot=n}Od.prototype.render=ip.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(a(409));var r=i.current,u=Vn();RE(r,u,n,i,null,null)},Od.prototype.unmount=ip.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;RE(n.current,2,null,n,null,null),md(),i[$n]=null}};function Od(n){this._internalRoot=n}Od.prototype.unstable_scheduleHydration=function(n){if(n){var i=Ri();n={blockedOn:null,target:n,priority:i};for(var r=0;r<na.length&&i!==0&&i<na[r].priority;r++);na.splice(r,0,n),r===0&&kE(n)}};var UE=e.version;if(UE!=="19.1.0")throw Error(a(527,UE,"19.1.0"));ne.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=g(i),n=n!==null?v(n):null,n=n===null?null:n.stateNode,n};var Tw={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Md=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Md.isDisabled&&Md.supportsFiber)try{gt=Md.inject(Tw),We=Md}catch{}}return gc.createRoot=function(n,i){if(!o(n))throw Error(a(299));var r=!1,u="",f=t_,p=n_,b=s_,S=null;return i!=null&&(i.unstable_strictMode===!0&&(r=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(f=i.onUncaughtError),i.onCaughtError!==void 0&&(p=i.onCaughtError),i.onRecoverableError!==void 0&&(b=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(S=i.unstable_transitionCallbacks)),i=IE(n,1,!1,null,null,r,u,f,p,b,S,null),n[$n]=i.current,Fm(n),new ip(i)},gc.hydrateRoot=function(n,i,r){if(!o(n))throw Error(a(299));var u=!1,f="",p=t_,b=n_,S=s_,k=null,Y=null;return r!=null&&(r.unstable_strictMode===!0&&(u=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(p=r.onUncaughtError),r.onCaughtError!==void 0&&(b=r.onCaughtError),r.onRecoverableError!==void 0&&(S=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(k=r.unstable_transitionCallbacks),r.formState!==void 0&&(Y=r.formState)),i=IE(n,1,!0,i,r??null,u,f,p,b,S,k,Y),i.context=jE(null),r=i.current,u=Vn(),u=ji(u),f=Ui(u),f.callback=null,Fi(r,f,u),r=u,i.current.lanes=r,Qs(i,r),Vs(i),n[$n]=i.current,Fm(n),new Od(i)},gc.version="19.1.0",gc}var QE;function Dw(){if(QE)return op.exports;QE=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),op.exports=Rw(),op.exports}var Ow=Dw();const Mw=()=>{};var XE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lN=function(s){const e=[];let t=0;for(let a=0;a<s.length;a++){let o=s.charCodeAt(a);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&a+1<s.length&&(s.charCodeAt(a+1)&64512)===56320?(o=65536+((o&1023)<<10)+(s.charCodeAt(++a)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},Pw=function(s){const e=[];let t=0,a=0;for(;t<s.length;){const o=s[t++];if(o<128)e[a++]=String.fromCharCode(o);else if(o>191&&o<224){const c=s[t++];e[a++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=s[t++],d=s[t++],m=s[t++],g=((o&7)<<18|(c&63)<<12|(d&63)<<6|m&63)-65536;e[a++]=String.fromCharCode(55296+(g>>10)),e[a++]=String.fromCharCode(56320+(g&1023))}else{const c=s[t++],d=s[t++];e[a++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},cN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let o=0;o<s.length;o+=3){const c=s[o],d=o+1<s.length,m=d?s[o+1]:0,g=o+2<s.length,v=g?s[o+2]:0,_=c>>2,T=(c&3)<<4|m>>4;let N=(m&15)<<2|v>>6,C=v&63;g||(C=64,d||(N=64)),a.push(t[_],t[T],t[N],t[C])}return a.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(lN(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):Pw(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let o=0;o<s.length;){const c=t[s.charAt(o++)],m=o<s.length?t[s.charAt(o)]:0;++o;const v=o<s.length?t[s.charAt(o)]:64;++o;const T=o<s.length?t[s.charAt(o)]:64;if(++o,c==null||m==null||v==null||T==null)throw new kw;const N=c<<2|m>>4;if(a.push(N),v!==64){const C=m<<4&240|v>>2;if(a.push(C),T!==64){const w=v<<6&192|T;a.push(w)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class kw extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Vw=function(s){const e=lN(s);return cN.encodeByteArray(e,!0)},nh=function(s){return Vw(s).replace(/\./g,"")},uN=function(s){try{return cN.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw=()=>Lw().__FIREBASE_DEFAULTS__,Fw=()=>{if(typeof process>"u"||typeof XE>"u")return;const s=XE.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},qw=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&uN(s[1]);return e&&JSON.parse(e)},Ch=()=>{try{return Mw()||Uw()||Fw()||qw()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},dN=s=>{var e,t;return(t=(e=Ch())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[s]},hN=s=>{const e=dN(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},fN=()=>{var s;return(s=Ch())===null||s===void 0?void 0:s.config},mN=s=>{var e;return(e=Ch())===null||e===void 0?void 0:e[`_${s}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jr(s){return s.endsWith(".cloudworkstations.dev")}async function dg(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pN(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",o=s.iat||0,c=s.sub||s.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${a}`,aud:a,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},s);return[nh(JSON.stringify(t)),nh(JSON.stringify(d)),""].join(".")}const Nc={};function Bw(){const s={prod:[],emulator:[]};for(const e of Object.keys(Nc))Nc[e]?s.emulator.push(e):s.prod.push(e);return s}function Hw(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let WE=!1;function hg(s,e){if(typeof window>"u"||typeof document>"u"||!jr(window.location.host)||Nc[s]===e||Nc[s]||WE)return;Nc[s]=e;function t(N){return`__firebase__banner__${N}`}const a="__firebase__banner",c=Bw().prod.length>0;function d(){const N=document.getElementById(a);N&&N.remove()}function m(N){N.style.display="flex",N.style.background="#7faaf0",N.style.position="fixed",N.style.bottom="5px",N.style.left="5px",N.style.padding=".5em",N.style.borderRadius="5px",N.style.alignItems="center"}function g(N,C){N.setAttribute("width","24"),N.setAttribute("id",C),N.setAttribute("height","24"),N.setAttribute("viewBox","0 0 24 24"),N.setAttribute("fill","none"),N.style.marginLeft="-6px"}function v(){const N=document.createElement("span");return N.style.cursor="pointer",N.style.marginLeft="16px",N.style.fontSize="24px",N.innerHTML=" &times;",N.onclick=()=>{WE=!0,d()},N}function _(N,C){N.setAttribute("id",C),N.innerText="Learn more",N.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",N.setAttribute("target","__blank"),N.style.paddingLeft="5px",N.style.textDecoration="underline"}function T(){const N=Hw(a),C=t("text"),w=document.getElementById(C)||document.createElement("span"),F=t("learnmore"),A=document.getElementById(F)||document.createElement("a"),L=t("preprendIcon"),W=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(N.created){const H=N.element;m(H),_(A,F);const U=v();g(W,L),H.append(W,w,A,U),document.body.appendChild(H)}c?(w.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Gw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mn())}function $w(){var s;const e=(s=Ch())===null||s===void 0?void 0:s.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Kw(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function gN(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function Yw(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Qw(){const s=mn();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function Xw(){return!$w()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fg(){try{return typeof indexedDB=="object"}catch{return!1}}function mg(){return new Promise((s,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(a);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(a),s(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}function vN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww="FirebaseError";class rs extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=Ww,Object.setPrototypeOf(this,rs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Aa.prototype.create)}}class Aa{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?Zw(c,a):"Error",m=`${this.serviceName}: ${d} (${o}).`;return new rs(o,m,a)}}function Zw(s,e){return s.replace(Jw,(t,a)=>{const o=e[a];return o!=null?String(o):`<${a}?>`})}const Jw=/\{\$([^}]+)}/g;function eC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function pa(s,e){if(s===e)return!0;const t=Object.keys(s),a=Object.keys(e);for(const o of t){if(!a.includes(o))return!1;const c=s[o],d=e[o];if(ZE(c)&&ZE(d)){if(!pa(c,d))return!1}else if(c!==d)return!1}for(const o of a)if(!t.includes(o))return!1;return!0}function ZE(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(s){const e=[];for(const[t,a]of Object.entries(s))Array.isArray(a)?a.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function vc(s){const e={};return s.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[o,c]=a.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function yc(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function tC(s,e){const t=new nC(s,e);return t.subscribe.bind(t)}class nC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let o;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");sC(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:a},o.next===void 0&&(o.next=dp),o.error===void 0&&(o.error=dp),o.complete===void 0&&(o.complete=dp);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function dp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC=1e3,aC=2,rC=4*60*60*1e3,oC=.5;function JE(s,e=iC,t=aC){const a=e*Math.pow(t,s),o=Math.round(oC*a*(Math.random()-.5)*2);return Math.min(rC,a+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ct(s){return s&&s._delegate?s._delegate:s}class Bn{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new zw;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&a.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const a=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(a)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:a})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(uC(e))try{this.getOrInitializeService({instanceIdentifier:vr})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});a.resolve(c)}catch{}}}}clearInstance(e=vr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=vr){return this.instances.has(e)}getOptions(e=vr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[c,d]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(c);a===m&&d.resolve(o)}return o}onInit(e,t){var a;const o=this.normalizeInstanceIdentifier(t),c=(a=this.onInitCallbacks.get(o))!==null&&a!==void 0?a:new Set;c.add(e),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&e(d,o),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const o of a)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:cC(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=vr){return this.component?this.component.multipleInstances?e:vr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function cC(s){return s===vr?void 0:s}function uC(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new lC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Ue||(Ue={}));const hC={debug:Ue.DEBUG,verbose:Ue.VERBOSE,info:Ue.INFO,warn:Ue.WARN,error:Ue.ERROR,silent:Ue.SILENT},fC=Ue.INFO,mC={[Ue.DEBUG]:"log",[Ue.VERBOSE]:"log",[Ue.INFO]:"info",[Ue.WARN]:"warn",[Ue.ERROR]:"error"},pC=(s,e,...t)=>{if(e<s.logLevel)return;const a=new Date().toISOString(),o=mC[e];if(o)console[o](`[${a}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Yc{constructor(e){this.name=e,this._logLevel=fC,this._logHandler=pC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ue.DEBUG,...e),this._logHandler(this,Ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ue.VERBOSE,...e),this._logHandler(this,Ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ue.INFO,...e),this._logHandler(this,Ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ue.WARN,...e),this._logHandler(this,Ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ue.ERROR,...e),this._logHandler(this,Ue.ERROR,...e)}}const gC=(s,e)=>e.some(t=>s instanceof t);let eb,tb;function vC(){return eb||(eb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yC(){return tb||(tb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yN=new WeakMap,Dp=new WeakMap,_N=new WeakMap,hp=new WeakMap,pg=new WeakMap;function _C(s){const e=new Promise((t,a)=>{const o=()=>{s.removeEventListener("success",c),s.removeEventListener("error",d)},c=()=>{t(da(s.result)),o()},d=()=>{a(s.error),o()};s.addEventListener("success",c),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&yN.set(t,s)}).catch(()=>{}),pg.set(e,s),e}function EC(s){if(Dp.has(s))return;const e=new Promise((t,a)=>{const o=()=>{s.removeEventListener("complete",c),s.removeEventListener("error",d),s.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{a(s.error||new DOMException("AbortError","AbortError")),o()};s.addEventListener("complete",c),s.addEventListener("error",d),s.addEventListener("abort",d)});Dp.set(s,e)}let Op={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return Dp.get(s);if(e==="objectStoreNames")return s.objectStoreNames||_N.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return da(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function bC(s){Op=s(Op)}function TC(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=s.call(fp(this),e,...t);return _N.set(a,e.sort?e.sort():[e]),da(a)}:yC().includes(s)?function(...e){return s.apply(fp(this),e),da(yN.get(this))}:function(...e){return da(s.apply(fp(this),e))}}function NC(s){return typeof s=="function"?TC(s):(s instanceof IDBTransaction&&EC(s),gC(s,vC())?new Proxy(s,Op):s)}function da(s){if(s instanceof IDBRequest)return _C(s);if(hp.has(s))return hp.get(s);const e=NC(s);return e!==s&&(hp.set(s,e),pg.set(e,s)),e}const fp=s=>pg.get(s);function EN(s,e,{blocked:t,upgrade:a,blocking:o,terminated:c}={}){const d=indexedDB.open(s,e),m=da(d);return a&&d.addEventListener("upgradeneeded",g=>{a(da(d.result),g.oldVersion,g.newVersion,da(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),m.then(g=>{c&&g.addEventListener("close",()=>c()),o&&g.addEventListener("versionchange",v=>o(v.oldVersion,v.newVersion,v))}).catch(()=>{}),m}const xC=["get","getKey","getAll","getAllKeys","count"],AC=["put","add","delete","clear"],mp=new Map;function nb(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(mp.get(e))return mp.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,o=AC.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(o||xC.includes(t)))return;const c=async function(d,...m){const g=this.transaction(d,o?"readwrite":"readonly");let v=g.store;return a&&(v=v.index(m.shift())),(await Promise.all([v[t](...m),o&&g.done]))[0]};return mp.set(e,c),c}bC(s=>({...s,get:(e,t,a)=>nb(e,t)||s.get(e,t,a),has:(e,t)=>!!nb(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(wC(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function wC(s){const e=s.getComponent();return e?.type==="VERSION"}const Mp="@firebase/app",sb="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ni=new Yc("@firebase/app"),CC="@firebase/app-compat",IC="@firebase/analytics-compat",jC="@firebase/analytics",RC="@firebase/app-check-compat",DC="@firebase/app-check",OC="@firebase/auth",MC="@firebase/auth-compat",PC="@firebase/database",kC="@firebase/data-connect",VC="@firebase/database-compat",LC="@firebase/functions",UC="@firebase/functions-compat",FC="@firebase/installations",qC="@firebase/installations-compat",zC="@firebase/messaging",BC="@firebase/messaging-compat",HC="@firebase/performance",GC="@firebase/performance-compat",$C="@firebase/remote-config",KC="@firebase/remote-config-compat",YC="@firebase/storage",QC="@firebase/storage-compat",XC="@firebase/firestore",WC="@firebase/ai",ZC="@firebase/firestore-compat",JC="firebase",eI="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pp="[DEFAULT]",tI={[Mp]:"fire-core",[CC]:"fire-core-compat",[jC]:"fire-analytics",[IC]:"fire-analytics-compat",[DC]:"fire-app-check",[RC]:"fire-app-check-compat",[OC]:"fire-auth",[MC]:"fire-auth-compat",[PC]:"fire-rtdb",[kC]:"fire-data-connect",[VC]:"fire-rtdb-compat",[LC]:"fire-fn",[UC]:"fire-fn-compat",[FC]:"fire-iid",[qC]:"fire-iid-compat",[zC]:"fire-fcm",[BC]:"fire-fcm-compat",[HC]:"fire-perf",[GC]:"fire-perf-compat",[$C]:"fire-rc",[KC]:"fire-rc-compat",[YC]:"fire-gcs",[QC]:"fire-gcs-compat",[XC]:"fire-fst",[ZC]:"fire-fst-compat",[WC]:"fire-vertex","fire-js":"fire-js",[JC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh=new Map,nI=new Map,kp=new Map;function ib(s,e){try{s.container.addComponent(e)}catch(t){Ni.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function is(s){const e=s.name;if(kp.has(e))return Ni.debug(`There were multiple attempts to register component ${e}.`),!1;kp.set(e,s);for(const t of sh.values())ib(t,s);for(const t of nI.values())ib(t,s);return!0}function wi(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Cn(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ha=new Aa("app","Firebase",sI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(e,t,a){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new Bn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ha.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr=eI;function bN(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const a=Object.assign({name:Pp,automaticDataCollectionEnabled:!0},e),o=a.name;if(typeof o!="string"||!o)throw ha.create("bad-app-name",{appName:String(o)});if(t||(t=fN()),!t)throw ha.create("no-options");const c=sh.get(o);if(c){if(pa(t,c.options)&&pa(a,c.config))return c;throw ha.create("duplicate-app",{appName:o})}const d=new dC(o);for(const g of kp.values())d.addComponent(g);const m=new iI(t,a,d);return sh.set(o,m),m}function Qc(s=Pp){const e=sh.get(s);if(!e&&s===Pp&&fN())return bN();if(!e)throw ha.create("no-app",{appName:s});return e}function fn(s,e,t){var a;let o=(a=tI[s])!==null&&a!==void 0?a:s;t&&(o+=`-${t}`);const c=o.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const m=[`Unable to register library "${o}" with version "${e}":`];c&&m.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&m.push("and"),d&&m.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ni.warn(m.join(" "));return}is(new Bn(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI="firebase-heartbeat-database",rI=1,Pc="firebase-heartbeat-store";let pp=null;function TN(){return pp||(pp=EN(aI,rI,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(Pc)}catch(t){console.warn(t)}}}}).catch(s=>{throw ha.create("idb-open",{originalErrorMessage:s.message})})),pp}async function oI(s){try{const t=(await TN()).transaction(Pc),a=await t.objectStore(Pc).get(NN(s));return await t.done,a}catch(e){if(e instanceof rs)Ni.warn(e.message);else{const t=ha.create("idb-get",{originalErrorMessage:e?.message});Ni.warn(t.message)}}}async function ab(s,e){try{const a=(await TN()).transaction(Pc,"readwrite");await a.objectStore(Pc).put(e,NN(s)),await a.done}catch(t){if(t instanceof rs)Ni.warn(t.message);else{const a=ha.create("idb-set",{originalErrorMessage:t?.message});Ni.warn(a.message)}}}function NN(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI=1024,cI=30;class uI{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new hI(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=rb();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>cI){const d=fI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){Ni.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=rb(),{heartbeatsToSend:a,unsentEntries:o}=dI(this._heartbeatsCache.heartbeats),c=nh(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Ni.warn(t),""}}}function rb(){return new Date().toISOString().substring(0,10)}function dI(s,e=lI){const t=[];let a=s.slice();for(const o of s){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),ob(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),ob(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class hI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fg()?mg().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await oI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return ab(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return ab(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function ob(s){return nh(JSON.stringify({version:2,heartbeats:s})).length}function fI(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let a=1;a<s.length;a++)s[a].date<t&&(t=s[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mI(s){is(new Bn("platform-logger",e=>new SC(e),"PRIVATE")),is(new Bn("heartbeat",e=>new uI(e),"PRIVATE")),fn(Mp,sb,s),fn(Mp,sb,"esm2017"),fn("fire-js","")}mI("");function gg(s,e){var t={};for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&e.indexOf(a)<0&&(t[a]=s[a]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(s);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(s,a[o])&&(t[a[o]]=s[a[o]]);return t}function xN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const pI=xN,AN=new Aa("auth","Firebase",xN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ih=new Yc("@firebase/auth");function gI(s,...e){ih.logLevel<=Ue.WARN&&ih.warn(`Auth (${Rr}): ${s}`,...e)}function Hd(s,...e){ih.logLevel<=Ue.ERROR&&ih.error(`Auth (${Rr}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function as(s,...e){throw yg(s,...e)}function ys(s,...e){return yg(s,...e)}function vg(s,e,t){const a=Object.assign(Object.assign({},pI()),{[e]:t});return new Aa("auth","Firebase",a).create(e,{appName:s.name})}function Ti(s){return vg(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function vI(s,e,t){const a=t;if(!(e instanceof a))throw a.name!==e.constructor.name&&as(s,"argument-error"),vg(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function yg(s,...e){if(typeof s!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=s.name),s._errorFactory.create(t,...a)}return AN.create(s,...e)}function we(s,e,...t){if(!s)throw yg(e,...t)}function Ei(s){const e="INTERNAL ASSERTION FAILED: "+s;throw Hd(e),new Error(e)}function xi(s,e){s||Ei(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(){var s;return typeof self<"u"&&((s=self.location)===null||s===void 0?void 0:s.href)||""}function yI(){return lb()==="http:"||lb()==="https:"}function lb(){var s;return typeof self<"u"&&((s=self.location)===null||s===void 0?void 0:s.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(yI()||gN()||"connection"in navigator)?navigator.onLine:!0}function EI(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,t){this.shortDelay=e,this.longDelay=t,xi(t>e,"Short delay should be less than long delay!"),this.isMobile=Gw()||Yw()}get(){return _I()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _g(s,e){xi(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],NI=new Xc(3e4,6e4);function Sa(s,e){return s.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:s.tenantId}):e}async function wa(s,e,t,a,o={}){return wN(s,o,async()=>{let c={},d={};a&&(e==="GET"?d=a:c={body:JSON.stringify(a)});const m=Kc(Object.assign({key:s.config.apiKey},d)).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const v=Object.assign({method:e,headers:g},c);return Kw()||(v.referrerPolicy="no-referrer"),s.emulatorConfig&&jr(s.emulatorConfig.host)&&(v.credentials="include"),SN.fetch()(await CN(s,s.config.apiHost,t,m),v)})}async function wN(s,e,t){s._canInitEmulator=!1;const a=Object.assign(Object.assign({},bI),e);try{const o=new AI(s),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw Pd(s,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const m=c.ok?d.errorMessage:d.error.message,[g,v]=m.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Pd(s,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw Pd(s,"email-already-in-use",d);if(g==="USER_DISABLED")throw Pd(s,"user-disabled",d);const _=a[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw vg(s,_,v);as(s,_)}}catch(o){if(o instanceof rs)throw o;as(s,"network-request-failed",{message:String(o)})}}async function Wc(s,e,t,a,o={}){const c=await wa(s,e,t,a,o);return"mfaPendingCredential"in c&&as(s,"multi-factor-auth-required",{_serverResponse:c}),c}async function CN(s,e,t,a){const o=`${e}${t}?${a}`,c=s,d=c.config.emulator?_g(s.config,o):`${s.config.apiScheme}://${o}`;return TI.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function xI(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class AI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(ys(this.auth,"network-request-failed")),NI.get())})}}function Pd(s,e,t){const a={appName:s.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const o=ys(s,e,a);return o.customData._tokenResponse=t,o}function cb(s){return s!==void 0&&s.enterprise!==void 0}class SI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return xI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function wI(s,e){return wa(s,"GET","/v2/recaptchaConfig",Sa(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CI(s,e){return wa(s,"POST","/v1/accounts:delete",e)}async function ah(s,e){return wa(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function II(s,e=!1){const t=ct(s),a=await t.getIdToken(e),o=Eg(a);we(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:a,authTime:xc(gp(o.auth_time)),issuedAtTime:xc(gp(o.iat)),expirationTime:xc(gp(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function gp(s){return Number(s)*1e3}function Eg(s){const[e,t,a]=s.split(".");if(e===void 0||t===void 0||a===void 0)return Hd("JWT malformed, contained fewer than 3 sections"),null;try{const o=uN(t);return o?JSON.parse(o):(Hd("Failed to decode base64 JWT payload"),null)}catch(o){return Hd("Caught error parsing JWT payload as JSON",o?.toString()),null}}function ub(s){const e=Eg(s);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kc(s,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof rs&&jI(a)&&s.auth.currentUser===s&&await s.auth.signOut(),a}}function jI({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const a=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),a}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=xc(this.lastLoginAt),this.creationTime=xc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rh(s){var e;const t=s.auth,a=await s.getIdToken(),o=await kc(s,ah(t,{idToken:a}));we(o?.users.length,t,"internal-error");const c=o.users[0];s._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?IN(c.providerUserInfo):[],m=OI(s.providerData,d),g=s.isAnonymous,v=!(s.email&&c.passwordHash)&&!m?.length,_=g?v:!1,T={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:m,metadata:new Lp(c.createdAt,c.lastLoginAt),isAnonymous:_};Object.assign(s,T)}async function DI(s){const e=ct(s);await rh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function OI(s,e){return[...s.filter(a=>!e.some(o=>o.providerId===a.providerId)),...e]}function IN(s){return s.map(e=>{var{providerId:t}=e,a=gg(e,["providerId"]);return{providerId:t,uid:a.rawId||"",displayName:a.displayName||null,email:a.email||null,phoneNumber:a.phoneNumber||null,photoURL:a.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MI(s,e){const t=await wN(s,{},async()=>{const a=Kc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=s.config,d=await CN(s,o,"/v1/token",`key=${c}`),m=await s._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:m,body:a};return s.emulatorConfig&&jr(s.emulatorConfig.host)&&(g.credentials="include"),SN.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function PI(s,e){return wa(s,"POST","/v2/accounts:revokeToken",Sa(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ub(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){we(e.length!==0,"internal-error");const t=ub(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(we(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:o,expiresIn:c}=await MI(e,t);this.updateTokensAndExpiration(a,o,Number(c))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:o,expirationTime:c}=t,d=new Vo;return a&&(we(typeof a=="string","internal-error",{appName:e}),d.refreshToken=a),o&&(we(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(we(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Vo,this.toJSON())}_performRefresh(){return Ei("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ia(s,e){we(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class gs{constructor(e){var{uid:t,auth:a,stsTokenManager:o}=e,c=gg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new RI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=a,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new Lp(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await kc(this,this.stsTokenManager.getToken(this.auth,e));return we(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return II(this,e)}reload(){return DI(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new gs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await rh(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Cn(this.auth.app))return Promise.reject(Ti(this.auth));const e=await this.getIdToken();return await kc(this,CI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var a,o,c,d,m,g,v,_;const T=(a=t.displayName)!==null&&a!==void 0?a:void 0,N=(o=t.email)!==null&&o!==void 0?o:void 0,C=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,w=(d=t.photoURL)!==null&&d!==void 0?d:void 0,F=(m=t.tenantId)!==null&&m!==void 0?m:void 0,A=(g=t._redirectEventId)!==null&&g!==void 0?g:void 0,L=(v=t.createdAt)!==null&&v!==void 0?v:void 0,W=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:H,emailVerified:U,isAnonymous:z,providerData:ae,stsTokenManager:O}=t;we(H&&O,e,"internal-error");const x=Vo.fromJSON(this.name,O);we(typeof H=="string",e,"internal-error"),ia(T,e.name),ia(N,e.name),we(typeof U=="boolean",e,"internal-error"),we(typeof z=="boolean",e,"internal-error"),ia(C,e.name),ia(w,e.name),ia(F,e.name),ia(A,e.name),ia(L,e.name),ia(W,e.name);const j=new gs({uid:H,auth:e,email:N,emailVerified:U,displayName:T,isAnonymous:z,photoURL:w,phoneNumber:C,tenantId:F,stsTokenManager:x,createdAt:L,lastLoginAt:W});return ae&&Array.isArray(ae)&&(j.providerData=ae.map(R=>Object.assign({},R))),A&&(j._redirectEventId=A),j}static async _fromIdTokenResponse(e,t,a=!1){const o=new Vo;o.updateFromServerResponse(t);const c=new gs({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:a});return await rh(c),c}static async _fromGetAccountInfoResponse(e,t,a){const o=t.users[0];we(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?IN(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,m=new Vo;m.updateFromIdToken(a);const g=new gs({uid:o.localId,auth:e,stsTokenManager:m,isAnonymous:d}),v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Lp(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(g,v),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const db=new Map;function bi(s){xi(s instanceof Function,"Expected a class definition");let e=db.get(s);return e?(xi(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,db.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}jN.type="NONE";const hb=jN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gd(s,e,t){return`firebase:${s}:${e}:${t}`}class Lo{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:o,name:c}=this.auth;this.fullUserKey=Gd(this.userKey,o.apiKey,c),this.fullPersistenceKey=Gd("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ah(this.auth,{idToken:e}).catch(()=>{});return t?gs._fromGetAccountInfoResponse(this.auth,t,e):null}return gs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new Lo(bi(hb),e,a);const o=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let c=o[0]||bi(hb);const d=Gd(a,e.config.apiKey,e.name);let m=null;for(const v of t)try{const _=await v._get(d);if(_){let T;if(typeof _=="string"){const N=await ah(e,{idToken:_}).catch(()=>{});if(!N)break;T=await gs._fromGetAccountInfoResponse(e,N,_)}else T=gs._fromJSON(e,_);v!==c&&(m=T),c=v;break}}catch{}const g=o.filter(v=>v._shouldAllowMigration);return!c._shouldAllowMigration||!g.length?new Lo(c,e,a):(c=g[0],m&&await c._set(d,m.toJSON()),await Promise.all(t.map(async v=>{if(v!==c)try{await v._remove(d)}catch{}})),new Lo(c,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(MN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(RN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kN(e))return"Blackberry";if(VN(e))return"Webos";if(DN(e))return"Safari";if((e.includes("chrome/")||ON(e))&&!e.includes("edge/"))return"Chrome";if(PN(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=s.match(t);if(a?.length===2)return a[1]}return"Other"}function RN(s=mn()){return/firefox\//i.test(s)}function DN(s=mn()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ON(s=mn()){return/crios\//i.test(s)}function MN(s=mn()){return/iemobile/i.test(s)}function PN(s=mn()){return/android/i.test(s)}function kN(s=mn()){return/blackberry/i.test(s)}function VN(s=mn()){return/webos/i.test(s)}function bg(s=mn()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function kI(s=mn()){var e;return bg(s)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function VI(){return Qw()&&document.documentMode===10}function LN(s=mn()){return bg(s)||PN(s)||VN(s)||kN(s)||/windows phone/i.test(s)||MN(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(s,e=[]){let t;switch(s){case"Browser":t=fb(mn());break;case"Worker":t=`${fb(mn())}-${s}`;break;default:t=s}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Rr}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=c=>new Promise((d,m)=>{try{const g=e(c);d(g)}catch(g){m(g)}});a.onAbort=t,this.queue.push(a);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UI(s,e={}){return wa(s,"GET","/v2/passwordPolicy",Sa(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI=6;class qI{constructor(e){var t,a,o,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:FI,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(a=e.allowedNonAlphanumericCharacters)===null||a===void 0?void 0:a.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,a,o,c,d,m;const g={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,g),this.validatePasswordCharacterOptions(e,g),g.isValid&&(g.isValid=(t=g.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),g.isValid&&(g.isValid=(a=g.meetsMaxPasswordLength)!==null&&a!==void 0?a:!0),g.isValid&&(g.isValid=(o=g.containsLowercaseLetter)!==null&&o!==void 0?o:!0),g.isValid&&(g.isValid=(c=g.containsUppercaseLetter)!==null&&c!==void 0?c:!0),g.isValid&&(g.isValid=(d=g.containsNumericCharacter)!==null&&d!==void 0?d:!0),g.isValid&&(g.isValid=(m=g.containsNonAlphanumericCharacter)!==null&&m!==void 0?m:!0),g}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let o=0;o<e.length;o++)a=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(e,t,a,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new mb(this),this.idTokenSubscription=new mb(this),this.beforeStateQueue=new LI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=AN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=bi(t)),this._initializationPromise=this.queue(async()=>{var a,o,c;if(!this._deleted&&(this.persistenceManager=await Lo.create(this,e),(a=this._resolvePersistenceManagerAvailable)===null||a===void 0||a.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ah(this,{idToken:e}),a=await gs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Cn(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(m=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(m,m))}):this.directlySetCurrentUser(null)}const a=await this.assertedPersistence.getCurrentUser();let o=a,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,m=o?._redirectEventId,g=await this.tryRedirectSignIn(e);(!d||d===m)&&g?.user&&(o=g.user,c=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(o)}catch(d){o=a,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await rh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=EI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Cn(this.app))return Promise.reject(Ti(this));const t=e?ct(e):null;return t&&we(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Cn(this.app)?Promise.reject(Ti(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Cn(this.app)?Promise.reject(Ti(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await UI(this),t=new qI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Aa("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await PI(this,a)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&bi(e)||this._popupRedirectResolver;we(t,this,"argument-error"),this.redirectPersistenceManager=await Lo.create(this,[bi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,a;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((a=this.redirectUser)===null||a===void 0?void 0:a._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const a=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==a&&(this.lastNotifiedUid=a,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(we(m,this,"internal-error"),m.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,a,o);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=UN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const a=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());a&&(t["X-Firebase-Client"]=a);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(Cn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&gI(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Ca(s){return ct(s)}class mb{constructor(e){this.auth=e,this.observer=null,this.addObserver=tC(t=>this.observer=t)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ih={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function BI(s){Ih=s}function FN(s){return Ih.loadJS(s)}function HI(){return Ih.recaptchaEnterpriseScript}function GI(){return Ih.gapiScript}function $I(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class KI{constructor(){this.enterprise=new YI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class YI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const QI="recaptcha-enterprise",qN="NO_RECAPTCHA";class XI{constructor(e){this.type=QI,this.auth=Ca(e)}async verify(e="verify",t=!1){async function a(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,m)=>{wI(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)m(new Error("recaptcha Enterprise site key undefined"));else{const v=new SI(g);return c.tenantId==null?c._agentRecaptchaConfig=v:c._tenantRecaptchaConfigs[c.tenantId]=v,d(v.siteKey)}}).catch(g=>{m(g)})})}function o(c,d,m){const g=window.grecaptcha;cb(g)?g.enterprise.ready(()=>{g.enterprise.execute(c,{action:e}).then(v=>{d(v)}).catch(()=>{d(qN)})}):m(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new KI().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{a(this.auth).then(m=>{if(!t&&cb(window.grecaptcha))o(m,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=HI();g.length!==0&&(g+=m),FN(g).then(()=>{o(m,c,d)}).catch(v=>{d(v)})}}).catch(m=>{d(m)})})}}async function pb(s,e,t,a=!1,o=!1){const c=new XI(s);let d;if(o)d=qN;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const m=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in m){const g=m.phoneEnrollmentInfo.phoneNumber,v=m.phoneEnrollmentInfo.recaptchaToken;Object.assign(m,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in m){const g=m.phoneSignInInfo.recaptchaToken;Object.assign(m,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return m}return a?Object.assign(m,{captchaResp:d}):Object.assign(m,{captchaResponse:d}),Object.assign(m,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(m,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),m}async function Up(s,e,t,a,o){var c;if(!((c=s._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await pb(s,e,t,t==="getOobCode");return a(s,d)}else return a(s,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const m=await pb(s,e,t,t==="getOobCode");return a(s,m)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WI(s,e){const t=wi(s,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(pa(c,e??{}))return o;as(o,"already-initialized")}return t.initialize({options:e})}function ZI(s,e){const t=e?.persistence||[],a=(Array.isArray(t)?t:[t]).map(bi);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(a,e?.popupRedirectResolver)}function JI(s,e,t){const a=Ca(s);we(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const o=!1,c=zN(e),{host:d,port:m}=ej(e),g=m===null?"":`:${m}`,v={url:`${c}//${d}${g}/`},_=Object.freeze({host:d,port:m,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!a._canInitEmulator){we(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),we(pa(v,a.config.emulator)&&pa(_,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=v,a.emulatorConfig=_,a.settings.appVerificationDisabledForTesting=!0,jr(d)?(dg(`${c}//${d}${g}`),hg("Auth",!0)):tj()}function zN(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function ej(s){const e=zN(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(a);if(o){const c=o[1];return{host:c,port:gb(a.substr(c.length+1))}}else{const[c,d]=a.split(":");return{host:c,port:gb(d)}}}function gb(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function tj(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ei("not implemented")}_getIdTokenResponse(e){return Ei("not implemented")}_linkToIdToken(e,t){return Ei("not implemented")}_getReauthenticationResolver(e){return Ei("not implemented")}}async function nj(s,e){return wa(s,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sj(s,e){return Wc(s,"POST","/v1/accounts:signInWithPassword",Sa(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ij(s,e){return Wc(s,"POST","/v1/accounts:signInWithEmailLink",Sa(s,e))}async function aj(s,e){return Wc(s,"POST","/v1/accounts:signInWithEmailLink",Sa(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc extends Tg{constructor(e,t,a,o=null){super("password",a),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Vc(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new Vc(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Up(e,t,"signInWithPassword",sj);case"emailLink":return ij(e,{email:this._email,oobCode:this._password});default:as(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Up(e,a,"signUpPassword",nj);case"emailLink":return aj(e,{idToken:t,email:this._email,oobCode:this._password});default:as(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uo(s,e){return Wc(s,"POST","/v1/accounts:signInWithIdp",Sa(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rj="http://localhost";class Tr extends Tg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Tr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):as("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:o}=t,c=gg(t,["providerId","signInMethod"]);if(!a||!o)return null;const d=new Tr(a,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Uo(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,Uo(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Uo(e,t)}buildRequest(){const e={requestUri:rj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Kc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oj(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function lj(s){const e=vc(yc(s)).link,t=e?vc(yc(e)).deep_link_id:null,a=vc(yc(s)).deep_link_id;return(a?vc(yc(a)).link:null)||a||t||e||s}class Ng{constructor(e){var t,a,o,c,d,m;const g=vc(yc(e)),v=(t=g.apiKey)!==null&&t!==void 0?t:null,_=(a=g.oobCode)!==null&&a!==void 0?a:null,T=oj((o=g.mode)!==null&&o!==void 0?o:null);we(v&&_&&T,"argument-error"),this.apiKey=v,this.operation=T,this.code=_,this.continueUrl=(c=g.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=g.lang)!==null&&d!==void 0?d:null,this.tenantId=(m=g.tenantId)!==null&&m!==void 0?m:null}static parseLink(e){const t=lj(e);try{return new Ng(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(){this.providerId=Zo.PROVIDER_ID}static credential(e,t){return Vc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=Ng.parseLink(t);return we(a,"argument-error"),Vc._fromEmailAndCode(e,a.code,a.tenantId)}}Zo.PROVIDER_ID="password";Zo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Zo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc extends xg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra extends Zc{constructor(){super("facebook.com")}static credential(e){return Tr._fromParams({providerId:ra.PROVIDER_ID,signInMethod:ra.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ra.credentialFromTaggedObject(e)}static credentialFromError(e){return ra.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ra.credential(e.oauthAccessToken)}catch{return null}}}ra.FACEBOOK_SIGN_IN_METHOD="facebook.com";ra.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends Zc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Tr._fromParams({providerId:_i.PROVIDER_ID,signInMethod:_i.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return _i.credentialFromTaggedObject(e)}static credentialFromError(e){return _i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return _i.credential(t,a)}catch{return null}}}_i.GOOGLE_SIGN_IN_METHOD="google.com";_i.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa extends Zc{constructor(){super("github.com")}static credential(e){return Tr._fromParams({providerId:oa.PROVIDER_ID,signInMethod:oa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oa.credentialFromTaggedObject(e)}static credentialFromError(e){return oa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return oa.credential(e.oauthAccessToken)}catch{return null}}}oa.GITHUB_SIGN_IN_METHOD="github.com";oa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la extends Zc{constructor(){super("twitter.com")}static credential(e,t){return Tr._fromParams({providerId:la.PROVIDER_ID,signInMethod:la.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return la.credentialFromTaggedObject(e)}static credentialFromError(e){return la.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return la.credential(t,a)}catch{return null}}}la.TWITTER_SIGN_IN_METHOD="twitter.com";la.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cj(s,e){return Wc(s,"POST","/v1/accounts:signUp",Sa(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,o=!1){const c=await gs._fromIdTokenResponse(e,a,o),d=vb(a);return new Nr({user:c,providerId:d,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const o=vb(a);return new Nr({user:e,providerId:o,_tokenResponse:a,operationType:t})}}function vb(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh extends rs{constructor(e,t,a,o){var c;super(t.code,t.message),this.operationType=a,this.user=o,Object.setPrototypeOf(this,oh.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,o){return new oh(e,t,a,o)}}function BN(s,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?oh._fromErrorAndOperation(s,c,e,a):c})}async function uj(s,e,t=!1){const a=await kc(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Nr._forOperation(s,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dj(s,e,t=!1){const{auth:a}=s;if(Cn(a.app))return Promise.reject(Ti(a));const o="reauthenticate";try{const c=await kc(s,BN(a,o,e,s),t);we(c.idToken,a,"internal-error");const d=Eg(c.idToken);we(d,a,"internal-error");const{sub:m}=d;return we(s.uid===m,a,"user-mismatch"),Nr._forOperation(s,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&as(a,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HN(s,e,t=!1){if(Cn(s.app))return Promise.reject(Ti(s));const a="signIn",o=await BN(s,a,e),c=await Nr._fromIdTokenResponse(s,a,o);return t||await s._updateCurrentUser(c.user),c}async function hj(s,e){return HN(Ca(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GN(s){const e=Ca(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function fj(s,e,t){if(Cn(s.app))return Promise.reject(Ti(s));const a=Ca(s),d=await Up(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",cj).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&GN(s),g}),m=await Nr._fromIdTokenResponse(a,"signIn",d);return await a._updateCurrentUser(m.user),m}function mj(s,e,t){return Cn(s.app)?Promise.reject(Ti(s)):hj(ct(s),Zo.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&GN(s),a})}function pj(s,e,t,a){return ct(s).onIdTokenChanged(e,t,a)}function gj(s,e,t){return ct(s).beforeAuthStateChanged(e,t)}function vj(s,e,t,a){return ct(s).onAuthStateChanged(e,t,a)}function yj(s){return ct(s).signOut()}const lh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $N{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(lh,"1"),this.storage.removeItem(lh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j=1e3,Ej=10;class KN extends $N{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=LN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),o=this.localCache[t];a!==o&&e(t,o,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,m,g)=>{this.notifyListeners(d,g)});return}const a=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(a);!t&&this.localCache[a]===d||this.notifyListeners(a,d)},c=this.storage.getItem(a);VI()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,Ej):o()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},_j)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}KN.type="LOCAL";const bj=KN;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN extends $N{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}YN.type="SESSION";const QN=YN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tj(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const a=new jh(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:o});const m=Array.from(d).map(async v=>v(t.origin,c)),g=await Tj(m);t.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ag(s="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((m,g)=>{const v=Ag("",20);o.port1.start();const _=setTimeout(()=>{g(new Error("unsupported_event"))},a);d={messageChannel:o,onMessage(T){const N=T;if(N.data.eventId===v)switch(N.data.status){case"ack":clearTimeout(_),c=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),m(N.data.response);break;default:clearTimeout(_),clearTimeout(c),g(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fs(){return window}function xj(s){Fs().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XN(){return typeof Fs().WorkerGlobalScope<"u"&&typeof Fs().importScripts=="function"}async function Aj(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Sj(){var s;return((s=navigator?.serviceWorker)===null||s===void 0?void 0:s.controller)||null}function wj(){return XN()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WN="firebaseLocalStorageDb",Cj=1,ch="firebaseLocalStorage",ZN="fbase_key";class Jc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Rh(s,e){return s.transaction([ch],e?"readwrite":"readonly").objectStore(ch)}function Ij(){const s=indexedDB.deleteDatabase(WN);return new Jc(s).toPromise()}function Fp(){const s=indexedDB.open(WN,Cj);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const a=s.result;try{a.createObjectStore(ch,{keyPath:ZN})}catch(o){t(o)}}),s.addEventListener("success",async()=>{const a=s.result;a.objectStoreNames.contains(ch)?e(a):(a.close(),await Ij(),e(await Fp()))})})}async function yb(s,e,t){const a=Rh(s,!0).put({[ZN]:e,value:t});return new Jc(a).toPromise()}async function jj(s,e){const t=Rh(s,!1).get(e),a=await new Jc(t).toPromise();return a===void 0?null:a.value}function _b(s,e){const t=Rh(s,!0).delete(e);return new Jc(t).toPromise()}const Rj=800,Dj=3;class JN{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Fp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>Dj)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return XN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jh._getInstance(wj()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Aj(),!this.activeServiceWorker)return;this.sender=new Nj(this.activeServiceWorker);const a=await this.sender._send("ping",{},800);a&&!((e=a[0])===null||e===void 0)&&e.fulfilled&&!((t=a[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Sj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Fp();return await yb(e,lh,"1"),await _b(e,lh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>yb(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>jj(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>_b(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Rh(o,!1).getAll();return new Jc(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)a.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!a.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Rj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}JN.type="LOCAL";const Oj=JN;new Xc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(s,e){return e?bi(e):(we(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg extends Tg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Uo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Uo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Uo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Mj(s){return HN(s.auth,new Sg(s),s.bypassAuthState)}function Pj(s){const{auth:e,user:t}=s;return we(t,e,"internal-error"),dj(t,new Sg(s),s.bypassAuthState)}async function kj(s){const{auth:e,user:t}=s;return we(t,e,"internal-error"),uj(t,new Sg(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0{constructor(e,t,a,o,c=!1){this.auth=e,this.resolver=a,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:o,tenantId:c,error:d,type:m}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:a,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(g))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Mj;case"linkViaPopup":case"linkViaRedirect":return kj;case"reauthViaPopup":case"reauthViaRedirect":return Pj;default:as(this.auth,"internal-error")}}resolve(e){xi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj=new Xc(2e3,1e4);async function Lj(s,e,t){if(Cn(s.app))return Promise.reject(ys(s,"operation-not-supported-in-this-environment"));const a=Ca(s);vI(s,e,xg);const o=e0(a,t);return new yr(a,"signInViaPopup",e,o).executeNotNull()}class yr extends t0{constructor(e,t,a,o,c){super(e,t,o,c),this.provider=a,this.authWindow=null,this.pollId=null,yr.currentPopupAction&&yr.currentPopupAction.cancel(),yr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){xi(this.filter.length===1,"Popup operations only handle one event");const e=Ag();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ys(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ys(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,yr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,a;if(!((a=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||a===void 0)&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ys(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Vj.get())};e()}}yr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uj="pendingRedirect",$d=new Map;class Fj extends t0{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=$d.get(this.auth._key());if(!e){try{const a=await qj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}$d.set(this.auth._key(),e)}return this.bypassAuthState||$d.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qj(s,e){const t=Hj(e),a=Bj(s);if(!await a._isAvailable())return!1;const o=await a._get(t)==="true";return await a._remove(t),o}function zj(s,e){$d.set(s._key(),e)}function Bj(s){return bi(s._redirectPersistence)}function Hj(s){return Gd(Uj,s.config.apiKey,s.name)}async function Gj(s,e,t=!1){if(Cn(s.app))return Promise.reject(Ti(s));const a=Ca(s),o=e0(a,e),d=await new Fj(a,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await a._persistUserIfCurrent(d.user),await a._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=10*60*1e3;class Kj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Yj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var a;if(e.error&&!n0(e)){const o=((a=e.error.code)===null||a===void 0?void 0:a.split("auth/")[1])||"internal-error";t.onError(ys(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=$j&&this.cachedEventUids.clear(),this.cachedEventUids.has(Eb(e))}saveEventToCache(e){this.cachedEventUids.add(Eb(e)),this.lastProcessedEventTime=Date.now()}}function Eb(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function n0({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function Yj(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return n0(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qj(s,e={}){return wa(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Wj=/^https?/;async function Zj(s){if(s.config.emulator)return;const{authorizedDomains:e}=await Qj(s);for(const t of e)try{if(Jj(t))return}catch{}as(s,"unauthorized-domain")}function Jj(s){const e=Vp(),{protocol:t,hostname:a}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&a===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===a}if(!Wj.test(t))return!1;if(Xj.test(s))return a===s;const o=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eR=new Xc(3e4,6e4);function bb(){const s=Fs().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function tR(s){return new Promise((e,t)=>{var a,o,c;function d(){bb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{bb(),t(ys(s,"network-request-failed"))},timeout:eR.get()})}if(!((o=(a=Fs().gapi)===null||a===void 0?void 0:a.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((c=Fs().gapi)===null||c===void 0)&&c.load)d();else{const m=$I("iframefcb");return Fs()[m]=()=>{gapi.load?d():t(ys(s,"network-request-failed"))},FN(`${GI()}?onload=${m}`).catch(g=>t(g))}}).catch(e=>{throw Kd=null,e})}let Kd=null;function nR(s){return Kd=Kd||tR(s),Kd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR=new Xc(5e3,15e3),iR="__/auth/iframe",aR="emulator/auth/iframe",rR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lR(s){const e=s.config;we(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?_g(e,aR):`https://${s.config.authDomain}/${iR}`,a={apiKey:e.apiKey,appName:s.name,v:Rr},o=oR.get(s.config.apiHost);o&&(a.eid=o);const c=s._getFrameworks();return c.length&&(a.fw=c.join(",")),`${t}?${Kc(a).slice(1)}`}async function cR(s){const e=await nR(s),t=Fs().gapi;return we(t,s,"internal-error"),e.open({where:document.body,url:lR(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rR,dontclear:!0},a=>new Promise(async(o,c)=>{await a.restyle({setHideOnLeave:!1});const d=ys(s,"network-request-failed"),m=Fs().setTimeout(()=>{c(d)},sR.get());function g(){Fs().clearTimeout(m),o(a)}a.ping(g).then(g,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},dR=500,hR=600,fR="_blank",mR="http://localhost";class Tb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pR(s,e,t,a=dR,o=hR){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-a)/2,0).toString();let m="";const g=Object.assign(Object.assign({},uR),{width:a.toString(),height:o.toString(),top:c,left:d}),v=mn().toLowerCase();t&&(m=ON(v)?fR:t),RN(v)&&(e=e||mR,g.scrollbars="yes");const _=Object.entries(g).reduce((N,[C,w])=>`${N}${C}=${w},`,"");if(kI(v)&&m!=="_self")return gR(e||"",m),new Tb(null);const T=window.open(e||"",m,_);we(T,s,"popup-blocked");try{T.focus()}catch{}return new Tb(T)}function gR(s,e){const t=document.createElement("a");t.href=s,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR="__/auth/handler",yR="emulator/auth/handler",_R=encodeURIComponent("fac");async function Nb(s,e,t,a,o,c){we(s.config.authDomain,s,"auth-domain-config-required"),we(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:a,v:Rr,eventId:o};if(e instanceof xg){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",eC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,T]of Object.entries({}))d[_]=T}if(e instanceof Zc){const _=e.getScopes().filter(T=>T!=="");_.length>0&&(d.scopes=_.join(","))}s.tenantId&&(d.tid=s.tenantId);const m=d;for(const _ of Object.keys(m))m[_]===void 0&&delete m[_];const g=await s._getAppCheckToken(),v=g?`#${_R}=${encodeURIComponent(g)}`:"";return`${ER(s)}?${Kc(m).slice(1)}${v}`}function ER({config:s}){return s.emulator?_g(s,yR):`https://${s.authDomain}/${vR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp="webStorageSupport";class bR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=QN,this._completeRedirectFn=Gj,this._overrideRedirectResult=zj}async _openPopup(e,t,a,o){var c;xi((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await Nb(e,t,a,Vp(),o);return pR(e,d,Ag())}async _openRedirect(e,t,a,o){await this._originValidation(e);const c=await Nb(e,t,a,Vp(),o);return xj(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(xi(c,"If manager is not set, promise should be"),c)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await cR(e),a=new Kj(e);return t.register("authEvent",o=>(we(o?.authEvent,e,"invalid-auth-event"),{status:a.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(vp,{type:vp},o=>{var c;const d=(c=o?.[0])===null||c===void 0?void 0:c[vp];d!==void 0&&t(!!d),as(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Zj(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return LN()||DN()||bg()}}const TR=bR;var xb="@firebase/auth",Ab="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e(a?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function AR(s){is(new Bn("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:m}=a.options;we(d&&!d.includes(":"),"invalid-api-key",{appName:a.name});const g={apiKey:d,authDomain:m,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:UN(s)},v=new zI(a,o,c,g);return ZI(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),is(new Bn("auth-internal",e=>{const t=Ca(e.getProvider("auth").getImmediate());return(a=>new NR(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),fn(xb,Ab,xR(s)),fn(xb,Ab,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SR=5*60,wR=mN("authIdTokenMaxAge")||SR;let Sb=null;const CR=s=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>wR)return;const o=t?.token;Sb!==o&&(Sb=o,await fetch(s,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function IR(s=Qc()){const e=wi(s,"auth");if(e.isInitialized())return e.getImmediate();const t=WI(s,{popupRedirectResolver:TR,persistence:[Oj,bj,QN]}),a=mN("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(a,location.origin);if(location.origin===c.origin){const d=CR(c.toString());gj(t,d,()=>d(t.currentUser)),pj(t,m=>d(m))}}const o=dN("auth");return o&&JI(t,`http://${o}`),t}function jR(){var s,e;return(e=(s=document.getElementsByTagName("head"))===null||s===void 0?void 0:s[0])!==null&&e!==void 0?e:document}BI({loadJS(s){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",s),a.onload=e,a.onerror=o=>{const c=ys("internal-error");c.customData=o,t(c)},a.type="text/javascript",a.charset="UTF-8",jR().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});AR("Browser");var RR="firebase",DR="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fn(RR,DR,"app");var wb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fa,s0;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(O,x){function j(){}j.prototype=x.prototype,O.D=x.prototype,O.prototype=new j,O.prototype.constructor=O,O.C=function(R,P,M){for(var D=Array(arguments.length-2),re=2;re<arguments.length;re++)D[re-2]=arguments[re];return x.prototype[P].apply(R,D)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(a,t),a.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(O,x,j){j||(j=0);var R=Array(16);if(typeof x=="string")for(var P=0;16>P;++P)R[P]=x.charCodeAt(j++)|x.charCodeAt(j++)<<8|x.charCodeAt(j++)<<16|x.charCodeAt(j++)<<24;else for(P=0;16>P;++P)R[P]=x[j++]|x[j++]<<8|x[j++]<<16|x[j++]<<24;x=O.g[0],j=O.g[1],P=O.g[2];var M=O.g[3],D=x+(M^j&(P^M))+R[0]+3614090360&4294967295;x=j+(D<<7&4294967295|D>>>25),D=M+(P^x&(j^P))+R[1]+3905402710&4294967295,M=x+(D<<12&4294967295|D>>>20),D=P+(j^M&(x^j))+R[2]+606105819&4294967295,P=M+(D<<17&4294967295|D>>>15),D=j+(x^P&(M^x))+R[3]+3250441966&4294967295,j=P+(D<<22&4294967295|D>>>10),D=x+(M^j&(P^M))+R[4]+4118548399&4294967295,x=j+(D<<7&4294967295|D>>>25),D=M+(P^x&(j^P))+R[5]+1200080426&4294967295,M=x+(D<<12&4294967295|D>>>20),D=P+(j^M&(x^j))+R[6]+2821735955&4294967295,P=M+(D<<17&4294967295|D>>>15),D=j+(x^P&(M^x))+R[7]+4249261313&4294967295,j=P+(D<<22&4294967295|D>>>10),D=x+(M^j&(P^M))+R[8]+1770035416&4294967295,x=j+(D<<7&4294967295|D>>>25),D=M+(P^x&(j^P))+R[9]+2336552879&4294967295,M=x+(D<<12&4294967295|D>>>20),D=P+(j^M&(x^j))+R[10]+4294925233&4294967295,P=M+(D<<17&4294967295|D>>>15),D=j+(x^P&(M^x))+R[11]+2304563134&4294967295,j=P+(D<<22&4294967295|D>>>10),D=x+(M^j&(P^M))+R[12]+1804603682&4294967295,x=j+(D<<7&4294967295|D>>>25),D=M+(P^x&(j^P))+R[13]+4254626195&4294967295,M=x+(D<<12&4294967295|D>>>20),D=P+(j^M&(x^j))+R[14]+2792965006&4294967295,P=M+(D<<17&4294967295|D>>>15),D=j+(x^P&(M^x))+R[15]+1236535329&4294967295,j=P+(D<<22&4294967295|D>>>10),D=x+(P^M&(j^P))+R[1]+4129170786&4294967295,x=j+(D<<5&4294967295|D>>>27),D=M+(j^P&(x^j))+R[6]+3225465664&4294967295,M=x+(D<<9&4294967295|D>>>23),D=P+(x^j&(M^x))+R[11]+643717713&4294967295,P=M+(D<<14&4294967295|D>>>18),D=j+(M^x&(P^M))+R[0]+3921069994&4294967295,j=P+(D<<20&4294967295|D>>>12),D=x+(P^M&(j^P))+R[5]+3593408605&4294967295,x=j+(D<<5&4294967295|D>>>27),D=M+(j^P&(x^j))+R[10]+38016083&4294967295,M=x+(D<<9&4294967295|D>>>23),D=P+(x^j&(M^x))+R[15]+3634488961&4294967295,P=M+(D<<14&4294967295|D>>>18),D=j+(M^x&(P^M))+R[4]+3889429448&4294967295,j=P+(D<<20&4294967295|D>>>12),D=x+(P^M&(j^P))+R[9]+568446438&4294967295,x=j+(D<<5&4294967295|D>>>27),D=M+(j^P&(x^j))+R[14]+3275163606&4294967295,M=x+(D<<9&4294967295|D>>>23),D=P+(x^j&(M^x))+R[3]+4107603335&4294967295,P=M+(D<<14&4294967295|D>>>18),D=j+(M^x&(P^M))+R[8]+1163531501&4294967295,j=P+(D<<20&4294967295|D>>>12),D=x+(P^M&(j^P))+R[13]+2850285829&4294967295,x=j+(D<<5&4294967295|D>>>27),D=M+(j^P&(x^j))+R[2]+4243563512&4294967295,M=x+(D<<9&4294967295|D>>>23),D=P+(x^j&(M^x))+R[7]+1735328473&4294967295,P=M+(D<<14&4294967295|D>>>18),D=j+(M^x&(P^M))+R[12]+2368359562&4294967295,j=P+(D<<20&4294967295|D>>>12),D=x+(j^P^M)+R[5]+4294588738&4294967295,x=j+(D<<4&4294967295|D>>>28),D=M+(x^j^P)+R[8]+2272392833&4294967295,M=x+(D<<11&4294967295|D>>>21),D=P+(M^x^j)+R[11]+1839030562&4294967295,P=M+(D<<16&4294967295|D>>>16),D=j+(P^M^x)+R[14]+4259657740&4294967295,j=P+(D<<23&4294967295|D>>>9),D=x+(j^P^M)+R[1]+2763975236&4294967295,x=j+(D<<4&4294967295|D>>>28),D=M+(x^j^P)+R[4]+1272893353&4294967295,M=x+(D<<11&4294967295|D>>>21),D=P+(M^x^j)+R[7]+4139469664&4294967295,P=M+(D<<16&4294967295|D>>>16),D=j+(P^M^x)+R[10]+3200236656&4294967295,j=P+(D<<23&4294967295|D>>>9),D=x+(j^P^M)+R[13]+681279174&4294967295,x=j+(D<<4&4294967295|D>>>28),D=M+(x^j^P)+R[0]+3936430074&4294967295,M=x+(D<<11&4294967295|D>>>21),D=P+(M^x^j)+R[3]+3572445317&4294967295,P=M+(D<<16&4294967295|D>>>16),D=j+(P^M^x)+R[6]+76029189&4294967295,j=P+(D<<23&4294967295|D>>>9),D=x+(j^P^M)+R[9]+3654602809&4294967295,x=j+(D<<4&4294967295|D>>>28),D=M+(x^j^P)+R[12]+3873151461&4294967295,M=x+(D<<11&4294967295|D>>>21),D=P+(M^x^j)+R[15]+530742520&4294967295,P=M+(D<<16&4294967295|D>>>16),D=j+(P^M^x)+R[2]+3299628645&4294967295,j=P+(D<<23&4294967295|D>>>9),D=x+(P^(j|~M))+R[0]+4096336452&4294967295,x=j+(D<<6&4294967295|D>>>26),D=M+(j^(x|~P))+R[7]+1126891415&4294967295,M=x+(D<<10&4294967295|D>>>22),D=P+(x^(M|~j))+R[14]+2878612391&4294967295,P=M+(D<<15&4294967295|D>>>17),D=j+(M^(P|~x))+R[5]+4237533241&4294967295,j=P+(D<<21&4294967295|D>>>11),D=x+(P^(j|~M))+R[12]+1700485571&4294967295,x=j+(D<<6&4294967295|D>>>26),D=M+(j^(x|~P))+R[3]+2399980690&4294967295,M=x+(D<<10&4294967295|D>>>22),D=P+(x^(M|~j))+R[10]+4293915773&4294967295,P=M+(D<<15&4294967295|D>>>17),D=j+(M^(P|~x))+R[1]+2240044497&4294967295,j=P+(D<<21&4294967295|D>>>11),D=x+(P^(j|~M))+R[8]+1873313359&4294967295,x=j+(D<<6&4294967295|D>>>26),D=M+(j^(x|~P))+R[15]+4264355552&4294967295,M=x+(D<<10&4294967295|D>>>22),D=P+(x^(M|~j))+R[6]+2734768916&4294967295,P=M+(D<<15&4294967295|D>>>17),D=j+(M^(P|~x))+R[13]+1309151649&4294967295,j=P+(D<<21&4294967295|D>>>11),D=x+(P^(j|~M))+R[4]+4149444226&4294967295,x=j+(D<<6&4294967295|D>>>26),D=M+(j^(x|~P))+R[11]+3174756917&4294967295,M=x+(D<<10&4294967295|D>>>22),D=P+(x^(M|~j))+R[2]+718787259&4294967295,P=M+(D<<15&4294967295|D>>>17),D=j+(M^(P|~x))+R[9]+3951481745&4294967295,O.g[0]=O.g[0]+x&4294967295,O.g[1]=O.g[1]+(P+(D<<21&4294967295|D>>>11))&4294967295,O.g[2]=O.g[2]+P&4294967295,O.g[3]=O.g[3]+M&4294967295}a.prototype.u=function(O,x){x===void 0&&(x=O.length);for(var j=x-this.blockSize,R=this.B,P=this.h,M=0;M<x;){if(P==0)for(;M<=j;)o(this,O,M),M+=this.blockSize;if(typeof O=="string"){for(;M<x;)if(R[P++]=O.charCodeAt(M++),P==this.blockSize){o(this,R),P=0;break}}else for(;M<x;)if(R[P++]=O[M++],P==this.blockSize){o(this,R),P=0;break}}this.h=P,this.o+=x},a.prototype.v=function(){var O=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);O[0]=128;for(var x=1;x<O.length-8;++x)O[x]=0;var j=8*this.o;for(x=O.length-8;x<O.length;++x)O[x]=j&255,j/=256;for(this.u(O),O=Array(16),x=j=0;4>x;++x)for(var R=0;32>R;R+=8)O[j++]=this.g[x]>>>R&255;return O};function c(O,x){var j=m;return Object.prototype.hasOwnProperty.call(j,O)?j[O]:j[O]=x(O)}function d(O,x){this.h=x;for(var j=[],R=!0,P=O.length-1;0<=P;P--){var M=O[P]|0;R&&M==x||(j[P]=M,R=!1)}this.g=j}var m={};function g(O){return-128<=O&&128>O?c(O,function(x){return new d([x|0],0>x?-1:0)}):new d([O|0],0>O?-1:0)}function v(O){if(isNaN(O)||!isFinite(O))return T;if(0>O)return A(v(-O));for(var x=[],j=1,R=0;O>=j;R++)x[R]=O/j|0,j*=4294967296;return new d(x,0)}function _(O,x){if(O.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(O.charAt(0)=="-")return A(_(O.substring(1),x));if(0<=O.indexOf("-"))throw Error('number format error: interior "-" character');for(var j=v(Math.pow(x,8)),R=T,P=0;P<O.length;P+=8){var M=Math.min(8,O.length-P),D=parseInt(O.substring(P,P+M),x);8>M?(M=v(Math.pow(x,M)),R=R.j(M).add(v(D))):(R=R.j(j),R=R.add(v(D)))}return R}var T=g(0),N=g(1),C=g(16777216);s=d.prototype,s.m=function(){if(F(this))return-A(this).m();for(var O=0,x=1,j=0;j<this.g.length;j++){var R=this.i(j);O+=(0<=R?R:4294967296+R)*x,x*=4294967296}return O},s.toString=function(O){if(O=O||10,2>O||36<O)throw Error("radix out of range: "+O);if(w(this))return"0";if(F(this))return"-"+A(this).toString(O);for(var x=v(Math.pow(O,6)),j=this,R="";;){var P=U(j,x).g;j=L(j,P.j(x));var M=((0<j.g.length?j.g[0]:j.h)>>>0).toString(O);if(j=P,w(j))return M+R;for(;6>M.length;)M="0"+M;R=M+R}},s.i=function(O){return 0>O?0:O<this.g.length?this.g[O]:this.h};function w(O){if(O.h!=0)return!1;for(var x=0;x<O.g.length;x++)if(O.g[x]!=0)return!1;return!0}function F(O){return O.h==-1}s.l=function(O){return O=L(this,O),F(O)?-1:w(O)?0:1};function A(O){for(var x=O.g.length,j=[],R=0;R<x;R++)j[R]=~O.g[R];return new d(j,~O.h).add(N)}s.abs=function(){return F(this)?A(this):this},s.add=function(O){for(var x=Math.max(this.g.length,O.g.length),j=[],R=0,P=0;P<=x;P++){var M=R+(this.i(P)&65535)+(O.i(P)&65535),D=(M>>>16)+(this.i(P)>>>16)+(O.i(P)>>>16);R=D>>>16,M&=65535,D&=65535,j[P]=D<<16|M}return new d(j,j[j.length-1]&-2147483648?-1:0)};function L(O,x){return O.add(A(x))}s.j=function(O){if(w(this)||w(O))return T;if(F(this))return F(O)?A(this).j(A(O)):A(A(this).j(O));if(F(O))return A(this.j(A(O)));if(0>this.l(C)&&0>O.l(C))return v(this.m()*O.m());for(var x=this.g.length+O.g.length,j=[],R=0;R<2*x;R++)j[R]=0;for(R=0;R<this.g.length;R++)for(var P=0;P<O.g.length;P++){var M=this.i(R)>>>16,D=this.i(R)&65535,re=O.i(P)>>>16,ye=O.i(P)&65535;j[2*R+2*P]+=D*ye,W(j,2*R+2*P),j[2*R+2*P+1]+=M*ye,W(j,2*R+2*P+1),j[2*R+2*P+1]+=D*re,W(j,2*R+2*P+1),j[2*R+2*P+2]+=M*re,W(j,2*R+2*P+2)}for(R=0;R<x;R++)j[R]=j[2*R+1]<<16|j[2*R];for(R=x;R<2*x;R++)j[R]=0;return new d(j,0)};function W(O,x){for(;(O[x]&65535)!=O[x];)O[x+1]+=O[x]>>>16,O[x]&=65535,x++}function H(O,x){this.g=O,this.h=x}function U(O,x){if(w(x))throw Error("division by zero");if(w(O))return new H(T,T);if(F(O))return x=U(A(O),x),new H(A(x.g),A(x.h));if(F(x))return x=U(O,A(x)),new H(A(x.g),x.h);if(30<O.g.length){if(F(O)||F(x))throw Error("slowDivide_ only works with positive integers.");for(var j=N,R=x;0>=R.l(O);)j=z(j),R=z(R);var P=ae(j,1),M=ae(R,1);for(R=ae(R,2),j=ae(j,2);!w(R);){var D=M.add(R);0>=D.l(O)&&(P=P.add(j),M=D),R=ae(R,1),j=ae(j,1)}return x=L(O,P.j(x)),new H(P,x)}for(P=T;0<=O.l(x);){for(j=Math.max(1,Math.floor(O.m()/x.m())),R=Math.ceil(Math.log(j)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),M=v(j),D=M.j(x);F(D)||0<D.l(O);)j-=R,M=v(j),D=M.j(x);w(M)&&(M=N),P=P.add(M),O=L(O,D)}return new H(P,O)}s.A=function(O){return U(this,O).h},s.and=function(O){for(var x=Math.max(this.g.length,O.g.length),j=[],R=0;R<x;R++)j[R]=this.i(R)&O.i(R);return new d(j,this.h&O.h)},s.or=function(O){for(var x=Math.max(this.g.length,O.g.length),j=[],R=0;R<x;R++)j[R]=this.i(R)|O.i(R);return new d(j,this.h|O.h)},s.xor=function(O){for(var x=Math.max(this.g.length,O.g.length),j=[],R=0;R<x;R++)j[R]=this.i(R)^O.i(R);return new d(j,this.h^O.h)};function z(O){for(var x=O.g.length+1,j=[],R=0;R<x;R++)j[R]=O.i(R)<<1|O.i(R-1)>>>31;return new d(j,O.h)}function ae(O,x){var j=x>>5;x%=32;for(var R=O.g.length-j,P=[],M=0;M<R;M++)P[M]=0<x?O.i(M+j)>>>x|O.i(M+j+1)<<32-x:O.i(M+j);return new d(P,O.h)}a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,s0=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=_,fa=d}).apply(typeof wb<"u"?wb:typeof self<"u"?self:typeof window<"u"?window:{});var kd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var i0,_c,a0,Yd,qp,r0,o0,l0;(function(){var s,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,E){return h==Array.prototype||h==Object.prototype||(h[y]=E.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof kd=="object"&&kd];for(var y=0;y<h.length;++y){var E=h[y];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var a=t(this);function o(h,y){if(y)e:{var E=a;h=h.split(".");for(var I=0;I<h.length-1;I++){var $=h[I];if(!($ in E))break e;E=E[$]}h=h[h.length-1],I=E[h],y=y(I),y!=I&&y!=null&&e(E,h,{configurable:!0,writable:!0,value:y})}}function c(h,y){h instanceof String&&(h+="");var E=0,I=!1,$={next:function(){if(!I&&E<h.length){var Z=E++;return{value:y(Z,h[Z]),done:!1}}return I=!0,{done:!0,value:void 0}}};return $[Symbol.iterator]=function(){return $},$}o("Array.prototype.values",function(h){return h||function(){return c(this,function(y,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},m=this||self;function g(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function v(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function _(h,y,E){return h.call.apply(h.bind,arguments)}function T(h,y,E){if(!h)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var $=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply($,I),h.apply(y,$)}}return function(){return h.apply(y,arguments)}}function N(h,y,E){return N=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:T,N.apply(null,arguments)}function C(h,y){var E=Array.prototype.slice.call(arguments,1);return function(){var I=E.slice();return I.push.apply(I,arguments),h.apply(this,I)}}function w(h,y){function E(){}E.prototype=y.prototype,h.aa=y.prototype,h.prototype=new E,h.prototype.constructor=h,h.Qb=function(I,$,Z){for(var de=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)de[Be-2]=arguments[Be];return y.prototype[$].apply(I,de)}}function F(h){const y=h.length;if(0<y){const E=Array(y);for(let I=0;I<y;I++)E[I]=h[I];return E}return[]}function A(h,y){for(let E=1;E<arguments.length;E++){const I=arguments[E];if(g(I)){const $=h.length||0,Z=I.length||0;h.length=$+Z;for(let de=0;de<Z;de++)h[$+de]=I[de]}else h.push(I)}}class L{constructor(y,E){this.i=y,this.j=E,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function W(h){return/^[\s\xa0]*$/.test(h)}function H(){var h=m.navigator;return h&&(h=h.userAgent)?h:""}function U(h){return U[" "](h),h}U[" "]=function(){};var z=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function ae(h,y,E){for(const I in h)y.call(E,h[I],I,h)}function O(h,y){for(const E in h)y.call(void 0,h[E],E,h)}function x(h){const y={};for(const E in h)y[E]=h[E];return y}const j="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(h,y){let E,I;for(let $=1;$<arguments.length;$++){I=arguments[$];for(E in I)h[E]=I[E];for(let Z=0;Z<j.length;Z++)E=j[Z],Object.prototype.hasOwnProperty.call(I,E)&&(h[E]=I[E])}}function P(h){var y=1;h=h.split(":");const E=[];for(;0<y&&h.length;)E.push(h.shift()),y--;return h.length&&E.push(h.join(":")),E}function M(h){m.setTimeout(()=>{throw h},0)}function D(){var h=ge;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class re{constructor(){this.h=this.g=null}add(y,E){const I=ye.get();I.set(y,E),this.h?this.h.next=I:this.g=I,this.h=I}}var ye=new L(()=>new G,h=>h.reset());class G{constructor(){this.next=this.g=this.h=null}set(y,E){this.h=y,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let ne,ce=!1,ge=new re,V=()=>{const h=m.Promise.resolve(void 0);ne=()=>{h.then(ee)}};var ee=()=>{for(var h;h=D();){try{h.h.call(h.g)}catch(E){M(E)}var y=ye;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}ce=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var Te=function(){if(!m.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};m.addEventListener("test",E,y),m.removeEventListener("test",E,y)}catch{}return h}();function Pe(h,y){if(ue.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var E=this.type=h.type,I=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(z){e:{try{U(y.nodeName);var $=!0;break e}catch{}$=!1}$||(y=null)}}else E=="mouseover"?y=h.fromElement:E=="mouseout"&&(y=h.toElement);this.relatedTarget=y,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Ie[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Pe.aa.h.call(this)}}w(Pe,ue);var Ie={2:"touch",3:"pen",4:"mouse"};Pe.prototype.h=function(){Pe.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Ut="closure_listenable_"+(1e6*Math.random()|0),ot=0;function bs(h,y,E,I,$){this.listener=h,this.proxy=null,this.src=y,this.type=E,this.capture=!!I,this.ha=$,this.key=++ot,this.da=this.fa=!1}function Ii(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ks(h){this.src=h,this.g={},this.h=0}Ks.prototype.add=function(h,y,E,I,$){var Z=h.toString();h=this.g[Z],h||(h=this.g[Z]=[],this.h++);var de=Ma(h,y,I,$);return-1<de?(y=h[de],E||(y.fa=!1)):(y=new bs(y,this.src,Z,!!I,$),y.fa=E,h.push(y)),y};function Oa(h,y){var E=y.type;if(E in h.g){var I=h.g[E],$=Array.prototype.indexOf.call(I,y,void 0),Z;(Z=0<=$)&&Array.prototype.splice.call(I,$,1),Z&&(Ii(y),h.g[E].length==0&&(delete h.g[E],h.h--))}}function Ma(h,y,E,I){for(var $=0;$<h.length;++$){var Z=h[$];if(!Z.da&&Z.listener==y&&Z.capture==!!E&&Z.ha==I)return $}return-1}var Pa="closure_lm_"+(1e6*Math.random()|0),ol={};function du(h,y,E,I,$){if(Array.isArray(y)){for(var Z=0;Z<y.length;Z++)du(h,y[Z],E,I,$);return null}return E=hu(E),h&&h[Ut]?h.K(y,E,v(I)?!!I.capture:!1,$):Gn(h,y,E,!1,I,$)}function Gn(h,y,E,I,$,Z){if(!y)throw Error("Invalid event type");var de=v($)?!!$.capture:!!$,Be=kr(h);if(Be||(h[Pa]=Be=new Ks(h)),E=Be.add(y,E,I,de,Z),E.proxy)return E;if(I=af(),E.proxy=I,I.src=h,I.listener=E,h.addEventListener)Te||($=de),$===void 0&&($=!1),h.addEventListener(y.toString(),I,$);else if(h.attachEvent)h.attachEvent(ka(y.toString()),I);else if(h.addListener&&h.removeListener)h.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return E}function af(){function h(E){return y.call(h.src,h.listener,E)}const y=rf;return h}function ll(h,y,E,I,$){if(Array.isArray(y))for(var Z=0;Z<y.length;Z++)ll(h,y[Z],E,I,$);else I=v(I)?!!I.capture:!!I,E=hu(E),h&&h[Ut]?(h=h.i,y=String(y).toString(),y in h.g&&(Z=h.g[y],E=Ma(Z,E,I,$),-1<E&&(Ii(Z[E]),Array.prototype.splice.call(Z,E,1),Z.length==0&&(delete h.g[y],h.h--)))):h&&(h=kr(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Ma(y,E,I,$)),(E=-1<h?y[h]:null)&&Pr(E))}function Pr(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[Ut])Oa(y.i,h);else{var E=h.type,I=h.proxy;y.removeEventListener?y.removeEventListener(E,I,h.capture):y.detachEvent?y.detachEvent(ka(E),I):y.addListener&&y.removeListener&&y.removeListener(I),(E=kr(y))?(Oa(E,h),E.h==0&&(E.src=null,y[Pa]=null)):Ii(h)}}}function ka(h){return h in ol?ol[h]:ol[h]="on"+h}function rf(h,y){if(h.da)h=!0;else{y=new Pe(y,this);var E=h.listener,I=h.ha||h.src;h.fa&&Pr(h),h=E.call(I,y)}return h}function kr(h){return h=h[Pa],h instanceof Ks?h:null}var cl="__closure_events_fn_"+(1e9*Math.random()>>>0);function hu(h){return typeof h=="function"?h:(h[cl]||(h[cl]=function(y){return h.handleEvent(y)}),h[cl])}function gt(){he.call(this),this.i=new Ks(this),this.M=this,this.F=null}w(gt,he),gt.prototype[Ut]=!0,gt.prototype.removeEventListener=function(h,y,E,I){ll(this,h,y,E,I)};function We(h,y){var E,I=h.F;if(I)for(E=[];I;I=I.F)E.push(I);if(h=h.M,I=y.type||y,typeof y=="string")y=new ue(y,h);else if(y instanceof ue)y.target=y.target||h;else{var $=y;y=new ue(I,h),R(y,$)}if($=!0,E)for(var Z=E.length-1;0<=Z;Z--){var de=y.g=E[Z];$=jn(de,I,!0,y)&&$}if(de=y.g=h,$=jn(de,I,!0,y)&&$,$=jn(de,I,!1,y)&&$,E)for(Z=0;Z<E.length;Z++)de=y.g=E[Z],$=jn(de,I,!1,y)&&$}gt.prototype.N=function(){if(gt.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var E=h.g[y],I=0;I<E.length;I++)Ii(E[I]);delete h.g[y],h.h--}}this.F=null},gt.prototype.K=function(h,y,E,I){return this.i.add(String(h),y,!1,E,I)},gt.prototype.L=function(h,y,E,I){return this.i.add(String(h),y,!0,E,I)};function jn(h,y,E,I){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var $=!0,Z=0;Z<y.length;++Z){var de=y[Z];if(de&&!de.da&&de.capture==E){var Be=de.listener,Dt=de.ha||de.src;de.fa&&Oa(h.i,de),$=Be.call(Dt,I)!==!1&&$}}return $&&!I.defaultPrevented}function on(h,y,E){if(typeof h=="function")E&&(h=N(h,E));else if(h&&typeof h.handleEvent=="function")h=N(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:m.setTimeout(h,y||0)}function fu(h){h.g=on(()=>{h.g=null,h.i&&(h.i=!1,fu(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class of extends he{constructor(y,E){super(),this.m=y,this.l=E,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:fu(this)}N(){super.N(),this.g&&(m.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Va(h){he.call(this),this.h=h,this.g={}}w(Va,he);var La=[];function Ua(h){ae(h.g,function(y,E){this.g.hasOwnProperty(E)&&Pr(y)},h),h.g={}}Va.prototype.N=function(){Va.aa.N.call(this),Ua(this)},Va.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var os=m.JSON.stringify,Vr=m.JSON.parse,Fa=class{stringify(h){return m.JSON.stringify(h,void 0)}parse(h){return m.JSON.parse(h,void 0)}};function ul(){}ul.prototype.h=null;function dl(h){return h.h||(h.h=h.i())}function hl(){}var Ys={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Qs(){ue.call(this,"d")}w(Qs,ue);function fl(){ue.call(this,"c")}w(fl,ue);var Ts={},ml=null;function ji(){return ml=ml||new gt}Ts.La="serverreachability";function Lr(h){ue.call(this,Ts.La,h)}w(Lr,ue);function Ri(h){const y=ji();We(y,new Lr(y))}Ts.STAT_EVENT="statevent";function mu(h,y){ue.call(this,Ts.STAT_EVENT,h),this.stat=y}w(mu,ue);function ut(h){const y=ji();We(y,new mu(y,h))}Ts.Ma="timingevent";function Rt(h,y){ue.call(this,Ts.Ma,h),this.size=y}w(Rt,ue);function At(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return m.setTimeout(function(){h()},y)}function $n(){this.g=!0}$n.prototype.xa=function(){this.g=!1};function pl(h,y,E,I,$,Z){h.info(function(){if(h.g)if(Z)for(var de="",Be=Z.split("&"),Dt=0;Dt<Be.length;Dt++){var He=Be[Dt].split("=");if(1<He.length){var qt=He[0];He=He[1];var Ot=qt.split("_");de=2<=Ot.length&&Ot[1]=="type"?de+(qt+"="+He+"&"):de+(qt+"=redacted&")}}else de=null;else de=Z;return"XMLHTTP REQ ("+I+") [attempt "+$+"]: "+y+`
`+E+`
`+de})}function lf(h,y,E,I,$,Z,de){h.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+$+"]: "+y+`
`+E+`
`+Z+" "+de})}function Di(h,y,E,I){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+qa(h,E)+(I?" "+I:"")})}function pu(h,y){h.info(function(){return"TIMEOUT: "+y})}$n.prototype.info=function(){};function qa(h,y){if(!h.g)return y;if(!y)return null;try{var E=JSON.parse(y);if(E){for(h=0;h<E.length;h++)if(Array.isArray(E[h])){var I=E[h];if(!(2>I.length)){var $=I[1];if(Array.isArray($)&&!(1>$.length)){var Z=$[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(var de=1;de<$.length;de++)$[de]=""}}}}return os(E)}catch{return y}}var Oi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Xs={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ns;function xs(){}w(xs,ul),xs.prototype.g=function(){return new XMLHttpRequest},xs.prototype.i=function(){return{}},Ns=new xs;function pn(h,y,E,I){this.j=h,this.i=y,this.l=E,this.R=I||1,this.U=new Va(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Et}function Et(){this.i=null,this.g="",this.h=!1}var gl={},Ur={};function ls(h,y,E){h.L=1,h.v=$a(Rn(y)),h.m=E,h.P=!0,Ws(h,null)}function Ws(h,y){h.F=Date.now(),za(h),h.A=Rn(h.v);var E=h.A,I=h.R;Array.isArray(I)||(I=[String(I)]),Tl(E.i,"t",I),h.C=0,E=h.j.J,h.h=new Et,h.g=Ru(h.j,E?y:null,!h.m),0<h.O&&(h.M=new of(N(h.Y,h,h.g),h.O)),y=h.U,E=h.g,I=h.ca;var $="readystatechange";Array.isArray($)||($&&(La[0]=$.toString()),$=La);for(var Z=0;Z<$.length;Z++){var de=du(E,$[Z],I||y.handleEvent,!1,y.h||y);if(!de)break;y.g[de.key]=de}y=h.H?x(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),Ri(),pl(h.i,h.u,h.A,h.l,h.R,h.m)}pn.prototype.ca=function(h){h=h.target;const y=this.M;y&&Xn(h)==3?y.j():this.Y(h)},pn.prototype.Y=function(h){try{if(h==this.g)e:{const Ot=Xn(this.g);var y=this.g.Ba();const ai=this.g.Z();if(!(3>Ot)&&(Ot!=3||this.g&&(this.h.h||this.g.oa()||Nu(this.g)))){this.J||Ot!=4||y==7||(y==8||0>=ai?Ri(3):Ri(2)),Mi(this);var E=this.g.Z();this.X=E;t:if(gu(this)){var I=Nu(this.g);h="";var $=I.length,Z=Xn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Kt(this),As(this);var de="";break t}this.h.i=new m.TextDecoder}for(y=0;y<$;y++)this.h.h=!0,h+=this.h.i.decode(I[y],{stream:!(Z&&y==$-1)});I.length=0,this.h.g+=h,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=E==200,lf(this.i,this.u,this.A,this.l,this.R,Ot,E),this.o){if(this.T&&!this.K){t:{if(this.g){var Be,Dt=this.g;if((Be=Dt.g?Dt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(Be)){var He=Be;break t}}He=null}if(E=He)Di(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ba(this,E);else{this.o=!1,this.s=3,ut(12),Kt(this),As(this);break e}}if(this.P){E=!0;let Yt;for(;!this.J&&this.C<de.length;)if(Yt=vu(this,de),Yt==Ur){Ot==4&&(this.s=4,ut(14),E=!1),Di(this.i,this.l,null,"[Incomplete Response]");break}else if(Yt==gl){this.s=4,ut(15),Di(this.i,this.l,de,"[Invalid Chunk]"),E=!1;break}else Di(this.i,this.l,Yt,null),Ba(this,Yt);if(gu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ot!=4||de.length!=0||this.h.h||(this.s=1,ut(16),E=!1),this.o=this.o&&E,!E)Di(this.i,this.l,de,"[Invalid Chunked Response]"),Kt(this),As(this);else if(0<de.length&&!this.W){this.W=!0;var qt=this.j;qt.g==this&&qt.ba&&!qt.M&&(qt.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),er(qt),qt.M=!0,ut(11))}}else Di(this.i,this.l,de,null),Ba(this,de);Ot==4&&Kt(this),this.o&&!this.J&&(Ot==4?Cu(this.j,this):(this.o=!1,za(this)))}else ff(this.g),E==400&&0<de.indexOf("Unknown SID")?(this.s=3,ut(12)):(this.s=0,ut(13)),Kt(this),As(this)}}}catch{}finally{}};function gu(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function vu(h,y){var E=h.C,I=y.indexOf(`
`,E);return I==-1?Ur:(E=Number(y.substring(E,I)),isNaN(E)?gl:(I+=1,I+E>y.length?Ur:(y=y.slice(I,I+E),h.C=I+E,y)))}pn.prototype.cancel=function(){this.J=!0,Kt(this)};function za(h){h.S=Date.now()+h.I,yu(h,h.I)}function yu(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=At(N(h.ba,h),y)}function Mi(h){h.B&&(m.clearTimeout(h.B),h.B=null)}pn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(pu(this.i,this.A),this.L!=2&&(Ri(),ut(17)),Kt(this),this.s=2,As(this)):yu(this,this.S-h)};function As(h){h.j.G==0||h.J||Cu(h.j,h)}function Kt(h){Mi(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,Ua(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Ba(h,y){try{var E=h.j;if(E.G!=0&&(E.g==h||vl(E.h,h))){if(!h.K&&vl(E.h,h)&&E.G==3){try{var I=E.Da.g.parse(y)}catch{I=null}if(Array.isArray(I)&&I.length==3){var $=I;if($[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<h.F)Wr(E),Qr(E);else break e;wl(E),ut(18)}}else E.za=$[1],0<E.za-E.T&&37500>$[2]&&E.F&&E.v==0&&!E.C&&(E.C=At(N(E.Za,E),6e3));if(1>=qr(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else ii(E,11)}else if((h.K||E.g==h)&&Wr(E),!W(y))for($=E.Da.g.parse(y),y=0;y<$.length;y++){let He=$[y];if(E.T=He[0],He=He[1],E.G==2)if(He[0]=="c"){E.K=He[1],E.ia=He[2];const qt=He[3];qt!=null&&(E.la=qt,E.j.info("VER="+E.la));const Ot=He[4];Ot!=null&&(E.Aa=Ot,E.j.info("SVER="+E.Aa));const ai=He[5];ai!=null&&typeof ai=="number"&&0<ai&&(I=1.5*ai,E.L=I,E.j.info("backChannelRequestTimeoutMs_="+I)),I=E;const Yt=h.g;if(Yt){const Ds=Yt.g?Yt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ds){var Z=I.h;Z.g||Ds.indexOf("spdy")==-1&&Ds.indexOf("quic")==-1&&Ds.indexOf("h2")==-1||(Z.j=Z.l,Z.g=new Set,Z.h&&(zr(Z,Z.h),Z.h=null))}if(I.D){const Il=Yt.g?Yt.g.getResponseHeader("X-HTTP-Session-Id"):null;Il&&(I.ya=Il,tt(I.I,I.D,Il))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-h.F,E.j.info("Handshake RTT: "+E.R+"ms")),I=E;var de=h;if(I.qa=ju(I,I.J?I.ia:null,I.W),de.K){gn(I.h,de);var Be=de,Dt=I.L;Dt&&(Be.I=Dt),Be.B&&(Mi(Be),za(Be)),I.g=de}else Su(I);0<E.i.length&&Xr(E)}else He[0]!="stop"&&He[0]!="close"||ii(E,7);else E.G==3&&(He[0]=="stop"||He[0]=="close"?He[0]=="stop"?ii(E,7):Al(E):He[0]!="noop"&&E.l&&E.l.ta(He),E.v=0)}}Ri(4)}catch{}}var _u=class{constructor(h,y){this.g=h,this.map=y}};function Zs(h){this.l=h||10,m.PerformanceNavigationTiming?(h=m.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(m.chrome&&m.chrome.loadTimes&&m.chrome.loadTimes()&&m.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Fr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function qr(h){return h.h?1:h.g?h.g.size:0}function vl(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function zr(h,y){h.g?h.g.add(y):h.h=y}function gn(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Zs.prototype.cancel=function(){if(this.i=yl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function yl(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const E of h.g.values())y=y.concat(E.D);return y}return F(h.i)}function cf(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(g(h)){for(var y=[],E=h.length,I=0;I<E;I++)y.push(h[I]);return y}y=[],E=0;for(I in h)y[E++]=h[I];return y}function Br(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(g(h)||typeof h=="string"){var y=[];h=h.length;for(var E=0;E<h;E++)y.push(E);return y}y=[],E=0;for(const I in h)y[E++]=I;return y}}}function _l(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(g(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var E=Br(h),I=cf(h),$=I.length,Z=0;Z<$;Z++)y.call(void 0,I[Z],E&&E[Z],h)}var Ha=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uf(h,y){if(h){h=h.split("&");for(var E=0;E<h.length;E++){var I=h[E].indexOf("="),$=null;if(0<=I){var Z=h[E].substring(0,I);$=h[E].substring(I+1)}else Z=h[E];y(Z,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function St(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof St){this.h=h.h,Ga(this,h.j),this.o=h.o,this.g=h.g,Pi(this,h.s),this.l=h.l;var y=h.i,E=new ei;E.i=y.i,y.g&&(E.g=new Map(y.g),E.h=y.h),Js(this,E),this.m=h.m}else h&&(y=String(h).match(Ha))?(this.h=!1,Ga(this,y[1]||"",!0),this.o=Kn(y[2]||""),this.g=Kn(y[3]||"",!0),Pi(this,y[4]),this.l=Kn(y[5]||"",!0),Js(this,y[6]||"",!0),this.m=Kn(y[7]||"")):(this.h=!1,this.i=new ei(null,this.h))}St.prototype.toString=function(){var h=[],y=this.j;y&&h.push(Ka(y,El,!0),":");var E=this.g;return(E||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Ka(y,El,!0),"@"),h.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&h.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(Ka(E,E.charAt(0)=="/"?df:bl,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",Ka(E,Hr)),h.join("")};function Rn(h){return new St(h)}function Ga(h,y,E){h.j=E?Kn(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Pi(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function Js(h,y,E){y instanceof ei?(h.i=y,bu(h.i,h.h)):(E||(y=Ka(y,hf)),h.i=new ei(y,h.h))}function tt(h,y,E){h.i.set(y,E)}function $a(h){return tt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Kn(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ka(h,y,E){return typeof h=="string"?(h=encodeURI(h).replace(y,Eu),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Eu(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var El=/[#\/\?@]/g,bl=/[#\?:]/g,df=/[#\?]/g,hf=/[#\?@]/g,Hr=/#/g;function ei(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function Yn(h){h.g||(h.g=new Map,h.h=0,h.i&&uf(h.i,function(y,E){h.add(decodeURIComponent(y.replace(/\+/g," ")),E)}))}s=ei.prototype,s.add=function(h,y){Yn(this),this.i=null,h=Ss(this,h);var E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(y),this.h+=1,this};function ti(h,y){Yn(h),y=Ss(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function ni(h,y){return Yn(h),y=Ss(h,y),h.g.has(y)}s.forEach=function(h,y){Yn(this),this.g.forEach(function(E,I){E.forEach(function($){h.call(y,$,I,this)},this)},this)},s.na=function(){Yn(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),E=[];for(let I=0;I<y.length;I++){const $=h[I];for(let Z=0;Z<$.length;Z++)E.push(y[I])}return E},s.V=function(h){Yn(this);let y=[];if(typeof h=="string")ni(this,h)&&(y=y.concat(this.g.get(Ss(this,h))));else{h=Array.from(this.g.values());for(let E=0;E<h.length;E++)y=y.concat(h[E])}return y},s.set=function(h,y){return Yn(this),this.i=null,h=Ss(this,h),ni(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},s.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function Tl(h,y,E){ti(h,y),0<E.length&&(h.i=null,h.g.set(Ss(h,y),F(E)),h.h+=E.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var E=0;E<y.length;E++){var I=y[E];const Z=encodeURIComponent(String(I)),de=this.V(I);for(I=0;I<de.length;I++){var $=Z;de[I]!==""&&($+="="+encodeURIComponent(String(de[I]))),h.push($)}}return this.i=h.join("&")};function Ss(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function bu(h,y){y&&!h.j&&(Yn(h),h.i=null,h.g.forEach(function(E,I){var $=I.toLowerCase();I!=$&&(ti(this,I),Tl(this,$,E))},h)),h.j=y}function Ya(h,y){const E=new $n;if(m.Image){const I=new Image;I.onload=C(Qn,E,"TestLoadImage: loaded",!0,y,I),I.onerror=C(Qn,E,"TestLoadImage: error",!1,y,I),I.onabort=C(Qn,E,"TestLoadImage: abort",!1,y,I),I.ontimeout=C(Qn,E,"TestLoadImage: timeout",!1,y,I),m.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=h}else y(!1)}function cs(h,y){const E=new $n,I=new AbortController,$=setTimeout(()=>{I.abort(),Qn(E,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:I.signal}).then(Z=>{clearTimeout($),Z.ok?Qn(E,"TestPingServer: ok",!0,y):Qn(E,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout($),Qn(E,"TestPingServer: error",!1,y)})}function Qn(h,y,E,I,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),I(E)}catch{}}function Qa(){this.g=new Fa}function ws(h,y,E){const I=E||"";try{_l(h,function($,Z){let de=$;v($)&&(de=os($)),y.push(I+Z+"="+encodeURIComponent(de))})}catch($){throw y.push(I+"type="+encodeURIComponent("_badmap")),$}}function ki(h){this.l=h.Ub||null,this.j=h.eb||!1}w(ki,ul),ki.prototype.g=function(){return new si(this.l,this.j)},ki.prototype.i=function(h){return function(){return h}}({});function si(h,y){gt.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(si,gt),s=si.prototype,s.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,Is(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||m).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Cs(this)),this.readyState=0},s.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Is(this)),this.g&&(this.readyState=3,Is(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof m.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Nl(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Nl(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}s.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Cs(this):Is(this),this.readyState==3&&Nl(this)}},s.Ra=function(h){this.g&&(this.response=this.responseText=h,Cs(this))},s.Qa=function(h){this.g&&(this.response=h,Cs(this))},s.ga=function(){this.g&&Cs(this)};function Cs(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Is(h)}s.setRequestHeader=function(h,y){this.u.append(h,y)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var E=y.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=y.next();return h.join(`\r
`)};function Is(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(si.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function xl(h){let y="";return ae(h,function(E,I){y+=I,y+=":",y+=E,y+=`\r
`}),y}function Ft(h,y,E){e:{for(I in E){var I=!1;break e}I=!0}I||(E=xl(E),typeof h=="string"?E!=null&&encodeURIComponent(String(E)):tt(h,y,E))}function Xe(h){gt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(Xe,gt);var Gr=/^https?$/i,Xa=["POST","PUT"];s=Xe.prototype,s.Ha=function(h){this.J=h},s.ea=function(h,y,E,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ns.g(),this.v=this.o?dl(this.o):dl(Ns),this.g.onreadystatechange=N(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(Z){Tu(this,Z);return}if(h=E||"",E=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var $ in I)E.set($,I[$]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const Z of I.keys())E.set(Z,I.get(Z));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(E.keys()).find(Z=>Z.toLowerCase()=="content-type"),$=m.FormData&&h instanceof m.FormData,!(0<=Array.prototype.indexOf.call(Xa,y,void 0))||I||$||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Z,de]of E)this.g.setRequestHeader(Z,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wa(this),this.u=!0,this.g.send(h),this.u=!1}catch(Z){Tu(this,Z)}};function Tu(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,$r(h),js(h)}function $r(h){h.A||(h.A=!0,We(h,"complete"),We(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,We(this,"complete"),We(this,"abort"),js(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),js(this,!0)),Xe.aa.N.call(this)},s.Ea=function(){this.s||(this.B||this.u||this.j?Kr(this):this.bb())},s.bb=function(){Kr(this)};function Kr(h){if(h.h&&typeof d<"u"&&(!h.v[1]||Xn(h)!=4||h.Z()!=2)){if(h.u&&Xn(h)==4)on(h.Ea,0,h);else if(We(h,"readystatechange"),Xn(h)==4){h.h=!1;try{const de=h.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var E;if(!(E=y)){var I;if(I=de===0){var $=String(h.D).match(Ha)[1]||null;!$&&m.self&&m.self.location&&($=m.self.location.protocol.slice(0,-1)),I=!Gr.test($?$.toLowerCase():"")}E=I}if(E)We(h,"complete"),We(h,"success");else{h.m=6;try{var Z=2<Xn(h)?h.g.statusText:""}catch{Z=""}h.l=Z+" ["+h.Z()+"]",$r(h)}}finally{js(h)}}}}function js(h,y){if(h.g){Wa(h);const E=h.g,I=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||We(h,"ready");try{E.onreadystatechange=I}catch{}}}function Wa(h){h.I&&(m.clearTimeout(h.I),h.I=null)}s.isActive=function(){return!!this.g};function Xn(h){return h.g?h.g.readyState:0}s.Z=function(){try{return 2<Xn(this)?this.g.status:-1}catch{return-1}},s.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),Vr(y)}};function Nu(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ff(h){const y={};h=(h.g&&2<=Xn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<h.length;I++){if(W(h[I]))continue;var E=P(h[I]);const $=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const Z=y[$]||[];y[$]=Z,Z.push(E)}O(y,function(I){return I.join(", ")})}s.Ba=function(){return this.m},s.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Za(h,y,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||y}function Yr(h){this.Aa=0,this.i=[],this.j=new $n,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Za("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Za("baseRetryDelayMs",5e3,h),this.cb=Za("retryDelaySeedMs",1e4,h),this.Wa=Za("forwardChannelMaxRetries",2,h),this.wa=Za("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new Zs(h&&h.concurrentRequestLimit),this.Da=new Qa,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}s=Yr.prototype,s.la=8,s.G=1,s.connect=function(h,y,E,I){ut(0),this.W=h,this.H=y||{},E&&I!==void 0&&(this.H.OSID=E,this.H.OAID=I),this.F=this.X,this.I=ju(this,null,this.W),Xr(this)};function Al(h){if(xu(h),h.G==3){var y=h.U++,E=Rn(h.I);if(tt(E,"SID",h.K),tt(E,"RID",y),tt(E,"TYPE","terminate"),Ja(h,E),y=new pn(h,h.j,y),y.L=2,y.v=$a(Rn(E)),E=!1,m.navigator&&m.navigator.sendBeacon)try{E=m.navigator.sendBeacon(y.v.toString(),"")}catch{}!E&&m.Image&&(new Image().src=y.v,E=!0),E||(y.g=Ru(y.j,null),y.g.ea(y.v)),y.F=Date.now(),za(y)}Iu(h)}function Qr(h){h.g&&(er(h),h.g.cancel(),h.g=null)}function xu(h){Qr(h),h.u&&(m.clearTimeout(h.u),h.u=null),Wr(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&m.clearTimeout(h.s),h.s=null)}function Xr(h){if(!Fr(h.h)&&!h.s){h.s=!0;var y=h.Ga;ne||V(),ce||(ne(),ce=!0),ge.add(y,h),h.B=0}}function mf(h,y){return qr(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=At(N(h.Ga,h,y),Cl(h,h.B)),h.B++,!0)}s.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const $=new pn(this,this.j,h);let Z=this.o;if(this.S&&(Z?(Z=x(Z),R(Z,this.S)):Z=this.S),this.m!==null||this.O||($.H=Z,Z=null),this.P)e:{for(var y=0,E=0;E<this.i.length;E++){t:{var I=this.i[E];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(y+=I,4096<y){y=E;break e}if(y===4096||E===this.i.length-1){y=E+1;break e}}y=1e3}else y=1e3;y=Au(this,$,y),E=Rn(this.I),tt(E,"RID",h),tt(E,"CVER",22),this.D&&tt(E,"X-HTTP-Session-Id",this.D),Ja(this,E),Z&&(this.O?y="headers="+encodeURIComponent(String(xl(Z)))+"&"+y:this.m&&Ft(E,this.m,Z)),zr(this.h,$),this.Ua&&tt(E,"TYPE","init"),this.P?(tt(E,"$req",y),tt(E,"SID","null"),$.T=!0,ls($,E,null)):ls($,E,y),this.G=2}}else this.G==3&&(h?Sl(this,h):this.i.length==0||Fr(this.h)||Sl(this))};function Sl(h,y){var E;y?E=y.l:E=h.U++;const I=Rn(h.I);tt(I,"SID",h.K),tt(I,"RID",E),tt(I,"AID",h.T),Ja(h,I),h.m&&h.o&&Ft(I,h.m,h.o),E=new pn(h,h.j,E,h.B+1),h.m===null&&(E.H=h.o),y&&(h.i=y.D.concat(h.i)),y=Au(h,E,1e3),E.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),zr(h.h,E),ls(E,I,y)}function Ja(h,y){h.H&&ae(h.H,function(E,I){tt(y,I,E)}),h.l&&_l({},function(E,I){tt(y,I,E)})}function Au(h,y,E){E=Math.min(h.i.length,E);var I=h.l?N(h.l.Na,h.l,h):null;e:{var $=h.i;let Z=-1;for(;;){const de=["count="+E];Z==-1?0<E?(Z=$[0].g,de.push("ofs="+Z)):Z=0:de.push("ofs="+Z);let Be=!0;for(let Dt=0;Dt<E;Dt++){let He=$[Dt].g;const qt=$[Dt].map;if(He-=Z,0>He)Z=Math.max(0,$[Dt].g-100),Be=!1;else try{ws(qt,de,"req"+He+"_")}catch{I&&I(qt)}}if(Be){I=de.join("&");break e}}}return h=h.i.splice(0,E),y.D=h,I}function Su(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;ne||V(),ce||(ne(),ce=!0),ge.add(y,h),h.v=0}}function wl(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=At(N(h.Fa,h),Cl(h,h.v)),h.v++,!0)}s.Fa=function(){if(this.u=null,wu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=At(N(this.ab,this),h)}},s.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ut(10),Qr(this),wu(this))};function er(h){h.A!=null&&(m.clearTimeout(h.A),h.A=null)}function wu(h){h.g=new pn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=Rn(h.qa);tt(y,"RID","rpc"),tt(y,"SID",h.K),tt(y,"AID",h.T),tt(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&tt(y,"TO",h.ja),tt(y,"TYPE","xmlhttp"),Ja(h,y),h.m&&h.o&&Ft(y,h.m,h.o),h.L&&(h.g.I=h.L);var E=h.g;h=h.ia,E.L=1,E.v=$a(Rn(y)),E.m=null,E.P=!0,Ws(E,h)}s.Za=function(){this.C!=null&&(this.C=null,Qr(this),wl(this),ut(19))};function Wr(h){h.C!=null&&(m.clearTimeout(h.C),h.C=null)}function Cu(h,y){var E=null;if(h.g==y){Wr(h),er(h),h.g=null;var I=2}else if(vl(h.h,y))E=y.D,gn(h.h,y),I=1;else return;if(h.G!=0){if(y.o)if(I==1){E=y.m?y.m.length:0,y=Date.now()-y.F;var $=h.B;I=ji(),We(I,new Rt(I,E)),Xr(h)}else Su(h);else if($=y.s,$==3||$==0&&0<y.X||!(I==1&&mf(h,y)||I==2&&wl(h)))switch(E&&0<E.length&&(y=h.h,y.i=y.i.concat(E)),$){case 1:ii(h,5);break;case 4:ii(h,10);break;case 3:ii(h,6);break;default:ii(h,2)}}}function Cl(h,y){let E=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(E*=2),E*y}function ii(h,y){if(h.j.info("Error code "+y),y==2){var E=N(h.fb,h),I=h.Xa;const $=!I;I=new St(I||"//www.google.com/images/cleardot.gif"),m.location&&m.location.protocol=="http"||Ga(I,"https"),$a(I),$?Ya(I.toString(),E):cs(I.toString(),E)}else ut(2);h.G=0,h.l&&h.l.sa(y),Iu(h),xu(h)}s.fb=function(h){h?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function Iu(h){if(h.G=0,h.ka=[],h.l){const y=yl(h.h);(y.length!=0||h.i.length!=0)&&(A(h.ka,y),A(h.ka,h.i),h.h.i.length=0,F(h.i),h.i.length=0),h.l.ra()}}function ju(h,y,E){var I=E instanceof St?Rn(E):new St(E);if(I.g!="")y&&(I.g=y+"."+I.g),Pi(I,I.s);else{var $=m.location;I=$.protocol,y=y?y+"."+$.hostname:$.hostname,$=+$.port;var Z=new St(null);I&&Ga(Z,I),y&&(Z.g=y),$&&Pi(Z,$),E&&(Z.l=E),I=Z}return E=h.D,y=h.ya,E&&y&&tt(I,E,y),tt(I,"VER",h.la),Ja(h,I),I}function Ru(h,y,E){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new Xe(new ki({eb:E})):new Xe(h.pa),y.Ha(h.J),y}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Du(){}s=Du.prototype,s.ua=function(){},s.ta=function(){},s.sa=function(){},s.ra=function(){},s.isActive=function(){return!0},s.Na=function(){};function Zr(){}Zr.prototype.g=function(h,y){return new vn(h,y)};function vn(h,y){gt.call(this),this.g=new Yr(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!W(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!W(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new Rs(this)}w(vn,gt),vn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){Al(this.g)},vn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.u&&(E={},E.__data__=os(h),h=E);y.i.push(new _u(y.Ya++,h)),y.G==3&&Xr(y)},vn.prototype.N=function(){this.g.l=null,delete this.j,Al(this.g),delete this.g,vn.aa.N.call(this)};function Ou(h){Qs.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const E in y){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}w(Ou,Qs);function Mu(){fl.call(this),this.status=1}w(Mu,fl);function Rs(h){this.g=h}w(Rs,Du),Rs.prototype.ua=function(){We(this.g,"a")},Rs.prototype.ta=function(h){We(this.g,new Ou(h))},Rs.prototype.sa=function(h){We(this.g,new Mu)},Rs.prototype.ra=function(){We(this.g,"b")},Zr.prototype.createWebChannel=Zr.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,l0=function(){return new Zr},o0=function(){return ji()},r0=Ts,qp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Oi.NO_ERROR=0,Oi.TIMEOUT=8,Oi.HTTP_ERROR=6,Yd=Oi,Xs.COMPLETE="complete",a0=Xs,hl.EventType=Ys,Ys.OPEN="a",Ys.CLOSE="b",Ys.ERROR="c",Ys.MESSAGE="d",gt.prototype.listen=gt.prototype.K,_c=hl,Xe.prototype.listenOnce=Xe.prototype.L,Xe.prototype.getLastError=Xe.prototype.Ka,Xe.prototype.getLastErrorCode=Xe.prototype.Ba,Xe.prototype.getStatus=Xe.prototype.Z,Xe.prototype.getResponseJson=Xe.prototype.Oa,Xe.prototype.getResponseText=Xe.prototype.oa,Xe.prototype.send=Xe.prototype.ea,Xe.prototype.setWithCredentials=Xe.prototype.Ha,i0=Xe}).apply(typeof kd<"u"?kd:typeof self<"u"?self:typeof window<"u"?window:{});const Cb="@firebase/firestore",Ib="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}dn.UNAUTHENTICATED=new dn(null),dn.GOOGLE_CREDENTIALS=new dn("google-credentials-uid"),dn.FIRST_PARTY=new dn("first-party-uid"),dn.MOCK_USER=new dn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jo="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr=new Yc("@firebase/firestore");function jo(){return xr.logLevel}function me(s,...e){if(xr.logLevel<=Ue.DEBUG){const t=e.map(wg);xr.debug(`Firestore (${Jo}): ${s}`,...t)}}function Ai(s,...e){if(xr.logLevel<=Ue.ERROR){const t=e.map(wg);xr.error(`Firestore (${Jo}): ${s}`,...t)}}function Bo(s,...e){if(xr.logLevel<=Ue.WARN){const t=e.map(wg);xr.warn(`Firestore (${Jo}): ${s}`,...t)}}function wg(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(s,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,c0(s,a,t)}function c0(s,e,t){let a=`FIRESTORE (${Jo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw Ai(a),new Error(a)}function Ke(s,e,t,a){let o="Unexpected state";typeof t=="string"?o=t:a=t,s||c0(e,o,a)}function je(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fe extends rs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class OR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(dn.UNAUTHENTICATED))}shutdown(){}}class MR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class PR{constructor(e){this.t=e,this.currentUser=dn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ke(this.o===void 0,42304);let a=this.i;const o=g=>this.i!==a?(a=this.i,t(g)):Promise.resolve();let c=new qs;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new qs,e.enqueueRetryable(()=>o(this.currentUser))};const d=()=>{const g=c;e.enqueueRetryable(async()=>{await g.promise,await o(this.currentUser)})},m=g=>{me("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit(g=>m(g)),setTimeout(()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?m(g):(me("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new qs)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(a=>this.i!==e?(me("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Ke(typeof a.accessToken=="string",31837,{l:a}),new u0(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ke(e===null||typeof e=="string",2055,{h:e}),new dn(e)}}class kR{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=dn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class VR{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new kR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(dn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class jb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class LR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Cn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ke(this.o===void 0,3512);const a=c=>{c.error!=null&&me("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,me("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>a(c))};const o=c=>{me("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>o(c)),setTimeout(()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):me("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new jb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ke(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new jb(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<s;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const o=UR(40);for(let c=0;c<o.length;++c)a.length<20&&o[c]<t&&(a+=e.charAt(o[c]%62))}return a}}function Me(s,e){return s<e?-1:s>e?1:0}function zp(s,e){let t=0;for(;t<s.length&&t<e.length;){const a=s.codePointAt(t),o=e.codePointAt(t);if(a!==o){if(a<128&&o<128)return Me(a,o);{const c=d0(),d=FR(c.encode(Rb(s,t)),c.encode(Rb(e,t)));return d!==0?d:Me(a,o)}}t+=a>65535?2:1}return Me(s.length,e.length)}function Rb(s,e){return s.codePointAt(e)>65535?s.substring(e,e+2):s.substring(e,e+1)}function FR(s,e){for(let t=0;t<s.length&&t<e.length;++t)if(s[t]!==e[t])return Me(s[t],e[t]);return Me(s.length,e.length)}function Ho(s,e,t){return s.length===e.length&&s.every((a,o)=>t(a,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Db=-62135596800,Ob=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*Ob);return new kt(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fe(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fe(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Db)throw new fe(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fe(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ob}_compareTo(e){return this.seconds===e.seconds?Me(this.nanoseconds,e.nanoseconds):Me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Db;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{static fromTimestamp(e){return new Se(e)}static min(){return new Se(new kt(0,0))}static max(){return new Se(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mb="__name__";class Ls{constructor(e,t,a){t===void 0?t=0:t>e.length&&Ne(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&Ne(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return Ls.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ls?e.forEach(a=>{t.push(a)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let o=0;o<a;o++){const c=Ls.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Me(e.length,t.length)}static compareSegments(e,t){const a=Ls.isNumericId(e),o=Ls.isNumericId(t);return a&&!o?-1:!a&&o?1:a&&o?Ls.extractNumericId(e).compare(Ls.extractNumericId(t)):zp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return fa.fromString(e.substring(4,e.length-2))}}class rt extends Ls{construct(e,t,a){return new rt(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new fe(ie.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter(o=>o.length>0))}return new rt(t)}static emptyPath(){return new rt([])}}const qR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tn extends Ls{construct(e,t,a){return new tn(e,t,a)}static isValidIdentifier(e){return qR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Mb}static keyField(){return new tn([Mb])}static fromServerFormat(e){const t=[];let a="",o=0;const c=()=>{if(a.length===0)throw new fe(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let d=!1;for(;o<e.length;){const m=e[o];if(m==="\\"){if(o+1===e.length)throw new fe(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[o+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new fe(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=g,o+=2}else m==="`"?(d=!d,o++):m!=="."||d?(a+=m,o++):(c(),o++)}if(c(),d)throw new fe(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tn(t)}static emptyPath(){return new tn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.path=e}static fromPath(e){return new be(rt.fromString(e))}static fromName(e){return new be(rt.fromString(e).popFirst(5))}static empty(){return new be(rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return rt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new rt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lc=-1;function zR(s,e){const t=s.toTimestamp().seconds,a=s.toTimestamp().nanoseconds+1,o=Se.fromTimestamp(a===1e9?new kt(t+1,0):new kt(t,a));return new ga(o,be.empty(),e)}function BR(s){return new ga(s.readTime,s.key,Lc)}class ga{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new ga(Se.min(),be.empty(),Lc)}static max(){return new ga(Se.max(),be.empty(),Lc)}}function HR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=be.comparator(s.documentKey,e.documentKey),t!==0?t:Me(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $R{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function el(s){if(s.code!==ie.FAILED_PRECONDITION||s.message!==GR)throw s;me("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le((a,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(a,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(a,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):le.reject(t)}static resolve(e){return new le((t,a)=>{t(e)})}static reject(e){return new le((t,a)=>{a(e)})}static waitFor(e){return new le((t,a)=>{let o=0,c=0,d=!1;e.forEach(m=>{++o,m.next(()=>{++c,d&&c===o&&t()},g=>a(g))}),d=!0,c===o&&t()})}static or(e){let t=le.resolve(!1);for(const a of e)t=t.next(o=>o?le.resolve(o):a());return t}static forEach(e,t){const a=[];return e.forEach((o,c)=>{a.push(t.call(this,o,c))}),this.waitFor(a)}static mapArray(e,t){return new le((a,o)=>{const c=e.length,d=new Array(c);let m=0;for(let g=0;g<c;g++){const v=g;t(e[v]).next(_=>{d[v]=_,++m,m===c&&a(d)},_=>o(_))}})}static doWhile(e,t){return new le((a,o)=>{const c=()=>{e()===!0?t().next(()=>{c()},o):a()};c()})}}function KR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function tl(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ue(a),this.ce=a=>t.writeSequenceNumber(a))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Dh.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg=-1;function eu(s){return s==null}function uh(s){return s===0&&1/s==-1/0}function YR(s){return typeof s=="number"&&Number.isInteger(s)&&!uh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f0="";function QR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=Pb(e)),e=XR(s.get(t),e);return Pb(e)}function XR(s,e){let t=e;const a=s.length;for(let o=0;o<a;o++){const c=s.charAt(o);switch(c){case"\0":t+="";break;case f0:t+="";break;default:t+=c}}return t}function Pb(s){return s+f0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kb(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Ia(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function m0(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,t){this.comparator=e,this.root=t||en.EMPTY}insert(e,t){return new pt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,en.BLACK,null,null))}remove(e){return new pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,en.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const o=this.comparator(e,a.key);if(o===0)return t+a.left.size;o<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,a)=>(e(t,a),!1))}toString(){const e=[];return this.inorderTraversal((t,a)=>(e.push(`${t}:${a}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vd(this.root,e,this.comparator,!0)}}class Vd{constructor(e,t,a,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?a(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class en{constructor(e,t,a,o,c){this.key=e,this.value=t,this.color=a??en.RED,this.left=o??en.EMPTY,this.right=c??en.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,o,c){return new en(e??this.key,t??this.value,a??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let o=this;const c=a(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,a),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,a)),o.fixUp()}removeMin(){if(this.left.isEmpty())return en.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return en.EMPTY;a=o.right.min(),o=o.copy(a.key,a.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,en.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,en.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ne(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ne(27949);return e+(this.isRed()?0:1)}}en.EMPTY=null,en.RED=!0,en.BLACK=!1;en.EMPTY=new class{constructor(){this.size=0}get key(){throw Ne(57766)}get value(){throw Ne(16141)}get color(){throw Ne(16727)}get left(){throw Ne(29726)}get right(){throw Ne(36894)}copy(e,t,a,o,c){return this}insert(e,t,a){return new en(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.comparator=e,this.data=new pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,a)=>(e(t),!1))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const o=a.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Vb(this.data.getIterator())}getIteratorFrom(e){return new Vb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(a=>{t=t.add(a)}),t}isEqual(e){if(!(e instanceof Vt)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Vt(this.comparator);return t.data=e,t}}class Vb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.fields=e,e.sort(tn.comparator)}static empty(){return new Un([])}unionWith(e){let t=new Vt(tn.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new Un(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ho(this.fields,e.fields,(t,a)=>t.isEqual(a))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new p0("Invalid base64 string: "+c):c}}(e);return new an(t)}static fromUint8Array(e){const t=function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c}(e);return new an(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const a=new Uint8Array(t.length);for(let o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return a}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}an.EMPTY_BYTE_STRING=new an("");const WR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function va(s){if(Ke(!!s,39018),typeof s=="string"){let e=0;const t=WR.exec(s);if(Ke(!!t,46558,{timestamp:s}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const a=new Date(s);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:Nt(s.seconds),nanos:Nt(s.nanos)}}function Nt(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function ya(s){return typeof s=="string"?an.fromBase64String(s):an.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0="server_timestamp",v0="__type__",y0="__previous_value__",_0="__local_write_time__";function Ig(s){var e,t;return((t=(((e=s?.mapValue)===null||e===void 0?void 0:e.fields)||{})[v0])===null||t===void 0?void 0:t.stringValue)===g0}function Oh(s){const e=s.mapValue.fields[y0];return Ig(e)?Oh(e):e}function Uc(s){const e=va(s.mapValue.fields[_0].timestampValue);return new kt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e,t,a,o,c,d,m,g,v,_){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=m,this.longPollingOptions=g,this.useFetchStreams=v,this.isUsingEmulator=_}}const dh="(default)";class Fc{constructor(e,t){this.projectId=e,this.database=t||dh}static empty(){return new Fc("","")}get isDefaultDatabase(){return this.database===dh}isEqual(e){return e instanceof Fc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0="__type__",JR="__max__",Ld={mapValue:{}},b0="__vector__",hh="value";function _a(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Ig(s)?4:t1(s)?9007199254740991:e1(s)?10:11:Ne(28295,{value:s})}function Bs(s,e){if(s===e)return!0;const t=_a(s);if(t!==_a(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Uc(s).isEqual(Uc(e));case 3:return function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=va(o.timestampValue),m=va(c.timestampValue);return d.seconds===m.seconds&&d.nanos===m.nanos}(s,e);case 5:return s.stringValue===e.stringValue;case 6:return function(o,c){return ya(o.bytesValue).isEqual(ya(c.bytesValue))}(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return function(o,c){return Nt(o.geoPointValue.latitude)===Nt(c.geoPointValue.latitude)&&Nt(o.geoPointValue.longitude)===Nt(c.geoPointValue.longitude)}(s,e);case 2:return function(o,c){if("integerValue"in o&&"integerValue"in c)return Nt(o.integerValue)===Nt(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=Nt(o.doubleValue),m=Nt(c.doubleValue);return d===m?uh(d)===uh(m):isNaN(d)&&isNaN(m)}return!1}(s,e);case 9:return Ho(s.arrayValue.values||[],e.arrayValue.values||[],Bs);case 10:case 11:return function(o,c){const d=o.mapValue.fields||{},m=c.mapValue.fields||{};if(kb(d)!==kb(m))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(m[g]===void 0||!Bs(d[g],m[g])))return!1;return!0}(s,e);default:return Ne(52216,{left:s})}}function qc(s,e){return(s.values||[]).find(t=>Bs(t,e))!==void 0}function Go(s,e){if(s===e)return 0;const t=_a(s),a=_a(e);if(t!==a)return Me(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return Me(s.booleanValue,e.booleanValue);case 2:return function(c,d){const m=Nt(c.integerValue||c.doubleValue),g=Nt(d.integerValue||d.doubleValue);return m<g?-1:m>g?1:m===g?0:isNaN(m)?isNaN(g)?0:-1:1}(s,e);case 3:return Lb(s.timestampValue,e.timestampValue);case 4:return Lb(Uc(s),Uc(e));case 5:return zp(s.stringValue,e.stringValue);case 6:return function(c,d){const m=ya(c),g=ya(d);return m.compareTo(g)}(s.bytesValue,e.bytesValue);case 7:return function(c,d){const m=c.split("/"),g=d.split("/");for(let v=0;v<m.length&&v<g.length;v++){const _=Me(m[v],g[v]);if(_!==0)return _}return Me(m.length,g.length)}(s.referenceValue,e.referenceValue);case 8:return function(c,d){const m=Me(Nt(c.latitude),Nt(d.latitude));return m!==0?m:Me(Nt(c.longitude),Nt(d.longitude))}(s.geoPointValue,e.geoPointValue);case 9:return Ub(s.arrayValue,e.arrayValue);case 10:return function(c,d){var m,g,v,_;const T=c.fields||{},N=d.fields||{},C=(m=T[hh])===null||m===void 0?void 0:m.arrayValue,w=(g=N[hh])===null||g===void 0?void 0:g.arrayValue,F=Me(((v=C?.values)===null||v===void 0?void 0:v.length)||0,((_=w?.values)===null||_===void 0?void 0:_.length)||0);return F!==0?F:Ub(C,w)}(s.mapValue,e.mapValue);case 11:return function(c,d){if(c===Ld.mapValue&&d===Ld.mapValue)return 0;if(c===Ld.mapValue)return 1;if(d===Ld.mapValue)return-1;const m=c.fields||{},g=Object.keys(m),v=d.fields||{},_=Object.keys(v);g.sort(),_.sort();for(let T=0;T<g.length&&T<_.length;++T){const N=zp(g[T],_[T]);if(N!==0)return N;const C=Go(m[g[T]],v[_[T]]);if(C!==0)return C}return Me(g.length,_.length)}(s.mapValue,e.mapValue);default:throw Ne(23264,{Pe:t})}}function Lb(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Me(s,e);const t=va(s),a=va(e),o=Me(t.seconds,a.seconds);return o!==0?o:Me(t.nanos,a.nanos)}function Ub(s,e){const t=s.values||[],a=e.values||[];for(let o=0;o<t.length&&o<a.length;++o){const c=Go(t[o],a[o]);if(c)return c}return Me(t.length,a.length)}function $o(s){return Bp(s)}function Bp(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(t){const a=va(t);return`time(${a.seconds},${a.nanos})`}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?function(t){return ya(t).toBase64()}(s.bytesValue):"referenceValue"in s?function(t){return be.fromName(t).toString()}(s.referenceValue):"geoPointValue"in s?function(t){return`geo(${t.latitude},${t.longitude})`}(s.geoPointValue):"arrayValue"in s?function(t){let a="[",o=!0;for(const c of t.values||[])o?o=!1:a+=",",a+=Bp(c);return a+"]"}(s.arrayValue):"mapValue"in s?function(t){const a=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of a)c?c=!1:o+=",",o+=`${d}:${Bp(t.fields[d])}`;return o+"}"}(s.mapValue):Ne(61005,{value:s})}function Qd(s){switch(_a(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Oh(s);return e?16+Qd(e):16;case 5:return 2*s.stringValue.length;case 6:return ya(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return function(a){return(a.values||[]).reduce((o,c)=>o+Qd(c),0)}(s.arrayValue);case 10:case 11:return function(a){let o=0;return Ia(a.fields,(c,d)=>{o+=c.length+Qd(d)}),o}(s.mapValue);default:throw Ne(13486,{value:s})}}function Fb(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Hp(s){return!!s&&"integerValue"in s}function jg(s){return!!s&&"arrayValue"in s}function qb(s){return!!s&&"nullValue"in s}function zb(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Xd(s){return!!s&&"mapValue"in s}function e1(s){var e,t;return((t=(((e=s?.mapValue)===null||e===void 0?void 0:e.fields)||{})[E0])===null||t===void 0?void 0:t.stringValue)===b0}function Ac(s){if(s.geoPointValue)return{geoPointValue:Object.assign({},s.geoPointValue)};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:Object.assign({},s.timestampValue)};if(s.mapValue){const e={mapValue:{fields:{}}};return Ia(s.mapValue.fields,(t,a)=>e.mapValue.fields[t]=Ac(a)),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ac(s.arrayValue.values[t]);return e}return Object.assign({},s)}function t1(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===JR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.value=e}static empty(){return new bn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!Xd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ac(t)}setAll(e){let t=tn.emptyPath(),a={},o=[];e.forEach((d,m)=>{if(!t.isImmediateParentOf(m)){const g=this.getFieldsMap(t);this.applyChanges(g,a,o),a={},o=[],t=m.popLast()}d?a[m.lastSegment()]=Ac(d):o.push(m.lastSegment())});const c=this.getFieldsMap(t);this.applyChanges(c,a,o)}delete(e){const t=this.field(e.popLast());Xd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Bs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let o=t.mapValue.fields[e.get(a)];Xd(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,a){Ia(t,(o,c)=>e[o]=c);for(const o of a)delete e[o]}clone(){return new bn(Ac(this.value))}}function T0(s){const e=[];return Ia(s.fields,(t,a)=>{const o=new tn([t]);if(Xd(a)){const c=T0(a.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)}),new Un(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,t,a,o,c,d,m){this.key=e,this.documentType=t,this.version=a,this.readTime=o,this.createTime=c,this.data=d,this.documentState=m}static newInvalidDocument(e){return new $t(e,0,Se.min(),Se.min(),Se.min(),bn.empty(),0)}static newFoundDocument(e,t,a,o){return new $t(e,1,t,Se.min(),a,o,0)}static newNoDocument(e,t){return new $t(e,2,t,Se.min(),Se.min(),bn.empty(),0)}static newUnknownDocument(e,t){return new $t(e,3,t,Se.min(),Se.min(),bn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=bn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=bn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof $t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,t){this.position=e,this.inclusive=t}}function Bb(s,e,t){let a=0;for(let o=0;o<s.position.length;o++){const c=e[o],d=s.position[o];if(c.field.isKeyField()?a=be.comparator(be.fromName(d.referenceValue),t.key):a=Go(d,t.data.field(c.field)),c.dir==="desc"&&(a*=-1),a!==0)break}return a}function Hb(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Bs(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(e,t="asc"){this.field=e,this.dir=t}}function n1(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{}class jt extends N0{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new i1(e,t,a):t==="array-contains"?new o1(e,a):t==="in"?new l1(e,a):t==="not-in"?new c1(e,a):t==="array-contains-any"?new u1(e,a):new jt(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new a1(e,a):new r1(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Go(t,this.value)):t!==null&&_a(this.value)===_a(t)&&this.matchesComparison(Go(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Es extends N0{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Es(e,t)}matches(e){return x0(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function x0(s){return s.op==="and"}function A0(s){return s1(s)&&x0(s)}function s1(s){for(const e of s.filters)if(e instanceof Es)return!1;return!0}function Gp(s){if(s instanceof jt)return s.field.canonicalString()+s.op.toString()+$o(s.value);if(A0(s))return s.filters.map(e=>Gp(e)).join(",");{const e=s.filters.map(t=>Gp(t)).join(",");return`${s.op}(${e})`}}function S0(s,e){return s instanceof jt?function(a,o){return o instanceof jt&&a.op===o.op&&a.field.isEqual(o.field)&&Bs(a.value,o.value)}(s,e):s instanceof Es?function(a,o){return o instanceof Es&&a.op===o.op&&a.filters.length===o.filters.length?a.filters.reduce((c,d,m)=>c&&S0(d,o.filters[m]),!0):!1}(s,e):void Ne(19439)}function w0(s){return s instanceof jt?function(t){return`${t.field.canonicalString()} ${t.op} ${$o(t.value)}`}(s):s instanceof Es?function(t){return t.op.toString()+" {"+t.getFilters().map(w0).join(" ,")+"}"}(s):"Filter"}class i1 extends jt{constructor(e,t,a){super(e,t,a),this.key=be.fromName(a.referenceValue)}matches(e){const t=be.comparator(e.key,this.key);return this.matchesComparison(t)}}class a1 extends jt{constructor(e,t){super(e,"in",t),this.keys=C0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class r1 extends jt{constructor(e,t){super(e,"not-in",t),this.keys=C0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function C0(s,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(a=>be.fromName(a.referenceValue))}class o1 extends jt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return jg(t)&&qc(t.arrayValue,this.value)}}class l1 extends jt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&qc(this.value.arrayValue,t)}}class c1 extends jt{constructor(e,t){super(e,"not-in",t)}matches(e){if(qc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!qc(this.value.arrayValue,t)}}class u1 extends jt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!jg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(a=>qc(this.value.arrayValue,a))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e,t=null,a=[],o=[],c=null,d=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=o,this.limit=c,this.startAt=d,this.endAt=m,this.Ie=null}}function Gb(s,e=null,t=[],a=[],o=null,c=null,d=null){return new d1(s,e,t,a,o,c,d)}function Rg(s){const e=je(s);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(a=>Gp(a)).join(","),t+="|ob:",t+=e.orderBy.map(a=>function(c){return c.field.canonicalString()+c.dir}(a)).join(","),eu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(a=>$o(a)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(a=>$o(a)).join(",")),e.Ie=t}return e.Ie}function Dg(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!n1(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!S0(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Hb(s.startAt,e.startAt)&&Hb(s.endAt,e.endAt)}function $p(s){return be.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,t=null,a=[],o=[],c=null,d="F",m=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=o,this.limit=c,this.limitType=d,this.startAt=m,this.endAt=g,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function h1(s,e,t,a,o,c,d,m){return new nl(s,e,t,a,o,c,d,m)}function Mh(s){return new nl(s)}function $b(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function I0(s){return s.collectionGroup!==null}function Sc(s){const e=je(s);if(e.Ee===null){e.Ee=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ee.push(c),t.add(c.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let m=new Vt(tn.comparator);return d.filters.forEach(g=>{g.getFlattenedFilters().forEach(v=>{v.isInequality()&&(m=m.add(v.field))})}),m})(e).forEach(c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ee.push(new zc(c,a))}),t.has(tn.keyField().canonicalString())||e.Ee.push(new zc(tn.keyField(),a))}return e.Ee}function zs(s){const e=je(s);return e.de||(e.de=f1(e,Sc(s))),e.de}function f1(s,e){if(s.limitType==="F")return Gb(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map(o=>{const c=o.dir==="desc"?"asc":"desc";return new zc(o.field,c)});const t=s.endAt?new fh(s.endAt.position,s.endAt.inclusive):null,a=s.startAt?new fh(s.startAt.position,s.startAt.inclusive):null;return Gb(s.path,s.collectionGroup,e,s.filters,s.limit,t,a)}}function Kp(s,e){const t=s.filters.concat([e]);return new nl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function Yp(s,e,t){return new nl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function Ph(s,e){return Dg(zs(s),zs(e))&&s.limitType===e.limitType}function j0(s){return`${Rg(zs(s))}|lt:${s.limitType}`}function Ro(s){return`Query(target=${function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map(o=>w0(o)).join(", ")}]`),eu(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map(o=>function(d){return`${d.field.canonicalString()} (${d.dir})`}(o)).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map(o=>$o(o)).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map(o=>$o(o)).join(",")),`Target(${a})`}(zs(s))}; limitType=${s.limitType})`}function kh(s,e){return e.isFoundDocument()&&function(a,o){const c=o.key.path;return a.collectionGroup!==null?o.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):be.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)}(s,e)&&function(a,o){for(const c of Sc(a))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0}(s,e)&&function(a,o){for(const c of a.filters)if(!c.matches(o))return!1;return!0}(s,e)&&function(a,o){return!(a.startAt&&!function(d,m,g){const v=Bb(d,m,g);return d.inclusive?v<=0:v<0}(a.startAt,Sc(a),o)||a.endAt&&!function(d,m,g){const v=Bb(d,m,g);return d.inclusive?v>=0:v>0}(a.endAt,Sc(a),o))}(s,e)}function m1(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function R0(s){return(e,t)=>{let a=!1;for(const o of Sc(s)){const c=p1(o,e,t);if(c!==0)return c;a=a||o.field.isKeyField()}return 0}}function p1(s,e,t){const a=s.field.isKeyField()?be.comparator(e.key,t.key):function(c,d,m){const g=d.data.field(c),v=m.data.field(c);return g!==null&&v!==null?Go(g,v):Ne(42886)}(s.field,e,t);switch(s.dir){case"asc":return a;case"desc":return-1*a;default:return Ne(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[o,c]of a)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),o=this.inner[a];if(o===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return a.length===1?delete this.inner[t]:a.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Ia(this.inner,(t,a)=>{for(const[o,c]of a)e(o,c)})}isEmpty(){return m0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1=new pt(be.comparator);function Si(){return g1}const D0=new pt(be.comparator);function Ec(...s){let e=D0;for(const t of s)e=e.insert(t.key,t);return e}function O0(s){let e=D0;return s.forEach((t,a)=>e=e.insert(t,a.overlayedDocument)),e}function _r(){return wc()}function M0(){return wc()}function wc(){return new Dr(s=>s.toString(),(s,e)=>s.isEqual(e))}const v1=new pt(be.comparator),y1=new Vt(be.comparator);function ze(...s){let e=y1;for(const t of s)e=e.add(t);return e}const _1=new Vt(Me);function E1(){return _1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Og(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:uh(e)?"-0":e}}function P0(s){return{integerValue:""+s}}function b1(s,e){return YR(e)?P0(e):Og(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(){this._=void 0}}function T1(s,e,t){return s instanceof Bc?function(o,c){const d={fields:{[v0]:{stringValue:g0},[_0]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Ig(c)&&(c=Oh(c)),c&&(d.fields[y0]=c),{mapValue:d}}(t,e):s instanceof Hc?V0(s,e):s instanceof Gc?L0(s,e):function(o,c){const d=k0(o,c),m=Kb(d)+Kb(o.Re);return Hp(d)&&Hp(o.Re)?P0(m):Og(o.serializer,m)}(s,e)}function N1(s,e,t){return s instanceof Hc?V0(s,e):s instanceof Gc?L0(s,e):t}function k0(s,e){return s instanceof mh?function(a){return Hp(a)||function(c){return!!c&&"doubleValue"in c}(a)}(e)?e:{integerValue:0}:null}class Bc extends Vh{}class Hc extends Vh{constructor(e){super(),this.elements=e}}function V0(s,e){const t=U0(e);for(const a of s.elements)t.some(o=>Bs(o,a))||t.push(a);return{arrayValue:{values:t}}}class Gc extends Vh{constructor(e){super(),this.elements=e}}function L0(s,e){let t=U0(e);for(const a of s.elements)t=t.filter(o=>!Bs(o,a));return{arrayValue:{values:t}}}class mh extends Vh{constructor(e,t){super(),this.serializer=e,this.Re=t}}function Kb(s){return Nt(s.integerValue||s.doubleValue)}function U0(s){return jg(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e,t){this.field=e,this.transform=t}}function A1(s,e){return s.field.isEqual(e.field)&&function(a,o){return a instanceof Hc&&o instanceof Hc||a instanceof Gc&&o instanceof Gc?Ho(a.elements,o.elements,Bs):a instanceof mh&&o instanceof mh?Bs(a.Re,o.Re):a instanceof Bc&&o instanceof Bc}(s.transform,e.transform)}class S1{constructor(e,t){this.version=e,this.transformResults=t}}class nn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new nn}static exists(e){return new nn(void 0,e)}static updateTime(e){return new nn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wd(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Lh{}function F0(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new Uh(s.key,nn.none()):new tu(s.key,s.data,nn.none());{const t=s.data,a=bn.empty();let o=new Vt(tn.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?a.delete(c):a.set(c,d),o=o.add(c)}return new ja(s.key,a,new Un(o.toArray()),nn.none())}}function w1(s,e,t){s instanceof tu?function(o,c,d){const m=o.value.clone(),g=Qb(o.fieldTransforms,c,d.transformResults);m.setAll(g),c.convertToFoundDocument(d.version,m).setHasCommittedMutations()}(s,e,t):s instanceof ja?function(o,c,d){if(!Wd(o.precondition,c))return void c.convertToUnknownDocument(d.version);const m=Qb(o.fieldTransforms,c,d.transformResults),g=c.data;g.setAll(q0(o)),g.setAll(m),c.convertToFoundDocument(d.version,g).setHasCommittedMutations()}(s,e,t):function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()}(0,e,t)}function Cc(s,e,t,a){return s instanceof tu?function(c,d,m,g){if(!Wd(c.precondition,d))return m;const v=c.value.clone(),_=Xb(c.fieldTransforms,g,d);return v.setAll(_),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null}(s,e,t,a):s instanceof ja?function(c,d,m,g){if(!Wd(c.precondition,d))return m;const v=Xb(c.fieldTransforms,g,d),_=d.data;return _.setAll(q0(c)),_.setAll(v),d.convertToFoundDocument(d.version,_).setHasLocalMutations(),m===null?null:m.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(T=>T.field))}(s,e,t,a):function(c,d,m){return Wd(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):m}(s,e,t)}function C1(s,e){let t=null;for(const a of s.fieldTransforms){const o=e.data.field(a.field),c=k0(a.transform,o||null);c!=null&&(t===null&&(t=bn.empty()),t.set(a.field,c))}return t||null}function Yb(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!function(a,o){return a===void 0&&o===void 0||!(!a||!o)&&Ho(a,o,(c,d)=>A1(c,d))}(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class tu extends Lh{constructor(e,t,a,o=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class ja extends Lh{constructor(e,t,a,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function q0(s){const e=new Map;return s.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const a=s.data.field(t);e.set(t,a)}}),e}function Qb(s,e,t){const a=new Map;Ke(s.length===t.length,32656,{Ve:t.length,me:s.length});for(let o=0;o<t.length;o++){const c=s[o],d=c.transform,m=e.data.field(c.field);a.set(c.field,N1(d,m,t[o]))}return a}function Xb(s,e,t){const a=new Map;for(const o of s){const c=o.transform,d=t.data.field(o.field);a.set(o.field,T1(c,d,e))}return a}class Uh extends Lh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class z0 extends Lh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(e,t,a,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=o}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&w1(c,e,a[o])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=Cc(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=Cc(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=M0();return this.mutations.forEach(o=>{const c=e.get(o.key),d=c.overlayedDocument;let m=this.applyToLocalView(d,c.mutatedFields);m=t.has(o.key)?null:m;const g=F0(d,m);g!==null&&a.set(o.key,g),d.isValidDocument()||d.convertToNoDocument(Se.min())}),a}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ze())}isEqual(e){return this.batchId===e.batchId&&Ho(this.mutations,e.mutations,(t,a)=>Yb(t,a))&&Ho(this.baseMutations,e.baseMutations,(t,a)=>Yb(t,a))}}class Mg{constructor(e,t,a,o){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=o}static from(e,t,a){Ke(e.mutations.length===a.length,58842,{fe:e.mutations.length,ge:a.length});let o=function(){return v1}();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,a[d].version);return new Mg(e,t,a,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It,$e;function B0(s){switch(s){case ie.OK:return Ne(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return Ne(15467,{code:s})}}function H0(s){if(s===void 0)return Ai("GRPC error has no .code"),ie.UNKNOWN;switch(s){case It.OK:return ie.OK;case It.CANCELLED:return ie.CANCELLED;case It.UNKNOWN:return ie.UNKNOWN;case It.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case It.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case It.INTERNAL:return ie.INTERNAL;case It.UNAVAILABLE:return ie.UNAVAILABLE;case It.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case It.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case It.NOT_FOUND:return ie.NOT_FOUND;case It.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case It.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case It.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case It.ABORTED:return ie.ABORTED;case It.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case It.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case It.DATA_LOSS:return ie.DATA_LOSS;default:return Ne(39323,{code:s})}}($e=It||(It={}))[$e.OK=0]="OK",$e[$e.CANCELLED=1]="CANCELLED",$e[$e.UNKNOWN=2]="UNKNOWN",$e[$e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$e[$e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$e[$e.NOT_FOUND=5]="NOT_FOUND",$e[$e.ALREADY_EXISTS=6]="ALREADY_EXISTS",$e[$e.PERMISSION_DENIED=7]="PERMISSION_DENIED",$e[$e.UNAUTHENTICATED=16]="UNAUTHENTICATED",$e[$e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$e[$e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$e[$e.ABORTED=10]="ABORTED",$e[$e.OUT_OF_RANGE=11]="OUT_OF_RANGE",$e[$e.UNIMPLEMENTED=12]="UNIMPLEMENTED",$e[$e.INTERNAL=13]="INTERNAL",$e[$e.UNAVAILABLE=14]="UNAVAILABLE",$e[$e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1=new fa([4294967295,4294967295],0);function Wb(s){const e=d0().encode(s),t=new s0;return t.update(e),new Uint8Array(t.digest())}function Zb(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new fa([t,a],0),new fa([o,c],0)]}class Pg{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new bc(`Invalid padding: ${t}`);if(a<0)throw new bc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new bc(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new bc(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=fa.fromNumber(this.pe)}we(e,t,a){let o=e.add(t.multiply(fa.fromNumber(a)));return o.compare(D1)===1&&(o=new fa([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=Wb(e),[a,o]=Zb(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);if(!this.be(d))return!1}return!0}static create(e,t,a){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new Pg(c,o,t);return a.forEach(m=>d.insert(m)),d}insert(e){if(this.pe===0)return;const t=Wb(e),[a,o]=Zb(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);this.Se(d)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class bc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,t,a,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const o=new Map;return o.set(e,nu.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new Fh(Se.min(),o,new pt(Me),Si(),ze())}}class nu{constructor(e,t,a,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new nu(a,t,ze(),ze(),ze())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e,t,a,o){this.De=e,this.removedTargetIds=t,this.key=a,this.ve=o}}class G0{constructor(e,t){this.targetId=e,this.Ce=t}}class $0{constructor(e,t,a=an.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=o}}class Jb{constructor(){this.Fe=0,this.Me=eT(),this.xe=an.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=ze(),t=ze(),a=ze();return this.Me.forEach((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:a=a.add(o);break;default:Ne(38017,{changeType:c})}}),new nu(this.xe,this.Oe,e,t,a)}Qe(){this.Ne=!1,this.Me=eT()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Ke(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class O1{constructor(e){this.ze=e,this.je=new Map,this.He=Si(),this.Je=Ud(),this.Ye=Ud(),this.Ze=new pt(Me)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const a=this.rt(t);switch(e.state){case 0:this.it(t)&&a.ke(e.resumeToken);break;case 1:a.We(),a.Be||a.Qe(),a.ke(e.resumeToken);break;case 2:a.We(),a.Be||this.removeTarget(t);break;case 3:this.it(t)&&(a.Ge(),a.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),a.ke(e.resumeToken));break;default:Ne(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((a,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,a=e.Ce.count,o=this._t(t);if(o){const c=o.target;if($p(c))if(a===0){const d=new be(c.path);this.tt(t,d,$t.newNoDocument(d,Se.min()))}else Ke(a===1,20013,{expectedCount:a});else{const d=this.ut(t);if(d!==a){const m=this.ct(e),g=m?this.lt(m,e,d):1;if(g!==0){this.st(t);const v=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,v)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:o=0},hashCount:c=0}=t;let d,m;try{d=ya(a).toUint8Array()}catch(g){if(g instanceof p0)return Bo("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{m=new Pg(d,o,c)}catch(g){return Bo(g instanceof bc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return m.pe===0?null:m}lt(e,t,a){return t.Ce.count===a-this.Tt(e,t.targetId)?0:2}Tt(e,t){const a=this.ze.getRemoteKeysForTarget(t);let o=0;return a.forEach(c=>{const d=this.ze.Pt(),m=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(m)||(this.tt(t,c,null),o++)}),o}It(e){const t=new Map;this.je.forEach((c,d)=>{const m=this._t(d);if(m){if(c.current&&$p(m.target)){const g=new be(m.target.path);this.Et(g).has(d)||this.dt(d,g)||this.tt(d,g,$t.newNoDocument(g,e))}c.Le&&(t.set(d,c.qe()),c.Qe())}});let a=ze();this.Ye.forEach((c,d)=>{let m=!0;d.forEachWhile(g=>{const v=this._t(g);return!v||v.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)}),m&&(a=a.add(c))}),this.He.forEach((c,d)=>d.setReadTime(e));const o=new Fh(e,t,this.Ze,this.He,a);return this.He=Si(),this.Je=Ud(),this.Ye=Ud(),this.Ze=new pt(Me),o}et(e,t){if(!this.it(e))return;const a=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,a),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,a){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),a&&(this.He=this.He.insert(t,a))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new Jb,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Vt(Me),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Vt(Me),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||me("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new Jb),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Ud(){return new pt(be.comparator)}function eT(){return new pt(be.comparator)}const M1={asc:"ASCENDING",desc:"DESCENDING"},P1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},k1={and:"AND",or:"OR"};class V1{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Qp(s,e){return s.useProto3Json||eu(e)?e:{value:e}}function ph(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function K0(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function L1(s,e){return ph(s,e.toTimestamp())}function qn(s){return Ke(!!s,49232),Se.fromTimestamp(function(t){const a=va(t);return new kt(a.seconds,a.nanos)}(s))}function kg(s,e){return Xp(s,e).canonicalString()}function Xp(s,e){const t=function(o){return new rt(["projects",o.projectId,"databases",o.database])}(s).child("documents");return e===void 0?t:t.child(e)}function Y0(s){const e=rt.fromString(s);return Ke(ex(e),10190,{key:e.toString()}),e}function gh(s,e){return kg(s.databaseId,e.path)}function Ic(s,e){const t=Y0(e);if(t.get(1)!==s.databaseId.projectId)throw new fe(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new fe(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new be(X0(t))}function Q0(s,e){return kg(s.databaseId,e)}function U1(s){const e=Y0(s);return e.length===4?rt.emptyPath():X0(e)}function Wp(s){return new rt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function X0(s){return Ke(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function tT(s,e,t){return{name:gh(s,e),fields:t.value.mapValue.fields}}function F1(s,e){return"found"in e?function(a,o){Ke(!!o.found,43571),o.found.name,o.found.updateTime;const c=Ic(a,o.found.name),d=qn(o.found.updateTime),m=o.found.createTime?qn(o.found.createTime):Se.min(),g=new bn({mapValue:{fields:o.found.fields}});return $t.newFoundDocument(c,d,m,g)}(s,e):"missing"in e?function(a,o){Ke(!!o.missing,3894),Ke(!!o.readTime,22933);const c=Ic(a,o.missing),d=qn(o.readTime);return $t.newNoDocument(c,d)}(s,e):Ne(7234,{result:e})}function q1(s,e){let t;if("targetChange"in e){e.targetChange;const a=function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:Ne(39313,{state:v})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=function(v,_){return v.useProto3Json?(Ke(_===void 0||typeof _=="string",58123),an.fromBase64String(_||"")):(Ke(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),an.fromUint8Array(_||new Uint8Array))}(s,e.targetChange.resumeToken),d=e.targetChange.cause,m=d&&function(v){const _=v.code===void 0?ie.UNKNOWN:H0(v.code);return new fe(_,v.message||"")}(d);t=new $0(a,o,c,m||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const o=Ic(s,a.document.name),c=qn(a.document.updateTime),d=a.document.createTime?qn(a.document.createTime):Se.min(),m=new bn({mapValue:{fields:a.document.fields}}),g=$t.newFoundDocument(o,c,d,m),v=a.targetIds||[],_=a.removedTargetIds||[];t=new Zd(v,_,g.key,g)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const o=Ic(s,a.document),c=a.readTime?qn(a.readTime):Se.min(),d=$t.newNoDocument(o,c),m=a.removedTargetIds||[];t=new Zd([],m,d.key,d)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const o=Ic(s,a.document),c=a.removedTargetIds||[];t=new Zd([],c,o,null)}else{if(!("filter"in e))return Ne(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:o=0,unchangedNames:c}=a,d=new R1(o,c),m=a.targetId;t=new G0(m,d)}}return t}function W0(s,e){let t;if(e instanceof tu)t={update:tT(s,e.key,e.value)};else if(e instanceof Uh)t={delete:gh(s,e.key)};else if(e instanceof ja)t={update:tT(s,e.key,e.data),updateMask:X1(e.fieldMask)};else{if(!(e instanceof z0))return Ne(16599,{ft:e.type});t={verify:gh(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(a=>function(c,d){const m=d.transform;if(m instanceof Bc)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Hc)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Gc)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof mh)return{fieldPath:d.field.canonicalString(),increment:m.Re};throw Ne(20930,{transform:d.transform})}(0,a))),e.precondition.isNone||(t.currentDocument=function(o,c){return c.updateTime!==void 0?{updateTime:L1(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:Ne(27497)}(s,e.precondition)),t}function z1(s,e){return s&&s.length>0?(Ke(e!==void 0,14353),s.map(t=>function(o,c){let d=o.updateTime?qn(o.updateTime):qn(c);return d.isEqual(Se.min())&&(d=qn(c)),new S1(d,o.transformResults||[])}(t,e))):[]}function B1(s,e){return{documents:[Q0(s,e.path)]}}function H1(s,e){const t={structuredQuery:{}},a=e.path;let o;e.collectionGroup!==null?(o=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=Q0(s,o);const c=function(v){if(v.length!==0)return J0(Es.create(v,"and"))}(e.filters);c&&(t.structuredQuery.where=c);const d=function(v){if(v.length!==0)return v.map(_=>function(N){return{field:Do(N.field),direction:K1(N.dir)}}(_))}(e.orderBy);d&&(t.structuredQuery.orderBy=d);const m=Qp(s,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=function(v){return{before:v.inclusive,values:v.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(v){return{before:!v.inclusive,values:v.position}}(e.endAt)),{gt:t,parent:o}}function G1(s){let e=U1(s.parent);const t=s.structuredQuery,a=t.from?t.from.length:0;let o=null;if(a>0){Ke(a===1,65062);const _=t.from[0];_.allDescendants?o=_.collectionId:e=e.child(_.collectionId)}let c=[];t.where&&(c=function(T){const N=Z0(T);return N instanceof Es&&A0(N)?N.getFilters():[N]}(t.where));let d=[];t.orderBy&&(d=function(T){return T.map(N=>function(w){return new zc(Oo(w.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(N))}(t.orderBy));let m=null;t.limit&&(m=function(T){let N;return N=typeof T=="object"?T.value:T,eu(N)?null:N}(t.limit));let g=null;t.startAt&&(g=function(T){const N=!!T.before,C=T.values||[];return new fh(C,N)}(t.startAt));let v=null;return t.endAt&&(v=function(T){const N=!T.before,C=T.values||[];return new fh(C,N)}(t.endAt)),h1(e,o,d,c,m,"F",g,v)}function $1(s,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ne(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Z0(s){return s.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=Oo(t.unaryFilter.field);return jt.create(a,"==",{doubleValue:NaN});case"IS_NULL":const o=Oo(t.unaryFilter.field);return jt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Oo(t.unaryFilter.field);return jt.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Oo(t.unaryFilter.field);return jt.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ne(61313);default:return Ne(60726)}}(s):s.fieldFilter!==void 0?function(t){return jt.create(Oo(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ne(58110);default:return Ne(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(s):s.compositeFilter!==void 0?function(t){return Es.create(t.compositeFilter.filters.map(a=>Z0(a)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ne(1026)}}(t.compositeFilter.op))}(s):Ne(30097,{filter:s})}function K1(s){return M1[s]}function Y1(s){return P1[s]}function Q1(s){return k1[s]}function Do(s){return{fieldPath:s.canonicalString()}}function Oo(s){return tn.fromServerFormat(s.fieldPath)}function J0(s){return s instanceof jt?function(t){if(t.op==="=="){if(zb(t.value))return{unaryFilter:{field:Do(t.field),op:"IS_NAN"}};if(qb(t.value))return{unaryFilter:{field:Do(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(zb(t.value))return{unaryFilter:{field:Do(t.field),op:"IS_NOT_NAN"}};if(qb(t.value))return{unaryFilter:{field:Do(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Do(t.field),op:Y1(t.op),value:t.value}}}(s):s instanceof Es?function(t){const a=t.getFilters().map(o=>J0(o));return a.length===1?a[0]:{compositeFilter:{op:Q1(t.op),filters:a}}}(s):Ne(54877,{filter:s})}function X1(s){const e=[];return s.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function ex(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e,t,a,o,c=Se.min(),d=Se.min(),m=an.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=m,this.expectedCount=g}withSequenceNumber(e){return new ua(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ua(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ua(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ua(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(e){this.wt=e}}function Z1(s){const e=G1({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Yp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(){this.Cn=new eD}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(ga.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(ga.min())}updateCollectionGroup(e,t,a){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class eD{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t]||new Vt(rt.comparator),c=!o.has(a);return this.index[t]=o.add(a),c}has(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t];return o&&o.has(a)}getEntries(e){return(this.index[e]||new Vt(rt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},tx=41943040;class wn{static withCacheSize(e){return new wn(e,wn.DEFAULT_COLLECTION_PERCENTILE,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wn.DEFAULT_COLLECTION_PERCENTILE=10,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wn.DEFAULT=new wn(tx,wn.DEFAULT_COLLECTION_PERCENTILE,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wn.DISABLED=new wn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Ko(0)}static lr(){return new Ko(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT="LruGarbageCollector",tD=1048576;function iT([s,e],[t,a]){const o=Me(s,t);return o===0?Me(e,a):o}class nD{constructor(e){this.Er=e,this.buffer=new Vt(iT),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();iT(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class sD{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){me(sT,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){tl(t)?me(sT,"Ignoring IndexedDB error during garbage collection: ",t):await el(t)}await this.mr(3e5)})}}class iD{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(a=>Math.floor(t/100*a))}nthSequenceNumber(e,t){if(t===0)return le.resolve(Dh.le);const a=new nD(t);return this.gr.forEachTarget(e,o=>a.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>a.Rr(o))).next(()=>a.maxValue)}removeTargets(e,t,a){return this.gr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(me("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(nT)):this.getCacheSize(e).next(a=>a<this.params.cacheSizeCollectionThreshold?(me("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),nT):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let a,o,c,d,m,g,v;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(T=>(T>this.params.maximumSequenceNumbersToCollect?(me("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),o=this.params.maximumSequenceNumbersToCollect):o=T,d=Date.now(),this.nthSequenceNumber(e,o))).next(T=>(a=T,m=Date.now(),this.removeTargets(e,a,t))).next(T=>(c=T,g=Date.now(),this.removeOrphanedDocuments(e,a))).next(T=>(v=Date.now(),jo()<=Ue.DEBUG&&me("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-_}ms
	Determined least recently used ${o} in `+(m-d)+`ms
	Removed ${c} targets in `+(g-m)+`ms
	Removed ${T} documents in `+(v-g)+`ms
Total Duration: ${v-_}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:T})))}}function aD(s,e){return new iD(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(){this.changes=new Dr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$t.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?le.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e,t,a,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=o}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(a=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(a!==null&&Cc(a.mutation,o,Un.empty(),kt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.getLocalViewOfDocuments(e,a,ze()).next(()=>a))}getLocalViewOfDocuments(e,t,a=ze()){const o=_r();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,a).next(c=>{let d=Ec();return c.forEach((m,g)=>{d=d.insert(m,g.overlayedDocument)}),d}))}getOverlayedDocuments(e,t){const a=_r();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,ze()))}populateOverlays(e,t,a){const o=[];return a.forEach(c=>{t.has(c)||o.push(c)}),this.documentOverlayCache.getOverlays(e,o).next(c=>{c.forEach((d,m)=>{t.set(d,m)})})}computeViews(e,t,a,o){let c=Si();const d=wc(),m=function(){return wc()}();return t.forEach((g,v)=>{const _=a.get(v.key);o.has(v.key)&&(_===void 0||_.mutation instanceof ja)?c=c.insert(v.key,v):_!==void 0?(d.set(v.key,_.mutation.getFieldMask()),Cc(_.mutation,v,_.mutation.getFieldMask(),kt.now())):d.set(v.key,Un.empty())}),this.recalculateAndSaveOverlays(e,c).next(g=>(g.forEach((v,_)=>d.set(v,_)),t.forEach((v,_)=>{var T;return m.set(v,new oD(_,(T=d.get(v))!==null&&T!==void 0?T:null))}),m))}recalculateAndSaveOverlays(e,t){const a=wc();let o=new pt((d,m)=>d-m),c=ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(d=>{for(const m of d)m.keys().forEach(g=>{const v=t.get(g);if(v===null)return;let _=a.get(g)||Un.empty();_=m.applyToLocalView(v,_),a.set(g,_);const T=(o.get(m.batchId)||ze()).add(g);o=o.insert(m.batchId,T)})}).next(()=>{const d=[],m=o.getReverseIterator();for(;m.hasNext();){const g=m.getNext(),v=g.key,_=g.value,T=M0();_.forEach(N=>{if(!c.has(N)){const C=F0(t.get(N),a.get(N));C!==null&&T.set(N,C),c=c.add(N)}}),d.push(this.documentOverlayCache.saveOverlays(e,v,T))}return le.waitFor(d)}).next(()=>a)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.recalculateAndSaveOverlays(e,a))}getDocumentsMatchingQuery(e,t,a,o){return function(d){return be.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):I0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,o):this.getDocumentsMatchingCollectionQuery(e,t,a,o)}getNextDocuments(e,t,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,o).next(c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,o-c.size):le.resolve(_r());let m=Lc,g=c;return d.next(v=>le.forEach(v,(_,T)=>(m<T.largestBatchId&&(m=T.largestBatchId),c.get(_)?le.resolve():this.remoteDocumentCache.getEntry(e,_).next(N=>{g=g.insert(_,N)}))).next(()=>this.populateOverlays(e,v,c)).next(()=>this.computeViews(e,g,v,ze())).next(_=>({batchId:m,changes:O0(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new be(t)).next(a=>{let o=Ec();return a.isFoundDocument()&&(o=o.insert(a.key,a)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,a,o){const c=t.collectionGroup;let d=Ec();return this.indexManager.getCollectionParents(e,c).next(m=>le.forEach(m,g=>{const v=function(T,N){return new nl(N,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)}(t,g.child(c));return this.getDocumentsMatchingCollectionQuery(e,v,a,o).next(_=>{_.forEach((T,N)=>{d=d.insert(T,N)})})}).next(()=>d))}getDocumentsMatchingCollectionQuery(e,t,a,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next(d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,c,o))).next(d=>{c.forEach((g,v)=>{const _=v.getKey();d.get(_)===null&&(d=d.insert(_,$t.newInvalidDocument(_)))});let m=Ec();return d.forEach((g,v)=>{const _=c.get(g);_!==void 0&&Cc(_.mutation,v,Un.empty(),kt.now()),kh(t,v)&&(m=m.insert(g,v))}),m})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return le.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:qn(o.createTime)}}(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:Z1(o.bundledQuery),readTime:qn(o.readTime)}}(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(){this.overlays=new pt(be.comparator),this.Qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const a=_r();return le.forEach(t,o=>this.getOverlay(e,o).next(c=>{c!==null&&a.set(o,c)})).next(()=>a)}saveOverlays(e,t,a){return a.forEach((o,c)=>{this.St(e,t,c)}),le.resolve()}removeOverlaysForBatchId(e,t,a){const o=this.Qr.get(a);return o!==void 0&&(o.forEach(c=>this.overlays=this.overlays.remove(c)),this.Qr.delete(a)),le.resolve()}getOverlaysForCollection(e,t,a){const o=_r(),c=t.length+1,d=new be(t.child("")),m=this.overlays.getIteratorFrom(d);for(;m.hasNext();){const g=m.getNext().value,v=g.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===c&&g.largestBatchId>a&&o.set(g.getKey(),g)}return le.resolve(o)}getOverlaysForCollectionGroup(e,t,a,o){let c=new pt((v,_)=>v-_);const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>a){let _=c.get(v.largestBatchId);_===null&&(_=_r(),c=c.insert(v.largestBatchId,_)),_.set(v.getKey(),v)}}const m=_r(),g=c.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach((v,_)=>m.set(v,_)),!(m.size()>=o)););return le.resolve(m)}St(e,t,a){const o=this.overlays.get(a.key);if(o!==null){const d=this.Qr.get(o.largestBatchId).delete(a.key);this.Qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(a.key,new j1(t,a));let c=this.Qr.get(t);c===void 0&&(c=ze(),this.Qr.set(t,c)),this.Qr.set(t,c.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(){this.sessionToken=an.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(){this.$r=new Vt(Gt.Ur),this.Kr=new Vt(Gt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const a=new Gt(e,t);this.$r=this.$r.add(a),this.Kr=this.Kr.add(a)}Gr(e,t){e.forEach(a=>this.addReference(a,t))}removeReference(e,t){this.zr(new Gt(e,t))}jr(e,t){e.forEach(a=>this.removeReference(a,t))}Hr(e){const t=new be(new rt([])),a=new Gt(t,e),o=new Gt(t,e+1),c=[];return this.Kr.forEachInRange([a,o],d=>{this.zr(d),c.push(d.key)}),c}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new be(new rt([])),a=new Gt(t,e),o=new Gt(t,e+1);let c=ze();return this.Kr.forEachInRange([a,o],d=>{c=c.add(d.key)}),c}containsKey(e){const t=new Gt(e,0),a=this.$r.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class Gt{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return be.comparator(e.key,t.key)||Me(e.Zr,t.Zr)}static Wr(e,t){return Me(e.Zr,t.Zr)||be.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Vt(Gt.Ur)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,o){const c=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new I1(c,t,a,o);this.mutationQueue.push(d);for(const m of o)this.Xr=this.Xr.add(new Gt(m.key,c)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return le.resolve(d)}lookupMutationBatch(e,t){return le.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,o=this.ti(a),c=o<0?0:o;return le.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?Cg:this.nr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new Gt(t,0),o=new Gt(t,Number.POSITIVE_INFINITY),c=[];return this.Xr.forEachInRange([a,o],d=>{const m=this.ei(d.Zr);c.push(m)}),le.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new Vt(Me);return t.forEach(o=>{const c=new Gt(o,0),d=new Gt(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([c,d],m=>{a=a.add(m.Zr)})}),le.resolve(this.ni(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,o=a.length+1;let c=a;be.isDocumentKey(c)||(c=c.child(""));const d=new Gt(new be(c),0);let m=new Vt(Me);return this.Xr.forEachWhile(g=>{const v=g.key.path;return!!a.isPrefixOf(v)&&(v.length===o&&(m=m.add(g.Zr)),!0)},d),le.resolve(this.ni(m))}ni(e){const t=[];return e.forEach(a=>{const o=this.ei(a);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Ke(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Xr;return le.forEach(t.mutations,o=>{const c=new Gt(o.key,t.batchId);return a=a.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=a})}sr(e){}containsKey(e,t){const a=new Gt(t,0),o=this.Xr.firstAfterOrEqual(a);return le.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e){this.ii=e,this.docs=function(){return new pt(be.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,o=this.docs.get(a),c=o?o.size:0,d=this.ii(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return le.resolve(a?a.document.mutableCopy():$t.newInvalidDocument(t))}getEntries(e,t){let a=Si();return t.forEach(o=>{const c=this.docs.get(o);a=a.insert(o,c?c.document.mutableCopy():$t.newInvalidDocument(o))}),le.resolve(a)}getDocumentsMatchingQuery(e,t,a,o){let c=Si();const d=t.path,m=new be(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(m);for(;g.hasNext();){const{key:v,value:{document:_}}=g.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||HR(BR(_),a)<=0||(o.has(_.key)||kh(t,_))&&(c=c.insert(_.key,_.mutableCopy()))}return le.resolve(c)}getAllFromCollectionGroup(e,t,a,o){Ne(9500)}si(e,t){return le.forEach(this.docs,a=>t(a))}newChangeBuffer(e){return new mD(this)}getSize(e){return le.resolve(this.size)}}class mD extends rD{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((a,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(a)}),le.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e){this.persistence=e,this.oi=new Dr(t=>Rg(t),Dg),this.lastRemoteSnapshotVersion=Se.min(),this.highestTargetId=0,this._i=0,this.ai=new Vg,this.targetCount=0,this.ui=Ko.cr()}forEachTarget(e,t){return this.oi.forEach((a,o)=>t(o)),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this._i&&(this._i=t),le.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Ko(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Tr(t),le.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,a){let o=0;const c=[];return this.oi.forEach((d,m)=>{m.sequenceNumber<=t&&a.get(m.targetId)===null&&(this.oi.delete(d),c.push(this.removeMatchingKeysForTargetId(e,m.targetId)),o++)}),le.waitFor(c).next(()=>o)}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const a=this.oi.get(t)||null;return le.resolve(a)}addMatchingKeys(e,t,a){return this.ai.Gr(t,a),le.resolve()}removeMatchingKeys(e,t,a){this.ai.jr(t,a);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach(d=>{c.push(o.markPotentiallyOrphaned(e,d))}),le.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const a=this.ai.Yr(t);return le.resolve(a)}containsKey(e,t){return le.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{constructor(e,t){this.ci={},this.overlays={},this.li=new Dh(0),this.hi=!1,this.hi=!0,this.Pi=new dD,this.referenceDelegate=e(this),this.Ti=new pD(this),this.indexManager=new J1,this.remoteDocumentCache=function(o){return new fD(o)}(a=>this.referenceDelegate.Ii(a)),this.serializer=new W1(t),this.Ei=new cD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new uD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ci[e.toKey()];return a||(a=new hD(t,this.referenceDelegate),this.ci[e.toKey()]=a),a}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,a){me("MemoryPersistence","Starting transaction:",e);const o=new gD(this.li.next());return this.referenceDelegate.di(),a(o).next(c=>this.referenceDelegate.Ai(o).next(()=>c)).toPromise().then(c=>(o.raiseOnCommittedEvent(),c))}Ri(e,t){return le.or(Object.values(this.ci).map(a=>()=>a.containsKey(e,t)))}}class gD extends $R{constructor(e){super(),this.currentSequenceNumber=e}}class Lg{constructor(e){this.persistence=e,this.Vi=new Vg,this.mi=null}static fi(e){return new Lg(e)}get gi(){if(this.mi)return this.mi;throw Ne(60996)}addReference(e,t,a){return this.Vi.addReference(a,t),this.gi.delete(a.toString()),le.resolve()}removeReference(e,t,a){return this.Vi.removeReference(a,t),this.gi.add(a.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(c=>this.gi.add(c.toString()))}).next(()=>a.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.gi,a=>{const o=be.fromPath(a);return this.pi(e,o).next(c=>{c||t.removeEntry(o,Se.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(a=>{a?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return le.or([()=>le.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class vh{constructor(e,t){this.persistence=e,this.yi=new Dr(a=>QR(a.path),(a,o)=>a.isEqual(o)),this.garbageCollector=aD(this,t)}static fi(e,t){return new vh(e,t)}di(){}Ai(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(a=>t.next(o=>a+o))}br(e){let t=0;return this.yr(e,a=>{t++}).next(()=>t)}yr(e,t){return le.forEach(this.yi,(a,o)=>this.Dr(e,a,o).next(c=>c?le.resolve():t(o)))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.si(e,d=>this.Dr(e,d,t).next(m=>{m||(a++,c.removeEntry(d,Se.min()))})).next(()=>c.apply(e)).next(()=>a)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}removeReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Qd(e.data.value)),t}Dr(e,t,a){return le.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return le.resolve(o!==void 0&&o>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e,t,a,o){this.targetId=e,this.fromCache=t,this.ds=a,this.As=o}static Rs(e,t){let a=ze(),o=ze();for(const c of t.docChanges)switch(c.type){case 0:a=a.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new Ug(e,t.fromCache,a,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return Xw()?8:KR(mn())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,a,o){const c={result:null};return this.ws(e,t).next(d=>{c.result=d}).next(()=>{if(!c.result)return this.bs(e,t,o,a).next(d=>{c.result=d})}).next(()=>{if(c.result)return;const d=new vD;return this.Ss(e,t,d).next(m=>{if(c.result=m,this.fs)return this.Ds(e,t,d,m.size)})}).next(()=>c.result)}Ds(e,t,a,o){return a.documentReadCount<this.gs?(jo()<=Ue.DEBUG&&me("QueryEngine","SDK will not create cache indexes for query:",Ro(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),le.resolve()):(jo()<=Ue.DEBUG&&me("QueryEngine","Query:",Ro(t),"scans",a.documentReadCount,"local documents and returns",o,"documents as results."),a.documentReadCount>this.ps*o?(jo()<=Ue.DEBUG&&me("QueryEngine","The SDK decides to create cache indexes for query:",Ro(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zs(t))):le.resolve())}ws(e,t){if($b(t))return le.resolve(null);let a=zs(t);return this.indexManager.getIndexType(e,a).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Yp(t,null,"F"),a=zs(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next(c=>{const d=ze(...c);return this.ys.getDocuments(e,d).next(m=>this.indexManager.getMinOffset(e,a).next(g=>{const v=this.vs(t,m);return this.Cs(t,v,d,g.readTime)?this.ws(e,Yp(t,null,"F")):this.Fs(e,v,t,g)}))})))}bs(e,t,a,o){return $b(t)||o.isEqual(Se.min())?le.resolve(null):this.ys.getDocuments(e,a).next(c=>{const d=this.vs(t,c);return this.Cs(t,d,a,o)?le.resolve(null):(jo()<=Ue.DEBUG&&me("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Ro(t)),this.Fs(e,d,t,zR(o,Lc)).next(m=>m))})}vs(e,t){let a=new Vt(R0(e));return t.forEach((o,c)=>{kh(e,c)&&(a=a.add(c))}),a}Cs(e,t,a,o){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,a){return jo()<=Ue.DEBUG&&me("QueryEngine","Using full collection scan to execute query:",Ro(t)),this.ys.getDocumentsMatchingQuery(e,t,ga.min(),a)}Fs(e,t,a,o){return this.ys.getDocumentsMatchingQuery(e,a,o).next(c=>(t.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg="LocalStore",_D=3e8;class ED{constructor(e,t,a,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new pt(Me),this.Os=new Dr(c=>Rg(c),Dg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(a)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lD(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function bD(s,e,t,a){return new ED(s,e,t,a)}async function sx(s,e){const t=je(s);return await t.persistence.runTransaction("Handle user change","readonly",a=>{let o;return t.mutationQueue.getAllMutationBatches(a).next(c=>(o=c,t.Ls(e),t.mutationQueue.getAllMutationBatches(a))).next(c=>{const d=[],m=[];let g=ze();for(const v of o){d.push(v.batchId);for(const _ of v.mutations)g=g.add(_.key)}for(const v of c){m.push(v.batchId);for(const _ of v.mutations)g=g.add(_.key)}return t.localDocuments.getDocuments(a,g).next(v=>({ks:v,removedBatchIds:d,addedBatchIds:m}))})})}function TD(s,e){const t=je(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const o=e.batch.keys(),c=t.Bs.newChangeBuffer({trackRemovals:!0});return function(m,g,v,_){const T=v.batch,N=T.keys();let C=le.resolve();return N.forEach(w=>{C=C.next(()=>_.getEntry(g,w)).next(F=>{const A=v.docVersions.get(w);Ke(A!==null,48541),F.version.compareTo(A)<0&&(T.applyToRemoteDocument(F,v),F.isValidDocument()&&(F.setReadTime(v.commitVersion),_.addEntry(F)))})}),C.next(()=>m.mutationQueue.removeMutationBatch(g,T))}(t,a,e,c).next(()=>c.apply(a)).next(()=>t.mutationQueue.performConsistencyCheck(a)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(a,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,function(m){let g=ze();for(let v=0;v<m.mutationResults.length;++v)m.mutationResults[v].transformResults.length>0&&(g=g.add(m.batch.mutations[v].key));return g}(e))).next(()=>t.localDocuments.getDocuments(a,o))})}function ix(s){const e=je(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function ND(s,e){const t=je(s),a=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const m=[];e.targetChanges.forEach((_,T)=>{const N=o.get(T);if(!N)return;m.push(t.Ti.removeMatchingKeys(c,_.removedDocuments,T).next(()=>t.Ti.addMatchingKeys(c,_.addedDocuments,T)));let C=N.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(T)!==null?C=C.withResumeToken(an.EMPTY_BYTE_STRING,Se.min()).withLastLimboFreeSnapshotVersion(Se.min()):_.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(_.resumeToken,a)),o=o.insert(T,C),function(F,A,L){return F.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=_D?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(N,C,_)&&m.push(t.Ti.updateTargetData(c,C))});let g=Si(),v=ze();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(c,_))}),m.push(xD(c,d,e.documentUpdates).next(_=>{g=_.qs,v=_.Qs})),!a.isEqual(Se.min())){const _=t.Ti.getLastRemoteSnapshotVersion(c).next(T=>t.Ti.setTargetsMetadata(c,c.currentSequenceNumber,a));m.push(_)}return le.waitFor(m).next(()=>d.apply(c)).next(()=>t.localDocuments.getLocalViewOfDocuments(c,g,v)).next(()=>g)}).then(c=>(t.xs=o,c))}function xD(s,e,t){let a=ze(),o=ze();return t.forEach(c=>a=a.add(c)),e.getEntries(s,a).next(c=>{let d=Si();return t.forEach((m,g)=>{const v=c.get(m);g.isFoundDocument()!==v.isFoundDocument()&&(o=o.add(m)),g.isNoDocument()&&g.version.isEqual(Se.min())?(e.removeEntry(m,g.readTime),d=d.insert(m,g)):!v.isValidDocument()||g.version.compareTo(v.version)>0||g.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(g),d=d.insert(m,g)):me(Fg,"Ignoring outdated watch update for ",m,". Current version:",v.version," Watch version:",g.version)}),{qs:d,Qs:o}})}function AD(s,e){const t=je(s);return t.persistence.runTransaction("Get next mutation batch","readonly",a=>(e===void 0&&(e=Cg),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e)))}function SD(s,e){const t=je(s);return t.persistence.runTransaction("Allocate target","readwrite",a=>{let o;return t.Ti.getTargetData(a,e).next(c=>c?(o=c,le.resolve(o)):t.Ti.allocateTargetId(a).next(d=>(o=new ua(e,d,"TargetPurposeListen",a.currentSequenceNumber),t.Ti.addTargetData(a,o).next(()=>o))))}).then(a=>{const o=t.xs.get(a.targetId);return(o===null||a.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(a.targetId,a),t.Os.set(e,a.targetId)),a})}async function Zp(s,e,t){const a=je(s),o=a.xs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",c,d=>a.persistence.referenceDelegate.removeTarget(d,o))}catch(d){if(!tl(d))throw d;me(Fg,`Failed to update sequence numbers for target ${e}: ${d}`)}a.xs=a.xs.remove(e),a.Os.delete(o.target)}function aT(s,e,t){const a=je(s);let o=Se.min(),c=ze();return a.persistence.runTransaction("Execute query","readwrite",d=>function(g,v,_){const T=je(g),N=T.Os.get(_);return N!==void 0?le.resolve(T.xs.get(N)):T.Ti.getTargetData(v,_)}(a,d,zs(e)).next(m=>{if(m)return o=m.lastLimboFreeSnapshotVersion,a.Ti.getMatchingKeysForTargetId(d,m.targetId).next(g=>{c=g})}).next(()=>a.Ms.getDocumentsMatchingQuery(d,e,t?o:Se.min(),t?c:ze())).next(m=>(wD(a,m1(e),m),{documents:m,$s:c})))}function wD(s,e,t){let a=s.Ns.get(e)||Se.min();t.forEach((o,c)=>{c.readTime.compareTo(a)>0&&(a=c.readTime)}),s.Ns.set(e,a)}class rT{constructor(){this.activeTargetIds=E1()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class CD{constructor(){this.xo=new rT,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,a){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new rT,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT="ConnectivityMonitor";class lT{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){me(oT,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){me(oT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fd=null;function Jp(){return Fd===null?Fd=function(){return 268435456+Math.round(2147483648*Math.random())}():Fd++,"0x"+Fd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp="RestConnection",jD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class RD{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${a}/databases/${o}`,this.Go=this.databaseId.database===dh?`project_id=${a}`:`project_id=${a}&database_id=${o}`}zo(e,t,a,o,c){const d=Jp(),m=this.jo(e,t.toUriEncodedString());me(yp,`Sending RPC '${e}' ${d}:`,m,a);const g={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(g,o,c);const{host:v}=new URL(m),_=jr(v);return this.Jo(e,m,g,a,_).then(T=>(me(yp,`Received RPC '${e}' ${d}: `,T),T),T=>{throw Bo(yp,`RPC '${e}' ${d} failed with error: `,T,"url: ",m,"request:",a),T})}Yo(e,t,a,o,c,d){return this.zo(e,t,a,o,c)}Ho(e,t,a){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,c)=>e[c]=o),a&&a.headers.forEach((o,c)=>e[c]=o)}jo(e,t){const a=jD[e];return`${this.Ko}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const un="WebChannelConnection";class OD extends RD{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,o,c){const d=Jp();return new Promise((m,g)=>{const v=new i0;v.setWithCredentials(!0),v.listenOnce(a0.COMPLETE,()=>{try{switch(v.getLastErrorCode()){case Yd.NO_ERROR:const T=v.getResponseJson();me(un,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(T)),m(T);break;case Yd.TIMEOUT:me(un,`RPC '${e}' ${d} timed out`),g(new fe(ie.DEADLINE_EXCEEDED,"Request time out"));break;case Yd.HTTP_ERROR:const N=v.getStatus();if(me(un,`RPC '${e}' ${d} failed with status:`,N,"response text:",v.getResponseText()),N>0){let C=v.getResponseJson();Array.isArray(C)&&(C=C[0]);const w=C?.error;if(w&&w.status&&w.message){const F=function(L){const W=L.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(W)>=0?W:ie.UNKNOWN}(w.status);g(new fe(F,w.message))}else g(new fe(ie.UNKNOWN,"Server responded with status "+v.getStatus()))}else g(new fe(ie.UNAVAILABLE,"Connection failed."));break;default:Ne(9055,{h_:e,streamId:d,P_:v.getLastErrorCode(),T_:v.getLastError()})}}finally{me(un,`RPC '${e}' ${d} completed.`)}});const _=JSON.stringify(o);me(un,`RPC '${e}' ${d} sending request:`,o),v.send(t,"POST",_,a,15)})}I_(e,t,a){const o=Jp(),c=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=l0(),m=o0(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(g.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(g.useFetchStreams=!0),this.Ho(g.initMessageHeaders,t,a),g.encodeInitMessageHeaders=!0;const _=c.join("");me(un,`Creating RPC '${e}' stream ${o}: ${_}`,g);const T=d.createWebChannel(_,g);this.E_(T);let N=!1,C=!1;const w=new DD({Zo:A=>{C?me(un,`Not sending because RPC '${e}' stream ${o} is closed:`,A):(N||(me(un,`Opening RPC '${e}' stream ${o} transport.`),T.open(),N=!0),me(un,`RPC '${e}' stream ${o} sending:`,A),T.send(A))},Xo:()=>T.close()}),F=(A,L,W)=>{A.listen(L,H=>{try{W(H)}catch(U){setTimeout(()=>{throw U},0)}})};return F(T,_c.EventType.OPEN,()=>{C||(me(un,`RPC '${e}' stream ${o} transport opened.`),w.__())}),F(T,_c.EventType.CLOSE,()=>{C||(C=!0,me(un,`RPC '${e}' stream ${o} transport closed`),w.u_(),this.d_(T))}),F(T,_c.EventType.ERROR,A=>{C||(C=!0,Bo(un,`RPC '${e}' stream ${o} transport errored. Name:`,A.name,"Message:",A.message),w.u_(new fe(ie.UNAVAILABLE,"The operation could not be completed")))}),F(T,_c.EventType.MESSAGE,A=>{var L;if(!C){const W=A.data[0];Ke(!!W,16349);const H=W,U=H?.error||((L=H[0])===null||L===void 0?void 0:L.error);if(U){me(un,`RPC '${e}' stream ${o} received error:`,U);const z=U.status;let ae=function(j){const R=It[j];if(R!==void 0)return H0(R)}(z),O=U.message;ae===void 0&&(ae=ie.INTERNAL,O="Unknown error status: "+z+" with message "+U.message),C=!0,w.u_(new fe(ae,O)),T.close()}else me(un,`RPC '${e}' stream ${o} received:`,W),w.c_(W)}}),F(m,r0.STAT_EVENT,A=>{A.stat===qp.PROXY?me(un,`RPC '${e}' stream ${o} detected buffering proxy`):A.stat===qp.NOPROXY&&me(un,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{w.a_()},0),w}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function _p(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qh(s){return new V1(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,t,a=1e3,o=1.5,c=6e4){this.xi=e,this.timerId=t,this.A_=a,this.R_=o,this.V_=c,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),a=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-a);o>0&&me("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT="PersistentStream";class ax{constructor(e,t,a,o,c,d,m,g){this.xi=e,this.S_=a,this.D_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=m,this.listener=g,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new qg(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(Ai(t.toString()),Ai("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,o])=>{this.v_===t&&this.z_(a,o)},a=>{e(()=>{const o=new fe(ie.UNKNOWN,"Fetching auth token failed: "+a.message);return this.j_(o)})})}z_(e,t){const a=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{a(()=>this.listener.e_())}),this.stream.n_(()=>{a(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{a(()=>this.j_(o))}),this.stream.onMessage(o=>{a(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return me(cT,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(me(cT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class MD extends ax{constructor(e,t,a,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=q1(this.serializer,e),a=function(c){if(!("targetChange"in c))return Se.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?Se.min():d.readTime?qn(d.readTime):Se.min()}(e);return this.listener.Y_(t,a)}Z_(e){const t={};t.database=Wp(this.serializer),t.addTarget=function(c,d){let m;const g=d.target;if(m=$p(g)?{documents:B1(c,g)}:{query:H1(c,g).gt},m.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){m.resumeToken=K0(c,d.resumeToken);const v=Qp(c,d.expectedCount);v!==null&&(m.expectedCount=v)}else if(d.snapshotVersion.compareTo(Se.min())>0){m.readTime=ph(c,d.snapshotVersion.toTimestamp());const v=Qp(c,d.expectedCount);v!==null&&(m.expectedCount=v)}return m}(this.serializer,e);const a=$1(this.serializer,e);a&&(t.labels=a),this.Q_(t)}X_(e){const t={};t.database=Wp(this.serializer),t.removeTarget=e,this.Q_(t)}}class PD extends ax{constructor(e,t,a,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Ke(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ke(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Ke(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=z1(e.writeResults,e.commitTime),a=qn(e.commitTime);return this.listener.ra(a,t)}ia(){const e={};e.database=Wp(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(a=>W0(this.serializer,a))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{}class VD extends kD{constructor(e,t,a,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new fe(ie.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,a,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.zo(e,Xp(t,a),o,c,d)).catch(c=>{throw c.name==="FirebaseError"?(c.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new fe(ie.UNKNOWN,c.toString())})}Yo(e,t,a,o,c){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,m])=>this.connection.Yo(e,Xp(t,a),o,d,m,c)).catch(d=>{throw d.name==="FirebaseError"?(d.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new fe(ie.UNKNOWN,d.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class LD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Ai(t),this.ua=!1):me("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ar="RemoteStore";class UD{constructor(e,t,a,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=c,this.Ra.No(d=>{a.enqueueAndForget(async()=>{Or(this)&&(me(Ar,"Restarting streams for network reachability change."),await async function(g){const v=je(g);v.da.add(4),await su(v),v.Va.set("Unknown"),v.da.delete(4),await zh(v)}(this))})}),this.Va=new LD(a,o)}}async function zh(s){if(Or(s))for(const e of s.Aa)await e(!0)}async function su(s){for(const e of s.Aa)await e(!1)}function rx(s,e){const t=je(s);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),Gg(t)?Hg(t):sl(t).N_()&&Bg(t,e))}function zg(s,e){const t=je(s),a=sl(t);t.Ea.delete(e),a.N_()&&ox(t,e),t.Ea.size===0&&(a.N_()?a.k_():Or(t)&&t.Va.set("Unknown"))}function Bg(s,e){if(s.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Se.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}sl(s).Z_(e)}function ox(s,e){s.ma.Ke(e),sl(s).X_(e)}function Hg(s){s.ma=new O1({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>s.Ea.get(e)||null,Pt:()=>s.datastore.serializer.databaseId}),sl(s).start(),s.Va.ca()}function Gg(s){return Or(s)&&!sl(s).O_()&&s.Ea.size>0}function Or(s){return je(s).da.size===0}function lx(s){s.ma=void 0}async function FD(s){s.Va.set("Online")}async function qD(s){s.Ea.forEach((e,t)=>{Bg(s,e)})}async function zD(s,e){lx(s),Gg(s)?(s.Va.Pa(e),Hg(s)):s.Va.set("Unknown")}async function BD(s,e,t){if(s.Va.set("Online"),e instanceof $0&&e.state===2&&e.cause)try{await async function(o,c){const d=c.cause;for(const m of c.targetIds)o.Ea.has(m)&&(await o.remoteSyncer.rejectListen(m,d),o.Ea.delete(m),o.ma.removeTarget(m))}(s,e)}catch(a){me(Ar,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await yh(s,a)}else if(e instanceof Zd?s.ma.Xe(e):e instanceof G0?s.ma.ot(e):s.ma.nt(e),!t.isEqual(Se.min()))try{const a=await ix(s.localStore);t.compareTo(a)>=0&&await function(c,d){const m=c.ma.It(d);return m.targetChanges.forEach((g,v)=>{if(g.resumeToken.approximateByteSize()>0){const _=c.Ea.get(v);_&&c.Ea.set(v,_.withResumeToken(g.resumeToken,d))}}),m.targetMismatches.forEach((g,v)=>{const _=c.Ea.get(g);if(!_)return;c.Ea.set(g,_.withResumeToken(an.EMPTY_BYTE_STRING,_.snapshotVersion)),ox(c,g);const T=new ua(_.target,g,v,_.sequenceNumber);Bg(c,T)}),c.remoteSyncer.applyRemoteEvent(m)}(s,t)}catch(a){me(Ar,"Failed to raise snapshot:",a),await yh(s,a)}}async function yh(s,e,t){if(!tl(e))throw e;s.da.add(1),await su(s),s.Va.set("Offline"),t||(t=()=>ix(s.localStore)),s.asyncQueue.enqueueRetryable(async()=>{me(Ar,"Retrying IndexedDB access"),await t(),s.da.delete(1),await zh(s)})}function cx(s,e){return e().catch(t=>yh(s,t,e))}async function Bh(s){const e=je(s),t=Ea(e);let a=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Cg;for(;HD(e);)try{const o=await AD(e.localStore,a);if(o===null){e.Ia.length===0&&t.k_();break}a=o.batchId,GD(e,o)}catch(o){await yh(e,o)}ux(e)&&dx(e)}function HD(s){return Or(s)&&s.Ia.length<10}function GD(s,e){s.Ia.push(e);const t=Ea(s);t.N_()&&t.ea&&t.ta(e.mutations)}function ux(s){return Or(s)&&!Ea(s).O_()&&s.Ia.length>0}function dx(s){Ea(s).start()}async function $D(s){Ea(s).ia()}async function KD(s){const e=Ea(s);for(const t of s.Ia)e.ta(t.mutations)}async function YD(s,e,t){const a=s.Ia.shift(),o=Mg.from(a,e,t);await cx(s,()=>s.remoteSyncer.applySuccessfulWrite(o)),await Bh(s)}async function QD(s,e){e&&Ea(s).ea&&await async function(a,o){if(function(d){return B0(d)&&d!==ie.ABORTED}(o.code)){const c=a.Ia.shift();Ea(a).L_(),await cx(a,()=>a.remoteSyncer.rejectFailedWrite(c.batchId,o)),await Bh(a)}}(s,e),ux(s)&&dx(s)}async function uT(s,e){const t=je(s);t.asyncQueue.verifyOperationInProgress(),me(Ar,"RemoteStore received new credentials");const a=Or(t);t.da.add(3),await su(t),a&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await zh(t)}async function XD(s,e){const t=je(s);e?(t.da.delete(2),await zh(t)):e||(t.da.add(2),await su(t),t.Va.set("Unknown"))}function sl(s){return s.fa||(s.fa=function(t,a,o){const c=je(t);return c.oa(),new MD(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(s.datastore,s.asyncQueue,{e_:FD.bind(null,s),n_:qD.bind(null,s),i_:zD.bind(null,s),Y_:BD.bind(null,s)}),s.Aa.push(async e=>{e?(s.fa.L_(),Gg(s)?Hg(s):s.Va.set("Unknown")):(await s.fa.stop(),lx(s))})),s.fa}function Ea(s){return s.ga||(s.ga=function(t,a,o){const c=je(t);return c.oa(),new PD(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(s.datastore,s.asyncQueue,{e_:()=>Promise.resolve(),n_:$D.bind(null,s),i_:QD.bind(null,s),na:KD.bind(null,s),ra:YD.bind(null,s)}),s.Aa.push(async e=>{e?(s.ga.L_(),await Bh(s)):(await s.ga.stop(),s.Ia.length>0&&(me(Ar,`Stopping write stream with ${s.Ia.length} pending writes`),s.Ia=[]))})),s.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(e,t,a,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=o,this.removalCallback=c,this.deferred=new qs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,o,c){const d=Date.now()+a,m=new $g(e,t,d,o,c);return m.start(a),m}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new fe(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Kg(s,e){if(Ai("AsyncQueue",`${e}: ${s}`),tl(s))return new fe(ie.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{static emptySet(e){return new Fo(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||be.comparator(t.key,a.key):(t,a)=>be.comparator(t.key,a.key),this.keyedMap=Ec(),this.sortedSet=new pt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,a)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Fo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new Fo;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(){this.pa=new pt(be.comparator)}track(e){const t=e.doc.key,a=this.pa.get(t);a?e.type!==0&&a.type===3?this.pa=this.pa.insert(t,e):e.type===3&&a.type!==1?this.pa=this.pa.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.pa=this.pa.remove(t):e.type===1&&a.type===2?this.pa=this.pa.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Ne(63341,{Vt:e,ya:a}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,a)=>{e.push(a)}),e}}class Yo{constructor(e,t,a,o,c,d,m,g,v){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=m,this.excludesMetadataChanges=g,this.hasCachedResults=v}static fromInitialDocuments(e,t,a,o,c){const d=[];return t.forEach(m=>{d.push({type:0,doc:m})}),new Yo(e,t,Fo.emptySet(t),d,a,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ph(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==a[o].type||!t[o].doc.isEqual(a[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class ZD{constructor(){this.queries=hT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const o=je(t),c=o.queries;o.queries=hT(),c.forEach((d,m)=>{for(const g of m.Sa)g.onError(a)})})(this,new fe(ie.ABORTED,"Firestore shutting down"))}}function hT(){return new Dr(s=>j0(s),Ph)}async function Yg(s,e){const t=je(s);let a=3;const o=e.query;let c=t.queries.get(o);c?!c.Da()&&e.va()&&(a=2):(c=new WD,a=e.va()?0:1);try{switch(a){case 0:c.ba=await t.onListen(o,!0);break;case 1:c.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const m=Kg(d,`Initialization of query '${Ro(e.query)}' failed`);return void e.onError(m)}t.queries.set(o,c),c.Sa.push(e),e.Fa(t.onlineState),c.ba&&e.Ma(c.ba)&&Xg(t)}async function Qg(s,e){const t=je(s),a=e.query;let o=3;const c=t.queries.get(a);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.va()?0:1:!c.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function JD(s,e){const t=je(s);let a=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const m of d.Sa)m.Ma(o)&&(a=!0);d.ba=o}}a&&Xg(t)}function eO(s,e,t){const a=je(s),o=a.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);a.queries.delete(e)}function Xg(s){s.Ca.forEach(e=>{e.next()})}var eg,fT;(fT=eg||(eg={})).xa="default",fT.Cache="cache";class Wg{constructor(e,t,a){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=a||{}}Ma(e){if(!this.options.includeMetadataChanges){const a=[];for(const o of e.docChanges)o.type!==3&&a.push(o);e=new Yo(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const a=t!=="Offline";return(!this.options.Qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=Yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==eg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(e){this.key=e}}class fx{constructor(e){this.key=e}}class tO{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ze(),this.mutatedKeys=ze(),this.Za=R0(e),this.Xa=new Fo(this.Za)}get eu(){return this.Ha}tu(e,t){const a=t?t.nu:new dT,o=t?t.Xa:this.Xa;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,m=!1;const g=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,v=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((_,T)=>{const N=o.get(_),C=kh(this.query,T)?T:null,w=!!N&&this.mutatedKeys.has(N.key),F=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let A=!1;N&&C?N.data.isEqual(C.data)?w!==F&&(a.track({type:3,doc:C}),A=!0):this.ru(N,C)||(a.track({type:2,doc:C}),A=!0,(g&&this.Za(C,g)>0||v&&this.Za(C,v)<0)&&(m=!0)):!N&&C?(a.track({type:0,doc:C}),A=!0):N&&!C&&(a.track({type:1,doc:N}),A=!0,(g||v)&&(m=!0)),A&&(C?(d=d.add(C),c=F?c.add(_):c.delete(_)):(d=d.delete(_),c=c.delete(_)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const _=this.query.limitType==="F"?d.last():d.first();d=d.delete(_.key),c=c.delete(_.key),a.track({type:1,doc:_})}return{Xa:d,nu:a,Cs:m,mutatedKeys:c}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,o){const c=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const d=e.nu.wa();d.sort((_,T)=>function(C,w){const F=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ne(20277,{Vt:A})}};return F(C)-F(w)}(_.type,T.type)||this.Za(_.doc,T.doc)),this.iu(a),o=o!=null&&o;const m=t&&!o?this.su():[],g=this.Ya.size===0&&this.current&&!o?1:0,v=g!==this.Ja;return this.Ja=g,d.length!==0||v?{snapshot:new Yo(this.query,e.Xa,c,d,e.mutatedKeys,g===0,v,!1,!!a&&a.resumeToken.approximateByteSize()>0),ou:m}:{ou:m}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new dT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=ze(),this.Xa.forEach(a=>{this._u(a.key)&&(this.Ya=this.Ya.add(a.key))});const t=[];return e.forEach(a=>{this.Ya.has(a)||t.push(new fx(a))}),this.Ya.forEach(a=>{e.has(a)||t.push(new hx(a))}),t}au(e){this.Ha=e.$s,this.Ya=ze();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return Yo.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const Zg="SyncEngine";class nO{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class sO{constructor(e){this.key=e,this.cu=!1}}class iO{constructor(e,t,a,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.lu={},this.hu=new Dr(m=>j0(m),Ph),this.Pu=new Map,this.Tu=new Set,this.Iu=new pt(be.comparator),this.Eu=new Map,this.du=new Vg,this.Au={},this.Ru=new Map,this.Vu=Ko.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function aO(s,e,t=!0){const a=_x(s);let o;const c=a.hu.get(e);return c?(a.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.uu()):o=await mx(a,e,t,!0),o}async function rO(s,e){const t=_x(s);await mx(t,e,!0,!1)}async function mx(s,e,t,a){const o=await SD(s.localStore,zs(e)),c=o.targetId,d=s.sharedClientState.addLocalQueryTarget(c,t);let m;return a&&(m=await oO(s,e,c,d==="current",o.resumeToken)),s.isPrimaryClient&&t&&rx(s.remoteStore,o),m}async function oO(s,e,t,a,o){s.fu=(T,N,C)=>async function(F,A,L,W){let H=A.view.tu(L);H.Cs&&(H=await aT(F.localStore,A.query,!1).then(({documents:O})=>A.view.tu(O,H)));const U=W&&W.targetChanges.get(A.targetId),z=W&&W.targetMismatches.get(A.targetId)!=null,ae=A.view.applyChanges(H,F.isPrimaryClient,U,z);return pT(F,A.targetId,ae.ou),ae.snapshot}(s,T,N,C);const c=await aT(s.localStore,e,!0),d=new tO(e,c.$s),m=d.tu(c.documents),g=nu.createSynthesizedTargetChangeForCurrentChange(t,a&&s.onlineState!=="Offline",o),v=d.applyChanges(m,s.isPrimaryClient,g);pT(s,t,v.ou);const _=new nO(e,t,d);return s.hu.set(e,_),s.Pu.has(t)?s.Pu.get(t).push(e):s.Pu.set(t,[e]),v.snapshot}async function lO(s,e,t){const a=je(s),o=a.hu.get(e),c=a.Pu.get(o.targetId);if(c.length>1)return a.Pu.set(o.targetId,c.filter(d=>!Ph(d,e))),void a.hu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(o.targetId),a.sharedClientState.isActiveQueryTarget(o.targetId)||await Zp(a.localStore,o.targetId,!1).then(()=>{a.sharedClientState.clearQueryState(o.targetId),t&&zg(a.remoteStore,o.targetId),tg(a,o.targetId)}).catch(el)):(tg(a,o.targetId),await Zp(a.localStore,o.targetId,!0))}async function cO(s,e){const t=je(s),a=t.hu.get(e),o=t.Pu.get(a.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),zg(t.remoteStore,a.targetId))}async function uO(s,e,t){const a=vO(s);try{const o=await function(d,m){const g=je(d),v=kt.now(),_=m.reduce((C,w)=>C.add(w.key),ze());let T,N;return g.persistence.runTransaction("Locally write mutations","readwrite",C=>{let w=Si(),F=ze();return g.Bs.getEntries(C,_).next(A=>{w=A,w.forEach((L,W)=>{W.isValidDocument()||(F=F.add(L))})}).next(()=>g.localDocuments.getOverlayedDocuments(C,w)).next(A=>{T=A;const L=[];for(const W of m){const H=C1(W,T.get(W.key).overlayedDocument);H!=null&&L.push(new ja(W.key,H,T0(H.value.mapValue),nn.exists(!0)))}return g.mutationQueue.addMutationBatch(C,v,L,m)}).next(A=>{N=A;const L=A.applyToLocalDocumentSet(T,F);return g.documentOverlayCache.saveOverlays(C,A.batchId,L)})}).then(()=>({batchId:N.batchId,changes:O0(T)}))}(a.localStore,e);a.sharedClientState.addPendingMutation(o.batchId),function(d,m,g){let v=d.Au[d.currentUser.toKey()];v||(v=new pt(Me)),v=v.insert(m,g),d.Au[d.currentUser.toKey()]=v}(a,o.batchId,t),await iu(a,o.changes),await Bh(a.remoteStore)}catch(o){const c=Kg(o,"Failed to persist write");t.reject(c)}}async function px(s,e){const t=je(s);try{const a=await ND(t.localStore,e);e.targetChanges.forEach((o,c)=>{const d=t.Eu.get(c);d&&(Ke(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.cu=!0:o.modifiedDocuments.size>0?Ke(d.cu,14607):o.removedDocuments.size>0&&(Ke(d.cu,42227),d.cu=!1))}),await iu(t,a,e)}catch(a){await el(a)}}function mT(s,e,t){const a=je(s);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const o=[];a.hu.forEach((c,d)=>{const m=d.view.Fa(e);m.snapshot&&o.push(m.snapshot)}),function(d,m){const g=je(d);g.onlineState=m;let v=!1;g.queries.forEach((_,T)=>{for(const N of T.Sa)N.Fa(m)&&(v=!0)}),v&&Xg(g)}(a.eventManager,e),o.length&&a.lu.Y_(o),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function dO(s,e,t){const a=je(s);a.sharedClientState.updateQueryState(e,"rejected",t);const o=a.Eu.get(e),c=o&&o.key;if(c){let d=new pt(be.comparator);d=d.insert(c,$t.newNoDocument(c,Se.min()));const m=ze().add(c),g=new Fh(Se.min(),new Map,new pt(Me),d,m);await px(a,g),a.Iu=a.Iu.remove(c),a.Eu.delete(e),Jg(a)}else await Zp(a.localStore,e,!1).then(()=>tg(a,e,t)).catch(el)}async function hO(s,e){const t=je(s),a=e.batch.batchId;try{const o=await TD(t.localStore,e);vx(t,a,null),gx(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await iu(t,o)}catch(o){await el(o)}}async function fO(s,e,t){const a=je(s);try{const o=await function(d,m){const g=je(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",v=>{let _;return g.mutationQueue.lookupMutationBatch(v,m).next(T=>(Ke(T!==null,37113),_=T.keys(),g.mutationQueue.removeMutationBatch(v,T))).next(()=>g.mutationQueue.performConsistencyCheck(v)).next(()=>g.documentOverlayCache.removeOverlaysForBatchId(v,_,m)).next(()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,_)).next(()=>g.localDocuments.getDocuments(v,_))})}(a.localStore,e);vx(a,e,t),gx(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await iu(a,o)}catch(o){await el(o)}}function gx(s,e){(s.Ru.get(e)||[]).forEach(t=>{t.resolve()}),s.Ru.delete(e)}function vx(s,e,t){const a=je(s);let o=a.Au[a.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),a.Au[a.currentUser.toKey()]=o}}function tg(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const a of s.Pu.get(e))s.hu.delete(a),t&&s.lu.gu(a,t);s.Pu.delete(e),s.isPrimaryClient&&s.du.Hr(e).forEach(a=>{s.du.containsKey(a)||yx(s,a)})}function yx(s,e){s.Tu.delete(e.path.canonicalString());const t=s.Iu.get(e);t!==null&&(zg(s.remoteStore,t),s.Iu=s.Iu.remove(e),s.Eu.delete(t),Jg(s))}function pT(s,e,t){for(const a of t)a instanceof hx?(s.du.addReference(a.key,e),mO(s,a)):a instanceof fx?(me(Zg,"Document no longer in limbo: "+a.key),s.du.removeReference(a.key,e),s.du.containsKey(a.key)||yx(s,a.key)):Ne(19791,{pu:a})}function mO(s,e){const t=e.key,a=t.path.canonicalString();s.Iu.get(t)||s.Tu.has(a)||(me(Zg,"New document in limbo: "+t),s.Tu.add(a),Jg(s))}function Jg(s){for(;s.Tu.size>0&&s.Iu.size<s.maxConcurrentLimboResolutions;){const e=s.Tu.values().next().value;s.Tu.delete(e);const t=new be(rt.fromString(e)),a=s.Vu.next();s.Eu.set(a,new sO(t)),s.Iu=s.Iu.insert(t,a),rx(s.remoteStore,new ua(zs(Mh(t.path)),a,"TargetPurposeLimboResolution",Dh.le))}}async function iu(s,e,t){const a=je(s),o=[],c=[],d=[];a.hu.isEmpty()||(a.hu.forEach((m,g)=>{d.push(a.fu(g,e,t).then(v=>{var _;if((v||t)&&a.isPrimaryClient){const T=v?!v.fromCache:(_=t?.targetChanges.get(g.targetId))===null||_===void 0?void 0:_.current;a.sharedClientState.updateQueryState(g.targetId,T?"current":"not-current")}if(v){o.push(v);const T=Ug.Rs(g.targetId,v);c.push(T)}}))}),await Promise.all(d),a.lu.Y_(o),await async function(g,v){const _=je(g);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",T=>le.forEach(v,N=>le.forEach(N.ds,C=>_.persistence.referenceDelegate.addReference(T,N.targetId,C)).next(()=>le.forEach(N.As,C=>_.persistence.referenceDelegate.removeReference(T,N.targetId,C)))))}catch(T){if(!tl(T))throw T;me(Fg,"Failed to update sequence numbers: "+T)}for(const T of v){const N=T.targetId;if(!T.fromCache){const C=_.xs.get(N),w=C.snapshotVersion,F=C.withLastLimboFreeSnapshotVersion(w);_.xs=_.xs.insert(N,F)}}}(a.localStore,c))}async function pO(s,e){const t=je(s);if(!t.currentUser.isEqual(e)){me(Zg,"User change. New user:",e.toKey());const a=await sx(t.localStore,e);t.currentUser=e,function(c,d){c.Ru.forEach(m=>{m.forEach(g=>{g.reject(new fe(ie.CANCELLED,d))})}),c.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await iu(t,a.ks)}}function gO(s,e){const t=je(s),a=t.Eu.get(e);if(a&&a.cu)return ze().add(a.key);{let o=ze();const c=t.Pu.get(e);if(!c)return o;for(const d of c){const m=t.hu.get(d);o=o.unionWith(m.view.eu)}return o}}function _x(s){const e=je(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=px.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dO.bind(null,e),e.lu.Y_=JD.bind(null,e.eventManager),e.lu.gu=eO.bind(null,e.eventManager),e}function vO(s){const e=je(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fO.bind(null,e),e}class _h{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=qh(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return bD(this.persistence,new yD,e.initialUser,this.serializer)}Su(e){return new nx(Lg.fi,this.serializer)}bu(e){return new CD}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_h.provider={build:()=>new _h};class yO extends _h{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Ke(this.persistence.referenceDelegate instanceof vh,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new sD(a,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?wn.withCacheSize(this.cacheSizeBytes):wn.DEFAULT;return new nx(a=>vh.fi(a,t),this.serializer)}}class ng{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>mT(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=pO.bind(null,this.syncEngine),await XD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ZD}()}createDatastore(e){const t=qh(e.databaseInfo.databaseId),a=function(c){return new OD(c)}(e.databaseInfo);return function(c,d,m,g){return new VD(c,d,m,g)}(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return function(a,o,c,d,m){return new UD(a,o,c,d,m)}(this.localStore,this.datastore,e.asyncQueue,t=>mT(this.syncEngine,t,0),function(){return lT.C()?new lT:new ID}())}createSyncEngine(e,t){return function(o,c,d,m,g,v,_){const T=new iO(o,c,d,m,g,v);return _&&(T.mu=!0),T}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const c=je(o);me(Ar,"RemoteStore shutting down."),c.da.add(5),await su(c),c.Ra.shutdown(),c.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}ng.provider={build:()=>new ng};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Ai("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new fe(ie.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,c){const d=je(o),m={documents:c.map(T=>gh(d.serializer,T))},g=await d.Yo("BatchGetDocuments",d.serializer.databaseId,rt.emptyPath(),m,c.length),v=new Map;g.forEach(T=>{const N=F1(d.serializer,T);v.set(N.key.toString(),N)});const _=[];return c.forEach(T=>{const N=v.get(T.toString());Ke(!!N,55234,{key:T}),_.push(N)}),_}(this.datastore,e);return t.forEach(a=>this.recordVersion(a)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(a){this.lastTransactionError=a}this.writtenDocs.add(e.toString())}delete(e){this.write(new Uh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,a)=>{const o=be.fromPath(a);this.mutations.push(new z0(o,this.precondition(o)))}),await async function(a,o){const c=je(a),d={writes:o.map(m=>W0(c.serializer,m))};await c.zo("Commit",c.serializer.databaseId,rt.emptyPath(),d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ne(50498,{Uu:e.constructor.name});t=Se.min()}const a=this.readVersions.get(e.key.toString());if(a){if(!t.isEqual(a))throw new fe(ie.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Se.min())?nn.exists(!1):nn.updateTime(t):nn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Se.min()))throw new fe(ie.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return nn.updateTime(t)}return nn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e,t,a,o,c){this.asyncQueue=e,this.datastore=t,this.options=a,this.updateFunction=o,this.deferred=c,this.Ku=a.maxAttempts,this.x_=new qg(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new _O(this.datastore),t=this.zu(e);t&&t.then(a=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(a)}).catch(o=>{this.ju(o)}))}).catch(a=>{this.ju(a)})})}zu(e){try{const t=this.updateFunction(e);return!eu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!B0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba="FirestoreClient";class bO{constructor(e,t,a,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=o,this.user=dn.UNAUTHENTICATED,this.clientId=h0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(a,async d=>{me(ba,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(a,d=>(me(ba,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=Kg(t,"Failed to shutdown persistence");e.reject(a)}}),e.promise}}async function Ep(s,e){s.asyncQueue.verifyOperationInProgress(),me(ba,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let a=t.initialUser;s.setCredentialChangeListener(async o=>{a.isEqual(o)||(await sx(e.localStore,o),a=o)}),e.persistence.setDatabaseDeletedListener(()=>s.terminate()),s._offlineComponents=e}async function gT(s,e){s.asyncQueue.verifyOperationInProgress();const t=await TO(s);me(ba,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener(a=>uT(e.remoteStore,a)),s.setAppCheckTokenChangeListener((a,o)=>uT(e.remoteStore,o)),s._onlineComponents=e}async function TO(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){me(ba,"Using user provided OfflineComponentProvider");try{await Ep(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===ie.FAILED_PRECONDITION||o.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Bo("Error using user provided cache. Falling back to memory cache: "+t),await Ep(s,new _h)}}else me(ba,"Using default OfflineComponentProvider"),await Ep(s,new yO(void 0));return s._offlineComponents}async function tv(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(me(ba,"Using user provided OnlineComponentProvider"),await gT(s,s._uninitializedComponentsProvider._online)):(me(ba,"Using default OnlineComponentProvider"),await gT(s,new ng))),s._onlineComponents}function NO(s){return tv(s).then(e=>e.syncEngine)}function xO(s){return tv(s).then(e=>e.datastore)}async function Eh(s){const e=await tv(s),t=e.eventManager;return t.onListen=aO.bind(null,e.syncEngine),t.onUnlisten=lO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=rO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=cO.bind(null,e.syncEngine),t}function AO(s,e,t={}){const a=new qs;return s.asyncQueue.enqueueAndForget(async()=>function(c,d,m,g,v){const _=new ev({next:N=>{_.xu(),d.enqueueAndForget(()=>Qg(c,T));const C=N.docs.has(m);!C&&N.fromCache?v.reject(new fe(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&N.fromCache&&g&&g.source==="server"?v.reject(new fe(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(N)},error:N=>v.reject(N)}),T=new Wg(Mh(m.path),_,{includeMetadataChanges:!0,Qa:!0});return Yg(c,T)}(await Eh(s),s.asyncQueue,e,t,a)),a.promise}function SO(s,e,t={}){const a=new qs;return s.asyncQueue.enqueueAndForget(async()=>function(c,d,m,g,v){const _=new ev({next:N=>{_.xu(),d.enqueueAndForget(()=>Qg(c,T)),N.fromCache&&g.source==="server"?v.reject(new fe(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(N)},error:N=>v.reject(N)}),T=new Wg(m,_,{includeMetadataChanges:!0,Qa:!0});return Yg(c,T)}(await Eh(s),s.asyncQueue,e,t,a)),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ex(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bx(s,e,t){if(!t)throw new fe(ie.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function wO(s,e,t,a){if(e===!0&&a===!0)throw new fe(ie.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function yT(s){if(!be.isDocumentKey(s))throw new fe(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function _T(s){if(be.isDocumentKey(s))throw new fe(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function Hh(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=function(a){return a.constructor?a.constructor.name:null}(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Ne(12329,{type:typeof s})}function Nn(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new fe(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Hh(s);throw new fe(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx="firestore.googleapis.com",ET=!0;class bT{constructor(e){var t,a;if(e.host===void 0){if(e.ssl!==void 0)throw new fe(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Tx,this.ssl=ET}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:ET;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=tx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<tD)throw new fe(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}wO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ex((a=e.experimentalLongPollingOptions)!==null&&a!==void 0?a:{}),function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new fe(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new fe(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new fe(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(a,o){return a.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Gh{constructor(e,t,a,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fe(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new fe(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(a){if(!a)return new OR;switch(a.type){case"firstParty":return new VR(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new fe(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const a=vT.get(t);a&&(me("ComponentProvider","Removing Datastore"),vT.delete(t),a.terminate())}(this),Promise.resolve()}}function CO(s,e,t,a={}){var o;s=Nn(s,Gh);const c=jr(e),d=s._getSettings(),m=Object.assign(Object.assign({},d),{emulatorOptions:s._getEmulatorOptions()}),g=`${e}:${t}`;c&&(dg(`https://${g}`),hg("Firestore",!0)),d.host!==Tx&&d.host!==g&&Bo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:g,ssl:c,emulatorOptions:a});if(!pa(v,m)&&(s._setSettings(v),a.mockUserToken)){let _,T;if(typeof a.mockUserToken=="string")_=a.mockUserToken,T=dn.MOCK_USER;else{_=pN(a.mockUserToken,(o=s._app)===null||o===void 0?void 0:o.options.projectId);const N=a.mockUserToken.sub||a.mockUserToken.user_id;if(!N)throw new fe(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");T=new dn(N)}s._authCredentials=new MR(new u0(_,T))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Ra(this.firestore,e,this._query)}}class sn{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ma(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new sn(this.firestore,e,this._key)}}class ma extends Ra{constructor(e,t,a){super(e,t,Mh(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new sn(this.firestore,null,new be(e))}withConverter(e){return new ma(this.firestore,e,this._path)}}function xt(s,e,...t){if(s=ct(s),bx("collection","path",e),s instanceof Gh){const a=rt.fromString(e,...t);return _T(a),new ma(s,null,a)}{if(!(s instanceof sn||s instanceof ma))throw new fe(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=s._path.child(rt.fromString(e,...t));return _T(a),new ma(s.firestore,null,a)}}function rn(s,e,...t){if(s=ct(s),arguments.length===1&&(e=h0.newId()),bx("doc","path",e),s instanceof Gh){const a=rt.fromString(e,...t);return yT(a),new sn(s,null,new be(a))}{if(!(s instanceof sn||s instanceof ma))throw new fe(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=s._path.child(rt.fromString(e,...t));return yT(a),new sn(s.firestore,s instanceof ma?s.converter:null,new be(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT="AsyncQueue";class NT{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new qg(this,"async_queue_retry"),this.rc=()=>{const a=_p();a&&me(TT,"Visibility state changed to "+a.visibilityState),this.x_.b_()},this.sc=e;const t=_p();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=_p();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new qs;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!tl(e))throw e;me(TT,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(a=>{throw this.Xu=a,this.ec=!1,Ai("INTERNAL UNHANDLED ERROR: ",xT(a)),a}).then(a=>(this.ec=!1,a))));return this.sc=t,t}enqueueAfterDelay(e,t,a){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=$g.createAndSchedule(this,e,t,a,c=>this.uc(c));return this.Zu.push(o),o}oc(){this.Xu&&Ne(47125,{cc:xT(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,a)=>t.targetTimeMs-a.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function xT(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AT(s){return function(t,a){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of a)if(c in o&&typeof o[c]=="function")return!0;return!1}(s,["next","error","complete"])}class Hs extends Gh{constructor(e,t,a,o){super(e,t,a,o),this.type="firestore",this._queue=new NT,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new NT(e),this._firestoreClient=void 0,await e}}}function IO(s,e){const t=typeof s=="object"?s:Qc(),a=typeof s=="string"?s:dh,o=wi(t,"firestore").getImmediate({identifier:a});if(!o._initialized){const c=hN("firestore");c&&CO(o,...c)}return o}function au(s){if(s._terminated)throw new fe(ie.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||jO(s),s._firestoreClient}function jO(s){var e,t,a;const o=s._freezeSettings(),c=function(m,g,v,_){return new ZR(m,g,v,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,Ex(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)}(s._databaseId,((e=s._app)===null||e===void 0?void 0:e.options.appId)||"",s._persistenceKey,o);s._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((a=o.localCache)===null||a===void 0)&&a._onlineComponentProvider)&&(s._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),s._firestoreClient=new bO(s._authCredentials,s._appCheckCredentials,s._queue,c,s._componentsProvider&&function(m){const g=m?._online.build();return{_offline:m?._offline.build(g),_online:g}}(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Sr(an.fromBase64String(e))}catch(t){throw new fe(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Sr(an.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new fe(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fe(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fe(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Me(this._lat,e._lat)||Me(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(a,o){if(a.length!==o.length)return!1;for(let c=0;c<a.length;++c)if(a[c]!==o[c])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RO=/^__.*__$/;class DO{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new ja(e,this.data,this.fieldMask,t,this.fieldTransforms):new tu(e,this.data,t,this.fieldTransforms)}}class Nx{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return new ja(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function xx(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ne(40011,{Ic:s})}}class iv{constructor(e,t,a,o,c,d){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=o,c===void 0&&this.Ec(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new iv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Vc(e),o}mc(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return bh(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(xx(this.Ic)&&RO.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class OO{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||qh(e)}bc(e,t,a,o=!1){return new iv({Ic:e,methodName:t,wc:a,path:tn.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ou(s){const e=s._freezeSettings(),t=qh(s._databaseId);return new OO(s._databaseId,!!e.ignoreUndefinedProperties,t)}function av(s,e,t,a,o,c={}){const d=s.bc(c.merge||c.mergeFields?2:0,e,t,o);ov("Data must be an object, but it was:",d,a);const m=wx(a,d);let g,v;if(c.merge)g=new Un(d.fieldMask),v=d.fieldTransforms;else if(c.mergeFields){const _=[];for(const T of c.mergeFields){const N=sg(e,T,t);if(!d.contains(N))throw new fe(ie.INVALID_ARGUMENT,`Field '${N}' is specified in your field mask but missing from your input data.`);Ix(_,N)||_.push(N)}g=new Un(_),v=d.fieldTransforms.filter(T=>g.covers(T.field))}else g=null,v=d.fieldTransforms;return new DO(new bn(m),g,v)}class Kh extends $h{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Kh}}class rv extends $h{_toFieldTransform(e){return new x1(e.path,new Bc)}isEqual(e){return e instanceof rv}}function Ax(s,e,t,a){const o=s.bc(1,e,t);ov("Data must be an object, but it was:",o,a);const c=[],d=bn.empty();Ia(a,(g,v)=>{const _=lv(e,g,t);v=ct(v);const T=o.mc(_);if(v instanceof Kh)c.push(_);else{const N=lu(v,T);N!=null&&(c.push(_),d.set(_,N))}});const m=new Un(c);return new Nx(d,m,o.fieldTransforms)}function Sx(s,e,t,a,o,c){const d=s.bc(1,e,t),m=[sg(e,a,t)],g=[o];if(c.length%2!=0)throw new fe(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let N=0;N<c.length;N+=2)m.push(sg(e,c[N])),g.push(c[N+1]);const v=[],_=bn.empty();for(let N=m.length-1;N>=0;--N)if(!Ix(v,m[N])){const C=m[N];let w=g[N];w=ct(w);const F=d.mc(C);if(w instanceof Kh)v.push(C);else{const A=lu(w,F);A!=null&&(v.push(C),_.set(C,A))}}const T=new Un(v);return new Nx(_,T,d.fieldTransforms)}function MO(s,e,t,a=!1){return lu(t,s.bc(a?4:3,e))}function lu(s,e){if(Cx(s=ct(s)))return ov("Unsupported field value:",e,s),wx(s,e);if(s instanceof $h)return function(a,o){if(!xx(o.Ic))throw o.gc(`${a._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${a._methodName}() is not currently supported inside arrays`);const c=a._toFieldTransform(o);c&&o.fieldTransforms.push(c)}(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(a,o){const c=[];let d=0;for(const m of a){let g=lu(m,o.fc(d));g==null&&(g={nullValue:"NULL_VALUE"}),c.push(g),d++}return{arrayValue:{values:c}}}(s,e)}return function(a,o){if((a=ct(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return b1(o.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const c=kt.fromDate(a);return{timestampValue:ph(o.serializer,c)}}if(a instanceof kt){const c=new kt(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:ph(o.serializer,c)}}if(a instanceof nv)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof Sr)return{bytesValue:K0(o.serializer,a._byteString)};if(a instanceof sn){const c=o.databaseId,d=a.firestore._databaseId;if(!d.isEqual(c))throw o.gc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:kg(a.firestore._databaseId||o.databaseId,a._key.path)}}if(a instanceof sv)return function(d,m){return{mapValue:{fields:{[E0]:{stringValue:b0},[hh]:{arrayValue:{values:d.toArray().map(v=>{if(typeof v!="number")throw m.gc("VectorValues must only contain numeric values.");return Og(m.serializer,v)})}}}}}}(a,o);throw o.gc(`Unsupported field value: ${Hh(a)}`)}(s,e)}function wx(s,e){const t={};return m0(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ia(s,(a,o)=>{const c=lu(o,e.Ac(a));c!=null&&(t[a]=c)}),{mapValue:{fields:t}}}function Cx(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof kt||s instanceof nv||s instanceof Sr||s instanceof sn||s instanceof $h||s instanceof sv)}function ov(s,e,t){if(!Cx(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const a=Hh(t);throw a==="an object"?e.gc(s+" a custom object"):e.gc(s+" "+a)}}function sg(s,e,t){if((e=ct(e))instanceof ru)return e._internalPath;if(typeof e=="string")return lv(s,e);throw bh("Field path arguments must be of type string or ",s,!1,void 0,t)}const PO=new RegExp("[~\\*/\\[\\]]");function lv(s,e,t){if(e.search(PO)>=0)throw bh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new ru(...e.split("."))._internalPath}catch{throw bh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function bh(s,e,t,a,o){const c=a&&!a.isEmpty(),d=o!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let g="";return(c||d)&&(g+=" (found",c&&(g+=` in field ${a}`),d&&(g+=` in document ${o}`),g+=")"),new fe(ie.INVALID_ARGUMENT,m+s+g)}function Ix(s,e){return s.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e,t,a,o,c){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new sn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Yh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class kO extends Th{data(){return super.data()}}function Yh(s,e){return typeof e=="string"?lv(s,e):e instanceof ru?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jx(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new fe(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cv{}class Rx extends cv{}function et(s,e,...t){let a=[];e instanceof cv&&a.push(e),a=a.concat(t),function(c){const d=c.filter(g=>g instanceof uv).length,m=c.filter(g=>g instanceof Qh).length;if(d>1||d>0&&m>0)throw new fe(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a);for(const o of a)s=o._apply(s);return s}class Qh extends Rx{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new Qh(e,t,a)}_apply(e){const t=this._parse(e);return Dx(e._query,t),new Ra(e.firestore,e.converter,Kp(e._query,t))}_parse(e){const t=ou(e.firestore);return function(c,d,m,g,v,_,T){let N;if(v.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new fe(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){wT(T,_);const w=[];for(const F of T)w.push(ST(g,c,F));N={arrayValue:{values:w}}}else N=ST(g,c,T)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||wT(T,_),N=MO(m,d,T,_==="in"||_==="not-in");return jt.create(v,_,N)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function mt(s,e,t){const a=e,o=Yh("where",s);return Qh._create(o,a,t)}class uv extends cv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new uv(e,t)}_parse(e){const t=this._queryConstraints.map(a=>a._parse(e)).filter(a=>a.getFilters().length>0);return t.length===1?t[0]:Es.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,c){let d=o;const m=c.getFlattenedFilters();for(const g of m)Dx(d,g),d=Kp(d,g)}(e._query,t),new Ra(e.firestore,e.converter,Kp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class dv extends Rx{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new dv(e,t)}_apply(e){const t=function(o,c,d){if(o.startAt!==null)throw new fe(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new fe(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new zc(c,d)}(e._query,this._field,this._direction);return new Ra(e.firestore,e.converter,function(o,c){const d=o.explicitOrderBy.concat([c]);return new nl(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function Da(s,e="asc"){const t=e,a=Yh("orderBy",s);return dv._create(a,t)}function ST(s,e,t){if(typeof(t=ct(t))=="string"){if(t==="")throw new fe(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!I0(e)&&t.indexOf("/")!==-1)throw new fe(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(rt.fromString(t));if(!be.isDocumentKey(a))throw new fe(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return Fb(s,new be(a))}if(t instanceof sn)return Fb(s,t._key);throw new fe(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hh(t)}.`)}function wT(s,e){if(!Array.isArray(s)||s.length===0)throw new fe(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Dx(s,e){const t=function(o,c){for(const d of o)for(const m of d.getFlattenedFilters())if(c.indexOf(m.op)>=0)return m.op;return null}(s.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new fe(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new fe(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Ox{convertValue(e,t="none"){switch(_a(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ya(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ne(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return Ia(e,(o,c)=>{a[o]=this.convertValue(c,t)}),a}convertVectorValue(e){var t,a,o;const c=(o=(a=(t=e.fields)===null||t===void 0?void 0:t[hh].arrayValue)===null||a===void 0?void 0:a.values)===null||o===void 0?void 0:o.map(d=>Nt(d.doubleValue));return new sv(c)}convertGeoPoint(e){return new nv(Nt(e.latitude),Nt(e.longitude))}convertArray(e,t){return(e.values||[]).map(a=>this.convertValue(a,t))}convertServerTimestamp(e,t){switch(t){case"previous":const a=Oh(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp(Uc(e));default:return null}}convertTimestamp(e){const t=va(e);return new kt(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=rt.fromString(e);Ke(ex(a),9688,{name:e});const o=new Fc(a.get(1),a.get(3)),c=new be(a.popFirst(5));return o.isEqual(t)||Ai(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hv(s,e,t){let a;return a=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,a}class VO extends Ox{constructor(e){super(),this.firestore=e}convertBytes(e){return new Sr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new sn(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fv extends Th{constructor(e,t,a,o,c,d){super(e,t,a,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Jd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(Yh("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}}class Jd extends fv{data(e={}){return super.data(e)}}class Mx{constructor(e,t,a,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Mo(o.hasPendingWrites,o.fromCache),this.query=a}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(a=>{e.call(t,new Jd(this._firestore,this._userDataWriter,a.key,a,new Mo(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new fe(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map(m=>{const g=new Jd(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Mo(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}})}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(m=>c||m.type!==3).map(m=>{const g=new Jd(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Mo(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let v=-1,_=-1;return m.type!==0&&(v=d.indexOf(m.doc.key),d=d.delete(m.doc.key)),m.type!==1&&(d=d.add(m.doc),_=d.indexOf(m.doc.key)),{type:LO(m.type),doc:g,oldIndex:v,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function LO(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ne(61501,{type:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(s){s=Nn(s,sn);const e=Nn(s.firestore,Hs);return AO(au(e),s._key).then(t=>kx(e,s,t))}class Xh extends Ox{constructor(e){super(),this.firestore=e}convertBytes(e){return new Sr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new sn(this.firestore,null,t)}}function Hn(s){s=Nn(s,Ra);const e=Nn(s.firestore,Hs),t=au(e),a=new Xh(e);return jx(s._query),SO(t,s._query).then(o=>new Mx(e,a,s,o))}function mv(s,e,t){s=Nn(s,sn);const a=Nn(s.firestore,Hs),o=hv(s.converter,e,t);return Zh(a,[av(ou(a),"setDoc",s._key,o,s.converter!==null,t).toMutation(s._key,nn.none())])}function il(s,e,t,...a){s=Nn(s,sn);const o=Nn(s.firestore,Hs),c=ou(o);let d;return d=typeof(e=ct(e))=="string"||e instanceof ru?Sx(c,"updateDoc",s._key,e,t,a):Ax(c,"updateDoc",s._key,e),Zh(o,[d.toMutation(s._key,nn.exists(!0))])}function UO(s){return Zh(Nn(s.firestore,Hs),[new Uh(s._key,nn.none())])}function Px(s,e){const t=Nn(s.firestore,Hs),a=rn(s),o=hv(s.converter,e);return Zh(t,[av(ou(s.firestore),"addDoc",a._key,o,s.converter!==null,{}).toMutation(a._key,nn.exists(!1))]).then(()=>a)}function Wh(s,...e){var t,a,o;s=ct(s);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||AT(e[d])||(c=e[d],d++);const m={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(AT(e[d])){const T=e[d];e[d]=(t=T.next)===null||t===void 0?void 0:t.bind(T),e[d+1]=(a=T.error)===null||a===void 0?void 0:a.bind(T),e[d+2]=(o=T.complete)===null||o===void 0?void 0:o.bind(T)}let g,v,_;if(s instanceof sn)v=Nn(s.firestore,Hs),_=Mh(s._key.path),g={next:T=>{e[d]&&e[d](kx(v,s,T))},error:e[d+1],complete:e[d+2]};else{const T=Nn(s,Ra);v=Nn(T.firestore,Hs),_=T._query;const N=new Xh(v);g={next:C=>{e[d]&&e[d](new Mx(v,N,T,C))},error:e[d+1],complete:e[d+2]},jx(s._query)}return function(N,C,w,F){const A=new ev(F),L=new Wg(C,A,w);return N.asyncQueue.enqueueAndForget(async()=>Yg(await Eh(N),L)),()=>{A.xu(),N.asyncQueue.enqueueAndForget(async()=>Qg(await Eh(N),L))}}(au(v),_,m,g)}function Zh(s,e){return function(a,o){const c=new qs;return a.asyncQueue.enqueueAndForget(async()=>uO(await NO(a),o,c)),c.promise}(au(s),e)}function kx(s,e,t){const a=t.docs.get(e._key),o=new Xh(s);return new fv(s,o,e._key,a,new Mo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FO={maxAttempts:5};function Tc(s,e){if((s=ct(s)).firestore!==e)throw new fe(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=ou(e)}get(e){const t=Tc(e,this._firestore),a=new VO(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return Ne(24041);const c=o[0];if(c.isFoundDocument())return new Th(this._firestore,a,c.key,c,t.converter);if(c.isNoDocument())return new Th(this._firestore,a,t._key,null,t.converter);throw Ne(18433,{doc:c})})}set(e,t,a){const o=Tc(e,this._firestore),c=hv(o.converter,t,a),d=av(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,a);return this._transaction.set(o._key,d),this}update(e,t,a,...o){const c=Tc(e,this._firestore);let d;return d=typeof(t=ct(t))=="string"||t instanceof ru?Sx(this._dataReader,"Transaction.update",c._key,t,a,o):Ax(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,d),this}delete(e){const t=Tc(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO extends qO{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Tc(e,this._firestore),a=new Xh(this._firestore);return super.get(e).then(o=>new fv(this._firestore,a,t._key,o._document,new Mo(!1,!1),t.converter))}}function Vx(s,e,t){s=Nn(s,Hs);const a=Object.assign(Object.assign({},FO),t);return function(c){if(c.maxAttempts<1)throw new fe(ie.INVALID_ARGUMENT,"Max attempts must be at least 1")}(a),function(c,d,m){const g=new qs;return c.asyncQueue.enqueueAndForget(async()=>{const v=await xO(c);new EO(c.asyncQueue,v,m,d,g).Wu()}),g.promise}(au(s),o=>e(new zO(s,o)),a)}function _s(){return new rv("serverTimestamp")}(function(e,t=!0){(function(o){Jo=o})(Rr),is(new Bn("firestore",(a,{instanceIdentifier:o,options:c})=>{const d=a.getProvider("app").getImmediate(),m=new Hs(new PR(a.getProvider("auth-internal")),new LR(d,a.getProvider("app-check-internal")),function(v,_){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new fe(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fc(v.options.projectId,_)}(d,o),d);return c=Object.assign({useFetchStreams:t},c),m._setSettings(c),m},"PUBLIC").setMultipleInstances(!0)),fn(Cb,Ib,e),fn(Cb,Ib,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lx="firebasestorage.googleapis.com",BO="storageBucket",HO=2*60*1e3,GO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s extends rs{constructor(e,t,a=0){super(bp(e),`Firebase Storage: ${t} (${bp(e)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,$s.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return bp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Gs;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Gs||(Gs={}));function bp(s){return"storage/"+s}function $O(){const s="An unknown error occurred, please check the error payload for server response.";return new $s(Gs.UNKNOWN,s)}function KO(){return new $s(Gs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function YO(){return new $s(Gs.CANCELED,"User canceled the upload/download.")}function QO(s){return new $s(Gs.INVALID_URL,"Invalid URL '"+s+"'.")}function XO(s){return new $s(Gs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function CT(s){return new $s(Gs.INVALID_ARGUMENT,s)}function Ux(){return new $s(Gs.APP_DELETED,"The Firebase app was deleted.")}function WO(s){return new $s(Gs.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let a;try{a=vs.makeFromUrl(e,t)}catch{return new vs(e,"")}if(a.path==="")return a;throw XO(e)}static makeFromUrl(e,t){let a=null;const o="([A-Za-z0-9.\\-_]+)";function c(U){U.path.charAt(U.path.length-1)==="/"&&(U.path_=U.path_.slice(0,-1))}const d="(/(.*))?$",m=new RegExp("^gs://"+o+d,"i"),g={bucket:1,path:3};function v(U){U.path_=decodeURIComponent(U.path)}const _="v[A-Za-z0-9_]+",T=t.replace(/[.]/g,"\\."),N="(/([^?#]*).*)?$",C=new RegExp(`^https?://${T}/${_}/b/${o}/o${N}`,"i"),w={bucket:1,path:3},F=t===Lx?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",L=new RegExp(`^https?://${F}/${o}/${A}`,"i"),H=[{regex:m,indices:g,postModify:c},{regex:C,indices:w,postModify:v},{regex:L,indices:{bucket:1,path:2},postModify:v}];for(let U=0;U<H.length;U++){const z=H[U],ae=z.regex.exec(e);if(ae){const O=ae[z.indices.bucket];let x=ae[z.indices.path];x||(x=""),a=new vs(O,x),z.postModify(a);break}}if(a==null)throw QO(e);return a}}class ZO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JO(s,e,t){let a=1,o=null,c=null,d=!1,m=0;function g(){return m===2}let v=!1;function _(...A){v||(v=!0,e.apply(null,A))}function T(A){o=setTimeout(()=>{o=null,s(C,g())},A)}function N(){c&&clearTimeout(c)}function C(A,...L){if(v){N();return}if(A){N(),_.call(null,A,...L);return}if(g()||d){N(),_.call(null,A,...L);return}a<64&&(a*=2);let H;m===1?(m=2,H=0):H=(a+Math.random())*1e3,T(H)}let w=!1;function F(A){w||(w=!0,N(),!v&&(o!==null?(A||(m=2),clearTimeout(o),T(0)):A||(m=1)))}return T(0),c=setTimeout(()=>{d=!0,F(!0)},t),F}function eM(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tM(s){return s!==void 0}function IT(s,e,t,a){if(a<e)throw CT(`Invalid value for '${s}'. Expected ${e} or greater.`);if(a>t)throw CT(`Invalid value for '${s}'. Expected ${t} or less.`)}function nM(s){const e=encodeURIComponent;let t="?";for(const a in s)if(s.hasOwnProperty(a)){const o=e(a)+"="+e(s[a]);t=t+o+"&"}return t=t.slice(0,-1),t}var Nh;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Nh||(Nh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sM(s,e){const t=s>=500&&s<600,o=[408,429].indexOf(s)!==-1,c=e.indexOf(s)!==-1;return t||o||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(e,t,a,o,c,d,m,g,v,_,T,N=!0,C=!1){this.url_=e,this.method_=t,this.headers_=a,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=m,this.errorCallback_=g,this.timeout_=v,this.progressCallback_=_,this.connectionFactory_=T,this.retry=N,this.isUsingEmulator=C,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,F)=>{this.resolve_=w,this.reject_=F,this.start_()})}start_(){const e=(a,o)=>{if(o){a(!1,new qd(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=m=>{const g=m.loaded,v=m.lengthComputable?m.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,v)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const m=c.getErrorCode()===Nh.NO_ERROR,g=c.getStatus();if(!m||sM(g,this.additionalRetryCodes_)&&this.retry){const _=c.getErrorCode()===Nh.ABORT;a(!1,new qd(!1,null,_));return}const v=this.successCodes_.indexOf(g)!==-1;a(!0,new qd(v,c))})},t=(a,o)=>{const c=this.resolve_,d=this.reject_,m=o.connection;if(o.wasSuccessCode)try{const g=this.callback_(m,m.getResponse());tM(g)?c(g):c()}catch(g){d(g)}else if(m!==null){const g=$O();g.serverResponse=m.getErrorText(),this.errorCallback_?d(this.errorCallback_(m,g)):d(g)}else if(o.canceled){const g=this.appDelete_?Ux():YO();d(g)}else{const g=KO();d(g)}};this.canceled_?t(!1,new qd(!1,null,!0)):this.backoffId_=JO(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&eM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class qd{constructor(e,t,a){this.wasSuccessCode=e,this.connection=t,this.canceled=!!a}}function aM(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function rM(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function oM(s,e){e&&(s["X-Firebase-GMPID"]=e)}function lM(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function cM(s,e,t,a,o,c,d=!0,m=!1){const g=nM(s.urlParams),v=s.url+g,_=Object.assign({},s.headers);return oM(_,e),aM(_,t),rM(_,c),lM(_,a),new iM(v,s.method,_,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,o,d,m)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uM(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function dM(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,t){this._service=e,t instanceof vs?this._location=t:this._location=vs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new xh(e,t)}get root(){const e=new vs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return dM(this._location.path)}get storage(){return this._service}get parent(){const e=uM(this._location.path);if(e===null)return null;const t=new vs(this._location.bucket,e);return new xh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw WO(e)}}function jT(s,e){const t=e?.[BO];return t==null?null:vs.makeFromBucketSpec(t,s)}function hM(s,e,t,a={}){s.host=`${e}:${t}`;const o=jr(e);o&&(dg(`https://${s.host}/b`),hg("Storage",!0)),s._isUsingEmulator=!0,s._protocol=o?"https":"http";const{mockUserToken:c}=a;c&&(s._overrideAuthToken=typeof c=="string"?c:pN(c,s.app.options.projectId))}class fM{constructor(e,t,a,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=a,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=Lx,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=HO,this._maxUploadRetryTime=GO,this._requests=new Set,o!=null?this._bucket=vs.makeFromBucketSpec(o,this._host):this._bucket=jT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=vs.makeFromBucketSpec(this._url,e):this._bucket=jT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){IT("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){IT("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Cn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new xh(this,e)}_makeRequest(e,t,a,o,c=!0){if(this._deleted)return new ZO(Ux());{const d=cM(e,this._appId,a,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[a,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,a,o).getPromise()}}const RT="@firebase/storage",DT="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="storage";function mM(s=Qc(),e){s=ct(s);const a=wi(s,Fx).getImmediate({identifier:e}),o=hN("storage");return o&&pM(a,...o),a}function pM(s,e,t,a={}){hM(s,e,t,a)}function gM(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),a=s.getProvider("auth-internal"),o=s.getProvider("app-check-internal");return new fM(t,a,o,e,Rr)}function vM(){is(new Bn(Fx,gM,"PUBLIC").setMultipleInstances(!0)),fn(RT,DT,""),fn(RT,DT,"esm2017")}vM();const qx="@firebase/installations",pv="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zx=1e4,Bx=`w:${pv}`,Hx="FIS_v2",yM="https://firebaseinstallations.googleapis.com/v1",_M=60*60*1e3,EM="installations",bM="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},wr=new Aa(EM,bM,TM);function Gx(s){return s instanceof rs&&s.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $x({projectId:s}){return`${yM}/projects/${s}/installations`}function Kx(s){return{token:s.token,requestStatus:2,expiresIn:xM(s.expiresIn),creationTime:Date.now()}}async function Yx(s,e){const a=(await e.json()).error;return wr.create("request-failed",{requestName:s,serverCode:a.code,serverMessage:a.message,serverStatus:a.status})}function Qx({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function NM(s,{refreshToken:e}){const t=Qx(s);return t.append("Authorization",AM(e)),t}async function Xx(s){const e=await s();return e.status>=500&&e.status<600?s():e}function xM(s){return Number(s.replace("s","000"))}function AM(s){return`${Hx} ${s}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SM({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const a=$x(s),o=Qx(s),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={fid:t,authVersion:Hx,appId:s.appId,sdkVersion:Bx},m={method:"POST",headers:o,body:JSON.stringify(d)},g=await Xx(()=>fetch(a,m));if(g.ok){const v=await g.json();return{fid:v.fid||t,registrationStatus:2,refreshToken:v.refreshToken,authToken:Kx(v.authToken)}}else throw await Yx("Create Installation",g)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(s){return new Promise(e=>{setTimeout(e,s)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wM(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CM=/^[cdef][\w-]{21}$/,ig="";function IM(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=jM(s);return CM.test(t)?t:ig}catch{return ig}}function jM(s){return wM(s).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jh(s){return`${s.appName}!${s.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx=new Map;function Jx(s,e){const t=Jh(s);eA(t,e),RM(t,e)}function eA(s,e){const t=Zx.get(s);if(t)for(const a of t)a(e)}function RM(s,e){const t=DM();t&&t.postMessage({key:s,fid:e}),OM()}let Er=null;function DM(){return!Er&&"BroadcastChannel"in self&&(Er=new BroadcastChannel("[Firebase] FID Change"),Er.onmessage=s=>{eA(s.data.key,s.data.fid)}),Er}function OM(){Zx.size===0&&Er&&(Er.close(),Er=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM="firebase-installations-database",PM=1,Cr="firebase-installations-store";let Tp=null;function gv(){return Tp||(Tp=EN(MM,PM,{upgrade:(s,e)=>{switch(e){case 0:s.createObjectStore(Cr)}}})),Tp}async function Ah(s,e){const t=Jh(s),o=(await gv()).transaction(Cr,"readwrite"),c=o.objectStore(Cr),d=await c.get(t);return await c.put(e,t),await o.done,(!d||d.fid!==e.fid)&&Jx(s,e.fid),e}async function tA(s){const e=Jh(s),a=(await gv()).transaction(Cr,"readwrite");await a.objectStore(Cr).delete(e),await a.done}async function ef(s,e){const t=Jh(s),o=(await gv()).transaction(Cr,"readwrite"),c=o.objectStore(Cr),d=await c.get(t),m=e(d);return m===void 0?await c.delete(t):await c.put(m,t),await o.done,m&&(!d||d.fid!==m.fid)&&Jx(s,m.fid),m}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vv(s){let e;const t=await ef(s.appConfig,a=>{const o=kM(a),c=VM(s,o);return e=c.registrationPromise,c.installationEntry});return t.fid===ig?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function kM(s){const e=s||{fid:IM(),registrationStatus:0};return nA(e)}function VM(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject(wr.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},a=LM(s,t);return{installationEntry:t,registrationPromise:a}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:UM(s)}:{installationEntry:e}}async function LM(s,e){try{const t=await SM(s,e);return Ah(s.appConfig,t)}catch(t){throw Gx(t)&&t.customData.serverCode===409?await tA(s.appConfig):await Ah(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function UM(s){let e=await OT(s.appConfig);for(;e.registrationStatus===1;)await Wx(100),e=await OT(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:a}=await vv(s);return a||t}return e}function OT(s){return ef(s,e=>{if(!e)throw wr.create("installation-not-found");return nA(e)})}function nA(s){return FM(s)?{fid:s.fid,registrationStatus:0}:s}function FM(s){return s.registrationStatus===1&&s.registrationTime+zx<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qM({appConfig:s,heartbeatServiceProvider:e},t){const a=zM(s,t),o=NM(s,t),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={installation:{sdkVersion:Bx,appId:s.appId}},m={method:"POST",headers:o,body:JSON.stringify(d)},g=await Xx(()=>fetch(a,m));if(g.ok){const v=await g.json();return Kx(v)}else throw await Yx("Generate Auth Token",g)}function zM(s,{fid:e}){return`${$x(s)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yv(s,e=!1){let t;const a=await ef(s.appConfig,c=>{if(!sA(c))throw wr.create("not-registered");const d=c.authToken;if(!e&&GM(d))return c;if(d.requestStatus===1)return t=BM(s,e),c;{if(!navigator.onLine)throw wr.create("app-offline");const m=KM(c);return t=HM(s,m),m}});return t?await t:a.authToken}async function BM(s,e){let t=await MT(s.appConfig);for(;t.authToken.requestStatus===1;)await Wx(100),t=await MT(s.appConfig);const a=t.authToken;return a.requestStatus===0?yv(s,e):a}function MT(s){return ef(s,e=>{if(!sA(e))throw wr.create("not-registered");const t=e.authToken;return YM(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function HM(s,e){try{const t=await qM(s,e),a=Object.assign(Object.assign({},e),{authToken:t});return await Ah(s.appConfig,a),t}catch(t){if(Gx(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await tA(s.appConfig);else{const a=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Ah(s.appConfig,a)}throw t}}function sA(s){return s!==void 0&&s.registrationStatus===2}function GM(s){return s.requestStatus===2&&!$M(s)}function $M(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+_M}function KM(s){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},s),{authToken:e})}function YM(s){return s.requestStatus===1&&s.requestTime+zx<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QM(s){const e=s,{installationEntry:t,registrationPromise:a}=await vv(e);return a?a.catch(console.error):yv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XM(s,e=!1){const t=s;return await WM(t),(await yv(t,e)).token}async function WM(s){const{registrationPromise:e}=await vv(s);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZM(s){if(!s||!s.options)throw Np("App Configuration");if(!s.name)throw Np("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw Np(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function Np(s){return wr.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA="installations",JM="installations-internal",eP=s=>{const e=s.getProvider("app").getImmediate(),t=ZM(e),a=wi(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:a,_delete:()=>Promise.resolve()}},tP=s=>{const e=s.getProvider("app").getImmediate(),t=wi(e,iA).getImmediate();return{getId:()=>QM(t),getToken:o=>XM(t,o)}};function nP(){is(new Bn(iA,eP,"PUBLIC")),is(new Bn(JM,tP,"PRIVATE"))}nP();fn(qx,pv);fn(qx,pv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh="analytics",sP="firebase_id",iP="origin",aP=60*1e3,rP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",_v="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In=new Yc("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},zn=new Aa("analytics","Analytics",oP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lP(s){if(!s.startsWith(_v)){const e=zn.create("invalid-gtag-resource",{gtagURL:s});return In.warn(e.message),""}return s}function aA(s){return Promise.all(s.map(e=>e.catch(t=>t)))}function cP(s,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(s,e)),t}function uP(s,e){const t=cP("firebase-js-sdk-policy",{createScriptURL:lP}),a=document.createElement("script"),o=`${_v}?l=${s}&id=${e}`;a.src=t?t?.createScriptURL(o):o,a.async=!0,document.head.appendChild(a)}function dP(s){let e=[];return Array.isArray(window[s])?e=window[s]:window[s]=e,e}async function hP(s,e,t,a,o,c){const d=a[o];try{if(d)await e[d];else{const g=(await aA(t)).find(v=>v.measurementId===o);g&&await e[g.appId]}}catch(m){In.error(m)}s("config",o,c)}async function fP(s,e,t,a,o){try{let c=[];if(o&&o.send_to){let d=o.send_to;Array.isArray(d)||(d=[d]);const m=await aA(t);for(const g of d){const v=m.find(T=>T.measurementId===g),_=v&&e[v.appId];if(_)c.push(_);else{c=[];break}}}c.length===0&&(c=Object.values(e)),await Promise.all(c),s("event",a,o||{})}catch(c){In.error(c)}}function mP(s,e,t,a){async function o(c,...d){try{if(c==="event"){const[m,g]=d;await fP(s,e,t,m,g)}else if(c==="config"){const[m,g]=d;await hP(s,e,t,a,m,g)}else if(c==="consent"){const[m,g]=d;s("consent",m,g)}else if(c==="get"){const[m,g,v]=d;s("get",m,g,v)}else if(c==="set"){const[m]=d;s("set",m)}else s(c,...d)}catch(m){In.error(m)}}return o}function pP(s,e,t,a,o){let c=function(...d){window[a].push(arguments)};return window[o]&&typeof window[o]=="function"&&(c=window[o]),window[o]=mP(c,s,e,t),{gtagCore:c,wrappedGtag:window[o]}}function gP(s){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(_v)&&t.src.includes(s))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vP=30,yP=1e3;class _P{constructor(e={},t=yP){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const rA=new _P;function EP(s){return new Headers({Accept:"application/json","x-goog-api-key":s})}async function bP(s){var e;const{appId:t,apiKey:a}=s,o={method:"GET",headers:EP(a)},c=rP.replace("{app-id}",t),d=await fetch(c,o);if(d.status!==200&&d.status!==304){let m="";try{const g=await d.json();!((e=g.error)===null||e===void 0)&&e.message&&(m=g.error.message)}catch{}throw zn.create("config-fetch-failed",{httpStatus:d.status,responseMessage:m})}return d.json()}async function TP(s,e=rA,t){const{appId:a,apiKey:o,measurementId:c}=s.options;if(!a)throw zn.create("no-app-id");if(!o){if(c)return{measurementId:c,appId:a};throw zn.create("no-api-key")}const d=e.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},m=new AP;return setTimeout(async()=>{m.abort()},aP),oA({appId:a,apiKey:o,measurementId:c},d,m,e)}async function oA(s,{throttleEndTimeMillis:e,backoffCount:t},a,o=rA){var c;const{appId:d,measurementId:m}=s;try{await NP(a,e)}catch(g){if(m)return In.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:d,measurementId:m};throw g}try{const g=await bP(s);return o.deleteThrottleMetadata(d),g}catch(g){const v=g;if(!xP(v)){if(o.deleteThrottleMetadata(d),m)return In.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${v?.message}]`),{appId:d,measurementId:m};throw g}const _=Number((c=v?.customData)===null||c===void 0?void 0:c.httpStatus)===503?JE(t,o.intervalMillis,vP):JE(t,o.intervalMillis),T={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return o.setThrottleMetadata(d,T),In.debug(`Calling attemptFetch again in ${_} millis`),oA(s,T,a,o)}}function NP(s,e){return new Promise((t,a)=>{const o=Math.max(e-Date.now(),0),c=setTimeout(t,o);s.addEventListener(()=>{clearTimeout(c),a(zn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function xP(s){if(!(s instanceof rs)||!s.customData)return!1;const e=Number(s.customData.httpStatus);return e===429||e===500||e===503||e===504}class AP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function SP(s,e,t,a,o){if(o&&o.global){s("event",t,a);return}else{const c=await e,d=Object.assign(Object.assign({},a),{send_to:c});s("event",t,d)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wP(){if(fg())try{await mg()}catch(s){return In.warn(zn.create("indexeddb-unavailable",{errorInfo:s?.toString()}).message),!1}else return In.warn(zn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function CP(s,e,t,a,o,c,d){var m;const g=TP(s);g.then(C=>{t[C.measurementId]=C.appId,s.options.measurementId&&C.measurementId!==s.options.measurementId&&In.warn(`The measurement ID in the local Firebase config (${s.options.measurementId}) does not match the measurement ID fetched from the server (${C.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(C=>In.error(C)),e.push(g);const v=wP().then(C=>{if(C)return a.getId()}),[_,T]=await Promise.all([g,v]);gP(c)||uP(c,_.measurementId),o("js",new Date);const N=(m=d?.config)!==null&&m!==void 0?m:{};return N[iP]="firebase",N.update=!0,T!=null&&(N[sP]=T),o("config",_.measurementId,N),_.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e){this.app=e}_delete(){return delete jc[this.app.options.appId],Promise.resolve()}}let jc={},PT=[];const kT={};let xp="dataLayer",jP="gtag",VT,lA,LT=!1;function RP(){const s=[];if(gN()&&s.push("This is a browser extension environment."),vN()||s.push("Cookies are not available."),s.length>0){const e=s.map((a,o)=>`(${o+1}) ${a}`).join(" "),t=zn.create("invalid-analytics-context",{errorInfo:e});In.warn(t.message)}}function DP(s,e,t){RP();const a=s.options.appId;if(!a)throw zn.create("no-app-id");if(!s.options.apiKey)if(s.options.measurementId)In.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${s.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw zn.create("no-api-key");if(jc[a]!=null)throw zn.create("already-exists",{id:a});if(!LT){dP(xp);const{wrappedGtag:c,gtagCore:d}=pP(jc,PT,kT,xp,jP);lA=c,VT=d,LT=!0}return jc[a]=CP(s,PT,kT,e,VT,xp,t),new IP(s)}function OP(s=Qc()){s=ct(s);const e=wi(s,Sh);return e.isInitialized()?e.getImmediate():MP(s)}function MP(s,e={}){const t=wi(s,Sh);if(t.isInitialized()){const o=t.getImmediate();if(pa(e,t.getOptions()))return o;throw zn.create("already-initialized")}return t.initialize({options:e})}function PP(s,e,t,a){s=ct(s),SP(lA,jc[s.app.options.appId],e,t,a).catch(o=>In.error(o))}const UT="@firebase/analytics",FT="0.10.16";function kP(){is(new Bn(Sh,(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return DP(a,o,t)},"PUBLIC")),is(new Bn("analytics-internal",s,"PRIVATE")),fn(UT,FT),fn(UT,FT,"esm2017");function s(e){try{const t=e.getProvider(Sh).getImmediate();return{logEvent:(a,o,c)=>PP(t,a,o,c)}}catch(t){throw zn.create("interop-component-reg-failed",{reason:t})}}}kP();var ag,qT,tf=function(){var s=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(s&&s.responseStart>0&&s.responseStart<performance.now())return s},cA=function(s){if(document.readyState==="loading")return"loading";var e=tf();if(e){if(s<e.domInteractive)return"loading";if(e.domContentLoadedEventStart===0||s<e.domContentLoadedEventStart)return"dom-interactive";if(e.domComplete===0||s<e.domComplete)return"dom-content-loaded"}return"complete"},VP=function(s){var e=s.nodeName;return s.nodeType===1?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},Ev=function(s,e){var t="";try{for(;s&&s.nodeType!==9;){var a=s,o=a.id?"#"+a.id:VP(a)+(a.classList&&a.classList.value&&a.classList.value.trim()&&a.classList.value.trim().length?"."+a.classList.value.trim().replace(/\s+/g,"."):"");if(t.length+o.length>(e||100)-1)return t||o;if(t=t?o+">"+t:o,a.id)break;s=a.parentNode}}catch{}return t},uA=-1,LP=function(){return uA},cu=function(s){addEventListener("pageshow",function(e){e.persisted&&(uA=e.timeStamp,s(e))},!0)},bv=function(){var s=tf();return s&&s.activationStart||0},Ta=function(s,e){var t=tf(),a="navigate";return LP()>=0?a="back-forward-cache":t&&(document.prerendering||bv()>0?a="prerender":document.wasDiscarded?a="restore":t.type&&(a=t.type.replace(/_/g,"-"))),{name:s,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:a}},al=function(s,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(s)){var a=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return a.observe(Object.assign({type:s,buffered:!0},t||{})),a}}catch{}},Na=function(s,e,t,a){var o,c;return function(d){e.value>=0&&(d||a)&&((c=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=c,e.rating=function(m,g){return m>g[1]?"poor":m>g[0]?"needs-improvement":"good"}(e.value,t),s(e))}},Tv=function(s){requestAnimationFrame(function(){return requestAnimationFrame(function(){return s()})})},nf=function(s){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&s()})},Nv=function(s){var e=!1;return function(){e||(s(),e=!0)}},Po=-1,zT=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},wh=function(s){document.visibilityState==="hidden"&&Po>-1&&(Po=s.type==="visibilitychange"?s.timeStamp:0,UP())},BT=function(){addEventListener("visibilitychange",wh,!0),addEventListener("prerenderingchange",wh,!0)},UP=function(){removeEventListener("visibilitychange",wh,!0),removeEventListener("prerenderingchange",wh,!0)},dA=function(){return Po<0&&(Po=zT(),BT(),cu(function(){setTimeout(function(){Po=zT(),BT()},0)})),{get firstHiddenTime(){return Po}}},xv=function(s){document.prerendering?addEventListener("prerenderingchange",function(){return s()},!0):s()},HT=[1800,3e3],FP=function(s,e){e=e||{},xv(function(){var t,a=dA(),o=Ta("FCP"),c=al("paint",function(d){d.forEach(function(m){m.name==="first-contentful-paint"&&(c.disconnect(),m.startTime<a.firstHiddenTime&&(o.value=Math.max(m.startTime-bv(),0),o.entries.push(m),t(!0)))})});c&&(t=Na(s,o,HT,e.reportAllChanges),cu(function(d){o=Ta("FCP"),t=Na(s,o,HT,e.reportAllChanges),Tv(function(){o.value=performance.now()-d.timeStamp,t(!0)})}))})},GT=[.1,.25],qP=function(s,e){(function(t,a){a=a||{},FP(Nv(function(){var o,c=Ta("CLS",0),d=0,m=[],g=function(_){_.forEach(function(T){if(!T.hadRecentInput){var N=m[0],C=m[m.length-1];d&&T.startTime-C.startTime<1e3&&T.startTime-N.startTime<5e3?(d+=T.value,m.push(T)):(d=T.value,m=[T])}}),d>c.value&&(c.value=d,c.entries=m,o())},v=al("layout-shift",g);v&&(o=Na(t,c,GT,a.reportAllChanges),nf(function(){g(v.takeRecords()),o(!0)}),cu(function(){d=0,c=Ta("CLS",0),o=Na(t,c,GT,a.reportAllChanges),Tv(function(){return o()})}),setTimeout(o,0))}))})(function(t){var a=function(o){var c,d={};if(o.entries.length){var m=o.entries.reduce(function(v,_){return v&&v.value>_.value?v:_});if(m&&m.sources&&m.sources.length){var g=(c=m.sources).find(function(v){return v.node&&v.node.nodeType===1})||c[0];g&&(d={largestShiftTarget:Ev(g.node),largestShiftTime:m.startTime,largestShiftValue:m.value,largestShiftSource:g,largestShiftEntry:m,loadState:cA(m.startTime)})}}return Object.assign(o,{attribution:d})}(t);s(a)},e)},hA=0,Ap=1/0,zd=0,zP=function(s){s.forEach(function(e){e.interactionId&&(Ap=Math.min(Ap,e.interactionId),zd=Math.max(zd,e.interactionId),hA=zd?(zd-Ap)/7+1:0)})},fA=function(){return ag?hA:performance.interactionCount||0},BP=function(){"interactionCount"in performance||ag||(ag=al("event",zP,{type:"event",buffered:!0,durationThreshold:0}))},ms=[],Rc=new Map,mA=0,HP=function(){var s=Math.min(ms.length-1,Math.floor((fA()-mA)/50));return ms[s]},pA=[],GP=function(s){if(pA.forEach(function(o){return o(s)}),s.interactionId||s.entryType==="first-input"){var e=ms[ms.length-1],t=Rc.get(s.interactionId);if(t||ms.length<10||s.duration>e.latency){if(t)s.duration>t.latency?(t.entries=[s],t.latency=s.duration):s.duration===t.latency&&s.startTime===t.entries[0].startTime&&t.entries.push(s);else{var a={id:s.interactionId,latency:s.duration,entries:[s]};Rc.set(a.id,a),ms.push(a)}ms.sort(function(o,c){return c.latency-o.latency}),ms.length>10&&ms.splice(10).forEach(function(o){return Rc.delete(o.id)})}}},Av=function(s){var e=self.requestIdleCallback||self.setTimeout,t=-1;return s=Nv(s),document.visibilityState==="hidden"?s():(t=e(s),nf(s)),t},$T=[200,500],$P=function(s,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},xv(function(){var t;BP();var a,o=Ta("INP"),c=function(m){Av(function(){m.forEach(GP);var g=HP();g&&g.latency!==o.value&&(o.value=g.latency,o.entries=g.entries,a())})},d=al("event",c,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});a=Na(s,o,$T,e.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),nf(function(){c(d.takeRecords()),a(!0)}),cu(function(){mA=fA(),ms.length=0,Rc.clear(),o=Ta("INP"),a=Na(s,o,$T,e.reportAllChanges)}))}))},qo=[],ca=[],rg=0,Sv=new WeakMap,zo=new Map,og=-1,KP=function(s){qo=qo.concat(s),gA()},gA=function(){og<0&&(og=Av(YP))},YP=function(){zo.size>10&&zo.forEach(function(d,m){Rc.has(m)||zo.delete(m)});var s=ms.map(function(d){return Sv.get(d.entries[0])}),e=ca.length-50;ca=ca.filter(function(d,m){return m>=e||s.includes(d)});for(var t=new Set,a=0;a<ca.length;a++){var o=ca[a];vA(o.startTime,o.processingEnd).forEach(function(d){t.add(d)})}var c=qo.length-1-50;qo=qo.filter(function(d,m){return d.startTime>rg&&m>c||t.has(d)}),og=-1};pA.push(function(s){s.interactionId&&s.target&&!zo.has(s.interactionId)&&zo.set(s.interactionId,s.target)},function(s){var e,t=s.startTime+s.duration;rg=Math.max(rg,s.processingEnd);for(var a=ca.length-1;a>=0;a--){var o=ca[a];if(Math.abs(t-o.renderTime)<=8){(e=o).startTime=Math.min(s.startTime,e.startTime),e.processingStart=Math.min(s.processingStart,e.processingStart),e.processingEnd=Math.max(s.processingEnd,e.processingEnd),e.entries.push(s);break}}e||(e={startTime:s.startTime,processingStart:s.processingStart,processingEnd:s.processingEnd,renderTime:t,entries:[s]},ca.push(e)),(s.interactionId||s.entryType==="first-input")&&Sv.set(s,e),gA()});var vA=function(s,e){for(var t,a=[],o=0;t=qo[o];o++)if(!(t.startTime+t.duration<s)){if(t.startTime>e)break;a.push(t)}return a},QP=function(s,e){qT||(qT=al("long-animation-frame",KP)),$P(function(t){var a=function(o){var c=o.entries[0],d=Sv.get(c),m=c.processingStart,g=d.processingEnd,v=d.entries.sort(function(A,L){return A.processingStart-L.processingStart}),_=vA(c.startTime,g),T=o.entries.find(function(A){return A.target}),N=T&&T.target||zo.get(c.interactionId),C=[c.startTime+c.duration,g].concat(_.map(function(A){return A.startTime+A.duration})),w=Math.max.apply(Math,C),F={interactionTarget:Ev(N),interactionTargetElement:N,interactionType:c.name.startsWith("key")?"keyboard":"pointer",interactionTime:c.startTime,nextPaintTime:w,processedEventEntries:v,longAnimationFrameEntries:_,inputDelay:m-c.startTime,processingDuration:g-m,presentationDelay:Math.max(w-g,0),loadState:cA(c.startTime)};return Object.assign(o,{attribution:F})}(t);s(a)},e)},KT=[2500,4e3],Sp={},XP=function(s,e){(function(t,a){a=a||{},xv(function(){var o,c=dA(),d=Ta("LCP"),m=function(_){a.reportAllChanges||(_=_.slice(-1)),_.forEach(function(T){T.startTime<c.firstHiddenTime&&(d.value=Math.max(T.startTime-bv(),0),d.entries=[T],o())})},g=al("largest-contentful-paint",m);if(g){o=Na(t,d,KT,a.reportAllChanges);var v=Nv(function(){Sp[d.id]||(m(g.takeRecords()),g.disconnect(),Sp[d.id]=!0,o(!0))});["keydown","click"].forEach(function(_){addEventListener(_,function(){return Av(v)},{once:!0,capture:!0})}),nf(v),cu(function(_){d=Ta("LCP"),o=Na(t,d,KT,a.reportAllChanges),Tv(function(){d.value=performance.now()-_.timeStamp,Sp[d.id]=!0,o(!0)})})}})})(function(t){var a=function(o){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:o.value};if(o.entries.length){var d=tf();if(d){var m=d.activationStart||0,g=o.entries[o.entries.length-1],v=g.url&&performance.getEntriesByType("resource").filter(function(w){return w.name===g.url})[0],_=Math.max(0,d.responseStart-m),T=Math.max(_,v?(v.requestStart||v.startTime)-m:0),N=Math.max(T,v?v.responseEnd-m:0),C=Math.max(N,g.startTime-m);c={element:Ev(g.element),timeToFirstByte:_,resourceLoadDelay:T-_,resourceLoadDuration:N-T,elementRenderDelay:C-N,navigationEntry:d,lcpEntry:g},g.url&&(c.url=g.url),v&&(c.lcpResourceEntry=v)}}return Object.assign(o,{attribution:c})}(t);s(a)},e)};const YT="@firebase/performance",lg="0.7.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA=lg,WP="FB-PERF-TRACE-START",ZP="FB-PERF-TRACE-STOP",cg="FB-PERF-TRACE-MEASURE",_A="_wt_",EA="_fp",bA="_fcp",TA="_fid",NA="_lcp",JP="lcp_element",xA="_inp",ek="inp_interactionTarget",AA="_cls",tk="cls_largestShiftTarget",SA="@firebase/performance/config",wA="@firebase/performance/configexpire",nk="performance",CA="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sk={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},hn=new Aa(nk,CA,sk);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xa=new Yc(CA);xa.logLevel=Ue.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wp,IA;class Lt{constructor(e){if(this.window=e,!e)throw hn.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=XP,this.onINP=QP,this.onCLS=qP}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,t,a){!this.performance||!this.performance.measure||this.performance.measure(e,t,a)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!vN()?(xa.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):fg()?!0:(xa.info("IndexedDB is not supported by current browser"),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(o=>{for(const c of o.getEntries())t(c)}).observe({entryTypes:[e]})}static getInstance(){return wp===void 0&&(wp=new Lt(IA)),wp}}function ik(s){IA=s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jA;function ak(s){const e=s.getId();return e.then(t=>{jA=t}),e}function wv(){return jA}function rk(s){const e=s.getToken();return e.then(t=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QT(s,e){const t=s.length-e.length;if(t<0||t>1)throw hn.create("invalid String merger input");const a=[];for(let o=0;o<s.length;o++)a.push(s.charAt(o)),e.length>o&&a.push(e.charAt(o));return a.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cp;class Fn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=QT("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=QT("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Cp===void 0&&(Cp=new Fn),Cp}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dc;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.VISIBLE=1]="VISIBLE",s[s.HIDDEN=2]="HIDDEN"})(Dc||(Dc={}));const ok=["firebase_","google_","ga_"],lk=new RegExp("^[a-zA-Z]\\w*$"),ck=40,uk=100;function dk(){const s=Lt.getInstance().navigator;return s?.serviceWorker?s.serviceWorker.controller?2:3:1}function hk(){switch(Lt.getInstance().document.visibilityState){case"visible":return Dc.VISIBLE;case"hidden":return Dc.HIDDEN;default:return Dc.UNKNOWN}}function fk(){const e=Lt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function mk(s){return s.length===0||s.length>ck?!1:!ok.some(t=>s.startsWith(t))&&!!s.match(lk)}function pk(s){return s.length!==0&&s.length<=uk}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RA(s){var e;const t=(e=s.options)===null||e===void 0?void 0:e.appId;if(!t)throw hn.create("no app id");return t}function gk(s){var e;const t=(e=s.options)===null||e===void 0?void 0:e.projectId;if(!t)throw hn.create("no project id");return t}function vk(s){var e;const t=(e=s.options)===null||e===void 0?void 0:e.apiKey;if(!t)throw hn.create("no api key");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk="0.0.1",fs={loggingEnabled:!0},_k="FIREBASE_INSTALLATIONS_AUTH";function Ek(s,e){const t=bk();return t?(XT(t),Promise.resolve()):xk(s,e).then(XT).then(a=>Tk(a),()=>{})}function bk(){const s=Lt.getInstance().localStorage;if(!s)return;const e=s.getItem(wA);if(!e||!Ak(e))return;const t=s.getItem(SA);if(t)try{return JSON.parse(t)}catch{return}}function Tk(s){const e=Lt.getInstance().localStorage;!s||!e||(e.setItem(SA,JSON.stringify(s)),e.setItem(wA,String(Date.now()+Fn.getInstance().configTimeToLive*60*60*1e3)))}const Nk="Could not fetch config, will use default configs";function xk(s,e){return rk(s.installations).then(t=>{const a=gk(s.app),o=vk(s.app),c=`https://firebaseremoteconfig.googleapis.com/v1/projects/${a}/namespaces/fireperf:fetch?key=${o}`,d=new Request(c,{method:"POST",headers:{Authorization:`${_k} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:RA(s.app),app_version:yA,sdk_version:yk})});return fetch(d).then(m=>{if(m.ok)return m.json();throw hn.create("RC response not ok")})}).catch(()=>{xa.info(Nk)})}function XT(s){if(!s)return s;const e=Fn.getInstance(),t=s.entries||{};return t.fpr_enabled!==void 0?e.loggingEnabled=String(t.fpr_enabled)==="true":e.loggingEnabled=fs.loggingEnabled,t.fpr_log_source?e.logSource=Number(t.fpr_log_source):fs.logSource&&(e.logSource=fs.logSource),t.fpr_log_endpoint_url?e.logEndPointUrl=t.fpr_log_endpoint_url:fs.logEndPointUrl&&(e.logEndPointUrl=fs.logEndPointUrl),t.fpr_log_transport_key?e.transportKey=t.fpr_log_transport_key:fs.transportKey&&(e.transportKey=fs.transportKey),t.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(t.fpr_vc_network_request_sampling_rate):fs.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=fs.networkRequestsSamplingRate),t.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(t.fpr_vc_trace_sampling_rate):fs.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=fs.tracesSamplingRate),e.logTraceAfterSampling=WT(e.tracesSamplingRate),e.logNetworkAfterSampling=WT(e.networkRequestsSamplingRate),s}function Ak(s){return Number(s)>Date.now()}function WT(s){return Math.random()<=s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cv=1,Ip;function DA(s){return Cv=2,Ip=Ip||wk(s),Ip}function Sk(){return Cv===3}function wk(s){return Ck().then(()=>ak(s.installations)).then(e=>Ek(s,e)).then(()=>ZT(),()=>ZT())}function Ck(){const s=Lt.getInstance().document;return new Promise(e=>{if(s&&s.readyState!=="complete"){const t=()=>{s.readyState==="complete"&&(s.removeEventListener("readystatechange",t),e())};s.addEventListener("readystatechange",t)}else e()})}function ZT(){Cv=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OA=10*1e3,Ik=5.5*1e3,jk=1e3,MA=3;let eh=MA,br=[],JT=!1;function Rk(){JT||(Iv(Ik),JT=!0)}function Iv(s){setTimeout(()=>{eh<=0||(br.length>0&&PA(),Iv(OA))},s)}function PA(){const s=br.splice(0,jk),e=s.map(a=>({source_extension_json_proto3:a.message,event_time_ms:String(a.eventTime)})),t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Fn.getInstance().logSource,log_event:e};Dk(t).then(()=>{eh=MA}).catch(()=>{br=[...s,...br],eh--,xa.info(`Tries left: ${eh}.`),Iv(OA)})}function Dk(s){const e=Fn.getInstance().getFlTransportFullUrl(),t=JSON.stringify(s);return navigator.sendBeacon&&navigator.sendBeacon(e,t)?Promise.resolve():fetch(e,{method:"POST",body:t,keepalive:!0}).then()}function Ok(s){if(!s.eventTime||!s.message)throw hn.create("invalid cc log");br=[...br,s]}function Mk(s){return(...e)=>{const t=s(...e);Ok({message:t,eventTime:Date.now()})}}function Pk(){for(;br.length>0;)PA()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oc;function kA(s,e){Oc||(Oc={send:Mk(Lk),flush:Pk}),Oc.send(s,e)}function Bd(s){const e=Fn.getInstance();!e.instrumentationEnabled&&s.isAuto||!e.dataCollectionEnabled&&!s.isAuto||Lt.getInstance().requiredApisAvailable()&&(Sk()?jp(s):DA(s.performanceController).then(()=>jp(s),()=>jp(s)))}function kk(){Oc&&Oc.flush()}function jp(s){if(!wv())return;const e=Fn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||kA(s,1)}function Vk(s){const e=Fn.getInstance();if(!e.instrumentationEnabled)return;const t=s.url,a=e.logEndPointUrl.split("?")[0],o=e.flTransportEndpointUrl.split("?")[0];t===a||t===o||!e.loggingEnabled||!e.logNetworkAfterSampling||kA(s,0)}function Lk(s,e){return e===0?Uk(s):Fk(s)}function Uk(s){const e={url:s.url,http_method:s.httpMethod||0,http_response_code:200,response_payload_bytes:s.responsePayloadBytes,client_start_time_us:s.startTimeUs,time_to_response_initiated_us:s.timeToResponseInitiatedUs,time_to_response_completed_us:s.timeToResponseCompletedUs},t={application_info:VA(s.performanceController.app),network_request_metric:e};return JSON.stringify(t)}function Fk(s){const e={name:s.name,is_auto:s.isAuto,client_start_time_us:s.startTimeUs,duration_us:s.durationUs};Object.keys(s.counters).length!==0&&(e.counters=s.counters);const t=s.getAttributes();Object.keys(t).length!==0&&(e.custom_attributes=t);const a={application_info:VA(s.performanceController.app),trace_metric:e};return JSON.stringify(a)}function VA(s){return{google_app_id:RA(s),app_instance_id:wv(),web_app_info:{sdk_version:yA,page_url:Lt.getInstance().getUrl(),service_worker_status:dk(),visibility_state:hk(),effective_connection_type:fk()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eN(s,e){const t=e;if(!t||t.responseStart===void 0)return;const a=Lt.getInstance().getTimeOrigin(),o=Math.floor((t.startTime+a)*1e3),c=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,d=Math.floor((t.responseEnd-t.startTime)*1e3),m=t.name&&t.name.split("?")[0],g={performanceController:s,url:m,responsePayloadBytes:t.transferSize,startTimeUs:o,timeToResponseInitiatedUs:c,timeToResponseCompletedUs:d};Vk(g)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qk=100,zk="_",Bk=[EA,bA,TA,NA,AA,xA];function Hk(s,e){return s.length===0||s.length>qk?!1:e&&e.startsWith(_A)&&Bk.indexOf(s)>-1||!s.startsWith(zk)}function Gk(s){const e=Math.floor(s);return e<s&&xa.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,t,a=!1,o){this.performanceController=e,this.name=t,this.isAuto=a,this.state=1,this.customAttributes={},this.counters={},this.api=Lt.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${WP}-${this.randomId}-${this.name}`,this.traceStopMark=`${ZP}-${this.randomId}-${this.name}`,this.traceMeasure=o||`${cg}-${this.randomId}-${this.name}`,o&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw hn.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw hn.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Bd(this)}record(e,t,a){if(e<=0)throw hn.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw hn.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(t*1e3),this.startTimeUs=Math.floor(e*1e3),a&&a.attributes&&(this.customAttributes=Object.assign({},a.attributes)),a&&a.metrics)for(const o of Object.keys(a.metrics))isNaN(Number(a.metrics[o]))||(this.counters[o]=Math.floor(Number(a.metrics[o])));Bd(this)}incrementMetric(e,t=1){this.counters[e]===void 0?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(Hk(e,this.name))this.counters[e]=Gk(t??0);else throw hn.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const a=mk(e),o=pk(t);if(a&&o){this.customAttributes[e]=t;return}if(!a)throw hn.create("invalid attribute name",{attributeName:e});if(!o)throw hn.create("invalid attribute value",{attributeValue:t})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(t.duration*1e3),this.startTimeUs=Math.floor((t.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,t,a,o,c){const d=Lt.getInstance().getUrl();if(!d)return;const m=new $c(e,_A+d,!0),g=Math.floor(Lt.getInstance().getTimeOrigin()*1e3);m.setStartTime(g),t&&t[0]&&(m.setDuration(Math.floor(t[0].duration*1e3)),m.putMetric("domInteractive",Math.floor(t[0].domInteractive*1e3)),m.putMetric("domContentLoadedEventEnd",Math.floor(t[0].domContentLoadedEventEnd*1e3)),m.putMetric("loadEventEnd",Math.floor(t[0].loadEventEnd*1e3)));const v="first-paint",_="first-contentful-paint";if(a){const T=a.find(C=>C.name===v);T&&T.startTime&&m.putMetric(EA,Math.floor(T.startTime*1e3));const N=a.find(C=>C.name===_);N&&N.startTime&&m.putMetric(bA,Math.floor(N.startTime*1e3)),c&&m.putMetric(TA,Math.floor(c*1e3))}this.addWebVitalMetric(m,NA,JP,o.lcp),this.addWebVitalMetric(m,AA,tk,o.cls),this.addWebVitalMetric(m,xA,ek,o.inp),Bd(m),kk()}static addWebVitalMetric(e,t,a,o){o&&(e.putMetric(t,Math.floor(o.value*1e3)),o.elementAttribution&&e.putAttribute(a,o.elementAttribution))}static createUserTimingTrace(e,t){const a=new $c(e,t,!1,t);Bd(a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let th={},tN=!1,LA;function nN(s){wv()&&(setTimeout(()=>Kk(s),0),setTimeout(()=>$k(s),0),setTimeout(()=>Yk(s),0))}function $k(s){const e=Lt.getInstance(),t=e.getEntriesByType("resource");for(const a of t)eN(s,a);e.setupObserver("resource",a=>eN(s,a))}function Kk(s){const e=Lt.getInstance();"onpagehide"in window?e.document.addEventListener("pagehide",()=>Rp(s)):e.document.addEventListener("unload",()=>Rp(s)),e.document.addEventListener("visibilitychange",()=>{e.document.visibilityState==="hidden"&&Rp(s)}),e.onFirstInputDelay&&e.onFirstInputDelay(t=>{LA=t}),e.onLCP(t=>{var a;th.lcp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.element}}),e.onCLS(t=>{var a;th.cls={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.largestShiftTarget}}),e.onINP(t=>{var a;th.inp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.interactionTarget}})}function Yk(s){const e=Lt.getInstance(),t=e.getEntriesByType("measure");for(const a of t)sN(s,a);e.setupObserver("measure",a=>sN(s,a))}function sN(s,e){const t=e.name;t.substring(0,cg.length)!==cg&&$c.createUserTimingTrace(s,t)}function Rp(s){if(!tN){tN=!0;const e=Lt.getInstance(),t=e.getEntriesByType("navigation"),a=e.getEntriesByType("paint");setTimeout(()=>{$c.createOobTrace(s,t,a,th,LA)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(e?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),e?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),Lt.getInstance().requiredApisAvailable()?mg().then(t=>{t&&(Rk(),DA(this).then(()=>nN(this),()=>nN(this)),this.initialized=!0)}).catch(t=>{xa.info(`Environment doesn't support IndexedDB: ${t}`)}):xa.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Fn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Fn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Fn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Fn.getInstance().dataCollectionEnabled}}const Xk="[DEFAULT]";function Wk(s=Qc()){return s=ct(s),wi(s,"performance").getImmediate()}const Zk=(s,{options:e})=>{const t=s.getProvider("app").getImmediate(),a=s.getProvider("installations-internal").getImmediate();if(t.name!==Xk)throw hn.create("FB not default");if(typeof window>"u")throw hn.create("no window");ik(window);const o=new Qk(t,a);return o._init(e),o};function Jk(){is(new Bn("performance",Zk,"PUBLIC")),fn(YT,lg),fn(YT,lg,"esm2017")}Jk();const e2={apiKey:"AIzaSyCbU834quCY8hjSffRwljJLgZrcxK8i2F4",authDomain:"liquidacionapp-62962.firebaseapp.com",projectId:"liquidacionapp-62962",storageBucket:"liquidacionapp-62962.firebasestorage.app",messagingSenderId:"851382130132",appId:"1:851382130132:web:eaba38fab449f14fb5b241"},uu=bN(e2);typeof window<"u"&&OP(uu);typeof window<"u"&&Wk(uu);const Mc=IR(uu),Fe=IO(uu);mM(uu);const ps={ADMIN:"admin",CONTADOR:"contador",CLIENTE:"cliente"},ht={MANAGE_INVENTORY:"canManageInventory",CREATE_MOVEMENTS:"canCreateMovements",VIEW_ALL_MOVEMENTS:"canViewAllMovements",MANAGE_VEHICLES:"canManageVehicles",MANAGE_SUPPLIERS:"canManageSuppliers",VIEW_REPORTS:"canViewReports",EXPORT_REPORTS:"canExportReports",MODIFY_SETTINGS:"canModifySettings"},t2="contacto.evert@gmail.com",UA=s=>{switch(s){case ps.ADMIN:return{[ht.MANAGE_INVENTORY]:!0,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!0,[ht.MANAGE_VEHICLES]:!0,[ht.MANAGE_SUPPLIERS]:!0,[ht.VIEW_REPORTS]:!0,[ht.EXPORT_REPORTS]:!0,[ht.MODIFY_SETTINGS]:!0};case ps.CONTADOR:return{[ht.MANAGE_INVENTORY]:!0,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!0,[ht.MANAGE_VEHICLES]:!1,[ht.MANAGE_SUPPLIERS]:!1,[ht.VIEW_REPORTS]:!0,[ht.EXPORT_REPORTS]:!0,[ht.MODIFY_SETTINGS]:!1};case ps.CLIENTE:default:return{[ht.MANAGE_INVENTORY]:!1,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!1,[ht.MANAGE_VEHICLES]:!1,[ht.MANAGE_SUPPLIERS]:!1,[ht.VIEW_REPORTS]:!1,[ht.EXPORT_REPORTS]:!1,[ht.MODIFY_SETTINGS]:!1}}},n2=s=>s===t2?ps.ADMIN:ps.CLIENTE,Qo=()=>"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/invitations",s2=()=>{const s="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let e="";for(let t=0;t<8;t++)e+=s.charAt(Math.floor(Math.random()*s.length));return e},i2=async(s,e)=>{try{const t=await sf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden crear invitaciones"};let a,o=!1,c=0;for(;!o&&c<10;){a=s2();const g=et(xt(Fe,Qo()),mt("code","==",a));(await Hn(g)).empty&&(o=!0),c++}if(!o)return{success:!1,error:"No se pudo generar un código único"};const d=rn(xt(Fe,Qo())),m={code:a,targetEmail:s.email.toLowerCase(),targetRole:s.role||ps.CLIENTE,targetName:s.name||"",status:"pending",appContext:"combustibles",expiresAt:new Date(Date.now()+7*24*60*60*1e3),createdAt:_s(),createdBy:e,usedAt:null,usedBy:null};return await mv(d,m),console.log("🎫 Invitación creada:",{code:a,email:s.email,role:s.role}),{success:!0,invitation:{id:d.id,code:a,...m}}}catch(t){return console.error("Error creating invitation:",t),{success:!1,error:t.message}}},FA=async s=>{try{const e=et(xt(Fe,Qo()),mt("code","==",s.toUpperCase()),mt("status","==","pending")),t=await Hn(e);if(t.empty)return{success:!1,error:"Código de invitación inválido o expirado"};const a=t.docs[0],o=a.data(),c=new Date,d=o.expiresAt.toDate();return c>d?{success:!1,error:"Código de invitación expirado"}:{success:!0,invitation:{id:a.id,...o}}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},a2=async(s,e)=>{try{const t=rn(Fe,Qo(),s);return await il(t,{status:"used",usedAt:_s(),usedBy:e}),{success:!0}}catch(t){return console.error("Error marking invitation as used:",t),{success:!1,error:t.message}}},r2=async s=>{try{const e=await sf(s);if(!e.success||e.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden ver invitaciones"};const t=et(xt(Fe,Qo())),a=await Hn(t),o=[];return a.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,d)=>{const m=c.createdAt?.toDate()||new Date(0);return(d.createdAt?.toDate()||new Date(0))-m}),{success:!0,invitations:o}}catch(e){return console.error("Error getting invitations:",e),{success:!1,error:e.message}}},o2=async(s,e)=>{try{const t=await sf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden cancelar invitaciones"};const a=rn(Fe,Qo(),s);return await il(a,{status:"cancelled",cancelledAt:_s(),cancelledBy:e}),{success:!0}}catch(t){return console.error("Error cancelling invitation:",t),{success:!1,error:t.message}}},l2=s=>UA(s.targetRole),qA=async(s,e={})=>{const t=rn(Fe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",s.uid);try{const a=await Mr(t);if(a.exists())return{success:!0,userData:a.data(),isNewUser:!1};{const o=n2(s.email),c={uid:s.uid,email:s.email,displayName:s.displayName||"",photoURL:s.photoURL||"",role:o,emailVerified:s.emailVerified,combustiblesPermissions:UA(o),createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...e};return await mv(t,c),{success:!0,userData:c,isNewUser:!0}}}catch(a){return console.error("Error creating/updating user profile:",a),{success:!1,error:a.message}}},iN=async(s,e,t={})=>{const a=rn(Fe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",s.uid);try{const o=await Mr(a);if(o.exists())return{success:!0,userData:o.data(),isNewUser:!1};const c=await FA(e);if(!c.success)return c;const d=c.invitation;if(d.targetEmail!==s.email.toLowerCase())return{success:!1,error:"El código de invitación no corresponde a este email"};const m={uid:s.uid,email:s.email,displayName:s.displayName||d.targetName||"",photoURL:s.photoURL||"",role:d.targetRole,emailVerified:s.emailVerified,combustiblesPermissions:l2(d),invitationUsed:d.id,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...t};return await mv(a,m),await a2(d.id,s.uid),console.log("👤 Usuario creado con invitación:",{email:s.email,role:d.targetRole,invitationCode:d.code}),{success:!0,userData:m,isNewUser:!0}}catch(o){return console.error("Error creating user profile with invitation:",o),{success:!1,error:o.message}}},sf=async s=>{try{const e=rn(Fe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",s),t=await Mr(e);return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"Usuario no encontrado"}}catch(e){return console.error("Error fetching user profile:",e),{success:!1,error:e.message}}},zA=J.createContext(),Ci=()=>{const s=J.useContext(zA);if(s===void 0)throw new Error("useCombustibles must be used within a CombustiblesProvider");return s},c2=({children:s})=>{const[e,t]=J.useState(null),[a,o]=J.useState(null),[c,d]=J.useState(!0),[m,g]=J.useState(null),[v,_]=J.useState([]),[T,N]=J.useState([]),[C,w]=J.useState([]),[F,A]=J.useState([]);J.useEffect(()=>{const j=vj(Mc,async R=>{try{if(d(!0),R){t(R);let P=await sf(R.uid);P.success||(P=await qA(R,{provider:"existing_account",appContext:"combustibles"})),P.success?o(P.userData):g("Error cargando perfil de usuario")}else t(null),o(null),_([]),N([]),w([]),A([])}catch(P){console.error("Error en autenticación:",P),g("Error de autenticación")}finally{d(!1)}});return()=>j()},[]);const x={user:e,userProfile:a,loading:c,error:m,hasPermission:j=>a?.combustiblesPermissions?.[j]||!1,isAdmin:()=>a?.role==="admin",isCounterOrAbove:()=>a?.role==="admin"||a?.role==="contador",inventory:v,movements:T,vehicles:C,suppliers:F,setInventory:_,setMovements:N,setVehicles:w,setSuppliers:A,refreshInventory:async()=>{console.log("Refrescando inventario...")},refreshMovements:async()=>{console.log("Refrescando movimientos...")},refreshVehicles:async()=>{console.log("Refrescando vehículos...")},refreshSuppliers:async()=>{console.log("Refrescando proveedores...")}};return l.jsx(zA.Provider,{value:x,children:s})},u2=({children:s,currentView:e,onViewChange:t})=>{const{userProfile:a,isAdmin:o,isCounterOrAbove:c}=Ci(),[d,m]=J.useState(!1),g=[{id:"dashboard",name:"Dashboard",icon:"📊",description:"Vista general",requiredPermission:null},{id:"inventory",name:"Inventario",icon:"🛢️",description:"Gestión de stock",requiredPermission:"canManageInventory"},{id:"movements",name:"Movimientos",icon:"📈",description:"Entradas y salidas",requiredPermission:"canCreateMovements"},{id:"vehicles",name:"Vehículos",icon:"🚜",description:"Maquinaria forestal",requiredPermission:null},{id:"suppliers",name:"Proveedores",icon:"🏪",description:"Gestión de proveedores",requiredPermission:"canManageSuppliers"},{id:"reports",name:"Reportes",icon:"📋",description:"Análisis y reportes",requiredPermission:"canViewReports"},{id:"admin",name:"Administración",icon:"⚙️",description:"Gestión de usuarios",requiredPermission:"admin"}],v=C=>{t(C),m(!1)},_=C=>C?C==="admin"?o():a?.combustiblesPermissions?.[C]||!1:!0,T=g.filter(C=>_(C.requiredPermission)),N=async()=>{try{await yj(Mc)}catch(C){console.error("Error al cerrar sesión:",C)}};return l.jsxs("div",{className:"dashboard-layout",children:[l.jsx("header",{className:"dashboard-header",children:l.jsxs("div",{className:"header-content",children:[l.jsx("button",{className:"sidebar-toggle",onClick:()=>m(!d),children:"☰"}),l.jsxs("div",{className:"header-title",children:[l.jsx("h1",{children:"⛽ Gestión de Combustibles"}),l.jsx("span",{className:"subtitle",children:"Forestech Colombia"})]}),l.jsxs("div",{className:"header-user",children:[l.jsxs("div",{className:"user-info",children:[l.jsx("span",{className:"user-name",children:a?.displayName||a?.email}),l.jsx("span",{className:"user-role",children:a?.role})]}),l.jsx("div",{className:"user-avatar",children:a?.photoURL?l.jsx("img",{src:a.photoURL,alt:"Avatar"}):l.jsx("div",{className:"avatar-placeholder",children:(a?.displayName||a?.email||"U").charAt(0).toUpperCase()})}),l.jsx("button",{className:"logout-button",onClick:N,title:"Cerrar sesión",children:"🚪"})]})]})}),l.jsxs("div",{className:"dashboard-body",children:[l.jsxs("aside",{className:`dashboard-sidebar ${d?"open":""}`,children:[l.jsx("nav",{className:"sidebar-nav",children:T.map(C=>l.jsxs("button",{className:`nav-item ${e===C.id?"active":""}`,onClick:()=>v(C.id),children:[l.jsx("span",{className:"nav-icon",children:C.icon}),l.jsxs("div",{className:"nav-content",children:[l.jsx("span",{className:"nav-name",children:C.name}),l.jsx("span",{className:"nav-description",children:C.description})]})]},C.id))}),l.jsx("div",{className:"sidebar-footer",children:l.jsxs("div",{className:"user-permissions",children:[l.jsx("h4",{children:"Permisos Activos:"}),l.jsxs("div",{className:"permission-list",children:[o()&&l.jsx("span",{className:"permission admin",children:"👑 Administrador"}),c()&&l.jsx("span",{className:"permission counter",children:"📊 Gestión Operativa"}),_("canManageInventory")&&l.jsx("span",{className:"permission",children:"🛢️ Inventario"}),_("canManageVehicles")&&l.jsx("span",{className:"permission",children:"🚜 Vehículos"})]})]})})]}),l.jsx("main",{className:"dashboard-main",children:l.jsx("div",{className:"main-content",children:s})})]}),d&&l.jsx("div",{className:"sidebar-overlay",onClick:()=>m(!1)})]})},En={DIESEL:"diesel",GASOLINE:"gasoline",ACPM:"acpm",LUBRICANTS:"lubricants",TWO_STROKE:"two_stroke",MIXED:"mixed"},Xo={[En.DIESEL]:{name:"Diésel",description:"Combustible para maquinaria pesada",unit:"galones",category:"Combustible",color:"#fbbf24",icon:"🚛",density:.85,priceUnit:"COP/galón"},[En.GASOLINE]:{name:"Gasolina",description:"Combustible para vehículos livianos",unit:"galones",category:"Combustible",color:"#ef4444",icon:"⛽",density:.75,priceUnit:"COP/galón"},[En.ACPM]:{name:"ACPM",description:"Aceite Combustible Para Motor",unit:"galones",category:"Combustible",color:"#8b5cf6",icon:"🚜",density:.85,priceUnit:"COP/galón"},[En.LUBRICANTS]:{name:"Lubricantes",description:"Aceites y lubricantes para mantenimiento",unit:"litros",category:"Mantenimiento",color:"#06b6d4",icon:"🛢️",density:.9,priceUnit:"COP/litro"},[En.TWO_STROKE]:{name:"Mezcla 2T",description:"Mezcla para motores de 2 tiempos (motosierras)",unit:"litros",category:"Especializado",color:"#10b981",icon:"🪚",density:.78,priceUnit:"COP/litro"},[En.MIXED]:{name:"Mixto",description:"Compatible con múltiples tipos de combustible",unit:"galones",category:"Flexible",color:"#64748b",icon:"🔄",density:.8,priceUnit:"COP/galón"}},_n={CRITICAL:"critical",LOW:"low",MEDIUM:"medium",HIGH:"high",FULL:"full"},ko={[_n.CRITICAL]:{label:"Crítico",color:"#dc2626",icon:"🚨",threshold:.1},[_n.LOW]:{label:"Bajo",color:"#ea580c",icon:"⚠️",threshold:.25},[_n.MEDIUM]:{label:"Medio",color:"#ca8a04",icon:"📊",threshold:.5},[_n.HIGH]:{label:"Alto",color:"#16a34a",icon:"✅",threshold:.75},[_n.FULL]:{label:"Completo",color:"#059669",icon:"🟢",threshold:1}},BA=(s,e)=>{if(e===0)return _n.CRITICAL;const t=s/e;return t<ko[_n.CRITICAL].threshold?_n.CRITICAL:t<ko[_n.LOW].threshold?_n.LOW:t<ko[_n.MEDIUM].threshold?_n.MEDIUM:t<ko[_n.HIGH].threshold?_n.HIGH:_n.FULL},Wo="combustibles_inventory",d2=async(s,e)=>{try{const t=Xo[s.fuelType];if(!t)return{success:!1,error:"Tipo de combustible no válido"};const a=et(xt(Fe,Wo),mt("fuelType","==",s.fuelType),mt("location","==",s.location));if(!(await Hn(a)).empty)return{success:!1,error:`Ya existe ${t.name} en ${s.location}`};const c={fuelType:s.fuelType,name:t.name,description:s.description||t.description,currentStock:Number(s.currentStock)||0,maxCapacity:Number(s.maxCapacity),minThreshold:Number(s.minThreshold)||s.maxCapacity*.15,unit:t.unit,location:s.location,pricePerUnit:Number(s.pricePerUnit)||0,supplier:s.supplier||"",status:s.status||"active",createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await Px(xt(Fe,Wo),c)).id,...c},message:`${t.name} agregado al inventario exitosamente`}}catch(t){return console.error("Error creating inventory item:",t),{success:!1,error:t.message}}},HA=async()=>{try{const s=et(xt(Fe,Wo),Da("fuelType","asc")),e=await Hn(s),t=[];return e.forEach(a=>{const o=a.data();t.push({id:a.id,...o,stockLevel:BA(o.currentStock,o.maxCapacity),stockPercentage:Math.round(o.currentStock/o.maxCapacity*100),needsRestock:o.currentStock<=o.minThreshold})}),{success:!0,data:t}}catch(s){return console.error("Error fetching inventory items:",s),{success:!1,error:s.message}}},h2=async(s,e,t)=>{try{const a=rn(Fe,Wo,s);if(!(await Mr(a)).exists())return{success:!1,error:"Item no encontrado"};const c={...e,lastUpdated:new Date,updatedBy:t};return delete c.id,delete c.createdAt,delete c.createdBy,await il(a,c),{success:!0,message:"Item actualizado exitosamente",data:{id:s,...c}}}catch(a){return console.error("Error updating inventory item:",a),{success:!1,error:a.message}}},f2=async s=>{try{const e=rn(Fe,Wo,s);return(await Mr(e)).exists()?(await UO(e),{success:!0,message:"Item eliminado exitosamente"}):{success:!1,error:"Item no encontrado"}}catch(e){return console.error("Error deleting inventory item:",e),{success:!1,error:e.message}}},GA=s=>{const e=et(xt(Fe,Wo),Da("fuelType","asc"));return Wh(e,t=>{const a=[];t.forEach(o=>{const c=o.data();a.push({id:o.id,...c,stockLevel:BA(c.currentStock,c.maxCapacity),stockPercentage:Math.round(c.currentStock/c.maxCapacity*100),needsRestock:c.currentStock<=c.minThreshold})}),s(a)},t=>{console.error("Error in inventory subscription:",t),s(null,t)})},m2=async()=>{try{const s=await HA();if(!s.success)return s;const e=s.data,t={totalItems:e.length,activeItems:e.filter(a=>a.status==="active").length,lowStockItems:e.filter(a=>a.needsRestock).length,totalValue:e.reduce((a,o)=>a+o.currentStock*o.pricePerUnit,0),averageStockLevel:e.length>0?Math.round(e.reduce((a,o)=>a+o.stockPercentage,0)/e.length):0,byFuelType:{}};return e.forEach(a=>{t.byFuelType[a.fuelType]||(t.byFuelType[a.fuelType]={count:0,totalStock:0,totalCapacity:0,totalValue:0}),t.byFuelType[a.fuelType].count++,t.byFuelType[a.fuelType].totalStock+=a.currentStock,t.byFuelType[a.fuelType].totalCapacity+=a.maxCapacity,t.byFuelType[a.fuelType].totalValue+=a.currentStock*a.pricePerUnit}),{success:!0,data:t}}catch(s){return console.error("Error calculating inventory stats:",s),{success:!1,error:s.message}}},rl="combustibles_movements",aN="combustibles_inventory",Ee={ENTRADA:"entrada",SALIDA:"salida",TRANSFERENCIA:"transferencia",AJUSTE:"ajuste"},qe={PENDIENTE:"pendiente",COMPLETADO:"completado",CANCELADO:"cancelado"},p2=async s=>{try{E2(s);const e={...s,createdAt:_s(),updatedAt:_s(),status:qe.PENDIENTE,totalValue:YA(s),effectiveDate:s.effectiveDate||_s()},t=await Vx(Fe,async a=>{const o=rn(xt(Fe,rl));return a.set(o,e),await QA(a,e,o.id),o.id});return console.log("✅ Movimiento creado exitosamente:",t),t}catch(e){throw console.error("❌ Error al crear movimiento:",e),new Error(`Error al crear movimiento: ${e.message}`)}},g2=async(s={})=>{try{let e=xt(Fe,rl);s.type&&(e=et(e,mt("type","==",s.type))),s.status&&(e=et(e,mt("status","==",s.status))),s.fuelType&&(e=et(e,mt("fuelType","==",s.fuelType))),s.vehicleId&&(e=et(e,mt("vehicleId","==",s.vehicleId))),e=et(e,Da("createdAt","desc"));const t=await Hn(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,effectiveDate:o.data().effectiveDate?.toDate?.()||o.data().effectiveDate})}),a}catch(e){throw console.error("❌ Error al obtener movimientos:",e),new Error(`Error al obtener movimientos: ${e.message}`)}},v2=async s=>{try{if(!s)throw new Error("ID de movimiento requerido");const e=rn(Fe,rl,s),t=await Mr(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate?.()||t.data().createdAt,updatedAt:t.data().updatedAt?.toDate?.()||t.data().updatedAt,effectiveDate:t.data().effectiveDate?.toDate?.()||t.data().effectiveDate}:null}catch(e){throw console.error("❌ Error al obtener movimiento:",e),new Error(`Error al obtener movimiento: ${e.message}`)}},$A=async(s,e)=>{try{if(!s)throw new Error("ID de movimiento requerido");const t={...e,updatedAt:_s(),...e.quantity||e.unitPrice?{totalValue:YA(e)}:{}},a=rn(Fe,rl,s);await il(a,t),console.log("✅ Movimiento actualizado exitosamente")}catch(t){throw console.error("❌ Error al actualizar movimiento:",t),new Error(`Error al actualizar movimiento: ${t.message}`)}},KA=(s,e={})=>{try{let t=xt(Fe,rl);return e.type&&(t=et(t,mt("type","==",e.type))),e.status&&(t=et(t,mt("status","==",e.status))),t=et(t,Da("createdAt","desc")),Wh(t,a=>{const o=[];a.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,effectiveDate:c.data().effectiveDate?.toDate?.()||c.data().effectiveDate})}),s(o)},a=>{console.error("❌ Error en suscripción de movimientos:",a),s([],a)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},y2=async s=>{try{const e=await v2(s);if(!e)throw new Error("Movimiento no encontrado");if(e.status!==qe.PENDIENTE)throw new Error("Solo se pueden aprobar movimientos pendientes");await Vx(Fe,async t=>{const a=rn(Fe,rl,s);t.update(a,{status:qe.COMPLETADO,approvedAt:_s(),updatedAt:_s()}),await QA(t,e,s)}),console.log("✅ Movimiento aprobado exitosamente")}catch(e){throw console.error("❌ Error al aprobar movimiento:",e),new Error(`Error al aprobar movimiento: ${e.message}`)}},_2=async(s={})=>{try{const e=await g2(s),t={totalMovements:e.length,byType:{},byStatus:{},byFuelType:{},totalValue:0,totalQuantity:0,averageValue:0,thisMonth:0,lastMonth:0,thisWeek:0},a=new Date,o=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()-1,1),d=new Date(a.setDate(a.getDate()-a.getDay()));return e.forEach(m=>{t.byType[m.type]=(t.byType[m.type]||0)+1,t.byStatus[m.status]=(t.byStatus[m.status]||0)+1,t.byFuelType[m.fuelType]=(t.byFuelType[m.fuelType]||0)+1,t.totalValue+=m.totalValue||0,t.totalQuantity+=m.quantity||0;const g=new Date(m.createdAt);g>=o&&t.thisMonth++,g>=c&&g<o&&t.lastMonth++,g>=d&&t.thisWeek++}),t.averageValue=t.totalMovements>0?t.totalValue/t.totalMovements:0,t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},E2=s=>{const e=["type","fuelType","quantity","unitPrice"];for(const t of e)if(!s[t])throw new Error(`Campo requerido: ${t}`);if(!Object.values(Ee).includes(s.type))throw new Error("Tipo de movimiento inválido");if(s.quantity<=0)throw new Error("La cantidad debe ser mayor a cero");if(s.unitPrice<0)throw new Error("El precio unitario no puede ser negativo");if(s.type===Ee.SALIDA&&!s.vehicleId)throw new Error("Las salidas deben tener un vehículo asociado");if(s.type===Ee.TRANSFERENCIA&&!s.destinationLocation)throw new Error("Las transferencias deben tener una ubicación destino")},YA=s=>(s.quantity||0)*(s.unitPrice||0),QA=async(s,e,t)=>{try{const a=et(xt(Fe,aN),mt("fuelType","==",e.fuelType),mt("location","==",e.location||"principal")),o=await Hn(a);if(o.empty)throw new Error(`No se encontró inventario para ${e.fuelType} en ${e.location||"ubicación principal"}`);const c=o.docs[0],d=c.data(),m=rn(Fe,aN,c.id);let g=d.currentStock;switch(e.type){case Ee.ENTRADA:g+=e.quantity;break;case Ee.SALIDA:if(g-=e.quantity,g<0)throw new Error("Stock insuficiente para realizar la salida");break;case Ee.AJUSTE:g+=e.quantity,g<0&&(g=0);break;case Ee.TRANSFERENCIA:if(g-=e.quantity,g<0)throw new Error("Stock insuficiente para realizar la transferencia");break}s.update(m,{currentStock:g,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:_s()},updatedAt:_s()})}catch(a){throw console.error("❌ Error al actualizar inventario:",a),a}},XA="combustibles_vehicles",ve={EXCAVADORA:"excavadora",BULLDOZER:"bulldozer",CARGADOR:"cargador",CAMION:"camion",GRUA:"grua",MOTOSIERRA:"motosierra",TRACTOR:"tractor",VOLQUETA:"volqueta",OTROS:"otros"},Re={ACTIVO:"activo",MANTENIMIENTO:"mantenimiento",INACTIVO:"inactivo",REPARACION:"reparacion"},_t={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},WA=async(s={})=>{try{let e=xt(Fe,XA);s.type&&(e=et(e,mt("type","==",s.type))),s.status&&(e=et(e,mt("status","==",s.status))),s.fuelType&&(e=et(e,mt("fuelType","==",s.fuelType))),s.location&&(e=et(e,mt("currentLocation","==",s.location))),e=et(e,Da("vehicleId","asc"));const t=await Hn(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,lastMovementDate:o.data().lastMovementDate?.toDate?.()||o.data().lastMovementDate,lastMaintenanceDate:o.data().lastMaintenanceDate?.toDate?.()||o.data().lastMaintenanceDate})}),a}catch(e){throw console.error("❌ Error al obtener vehículos:",e),new Error(`Error al obtener vehículos: ${e.message}`)}},ZA=(s,e={})=>{try{let t=xt(Fe,XA);return e.type&&(t=et(t,mt("type","==",e.type))),e.status&&(t=et(t,mt("status","==",e.status))),t=et(t,Da("vehicleId","asc")),Wh(t,a=>{const o=[];a.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,lastMovementDate:c.data().lastMovementDate?.toDate?.()||c.data().lastMovementDate,lastMaintenanceDate:c.data().lastMaintenanceDate?.toDate?.()||c.data().lastMaintenanceDate})}),s(o)},a=>{console.error("❌ Error en suscripción de vehículos:",a),s([],a)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},b2=async(s={})=>{try{const e=await WA(s),t={totalVehicles:e.length,byType:{},byStatus:{},byFuelType:{},totalFuelConsumed:0,totalHoursWorked:0,averageConsumption:0,mostActiveVehicle:null,leastActiveVehicle:null};let a=0,o=1/0;return e.forEach(c=>{t.byType[c.type]=(t.byType[c.type]||0)+1,t.byStatus[c.status]=(t.byStatus[c.status]||0)+1,t.byFuelType[c.fuelType]=(t.byFuelType[c.fuelType]||0)+1,t.totalFuelConsumed+=c.totalFuelConsumed||0,t.totalHoursWorked+=c.totalHoursWorked||0;const d=c.totalMovements||0;d>a&&(a=d,t.mostActiveVehicle=c),d<o&&d>0&&(o=d,t.leastActiveVehicle=c)}),t.totalHoursWorked>0&&(t.averageConsumption=t.totalFuelConsumed/t.totalHoursWorked),t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},rN=()=>{const[s,e]=J.useState({totalFuel:0,activeVehicles:0,pendingMovements:0,lowStockAlerts:0}),[t,a]=J.useState([]),[o,c]=J.useState(!0),[d,m]=J.useState(null),[g,v]=J.useState({inventory:!1,movements:!1,vehicles:!1});J.useEffect(()=>{c(!0),m(null);const N=GA(F=>{const A=F.reduce((W,H)=>W+(H.currentStock||0),0),L=F.filter(W=>(W.currentStock||0)<(W.minThreshold||0)).length;e(W=>({...W,totalFuel:A,lowStockAlerts:L})),v(W=>({...W,inventory:!0}))}),C=KA(F=>{const A=F.filter(W=>W.status==="pending").length,L=F.sort((W,H)=>H.date.toMillis()-W.date.toMillis()).slice(0,5);e(W=>({...W,pendingMovements:A})),a(L),v(W=>({...W,movements:!0}))},F=>{console.error("Error loading movements:",F),m("Error cargando movimientos")}),w=ZA(F=>{const A=F.filter(L=>L.status==="active").length;e(L=>({...L,activeVehicles:A})),v(L=>({...L,vehicles:!0}))},F=>{console.error("Error loading vehicles:",F),m("Error cargando vehículos")});return()=>{N(),C(),w()}},[]),J.useEffect(()=>{Object.values(g).every(C=>C)&&c(!1)},[g]);const _=J.useMemo(()=>N=>new Intl.NumberFormat("es-CO").format(N),[]),T=N=>{switch(N.type){case"entry":return`Entrada de ${N.quantity} ${N.unit} de ${N.fuelType}.`;case"exit":return`Salida de ${N.quantity} ${N.unit} para vehículo ${N.vehicleId||"N/A"}.`;case"transfer":return`Transferencia de ${N.quantity} ${N.unit} de ${N.fromLocation} a ${N.toLocation}.`;case"adjustment":return`Ajuste de inventario: ${N.quantity} ${N.unit} de ${N.fuelType}.`;default:return"Movimiento registrado."}};return o?l.jsxs("div",{className:"dashboard-main",children:[l.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),l.jsx("p",{className:"dashboard-subtitle",children:"Cargando datos en tiempo real..."}),l.jsx("div",{className:"loading-spinner-container",children:l.jsx("div",{className:"loading-spinner"})})]}):d?l.jsxs("div",{className:"dashboard-main",children:[l.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),l.jsxs("div",{className:"error-message",children:[l.jsxs("p",{children:["⚠️ ",d]}),l.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})]}):l.jsxs("div",{className:"dashboard-main",children:[l.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),l.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del estado de combustibles y maquinaria."}),l.jsxs("div",{className:"stats-grid",children:[l.jsxs("div",{className:"stat-card",children:[l.jsx("div",{className:"stat-icon fuel-icon",children:"🛢️"}),l.jsxs("div",{className:"stat-info",children:[l.jsx("p",{children:"Combustible Total"}),l.jsxs("h2",{children:[_(s.totalFuel)," gal"]})]})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("div",{className:"stat-icon vehicle-icon",children:"🚜"}),l.jsxs("div",{className:"stat-info",children:[l.jsx("p",{children:"Vehículos Activos"}),l.jsx("h2",{children:_(s.activeVehicles)})]})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("div",{className:"stat-icon movement-icon",children:"🔄"}),l.jsxs("div",{className:"stat-info",children:[l.jsx("p",{children:"Movimientos Pendientes"}),l.jsx("h2",{children:_(s.pendingMovements)})]})]}),l.jsxs("div",{className:`stat-card ${s.lowStockAlerts>0?"alert":""}`,children:[l.jsx("div",{className:"stat-icon alert-icon",children:"⚠️"}),l.jsxs("div",{className:"stat-info",children:[l.jsx("p",{children:"Alertas de Stock"}),l.jsx("h2",{children:_(s.lowStockAlerts)})]})]})]}),l.jsxs("div",{className:"dashboard-content",children:[l.jsxs("div",{className:"dashboard-widget",children:[l.jsx("h3",{children:"Actividad Reciente"}),t.length>0?l.jsx("ul",{children:t.map(N=>l.jsxs("li",{children:[l.jsx("span",{className:`movement-type-badge ${N.type}`,children:N.type}),T(N),l.jsx("span",{className:"movement-date",children:N.date.toDate().toLocaleDateString()})]},N.id))}):l.jsx("p",{children:"No hay movimientos recientes."})]}),l.jsxs("div",{className:"dashboard-widget",children:[l.jsx("h3",{children:"Consumo por Tipo de Combustible"}),l.jsx("div",{className:"chart-placeholder",children:l.jsx("p",{children:"Gráfico de consumo próximamente"})})]})]})]})},T2=({items:s,onEdit:e,onDelete:t,canManage:a})=>{const[o,c]=J.useState("name"),[d,m]=J.useState("asc"),g=w=>new Intl.NumberFormat("es-CO").format(w),v=w=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(w),_=w=>{const A=new Date-new Date(w.seconds?w.seconds*1e3:w),L=Math.floor(A/(1e3*60*60)),W=Math.floor(L/24);return W>0?`${W}d`:L>0?`${L}h`:"ahora"},T=w=>{o===w?m(d==="asc"?"desc":"asc"):(c(w),m("asc"))},N=[...s].sort((w,F)=>{let A=w[o],L=F[o];return o==="lastUpdated"&&(A=new Date(A.seconds?A.seconds*1e3:A),L=new Date(L.seconds?L.seconds*1e3:L)),A<L?d==="asc"?-1:1:A>L?d==="asc"?1:-1:0}),C=w=>o!==w?"↕️":d==="asc"?"↑":"↓";return l.jsxs("div",{className:"inventory-table-container",children:[l.jsx("div",{className:"table-wrapper",children:l.jsxs("table",{className:"inventory-table",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsxs("th",{onClick:()=>T("name"),className:"sortable",children:["Combustible ",C("name")]}),l.jsxs("th",{onClick:()=>T("location"),className:"sortable",children:["Ubicación ",C("location")]}),l.jsxs("th",{onClick:()=>T("currentStock"),className:"sortable",children:["Stock Actual ",C("currentStock")]}),l.jsxs("th",{onClick:()=>T("stockPercentage"),className:"sortable",children:["Nivel ",C("stockPercentage")]}),l.jsxs("th",{onClick:()=>T("pricePerUnit"),className:"sortable",children:["Precio ",C("pricePerUnit")]}),l.jsx("th",{children:"Valor Total"}),l.jsxs("th",{onClick:()=>T("status"),className:"sortable",children:["Estado ",C("status")]}),l.jsxs("th",{onClick:()=>T("lastUpdated"),className:"sortable",children:["Actualizado ",C("lastUpdated")]}),a&&l.jsx("th",{children:"Acciones"})]})}),l.jsx("tbody",{children:N.map(w=>{const F=Xo[w.fuelType],A=ko[w.stockLevel],L=w.currentStock*w.pricePerUnit;return l.jsxs("tr",{className:w.needsRestock?"needs-restock":"",children:[l.jsx("td",{className:"fuel-cell",children:l.jsxs("div",{className:"fuel-info",children:[l.jsx("span",{className:"fuel-icon",style:{color:F?.color},children:F?.icon}),l.jsxs("div",{children:[l.jsx("div",{className:"fuel-name",children:F?.name}),l.jsx("div",{className:"fuel-type",children:w.fuelType})]})]})}),l.jsx("td",{children:w.location}),l.jsxs("td",{className:"stock-cell",children:[l.jsxs("div",{className:"stock-info",children:[l.jsx("span",{className:"stock-amount",children:g(w.currentStock)}),l.jsxs("span",{className:"stock-unit",children:["/ ",g(w.maxCapacity)," ",w.unit]})]}),w.needsRestock&&l.jsx("div",{className:"restock-indicator",children:"⚠️ Bajo mínimo"})]}),l.jsx("td",{className:"level-cell",children:l.jsxs("div",{className:"level-info",children:[l.jsxs("div",{className:"level-badge",style:{backgroundColor:A?.color,color:"white"},children:[w.stockPercentage,"%"]}),l.jsx("div",{className:"level-bar",children:l.jsx("div",{className:"level-fill",style:{width:`${w.stockPercentage}%`,backgroundColor:A?.color}})})]})}),l.jsx("td",{className:"price-cell",children:l.jsxs("div",{className:"price-info",children:[l.jsx("span",{className:"price-amount",children:v(w.pricePerUnit)}),l.jsxs("span",{className:"price-unit",children:["/ ",w.unit]})]})}),l.jsx("td",{className:"value-cell",children:l.jsx("span",{className:"total-value",children:v(L)})}),l.jsx("td",{className:"status-cell",children:l.jsxs("span",{className:`status-badge ${w.status}`,children:[l.jsx("span",{className:"status-dot"}),w.status==="active"?"Activo":w.status==="inactive"?"Inactivo":w.status==="maintenance"?"Mantenimiento":w.status]})}),l.jsx("td",{className:"updated-cell",children:l.jsx("span",{className:"time-ago",children:_(w.lastUpdated)})}),a&&l.jsx("td",{className:"actions-cell",children:l.jsxs("div",{className:"action-buttons",children:[l.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(w),title:"Editar",children:"✏️"}),l.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(w),title:"Eliminar",children:"🗑️"})]})})]},w.id)})})]})}),l.jsxs("div",{className:"table-footer",children:[l.jsxs("div",{className:"table-info",children:[N.length," items ordenados por ",o,"(",d==="asc"?"ascendente":"descendente",")"]}),l.jsxs("div",{className:"table-legend",children:[l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-dot critical"}),"Crítico"]}),l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-dot low"}),"Bajo"]}),l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-dot normal"}),"Normal"]}),l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},N2=({items:s,onEdit:e,onDelete:t,canManage:a})=>{const o=m=>new Intl.NumberFormat("es-CO").format(m),c=m=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(m),d=m=>{const v=new Date-new Date(m.seconds?m.seconds*1e3:m),_=Math.floor(v/(1e3*60*60)),T=Math.floor(_/24);return T>0?`hace ${T} día${T>1?"s":""}`:_>0?`hace ${_} hora${_>1?"s":""}`:"hace unos minutos"};return l.jsx("div",{className:"inventory-cards-grid",children:s.map(m=>{const g=Xo[m.fuelType],v=ko[m.stockLevel],_=m.currentStock*m.pricePerUnit;return l.jsxs("div",{className:"inventory-card",children:[l.jsxs("div",{className:"card-header",children:[l.jsxs("div",{className:"fuel-info",children:[l.jsx("span",{className:"fuel-icon",style:{color:g?.color},children:g?.icon}),l.jsxs("div",{className:"fuel-details",children:[l.jsx("h3",{children:g?.name}),l.jsx("p",{className:"location",children:m.location})]})]}),l.jsx("div",{className:"stock-status",children:l.jsxs("span",{className:"status-badge",style:{backgroundColor:v?.color,color:"white"},children:[v?.icon," ",v?.label]})})]}),l.jsxs("div",{className:"stock-progress",children:[l.jsxs("div",{className:"progress-header",children:[l.jsxs("span",{className:"stock-text",children:[o(m.currentStock)," / ",o(m.maxCapacity)," ",m.unit]}),l.jsxs("span",{className:"percentage",children:[m.stockPercentage,"%"]})]}),l.jsx("div",{className:"progress-bar",children:l.jsx("div",{className:"progress-fill",style:{width:`${m.stockPercentage}%`,backgroundColor:v?.color}})}),m.needsRestock&&l.jsxs("div",{className:"restock-warning",children:["⚠️ Bajo nivel mínimo (",o(m.minThreshold)," ",m.unit,")"]})]}),l.jsxs("div",{className:"card-metrics",children:[l.jsxs("div",{className:"metric",children:[l.jsxs("span",{className:"metric-label",children:["Precio por ",m.unit,":"]}),l.jsx("span",{className:"metric-value",children:c(m.pricePerUnit)})]}),l.jsxs("div",{className:"metric",children:[l.jsx("span",{className:"metric-label",children:"Valor total:"}),l.jsx("span",{className:"metric-value",children:c(_)})]}),m.supplier&&l.jsxs("div",{className:"metric",children:[l.jsx("span",{className:"metric-label",children:"Proveedor:"}),l.jsx("span",{className:"metric-value",children:m.supplier})]})]}),l.jsxs("div",{className:"card-footer",children:[l.jsxs("div",{className:"status-info",children:[l.jsx("span",{className:`status-dot ${m.status}`}),l.jsx("span",{className:"status-text",children:m.status==="active"?"Activo":m.status==="inactive"?"Inactivo":m.status==="maintenance"?"Mantenimiento":m.status})]}),l.jsxs("div",{className:"last-update",children:["Actualizado ",d(m.lastUpdated)]})]}),a&&l.jsxs("div",{className:"card-actions",children:[l.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>e(m),title:"Editar combustible",children:"✏️ Editar"}),l.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>t(m),title:"Eliminar combustible",children:"🗑️ Eliminar"})]}),m.description&&m.description!==g?.description&&l.jsx("div",{className:"card-description",children:l.jsx("p",{children:m.description})})]},m.id)})})},x2=({item:s,onClose:e,onSuccess:t})=>{const{userProfile:a}=Ci(),o=!!s,[c,d]=J.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[m,g]=J.useState({}),[v,_]=J.useState(!1);J.useEffect(()=>{o&&s&&d({fuelType:s.fuelType||"",location:s.location||"",currentStock:s.currentStock||"",maxCapacity:s.maxCapacity||"",minThreshold:s.minThreshold||"",pricePerUnit:s.pricePerUnit||"",supplier:s.supplier||"",description:s.description||"",status:s.status||"active"})},[o,s]),J.useEffect(()=>{if(c.maxCapacity&&!c.minThreshold){const F=Math.round(Number(c.maxCapacity)*.15);d(A=>({...A,minThreshold:F}))}},[c.maxCapacity]);const T=F=>{const{name:A,value:L}=F.target;d(W=>({...W,[A]:L})),m[A]&&g(W=>({...W,[A]:null}))},N=()=>{const F={};c.fuelType||(F.fuelType="Tipo de combustible es requerido"),c.location||(F.location="Ubicación es requerida"),c.maxCapacity||(F.maxCapacity="Capacidad máxima es requerida");const A=Number(c.currentStock),L=Number(c.maxCapacity),W=Number(c.minThreshold),H=Number(c.pricePerUnit);return c.currentStock&&(isNaN(A)||A<0)&&(F.currentStock="Stock actual debe ser un número válido mayor o igual a 0"),c.maxCapacity&&(isNaN(L)||L<=0)&&(F.maxCapacity="Capacidad máxima debe ser un número válido mayor a 0"),c.minThreshold&&(isNaN(W)||W<0)&&(F.minThreshold="Umbral mínimo debe ser un número válido mayor o igual a 0"),c.pricePerUnit&&(isNaN(H)||H<0)&&(F.pricePerUnit="Precio debe ser un número válido mayor o igual a 0"),A>L&&(F.currentStock="Stock actual no puede ser mayor a la capacidad máxima"),W>L&&(F.minThreshold="Umbral mínimo no puede ser mayor a la capacidad máxima"),g(F),Object.keys(F).length===0},C=async F=>{if(F.preventDefault(),!!N()){_(!0);try{let A;o?A=await h2(s.id,{location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid):A=await d2({fuelType:c.fuelType,location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid),A.success?(alert(A.message),t()):alert(`Error: ${A.error}`)}catch(A){console.error("Error saving inventory item:",A),alert("Error inesperado al guardar el item")}finally{_(!1)}}},w=Xo[c.fuelType];return l.jsx("div",{className:"modal-overlay",onClick:e,children:l.jsxs("div",{className:"modal-content inventory-modal",onClick:F=>F.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h2",{children:o?"✏️ Editar Combustible":"➕ Agregar Nuevo Combustible"}),l.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),l.jsxs("form",{onSubmit:C,className:"modal-form",children:[l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",w&&l.jsxs("span",{className:"fuel-preview",children:[w.icon," ",w.name]})]}),l.jsxs("select",{id:"fuelType",name:"fuelType",value:c.fuelType,onChange:T,disabled:o,className:m.fuelType?"error":"",required:!0,children:[l.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(En).map(([F,A])=>{const L=Xo[A];return l.jsxs("option",{value:A,children:[L.icon," ",L.name," (",L.unit,")"]},F)})]}),m.fuelType&&l.jsx("span",{className:"error-text",children:m.fuelType})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"location",children:"Ubicación / Tanque *"}),l.jsx("input",{type:"text",id:"location",name:"location",value:c.location,onChange:T,placeholder:"ej. Tanque Principal, Depósito A, Bodega Norte",className:m.location?"error":"",required:!0}),m.location&&l.jsx("span",{className:"error-text",children:m.location})]}),l.jsxs("div",{className:"form-group",children:[l.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",w&&`(${w.unit})`]}),l.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:c.currentStock,onChange:T,placeholder:"0",min:"0",step:"0.01",className:m.currentStock?"error":""}),m.currentStock&&l.jsx("span",{className:"error-text",children:m.currentStock})]}),l.jsxs("div",{className:"form-group",children:[l.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad Máxima * ",w&&`(${w.unit})`]}),l.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:c.maxCapacity,onChange:T,placeholder:"1000",min:"1",step:"0.01",className:m.maxCapacity?"error":"",required:!0}),m.maxCapacity&&l.jsx("span",{className:"error-text",children:m.maxCapacity})]}),l.jsxs("div",{className:"form-group",children:[l.jsxs("label",{htmlFor:"minThreshold",children:["Umbral Mínimo ",w&&`(${w.unit})`,l.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),l.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:c.minThreshold,onChange:T,placeholder:"Auto: 15% de capacidad máxima",min:"0",step:"0.01",className:m.minThreshold?"error":""}),m.minThreshold&&l.jsx("span",{className:"error-text",children:m.minThreshold}),c.maxCapacity&&l.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(c.maxCapacity)*.15)," ",w?.unit||"unidades"]})]}),l.jsxs("div",{className:"form-group",children:[l.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",w?.unit||"Unidad"]}),l.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:c.pricePerUnit,onChange:T,placeholder:"12000",min:"0",step:"0.01",className:m.pricePerUnit?"error":""}),m.pricePerUnit&&l.jsx("span",{className:"error-text",children:m.pricePerUnit})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),l.jsx("input",{type:"text",id:"supplier",name:"supplier",value:c.supplier,onChange:T,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"status",children:"Estado"}),l.jsxs("select",{id:"status",name:"status",value:c.status,onChange:T,children:[l.jsx("option",{value:"active",children:"Activo"}),l.jsx("option",{value:"inactive",children:"Inactivo"}),l.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),l.jsxs("div",{className:"form-group full-width",children:[l.jsx("label",{htmlFor:"description",children:"Descripción / Notas"}),l.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:T,placeholder:"Información adicional sobre este combustible...",rows:"3"})]})]}),w&&c.maxCapacity&&l.jsxs("div",{className:"form-preview",children:[l.jsx("h4",{children:"📊 Vista Previa"}),l.jsxs("div",{className:"preview-card",children:[l.jsxs("div",{className:"preview-header",children:[l.jsxs("span",{style:{color:w.color},children:[w.icon," ",w.name]}),l.jsx("span",{children:c.location})]}),l.jsxs("div",{className:"preview-capacity",children:[c.currentStock||0," / ",c.maxCapacity," ",w.unit,c.currentStock&&c.maxCapacity&&l.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(c.currentStock)/Number(c.maxCapacity)*100),"%)"]})]}),c.pricePerUnit&&l.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(c.currentStock)||0)*Number(c.pricePerUnit))]})]})]}),l.jsxs("div",{className:"modal-actions",children:[l.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Cancelar"}),l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v,children:v?"Guardando...":o?"Actualizar":"Crear"})]})]})]})})},oN=(s,e=[])=>{if(!s||!s.fuelType||!s.quantity)return{isValid:!1,error:"Datos de movimiento incompletos",availableStock:0,requiredStock:0};const{fuelType:t,quantity:a,type:o,sourceLocation:c}=s,d=parseFloat(a)||0;if(o!=="outbound"&&o!=="transfer")return{isValid:!0,message:"Movimiento no requiere validación de stock",availableStock:0,requiredStock:d};const m=e.filter(_=>_.fuelType===t&&_.location===c&&_.status==="active").reduce((_,T)=>_+(parseFloat(T.quantity)||0),0),g=m>=d,v=m-d;return{isValid:g,availableStock:m,requiredStock:d,remainingStock:v,fuelType:t,location:c,error:g?null:`Stock insuficiente. Disponible: ${m}, Requerido: ${d}`,warning:v<m*.2&&v>=0?"Stock quedará bajo después del movimiento":null}},Ir=s=>typeof s!="number"||isNaN(s)?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),Tn=(s,e=2)=>typeof s!="number"||isNaN(s)?"0":new Intl.NumberFormat("es-CO",{minimumFractionDigits:e,maximumFractionDigits:e}).format(s),gr=(s,e=1)=>typeof s!="number"||isNaN(s)?"0%":`${(s*100).toFixed(e)}%`,A2=({stats:s})=>l.jsxs("div",{className:"inventory-stats",children:[l.jsxs("div",{className:"stats-grid",children:[l.jsxs("div",{className:"stat-card primary",children:[l.jsx("div",{className:"stat-icon",children:"💰"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("h3",{children:"Valor Total"}),l.jsx("div",{className:"stat-value",children:Ir(s.totalValue)}),l.jsxs("div",{className:"stat-subtitle",children:[Tn(s.totalItems)," tipos de combustible"]})]})]}),l.jsxs("div",{className:"stat-card success",children:[l.jsx("div",{className:"stat-icon",children:"✅"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("h3",{children:"Items Activos"}),l.jsx("div",{className:"stat-value",children:s.activeItems}),l.jsxs("div",{className:"stat-subtitle",children:[Math.round(s.activeItems/s.totalItems*100),"% del total"]})]})]}),l.jsxs("div",{className:`stat-card ${s.lowStockItems>0?"warning":"info"}`,children:[l.jsx("div",{className:"stat-icon",children:s.lowStockItems>0?"⚠️":"📊"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("h3",{children:"Stock Bajo"}),l.jsx("div",{className:"stat-value",children:s.lowStockItems}),l.jsx("div",{className:"stat-subtitle",children:s.lowStockItems>0?"Requieren atención":"Niveles normales"})]})]}),l.jsxs("div",{className:"stat-card info",children:[l.jsx("div",{className:"stat-icon",children:"📈"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("h3",{children:"Nivel Promedio"}),l.jsxs("div",{className:"stat-value",children:[s.averageStockLevel,"%"]}),l.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),l.jsxs("div",{className:"fuel-type-summary",children:[l.jsx("h4",{children:"📊 Resumen por Tipo de Combustible"}),l.jsx("div",{className:"fuel-types-grid",children:Object.entries(s.byFuelType).map(([e,t])=>{const a=Xo[e],o=t.totalCapacity>0?Math.round(t.totalStock/t.totalCapacity*100):0;return l.jsxs("div",{className:"fuel-type-card",children:[l.jsxs("div",{className:"fuel-header",children:[l.jsx("span",{className:"fuel-icon",style:{color:a?.color||"#6b7280"},children:a?.icon||"⛽"}),l.jsxs("div",{className:"fuel-info",children:[l.jsx("h5",{children:a?.name||e}),l.jsxs("span",{className:"fuel-count",children:[t.count," ubicaciones"]})]})]}),l.jsxs("div",{className:"fuel-metrics",children:[l.jsxs("div",{className:"metric",children:[l.jsx("span",{className:"metric-label",children:"Stock Total:"}),l.jsxs("span",{className:"metric-value",children:[Tn(t.totalStock)," ",a?.unit||"unidades"]})]}),l.jsxs("div",{className:"metric",children:[l.jsx("span",{className:"metric-label",children:"Capacidad:"}),l.jsxs("span",{className:"metric-value",children:[Tn(t.totalCapacity)," ",a?.unit||"unidades"]})]}),l.jsxs("div",{className:"metric",children:[l.jsx("span",{className:"metric-label",children:"Utilización:"}),l.jsxs("span",{className:`metric-value ${o<25?"low":o>75?"high":"normal"}`,children:[o,"%"]})]}),l.jsxs("div",{className:"metric",children:[l.jsx("span",{className:"metric-label",children:"Valor:"}),l.jsx("span",{className:"metric-value",children:Ir(t.totalValue)})]})]}),l.jsx("div",{className:"progress-bar",children:l.jsx("div",{className:"progress-fill",style:{width:`${o}%`,backgroundColor:a?.color||"#6b7280"}})})]},e)})}),Object.keys(s.byFuelType).length===0&&l.jsx("div",{className:"empty-fuel-types",children:l.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),S2=()=>{const{hasPermission:s}=Ci(),[e,t]=J.useState([]),[a,o]=J.useState(null),[c,d]=J.useState(!0),[m,g]=J.useState(null),[v,_]=J.useState("cards"),[T,N]=J.useState(!1),[C,w]=J.useState(null),[F,A]=J.useState("all"),[L,W]=J.useState("");J.useEffect(()=>{let x=null;return(()=>{x=GA((R,P)=>{if(P){console.error("Error in inventory subscription:",P),g("Error cargando inventario en tiempo real");return}t(R||[]),d(!1)})})(),()=>{x&&x()}},[]),J.useEffect(()=>{(async()=>{const j=await m2();j.success&&o(j.data)})()},[e]);const H=e.filter(x=>{if(F==="active"&&x.status!=="active"||F==="low-stock"&&!x.needsRestock)return!1;if(L){const j=L.toLowerCase();return x.name.toLowerCase().includes(j)||x.location.toLowerCase().includes(j)||x.fuelType.toLowerCase().includes(j)}return!0}),U=x=>{if(!s("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}w(x),N(!0)},z=async x=>{if(!s("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`¿Estás seguro de eliminar ${x.name} de ${x.location}?

Esta acción no se puede deshacer.`))return;d(!0);const R=await f2(x.id);R.success?alert("Item eliminado exitosamente"):(g(R.error),alert(`Error al eliminar: ${R.error}`)),d(!1)},ae=()=>{N(!1),w(null)},O=()=>{ae()};return c&&e.length===0?l.jsxs("div",{className:"inventory-loading",children:[l.jsx("div",{className:"loading-spinner"}),l.jsx("p",{children:"Cargando inventario..."})]}):l.jsxs("div",{className:"inventory-main",children:[l.jsxs("div",{className:"inventory-header",children:[l.jsxs("div",{className:"header-title",children:[l.jsx("h2",{children:"🛢️ Gestión de Inventario"}),l.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),l.jsx("div",{className:"inventory-info",children:l.jsxs("span",{className:"info-text",children:["💡 Los combustibles se agregan automáticamente desde la pestaña ",l.jsx("strong",{children:"Movimientos"})]})})]}),a&&l.jsx(A2,{stats:a}),l.jsxs("div",{className:"inventory-controls",children:[l.jsxs("div",{className:"search-filters",children:[l.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicación o tipo...",value:L,onChange:x=>W(x.target.value),className:"search-input"}),l.jsxs("select",{value:F,onChange:x=>A(x.target.value),className:"filter-select",children:[l.jsx("option",{value:"all",children:"Todos los items"}),l.jsx("option",{value:"active",children:"Solo activos"}),l.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),l.jsxs("div",{className:"view-toggle",children:[l.jsx("button",{className:`toggle-btn ${v==="cards"?"active":""}`,onClick:()=>_("cards"),children:"📱 Cards"}),l.jsx("button",{className:`toggle-btn ${v==="table"?"active":""}`,onClick:()=>_("table"),children:"📊 Tabla"})]})]}),m&&l.jsxs("div",{className:"error-banner",children:[l.jsxs("span",{children:["⚠️ ",m]}),l.jsx("button",{onClick:()=>g(null),children:"✕"})]}),l.jsx("div",{className:"inventory-content",children:H.length===0?l.jsxs("div",{className:"empty-state",children:[l.jsx("div",{className:"empty-icon",children:"📦"}),l.jsx("h3",{children:"No hay items de inventario"}),l.jsx("p",{children:L||F!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaña Movimientos para crear una ENTRADA de combustible"})]}):l.jsx(l.Fragment,{children:v==="cards"?l.jsx(N2,{items:H,onEdit:U,onDelete:z,canManage:s("canManageInventory")}):l.jsx(T2,{items:H,onEdit:U,onDelete:z,canManage:s("canManageInventory")})})}),H.length>0&&l.jsx("div",{className:"results-footer",children:l.jsxs("p",{children:["Mostrando ",H.length," de ",e.length," items",L&&` · Filtro: "${L}"`,F!=="all"&&` · Estado: ${F}`]})}),T&&l.jsx(x2,{item:C,onClose:ae,onSuccess:O})]})},w2=({stats:s,filters:e})=>{if(!s)return null;const t=(d,m)=>m===0?d>0?100:0:((d-m)/m*100).toFixed(1),a=d=>{switch(d){case Ee.ENTRADA:return"#10b981";case Ee.SALIDA:return"#ef4444";case Ee.TRANSFERENCIA:return"#3b82f6";case Ee.AJUSTE:return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case Ee.ENTRADA:return"📥";case Ee.SALIDA:return"📤";case Ee.TRANSFERENCIA:return"🔄";case Ee.AJUSTE:return"⚖️";default:return"📋"}},c=t(s.thisMonth,s.lastMonth);return l.jsxs("div",{className:"movements-stats",children:[l.jsxs("div",{className:"stats-grid",children:[l.jsxs("div",{className:"stat-card primary",children:[l.jsx("div",{className:"stat-icon",children:"📊"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:Tn(s.totalMovements)}),l.jsx("div",{className:"stat-label",children:"Total Movimientos"}),l.jsxs("div",{className:"stat-trend",children:[l.jsxs("span",{className:`trend ${c>=0?"positive":"negative"}`,children:[c>=0?"📈":"📉"," ",Math.abs(c),"%"]}),l.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("div",{className:"stat-icon",children:"💰"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:Ir(s.totalValue)}),l.jsx("div",{className:"stat-label",children:"Valor Total"}),l.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Ir(s.averageValue)]})]})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("div",{className:"stat-icon",children:"⛽"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:Tn(s.totalQuantity)}),l.jsx("div",{className:"stat-label",children:"Galones Total"}),l.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Tn(s.totalQuantity/(s.totalMovements||1))," gal/mov"]})]})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("div",{className:"stat-icon",children:"📅"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:Tn(s.thisWeek)}),l.jsx("div",{className:"stat-label",children:"Esta Semana"}),l.jsxs("div",{className:"stat-secondary",children:[Tn(s.thisMonth)," este mes"]})]})]})]}),l.jsxs("div",{className:"stats-breakdown",children:[l.jsxs("div",{className:"breakdown-section",children:[l.jsx("h4",{children:"📋 Por Tipo de Movimiento"}),l.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byType).map(([d,m])=>{const g=(m/s.totalMovements*100).toFixed(1);return l.jsxs("div",{className:"breakdown-item",children:[l.jsxs("div",{className:"breakdown-header",children:[l.jsx("span",{className:"breakdown-icon",children:o(d)}),l.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),l.jsx("div",{className:"breakdown-value",children:m}),l.jsx("div",{className:"breakdown-bar",children:l.jsx("div",{className:"breakdown-fill",style:{width:`${g}%`,backgroundColor:a(d)}})}),l.jsxs("div",{className:"breakdown-percentage",children:[g,"%"]})]},d)})})]}),l.jsxs("div",{className:"breakdown-section",children:[l.jsx("h4",{children:"⚡ Por Estado"}),l.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byStatus).map(([d,m])=>{const g=(m/s.totalMovements*100).toFixed(1),v=T=>{switch(T){case qe.COMPLETADO:return"#10b981";case qe.PENDIENTE:return"#f59e0b";case qe.CANCELADO:return"#ef4444";default:return"#6b7280"}},_=T=>{switch(T){case qe.COMPLETADO:return"✅";case qe.PENDIENTE:return"⏳";case qe.CANCELADO:return"❌";default:return"❓"}};return l.jsxs("div",{className:"breakdown-item",children:[l.jsxs("div",{className:"breakdown-header",children:[l.jsx("span",{className:"breakdown-icon",children:_(d)}),l.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),l.jsx("div",{className:"breakdown-value",children:m}),l.jsx("div",{className:"breakdown-bar",children:l.jsx("div",{className:"breakdown-fill",style:{width:`${g}%`,backgroundColor:v(d)}})}),l.jsxs("div",{className:"breakdown-percentage",children:[g,"%"]})]},d)})})]}),l.jsxs("div",{className:"breakdown-section",children:[l.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),l.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byFuelType).map(([d,m])=>{const g=(m/s.totalMovements*100).toFixed(1),v=_=>{switch(_?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}};return l.jsxs("div",{className:"breakdown-item",children:[l.jsxs("div",{className:"breakdown-header",children:[l.jsx("span",{className:"breakdown-icon",children:v(d)}),l.jsx("span",{className:"breakdown-label",children:d})]}),l.jsx("div",{className:"breakdown-value",children:m}),l.jsx("div",{className:"breakdown-bar",children:l.jsx("div",{className:"breakdown-fill",style:{width:`${g}%`,backgroundColor:"#059669"}})}),l.jsxs("div",{className:"breakdown-percentage",children:[g,"%"]})]},d)})})]})]}),(e.type||e.status||e.fuelType||e.vehicleId)&&l.jsxs("div",{className:"active-filters",children:[l.jsx("h4",{children:"🔍 Filtros Activos"}),l.jsxs("div",{className:"filters-list",children:[e.type&&l.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&l.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&l.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.vehicleId&&l.jsxs("span",{className:"filter-tag",children:["Vehículo: ",e.vehicleId]})]})]})]})},C2=({filters:s,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:m})=>{const[g,v]=J.useState(!1),_=[{value:"Diesel",label:"Diesel 🚛"},{value:"Gasolina",label:"Gasolina 🚗"},{value:"ACPM",label:"ACPM 🚚"},{value:"Lubricante",label:"Lubricante 🛢️"}],T=[{value:"all",label:"Todos los períodos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este año"}],N=Object.values(s).filter(F=>F&&F!==""&&F!=="all").length,C=(F,A)=>{e({[F]:A})},w=F=>{e(F)};return l.jsxs("div",{className:"movements-filters",children:[l.jsxs("div",{className:"filters-main",children:[l.jsx("div",{className:"search-section",children:l.jsxs("div",{className:"search-box",children:[l.jsx("span",{className:"search-icon",children:"🔍"}),l.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehículo, referencia...",value:a,onChange:F=>o(F.target.value),className:"search-input"}),a&&l.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),l.jsxs("div",{className:"filters-controls",children:[l.jsxs("div",{className:"quick-filters",children:[l.jsx("button",{className:`quick-filter ${s.type===Ee.ENTRADA?"active":""}`,onClick:()=>w({type:Ee.ENTRADA}),children:"📥 Entradas"}),l.jsx("button",{className:`quick-filter ${s.type===Ee.SALIDA?"active":""}`,onClick:()=>w({type:Ee.SALIDA}),children:"📤 Salidas"}),l.jsx("button",{className:`quick-filter ${s.status===qe.PENDIENTE?"active":""}`,onClick:()=>w({status:qe.PENDIENTE}),children:"⏳ Pendientes"})]}),l.jsxs("button",{className:`btn-advanced-filters ${g?"active":""}`,onClick:()=>v(!g),children:["🎛️ Filtros",N>0&&l.jsx("span",{className:"filters-count",children:N})]}),l.jsxs("div",{className:"view-modes",children:[l.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),l.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),g&&l.jsxs("div",{className:"filters-advanced",children:[l.jsxs("div",{className:"filters-grid",children:[l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{children:"Tipo de Movimiento"}),l.jsxs("select",{value:s.type,onChange:F=>C("type",F.target.value),className:"filter-select",children:[l.jsx("option",{value:"",children:"Todos los tipos"}),l.jsx("option",{value:Ee.ENTRADA,children:"📥 Entrada"}),l.jsx("option",{value:Ee.SALIDA,children:"📤 Salida"}),l.jsx("option",{value:Ee.TRANSFERENCIA,children:"🔄 Transferencia"}),l.jsx("option",{value:Ee.AJUSTE,children:"⚖️ Ajuste"})]})]}),l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{children:"Estado"}),l.jsxs("select",{value:s.status,onChange:F=>C("status",F.target.value),className:"filter-select",children:[l.jsx("option",{value:"",children:"Todos los estados"}),l.jsx("option",{value:qe.PENDIENTE,children:"⏳ Pendiente"}),l.jsx("option",{value:qe.COMPLETADO,children:"✅ Completado"}),l.jsx("option",{value:qe.CANCELADO,children:"❌ Cancelado"})]})]}),l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{children:"Tipo de Combustible"}),l.jsxs("select",{value:s.fuelType,onChange:F=>C("fuelType",F.target.value),className:"filter-select",children:[l.jsx("option",{value:"",children:"Todos los combustibles"}),_.map(F=>l.jsx("option",{value:F.value,children:F.label},F.value))]})]}),l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{children:"Período"}),l.jsx("select",{value:s.dateRange,onChange:F=>C("dateRange",F.target.value),className:"filter-select",children:T.map(F=>l.jsx("option",{value:F.value,children:F.label},F.value))})]}),l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{children:"Vehículo/Equipo"}),l.jsx("input",{type:"text",placeholder:"ID del vehículo...",value:s.vehicleId,onChange:F=>C("vehicleId",F.target.value),className:"filter-input"})]})]}),l.jsxs("div",{className:"filters-actions",children:[l.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:N===0,children:"🗑️ Limpiar Filtros"}),l.jsxs("div",{className:"filters-info",children:[l.jsxs("span",{className:"results-count",children:[m," resultado",m!==1?"s":""]}),N>0&&l.jsxs("span",{className:"active-filters-text",children:["(",N," filtro",N!==1?"s":""," activo",N!==1?"s":"",")"]})]})]})]}),l.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:l.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},I2=({movements:s,onEdit:e,onView:t,onApprove:a,onReject:o,userRole:c})=>{const d=w=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(w),m=w=>w?(w instanceof Date?w:new Date(w)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Sin fecha",g=w=>{if(!w)return"";const F=new Date,A=w instanceof Date?w:new Date(w),L=Math.abs(F-A),W=Math.ceil(L/(1e3*60*60*24));return W===1?"hace 1 día":W<7?`hace ${W} días`:W<30?`hace ${Math.ceil(W/7)} semanas`:W<365?`hace ${Math.ceil(W/30)} meses`:`hace ${Math.ceil(W/365)} años`},v=w=>{switch(w){case Ee.ENTRADA:return"movement-entrada";case Ee.SALIDA:return"movement-salida";case Ee.TRANSFERENCIA:return"movement-transferencia";case Ee.AJUSTE:return"movement-ajuste";default:return"movement-default"}},_=w=>{switch(w){case qe.COMPLETADO:return"status-completado";case qe.PENDIENTE:return"status-pendiente";case qe.CANCELADO:return"status-cancelado";default:return"status-default"}},T=w=>{switch(w){case Ee.ENTRADA:return"📥";case Ee.SALIDA:return"📤";case Ee.TRANSFERENCIA:return"🔄";case Ee.AJUSTE:return"⚖️";default:return"📋"}},N=w=>{switch(w?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},C=w=>{switch(w){case qe.COMPLETADO:return"✅";case qe.PENDIENTE:return"⏳";case qe.CANCELADO:return"❌";default:return"❓"}};return l.jsx("div",{className:"movements-cards",children:s.map(w=>l.jsxs("div",{className:`movement-card ${v(w.type)}`,children:[l.jsxs("div",{className:"card-header",children:[l.jsxs("div",{className:"movement-type",children:[l.jsx("span",{className:"type-icon",children:T(w.type)}),l.jsx("span",{className:"type-label",children:w.type.charAt(0).toUpperCase()+w.type.slice(1)})]}),l.jsxs("div",{className:`status-badge ${_(w.status)}`,children:[l.jsx("span",{className:"status-icon",children:C(w.status)}),l.jsx("span",{className:"status-label",children:w.status.charAt(0).toUpperCase()+w.status.slice(1)})]})]}),l.jsxs("div",{className:"card-content",children:[l.jsxs("div",{className:"fuel-info",children:[l.jsx("span",{className:"fuel-icon",children:N(w.fuelType)}),l.jsx("span",{className:"fuel-type",children:w.fuelType}),l.jsxs("span",{className:"quantity",children:[w.quantity," galones"]})]}),l.jsxs("div",{className:"value-info",children:[l.jsx("div",{className:"total-value",children:d(w.totalValue)}),l.jsxs("div",{className:"unit-price",children:[d(w.unitPrice),"/galón"]})]}),w.vehicleId&&l.jsxs("div",{className:"vehicle-info",children:[l.jsx("span",{className:"vehicle-icon",children:"🚜"}),l.jsxs("span",{className:"vehicle-id",children:["Vehículo: ",w.vehicleId]})]}),w.location&&l.jsxs("div",{className:"location-info",children:[l.jsx("span",{className:"location-icon",children:"📍"}),l.jsx("span",{className:"location",children:w.location})]}),w.description&&l.jsx("div",{className:"description",children:l.jsx("p",{children:w.description})}),w.reference&&l.jsxs("div",{className:"reference",children:[l.jsx("span",{className:"reference-label",children:"Ref:"}),l.jsx("span",{className:"reference-value",children:w.reference})]})]}),l.jsxs("div",{className:"card-footer",children:[l.jsxs("div",{className:"date-info",children:[l.jsx("div",{className:"created-date",children:m(w.createdAt)}),l.jsx("div",{className:"relative-time",children:g(w.createdAt)})]}),l.jsxs("div",{className:"card-actions",children:[c==="admin"&&w.status===qe.PENDIENTE&&l.jsxs("div",{className:"admin-actions",children:[l.jsx("button",{className:"btn-approve",onClick:()=>a(w.id),title:"Aprobar movimiento",children:"✓ Aprobar"}),l.jsx("button",{className:"btn-reject",onClick:()=>o(w.id),title:"Rechazar movimiento",children:"✗ Rechazar"})]}),l.jsxs("div",{className:"user-actions",children:[l.jsx("button",{className:"btn-view",onClick:()=>t(w),title:"Ver detalles",children:"👁️ Ver"}),e&&w.status===qe.PENDIENTE&&l.jsx("button",{className:"btn-edit",onClick:()=>e(w),title:"Editar movimiento",children:"✏️ Editar"})]})]})]}),w.status===qe.PENDIENTE&&l.jsx("div",{className:"urgency-indicator",children:l.jsx("div",{className:"urgency-pulse"})}),w.type===Ee.AJUSTE&&l.jsx("div",{className:"adjustment-badge",children:l.jsx("span",{children:"Ajuste"})}),w.type===Ee.TRANSFERENCIA&&w.destinationLocation&&l.jsxs("div",{className:"transfer-info",children:[l.jsx("span",{className:"transfer-arrow",children:"→"}),l.jsx("span",{className:"destination",children:w.destinationLocation})]})]},w.id))})},j2=({movements:s,onEdit:e,onView:t,onApprove:a,onReject:o,userRole:c})=>{const[d,m]=J.useState("createdAt"),[g,v]=J.useState("desc"),_=H=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(H),T=H=>H?(H instanceof Date?H:new Date(H)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",N=H=>{switch(H){case Ee.ENTRADA:return"📥";case Ee.SALIDA:return"📤";case Ee.TRANSFERENCIA:return"🔄";case Ee.AJUSTE:return"⚖️";default:return"📋"}},C=H=>{switch(H?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},w=H=>{switch(H){case qe.COMPLETADO:return"✅";case qe.PENDIENTE:return"⏳";case qe.CANCELADO:return"❌";default:return"❓"}},F=H=>{switch(H){case qe.COMPLETADO:return"status-completado";case qe.PENDIENTE:return"status-pendiente";case qe.CANCELADO:return"status-cancelado";default:return"status-default"}},A=H=>{d===H?v(g==="asc"?"desc":"asc"):(m(H),v("asc"))},L=[...s].sort((H,U)=>{let z=H[d],ae=U[d];return(d.includes("Date")||d.includes("At"))&&(z=new Date(z),ae=new Date(ae)),typeof z=="number"&&typeof ae=="number"?g==="asc"?z-ae:ae-z:typeof z=="string"&&typeof ae=="string"?g==="asc"?z.localeCompare(ae):ae.localeCompare(z):z instanceof Date&&ae instanceof Date?g==="asc"?z-ae:ae-z:0}),W=H=>d!==H?"↕️":g==="asc"?"↑":"↓";return l.jsxs("div",{className:"movements-table-container",children:[l.jsx("div",{className:"table-wrapper",children:l.jsxs("table",{className:"movements-table",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsxs("th",{className:"sortable",onClick:()=>A("type"),children:["Tipo ",W("type")]}),l.jsxs("th",{className:"sortable",onClick:()=>A("fuelType"),children:["Combustible ",W("fuelType")]}),l.jsxs("th",{className:"sortable text-right",onClick:()=>A("quantity"),children:["Cantidad ",W("quantity")]}),l.jsxs("th",{className:"sortable text-right",onClick:()=>A("unitPrice"),children:["Precio/Gal ",W("unitPrice")]}),l.jsxs("th",{className:"sortable text-right",onClick:()=>A("totalValue"),children:["Valor Total ",W("totalValue")]}),l.jsx("th",{children:"Vehículo"}),l.jsx("th",{children:"Ubicación"}),l.jsxs("th",{className:"sortable",onClick:()=>A("status"),children:["Estado ",W("status")]}),l.jsxs("th",{className:"sortable",onClick:()=>A("createdAt"),children:["Fecha ",W("createdAt")]}),l.jsx("th",{className:"actions-column",children:"Acciones"})]})}),l.jsx("tbody",{children:L.map(H=>l.jsxs("tr",{className:`movement-row ${H.status===qe.PENDIENTE?"pending-row":""}`,children:[l.jsx("td",{className:"type-cell",children:l.jsxs("div",{className:"type-content",children:[l.jsx("span",{className:"type-icon",children:N(H.type)}),l.jsx("span",{className:"type-text",children:H.type.charAt(0).toUpperCase()+H.type.slice(1)})]})}),l.jsx("td",{className:"fuel-cell",children:l.jsxs("div",{className:"fuel-content",children:[l.jsx("span",{className:"fuel-icon",children:C(H.fuelType)}),l.jsx("span",{className:"fuel-text",children:H.fuelType})]})}),l.jsxs("td",{className:"quantity-cell text-right",children:[l.jsx("span",{className:"quantity-value",children:H.quantity}),l.jsx("span",{className:"quantity-unit",children:"gal"})]}),l.jsx("td",{className:"price-cell text-right",children:_(H.unitPrice)}),l.jsx("td",{className:"value-cell text-right",children:l.jsx("strong",{children:_(H.totalValue)})}),l.jsx("td",{className:"vehicle-cell",children:H.vehicleId?l.jsxs("span",{className:"vehicle-id",children:["🚜 ",H.vehicleId]}):l.jsx("span",{className:"no-vehicle",children:"-"})}),l.jsx("td",{className:"location-cell",children:l.jsxs("span",{className:"location-text",children:["📍 ",H.location||"Principal"]})}),l.jsx("td",{className:"status-cell",children:l.jsxs("div",{className:`status-badge ${F(H.status)}`,children:[l.jsx("span",{className:"status-icon",children:w(H.status)}),l.jsx("span",{className:"status-text",children:H.status.charAt(0).toUpperCase()+H.status.slice(1)})]})}),l.jsx("td",{className:"date-cell",children:l.jsxs("div",{className:"date-content",children:[l.jsx("span",{className:"date-value",children:T(H.createdAt)}),H.reference&&l.jsxs("span",{className:"reference-small",children:["#",H.reference]})]})}),l.jsx("td",{className:"actions-cell",children:l.jsxs("div",{className:"action-buttons",children:[l.jsx("button",{className:"btn-action btn-view",onClick:()=>t(H),title:"Ver detalles",children:"👁️"}),c==="admin"&&H.status===qe.PENDIENTE&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"btn-action btn-approve",onClick:()=>a(H.id),title:"Aprobar movimiento",children:"✓"}),l.jsx("button",{className:"btn-action btn-reject",onClick:()=>o(H.id),title:"Rechazar movimiento",children:"✗"})]}),e&&H.status===qe.PENDIENTE&&l.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(H),title:"Editar movimiento",children:"✏️"})]})})]},H.id))})]})}),l.jsxs("div",{className:"table-info",children:[l.jsxs("div",{className:"table-summary",children:[l.jsxs("span",{className:"total-rows",children:[s.length," movimiento",s.length!==1?"s":""]}),d&&l.jsxs("span",{className:"sort-info",children:["Ordenado por ",d," (",g==="asc"?"ascendente":"descendente",")"]})]}),l.jsxs("div",{className:"table-legend",children:[l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-icon",children:"⏳"})," Pendiente"]}),l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-icon",children:"✅"})," Completado"]}),l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-icon",children:"❌"})," Cancelado"]})]})]})]})},R2=({movements:s,viewMode:e,onEdit:t,onView:a,userRole:o})=>e==="table"?l.jsx(j2,{movements:s,onEdit:t,onView:a,userRole:o}):l.jsx(I2,{movements:s,onEdit:t,onView:a,userRole:o}),Us="combustibles_suppliers",D2=async(s,e)=>{try{const t=et(xt(Fe,Us),mt("name","==",s.name.trim()));if(!(await Hn(t)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${s.name}"`};if(s.taxId){const d=et(xt(Fe,Us),mt("taxId","==",s.taxId.trim()));if(!(await Hn(d)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${s.taxId}"`}}const o={name:s.name.trim(),taxId:s.taxId?.trim()||"",type:s.type||"proveedor",category:s.category||"combustibles",contactPerson:s.contactPerson?.trim()||"",phone:s.phone?.trim()||"",email:s.email?.trim()||"",address:s.address?.trim()||"",city:s.city?.trim()||"",state:s.state?.trim()||"Colombia",fuelTypes:s.fuelTypes||[],paymentTerms:s.paymentTerms||"contado",creditLimit:Number(s.creditLimit)||0,priceList:s.priceList||{},rating:Number(s.rating)||5,evaluationNotes:s.evaluationNotes||"",status:s.status||"active",isPreferred:s.isPreferred||!1,totalOrders:0,totalPurchased:0,lastOrderDate:null,averageDeliveryTime:0,createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await Px(xt(Fe,Us),o)).id,...o},message:`Proveedor "${o.name}" creado exitosamente`}}catch(t){return console.error("Error creating supplier:",t),{success:!1,error:t.message}}},JA=async()=>{try{const s=et(xt(Fe,Us),Da("name","asc"));return{success:!0,data:(await Hn(s)).docs.map(a=>({id:a.id,...a.data()}))}}catch(s){return console.error("Error getting suppliers:",s),{success:!1,error:s.message}}},O2=s=>{const e=et(xt(Fe,Us),Da("name","asc"));return Wh(e,t=>{const a=t.docs.map(o=>({id:o.id,...o.data()}));s(a)})},M2=async(s,e,t)=>{try{const a=await Mr(rn(Fe,Us,s));if(!a.exists())return{success:!1,error:"Proveedor no encontrado"};if(e.name&&e.name.trim()!==a.data().name){const c=et(xt(Fe,Us),mt("name","==",e.name.trim()));if(!(await Hn(c)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${e.name}"`}}if(e.taxId&&e.taxId.trim()!==a.data().taxId){const c=et(xt(Fe,Us),mt("taxId","==",e.taxId.trim()));if(!(await Hn(c)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${e.taxId}"`}}const o={...e,lastUpdated:new Date,updatedBy:t};return o.name&&(o.name=o.name.trim()),o.taxId&&(o.taxId=o.taxId.trim()),o.contactPerson&&(o.contactPerson=o.contactPerson.trim()),o.phone&&(o.phone=o.phone.trim()),o.email&&(o.email=o.email.trim()),await il(rn(Fe,Us,s),o),{success:!0,message:"Proveedor actualizado exitosamente"}}catch(a){return console.error("Error updating supplier:",a),{success:!1,error:a.message}}},P2=async(s,e)=>{try{return await il(rn(Fe,Us,s),{status:"inactive",lastUpdated:new Date,updatedBy:e}),{success:!0,message:"Proveedor desactivado exitosamente"}}catch(t){return console.error("Error deleting supplier:",t),{success:!1,error:t.message}}},k2=async()=>{try{const s=await JA();if(!s.success)return s;const e=s.data,t={total:e.length,active:e.filter(a=>a.status==="active").length,inactive:e.filter(a=>a.status==="inactive").length,suspended:e.filter(a=>a.status==="suspended").length,preferred:e.filter(a=>a.isPreferred).length,averageRating:e.length>0?e.reduce((a,o)=>a+(o.rating||0),0)/e.length:0,byCategory:{},byType:{}};return e.forEach(a=>{const o=a.category||"sin_categoria";t.byCategory[o]=(t.byCategory[o]||0)+1}),e.forEach(a=>{const o=a.type||"sin_tipo";t.byType[o]=(t.byType[o]||0)+1}),{success:!0,data:t}}catch(s){return console.error("Error getting suppliers stats:",s),{success:!1,error:s.message}}},V2=({isOpen:s,onClose:e,movement:t,mode:a,onSuccess:o})=>{const[c,d]=J.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),[m,g]=J.useState(!1),[v,_]=J.useState(""),[T,N]=J.useState({}),[C,w]=J.useState([]),[F,A]=J.useState(!1),[L,W]=J.useState([]),[H,U]=J.useState(""),[z,ae]=J.useState([]),O=[{value:"Diesel",label:"Diesel/ACPM 🚛",price:12500},{value:"Gasolina",label:"Gasolina 🚗",price:14200},{value:"Lubricante",label:"Lubricante 🛢️",price:45e3}],x=["Principal","Bodega Norte","Bodega Sur","Campo Operativo","Estación Móvil"];J.useEffect(()=>{(async()=>{if(s){A(!0);try{const[ye,G,ne]=await Promise.all([WA(),HA(),JA()]);w(ye),W(G.success?G.data:[]),ae(ne.success?ne.data:[])}catch(ye){console.error("Error al cargar datos:",ye)}finally{A(!1)}}})()},[s]),J.useEffect(()=>{t&&(a==="edit"||a==="view")?d({type:t.type||"",fuelType:t.fuelType||"",quantity:t.quantity?.toString()||"",unitPrice:t.unitPrice?.toString()||"",location:t.location||"Principal",vehicleId:t.vehicleId||"",destinationLocation:t.destinationLocation||"",description:t.description||"",reference:t.reference||"",effectiveDate:t.effectiveDate?new Date(t.effectiveDate).toISOString().slice(0,16):new Date().toISOString().slice(0,16)}):a==="create"&&d({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),_(""),N({})},[t,a,s]),J.useEffect(()=>{if(c.fuelType&&!c.unitPrice){const re=O.find(ye=>ye.value===c.fuelType);re&&d(ye=>({...ye,unitPrice:re.price.toString()}))}},[c.fuelType]),J.useEffect(()=>{if(U(""),(c.type===Ee.SALIDA||c.type===Ee.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&L.length>0){const re={type:c.type===Ee.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},ye=oN(re,L);ye.isValid?ye.warning&&U(`⚠️ ${ye.warning}`):U(`🚫 ${ye.error}`)}},[c.type,c.fuelType,c.location,c.quantity,L]);const j=(re,ye)=>{d(re==="type"?G=>({...G,[re]:ye,location:ye===Ee.ENTRADA?"":"Principal"}):G=>({...G,[re]:ye})),T[re]&&N(G=>({...G,[re]:""}))},R=()=>{const re={};if(c.type||(re.type="Tipo de movimiento requerido"),c.fuelType||(re.fuelType="Tipo de combustible requerido"),c.quantity?parseFloat(c.quantity)<=0&&(re.quantity="La cantidad debe ser mayor a cero"):re.quantity="Cantidad requerida",c.unitPrice?parseFloat(c.unitPrice)<0&&(re.unitPrice="El precio no puede ser negativo"):re.unitPrice="Precio unitario requerido",c.type===Ee.ENTRADA&&!c.location&&(re.location="Las entradas requieren un proveedor"),c.type===Ee.SALIDA&&!c.vehicleId&&(re.vehicleId="Las salidas requieren un vehículo"),c.type===Ee.TRANSFERENCIA&&!c.destinationLocation&&(re.destinationLocation="Las transferencias requieren una ubicación destino"),(c.type===Ee.SALIDA||c.type===Ee.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&L.length>0){const ye={type:c.type===Ee.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},G=oN(ye,L);G.isValid||(re.quantity=G.error)}return N(re),Object.keys(re).length===0},P=async re=>{if(re.preventDefault(),!R()){_("Por favor corrige los errores en el formulario");return}g(!0),_("");try{const ye={...c,quantity:parseFloat(c.quantity),unitPrice:parseFloat(c.unitPrice),effectiveDate:new Date(c.effectiveDate)};a==="create"?await p2(ye):a==="edit"&&await $A(t.id,ye),o()}catch(ye){console.error("Error al guardar movimiento:",ye),_(ye.message||"Error al guardar el movimiento")}finally{g(!1)}},M=(parseFloat(c.quantity)||0)*(parseFloat(c.unitPrice)||0),D=()=>{switch(a){case"create":return"➕ Nuevo Movimiento";case"edit":return"✏️ Editar Movimiento";case"view":return"👁️ Detalles del Movimiento";default:return"Movimiento"}};return s?l.jsx("div",{className:"modal-overlay",onClick:e,children:l.jsxs("div",{className:"modal-content movement-modal",onClick:re=>re.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h3",{children:D()}),l.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),l.jsxs("div",{className:"modal-body",children:[v&&l.jsxs("div",{className:"error-message",children:[l.jsx("span",{className:"error-icon",children:"⚠️"}),v]}),l.jsxs("form",{onSubmit:P,className:"movement-form",children:[l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Tipo de Movimiento *"}),l.jsxs("select",{value:c.type,onChange:re=>j("type",re.target.value),disabled:a==="view",className:T.type?"error":"",children:[l.jsx("option",{value:"",children:"Seleccionar tipo..."}),l.jsx("option",{value:Ee.ENTRADA,children:"📥 Entrada"}),l.jsx("option",{value:Ee.SALIDA,children:"📤 Salida"}),l.jsx("option",{value:Ee.TRANSFERENCIA,children:"🔄 Transferencia"}),l.jsx("option",{value:Ee.AJUSTE,children:"⚖️ Ajuste"})]}),T.type&&l.jsx("span",{className:"field-error",children:T.type})]}),a==="view"&&t&&l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Estado"}),l.jsx("div",{className:"status-display",children:l.jsxs("span",{className:`status-badge status-${t.status}`,children:[t.status===qe.COMPLETADO&&"✅",t.status===qe.PENDIENTE&&"⏳",t.status===qe.CANCELADO&&"❌",t.status.charAt(0).toUpperCase()+t.status.slice(1)]})})]})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Tipo de Combustible *"}),l.jsxs("select",{value:c.fuelType,onChange:re=>j("fuelType",re.target.value),disabled:a==="view",className:T.fuelType?"error":"",children:[l.jsx("option",{value:"",children:"Seleccionar combustible..."}),O.map(re=>l.jsx("option",{value:re.value,children:re.label},re.value))]}),T.fuelType&&l.jsx("span",{className:"field-error",children:T.fuelType})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Cantidad (galones) *"}),l.jsx("input",{type:"number",step:"0.01",min:"0",value:c.quantity,onChange:re=>j("quantity",re.target.value),disabled:a==="view",placeholder:"0.00",className:T.quantity?"error":""}),T.quantity&&l.jsx("span",{className:"field-error",children:T.quantity}),H&&!T.quantity&&l.jsx("div",{className:"stock-warning",children:H})]})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Precio Unitario (COP) *"}),l.jsx("input",{type:"number",step:"1",min:"0",value:c.unitPrice,onChange:re=>j("unitPrice",re.target.value),disabled:a==="view",placeholder:"0",className:T.unitPrice?"error":""}),T.unitPrice&&l.jsx("span",{className:"field-error",children:T.unitPrice})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Valor Total"}),l.jsx("div",{className:"total-value-display",children:Ir(M)})]})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:c.type===Ee.ENTRADA?"Proveedor *":"Ubicación"}),c.type===Ee.ENTRADA?l.jsxs("select",{value:c.location,onChange:re=>j("location",re.target.value),disabled:a==="view",className:T.location?"error":"",children:[l.jsx("option",{value:"",children:"Seleccionar proveedor..."}),z.filter(re=>re.status==="active").map(re=>l.jsxs("option",{value:re.name,children:["🏪 ",re.name," - ",re.city]},re.id))]}):l.jsx("select",{value:c.location,onChange:re=>j("location",re.target.value),disabled:a==="view",children:x.map(re=>l.jsxs("option",{value:re,children:["📍 ",re]},re))}),T.location&&l.jsx("span",{className:"field-error",children:T.location})]}),l.jsxs("div",{className:"form-group",children:[l.jsxs("label",{children:["Vehículo/Equipo ",c.type===Ee.SALIDA&&"*"]}),c.type===Ee.SALIDA?F?l.jsxs("div",{className:"loading-vehicles",children:[l.jsx("span",{className:"loading-spinner small"}),"Cargando vehículos..."]}):l.jsxs("select",{value:c.vehicleId,onChange:re=>j("vehicleId",re.target.value),disabled:a==="view",className:T.vehicleId?"error":"",children:[l.jsx("option",{value:"",children:"Seleccionar vehículo destino..."}),C.map(re=>l.jsxs("option",{value:re.vehicleId,children:["🚜 ",re.vehicleId," - ",re.name," (",re.type,")"]},re.id))]}):l.jsx("input",{type:"text",value:c.vehicleId,onChange:re=>j("vehicleId",re.target.value),disabled:a==="view",placeholder:"ID del vehículo o equipo",className:T.vehicleId?"error":""}),T.vehicleId&&l.jsx("span",{className:"field-error",children:T.vehicleId})]})]}),c.type===Ee.TRANSFERENCIA&&l.jsx("div",{className:"form-row",children:l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Ubicación Destino *"}),l.jsxs("select",{value:c.destinationLocation,onChange:re=>j("destinationLocation",re.target.value),disabled:a==="view",className:T.destinationLocation?"error":"",children:[l.jsx("option",{value:"",children:"Seleccionar destino..."}),x.filter(re=>re!==c.location).map(re=>l.jsxs("option",{value:re,children:["📍 ",re]},re))]}),T.destinationLocation&&l.jsx("span",{className:"field-error",children:T.destinationLocation})]})}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Fecha Efectiva"}),l.jsx("input",{type:"datetime-local",value:c.effectiveDate,onChange:re=>j("effectiveDate",re.target.value),disabled:a==="view"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Referencia"}),l.jsx("input",{type:"text",value:c.reference,onChange:re=>j("reference",re.target.value),disabled:a==="view",placeholder:"Factura, orden, etc."})]})]}),l.jsx("div",{className:"form-row",children:l.jsxs("div",{className:"form-group full-width",children:[l.jsx("label",{children:"Descripción"}),l.jsx("textarea",{value:c.description,onChange:re=>j("description",re.target.value),disabled:a==="view",placeholder:"Detalles adicionales del movimiento...",rows:"3"})]})}),a==="view"&&t&&l.jsx("div",{className:"movement-details",children:l.jsxs("div",{className:"details-section",children:[l.jsx("h4",{children:"📋 Información del Sistema"}),l.jsxs("div",{className:"details-grid",children:[l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"ID:"}),l.jsx("span",{children:t.id})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Creado:"}),l.jsx("span",{children:new Date(t.createdAt).toLocaleString("es-CO")})]}),t.updatedAt&&l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Actualizado:"}),l.jsx("span",{children:new Date(t.updatedAt).toLocaleString("es-CO")})]}),t.approvedAt&&l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Aprobado:"}),l.jsx("span",{children:new Date(t.approvedAt).toLocaleString("es-CO")})]})]})]})})]})]}),l.jsxs("div",{className:"modal-footer",children:[l.jsx("button",{type:"button",className:"btn-cancel",onClick:e,children:a==="view"?"Cerrar":"Cancelar"}),a!=="view"&&l.jsx("button",{type:"submit",className:"btn-primary",onClick:P,disabled:m,children:m?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"loading-spinner small"}),"Guardando..."]}):a==="create"?"Crear Movimiento":"Actualizar Movimiento"})]})]})}):null},L2=()=>{const{user:s,userProfile:e}=Ci(),[t,a]=J.useState([]),[o,c]=J.useState(null),[d,m]=J.useState(!0),[g,v]=J.useState(null),[_,T]=J.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[N,C]=J.useState("cards"),[w,F]=J.useState(""),[A,L]=J.useState(!1),[W,H]=J.useState(null),[U,z]=J.useState("create");J.useEffect(()=>{if(!s)return;m(!0);const ne=KA((ce,ge)=>{if(ge){console.error("Error en suscripción de movimientos:",ge),v("Error al cargar movimientos"),m(!1);return}a(ce),v(null),m(!1)},_);return()=>ne()},[s,_]),J.useEffect(()=>{s&&(async()=>{try{const ce=await _2(_);c(ce)}catch(ce){console.error("Error al cargar estadísticas:",ce)}})()},[s,t,_]);const ae=t.filter(ne=>{if(!w)return!0;const ce=w.toLowerCase();return ne.fuelType?.toLowerCase().includes(ce)||ne.type?.toLowerCase().includes(ce)||ne.location?.toLowerCase().includes(ce)||ne.vehicleId?.toLowerCase().includes(ce)||ne.description?.toLowerCase().includes(ce)||ne.reference?.toLowerCase().includes(ce)}),O=()=>{H(null),z("create"),L(!0)},x=ne=>{H(ne),z("edit"),L(!0)},j=ne=>{H(ne),z("view"),L(!0)},R=()=>{L(!1),H(null)},P=ne=>{T(ce=>({...ce,...ne}))},M=()=>{T({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),F("")},D=async ne=>{if(window.confirm("¿Estás seguro de que quieres aprobar este movimiento? Esta acción actualizará el inventario."))try{await y2(ne),alert("Movimiento aprobado y stock actualizado.")}catch(ce){console.error("Error al aprobar movimiento:",ce),alert(`Error al aprobar movimiento: ${ce.message}`)}},re=async ne=>{if(window.confirm("¿Estás seguro de que quieres rechazar este movimiento?"))try{await $A(ne,{status:qe.CANCELADO}),alert("Movimiento rechazado.")}catch(ce){console.error("Error al rechazar movimiento:",ce),alert(`Error al rechazar movimiento: ${ce.message}`)}},ye=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",G=e?.role==="admin";return d?l.jsx("div",{className:"movements-main",children:l.jsxs("div",{className:"loading-container",children:[l.jsx("div",{className:"loading-spinner"}),l.jsx("p",{children:"Cargando movimientos..."})]})}):g?l.jsx("div",{className:"movements-main",children:l.jsxs("div",{className:"error-container",children:[l.jsx("div",{className:"error-icon",children:"⚠️"}),l.jsx("h3",{children:"Error al cargar movimientos"}),l.jsx("p",{children:g}),l.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):l.jsxs("div",{className:"movements-main",children:[l.jsxs("div",{className:"movements-header",children:[l.jsxs("div",{className:"header-title",children:[l.jsx("h2",{children:"📊 Movimientos de Combustibles"}),l.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),ye&&l.jsx("button",{className:"btn-create-movement",onClick:O,children:"➕ Nuevo Movimiento"})]}),o&&l.jsx(w2,{stats:o,filters:_}),l.jsx(C2,{filters:_,onFilterChange:P,onClearFilters:M,searchTerm:w,onSearchChange:F,viewMode:N,onViewModeChange:C,totalResults:ae.length}),ae.length===0?l.jsxs("div",{className:"empty-state",children:[l.jsx("div",{className:"empty-icon",children:"📋"}),l.jsx("h3",{children:t.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),l.jsx("p",{children:t.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&ye&&l.jsx("button",{className:"btn-create-first",onClick:O,children:"➕ Crear Primer Movimiento"})]}):l.jsx(R2,{movements:ae,viewMode:N,onEdit:G?x:null,onView:j,onApprove:D,onReject:re,userRole:s?.role}),A&&l.jsx(V2,{isOpen:A,onClose:R,movement:W,mode:U,onSuccess:()=>{R()}})]})},U2=({stats:s,filters:e})=>{if(!s)return null;const t=T=>`${Tn(T)} gal`,a=T=>`${Tn(T)} hrs`,o=T=>`${T.toFixed(2)} gal/hr`,c=T=>{switch(T){case ve.EXCAVADORA:return"#059669";case ve.BULLDOZER:return"#dc2626";case ve.CARGADOR:return"#2563eb";case ve.CAMION:return"#7c3aed";case ve.GRUA:return"#ea580c";case ve.MOTOSIERRA:return"#16a34a";case ve.TRACTOR:return"#ca8a04";case ve.VOLQUETA:return"#9333ea";default:return"#6b7280"}},d=T=>{switch(T){case ve.EXCAVADORA:return"🚚";case ve.BULLDOZER:return"🚜";case ve.CARGADOR:return"🏗️";case ve.CAMION:return"🚛";case ve.GRUA:return"🏗️";case ve.MOTOSIERRA:return"🪚";case ve.TRACTOR:return"🚜";case ve.VOLQUETA:return"🚛";default:return"🚗"}},m=T=>{switch(T){case Re.ACTIVO:return"#10b981";case Re.MANTENIMIENTO:return"#f59e0b";case Re.INACTIVO:return"#6b7280";case Re.REPARACION:return"#ef4444";default:return"#6b7280"}},g=T=>{switch(T){case Re.ACTIVO:return"✅";case Re.MANTENIMIENTO:return"🔧";case Re.INACTIVO:return"⏸️";case Re.REPARACION:return"🔴";default:return"❓"}},v=T=>{switch(T){case _t.DIESEL:return"🚛";case _t.GASOLINA:return"🚗";case _t.ACPM:return"🚚";case _t.MIXTO:return"⛽";default:return"⛽"}},_=s.totalVehicles>0?((s.byStatus[Re.ACTIVO]||0)/s.totalVehicles*100).toFixed(1):0;return l.jsxs("div",{className:"vehicles-stats",children:[l.jsxs("div",{className:"stats-grid",children:[l.jsxs("div",{className:"stat-card primary",children:[l.jsx("div",{className:"stat-icon",children:"🚜"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:Tn(s.totalVehicles)}),l.jsx("div",{className:"stat-label",children:"Total Vehículos"}),l.jsx("div",{className:"stat-trend",children:l.jsxs("span",{className:`trend ${_>=80?"positive":"warning"}`,children:[_>=80?"📈":"⚠️"," ",_,"% activos"]})})]})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("div",{className:"stat-icon",children:"⛽"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:t(s.totalFuelConsumed)}),l.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),l.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(s.averageConsumption||0)]})]})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("div",{className:"stat-icon",children:"⏰"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:a(s.totalHoursWorked)}),l.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),l.jsxs("div",{className:"stat-secondary",children:["Promedio: ",a(s.totalHoursWorked/(s.totalVehicles||1))]})]})]}),l.jsxs("div",{className:"stat-card",children:[l.jsx("div",{className:"stat-icon",children:"🏆"}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:s.mostActiveVehicle?s.mostActiveVehicle.vehicleId:"N/A"}),l.jsx("div",{className:"stat-label",children:"Más Activo"}),l.jsx("div",{className:"stat-secondary",children:s.mostActiveVehicle?`${s.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),l.jsxs("div",{className:"stats-breakdown",children:[l.jsxs("div",{className:"breakdown-section",children:[l.jsx("h4",{children:"🚜 Por Tipo de Vehículo"}),l.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byType).map(([T,N])=>{const C=(N/s.totalVehicles*100).toFixed(1);return l.jsxs("div",{className:"breakdown-item",children:[l.jsxs("div",{className:"breakdown-header",children:[l.jsx("span",{className:"breakdown-icon",children:d(T)}),l.jsx("span",{className:"breakdown-label",children:T.charAt(0).toUpperCase()+T.slice(1)})]}),l.jsx("div",{className:"breakdown-value",children:N}),l.jsx("div",{className:"breakdown-bar",children:l.jsx("div",{className:"breakdown-fill",style:{width:`${C}%`,backgroundColor:c(T)}})}),l.jsxs("div",{className:"breakdown-percentage",children:[C,"%"]})]},T)})})]}),l.jsxs("div",{className:"breakdown-section",children:[l.jsx("h4",{children:"⚡ Por Estado"}),l.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byStatus).map(([T,N])=>{const C=(N/s.totalVehicles*100).toFixed(1);return l.jsxs("div",{className:"breakdown-item",children:[l.jsxs("div",{className:"breakdown-header",children:[l.jsx("span",{className:"breakdown-icon",children:g(T)}),l.jsx("span",{className:"breakdown-label",children:T.charAt(0).toUpperCase()+T.slice(1)})]}),l.jsx("div",{className:"breakdown-value",children:N}),l.jsx("div",{className:"breakdown-bar",children:l.jsx("div",{className:"breakdown-fill",style:{width:`${C}%`,backgroundColor:m(T)}})}),l.jsxs("div",{className:"breakdown-percentage",children:[C,"%"]})]},T)})})]}),l.jsxs("div",{className:"breakdown-section",children:[l.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),l.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byFuelType).map(([T,N])=>{const C=(N/s.totalVehicles*100).toFixed(1);return l.jsxs("div",{className:"breakdown-item",children:[l.jsxs("div",{className:"breakdown-header",children:[l.jsx("span",{className:"breakdown-icon",children:v(T)}),l.jsx("span",{className:"breakdown-label",children:T})]}),l.jsx("div",{className:"breakdown-value",children:N}),l.jsx("div",{className:"breakdown-bar",children:l.jsx("div",{className:"breakdown-fill",style:{width:`${C}%`,backgroundColor:"#059669"}})}),l.jsxs("div",{className:"breakdown-percentage",children:[C,"%"]})]},T)})})]})]}),(s.totalFuelConsumed>0||s.totalHoursWorked>0)&&l.jsxs("div",{className:"performance-metrics",children:[l.jsx("h4",{children:"📊 Métricas de Rendimiento"}),l.jsxs("div",{className:"metrics-grid",children:[l.jsxs("div",{className:"metric-card",children:[l.jsx("div",{className:"metric-icon",children:"⚡"}),l.jsxs("div",{className:"metric-content",children:[l.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),l.jsxs("div",{className:"metric-value",children:[_,"%"]}),l.jsxs("div",{className:"metric-description",children:[s.byStatus[Re.ACTIVO]||0," de ",s.totalVehicles," activos"]})]})]}),s.averageConsumption>0&&l.jsxs("div",{className:"metric-card",children:[l.jsx("div",{className:"metric-icon",children:"📈"}),l.jsxs("div",{className:"metric-content",children:[l.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),l.jsx("div",{className:"metric-value",children:o(s.averageConsumption)}),l.jsx("div",{className:"metric-description",children:"Por vehículo por hora trabajada"})]})]}),s.mostActiveVehicle&&l.jsxs("div",{className:"metric-card",children:[l.jsx("div",{className:"metric-icon",children:"🏆"}),l.jsxs("div",{className:"metric-content",children:[l.jsx("div",{className:"metric-label",children:"Mayor Utilización"}),l.jsx("div",{className:"metric-value",children:s.mostActiveVehicle.vehicleId}),l.jsxs("div",{className:"metric-description",children:[t(s.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),s.leastActiveVehicle&&l.jsxs("div",{className:"metric-card",children:[l.jsx("div",{className:"metric-icon",children:"📉"}),l.jsxs("div",{className:"metric-content",children:[l.jsx("div",{className:"metric-label",children:"Menor Utilización"}),l.jsx("div",{className:"metric-value",children:s.leastActiveVehicle.vehicleId}),l.jsxs("div",{className:"metric-description",children:[t(s.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(e.type||e.status||e.fuelType||e.location)&&l.jsxs("div",{className:"active-filters",children:[l.jsx("h4",{children:"🔍 Filtros Activos"}),l.jsxs("div",{className:"filters-list",children:[e.type&&l.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&l.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&l.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.location&&l.jsxs("span",{className:"filter-tag",children:["Ubicación: ",e.location]})]})]})]})},F2=({filters:s,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:m})=>{const[g,v]=J.useState(!1),_=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mecánico","Proyecto A","Proyecto B","En Reparación","Otros"],T=Object.values(s).filter(w=>w&&w!==""&&w!=="all").length,N=(w,F)=>{e({[w]:F})},C=w=>{e(w)};return l.jsxs("div",{className:"vehicles-filters",children:[l.jsxs("div",{className:"filters-main",children:[l.jsx("div",{className:"search-section",children:l.jsxs("div",{className:"search-box",children:[l.jsx("span",{className:"search-icon",children:"🔍"}),l.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicación...",value:a,onChange:w=>o(w.target.value),className:"search-input"}),a&&l.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),l.jsxs("div",{className:"filters-controls",children:[l.jsxs("div",{className:"quick-filters",children:[l.jsx("button",{className:`quick-filter ${s.status===Re.ACTIVO?"active":""}`,onClick:()=>C({status:Re.ACTIVO}),children:"✅ Activos"}),l.jsx("button",{className:`quick-filter ${s.status===Re.MANTENIMIENTO?"active":""}`,onClick:()=>C({status:Re.MANTENIMIENTO}),children:"🔧 Mantenimiento"}),l.jsx("button",{className:`quick-filter ${s.type===ve.EXCAVADORA?"active":""}`,onClick:()=>C({type:ve.EXCAVADORA}),children:"🚚 Excavadoras"}),l.jsx("button",{className:`quick-filter ${s.type===ve.TRACTOR?"active":""}`,onClick:()=>C({type:ve.TRACTOR}),children:"🚜 Tractores"})]}),l.jsxs("button",{className:`btn-advanced-filters ${g?"active":""}`,onClick:()=>v(!g),children:["🎛️ Filtros",T>0&&l.jsx("span",{className:"filters-count",children:T})]}),l.jsxs("div",{className:"view-modes",children:[l.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),l.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),g&&l.jsxs("div",{className:"filters-advanced",children:[l.jsxs("div",{className:"filters-grid",children:[l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{children:"Tipo de Vehículo"}),l.jsxs("select",{value:s.type,onChange:w=>N("type",w.target.value),className:"filter-select",children:[l.jsx("option",{value:"",children:"Todos los tipos"}),l.jsx("option",{value:ve.EXCAVADORA,children:"🚚 Excavadora"}),l.jsx("option",{value:ve.BULLDOZER,children:"🚜 Bulldozer"}),l.jsx("option",{value:ve.CARGADOR,children:"🏗️ Cargador"}),l.jsx("option",{value:ve.CAMION,children:"🚛 Camión"}),l.jsx("option",{value:ve.GRUA,children:"🏗️ Grúa"}),l.jsx("option",{value:ve.MOTOSIERRA,children:"🪚 Motosierra"}),l.jsx("option",{value:ve.TRACTOR,children:"🚜 Tractor"}),l.jsx("option",{value:ve.VOLQUETA,children:"🚛 Volqueta"}),l.jsx("option",{value:ve.OTROS,children:"🚗 Otros"})]})]}),l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{children:"Estado"}),l.jsxs("select",{value:s.status,onChange:w=>N("status",w.target.value),className:"filter-select",children:[l.jsx("option",{value:"",children:"Todos los estados"}),l.jsx("option",{value:Re.ACTIVO,children:"✅ Activo"}),l.jsx("option",{value:Re.MANTENIMIENTO,children:"🔧 Mantenimiento"}),l.jsx("option",{value:Re.INACTIVO,children:"⏸️ Inactivo"}),l.jsx("option",{value:Re.REPARACION,children:"🔴 Reparación"})]})]}),l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{children:"Tipo de Combustible"}),l.jsxs("select",{value:s.fuelType,onChange:w=>N("fuelType",w.target.value),className:"filter-select",children:[l.jsx("option",{value:"",children:"Todos los combustibles"}),l.jsx("option",{value:_t.DIESEL,children:"🚛 Diesel"}),l.jsx("option",{value:_t.GASOLINA,children:"🚗 Gasolina"}),l.jsx("option",{value:_t.ACPM,children:"🚚 ACPM"}),l.jsx("option",{value:_t.MIXTO,children:"⛽ Mixto"})]})]}),l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{children:"Ubicación Actual"}),l.jsxs("select",{value:s.location,onChange:w=>N("location",w.target.value),className:"filter-select",children:[l.jsx("option",{value:"",children:"Todas las ubicaciones"}),_.map(w=>l.jsxs("option",{value:w,children:["📍 ",w]},w))]})]}),l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{children:"Mantenimiento"}),l.jsxs("select",{value:s.maintenance,onChange:w=>N("maintenance",w.target.value),className:"filter-select",children:[l.jsx("option",{value:"all",children:"Todos"}),l.jsx("option",{value:"due",children:"Mantenimiento debido"}),l.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),l.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),l.jsxs("div",{className:"filters-actions",children:[l.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:T===0,children:"🗑️ Limpiar Filtros"}),l.jsxs("div",{className:"filters-info",children:[l.jsxs("span",{className:"results-count",children:[m," resultado",m!==1?"s":""]}),T>0&&l.jsxs("span",{className:"active-filters-text",children:["(",T," filtro",T!==1?"s":""," activo",T!==1?"s":"",")"]})]})]})]}),T>0&&l.jsx("div",{className:"active-filters-summary",children:l.jsxs("div",{className:"summary-content",children:[l.jsx("span",{className:"summary-label",children:"Filtros activos:"}),l.jsxs("div",{className:"summary-tags",children:[s.type&&l.jsxs("span",{className:"summary-tag",onClick:()=>N("type",""),children:["Tipo: ",s.type," ✕"]}),s.status&&l.jsxs("span",{className:"summary-tag",onClick:()=>N("status",""),children:["Estado: ",s.status," ✕"]}),s.fuelType&&l.jsxs("span",{className:"summary-tag",onClick:()=>N("fuelType",""),children:["Combustible: ",s.fuelType," ✕"]}),s.location&&l.jsxs("span",{className:"summary-tag",onClick:()=>N("location",""),children:["Ubicación: ",s.location," ✕"]}),s.maintenance!=="all"&&l.jsxs("span",{className:"summary-tag",onClick:()=>N("maintenance","all"),children:["Mantenimiento: ",s.maintenance," ✕"]})]})]})}),l.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:l.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},q2=({vehicles:s,onEdit:e,onView:t,onMaintenance:a})=>{const o=A=>new Intl.NumberFormat("es-CO").format(A),c=A=>`${o(A)} gal`,d=A=>`${o(A)} hrs`,m=A=>A?(A instanceof Date?A:new Date(A)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",g=A=>{if(!A)return"";const L=new Date,W=A instanceof Date?A:new Date(A),H=Math.abs(L-W),U=Math.ceil(H/(1e3*60*60*24));return U===1?"hace 1 día":U<7?`hace ${U} días`:U<30?`hace ${Math.ceil(U/7)} semanas`:U<365?`hace ${Math.ceil(U/30)} meses`:`hace ${Math.ceil(U/365)} años`},v=A=>{switch(A){case ve.EXCAVADORA:return"vehicle-excavadora";case ve.BULLDOZER:return"vehicle-bulldozer";case ve.CARGADOR:return"vehicle-cargador";case ve.CAMION:return"vehicle-camion";case ve.GRUA:return"vehicle-grua";case ve.MOTOSIERRA:return"vehicle-motosierra";case ve.TRACTOR:return"vehicle-tractor";case ve.VOLQUETA:return"vehicle-volqueta";default:return"vehicle-default"}},_=A=>{switch(A){case Re.ACTIVO:return"status-activo";case Re.MANTENIMIENTO:return"status-mantenimiento";case Re.INACTIVO:return"status-inactivo";case Re.REPARACION:return"status-reparacion";default:return"status-default"}},T=A=>{switch(A){case ve.EXCAVADORA:return"🚚";case ve.BULLDOZER:return"🚜";case ve.CARGADOR:return"🏗️";case ve.CAMION:return"🚛";case ve.GRUA:return"🏗️";case ve.MOTOSIERRA:return"🪚";case ve.TRACTOR:return"🚜";case ve.VOLQUETA:return"🚛";default:return"🚗"}},N=A=>{switch(A){case _t.DIESEL:return"🚛";case _t.GASOLINA:return"🚗";case _t.ACPM:return"🚚";case _t.MIXTO:return"⛽";default:return"⛽"}},C=A=>{switch(A){case Re.ACTIVO:return"✅";case Re.MANTENIMIENTO:return"🔧";case Re.INACTIVO:return"⏸️";case Re.REPARACION:return"🔴";default:return"❓"}},w=A=>!A.totalHoursWorked||A.totalHoursWorked===0?A.estimatedConsumptionPerHour||0:A.totalFuelConsumed/A.totalHoursWorked,F=A=>A.lastMaintenanceDate?Math.floor((new Date-new Date(A.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return l.jsx("div",{className:"vehicles-cards",children:s.map(A=>l.jsxs("div",{className:`vehicle-card ${v(A.type)}`,children:[l.jsx("div",{className:"card-header",children:l.jsxs("div",{className:"vehicle-info",children:[l.jsxs("div",{className:"vehicle-id-section",children:[l.jsx("span",{className:"vehicle-icon",children:T(A.type)}),l.jsxs("div",{className:"vehicle-details",children:[l.jsx("span",{className:"vehicle-id",children:A.vehicleId}),l.jsx("span",{className:"vehicle-name",children:A.name})]})]}),l.jsxs("div",{className:`status-badge ${_(A.status)}`,children:[l.jsx("span",{className:"status-icon",children:C(A.status)}),l.jsx("span",{className:"status-label",children:A.status.charAt(0).toUpperCase()+A.status.slice(1)})]})]})}),l.jsxs("div",{className:"card-content",children:[l.jsxs("div",{className:"basic-info",children:[l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Tipo:"}),l.jsxs("span",{className:"info-value",children:[T(A.type)," ",A.type.charAt(0).toUpperCase()+A.type.slice(1)]})]}),A.brand&&A.model&&l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),l.jsxs("span",{className:"info-value",children:[A.brand," ",A.model]})]}),l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Combustible:"}),l.jsxs("span",{className:"info-value",children:[N(A.fuelType)," ",A.fuelType]})]}),A.currentLocation&&l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Ubicación:"}),l.jsxs("span",{className:"info-value",children:["📍 ",A.currentLocation]})]})]}),l.jsxs("div",{className:"consumption-metrics",children:[l.jsxs("div",{className:"metric-item",children:[l.jsx("div",{className:"metric-icon",children:"⛽"}),l.jsxs("div",{className:"metric-content",children:[l.jsx("div",{className:"metric-value",children:c(A.totalFuelConsumed||0)}),l.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),l.jsxs("div",{className:"metric-item",children:[l.jsx("div",{className:"metric-icon",children:"⏰"}),l.jsxs("div",{className:"metric-content",children:[l.jsx("div",{className:"metric-value",children:d(A.totalHoursWorked||0)}),l.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),l.jsxs("div",{className:"metric-item",children:[l.jsx("div",{className:"metric-icon",children:"📊"}),l.jsxs("div",{className:"metric-content",children:[l.jsxs("div",{className:"metric-value",children:[w(A).toFixed(1)," gal/hr"]}),l.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),l.jsxs("div",{className:"metric-item",children:[l.jsx("div",{className:"metric-icon",children:"🔄"}),l.jsxs("div",{className:"metric-content",children:[l.jsx("div",{className:"metric-value",children:A.totalMovements||0}),l.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(A.enginePower||A.fuelCapacity||A.year)&&l.jsxs("div",{className:"technical-specs",children:[A.enginePower&&l.jsxs("div",{className:"spec-item",children:[l.jsx("span",{className:"spec-icon",children:"⚡"}),l.jsxs("span",{className:"spec-value",children:[A.enginePower," HP"]})]}),A.fuelCapacity&&l.jsxs("div",{className:"spec-item",children:[l.jsx("span",{className:"spec-icon",children:"🛢️"}),l.jsxs("span",{className:"spec-value",children:[A.fuelCapacity," gal"]})]}),A.year&&l.jsxs("div",{className:"spec-item",children:[l.jsx("span",{className:"spec-icon",children:"📅"}),l.jsx("span",{className:"spec-value",children:A.year})]})]}),A.description&&l.jsx("div",{className:"description",children:l.jsx("p",{children:A.description})})]}),l.jsxs("div",{className:"card-footer",children:[l.jsxs("div",{className:"date-info",children:[A.lastMovementDate&&l.jsxs("div",{className:"date-item",children:[l.jsx("span",{className:"date-label",children:"Último movimiento:"}),l.jsx("span",{className:"date-value",children:m(A.lastMovementDate)}),l.jsx("span",{className:"date-relative",children:g(A.lastMovementDate)})]}),A.lastMaintenanceDate&&l.jsxs("div",{className:"date-item",children:[l.jsx("span",{className:"date-label",children:"Último mantenimiento:"}),l.jsx("span",{className:"date-value",children:m(A.lastMaintenanceDate)}),l.jsx("span",{className:"date-relative",children:g(A.lastMaintenanceDate)})]})]}),l.jsxs("div",{className:"card-actions",children:[l.jsx("button",{className:"btn-view",onClick:()=>t(A),title:"Ver detalles",children:"👁️"}),e&&A.status!==Re.REPARACION&&l.jsx("button",{className:"btn-edit",onClick:()=>e(A),title:"Editar vehículo",children:"✏️"}),a&&l.jsx("button",{className:"btn-maintenance",onClick:()=>a(A),title:"Registrar mantenimiento",children:"🔧"})]})]}),A.status===Re.MANTENIMIENTO&&l.jsx("div",{className:"maintenance-indicator",children:l.jsx("div",{className:"maintenance-pulse"})}),F(A)&&A.status===Re.ACTIVO&&l.jsx("div",{className:"maintenance-due-badge",children:l.jsx("span",{children:"Mantenimiento Debido"})}),A.status===Re.REPARACION&&l.jsx("div",{className:"repair-badge",children:l.jsx("span",{children:"En Reparación"})}),A.totalHoursWorked>0&&l.jsxs("div",{className:"efficiency-indicator",children:[l.jsx("div",{className:"efficiency-bar",children:l.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(A.totalHoursWorked/2e3*100,100)}%`}})}),l.jsxs("span",{className:"efficiency-label",children:[(A.totalHoursWorked/2e3*100).toFixed(1),"% utilización anual"]})]})]},A.id))})},z2=({vehicles:s,onEdit:e,onView:t,onMaintenance:a})=>{const[o,c]=J.useState("vehicleId"),[d,m]=J.useState("asc"),g=z=>new Intl.NumberFormat("es-CO").format(z),v=z=>`${g(z)} gal`,_=z=>`${g(z)} hrs`,T=z=>z?(z instanceof Date?z:new Date(z)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",N=z=>{switch(z){case ve.EXCAVADORA:return"🚚";case ve.BULLDOZER:return"🚜";case ve.CARGADOR:return"🏗️";case ve.CAMION:return"🚛";case ve.GRUA:return"🏗️";case ve.MOTOSIERRA:return"🪚";case ve.TRACTOR:return"🚜";case ve.VOLQUETA:return"🚛";default:return"🚗"}},C=z=>{switch(z){case _t.DIESEL:return"🚛";case _t.GASOLINA:return"🚗";case _t.ACPM:return"🚚";case _t.MIXTO:return"⛽";default:return"⛽"}},w=z=>{switch(z){case Re.ACTIVO:return"✅";case Re.MANTENIMIENTO:return"🔧";case Re.INACTIVO:return"⏸️";case Re.REPARACION:return"🔴";default:return"❓"}},F=z=>{switch(z){case Re.ACTIVO:return"status-activo";case Re.MANTENIMIENTO:return"status-mantenimiento";case Re.INACTIVO:return"status-inactivo";case Re.REPARACION:return"status-reparacion";default:return"status-default"}},A=z=>{o===z?m(d==="asc"?"desc":"asc"):(c(z),m("asc"))},L=[...s].sort((z,ae)=>{let O=z[o],x=ae[o];return(o.includes("Date")||o.includes("At"))&&(O=new Date(O||0),x=new Date(x||0)),typeof O=="number"&&typeof x=="number"?d==="asc"?O-x:x-O:typeof O=="string"&&typeof x=="string"?d==="asc"?O.localeCompare(x):x.localeCompare(O):O instanceof Date&&x instanceof Date?d==="asc"?O-x:x-O:!O&&!x?0:O?x?0:d==="asc"?-1:1:d==="asc"?1:-1}),W=z=>o!==z?"↕️":d==="asc"?"↑":"↓",H=z=>!z.totalHoursWorked||z.totalHoursWorked===0?z.estimatedConsumptionPerHour||0:z.totalFuelConsumed/z.totalHoursWorked,U=z=>z.lastMaintenanceDate?Math.floor((new Date-new Date(z.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return l.jsxs("div",{className:"vehicles-table-container",children:[l.jsx("div",{className:"table-wrapper",children:l.jsxs("table",{className:"vehicles-table",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsxs("th",{className:"sortable",onClick:()=>A("vehicleId"),children:["ID Vehículo ",W("vehicleId")]}),l.jsxs("th",{className:"sortable",onClick:()=>A("name"),children:["Nombre ",W("name")]}),l.jsxs("th",{className:"sortable",onClick:()=>A("type"),children:["Tipo ",W("type")]}),l.jsx("th",{children:"Marca/Modelo"}),l.jsxs("th",{className:"sortable",onClick:()=>A("fuelType"),children:["Combustible ",W("fuelType")]}),l.jsxs("th",{className:"sortable text-right",onClick:()=>A("totalFuelConsumed"),children:["Consumido ",W("totalFuelConsumed")]}),l.jsxs("th",{className:"sortable text-right",onClick:()=>A("totalHoursWorked"),children:["Horas ",W("totalHoursWorked")]}),l.jsx("th",{className:"text-right",children:"Consumo/Hr"}),l.jsx("th",{children:"Ubicación"}),l.jsxs("th",{className:"sortable",onClick:()=>A("status"),children:["Estado ",W("status")]}),l.jsxs("th",{className:"sortable",onClick:()=>A("lastMovementDate"),children:["Último Mov. ",W("lastMovementDate")]}),l.jsx("th",{className:"actions-column",children:"Acciones"})]})}),l.jsx("tbody",{children:L.map(z=>l.jsxs("tr",{className:`vehicle-row ${z.status===Re.MANTENIMIENTO?"maintenance-row":""} ${U(z)?"needs-maintenance":""}`,children:[l.jsx("td",{className:"vehicle-id-cell",children:l.jsxs("div",{className:"id-content",children:[l.jsx("span",{className:"vehicle-icon",children:N(z.type)}),l.jsx("span",{className:"vehicle-id",children:z.vehicleId})]})}),l.jsx("td",{className:"name-cell",children:l.jsx("span",{className:"vehicle-name",children:z.name})}),l.jsx("td",{className:"type-cell",children:l.jsx("span",{className:"type-text",children:z.type.charAt(0).toUpperCase()+z.type.slice(1)})}),l.jsx("td",{className:"brand-model-cell",children:z.brand&&z.model?l.jsxs("span",{className:"brand-model",children:[z.brand," ",z.model]}):l.jsx("span",{className:"no-data",children:"-"})}),l.jsx("td",{className:"fuel-cell",children:l.jsxs("div",{className:"fuel-content",children:[l.jsx("span",{className:"fuel-icon",children:C(z.fuelType)}),l.jsx("span",{className:"fuel-text",children:z.fuelType})]})}),l.jsx("td",{className:"consumption-cell text-right",children:l.jsx("span",{className:"consumption-value",children:v(z.totalFuelConsumed||0)})}),l.jsx("td",{className:"hours-cell text-right",children:l.jsx("span",{className:"hours-value",children:_(z.totalHoursWorked||0)})}),l.jsx("td",{className:"rate-cell text-right",children:l.jsxs("span",{className:"rate-value",children:[H(z).toFixed(1)," gal/hr"]})}),l.jsx("td",{className:"location-cell",children:l.jsxs("span",{className:"location-text",children:["📍 ",z.currentLocation||"Sin ubicación"]})}),l.jsx("td",{className:"status-cell",children:l.jsxs("div",{className:`status-badge ${F(z.status)}`,children:[l.jsx("span",{className:"status-icon",children:w(z.status)}),l.jsx("span",{className:"status-text",children:z.status.charAt(0).toUpperCase()+z.status.slice(1)})]})}),l.jsx("td",{className:"date-cell",children:l.jsxs("div",{className:"date-content",children:[l.jsx("span",{className:"date-value",children:T(z.lastMovementDate)}),U(z)&&l.jsx("span",{className:"maintenance-warning",children:"⚠️"})]})}),l.jsx("td",{className:"actions-cell",children:l.jsxs("div",{className:"action-buttons",children:[l.jsx("button",{className:"btn-action btn-view",onClick:()=>t(z),title:"Ver detalles",children:"👁️"}),e&&z.status!==Re.REPARACION&&l.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(z),title:"Editar vehículo",children:"✏️"}),a&&l.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>a(z),title:"Registrar mantenimiento",children:"🔧"})]})})]},z.id))})]})}),l.jsxs("div",{className:"table-info",children:[l.jsxs("div",{className:"table-summary",children:[l.jsxs("span",{className:"total-rows",children:[s.length," vehículo",s.length!==1?"s":""]}),o&&l.jsxs("span",{className:"sort-info",children:["Ordenado por ",o," (",d==="asc"?"ascendente":"descendente",")"]})]}),l.jsxs("div",{className:"table-legend",children:[l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-icon",children:"✅"})," Activo"]}),l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-icon",children:"🔧"})," Mantenimiento"]}),l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-icon",children:"⏸️"})," Inactivo"]}),l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-icon",children:"🔴"})," Reparación"]}),l.jsxs("span",{className:"legend-item",children:[l.jsx("span",{className:"legend-icon",children:"⚠️"})," Mantto. Debido"]})]})]})]})},B2=({vehicles:s,viewMode:e,onEdit:t,onView:a,onMaintenance:o})=>e==="table"?l.jsx(z2,{vehicles:s,onEdit:t,onView:a,onMaintenance:o}):l.jsx(q2,{vehicles:s,onEdit:t,onView:a,onMaintenance:o}),Zt={HARVESTING:"harvesting",TRANSPORT:"transport",MAINTENANCE:"maintenance",SUPPORT:"support"},Jt={CHAINSAW:"chainsaw",HARVESTER:"harvester",FORWARDER:"forwarder",SKIDDER:"skidder",LOG_TRUCK:"log_truck",PICKUP_TRUCK:"pickup_truck",CAR:"car",MOTORCYCLE:"motorcycle",ATV:"atv",BULLDOZER:"bulldozer",EXCAVATOR:"excavator",GRADER:"grader",LOADER:"loader",WATER_PUMP:"water_pump",FIRE_PUMP:"fire_pump",GENERATOR:"generator",COMPRESSOR:"compressor"},H2={[Jt.CHAINSAW]:{name:"Motosierra",category:Zt.HARVESTING,fuelType:"two_stroke",avgConsumption:2.5,icon:"🪚",color:"#dc2626",description:"Herramienta para corte de árboles"},[Jt.HARVESTER]:{name:"Cosechadora Forestal",category:Zt.HARVESTING,fuelType:"diesel",avgConsumption:25,icon:"🚜",color:"#059669",description:"Máquina para corte y procesamiento de árboles"},[Jt.FORWARDER]:{name:"Forwarder",category:Zt.HARVESTING,fuelType:"diesel",avgConsumption:20,icon:"🚚",color:"#0891b2",description:"Transporte de troncos dentro del bosque"},[Jt.LOG_TRUCK]:{name:"Camión Maderero",category:Zt.TRANSPORT,fuelType:"acpm",avgConsumption:3.5,icon:"🚚",color:"#ea580c",description:"Transporte de madera a destino"},[Jt.PICKUP_TRUCK]:{name:"Camioneta",category:Zt.TRANSPORT,fuelType:"gasoline",avgConsumption:8,icon:"🚐",color:"#2563eb",description:"Transporte de personal y herramientas"},[Jt.CAR]:{name:"Automóvil",category:Zt.TRANSPORT,fuelType:"gasoline",avgConsumption:12,icon:"🚗",color:"#3b82f6",description:"Vehículo liviano para transporte ejecutivo"},[Jt.MOTORCYCLE]:{name:"Motocicleta",category:Zt.TRANSPORT,fuelType:"gasoline",avgConsumption:25,icon:"🏍️",color:"#6366f1",description:"Transporte ágil para terrenos difíciles"},[Jt.ATV]:{name:"Cuatrimoto",category:Zt.TRANSPORT,fuelType:"gasoline",avgConsumption:15,icon:"🏍️",color:"#84cc16",description:"Vehículo todo terreno para supervisión"},[Jt.SKIDDER]:{name:"Skidder",category:Zt.HARVESTING,fuelType:"diesel",avgConsumption:22,icon:"🚜",color:"#f59e0b",description:"Arrastre de troncos desde el lugar de corte"},[Jt.BULLDOZER]:{name:"Bulldozer",category:Zt.MAINTENANCE,fuelType:"diesel",avgConsumption:30,icon:"🚜",color:"#f97316",description:"Construcción y mantenimiento de caminos"},[Jt.EXCAVATOR]:{name:"Excavadora",category:Zt.MAINTENANCE,fuelType:"diesel",avgConsumption:28,icon:"🏗️",color:"#eab308",description:"Excavación y movimiento de tierra"},[Jt.GRADER]:{name:"Motoniveladora",category:Zt.MAINTENANCE,fuelType:"diesel",avgConsumption:25,icon:"🚜",color:"#a3a3a3",description:"Nivelación y mantenimiento de vías"},[Jt.LOADER]:{name:"Cargador Frontal",category:Zt.MAINTENANCE,fuelType:"diesel",avgConsumption:24,icon:"🚜",color:"#71717a",description:"Carga y descarga de materiales"},[Jt.WATER_PUMP]:{name:"Motobomba de Agua",category:Zt.SUPPORT,fuelType:"gasoline",avgConsumption:3.5,icon:"💧",color:"#0891b2",description:"Bombeo de agua para operaciones"},[Jt.FIRE_PUMP]:{name:"Motobomba Contra Incendios",category:Zt.SUPPORT,fuelType:"gasoline",avgConsumption:4.2,icon:"🔥",color:"#dc2626",description:"Equipo de emergencia contra incendios"},[Jt.GENERATOR]:{name:"Generador Eléctrico",category:Zt.SUPPORT,fuelType:"gasoline",avgConsumption:2.8,icon:"⚡",color:"#7c3aed",description:"Suministro de energía eléctrica"},[Jt.COMPRESSOR]:{name:"Compresor de Aire",category:Zt.SUPPORT,fuelType:"gasoline",avgConsumption:2.5,icon:"💨",color:"#64748b",description:"Suministro de aire comprimido"}},G2=({isOpen:s,onClose:e,vehicle:t,onSave:a,mode:o="create",userRole:c})=>{const d=()=>({vehicleId:t?.vehicleId||"",name:t?.name||"",type:t?.type||ve.EXCAVADORA,brand:t?.brand||"",model:t?.model||"",year:t?.year||new Date().getFullYear(),fuelType:t?.fuelType||_t.DIESEL,fuelCapacity:t?.fuelCapacity||0,enginePower:t?.enginePower||0,status:t?.status||Re.ACTIVO,currentLocation:t?.currentLocation||"",description:t?.description||"",estimatedConsumptionPerHour:t?.estimatedConsumptionPerHour||0,serialNumber:t?.serialNumber||"",plateNumber:t?.plateNumber||"",lastMaintenanceDate:t?.lastMaintenanceDate?new Date(t.lastMaintenanceDate).toISOString().split("T")[0]:"",nextMaintenanceDate:t?.nextMaintenanceDate?new Date(t.nextMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:t?.purchaseDate?new Date(t.purchaseDate).toISOString().split("T")[0]:"",warrantyExpiration:t?.warrantyExpiration?new Date(t.warrantyExpiration).toISOString().split("T")[0]:""}),[m,g]=J.useState(d()),[v,_]=J.useState({}),[T,N]=J.useState(!1),[C,w]=J.useState(""),[F,A]=J.useState(!1);J.useEffect(()=>{s&&(g(d()),_({}))},[s,t]);const L=x=>{const{name:j,value:R,type:P}=x.target,M=P==="number"?parseFloat(R)||0:R;g(D=>({...D,[j]:M})),v[j]&&_(D=>({...D,[j]:null}))},W=()=>{const x={};m.vehicleId.trim()?m.vehicleId.length<3&&(x.vehicleId="El ID debe tener al menos 3 caracteres"):x.vehicleId="El ID del vehículo es obligatorio",m.name.trim()?m.name.length<2&&(x.name="El nombre debe tener al menos 2 caracteres"):x.name="El nombre del vehículo es obligatorio",m.fuelCapacity<=0?x.fuelCapacity="La capacidad de combustible debe ser mayor a 0":m.fuelCapacity>1e3&&(x.fuelCapacity="La capacidad no puede ser mayor a 1000 galones"),m.enginePower<0?x.enginePower="La potencia no puede ser negativa":m.enginePower>1e3&&(x.enginePower="La potencia no puede ser mayor a 1000 HP"),m.estimatedConsumptionPerHour<0?x.estimatedConsumptionPerHour="El consumo no puede ser negativo":m.estimatedConsumptionPerHour>50&&(x.estimatedConsumptionPerHour="El consumo no puede ser mayor a 50 gal/hr");const j=new Date().getFullYear();if(m.year<1990?x.year="El año no puede ser anterior a 1990":m.year>j+1&&(x.year=`El año no puede ser mayor a ${j+1}`),m.lastMaintenanceDate&&m.nextMaintenanceDate){const R=new Date(m.lastMaintenanceDate);new Date(m.nextMaintenanceDate)<=R&&(x.nextMaintenanceDate="La próxima fecha debe ser posterior al último mantenimiento")}return m.purchaseDate&&new Date(m.purchaseDate)>new Date&&(x.purchaseDate="La fecha de compra no puede ser futura"),_(x),Object.keys(x).length===0},H=async x=>{if(x.preventDefault(),!!W()){N(!0);try{const j={...m,lastMaintenanceDate:m.lastMaintenanceDate||null,nextMaintenanceDate:m.nextMaintenanceDate||null,purchaseDate:m.purchaseDate||null,warrantyExpiration:m.warrantyExpiration||null};await a(j),e()}catch(j){console.error("Error guardando vehículo:",j),_({general:"Error al guardar el vehículo. Intenta nuevamente."})}finally{N(!1)}}},U=x=>{switch(x){case ve.EXCAVADORA:return"🚚";case ve.BULLDOZER:return"🚜";case ve.CARGADOR:return"🏗️";case ve.CAMION:return"🚛";case ve.GRUA:return"🏗️";case ve.MOTOSIERRA:return"🪚";case ve.TRACTOR:return"🚜";case ve.VOLQUETA:return"🚛";default:return"🚗"}},z=x=>{switch(x){case _t.DIESEL:return"🚛";case _t.GASOLINA:return"🚗";case _t.ACPM:return"🚚";case _t.MIXTO:return"⛽";default:return"⛽"}},ae=o==="view",O=c==="admin"||c==="supervisor";return s?l.jsx("div",{className:"modal-overlay",onClick:e,children:l.jsxs("div",{className:"modal-content vehicle-modal",onClick:x=>x.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsxs("div",{className:"modal-title",children:[l.jsx("span",{className:"title-icon",children:o==="create"?"➕":o==="edit"?"✏️":"👁️"}),l.jsxs("div",{className:"title-text",children:[l.jsxs("h3",{children:[o==="create"&&"Crear Nuevo Vehículo",o==="edit"&&"Editar Vehículo",o==="view"&&"Detalles del Vehículo"]}),l.jsxs("p",{children:[o==="create"&&"Registra un nuevo vehículo en la flota",o==="edit"&&"Modifica la información del vehículo",o==="view"&&"Información completa del vehículo"]})]})]}),l.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),l.jsxs("form",{onSubmit:H,className:"modal-form",children:[l.jsxs("div",{className:"form-content",children:[l.jsxs("div",{className:"vehicle-preview",children:[l.jsxs("div",{className:"preview-header",children:[l.jsx("span",{className:"preview-icon",children:U(m.type)}),l.jsxs("div",{className:"preview-info",children:[l.jsx("span",{className:"preview-id",children:m.vehicleId||"ID-000"}),l.jsx("span",{className:"preview-name",children:m.name||"Nombre del vehículo"})]}),l.jsxs("div",{className:"preview-fuel",children:[l.jsx("span",{className:"fuel-icon",children:z(m.fuelType)}),l.jsx("span",{className:"fuel-text",children:m.fuelType})]})]}),l.jsxs("div",{className:"preview-specs",children:[m.enginePower>0&&l.jsxs("span",{className:"spec",children:["⚡ ",m.enginePower," HP"]}),m.fuelCapacity>0&&l.jsxs("span",{className:"spec",children:["🛢️ ",m.fuelCapacity," gal"]}),m.year&&l.jsxs("span",{className:"spec",children:["📅 ",m.year]})]})]}),v.general&&l.jsxs("div",{className:"error-message general-error",children:["⚠️ ",v.general]}),l.jsxs("div",{className:"form-section",children:[l.jsx("h4",{className:"section-title",children:"📋 Información Básica"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"vehicleId",children:"ID del Vehículo *"}),l.jsx("input",{type:"text",id:"vehicleId",name:"vehicleId",value:m.vehicleId,onChange:L,placeholder:"Ej: EXC-001",className:v.vehicleId?"error":"",disabled:ae||o==="edit"&&!O,maxLength:20}),v.vehicleId&&l.jsx("span",{className:"error-text",children:v.vehicleId})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"name",children:"Nombre del Vehículo *"}),l.jsx("input",{type:"text",id:"name",name:"name",value:m.name,onChange:L,placeholder:"Ej: Excavadora Principal",className:v.name?"error":"",disabled:ae||o==="edit"&&!O,maxLength:100}),v.name&&l.jsx("span",{className:"error-text",children:v.name})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"type",children:"Tipo de Vehículo"}),F?l.jsxs("div",{className:"custom-type-input",children:[l.jsx("input",{type:"text",placeholder:"Ej: Montacargas, Grúa Torre, etc.",value:C,onChange:x=>w(x.target.value),onKeyDown:x=>{x.key==="Enter"?(x.preventDefault(),C.trim()&&(g(j=>({...j,type:C.trim()})),A(!1),w(""))):x.key==="Escape"&&(A(!1),w(""))},autoFocus:!0}),l.jsx("button",{type:"button",className:"btn-confirm-custom",onClick:()=>{C.trim()&&(g(x=>({...x,type:C.trim()})),A(!1),w(""))},title:"Confirmar tipo personalizado",children:"✓"}),l.jsx("button",{type:"button",className:"btn-cancel-custom",onClick:()=>{A(!1),w("")},title:"Cancelar",children:"✕"})]}):l.jsxs("div",{className:"select-with-button",children:[l.jsx("select",{id:"type",name:"type",value:m.type,onChange:L,disabled:ae||o==="edit"&&!O,children:Object.entries(H2).map(([x,j])=>l.jsxs("option",{value:x,children:[j.icon," ",j.name]},x))}),l.jsx("button",{type:"button",className:"btn-add-custom",onClick:()=>A(!0),disabled:ae||o==="edit"&&!O,title:"Agregar tipo personalizado",children:"➕"})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"status",children:"Estado"}),l.jsx("select",{id:"status",name:"status",value:m.status,onChange:L,disabled:ae||o==="edit"&&!O,children:Object.values(Re).map(x=>l.jsx("option",{value:x,children:x.charAt(0).toUpperCase()+x.slice(1)},x))})]})]})]}),l.jsxs("div",{className:"form-section",children:[l.jsx("h4",{className:"section-title",children:"🔧 Especificaciones Técnicas"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"brand",children:"Marca"}),l.jsx("input",{type:"text",id:"brand",name:"brand",value:m.brand,onChange:L,placeholder:"Ej: Caterpillar",disabled:ae||o==="edit"&&!O,maxLength:50})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"model",children:"Modelo"}),l.jsx("input",{type:"text",id:"model",name:"model",value:m.model,onChange:L,placeholder:"Ej: 320D",disabled:ae||o==="edit"&&!O,maxLength:50})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"year",children:"Año"}),l.jsx("input",{type:"number",id:"year",name:"year",value:m.year,onChange:L,min:"1990",max:new Date().getFullYear()+1,className:v.year?"error":"",disabled:ae||o==="edit"&&!O}),v.year&&l.jsx("span",{className:"error-text",children:v.year})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"serialNumber",children:"Número de Serie"}),l.jsx("input",{type:"text",id:"serialNumber",name:"serialNumber",value:m.serialNumber,onChange:L,placeholder:"Ej: ABC123456789",disabled:ae||o==="edit"&&!O,maxLength:50})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"plateNumber",children:"Placa"}),l.jsx("input",{type:"text",id:"plateNumber",name:"plateNumber",value:m.plateNumber,onChange:L,placeholder:"Ej: ABC123",disabled:ae||o==="edit"&&!O,maxLength:10})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"enginePower",children:"Potencia del Motor (HP)"}),l.jsx("input",{type:"number",id:"enginePower",name:"enginePower",value:m.enginePower,onChange:L,min:"0",max:"1000",step:"0.1",className:v.enginePower?"error":"",disabled:ae||o==="edit"&&!O}),v.enginePower&&l.jsx("span",{className:"error-text",children:v.enginePower})]})]})]}),l.jsxs("div",{className:"form-section",children:[l.jsx("h4",{className:"section-title",children:"⛽ Información de Combustible"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"fuelType",children:"Tipo de Combustible"}),l.jsx("select",{id:"fuelType",name:"fuelType",value:m.fuelType,onChange:L,disabled:ae||o==="edit"&&!O,children:Object.values(_t).map(x=>l.jsxs("option",{value:x,children:[z(x)," ",x.charAt(0).toUpperCase()+x.slice(1)]},x))})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"fuelCapacity",children:"Capacidad de Combustible (gal) *"}),l.jsx("input",{type:"number",id:"fuelCapacity",name:"fuelCapacity",value:m.fuelCapacity,onChange:L,min:"0",max:"1000",step:"0.1",className:v.fuelCapacity?"error":"",disabled:ae||o==="edit"&&!O}),v.fuelCapacity&&l.jsx("span",{className:"error-text",children:v.fuelCapacity})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"estimatedConsumptionPerHour",children:"Consumo Estimado (gal/hr)"}),l.jsx("input",{type:"number",id:"estimatedConsumptionPerHour",name:"estimatedConsumptionPerHour",value:m.estimatedConsumptionPerHour,onChange:L,min:"0",max:"50",step:"0.1",className:v.estimatedConsumptionPerHour?"error":"",disabled:ae||o==="edit"&&!O}),v.estimatedConsumptionPerHour&&l.jsx("span",{className:"error-text",children:v.estimatedConsumptionPerHour})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"currentLocation",children:"Ubicación Actual"}),l.jsx("input",{type:"text",id:"currentLocation",name:"currentLocation",value:m.currentLocation,onChange:L,placeholder:"Ej: Sector Norte - Lote 15",disabled:ae||o==="edit"&&!O,maxLength:100})]})]})]}),l.jsxs("div",{className:"form-section",children:[l.jsx("h4",{className:"section-title",children:"📅 Fechas Importantes"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"purchaseDate",children:"Fecha de Compra"}),l.jsx("input",{type:"date",id:"purchaseDate",name:"purchaseDate",value:m.purchaseDate,onChange:L,max:new Date().toISOString().split("T")[0],className:v.purchaseDate?"error":"",disabled:ae||o==="edit"&&!O}),v.purchaseDate&&l.jsx("span",{className:"error-text",children:v.purchaseDate})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"warrantyExpiration",children:"Vencimiento de Garantía"}),l.jsx("input",{type:"date",id:"warrantyExpiration",name:"warrantyExpiration",value:m.warrantyExpiration,onChange:L,disabled:ae||o==="edit"&&!O})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"lastMaintenanceDate",children:"Último Mantenimiento"}),l.jsx("input",{type:"date",id:"lastMaintenanceDate",name:"lastMaintenanceDate",value:m.lastMaintenanceDate,onChange:L,disabled:ae||o==="edit"&&!O})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),l.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:m.nextMaintenanceDate,onChange:L,className:v.nextMaintenanceDate?"error":"",disabled:ae||o==="edit"&&!O}),v.nextMaintenanceDate&&l.jsx("span",{className:"error-text",children:v.nextMaintenanceDate})]})]})]}),l.jsxs("div",{className:"form-section",children:[l.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"description",children:"Descripción"}),l.jsx("textarea",{id:"description",name:"description",value:m.description,onChange:L,placeholder:"Información adicional sobre el vehículo...",rows:"3",maxLength:"500",disabled:ae||o==="edit"&&!O}),l.jsxs("span",{className:"char-count",children:[m.description.length,"/500 caracteres"]})]})]})]}),l.jsxs("div",{className:"modal-footer",children:[l.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:T,children:o==="view"?"Cerrar":"Cancelar"}),!ae&&O&&l.jsx("button",{type:"submit",className:"btn-primary",disabled:T,children:T?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):l.jsx(l.Fragment,{children:o==="create"?"➕ Crear Vehículo":"💾 Guardar Cambios"})})]})]})]})}):null},Co={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},aa={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},Io={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},$2=({isOpen:s,onClose:e,vehicle:t,maintenance:a,onSave:o,mode:c="create",userRole:d})=>{const m=()=>({vehicleId:t?.vehicleId||"",vehicleName:t?.name||"",type:a?.type||Co.PREVENTIVO,title:a?.title||"",description:a?.description||"",priority:a?.priority||Io.MEDIA,status:a?.status||aa.PROGRAMADO,scheduledDate:a?.scheduledDate?new Date(a.scheduledDate).toISOString().split("T")[0]:"",startDate:a?.startDate?new Date(a.startDate).toISOString().split("T")[0]:"",completedDate:a?.completedDate?new Date(a.completedDate).toISOString().split("T")[0]:"",estimatedHours:a?.estimatedHours||0,actualHours:a?.actualHours||0,estimatedCost:a?.estimatedCost||0,actualCost:a?.actualCost||0,technician:a?.technician||"",workshop:a?.workshop||"",parts:a?.parts||[],notes:a?.notes||"",nextMaintenanceKm:a?.nextMaintenanceKm||0,nextMaintenanceHours:a?.nextMaintenanceHours||0,nextMaintenanceDate:a?.nextMaintenanceDate?new Date(a.nextMaintenanceDate).toISOString().split("T")[0]:""}),[g,v]=J.useState(m()),[_,T]=J.useState({}),[N,C]=J.useState(!1),[w,F]=J.useState({name:"",quantity:1,cost:0});J.useEffect(()=>{s&&(v(m()),T({}))},[s,a,t]);const A=M=>{const{name:D,value:re,type:ye}=M.target,G=ye==="number"?parseFloat(re)||0:re;v(ne=>({...ne,[D]:G})),_[D]&&T(ne=>({...ne,[D]:null}))},L=M=>{const{name:D,value:re,type:ye}=M.target,G=ye==="number"?parseFloat(re)||0:re;F(ne=>({...ne,[D]:G}))},W=()=>{if(!w.name.trim())return;const M={id:Date.now().toString(),name:w.name.trim(),quantity:w.quantity,cost:w.cost,total:w.quantity*w.cost};v(D=>({...D,parts:[...D.parts,M]})),F({name:"",quantity:1,cost:0})},H=M=>{v(D=>({...D,parts:D.parts.filter(re=>re.id!==M)}))},U=()=>{const M={};if(g.title.trim()||(M.title="El título del mantenimiento es obligatorio"),g.description.trim()||(M.description="La descripción es obligatoria"),g.scheduledDate||(M.scheduledDate="La fecha programada es obligatoria"),g.startDate&&g.completedDate){const D=new Date(g.startDate);new Date(g.completedDate)<D&&(M.completedDate="La fecha de finalización debe ser posterior al inicio")}return g.scheduledDate&&g.startDate&&(new Date(g.scheduledDate),new Date(g.startDate)),g.estimatedHours<0&&(M.estimatedHours="Las horas estimadas no pueden ser negativas"),g.actualHours<0&&(M.actualHours="Las horas reales no pueden ser negativas"),g.estimatedCost<0&&(M.estimatedCost="El costo estimado no puede ser negativo"),g.actualCost<0&&(M.actualCost="El costo real no puede ser negativo"),g.status===aa.COMPLETADO&&!g.completedDate&&(M.completedDate="La fecha de finalización es obligatoria para mantenimientos completados"),g.status===aa.EN_PROCESO&&!g.startDate&&(M.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),T(M),Object.keys(M).length===0},z=async M=>{if(M.preventDefault(),!!U()){C(!0);try{const D=g.parts.reduce((ne,ce)=>ne+ce.total,0),re=g.estimatedCost+D,ye=g.actualCost+D,G={...g,vehicleId:t.id,vehicleName:t.name,totalPartsCost:D,totalEstimatedCost:re,totalActualCost:ye,scheduledDate:g.scheduledDate||null,startDate:g.startDate||null,completedDate:g.completedDate||null,nextMaintenanceDate:g.nextMaintenanceDate||null,createdAt:a?.createdAt||new Date,updatedAt:new Date};await o(G),e()}catch(D){console.error("Error guardando mantenimiento:",D),T({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{C(!1)}}},ae=M=>{switch(M){case Co.PREVENTIVO:return"🔧";case Co.CORRECTIVO:return"🛠️";case Co.PREDICTIVO:return"📊";case Co.EMERGENCIA:return"🚨";default:return"⚙️"}},O=M=>{switch(M){case Io.BAJA:return"priority-low";case Io.MEDIA:return"priority-medium";case Io.ALTA:return"priority-high";case Io.CRITICA:return"priority-critical";default:return"priority-medium"}},x=M=>{switch(M){case aa.PROGRAMADO:return"status-scheduled";case aa.EN_PROCESO:return"status-in-progress";case aa.COMPLETADO:return"status-completed";case aa.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},j=()=>g.parts.reduce((M,D)=>M+D.total,0),R=c==="view",P=d==="admin"||d==="supervisor";return s?l.jsx("div",{className:"modal-overlay",onClick:e,children:l.jsxs("div",{className:"modal-content maintenance-modal",onClick:M=>M.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsxs("div",{className:"modal-title",children:[l.jsx("span",{className:"title-icon",children:c==="create"?"➕":c==="edit"?"✏️":"👁️"}),l.jsxs("div",{className:"title-text",children:[l.jsxs("h3",{children:[c==="create"&&"Registrar Mantenimiento",c==="edit"&&"Editar Mantenimiento",c==="view"&&"Detalles del Mantenimiento"]}),l.jsxs("p",{children:["Vehículo: ",t?.vehicleId," - ",t?.name]})]})]}),l.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),l.jsxs("form",{onSubmit:z,className:"modal-form",children:[l.jsxs("div",{className:"form-content",children:[_.general&&l.jsxs("div",{className:"error-message general-error",children:["⚠️ ",_.general]}),l.jsxs("div",{className:"form-section",children:[l.jsx("h4",{className:"section-title",children:"📋 Información del Mantenimiento"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),l.jsx("select",{id:"type",name:"type",value:g.type,onChange:A,disabled:R||c==="edit"&&!P,children:Object.values(Co).map(M=>l.jsxs("option",{value:M,children:[ae(M)," ",M.charAt(0).toUpperCase()+M.slice(1)]},M))})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"priority",children:"Prioridad"}),l.jsx("select",{id:"priority",name:"priority",value:g.priority,onChange:A,className:O(g.priority),disabled:R||c==="edit"&&!P,children:Object.values(Io).map(M=>l.jsx("option",{value:M,children:M.charAt(0).toUpperCase()+M.slice(1)},M))})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"status",children:"Estado"}),l.jsx("select",{id:"status",name:"status",value:g.status,onChange:A,className:x(g.status),disabled:R||c==="edit"&&!P,children:Object.values(aa).map(M=>l.jsx("option",{value:M,children:M.charAt(0).toUpperCase()+M.slice(1).replace("_"," ")},M))})]}),l.jsxs("div",{className:"form-group full-width",children:[l.jsx("label",{htmlFor:"title",children:"Título del Mantenimiento *"}),l.jsx("input",{type:"text",id:"title",name:"title",value:g.title,onChange:A,placeholder:"Ej: Cambio de aceite y filtros",className:_.title?"error":"",disabled:R||c==="edit"&&!P,maxLength:100}),_.title&&l.jsx("span",{className:"error-text",children:_.title})]})]})]}),l.jsxs("div",{className:"form-section",children:[l.jsx("h4",{className:"section-title",children:"📅 Programación"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),l.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:g.scheduledDate,onChange:A,className:_.scheduledDate?"error":"",disabled:R||c==="edit"&&!P}),_.scheduledDate&&l.jsx("span",{className:"error-text",children:_.scheduledDate})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),l.jsx("input",{type:"date",id:"startDate",name:"startDate",value:g.startDate,onChange:A,className:_.startDate?"error":"",disabled:R||c==="edit"&&!P}),_.startDate&&l.jsx("span",{className:"error-text",children:_.startDate})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalización"}),l.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:g.completedDate,onChange:A,className:_.completedDate?"error":"",disabled:R||c==="edit"&&!P}),_.completedDate&&l.jsx("span",{className:"error-text",children:_.completedDate})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),l.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:g.nextMaintenanceDate,onChange:A,disabled:R||c==="edit"&&!P})]})]})]}),l.jsxs("div",{className:"form-section",children:[l.jsx("h4",{className:"section-title",children:"💰 Recursos y Costos"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"technician",children:"Técnico Responsable"}),l.jsx("input",{type:"text",id:"technician",name:"technician",value:g.technician,onChange:A,placeholder:"Nombre del técnico",disabled:R||c==="edit"&&!P,maxLength:100})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicación"}),l.jsx("input",{type:"text",id:"workshop",name:"workshop",value:g.workshop,onChange:A,placeholder:"Taller donde se realiza",disabled:R||c==="edit"&&!P,maxLength:100})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),l.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:g.estimatedHours,onChange:A,min:"0",step:"0.5",className:_.estimatedHours?"error":"",disabled:R||c==="edit"&&!P}),_.estimatedHours&&l.jsx("span",{className:"error-text",children:_.estimatedHours})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),l.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:g.actualHours,onChange:A,min:"0",step:"0.5",className:_.actualHours?"error":"",disabled:R||c==="edit"&&!P}),_.actualHours&&l.jsx("span",{className:"error-text",children:_.actualHours})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),l.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:g.estimatedCost,onChange:A,min:"0",step:"1000",className:_.estimatedCost?"error":"",disabled:R||c==="edit"&&!P}),_.estimatedCost&&l.jsx("span",{className:"error-text",children:_.estimatedCost})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),l.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:g.actualCost,onChange:A,min:"0",step:"1000",className:_.actualCost?"error":"",disabled:R||c==="edit"&&!P}),_.actualCost&&l.jsx("span",{className:"error-text",children:_.actualCost})]})]})]}),l.jsxs("div",{className:"form-section",children:[l.jsx("h4",{className:"section-title",children:"🔧 Partes y Repuestos"}),!R&&P&&l.jsx("div",{className:"parts-form",children:l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),l.jsx("input",{type:"text",id:"partName",name:"name",value:w.name,onChange:L,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),l.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:w.quantity,onChange:L,min:"1",step:"1"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),l.jsx("input",{type:"number",id:"partCost",name:"cost",value:w.cost,onChange:L,min:"0",step:"1000"})]}),l.jsx("div",{className:"form-group",children:l.jsx("button",{type:"button",className:"btn-add-part",onClick:W,disabled:!w.name.trim(),children:"➕ Agregar"})})]})}),g.parts.length>0&&l.jsx("div",{className:"parts-list",children:l.jsxs("table",{className:"parts-table",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Parte"}),l.jsx("th",{children:"Cantidad"}),l.jsx("th",{children:"Costo Unit."}),l.jsx("th",{children:"Total"}),!R&&P&&l.jsx("th",{children:"Acciones"})]})}),l.jsx("tbody",{children:g.parts.map(M=>l.jsxs("tr",{children:[l.jsx("td",{children:M.name}),l.jsx("td",{children:M.quantity}),l.jsxs("td",{children:["$",M.cost.toLocaleString("es-CO")]}),l.jsxs("td",{children:["$",M.total.toLocaleString("es-CO")]}),!R&&P&&l.jsx("td",{children:l.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>H(M.id),title:"Eliminar parte",children:"🗑️"})})]},M.id))}),l.jsx("tfoot",{children:l.jsxs("tr",{className:"total-row",children:[l.jsx("td",{colSpan:"3",children:l.jsx("strong",{children:"Total Partes:"})}),l.jsx("td",{children:l.jsxs("strong",{children:["$",j().toLocaleString("es-CO")]})}),!R&&P&&l.jsx("td",{})]})})]})})]}),l.jsxs("div",{className:"form-section",children:[l.jsx("h4",{className:"section-title",children:"🔄 Próximo Mantenimiento"}),l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Próximo Mantenimiento (Km)"}),l.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:g.nextMaintenanceKm,onChange:A,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:R||c==="edit"&&!P})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Próximo Mantenimiento (Horas)"}),l.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:g.nextMaintenanceHours,onChange:A,min:"0",step:"100",placeholder:"0 = No aplica",disabled:R||c==="edit"&&!P})]})]})]}),l.jsxs("div",{className:"form-section",children:[l.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"description",children:"Descripción del Trabajo *"}),l.jsx("textarea",{id:"description",name:"description",value:g.description,onChange:A,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:_.description?"error":"",disabled:R||c==="edit"&&!P}),_.description&&l.jsx("span",{className:"error-text",children:_.description})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),l.jsx("textarea",{id:"notes",name:"notes",value:g.notes,onChange:A,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:R||c==="edit"&&!P}),l.jsxs("span",{className:"char-count",children:[g.notes.length,"/500 caracteres"]})]})]}),l.jsxs("div",{className:"cost-summary",children:[l.jsx("h4",{children:"💰 Resumen de Costos"}),l.jsxs("div",{className:"cost-grid",children:[l.jsxs("div",{className:"cost-item",children:[l.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),l.jsxs("span",{className:"cost-value",children:["$",g.actualCost.toLocaleString("es-CO")]})]}),l.jsxs("div",{className:"cost-item",children:[l.jsx("span",{className:"cost-label",children:"Partes:"}),l.jsxs("span",{className:"cost-value",children:["$",j().toLocaleString("es-CO")]})]}),l.jsxs("div",{className:"cost-item total-cost",children:[l.jsx("span",{className:"cost-label",children:"Total:"}),l.jsxs("span",{className:"cost-value",children:["$",(g.actualCost+j()).toLocaleString("es-CO")]})]})]})]})]}),l.jsxs("div",{className:"modal-footer",children:[l.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:N,children:c==="view"?"Cerrar":"Cancelar"}),!R&&P&&l.jsx("button",{type:"submit",className:"btn-primary",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):l.jsx(l.Fragment,{children:c==="create"?"➕ Registrar Mantenimiento":"💾 Guardar Cambios"})})]})]})]})}):null},K2=()=>{const{user:s,userProfile:e}=Ci(),[t,a]=J.useState([]),[o,c]=J.useState(null),[d,m]=J.useState(!0),[g,v]=J.useState(null),[_,T]=J.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[N,C]=J.useState("cards"),[w,F]=J.useState(""),[A,L]=J.useState(!1),[W,H]=J.useState(!1),[U,z]=J.useState(null),[ae,O]=J.useState("create");J.useEffect(()=>{if(!s)return;m(!0);const ge=ZA((V,ee)=>{if(ee){console.error("Error en suscripción de vehículos:",ee),v("Error al cargar vehículos"),m(!1);return}a(V),v(null),m(!1)},_);return()=>ge()},[s,_]),J.useEffect(()=>{s&&(async()=>{try{const V=await b2(_);c(V)}catch(V){console.error("Error al cargar estadísticas:",V)}})()},[s,t,_]);const x=t.filter(ge=>{if(!w)return!0;const V=w.toLowerCase();return ge.vehicleId?.toLowerCase().includes(V)||ge.name?.toLowerCase().includes(V)||ge.type?.toLowerCase().includes(V)||ge.brand?.toLowerCase().includes(V)||ge.model?.toLowerCase().includes(V)||ge.currentLocation?.toLowerCase().includes(V)||ge.description?.toLowerCase().includes(V)}),j=()=>{z(null),O("create"),L(!0)},R=ge=>{z(ge),O("edit"),L(!0)},P=ge=>{z(ge),O("view"),L(!0)},M=ge=>{z(ge),H(!0)},D=()=>{L(!1),H(!1),z(null)},re=ge=>{T(V=>({...V,...ge}))},ye=()=>{T({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),F("")},G=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",ne=e?.role==="admin",ce=e?.role==="admin"||e?.role==="contador";return d?l.jsx("div",{className:"vehicles-main",children:l.jsxs("div",{className:"loading-container",children:[l.jsx("div",{className:"loading-spinner"}),l.jsx("p",{children:"Cargando vehículos..."})]})}):g?l.jsx("div",{className:"vehicles-main",children:l.jsxs("div",{className:"error-container",children:[l.jsx("div",{className:"error-icon",children:"⚠️"}),l.jsx("h3",{children:"Error al cargar vehículos"}),l.jsx("p",{children:g}),l.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):l.jsxs("div",{className:"vehicles-main",children:[l.jsxs("div",{className:"vehicles-header",children:[l.jsxs("div",{className:"header-title",children:[l.jsx("h2",{children:"🚜 Gestión de Vehículos"}),l.jsx("p",{children:"Administra la maquinaria y vehículos forestales"})]}),G&&l.jsx("button",{className:"btn-create-vehicle",onClick:j,children:"➕ Nuevo Vehículo"})]}),o&&l.jsx(U2,{stats:o,filters:_}),l.jsx(F2,{filters:_,onFilterChange:re,onClearFilters:ye,searchTerm:w,onSearchChange:F,viewMode:N,onViewModeChange:C,totalResults:x.length}),x.length===0?l.jsxs("div",{className:"empty-state",children:[l.jsx("div",{className:"empty-icon",children:"🚜"}),l.jsx("h3",{children:t.length===0?"No hay vehículos registrados":"No se encontraron vehículos"}),l.jsx("p",{children:t.length===0?"Comienza registrando tu primer vehículo o maquinaria forestal":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&G&&l.jsx("button",{className:"btn-create-first",onClick:j,children:"➕ Registrar Primer Vehículo"})]}):l.jsx(B2,{vehicles:x,viewMode:N,onEdit:ne?R:null,onView:P,onMaintenance:ce?M:null,userRole:s?.role}),A&&l.jsx(G2,{isOpen:A,onClose:D,vehicle:U,mode:ae,onSuccess:()=>{D()}}),W&&l.jsx($2,{isOpen:W,onClose:D,vehicle:U,onSuccess:()=>{D()}})]})},Y2=({suppliers:s,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const[c,d]=J.useState("name"),[m,g]=J.useState("asc"),v=L=>{c===L?g(m==="asc"?"desc":"asc"):(d(L),g("asc"))},_=[...s].sort((L,W)=>{let H=L[c],U=W[c];switch(c){case"rating":H=H||0,U=U||0;break;case"totalOrders":case"totalPurchased":H=H||0,U=U||0;break;case"createdAt":case"lastOrderDate":H=H?H.toDate?H.toDate():new Date(H):new Date(0),U=U?U.toDate?U.toDate():new Date(U):new Date(0);break;default:H=(H||"").toString().toLowerCase(),U=(U||"").toString().toLowerCase()}return H<U?m==="asc"?-1:1:H>U?m==="asc"?1:-1:0}),T=L=>{switch(L){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},N=L=>{switch(L){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},C=L=>L?(L.toDate?L.toDate():new Date(L)).toLocaleDateString("es-CO"):"-",w=L=>{const W=[];for(let H=1;H<=5;H++)W.push(l.jsx("span",{className:`star ${H<=L?"filled":""}`,children:"★"},H));return l.jsx("div",{className:"rating-stars",children:W})},F=L=>!L||L.length===0?l.jsx("span",{className:"no-data",children:"-"}):l.jsxs("div",{className:"fuel-types-cell",children:[L.slice(0,2).map(W=>l.jsx("span",{className:"fuel-badge-sm",children:En[W]||W},W)),L.length>2&&l.jsxs("span",{className:"fuel-badge-sm more",title:L.slice(2).map(W=>En[W]||W).join(", "),children:["+",L.length-2]})]}),A=L=>c!==L?"icon-chevrons-up-down":m==="asc"?"icon-chevron-up":"icon-chevron-down";return l.jsxs("div",{className:"suppliers-table-container",children:[l.jsxs("div",{className:"table-wrapper",children:[l.jsxs("table",{className:"suppliers-table",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsxs("th",{className:`sortable ${c==="name"?"active":""}`,onClick:()=>v("name"),children:[l.jsx("span",{children:"Proveedor"}),l.jsx("i",{className:A("name")})]}),l.jsxs("th",{className:`sortable ${c==="status"?"active":""}`,onClick:()=>v("status"),children:[l.jsx("span",{children:"Estado"}),l.jsx("i",{className:A("status")})]}),l.jsxs("th",{className:`sortable ${c==="category"?"active":""}`,onClick:()=>v("category"),children:[l.jsx("span",{children:"Categoría"}),l.jsx("i",{className:A("category")})]}),l.jsx("th",{children:l.jsx("span",{children:"Combustibles"})}),l.jsx("th",{children:l.jsx("span",{children:"Contacto"})}),l.jsxs("th",{className:`sortable ${c==="rating"?"active":""}`,onClick:()=>v("rating"),children:[l.jsx("span",{children:"Rating"}),l.jsx("i",{className:A("rating")})]}),l.jsxs("th",{className:`sortable ${c==="totalOrders"?"active":""}`,onClick:()=>v("totalOrders"),children:[l.jsx("span",{children:"Órdenes"}),l.jsx("i",{className:A("totalOrders")})]}),l.jsxs("th",{className:`sortable ${c==="totalPurchased"?"active":""}`,onClick:()=>v("totalPurchased"),children:[l.jsx("span",{children:"Total Comprado"}),l.jsx("i",{className:A("totalPurchased")})]}),l.jsxs("th",{className:`sortable ${c==="createdAt"?"active":""}`,onClick:()=>v("createdAt"),children:[l.jsx("span",{children:"Creado"}),l.jsx("i",{className:A("createdAt")})]}),l.jsx("th",{className:"actions-column",children:l.jsx("span",{children:"Acciones"})})]})}),l.jsx("tbody",{children:_.map(L=>l.jsxs("tr",{className:`supplier-row ${L.status}`,children:[l.jsx("td",{className:"supplier-info-cell",children:l.jsxs("div",{className:"supplier-main-info",children:[l.jsxs("div",{className:"supplier-name",children:[L.name,L.isPreferred&&l.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:l.jsx("i",{className:"icon-star"})})]}),L.taxId&&l.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",L.taxId]}),L.type&&l.jsx("div",{className:"supplier-type",children:L.type.charAt(0).toUpperCase()+L.type.slice(1)})]})}),l.jsx("td",{className:"status-cell",children:l.jsxs("div",{className:"status-display",children:[l.jsx("span",{className:"status-dot",style:{backgroundColor:T(L.status)}}),l.jsx("span",{className:"status-label",children:N(L.status)})]})}),l.jsx("td",{className:"category-cell",children:l.jsx("span",{className:"category-label",children:L.category?.charAt(0).toUpperCase()+L.category?.slice(1)||"-"})}),l.jsx("td",{className:"fuel-types-cell",children:F(L.fuelTypes)}),l.jsx("td",{className:"contact-cell",children:l.jsxs("div",{className:"contact-info",children:[L.contactPerson&&l.jsxs("div",{className:"contact-person",children:[l.jsx("i",{className:"icon-user"}),l.jsx("span",{children:L.contactPerson})]}),L.phone&&l.jsxs("div",{className:"contact-item",children:[l.jsx("i",{className:"icon-phone"}),l.jsx("a",{href:`tel:${L.phone}`,children:L.phone})]}),L.email&&l.jsxs("div",{className:"contact-item",children:[l.jsx("i",{className:"icon-mail"}),l.jsx("a",{href:`mailto:${L.email}`,children:L.email})]}),L.city&&l.jsxs("div",{className:"contact-item",children:[l.jsx("i",{className:"icon-map-pin"}),l.jsx("span",{children:L.city})]})]})}),l.jsx("td",{className:"rating-cell",children:l.jsxs("div",{className:"rating-display",children:[w(L.rating||0),l.jsx("span",{className:"rating-value",children:(L.rating||0).toFixed(1)})]})}),l.jsx("td",{className:"orders-cell",children:l.jsx("span",{className:"orders-count",children:L.totalOrders||0})}),l.jsx("td",{className:"purchased-cell",children:l.jsx("span",{className:"purchased-amount",children:Ir(L.totalPurchased||0)})}),l.jsx("td",{className:"date-cell",children:l.jsx("span",{className:"date-value",children:C(L.createdAt)})}),l.jsx("td",{className:"actions-cell",children:l.jsxs("div",{className:"action-buttons",children:[a&&l.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(L),title:"Editar proveedor",children:l.jsx("i",{className:"icon-edit"})}),o&&L.status==="active"&&l.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(L.id,L.name),title:"Desactivar proveedor",children:l.jsx("i",{className:"icon-x-circle"})}),l.jsxs("div",{className:"quick-actions",children:[L.phone&&l.jsx("a",{href:`tel:${L.phone}`,className:"quick-action-btn",title:"Llamar",children:l.jsx("i",{className:"icon-phone"})}),L.email&&l.jsx("a",{href:`mailto:${L.email}`,className:"quick-action-btn",title:"Enviar email",children:l.jsx("i",{className:"icon-mail"})})]})]})})]},L.id))})]}),_.length===0&&l.jsxs("div",{className:"table-empty-state",children:[l.jsx("i",{className:"icon-truck"}),l.jsx("p",{children:"No hay proveedores para mostrar"})]})]}),l.jsxs("div",{className:"table-footer",children:[l.jsx("div",{className:"table-info",children:l.jsxs("span",{children:["Mostrando ",_.length," proveedor",_.length!==1?"es":""]})}),l.jsx("div",{className:"table-actions",children:l.jsxs("span",{className:"sort-info",children:["Ordenado por: ",c==="name"?"Nombre":c==="status"?"Estado":c==="category"?"Categoría":c==="rating"?"Rating":c==="totalOrders"?"Órdenes":c==="totalPurchased"?"Total Comprado":c==="createdAt"?"Fecha de Creación":c," (",m==="asc"?"Ascendente":"Descendente",")"]})})]})]})},Q2=({suppliers:s,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const c=C=>{switch(C){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},d=C=>{switch(C){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},m=C=>{switch(C){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},g=C=>{switch(C){case"proveedor":return"Proveedor";case"distribuidor":return"Distribuidor";case"mayorista":return"Mayorista";default:return"Sin especificar"}},v=C=>C?(C.toDate?C.toDate():new Date(C)).toLocaleDateString("es-CO"):"No disponible",_=C=>{const w=[];for(let F=1;F<=5;F++)w.push(l.jsx("span",{className:`star ${F<=C?"filled":""}`,children:"★"},F));return l.jsx("div",{className:"rating-stars",children:w})},T=C=>!C||C.length===0?l.jsx("span",{className:"no-fuels",children:"Sin combustibles especificados"}):l.jsxs("div",{className:"fuel-types",children:[C.slice(0,3).map(w=>l.jsx("span",{className:"fuel-badge",title:En[w],children:En[w]||w},w)),C.length>3&&l.jsxs("span",{className:"fuel-badge more",title:`+${C.length-3} más`,children:["+",C.length-3]})]}),N=C=>{const w=[];return C.phone&&w.push(l.jsxs("div",{className:"contact-item",children:[l.jsx("i",{className:"icon-phone"}),l.jsx("span",{children:C.phone})]},"phone")),C.email&&w.push(l.jsxs("div",{className:"contact-item",children:[l.jsx("i",{className:"icon-mail"}),l.jsx("span",{children:C.email})]},"email")),C.city&&w.push(l.jsxs("div",{className:"contact-item",children:[l.jsx("i",{className:"icon-map-pin"}),l.jsx("span",{children:C.city})]},"city")),w.length>0?w:l.jsxs("div",{className:"contact-item no-contact",children:[l.jsx("i",{className:"icon-info-circle"}),l.jsx("span",{children:"Sin información de contacto"})]})};return l.jsx("div",{className:"suppliers-cards",children:s.map(C=>l.jsxs("div",{className:`supplier-card ${C.status}`,children:[l.jsxs("div",{className:"card-header",children:[l.jsx("div",{className:"header-left",children:l.jsxs("div",{className:"supplier-info",children:[l.jsxs("h3",{className:"supplier-name",children:[C.name,C.isPreferred&&l.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:l.jsx("i",{className:"icon-star"})})]}),C.taxId&&l.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",C.taxId]})]})}),l.jsx("div",{className:"header-right",children:l.jsxs("div",{className:"supplier-status",children:[l.jsx("span",{className:"status-dot",style:{backgroundColor:c(C.status)}}),l.jsx("span",{className:"status-label",children:d(C.status)})]})})]}),l.jsxs("div",{className:"card-content",children:[l.jsxs("div",{className:"supplier-meta",children:[l.jsxs("div",{className:"meta-item",children:[l.jsx("span",{className:"meta-icon",children:m(C.category)}),l.jsx("span",{className:"meta-label",children:C.category?.charAt(0).toUpperCase()+C.category?.slice(1)||"Sin categoría"})]}),l.jsxs("div",{className:"meta-item",children:[l.jsx("i",{className:"icon-building meta-icon"}),l.jsx("span",{className:"meta-label",children:g(C.type)})]})]}),C.contactPerson&&l.jsxs("div",{className:"contact-person",children:[l.jsx("i",{className:"icon-user"}),l.jsx("span",{children:C.contactPerson})]}),l.jsx("div",{className:"contact-info",children:N(C)}),l.jsxs("div",{className:"fuel-types-section",children:[l.jsx("div",{className:"section-label",children:"Combustibles Suministrados:"}),T(C.fuelTypes)]}),l.jsxs("div",{className:"rating-section",children:[l.jsxs("div",{className:"rating-display",children:[_(C.rating||0),l.jsxs("span",{className:"rating-value",children:[(C.rating||0).toFixed(1),"/5"]})]}),C.evaluationNotes&&l.jsxs("div",{className:"evaluation-notes",title:C.evaluationNotes,children:[l.jsx("i",{className:"icon-message-square"}),l.jsx("span",{children:"Con evaluación"})]})]}),C.paymentTerms&&l.jsxs("div",{className:"payment-terms",children:[l.jsx("i",{className:"icon-credit-card"}),l.jsxs("span",{children:["Términos: ",C.paymentTerms==="contado"?"Contado":C.paymentTerms==="30dias"?"30 días":C.paymentTerms==="60dias"?"60 días":C.paymentTerms==="90dias"?"90 días":C.paymentTerms]})]}),l.jsxs("div",{className:"supplier-stats",children:[l.jsxs("div",{className:"stat-item",children:[l.jsx("span",{className:"stat-label",children:"Órdenes:"}),l.jsx("span",{className:"stat-value",children:C.totalOrders||0})]}),l.jsxs("div",{className:"stat-item",children:[l.jsx("span",{className:"stat-label",children:"Total Comprado:"}),l.jsx("span",{className:"stat-value",children:Ir(C.totalPurchased||0)})]}),C.lastOrderDate&&l.jsxs("div",{className:"stat-item",children:[l.jsx("span",{className:"stat-label",children:"Última Orden:"}),l.jsx("span",{className:"stat-value",children:v(C.lastOrderDate)})]})]})]}),l.jsxs("div",{className:"card-footer",children:[l.jsx("div",{className:"footer-info",children:l.jsxs("span",{className:"created-date",children:["Creado: ",v(C.createdAt)]})}),l.jsxs("div",{className:"card-actions",children:[a&&l.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(C),title:"Editar proveedor",children:[l.jsx("i",{className:"icon-edit"}),"Editar"]}),o&&C.status==="active"&&l.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>t(C.id,C.name),title:"Desactivar proveedor",children:[l.jsx("i",{className:"icon-x-circle"}),"Desactivar"]}),l.jsxs("div",{className:"quick-actions",children:[C.phone&&l.jsx("a",{href:`tel:${C.phone}`,className:"quick-action-btn",title:"Llamar",children:l.jsx("i",{className:"icon-phone"})}),C.email&&l.jsx("a",{href:`mailto:${C.email}`,className:"quick-action-btn",title:"Enviar email",children:l.jsx("i",{className:"icon-mail"})})]})]})]})]},C.id))})},X2=({supplier:s,onClose:e,onSuccess:t,onError:a})=>{const{userProfile:o}=Ci(),c=!!s,[d,m]=J.useState({name:"",taxId:"",type:"proveedor",category:"combustibles",contactPerson:"",phone:"",email:"",address:"",city:"",state:"Colombia",fuelTypes:[],paymentTerms:"contado",creditLimit:"",priceList:{},rating:5,evaluationNotes:"",status:"active",isPreferred:!1}),[g,v]=J.useState(!1),[_,T]=J.useState({}),[N,C]=J.useState("basic");J.useEffect(()=>{c&&s&&m({name:s.name||"",taxId:s.taxId||"",type:s.type||"proveedor",category:s.category||"combustibles",contactPerson:s.contactPerson||"",phone:s.phone||"",email:s.email||"",address:s.address||"",city:s.city||"",state:s.state||"Colombia",fuelTypes:s.fuelTypes||[],paymentTerms:s.paymentTerms||"contado",creditLimit:s.creditLimit||"",priceList:s.priceList||{},rating:s.rating||5,evaluationNotes:s.evaluationNotes||"",status:s.status||"active",isPreferred:s.isPreferred||!1})},[c,s]);const w=(U,z)=>{m(ae=>({...ae,[U]:z})),_[U]&&T(ae=>({...ae,[U]:null}))},F=U=>{m(z=>({...z,fuelTypes:z.fuelTypes.includes(U)?z.fuelTypes.filter(ae=>ae!==U):[...z.fuelTypes,U]}))},A=(U,z)=>{m(ae=>({...ae,priceList:{...ae.priceList,[U]:parseFloat(z)||0}}))},L=()=>{const U={};return d.name.trim()||(U.name="El nombre del proveedor es requerido"),d.category||(U.category="La categoría es requerida"),d.type||(U.type="El tipo de proveedor es requerido"),d.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)&&(U.email="El formato del email no es válido"),d.phone&&!/^[\d\s\-+()]+$/.test(d.phone)&&(U.phone="El formato del teléfono no es válido"),d.creditLimit&&(isNaN(d.creditLimit)||parseFloat(d.creditLimit)<0)&&(U.creditLimit="El límite de crédito debe ser un número positivo"),(d.rating<1||d.rating>5)&&(U.rating="El rating debe estar entre 1 y 5"),d.fuelTypes.forEach(z=>{d.priceList[z]&&(isNaN(d.priceList[z])||parseFloat(d.priceList[z])<0)&&(U[`price_${z}`]=`El precio de ${En[z]} debe ser un número positivo`)}),T(U),Object.keys(U).length===0},W=async U=>{if(U.preventDefault(),!!L()){v(!0);try{const z={...d,creditLimit:parseFloat(d.creditLimit)||0,rating:parseFloat(d.rating)||5,priceList:Object.fromEntries(Object.entries(d.priceList).filter(([O,x])=>d.fuelTypes.includes(O)&&x>0))};let ae;c?ae=await M2(s.id,z,o?.email):ae=await D2(z,o?.email),ae.success?t():a(ae.error||"Error al guardar proveedor")}catch(z){console.error("Error saving supplier:",z),a("Error inesperado al guardar proveedor")}finally{v(!1)}}},H=[{id:"basic",label:"Información Básica",icon:"icon-info"},{id:"contact",label:"Contacto",icon:"icon-phone"},{id:"products",label:"Productos",icon:"icon-package"},{id:"commercial",label:"Comercial",icon:"icon-credit-card"}];return l.jsx("div",{className:"modal-overlay",onClick:e,children:l.jsxs("div",{className:"modal-container large",onClick:U=>U.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsxs("h2",{children:[l.jsx("i",{className:"icon-truck"}),c?"Editar Proveedor":"Nuevo Proveedor"]}),l.jsx("button",{className:"modal-close",onClick:e,children:l.jsx("i",{className:"icon-x"})})]}),l.jsxs("form",{onSubmit:W,children:[l.jsx("div",{className:"modal-tabs",children:H.map(U=>l.jsxs("button",{type:"button",className:`tab-button ${N===U.id?"active":""}`,onClick:()=>C(U.id),children:[l.jsx("i",{className:U.icon}),U.label]},U.id))}),l.jsxs("div",{className:"modal-body",children:[N==="basic"&&l.jsx("div",{className:"tab-content",children:l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{className:"required",children:"Nombre del Proveedor"}),l.jsx("input",{type:"text",value:d.name,onChange:U=>w("name",U.target.value),placeholder:"Ingresa el nombre del proveedor",className:_.name?"error":""}),_.name&&l.jsx("span",{className:"error-message",children:_.name})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"NIT / Documento"}),l.jsx("input",{type:"text",value:d.taxId,onChange:U=>w("taxId",U.target.value),placeholder:"123456789-0",className:_.taxId?"error":""}),_.taxId&&l.jsx("span",{className:"error-message",children:_.taxId})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{className:"required",children:"Tipo de Proveedor"}),l.jsxs("select",{value:d.type,onChange:U=>w("type",U.target.value),className:_.type?"error":"",children:[l.jsx("option",{value:"proveedor",children:"Proveedor"}),l.jsx("option",{value:"distribuidor",children:"Distribuidor"}),l.jsx("option",{value:"mayorista",children:"Mayorista"})]}),_.type&&l.jsx("span",{className:"error-message",children:_.type})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{className:"required",children:"Categoría"}),l.jsxs("select",{value:d.category,onChange:U=>w("category",U.target.value),className:_.category?"error":"",children:[l.jsx("option",{value:"combustibles",children:"Combustibles"}),l.jsx("option",{value:"lubricantes",children:"Lubricantes"}),l.jsx("option",{value:"aditivos",children:"Aditivos"})]}),_.category&&l.jsx("span",{className:"error-message",children:_.category})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Estado"}),l.jsxs("select",{value:d.status,onChange:U=>w("status",U.target.value),children:[l.jsx("option",{value:"active",children:"Activo"}),l.jsx("option",{value:"inactive",children:"Inactivo"}),l.jsx("option",{value:"suspended",children:"Suspendido"})]})]}),l.jsx("div",{className:"form-group checkbox",children:l.jsxs("label",{className:"checkbox-label",children:[l.jsx("input",{type:"checkbox",checked:d.isPreferred,onChange:U=>w("isPreferred",U.target.checked)}),l.jsx("span",{className:"checkbox-mark"}),"Proveedor Preferido"]})})]})}),N==="contact"&&l.jsx("div",{className:"tab-content",children:l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Persona de Contacto"}),l.jsx("input",{type:"text",value:d.contactPerson,onChange:U=>w("contactPerson",U.target.value),placeholder:"Nombre del contacto principal"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Teléfono"}),l.jsx("input",{type:"tel",value:d.phone,onChange:U=>w("phone",U.target.value),placeholder:"+57 300 123 4567",className:_.phone?"error":""}),_.phone&&l.jsx("span",{className:"error-message",children:_.phone})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Email"}),l.jsx("input",{type:"email",value:d.email,onChange:U=>w("email",U.target.value),placeholder:"contacto@proveedor.com",className:_.email?"error":""}),_.email&&l.jsx("span",{className:"error-message",children:_.email})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Ciudad"}),l.jsx("input",{type:"text",value:d.city,onChange:U=>w("city",U.target.value),placeholder:"Bogotá"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Estado/País"}),l.jsx("input",{type:"text",value:d.state,onChange:U=>w("state",U.target.value),placeholder:"Colombia"})]}),l.jsxs("div",{className:"form-group full-width",children:[l.jsx("label",{children:"Dirección"}),l.jsx("textarea",{value:d.address,onChange:U=>w("address",U.target.value),placeholder:"Dirección completa del proveedor",rows:"3"})]})]})}),N==="products"&&l.jsxs("div",{className:"tab-content",children:[l.jsxs("div",{className:"section",children:[l.jsx("h3",{children:"Tipos de Combustible que Suministra"}),l.jsx("div",{className:"fuel-types-grid",children:Object.entries(En).map(([U,z])=>l.jsx("div",{className:"fuel-type-item",children:l.jsxs("label",{className:"checkbox-label",children:[l.jsx("input",{type:"checkbox",checked:d.fuelTypes.includes(U),onChange:()=>F(U)}),l.jsx("span",{className:"checkbox-mark"}),z]})},U))})]}),d.fuelTypes.length>0&&l.jsxs("div",{className:"section",children:[l.jsx("h3",{children:"Precios por Litro (Opcional)"}),l.jsx("div",{className:"prices-grid",children:d.fuelTypes.map(U=>l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:En[U]}),l.jsxs("div",{className:"input-with-currency",children:[l.jsx("span",{className:"currency-symbol",children:"$"}),l.jsx("input",{type:"number",step:"0.01",min:"0",value:d.priceList[U]||"",onChange:z=>A(U,z.target.value),placeholder:"0.00",className:_[`price_${U}`]?"error":""})]}),_[`price_${U}`]&&l.jsx("span",{className:"error-message",children:_[`price_${U}`]})]},U))})]})]}),N==="commercial"&&l.jsx("div",{className:"tab-content",children:l.jsxs("div",{className:"form-grid",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Términos de Pago"}),l.jsxs("select",{value:d.paymentTerms,onChange:U=>w("paymentTerms",U.target.value),children:[l.jsx("option",{value:"contado",children:"Contado"}),l.jsx("option",{value:"30dias",children:"30 días"}),l.jsx("option",{value:"60dias",children:"60 días"}),l.jsx("option",{value:"90dias",children:"90 días"})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Límite de Crédito"}),l.jsxs("div",{className:"input-with-currency",children:[l.jsx("span",{className:"currency-symbol",children:"$"}),l.jsx("input",{type:"number",step:"0.01",min:"0",value:d.creditLimit,onChange:U=>w("creditLimit",U.target.value),placeholder:"0.00",className:_.creditLimit?"error":""})]}),_.creditLimit&&l.jsx("span",{className:"error-message",children:_.creditLimit})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Rating"}),l.jsxs("div",{className:"rating-input",children:[l.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:d.rating,onChange:U=>w("rating",parseFloat(U.target.value)),className:_.rating?"error":""}),l.jsxs("div",{className:"rating-display",children:[l.jsx("span",{className:"rating-value",children:d.rating.toFixed(1)}),l.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(U=>l.jsx("span",{className:`star ${U<=Math.round(d.rating)?"filled":""}`,children:"★"},U))})]})]}),_.rating&&l.jsx("span",{className:"error-message",children:_.rating})]}),l.jsxs("div",{className:"form-group full-width",children:[l.jsx("label",{children:"Notas de Evaluación"}),l.jsx("textarea",{value:d.evaluationNotes,onChange:U=>w("evaluationNotes",U.target.value),placeholder:"Comentarios sobre el desempeño del proveedor...",rows:"4"})]})]})})]}),l.jsxs("div",{className:"modal-footer",children:[l.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:g,children:"Cancelar"}),l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:g,children:g?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"loading-spinner small"}),c?"Actualizando...":"Creando..."]}):l.jsxs(l.Fragment,{children:[l.jsx("i",{className:"icon-save"}),c?"Actualizar Proveedor":"Crear Proveedor"]})})]})]})]})})},W2=({stats:s,suppliersCount:e,totalSuppliers:t})=>{if(!s)return null;const a=d=>{switch(d){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},c=d=>{switch(d){case"proveedor":return"🏪";case"distribuidor":return"🚛";case"mayorista":return"🏭";default:return"🏢"}};return l.jsxs("div",{className:"suppliers-stats",children:[l.jsxs("div",{className:"stats-grid",children:[l.jsxs("div",{className:"stat-card primary",children:[l.jsx("div",{className:"stat-icon",children:l.jsx("i",{className:"icon-truck"})}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:Tn(s.total)}),l.jsx("div",{className:"stat-label",children:"Total Proveedores"}),t!==e&&l.jsxs("div",{className:"stat-sublabel",children:[Tn(e)," mostrados"]})]})]}),l.jsxs("div",{className:"stat-card success",children:[l.jsx("div",{className:"stat-icon",children:l.jsx("i",{className:"icon-check-circle"})}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:Tn(s.active)}),l.jsx("div",{className:"stat-label",children:"Activos"}),l.jsx("div",{className:"stat-sublabel",children:gr(s.total>0?s.active/s.total:0)})]})]}),l.jsxs("div",{className:"stat-card warning",children:[l.jsx("div",{className:"stat-icon",children:l.jsx("i",{className:"icon-star"})}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:Tn(s.preferred)}),l.jsx("div",{className:"stat-label",children:"Preferidos"}),l.jsx("div",{className:"stat-sublabel",children:gr(s.active>0?s.preferred/s.active:0)})]})]}),l.jsxs("div",{className:"stat-card info",children:[l.jsx("div",{className:"stat-icon",children:l.jsx("i",{className:"icon-award"})}),l.jsxs("div",{className:"stat-content",children:[l.jsx("div",{className:"stat-value",children:s.averageRating.toFixed(1)}),l.jsx("div",{className:"stat-label",children:"Rating Promedio"}),l.jsx("div",{className:"stat-sublabel",children:l.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(d=>l.jsx("span",{className:`star ${d<=Math.round(s.averageRating)?"filled":""}`,children:"★"},d))})})]})]})]}),l.jsxs("div",{className:"stats-details",children:[l.jsxs("div",{className:"stats-section",children:[l.jsx("h3",{children:"Estado de Proveedores"}),l.jsxs("div",{className:"stats-breakdown",children:[l.jsxs("div",{className:"breakdown-item",children:[l.jsxs("div",{className:"breakdown-label",children:[l.jsx("span",{className:"status-dot",style:{backgroundColor:a("active")}}),"Activos"]}),l.jsx("div",{className:"breakdown-value",children:s.active}),l.jsx("div",{className:"breakdown-percentage",children:gr(s.total>0?s.active/s.total:0)})]}),s.inactive>0&&l.jsxs("div",{className:"breakdown-item",children:[l.jsxs("div",{className:"breakdown-label",children:[l.jsx("span",{className:"status-dot",style:{backgroundColor:a("inactive")}}),"Inactivos"]}),l.jsx("div",{className:"breakdown-value",children:s.inactive}),l.jsx("div",{className:"breakdown-percentage",children:gr(s.total>0?s.inactive/s.total:0)})]}),s.suspended>0&&l.jsxs("div",{className:"breakdown-item",children:[l.jsxs("div",{className:"breakdown-label",children:[l.jsx("span",{className:"status-dot",style:{backgroundColor:a("suspended")}}),"Suspendidos"]}),l.jsx("div",{className:"breakdown-value",children:s.suspended}),l.jsx("div",{className:"breakdown-percentage",children:gr(s.total>0?s.suspended/s.total:0)})]})]})]}),Object.keys(s.byCategory).length>0&&l.jsxs("div",{className:"stats-section",children:[l.jsx("h3",{children:"Por Categoría"}),l.jsx("div",{className:"stats-breakdown",children:Object.entries(s.byCategory).sort(([,d],[,m])=>m-d).map(([d,m])=>l.jsxs("div",{className:"breakdown-item",children:[l.jsxs("div",{className:"breakdown-label",children:[l.jsx("span",{className:"category-icon",children:o(d)}),d.charAt(0).toUpperCase()+d.slice(1).replace("_"," ")]}),l.jsx("div",{className:"breakdown-value",children:m}),l.jsx("div",{className:"breakdown-percentage",children:gr(s.total>0?m/s.total:0)})]},d))})]}),Object.keys(s.byType).length>0&&l.jsxs("div",{className:"stats-section",children:[l.jsx("h3",{children:"Por Tipo"}),l.jsx("div",{className:"stats-breakdown",children:Object.entries(s.byType).sort(([,d],[,m])=>m-d).map(([d,m])=>l.jsxs("div",{className:"breakdown-item",children:[l.jsxs("div",{className:"breakdown-label",children:[l.jsx("span",{className:"type-icon",children:c(d)}),d.charAt(0).toUpperCase()+d.slice(1)]}),l.jsx("div",{className:"breakdown-value",children:m}),l.jsx("div",{className:"breakdown-percentage",children:gr(s.total>0?m/s.total:0)})]},d))})]})]}),l.jsxs("div",{className:"stats-insights",children:[l.jsx("h3",{children:"Información Rápida"}),l.jsxs("div",{className:"insights-grid",children:[l.jsxs("div",{className:"insight-item",children:[l.jsx("div",{className:"insight-label",children:"Nivel de Satisfacción"}),l.jsx("div",{className:"insight-value",children:s.averageRating>=4.5?"Excelente":s.averageRating>=4?"Muy Bueno":s.averageRating>=3.5?"Bueno":s.averageRating>=3?"Regular":"Necesita Mejora"})]}),l.jsxs("div",{className:"insight-item",children:[l.jsx("div",{className:"insight-label",children:"Estado General"}),l.jsx("div",{className:"insight-value",children:s.active/s.total>=.9?"Excelente":s.active/s.total>=.8?"Bueno":s.active/s.total>=.7?"Regular":"Revisar"})]}),l.jsxs("div",{className:"insight-item",children:[l.jsx("div",{className:"insight-label",children:"Proveedores Preferidos"}),l.jsx("div",{className:"insight-value",children:s.preferred===0?"Ninguno":s.preferred/s.active>=.3?"Suficientes":s.preferred/s.active>=.2?"Buenos":"Pocos"})]}),l.jsxs("div",{className:"insight-item",children:[l.jsx("div",{className:"insight-label",children:"Diversificación"}),l.jsx("div",{className:"insight-value",children:Object.keys(s.byCategory).length>=3?"Alta":Object.keys(s.byCategory).length>=2?"Media":"Baja"})]})]})]})]})},Z2=({searchTerm:s,setSearchTerm:e,filterStatus:t,setFilterStatus:a,filterCategory:o,setFilterCategory:c,filterFuelType:d,setFilterFuelType:m,viewMode:g,setViewMode:v,onClearFilters:_,resultsCount:T})=>{const N=[{value:"all",label:"Todos los Estados",icon:"list"},{value:"active",label:"Activos",icon:"check-circle"},{value:"inactive",label:"Inactivos",icon:"x-circle"},{value:"suspended",label:"Suspendidos",icon:"alert-circle"},{value:"preferred",label:"Preferidos",icon:"star"}],C=[{value:"all",label:"Todas las Categorías",icon:"grid"},{value:"combustibles",label:"Combustibles",icon:"fuel"},{value:"lubricantes",label:"Lubricantes",icon:"droplets"},{value:"aditivos",label:"Aditivos",icon:"flask"}],w=[{value:"all",label:"Todos los Combustibles",icon:"fuel"},...Object.entries(En).map(([A,L])=>({value:A,label:L,icon:"droplet"}))],F=s||t!=="all"||o!=="all"||d!=="all";return l.jsxs("div",{className:"suppliers-filters",children:[l.jsxs("div",{className:"filters-top",children:[l.jsx("div",{className:"search-container",children:l.jsxs("div",{className:"search-input-wrapper",children:[l.jsx("i",{className:"icon-search search-icon"}),l.jsx("input",{type:"text",placeholder:"Buscar por nombre, NIT, contacto, ciudad...",value:s,onChange:A=>e(A.target.value),className:"search-input"}),s&&l.jsx("button",{className:"search-clear",onClick:()=>e(""),title:"Limpiar búsqueda",children:l.jsx("i",{className:"icon-x"})})]})}),l.jsxs("div",{className:"view-controls",children:[l.jsxs("div",{className:"view-mode-toggle",children:[l.jsx("button",{className:`view-btn ${g==="cards"?"active":""}`,onClick:()=>v("cards"),title:"Vista de tarjetas",children:l.jsx("i",{className:"icon-grid"})}),l.jsx("button",{className:`view-btn ${g==="table"?"active":""}`,onClick:()=>v("table"),title:"Vista de tabla",children:l.jsx("i",{className:"icon-list"})})]}),F&&l.jsxs("button",{className:"btn btn-secondary clear-filters",onClick:_,title:"Limpiar todos los filtros",children:[l.jsx("i",{className:"icon-filter-x"}),"Limpiar"]})]})]}),l.jsxs("div",{className:"filters-dropdowns",children:[l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{className:"filter-label",children:"Estado"}),l.jsxs("div",{className:"select-wrapper",children:[l.jsx("select",{value:t,onChange:A=>a(A.target.value),className:"filter-select",children:N.map(A=>l.jsx("option",{value:A.value,children:A.label},A.value))}),l.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{className:"filter-label",children:"Categoría"}),l.jsxs("div",{className:"select-wrapper",children:[l.jsx("select",{value:o,onChange:A=>c(A.target.value),className:"filter-select",children:C.map(A=>l.jsx("option",{value:A.value,children:A.label},A.value))}),l.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),l.jsxs("div",{className:"filter-group",children:[l.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),l.jsxs("div",{className:"select-wrapper",children:[l.jsx("select",{value:d,onChange:A=>m(A.target.value),className:"filter-select",children:w.map(A=>l.jsx("option",{value:A.value,children:A.label},A.value))}),l.jsx("i",{className:"icon-chevron-down select-arrow"})]})]})]}),l.jsxs("div",{className:"filters-summary",children:[l.jsxs("div",{className:"results-count",children:[l.jsx("i",{className:"icon-info-circle"}),l.jsx("span",{children:T===0?"No se encontraron proveedores":`Mostrando ${T} proveedor${T!==1?"es":""}`})]}),F&&l.jsxs("div",{className:"active-filters",children:[l.jsx("span",{className:"filters-label",children:"Filtros activos:"}),l.jsxs("div",{className:"filter-tags",children:[s&&l.jsxs("span",{className:"filter-tag",children:[l.jsx("i",{className:"icon-search"}),s,l.jsx("button",{onClick:()=>e(""),children:l.jsx("i",{className:"icon-x"})})]}),t!=="all"&&l.jsxs("span",{className:"filter-tag",children:[l.jsx("i",{className:"icon-filter"}),N.find(A=>A.value===t)?.label,l.jsx("button",{onClick:()=>a("all"),children:l.jsx("i",{className:"icon-x"})})]}),o!=="all"&&l.jsxs("span",{className:"filter-tag",children:[l.jsx("i",{className:"icon-tag"}),C.find(A=>A.value===o)?.label,l.jsx("button",{onClick:()=>c("all"),children:l.jsx("i",{className:"icon-x"})})]}),d!=="all"&&l.jsxs("span",{className:"filter-tag",children:[l.jsx("i",{className:"icon-droplet"}),w.find(A=>A.value===d)?.label,l.jsx("button",{onClick:()=>m("all"),children:l.jsx("i",{className:"icon-x"})})]})]})]})]}),l.jsxs("div",{className:"quick-filters",children:[l.jsx("span",{className:"quick-filters-label",children:"Acceso rápido:"}),l.jsxs("div",{className:"quick-filter-buttons",children:[l.jsxs("button",{className:`quick-filter-btn ${t==="preferred"?"active":""}`,onClick:()=>a(t==="preferred"?"all":"preferred"),children:[l.jsx("i",{className:"icon-star"}),"Preferidos"]}),l.jsxs("button",{className:`quick-filter-btn ${t==="active"?"active":""}`,onClick:()=>a(t==="active"?"all":"active"),children:[l.jsx("i",{className:"icon-check-circle"}),"Activos"]}),l.jsxs("button",{className:`quick-filter-btn ${o==="combustibles"?"active":""}`,onClick:()=>c(o==="combustibles"?"all":"combustibles"),children:[l.jsx("i",{className:"icon-fuel"}),"Combustibles"]}),l.jsxs("button",{className:`quick-filter-btn ${d==="diesel"?"active":""}`,onClick:()=>m(d==="diesel"?"all":"diesel"),children:[l.jsx("i",{className:"icon-droplet"}),"Diésel"]})]})]})]})},J2=()=>{const{hasPermission:s,userProfile:e}=Ci(),[t,a]=J.useState([]),[o,c]=J.useState(null),[d,m]=J.useState(!0),[g,v]=J.useState(null),[_,T]=J.useState("cards"),[N,C]=J.useState(!1),[w,F]=J.useState(null),[A,L]=J.useState("all"),[W,H]=J.useState("all"),[U,z]=J.useState("all"),[ae,O]=J.useState("");J.useEffect(()=>{let G=null;return(()=>{G=O2(ce=>{a(ce||[]),m(!1)})})(),()=>{G&&G()}},[]),J.useEffect(()=>{const G=async()=>{const ne=await k2();ne.success&&c(ne.data)};t.length>0&&G()},[t]);const x=t.filter(G=>{const ne=!ae||G.name?.toLowerCase().includes(ae.toLowerCase())||G.taxId?.toLowerCase().includes(ae.toLowerCase())||G.contactPerson?.toLowerCase().includes(ae.toLowerCase())||G.city?.toLowerCase().includes(ae.toLowerCase()),ce=A==="all"||(A==="preferred"?G.isPreferred:G.status===A),ge=W==="all"||G.category===W,V=U==="all"||G.fuelTypes&&G.fuelTypes.includes(U);return ne&&ce&&ge&&V}),j=()=>{if(!s("canManageSuppliers")){v("No tienes permisos para agregar proveedores");return}F(null),C(!0)},R=G=>{if(!s("canManageSuppliers")){v("No tienes permisos para editar proveedores");return}F(G),C(!0)},P=async(G,ne)=>{if(!s("canManageSuppliers")){v("No tienes permisos para eliminar proveedores");return}if(window.confirm(`¿Estás seguro de que deseas desactivar el proveedor "${ne}"?

Esta acción se puede revertir cambiando su estado a activo.`))try{const ce=await P2(G,e?.email);ce.success?v(null):v(ce.error||"Error al desactivar proveedor")}catch(ce){console.error("Error deleting supplier:",ce),v("Error inesperado al eliminar proveedor")}},M=()=>{C(!1),F(null),v(null)},D=()=>{C(!1),F(null),v(null)},re=()=>{L("all"),H("all"),z("all"),O("")},ye=()=>{if(!s("canExportReports")){v("No tienes permisos para exportar datos");return}try{const G=x.map(ee=>({Nombre:ee.name,"NIT/Documento":ee.taxId,Tipo:ee.type,Categoría:ee.category,"Persona de Contacto":ee.contactPerson,Teléfono:ee.phone,Email:ee.email,Ciudad:ee.city,Combustibles:ee.fuelTypes?.join(", "),Rating:ee.rating,Estado:ee.status,Preferido:ee.isPreferred?"Sí":"No","Fecha Creación":ee.createdAt?.toDate?.()?.toLocaleDateString()||"N/A"})),ne=[Object.keys(G[0]).join(","),...G.map(ee=>Object.values(ee).map(he=>`"${he||""}"`).join(","))].join(`
`),ce=new Blob([ne],{type:"text/csv;charset=utf-8;"}),ge=document.createElement("a"),V=URL.createObjectURL(ce);ge.setAttribute("href",V),ge.setAttribute("download",`proveedores_${new Date().toISOString().split("T")[0]}.csv`),ge.style.visibility="hidden",document.body.appendChild(ge),ge.click(),document.body.removeChild(ge)}catch(G){console.error("Error exporting suppliers:",G),v("Error al exportar proveedores")}};return d?l.jsx("div",{className:"suppliers-main",children:l.jsxs("div",{className:"loading-container",children:[l.jsx("div",{className:"loading-spinner"}),l.jsx("p",{children:"Cargando proveedores..."})]})}):l.jsxs("div",{className:"suppliers-main",children:[l.jsxs("div",{className:"suppliers-header",children:[l.jsxs("div",{className:"header-content",children:[l.jsx("h1",{children:"Gestión de Proveedores"}),l.jsx("p",{className:"header-subtitle",children:"Administra los proveedores de combustibles y materiales"})]}),l.jsxs("div",{className:"header-actions",children:[s("canManageSuppliers")&&l.jsxs("button",{className:"btn btn-primary",onClick:j,children:[l.jsx("i",{className:"icon-plus"}),"Agregar Proveedor"]}),s("canExportReports")&&l.jsxs("button",{className:"btn btn-secondary",onClick:ye,disabled:x.length===0,children:[l.jsx("i",{className:"icon-download"}),"Exportar"]})]})]}),g&&l.jsxs("div",{className:"alert alert-error",children:[l.jsx("i",{className:"icon-alert-circle"}),l.jsx("span",{children:g}),l.jsx("button",{onClick:()=>v(null),className:"alert-close",children:l.jsx("i",{className:"icon-x"})})]}),o&&l.jsx(W2,{stats:o,suppliersCount:x.length,totalSuppliers:t.length}),l.jsx(Z2,{searchTerm:ae,setSearchTerm:O,filterStatus:A,setFilterStatus:L,filterCategory:W,setFilterCategory:H,filterFuelType:U,setFilterFuelType:z,viewMode:_,setViewMode:T,onClearFilters:re,resultsCount:x.length}),x.length===0?l.jsxs("div",{className:"empty-state",children:[l.jsx("div",{className:"empty-icon",children:l.jsx("i",{className:"icon-truck"})}),l.jsx("h3",{children:"No hay proveedores"}),l.jsx("p",{children:t.length===0?"Comienza agregando tu primer proveedor de combustibles.":"No se encontraron proveedores que coincidan con los filtros aplicados."}),t.length===0&&s("canManageSuppliers")&&l.jsxs("button",{className:"btn btn-primary",onClick:j,children:[l.jsx("i",{className:"icon-plus"}),"Agregar Primer Proveedor"]}),t.length>0&&l.jsxs("button",{className:"btn btn-secondary",onClick:re,children:[l.jsx("i",{className:"icon-filter-x"}),"Limpiar Filtros"]})]}):l.jsx("div",{className:"suppliers-content",children:_==="cards"?l.jsx(Q2,{suppliers:x,onEdit:R,onDelete:P,hasEditPermission:s("canManageSuppliers"),hasDeletePermission:s("canManageSuppliers")}):l.jsx(Y2,{suppliers:x,onEdit:R,onDelete:P,hasEditPermission:s("canManageSuppliers"),hasDeletePermission:s("canManageSuppliers")})}),N&&l.jsx(X2,{supplier:w,onClose:M,onSuccess:D,onError:v})]})},eV=()=>{const{user:s,userProfile:e}=Ci(),[t,a]=J.useState("invitations"),[o,c]=J.useState([]),[d,m]=J.useState(!1),[g,v]=J.useState(!1),[_,T]=J.useState(!1),[N,C]=J.useState({email:"",name:"",role:ps.CLIENTE});J.useEffect(()=>{s&&e?.role==="admin"&&w()},[s,e]);const w=async()=>{m(!0);try{const U=await r2(s.uid);U.success?c(U.invitations):console.error("Error loading invitations:",U.error)}catch(U){console.error("Error loading invitations:",U)}finally{m(!1)}},F=async U=>{U.preventDefault(),T(!0);try{const z=await i2(N,s.uid);z.success?(C({email:"",name:"",role:ps.CLIENTE}),v(!1),await w(),alert(`Invitación creada exitosamente!
Código: ${z.invitation.code}`)):alert(`Error: ${z.error}`)}catch(z){console.error("Error creating invitation:",z),alert("Error creando invitación")}finally{T(!1)}},A=async U=>{if(confirm("¿Estás seguro de cancelar esta invitación?"))try{const z=await o2(U,s.uid);z.success?(await w(),alert("Invitación cancelada exitosamente")):alert(`Error: ${z.error}`)}catch(z){console.error("Error cancelling invitation:",z),alert("Error cancelando invitación")}},L=U=>({pending:{text:"Pendiente",class:"status-pending"},used:{text:"Usada",class:"status-used"},cancelled:{text:"Cancelada",class:"status-cancelled"},expired:{text:"Expirada",class:"status-expired"}})[U]||{text:U,class:"status-unknown"},W=U=>({admin:"Administrador",contador:"Contador",cliente:"Cliente"})[U]||U,H=U=>U?(U.toDate?U.toDate():new Date(U)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e?.role!=="admin"?l.jsxs("div",{className:"admin-unauthorized",children:[l.jsx("h2",{children:"⛔ Acceso Denegado"}),l.jsx("p",{children:"Solo los administradores pueden acceder a esta sección."})]}):l.jsxs("div",{className:"admin-main",children:[l.jsxs("div",{className:"admin-header",children:[l.jsx("h1",{children:"⚙️ Administración del Sistema"}),l.jsx("p",{children:"Gestión de usuarios y configuraciones"})]}),l.jsxs("div",{className:"admin-tabs",children:[l.jsx("button",{className:`tab-button ${t==="invitations"?"active":""}`,onClick:()=>a("invitations"),children:"🎫 Invitaciones"}),l.jsx("button",{className:`tab-button ${t==="users"?"active":""}`,onClick:()=>a("users"),children:"👥 Usuarios"}),l.jsx("button",{className:`tab-button ${t==="settings"?"active":""}`,onClick:()=>a("settings"),children:"⚙️ Configuración"})]}),l.jsxs("div",{className:"admin-content",children:[t==="invitations"&&l.jsxs("div",{className:"invitations-section",children:[l.jsxs("div",{className:"section-header",children:[l.jsx("h2",{children:"Gestión de Invitaciones"}),l.jsx("button",{className:"create-button",onClick:()=>v(!0),children:"+ Crear Invitación"})]}),d?l.jsx("div",{className:"loading",children:"Cargando invitaciones..."}):l.jsxs("div",{className:"invitations-table",children:[l.jsxs("table",{children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Código"}),l.jsx("th",{children:"Email"}),l.jsx("th",{children:"Nombre"}),l.jsx("th",{children:"Rol"}),l.jsx("th",{children:"Estado"}),l.jsx("th",{children:"Creada"}),l.jsx("th",{children:"Expira"}),l.jsx("th",{children:"Acciones"})]})}),l.jsx("tbody",{children:o.map(U=>{const z=L(U.status);return l.jsxs("tr",{children:[l.jsx("td",{children:l.jsx("code",{className:"invitation-code",children:U.code})}),l.jsx("td",{children:U.targetEmail}),l.jsx("td",{children:U.targetName||"-"}),l.jsx("td",{children:W(U.targetRole)}),l.jsx("td",{children:l.jsx("span",{className:`status-badge ${z.class}`,children:z.text})}),l.jsx("td",{children:H(U.createdAt)}),l.jsx("td",{children:H(U.expiresAt)}),l.jsx("td",{children:U.status==="pending"&&l.jsx("button",{className:"cancel-button",onClick:()=>A(U.id),children:"Cancelar"})})]},U.id)})})]}),o.length===0&&l.jsx("div",{className:"empty-state",children:l.jsx("p",{children:"No hay invitaciones creadas"})})]})]}),t==="users"&&l.jsxs("div",{className:"users-section",children:[l.jsx("h2",{children:"👥 Usuarios del Sistema"}),l.jsxs("div",{className:"coming-soon",children:[l.jsx("span",{children:"🚧 En desarrollo"}),l.jsx("p",{children:"Próximamente: Lista de usuarios registrados, edición de permisos, y estadísticas."})]})]}),t==="settings"&&l.jsxs("div",{className:"settings-section",children:[l.jsx("h2",{children:"⚙️ Configuración del Sistema"}),l.jsxs("div",{className:"coming-soon",children:[l.jsx("span",{children:"🚧 En desarrollo"}),l.jsx("p",{children:"Próximamente: Configuraciones generales, notificaciones, y parámetros del sistema."})]})]})]}),g&&l.jsx("div",{className:"modal-overlay",onClick:()=>v(!1),children:l.jsxs("div",{className:"modal-content",onClick:U=>U.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h3",{children:"Crear Nueva Invitación"}),l.jsx("button",{className:"modal-close",onClick:()=>v(!1),children:"×"})]}),l.jsxs("form",{onSubmit:F,className:"invitation-form",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"email",children:"Email del usuario:"}),l.jsx("input",{id:"email",type:"email",required:!0,value:N.email,onChange:U=>C({...N,email:U.target.value}),placeholder:"usuario@ejemplo.com"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"name",children:"Nombre (opcional):"}),l.jsx("input",{id:"name",type:"text",value:N.name,onChange:U=>C({...N,name:U.target.value}),placeholder:"Nombre del usuario"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"role",children:"Rol:"}),l.jsxs("select",{id:"role",value:N.role,onChange:U=>C({...N,role:U.target.value}),children:[l.jsx("option",{value:ps.CLIENTE,children:"Cliente"}),l.jsx("option",{value:ps.CONTADOR,children:"Contador"}),l.jsx("option",{value:ps.ADMIN,children:"Administrador"})]})]}),l.jsxs("div",{className:"form-actions",children:[l.jsx("button",{type:"button",className:"cancel-button",onClick:()=>v(!1),children:"Cancelar"}),l.jsx("button",{type:"submit",className:"create-button",disabled:_,children:_?"Creando...":"Crear Invitación"})]})]})]})})]})},tV=()=>l.jsxs("div",{className:"module-placeholder",children:[l.jsx("h2",{children:"📋 Módulo de Reportes"}),l.jsx("p",{children:"Análisis y reportes de combustibles"}),l.jsxs("div",{className:"coming-soon",children:[l.jsx("span",{children:"🚧 En desarrollo"}),l.jsx("p",{children:"Próximamente: Reportes personalizables, gráficos interactivos, y exportación."})]})]}),nV=()=>{const[s,e]=J.useState("dashboard"),t=()=>{switch(s){case"dashboard":return l.jsx(rN,{});case"inventory":return l.jsx(S2,{});case"movements":return l.jsx(L2,{});case"vehicles":return l.jsx(K2,{});case"suppliers":return l.jsx(J2,{});case"reports":return l.jsx(tV,{});case"admin":return l.jsx(eV,{});default:return l.jsx(rN,{})}};return l.jsx(u2,{currentView:s,onViewChange:e,children:t()})},sV=()=>{const[s,e]=J.useState("login"),[t,a]=J.useState(!1),[o,c]=J.useState(""),[d,m]=J.useState(""),[g,v]=J.useState(""),[_,T]=J.useState(""),[N,C]=J.useState({email:"",password:"",confirmPassword:"",invitationCode:""}),[w,F]=J.useState(""),[A,L]=J.useState(null),W=async j=>{j.preventDefault(),a(!0),c("");try{await mj(Mc,g,_)}catch(R){console.error("Error en login:",R),c(ae(R.code))}finally{a(!1)}},H=async()=>{a(!0),c("");try{const j=new _i,R=await Lj(Mc,j);A?await iN(R.user,A.code):await qA(R.user)}catch(j){console.error("Error en login con Google:",j),c("Error al iniciar sesión con Google")}finally{a(!1)}},U=async j=>{j.preventDefault(),a(!0),c(""),m("");try{const R=await FA(w);R.success?(L(R.invitation),m(`Invitación válida para: ${R.invitation.targetEmail}`),e("register"),C({...N,email:R.invitation.targetEmail,invitationCode:w})):c(R.error)}catch(R){console.error("Error validando invitación:",R),c("Error validando código de invitación")}finally{a(!1)}},z=async j=>{if(j.preventDefault(),a(!0),c(""),N.password!==N.confirmPassword){c("Las contraseñas no coinciden"),a(!1);return}if(N.password.length<6){c("La contraseña debe tener al menos 6 caracteres"),a(!1);return}try{const R=await fj(Mc,N.email,N.password),P=await iN(R.user,N.invitationCode);P.success?m("¡Registro exitoso! Bienvenido al sistema."):c(P.error)}catch(R){console.error("Error en registro:",R),c(ae(R.code))}finally{a(!1)}},ae=j=>{switch(j){case"auth/invalid-email":return"El formato del email es inválido";case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contraseña incorrecta";case"auth/invalid-credential":return"Email o contraseña incorrectos";case"auth/email-already-in-use":return"Este email ya está registrado";case"auth/weak-password":return"La contraseña es muy débil";default:return"Error de autenticación. Inténtalo de nuevo."}},O=()=>{c(""),m(""),v(""),T(""),F(""),L(null),C({email:"",password:"",confirmPassword:"",invitationCode:""})},x=()=>{switch(s){case"login":return l.jsxs(l.Fragment,{children:[l.jsxs("form",{onSubmit:W,children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"email",children:"Email:"}),l.jsx("input",{id:"email",type:"email",value:g,onChange:j=>v(j.target.value),required:!0,disabled:t,placeholder:"tu-email@ejemplo.com"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"password",children:"Contraseña:"}),l.jsx("input",{id:"password",type:"password",value:_,onChange:j=>T(j.target.value),required:!0,disabled:t,placeholder:"Tu contraseña"})]}),l.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Iniciando sesión...":"Iniciar Sesión"})]}),l.jsx("div",{className:"auth-divider",children:l.jsx("span",{children:"o"})}),l.jsxs("button",{onClick:H,className:"auth-button google",disabled:t,children:[l.jsx("span",{children:"🔗"}),"Continuar con Google"]}),l.jsx("div",{className:"auth-actions",children:l.jsx("button",{className:"link-button",onClick:()=>{O(),e("invite")},children:"¿Tienes un código de invitación? Regístrate aquí"})})]});case"invite":return l.jsxs(l.Fragment,{children:[l.jsxs("form",{onSubmit:U,children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"inviteCode",children:"Código de invitación:"}),l.jsx("input",{id:"inviteCode",type:"text",value:w,onChange:j=>F(j.target.value.toUpperCase()),required:!0,disabled:t,placeholder:"XXXXXXXX",maxLength:8,style:{textTransform:"uppercase",fontFamily:"monospace"}}),l.jsx("small",{children:"Ingresa el código de 8 caracteres que recibiste"})]}),l.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Validando...":"Validar Código"})]}),l.jsx("div",{className:"auth-actions",children:l.jsx("button",{className:"link-button",onClick:()=>{O(),e("login")},children:"Volver al inicio de sesión"})})]});case"register":return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"invitation-info",children:l.jsxs("div",{className:"success-message",children:["✅ Código válido para: ",A?.targetEmail]})}),l.jsxs("form",{onSubmit:z,children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"registerEmail",children:"Email:"}),l.jsx("input",{id:"registerEmail",type:"email",value:N.email,disabled:!0,className:"disabled-input"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"registerPassword",children:"Contraseña:"}),l.jsx("input",{id:"registerPassword",type:"password",value:N.password,onChange:j=>C({...N,password:j.target.value}),required:!0,disabled:t,placeholder:"Mínimo 6 caracteres",minLength:6})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar contraseña:"}),l.jsx("input",{id:"confirmPassword",type:"password",value:N.confirmPassword,onChange:j=>C({...N,confirmPassword:j.target.value}),required:!0,disabled:t,placeholder:"Repite tu contraseña"})]}),l.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Registrando...":"Crear Cuenta"})]}),l.jsx("div",{className:"auth-divider",children:l.jsx("span",{children:"o"})}),l.jsxs("button",{onClick:H,className:"auth-button google",disabled:t,children:[l.jsx("span",{children:"🔗"}),"Registrarse con Google"]}),l.jsx("div",{className:"auth-actions",children:l.jsx("button",{className:"link-button",onClick:()=>{O(),e("invite")},children:"Usar otro código de invitación"})})]});default:return null}};return l.jsx("div",{className:"auth-container",children:l.jsxs("div",{className:"auth-card",children:[l.jsxs("div",{className:"auth-header",children:[l.jsx("h1",{children:"⛽ Combustibles"}),l.jsx("h2",{children:"Forestech Colombia"}),l.jsxs("p",{children:[s==="login"&&"Sistema de gestión de combustibles",s==="invite"&&"Validar código de invitación",s==="register"&&"Crear nueva cuenta"]})]}),l.jsxs("div",{className:"auth-form",children:[o&&l.jsx("div",{className:"error-message",children:o}),d&&l.jsx("div",{className:"success-message",children:d}),x(),l.jsx("div",{className:"auth-footer",children:l.jsx("p",{children:l.jsxs("small",{children:["Solo usuarios autorizados pueden acceder al sistema.",l.jsx("br",{}),s==="login"?"Contacta al administrador para obtener un código de invitación.":"Si no tienes código, contacta al administrador."]})})})]})]})})};function iV(){return l.jsx(c2,{children:l.jsx(aV,{})})}function aV(){const{user:s,loading:e}=Ci();return e?l.jsx("div",{className:"loading-container",children:l.jsxs("div",{className:"loader",children:[l.jsx("div",{className:"spinner"}),l.jsx("p",{children:"Cargando..."})]})}):l.jsxs("div",{className:"App",children:[!s&&l.jsx(sV,{}),s&&l.jsx(nV,{})]})}Ow.createRoot(document.getElementById("root")).render(l.jsx(J.StrictMode,{children:l.jsx(iV,{})}));
