(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var jp={exports:{}},Ac={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gN;function jC(){if(gN)return Ac;gN=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var f in o)f!=="key"&&(c[f]=o[f])}else c=o;return o=c.ref,{$$typeof:n,type:i,key:d,ref:o!==void 0?o:null,props:c}}return Ac.Fragment=e,Ac.jsx=t,Ac.jsxs=t,Ac}var vN;function AC(){return vN||(vN=1,jp.exports=jC()),jp.exports}var a=AC(),Ap={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yN;function wC(){if(yN)return Le;yN=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),N=Symbol.iterator;function j(H){return H===null||typeof H!="object"?null:(H=N&&H[N]||H["@@iterator"],typeof H=="function"?H:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,A={};function E(H,ee,ce){this.props=H,this.context=ee,this.refs=A,this.updater=ce||w}E.prototype.isReactComponent={},E.prototype.setState=function(H,ee){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ee,"setState")},E.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function D(){}D.prototype=E.prototype;function q(H,ee,ce){this.props=H,this.context=ee,this.refs=A,this.updater=ce||w}var U=q.prototype=new D;U.constructor=q,b(U,E.prototype),U.isPureReactComponent=!0;var P=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},$=Object.prototype.hasOwnProperty;function L(H,ee,ce,ue,Ne,ze){return ce=ze.ref,{$$typeof:n,type:H,key:ee,ref:ce!==void 0?ce:null,props:ze}}function S(H,ee){return L(H.type,ee,void 0,void 0,void 0,H.props)}function k(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function O(H){var ee={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ce){return ee[ce]})}var C=/\/+/g;function R(H,ee){return typeof H=="object"&&H!==null&&H.key!=null?O(""+H.key):ee.toString(36)}function V(){}function ye(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(V,V):(H.status="pending",H.then(function(ee){H.status==="pending"&&(H.status="fulfilled",H.value=ee)},function(ee){H.status==="pending"&&(H.status="rejected",H.reason=ee)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function Ie(H,ee,ce,ue,Ne){var ze=typeof H;(ze==="undefined"||ze==="boolean")&&(H=null);var Re=!1;if(H===null)Re=!0;else switch(ze){case"bigint":case"string":case"number":Re=!0;break;case"object":switch(H.$$typeof){case n:case e:Re=!0;break;case y:return Re=H._init,Ie(Re(H._payload),ee,ce,ue,Ne)}}if(Re)return Ne=Ne(H),Re=ue===""?"."+R(H,0):ue,P(Ne)?(ce="",Re!=null&&(ce=Re.replace(C,"$&/")+"/"),Ie(Ne,ee,ce,"",function(As){return As})):Ne!=null&&(k(Ne)&&(Ne=S(Ne,ce+(Ne.key==null||H&&H.key===Ne.key?"":(""+Ne.key).replace(C,"$&/")+"/")+Re)),ee.push(Ne)),1;Re=0;var Bt=ue===""?".":ue+":";if(P(H))for(var pt=0;pt<H.length;pt++)ue=H[pt],ze=Bt+R(ue,pt),Re+=Ie(ue,ee,ce,ze,Ne);else if(pt=j(H),typeof pt=="function")for(H=pt.call(H),pt=0;!(ue=H.next()).done;)ue=ue.value,ze=Bt+R(ue,pt++),Re+=Ie(ue,ee,ce,ze,Ne);else if(ze==="object"){if(typeof H.then=="function")return Ie(ye(H),ee,ce,ue,Ne);throw ee=String(H),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return Re}function Y(H,ee,ce){if(H==null)return H;var ue=[],Ne=0;return Ie(H,ue,"","",function(ze){return ee.call(ce,ze,Ne++)}),ue}function te(H){if(H._status===-1){var ee=H._result;ee=ee(),ee.then(function(ce){(H._status===0||H._status===-1)&&(H._status=1,H._result=ce)},function(ce){(H._status===0||H._status===-1)&&(H._status=2,H._result=ce)}),H._status===-1&&(H._status=0,H._result=ee)}if(H._status===1)return H._result.default;throw H._result}var le=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)};function Me(){}return Le.Children={map:Y,forEach:function(H,ee,ce){Y(H,function(){ee.apply(this,arguments)},ce)},count:function(H){var ee=0;return Y(H,function(){ee++}),ee},toArray:function(H){return Y(H,function(ee){return ee})||[]},only:function(H){if(!k(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Le.Component=E,Le.Fragment=t,Le.Profiler=o,Le.PureComponent=q,Le.StrictMode=i,Le.Suspense=p,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Le.__COMPILER_RUNTIME={__proto__:null,c:function(H){return F.H.useMemoCache(H)}},Le.cache=function(H){return function(){return H.apply(null,arguments)}},Le.cloneElement=function(H,ee,ce){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var ue=b({},H.props),Ne=H.key,ze=void 0;if(ee!=null)for(Re in ee.ref!==void 0&&(ze=void 0),ee.key!==void 0&&(Ne=""+ee.key),ee)!$.call(ee,Re)||Re==="key"||Re==="__self"||Re==="__source"||Re==="ref"&&ee.ref===void 0||(ue[Re]=ee[Re]);var Re=arguments.length-2;if(Re===1)ue.children=ce;else if(1<Re){for(var Bt=Array(Re),pt=0;pt<Re;pt++)Bt[pt]=arguments[pt+2];ue.children=Bt}return L(H.type,Ne,void 0,void 0,ze,ue)},Le.createContext=function(H){return H={$$typeof:d,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:c,_context:H},H},Le.createElement=function(H,ee,ce){var ue,Ne={},ze=null;if(ee!=null)for(ue in ee.key!==void 0&&(ze=""+ee.key),ee)$.call(ee,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(Ne[ue]=ee[ue]);var Re=arguments.length-2;if(Re===1)Ne.children=ce;else if(1<Re){for(var Bt=Array(Re),pt=0;pt<Re;pt++)Bt[pt]=arguments[pt+2];Ne.children=Bt}if(H&&H.defaultProps)for(ue in Re=H.defaultProps,Re)Ne[ue]===void 0&&(Ne[ue]=Re[ue]);return L(H,ze,void 0,void 0,null,Ne)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(H){return{$$typeof:f,render:H}},Le.isValidElement=k,Le.lazy=function(H){return{$$typeof:y,_payload:{_status:-1,_result:H},_init:te}},Le.memo=function(H,ee){return{$$typeof:g,type:H,compare:ee===void 0?null:ee}},Le.startTransition=function(H){var ee=F.T,ce={};F.T=ce;try{var ue=H(),Ne=F.S;Ne!==null&&Ne(ce,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(Me,le)}catch(ze){le(ze)}finally{F.T=ee}},Le.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Le.use=function(H){return F.H.use(H)},Le.useActionState=function(H,ee,ce){return F.H.useActionState(H,ee,ce)},Le.useCallback=function(H,ee){return F.H.useCallback(H,ee)},Le.useContext=function(H){return F.H.useContext(H)},Le.useDebugValue=function(){},Le.useDeferredValue=function(H,ee){return F.H.useDeferredValue(H,ee)},Le.useEffect=function(H,ee,ce){var ue=F.H;if(typeof ce=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ue.useEffect(H,ee)},Le.useId=function(){return F.H.useId()},Le.useImperativeHandle=function(H,ee,ce){return F.H.useImperativeHandle(H,ee,ce)},Le.useInsertionEffect=function(H,ee){return F.H.useInsertionEffect(H,ee)},Le.useLayoutEffect=function(H,ee){return F.H.useLayoutEffect(H,ee)},Le.useMemo=function(H,ee){return F.H.useMemo(H,ee)},Le.useOptimistic=function(H,ee){return F.H.useOptimistic(H,ee)},Le.useReducer=function(H,ee,ce){return F.H.useReducer(H,ee,ce)},Le.useRef=function(H){return F.H.useRef(H)},Le.useState=function(H){return F.H.useState(H)},Le.useSyncExternalStore=function(H,ee,ce){return F.H.useSyncExternalStore(H,ee,ce)},Le.useTransition=function(){return F.H.useTransition()},Le.version="19.1.0",Le}var xN;function Ig(){return xN||(xN=1,Ap.exports=wC()),Ap.exports}var G=Ig(),wp={exports:{}},wc={},Cp={exports:{}},Sp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bN;function CC(){return bN||(bN=1,function(n){function e(Y,te){var le=Y.length;Y.push(te);e:for(;0<le;){var Me=le-1>>>1,H=Y[Me];if(0<o(H,te))Y[Me]=te,Y[le]=H,le=Me;else break e}}function t(Y){return Y.length===0?null:Y[0]}function i(Y){if(Y.length===0)return null;var te=Y[0],le=Y.pop();if(le!==te){Y[0]=le;e:for(var Me=0,H=Y.length,ee=H>>>1;Me<ee;){var ce=2*(Me+1)-1,ue=Y[ce],Ne=ce+1,ze=Y[Ne];if(0>o(ue,le))Ne<H&&0>o(ze,ue)?(Y[Me]=ze,Y[Ne]=le,Me=Ne):(Y[Me]=ue,Y[ce]=le,Me=ce);else if(Ne<H&&0>o(ze,le))Y[Me]=ze,Y[Ne]=le,Me=Ne;else break e}}return te}function o(Y,te){var le=Y.sortIndex-te.sortIndex;return le!==0?le:Y.id-te.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var p=[],g=[],y=1,N=null,j=3,w=!1,b=!1,A=!1,E=!1,D=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;function P(Y){for(var te=t(g);te!==null;){if(te.callback===null)i(g);else if(te.startTime<=Y)i(g),te.sortIndex=te.expirationTime,e(p,te);else break;te=t(g)}}function F(Y){if(A=!1,P(Y),!b)if(t(p)!==null)b=!0,$||($=!0,R());else{var te=t(g);te!==null&&Ie(F,te.startTime-Y)}}var $=!1,L=-1,S=5,k=-1;function O(){return E?!0:!(n.unstable_now()-k<S)}function C(){if(E=!1,$){var Y=n.unstable_now();k=Y;var te=!0;try{e:{b=!1,A&&(A=!1,q(L),L=-1),w=!0;var le=j;try{t:{for(P(Y),N=t(p);N!==null&&!(N.expirationTime>Y&&O());){var Me=N.callback;if(typeof Me=="function"){N.callback=null,j=N.priorityLevel;var H=Me(N.expirationTime<=Y);if(Y=n.unstable_now(),typeof H=="function"){N.callback=H,P(Y),te=!0;break t}N===t(p)&&i(p),P(Y)}else i(p);N=t(p)}if(N!==null)te=!0;else{var ee=t(g);ee!==null&&Ie(F,ee.startTime-Y),te=!1}}break e}finally{N=null,j=le,w=!1}te=void 0}}finally{te?R():$=!1}}}var R;if(typeof U=="function")R=function(){U(C)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,ye=V.port2;V.port1.onmessage=C,R=function(){ye.postMessage(null)}}else R=function(){D(C,0)};function Ie(Y,te){L=D(function(){Y(n.unstable_now())},te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return j},n.unstable_next=function(Y){switch(j){case 1:case 2:case 3:var te=3;break;default:te=j}var le=j;j=te;try{return Y()}finally{j=le}},n.unstable_requestPaint=function(){E=!0},n.unstable_runWithPriority=function(Y,te){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var le=j;j=Y;try{return te()}finally{j=le}},n.unstable_scheduleCallback=function(Y,te,le){var Me=n.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?Me+le:Me):le=Me,Y){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=le+H,Y={id:y++,callback:te,priorityLevel:Y,startTime:le,expirationTime:H,sortIndex:-1},le>Me?(Y.sortIndex=le,e(g,Y),t(p)===null&&Y===t(g)&&(A?(q(L),L=-1):A=!0,Ie(F,le-Me))):(Y.sortIndex=H,e(p,Y),b||w||(b=!0,$||($=!0,R()))),Y},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(Y){var te=j;return function(){var le=j;j=te;try{return Y.apply(this,arguments)}finally{j=le}}}}(Sp)),Sp}var NN;function SC(){return NN||(NN=1,Cp.exports=CC()),Cp.exports}var Ip={exports:{}},dn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _N;function IC(){if(_N)return dn;_N=1;var n=Ig();function e(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)g+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,g,y){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:N==null?null:""+N,children:p,containerInfo:g,implementation:y}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,dn.createPortal=function(p,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return c(p,g,null,y)},dn.flushSync=function(p){var g=d.T,y=i.p;try{if(d.T=null,i.p=2,p)return p()}finally{d.T=g,i.p=y,i.d.f()}},dn.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(p,g))},dn.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},dn.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var y=g.as,N=f(y,g.crossOrigin),j=typeof g.integrity=="string"?g.integrity:void 0,w=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;y==="style"?i.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:N,integrity:j,fetchPriority:w}):y==="script"&&i.d.X(p,{crossOrigin:N,integrity:j,fetchPriority:w,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},dn.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var y=f(g.as,g.crossOrigin);i.d.M(p,{crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(p)},dn.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var y=g.as,N=f(y,g.crossOrigin);i.d.L(p,y,{crossOrigin:N,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},dn.preloadModule=function(p,g){if(typeof p=="string")if(g){var y=f(g.as,g.crossOrigin);i.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(p)},dn.requestFormReset=function(p){i.d.r(p)},dn.unstable_batchedUpdates=function(p,g){return p(g)},dn.useFormState=function(p,g,y){return d.H.useFormState(p,g,y)},dn.useFormStatus=function(){return d.H.useHostTransitionStatus()},dn.version="19.1.0",dn}var EN;function RC(){if(EN)return Ip.exports;EN=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ip.exports=IC(),Ip.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TN;function DC(){if(TN)return wc;TN=1;var n=SC(),e=Ig(),t=RC();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var r=s,l=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(l=r.return),s=r.return;while(s)}return r.tag===3?l:null}function d(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function f(s){if(c(s)!==s)throw Error(i(188))}function p(s){var r=s.alternate;if(!r){if(r=c(s),r===null)throw Error(i(188));return r!==s?null:s}for(var l=s,u=r;;){var m=l.return;if(m===null)break;var v=m.alternate;if(v===null){if(u=m.return,u!==null){l=u;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===l)return f(m),s;if(v===u)return f(m),r;v=v.sibling}throw Error(i(188))}if(l.return!==u.return)l=m,u=v;else{for(var T=!1,I=m.child;I;){if(I===l){T=!0,l=m,u=v;break}if(I===u){T=!0,u=m,l=v;break}I=I.sibling}if(!T){for(I=v.child;I;){if(I===l){T=!0,l=v,u=m;break}if(I===u){T=!0,u=v,l=m;break}I=I.sibling}if(!T)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:r}function g(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=g(s),r!==null)return r;s=s.sibling}return null}var y=Object.assign,N=Symbol.for("react.element"),j=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),q=Symbol.for("react.consumer"),U=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),C=Symbol.iterator;function R(s){return s===null||typeof s!="object"?null:(s=C&&s[C]||s["@@iterator"],typeof s=="function"?s:null)}var V=Symbol.for("react.client.reference");function ye(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===V?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case E:return"Profiler";case A:return"StrictMode";case F:return"Suspense";case $:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case U:return(s.displayName||"Context")+".Provider";case q:return(s._context.displayName||"Context")+".Consumer";case P:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case L:return r=s.displayName||null,r!==null?r:ye(s.type)||"Memo";case S:r=s._payload,s=s._init;try{return ye(s(r))}catch{}}return null}var Ie=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},Me=[],H=-1;function ee(s){return{current:s}}function ce(s){0>H||(s.current=Me[H],Me[H]=null,H--)}function ue(s,r){H++,Me[H]=s.current,s.current=r}var Ne=ee(null),ze=ee(null),Re=ee(null),Bt=ee(null);function pt(s,r){switch(ue(Re,r),ue(ze,s),ue(Ne,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?Bb(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=Bb(r),s=Gb(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ce(Ne),ue(Ne,s)}function As(){ce(Ne),ce(ze),ce(Re)}function La(s){s.memoizedState!==null&&ue(Bt,s);var r=Ne.current,l=Gb(r,s.type);r!==l&&(ue(ze,s),ue(Ne,l))}function ea(s){ze.current===s&&(ce(Ne),ce(ze)),Bt.current===s&&(ce(Bt),Nc._currentValue=le)}var Fi=Object.prototype.hasOwnProperty,qi=n.unstable_scheduleCallback,zi=n.unstable_cancelCallback,yl=n.unstable_shouldYield,Au=n.unstable_requestPaint,Yn=n.unstable_now,jf=n.unstable_getCurrentPriorityLevel,xl=n.unstable_ImmediatePriority,Hr=n.unstable_UserBlockingPriority,Hi=n.unstable_NormalPriority,Af=n.unstable_LowPriority,Br=n.unstable_IdlePriority,bl=n.log,wu=n.unstable_setDisableYieldValue,Et=null,at=null;function Mn(s){if(typeof bl=="function"&&wu(s),at&&typeof at.setStrictMode=="function")try{at.setStrictMode(Et,s)}catch{}}var cn=Math.clz32?Math.clz32:Bi,Cu=Math.log,wf=Math.LN2;function Bi(s){return s>>>=0,s===0?32:31-(Cu(s)/wf|0)|0}var Gi=256,$i=4194304;function ds(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Gr(s,r,l){var u=s.pendingLanes;if(u===0)return 0;var m=0,v=s.suspendedLanes,T=s.pingedLanes;s=s.warmLanes;var I=u&134217727;return I!==0?(u=I&~v,u!==0?m=ds(u):(T&=I,T!==0?m=ds(T):l||(l=I&~s,l!==0&&(m=ds(l))))):(I=u&~v,I!==0?m=ds(I):T!==0?m=ds(T):l||(l=u&~s,l!==0&&(m=ds(l)))),m===0?0:r!==0&&r!==m&&(r&v)===0&&(v=m&-m,l=r&-r,v>=l||v===32&&(l&4194048)!==0)?r:m}function Yi(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function Nl(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _l(){var s=Gi;return Gi<<=1,(Gi&4194048)===0&&(Gi=256),s}function El(){var s=$i;return $i<<=1,($i&62914560)===0&&($i=4194304),s}function ta(s){for(var r=[],l=0;31>l;l++)r.push(s);return r}function na(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Tl(s,r,l,u,m,v){var T=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var I=s.entanglements,z=s.expirationTimes,W=s.hiddenUpdates;for(l=T&~l;0<l;){var se=31-cn(l),re=1<<se;I[se]=0,z[se]=-1;var Z=W[se];if(Z!==null)for(W[se]=null,se=0;se<Z.length;se++){var J=Z[se];J!==null&&(J.lane&=-536870913)}l&=~re}u!==0&&ws(s,u,0),v!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=v&~(T&~r))}function ws(s,r,l){s.pendingLanes|=r,s.suspendedLanes&=~r;var u=31-cn(r);s.entangledLanes|=r,s.entanglements[u]=s.entanglements[u]|1073741824|l&4194090}function jl(s,r){var l=s.entangledLanes|=r;for(s=s.entanglements;l;){var u=31-cn(l),m=1<<u;m&r|s[u]&r&&(s[u]|=r),l&=~m}}function Va(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function $r(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ua(){var s=te.p;return s!==0?s:(s=window.event,s===void 0?32:uN(s.type))}function Su(s,r){var l=te.p;try{return te.p=s,r()}finally{te.p=l}}var xt=Math.random().toString(36).slice(2),Pt="__reactFiber$"+xt,It="__reactProps$"+xt,Qn="__reactContainer$"+xt,Al="__reactEvents$"+xt,Cf="__reactListeners$"+xt,Fa="__reactHandles$"+xt,Iu="__reactResources$"+xt,Qi="__reactMarker$"+xt;function qa(s){delete s[Pt],delete s[It],delete s[Al],delete s[Cf],delete s[Fa]}function sa(s){var r=s[Pt];if(r)return r;for(var l=s.parentNode;l;){if(r=l[Qn]||l[Pt]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(s=Kb(s);s!==null;){if(l=s[Pt])return l;s=Kb(s)}return r}s=l,l=s.parentNode}return null}function Cs(s){if(s=s[Pt]||s[Qn]){var r=s.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return s}return null}function Ss(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function vn(s){var r=s[Iu];return r||(r=s[Iu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function At(s){s[Qi]=!0}var wl=new Set,Yr={};function hs(s,r){aa(s,r),aa(s+"Capture",r)}function aa(s,r){for(Yr[s]=r,s=0;s<r.length;s++)wl.add(r[s])}var Ru=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Du={},Ki={};function Mu(s){return Fi.call(Ki,s)?!0:Fi.call(Du,s)?!1:Ru.test(s)?Ki[s]=!0:(Du[s]=!0,!1)}function za(s,r,l){if(Mu(r))if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+l)}}function Is(s,r,l){if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+l)}}function Zt(s,r,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(r,l,""+u)}}var Xi,Ou;function ia(s){if(Xi===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);Xi=r&&r[1]||"",Ou=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Xi+s+Ou}var Qr=!1;function Kr(s,r){if(!s||Qr)return"";Qr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(J){var Z=J}Reflect.construct(s,[],re)}else{try{re.call()}catch(J){Z=J}s.call(re.prototype)}}else{try{throw Error()}catch(J){Z=J}(re=s())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(J){if(J&&Z&&typeof J.stack=="string")return[J.stack,Z.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=u.DetermineComponentFrameRoot(),T=v[0],I=v[1];if(T&&I){var z=T.split(`
`),W=I.split(`
`);for(m=u=0;u<z.length&&!z[u].includes("DetermineComponentFrameRoot");)u++;for(;m<W.length&&!W[m].includes("DetermineComponentFrameRoot");)m++;if(u===z.length||m===W.length)for(u=z.length-1,m=W.length-1;1<=u&&0<=m&&z[u]!==W[m];)m--;for(;1<=u&&0<=m;u--,m--)if(z[u]!==W[m]){if(u!==1||m!==1)do if(u--,m--,0>m||z[u]!==W[m]){var se=`
`+z[u].replace(" at new "," at ");return s.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",s.displayName)),se}while(1<=u&&0<=m);break}}}finally{Qr=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?ia(l):""}function Cl(s){switch(s.tag){case 26:case 27:case 5:return ia(s.type);case 16:return ia("Lazy");case 13:return ia("Suspense");case 19:return ia("SuspenseList");case 0:case 15:return Kr(s.type,!1);case 11:return Kr(s.type.render,!1);case 1:return Kr(s.type,!0);case 31:return ia("Activity");default:return""}}function Xr(s){try{var r="";do r+=Cl(s),s=s.return;while(s);return r}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function yn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Sl(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Sf(s){var r=Sl(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,r),u=""+s[r];if(!s.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,v=l.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return m.call(this)},set:function(T){u=""+T,v.call(this,T)}}),Object.defineProperty(s,r,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function Wr(s){s._valueTracker||(s._valueTracker=Sf(s))}function Il(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var l=r.getValue(),u="";return s&&(u=Sl(s)?s.checked?"true":"false":s.value),s=u,s!==l?(r.setValue(s),!0):!1}function Wi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var If=/[\n"\\]/g;function Rt(s){return s.replace(If,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function On(s,r,l,u,m,v,T,I){s.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?s.type=T:s.removeAttribute("type"),r!=null?T==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+yn(r)):s.value!==""+yn(r)&&(s.value=""+yn(r)):T!=="submit"&&T!=="reset"||s.removeAttribute("value"),r!=null?Ha(s,T,yn(r)):l!=null?Ha(s,T,yn(l)):u!=null&&s.removeAttribute("value"),m==null&&v!=null&&(s.defaultChecked=!!v),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+yn(I):s.removeAttribute("name")}function Zi(s,r,l,u,m,v,T,I){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),r!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||r!=null))return;l=l!=null?""+yn(l):"",r=r!=null?""+yn(r):l,I||r===s.value||(s.value=r),s.defaultValue=r}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=I?s.checked:!!u,s.defaultChecked=!!u,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(s.name=T)}function Ha(s,r,l){r==="number"&&Wi(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function ra(s,r,l,u){if(s=s.options,r){r={};for(var m=0;m<l.length;m++)r["$"+l[m]]=!0;for(l=0;l<s.length;l++)m=r.hasOwnProperty("$"+s[l].value),s[l].selected!==m&&(s[l].selected=m),m&&u&&(s[l].defaultSelected=!0)}else{for(l=""+yn(l),r=null,m=0;m<s.length;m++){if(s[m].value===l){s[m].selected=!0,u&&(s[m].defaultSelected=!0);return}r!==null||s[m].disabled||(r=s[m])}r!==null&&(r.selected=!0)}}function ot(s,r,l){if(r!=null&&(r=""+yn(r),r!==s.value&&(s.value=r),l==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=l!=null?""+yn(l):""}function Ji(s,r,l,u){if(r==null){if(u!=null){if(l!=null)throw Error(i(92));if(Ie(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),r=l}l=yn(r),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u)}function Kn(s,r){if(r){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=r;return}}s.textContent=r}var er=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ku(s,r,l){var u=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":u?s.setProperty(r,l):typeof l!="number"||l===0||er.has(r)?r==="float"?s.cssFloat=l:s[r]=(""+l).trim():s[r]=l+"px"}function Rl(s,r,l){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var m in r)u=r[m],r.hasOwnProperty(m)&&l[m]!==u&&ku(s,m,u)}else for(var v in r)r.hasOwnProperty(v)&&ku(s,v,r[v])}function Dl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Df=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zr(s){return Df.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var oa=null;function Xn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var la=null,ca=null;function Ml(s){var r=Cs(s);if(r&&(s=r.stateNode)){var l=s[It]||null;e:switch(s=r.stateNode,r.type){case"input":if(On(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Rt(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var u=l[r];if(u!==s&&u.form===s.form){var m=u[It]||null;if(!m)throw Error(i(90));On(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(r=0;r<l.length;r++)u=l[r],u.form===s.form&&Il(u)}break e;case"textarea":ot(s,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&ra(s,!!l.multiple,r,!1)}}}var Rs=!1;function Pu(s,r,l){if(Rs)return s(r,l);Rs=!0;try{var u=s(r);return u}finally{if(Rs=!1,(la!==null||ca!==null)&&(Sd(),la&&(r=la,s=ca,ca=la=null,Ml(r),s)))for(r=0;r<s.length;r++)Ml(s[r])}}function tr(s,r){var l=s.stateNode;if(l===null)return null;var u=l[It]||null;if(u===null)return null;l=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var fs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wn=!1;if(fs)try{var nr={};Object.defineProperty(nr,"passive",{get:function(){Wn=!0}}),window.addEventListener("test",nr,nr),window.removeEventListener("test",nr,nr)}catch{Wn=!1}var Ds=null,Ba=null,ua=null;function Ol(){if(ua)return ua;var s,r=Ba,l=r.length,u,m="value"in Ds?Ds.value:Ds.textContent,v=m.length;for(s=0;s<l&&r[s]===m[s];s++);var T=l-s;for(u=1;u<=T&&r[l-u]===m[v-u];u++);return ua=m.slice(s,1<u?1-u:void 0)}function Ms(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function Os(){return!0}function kl(){return!1}function Gt(s){function r(l,u,m,v,T){this._reactName=l,this._targetInst=m,this.type=u,this.nativeEvent=v,this.target=T,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(l=s[I],this[I]=l?l(v):v[I]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Os:kl,this.isPropagationStopped=kl,this}return y(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Os)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Os)},persist:function(){},isPersistent:Os}),r}var st={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jr=Gt(st),sr=y({},st,{view:0,detail:0}),Lu=Gt(sr),eo,to,ks,ar=y({},sr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:or,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ks&&(ks&&s.type==="mousemove"?(eo=s.screenX-ks.screenX,to=s.screenY-ks.screenY):to=eo=0,ks=s),eo)},movementY:function(s){return"movementY"in s?s.movementY:to}}),Zn=Gt(ar),Vu=y({},ar,{dataTransfer:0}),Mf=Gt(Vu),ir=y({},sr,{relatedTarget:0}),no=Gt(ir),Pl=y({},st,{animationName:0,elapsedTime:0,pseudoElement:0}),so=Gt(Pl),Uu=y({},st,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ao=Gt(Uu),Of=y({},st,{data:0}),Ll=Gt(Of),rr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vl(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=qu[s])?!!r[s]:!1}function or(){return Vl}var zu=y({},sr,{key:function(s){if(s.key){var r=rr[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Ms(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Fu[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:or,charCode:function(s){return s.type==="keypress"?Ms(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ms(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),io=Gt(zu),Hu=y({},ar,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ul=Gt(Hu),da=y({},sr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:or}),Bu=Gt(da),Gu=y({},st,{propertyName:0,elapsedTime:0,pseudoElement:0}),$u=Gt(Gu),Yu=y({},ar,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ro=Gt(Yu),xn=y({},st,{newState:0,oldState:0}),Qu=Gt(xn),Ku=[9,13,27,32],Ps=fs&&"CompositionEvent"in window,h=null;fs&&"documentMode"in document&&(h=document.documentMode);var x=fs&&"TextEvent"in window&&!h,_=fs&&(!Ps||h&&8<h&&11>=h),M=" ",K=!1;function ne(s,r){switch(s){case"keyup":return Ku.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function de(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ke=!1;function Lt(s,r){switch(s){case"compositionend":return de(r);case"keypress":return r.which!==32?null:(K=!0,M);case"textInput":return s=r.data,s===M&&K?null:s;default:return null}}function Xe(s,r){if(Ke)return s==="compositionend"||!Ps&&ne(s,r)?(s=Ol(),ua=Ba=Ds=null,Ke=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return _&&r.locale!=="ko"?null:r.data;default:return null}}var $t={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vt(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!$t[s.type]:r==="textarea"}function ha(s,r,l,u){la?ca?ca.push(u):ca=[u]:la=u,r=kd(r,"onChange"),0<r.length&&(l=new Jr("onChange","change",null,l,u),s.push({event:l,listeners:r}))}var Jt=null,Ls=null;function Fl(s){Ub(s,0)}function Xu(s){var r=Ss(s);if(Il(r))return s}function ry(s,r){if(s==="change")return r}var oy=!1;if(fs){var kf;if(fs){var Pf="oninput"in document;if(!Pf){var ly=document.createElement("div");ly.setAttribute("oninput","return;"),Pf=typeof ly.oninput=="function"}kf=Pf}else kf=!1;oy=kf&&(!document.documentMode||9<document.documentMode)}function cy(){Jt&&(Jt.detachEvent("onpropertychange",uy),Ls=Jt=null)}function uy(s){if(s.propertyName==="value"&&Xu(Ls)){var r=[];ha(r,Ls,s,Xn(s)),Pu(Fl,r)}}function tw(s,r,l){s==="focusin"?(cy(),Jt=r,Ls=l,Jt.attachEvent("onpropertychange",uy)):s==="focusout"&&cy()}function nw(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Xu(Ls)}function sw(s,r){if(s==="click")return Xu(r)}function aw(s,r){if(s==="input"||s==="change")return Xu(r)}function iw(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var kn=typeof Object.is=="function"?Object.is:iw;function ql(s,r){if(kn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var l=Object.keys(s),u=Object.keys(r);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var m=l[u];if(!Fi.call(r,m)||!kn(s[m],r[m]))return!1}return!0}function dy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function hy(s,r){var l=dy(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=r&&u>=r)return{node:l,offset:r-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=dy(l)}}function fy(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?fy(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function my(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Wi(s.document);r instanceof s.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)s=r.contentWindow;else break;r=Wi(s.document)}return r}function Lf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var rw=fs&&"documentMode"in document&&11>=document.documentMode,oo=null,Vf=null,zl=null,Uf=!1;function py(s,r,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Uf||oo==null||oo!==Wi(u)||(u=oo,"selectionStart"in u&&Lf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),zl&&ql(zl,u)||(zl=u,u=kd(Vf,"onSelect"),0<u.length&&(r=new Jr("onSelect","select",null,r,l),s.push({event:r,listeners:u}),r.target=oo)))}function lr(s,r){var l={};return l[s.toLowerCase()]=r.toLowerCase(),l["Webkit"+s]="webkit"+r,l["Moz"+s]="moz"+r,l}var lo={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},Ff={},gy={};fs&&(gy=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function cr(s){if(Ff[s])return Ff[s];if(!lo[s])return s;var r=lo[s],l;for(l in r)if(r.hasOwnProperty(l)&&l in gy)return Ff[s]=r[l];return s}var vy=cr("animationend"),yy=cr("animationiteration"),xy=cr("animationstart"),ow=cr("transitionrun"),lw=cr("transitionstart"),cw=cr("transitioncancel"),by=cr("transitionend"),Ny=new Map,qf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");qf.push("scrollEnd");function ms(s,r){Ny.set(s,r),hs(r,[s])}var _y=new WeakMap;function Jn(s,r){if(typeof s=="object"&&s!==null){var l=_y.get(s);return l!==void 0?l:(r={value:s,source:r,stack:Xr(r)},_y.set(s,r),r)}return{value:s,source:r,stack:Xr(r)}}var es=[],co=0,zf=0;function Wu(){for(var s=co,r=zf=co=0;r<s;){var l=es[r];es[r++]=null;var u=es[r];es[r++]=null;var m=es[r];es[r++]=null;var v=es[r];if(es[r++]=null,u!==null&&m!==null){var T=u.pending;T===null?m.next=m:(m.next=T.next,T.next=m),u.pending=m}v!==0&&Ey(l,m,v)}}function Zu(s,r,l,u){es[co++]=s,es[co++]=r,es[co++]=l,es[co++]=u,zf|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function Hf(s,r,l,u){return Zu(s,r,l,u),Ju(s)}function uo(s,r){return Zu(s,null,null,r),Ju(s)}function Ey(s,r,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var m=!1,v=s.return;v!==null;)v.childLanes|=l,u=v.alternate,u!==null&&(u.childLanes|=l),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(m=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,m&&r!==null&&(m=31-cn(l),s=v.hiddenUpdates,u=s[m],u===null?s[m]=[r]:u.push(r),r.lane=l|536870912),v):null}function Ju(s){if(50<fc)throw fc=0,Km=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var ho={};function uw(s,r,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(s,r,l,u){return new uw(s,r,l,u)}function Bf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function fa(s,r){var l=s.alternate;return l===null?(l=Pn(s.tag,r,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=r,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,r=s.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Ty(s,r){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,r=l.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function ed(s,r,l,u,m,v){var T=0;if(u=s,typeof s=="function")Bf(s)&&(T=1);else if(typeof s=="string")T=hC(s,l,Ne.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=Pn(31,l,r,m),s.elementType=k,s.lanes=v,s;case b:return ur(l.children,m,v,r);case A:T=8,m|=24;break;case E:return s=Pn(12,l,r,m|2),s.elementType=E,s.lanes=v,s;case F:return s=Pn(13,l,r,m),s.elementType=F,s.lanes=v,s;case $:return s=Pn(19,l,r,m),s.elementType=$,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case D:case U:T=10;break e;case q:T=9;break e;case P:T=11;break e;case L:T=14;break e;case S:T=16,u=null;break e}T=29,l=Error(i(130,s===null?"null":typeof s,"")),u=null}return r=Pn(T,l,r,m),r.elementType=s,r.type=u,r.lanes=v,r}function ur(s,r,l,u){return s=Pn(7,s,u,r),s.lanes=l,s}function Gf(s,r,l){return s=Pn(6,s,null,r),s.lanes=l,s}function $f(s,r,l){return r=Pn(4,s.children!==null?s.children:[],s.key,r),r.lanes=l,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var fo=[],mo=0,td=null,nd=0,ts=[],ns=0,dr=null,ma=1,pa="";function hr(s,r){fo[mo++]=nd,fo[mo++]=td,td=s,nd=r}function jy(s,r,l){ts[ns++]=ma,ts[ns++]=pa,ts[ns++]=dr,dr=s;var u=ma;s=pa;var m=32-cn(u)-1;u&=~(1<<m),l+=1;var v=32-cn(r)+m;if(30<v){var T=m-m%5;v=(u&(1<<T)-1).toString(32),u>>=T,m-=T,ma=1<<32-cn(r)+m|l<<m|u,pa=v+s}else ma=1<<v|l<<m|u,pa=s}function Yf(s){s.return!==null&&(hr(s,1),jy(s,1,0))}function Qf(s){for(;s===td;)td=fo[--mo],fo[mo]=null,nd=fo[--mo],fo[mo]=null;for(;s===dr;)dr=ts[--ns],ts[ns]=null,pa=ts[--ns],ts[ns]=null,ma=ts[--ns],ts[ns]=null}var bn=null,Tt=null,nt=!1,fr=null,Vs=!1,Kf=Error(i(519));function mr(s){var r=Error(i(418,""));throw Gl(Jn(r,s)),Kf}function Ay(s){var r=s.stateNode,l=s.type,u=s.memoizedProps;switch(r[Pt]=s,r[It]=u,l){case"dialog":Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":case"embed":Ge("load",r);break;case"video":case"audio":for(l=0;l<pc.length;l++)Ge(pc[l],r);break;case"source":Ge("error",r);break;case"img":case"image":case"link":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"input":Ge("invalid",r),Zi(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Wr(r);break;case"select":Ge("invalid",r);break;case"textarea":Ge("invalid",r),Ji(r,u.value,u.defaultValue,u.children),Wr(r)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||u.suppressHydrationWarning===!0||Hb(r.textContent,l)?(u.popover!=null&&(Ge("beforetoggle",r),Ge("toggle",r)),u.onScroll!=null&&Ge("scroll",r),u.onScrollEnd!=null&&Ge("scrollend",r),u.onClick!=null&&(r.onclick=Pd),r=!0):r=!1,r||mr(s)}function wy(s){for(bn=s.return;bn;)switch(bn.tag){case 5:case 13:Vs=!1;return;case 27:case 3:Vs=!0;return;default:bn=bn.return}}function Hl(s){if(s!==bn)return!1;if(!nt)return wy(s),nt=!0,!1;var r=s.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||dp(s.type,s.memoizedProps)),l=!l),l&&Tt&&mr(s),wy(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));e:{for(s=s.nextSibling,r=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(r===0){Tt=gs(s.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++;s=s.nextSibling}Tt=null}}else r===27?(r=Tt,ri(s.type)?(s=pp,pp=null,Tt=s):Tt=r):Tt=bn?gs(s.stateNode.nextSibling):null;return!0}function Bl(){Tt=bn=null,nt=!1}function Cy(){var s=fr;return s!==null&&(Cn===null?Cn=s:Cn.push.apply(Cn,s),fr=null),s}function Gl(s){fr===null?fr=[s]:fr.push(s)}var Xf=ee(null),pr=null,ga=null;function Ga(s,r,l){ue(Xf,r._currentValue),r._currentValue=l}function va(s){s._currentValue=Xf.current,ce(Xf)}function Wf(s,r,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),s===l)break;s=s.return}}function Zf(s,r,l,u){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var v=m.dependencies;if(v!==null){var T=m.child;v=v.firstContext;e:for(;v!==null;){var I=v;v=m;for(var z=0;z<r.length;z++)if(I.context===r[z]){v.lanes|=l,I=v.alternate,I!==null&&(I.lanes|=l),Wf(v.return,l,s),u||(T=null);break e}v=I.next}}else if(m.tag===18){if(T=m.return,T===null)throw Error(i(341));T.lanes|=l,v=T.alternate,v!==null&&(v.lanes|=l),Wf(T,l,s),T=null}else T=m.child;if(T!==null)T.return=m;else for(T=m;T!==null;){if(T===s){T=null;break}if(m=T.sibling,m!==null){m.return=T.return,T=m;break}T=T.return}m=T}}function $l(s,r,l,u){s=null;for(var m=r,v=!1;m!==null;){if(!v){if((m.flags&524288)!==0)v=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var T=m.alternate;if(T===null)throw Error(i(387));if(T=T.memoizedProps,T!==null){var I=m.type;kn(m.pendingProps.value,T.value)||(s!==null?s.push(I):s=[I])}}else if(m===Bt.current){if(T=m.alternate,T===null)throw Error(i(387));T.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Nc):s=[Nc])}m=m.return}s!==null&&Zf(r,s,l,u),r.flags|=262144}function sd(s){for(s=s.firstContext;s!==null;){if(!kn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function gr(s){pr=s,ga=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function un(s){return Sy(pr,s)}function ad(s,r){return pr===null&&gr(s),Sy(s,r)}function Sy(s,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},ga===null){if(s===null)throw Error(i(308));ga=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else ga=ga.next=r;return l}var dw=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){r.aborted=!0,s.forEach(function(l){return l()})}},hw=n.unstable_scheduleCallback,fw=n.unstable_NormalPriority,Ut={$$typeof:U,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jf(){return{controller:new dw,data:new Map,refCount:0}}function Yl(s){s.refCount--,s.refCount===0&&hw(fw,function(){s.controller.abort()})}var Ql=null,em=0,po=0,go=null;function mw(s,r){if(Ql===null){var l=Ql=[];em=0,po=np(),go={status:"pending",value:void 0,then:function(u){l.push(u)}}}return em++,r.then(Iy,Iy),r}function Iy(){if(--em===0&&Ql!==null){go!==null&&(go.status="fulfilled");var s=Ql;Ql=null,po=0,go=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function pw(s,r){var l=[],u={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return s.then(function(){u.status="fulfilled",u.value=r;for(var m=0;m<l.length;m++)(0,l[m])(r)},function(m){for(u.status="rejected",u.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),u}var Ry=Y.S;Y.S=function(s,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&mw(s,r),Ry!==null&&Ry(s,r)};var vr=ee(null);function tm(){var s=vr.current;return s!==null?s:gt.pooledCache}function id(s,r){r===null?ue(vr,vr.current):ue(vr,r.pool)}function Dy(){var s=tm();return s===null?null:{parent:Ut._currentValue,pool:s}}var Kl=Error(i(460)),My=Error(i(474)),rd=Error(i(542)),nm={then:function(){}};function Oy(s){return s=s.status,s==="fulfilled"||s==="rejected"}function od(){}function ky(s,r,l){switch(l=s[l],l===void 0?s.push(r):l!==r&&(r.then(od,od),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Ly(s),s;default:if(typeof r.status=="string")r.then(od,od);else{if(s=gt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(u){if(r.status==="pending"){var m=r;m.status="fulfilled",m.value=u}},function(u){if(r.status==="pending"){var m=r;m.status="rejected",m.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Ly(s),s}throw Xl=r,Kl}}var Xl=null;function Py(){if(Xl===null)throw Error(i(459));var s=Xl;return Xl=null,s}function Ly(s){if(s===Kl||s===rd)throw Error(i(483))}var $a=!1;function sm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function am(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ya(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Qa(s,r,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(it&2)!==0){var m=u.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),u.pending=r,r=Ju(s),Ey(s,null,l),r}return Zu(s,u,r,l),Ju(s)}function Wl(s,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,jl(s,l)}}function im(s,r){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var m=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var T={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?m=v=T:v=v.next=T,l=l.next}while(l!==null);v===null?m=v=r:v=v.next=r}else m=v=r;l={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=r:s.next=r,l.lastBaseUpdate=r}var rm=!1;function Zl(){if(rm){var s=go;if(s!==null)throw s}}function Jl(s,r,l,u){rm=!1;var m=s.updateQueue;$a=!1;var v=m.firstBaseUpdate,T=m.lastBaseUpdate,I=m.shared.pending;if(I!==null){m.shared.pending=null;var z=I,W=z.next;z.next=null,T===null?v=W:T.next=W,T=z;var se=s.alternate;se!==null&&(se=se.updateQueue,I=se.lastBaseUpdate,I!==T&&(I===null?se.firstBaseUpdate=W:I.next=W,se.lastBaseUpdate=z))}if(v!==null){var re=m.baseState;T=0,se=W=z=null,I=v;do{var Z=I.lane&-536870913,J=Z!==I.lane;if(J?(We&Z)===Z:(u&Z)===Z){Z!==0&&Z===po&&(rm=!0),se!==null&&(se=se.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var Ce=s,Te=I;Z=r;var ut=l;switch(Te.tag){case 1:if(Ce=Te.payload,typeof Ce=="function"){re=Ce.call(ut,re,Z);break e}re=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=Te.payload,Z=typeof Ce=="function"?Ce.call(ut,re,Z):Ce,Z==null)break e;re=y({},re,Z);break e;case 2:$a=!0}}Z=I.callback,Z!==null&&(s.flags|=64,J&&(s.flags|=8192),J=m.callbacks,J===null?m.callbacks=[Z]:J.push(Z))}else J={lane:Z,tag:I.tag,payload:I.payload,callback:I.callback,next:null},se===null?(W=se=J,z=re):se=se.next=J,T|=Z;if(I=I.next,I===null){if(I=m.shared.pending,I===null)break;J=I,I=J.next,J.next=null,m.lastBaseUpdate=J,m.shared.pending=null}}while(!0);se===null&&(z=re),m.baseState=z,m.firstBaseUpdate=W,m.lastBaseUpdate=se,v===null&&(m.shared.lanes=0),ni|=T,s.lanes=T,s.memoizedState=re}}function Vy(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function Uy(s,r){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)Vy(l[s],r)}var vo=ee(null),ld=ee(0);function Fy(s,r){s=Ta,ue(ld,s),ue(vo,r),Ta=s|r.baseLanes}function om(){ue(ld,Ta),ue(vo,vo.current)}function lm(){Ta=ld.current,ce(vo),ce(ld)}var Ka=0,Fe=null,lt=null,Dt=null,cd=!1,yo=!1,yr=!1,ud=0,ec=0,xo=null,gw=0;function wt(){throw Error(i(321))}function cm(s,r){if(r===null)return!1;for(var l=0;l<r.length&&l<s.length;l++)if(!kn(s[l],r[l]))return!1;return!0}function um(s,r,l,u,m,v){return Ka=v,Fe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Y.H=s===null||s.memoizedState===null?Ex:Tx,yr=!1,v=l(u,m),yr=!1,yo&&(v=zy(r,l,u,m)),qy(s),v}function qy(s){Y.H=gd;var r=lt!==null&&lt.next!==null;if(Ka=0,Dt=lt=Fe=null,cd=!1,ec=0,xo=null,r)throw Error(i(300));s===null||Yt||(s=s.dependencies,s!==null&&sd(s)&&(Yt=!0))}function zy(s,r,l,u){Fe=s;var m=0;do{if(yo&&(xo=null),ec=0,yo=!1,25<=m)throw Error(i(301));if(m+=1,Dt=lt=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}Y.H=Ew,v=r(l,u)}while(yo);return v}function vw(){var s=Y.H,r=s.useState()[0];return r=typeof r.then=="function"?tc(r):r,s=s.useState()[0],(lt!==null?lt.memoizedState:null)!==s&&(Fe.flags|=1024),r}function dm(){var s=ud!==0;return ud=0,s}function hm(s,r,l){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~l}function fm(s){if(cd){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}cd=!1}Ka=0,Dt=lt=Fe=null,yo=!1,ec=ud=0,xo=null}function An(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?Fe.memoizedState=Dt=s:Dt=Dt.next=s,Dt}function Mt(){if(lt===null){var s=Fe.alternate;s=s!==null?s.memoizedState:null}else s=lt.next;var r=Dt===null?Fe.memoizedState:Dt.next;if(r!==null)Dt=r,lt=s;else{if(s===null)throw Fe.alternate===null?Error(i(467)):Error(i(310));lt=s,s={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},Dt===null?Fe.memoizedState=Dt=s:Dt=Dt.next=s}return Dt}function mm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function tc(s){var r=ec;return ec+=1,xo===null&&(xo=[]),s=ky(xo,s,r),r=Fe,(Dt===null?r.memoizedState:Dt.next)===null&&(r=r.alternate,Y.H=r===null||r.memoizedState===null?Ex:Tx),s}function dd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return tc(s);if(s.$$typeof===U)return un(s)}throw Error(i(438,String(s)))}function pm(s){var r=null,l=Fe.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var u=Fe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(m){return m.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=mm(),Fe.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(s),u=0;u<s;u++)l[u]=O;return r.index++,l}function ya(s,r){return typeof r=="function"?r(s):r}function hd(s){var r=Mt();return gm(r,lt,s)}function gm(s,r,l){var u=s.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var m=s.baseQueue,v=u.pending;if(v!==null){if(m!==null){var T=m.next;m.next=v.next,v.next=T}r.baseQueue=m=v,u.pending=null}if(v=s.baseState,m===null)s.memoizedState=v;else{r=m.next;var I=T=null,z=null,W=r,se=!1;do{var re=W.lane&-536870913;if(re!==W.lane?(We&re)===re:(Ka&re)===re){var Z=W.revertLane;if(Z===0)z!==null&&(z=z.next={lane:0,revertLane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),re===po&&(se=!0);else if((Ka&Z)===Z){W=W.next,Z===po&&(se=!0);continue}else re={lane:0,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},z===null?(I=z=re,T=v):z=z.next=re,Fe.lanes|=Z,ni|=Z;re=W.action,yr&&l(v,re),v=W.hasEagerState?W.eagerState:l(v,re)}else Z={lane:re,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},z===null?(I=z=Z,T=v):z=z.next=Z,Fe.lanes|=re,ni|=re;W=W.next}while(W!==null&&W!==r);if(z===null?T=v:z.next=I,!kn(v,s.memoizedState)&&(Yt=!0,se&&(l=go,l!==null)))throw l;s.memoizedState=v,s.baseState=T,s.baseQueue=z,u.lastRenderedState=v}return m===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function vm(s){var r=Mt(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var u=l.dispatch,m=l.pending,v=r.memoizedState;if(m!==null){l.pending=null;var T=m=m.next;do v=s(v,T.action),T=T.next;while(T!==m);kn(v,r.memoizedState)||(Yt=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),l.lastRenderedState=v}return[v,u]}function Hy(s,r,l){var u=Fe,m=Mt(),v=nt;if(v){if(l===void 0)throw Error(i(407));l=l()}else l=r();var T=!kn((lt||m).memoizedState,l);T&&(m.memoizedState=l,Yt=!0),m=m.queue;var I=$y.bind(null,u,m,s);if(nc(2048,8,I,[s]),m.getSnapshot!==r||T||Dt!==null&&Dt.memoizedState.tag&1){if(u.flags|=2048,bo(9,fd(),Gy.bind(null,u,m,l,r),null),gt===null)throw Error(i(349));v||(Ka&124)!==0||By(u,r,l)}return l}function By(s,r,l){s.flags|=16384,s={getSnapshot:r,value:l},r=Fe.updateQueue,r===null?(r=mm(),Fe.updateQueue=r,r.stores=[s]):(l=r.stores,l===null?r.stores=[s]:l.push(s))}function Gy(s,r,l,u){r.value=l,r.getSnapshot=u,Yy(r)&&Qy(s)}function $y(s,r,l){return l(function(){Yy(r)&&Qy(s)})}function Yy(s){var r=s.getSnapshot;s=s.value;try{var l=r();return!kn(s,l)}catch{return!0}}function Qy(s){var r=uo(s,2);r!==null&&qn(r,s,2)}function ym(s){var r=An();if(typeof s=="function"){var l=s;if(s=l(),yr){Mn(!0);try{l()}finally{Mn(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:s},r}function Ky(s,r,l,u){return s.baseState=l,gm(s,lt,typeof u=="function"?u:ya)}function yw(s,r,l,u,m){if(pd(s))throw Error(i(485));if(s=r.action,s!==null){var v={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){v.listeners.push(T)}};Y.T!==null?l(!0):v.isTransition=!1,u(v),l=r.pending,l===null?(v.next=r.pending=v,Xy(r,v)):(v.next=l.next,r.pending=l.next=v)}}function Xy(s,r){var l=r.action,u=r.payload,m=s.state;if(r.isTransition){var v=Y.T,T={};Y.T=T;try{var I=l(m,u),z=Y.S;z!==null&&z(T,I),Wy(s,r,I)}catch(W){xm(s,r,W)}finally{Y.T=v}}else try{v=l(m,u),Wy(s,r,v)}catch(W){xm(s,r,W)}}function Wy(s,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Zy(s,r,u)},function(u){return xm(s,r,u)}):Zy(s,r,l)}function Zy(s,r,l){r.status="fulfilled",r.value=l,Jy(r),s.state=l,r=s.pending,r!==null&&(l=r.next,l===r?s.pending=null:(l=l.next,r.next=l,Xy(s,l)))}function xm(s,r,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=l,Jy(r),r=r.next;while(r!==u)}s.action=null}function Jy(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function ex(s,r){return r}function tx(s,r){if(nt){var l=gt.formState;if(l!==null){e:{var u=Fe;if(nt){if(Tt){t:{for(var m=Tt,v=Vs;m.nodeType!==8;){if(!v){m=null;break t}if(m=gs(m.nextSibling),m===null){m=null;break t}}v=m.data,m=v==="F!"||v==="F"?m:null}if(m){Tt=gs(m.nextSibling),u=m.data==="F!";break e}}mr(u)}u=!1}u&&(r=l[0])}}return l=An(),l.memoizedState=l.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ex,lastRenderedState:r},l.queue=u,l=bx.bind(null,Fe,u),u.dispatch=l,u=ym(!1),v=Tm.bind(null,Fe,!1,u.queue),u=An(),m={state:r,dispatch:null,action:s,pending:null},u.queue=m,l=yw.bind(null,Fe,m,v,l),m.dispatch=l,u.memoizedState=s,[r,l,!1]}function nx(s){var r=Mt();return sx(r,lt,s)}function sx(s,r,l){if(r=gm(s,r,ex)[0],s=hd(ya)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=tc(r)}catch(T){throw T===Kl?rd:T}else u=r;r=Mt();var m=r.queue,v=m.dispatch;return l!==r.memoizedState&&(Fe.flags|=2048,bo(9,fd(),xw.bind(null,m,l),null)),[u,v,s]}function xw(s,r){s.action=r}function ax(s){var r=Mt(),l=lt;if(l!==null)return sx(r,l,s);Mt(),r=r.memoizedState,l=Mt();var u=l.queue.dispatch;return l.memoizedState=s,[r,u,!1]}function bo(s,r,l,u){return s={tag:s,create:l,deps:u,inst:r,next:null},r=Fe.updateQueue,r===null&&(r=mm(),Fe.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,r.lastEffect=s),s}function fd(){return{destroy:void 0,resource:void 0}}function ix(){return Mt().memoizedState}function md(s,r,l,u){var m=An();u=u===void 0?null:u,Fe.flags|=s,m.memoizedState=bo(1|r,fd(),l,u)}function nc(s,r,l,u){var m=Mt();u=u===void 0?null:u;var v=m.memoizedState.inst;lt!==null&&u!==null&&cm(u,lt.memoizedState.deps)?m.memoizedState=bo(r,v,l,u):(Fe.flags|=s,m.memoizedState=bo(1|r,v,l,u))}function rx(s,r){md(8390656,8,s,r)}function ox(s,r){nc(2048,8,s,r)}function lx(s,r){return nc(4,2,s,r)}function cx(s,r){return nc(4,4,s,r)}function ux(s,r){if(typeof r=="function"){s=s();var l=r(s);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function dx(s,r,l){l=l!=null?l.concat([s]):null,nc(4,4,ux.bind(null,r,s),l)}function bm(){}function hx(s,r){var l=Mt();r=r===void 0?null:r;var u=l.memoizedState;return r!==null&&cm(r,u[1])?u[0]:(l.memoizedState=[s,r],s)}function fx(s,r){var l=Mt();r=r===void 0?null:r;var u=l.memoizedState;if(r!==null&&cm(r,u[1]))return u[0];if(u=s(),yr){Mn(!0);try{s()}finally{Mn(!1)}}return l.memoizedState=[u,r],u}function Nm(s,r,l){return l===void 0||(Ka&1073741824)!==0?s.memoizedState=r:(s.memoizedState=l,s=gb(),Fe.lanes|=s,ni|=s,l)}function mx(s,r,l,u){return kn(l,r)?l:vo.current!==null?(s=Nm(s,l,u),kn(s,r)||(Yt=!0),s):(Ka&42)===0?(Yt=!0,s.memoizedState=l):(s=gb(),Fe.lanes|=s,ni|=s,r)}function px(s,r,l,u,m){var v=te.p;te.p=v!==0&&8>v?v:8;var T=Y.T,I={};Y.T=I,Tm(s,!1,r,l);try{var z=m(),W=Y.S;if(W!==null&&W(I,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var se=pw(z,u);sc(s,r,se,Fn(s))}else sc(s,r,u,Fn(s))}catch(re){sc(s,r,{then:function(){},status:"rejected",reason:re},Fn())}finally{te.p=v,Y.T=T}}function bw(){}function _m(s,r,l,u){if(s.tag!==5)throw Error(i(476));var m=gx(s).queue;px(s,m,r,le,l===null?bw:function(){return vx(s),l(u)})}function gx(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:le},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:l},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function vx(s){var r=gx(s).next.queue;sc(s,r,{},Fn())}function Em(){return un(Nc)}function yx(){return Mt().memoizedState}function xx(){return Mt().memoizedState}function Nw(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var l=Fn();s=Ya(l);var u=Qa(r,s,l);u!==null&&(qn(u,r,l),Wl(u,r,l)),r={cache:Jf()},s.payload=r;return}r=r.return}}function _w(s,r,l){var u=Fn();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},pd(s)?Nx(r,l):(l=Hf(s,r,l,u),l!==null&&(qn(l,s,u),_x(l,r,u)))}function bx(s,r,l){var u=Fn();sc(s,r,l,u)}function sc(s,r,l,u){var m={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(pd(s))Nx(r,m);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var T=r.lastRenderedState,I=v(T,l);if(m.hasEagerState=!0,m.eagerState=I,kn(I,T))return Zu(s,r,m,0),gt===null&&Wu(),!1}catch{}finally{}if(l=Hf(s,r,m,u),l!==null)return qn(l,s,u),_x(l,r,u),!0}return!1}function Tm(s,r,l,u){if(u={lane:2,revertLane:np(),action:u,hasEagerState:!1,eagerState:null,next:null},pd(s)){if(r)throw Error(i(479))}else r=Hf(s,l,u,2),r!==null&&qn(r,s,2)}function pd(s){var r=s.alternate;return s===Fe||r!==null&&r===Fe}function Nx(s,r){yo=cd=!0;var l=s.pending;l===null?r.next=r:(r.next=l.next,l.next=r),s.pending=r}function _x(s,r,l){if((l&4194048)!==0){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,jl(s,l)}}var gd={readContext:un,use:dd,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useLayoutEffect:wt,useInsertionEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useSyncExternalStore:wt,useId:wt,useHostTransitionStatus:wt,useFormState:wt,useActionState:wt,useOptimistic:wt,useMemoCache:wt,useCacheRefresh:wt},Ex={readContext:un,use:dd,useCallback:function(s,r){return An().memoizedState=[s,r===void 0?null:r],s},useContext:un,useEffect:rx,useImperativeHandle:function(s,r,l){l=l!=null?l.concat([s]):null,md(4194308,4,ux.bind(null,r,s),l)},useLayoutEffect:function(s,r){return md(4194308,4,s,r)},useInsertionEffect:function(s,r){md(4,2,s,r)},useMemo:function(s,r){var l=An();r=r===void 0?null:r;var u=s();if(yr){Mn(!0);try{s()}finally{Mn(!1)}}return l.memoizedState=[u,r],u},useReducer:function(s,r,l){var u=An();if(l!==void 0){var m=l(r);if(yr){Mn(!0);try{l(r)}finally{Mn(!1)}}}else m=r;return u.memoizedState=u.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},u.queue=s,s=s.dispatch=_w.bind(null,Fe,s),[u.memoizedState,s]},useRef:function(s){var r=An();return s={current:s},r.memoizedState=s},useState:function(s){s=ym(s);var r=s.queue,l=bx.bind(null,Fe,r);return r.dispatch=l,[s.memoizedState,l]},useDebugValue:bm,useDeferredValue:function(s,r){var l=An();return Nm(l,s,r)},useTransition:function(){var s=ym(!1);return s=px.bind(null,Fe,s.queue,!0,!1),An().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,l){var u=Fe,m=An();if(nt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),gt===null)throw Error(i(349));(We&124)!==0||By(u,r,l)}m.memoizedState=l;var v={value:l,getSnapshot:r};return m.queue=v,rx($y.bind(null,u,v,s),[s]),u.flags|=2048,bo(9,fd(),Gy.bind(null,u,v,l,r),null),l},useId:function(){var s=An(),r=gt.identifierPrefix;if(nt){var l=pa,u=ma;l=(u&~(1<<32-cn(u)-1)).toString(32)+l,r="«"+r+"R"+l,l=ud++,0<l&&(r+="H"+l.toString(32)),r+="»"}else l=gw++,r="«"+r+"r"+l.toString(32)+"»";return s.memoizedState=r},useHostTransitionStatus:Em,useFormState:tx,useActionState:tx,useOptimistic:function(s){var r=An();r.memoizedState=r.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=Tm.bind(null,Fe,!0,l),l.dispatch=r,[s,r]},useMemoCache:pm,useCacheRefresh:function(){return An().memoizedState=Nw.bind(null,Fe)}},Tx={readContext:un,use:dd,useCallback:hx,useContext:un,useEffect:ox,useImperativeHandle:dx,useInsertionEffect:lx,useLayoutEffect:cx,useMemo:fx,useReducer:hd,useRef:ix,useState:function(){return hd(ya)},useDebugValue:bm,useDeferredValue:function(s,r){var l=Mt();return mx(l,lt.memoizedState,s,r)},useTransition:function(){var s=hd(ya)[0],r=Mt().memoizedState;return[typeof s=="boolean"?s:tc(s),r]},useSyncExternalStore:Hy,useId:yx,useHostTransitionStatus:Em,useFormState:nx,useActionState:nx,useOptimistic:function(s,r){var l=Mt();return Ky(l,lt,s,r)},useMemoCache:pm,useCacheRefresh:xx},Ew={readContext:un,use:dd,useCallback:hx,useContext:un,useEffect:ox,useImperativeHandle:dx,useInsertionEffect:lx,useLayoutEffect:cx,useMemo:fx,useReducer:vm,useRef:ix,useState:function(){return vm(ya)},useDebugValue:bm,useDeferredValue:function(s,r){var l=Mt();return lt===null?Nm(l,s,r):mx(l,lt.memoizedState,s,r)},useTransition:function(){var s=vm(ya)[0],r=Mt().memoizedState;return[typeof s=="boolean"?s:tc(s),r]},useSyncExternalStore:Hy,useId:yx,useHostTransitionStatus:Em,useFormState:ax,useActionState:ax,useOptimistic:function(s,r){var l=Mt();return lt!==null?Ky(l,lt,s,r):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:pm,useCacheRefresh:xx},No=null,ac=0;function vd(s){var r=ac;return ac+=1,No===null&&(No=[]),ky(No,s,r)}function ic(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function yd(s,r){throw r.$$typeof===N?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function jx(s){var r=s._init;return r(s._payload)}function Ax(s){function r(Q,B){if(s){var X=Q.deletions;X===null?(Q.deletions=[B],Q.flags|=16):X.push(B)}}function l(Q,B){if(!s)return null;for(;B!==null;)r(Q,B),B=B.sibling;return null}function u(Q){for(var B=new Map;Q!==null;)Q.key!==null?B.set(Q.key,Q):B.set(Q.index,Q),Q=Q.sibling;return B}function m(Q,B){return Q=fa(Q,B),Q.index=0,Q.sibling=null,Q}function v(Q,B,X){return Q.index=X,s?(X=Q.alternate,X!==null?(X=X.index,X<B?(Q.flags|=67108866,B):X):(Q.flags|=67108866,B)):(Q.flags|=1048576,B)}function T(Q){return s&&Q.alternate===null&&(Q.flags|=67108866),Q}function I(Q,B,X,ae){return B===null||B.tag!==6?(B=Gf(X,Q.mode,ae),B.return=Q,B):(B=m(B,X),B.return=Q,B)}function z(Q,B,X,ae){var ve=X.type;return ve===b?se(Q,B,X.props.children,ae,X.key):B!==null&&(B.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===S&&jx(ve)===B.type)?(B=m(B,X.props),ic(B,X),B.return=Q,B):(B=ed(X.type,X.key,X.props,null,Q.mode,ae),ic(B,X),B.return=Q,B)}function W(Q,B,X,ae){return B===null||B.tag!==4||B.stateNode.containerInfo!==X.containerInfo||B.stateNode.implementation!==X.implementation?(B=$f(X,Q.mode,ae),B.return=Q,B):(B=m(B,X.children||[]),B.return=Q,B)}function se(Q,B,X,ae,ve){return B===null||B.tag!==7?(B=ur(X,Q.mode,ae,ve),B.return=Q,B):(B=m(B,X),B.return=Q,B)}function re(Q,B,X){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=Gf(""+B,Q.mode,X),B.return=Q,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case j:return X=ed(B.type,B.key,B.props,null,Q.mode,X),ic(X,B),X.return=Q,X;case w:return B=$f(B,Q.mode,X),B.return=Q,B;case S:var ae=B._init;return B=ae(B._payload),re(Q,B,X)}if(Ie(B)||R(B))return B=ur(B,Q.mode,X,null),B.return=Q,B;if(typeof B.then=="function")return re(Q,vd(B),X);if(B.$$typeof===U)return re(Q,ad(Q,B),X);yd(Q,B)}return null}function Z(Q,B,X,ae){var ve=B!==null?B.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return ve!==null?null:I(Q,B,""+X,ae);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case j:return X.key===ve?z(Q,B,X,ae):null;case w:return X.key===ve?W(Q,B,X,ae):null;case S:return ve=X._init,X=ve(X._payload),Z(Q,B,X,ae)}if(Ie(X)||R(X))return ve!==null?null:se(Q,B,X,ae,null);if(typeof X.then=="function")return Z(Q,B,vd(X),ae);if(X.$$typeof===U)return Z(Q,B,ad(Q,X),ae);yd(Q,X)}return null}function J(Q,B,X,ae,ve){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Q=Q.get(X)||null,I(B,Q,""+ae,ve);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case j:return Q=Q.get(ae.key===null?X:ae.key)||null,z(B,Q,ae,ve);case w:return Q=Q.get(ae.key===null?X:ae.key)||null,W(B,Q,ae,ve);case S:var He=ae._init;return ae=He(ae._payload),J(Q,B,X,ae,ve)}if(Ie(ae)||R(ae))return Q=Q.get(X)||null,se(B,Q,ae,ve,null);if(typeof ae.then=="function")return J(Q,B,X,vd(ae),ve);if(ae.$$typeof===U)return J(Q,B,X,ad(B,ae),ve);yd(B,ae)}return null}function Ce(Q,B,X,ae){for(var ve=null,He=null,xe=B,je=B=0,Kt=null;xe!==null&&je<X.length;je++){xe.index>je?(Kt=xe,xe=null):Kt=xe.sibling;var tt=Z(Q,xe,X[je],ae);if(tt===null){xe===null&&(xe=Kt);break}s&&xe&&tt.alternate===null&&r(Q,xe),B=v(tt,B,je),He===null?ve=tt:He.sibling=tt,He=tt,xe=Kt}if(je===X.length)return l(Q,xe),nt&&hr(Q,je),ve;if(xe===null){for(;je<X.length;je++)xe=re(Q,X[je],ae),xe!==null&&(B=v(xe,B,je),He===null?ve=xe:He.sibling=xe,He=xe);return nt&&hr(Q,je),ve}for(xe=u(xe);je<X.length;je++)Kt=J(xe,Q,je,X[je],ae),Kt!==null&&(s&&Kt.alternate!==null&&xe.delete(Kt.key===null?je:Kt.key),B=v(Kt,B,je),He===null?ve=Kt:He.sibling=Kt,He=Kt);return s&&xe.forEach(function(di){return r(Q,di)}),nt&&hr(Q,je),ve}function Te(Q,B,X,ae){if(X==null)throw Error(i(151));for(var ve=null,He=null,xe=B,je=B=0,Kt=null,tt=X.next();xe!==null&&!tt.done;je++,tt=X.next()){xe.index>je?(Kt=xe,xe=null):Kt=xe.sibling;var di=Z(Q,xe,tt.value,ae);if(di===null){xe===null&&(xe=Kt);break}s&&xe&&di.alternate===null&&r(Q,xe),B=v(di,B,je),He===null?ve=di:He.sibling=di,He=di,xe=Kt}if(tt.done)return l(Q,xe),nt&&hr(Q,je),ve;if(xe===null){for(;!tt.done;je++,tt=X.next())tt=re(Q,tt.value,ae),tt!==null&&(B=v(tt,B,je),He===null?ve=tt:He.sibling=tt,He=tt);return nt&&hr(Q,je),ve}for(xe=u(xe);!tt.done;je++,tt=X.next())tt=J(xe,Q,je,tt.value,ae),tt!==null&&(s&&tt.alternate!==null&&xe.delete(tt.key===null?je:tt.key),B=v(tt,B,je),He===null?ve=tt:He.sibling=tt,He=tt);return s&&xe.forEach(function(TC){return r(Q,TC)}),nt&&hr(Q,je),ve}function ut(Q,B,X,ae){if(typeof X=="object"&&X!==null&&X.type===b&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case j:e:{for(var ve=X.key;B!==null;){if(B.key===ve){if(ve=X.type,ve===b){if(B.tag===7){l(Q,B.sibling),ae=m(B,X.props.children),ae.return=Q,Q=ae;break e}}else if(B.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===S&&jx(ve)===B.type){l(Q,B.sibling),ae=m(B,X.props),ic(ae,X),ae.return=Q,Q=ae;break e}l(Q,B);break}else r(Q,B);B=B.sibling}X.type===b?(ae=ur(X.props.children,Q.mode,ae,X.key),ae.return=Q,Q=ae):(ae=ed(X.type,X.key,X.props,null,Q.mode,ae),ic(ae,X),ae.return=Q,Q=ae)}return T(Q);case w:e:{for(ve=X.key;B!==null;){if(B.key===ve)if(B.tag===4&&B.stateNode.containerInfo===X.containerInfo&&B.stateNode.implementation===X.implementation){l(Q,B.sibling),ae=m(B,X.children||[]),ae.return=Q,Q=ae;break e}else{l(Q,B);break}else r(Q,B);B=B.sibling}ae=$f(X,Q.mode,ae),ae.return=Q,Q=ae}return T(Q);case S:return ve=X._init,X=ve(X._payload),ut(Q,B,X,ae)}if(Ie(X))return Ce(Q,B,X,ae);if(R(X)){if(ve=R(X),typeof ve!="function")throw Error(i(150));return X=ve.call(X),Te(Q,B,X,ae)}if(typeof X.then=="function")return ut(Q,B,vd(X),ae);if(X.$$typeof===U)return ut(Q,B,ad(Q,X),ae);yd(Q,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,B!==null&&B.tag===6?(l(Q,B.sibling),ae=m(B,X),ae.return=Q,Q=ae):(l(Q,B),ae=Gf(X,Q.mode,ae),ae.return=Q,Q=ae),T(Q)):l(Q,B)}return function(Q,B,X,ae){try{ac=0;var ve=ut(Q,B,X,ae);return No=null,ve}catch(xe){if(xe===Kl||xe===rd)throw xe;var He=Pn(29,xe,null,Q.mode);return He.lanes=ae,He.return=Q,He}finally{}}}var _o=Ax(!0),wx=Ax(!1),ss=ee(null),Us=null;function Xa(s){var r=s.alternate;ue(Ft,Ft.current&1),ue(ss,s),Us===null&&(r===null||vo.current!==null||r.memoizedState!==null)&&(Us=s)}function Cx(s){if(s.tag===22){if(ue(Ft,Ft.current),ue(ss,s),Us===null){var r=s.alternate;r!==null&&r.memoizedState!==null&&(Us=s)}}else Wa()}function Wa(){ue(Ft,Ft.current),ue(ss,ss.current)}function xa(s){ce(ss),Us===s&&(Us=null),ce(Ft)}var Ft=ee(0);function xd(s){for(var r=s;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||mp(l)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function jm(s,r,l,u){r=s.memoizedState,l=l(u,r),l=l==null?r:y({},r,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Am={enqueueSetState:function(s,r,l){s=s._reactInternals;var u=Fn(),m=Ya(u);m.payload=r,l!=null&&(m.callback=l),r=Qa(s,m,u),r!==null&&(qn(r,s,u),Wl(r,s,u))},enqueueReplaceState:function(s,r,l){s=s._reactInternals;var u=Fn(),m=Ya(u);m.tag=1,m.payload=r,l!=null&&(m.callback=l),r=Qa(s,m,u),r!==null&&(qn(r,s,u),Wl(r,s,u))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var l=Fn(),u=Ya(l);u.tag=2,r!=null&&(u.callback=r),r=Qa(s,u,l),r!==null&&(qn(r,s,l),Wl(r,s,l))}};function Sx(s,r,l,u,m,v,T){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,v,T):r.prototype&&r.prototype.isPureReactComponent?!ql(l,u)||!ql(m,v):!0}function Ix(s,r,l,u){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,u),r.state!==s&&Am.enqueueReplaceState(r,r.state,null)}function xr(s,r){var l=r;if("ref"in r){l={};for(var u in r)u!=="ref"&&(l[u]=r[u])}if(s=s.defaultProps){l===r&&(l=y({},l));for(var m in s)l[m]===void 0&&(l[m]=s[m])}return l}var bd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Rx(s){bd(s)}function Dx(s){console.error(s)}function Mx(s){bd(s)}function Nd(s,r){try{var l=s.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function Ox(s,r,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function wm(s,r,l){return l=Ya(l),l.tag=3,l.payload={element:null},l.callback=function(){Nd(s,r)},l}function kx(s){return s=Ya(s),s.tag=3,s}function Px(s,r,l,u){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var v=u.value;s.payload=function(){return m(v)},s.callback=function(){Ox(r,l,u)}}var T=l.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(s.callback=function(){Ox(r,l,u),typeof m!="function"&&(si===null?si=new Set([this]):si.add(this));var I=u.stack;this.componentDidCatch(u.value,{componentStack:I!==null?I:""})})}function Tw(s,r,l,u,m){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=l.alternate,r!==null&&$l(r,l,m,!0),l=ss.current,l!==null){switch(l.tag){case 13:return Us===null?Wm():l.alternate===null&&jt===0&&(jt=3),l.flags&=-257,l.flags|=65536,l.lanes=m,u===nm?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([u]):r.add(u),Jm(s,u,m)),!1;case 22:return l.flags|=65536,u===nm?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([u]):l.add(u)),Jm(s,u,m)),!1}throw Error(i(435,l.tag))}return Jm(s,u,m),Wm(),!1}if(nt)return r=ss.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=m,u!==Kf&&(s=Error(i(422),{cause:u}),Gl(Jn(s,l)))):(u!==Kf&&(r=Error(i(423),{cause:u}),Gl(Jn(r,l))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,u=Jn(u,l),m=wm(s.stateNode,u,m),im(s,m),jt!==4&&(jt=2)),!1;var v=Error(i(520),{cause:u});if(v=Jn(v,l),hc===null?hc=[v]:hc.push(v),jt!==4&&(jt=2),r===null)return!0;u=Jn(u,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,s=m&-m,l.lanes|=s,s=wm(l.stateNode,u,s),im(l,s),!1;case 1:if(r=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(si===null||!si.has(v))))return l.flags|=65536,m&=-m,l.lanes|=m,m=kx(m),Px(m,s,l,u),im(l,m),!1}l=l.return}while(l!==null);return!1}var Lx=Error(i(461)),Yt=!1;function en(s,r,l,u){r.child=s===null?wx(r,null,l,u):_o(r,s.child,l,u)}function Vx(s,r,l,u,m){l=l.render;var v=r.ref;if("ref"in u){var T={};for(var I in u)I!=="ref"&&(T[I]=u[I])}else T=u;return gr(r),u=um(s,r,l,T,v,m),I=dm(),s!==null&&!Yt?(hm(s,r,m),ba(s,r,m)):(nt&&I&&Yf(r),r.flags|=1,en(s,r,u,m),r.child)}function Ux(s,r,l,u,m){if(s===null){var v=l.type;return typeof v=="function"&&!Bf(v)&&v.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=v,Fx(s,r,v,u,m)):(s=ed(l.type,null,u,r,r.mode,m),s.ref=r.ref,s.return=r,r.child=s)}if(v=s.child,!km(s,m)){var T=v.memoizedProps;if(l=l.compare,l=l!==null?l:ql,l(T,u)&&s.ref===r.ref)return ba(s,r,m)}return r.flags|=1,s=fa(v,u),s.ref=r.ref,s.return=r,r.child=s}function Fx(s,r,l,u,m){if(s!==null){var v=s.memoizedProps;if(ql(v,u)&&s.ref===r.ref)if(Yt=!1,r.pendingProps=u=v,km(s,m))(s.flags&131072)!==0&&(Yt=!0);else return r.lanes=s.lanes,ba(s,r,m)}return Cm(s,r,l,u,m)}function qx(s,r,l){var u=r.pendingProps,m=u.children,v=s!==null?s.memoizedState:null;if(u.mode==="hidden"){if((r.flags&128)!==0){if(u=v!==null?v.baseLanes|l:l,s!==null){for(m=r.child=s.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;r.childLanes=v&~u}else r.childLanes=0,r.child=null;return zx(s,r,u,l)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&id(r,v!==null?v.cachePool:null),v!==null?Fy(r,v):om(),Cx(r);else return r.lanes=r.childLanes=536870912,zx(s,r,v!==null?v.baseLanes|l:l,l)}else v!==null?(id(r,v.cachePool),Fy(r,v),Wa(),r.memoizedState=null):(s!==null&&id(r,null),om(),Wa());return en(s,r,m,l),r.child}function zx(s,r,l,u){var m=tm();return m=m===null?null:{parent:Ut._currentValue,pool:m},r.memoizedState={baseLanes:l,cachePool:m},s!==null&&id(r,null),om(),Cx(r),s!==null&&$l(s,r,u,!0),null}function _d(s,r){var l=r.ref;if(l===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(r.flags|=4194816)}}function Cm(s,r,l,u,m){return gr(r),l=um(s,r,l,u,void 0,m),u=dm(),s!==null&&!Yt?(hm(s,r,m),ba(s,r,m)):(nt&&u&&Yf(r),r.flags|=1,en(s,r,l,m),r.child)}function Hx(s,r,l,u,m,v){return gr(r),r.updateQueue=null,l=zy(r,u,l,m),qy(s),u=dm(),s!==null&&!Yt?(hm(s,r,v),ba(s,r,v)):(nt&&u&&Yf(r),r.flags|=1,en(s,r,l,v),r.child)}function Bx(s,r,l,u,m){if(gr(r),r.stateNode===null){var v=ho,T=l.contextType;typeof T=="object"&&T!==null&&(v=un(T)),v=new l(u,v),r.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Am,r.stateNode=v,v._reactInternals=r,v=r.stateNode,v.props=u,v.state=r.memoizedState,v.refs={},sm(r),T=l.contextType,v.context=typeof T=="object"&&T!==null?un(T):ho,v.state=r.memoizedState,T=l.getDerivedStateFromProps,typeof T=="function"&&(jm(r,l,T,u),v.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(T=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),T!==v.state&&Am.enqueueReplaceState(v,v.state,null),Jl(r,u,v,m),Zl(),v.state=r.memoizedState),typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(s===null){v=r.stateNode;var I=r.memoizedProps,z=xr(l,I);v.props=z;var W=v.context,se=l.contextType;T=ho,typeof se=="object"&&se!==null&&(T=un(se));var re=l.getDerivedStateFromProps;se=typeof re=="function"||typeof v.getSnapshotBeforeUpdate=="function",I=r.pendingProps!==I,se||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(I||W!==T)&&Ix(r,v,u,T),$a=!1;var Z=r.memoizedState;v.state=Z,Jl(r,u,v,m),Zl(),W=r.memoizedState,I||Z!==W||$a?(typeof re=="function"&&(jm(r,l,re,u),W=r.memoizedState),(z=$a||Sx(r,l,z,u,Z,W,T))?(se||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=W),v.props=u,v.state=W,v.context=T,u=z):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{v=r.stateNode,am(s,r),T=r.memoizedProps,se=xr(l,T),v.props=se,re=r.pendingProps,Z=v.context,W=l.contextType,z=ho,typeof W=="object"&&W!==null&&(z=un(W)),I=l.getDerivedStateFromProps,(W=typeof I=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(T!==re||Z!==z)&&Ix(r,v,u,z),$a=!1,Z=r.memoizedState,v.state=Z,Jl(r,u,v,m),Zl();var J=r.memoizedState;T!==re||Z!==J||$a||s!==null&&s.dependencies!==null&&sd(s.dependencies)?(typeof I=="function"&&(jm(r,l,I,u),J=r.memoizedState),(se=$a||Sx(r,l,se,u,Z,J,z)||s!==null&&s.dependencies!==null&&sd(s.dependencies))?(W||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,J,z),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,J,z)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=J),v.props=u,v.state=J,v.context=z,u=se):(typeof v.componentDidUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(r.flags|=1024),u=!1)}return v=u,_d(s,r),u=(r.flags&128)!==0,v||u?(v=r.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:v.render(),r.flags|=1,s!==null&&u?(r.child=_o(r,s.child,null,m),r.child=_o(r,null,l,m)):en(s,r,l,m),r.memoizedState=v.state,s=r.child):s=ba(s,r,m),s}function Gx(s,r,l,u){return Bl(),r.flags|=256,en(s,r,l,u),r.child}var Sm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Im(s){return{baseLanes:s,cachePool:Dy()}}function Rm(s,r,l){return s=s!==null?s.childLanes&~l:0,r&&(s|=as),s}function $x(s,r,l){var u=r.pendingProps,m=!1,v=(r.flags&128)!==0,T;if((T=v)||(T=s!==null&&s.memoizedState===null?!1:(Ft.current&2)!==0),T&&(m=!0,r.flags&=-129),T=(r.flags&32)!==0,r.flags&=-33,s===null){if(nt){if(m?Xa(r):Wa(),nt){var I=Tt,z;if(z=I){e:{for(z=I,I=Vs;z.nodeType!==8;){if(!I){I=null;break e}if(z=gs(z.nextSibling),z===null){I=null;break e}}I=z}I!==null?(r.memoizedState={dehydrated:I,treeContext:dr!==null?{id:ma,overflow:pa}:null,retryLane:536870912,hydrationErrors:null},z=Pn(18,null,null,0),z.stateNode=I,z.return=r,r.child=z,bn=r,Tt=null,z=!0):z=!1}z||mr(r)}if(I=r.memoizedState,I!==null&&(I=I.dehydrated,I!==null))return mp(I)?r.lanes=32:r.lanes=536870912,null;xa(r)}return I=u.children,u=u.fallback,m?(Wa(),m=r.mode,I=Ed({mode:"hidden",children:I},m),u=ur(u,m,l,null),I.return=r,u.return=r,I.sibling=u,r.child=I,m=r.child,m.memoizedState=Im(l),m.childLanes=Rm(s,T,l),r.memoizedState=Sm,u):(Xa(r),Dm(r,I))}if(z=s.memoizedState,z!==null&&(I=z.dehydrated,I!==null)){if(v)r.flags&256?(Xa(r),r.flags&=-257,r=Mm(s,r,l)):r.memoizedState!==null?(Wa(),r.child=s.child,r.flags|=128,r=null):(Wa(),m=u.fallback,I=r.mode,u=Ed({mode:"visible",children:u.children},I),m=ur(m,I,l,null),m.flags|=2,u.return=r,m.return=r,u.sibling=m,r.child=u,_o(r,s.child,null,l),u=r.child,u.memoizedState=Im(l),u.childLanes=Rm(s,T,l),r.memoizedState=Sm,r=m);else if(Xa(r),mp(I)){if(T=I.nextSibling&&I.nextSibling.dataset,T)var W=T.dgst;T=W,u=Error(i(419)),u.stack="",u.digest=T,Gl({value:u,source:null,stack:null}),r=Mm(s,r,l)}else if(Yt||$l(s,r,l,!1),T=(l&s.childLanes)!==0,Yt||T){if(T=gt,T!==null&&(u=l&-l,u=(u&42)!==0?1:Va(u),u=(u&(T.suspendedLanes|l))!==0?0:u,u!==0&&u!==z.retryLane))throw z.retryLane=u,uo(s,u),qn(T,s,u),Lx;I.data==="$?"||Wm(),r=Mm(s,r,l)}else I.data==="$?"?(r.flags|=192,r.child=s.child,r=null):(s=z.treeContext,Tt=gs(I.nextSibling),bn=r,nt=!0,fr=null,Vs=!1,s!==null&&(ts[ns++]=ma,ts[ns++]=pa,ts[ns++]=dr,ma=s.id,pa=s.overflow,dr=r),r=Dm(r,u.children),r.flags|=4096);return r}return m?(Wa(),m=u.fallback,I=r.mode,z=s.child,W=z.sibling,u=fa(z,{mode:"hidden",children:u.children}),u.subtreeFlags=z.subtreeFlags&65011712,W!==null?m=fa(W,m):(m=ur(m,I,l,null),m.flags|=2),m.return=r,u.return=r,u.sibling=m,r.child=u,u=m,m=r.child,I=s.child.memoizedState,I===null?I=Im(l):(z=I.cachePool,z!==null?(W=Ut._currentValue,z=z.parent!==W?{parent:W,pool:W}:z):z=Dy(),I={baseLanes:I.baseLanes|l,cachePool:z}),m.memoizedState=I,m.childLanes=Rm(s,T,l),r.memoizedState=Sm,u):(Xa(r),l=s.child,s=l.sibling,l=fa(l,{mode:"visible",children:u.children}),l.return=r,l.sibling=null,s!==null&&(T=r.deletions,T===null?(r.deletions=[s],r.flags|=16):T.push(s)),r.child=l,r.memoizedState=null,l)}function Dm(s,r){return r=Ed({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Ed(s,r){return s=Pn(22,s,null,r),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Mm(s,r,l){return _o(r,s.child,null,l),s=Dm(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function Yx(s,r,l){s.lanes|=r;var u=s.alternate;u!==null&&(u.lanes|=r),Wf(s.return,r,l)}function Om(s,r,l,u,m){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:m}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=l,v.tailMode=m)}function Qx(s,r,l){var u=r.pendingProps,m=u.revealOrder,v=u.tail;if(en(s,r,u.children,l),u=Ft.current,(u&2)!==0)u=u&1|2,r.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Yx(s,l,r);else if(s.tag===19)Yx(s,l,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}u&=1}switch(ue(Ft,u),m){case"forwards":for(l=r.child,m=null;l!==null;)s=l.alternate,s!==null&&xd(s)===null&&(m=l),l=l.sibling;l=m,l===null?(m=r.child,r.child=null):(m=l.sibling,l.sibling=null),Om(r,!1,m,l,v);break;case"backwards":for(l=null,m=r.child,r.child=null;m!==null;){if(s=m.alternate,s!==null&&xd(s)===null){r.child=m;break}s=m.sibling,m.sibling=l,l=m,m=s}Om(r,!0,l,null,v);break;case"together":Om(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function ba(s,r,l){if(s!==null&&(r.dependencies=s.dependencies),ni|=r.lanes,(l&r.childLanes)===0)if(s!==null){if($l(s,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,l=fa(s,s.pendingProps),r.child=l,l.return=r;s.sibling!==null;)s=s.sibling,l=l.sibling=fa(s,s.pendingProps),l.return=r;l.sibling=null}return r.child}function km(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&sd(s)))}function jw(s,r,l){switch(r.tag){case 3:pt(r,r.stateNode.containerInfo),Ga(r,Ut,s.memoizedState.cache),Bl();break;case 27:case 5:La(r);break;case 4:pt(r,r.stateNode.containerInfo);break;case 10:Ga(r,r.type,r.memoizedProps.value);break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(Xa(r),r.flags|=128,null):(l&r.child.childLanes)!==0?$x(s,r,l):(Xa(r),s=ba(s,r,l),s!==null?s.sibling:null);Xa(r);break;case 19:var m=(s.flags&128)!==0;if(u=(l&r.childLanes)!==0,u||($l(s,r,l,!1),u=(l&r.childLanes)!==0),m){if(u)return Qx(s,r,l);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ue(Ft,Ft.current),u)break;return null;case 22:case 23:return r.lanes=0,qx(s,r,l);case 24:Ga(r,Ut,s.memoizedState.cache)}return ba(s,r,l)}function Kx(s,r,l){if(s!==null)if(s.memoizedProps!==r.pendingProps)Yt=!0;else{if(!km(s,l)&&(r.flags&128)===0)return Yt=!1,jw(s,r,l);Yt=(s.flags&131072)!==0}else Yt=!1,nt&&(r.flags&1048576)!==0&&jy(r,nd,r.index);switch(r.lanes=0,r.tag){case 16:e:{s=r.pendingProps;var u=r.elementType,m=u._init;if(u=m(u._payload),r.type=u,typeof u=="function")Bf(u)?(s=xr(u,s),r.tag=1,r=Bx(null,r,u,s,l)):(r.tag=0,r=Cm(null,r,u,s,l));else{if(u!=null){if(m=u.$$typeof,m===P){r.tag=11,r=Vx(null,r,u,s,l);break e}else if(m===L){r.tag=14,r=Ux(null,r,u,s,l);break e}}throw r=ye(u)||u,Error(i(306,r,""))}}return r;case 0:return Cm(s,r,r.type,r.pendingProps,l);case 1:return u=r.type,m=xr(u,r.pendingProps),Bx(s,r,u,m,l);case 3:e:{if(pt(r,r.stateNode.containerInfo),s===null)throw Error(i(387));u=r.pendingProps;var v=r.memoizedState;m=v.element,am(s,r),Jl(r,u,null,l);var T=r.memoizedState;if(u=T.cache,Ga(r,Ut,u),u!==v.cache&&Zf(r,[Ut],l,!0),Zl(),u=T.element,v.isDehydrated)if(v={element:u,isDehydrated:!1,cache:T.cache},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){r=Gx(s,r,u,l);break e}else if(u!==m){m=Jn(Error(i(424)),r),Gl(m),r=Gx(s,r,u,l);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Tt=gs(s.firstChild),bn=r,nt=!0,fr=null,Vs=!0,l=wx(r,null,u,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Bl(),u===m){r=ba(s,r,l);break e}en(s,r,u,l)}r=r.child}return r;case 26:return _d(s,r),s===null?(l=Jb(r.type,null,r.pendingProps,null))?r.memoizedState=l:nt||(l=r.type,s=r.pendingProps,u=Ld(Re.current).createElement(l),u[Pt]=r,u[It]=s,nn(u,l,s),At(u),r.stateNode=u):r.memoizedState=Jb(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return La(r),s===null&&nt&&(u=r.stateNode=Xb(r.type,r.pendingProps,Re.current),bn=r,Vs=!0,m=Tt,ri(r.type)?(pp=m,Tt=gs(u.firstChild)):Tt=m),en(s,r,r.pendingProps.children,l),_d(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&nt&&((m=u=Tt)&&(u=Jw(u,r.type,r.pendingProps,Vs),u!==null?(r.stateNode=u,bn=r,Tt=gs(u.firstChild),Vs=!1,m=!0):m=!1),m||mr(r)),La(r),m=r.type,v=r.pendingProps,T=s!==null?s.memoizedProps:null,u=v.children,dp(m,v)?u=null:T!==null&&dp(m,T)&&(r.flags|=32),r.memoizedState!==null&&(m=um(s,r,vw,null,null,l),Nc._currentValue=m),_d(s,r),en(s,r,u,l),r.child;case 6:return s===null&&nt&&((s=l=Tt)&&(l=eC(l,r.pendingProps,Vs),l!==null?(r.stateNode=l,bn=r,Tt=null,s=!0):s=!1),s||mr(r)),null;case 13:return $x(s,r,l);case 4:return pt(r,r.stateNode.containerInfo),u=r.pendingProps,s===null?r.child=_o(r,null,u,l):en(s,r,u,l),r.child;case 11:return Vx(s,r,r.type,r.pendingProps,l);case 7:return en(s,r,r.pendingProps,l),r.child;case 8:return en(s,r,r.pendingProps.children,l),r.child;case 12:return en(s,r,r.pendingProps.children,l),r.child;case 10:return u=r.pendingProps,Ga(r,r.type,u.value),en(s,r,u.children,l),r.child;case 9:return m=r.type._context,u=r.pendingProps.children,gr(r),m=un(m),u=u(m),r.flags|=1,en(s,r,u,l),r.child;case 14:return Ux(s,r,r.type,r.pendingProps,l);case 15:return Fx(s,r,r.type,r.pendingProps,l);case 19:return Qx(s,r,l);case 31:return u=r.pendingProps,l=r.mode,u={mode:u.mode,children:u.children},s===null?(l=Ed(u,l),l.ref=r.ref,r.child=l,l.return=r,r=l):(l=fa(s.child,u),l.ref=r.ref,r.child=l,l.return=r,r=l),r;case 22:return qx(s,r,l);case 24:return gr(r),u=un(Ut),s===null?(m=tm(),m===null&&(m=gt,v=Jf(),m.pooledCache=v,v.refCount++,v!==null&&(m.pooledCacheLanes|=l),m=v),r.memoizedState={parent:u,cache:m},sm(r),Ga(r,Ut,m)):((s.lanes&l)!==0&&(am(s,r),Jl(r,null,null,l),Zl()),m=s.memoizedState,v=r.memoizedState,m.parent!==u?(m={parent:u,cache:u},r.memoizedState=m,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=m),Ga(r,Ut,u)):(u=v.cache,Ga(r,Ut,u),u!==m.cache&&Zf(r,[Ut],l,!0))),en(s,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Na(s){s.flags|=4}function Xx(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!aN(r)){if(r=ss.current,r!==null&&((We&4194048)===We?Us!==null:(We&62914560)!==We&&(We&536870912)===0||r!==Us))throw Xl=nm,My;s.flags|=8192}}function Td(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?El():536870912,s.lanes|=r,Ao|=r)}function rc(s,r){if(!nt)switch(s.tailMode){case"hidden":r=s.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function Nt(s){var r=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(r)for(var m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=u,s.childLanes=l,r}function Aw(s,r,l){var u=r.pendingProps;switch(Qf(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(r),null;case 1:return Nt(r),null;case 3:return l=r.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),va(Ut),As(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Hl(r)?Na(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Cy())),Nt(r),null;case 26:return l=r.memoizedState,s===null?(Na(r),l!==null?(Nt(r),Xx(r,l)):(Nt(r),r.flags&=-16777217)):l?l!==s.memoizedState?(Na(r),Nt(r),Xx(r,l)):(Nt(r),r.flags&=-16777217):(s.memoizedProps!==u&&Na(r),Nt(r),r.flags&=-16777217),null;case 27:ea(r),l=Re.current;var m=r.type;if(s!==null&&r.stateNode!=null)s.memoizedProps!==u&&Na(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Nt(r),null}s=Ne.current,Hl(r)?Ay(r):(s=Xb(m,u,l),r.stateNode=s,Na(r))}return Nt(r),null;case 5:if(ea(r),l=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&Na(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Nt(r),null}if(s=Ne.current,Hl(r))Ay(r);else{switch(m=Ld(Re.current),s){case 1:s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=m.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof u.is=="string"?m.createElement("select",{is:u.is}):m.createElement("select"),u.multiple?s.multiple=!0:u.size&&(s.size=u.size);break;default:s=typeof u.is=="string"?m.createElement(l,{is:u.is}):m.createElement(l)}}s[Pt]=r,s[It]=u;e:for(m=r.child;m!==null;){if(m.tag===5||m.tag===6)s.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===r)break e;for(;m.sibling===null;){if(m.return===null||m.return===r)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}r.stateNode=s;e:switch(nn(s,l,u),l){case"button":case"input":case"select":case"textarea":s=!!u.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Na(r)}}return Nt(r),r.flags&=-16777217,null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==u&&Na(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(s=Re.current,Hl(r)){if(s=r.stateNode,l=r.memoizedProps,u=null,m=bn,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}s[Pt]=r,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||Hb(s.nodeValue,l)),s||mr(r)}else s=Ld(s).createTextNode(u),s[Pt]=r,r.stateNode=s}return Nt(r),null;case 13:if(u=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=Hl(r),u!==null&&u.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[Pt]=r}else Bl(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Nt(r),m=!1}else m=Cy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return r.flags&256?(xa(r),r):(xa(r),null)}if(xa(r),(r.flags&128)!==0)return r.lanes=l,r;if(l=u!==null,s=s!==null&&s.memoizedState!==null,l){u=r.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool);var v=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),v!==m&&(u.flags|=2048)}return l!==s&&l&&(r.child.flags|=8192),Td(r,r.updateQueue),Nt(r),null;case 4:return As(),s===null&&rp(r.stateNode.containerInfo),Nt(r),null;case 10:return va(r.type),Nt(r),null;case 19:if(ce(Ft),m=r.memoizedState,m===null)return Nt(r),null;if(u=(r.flags&128)!==0,v=m.rendering,v===null)if(u)rc(m,!1);else{if(jt!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(v=xd(s),v!==null){for(r.flags|=128,rc(m,!1),s=v.updateQueue,r.updateQueue=s,Td(r,s),r.subtreeFlags=0,s=l,l=r.child;l!==null;)Ty(l,s),l=l.sibling;return ue(Ft,Ft.current&1|2),r.child}s=s.sibling}m.tail!==null&&Yn()>wd&&(r.flags|=128,u=!0,rc(m,!1),r.lanes=4194304)}else{if(!u)if(s=xd(v),s!==null){if(r.flags|=128,u=!0,s=s.updateQueue,r.updateQueue=s,Td(r,s),rc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!nt)return Nt(r),null}else 2*Yn()-m.renderingStartTime>wd&&l!==536870912&&(r.flags|=128,u=!0,rc(m,!1),r.lanes=4194304);m.isBackwards?(v.sibling=r.child,r.child=v):(s=m.last,s!==null?s.sibling=v:r.child=v,m.last=v)}return m.tail!==null?(r=m.tail,m.rendering=r,m.tail=r.sibling,m.renderingStartTime=Yn(),r.sibling=null,s=Ft.current,ue(Ft,u?s&1|2:s&1),r):(Nt(r),null);case 22:case 23:return xa(r),lm(),u=r.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(l&536870912)!==0&&(r.flags&128)===0&&(Nt(r),r.subtreeFlags&6&&(r.flags|=8192)):Nt(r),l=r.updateQueue,l!==null&&Td(r,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==l&&(r.flags|=2048),s!==null&&ce(vr),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),va(Ut),Nt(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function ww(s,r){switch(Qf(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return va(Ut),As(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return ea(r),null;case 13:if(xa(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));Bl()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return ce(Ft),null;case 4:return As(),null;case 10:return va(r.type),null;case 22:case 23:return xa(r),lm(),s!==null&&ce(vr),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return va(Ut),null;case 25:return null;default:return null}}function Wx(s,r){switch(Qf(r),r.tag){case 3:va(Ut),As();break;case 26:case 27:case 5:ea(r);break;case 4:As();break;case 13:xa(r);break;case 19:ce(Ft);break;case 10:va(r.type);break;case 22:case 23:xa(r),lm(),s!==null&&ce(vr);break;case 24:va(Ut)}}function oc(s,r){try{var l=r.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var m=u.next;l=m;do{if((l.tag&s)===s){u=void 0;var v=l.create,T=l.inst;u=v(),T.destroy=u}l=l.next}while(l!==m)}}catch(I){dt(r,r.return,I)}}function Za(s,r,l){try{var u=r.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var v=m.next;u=v;do{if((u.tag&s)===s){var T=u.inst,I=T.destroy;if(I!==void 0){T.destroy=void 0,m=r;var z=l,W=I;try{W()}catch(se){dt(m,z,se)}}}u=u.next}while(u!==v)}}catch(se){dt(r,r.return,se)}}function Zx(s){var r=s.updateQueue;if(r!==null){var l=s.stateNode;try{Uy(r,l)}catch(u){dt(s,s.return,u)}}}function Jx(s,r,l){l.props=xr(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){dt(s,r,u)}}function lc(s,r){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(m){dt(s,r,m)}}function Fs(s,r){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(m){dt(s,r,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){dt(s,r,m)}else l.current=null}function eb(s){var r=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(m){dt(s,s.return,m)}}function Pm(s,r,l){try{var u=s.stateNode;Qw(u,s.type,l,r),u[It]=r}catch(m){dt(s,s.return,m)}}function tb(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ri(s.type)||s.tag===4}function Lm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||tb(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ri(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vm(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(s),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Pd));else if(u!==4&&(u===27&&ri(s.type)&&(l=s.stateNode,r=null),s=s.child,s!==null))for(Vm(s,r,l),s=s.sibling;s!==null;)Vm(s,r,l),s=s.sibling}function jd(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?l.insertBefore(s,r):l.appendChild(s);else if(u!==4&&(u===27&&ri(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(jd(s,r,l),s=s.sibling;s!==null;)jd(s,r,l),s=s.sibling}function nb(s){var r=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,m=r.attributes;m.length;)r.removeAttributeNode(m[0]);nn(r,u,l),r[Pt]=s,r[It]=l}catch(v){dt(s,s.return,v)}}var _a=!1,Ct=!1,Um=!1,sb=typeof WeakSet=="function"?WeakSet:Set,Qt=null;function Cw(s,r){if(s=s.containerInfo,cp=Hd,s=my(s),Lf(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var m=u.anchorOffset,v=u.focusNode;u=u.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var T=0,I=-1,z=-1,W=0,se=0,re=s,Z=null;t:for(;;){for(var J;re!==l||m!==0&&re.nodeType!==3||(I=T+m),re!==v||u!==0&&re.nodeType!==3||(z=T+u),re.nodeType===3&&(T+=re.nodeValue.length),(J=re.firstChild)!==null;)Z=re,re=J;for(;;){if(re===s)break t;if(Z===l&&++W===m&&(I=T),Z===v&&++se===u&&(z=T),(J=re.nextSibling)!==null)break;re=Z,Z=re.parentNode}re=J}l=I===-1||z===-1?null:{start:I,end:z}}else l=null}l=l||{start:0,end:0}}else l=null;for(up={focusedElem:s,selectionRange:l},Hd=!1,Qt=r;Qt!==null;)if(r=Qt,s=r.child,(r.subtreeFlags&1024)!==0&&s!==null)s.return=r,Qt=s;else for(;Qt!==null;){switch(r=Qt,v=r.alternate,s=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,l=r,m=v.memoizedProps,v=v.memoizedState,u=l.stateNode;try{var Ce=xr(l.type,m,l.elementType===l.type);s=u.getSnapshotBeforeUpdate(Ce,v),u.__reactInternalSnapshotBeforeUpdate=s}catch(Te){dt(l,l.return,Te)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,l=s.nodeType,l===9)fp(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":fp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,Qt=s;break}Qt=r.return}}function ab(s,r,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Ja(s,l),u&4&&oc(5,l);break;case 1:if(Ja(s,l),u&4)if(s=l.stateNode,r===null)try{s.componentDidMount()}catch(T){dt(l,l.return,T)}else{var m=xr(l.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(m,r,s.__reactInternalSnapshotBeforeUpdate)}catch(T){dt(l,l.return,T)}}u&64&&Zx(l),u&512&&lc(l,l.return);break;case 3:if(Ja(s,l),u&64&&(s=l.updateQueue,s!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Uy(s,r)}catch(T){dt(l,l.return,T)}}break;case 27:r===null&&u&4&&nb(l);case 26:case 5:Ja(s,l),r===null&&u&4&&eb(l),u&512&&lc(l,l.return);break;case 12:Ja(s,l);break;case 13:Ja(s,l),u&4&&ob(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=Lw.bind(null,l),tC(s,l))));break;case 22:if(u=l.memoizedState!==null||_a,!u){r=r!==null&&r.memoizedState!==null||Ct,m=_a;var v=Ct;_a=u,(Ct=r)&&!v?ei(s,l,(l.subtreeFlags&8772)!==0):Ja(s,l),_a=m,Ct=v}break;case 30:break;default:Ja(s,l)}}function ib(s){var r=s.alternate;r!==null&&(s.alternate=null,ib(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&qa(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var bt=null,wn=!1;function Ea(s,r,l){for(l=l.child;l!==null;)rb(s,r,l),l=l.sibling}function rb(s,r,l){if(at&&typeof at.onCommitFiberUnmount=="function")try{at.onCommitFiberUnmount(Et,l)}catch{}switch(l.tag){case 26:Ct||Fs(l,r),Ea(s,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ct||Fs(l,r);var u=bt,m=wn;ri(l.type)&&(bt=l.stateNode,wn=!1),Ea(s,r,l),vc(l.stateNode),bt=u,wn=m;break;case 5:Ct||Fs(l,r);case 6:if(u=bt,m=wn,bt=null,Ea(s,r,l),bt=u,wn=m,bt!==null)if(wn)try{(bt.nodeType===9?bt.body:bt.nodeName==="HTML"?bt.ownerDocument.body:bt).removeChild(l.stateNode)}catch(v){dt(l,r,v)}else try{bt.removeChild(l.stateNode)}catch(v){dt(l,r,v)}break;case 18:bt!==null&&(wn?(s=bt,Qb(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),jc(s)):Qb(bt,l.stateNode));break;case 4:u=bt,m=wn,bt=l.stateNode.containerInfo,wn=!0,Ea(s,r,l),bt=u,wn=m;break;case 0:case 11:case 14:case 15:Ct||Za(2,l,r),Ct||Za(4,l,r),Ea(s,r,l);break;case 1:Ct||(Fs(l,r),u=l.stateNode,typeof u.componentWillUnmount=="function"&&Jx(l,r,u)),Ea(s,r,l);break;case 21:Ea(s,r,l);break;case 22:Ct=(u=Ct)||l.memoizedState!==null,Ea(s,r,l),Ct=u;break;default:Ea(s,r,l)}}function ob(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{jc(s)}catch(l){dt(r,r.return,l)}}function Sw(s){switch(s.tag){case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new sb),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new sb),r;default:throw Error(i(435,s.tag))}}function Fm(s,r){var l=Sw(s);r.forEach(function(u){var m=Vw.bind(null,s,u);l.has(u)||(l.add(u),u.then(m,m))})}function Ln(s,r){var l=r.deletions;if(l!==null)for(var u=0;u<l.length;u++){var m=l[u],v=s,T=r,I=T;e:for(;I!==null;){switch(I.tag){case 27:if(ri(I.type)){bt=I.stateNode,wn=!1;break e}break;case 5:bt=I.stateNode,wn=!1;break e;case 3:case 4:bt=I.stateNode.containerInfo,wn=!0;break e}I=I.return}if(bt===null)throw Error(i(160));rb(v,T,m),bt=null,wn=!1,v=m.alternate,v!==null&&(v.return=null),m.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)lb(r,s),r=r.sibling}var ps=null;function lb(s,r){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ln(r,s),Vn(s),u&4&&(Za(3,s,s.return),oc(3,s),Za(5,s,s.return));break;case 1:Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),u&64&&_a&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var m=ps;if(Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),u&4){var v=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":v=m.getElementsByTagName("title")[0],(!v||v[Qi]||v[Pt]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=m.createElement(u),m.head.insertBefore(v,m.querySelector("head > title"))),nn(v,u,l),v[Pt]=s,At(v),u=v;break e;case"link":var T=nN("link","href",m).get(u+(l.href||""));if(T){for(var I=0;I<T.length;I++)if(v=T[I],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){T.splice(I,1);break t}}v=m.createElement(u),nn(v,u,l),m.head.appendChild(v);break;case"meta":if(T=nN("meta","content",m).get(u+(l.content||""))){for(I=0;I<T.length;I++)if(v=T[I],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){T.splice(I,1);break t}}v=m.createElement(u),nn(v,u,l),m.head.appendChild(v);break;default:throw Error(i(468,u))}v[Pt]=s,At(v),u=v}s.stateNode=u}else sN(m,s.type,s.stateNode);else s.stateNode=tN(m,u,s.memoizedProps);else v!==u?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,u===null?sN(m,s.type,s.stateNode):tN(m,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Pm(s,s.memoizedProps,l.memoizedProps)}break;case 27:Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),l!==null&&u&4&&Pm(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),s.flags&32){m=s.stateNode;try{Kn(m,"")}catch(J){dt(s,s.return,J)}}u&4&&s.stateNode!=null&&(m=s.memoizedProps,Pm(s,m,l!==null?l.memoizedProps:m)),u&1024&&(Um=!0);break;case 6:if(Ln(r,s),Vn(s),u&4){if(s.stateNode===null)throw Error(i(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(J){dt(s,s.return,J)}}break;case 3:if(Fd=null,m=ps,ps=Vd(r.containerInfo),Ln(r,s),ps=m,Vn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{jc(r.containerInfo)}catch(J){dt(s,s.return,J)}Um&&(Um=!1,cb(s));break;case 4:u=ps,ps=Vd(s.stateNode.containerInfo),Ln(r,s),Vn(s),ps=u;break;case 12:Ln(r,s),Vn(s);break;case 13:Ln(r,s),Vn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&($m=Yn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Fm(s,u)));break;case 22:m=s.memoizedState!==null;var z=l!==null&&l.memoizedState!==null,W=_a,se=Ct;if(_a=W||m,Ct=se||z,Ln(r,s),Ct=se,_a=W,Vn(s),u&8192)e:for(r=s.stateNode,r._visibility=m?r._visibility&-2:r._visibility|1,m&&(l===null||z||_a||Ct||br(s)),l=null,r=s;;){if(r.tag===5||r.tag===26){if(l===null){z=l=r;try{if(v=z.stateNode,m)T=v.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{I=z.stateNode;var re=z.memoizedProps.style,Z=re!=null&&re.hasOwnProperty("display")?re.display:null;I.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(J){dt(z,z.return,J)}}}else if(r.tag===6){if(l===null){z=r;try{z.stateNode.nodeValue=m?"":z.memoizedProps}catch(J){dt(z,z.return,J)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Fm(s,l))));break;case 19:Ln(r,s),Vn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Fm(s,u)));break;case 30:break;case 21:break;default:Ln(r,s),Vn(s)}}function Vn(s){var r=s.flags;if(r&2){try{for(var l,u=s.return;u!==null;){if(tb(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var m=l.stateNode,v=Lm(s);jd(s,v,m);break;case 5:var T=l.stateNode;l.flags&32&&(Kn(T,""),l.flags&=-33);var I=Lm(s);jd(s,I,T);break;case 3:case 4:var z=l.stateNode.containerInfo,W=Lm(s);Vm(s,W,z);break;default:throw Error(i(161))}}catch(se){dt(s,s.return,se)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function cb(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;cb(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function Ja(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)ab(s,r.alternate,r),r=r.sibling}function br(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:Za(4,r,r.return),br(r);break;case 1:Fs(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&Jx(r,r.return,l),br(r);break;case 27:vc(r.stateNode);case 26:case 5:Fs(r,r.return),br(r);break;case 22:r.memoizedState===null&&br(r);break;case 30:br(r);break;default:br(r)}s=s.sibling}}function ei(s,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,m=s,v=r,T=v.flags;switch(v.tag){case 0:case 11:case 15:ei(m,v,l),oc(4,v);break;case 1:if(ei(m,v,l),u=v,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(W){dt(u,u.return,W)}if(u=v,m=u.updateQueue,m!==null){var I=u.stateNode;try{var z=m.shared.hiddenCallbacks;if(z!==null)for(m.shared.hiddenCallbacks=null,m=0;m<z.length;m++)Vy(z[m],I)}catch(W){dt(u,u.return,W)}}l&&T&64&&Zx(v),lc(v,v.return);break;case 27:nb(v);case 26:case 5:ei(m,v,l),l&&u===null&&T&4&&eb(v),lc(v,v.return);break;case 12:ei(m,v,l);break;case 13:ei(m,v,l),l&&T&4&&ob(m,v);break;case 22:v.memoizedState===null&&ei(m,v,l),lc(v,v.return);break;case 30:break;default:ei(m,v,l)}r=r.sibling}}function qm(s,r){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Yl(l))}function zm(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Yl(s))}function qs(s,r,l,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)ub(s,r,l,u),r=r.sibling}function ub(s,r,l,u){var m=r.flags;switch(r.tag){case 0:case 11:case 15:qs(s,r,l,u),m&2048&&oc(9,r);break;case 1:qs(s,r,l,u);break;case 3:qs(s,r,l,u),m&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Yl(s)));break;case 12:if(m&2048){qs(s,r,l,u),s=r.stateNode;try{var v=r.memoizedProps,T=v.id,I=v.onPostCommit;typeof I=="function"&&I(T,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(z){dt(r,r.return,z)}}else qs(s,r,l,u);break;case 13:qs(s,r,l,u);break;case 23:break;case 22:v=r.stateNode,T=r.alternate,r.memoizedState!==null?v._visibility&2?qs(s,r,l,u):cc(s,r):v._visibility&2?qs(s,r,l,u):(v._visibility|=2,Eo(s,r,l,u,(r.subtreeFlags&10256)!==0)),m&2048&&qm(T,r);break;case 24:qs(s,r,l,u),m&2048&&zm(r.alternate,r);break;default:qs(s,r,l,u)}}function Eo(s,r,l,u,m){for(m=m&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var v=s,T=r,I=l,z=u,W=T.flags;switch(T.tag){case 0:case 11:case 15:Eo(v,T,I,z,m),oc(8,T);break;case 23:break;case 22:var se=T.stateNode;T.memoizedState!==null?se._visibility&2?Eo(v,T,I,z,m):cc(v,T):(se._visibility|=2,Eo(v,T,I,z,m)),m&&W&2048&&qm(T.alternate,T);break;case 24:Eo(v,T,I,z,m),m&&W&2048&&zm(T.alternate,T);break;default:Eo(v,T,I,z,m)}r=r.sibling}}function cc(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=s,u=r,m=u.flags;switch(u.tag){case 22:cc(l,u),m&2048&&qm(u.alternate,u);break;case 24:cc(l,u),m&2048&&zm(u.alternate,u);break;default:cc(l,u)}r=r.sibling}}var uc=8192;function To(s){if(s.subtreeFlags&uc)for(s=s.child;s!==null;)db(s),s=s.sibling}function db(s){switch(s.tag){case 26:To(s),s.flags&uc&&s.memoizedState!==null&&mC(ps,s.memoizedState,s.memoizedProps);break;case 5:To(s);break;case 3:case 4:var r=ps;ps=Vd(s.stateNode.containerInfo),To(s),ps=r;break;case 22:s.memoizedState===null&&(r=s.alternate,r!==null&&r.memoizedState!==null?(r=uc,uc=16777216,To(s),uc=r):To(s));break;default:To(s)}}function hb(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function dc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Qt=u,mb(u,s)}hb(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)fb(s),s=s.sibling}function fb(s){switch(s.tag){case 0:case 11:case 15:dc(s),s.flags&2048&&Za(9,s,s.return);break;case 3:dc(s);break;case 12:dc(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Ad(s)):dc(s);break;default:dc(s)}}function Ad(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Qt=u,mb(u,s)}hb(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:Za(8,r,r.return),Ad(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,Ad(r));break;default:Ad(r)}s=s.sibling}}function mb(s,r){for(;Qt!==null;){var l=Qt;switch(l.tag){case 0:case 11:case 15:Za(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Yl(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Qt=u;else e:for(l=s;Qt!==null;){u=Qt;var m=u.sibling,v=u.return;if(ib(u),u===l){Qt=null;break e}if(m!==null){m.return=v,Qt=m;break e}Qt=v}}}var Iw={getCacheForType:function(s){var r=un(Ut),l=r.data.get(s);return l===void 0&&(l=s(),r.data.set(s,l)),l}},Rw=typeof WeakMap=="function"?WeakMap:Map,it=0,gt=null,Be=null,We=0,rt=0,Un=null,ti=!1,jo=!1,Hm=!1,Ta=0,jt=0,ni=0,Nr=0,Bm=0,as=0,Ao=0,hc=null,Cn=null,Gm=!1,$m=0,wd=1/0,Cd=null,si=null,tn=0,ai=null,wo=null,Co=0,Ym=0,Qm=null,pb=null,fc=0,Km=null;function Fn(){if((it&2)!==0&&We!==0)return We&-We;if(Y.T!==null){var s=po;return s!==0?s:np()}return Ua()}function gb(){as===0&&(as=(We&536870912)===0||nt?_l():536870912);var s=ss.current;return s!==null&&(s.flags|=32),as}function qn(s,r,l){(s===gt&&(rt===2||rt===9)||s.cancelPendingCommit!==null)&&(So(s,0),ii(s,We,as,!1)),na(s,l),((it&2)===0||s!==gt)&&(s===gt&&((it&2)===0&&(Nr|=l),jt===4&&ii(s,We,as,!1)),zs(s))}function vb(s,r,l){if((it&6)!==0)throw Error(i(327));var u=!l&&(r&124)===0&&(r&s.expiredLanes)===0||Yi(s,r),m=u?Ow(s,r):Zm(s,r,!0),v=u;do{if(m===0){jo&&!u&&ii(s,r,0,!1);break}else{if(l=s.current.alternate,v&&!Dw(l)){m=Zm(s,r,!1),v=!1;continue}if(m===2){if(v=r,s.errorRecoveryDisabledLanes&v)var T=0;else T=s.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){r=T;e:{var I=s;m=hc;var z=I.current.memoizedState.isDehydrated;if(z&&(So(I,T).flags|=256),T=Zm(I,T,!1),T!==2){if(Hm&&!z){I.errorRecoveryDisabledLanes|=v,Nr|=v,m=4;break e}v=Cn,Cn=m,v!==null&&(Cn===null?Cn=v:Cn.push.apply(Cn,v))}m=T}if(v=!1,m!==2)continue}}if(m===1){So(s,0),ii(s,r,0,!0);break}e:{switch(u=s,v=m,v){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:ii(u,r,as,!ti);break e;case 2:Cn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(m=$m+300-Yn(),10<m)){if(ii(u,r,as,!ti),Gr(u,0,!0)!==0)break e;u.timeoutHandle=$b(yb.bind(null,u,l,Cn,Cd,Gm,r,as,Nr,Ao,ti,v,2,-0,0),m);break e}yb(u,l,Cn,Cd,Gm,r,as,Nr,Ao,ti,v,0,-0,0)}}break}while(!0);zs(s)}function yb(s,r,l,u,m,v,T,I,z,W,se,re,Z,J){if(s.timeoutHandle=-1,re=r.subtreeFlags,(re&8192||(re&16785408)===16785408)&&(bc={stylesheets:null,count:0,unsuspend:fC},db(r),re=pC(),re!==null)){s.cancelPendingCommit=re(jb.bind(null,s,r,v,l,u,m,T,I,z,se,1,Z,J)),ii(s,v,T,!W);return}jb(s,r,v,l,u,m,T,I,z)}function Dw(s){for(var r=s;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var m=l[u],v=m.getSnapshot;m=m.value;try{if(!kn(v(),m))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function ii(s,r,l,u){r&=~Bm,r&=~Nr,s.suspendedLanes|=r,s.pingedLanes&=~r,u&&(s.warmLanes|=r),u=s.expirationTimes;for(var m=r;0<m;){var v=31-cn(m),T=1<<v;u[v]=-1,m&=~T}l!==0&&ws(s,l,r)}function Sd(){return(it&6)===0?(mc(0),!1):!0}function Xm(){if(Be!==null){if(rt===0)var s=Be.return;else s=Be,ga=pr=null,fm(s),No=null,ac=0,s=Be;for(;s!==null;)Wx(s.alternate,s),s=s.return;Be=null}}function So(s,r){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,Xw(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Xm(),gt=s,Be=l=fa(s.current,null),We=r,rt=0,Un=null,ti=!1,jo=Yi(s,r),Hm=!1,Ao=as=Bm=Nr=ni=jt=0,Cn=hc=null,Gm=!1,(r&8)!==0&&(r|=r&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=r;0<u;){var m=31-cn(u),v=1<<m;r|=s[m],u&=~v}return Ta=r,Wu(),l}function xb(s,r){Fe=null,Y.H=gd,r===Kl||r===rd?(r=Py(),rt=3):r===My?(r=Py(),rt=4):rt=r===Lx?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Un=r,Be===null&&(jt=1,Nd(s,Jn(r,s.current)))}function bb(){var s=Y.H;return Y.H=gd,s===null?gd:s}function Nb(){var s=Y.A;return Y.A=Iw,s}function Wm(){jt=4,ti||(We&4194048)!==We&&ss.current!==null||(jo=!0),(ni&134217727)===0&&(Nr&134217727)===0||gt===null||ii(gt,We,as,!1)}function Zm(s,r,l){var u=it;it|=2;var m=bb(),v=Nb();(gt!==s||We!==r)&&(Cd=null,So(s,r)),r=!1;var T=jt;e:do try{if(rt!==0&&Be!==null){var I=Be,z=Un;switch(rt){case 8:Xm(),T=6;break e;case 3:case 2:case 9:case 6:ss.current===null&&(r=!0);var W=rt;if(rt=0,Un=null,Io(s,I,z,W),l&&jo){T=0;break e}break;default:W=rt,rt=0,Un=null,Io(s,I,z,W)}}Mw(),T=jt;break}catch(se){xb(s,se)}while(!0);return r&&s.shellSuspendCounter++,ga=pr=null,it=u,Y.H=m,Y.A=v,Be===null&&(gt=null,We=0,Wu()),T}function Mw(){for(;Be!==null;)_b(Be)}function Ow(s,r){var l=it;it|=2;var u=bb(),m=Nb();gt!==s||We!==r?(Cd=null,wd=Yn()+500,So(s,r)):jo=Yi(s,r);e:do try{if(rt!==0&&Be!==null){r=Be;var v=Un;t:switch(rt){case 1:rt=0,Un=null,Io(s,r,v,1);break;case 2:case 9:if(Oy(v)){rt=0,Un=null,Eb(r);break}r=function(){rt!==2&&rt!==9||gt!==s||(rt=7),zs(s)},v.then(r,r);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:Oy(v)?(rt=0,Un=null,Eb(r)):(rt=0,Un=null,Io(s,r,v,7));break;case 5:var T=null;switch(Be.tag){case 26:T=Be.memoizedState;case 5:case 27:var I=Be;if(!T||aN(T)){rt=0,Un=null;var z=I.sibling;if(z!==null)Be=z;else{var W=I.return;W!==null?(Be=W,Id(W)):Be=null}break t}}rt=0,Un=null,Io(s,r,v,5);break;case 6:rt=0,Un=null,Io(s,r,v,6);break;case 8:Xm(),jt=6;break e;default:throw Error(i(462))}}kw();break}catch(se){xb(s,se)}while(!0);return ga=pr=null,Y.H=u,Y.A=m,it=l,Be!==null?0:(gt=null,We=0,Wu(),jt)}function kw(){for(;Be!==null&&!yl();)_b(Be)}function _b(s){var r=Kx(s.alternate,s,Ta);s.memoizedProps=s.pendingProps,r===null?Id(s):Be=r}function Eb(s){var r=s,l=r.alternate;switch(r.tag){case 15:case 0:r=Hx(l,r,r.pendingProps,r.type,void 0,We);break;case 11:r=Hx(l,r,r.pendingProps,r.type.render,r.ref,We);break;case 5:fm(r);default:Wx(l,r),r=Be=Ty(r,Ta),r=Kx(l,r,Ta)}s.memoizedProps=s.pendingProps,r===null?Id(s):Be=r}function Io(s,r,l,u){ga=pr=null,fm(r),No=null,ac=0;var m=r.return;try{if(Tw(s,m,r,l,We)){jt=1,Nd(s,Jn(l,s.current)),Be=null;return}}catch(v){if(m!==null)throw Be=m,v;jt=1,Nd(s,Jn(l,s.current)),Be=null;return}r.flags&32768?(nt||u===1?s=!0:jo||(We&536870912)!==0?s=!1:(ti=s=!0,(u===2||u===9||u===3||u===6)&&(u=ss.current,u!==null&&u.tag===13&&(u.flags|=16384))),Tb(r,s)):Id(r)}function Id(s){var r=s;do{if((r.flags&32768)!==0){Tb(r,ti);return}s=r.return;var l=Aw(r.alternate,r,Ta);if(l!==null){Be=l;return}if(r=r.sibling,r!==null){Be=r;return}Be=r=s}while(r!==null);jt===0&&(jt=5)}function Tb(s,r){do{var l=ww(s.alternate,s);if(l!==null){l.flags&=32767,Be=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(s=s.sibling,s!==null)){Be=s;return}Be=s=l}while(s!==null);jt=6,Be=null}function jb(s,r,l,u,m,v,T,I,z){s.cancelPendingCommit=null;do Rd();while(tn!==0);if((it&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(v=r.lanes|r.childLanes,v|=zf,Tl(s,l,v,T,I,z),s===gt&&(Be=gt=null,We=0),wo=r,ai=s,Co=l,Ym=v,Qm=m,pb=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Uw(Hi,function(){return Ib(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=Y.T,Y.T=null,m=te.p,te.p=2,T=it,it|=4;try{Cw(s,r,l)}finally{it=T,te.p=m,Y.T=u}}tn=1,Ab(),wb(),Cb()}}function Ab(){if(tn===1){tn=0;var s=ai,r=wo,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=Y.T,Y.T=null;var u=te.p;te.p=2;var m=it;it|=4;try{lb(r,s);var v=up,T=my(s.containerInfo),I=v.focusedElem,z=v.selectionRange;if(T!==I&&I&&I.ownerDocument&&fy(I.ownerDocument.documentElement,I)){if(z!==null&&Lf(I)){var W=z.start,se=z.end;if(se===void 0&&(se=W),"selectionStart"in I)I.selectionStart=W,I.selectionEnd=Math.min(se,I.value.length);else{var re=I.ownerDocument||document,Z=re&&re.defaultView||window;if(Z.getSelection){var J=Z.getSelection(),Ce=I.textContent.length,Te=Math.min(z.start,Ce),ut=z.end===void 0?Te:Math.min(z.end,Ce);!J.extend&&Te>ut&&(T=ut,ut=Te,Te=T);var Q=hy(I,Te),B=hy(I,ut);if(Q&&B&&(J.rangeCount!==1||J.anchorNode!==Q.node||J.anchorOffset!==Q.offset||J.focusNode!==B.node||J.focusOffset!==B.offset)){var X=re.createRange();X.setStart(Q.node,Q.offset),J.removeAllRanges(),Te>ut?(J.addRange(X),J.extend(B.node,B.offset)):(X.setEnd(B.node,B.offset),J.addRange(X))}}}}for(re=[],J=I;J=J.parentNode;)J.nodeType===1&&re.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<re.length;I++){var ae=re[I];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}Hd=!!cp,up=cp=null}finally{it=m,te.p=u,Y.T=l}}s.current=r,tn=2}}function wb(){if(tn===2){tn=0;var s=ai,r=wo,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=Y.T,Y.T=null;var u=te.p;te.p=2;var m=it;it|=4;try{ab(s,r.alternate,r)}finally{it=m,te.p=u,Y.T=l}}tn=3}}function Cb(){if(tn===4||tn===3){tn=0,Au();var s=ai,r=wo,l=Co,u=pb;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?tn=5:(tn=0,wo=ai=null,Sb(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(si=null),$r(l),r=r.stateNode,at&&typeof at.onCommitFiberRoot=="function")try{at.onCommitFiberRoot(Et,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=Y.T,m=te.p,te.p=2,Y.T=null;try{for(var v=s.onRecoverableError,T=0;T<u.length;T++){var I=u[T];v(I.value,{componentStack:I.stack})}}finally{Y.T=r,te.p=m}}(Co&3)!==0&&Rd(),zs(s),m=s.pendingLanes,(l&4194090)!==0&&(m&42)!==0?s===Km?fc++:(fc=0,Km=s):fc=0,mc(0)}}function Sb(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Yl(r)))}function Rd(s){return Ab(),wb(),Cb(),Ib()}function Ib(){if(tn!==5)return!1;var s=ai,r=Ym;Ym=0;var l=$r(Co),u=Y.T,m=te.p;try{te.p=32>l?32:l,Y.T=null,l=Qm,Qm=null;var v=ai,T=Co;if(tn=0,wo=ai=null,Co=0,(it&6)!==0)throw Error(i(331));var I=it;if(it|=4,fb(v.current),ub(v,v.current,T,l),it=I,mc(0,!1),at&&typeof at.onPostCommitFiberRoot=="function")try{at.onPostCommitFiberRoot(Et,v)}catch{}return!0}finally{te.p=m,Y.T=u,Sb(s,r)}}function Rb(s,r,l){r=Jn(l,r),r=wm(s.stateNode,r,2),s=Qa(s,r,2),s!==null&&(na(s,2),zs(s))}function dt(s,r,l){if(s.tag===3)Rb(s,s,l);else for(;r!==null;){if(r.tag===3){Rb(r,s,l);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(si===null||!si.has(u))){s=Jn(l,s),l=kx(2),u=Qa(r,l,2),u!==null&&(Px(l,u,r,s),na(u,2),zs(u));break}}r=r.return}}function Jm(s,r,l){var u=s.pingCache;if(u===null){u=s.pingCache=new Rw;var m=new Set;u.set(r,m)}else m=u.get(r),m===void 0&&(m=new Set,u.set(r,m));m.has(l)||(Hm=!0,m.add(l),s=Pw.bind(null,s,r,l),r.then(s,s))}function Pw(s,r,l){var u=s.pingCache;u!==null&&u.delete(r),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,gt===s&&(We&l)===l&&(jt===4||jt===3&&(We&62914560)===We&&300>Yn()-$m?(it&2)===0&&So(s,0):Bm|=l,Ao===We&&(Ao=0)),zs(s)}function Db(s,r){r===0&&(r=El()),s=uo(s,r),s!==null&&(na(s,r),zs(s))}function Lw(s){var r=s.memoizedState,l=0;r!==null&&(l=r.retryLane),Db(s,l)}function Vw(s,r){var l=0;switch(s.tag){case 13:var u=s.stateNode,m=s.memoizedState;m!==null&&(l=m.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),Db(s,l)}function Uw(s,r){return qi(s,r)}var Dd=null,Ro=null,ep=!1,Md=!1,tp=!1,_r=0;function zs(s){s!==Ro&&s.next===null&&(Ro===null?Dd=Ro=s:Ro=Ro.next=s),Md=!0,ep||(ep=!0,qw())}function mc(s,r){if(!tp&&Md){tp=!0;do for(var l=!1,u=Dd;u!==null;){if(s!==0){var m=u.pendingLanes;if(m===0)var v=0;else{var T=u.suspendedLanes,I=u.pingedLanes;v=(1<<31-cn(42|s)+1)-1,v&=m&~(T&~I),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,Pb(u,v))}else v=We,v=Gr(u,u===gt?v:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(v&3)===0||Yi(u,v)||(l=!0,Pb(u,v));u=u.next}while(l);tp=!1}}function Fw(){Mb()}function Mb(){Md=ep=!1;var s=0;_r!==0&&(Kw()&&(s=_r),_r=0);for(var r=Yn(),l=null,u=Dd;u!==null;){var m=u.next,v=Ob(u,r);v===0?(u.next=null,l===null?Dd=m:l.next=m,m===null&&(Ro=l)):(l=u,(s!==0||(v&3)!==0)&&(Md=!0)),u=m}mc(s)}function Ob(s,r){for(var l=s.suspendedLanes,u=s.pingedLanes,m=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var T=31-cn(v),I=1<<T,z=m[T];z===-1?((I&l)===0||(I&u)!==0)&&(m[T]=Nl(I,r)):z<=r&&(s.expiredLanes|=I),v&=~I}if(r=gt,l=We,l=Gr(s,s===r?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===r&&(rt===2||rt===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&zi(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Yi(s,l)){if(r=l&-l,r===s.callbackPriority)return r;switch(u!==null&&zi(u),$r(l)){case 2:case 8:l=Hr;break;case 32:l=Hi;break;case 268435456:l=Br;break;default:l=Hi}return u=kb.bind(null,s),l=qi(l,u),s.callbackPriority=r,s.callbackNode=l,r}return u!==null&&u!==null&&zi(u),s.callbackPriority=2,s.callbackNode=null,2}function kb(s,r){if(tn!==0&&tn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Rd()&&s.callbackNode!==l)return null;var u=We;return u=Gr(s,s===gt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(vb(s,u,r),Ob(s,Yn()),s.callbackNode!=null&&s.callbackNode===l?kb.bind(null,s):null)}function Pb(s,r){if(Rd())return null;vb(s,r,!0)}function qw(){Ww(function(){(it&6)!==0?qi(xl,Fw):Mb()})}function np(){return _r===0&&(_r=_l()),_r}function Lb(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Zr(""+s)}function Vb(s,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,s.id&&l.setAttribute("form",s.id),r.parentNode.insertBefore(l,r),s=new FormData(s),l.parentNode.removeChild(l),s}function zw(s,r,l,u,m){if(r==="submit"&&l&&l.stateNode===m){var v=Lb((m[It]||null).action),T=u.submitter;T&&(r=(r=T[It]||null)?Lb(r.formAction):T.getAttribute("formAction"),r!==null&&(v=r,T=null));var I=new Jr("action","action",null,u,m);s.push({event:I,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(_r!==0){var z=T?Vb(m,T):new FormData(m);_m(l,{pending:!0,data:z,method:m.method,action:v},null,z)}}else typeof v=="function"&&(I.preventDefault(),z=T?Vb(m,T):new FormData(m),_m(l,{pending:!0,data:z,method:m.method,action:v},v,z))},currentTarget:m}]})}}for(var sp=0;sp<qf.length;sp++){var ap=qf[sp],Hw=ap.toLowerCase(),Bw=ap[0].toUpperCase()+ap.slice(1);ms(Hw,"on"+Bw)}ms(vy,"onAnimationEnd"),ms(yy,"onAnimationIteration"),ms(xy,"onAnimationStart"),ms("dblclick","onDoubleClick"),ms("focusin","onFocus"),ms("focusout","onBlur"),ms(ow,"onTransitionRun"),ms(lw,"onTransitionStart"),ms(cw,"onTransitionCancel"),ms(by,"onTransitionEnd"),aa("onMouseEnter",["mouseout","mouseover"]),aa("onMouseLeave",["mouseout","mouseover"]),aa("onPointerEnter",["pointerout","pointerover"]),aa("onPointerLeave",["pointerout","pointerover"]),hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),hs("onBeforeInput",["compositionend","keypress","textInput","paste"]),hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(pc));function Ub(s,r){r=(r&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],m=u.event;u=u.listeners;e:{var v=void 0;if(r)for(var T=u.length-1;0<=T;T--){var I=u[T],z=I.instance,W=I.currentTarget;if(I=I.listener,z!==v&&m.isPropagationStopped())break e;v=I,m.currentTarget=W;try{v(m)}catch(se){bd(se)}m.currentTarget=null,v=z}else for(T=0;T<u.length;T++){if(I=u[T],z=I.instance,W=I.currentTarget,I=I.listener,z!==v&&m.isPropagationStopped())break e;v=I,m.currentTarget=W;try{v(m)}catch(se){bd(se)}m.currentTarget=null,v=z}}}}function Ge(s,r){var l=r[Al];l===void 0&&(l=r[Al]=new Set);var u=s+"__bubble";l.has(u)||(Fb(r,s,2,!1),l.add(u))}function ip(s,r,l){var u=0;r&&(u|=4),Fb(l,s,u,r)}var Od="_reactListening"+Math.random().toString(36).slice(2);function rp(s){if(!s[Od]){s[Od]=!0,wl.forEach(function(l){l!=="selectionchange"&&(Gw.has(l)||ip(l,!1,s),ip(l,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Od]||(r[Od]=!0,ip("selectionchange",!1,r))}}function Fb(s,r,l,u){switch(uN(r)){case 2:var m=yC;break;case 8:m=xC;break;default:m=bp}l=m.bind(null,r,l,s),m=void 0,!Wn||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),u?m!==void 0?s.addEventListener(r,l,{capture:!0,passive:m}):s.addEventListener(r,l,!0):m!==void 0?s.addEventListener(r,l,{passive:m}):s.addEventListener(r,l,!1)}function op(s,r,l,u,m){var v=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var T=u.tag;if(T===3||T===4){var I=u.stateNode.containerInfo;if(I===m)break;if(T===4)for(T=u.return;T!==null;){var z=T.tag;if((z===3||z===4)&&T.stateNode.containerInfo===m)return;T=T.return}for(;I!==null;){if(T=sa(I),T===null)return;if(z=T.tag,z===5||z===6||z===26||z===27){u=v=T;continue e}I=I.parentNode}}u=u.return}Pu(function(){var W=v,se=Xn(l),re=[];e:{var Z=Ny.get(s);if(Z!==void 0){var J=Jr,Ce=s;switch(s){case"keypress":if(Ms(l)===0)break e;case"keydown":case"keyup":J=io;break;case"focusin":Ce="focus",J=no;break;case"focusout":Ce="blur",J=no;break;case"beforeblur":case"afterblur":J=no;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=Zn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=Mf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=Bu;break;case vy:case yy:case xy:J=so;break;case by:J=$u;break;case"scroll":case"scrollend":J=Lu;break;case"wheel":J=ro;break;case"copy":case"cut":case"paste":J=ao;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=Ul;break;case"toggle":case"beforetoggle":J=Qu}var Te=(r&4)!==0,ut=!Te&&(s==="scroll"||s==="scrollend"),Q=Te?Z!==null?Z+"Capture":null:Z;Te=[];for(var B=W,X;B!==null;){var ae=B;if(X=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||X===null||Q===null||(ae=tr(B,Q),ae!=null&&Te.push(gc(B,ae,X))),ut)break;B=B.return}0<Te.length&&(Z=new J(Z,Ce,null,l,se),re.push({event:Z,listeners:Te}))}}if((r&7)===0){e:{if(Z=s==="mouseover"||s==="pointerover",J=s==="mouseout"||s==="pointerout",Z&&l!==oa&&(Ce=l.relatedTarget||l.fromElement)&&(sa(Ce)||Ce[Qn]))break e;if((J||Z)&&(Z=se.window===se?se:(Z=se.ownerDocument)?Z.defaultView||Z.parentWindow:window,J?(Ce=l.relatedTarget||l.toElement,J=W,Ce=Ce?sa(Ce):null,Ce!==null&&(ut=c(Ce),Te=Ce.tag,Ce!==ut||Te!==5&&Te!==27&&Te!==6)&&(Ce=null)):(J=null,Ce=W),J!==Ce)){if(Te=Zn,ae="onMouseLeave",Q="onMouseEnter",B="mouse",(s==="pointerout"||s==="pointerover")&&(Te=Ul,ae="onPointerLeave",Q="onPointerEnter",B="pointer"),ut=J==null?Z:Ss(J),X=Ce==null?Z:Ss(Ce),Z=new Te(ae,B+"leave",J,l,se),Z.target=ut,Z.relatedTarget=X,ae=null,sa(se)===W&&(Te=new Te(Q,B+"enter",Ce,l,se),Te.target=X,Te.relatedTarget=ut,ae=Te),ut=ae,J&&Ce)t:{for(Te=J,Q=Ce,B=0,X=Te;X;X=Do(X))B++;for(X=0,ae=Q;ae;ae=Do(ae))X++;for(;0<B-X;)Te=Do(Te),B--;for(;0<X-B;)Q=Do(Q),X--;for(;B--;){if(Te===Q||Q!==null&&Te===Q.alternate)break t;Te=Do(Te),Q=Do(Q)}Te=null}else Te=null;J!==null&&qb(re,Z,J,Te,!1),Ce!==null&&ut!==null&&qb(re,ut,Ce,Te,!0)}}e:{if(Z=W?Ss(W):window,J=Z.nodeName&&Z.nodeName.toLowerCase(),J==="select"||J==="input"&&Z.type==="file")var ve=ry;else if(Vt(Z))if(oy)ve=aw;else{ve=nw;var He=tw}else J=Z.nodeName,!J||J.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?W&&Dl(W.elementType)&&(ve=ry):ve=sw;if(ve&&(ve=ve(s,W))){ha(re,ve,l,se);break e}He&&He(s,Z,W),s==="focusout"&&W&&Z.type==="number"&&W.memoizedProps.value!=null&&Ha(Z,"number",Z.value)}switch(He=W?Ss(W):window,s){case"focusin":(Vt(He)||He.contentEditable==="true")&&(oo=He,Vf=W,zl=null);break;case"focusout":zl=Vf=oo=null;break;case"mousedown":Uf=!0;break;case"contextmenu":case"mouseup":case"dragend":Uf=!1,py(re,l,se);break;case"selectionchange":if(rw)break;case"keydown":case"keyup":py(re,l,se)}var xe;if(Ps)e:{switch(s){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Ke?ne(s,l)&&(je="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(je="onCompositionStart");je&&(_&&l.locale!=="ko"&&(Ke||je!=="onCompositionStart"?je==="onCompositionEnd"&&Ke&&(xe=Ol()):(Ds=se,Ba="value"in Ds?Ds.value:Ds.textContent,Ke=!0)),He=kd(W,je),0<He.length&&(je=new Ll(je,s,null,l,se),re.push({event:je,listeners:He}),xe?je.data=xe:(xe=de(l),xe!==null&&(je.data=xe)))),(xe=x?Lt(s,l):Xe(s,l))&&(je=kd(W,"onBeforeInput"),0<je.length&&(He=new Ll("onBeforeInput","beforeinput",null,l,se),re.push({event:He,listeners:je}),He.data=xe)),zw(re,s,W,l,se)}Ub(re,r)})}function gc(s,r,l){return{instance:s,listener:r,currentTarget:l}}function kd(s,r){for(var l=r+"Capture",u=[];s!==null;){var m=s,v=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||v===null||(m=tr(s,l),m!=null&&u.unshift(gc(s,m,v)),m=tr(s,r),m!=null&&u.push(gc(s,m,v))),s.tag===3)return u;s=s.return}return[]}function Do(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function qb(s,r,l,u,m){for(var v=r._reactName,T=[];l!==null&&l!==u;){var I=l,z=I.alternate,W=I.stateNode;if(I=I.tag,z!==null&&z===u)break;I!==5&&I!==26&&I!==27||W===null||(z=W,m?(W=tr(l,v),W!=null&&T.unshift(gc(l,W,z))):m||(W=tr(l,v),W!=null&&T.push(gc(l,W,z)))),l=l.return}T.length!==0&&s.push({event:r,listeners:T})}var $w=/\r\n?/g,Yw=/\u0000|\uFFFD/g;function zb(s){return(typeof s=="string"?s:""+s).replace($w,`
`).replace(Yw,"")}function Hb(s,r){return r=zb(r),zb(s)===r}function Pd(){}function ct(s,r,l,u,m,v){switch(l){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||Kn(s,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&Kn(s,""+u);break;case"className":Is(s,"class",u);break;case"tabIndex":Is(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Is(s,l,u);break;case"style":Rl(s,u,v);break;case"data":if(r!=="object"){Is(s,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Zr(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(r!=="input"&&ct(s,r,"name",m.name,m,null),ct(s,r,"formEncType",m.formEncType,m,null),ct(s,r,"formMethod",m.formMethod,m,null),ct(s,r,"formTarget",m.formTarget,m,null)):(ct(s,r,"encType",m.encType,m,null),ct(s,r,"method",m.method,m,null),ct(s,r,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Zr(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=Pd);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Zr(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":Ge("beforetoggle",s),Ge("toggle",s),za(s,"popover",u);break;case"xlinkActuate":Zt(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Zt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Zt(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Zt(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Zt(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Zt(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":za(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Rf.get(l)||l,za(s,l,u))}}function lp(s,r,l,u,m,v){switch(l){case"style":Rl(s,u,v);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof u=="string"?Kn(s,u):(typeof u=="number"||typeof u=="bigint")&&Kn(s,""+u);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"onClick":u!=null&&(s.onclick=Pd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yr.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),r=l.slice(2,m?l.length-7:void 0),v=s[It]||null,v=v!=null?v[l]:null,typeof v=="function"&&s.removeEventListener(r,v,m),typeof u=="function")){typeof v!="function"&&v!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(r,u,m);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):za(s,l,u)}}}function nn(s,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",s),Ge("load",s);var u=!1,m=!1,v;for(v in l)if(l.hasOwnProperty(v)){var T=l[v];if(T!=null)switch(v){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:ct(s,r,v,T,l,null)}}m&&ct(s,r,"srcSet",l.srcSet,l,null),u&&ct(s,r,"src",l.src,l,null);return;case"input":Ge("invalid",s);var I=v=T=m=null,z=null,W=null;for(u in l)if(l.hasOwnProperty(u)){var se=l[u];if(se!=null)switch(u){case"name":m=se;break;case"type":T=se;break;case"checked":z=se;break;case"defaultChecked":W=se;break;case"value":v=se;break;case"defaultValue":I=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,r));break;default:ct(s,r,u,se,l,null)}}Zi(s,v,I,z,W,T,m,!1),Wr(s);return;case"select":Ge("invalid",s),u=T=v=null;for(m in l)if(l.hasOwnProperty(m)&&(I=l[m],I!=null))switch(m){case"value":v=I;break;case"defaultValue":T=I;break;case"multiple":u=I;default:ct(s,r,m,I,l,null)}r=v,l=T,s.multiple=!!u,r!=null?ra(s,!!u,r,!1):l!=null&&ra(s,!!u,l,!0);return;case"textarea":Ge("invalid",s),v=m=u=null;for(T in l)if(l.hasOwnProperty(T)&&(I=l[T],I!=null))switch(T){case"value":u=I;break;case"defaultValue":m=I;break;case"children":v=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(91));break;default:ct(s,r,T,I,l,null)}Ji(s,u,m,v),Wr(s);return;case"option":for(z in l)if(l.hasOwnProperty(z)&&(u=l[z],u!=null))switch(z){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:ct(s,r,z,u,l,null)}return;case"dialog":Ge("beforetoggle",s),Ge("toggle",s),Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":Ge("load",s);break;case"video":case"audio":for(u=0;u<pc.length;u++)Ge(pc[u],s);break;case"image":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"embed":case"source":case"link":Ge("error",s),Ge("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in l)if(l.hasOwnProperty(W)&&(u=l[W],u!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:ct(s,r,W,u,l,null)}return;default:if(Dl(r)){for(se in l)l.hasOwnProperty(se)&&(u=l[se],u!==void 0&&lp(s,r,se,u,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(u=l[I],u!=null&&ct(s,r,I,u,l,null))}function Qw(s,r,l,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,v=null,T=null,I=null,z=null,W=null,se=null;for(J in l){var re=l[J];if(l.hasOwnProperty(J)&&re!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":z=re;default:u.hasOwnProperty(J)||ct(s,r,J,null,u,re)}}for(var Z in u){var J=u[Z];if(re=l[Z],u.hasOwnProperty(Z)&&(J!=null||re!=null))switch(Z){case"type":v=J;break;case"name":m=J;break;case"checked":W=J;break;case"defaultChecked":se=J;break;case"value":T=J;break;case"defaultValue":I=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,r));break;default:J!==re&&ct(s,r,Z,J,u,re)}}On(s,T,I,z,W,se,v,m);return;case"select":J=T=I=Z=null;for(v in l)if(z=l[v],l.hasOwnProperty(v)&&z!=null)switch(v){case"value":break;case"multiple":J=z;default:u.hasOwnProperty(v)||ct(s,r,v,null,u,z)}for(m in u)if(v=u[m],z=l[m],u.hasOwnProperty(m)&&(v!=null||z!=null))switch(m){case"value":Z=v;break;case"defaultValue":I=v;break;case"multiple":T=v;default:v!==z&&ct(s,r,m,v,u,z)}r=I,l=T,u=J,Z!=null?ra(s,!!l,Z,!1):!!u!=!!l&&(r!=null?ra(s,!!l,r,!0):ra(s,!!l,l?[]:"",!1));return;case"textarea":J=Z=null;for(I in l)if(m=l[I],l.hasOwnProperty(I)&&m!=null&&!u.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:ct(s,r,I,null,u,m)}for(T in u)if(m=u[T],v=l[T],u.hasOwnProperty(T)&&(m!=null||v!=null))switch(T){case"value":Z=m;break;case"defaultValue":J=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==v&&ct(s,r,T,m,u,v)}ot(s,Z,J);return;case"option":for(var Ce in l)if(Z=l[Ce],l.hasOwnProperty(Ce)&&Z!=null&&!u.hasOwnProperty(Ce))switch(Ce){case"selected":s.selected=!1;break;default:ct(s,r,Ce,null,u,Z)}for(z in u)if(Z=u[z],J=l[z],u.hasOwnProperty(z)&&Z!==J&&(Z!=null||J!=null))switch(z){case"selected":s.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:ct(s,r,z,Z,u,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Te in l)Z=l[Te],l.hasOwnProperty(Te)&&Z!=null&&!u.hasOwnProperty(Te)&&ct(s,r,Te,null,u,Z);for(W in u)if(Z=u[W],J=l[W],u.hasOwnProperty(W)&&Z!==J&&(Z!=null||J!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,r));break;default:ct(s,r,W,Z,u,J)}return;default:if(Dl(r)){for(var ut in l)Z=l[ut],l.hasOwnProperty(ut)&&Z!==void 0&&!u.hasOwnProperty(ut)&&lp(s,r,ut,void 0,u,Z);for(se in u)Z=u[se],J=l[se],!u.hasOwnProperty(se)||Z===J||Z===void 0&&J===void 0||lp(s,r,se,Z,u,J);return}}for(var Q in l)Z=l[Q],l.hasOwnProperty(Q)&&Z!=null&&!u.hasOwnProperty(Q)&&ct(s,r,Q,null,u,Z);for(re in u)Z=u[re],J=l[re],!u.hasOwnProperty(re)||Z===J||Z==null&&J==null||ct(s,r,re,Z,u,J)}var cp=null,up=null;function Ld(s){return s.nodeType===9?s:s.ownerDocument}function Bb(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gb(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function dp(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var hp=null;function Kw(){var s=window.event;return s&&s.type==="popstate"?s===hp?!1:(hp=s,!0):(hp=null,!1)}var $b=typeof setTimeout=="function"?setTimeout:void 0,Xw=typeof clearTimeout=="function"?clearTimeout:void 0,Yb=typeof Promise=="function"?Promise:void 0,Ww=typeof queueMicrotask=="function"?queueMicrotask:typeof Yb<"u"?function(s){return Yb.resolve(null).then(s).catch(Zw)}:$b;function Zw(s){setTimeout(function(){throw s})}function ri(s){return s==="head"}function Qb(s,r){var l=r,u=0,m=0;do{var v=l.nextSibling;if(s.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<u&&8>u){l=u;var T=s.ownerDocument;if(l&1&&vc(T.documentElement),l&2&&vc(T.body),l&4)for(l=T.head,vc(l),T=l.firstChild;T;){var I=T.nextSibling,z=T.nodeName;T[Qi]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&T.rel.toLowerCase()==="stylesheet"||l.removeChild(T),T=I}}if(m===0){s.removeChild(v),jc(r);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:u=l.charCodeAt(0)-48;else u=0;l=v}while(l);jc(r)}function fp(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":fp(l),qa(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function Jw(s,r,l,u){for(;s.nodeType===1;){var m=l;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Qi])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var v=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=gs(s.nextSibling),s===null)break}return null}function eC(s,r,l){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=gs(s.nextSibling),s===null))return null;return s}function mp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function tC(s,r){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")r();else{var u=function(){r(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function gs(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return s}var pp=null;function Kb(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return s;r--}else l==="/$"&&r++}s=s.previousSibling}return null}function Xb(s,r,l){switch(r=Ld(l),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function vc(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);qa(s)}var is=new Map,Wb=new Set;function Vd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ja=te.d;te.d={f:nC,r:sC,D:aC,C:iC,L:rC,m:oC,X:cC,S:lC,M:uC};function nC(){var s=ja.f(),r=Sd();return s||r}function sC(s){var r=Cs(s);r!==null&&r.tag===5&&r.type==="form"?vx(r):ja.r(s)}var Mo=typeof document>"u"?null:document;function Zb(s,r,l){var u=Mo;if(u&&typeof r=="string"&&r){var m=Rt(r);m='link[rel="'+s+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),Wb.has(m)||(Wb.add(m),s={rel:s,crossOrigin:l,href:r},u.querySelector(m)===null&&(r=u.createElement("link"),nn(r,"link",s),At(r),u.head.appendChild(r)))}}function aC(s){ja.D(s),Zb("dns-prefetch",s,null)}function iC(s,r){ja.C(s,r),Zb("preconnect",s,r)}function rC(s,r,l){ja.L(s,r,l);var u=Mo;if(u&&s&&r){var m='link[rel="preload"][as="'+Rt(r)+'"]';r==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+Rt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+Rt(l.imageSizes)+'"]')):m+='[href="'+Rt(s)+'"]';var v=m;switch(r){case"style":v=Oo(s);break;case"script":v=ko(s)}is.has(v)||(s=y({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:s,as:r},l),is.set(v,s),u.querySelector(m)!==null||r==="style"&&u.querySelector(yc(v))||r==="script"&&u.querySelector(xc(v))||(r=u.createElement("link"),nn(r,"link",s),At(r),u.head.appendChild(r)))}}function oC(s,r){ja.m(s,r);var l=Mo;if(l&&s){var u=r&&typeof r.as=="string"?r.as:"script",m='link[rel="modulepreload"][as="'+Rt(u)+'"][href="'+Rt(s)+'"]',v=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ko(s)}if(!is.has(v)&&(s=y({rel:"modulepreload",href:s},r),is.set(v,s),l.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(xc(v)))return}u=l.createElement("link"),nn(u,"link",s),At(u),l.head.appendChild(u)}}}function lC(s,r,l){ja.S(s,r,l);var u=Mo;if(u&&s){var m=vn(u).hoistableStyles,v=Oo(s);r=r||"default";var T=m.get(v);if(!T){var I={loading:0,preload:null};if(T=u.querySelector(yc(v)))I.loading=5;else{s=y({rel:"stylesheet",href:s,"data-precedence":r},l),(l=is.get(v))&&gp(s,l);var z=T=u.createElement("link");At(z),nn(z,"link",s),z._p=new Promise(function(W,se){z.onload=W,z.onerror=se}),z.addEventListener("load",function(){I.loading|=1}),z.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Ud(T,r,u)}T={type:"stylesheet",instance:T,count:1,state:I},m.set(v,T)}}}function cC(s,r){ja.X(s,r);var l=Mo;if(l&&s){var u=vn(l).hoistableScripts,m=ko(s),v=u.get(m);v||(v=l.querySelector(xc(m)),v||(s=y({src:s,async:!0},r),(r=is.get(m))&&vp(s,r),v=l.createElement("script"),At(v),nn(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(m,v))}}function uC(s,r){ja.M(s,r);var l=Mo;if(l&&s){var u=vn(l).hoistableScripts,m=ko(s),v=u.get(m);v||(v=l.querySelector(xc(m)),v||(s=y({src:s,async:!0,type:"module"},r),(r=is.get(m))&&vp(s,r),v=l.createElement("script"),At(v),nn(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(m,v))}}function Jb(s,r,l,u){var m=(m=Re.current)?Vd(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=Oo(l.href),l=vn(m).hoistableStyles,u=l.get(r),u||(u={type:"style",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Oo(l.href);var v=vn(m).hoistableStyles,T=v.get(s);if(T||(m=m.ownerDocument||m,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,T),(v=m.querySelector(yc(s)))&&!v._p&&(T.instance=v,T.state.loading=5),is.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},is.set(s,l),v||dC(m,s,l,T.state))),r&&u===null)throw Error(i(528,""));return T}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ko(l),l=vn(m).hoistableScripts,u=l.get(r),u||(u={type:"script",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Oo(s){return'href="'+Rt(s)+'"'}function yc(s){return'link[rel="stylesheet"]['+s+"]"}function eN(s){return y({},s,{"data-precedence":s.precedence,precedence:null})}function dC(s,r,l,u){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=s.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),nn(r,"link",l),At(r),s.head.appendChild(r))}function ko(s){return'[src="'+Rt(s)+'"]'}function xc(s){return"script[async]"+s}function tN(s,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var u=s.querySelector('style[data-href~="'+Rt(l.href)+'"]');if(u)return r.instance=u,At(u),u;var m=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),At(u),nn(u,"style",m),Ud(u,l.precedence,s),r.instance=u;case"stylesheet":m=Oo(l.href);var v=s.querySelector(yc(m));if(v)return r.state.loading|=4,r.instance=v,At(v),v;u=eN(l),(m=is.get(m))&&gp(u,m),v=(s.ownerDocument||s).createElement("link"),At(v);var T=v;return T._p=new Promise(function(I,z){T.onload=I,T.onerror=z}),nn(v,"link",u),r.state.loading|=4,Ud(v,l.precedence,s),r.instance=v;case"script":return v=ko(l.src),(m=s.querySelector(xc(v)))?(r.instance=m,At(m),m):(u=l,(m=is.get(v))&&(u=y({},l),vp(u,m)),s=s.ownerDocument||s,m=s.createElement("script"),At(m),nn(m,"link",u),s.head.appendChild(m),r.instance=m);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Ud(u,l.precedence,s));return r.instance}function Ud(s,r,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,v=m,T=0;T<u.length;T++){var I=u[T];if(I.dataset.precedence===r)v=I;else if(v!==m)break}v?v.parentNode.insertBefore(s,v.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(s,r.firstChild))}function gp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function vp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var Fd=null;function nN(s,r,l){if(Fd===null){var u=new Map,m=Fd=new Map;m.set(l,u)}else m=Fd,u=m.get(l),u||(u=new Map,m.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),m=0;m<l.length;m++){var v=l[m];if(!(v[Qi]||v[Pt]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var T=v.getAttribute(r)||"";T=s+T;var I=u.get(T);I?I.push(v):u.set(T,[v])}}return u}function sN(s,r,l){s=s.ownerDocument||s,s.head.insertBefore(l,r==="title"?s.querySelector("head > title"):null)}function hC(s,r,l){if(l===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function aN(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var bc=null;function fC(){}function mC(s,r,l){if(bc===null)throw Error(i(475));var u=bc;if(r.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var m=Oo(l.href),v=s.querySelector(yc(m));if(v){s=v._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(u.count++,u=qd.bind(u),s.then(u,u)),r.state.loading|=4,r.instance=v,At(v);return}v=s.ownerDocument||s,l=eN(l),(m=is.get(m))&&gp(l,m),v=v.createElement("link"),At(v);var T=v;T._p=new Promise(function(I,z){T.onload=I,T.onerror=z}),nn(v,"link",l),r.instance=v}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(r,s),(s=r.state.preload)&&(r.state.loading&3)===0&&(u.count++,r=qd.bind(u),s.addEventListener("load",r),s.addEventListener("error",r))}}function pC(){if(bc===null)throw Error(i(475));var s=bc;return s.stylesheets&&s.count===0&&yp(s,s.stylesheets),0<s.count?function(r){var l=setTimeout(function(){if(s.stylesheets&&yp(s,s.stylesheets),s.unsuspend){var u=s.unsuspend;s.unsuspend=null,u()}},6e4);return s.unsuspend=r,function(){s.unsuspend=null,clearTimeout(l)}}:null}function qd(){if(this.count--,this.count===0){if(this.stylesheets)yp(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var zd=null;function yp(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,zd=new Map,r.forEach(gC,s),zd=null,qd.call(s))}function gC(s,r){if(!(r.state.loading&4)){var l=zd.get(s);if(l)var u=l.get(null);else{l=new Map,zd.set(s,l);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<m.length;v++){var T=m[v];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(l.set(T.dataset.precedence,T),u=T)}u&&l.set(null,u)}m=r.instance,T=m.getAttribute("data-precedence"),v=l.get(T)||u,v===u&&l.set(null,m),l.set(T,m),this.count++,u=qd.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),v?v.parentNode.insertBefore(m,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),r.state.loading|=4}}var Nc={$$typeof:U,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function vC(s,r,l,u,m,v,T,I){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ta(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ta(0),this.hiddenUpdates=ta(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=v,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function iN(s,r,l,u,m,v,T,I,z,W,se,re){return s=new vC(s,r,l,T,I,z,W,re),r=1,v===!0&&(r|=24),v=Pn(3,null,null,r),s.current=v,v.stateNode=s,r=Jf(),r.refCount++,s.pooledCache=r,r.refCount++,v.memoizedState={element:u,isDehydrated:l,cache:r},sm(v),s}function rN(s){return s?(s=ho,s):ho}function oN(s,r,l,u,m,v){m=rN(m),u.context===null?u.context=m:u.pendingContext=m,u=Ya(r),u.payload={element:l},v=v===void 0?null:v,v!==null&&(u.callback=v),l=Qa(s,u,r),l!==null&&(qn(l,s,r),Wl(l,s,r))}function lN(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<r?l:r}}function xp(s,r){lN(s,r),(s=s.alternate)&&lN(s,r)}function cN(s){if(s.tag===13){var r=uo(s,67108864);r!==null&&qn(r,s,67108864),xp(s,67108864)}}var Hd=!0;function yC(s,r,l,u){var m=Y.T;Y.T=null;var v=te.p;try{te.p=2,bp(s,r,l,u)}finally{te.p=v,Y.T=m}}function xC(s,r,l,u){var m=Y.T;Y.T=null;var v=te.p;try{te.p=8,bp(s,r,l,u)}finally{te.p=v,Y.T=m}}function bp(s,r,l,u){if(Hd){var m=Np(u);if(m===null)op(s,r,u,Bd,l),dN(s,u);else if(NC(m,s,r,l,u))u.stopPropagation();else if(dN(s,u),r&4&&-1<bC.indexOf(s)){for(;m!==null;){var v=Cs(m);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var T=ds(v.pendingLanes);if(T!==0){var I=v;for(I.pendingLanes|=2,I.entangledLanes|=2;T;){var z=1<<31-cn(T);I.entanglements[1]|=z,T&=~z}zs(v),(it&6)===0&&(wd=Yn()+500,mc(0))}}break;case 13:I=uo(v,2),I!==null&&qn(I,v,2),Sd(),xp(v,2)}if(v=Np(u),v===null&&op(s,r,u,Bd,l),v===m)break;m=v}m!==null&&u.stopPropagation()}else op(s,r,u,null,l)}}function Np(s){return s=Xn(s),_p(s)}var Bd=null;function _p(s){if(Bd=null,s=sa(s),s!==null){var r=c(s);if(r===null)s=null;else{var l=r.tag;if(l===13){if(s=d(r),s!==null)return s;s=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return Bd=s,null}function uN(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(jf()){case xl:return 2;case Hr:return 8;case Hi:case Af:return 32;case Br:return 268435456;default:return 32}default:return 32}}var Ep=!1,oi=null,li=null,ci=null,_c=new Map,Ec=new Map,ui=[],bC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dN(s,r){switch(s){case"focusin":case"focusout":oi=null;break;case"dragenter":case"dragleave":li=null;break;case"mouseover":case"mouseout":ci=null;break;case"pointerover":case"pointerout":_c.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ec.delete(r.pointerId)}}function Tc(s,r,l,u,m,v){return s===null||s.nativeEvent!==v?(s={blockedOn:r,domEventName:l,eventSystemFlags:u,nativeEvent:v,targetContainers:[m]},r!==null&&(r=Cs(r),r!==null&&cN(r)),s):(s.eventSystemFlags|=u,r=s.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),s)}function NC(s,r,l,u,m){switch(r){case"focusin":return oi=Tc(oi,s,r,l,u,m),!0;case"dragenter":return li=Tc(li,s,r,l,u,m),!0;case"mouseover":return ci=Tc(ci,s,r,l,u,m),!0;case"pointerover":var v=m.pointerId;return _c.set(v,Tc(_c.get(v)||null,s,r,l,u,m)),!0;case"gotpointercapture":return v=m.pointerId,Ec.set(v,Tc(Ec.get(v)||null,s,r,l,u,m)),!0}return!1}function hN(s){var r=sa(s.target);if(r!==null){var l=c(r);if(l!==null){if(r=l.tag,r===13){if(r=d(l),r!==null){s.blockedOn=r,Su(s.priority,function(){if(l.tag===13){var u=Fn();u=Va(u);var m=uo(l,u);m!==null&&qn(m,l,u),xp(l,u)}});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Gd(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var l=Np(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);oa=u,l.target.dispatchEvent(u),oa=null}else return r=Cs(l),r!==null&&cN(r),s.blockedOn=l,!1;r.shift()}return!0}function fN(s,r,l){Gd(s)&&l.delete(r)}function _C(){Ep=!1,oi!==null&&Gd(oi)&&(oi=null),li!==null&&Gd(li)&&(li=null),ci!==null&&Gd(ci)&&(ci=null),_c.forEach(fN),Ec.forEach(fN)}function $d(s,r){s.blockedOn===r&&(s.blockedOn=null,Ep||(Ep=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,_C)))}var Yd=null;function mN(s){Yd!==s&&(Yd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Yd===s&&(Yd=null);for(var r=0;r<s.length;r+=3){var l=s[r],u=s[r+1],m=s[r+2];if(typeof u!="function"){if(_p(u||l)===null)continue;break}var v=Cs(l);v!==null&&(s.splice(r,3),r-=3,_m(v,{pending:!0,data:m,method:l.method,action:u},u,m))}}))}function jc(s){function r(z){return $d(z,s)}oi!==null&&$d(oi,s),li!==null&&$d(li,s),ci!==null&&$d(ci,s),_c.forEach(r),Ec.forEach(r);for(var l=0;l<ui.length;l++){var u=ui[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<ui.length&&(l=ui[0],l.blockedOn===null);)hN(l),l.blockedOn===null&&ui.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var m=l[u],v=l[u+1],T=m[It]||null;if(typeof v=="function")T||mN(l);else if(T){var I=null;if(v&&v.hasAttribute("formAction")){if(m=v,T=v[It]||null)I=T.formAction;else if(_p(m)!==null)continue}else I=T.action;typeof I=="function"?l[u+1]=I:(l.splice(u,3),u-=3),mN(l)}}}function Tp(s){this._internalRoot=s}Qd.prototype.render=Tp.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var l=r.current,u=Fn();oN(l,u,s,r,null,null)},Qd.prototype.unmount=Tp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;oN(s.current,2,null,s,null,null),Sd(),r[Qn]=null}};function Qd(s){this._internalRoot=s}Qd.prototype.unstable_scheduleHydration=function(s){if(s){var r=Ua();s={blockedOn:null,target:s,priority:r};for(var l=0;l<ui.length&&r!==0&&r<ui[l].priority;l++);ui.splice(l,0,s),l===0&&hN(s)}};var pN=e.version;if(pN!=="19.1.0")throw Error(i(527,pN,"19.1.0"));te.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=p(r),s=s!==null?g(s):null,s=s===null?null:s.stateNode,s};var EC={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kd.isDisabled&&Kd.supportsFiber)try{Et=Kd.inject(EC),at=Kd}catch{}}return wc.createRoot=function(s,r){if(!o(s))throw Error(i(299));var l=!1,u="",m=Rx,v=Dx,T=Mx,I=null;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(T=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(I=r.unstable_transitionCallbacks)),r=iN(s,1,!1,null,null,l,u,m,v,T,I,null),s[Qn]=r.current,rp(s),new Tp(r)},wc.hydrateRoot=function(s,r,l){if(!o(s))throw Error(i(299));var u=!1,m="",v=Rx,T=Dx,I=Mx,z=null,W=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(T=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(z=l.unstable_transitionCallbacks),l.formState!==void 0&&(W=l.formState)),r=iN(s,1,!0,r,l??null,u,m,v,T,I,z,W),r.context=rN(null),l=r.current,u=Fn(),u=Va(u),m=Ya(u),m.callback=null,Qa(l,m,u),l=u,r.current.lanes=l,na(r,l),zs(r),s[Qn]=r.current,rp(s),new Qd(r)},wc.version="19.1.0",wc}var jN;function MC(){if(jN)return wp.exports;jN=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),wp.exports=DC(),wp.exports}var OC=MC();const kC=()=>{};var AN={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},PC=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[i++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],f=n[t++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(p>>10)),e[i++]=String.fromCharCode(56320+(p&1023))}else{const c=n[t++],d=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},YE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,f=d?n[o+1]:0,p=o+2<n.length,g=p?n[o+2]:0,y=c>>2,N=(c&3)<<4|f>>4;let j=(f&15)<<2|g>>6,w=g&63;p||(w=64,d||(j=64)),i.push(t[y],t[N],t[j],t[w])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray($E(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):PC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],f=o<n.length?t[n.charAt(o)]:0;++o;const g=o<n.length?t[n.charAt(o)]:64;++o;const N=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||f==null||g==null||N==null)throw new LC;const j=c<<2|f>>4;if(i.push(j),g!==64){const w=f<<4&240|g>>2;if(i.push(w),N!==64){const b=g<<6&192|N;i.push(b)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class LC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const VC=function(n){const e=$E(n);return YE.encodeByteArray(e,!0)},vh=function(n){return VC(n).replace(/\./g,"")},QE=function(n){try{return YE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC=()=>UC().__FIREBASE_DEFAULTS__,qC=()=>{if(typeof process>"u"||typeof AN>"u")return;const n=AN.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},zC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&QE(n[1]);return e&&JSON.parse(e)},Bh=()=>{try{return kC()||FC()||qC()||zC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},KE=n=>{var e,t;return(t=(e=Bh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},XE=n=>{const e=KE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},WE=()=>{var n;return(n=Bh())===null||n===void 0?void 0:n.config},ZE=n=>{var e;return(e=Bh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lr(n){return n.endsWith(".cloudworkstations.dev")}async function Rg(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},n);return[vh(JSON.stringify(t)),vh(JSON.stringify(d)),""].join(".")}const Oc={};function BC(){const n={prod:[],emulator:[]};for(const e of Object.keys(Oc))Oc[e]?n.emulator.push(e):n.prod.push(e);return n}function GC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let wN=!1;function Dg(n,e){if(typeof window>"u"||typeof document>"u"||!Lr(window.location.host)||Oc[n]===e||Oc[n]||wN)return;Oc[n]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",c=BC().prod.length>0;function d(){const j=document.getElementById(i);j&&j.remove()}function f(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function p(j,w){j.setAttribute("width","24"),j.setAttribute("id",w),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function g(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{wN=!0,d()},j}function y(j,w){j.setAttribute("id",w),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function N(){const j=GC(i),w=t("text"),b=document.getElementById(w)||document.createElement("span"),A=t("learnmore"),E=document.getElementById(A)||document.createElement("a"),D=t("preprendIcon"),q=document.getElementById(D)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const U=j.element;f(U),y(E,A);const P=g();p(q,D),U.append(q,b,E,P),document.body.appendChild(U)}c?(b.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",N):N()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $C(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gn())}function YC(){var n;const e=(n=Bh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function QC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Mg(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function KC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function XC(){const n=gn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function WC(){return!YC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Gh(){try{return typeof indexedDB=="object"}catch{return!1}}function $h(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}function Og(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC="FirebaseError";class us extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=ZC,Object.setPrototypeOf(this,us.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mi.prototype.create)}}class Mi{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?JC(c,i):"Error",f=`${this.serviceName}: ${d} (${o}).`;return new us(o,f,i)}}function JC(n,e){return n.replace(eS,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const eS=/\{\$([^}]+)}/g;function tS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ei(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const c=n[o],d=e[o];if(CN(c)&&CN(d)){if(!Ei(c,d))return!1}else if(c!==d)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function CN(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Cc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,c]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Sc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function nS(n,e){const t=new sS(n,e);return t.subscribe.bind(t)}class sS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");aS(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=Rp),o.error===void 0&&(o.error=Rp),o.complete===void 0&&(o.complete=Rp);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function aS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Rp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS=1e3,rS=2,oS=4*60*60*1e3,lS=.5;function SN(n,e=iS,t=rS){const i=e*Math.pow(t,n),o=Math.round(lS*i*(Math.random()-.5)*2);return Math.min(oS,i+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(n){return n&&n._delegate?n._delegate:n}class $n{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new HC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(dS(e))try{this.getOrInitializeService({instanceIdentifier:Tr})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});i.resolve(c)}catch{}}}}clearInstance(e=Tr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Tr){return this.instances.has(e)}getOptions(e=Tr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[c,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(c);i===f&&d.resolve(o)}return o}onInit(e,t){var i;const o=this.normalizeInstanceIdentifier(t),c=(i=this.onInitCallbacks.get(o))!==null&&i!==void 0?i:new Set;c.add(e),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&e(d,o),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:uS(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Tr){return this.component?this.component.multipleInstances?e:Tr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function uS(n){return n===Tr?void 0:n}function dS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new cS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})($e||($e={}));const fS={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},mS=$e.INFO,pS={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},gS=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=pS[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lu{constructor(e){this.name=e,this._logLevel=mS,this._logHandler=gS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?fS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const vS=(n,e)=>e.some(t=>n instanceof t);let IN,RN;function yS(){return IN||(IN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xS(){return RN||(RN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const eT=new WeakMap,Jp=new WeakMap,tT=new WeakMap,Dp=new WeakMap,kg=new WeakMap;function bS(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(xi(n.result)),o()},d=()=>{i(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&eT.set(t,n)}).catch(()=>{}),kg.set(e,n),e}function NS(n){if(Jp.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});Jp.set(n,e)}let eg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Jp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||tT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return xi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function _S(n){eg=n(eg)}function ES(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Mp(this),e,...t);return tT.set(i,e.sort?e.sort():[e]),xi(i)}:xS().includes(n)?function(...e){return n.apply(Mp(this),e),xi(eT.get(this))}:function(...e){return xi(n.apply(Mp(this),e))}}function TS(n){return typeof n=="function"?ES(n):(n instanceof IDBTransaction&&NS(n),vS(n,yS())?new Proxy(n,eg):n)}function xi(n){if(n instanceof IDBRequest)return bS(n);if(Dp.has(n))return Dp.get(n);const e=TS(n);return e!==n&&(Dp.set(n,e),kg.set(e,n)),e}const Mp=n=>kg.get(n);function nT(n,e,{blocked:t,upgrade:i,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),f=xi(d);return i&&d.addEventListener("upgradeneeded",p=>{i(xi(d.result),p.oldVersion,p.newVersion,xi(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),f.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),f}const jS=["get","getKey","getAll","getAllKeys","count"],AS=["put","add","delete","clear"],Op=new Map;function DN(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Op.get(e))return Op.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=AS.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||jS.includes(t)))return;const c=async function(d,...f){const p=this.transaction(d,o?"readwrite":"readonly");let g=p.store;return i&&(g=g.index(f.shift())),(await Promise.all([g[t](...f),o&&p.done]))[0]};return Op.set(e,c),c}_S(n=>({...n,get:(e,t,i)=>DN(e,t)||n.get(e,t,i),has:(e,t)=>!!DN(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(CS(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function CS(n){const e=n.getComponent();return e?.type==="VERSION"}const tg="@firebase/app",MN="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=new lu("@firebase/app"),SS="@firebase/app-compat",IS="@firebase/analytics-compat",RS="@firebase/analytics",DS="@firebase/app-check-compat",MS="@firebase/app-check",OS="@firebase/auth",kS="@firebase/auth-compat",PS="@firebase/database",LS="@firebase/data-connect",VS="@firebase/database-compat",US="@firebase/functions",FS="@firebase/functions-compat",qS="@firebase/installations",zS="@firebase/installations-compat",HS="@firebase/messaging",BS="@firebase/messaging-compat",GS="@firebase/performance",$S="@firebase/performance-compat",YS="@firebase/remote-config",QS="@firebase/remote-config-compat",KS="@firebase/storage",XS="@firebase/storage-compat",WS="@firebase/firestore",ZS="@firebase/ai",JS="@firebase/firestore-compat",eI="firebase",tI="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng="[DEFAULT]",nI={[tg]:"fire-core",[SS]:"fire-core-compat",[RS]:"fire-analytics",[IS]:"fire-analytics-compat",[MS]:"fire-app-check",[DS]:"fire-app-check-compat",[OS]:"fire-auth",[kS]:"fire-auth-compat",[PS]:"fire-rtdb",[LS]:"fire-data-connect",[VS]:"fire-rtdb-compat",[US]:"fire-fn",[FS]:"fire-fn-compat",[qS]:"fire-iid",[zS]:"fire-iid-compat",[HS]:"fire-fcm",[BS]:"fire-fcm-compat",[GS]:"fire-perf",[$S]:"fire-perf-compat",[YS]:"fire-rc",[QS]:"fire-rc-compat",[KS]:"fire-gcs",[XS]:"fire-gcs-compat",[WS]:"fire-fst",[JS]:"fire-fst-compat",[ZS]:"fire-vertex","fire-js":"fire-js",[eI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yh=new Map,sI=new Map,sg=new Map;function ON(n,e){try{n.container.addComponent(e)}catch(t){Ra.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ls(n){const e=n.name;if(sg.has(e))return Ra.debug(`There were multiple attempts to register component ${e}.`),!1;sg.set(e,n);for(const t of yh.values())ON(t,n);for(const t of sI.values())ON(t,n);return!0}function ka(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function In(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bi=new Mi("app","Firebase",aI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vr=tI;function sT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:ng,automaticDataCollectionEnabled:!0},e),o=i.name;if(typeof o!="string"||!o)throw bi.create("bad-app-name",{appName:String(o)});if(t||(t=WE()),!t)throw bi.create("no-options");const c=yh.get(o);if(c){if(Ei(t,c.options)&&Ei(i,c.config))return c;throw bi.create("duplicate-app",{appName:o})}const d=new hS(o);for(const p of sg.values())d.addComponent(p);const f=new iI(t,i,d);return yh.set(o,f),f}function cu(n=ng){const e=yh.get(n);if(!e&&n===ng&&WE())return sT();if(!e)throw bi.create("no-app",{appName:n});return e}function pn(n,e,t){var i;let o=(i=nI[n])!==null&&i!==void 0?i:n;t&&(o+=`-${t}`);const c=o.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const f=[`Unable to register library "${o}" with version "${e}":`];c&&f.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ra.warn(f.join(" "));return}ls(new $n(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI="firebase-heartbeat-database",oI=1,$c="firebase-heartbeat-store";let kp=null;function aT(){return kp||(kp=nT(rI,oI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore($c)}catch(t){console.warn(t)}}}}).catch(n=>{throw bi.create("idb-open",{originalErrorMessage:n.message})})),kp}async function lI(n){try{const t=(await aT()).transaction($c),i=await t.objectStore($c).get(iT(n));return await t.done,i}catch(e){if(e instanceof us)Ra.warn(e.message);else{const t=bi.create("idb-get",{originalErrorMessage:e?.message});Ra.warn(t.message)}}}async function kN(n,e){try{const i=(await aT()).transaction($c,"readwrite");await i.objectStore($c).put(e,iT(n)),await i.done}catch(t){if(t instanceof us)Ra.warn(t.message);else{const i=bi.create("idb-set",{originalErrorMessage:t?.message});Ra.warn(i.message)}}}function iT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI=1024,uI=30;class dI{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new fI(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=PN();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>uI){const d=mI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Ra.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=PN(),{heartbeatsToSend:i,unsentEntries:o}=hI(this._heartbeatsCache.heartbeats),c=vh(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Ra.warn(t),""}}}function PN(){return new Date().toISOString().substring(0,10)}function hI(n,e=cI){const t=[];let i=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),LN(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),LN(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class fI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Gh()?$h().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await lI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return kN(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return kN(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function LN(n){return vh(JSON.stringify({version:2,heartbeats:n})).length}function mI(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(n){ls(new $n("platform-logger",e=>new wS(e),"PRIVATE")),ls(new $n("heartbeat",e=>new dI(e),"PRIVATE")),pn(tg,MN,n),pn(tg,MN,"esm2017"),pn("fire-js","")}pI("");function Pg(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(n);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(n,i[o])&&(t[i[o]]=n[i[o]]);return t}function rT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const gI=rT,oT=new Mi("auth","Firebase",rT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh=new lu("@firebase/auth");function vI(n,...e){xh.logLevel<=$e.WARN&&xh.warn(`Auth (${Vr}): ${n}`,...e)}function ih(n,...e){xh.logLevel<=$e.ERROR&&xh.error(`Auth (${Vr}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(n,...e){throw Vg(n,...e)}function _s(n,...e){return Vg(n,...e)}function Lg(n,e,t){const i=Object.assign(Object.assign({},gI()),{[e]:t});return new Mi("auth","Firebase",i).create(e,{appName:n.name})}function Ia(n){return Lg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yI(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&cs(n,"argument-error"),Lg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Vg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return oT.create(n,...e)}function we(n,e,...t){if(!n)throw Vg(e,...t)}function Ca(n){const e="INTERNAL ASSERTION FAILED: "+n;throw ih(e),new Error(e)}function Da(n,e){n||Ca(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ag(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function xI(){return VN()==="http:"||VN()==="https:"}function VN(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xI()||Mg()||"connection"in navigator)?navigator.onLine:!0}function NI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Da(t>e,"Short delay should be less than long delay!"),this.isMobile=$C()||KC()}get(){return bI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(n,e){Da(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ca("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ca("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ca("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],TI=new uu(3e4,6e4);function Oi(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function ki(n,e,t,i,o={}){return cT(n,o,async()=>{let c={},d={};i&&(e==="GET"?d=i:c={body:JSON.stringify(i)});const f=ou(Object.assign({key:n.config.apiKey},d)).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const g=Object.assign({method:e,headers:p},c);return QC()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&Lr(n.emulatorConfig.host)&&(g.credentials="include"),lT.fetch()(await uT(n,n.config.apiHost,t,f),g)})}async function cT(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},_I),e);try{const o=new AI(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw Xd(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const f=c.ok?d.errorMessage:d.error.message,[p,g]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xd(n,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw Xd(n,"email-already-in-use",d);if(p==="USER_DISABLED")throw Xd(n,"user-disabled",d);const y=i[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw Lg(n,y,g);cs(n,y)}}catch(o){if(o instanceof us)throw o;cs(n,"network-request-failed",{message:String(o)})}}async function du(n,e,t,i,o={}){const c=await ki(n,e,t,i,o);return"mfaPendingCredential"in c&&cs(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function uT(n,e,t,i){const o=`${e}${t}?${i}`,c=n,d=c.config.emulator?Ug(n.config,o):`${n.config.apiScheme}://${o}`;return EI.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function jI(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class AI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(_s(this.auth,"network-request-failed")),TI.get())})}}function Xd(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=_s(n,e,i);return o.customData._tokenResponse=t,o}function UN(n){return n!==void 0&&n.enterprise!==void 0}class wI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return jI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function CI(n,e){return ki(n,"GET","/v2/recaptchaConfig",Oi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SI(n,e){return ki(n,"POST","/v1/accounts:delete",e)}async function bh(n,e){return ki(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function II(n,e=!1){const t=yt(n),i=await t.getIdToken(e),o=Fg(i);we(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:i,authTime:kc(Pp(o.auth_time)),issuedAtTime:kc(Pp(o.iat)),expirationTime:kc(Pp(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Pp(n){return Number(n)*1e3}function Fg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return ih("JWT malformed, contained fewer than 3 sections"),null;try{const o=QE(t);return o?JSON.parse(o):(ih("Failed to decode base64 JWT payload"),null)}catch(o){return ih("Caught error parsing JWT payload as JSON",o?.toString()),null}}function FN(n){const e=Fg(n);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yc(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof us&&RI(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function RI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=kc(this.lastLoginAt),this.creationTime=kc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nh(n){var e;const t=n.auth,i=await n.getIdToken(),o=await Yc(n,bh(t,{idToken:i}));we(o?.users.length,t,"internal-error");const c=o.users[0];n._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?dT(c.providerUserInfo):[],f=OI(n.providerData,d),p=n.isAnonymous,g=!(n.email&&c.passwordHash)&&!f?.length,y=p?g:!1,N={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:f,metadata:new ig(c.createdAt,c.lastLoginAt),isAnonymous:y};Object.assign(n,N)}async function MI(n){const e=yt(n);await Nh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function OI(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function dT(n){return n.map(e=>{var{providerId:t}=e,i=Pg(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kI(n,e){const t=await cT(n,{},async()=>{const i=ou({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await uT(n,o,"/v1/token",`key=${c}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:i};return n.emulatorConfig&&Lr(n.emulatorConfig.host)&&(p.credentials="include"),lT.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function PI(n,e){return ki(n,"POST","/v2/accounts:revokeToken",Oi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):FN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){we(e.length!==0,"internal-error");const t=FN(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(we(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:c}=await kI(e,t);this.updateTokensAndExpiration(i,o,Number(c))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:c}=t,d=new $o;return i&&(we(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),o&&(we(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(we(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $o,this.toJSON())}_performRefresh(){return Ca("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(n,e){we(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class bs{constructor(e){var{uid:t,auth:i,stsTokenManager:o}=e,c=Pg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new DI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new ig(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await Yc(this,this.stsTokenManager.getToken(this.auth,e));return we(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return II(this,e)}reload(){return MI(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new bs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Nh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(In(this.auth.app))return Promise.reject(Ia(this.auth));const e=await this.getIdToken();return await Yc(this,SI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,o,c,d,f,p,g,y;const N=(i=t.displayName)!==null&&i!==void 0?i:void 0,j=(o=t.email)!==null&&o!==void 0?o:void 0,w=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,b=(d=t.photoURL)!==null&&d!==void 0?d:void 0,A=(f=t.tenantId)!==null&&f!==void 0?f:void 0,E=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,D=(g=t.createdAt)!==null&&g!==void 0?g:void 0,q=(y=t.lastLoginAt)!==null&&y!==void 0?y:void 0,{uid:U,emailVerified:P,isAnonymous:F,providerData:$,stsTokenManager:L}=t;we(U&&L,e,"internal-error");const S=$o.fromJSON(this.name,L);we(typeof U=="string",e,"internal-error"),hi(N,e.name),hi(j,e.name),we(typeof P=="boolean",e,"internal-error"),we(typeof F=="boolean",e,"internal-error"),hi(w,e.name),hi(b,e.name),hi(A,e.name),hi(E,e.name),hi(D,e.name),hi(q,e.name);const k=new bs({uid:U,auth:e,email:j,emailVerified:P,displayName:N,isAnonymous:F,photoURL:b,phoneNumber:w,tenantId:A,stsTokenManager:S,createdAt:D,lastLoginAt:q});return $&&Array.isArray($)&&(k.providerData=$.map(O=>Object.assign({},O))),E&&(k._redirectEventId=E),k}static async _fromIdTokenResponse(e,t,i=!1){const o=new $o;o.updateFromServerResponse(t);const c=new bs({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await Nh(c),c}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];we(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?dT(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,f=new $o;f.updateFromIdToken(i);const p=new bs({uid:o.localId,auth:e,stsTokenManager:f,isAnonymous:d}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new ig(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,g),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN=new Map;function Sa(n){Da(n instanceof Function,"Expected a class definition");let e=qN.get(n);return e?(Da(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,qN.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}hT.type="NONE";const zN=hT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rh(n,e,t){return`firebase:${n}:${e}:${t}`}class Yo{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:c}=this.auth;this.fullUserKey=rh(this.userKey,o.apiKey,c),this.fullPersistenceKey=rh("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await bh(this.auth,{idToken:e}).catch(()=>{});return t?bs._fromGetAccountInfoResponse(this.auth,t,e):null}return bs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Yo(Sa(zN),e,i);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let c=o[0]||Sa(zN);const d=rh(i,e.config.apiKey,e.name);let f=null;for(const g of t)try{const y=await g._get(d);if(y){let N;if(typeof y=="string"){const j=await bh(e,{idToken:y}).catch(()=>{});if(!j)break;N=await bs._fromGetAccountInfoResponse(e,j,y)}else N=bs._fromJSON(e,y);g!==c&&(f=N),c=g;break}}catch{}const p=o.filter(g=>g._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new Yo(c,e,i):(c=p[0],f&&await c._set(d,f.toJSON()),await Promise.all(t.map(async g=>{if(g!==c)try{await g._remove(d)}catch{}})),new Yo(c,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HN(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(yT(e))return"Blackberry";if(xT(e))return"Webos";if(mT(e))return"Safari";if((e.includes("chrome/")||pT(e))&&!e.includes("edge/"))return"Chrome";if(vT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function fT(n=gn()){return/firefox\//i.test(n)}function mT(n=gn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pT(n=gn()){return/crios\//i.test(n)}function gT(n=gn()){return/iemobile/i.test(n)}function vT(n=gn()){return/android/i.test(n)}function yT(n=gn()){return/blackberry/i.test(n)}function xT(n=gn()){return/webos/i.test(n)}function qg(n=gn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function LI(n=gn()){var e;return qg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function VI(){return XC()&&document.documentMode===10}function bT(n=gn()){return qg(n)||vT(n)||xT(n)||yT(n)||/windows phone/i.test(n)||gT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(n,e=[]){let t;switch(n){case"Browser":t=HN(gn());break;case"Worker":t=`${HN(gn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Vr}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=c=>new Promise((d,f)=>{try{const p=e(c);d(p)}catch(p){f(p)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FI(n,e={}){return ki(n,"GET","/v2/passwordPolicy",Oi(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qI=6;class zI{constructor(e){var t,i,o,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:qI,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,o,c,d,f;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(i=p.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),p.isValid&&(p.isValid=(o=p.containsLowercaseLetter)!==null&&o!==void 0?o:!0),p.isValid&&(p.isValid=(c=p.containsUppercaseLetter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(d=p.containsNumericCharacter)!==null&&d!==void 0?d:!0),p.isValid&&(p.isValid=(f=p.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),p}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new BN(this),this.idTokenSubscription=new BN(this),this.beforeStateQueue=new UI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=oT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Sa(t)),this._initializationPromise=this.queue(async()=>{var i,o,c;if(!this._deleted&&(this.persistenceManager=await Yo.create(this,e),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await bh(this,{idToken:e}),i=await bs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(In(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let o=i,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=o?._redirectEventId,p=await this.tryRedirectSignIn(e);(!d||d===f)&&p?.user&&(o=p.user,c=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(o)}catch(d){o=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Nh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=NI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(In(this.app))return Promise.reject(Ia(this));const t=e?yt(e):null;return t&&we(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return In(this.app)?Promise.reject(Ia(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return In(this.app)?Promise.reject(Ia(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await FI(this),t=new zI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Mi("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await PI(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Sa(e)||this._popupRedirectResolver;we(t,this,"argument-error"),this.redirectPersistenceManager=await Yo.create(this,[Sa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(we(f,this,"internal-error"),f.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,i,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=NT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(In(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&vI(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Pi(n){return yt(n)}class BN{constructor(e){this.auth=e,this.observer=null,this.addObserver=nS(t=>this.observer=t)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function BI(n){Yh=n}function _T(n){return Yh.loadJS(n)}function GI(){return Yh.recaptchaEnterpriseScript}function $I(){return Yh.gapiScript}function YI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class QI{constructor(){this.enterprise=new KI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class KI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const XI="recaptcha-enterprise",ET="NO_RECAPTCHA";class WI{constructor(e){this.type=XI,this.auth=Pi(e)}async verify(e="verify",t=!1){async function i(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,f)=>{CI(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const g=new wI(p);return c.tenantId==null?c._agentRecaptchaConfig=g:c._tenantRecaptchaConfigs[c.tenantId]=g,d(g.siteKey)}}).catch(p=>{f(p)})})}function o(c,d,f){const p=window.grecaptcha;UN(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(g=>{d(g)}).catch(()=>{d(ET)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new QI().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{i(this.auth).then(f=>{if(!t&&UN(window.grecaptcha))o(f,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=GI();p.length!==0&&(p+=f),_T(p).then(()=>{o(f,c,d)}).catch(g=>{d(g)})}}).catch(f=>{d(f)})})}}async function GN(n,e,t,i=!1,o=!1){const c=new WI(n);let d;if(o)d=ET;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,g=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function rg(n,e,t,i,o){var c;if(!((c=n._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await GN(n,e,t,t==="getOobCode");return i(n,d)}else return i(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await GN(n,e,t,t==="getOobCode");return i(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZI(n,e){const t=ka(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Ei(c,e??{}))return o;cs(o,"already-initialized")}return t.initialize({options:e})}function JI(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Sa);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function eR(n,e,t){const i=Pi(n);we(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,c=TT(e),{host:d,port:f}=tR(e),p=f===null?"":`:${f}`,g={url:`${c}//${d}${p}/`},y=Object.freeze({host:d,port:f,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){we(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),we(Ei(g,i.config.emulator)&&Ei(y,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=y,i.settings.appVerificationDisabledForTesting=!0,Lr(d)?(Rg(`${c}//${d}${p}`),Dg("Auth",!0)):nR()}function TT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function tR(n){const e=TT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const c=o[1];return{host:c,port:$N(i.substr(c.length+1))}}else{const[c,d]=i.split(":");return{host:c,port:$N(d)}}}function $N(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function nR(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ca("not implemented")}_getIdTokenResponse(e){return Ca("not implemented")}_linkToIdToken(e,t){return Ca("not implemented")}_getReauthenticationResolver(e){return Ca("not implemented")}}async function sR(n,e){return ki(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aR(n,e){return du(n,"POST","/v1/accounts:signInWithPassword",Oi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iR(n,e){return du(n,"POST","/v1/accounts:signInWithEmailLink",Oi(n,e))}async function rR(n,e){return du(n,"POST","/v1/accounts:signInWithEmailLink",Oi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc extends zg{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Qc(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Qc(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rg(e,t,"signInWithPassword",aR);case"emailLink":return iR(e,{email:this._email,oobCode:this._password});default:cs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rg(e,i,"signUpPassword",sR);case"emailLink":return rR(e,{idToken:t,email:this._email,oobCode:this._password});default:cs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qo(n,e){return du(n,"POST","/v1/accounts:signInWithIdp",Oi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR="http://localhost";class Sr extends zg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Sr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):cs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o}=t,c=Pg(t,["providerId","signInMethod"]);if(!i||!o)return null;const d=new Sr(i,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Qo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Qo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qo(e,t)}buildRequest(){const e={requestUri:oR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ou(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function cR(n){const e=Cc(Sc(n)).link,t=e?Cc(Sc(e)).deep_link_id:null,i=Cc(Sc(n)).deep_link_id;return(i?Cc(Sc(i)).link:null)||i||t||e||n}class Hg{constructor(e){var t,i,o,c,d,f;const p=Cc(Sc(e)),g=(t=p.apiKey)!==null&&t!==void 0?t:null,y=(i=p.oobCode)!==null&&i!==void 0?i:null,N=lR((o=p.mode)!==null&&o!==void 0?o:null);we(g&&y&&N,"argument-error"),this.apiKey=g,this.operation=N,this.code=y,this.continueUrl=(c=p.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=p.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=p.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=cR(e);try{return new Hg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(){this.providerId=cl.PROVIDER_ID}static credential(e,t){return Qc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Hg.parseLink(t);return we(i,"argument-error"),Qc._fromEmailAndCode(e,i.code,i.tenantId)}}cl.PROVIDER_ID="password";cl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";cl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu extends Bg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends hu{constructor(){super("facebook.com")}static credential(e){return Sr._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.FACEBOOK_SIGN_IN_METHOD="facebook.com";mi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa extends hu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Sr._fromParams({providerId:wa.PROVIDER_ID,signInMethod:wa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wa.credentialFromTaggedObject(e)}static credentialFromError(e){return wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return wa.credential(t,i)}catch{return null}}}wa.GOOGLE_SIGN_IN_METHOD="google.com";wa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends hu{constructor(){super("github.com")}static credential(e){return Sr._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pi.credential(e.oauthAccessToken)}catch{return null}}}pi.GITHUB_SIGN_IN_METHOD="github.com";pi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends hu{constructor(){super("twitter.com")}static credential(e,t){return Sr._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return gi.credential(t,i)}catch{return null}}}gi.TWITTER_SIGN_IN_METHOD="twitter.com";gi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uR(n,e){return du(n,"POST","/v1/accounts:signUp",Oi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const c=await bs._fromIdTokenResponse(e,i,o),d=YN(i);return new Ir({user:c,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=YN(i);return new Ir({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function YN(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h extends us{constructor(e,t,i,o){var c;super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,_h.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new _h(e,t,i,o)}}function jT(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?_h._fromErrorAndOperation(n,c,e,i):c})}async function dR(n,e,t=!1){const i=await Yc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ir._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hR(n,e,t=!1){const{auth:i}=n;if(In(i.app))return Promise.reject(Ia(i));const o="reauthenticate";try{const c=await Yc(n,jT(i,o,e,n),t);we(c.idToken,i,"internal-error");const d=Fg(c.idToken);we(d,i,"internal-error");const{sub:f}=d;return we(n.uid===f,i,"user-mismatch"),Ir._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&cs(i,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AT(n,e,t=!1){if(In(n.app))return Promise.reject(Ia(n));const i="signIn",o=await jT(n,i,e),c=await Ir._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(c.user),c}async function fR(n,e){return AT(Pi(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wT(n){const e=Pi(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function mR(n,e,t){if(In(n.app))return Promise.reject(Ia(n));const i=Pi(n),d=await rg(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",uR).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&wT(n),p}),f=await Ir._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(f.user),f}function pR(n,e,t){return In(n.app)?Promise.reject(Ia(n)):fR(yt(n),cl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&wT(n),i})}function gR(n,e,t,i){return yt(n).onIdTokenChanged(e,t,i)}function vR(n,e,t){return yt(n).beforeAuthStateChanged(e,t)}function yR(n,e,t,i){return yt(n).onAuthStateChanged(e,t,i)}function xR(n){return yt(n).signOut()}const Eh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Eh,"1"),this.storage.removeItem(Eh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR=1e3,NR=10;class ST extends CT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=bT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,p)=>{this.notifyListeners(d,p)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},c=this.storage.getItem(i);VI()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,NR):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},bR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ST.type="LOCAL";const _R=ST;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT extends CT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}IT.type="SESSION";const RT=IT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new Qh(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const f=Array.from(d).map(async g=>g(t.origin,c)),p=await ER(f);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((f,p)=>{const g=Gg("",20);o.port1.start();const y=setTimeout(()=>{p(new Error("unsupported_event"))},i);d={messageChannel:o,onMessage(N){const j=N;if(j.data.eventId===g)switch(j.data.status){case"ack":clearTimeout(y),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),f(j.data.response);break;default:clearTimeout(y),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(){return window}function jR(n){Ys().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(){return typeof Ys().WorkerGlobalScope<"u"&&typeof Ys().importScripts=="function"}async function AR(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wR(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function CR(){return DT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT="firebaseLocalStorageDb",SR=1,Th="firebaseLocalStorage",OT="fbase_key";class fu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Kh(n,e){return n.transaction([Th],e?"readwrite":"readonly").objectStore(Th)}function IR(){const n=indexedDB.deleteDatabase(MT);return new fu(n).toPromise()}function og(){const n=indexedDB.open(MT,SR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Th,{keyPath:OT})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Th)?e(i):(i.close(),await IR(),e(await og()))})})}async function QN(n,e,t){const i=Kh(n,!0).put({[OT]:e,value:t});return new fu(i).toPromise()}async function RR(n,e){const t=Kh(n,!1).get(e),i=await new fu(t).toPromise();return i===void 0?null:i.value}function KN(n,e){const t=Kh(n,!0).delete(e);return new fu(t).toPromise()}const DR=800,MR=3;class kT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await og(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>MR)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return DT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qh._getInstance(CR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await AR(),!this.activeServiceWorker)return;this.sender=new TR(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await og();return await QN(e,Eh,"1"),await KN(e,Eh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>QN(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>RR(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>KN(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Kh(o,!1).getAll();return new fu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),DR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}kT.type="LOCAL";const OR=kT;new uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n,e){return e?Sa(e):(we(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g extends zg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function kR(n){return AT(n.auth,new $g(n),n.bypassAuthState)}function PR(n){const{auth:e,user:t}=n;return we(t,e,"internal-error"),hR(t,new $g(n),n.bypassAuthState)}async function LR(n){const{auth:e,user:t}=n;return we(t,e,"internal-error"),dR(t,new $g(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e,t,i,o,c=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:c,error:d,type:f}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:i,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kR;case"linkViaPopup":case"linkViaRedirect":return LR;case"reauthViaPopup":case"reauthViaRedirect":return PR;default:cs(this.auth,"internal-error")}}resolve(e){Da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VR=new uu(2e3,1e4);async function UR(n,e,t){if(In(n.app))return Promise.reject(_s(n,"operation-not-supported-in-this-environment"));const i=Pi(n);yI(n,e,Bg);const o=PT(i,t);return new jr(i,"signInViaPopup",e,o).executeNotNull()}class jr extends LT{constructor(e,t,i,o,c){super(e,t,o,c),this.provider=i,this.authWindow=null,this.pollId=null,jr.currentPopupAction&&jr.currentPopupAction.cancel(),jr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){Da(this.filter.length===1,"Popup operations only handle one event");const e=Gg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_s(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_s(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,jr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_s(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,VR.get())};e()}}jr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR="pendingRedirect",oh=new Map;class qR extends LT{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=oh.get(this.auth._key());if(!e){try{const i=await zR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}oh.set(this.auth._key(),e)}return this.bypassAuthState||oh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function zR(n,e){const t=GR(e),i=BR(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function HR(n,e){oh.set(n._key(),e)}function BR(n){return Sa(n._redirectPersistence)}function GR(n){return rh(FR,n.config.apiKey,n.name)}async function $R(n,e,t=!1){if(In(n.app))return Promise.reject(Ia(n));const i=Pi(n),o=PT(i,e),d=await new qR(i,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YR=10*60*1e3;class QR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KR(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!VT(e)){const o=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(_s(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=YR&&this.cachedEventUids.clear(),this.cachedEventUids.has(XN(e))}saveEventToCache(e){this.cachedEventUids.add(XN(e)),this.lastProcessedEventTime=Date.now()}}function XN(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function VT({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function KR(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return VT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XR(n,e={}){return ki(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ZR=/^https?/;async function JR(n){if(n.config.emulator)return;const{authorizedDomains:e}=await XR(n);for(const t of e)try{if(e1(t))return}catch{}cs(n,"unauthorized-domain")}function e1(n){const e=ag(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!ZR.test(t))return!1;if(WR.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t1=new uu(3e4,6e4);function WN(){const n=Ys().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function n1(n){return new Promise((e,t)=>{var i,o,c;function d(){WN(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{WN(),t(_s(n,"network-request-failed"))},timeout:t1.get()})}if(!((o=(i=Ys().gapi)===null||i===void 0?void 0:i.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((c=Ys().gapi)===null||c===void 0)&&c.load)d();else{const f=YI("iframefcb");return Ys()[f]=()=>{gapi.load?d():t(_s(n,"network-request-failed"))},_T(`${$I()}?onload=${f}`).catch(p=>t(p))}}).catch(e=>{throw lh=null,e})}let lh=null;function s1(n){return lh=lh||n1(n),lh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1=new uu(5e3,15e3),i1="__/auth/iframe",r1="emulator/auth/iframe",o1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},l1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function c1(n){const e=n.config;we(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ug(e,r1):`https://${n.config.authDomain}/${i1}`,i={apiKey:e.apiKey,appName:n.name,v:Vr},o=l1.get(n.config.apiHost);o&&(i.eid=o);const c=n._getFrameworks();return c.length&&(i.fw=c.join(",")),`${t}?${ou(i).slice(1)}`}async function u1(n){const e=await s1(n),t=Ys().gapi;return we(t,n,"internal-error"),e.open({where:document.body,url:c1(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:o1,dontclear:!0},i=>new Promise(async(o,c)=>{await i.restyle({setHideOnLeave:!1});const d=_s(n,"network-request-failed"),f=Ys().setTimeout(()=>{c(d)},a1.get());function p(){Ys().clearTimeout(f),o(i)}i.ping(p).then(p,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},h1=500,f1=600,m1="_blank",p1="http://localhost";class ZN{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function g1(n,e,t,i=h1,o=f1){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const p=Object.assign(Object.assign({},d1),{width:i.toString(),height:o.toString(),top:c,left:d}),g=gn().toLowerCase();t&&(f=pT(g)?m1:t),fT(g)&&(e=e||p1,p.scrollbars="yes");const y=Object.entries(p).reduce((j,[w,b])=>`${j}${w}=${b},`,"");if(LI(g)&&f!=="_self")return v1(e||"",f),new ZN(null);const N=window.open(e||"",f,y);we(N,n,"popup-blocked");try{N.focus()}catch{}return new ZN(N)}function v1(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1="__/auth/handler",x1="emulator/auth/handler",b1=encodeURIComponent("fac");async function JN(n,e,t,i,o,c){we(n.config.authDomain,n,"auth-domain-config-required"),we(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Vr,eventId:o};if(e instanceof Bg){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",tS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,N]of Object.entries({}))d[y]=N}if(e instanceof hu){const y=e.getScopes().filter(N=>N!=="");y.length>0&&(d.scopes=y.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const y of Object.keys(f))f[y]===void 0&&delete f[y];const p=await n._getAppCheckToken(),g=p?`#${b1}=${encodeURIComponent(p)}`:"";return`${N1(n)}?${ou(f).slice(1)}${g}`}function N1({config:n}){return n.emulator?Ug(n,x1):`https://${n.authDomain}/${y1}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="webStorageSupport";class _1{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=RT,this._completeRedirectFn=$R,this._overrideRedirectResult=HR}async _openPopup(e,t,i,o){var c;Da((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await JN(e,t,i,ag(),o);return g1(e,d,Gg())}async _openRedirect(e,t,i,o){await this._originValidation(e);const c=await JN(e,t,i,ag(),o);return jR(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Da(c,"If manager is not set, promise should be"),c)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await u1(e),i=new QR(e);return t.register("authEvent",o=>(we(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Lp,{type:Lp},o=>{var c;const d=(c=o?.[0])===null||c===void 0?void 0:c[Lp];d!==void 0&&t(!!d),cs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=JR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return bT()||mT()||qg()}}const E1=_1;var e_="@firebase/auth",t_="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function A1(n){ls(new $n("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=i.options;we(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const p={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:NT(n)},g=new HI(i,o,c,p);return JI(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ls(new $n("auth-internal",e=>{const t=Pi(e.getProvider("auth").getImmediate());return(i=>new T1(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pn(e_,t_,j1(n)),pn(e_,t_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w1=5*60,C1=ZE("authIdTokenMaxAge")||w1;let n_=null;const S1=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>C1)return;const o=t?.token;n_!==o&&(n_=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function I1(n=cu()){const e=ka(n,"auth");if(e.isInitialized())return e.getImmediate();const t=ZI(n,{popupRedirectResolver:E1,persistence:[OR,_R,RT]}),i=ZE("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(i,location.origin);if(location.origin===c.origin){const d=S1(c.toString());vR(t,d,()=>d(t.currentUser)),gR(t,f=>d(f))}}const o=KE("auth");return o&&eR(t,`http://${o}`),t}function R1(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}BI({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const c=_s("internal-error");c.customData=o,t(c)},i.type="text/javascript",i.charset="UTF-8",R1().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});A1("Browser");var D1="firebase",M1="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn(D1,M1,"app");var s_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ni,UT;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(L,S){function k(){}k.prototype=S.prototype,L.D=S.prototype,L.prototype=new k,L.prototype.constructor=L,L.C=function(O,C,R){for(var V=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)V[ye-2]=arguments[ye];return S.prototype[C].apply(O,V)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(L,S,k){k||(k=0);var O=Array(16);if(typeof S=="string")for(var C=0;16>C;++C)O[C]=S.charCodeAt(k++)|S.charCodeAt(k++)<<8|S.charCodeAt(k++)<<16|S.charCodeAt(k++)<<24;else for(C=0;16>C;++C)O[C]=S[k++]|S[k++]<<8|S[k++]<<16|S[k++]<<24;S=L.g[0],k=L.g[1],C=L.g[2];var R=L.g[3],V=S+(R^k&(C^R))+O[0]+3614090360&4294967295;S=k+(V<<7&4294967295|V>>>25),V=R+(C^S&(k^C))+O[1]+3905402710&4294967295,R=S+(V<<12&4294967295|V>>>20),V=C+(k^R&(S^k))+O[2]+606105819&4294967295,C=R+(V<<17&4294967295|V>>>15),V=k+(S^C&(R^S))+O[3]+3250441966&4294967295,k=C+(V<<22&4294967295|V>>>10),V=S+(R^k&(C^R))+O[4]+4118548399&4294967295,S=k+(V<<7&4294967295|V>>>25),V=R+(C^S&(k^C))+O[5]+1200080426&4294967295,R=S+(V<<12&4294967295|V>>>20),V=C+(k^R&(S^k))+O[6]+2821735955&4294967295,C=R+(V<<17&4294967295|V>>>15),V=k+(S^C&(R^S))+O[7]+4249261313&4294967295,k=C+(V<<22&4294967295|V>>>10),V=S+(R^k&(C^R))+O[8]+1770035416&4294967295,S=k+(V<<7&4294967295|V>>>25),V=R+(C^S&(k^C))+O[9]+2336552879&4294967295,R=S+(V<<12&4294967295|V>>>20),V=C+(k^R&(S^k))+O[10]+4294925233&4294967295,C=R+(V<<17&4294967295|V>>>15),V=k+(S^C&(R^S))+O[11]+2304563134&4294967295,k=C+(V<<22&4294967295|V>>>10),V=S+(R^k&(C^R))+O[12]+1804603682&4294967295,S=k+(V<<7&4294967295|V>>>25),V=R+(C^S&(k^C))+O[13]+4254626195&4294967295,R=S+(V<<12&4294967295|V>>>20),V=C+(k^R&(S^k))+O[14]+2792965006&4294967295,C=R+(V<<17&4294967295|V>>>15),V=k+(S^C&(R^S))+O[15]+1236535329&4294967295,k=C+(V<<22&4294967295|V>>>10),V=S+(C^R&(k^C))+O[1]+4129170786&4294967295,S=k+(V<<5&4294967295|V>>>27),V=R+(k^C&(S^k))+O[6]+3225465664&4294967295,R=S+(V<<9&4294967295|V>>>23),V=C+(S^k&(R^S))+O[11]+643717713&4294967295,C=R+(V<<14&4294967295|V>>>18),V=k+(R^S&(C^R))+O[0]+3921069994&4294967295,k=C+(V<<20&4294967295|V>>>12),V=S+(C^R&(k^C))+O[5]+3593408605&4294967295,S=k+(V<<5&4294967295|V>>>27),V=R+(k^C&(S^k))+O[10]+38016083&4294967295,R=S+(V<<9&4294967295|V>>>23),V=C+(S^k&(R^S))+O[15]+3634488961&4294967295,C=R+(V<<14&4294967295|V>>>18),V=k+(R^S&(C^R))+O[4]+3889429448&4294967295,k=C+(V<<20&4294967295|V>>>12),V=S+(C^R&(k^C))+O[9]+568446438&4294967295,S=k+(V<<5&4294967295|V>>>27),V=R+(k^C&(S^k))+O[14]+3275163606&4294967295,R=S+(V<<9&4294967295|V>>>23),V=C+(S^k&(R^S))+O[3]+4107603335&4294967295,C=R+(V<<14&4294967295|V>>>18),V=k+(R^S&(C^R))+O[8]+1163531501&4294967295,k=C+(V<<20&4294967295|V>>>12),V=S+(C^R&(k^C))+O[13]+2850285829&4294967295,S=k+(V<<5&4294967295|V>>>27),V=R+(k^C&(S^k))+O[2]+4243563512&4294967295,R=S+(V<<9&4294967295|V>>>23),V=C+(S^k&(R^S))+O[7]+1735328473&4294967295,C=R+(V<<14&4294967295|V>>>18),V=k+(R^S&(C^R))+O[12]+2368359562&4294967295,k=C+(V<<20&4294967295|V>>>12),V=S+(k^C^R)+O[5]+4294588738&4294967295,S=k+(V<<4&4294967295|V>>>28),V=R+(S^k^C)+O[8]+2272392833&4294967295,R=S+(V<<11&4294967295|V>>>21),V=C+(R^S^k)+O[11]+1839030562&4294967295,C=R+(V<<16&4294967295|V>>>16),V=k+(C^R^S)+O[14]+4259657740&4294967295,k=C+(V<<23&4294967295|V>>>9),V=S+(k^C^R)+O[1]+2763975236&4294967295,S=k+(V<<4&4294967295|V>>>28),V=R+(S^k^C)+O[4]+1272893353&4294967295,R=S+(V<<11&4294967295|V>>>21),V=C+(R^S^k)+O[7]+4139469664&4294967295,C=R+(V<<16&4294967295|V>>>16),V=k+(C^R^S)+O[10]+3200236656&4294967295,k=C+(V<<23&4294967295|V>>>9),V=S+(k^C^R)+O[13]+681279174&4294967295,S=k+(V<<4&4294967295|V>>>28),V=R+(S^k^C)+O[0]+3936430074&4294967295,R=S+(V<<11&4294967295|V>>>21),V=C+(R^S^k)+O[3]+3572445317&4294967295,C=R+(V<<16&4294967295|V>>>16),V=k+(C^R^S)+O[6]+76029189&4294967295,k=C+(V<<23&4294967295|V>>>9),V=S+(k^C^R)+O[9]+3654602809&4294967295,S=k+(V<<4&4294967295|V>>>28),V=R+(S^k^C)+O[12]+3873151461&4294967295,R=S+(V<<11&4294967295|V>>>21),V=C+(R^S^k)+O[15]+530742520&4294967295,C=R+(V<<16&4294967295|V>>>16),V=k+(C^R^S)+O[2]+3299628645&4294967295,k=C+(V<<23&4294967295|V>>>9),V=S+(C^(k|~R))+O[0]+4096336452&4294967295,S=k+(V<<6&4294967295|V>>>26),V=R+(k^(S|~C))+O[7]+1126891415&4294967295,R=S+(V<<10&4294967295|V>>>22),V=C+(S^(R|~k))+O[14]+2878612391&4294967295,C=R+(V<<15&4294967295|V>>>17),V=k+(R^(C|~S))+O[5]+4237533241&4294967295,k=C+(V<<21&4294967295|V>>>11),V=S+(C^(k|~R))+O[12]+1700485571&4294967295,S=k+(V<<6&4294967295|V>>>26),V=R+(k^(S|~C))+O[3]+2399980690&4294967295,R=S+(V<<10&4294967295|V>>>22),V=C+(S^(R|~k))+O[10]+4293915773&4294967295,C=R+(V<<15&4294967295|V>>>17),V=k+(R^(C|~S))+O[1]+2240044497&4294967295,k=C+(V<<21&4294967295|V>>>11),V=S+(C^(k|~R))+O[8]+1873313359&4294967295,S=k+(V<<6&4294967295|V>>>26),V=R+(k^(S|~C))+O[15]+4264355552&4294967295,R=S+(V<<10&4294967295|V>>>22),V=C+(S^(R|~k))+O[6]+2734768916&4294967295,C=R+(V<<15&4294967295|V>>>17),V=k+(R^(C|~S))+O[13]+1309151649&4294967295,k=C+(V<<21&4294967295|V>>>11),V=S+(C^(k|~R))+O[4]+4149444226&4294967295,S=k+(V<<6&4294967295|V>>>26),V=R+(k^(S|~C))+O[11]+3174756917&4294967295,R=S+(V<<10&4294967295|V>>>22),V=C+(S^(R|~k))+O[2]+718787259&4294967295,C=R+(V<<15&4294967295|V>>>17),V=k+(R^(C|~S))+O[9]+3951481745&4294967295,L.g[0]=L.g[0]+S&4294967295,L.g[1]=L.g[1]+(C+(V<<21&4294967295|V>>>11))&4294967295,L.g[2]=L.g[2]+C&4294967295,L.g[3]=L.g[3]+R&4294967295}i.prototype.u=function(L,S){S===void 0&&(S=L.length);for(var k=S-this.blockSize,O=this.B,C=this.h,R=0;R<S;){if(C==0)for(;R<=k;)o(this,L,R),R+=this.blockSize;if(typeof L=="string"){for(;R<S;)if(O[C++]=L.charCodeAt(R++),C==this.blockSize){o(this,O),C=0;break}}else for(;R<S;)if(O[C++]=L[R++],C==this.blockSize){o(this,O),C=0;break}}this.h=C,this.o+=S},i.prototype.v=function(){var L=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);L[0]=128;for(var S=1;S<L.length-8;++S)L[S]=0;var k=8*this.o;for(S=L.length-8;S<L.length;++S)L[S]=k&255,k/=256;for(this.u(L),L=Array(16),S=k=0;4>S;++S)for(var O=0;32>O;O+=8)L[k++]=this.g[S]>>>O&255;return L};function c(L,S){var k=f;return Object.prototype.hasOwnProperty.call(k,L)?k[L]:k[L]=S(L)}function d(L,S){this.h=S;for(var k=[],O=!0,C=L.length-1;0<=C;C--){var R=L[C]|0;O&&R==S||(k[C]=R,O=!1)}this.g=k}var f={};function p(L){return-128<=L&&128>L?c(L,function(S){return new d([S|0],0>S?-1:0)}):new d([L|0],0>L?-1:0)}function g(L){if(isNaN(L)||!isFinite(L))return N;if(0>L)return E(g(-L));for(var S=[],k=1,O=0;L>=k;O++)S[O]=L/k|0,k*=4294967296;return new d(S,0)}function y(L,S){if(L.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(L.charAt(0)=="-")return E(y(L.substring(1),S));if(0<=L.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=g(Math.pow(S,8)),O=N,C=0;C<L.length;C+=8){var R=Math.min(8,L.length-C),V=parseInt(L.substring(C,C+R),S);8>R?(R=g(Math.pow(S,R)),O=O.j(R).add(g(V))):(O=O.j(k),O=O.add(g(V)))}return O}var N=p(0),j=p(1),w=p(16777216);n=d.prototype,n.m=function(){if(A(this))return-E(this).m();for(var L=0,S=1,k=0;k<this.g.length;k++){var O=this.i(k);L+=(0<=O?O:4294967296+O)*S,S*=4294967296}return L},n.toString=function(L){if(L=L||10,2>L||36<L)throw Error("radix out of range: "+L);if(b(this))return"0";if(A(this))return"-"+E(this).toString(L);for(var S=g(Math.pow(L,6)),k=this,O="";;){var C=P(k,S).g;k=D(k,C.j(S));var R=((0<k.g.length?k.g[0]:k.h)>>>0).toString(L);if(k=C,b(k))return R+O;for(;6>R.length;)R="0"+R;O=R+O}},n.i=function(L){return 0>L?0:L<this.g.length?this.g[L]:this.h};function b(L){if(L.h!=0)return!1;for(var S=0;S<L.g.length;S++)if(L.g[S]!=0)return!1;return!0}function A(L){return L.h==-1}n.l=function(L){return L=D(this,L),A(L)?-1:b(L)?0:1};function E(L){for(var S=L.g.length,k=[],O=0;O<S;O++)k[O]=~L.g[O];return new d(k,~L.h).add(j)}n.abs=function(){return A(this)?E(this):this},n.add=function(L){for(var S=Math.max(this.g.length,L.g.length),k=[],O=0,C=0;C<=S;C++){var R=O+(this.i(C)&65535)+(L.i(C)&65535),V=(R>>>16)+(this.i(C)>>>16)+(L.i(C)>>>16);O=V>>>16,R&=65535,V&=65535,k[C]=V<<16|R}return new d(k,k[k.length-1]&-2147483648?-1:0)};function D(L,S){return L.add(E(S))}n.j=function(L){if(b(this)||b(L))return N;if(A(this))return A(L)?E(this).j(E(L)):E(E(this).j(L));if(A(L))return E(this.j(E(L)));if(0>this.l(w)&&0>L.l(w))return g(this.m()*L.m());for(var S=this.g.length+L.g.length,k=[],O=0;O<2*S;O++)k[O]=0;for(O=0;O<this.g.length;O++)for(var C=0;C<L.g.length;C++){var R=this.i(O)>>>16,V=this.i(O)&65535,ye=L.i(C)>>>16,Ie=L.i(C)&65535;k[2*O+2*C]+=V*Ie,q(k,2*O+2*C),k[2*O+2*C+1]+=R*Ie,q(k,2*O+2*C+1),k[2*O+2*C+1]+=V*ye,q(k,2*O+2*C+1),k[2*O+2*C+2]+=R*ye,q(k,2*O+2*C+2)}for(O=0;O<S;O++)k[O]=k[2*O+1]<<16|k[2*O];for(O=S;O<2*S;O++)k[O]=0;return new d(k,0)};function q(L,S){for(;(L[S]&65535)!=L[S];)L[S+1]+=L[S]>>>16,L[S]&=65535,S++}function U(L,S){this.g=L,this.h=S}function P(L,S){if(b(S))throw Error("division by zero");if(b(L))return new U(N,N);if(A(L))return S=P(E(L),S),new U(E(S.g),E(S.h));if(A(S))return S=P(L,E(S)),new U(E(S.g),S.h);if(30<L.g.length){if(A(L)||A(S))throw Error("slowDivide_ only works with positive integers.");for(var k=j,O=S;0>=O.l(L);)k=F(k),O=F(O);var C=$(k,1),R=$(O,1);for(O=$(O,2),k=$(k,2);!b(O);){var V=R.add(O);0>=V.l(L)&&(C=C.add(k),R=V),O=$(O,1),k=$(k,1)}return S=D(L,C.j(S)),new U(C,S)}for(C=N;0<=L.l(S);){for(k=Math.max(1,Math.floor(L.m()/S.m())),O=Math.ceil(Math.log(k)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),R=g(k),V=R.j(S);A(V)||0<V.l(L);)k-=O,R=g(k),V=R.j(S);b(R)&&(R=j),C=C.add(R),L=D(L,V)}return new U(C,L)}n.A=function(L){return P(this,L).h},n.and=function(L){for(var S=Math.max(this.g.length,L.g.length),k=[],O=0;O<S;O++)k[O]=this.i(O)&L.i(O);return new d(k,this.h&L.h)},n.or=function(L){for(var S=Math.max(this.g.length,L.g.length),k=[],O=0;O<S;O++)k[O]=this.i(O)|L.i(O);return new d(k,this.h|L.h)},n.xor=function(L){for(var S=Math.max(this.g.length,L.g.length),k=[],O=0;O<S;O++)k[O]=this.i(O)^L.i(O);return new d(k,this.h^L.h)};function F(L){for(var S=L.g.length+1,k=[],O=0;O<S;O++)k[O]=L.i(O)<<1|L.i(O-1)>>>31;return new d(k,L.h)}function $(L,S){var k=S>>5;S%=32;for(var O=L.g.length-k,C=[],R=0;R<O;R++)C[R]=0<S?L.i(R+k)>>>S|L.i(R+k+1)<<32-S:L.i(R+k);return new d(C,L.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,UT=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=g,d.fromString=y,Ni=d}).apply(typeof s_<"u"?s_:typeof self<"u"?self:typeof window<"u"?window:{});var Wd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var FT,Ic,qT,ch,lg,zT,HT,BT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,x,_){return h==Array.prototype||h==Object.prototype||(h[x]=_.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wd=="object"&&Wd];for(var x=0;x<h.length;++x){var _=h[x];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function o(h,x){if(x)e:{var _=i;h=h.split(".");for(var M=0;M<h.length-1;M++){var K=h[M];if(!(K in _))break e;_=_[K]}h=h[h.length-1],M=_[h],x=x(M),x!=M&&x!=null&&e(_,h,{configurable:!0,writable:!0,value:x})}}function c(h,x){h instanceof String&&(h+="");var _=0,M=!1,K={next:function(){if(!M&&_<h.length){var ne=_++;return{value:x(ne,h[ne]),done:!1}}return M=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}o("Array.prototype.values",function(h){return h||function(){return c(this,function(x,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function p(h){var x=typeof h;return x=x!="object"?x:h?Array.isArray(h)?"array":x:"null",x=="array"||x=="object"&&typeof h.length=="number"}function g(h){var x=typeof h;return x=="object"&&h!=null||x=="function"}function y(h,x,_){return h.call.apply(h.bind,arguments)}function N(h,x,_){if(!h)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,M),h.apply(x,K)}}return function(){return h.apply(x,arguments)}}function j(h,x,_){return j=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:N,j.apply(null,arguments)}function w(h,x){var _=Array.prototype.slice.call(arguments,1);return function(){var M=_.slice();return M.push.apply(M,arguments),h.apply(this,M)}}function b(h,x){function _(){}_.prototype=x.prototype,h.aa=x.prototype,h.prototype=new _,h.prototype.constructor=h,h.Qb=function(M,K,ne){for(var de=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)de[Ke-2]=arguments[Ke];return x.prototype[K].apply(M,de)}}function A(h){const x=h.length;if(0<x){const _=Array(x);for(let M=0;M<x;M++)_[M]=h[M];return _}return[]}function E(h,x){for(let _=1;_<arguments.length;_++){const M=arguments[_];if(p(M)){const K=h.length||0,ne=M.length||0;h.length=K+ne;for(let de=0;de<ne;de++)h[K+de]=M[de]}else h.push(M)}}class D{constructor(x,_){this.i=x,this.j=_,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function q(h){return/^[\s\xa0]*$/.test(h)}function U(){var h=f.navigator;return h&&(h=h.userAgent)?h:""}function P(h){return P[" "](h),h}P[" "]=function(){};var F=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function $(h,x,_){for(const M in h)x.call(_,h[M],M,h)}function L(h,x){for(const _ in h)x.call(void 0,h[_],_,h)}function S(h){const x={};for(const _ in h)x[_]=h[_];return x}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(h,x){let _,M;for(let K=1;K<arguments.length;K++){M=arguments[K];for(_ in M)h[_]=M[_];for(let ne=0;ne<k.length;ne++)_=k[ne],Object.prototype.hasOwnProperty.call(M,_)&&(h[_]=M[_])}}function C(h){var x=1;h=h.split(":");const _=[];for(;0<x&&h.length;)_.push(h.shift()),x--;return h.length&&_.push(h.join(":")),_}function R(h){f.setTimeout(()=>{throw h},0)}function V(){var h=Me;let x=null;return h.g&&(x=h.g,h.g=h.g.next,h.g||(h.h=null),x.next=null),x}class ye{constructor(){this.h=this.g=null}add(x,_){const M=Ie.get();M.set(x,_),this.h?this.h.next=M:this.g=M,this.h=M}}var Ie=new D(()=>new Y,h=>h.reset());class Y{constructor(){this.next=this.g=this.h=null}set(x,_){this.h=x,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let te,le=!1,Me=new ye,H=()=>{const h=f.Promise.resolve(void 0);te=()=>{h.then(ee)}};var ee=()=>{for(var h;h=V();){try{h.h.call(h.g)}catch(_){R(_)}var x=Ie;x.j(h),100>x.h&&(x.h++,h.next=x.g,x.g=h)}le=!1};function ce(){this.s=this.s,this.C=this.C}ce.prototype.s=!1,ce.prototype.ma=function(){this.s||(this.s=!0,this.N())},ce.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(h,x){this.type=h,this.g=this.target=x,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var Ne=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var h=!1,x=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};f.addEventListener("test",_,x),f.removeEventListener("test",_,x)}catch{}return h}();function ze(h,x){if(ue.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var _=this.type=h.type,M=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=x,x=h.relatedTarget){if(F){e:{try{P(x.nodeName);var K=!0;break e}catch{}K=!1}K||(x=null)}}else _=="mouseover"?x=h.fromElement:_=="mouseout"&&(x=h.toElement);this.relatedTarget=x,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Re[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&ze.aa.h.call(this)}}b(ze,ue);var Re={2:"touch",3:"pen",4:"mouse"};ze.prototype.h=function(){ze.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Bt="closure_listenable_"+(1e6*Math.random()|0),pt=0;function As(h,x,_,M,K){this.listener=h,this.proxy=null,this.src=x,this.type=_,this.capture=!!M,this.ha=K,this.key=++pt,this.da=this.fa=!1}function La(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function ea(h){this.src=h,this.g={},this.h=0}ea.prototype.add=function(h,x,_,M,K){var ne=h.toString();h=this.g[ne],h||(h=this.g[ne]=[],this.h++);var de=qi(h,x,M,K);return-1<de?(x=h[de],_||(x.fa=!1)):(x=new As(x,this.src,ne,!!M,K),x.fa=_,h.push(x)),x};function Fi(h,x){var _=x.type;if(_ in h.g){var M=h.g[_],K=Array.prototype.indexOf.call(M,x,void 0),ne;(ne=0<=K)&&Array.prototype.splice.call(M,K,1),ne&&(La(x),h.g[_].length==0&&(delete h.g[_],h.h--))}}function qi(h,x,_,M){for(var K=0;K<h.length;++K){var ne=h[K];if(!ne.da&&ne.listener==x&&ne.capture==!!_&&ne.ha==M)return K}return-1}var zi="closure_lm_"+(1e6*Math.random()|0),yl={};function Au(h,x,_,M,K){if(Array.isArray(x)){for(var ne=0;ne<x.length;ne++)Au(h,x[ne],_,M,K);return null}return _=wu(_),h&&h[Bt]?h.K(x,_,g(M)?!!M.capture:!1,K):Yn(h,x,_,!1,M,K)}function Yn(h,x,_,M,K,ne){if(!x)throw Error("Invalid event type");var de=g(K)?!!K.capture:!!K,Ke=Br(h);if(Ke||(h[zi]=Ke=new ea(h)),_=Ke.add(x,_,M,de,ne),_.proxy)return _;if(M=jf(),_.proxy=M,M.src=h,M.listener=_,h.addEventListener)Ne||(K=de),K===void 0&&(K=!1),h.addEventListener(x.toString(),M,K);else if(h.attachEvent)h.attachEvent(Hi(x.toString()),M);else if(h.addListener&&h.removeListener)h.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return _}function jf(){function h(_){return x.call(h.src,h.listener,_)}const x=Af;return h}function xl(h,x,_,M,K){if(Array.isArray(x))for(var ne=0;ne<x.length;ne++)xl(h,x[ne],_,M,K);else M=g(M)?!!M.capture:!!M,_=wu(_),h&&h[Bt]?(h=h.i,x=String(x).toString(),x in h.g&&(ne=h.g[x],_=qi(ne,_,M,K),-1<_&&(La(ne[_]),Array.prototype.splice.call(ne,_,1),ne.length==0&&(delete h.g[x],h.h--)))):h&&(h=Br(h))&&(x=h.g[x.toString()],h=-1,x&&(h=qi(x,_,M,K)),(_=-1<h?x[h]:null)&&Hr(_))}function Hr(h){if(typeof h!="number"&&h&&!h.da){var x=h.src;if(x&&x[Bt])Fi(x.i,h);else{var _=h.type,M=h.proxy;x.removeEventListener?x.removeEventListener(_,M,h.capture):x.detachEvent?x.detachEvent(Hi(_),M):x.addListener&&x.removeListener&&x.removeListener(M),(_=Br(x))?(Fi(_,h),_.h==0&&(_.src=null,x[zi]=null)):La(h)}}}function Hi(h){return h in yl?yl[h]:yl[h]="on"+h}function Af(h,x){if(h.da)h=!0;else{x=new ze(x,this);var _=h.listener,M=h.ha||h.src;h.fa&&Hr(h),h=_.call(M,x)}return h}function Br(h){return h=h[zi],h instanceof ea?h:null}var bl="__closure_events_fn_"+(1e9*Math.random()>>>0);function wu(h){return typeof h=="function"?h:(h[bl]||(h[bl]=function(x){return h.handleEvent(x)}),h[bl])}function Et(){ce.call(this),this.i=new ea(this),this.M=this,this.F=null}b(Et,ce),Et.prototype[Bt]=!0,Et.prototype.removeEventListener=function(h,x,_,M){xl(this,h,x,_,M)};function at(h,x){var _,M=h.F;if(M)for(_=[];M;M=M.F)_.push(M);if(h=h.M,M=x.type||x,typeof x=="string")x=new ue(x,h);else if(x instanceof ue)x.target=x.target||h;else{var K=x;x=new ue(M,h),O(x,K)}if(K=!0,_)for(var ne=_.length-1;0<=ne;ne--){var de=x.g=_[ne];K=Mn(de,M,!0,x)&&K}if(de=x.g=h,K=Mn(de,M,!0,x)&&K,K=Mn(de,M,!1,x)&&K,_)for(ne=0;ne<_.length;ne++)de=x.g=_[ne],K=Mn(de,M,!1,x)&&K}Et.prototype.N=function(){if(Et.aa.N.call(this),this.i){var h=this.i,x;for(x in h.g){for(var _=h.g[x],M=0;M<_.length;M++)La(_[M]);delete h.g[x],h.h--}}this.F=null},Et.prototype.K=function(h,x,_,M){return this.i.add(String(h),x,!1,_,M)},Et.prototype.L=function(h,x,_,M){return this.i.add(String(h),x,!0,_,M)};function Mn(h,x,_,M){if(x=h.i.g[String(x)],!x)return!0;x=x.concat();for(var K=!0,ne=0;ne<x.length;++ne){var de=x[ne];if(de&&!de.da&&de.capture==_){var Ke=de.listener,Lt=de.ha||de.src;de.fa&&Fi(h.i,de),K=Ke.call(Lt,M)!==!1&&K}}return K&&!M.defaultPrevented}function cn(h,x,_){if(typeof h=="function")_&&(h=j(h,_));else if(h&&typeof h.handleEvent=="function")h=j(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:f.setTimeout(h,x||0)}function Cu(h){h.g=cn(()=>{h.g=null,h.i&&(h.i=!1,Cu(h))},h.l);const x=h.h;h.h=null,h.m.apply(null,x)}class wf extends ce{constructor(x,_){super(),this.m=x,this.l=_,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:Cu(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bi(h){ce.call(this),this.h=h,this.g={}}b(Bi,ce);var Gi=[];function $i(h){$(h.g,function(x,_){this.g.hasOwnProperty(_)&&Hr(x)},h),h.g={}}Bi.prototype.N=function(){Bi.aa.N.call(this),$i(this)},Bi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ds=f.JSON.stringify,Gr=f.JSON.parse,Yi=class{stringify(h){return f.JSON.stringify(h,void 0)}parse(h){return f.JSON.parse(h,void 0)}};function Nl(){}Nl.prototype.h=null;function _l(h){return h.h||(h.h=h.i())}function El(){}var ta={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function na(){ue.call(this,"d")}b(na,ue);function Tl(){ue.call(this,"c")}b(Tl,ue);var ws={},jl=null;function Va(){return jl=jl||new Et}ws.La="serverreachability";function $r(h){ue.call(this,ws.La,h)}b($r,ue);function Ua(h){const x=Va();at(x,new $r(x))}ws.STAT_EVENT="statevent";function Su(h,x){ue.call(this,ws.STAT_EVENT,h),this.stat=x}b(Su,ue);function xt(h){const x=Va();at(x,new Su(x,h))}ws.Ma="timingevent";function Pt(h,x){ue.call(this,ws.Ma,h),this.size=x}b(Pt,ue);function It(h,x){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){h()},x)}function Qn(){this.g=!0}Qn.prototype.xa=function(){this.g=!1};function Al(h,x,_,M,K,ne){h.info(function(){if(h.g)if(ne)for(var de="",Ke=ne.split("&"),Lt=0;Lt<Ke.length;Lt++){var Xe=Ke[Lt].split("=");if(1<Xe.length){var $t=Xe[0];Xe=Xe[1];var Vt=$t.split("_");de=2<=Vt.length&&Vt[1]=="type"?de+($t+"="+Xe+"&"):de+($t+"=redacted&")}}else de=null;else de=ne;return"XMLHTTP REQ ("+M+") [attempt "+K+"]: "+x+`
`+_+`
`+de})}function Cf(h,x,_,M,K,ne,de){h.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+K+"]: "+x+`
`+_+`
`+ne+" "+de})}function Fa(h,x,_,M){h.info(function(){return"XMLHTTP TEXT ("+x+"): "+Qi(h,_)+(M?" "+M:"")})}function Iu(h,x){h.info(function(){return"TIMEOUT: "+x})}Qn.prototype.info=function(){};function Qi(h,x){if(!h.g)return x;if(!x)return null;try{var _=JSON.parse(x);if(_){for(h=0;h<_.length;h++)if(Array.isArray(_[h])){var M=_[h];if(!(2>M.length)){var K=M[1];if(Array.isArray(K)&&!(1>K.length)){var ne=K[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(var de=1;de<K.length;de++)K[de]=""}}}}return ds(_)}catch{return x}}var qa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},sa={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Cs;function Ss(){}b(Ss,Nl),Ss.prototype.g=function(){return new XMLHttpRequest},Ss.prototype.i=function(){return{}},Cs=new Ss;function vn(h,x,_,M){this.j=h,this.i=x,this.l=_,this.R=M||1,this.U=new Bi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new At}function At(){this.i=null,this.g="",this.h=!1}var wl={},Yr={};function hs(h,x,_){h.L=1,h.v=Ji(On(x)),h.m=_,h.P=!0,aa(h,null)}function aa(h,x){h.F=Date.now(),Ki(h),h.A=On(h.v);var _=h.A,M=h.R;Array.isArray(M)||(M=[String(M)]),Ml(_.i,"t",M),h.C=0,_=h.j.J,h.h=new At,h.g=$u(h.j,_?x:null,!h.m),0<h.O&&(h.M=new wf(j(h.Y,h,h.g),h.O)),x=h.U,_=h.g,M=h.ca;var K="readystatechange";Array.isArray(K)||(K&&(Gi[0]=K.toString()),K=Gi);for(var ne=0;ne<K.length;ne++){var de=Au(_,K[ne],M||x.handleEvent,!1,x.h||x);if(!de)break;x.g[de.key]=de}x=h.H?S(h.H):{},h.m?(h.u||(h.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,x)):(h.u="GET",h.g.ea(h.A,h.u,null,x)),Ua(),Al(h.i,h.u,h.A,h.l,h.R,h.m)}vn.prototype.ca=function(h){h=h.target;const x=this.M;x&&Zn(h)==3?x.j():this.Y(h)},vn.prototype.Y=function(h){try{if(h==this.g)e:{const Vt=Zn(this.g);var x=this.g.Ba();const ha=this.g.Z();if(!(3>Vt)&&(Vt!=3||this.g&&(this.h.h||this.g.oa()||Vu(this.g)))){this.J||Vt!=4||x==7||(x==8||0>=ha?Ua(3):Ua(2)),za(this);var _=this.g.Z();this.X=_;t:if(Ru(this)){var M=Vu(this.g);h="";var K=M.length,ne=Zn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zt(this),Is(this);var de="";break t}this.h.i=new f.TextDecoder}for(x=0;x<K;x++)this.h.h=!0,h+=this.h.i.decode(M[x],{stream:!(ne&&x==K-1)});M.length=0,this.h.g+=h,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=_==200,Cf(this.i,this.u,this.A,this.l,this.R,Vt,_),this.o){if(this.T&&!this.K){t:{if(this.g){var Ke,Lt=this.g;if((Ke=Lt.g?Lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(Ke)){var Xe=Ke;break t}}Xe=null}if(_=Xe)Fa(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xi(this,_);else{this.o=!1,this.s=3,xt(12),Zt(this),Is(this);break e}}if(this.P){_=!0;let Jt;for(;!this.J&&this.C<de.length;)if(Jt=Du(this,de),Jt==Yr){Vt==4&&(this.s=4,xt(14),_=!1),Fa(this.i,this.l,null,"[Incomplete Response]");break}else if(Jt==wl){this.s=4,xt(15),Fa(this.i,this.l,de,"[Invalid Chunk]"),_=!1;break}else Fa(this.i,this.l,Jt,null),Xi(this,Jt);if(Ru(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vt!=4||de.length!=0||this.h.h||(this.s=1,xt(16),_=!1),this.o=this.o&&_,!_)Fa(this.i,this.l,de,"[Invalid Chunked Response]"),Zt(this),Is(this);else if(0<de.length&&!this.W){this.W=!0;var $t=this.j;$t.g==this&&$t.ba&&!$t.M&&($t.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),or($t),$t.M=!0,xt(11))}}else Fa(this.i,this.l,de,null),Xi(this,de);Vt==4&&Zt(this),this.o&&!this.J&&(Vt==4?Hu(this.j,this):(this.o=!1,Ki(this)))}else Mf(this.g),_==400&&0<de.indexOf("Unknown SID")?(this.s=3,xt(12)):(this.s=0,xt(13)),Zt(this),Is(this)}}}catch{}finally{}};function Ru(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Du(h,x){var _=h.C,M=x.indexOf(`
`,_);return M==-1?Yr:(_=Number(x.substring(_,M)),isNaN(_)?wl:(M+=1,M+_>x.length?Yr:(x=x.slice(M,M+_),h.C=M+_,x)))}vn.prototype.cancel=function(){this.J=!0,Zt(this)};function Ki(h){h.S=Date.now()+h.I,Mu(h,h.I)}function Mu(h,x){if(h.B!=null)throw Error("WatchDog timer not null");h.B=It(j(h.ba,h),x)}function za(h){h.B&&(f.clearTimeout(h.B),h.B=null)}vn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Iu(this.i,this.A),this.L!=2&&(Ua(),xt(17)),Zt(this),this.s=2,Is(this)):Mu(this,this.S-h)};function Is(h){h.j.G==0||h.J||Hu(h.j,h)}function Zt(h){za(h);var x=h.M;x&&typeof x.ma=="function"&&x.ma(),h.M=null,$i(h.U),h.g&&(x=h.g,h.g=null,x.abort(),x.ma())}function Xi(h,x){try{var _=h.j;if(_.G!=0&&(_.g==h||Cl(_.h,h))){if(!h.K&&Cl(_.h,h)&&_.G==3){try{var M=_.Da.g.parse(x)}catch{M=null}if(Array.isArray(M)&&M.length==3){var K=M;if(K[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<h.F)io(_),so(_);else break e;Vl(_),xt(18)}}else _.za=K[1],0<_.za-_.T&&37500>K[2]&&_.F&&_.v==0&&!_.C&&(_.C=It(j(_.Za,_),6e3));if(1>=Kr(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else da(_,11)}else if((h.K||_.g==h)&&io(_),!q(x))for(K=_.Da.g.parse(x),x=0;x<K.length;x++){let Xe=K[x];if(_.T=Xe[0],Xe=Xe[1],_.G==2)if(Xe[0]=="c"){_.K=Xe[1],_.ia=Xe[2];const $t=Xe[3];$t!=null&&(_.la=$t,_.j.info("VER="+_.la));const Vt=Xe[4];Vt!=null&&(_.Aa=Vt,_.j.info("SVER="+_.Aa));const ha=Xe[5];ha!=null&&typeof ha=="number"&&0<ha&&(M=1.5*ha,_.L=M,_.j.info("backChannelRequestTimeoutMs_="+M)),M=_;const Jt=h.g;if(Jt){const Ls=Jt.g?Jt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ls){var ne=M.h;ne.g||Ls.indexOf("spdy")==-1&&Ls.indexOf("quic")==-1&&Ls.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(Xr(ne,ne.h),ne.h=null))}if(M.D){const Fl=Jt.g?Jt.g.getResponseHeader("X-HTTP-Session-Id"):null;Fl&&(M.ya=Fl,ot(M.I,M.D,Fl))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-h.F,_.j.info("Handshake RTT: "+_.R+"ms")),M=_;var de=h;if(M.qa=Gu(M,M.J?M.ia:null,M.W),de.K){yn(M.h,de);var Ke=de,Lt=M.L;Lt&&(Ke.I=Lt),Ke.B&&(za(Ke),Ki(Ke)),M.g=de}else qu(M);0<_.i.length&&ao(_)}else Xe[0]!="stop"&&Xe[0]!="close"||da(_,7);else _.G==3&&(Xe[0]=="stop"||Xe[0]=="close"?Xe[0]=="stop"?da(_,7):Pl(_):Xe[0]!="noop"&&_.l&&_.l.ta(Xe),_.v=0)}}Ua(4)}catch{}}var Ou=class{constructor(h,x){this.g=h,this.map=x}};function ia(h){this.l=h||10,f.PerformanceNavigationTiming?(h=f.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Kr(h){return h.h?1:h.g?h.g.size:0}function Cl(h,x){return h.h?h.h==x:h.g?h.g.has(x):!1}function Xr(h,x){h.g?h.g.add(x):h.h=x}function yn(h,x){h.h&&h.h==x?h.h=null:h.g&&h.g.has(x)&&h.g.delete(x)}ia.prototype.cancel=function(){if(this.i=Sl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Sl(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let x=h.i;for(const _ of h.g.values())x=x.concat(_.D);return x}return A(h.i)}function Sf(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var x=[],_=h.length,M=0;M<_;M++)x.push(h[M]);return x}x=[],_=0;for(M in h)x[_++]=h[M];return x}function Wr(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var x=[];h=h.length;for(var _=0;_<h;_++)x.push(_);return x}x=[],_=0;for(const M in h)x[_++]=M;return x}}}function Il(h,x){if(h.forEach&&typeof h.forEach=="function")h.forEach(x,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,x,void 0);else for(var _=Wr(h),M=Sf(h),K=M.length,ne=0;ne<K;ne++)x.call(void 0,M[ne],_&&_[ne],h)}var Wi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function If(h,x){if(h){h=h.split("&");for(var _=0;_<h.length;_++){var M=h[_].indexOf("="),K=null;if(0<=M){var ne=h[_].substring(0,M);K=h[_].substring(M+1)}else ne=h[_];x(ne,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Rt(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Rt){this.h=h.h,Zi(this,h.j),this.o=h.o,this.g=h.g,Ha(this,h.s),this.l=h.l;var x=h.i,_=new oa;_.i=x.i,x.g&&(_.g=new Map(x.g),_.h=x.h),ra(this,_),this.m=h.m}else h&&(x=String(h).match(Wi))?(this.h=!1,Zi(this,x[1]||"",!0),this.o=Kn(x[2]||""),this.g=Kn(x[3]||"",!0),Ha(this,x[4]),this.l=Kn(x[5]||"",!0),ra(this,x[6]||"",!0),this.m=Kn(x[7]||"")):(this.h=!1,this.i=new oa(null,this.h))}Rt.prototype.toString=function(){var h=[],x=this.j;x&&h.push(er(x,Rl,!0),":");var _=this.g;return(_||x=="file")&&(h.push("//"),(x=this.o)&&h.push(er(x,Rl,!0),"@"),h.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&h.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(er(_,_.charAt(0)=="/"?Rf:Dl,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",er(_,Zr)),h.join("")};function On(h){return new Rt(h)}function Zi(h,x,_){h.j=_?Kn(x,!0):x,h.j&&(h.j=h.j.replace(/:$/,""))}function Ha(h,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);h.s=x}else h.s=null}function ra(h,x,_){x instanceof oa?(h.i=x,Pu(h.i,h.h)):(_||(x=er(x,Df)),h.i=new oa(x,h.h))}function ot(h,x,_){h.i.set(x,_)}function Ji(h){return ot(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Kn(h,x){return h?x?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function er(h,x,_){return typeof h=="string"?(h=encodeURI(h).replace(x,ku),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function ku(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Rl=/[#\/\?@]/g,Dl=/[#\?:]/g,Rf=/[#\?]/g,Df=/[#\?@]/g,Zr=/#/g;function oa(h,x){this.h=this.g=null,this.i=h||null,this.j=!!x}function Xn(h){h.g||(h.g=new Map,h.h=0,h.i&&If(h.i,function(x,_){h.add(decodeURIComponent(x.replace(/\+/g," ")),_)}))}n=oa.prototype,n.add=function(h,x){Xn(this),this.i=null,h=Rs(this,h);var _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(x),this.h+=1,this};function la(h,x){Xn(h),x=Rs(h,x),h.g.has(x)&&(h.i=null,h.h-=h.g.get(x).length,h.g.delete(x))}function ca(h,x){return Xn(h),x=Rs(h,x),h.g.has(x)}n.forEach=function(h,x){Xn(this),this.g.forEach(function(_,M){_.forEach(function(K){h.call(x,K,M,this)},this)},this)},n.na=function(){Xn(this);const h=Array.from(this.g.values()),x=Array.from(this.g.keys()),_=[];for(let M=0;M<x.length;M++){const K=h[M];for(let ne=0;ne<K.length;ne++)_.push(x[M])}return _},n.V=function(h){Xn(this);let x=[];if(typeof h=="string")ca(this,h)&&(x=x.concat(this.g.get(Rs(this,h))));else{h=Array.from(this.g.values());for(let _=0;_<h.length;_++)x=x.concat(h[_])}return x},n.set=function(h,x){return Xn(this),this.i=null,h=Rs(this,h),ca(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[x]),this.h+=1,this},n.get=function(h,x){return h?(h=this.V(h),0<h.length?String(h[0]):x):x};function Ml(h,x,_){la(h,x),0<_.length&&(h.i=null,h.g.set(Rs(h,x),A(_)),h.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],x=Array.from(this.g.keys());for(var _=0;_<x.length;_++){var M=x[_];const ne=encodeURIComponent(String(M)),de=this.V(M);for(M=0;M<de.length;M++){var K=ne;de[M]!==""&&(K+="="+encodeURIComponent(String(de[M]))),h.push(K)}}return this.i=h.join("&")};function Rs(h,x){return x=String(x),h.j&&(x=x.toLowerCase()),x}function Pu(h,x){x&&!h.j&&(Xn(h),h.i=null,h.g.forEach(function(_,M){var K=M.toLowerCase();M!=K&&(la(this,M),Ml(this,K,_))},h)),h.j=x}function tr(h,x){const _=new Qn;if(f.Image){const M=new Image;M.onload=w(Wn,_,"TestLoadImage: loaded",!0,x,M),M.onerror=w(Wn,_,"TestLoadImage: error",!1,x,M),M.onabort=w(Wn,_,"TestLoadImage: abort",!1,x,M),M.ontimeout=w(Wn,_,"TestLoadImage: timeout",!1,x,M),f.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=h}else x(!1)}function fs(h,x){const _=new Qn,M=new AbortController,K=setTimeout(()=>{M.abort(),Wn(_,"TestPingServer: timeout",!1,x)},1e4);fetch(h,{signal:M.signal}).then(ne=>{clearTimeout(K),ne.ok?Wn(_,"TestPingServer: ok",!0,x):Wn(_,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(K),Wn(_,"TestPingServer: error",!1,x)})}function Wn(h,x,_,M,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),M(_)}catch{}}function nr(){this.g=new Yi}function Ds(h,x,_){const M=_||"";try{Il(h,function(K,ne){let de=K;g(K)&&(de=ds(K)),x.push(M+ne+"="+encodeURIComponent(de))})}catch(K){throw x.push(M+"type="+encodeURIComponent("_badmap")),K}}function Ba(h){this.l=h.Ub||null,this.j=h.eb||!1}b(Ba,Nl),Ba.prototype.g=function(){return new ua(this.l,this.j)},Ba.prototype.i=function(h){return function(){return h}}({});function ua(h,x){Et.call(this),this.D=h,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(ua,Et),n=ua.prototype,n.open=function(h,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=x,this.readyState=1,Os(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(x.body=h),(this.D||f).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ms(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Os(this)),this.g&&(this.readyState=3,Os(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ol(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ol(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var x=h.value?h.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!h.done}))&&(this.response=this.responseText+=x)}h.done?Ms(this):Os(this),this.readyState==3&&Ol(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Ms(this))},n.Qa=function(h){this.g&&(this.response=h,Ms(this))},n.ga=function(){this.g&&Ms(this)};function Ms(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Os(h)}n.setRequestHeader=function(h,x){this.u.append(h,x)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],x=this.h.entries();for(var _=x.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=x.next();return h.join(`\r
`)};function Os(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(ua.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function kl(h){let x="";return $(h,function(_,M){x+=M,x+=":",x+=_,x+=`\r
`}),x}function Gt(h,x,_){e:{for(M in _){var M=!1;break e}M=!0}M||(_=kl(_),typeof h=="string"?_!=null&&encodeURIComponent(String(_)):ot(h,x,_))}function st(h){Et.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(st,Et);var Jr=/^https?$/i,sr=["POST","PUT"];n=st.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,x,_,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);x=x?x.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Cs.g(),this.v=this.o?_l(this.o):_l(Cs),this.g.onreadystatechange=j(this.Ea,this);try{this.B=!0,this.g.open(x,String(h),!0),this.B=!1}catch(ne){Lu(this,ne);return}if(h=_||"",_=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var K in M)_.set(K,M[K]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const ne of M.keys())_.set(ne,M.get(ne));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(_.keys()).find(ne=>ne.toLowerCase()=="content-type"),K=f.FormData&&h instanceof f.FormData,!(0<=Array.prototype.indexOf.call(sr,x,void 0))||M||K||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,de]of _)this.g.setRequestHeader(ne,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ar(this),this.u=!0,this.g.send(h),this.u=!1}catch(ne){Lu(this,ne)}};function Lu(h,x){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=x,h.m=5,eo(h),ks(h)}function eo(h){h.A||(h.A=!0,at(h,"complete"),at(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,at(this,"complete"),at(this,"abort"),ks(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ks(this,!0)),st.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?to(this):this.bb())},n.bb=function(){to(this)};function to(h){if(h.h&&typeof d<"u"&&(!h.v[1]||Zn(h)!=4||h.Z()!=2)){if(h.u&&Zn(h)==4)cn(h.Ea,0,h);else if(at(h,"readystatechange"),Zn(h)==4){h.h=!1;try{const de=h.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var _;if(!(_=x)){var M;if(M=de===0){var K=String(h.D).match(Wi)[1]||null;!K&&f.self&&f.self.location&&(K=f.self.location.protocol.slice(0,-1)),M=!Jr.test(K?K.toLowerCase():"")}_=M}if(_)at(h,"complete"),at(h,"success");else{h.m=6;try{var ne=2<Zn(h)?h.g.statusText:""}catch{ne=""}h.l=ne+" ["+h.Z()+"]",eo(h)}}finally{ks(h)}}}}function ks(h,x){if(h.g){ar(h);const _=h.g,M=h.v[0]?()=>{}:null;h.g=null,h.v=null,x||at(h,"ready");try{_.onreadystatechange=M}catch{}}}function ar(h){h.I&&(f.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function Zn(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<Zn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var x=this.g.responseText;return h&&x.indexOf(h)==0&&(x=x.substring(h.length)),Gr(x)}};function Vu(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Mf(h){const x={};h=(h.g&&2<=Zn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<h.length;M++){if(q(h[M]))continue;var _=C(h[M]);const K=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const ne=x[K]||[];x[K]=ne,ne.push(_)}L(x,function(M){return M.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ir(h,x,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||x}function no(h){this.Aa=0,this.i=[],this.j=new Qn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ir("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ir("baseRetryDelayMs",5e3,h),this.cb=ir("retryDelaySeedMs",1e4,h),this.Wa=ir("forwardChannelMaxRetries",2,h),this.wa=ir("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ia(h&&h.concurrentRequestLimit),this.Da=new nr,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=no.prototype,n.la=8,n.G=1,n.connect=function(h,x,_,M){xt(0),this.W=h,this.H=x||{},_&&M!==void 0&&(this.H.OSID=_,this.H.OAID=M),this.F=this.X,this.I=Gu(this,null,this.W),ao(this)};function Pl(h){if(Uu(h),h.G==3){var x=h.U++,_=On(h.I);if(ot(_,"SID",h.K),ot(_,"RID",x),ot(_,"TYPE","terminate"),rr(h,_),x=new vn(h,h.j,x),x.L=2,x.v=Ji(On(_)),_=!1,f.navigator&&f.navigator.sendBeacon)try{_=f.navigator.sendBeacon(x.v.toString(),"")}catch{}!_&&f.Image&&(new Image().src=x.v,_=!0),_||(x.g=$u(x.j,null),x.g.ea(x.v)),x.F=Date.now(),Ki(x)}Bu(h)}function so(h){h.g&&(or(h),h.g.cancel(),h.g=null)}function Uu(h){so(h),h.u&&(f.clearTimeout(h.u),h.u=null),io(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&f.clearTimeout(h.s),h.s=null)}function ao(h){if(!Qr(h.h)&&!h.s){h.s=!0;var x=h.Ga;te||H(),le||(te(),le=!0),Me.add(x,h),h.B=0}}function Of(h,x){return Kr(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=x.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=It(j(h.Ga,h,x),Ul(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const K=new vn(this,this.j,h);let ne=this.o;if(this.S&&(ne?(ne=S(ne),O(ne,this.S)):ne=this.S),this.m!==null||this.O||(K.H=ne,ne=null),this.P)e:{for(var x=0,_=0;_<this.i.length;_++){t:{var M=this.i[_];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(x+=M,4096<x){x=_;break e}if(x===4096||_===this.i.length-1){x=_+1;break e}}x=1e3}else x=1e3;x=Fu(this,K,x),_=On(this.I),ot(_,"RID",h),ot(_,"CVER",22),this.D&&ot(_,"X-HTTP-Session-Id",this.D),rr(this,_),ne&&(this.O?x="headers="+encodeURIComponent(String(kl(ne)))+"&"+x:this.m&&Gt(_,this.m,ne)),Xr(this.h,K),this.Ua&&ot(_,"TYPE","init"),this.P?(ot(_,"$req",x),ot(_,"SID","null"),K.T=!0,hs(K,_,null)):hs(K,_,x),this.G=2}}else this.G==3&&(h?Ll(this,h):this.i.length==0||Qr(this.h)||Ll(this))};function Ll(h,x){var _;x?_=x.l:_=h.U++;const M=On(h.I);ot(M,"SID",h.K),ot(M,"RID",_),ot(M,"AID",h.T),rr(h,M),h.m&&h.o&&Gt(M,h.m,h.o),_=new vn(h,h.j,_,h.B+1),h.m===null&&(_.H=h.o),x&&(h.i=x.D.concat(h.i)),x=Fu(h,_,1e3),_.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Xr(h.h,_),hs(_,M,x)}function rr(h,x){h.H&&$(h.H,function(_,M){ot(x,M,_)}),h.l&&Il({},function(_,M){ot(x,M,_)})}function Fu(h,x,_){_=Math.min(h.i.length,_);var M=h.l?j(h.l.Na,h.l,h):null;e:{var K=h.i;let ne=-1;for(;;){const de=["count="+_];ne==-1?0<_?(ne=K[0].g,de.push("ofs="+ne)):ne=0:de.push("ofs="+ne);let Ke=!0;for(let Lt=0;Lt<_;Lt++){let Xe=K[Lt].g;const $t=K[Lt].map;if(Xe-=ne,0>Xe)ne=Math.max(0,K[Lt].g-100),Ke=!1;else try{Ds($t,de,"req"+Xe+"_")}catch{M&&M($t)}}if(Ke){M=de.join("&");break e}}}return h=h.i.splice(0,_),x.D=h,M}function qu(h){if(!h.g&&!h.u){h.Y=1;var x=h.Fa;te||H(),le||(te(),le=!0),Me.add(x,h),h.v=0}}function Vl(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=It(j(h.Fa,h),Ul(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,zu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=It(j(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,xt(10),so(this),zu(this))};function or(h){h.A!=null&&(f.clearTimeout(h.A),h.A=null)}function zu(h){h.g=new vn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var x=On(h.qa);ot(x,"RID","rpc"),ot(x,"SID",h.K),ot(x,"AID",h.T),ot(x,"CI",h.F?"0":"1"),!h.F&&h.ja&&ot(x,"TO",h.ja),ot(x,"TYPE","xmlhttp"),rr(h,x),h.m&&h.o&&Gt(x,h.m,h.o),h.L&&(h.g.I=h.L);var _=h.g;h=h.ia,_.L=1,_.v=Ji(On(x)),_.m=null,_.P=!0,aa(_,h)}n.Za=function(){this.C!=null&&(this.C=null,so(this),Vl(this),xt(19))};function io(h){h.C!=null&&(f.clearTimeout(h.C),h.C=null)}function Hu(h,x){var _=null;if(h.g==x){io(h),or(h),h.g=null;var M=2}else if(Cl(h.h,x))_=x.D,yn(h.h,x),M=1;else return;if(h.G!=0){if(x.o)if(M==1){_=x.m?x.m.length:0,x=Date.now()-x.F;var K=h.B;M=Va(),at(M,new Pt(M,_)),ao(h)}else qu(h);else if(K=x.s,K==3||K==0&&0<x.X||!(M==1&&Of(h,x)||M==2&&Vl(h)))switch(_&&0<_.length&&(x=h.h,x.i=x.i.concat(_)),K){case 1:da(h,5);break;case 4:da(h,10);break;case 3:da(h,6);break;default:da(h,2)}}}function Ul(h,x){let _=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(_*=2),_*x}function da(h,x){if(h.j.info("Error code "+x),x==2){var _=j(h.fb,h),M=h.Xa;const K=!M;M=new Rt(M||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||Zi(M,"https"),Ji(M),K?tr(M.toString(),_):fs(M.toString(),_)}else xt(2);h.G=0,h.l&&h.l.sa(x),Bu(h),Uu(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),xt(2)):(this.j.info("Failed to ping google.com"),xt(1))};function Bu(h){if(h.G=0,h.ka=[],h.l){const x=Sl(h.h);(x.length!=0||h.i.length!=0)&&(E(h.ka,x),E(h.ka,h.i),h.h.i.length=0,A(h.i),h.i.length=0),h.l.ra()}}function Gu(h,x,_){var M=_ instanceof Rt?On(_):new Rt(_);if(M.g!="")x&&(M.g=x+"."+M.g),Ha(M,M.s);else{var K=f.location;M=K.protocol,x=x?x+"."+K.hostname:K.hostname,K=+K.port;var ne=new Rt(null);M&&Zi(ne,M),x&&(ne.g=x),K&&Ha(ne,K),_&&(ne.l=_),M=ne}return _=h.D,x=h.ya,_&&x&&ot(M,_,x),ot(M,"VER",h.la),rr(h,M),M}function $u(h,x,_){if(x&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=h.Ca&&!h.pa?new st(new Ba({eb:_})):new st(h.pa),x.Ha(h.J),x}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yu(){}n=Yu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ro(){}ro.prototype.g=function(h,x){return new xn(h,x)};function xn(h,x){Et.call(this),this.g=new no(x),this.l=h,this.h=x&&x.messageUrlParams||null,h=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(h?h["X-WebChannel-Content-Type"]=x.messageContentType:h={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(h?h["X-WebChannel-Client-Profile"]=x.va:h={"X-WebChannel-Client-Profile":x.va}),this.g.S=h,(h=x&&x.Sb)&&!q(h)&&(this.g.m=h),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!q(x)&&(this.g.D=x,h=this.h,h!==null&&x in h&&(h=this.h,x in h&&delete h[x])),this.j=new Ps(this)}b(xn,Et),xn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){Pl(this.g)},xn.prototype.o=function(h){var x=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.u&&(_={},_.__data__=ds(h),h=_);x.i.push(new Ou(x.Ya++,h)),x.G==3&&ao(x)},xn.prototype.N=function(){this.g.l=null,delete this.j,Pl(this.g),delete this.g,xn.aa.N.call(this)};function Qu(h){na.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var x=h.__sm__;if(x){e:{for(const _ in x){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,x=x!==null&&h in x?x[h]:void 0),this.data=x}else this.data=h}b(Qu,na);function Ku(){Tl.call(this),this.status=1}b(Ku,Tl);function Ps(h){this.g=h}b(Ps,Yu),Ps.prototype.ua=function(){at(this.g,"a")},Ps.prototype.ta=function(h){at(this.g,new Qu(h))},Ps.prototype.sa=function(h){at(this.g,new Ku)},Ps.prototype.ra=function(){at(this.g,"b")},ro.prototype.createWebChannel=ro.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,BT=function(){return new ro},HT=function(){return Va()},zT=ws,lg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qa.NO_ERROR=0,qa.TIMEOUT=8,qa.HTTP_ERROR=6,ch=qa,sa.COMPLETE="complete",qT=sa,El.EventType=ta,ta.OPEN="a",ta.CLOSE="b",ta.ERROR="c",ta.MESSAGE="d",Et.prototype.listen=Et.prototype.K,Ic=El,st.prototype.listenOnce=st.prototype.L,st.prototype.getLastError=st.prototype.Ka,st.prototype.getLastErrorCode=st.prototype.Ba,st.prototype.getStatus=st.prototype.Z,st.prototype.getResponseJson=st.prototype.Oa,st.prototype.getResponseText=st.prototype.oa,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Ha,FT=st}).apply(typeof Wd<"u"?Wd:typeof self<"u"?self:typeof window<"u"?window:{});const a_="@firebase/firestore",i_="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ul="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr=new lu("@firebase/firestore");function Vo(){return Rr.logLevel}function ge(n,...e){if(Rr.logLevel<=$e.DEBUG){const t=e.map(Yg);Rr.debug(`Firestore (${ul}): ${n}`,...t)}}function Ma(n,...e){if(Rr.logLevel<=$e.ERROR){const t=e.map(Yg);Rr.error(`Firestore (${ul}): ${n}`,...t)}}function Zo(n,...e){if(Rr.logLevel<=$e.WARN){const t=e.map(Yg);Rr.warn(`Firestore (${ul}): ${n}`,...t)}}function Yg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _e(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,GT(n,i,t)}function GT(n,e,t){let i=`FIRESTORE (${ul}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ma(i),new Error(i)}function Je(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||GT(e,o,i)}function De(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pe extends us{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class O1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(fn.UNAUTHENTICATED))}shutdown(){}}class k1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class P1{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Je(this.o===void 0,42304);let i=this.i;const o=p=>this.i!==i?(i=this.i,t(p)):Promise.resolve();let c=new Qs;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Qs,e.enqueueRetryable(()=>o(this.currentUser))};const d=()=>{const p=c;e.enqueueRetryable(async()=>{await p.promise,await o(this.currentUser)})},f=p=>{ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit(p=>f(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Qs)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Je(typeof i.accessToken=="string",31837,{l:i}),new $T(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Je(e===null||typeof e=="string",2055,{h:e}),new fn(e)}}class L1{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class V1{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new L1(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(fn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class r_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class U1{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,In(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Je(this.o===void 0,3512);const i=c=>{c.error!=null&&ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,ge("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>i(c))};const o=c=>{ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>o(c)),setTimeout(()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new r_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Je(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new r_(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YT(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=F1(40);for(let c=0;c<o.length;++c)i.length<20&&o[c]<t&&(i+=e.charAt(o[c]%62))}return i}}function qe(n,e){return n<e?-1:n>e?1:0}function cg(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=n.codePointAt(t),o=e.codePointAt(t);if(i!==o){if(i<128&&o<128)return qe(i,o);{const c=YT(),d=q1(c.encode(o_(n,t)),c.encode(o_(e,t)));return d!==0?d:qe(i,o)}}t+=i>65535?2:1}return qe(n.length,e.length)}function o_(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function q1(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return qe(n[t],e[t]);return qe(n.length,e.length)}function Jo(n,e,t){return n.length===e.length&&n.every((i,o)=>t(i,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l_=-62135596800,c_=1e6;class qt{static now(){return qt.fromMillis(Date.now())}static fromDate(e){return qt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*c_);return new qt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new pe(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new pe(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<l_)throw new pe(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pe(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/c_}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-l_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{static fromTimestamp(e){return new Ae(e)}static min(){return new Ae(new qt(0,0))}static max(){return new Ae(new qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u_="__name__";class Bs{constructor(e,t,i){t===void 0?t=0:t>e.length&&_e(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&_e(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Bs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Bs?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const c=Bs.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return qe(e.length,t.length)}static compareSegments(e,t){const i=Bs.isNumericId(e),o=Bs.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?Bs.extractNumericId(e).compare(Bs.extractNumericId(t)):cg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ni.fromString(e.substring(4,e.length-2))}}class ft extends Bs{construct(e,t,i){return new ft(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new pe(ie.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(o=>o.length>0))}return new ft(t)}static emptyPath(){return new ft([])}}const z1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class an extends Bs{construct(e,t,i){return new an(e,t,i)}static isValidIdentifier(e){return z1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),an.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===u_}static keyField(){return new an([u_])}static fromServerFormat(e){const t=[];let i="",o=0;const c=()=>{if(i.length===0)throw new pe(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;o<e.length;){const f=e[o];if(f==="\\"){if(o+1===e.length)throw new pe(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new pe(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=p,o+=2}else f==="`"?(d=!d,o++):f!=="."||d?(i+=f,o++):(c(),o++)}if(c(),d)throw new pe(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new an(t)}static emptyPath(){return new an([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.path=e}static fromPath(e){return new be(ft.fromString(e))}static fromName(e){return new be(ft.fromString(e).popFirst(5))}static empty(){return new be(ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ft.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new ft(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=-1;function H1(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=Ae.fromTimestamp(i===1e9?new qt(t+1,0):new qt(t,i));return new Ti(o,be.empty(),e)}function B1(n){return new Ti(n.readTime,n.key,Kc)}class Ti{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ti(Ae.min(),be.empty(),Kc)}static max(){return new Ti(Ae.max(),be.empty(),Kc)}}function G1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=be.comparator(n.documentKey,e.documentKey),t!==0?t:qe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Y1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dl(n){if(n.code!==ie.FAILED_PRECONDITION||n.message!==$1)throw n;ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_e(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe((i,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(i,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(i,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.reject(t)}static resolve(e){return new oe((t,i)=>{t(e)})}static reject(e){return new oe((t,i)=>{i(e)})}static waitFor(e){return new oe((t,i)=>{let o=0,c=0,d=!1;e.forEach(f=>{++o,f.next(()=>{++c,d&&c===o&&t()},p=>i(p))}),d=!0,c===o&&t()})}static or(e){let t=oe.resolve(!1);for(const i of e)t=t.next(o=>o?oe.resolve(o):i());return t}static forEach(e,t){const i=[];return e.forEach((o,c)=>{i.push(t.call(this,o,c))}),this.waitFor(i)}static mapArray(e,t){return new oe((i,o)=>{const c=e.length,d=new Array(c);let f=0;for(let p=0;p<c;p++){const g=p;t(e[g]).next(y=>{d[g]=y,++f,f===c&&i(d)},y=>o(y))}})}static doWhile(e,t){return new oe((i,o)=>{const c=()=>{e()===!0?t().next(()=>{c()},o):i()};c()})}}function Q1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function hl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>t.writeSequenceNumber(i))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Xh.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg=-1;function mu(n){return n==null}function jh(n){return n===0&&1/n==-1/0}function K1(n){return typeof n=="number"&&Number.isInteger(n)&&!jh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT="";function X1(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=d_(e)),e=W1(n.get(t),e);return d_(e)}function W1(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case KT:t+="";break;default:t+=c}}return t}function d_(n){return n+KT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Li(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function XT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,t){this.comparator=e,this.root=t||sn.EMPTY}insert(e,t){return new _t(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,sn.BLACK,null,null))}remove(e){return new _t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zd(this.root,e,this.comparator,!0)}}class Zd{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?i(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sn{constructor(e,t,i,o,c){this.key=e,this.value=t,this.color=i??sn.RED,this.left=o??sn.EMPTY,this.right=c??sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,c){return new sn(e??this.key,t??this.value,i??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const c=i(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,i),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return sn.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _e(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _e(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _e(27949);return e+(this.isRed()?0:1)}}sn.EMPTY=null,sn.RED=!0,sn.BLACK=!1;sn.EMPTY=new class{constructor(){this.size=0}get key(){throw _e(57766)}get value(){throw _e(16141)}get color(){throw _e(16727)}get left(){throw _e(29726)}get right(){throw _e(36894)}copy(e,t,i,o,c){return this}insert(e,t,i){return new sn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.comparator=e,this.data=new _t(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new f_(this.data.getIterator())}getIteratorFrom(e){return new f_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof zt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new zt(this.comparator);return t.data=e,t}}class f_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.fields=e,e.sort(an.comparator)}static empty(){return new zn([])}unionWith(e){let t=new zt(an.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new zn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jo(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new WT("Invalid base64 string: "+c):c}}(e);return new ln(t)}static fromUint8Array(e){const t=function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c}(e);return new ln(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ln.EMPTY_BYTE_STRING=new ln("");const Z1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ji(n){if(Je(!!n,39018),typeof n=="string"){let e=0;const t=Z1.exec(n);if(Je(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:St(n.seconds),nanos:St(n.nanos)}}function St(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ai(n){return typeof n=="string"?ln.fromBase64String(n):ln.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT="server_timestamp",JT="__type__",e0="__previous_value__",t0="__local_write_time__";function Kg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[JT])===null||t===void 0?void 0:t.stringValue)===ZT}function Wh(n){const e=n.mapValue.fields[e0];return Kg(e)?Wh(e):e}function Xc(n){const e=ji(n.mapValue.fields[t0].timestampValue);return new qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(e,t,i,o,c,d,f,p,g,y){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=g,this.isUsingEmulator=y}}const Ah="(default)";class Wc{constructor(e,t){this.projectId=e,this.database=t||Ah}static empty(){return new Wc("","")}get isDefaultDatabase(){return this.database===Ah}isEqual(e){return e instanceof Wc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0="__type__",eD="__max__",Jd={mapValue:{}},s0="__vector__",wh="value";function wi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Kg(n)?4:nD(n)?9007199254740991:tD(n)?10:11:_e(28295,{value:n})}function Xs(n,e){if(n===e)return!0;const t=wi(n);if(t!==wi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Xc(n).isEqual(Xc(e));case 3:return function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=ji(o.timestampValue),f=ji(c.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,c){return Ai(o.bytesValue).isEqual(Ai(c.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,c){return St(o.geoPointValue.latitude)===St(c.geoPointValue.latitude)&&St(o.geoPointValue.longitude)===St(c.geoPointValue.longitude)}(n,e);case 2:return function(o,c){if("integerValue"in o&&"integerValue"in c)return St(o.integerValue)===St(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=St(o.doubleValue),f=St(c.doubleValue);return d===f?jh(d)===jh(f):isNaN(d)&&isNaN(f)}return!1}(n,e);case 9:return Jo(n.arrayValue.values||[],e.arrayValue.values||[],Xs);case 10:case 11:return function(o,c){const d=o.mapValue.fields||{},f=c.mapValue.fields||{};if(h_(d)!==h_(f))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(f[p]===void 0||!Xs(d[p],f[p])))return!1;return!0}(n,e);default:return _e(52216,{left:n})}}function Zc(n,e){return(n.values||[]).find(t=>Xs(t,e))!==void 0}function el(n,e){if(n===e)return 0;const t=wi(n),i=wi(e);if(t!==i)return qe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return qe(n.booleanValue,e.booleanValue);case 2:return function(c,d){const f=St(c.integerValue||c.doubleValue),p=St(d.integerValue||d.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1}(n,e);case 3:return m_(n.timestampValue,e.timestampValue);case 4:return m_(Xc(n),Xc(e));case 5:return cg(n.stringValue,e.stringValue);case 6:return function(c,d){const f=Ai(c),p=Ai(d);return f.compareTo(p)}(n.bytesValue,e.bytesValue);case 7:return function(c,d){const f=c.split("/"),p=d.split("/");for(let g=0;g<f.length&&g<p.length;g++){const y=qe(f[g],p[g]);if(y!==0)return y}return qe(f.length,p.length)}(n.referenceValue,e.referenceValue);case 8:return function(c,d){const f=qe(St(c.latitude),St(d.latitude));return f!==0?f:qe(St(c.longitude),St(d.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return p_(n.arrayValue,e.arrayValue);case 10:return function(c,d){var f,p,g,y;const N=c.fields||{},j=d.fields||{},w=(f=N[wh])===null||f===void 0?void 0:f.arrayValue,b=(p=j[wh])===null||p===void 0?void 0:p.arrayValue,A=qe(((g=w?.values)===null||g===void 0?void 0:g.length)||0,((y=b?.values)===null||y===void 0?void 0:y.length)||0);return A!==0?A:p_(w,b)}(n.mapValue,e.mapValue);case 11:return function(c,d){if(c===Jd.mapValue&&d===Jd.mapValue)return 0;if(c===Jd.mapValue)return 1;if(d===Jd.mapValue)return-1;const f=c.fields||{},p=Object.keys(f),g=d.fields||{},y=Object.keys(g);p.sort(),y.sort();for(let N=0;N<p.length&&N<y.length;++N){const j=cg(p[N],y[N]);if(j!==0)return j;const w=el(f[p[N]],g[y[N]]);if(w!==0)return w}return qe(p.length,y.length)}(n.mapValue,e.mapValue);default:throw _e(23264,{Pe:t})}}function m_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return qe(n,e);const t=ji(n),i=ji(e),o=qe(t.seconds,i.seconds);return o!==0?o:qe(t.nanos,i.nanos)}function p_(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const c=el(t[o],i[o]);if(c)return c}return qe(t.length,i.length)}function tl(n){return ug(n)}function ug(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=ji(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ai(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return be.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",o=!0;for(const c of t.values||[])o?o=!1:i+=",",i+=ug(c);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of i)c?c=!1:o+=",",o+=`${d}:${ug(t.fields[d])}`;return o+"}"}(n.mapValue):_e(61005,{value:n})}function uh(n){switch(wi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Wh(n);return e?16+uh(e):16;case 5:return 2*n.stringValue.length;case 6:return Ai(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((o,c)=>o+uh(c),0)}(n.arrayValue);case 10:case 11:return function(i){let o=0;return Li(i.fields,(c,d)=>{o+=c.length+uh(d)}),o}(n.mapValue);default:throw _e(13486,{value:n})}}function g_(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function dg(n){return!!n&&"integerValue"in n}function Xg(n){return!!n&&"arrayValue"in n}function v_(n){return!!n&&"nullValue"in n}function y_(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function dh(n){return!!n&&"mapValue"in n}function tD(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[n0])===null||t===void 0?void 0:t.stringValue)===s0}function Pc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Li(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Pc(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Pc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function nD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===eD}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.value=e}static empty(){return new En({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!dh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pc(t)}setAll(e){let t=an.emptyPath(),i={},o=[];e.forEach((d,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,i,o),i={},o=[],t=f.popLast()}d?i[f.lastSegment()]=Pc(d):o.push(f.lastSegment())});const c=this.getFieldsMap(t);this.applyChanges(c,i,o)}delete(e){const t=this.field(e.popLast());dh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];dh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Li(t,(o,c)=>e[o]=c);for(const o of i)delete e[o]}clone(){return new En(Pc(this.value))}}function a0(n){const e=[];return Li(n.fields,(t,i)=>{const o=new an([t]);if(dh(i)){const c=a0(i.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)}),new zn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,t,i,o,c,d,f){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=c,this.data=d,this.documentState=f}static newInvalidDocument(e){return new Wt(e,0,Ae.min(),Ae.min(),Ae.min(),En.empty(),0)}static newFoundDocument(e,t,i,o){return new Wt(e,1,t,Ae.min(),i,o,0)}static newNoDocument(e,t){return new Wt(e,2,t,Ae.min(),Ae.min(),En.empty(),0)}static newUnknownDocument(e,t){return new Wt(e,3,t,Ae.min(),Ae.min(),En.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=En.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=En.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,t){this.position=e,this.inclusive=t}}function x_(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?i=be.comparator(be.fromName(d.referenceValue),t.key):i=el(d,t.data.field(c.field)),c.dir==="desc"&&(i*=-1),i!==0)break}return i}function b_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Xs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,t="asc"){this.field=e,this.dir=t}}function sD(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{}class kt extends i0{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new iD(e,t,i):t==="array-contains"?new lD(e,i):t==="in"?new cD(e,i):t==="not-in"?new uD(e,i):t==="array-contains-any"?new dD(e,i):new kt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new rD(e,i):new oD(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(el(t,this.value)):t!==null&&wi(this.value)===wi(t)&&this.matchesComparison(el(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _e(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Es extends i0{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Es(e,t)}matches(e){return r0(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function r0(n){return n.op==="and"}function o0(n){return aD(n)&&r0(n)}function aD(n){for(const e of n.filters)if(e instanceof Es)return!1;return!0}function hg(n){if(n instanceof kt)return n.field.canonicalString()+n.op.toString()+tl(n.value);if(o0(n))return n.filters.map(e=>hg(e)).join(",");{const e=n.filters.map(t=>hg(t)).join(",");return`${n.op}(${e})`}}function l0(n,e){return n instanceof kt?function(i,o){return o instanceof kt&&i.op===o.op&&i.field.isEqual(o.field)&&Xs(i.value,o.value)}(n,e):n instanceof Es?function(i,o){return o instanceof Es&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce((c,d,f)=>c&&l0(d,o.filters[f]),!0):!1}(n,e):void _e(19439)}function c0(n){return n instanceof kt?function(t){return`${t.field.canonicalString()} ${t.op} ${tl(t.value)}`}(n):n instanceof Es?function(t){return t.op.toString()+" {"+t.getFilters().map(c0).join(" ,")+"}"}(n):"Filter"}class iD extends kt{constructor(e,t,i){super(e,t,i),this.key=be.fromName(i.referenceValue)}matches(e){const t=be.comparator(e.key,this.key);return this.matchesComparison(t)}}class rD extends kt{constructor(e,t){super(e,"in",t),this.keys=u0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class oD extends kt{constructor(e,t){super(e,"not-in",t),this.keys=u0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function u0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>be.fromName(i.referenceValue))}class lD extends kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Xg(t)&&Zc(t.arrayValue,this.value)}}class cD extends kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Zc(this.value.arrayValue,t)}}class uD extends kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Zc(this.value.arrayValue,t)}}class dD extends kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Xg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Zc(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,t=null,i=[],o=[],c=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=c,this.startAt=d,this.endAt=f,this.Ie=null}}function N_(n,e=null,t=[],i=[],o=null,c=null,d=null){return new hD(n,e,t,i,o,c,d)}function Wg(n){const e=De(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>hg(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(c){return c.field.canonicalString()+c.dir}(i)).join(","),mu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>tl(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>tl(i)).join(",")),e.Ie=t}return e.Ie}function Zg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!sD(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!l0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!b_(n.startAt,e.startAt)&&b_(n.endAt,e.endAt)}function fg(n){return be.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,t=null,i=[],o=[],c=null,d="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=c,this.limitType=d,this.startAt=f,this.endAt=p,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function fD(n,e,t,i,o,c,d,f){return new fl(n,e,t,i,o,c,d,f)}function Zh(n){return new fl(n)}function __(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function d0(n){return n.collectionGroup!==null}function Lc(n){const e=De(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ee.push(c),t.add(c.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new zt(an.comparator);return d.filters.forEach(p=>{p.getFlattenedFilters().forEach(g=>{g.isInequality()&&(f=f.add(g.field))})}),f})(e).forEach(c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ee.push(new Jc(c,i))}),t.has(an.keyField().canonicalString())||e.Ee.push(new Jc(an.keyField(),i))}return e.Ee}function Ks(n){const e=De(n);return e.de||(e.de=mD(e,Lc(n))),e.de}function mD(n,e){if(n.limitType==="F")return N_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const c=o.dir==="desc"?"asc":"desc";return new Jc(o.field,c)});const t=n.endAt?new Ch(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ch(n.startAt.position,n.startAt.inclusive):null;return N_(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function mg(n,e){const t=n.filters.concat([e]);return new fl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Sh(n,e,t){return new fl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Jh(n,e){return Zg(Ks(n),Ks(e))&&n.limitType===e.limitType}function h0(n){return`${Wg(Ks(n))}|lt:${n.limitType}`}function Uo(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(o=>c0(o)).join(", ")}]`),mu(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(o=>function(d){return`${d.field.canonicalString()} (${d.dir})`}(o)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(o=>tl(o)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(o=>tl(o)).join(",")),`Target(${i})`}(Ks(n))}; limitType=${n.limitType})`}function ef(n,e){return e.isFoundDocument()&&function(i,o){const c=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(c):be.isDocumentKey(i.path)?i.path.isEqual(c):i.path.isImmediateParentOf(c)}(n,e)&&function(i,o){for(const c of Lc(i))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0}(n,e)&&function(i,o){for(const c of i.filters)if(!c.matches(o))return!1;return!0}(n,e)&&function(i,o){return!(i.startAt&&!function(d,f,p){const g=x_(d,f,p);return d.inclusive?g<=0:g<0}(i.startAt,Lc(i),o)||i.endAt&&!function(d,f,p){const g=x_(d,f,p);return d.inclusive?g>=0:g>0}(i.endAt,Lc(i),o))}(n,e)}function pD(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function f0(n){return(e,t)=>{let i=!1;for(const o of Lc(n)){const c=gD(o,e,t);if(c!==0)return c;i=i||o.field.isKeyField()}return 0}}function gD(n,e,t){const i=n.field.isKeyField()?be.comparator(e.key,t.key):function(c,d,f){const p=d.data.field(c),g=f.data.field(c);return p!==null&&g!==null?el(p,g):_e(42886)}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return _e(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,c]of i)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Li(this.inner,(t,i)=>{for(const[o,c]of i)e(o,c)})}isEmpty(){return XT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=new _t(be.comparator);function Oa(){return vD}const m0=new _t(be.comparator);function Rc(...n){let e=m0;for(const t of n)e=e.insert(t.key,t);return e}function p0(n){let e=m0;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Ar(){return Vc()}function g0(){return Vc()}function Vc(){return new Ur(n=>n.toString(),(n,e)=>n.isEqual(e))}const yD=new _t(be.comparator),xD=new zt(be.comparator);function Ye(...n){let e=xD;for(const t of n)e=e.add(t);return e}const bD=new zt(qe);function ND(){return bD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jh(e)?"-0":e}}function v0(n){return{integerValue:""+n}}function _D(n,e){return K1(e)?v0(e):Jg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(){this._=void 0}}function ED(n,e,t){return n instanceof eu?function(o,c){const d={fields:{[JT]:{stringValue:ZT},[t0]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Kg(c)&&(c=Wh(c)),c&&(d.fields[e0]=c),{mapValue:d}}(t,e):n instanceof tu?x0(n,e):n instanceof nu?b0(n,e):function(o,c){const d=y0(o,c),f=E_(d)+E_(o.Re);return dg(d)&&dg(o.Re)?v0(f):Jg(o.serializer,f)}(n,e)}function TD(n,e,t){return n instanceof tu?x0(n,e):n instanceof nu?b0(n,e):t}function y0(n,e){return n instanceof Ih?function(i){return dg(i)||function(c){return!!c&&"doubleValue"in c}(i)}(e)?e:{integerValue:0}:null}class eu extends tf{}class tu extends tf{constructor(e){super(),this.elements=e}}function x0(n,e){const t=N0(e);for(const i of n.elements)t.some(o=>Xs(o,i))||t.push(i);return{arrayValue:{values:t}}}class nu extends tf{constructor(e){super(),this.elements=e}}function b0(n,e){let t=N0(e);for(const i of n.elements)t=t.filter(o=>!Xs(o,i));return{arrayValue:{values:t}}}class Ih extends tf{constructor(e,t){super(),this.serializer=e,this.Re=t}}function E_(n){return St(n.integerValue||n.doubleValue)}function N0(n){return Xg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e,t){this.field=e,this.transform=t}}function AD(n,e){return n.field.isEqual(e.field)&&function(i,o){return i instanceof tu&&o instanceof tu||i instanceof nu&&o instanceof nu?Jo(i.elements,o.elements,Xs):i instanceof Ih&&o instanceof Ih?Xs(i.Re,o.Re):i instanceof eu&&o instanceof eu}(n.transform,e.transform)}class wD{constructor(e,t){this.version=e,this.transformResults=t}}class rn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class nf{}function _0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new sf(n.key,rn.none()):new pu(n.key,n.data,rn.none());{const t=n.data,i=En.empty();let o=new zt(an.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?i.delete(c):i.set(c,d),o=o.add(c)}return new Vi(n.key,i,new zn(o.toArray()),rn.none())}}function CD(n,e,t){n instanceof pu?function(o,c,d){const f=o.value.clone(),p=j_(o.fieldTransforms,c,d.transformResults);f.setAll(p),c.convertToFoundDocument(d.version,f).setHasCommittedMutations()}(n,e,t):n instanceof Vi?function(o,c,d){if(!hh(o.precondition,c))return void c.convertToUnknownDocument(d.version);const f=j_(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(E0(o)),p.setAll(f),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()}(n,e,t):function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()}(0,e,t)}function Uc(n,e,t,i){return n instanceof pu?function(c,d,f,p){if(!hh(c.precondition,d))return f;const g=c.value.clone(),y=A_(c.fieldTransforms,p,d);return g.setAll(y),d.convertToFoundDocument(d.version,g).setHasLocalMutations(),null}(n,e,t,i):n instanceof Vi?function(c,d,f,p){if(!hh(c.precondition,d))return f;const g=A_(c.fieldTransforms,p,d),y=d.data;return y.setAll(E0(c)),y.setAll(g),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),f===null?null:f.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(N=>N.field))}(n,e,t,i):function(c,d,f){return hh(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f}(n,e,t)}function SD(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),c=y0(i.transform,o||null);c!=null&&(t===null&&(t=En.empty()),t.set(i.field,c))}return t||null}function T_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Jo(i,o,(c,d)=>AD(c,d))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class pu extends nf{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Vi extends nf{constructor(e,t,i,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function E0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function j_(n,e,t){const i=new Map;Je(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,f=e.data.field(c.field);i.set(c.field,TD(d,f,t[o]))}return i}function A_(n,e,t){const i=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);i.set(o.field,ED(c,d,e))}return i}class sf extends nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class T0 extends nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&CD(c,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Uc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Uc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=g0();return this.mutations.forEach(o=>{const c=e.get(o.key),d=c.overlayedDocument;let f=this.applyToLocalView(d,c.mutatedFields);f=t.has(o.key)?null:f;const p=_0(d,f);p!==null&&i.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(Ae.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ye())}isEqual(e){return this.batchId===e.batchId&&Jo(this.mutations,e.mutations,(t,i)=>T_(t,i))&&Jo(this.baseMutations,e.baseMutations,(t,i)=>T_(t,i))}}class ev{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){Je(e.mutations.length===i.length,58842,{fe:e.mutations.length,ge:i.length});let o=function(){return yD}();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,i[d].version);return new ev(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot,Ze;function j0(n){switch(n){case ie.OK:return _e(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return _e(15467,{code:n})}}function A0(n){if(n===void 0)return Ma("GRPC error has no .code"),ie.UNKNOWN;switch(n){case Ot.OK:return ie.OK;case Ot.CANCELLED:return ie.CANCELLED;case Ot.UNKNOWN:return ie.UNKNOWN;case Ot.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case Ot.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case Ot.INTERNAL:return ie.INTERNAL;case Ot.UNAVAILABLE:return ie.UNAVAILABLE;case Ot.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case Ot.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case Ot.NOT_FOUND:return ie.NOT_FOUND;case Ot.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case Ot.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case Ot.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case Ot.ABORTED:return ie.ABORTED;case Ot.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case Ot.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case Ot.DATA_LOSS:return ie.DATA_LOSS;default:return _e(39323,{code:n})}}(Ze=Ot||(Ot={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD=new Ni([4294967295,4294967295],0);function w_(n){const e=YT().encode(n),t=new UT;return t.update(e),new Uint8Array(t.digest())}function C_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new Ni([t,i],0),new Ni([o,c],0)]}class tv{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Dc(`Invalid padding: ${t}`);if(i<0)throw new Dc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Dc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Dc(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Ni.fromNumber(this.pe)}we(e,t,i){let o=e.add(t.multiply(Ni.fromNumber(i)));return o.compare(MD)===1&&(o=new Ni([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=w_(e),[i,o]=C_(t);for(let c=0;c<this.hashCount;c++){const d=this.we(i,o,c);if(!this.be(d))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new tv(c,o,t);return i.forEach(f=>d.insert(f)),d}insert(e){if(this.pe===0)return;const t=w_(e),[i,o]=C_(t);for(let c=0;c<this.hashCount;c++){const d=this.we(i,o,c);this.Se(d)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Dc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,t,i,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,gu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new af(Ae.min(),o,new _t(qe),Oa(),Ye())}}class gu{constructor(e,t,i,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new gu(i,t,Ye(),Ye(),Ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,t,i,o){this.De=e,this.removedTargetIds=t,this.key=i,this.ve=o}}class w0{constructor(e,t){this.targetId=e,this.Ce=t}}class C0{constructor(e,t,i=ln.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class S_{constructor(){this.Fe=0,this.Me=I_(),this.xe=ln.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Ye(),t=Ye(),i=Ye();return this.Me.forEach((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:_e(38017,{changeType:c})}}),new gu(this.xe,this.Oe,e,t,i)}Qe(){this.Ne=!1,this.Me=I_()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Je(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class OD{constructor(e){this.ze=e,this.je=new Map,this.He=Oa(),this.Je=eh(),this.Ye=eh(),this.Ze=new _t(qe)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const i=this.rt(t);switch(e.state){case 0:this.it(t)&&i.ke(e.resumeToken);break;case 1:i.We(),i.Be||i.Qe(),i.ke(e.resumeToken);break;case 2:i.We(),i.Be||this.removeTarget(t);break;case 3:this.it(t)&&(i.Ge(),i.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),i.ke(e.resumeToken));break;default:_e(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((i,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,i=e.Ce.count,o=this._t(t);if(o){const c=o.target;if(fg(c))if(i===0){const d=new be(c.path);this.tt(t,d,Wt.newNoDocument(d,Ae.min()))}else Je(i===1,20013,{expectedCount:i});else{const d=this.ut(t);if(d!==i){const f=this.ct(e),p=f?this.lt(f,e,d):1;if(p!==0){this.st(t);const g=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:c=0}=t;let d,f;try{d=Ai(i).toUint8Array()}catch(p){if(p instanceof WT)return Zo("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new tv(d,o,c)}catch(p){return Zo(p instanceof Dc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.pe===0?null:f}lt(e,t,i){return t.Ce.count===i-this.Tt(e,t.targetId)?0:2}Tt(e,t){const i=this.ze.getRemoteKeysForTarget(t);let o=0;return i.forEach(c=>{const d=this.ze.Pt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(f)||(this.tt(t,c,null),o++)}),o}It(e){const t=new Map;this.je.forEach((c,d)=>{const f=this._t(d);if(f){if(c.current&&fg(f.target)){const p=new be(f.target.path);this.Et(p).has(d)||this.dt(d,p)||this.tt(d,p,Wt.newNoDocument(p,e))}c.Le&&(t.set(d,c.qe()),c.Qe())}});let i=Ye();this.Ye.forEach((c,d)=>{let f=!0;d.forEachWhile(p=>{const g=this._t(p);return!g||g.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)}),f&&(i=i.add(c))}),this.He.forEach((c,d)=>d.setReadTime(e));const o=new af(e,t,this.Ze,this.He,i);return this.He=Oa(),this.Je=eh(),this.Ye=eh(),this.Ze=new _t(qe),o}et(e,t){if(!this.it(e))return;const i=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,i),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,i){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),i&&(this.He=this.He.insert(t,i))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new S_,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new zt(qe),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new zt(qe),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||ge("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new S_),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function eh(){return new _t(be.comparator)}function I_(){return new _t(be.comparator)}const kD={asc:"ASCENDING",desc:"DESCENDING"},PD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LD={and:"AND",or:"OR"};class VD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function pg(n,e){return n.useProto3Json||mu(e)?e:{value:e}}function Rh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function S0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function UD(n,e){return Rh(n,e.toTimestamp())}function Bn(n){return Je(!!n,49232),Ae.fromTimestamp(function(t){const i=ji(t);return new qt(i.seconds,i.nanos)}(n))}function nv(n,e){return gg(n,e).canonicalString()}function gg(n,e){const t=function(o){return new ft(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function I0(n){const e=ft.fromString(n);return Je(P0(e),10190,{key:e.toString()}),e}function Dh(n,e){return nv(n.databaseId,e.path)}function Fc(n,e){const t=I0(e);if(t.get(1)!==n.databaseId.projectId)throw new pe(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new pe(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new be(D0(t))}function R0(n,e){return nv(n.databaseId,e)}function FD(n){const e=I0(n);return e.length===4?ft.emptyPath():D0(e)}function vg(n){return new ft(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function D0(n){return Je(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function R_(n,e,t){return{name:Dh(n,e),fields:t.value.mapValue.fields}}function qD(n,e){return"found"in e?function(i,o){Je(!!o.found,43571),o.found.name,o.found.updateTime;const c=Fc(i,o.found.name),d=Bn(o.found.updateTime),f=o.found.createTime?Bn(o.found.createTime):Ae.min(),p=new En({mapValue:{fields:o.found.fields}});return Wt.newFoundDocument(c,d,f,p)}(n,e):"missing"in e?function(i,o){Je(!!o.missing,3894),Je(!!o.readTime,22933);const c=Fc(i,o.missing),d=Bn(o.readTime);return Wt.newNoDocument(c,d)}(n,e):_e(7234,{result:e})}function zD(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:_e(39313,{state:g})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=function(g,y){return g.useProto3Json?(Je(y===void 0||typeof y=="string",58123),ln.fromBase64String(y||"")):(Je(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),ln.fromUint8Array(y||new Uint8Array))}(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&function(g){const y=g.code===void 0?ie.UNKNOWN:A0(g.code);return new pe(y,g.message||"")}(d);t=new C0(i,o,c,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=Fc(n,i.document.name),c=Bn(i.document.updateTime),d=i.document.createTime?Bn(i.document.createTime):Ae.min(),f=new En({mapValue:{fields:i.document.fields}}),p=Wt.newFoundDocument(o,c,d,f),g=i.targetIds||[],y=i.removedTargetIds||[];t=new fh(g,y,p.key,p)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=Fc(n,i.document),c=i.readTime?Bn(i.readTime):Ae.min(),d=Wt.newNoDocument(o,c),f=i.removedTargetIds||[];t=new fh([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=Fc(n,i.document),c=i.removedTargetIds||[];t=new fh([],c,o,null)}else{if(!("filter"in e))return _e(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:c}=i,d=new DD(o,c),f=i.targetId;t=new w0(f,d)}}return t}function M0(n,e){let t;if(e instanceof pu)t={update:R_(n,e.key,e.value)};else if(e instanceof sf)t={delete:Dh(n,e.key)};else if(e instanceof Vi)t={update:R_(n,e.key,e.data),updateMask:WD(e.fieldMask)};else{if(!(e instanceof T0))return _e(16599,{ft:e.type});t={verify:Dh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(c,d){const f=d.transform;if(f instanceof eu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof tu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof nu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Ih)return{fieldPath:d.field.canonicalString(),increment:f.Re};throw _e(20930,{transform:d.transform})}(0,i))),e.precondition.isNone||(t.currentDocument=function(o,c){return c.updateTime!==void 0?{updateTime:UD(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:_e(27497)}(n,e.precondition)),t}function HD(n,e){return n&&n.length>0?(Je(e!==void 0,14353),n.map(t=>function(o,c){let d=o.updateTime?Bn(o.updateTime):Bn(c);return d.isEqual(Ae.min())&&(d=Bn(c)),new wD(d,o.transformResults||[])}(t,e))):[]}function BD(n,e){return{documents:[R0(n,e.path)]}}function GD(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=R0(n,o);const c=function(g){if(g.length!==0)return k0(Es.create(g,"and"))}(e.filters);c&&(t.structuredQuery.where=c);const d=function(g){if(g.length!==0)return g.map(y=>function(j){return{field:Fo(j.field),direction:QD(j.dir)}}(y))}(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=pg(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=function(g){return{before:g.inclusive,values:g.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(g){return{before:!g.inclusive,values:g.position}}(e.endAt)),{gt:t,parent:o}}function $D(n){let e=FD(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){Je(i===1,65062);const y=t.from[0];y.allDescendants?o=y.collectionId:e=e.child(y.collectionId)}let c=[];t.where&&(c=function(N){const j=O0(N);return j instanceof Es&&o0(j)?j.getFilters():[j]}(t.where));let d=[];t.orderBy&&(d=function(N){return N.map(j=>function(b){return new Jc(qo(b.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(j))}(t.orderBy));let f=null;t.limit&&(f=function(N){let j;return j=typeof N=="object"?N.value:N,mu(j)?null:j}(t.limit));let p=null;t.startAt&&(p=function(N){const j=!!N.before,w=N.values||[];return new Ch(w,j)}(t.startAt));let g=null;return t.endAt&&(g=function(N){const j=!N.before,w=N.values||[];return new Ch(w,j)}(t.endAt)),fD(e,o,d,c,f,"F",p,g)}function YD(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _e(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function O0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=qo(t.unaryFilter.field);return kt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=qo(t.unaryFilter.field);return kt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=qo(t.unaryFilter.field);return kt.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=qo(t.unaryFilter.field);return kt.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _e(61313);default:return _e(60726)}}(n):n.fieldFilter!==void 0?function(t){return kt.create(qo(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _e(58110);default:return _e(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Es.create(t.compositeFilter.filters.map(i=>O0(i)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return _e(1026)}}(t.compositeFilter.op))}(n):_e(30097,{filter:n})}function QD(n){return kD[n]}function KD(n){return PD[n]}function XD(n){return LD[n]}function Fo(n){return{fieldPath:n.canonicalString()}}function qo(n){return an.fromServerFormat(n.fieldPath)}function k0(n){return n instanceof kt?function(t){if(t.op==="=="){if(y_(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NAN"}};if(v_(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(y_(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NOT_NAN"}};if(v_(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fo(t.field),op:KD(t.op),value:t.value}}}(n):n instanceof Es?function(t){const i=t.getFilters().map(o=>k0(o));return i.length===1?i[0]:{compositeFilter:{op:XD(t.op),filters:i}}}(n):_e(54877,{filter:n})}function WD(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function P0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,t,i,o,c=Ae.min(),d=Ae.min(),f=ln.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e){this.wt=e}}function JD(n){const e=$D({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Sh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{constructor(){this.Cn=new tM}addToCollectionParentIndex(e,t){return this.Cn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(Ti.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(Ti.min())}updateCollectionGroup(e,t,i){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class tM{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new zt(ft.comparator),c=!o.has(i);return this.index[t]=o.add(i),c}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new zt(ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},L0=41943040;class Sn{static withCacheSize(e){return new Sn(e,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sn.DEFAULT_COLLECTION_PERCENTILE=10,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sn.DEFAULT=new Sn(L0,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sn.DISABLED=new Sn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new nl(0)}static lr(){return new nl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_="LruGarbageCollector",nM=1048576;function O_([n,e],[t,i]){const o=qe(n,t);return o===0?qe(e,i):o}class sM{constructor(e){this.Er=e,this.buffer=new zt(O_),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();O_(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class aM{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){ge(M_,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){hl(t)?ge(M_,"Ignoring IndexedDB error during garbage collection: ",t):await dl(t)}await this.mr(3e5)})}}class iM{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(Xh.le);const i=new sM(t);return this.gr.forEachTarget(e,o=>i.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>i.Rr(o))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.gr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ge("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(D_)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),D_):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let i,o,c,d,f,p,g;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(N=>(N>this.params.maximumSequenceNumbersToCollect?(ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${N}`),o=this.params.maximumSequenceNumbersToCollect):o=N,d=Date.now(),this.nthSequenceNumber(e,o))).next(N=>(i=N,f=Date.now(),this.removeTargets(e,i,t))).next(N=>(c=N,p=Date.now(),this.removeOrphanedDocuments(e,i))).next(N=>(g=Date.now(),Vo()<=$e.DEBUG&&ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-y}ms
	Determined least recently used ${o} in `+(f-d)+`ms
	Removed ${c} targets in `+(p-f)+`ms
	Removed ${N} documents in `+(g-p)+`ms
Total Duration: ${g-y}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:N})))}}function rM(n,e){return new iM(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(){this.changes=new Ur(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Wt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?oe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(i=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(i!==null&&Uc(i.mutation,o,zn.empty(),qt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Ye()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Ye()){const o=Ar();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,i).next(c=>{let d=Rc();return c.forEach((f,p)=>{d=d.insert(f,p.overlayedDocument)}),d}))}getOverlayedDocuments(e,t){const i=Ar();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Ye()))}populateOverlays(e,t,i){const o=[];return i.forEach(c=>{t.has(c)||o.push(c)}),this.documentOverlayCache.getOverlays(e,o).next(c=>{c.forEach((d,f)=>{t.set(d,f)})})}computeViews(e,t,i,o){let c=Oa();const d=Vc(),f=function(){return Vc()}();return t.forEach((p,g)=>{const y=i.get(g.key);o.has(g.key)&&(y===void 0||y.mutation instanceof Vi)?c=c.insert(g.key,g):y!==void 0?(d.set(g.key,y.mutation.getFieldMask()),Uc(y.mutation,g,y.mutation.getFieldMask(),qt.now())):d.set(g.key,zn.empty())}),this.recalculateAndSaveOverlays(e,c).next(p=>(p.forEach((g,y)=>d.set(g,y)),t.forEach((g,y)=>{var N;return f.set(g,new lM(y,(N=d.get(g))!==null&&N!==void 0?N:null))}),f))}recalculateAndSaveOverlays(e,t){const i=Vc();let o=new _t((d,f)=>d-f),c=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(d=>{for(const f of d)f.keys().forEach(p=>{const g=t.get(p);if(g===null)return;let y=i.get(p)||zn.empty();y=f.applyToLocalView(g,y),i.set(p,y);const N=(o.get(f.batchId)||Ye()).add(p);o=o.insert(f.batchId,N)})}).next(()=>{const d=[],f=o.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),g=p.key,y=p.value,N=g0();y.forEach(j=>{if(!c.has(j)){const w=_0(t.get(j),i.get(j));w!==null&&N.set(j,w),c=c.add(j)}}),d.push(this.documentOverlayCache.saveOverlays(e,g,N))}return oe.waitFor(d)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,o){return function(d){return be.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):d0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next(c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-c.size):oe.resolve(Ar());let f=Kc,p=c;return d.next(g=>oe.forEach(g,(y,N)=>(f<N.largestBatchId&&(f=N.largestBatchId),c.get(y)?oe.resolve():this.remoteDocumentCache.getEntry(e,y).next(j=>{p=p.insert(y,j)}))).next(()=>this.populateOverlays(e,g,c)).next(()=>this.computeViews(e,p,g,Ye())).next(y=>({batchId:f,changes:p0(y)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new be(t)).next(i=>{let o=Rc();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const c=t.collectionGroup;let d=Rc();return this.indexManager.getCollectionParents(e,c).next(f=>oe.forEach(f,p=>{const g=function(N,j){return new fl(j,null,N.explicitOrderBy.slice(),N.filters.slice(),N.limit,N.limitType,N.startAt,N.endAt)}(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,g,i,o).next(y=>{y.forEach((N,j)=>{d=d.insert(N,j)})})}).next(()=>d))}getDocumentsMatchingCollectionQuery(e,t,i,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,c,o))).next(d=>{c.forEach((p,g)=>{const y=g.getKey();d.get(y)===null&&(d=d.insert(y,Wt.newInvalidDocument(y)))});let f=Rc();return d.forEach((p,g)=>{const y=c.get(p);y!==void 0&&Uc(y.mutation,g,zn.empty(),qt.now()),ef(t,g)&&(f=f.insert(p,g))}),f})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return oe.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:Bn(o.createTime)}}(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:JD(o.bundledQuery),readTime:Bn(o.readTime)}}(t)),oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(){this.overlays=new _t(be.comparator),this.Qr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ar();return oe.forEach(t,o=>this.getOverlay(e,o).next(c=>{c!==null&&i.set(o,c)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((o,c)=>{this.St(e,t,c)}),oe.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.Qr.get(i);return o!==void 0&&(o.forEach(c=>this.overlays=this.overlays.remove(c)),this.Qr.delete(i)),oe.resolve()}getOverlaysForCollection(e,t,i){const o=Ar(),c=t.length+1,d=new be(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const p=f.getNext().value,g=p.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===c&&p.largestBatchId>i&&o.set(p.getKey(),p)}return oe.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let c=new _t((g,y)=>g-y);const d=this.overlays.getIterator();for(;d.hasNext();){const g=d.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>i){let y=c.get(g.largestBatchId);y===null&&(y=Ar(),c=c.insert(g.largestBatchId,y)),y.set(g.getKey(),g)}}const f=Ar(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((g,y)=>f.set(g,y)),!(f.size()>=o)););return oe.resolve(f)}St(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const d=this.Qr.get(o.largestBatchId).delete(i.key);this.Qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new RD(t,i));let c=this.Qr.get(t);c===void 0&&(c=Ye(),this.Qr.set(t,c)),this.Qr.set(t,c.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(){this.sessionToken=ln.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(){this.$r=new zt(Xt.Ur),this.Kr=new zt(Xt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const i=new Xt(e,t);this.$r=this.$r.add(i),this.Kr=this.Kr.add(i)}Gr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.zr(new Xt(e,t))}jr(e,t){e.forEach(i=>this.removeReference(i,t))}Hr(e){const t=new be(new ft([])),i=new Xt(t,e),o=new Xt(t,e+1),c=[];return this.Kr.forEachInRange([i,o],d=>{this.zr(d),c.push(d.key)}),c}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new be(new ft([])),i=new Xt(t,e),o=new Xt(t,e+1);let c=Ye();return this.Kr.forEachInRange([i,o],d=>{c=c.add(d.key)}),c}containsKey(e){const t=new Xt(e,0),i=this.$r.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Xt{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return be.comparator(e.key,t.key)||qe(e.Zr,t.Zr)}static Wr(e,t){return qe(e.Zr,t.Zr)||be.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new zt(Xt.Ur)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const c=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new ID(c,t,i,o);this.mutationQueue.push(d);for(const f of o)this.Xr=this.Xr.add(new Xt(f.key,c)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return oe.resolve(d)}lookupMutationBatch(e,t){return oe.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.ti(i),c=o<0?0:o;return oe.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?Qg:this.nr-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Xt(t,0),o=new Xt(t,Number.POSITIVE_INFINITY),c=[];return this.Xr.forEachInRange([i,o],d=>{const f=this.ei(d.Zr);c.push(f)}),oe.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new zt(qe);return t.forEach(o=>{const c=new Xt(o,0),d=new Xt(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([c,d],f=>{i=i.add(f.Zr)})}),oe.resolve(this.ni(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let c=i;be.isDocumentKey(c)||(c=c.child(""));const d=new Xt(new be(c),0);let f=new zt(qe);return this.Xr.forEachWhile(p=>{const g=p.key.path;return!!i.isPrefixOf(g)&&(g.length===o&&(f=f.add(p.Zr)),!0)},d),oe.resolve(this.ni(f))}ni(e){const t=[];return e.forEach(i=>{const o=this.ei(i);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Je(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Xr;return oe.forEach(t.mutations,o=>{const c=new Xt(o.key,t.batchId);return i=i.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=i})}sr(e){}containsKey(e,t){const i=new Xt(t,0),o=this.Xr.firstAfterOrEqual(i);return oe.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM{constructor(e){this.ii=e,this.docs=function(){return new _t(be.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),c=o?o.size:0,d=this.ii(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return oe.resolve(i?i.document.mutableCopy():Wt.newInvalidDocument(t))}getEntries(e,t){let i=Oa();return t.forEach(o=>{const c=this.docs.get(o);i=i.insert(o,c?c.document.mutableCopy():Wt.newInvalidDocument(o))}),oe.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let c=Oa();const d=t.path,f=new be(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:g,value:{document:y}}=p.getNext();if(!d.isPrefixOf(g.path))break;g.path.length>d.length+1||G1(B1(y),i)<=0||(o.has(y.key)||ef(t,y))&&(c=c.insert(y.key,y.mutableCopy()))}return oe.resolve(c)}getAllFromCollectionGroup(e,t,i,o){_e(9500)}si(e,t){return oe.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new pM(this)}getSize(e){return oe.resolve(this.size)}}class pM extends oM{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((i,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(i)}),oe.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gM{constructor(e){this.persistence=e,this.oi=new Ur(t=>Wg(t),Zg),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this._i=0,this.ai=new sv,this.targetCount=0,this.ui=nl.cr()}forEachTarget(e,t){return this.oi.forEach((i,o)=>t(o)),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this._i&&(this._i=t),oe.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new nl(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.Tr(t),oe.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,i){let o=0;const c=[];return this.oi.forEach((d,f)=>{f.sequenceNumber<=t&&i.get(f.targetId)===null&&(this.oi.delete(d),c.push(this.removeMatchingKeysForTargetId(e,f.targetId)),o++)}),oe.waitFor(c).next(()=>o)}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const i=this.oi.get(t)||null;return oe.resolve(i)}addMatchingKeys(e,t,i){return this.ai.Gr(t,i),oe.resolve()}removeMatchingKeys(e,t,i){this.ai.jr(t,i);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach(d=>{c.push(o.markPotentiallyOrphaned(e,d))}),oe.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const i=this.ai.Yr(t);return oe.resolve(i)}containsKey(e,t){return oe.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e,t){this.ci={},this.overlays={},this.li=new Xh(0),this.hi=!1,this.hi=!0,this.Pi=new hM,this.referenceDelegate=e(this),this.Ti=new gM(this),this.indexManager=new eM,this.remoteDocumentCache=function(o){return new mM(o)}(i=>this.referenceDelegate.Ii(i)),this.serializer=new ZD(t),this.Ei=new uM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new dM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ci[e.toKey()];return i||(i=new fM(t,this.referenceDelegate),this.ci[e.toKey()]=i),i}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,i){ge("MemoryPersistence","Starting transaction:",e);const o=new vM(this.li.next());return this.referenceDelegate.di(),i(o).next(c=>this.referenceDelegate.Ai(o).next(()=>c)).toPromise().then(c=>(o.raiseOnCommittedEvent(),c))}Ri(e,t){return oe.or(Object.values(this.ci).map(i=>()=>i.containsKey(e,t)))}}class vM extends Y1{constructor(e){super(),this.currentSequenceNumber=e}}class av{constructor(e){this.persistence=e,this.Vi=new sv,this.mi=null}static fi(e){return new av(e)}get gi(){if(this.mi)return this.mi;throw _e(60996)}addReference(e,t,i){return this.Vi.addReference(i,t),this.gi.delete(i.toString()),oe.resolve()}removeReference(e,t,i){return this.Vi.removeReference(i,t),this.gi.add(i.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(c=>this.gi.add(c.toString()))}).next(()=>i.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.gi,i=>{const o=be.fromPath(i);return this.pi(e,o).next(c=>{c||t.removeEntry(o,Ae.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(i=>{i?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return oe.or([()=>oe.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Mh{constructor(e,t){this.persistence=e,this.yi=new Ur(i=>X1(i.path),(i,o)=>i.isEqual(o)),this.garbageCollector=rM(this,t)}static fi(e,t){return new Mh(e,t)}di(){}Ai(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(o=>i+o))}br(e){let t=0;return this.yr(e,i=>{t++}).next(()=>t)}yr(e,t){return oe.forEach(this.yi,(i,o)=>this.Dr(e,i,o).next(c=>c?oe.resolve():t(o)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.si(e,d=>this.Dr(e,d,t).next(f=>{f||(i++,c.removeEntry(d,Ae.min()))})).next(()=>c.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.yi.set(i,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,i){return this.yi.set(i,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),oe.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=uh(e.data.value)),t}Dr(e,t,i){return oe.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return oe.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.ds=i,this.As=o}static Rs(e,t){let i=Ye(),o=Ye();for(const c of t.docChanges)switch(c.type){case 0:i=i.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new iv(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return WC()?8:Q1(gn())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,i,o){const c={result:null};return this.ws(e,t).next(d=>{c.result=d}).next(()=>{if(!c.result)return this.bs(e,t,o,i).next(d=>{c.result=d})}).next(()=>{if(c.result)return;const d=new yM;return this.Ss(e,t,d).next(f=>{if(c.result=f,this.fs)return this.Ds(e,t,d,f.size)})}).next(()=>c.result)}Ds(e,t,i,o){return i.documentReadCount<this.gs?(Vo()<=$e.DEBUG&&ge("QueryEngine","SDK will not create cache indexes for query:",Uo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),oe.resolve()):(Vo()<=$e.DEBUG&&ge("QueryEngine","Query:",Uo(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.ps*o?(Vo()<=$e.DEBUG&&ge("QueryEngine","The SDK decides to create cache indexes for query:",Uo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ks(t))):oe.resolve())}ws(e,t){if(__(t))return oe.resolve(null);let i=Ks(t);return this.indexManager.getIndexType(e,i).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Sh(t,null,"F"),i=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(c=>{const d=Ye(...c);return this.ys.getDocuments(e,d).next(f=>this.indexManager.getMinOffset(e,i).next(p=>{const g=this.vs(t,f);return this.Cs(t,g,d,p.readTime)?this.ws(e,Sh(t,null,"F")):this.Fs(e,g,t,p)}))})))}bs(e,t,i,o){return __(t)||o.isEqual(Ae.min())?oe.resolve(null):this.ys.getDocuments(e,i).next(c=>{const d=this.vs(t,c);return this.Cs(t,d,i,o)?oe.resolve(null):(Vo()<=$e.DEBUG&&ge("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Uo(t)),this.Fs(e,d,t,H1(o,Kc)).next(f=>f))})}vs(e,t){let i=new zt(f0(e));return t.forEach((o,c)=>{ef(e,c)&&(i=i.add(c))}),i}Cs(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,i){return Vo()<=$e.DEBUG&&ge("QueryEngine","Using full collection scan to execute query:",Uo(t)),this.ys.getDocumentsMatchingQuery(e,t,Ti.min(),i)}Fs(e,t,i,o){return this.ys.getDocumentsMatchingQuery(e,i,o).next(c=>(t.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv="LocalStore",bM=3e8;class NM{constructor(e,t,i,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new _t(qe),this.Os=new Ur(c=>Wg(c),Zg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(i)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cM(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function _M(n,e,t,i){return new NM(n,e,t,i)}async function U0(n,e){const t=De(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next(c=>(o=c,t.Ls(e),t.mutationQueue.getAllMutationBatches(i))).next(c=>{const d=[],f=[];let p=Ye();for(const g of o){d.push(g.batchId);for(const y of g.mutations)p=p.add(y.key)}for(const g of c){f.push(g.batchId);for(const y of g.mutations)p=p.add(y.key)}return t.localDocuments.getDocuments(i,p).next(g=>({ks:g,removedBatchIds:d,addedBatchIds:f}))})})}function EM(n,e){const t=De(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const o=e.batch.keys(),c=t.Bs.newChangeBuffer({trackRemovals:!0});return function(f,p,g,y){const N=g.batch,j=N.keys();let w=oe.resolve();return j.forEach(b=>{w=w.next(()=>y.getEntry(p,b)).next(A=>{const E=g.docVersions.get(b);Je(E!==null,48541),A.version.compareTo(E)<0&&(N.applyToRemoteDocument(A,g),A.isValidDocument()&&(A.setReadTime(g.commitVersion),y.addEntry(A)))})}),w.next(()=>f.mutationQueue.removeMutationBatch(p,N))}(t,i,e,c).next(()=>c.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(f){let p=Ye();for(let g=0;g<f.mutationResults.length;++g)f.mutationResults[g].transformResults.length>0&&(p=p.add(f.batch.mutations[g].key));return p}(e))).next(()=>t.localDocuments.getDocuments(i,o))})}function F0(n){const e=De(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function TM(n,e){const t=De(n),i=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const f=[];e.targetChanges.forEach((y,N)=>{const j=o.get(N);if(!j)return;f.push(t.Ti.removeMatchingKeys(c,y.removedDocuments,N).next(()=>t.Ti.addMatchingKeys(c,y.addedDocuments,N)));let w=j.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(N)!==null?w=w.withResumeToken(ln.EMPTY_BYTE_STRING,Ae.min()).withLastLimboFreeSnapshotVersion(Ae.min()):y.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(y.resumeToken,i)),o=o.insert(N,w),function(A,E,D){return A.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=bM?!0:D.addedDocuments.size+D.modifiedDocuments.size+D.removedDocuments.size>0}(j,w,y)&&f.push(t.Ti.updateTargetData(c,w))});let p=Oa(),g=Ye();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(c,y))}),f.push(jM(c,d,e.documentUpdates).next(y=>{p=y.qs,g=y.Qs})),!i.isEqual(Ae.min())){const y=t.Ti.getLastRemoteSnapshotVersion(c).next(N=>t.Ti.setTargetsMetadata(c,c.currentSequenceNumber,i));f.push(y)}return oe.waitFor(f).next(()=>d.apply(c)).next(()=>t.localDocuments.getLocalViewOfDocuments(c,p,g)).next(()=>p)}).then(c=>(t.xs=o,c))}function jM(n,e,t){let i=Ye(),o=Ye();return t.forEach(c=>i=i.add(c)),e.getEntries(n,i).next(c=>{let d=Oa();return t.forEach((f,p)=>{const g=c.get(f);p.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(f)),p.isNoDocument()&&p.version.isEqual(Ae.min())?(e.removeEntry(f,p.readTime),d=d.insert(f,p)):!g.isValidDocument()||p.version.compareTo(g.version)>0||p.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(p),d=d.insert(f,p)):ge(rv,"Ignoring outdated watch update for ",f,". Current version:",g.version," Watch version:",p.version)}),{qs:d,Qs:o}})}function AM(n,e){const t=De(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=Qg),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function wM(n,e){const t=De(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let o;return t.Ti.getTargetData(i,e).next(c=>c?(o=c,oe.resolve(o)):t.Ti.allocateTargetId(i).next(d=>(o=new yi(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.Ti.addTargetData(i,o).next(()=>o))))}).then(i=>{const o=t.xs.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(i.targetId,i),t.Os.set(e,i.targetId)),i})}async function yg(n,e,t){const i=De(n),o=i.xs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",c,d=>i.persistence.referenceDelegate.removeTarget(d,o))}catch(d){if(!hl(d))throw d;ge(rv,`Failed to update sequence numbers for target ${e}: ${d}`)}i.xs=i.xs.remove(e),i.Os.delete(o.target)}function k_(n,e,t){const i=De(n);let o=Ae.min(),c=Ye();return i.persistence.runTransaction("Execute query","readwrite",d=>function(p,g,y){const N=De(p),j=N.Os.get(y);return j!==void 0?oe.resolve(N.xs.get(j)):N.Ti.getTargetData(g,y)}(i,d,Ks(e)).next(f=>{if(f)return o=f.lastLimboFreeSnapshotVersion,i.Ti.getMatchingKeysForTargetId(d,f.targetId).next(p=>{c=p})}).next(()=>i.Ms.getDocumentsMatchingQuery(d,e,t?o:Ae.min(),t?c:Ye())).next(f=>(CM(i,pD(e),f),{documents:f,$s:c})))}function CM(n,e,t){let i=n.Ns.get(e)||Ae.min();t.forEach((o,c)=>{c.readTime.compareTo(i)>0&&(i=c.readTime)}),n.Ns.set(e,i)}class P_{constructor(){this.activeTargetIds=ND()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class SM{constructor(){this.xo=new P_,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,i){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new P_,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_="ConnectivityMonitor";class V_{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){ge(L_,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){ge(L_,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let th=null;function xg(){return th===null?th=function(){return 268435456+Math.round(2147483648*Math.random())}():th++,"0x"+th.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp="RestConnection",RM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class DM{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${i}/databases/${o}`,this.Go=this.databaseId.database===Ah?`project_id=${i}`:`project_id=${i}&database_id=${o}`}zo(e,t,i,o,c){const d=xg(),f=this.jo(e,t.toUriEncodedString());ge(Vp,`Sending RPC '${e}' ${d}:`,f,i);const p={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(p,o,c);const{host:g}=new URL(f),y=Lr(g);return this.Jo(e,f,p,i,y).then(N=>(ge(Vp,`Received RPC '${e}' ${d}: `,N),N),N=>{throw Zo(Vp,`RPC '${e}' ${d} failed with error: `,N,"url: ",f,"request:",i),N})}Yo(e,t,i,o,c,d){return this.zo(e,t,i,o,c)}Ho(e,t,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ul}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,c)=>e[c]=o),i&&i.headers.forEach((o,c)=>e[c]=o)}jo(e,t){const i=RM[e];return`${this.Ko}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hn="WebChannelConnection";class OM extends DM{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,o,c){const d=xg();return new Promise((f,p)=>{const g=new FT;g.setWithCredentials(!0),g.listenOnce(qT.COMPLETE,()=>{try{switch(g.getLastErrorCode()){case ch.NO_ERROR:const N=g.getResponseJson();ge(hn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(N)),f(N);break;case ch.TIMEOUT:ge(hn,`RPC '${e}' ${d} timed out`),p(new pe(ie.DEADLINE_EXCEEDED,"Request time out"));break;case ch.HTTP_ERROR:const j=g.getStatus();if(ge(hn,`RPC '${e}' ${d} failed with status:`,j,"response text:",g.getResponseText()),j>0){let w=g.getResponseJson();Array.isArray(w)&&(w=w[0]);const b=w?.error;if(b&&b.status&&b.message){const A=function(D){const q=D.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(q)>=0?q:ie.UNKNOWN}(b.status);p(new pe(A,b.message))}else p(new pe(ie.UNKNOWN,"Server responded with status "+g.getStatus()))}else p(new pe(ie.UNAVAILABLE,"Connection failed."));break;default:_e(9055,{h_:e,streamId:d,P_:g.getLastErrorCode(),T_:g.getLastError()})}}finally{ge(hn,`RPC '${e}' ${d} completed.`)}});const y=JSON.stringify(o);ge(hn,`RPC '${e}' ${d} sending request:`,o),g.send(t,"POST",y,i,15)})}I_(e,t,i){const o=xg(),c=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=BT(),f=HT(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Ho(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=c.join("");ge(hn,`Creating RPC '${e}' stream ${o}: ${y}`,p);const N=d.createWebChannel(y,p);this.E_(N);let j=!1,w=!1;const b=new MM({Zo:E=>{w?ge(hn,`Not sending because RPC '${e}' stream ${o} is closed:`,E):(j||(ge(hn,`Opening RPC '${e}' stream ${o} transport.`),N.open(),j=!0),ge(hn,`RPC '${e}' stream ${o} sending:`,E),N.send(E))},Xo:()=>N.close()}),A=(E,D,q)=>{E.listen(D,U=>{try{q(U)}catch(P){setTimeout(()=>{throw P},0)}})};return A(N,Ic.EventType.OPEN,()=>{w||(ge(hn,`RPC '${e}' stream ${o} transport opened.`),b.__())}),A(N,Ic.EventType.CLOSE,()=>{w||(w=!0,ge(hn,`RPC '${e}' stream ${o} transport closed`),b.u_(),this.d_(N))}),A(N,Ic.EventType.ERROR,E=>{w||(w=!0,Zo(hn,`RPC '${e}' stream ${o} transport errored. Name:`,E.name,"Message:",E.message),b.u_(new pe(ie.UNAVAILABLE,"The operation could not be completed")))}),A(N,Ic.EventType.MESSAGE,E=>{var D;if(!w){const q=E.data[0];Je(!!q,16349);const U=q,P=U?.error||((D=U[0])===null||D===void 0?void 0:D.error);if(P){ge(hn,`RPC '${e}' stream ${o} received error:`,P);const F=P.status;let $=function(k){const O=Ot[k];if(O!==void 0)return A0(O)}(F),L=P.message;$===void 0&&($=ie.INTERNAL,L="Unknown error status: "+F+" with message "+P.message),w=!0,b.u_(new pe($,L)),N.close()}else ge(hn,`RPC '${e}' stream ${o} received:`,q),b.c_(q)}}),A(f,zT.STAT_EVENT,E=>{E.stat===lg.PROXY?ge(hn,`RPC '${e}' stream ${o} detected buffering proxy`):E.stat===lg.NOPROXY&&ge(hn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{b.a_()},0),b}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function Up(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(n){return new VD(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,t,i=1e3,o=1.5,c=6e4){this.xi=e,this.timerId=t,this.A_=i,this.R_=o,this.V_=c,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),i=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-i);o>0&&ge("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U_="PersistentStream";class q0{constructor(e,t,i,o,c,d,f,p){this.xi=e,this.S_=i,this.D_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new ov(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(Ma(t.toString()),Ma("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,o])=>{this.v_===t&&this.z_(i,o)},i=>{e(()=>{const o=new pe(ie.UNKNOWN,"Fetching auth token failed: "+i.message);return this.j_(o)})})}z_(e,t){const i=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{i(()=>this.listener.e_())}),this.stream.n_(()=>{i(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{i(()=>this.j_(o))}),this.stream.onMessage(o=>{i(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return ge(U_,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(ge(U_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class kM extends q0{constructor(e,t,i,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=zD(this.serializer,e),i=function(c){if(!("targetChange"in c))return Ae.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?Ae.min():d.readTime?Bn(d.readTime):Ae.min()}(e);return this.listener.Y_(t,i)}Z_(e){const t={};t.database=vg(this.serializer),t.addTarget=function(c,d){let f;const p=d.target;if(f=fg(p)?{documents:BD(c,p)}:{query:GD(c,p).gt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=S0(c,d.resumeToken);const g=pg(c,d.expectedCount);g!==null&&(f.expectedCount=g)}else if(d.snapshotVersion.compareTo(Ae.min())>0){f.readTime=Rh(c,d.snapshotVersion.toTimestamp());const g=pg(c,d.expectedCount);g!==null&&(f.expectedCount=g)}return f}(this.serializer,e);const i=YD(this.serializer,e);i&&(t.labels=i),this.Q_(t)}X_(e){const t={};t.database=vg(this.serializer),t.removeTarget=e,this.Q_(t)}}class PM extends q0{constructor(e,t,i,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Je(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=HD(e.writeResults,e.commitTime),i=Bn(e.commitTime);return this.listener.ra(i,t)}ia(){const e={};e.database=vg(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>M0(this.serializer,i))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{}class VM extends LM{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new pe(ie.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,i,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.zo(e,gg(t,i),o,c,d)).catch(c=>{throw c.name==="FirebaseError"?(c.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new pe(ie.UNKNOWN,c.toString())})}Yo(e,t,i,o,c){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,f])=>this.connection.Yo(e,gg(t,i),o,d,f,c)).catch(d=>{throw d.name==="FirebaseError"?(d.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new pe(ie.UNKNOWN,d.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class UM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Ma(t),this.ua=!1):ge("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr="RemoteStore";class FM{constructor(e,t,i,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=c,this.Ra.No(d=>{i.enqueueAndForget(async()=>{Fr(this)&&(ge(Dr,"Restarting streams for network reachability change."),await async function(p){const g=De(p);g.da.add(4),await vu(g),g.Va.set("Unknown"),g.da.delete(4),await of(g)}(this))})}),this.Va=new UM(i,o)}}async function of(n){if(Fr(n))for(const e of n.Aa)await e(!0)}async function vu(n){for(const e of n.Aa)await e(!1)}function z0(n,e){const t=De(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),dv(t)?uv(t):ml(t).N_()&&cv(t,e))}function lv(n,e){const t=De(n),i=ml(t);t.Ea.delete(e),i.N_()&&H0(t,e),t.Ea.size===0&&(i.N_()?i.k_():Fr(t)&&t.Va.set("Unknown"))}function cv(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ae.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ml(n).Z_(e)}function H0(n,e){n.ma.Ke(e),ml(n).X_(e)}function uv(n){n.ma=new OD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),ml(n).start(),n.Va.ca()}function dv(n){return Fr(n)&&!ml(n).O_()&&n.Ea.size>0}function Fr(n){return De(n).da.size===0}function B0(n){n.ma=void 0}async function qM(n){n.Va.set("Online")}async function zM(n){n.Ea.forEach((e,t)=>{cv(n,e)})}async function HM(n,e){B0(n),dv(n)?(n.Va.Pa(e),uv(n)):n.Va.set("Unknown")}async function BM(n,e,t){if(n.Va.set("Online"),e instanceof C0&&e.state===2&&e.cause)try{await async function(o,c){const d=c.cause;for(const f of c.targetIds)o.Ea.has(f)&&(await o.remoteSyncer.rejectListen(f,d),o.Ea.delete(f),o.ma.removeTarget(f))}(n,e)}catch(i){ge(Dr,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Oh(n,i)}else if(e instanceof fh?n.ma.Xe(e):e instanceof w0?n.ma.ot(e):n.ma.nt(e),!t.isEqual(Ae.min()))try{const i=await F0(n.localStore);t.compareTo(i)>=0&&await function(c,d){const f=c.ma.It(d);return f.targetChanges.forEach((p,g)=>{if(p.resumeToken.approximateByteSize()>0){const y=c.Ea.get(g);y&&c.Ea.set(g,y.withResumeToken(p.resumeToken,d))}}),f.targetMismatches.forEach((p,g)=>{const y=c.Ea.get(p);if(!y)return;c.Ea.set(p,y.withResumeToken(ln.EMPTY_BYTE_STRING,y.snapshotVersion)),H0(c,p);const N=new yi(y.target,p,g,y.sequenceNumber);cv(c,N)}),c.remoteSyncer.applyRemoteEvent(f)}(n,t)}catch(i){ge(Dr,"Failed to raise snapshot:",i),await Oh(n,i)}}async function Oh(n,e,t){if(!hl(e))throw e;n.da.add(1),await vu(n),n.Va.set("Offline"),t||(t=()=>F0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ge(Dr,"Retrying IndexedDB access"),await t(),n.da.delete(1),await of(n)})}function G0(n,e){return e().catch(t=>Oh(n,t,e))}async function lf(n){const e=De(n),t=Ci(e);let i=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Qg;for(;GM(e);)try{const o=await AM(e.localStore,i);if(o===null){e.Ia.length===0&&t.k_();break}i=o.batchId,$M(e,o)}catch(o){await Oh(e,o)}$0(e)&&Y0(e)}function GM(n){return Fr(n)&&n.Ia.length<10}function $M(n,e){n.Ia.push(e);const t=Ci(n);t.N_()&&t.ea&&t.ta(e.mutations)}function $0(n){return Fr(n)&&!Ci(n).O_()&&n.Ia.length>0}function Y0(n){Ci(n).start()}async function YM(n){Ci(n).ia()}async function QM(n){const e=Ci(n);for(const t of n.Ia)e.ta(t.mutations)}async function KM(n,e,t){const i=n.Ia.shift(),o=ev.from(i,e,t);await G0(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await lf(n)}async function XM(n,e){e&&Ci(n).ea&&await async function(i,o){if(function(d){return j0(d)&&d!==ie.ABORTED}(o.code)){const c=i.Ia.shift();Ci(i).L_(),await G0(i,()=>i.remoteSyncer.rejectFailedWrite(c.batchId,o)),await lf(i)}}(n,e),$0(n)&&Y0(n)}async function F_(n,e){const t=De(n);t.asyncQueue.verifyOperationInProgress(),ge(Dr,"RemoteStore received new credentials");const i=Fr(t);t.da.add(3),await vu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await of(t)}async function WM(n,e){const t=De(n);e?(t.da.delete(2),await of(t)):e||(t.da.add(2),await vu(t),t.Va.set("Unknown"))}function ml(n){return n.fa||(n.fa=function(t,i,o){const c=De(t);return c.oa(),new kM(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:qM.bind(null,n),n_:zM.bind(null,n),i_:HM.bind(null,n),Y_:BM.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),dv(n)?uv(n):n.Va.set("Unknown")):(await n.fa.stop(),B0(n))})),n.fa}function Ci(n){return n.ga||(n.ga=function(t,i,o){const c=De(t);return c.oa(),new PM(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:YM.bind(null,n),i_:XM.bind(null,n),na:QM.bind(null,n),ra:KM.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await lf(n)):(await n.ga.stop(),n.Ia.length>0&&(ge(Dr,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e,t,i,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=c,this.deferred=new Qs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,c){const d=Date.now()+i,f=new hv(e,t,d,o,c);return f.start(i),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pe(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fv(n,e){if(Ma("AsyncQueue",`${e}: ${n}`),hl(n))return new pe(ie.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{static emptySet(e){return new Ko(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||be.comparator(t.key,i.key):(t,i)=>be.comparator(t.key,i.key),this.keyedMap=Rc(),this.sortedSet=new _t(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ko)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Ko;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(){this.pa=new _t(be.comparator)}track(e){const t=e.doc.key,i=this.pa.get(t);i?e.type!==0&&i.type===3?this.pa=this.pa.insert(t,e):e.type===3&&i.type!==1?this.pa=this.pa.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.pa=this.pa.remove(t):e.type===1&&i.type===2?this.pa=this.pa.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):_e(63341,{Vt:e,ya:i}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,i)=>{e.push(i)}),e}}class sl{constructor(e,t,i,o,c,d,f,p,g){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=g}static fromInitialDocuments(e,t,i,o,c){const d=[];return t.forEach(f=>{d.push({type:0,doc:f})}),new sl(e,t,Ko.emptySet(t),d,i,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class JM{constructor(){this.queries=z_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=De(t),c=o.queries;o.queries=z_(),c.forEach((d,f)=>{for(const p of f.Sa)p.onError(i)})})(this,new pe(ie.ABORTED,"Firestore shutting down"))}}function z_(){return new Ur(n=>h0(n),Jh)}async function mv(n,e){const t=De(n);let i=3;const o=e.query;let c=t.queries.get(o);c?!c.Da()&&e.va()&&(i=2):(c=new ZM,i=e.va()?0:1);try{switch(i){case 0:c.ba=await t.onListen(o,!0);break;case 1:c.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const f=fv(d,`Initialization of query '${Uo(e.query)}' failed`);return void e.onError(f)}t.queries.set(o,c),c.Sa.push(e),e.Fa(t.onlineState),c.ba&&e.Ma(c.ba)&&gv(t)}async function pv(n,e){const t=De(n),i=e.query;let o=3;const c=t.queries.get(i);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.va()?0:1:!c.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function eO(n,e){const t=De(n);let i=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const f of d.Sa)f.Ma(o)&&(i=!0);d.ba=o}}i&&gv(t)}function tO(n,e,t){const i=De(n),o=i.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);i.queries.delete(e)}function gv(n){n.Ca.forEach(e=>{e.next()})}var bg,H_;(H_=bg||(bg={})).xa="default",H_.Cache="cache";class vv{constructor(e,t,i){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=i||{}}Ma(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new sl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const i=t!=="Offline";return(!this.options.Qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=sl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==bg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e){this.key=e}}class K0{constructor(e){this.key=e}}class nO{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ye(),this.mutatedKeys=Ye(),this.Za=f0(e),this.Xa=new Ko(this.Za)}get eu(){return this.Ha}tu(e,t){const i=t?t.nu:new q_,o=t?t.Xa:this.Xa;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,f=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((y,N)=>{const j=o.get(y),w=ef(this.query,N)?N:null,b=!!j&&this.mutatedKeys.has(j.key),A=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let E=!1;j&&w?j.data.isEqual(w.data)?b!==A&&(i.track({type:3,doc:w}),E=!0):this.ru(j,w)||(i.track({type:2,doc:w}),E=!0,(p&&this.Za(w,p)>0||g&&this.Za(w,g)<0)&&(f=!0)):!j&&w?(i.track({type:0,doc:w}),E=!0):j&&!w&&(i.track({type:1,doc:j}),E=!0,(p||g)&&(f=!0)),E&&(w?(d=d.add(w),c=A?c.add(y):c.delete(y)):(d=d.delete(y),c=c.delete(y)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const y=this.query.limitType==="F"?d.last():d.first();d=d.delete(y.key),c=c.delete(y.key),i.track({type:1,doc:y})}return{Xa:d,nu:i,Cs:f,mutatedKeys:c}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const c=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const d=e.nu.wa();d.sort((y,N)=>function(w,b){const A=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _e(20277,{Vt:E})}};return A(w)-A(b)}(y.type,N.type)||this.Za(y.doc,N.doc)),this.iu(i),o=o!=null&&o;const f=t&&!o?this.su():[],p=this.Ya.size===0&&this.current&&!o?1:0,g=p!==this.Ja;return this.Ja=p,d.length!==0||g?{snapshot:new sl(this.query,e.Xa,c,d,e.mutatedKeys,p===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),ou:f}:{ou:f}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new q_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Ye(),this.Xa.forEach(i=>{this._u(i.key)&&(this.Ya=this.Ya.add(i.key))});const t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new K0(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new Q0(i))}),t}au(e){this.Ha=e.$s,this.Ya=Ye();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return sl.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const yv="SyncEngine";class sO{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class aO{constructor(e){this.key=e,this.cu=!1}}class iO{constructor(e,t,i,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.lu={},this.hu=new Ur(f=>h0(f),Jh),this.Pu=new Map,this.Tu=new Set,this.Iu=new _t(be.comparator),this.Eu=new Map,this.du=new sv,this.Au={},this.Ru=new Map,this.Vu=nl.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function rO(n,e,t=!0){const i=tj(n);let o;const c=i.hu.get(e);return c?(i.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.uu()):o=await X0(i,e,t,!0),o}async function oO(n,e){const t=tj(n);await X0(t,e,!0,!1)}async function X0(n,e,t,i){const o=await wM(n.localStore,Ks(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let f;return i&&(f=await lO(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&z0(n.remoteStore,o),f}async function lO(n,e,t,i,o){n.fu=(N,j,w)=>async function(A,E,D,q){let U=E.view.tu(D);U.Cs&&(U=await k_(A.localStore,E.query,!1).then(({documents:L})=>E.view.tu(L,U)));const P=q&&q.targetChanges.get(E.targetId),F=q&&q.targetMismatches.get(E.targetId)!=null,$=E.view.applyChanges(U,A.isPrimaryClient,P,F);return G_(A,E.targetId,$.ou),$.snapshot}(n,N,j,w);const c=await k_(n.localStore,e,!0),d=new nO(e,c.$s),f=d.tu(c.documents),p=gu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),g=d.applyChanges(f,n.isPrimaryClient,p);G_(n,t,g.ou);const y=new sO(e,t,d);return n.hu.set(e,y),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),g.snapshot}async function cO(n,e,t){const i=De(n),o=i.hu.get(e),c=i.Pu.get(o.targetId);if(c.length>1)return i.Pu.set(o.targetId,c.filter(d=>!Jh(d,e))),void i.hu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await yg(i.localStore,o.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(o.targetId),t&&lv(i.remoteStore,o.targetId),Ng(i,o.targetId)}).catch(dl)):(Ng(i,o.targetId),await yg(i.localStore,o.targetId,!0))}async function uO(n,e){const t=De(n),i=t.hu.get(e),o=t.Pu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),lv(t.remoteStore,i.targetId))}async function dO(n,e,t){const i=yO(n);try{const o=await function(d,f){const p=De(d),g=qt.now(),y=f.reduce((w,b)=>w.add(b.key),Ye());let N,j;return p.persistence.runTransaction("Locally write mutations","readwrite",w=>{let b=Oa(),A=Ye();return p.Bs.getEntries(w,y).next(E=>{b=E,b.forEach((D,q)=>{q.isValidDocument()||(A=A.add(D))})}).next(()=>p.localDocuments.getOverlayedDocuments(w,b)).next(E=>{N=E;const D=[];for(const q of f){const U=SD(q,N.get(q.key).overlayedDocument);U!=null&&D.push(new Vi(q.key,U,a0(U.value.mapValue),rn.exists(!0)))}return p.mutationQueue.addMutationBatch(w,g,D,f)}).next(E=>{j=E;const D=E.applyToLocalDocumentSet(N,A);return p.documentOverlayCache.saveOverlays(w,E.batchId,D)})}).then(()=>({batchId:j.batchId,changes:p0(N)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),function(d,f,p){let g=d.Au[d.currentUser.toKey()];g||(g=new _t(qe)),g=g.insert(f,p),d.Au[d.currentUser.toKey()]=g}(i,o.batchId,t),await yu(i,o.changes),await lf(i.remoteStore)}catch(o){const c=fv(o,"Failed to persist write");t.reject(c)}}async function W0(n,e){const t=De(n);try{const i=await TM(t.localStore,e);e.targetChanges.forEach((o,c)=>{const d=t.Eu.get(c);d&&(Je(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.cu=!0:o.modifiedDocuments.size>0?Je(d.cu,14607):o.removedDocuments.size>0&&(Je(d.cu,42227),d.cu=!1))}),await yu(t,i,e)}catch(i){await dl(i)}}function B_(n,e,t){const i=De(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.hu.forEach((c,d)=>{const f=d.view.Fa(e);f.snapshot&&o.push(f.snapshot)}),function(d,f){const p=De(d);p.onlineState=f;let g=!1;p.queries.forEach((y,N)=>{for(const j of N.Sa)j.Fa(f)&&(g=!0)}),g&&gv(p)}(i.eventManager,e),o.length&&i.lu.Y_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function hO(n,e,t){const i=De(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Eu.get(e),c=o&&o.key;if(c){let d=new _t(be.comparator);d=d.insert(c,Wt.newNoDocument(c,Ae.min()));const f=Ye().add(c),p=new af(Ae.min(),new Map,new _t(qe),d,f);await W0(i,p),i.Iu=i.Iu.remove(c),i.Eu.delete(e),xv(i)}else await yg(i.localStore,e,!1).then(()=>Ng(i,e,t)).catch(dl)}async function fO(n,e){const t=De(n),i=e.batch.batchId;try{const o=await EM(t.localStore,e);J0(t,i,null),Z0(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await yu(t,o)}catch(o){await dl(o)}}async function mO(n,e,t){const i=De(n);try{const o=await function(d,f){const p=De(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let y;return p.mutationQueue.lookupMutationBatch(g,f).next(N=>(Je(N!==null,37113),y=N.keys(),p.mutationQueue.removeMutationBatch(g,N))).next(()=>p.mutationQueue.performConsistencyCheck(g)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(g,y,f)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,y)).next(()=>p.localDocuments.getDocuments(g,y))})}(i.localStore,e);J0(i,e,t),Z0(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await yu(i,o)}catch(o){await dl(o)}}function Z0(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function J0(n,e,t){const i=De(n);let o=i.Au[i.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),i.Au[i.currentUser.toKey()]=o}}function Ng(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Pu.get(e))n.hu.delete(i),t&&n.lu.gu(i,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(i=>{n.du.containsKey(i)||ej(n,i)})}function ej(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(lv(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),xv(n))}function G_(n,e,t){for(const i of t)i instanceof Q0?(n.du.addReference(i.key,e),pO(n,i)):i instanceof K0?(ge(yv,"Document no longer in limbo: "+i.key),n.du.removeReference(i.key,e),n.du.containsKey(i.key)||ej(n,i.key)):_e(19791,{pu:i})}function pO(n,e){const t=e.key,i=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(i)||(ge(yv,"New document in limbo: "+t),n.Tu.add(i),xv(n))}function xv(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new be(ft.fromString(e)),i=n.Vu.next();n.Eu.set(i,new aO(t)),n.Iu=n.Iu.insert(t,i),z0(n.remoteStore,new yi(Ks(Zh(t.path)),i,"TargetPurposeLimboResolution",Xh.le))}}async function yu(n,e,t){const i=De(n),o=[],c=[],d=[];i.hu.isEmpty()||(i.hu.forEach((f,p)=>{d.push(i.fu(p,e,t).then(g=>{var y;if((g||t)&&i.isPrimaryClient){const N=g?!g.fromCache:(y=t?.targetChanges.get(p.targetId))===null||y===void 0?void 0:y.current;i.sharedClientState.updateQueryState(p.targetId,N?"current":"not-current")}if(g){o.push(g);const N=iv.Rs(p.targetId,g);c.push(N)}}))}),await Promise.all(d),i.lu.Y_(o),await async function(p,g){const y=De(p);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",N=>oe.forEach(g,j=>oe.forEach(j.ds,w=>y.persistence.referenceDelegate.addReference(N,j.targetId,w)).next(()=>oe.forEach(j.As,w=>y.persistence.referenceDelegate.removeReference(N,j.targetId,w)))))}catch(N){if(!hl(N))throw N;ge(rv,"Failed to update sequence numbers: "+N)}for(const N of g){const j=N.targetId;if(!N.fromCache){const w=y.xs.get(j),b=w.snapshotVersion,A=w.withLastLimboFreeSnapshotVersion(b);y.xs=y.xs.insert(j,A)}}}(i.localStore,c))}async function gO(n,e){const t=De(n);if(!t.currentUser.isEqual(e)){ge(yv,"User change. New user:",e.toKey());const i=await U0(t.localStore,e);t.currentUser=e,function(c,d){c.Ru.forEach(f=>{f.forEach(p=>{p.reject(new pe(ie.CANCELLED,d))})}),c.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await yu(t,i.ks)}}function vO(n,e){const t=De(n),i=t.Eu.get(e);if(i&&i.cu)return Ye().add(i.key);{let o=Ye();const c=t.Pu.get(e);if(!c)return o;for(const d of c){const f=t.hu.get(d);o=o.unionWith(f.view.eu)}return o}}function tj(n){const e=De(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=W0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hO.bind(null,e),e.lu.Y_=eO.bind(null,e.eventManager),e.lu.gu=tO.bind(null,e.eventManager),e}function yO(n){const e=De(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=mO.bind(null,e),e}class kh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rf(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return _M(this.persistence,new xM,e.initialUser,this.serializer)}Su(e){return new V0(av.fi,this.serializer)}bu(e){return new SM}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}kh.provider={build:()=>new kh};class xO extends kh{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Je(this.persistence.referenceDelegate instanceof Mh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new aM(i,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?Sn.withCacheSize(this.cacheSizeBytes):Sn.DEFAULT;return new V0(i=>Mh.fi(i,t),this.serializer)}}class _g{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>B_(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=gO.bind(null,this.syncEngine),await WM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new JM}()}createDatastore(e){const t=rf(e.databaseInfo.databaseId),i=function(c){return new OM(c)}(e.databaseInfo);return function(c,d,f,p){return new VM(c,d,f,p)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,o,c,d,f){return new FM(i,o,c,d,f)}(this.localStore,this.datastore,e.asyncQueue,t=>B_(this.syncEngine,t,0),function(){return V_.C()?new V_:new IM}())}createSyncEngine(e,t){return function(o,c,d,f,p,g,y){const N=new iO(o,c,d,f,p,g);return y&&(N.mu=!0),N}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const c=De(o);ge(Dr,"RemoteStore shutting down."),c.da.add(5),await vu(c),c.Ra.shutdown(),c.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}_g.provider={build:()=>new _g};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Ma("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new pe(ie.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,c){const d=De(o),f={documents:c.map(N=>Dh(d.serializer,N))},p=await d.Yo("BatchGetDocuments",d.serializer.databaseId,ft.emptyPath(),f,c.length),g=new Map;p.forEach(N=>{const j=qD(d.serializer,N);g.set(j.key.toString(),j)});const y=[];return c.forEach(N=>{const j=g.get(N.toString());Je(!!j,55234,{key:N}),y.push(j)}),y}(this.datastore,e);return t.forEach(i=>this.recordVersion(i)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new sf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,i)=>{const o=be.fromPath(i);this.mutations.push(new T0(o,this.precondition(o)))}),await async function(i,o){const c=De(i),d={writes:o.map(f=>M0(c.serializer,f))};await c.zo("Commit",c.serializer.databaseId,ft.emptyPath(),d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw _e(50498,{Uu:e.constructor.name});t=Ae.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new pe(ie.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ae.min())?rn.exists(!1):rn.updateTime(t):rn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ae.min()))throw new pe(ie.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rn.updateTime(t)}return rn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{constructor(e,t,i,o,c){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=o,this.deferred=c,this.Ku=i.maxAttempts,this.x_=new ov(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new bO(this.datastore),t=this.zu(e);t&&t.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(o=>{this.ju(o)}))}).catch(i=>{this.ju(i)})})}zu(e){try{const t=this.updateFunction(e);return!mu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!j0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si="FirestoreClient";class _O{constructor(e,t,i,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=fn.UNAUTHENTICATED,this.clientId=QT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(i,async d=>{ge(Si,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(i,d=>(ge(Si,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=fv(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function Fp(n,e){n.asyncQueue.verifyOperationInProgress(),ge(Si,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async o=>{i.isEqual(o)||(await U0(e.localStore,o),i=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function $_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await EO(n);ge(Si,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>F_(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,o)=>F_(e.remoteStore,o)),n._onlineComponents=e}async function EO(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ge(Si,"Using user provided OfflineComponentProvider");try{await Fp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===ie.FAILED_PRECONDITION||o.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Zo("Error using user provided cache. Falling back to memory cache: "+t),await Fp(n,new kh)}}else ge(Si,"Using default OfflineComponentProvider"),await Fp(n,new xO(void 0));return n._offlineComponents}async function Nv(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ge(Si,"Using user provided OnlineComponentProvider"),await $_(n,n._uninitializedComponentsProvider._online)):(ge(Si,"Using default OnlineComponentProvider"),await $_(n,new _g))),n._onlineComponents}function TO(n){return Nv(n).then(e=>e.syncEngine)}function jO(n){return Nv(n).then(e=>e.datastore)}async function Ph(n){const e=await Nv(n),t=e.eventManager;return t.onListen=rO.bind(null,e.syncEngine),t.onUnlisten=cO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=oO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=uO.bind(null,e.syncEngine),t}function AO(n,e,t={}){const i=new Qs;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,g){const y=new bv({next:j=>{y.xu(),d.enqueueAndForget(()=>pv(c,N));const w=j.docs.has(f);!w&&j.fromCache?g.reject(new pe(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&j.fromCache&&p&&p.source==="server"?g.reject(new pe(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(j)},error:j=>g.reject(j)}),N=new vv(Zh(f.path),y,{includeMetadataChanges:!0,Qa:!0});return mv(c,N)}(await Ph(n),n.asyncQueue,e,t,i)),i.promise}function wO(n,e,t={}){const i=new Qs;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,g){const y=new bv({next:j=>{y.xu(),d.enqueueAndForget(()=>pv(c,N)),j.fromCache&&p.source==="server"?g.reject(new pe(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(j)},error:j=>g.reject(j)}),N=new vv(f,y,{includeMetadataChanges:!0,Qa:!0});return mv(c,N)}(await Ph(n),n.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nj(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sj(n,e,t){if(!t)throw new pe(ie.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function CO(n,e,t,i){if(e===!0&&i===!0)throw new pe(ie.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Q_(n){if(!be.isDocumentKey(n))throw new pe(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function K_(n){if(be.isDocumentKey(n))throw new pe(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function cf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":_e(12329,{type:typeof n})}function Tn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new pe(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=cf(n);throw new pe(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aj="firestore.googleapis.com",X_=!0;class W_{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new pe(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=aj,this.ssl=X_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:X_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=L0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<nM)throw new pe(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}CO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nj((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new pe(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new pe(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new pe(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,o){return i.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class uf{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new W_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pe(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new pe(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new W_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new O1;switch(i.type){case"firstParty":return new V1(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new pe(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=Y_.get(t);i&&(ge("ComponentProvider","Removing Datastore"),Y_.delete(t),i.terminate())}(this),Promise.resolve()}}function SO(n,e,t,i={}){var o;n=Tn(n,uf);const c=Lr(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),p=`${e}:${t}`;c&&(Rg(`https://${p}`),Dg("Firestore",!0)),d.host!==aj&&d.host!==p&&Zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g=Object.assign(Object.assign({},d),{host:p,ssl:c,emulatorOptions:i});if(!Ei(g,f)&&(n._setSettings(g),i.mockUserToken)){let y,N;if(typeof i.mockUserToken=="string")y=i.mockUserToken,N=fn.MOCK_USER;else{y=JE(i.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const j=i.mockUserToken.sub||i.mockUserToken.user_id;if(!j)throw new pe(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");N=new fn(j)}n._authCredentials=new k1(new $T(y,N))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Pa(this.firestore,e,this._query)}}class on{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _i(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new on(this.firestore,e,this._key)}}class _i extends Pa{constructor(e,t,i){super(e,t,Zh(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new on(this.firestore,null,new be(e))}withConverter(e){return new _i(this.firestore,e,this._path)}}function Oe(n,e,...t){if(n=yt(n),sj("collection","path",e),n instanceof uf){const i=ft.fromString(e,...t);return K_(i),new _i(n,null,i)}{if(!(n instanceof on||n instanceof _i))throw new pe(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ft.fromString(e,...t));return K_(i),new _i(n.firestore,null,i)}}function et(n,e,...t){if(n=yt(n),arguments.length===1&&(e=QT.newId()),sj("doc","path",e),n instanceof uf){const i=ft.fromString(e,...t);return Q_(i),new on(n,null,new be(i))}{if(!(n instanceof on||n instanceof _i))throw new pe(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ft.fromString(e,...t));return Q_(i),new on(n.firestore,n instanceof _i?n.converter:null,new be(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z_="AsyncQueue";class J_{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new ov(this,"async_queue_retry"),this.rc=()=>{const i=Up();i&&ge(Z_,"Visibility state changed to "+i.visibilityState),this.x_.b_()},this.sc=e;const t=Up();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Up();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Qs;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!hl(e))throw e;ge(Z_,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(i=>{throw this.Xu=i,this.ec=!1,Ma("INTERNAL UNHANDLED ERROR: ",eE(i)),i}).then(i=>(this.ec=!1,i))));return this.sc=t,t}enqueueAfterDelay(e,t,i){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=hv.createAndSchedule(this,e,t,i,c=>this.uc(c));return this.Zu.push(o),o}oc(){this.Xu&&_e(47125,{cc:eE(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function eE(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(n){return function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of i)if(c in o&&typeof o[c]=="function")return!0;return!1}(n,["next","error","complete"])}class Ws extends uf{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new J_,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new J_(e),this._firestoreClient=void 0,await e}}}function IO(n,e){const t=typeof n=="object"?n:cu(),i=typeof n=="string"?n:Ah,o=ka(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const c=XE("firestore");c&&SO(o,...c)}return o}function xu(n){if(n._terminated)throw new pe(ie.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||RO(n),n._firestoreClient}function RO(n){var e,t,i;const o=n._freezeSettings(),c=function(f,p,g,y){return new J1(f,p,g,y.host,y.ssl,y.experimentalForceLongPolling,y.experimentalAutoDetectLongPolling,nj(y.experimentalLongPollingOptions),y.useFetchStreams,y.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=o.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new _O(n._authCredentials,n._appCheckCredentials,n._queue,c,n._componentsProvider&&function(f){const p=f?._online.build();return{_offline:f?._offline.build(p),_online:p}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mr(ln.fromBase64String(e))}catch(t){throw new pe(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Mr(ln.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new pe(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new an(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new pe(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new pe(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,o){if(i.length!==o.length)return!1;for(let c=0;c<i.length;++c)if(i[c]!==o[c])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DO=/^__.*__$/;class MO{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Vi(e,this.data,this.fieldMask,t,this.fieldTransforms):new pu(e,this.data,t,this.fieldTransforms)}}class ij{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Vi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function rj(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _e(40011,{Ic:n})}}class Tv{constructor(e,t,i,o,c,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,c===void 0&&this.Ec(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Tv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:i,Rc:!1});return o.Vc(e),o}mc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:i,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Lh(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(rj(this.Ic)&&DO.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class OO{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||rf(e)}bc(e,t,i,o=!1){return new Tv({Ic:e,methodName:t,wc:i,path:an.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Nu(n){const e=n._freezeSettings(),t=rf(n._databaseId);return new OO(n._databaseId,!!e.ignoreUndefinedProperties,t)}function jv(n,e,t,i,o,c={}){const d=n.bc(c.merge||c.mergeFields?2:0,e,t,o);wv("Data must be an object, but it was:",d,i);const f=cj(i,d);let p,g;if(c.merge)p=new zn(d.fieldMask),g=d.fieldTransforms;else if(c.mergeFields){const y=[];for(const N of c.mergeFields){const j=Eg(e,N,t);if(!d.contains(j))throw new pe(ie.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);dj(y,j)||y.push(j)}p=new zn(y),g=d.fieldTransforms.filter(N=>p.covers(N.field))}else p=null,g=d.fieldTransforms;return new MO(new En(f),p,g)}class hf extends df{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof hf}}class Av extends df{_toFieldTransform(e){return new jD(e.path,new eu)}isEqual(e){return e instanceof Av}}function oj(n,e,t,i){const o=n.bc(1,e,t);wv("Data must be an object, but it was:",o,i);const c=[],d=En.empty();Li(i,(p,g)=>{const y=Cv(e,p,t);g=yt(g);const N=o.mc(y);if(g instanceof hf)c.push(y);else{const j=_u(g,N);j!=null&&(c.push(y),d.set(y,j))}});const f=new zn(c);return new ij(d,f,o.fieldTransforms)}function lj(n,e,t,i,o,c){const d=n.bc(1,e,t),f=[Eg(e,i,t)],p=[o];if(c.length%2!=0)throw new pe(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<c.length;j+=2)f.push(Eg(e,c[j])),p.push(c[j+1]);const g=[],y=En.empty();for(let j=f.length-1;j>=0;--j)if(!dj(g,f[j])){const w=f[j];let b=p[j];b=yt(b);const A=d.mc(w);if(b instanceof hf)g.push(w);else{const E=_u(b,A);E!=null&&(g.push(w),y.set(w,E))}}const N=new zn(g);return new ij(y,N,d.fieldTransforms)}function kO(n,e,t,i=!1){return _u(t,n.bc(i?4:3,e))}function _u(n,e){if(uj(n=yt(n)))return wv("Unsupported field value:",e,n),cj(n,e);if(n instanceof df)return function(i,o){if(!rj(o.Ic))throw o.gc(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${i._methodName}() is not currently supported inside arrays`);const c=i._toFieldTransform(o);c&&o.fieldTransforms.push(c)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(i,o){const c=[];let d=0;for(const f of i){let p=_u(f,o.fc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}}(n,e)}return function(i,o){if((i=yt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return _D(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const c=qt.fromDate(i);return{timestampValue:Rh(o.serializer,c)}}if(i instanceof qt){const c=new qt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Rh(o.serializer,c)}}if(i instanceof _v)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Mr)return{bytesValue:S0(o.serializer,i._byteString)};if(i instanceof on){const c=o.databaseId,d=i.firestore._databaseId;if(!d.isEqual(c))throw o.gc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:nv(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof Ev)return function(d,f){return{mapValue:{fields:{[n0]:{stringValue:s0},[wh]:{arrayValue:{values:d.toArray().map(g=>{if(typeof g!="number")throw f.gc("VectorValues must only contain numeric values.");return Jg(f.serializer,g)})}}}}}}(i,o);throw o.gc(`Unsupported field value: ${cf(i)}`)}(n,e)}function cj(n,e){const t={};return XT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Li(n,(i,o)=>{const c=_u(o,e.Ac(i));c!=null&&(t[i]=c)}),{mapValue:{fields:t}}}function uj(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qt||n instanceof _v||n instanceof Mr||n instanceof on||n instanceof df||n instanceof Ev)}function wv(n,e,t){if(!uj(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const i=cf(t);throw i==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+i)}}function Eg(n,e,t){if((e=yt(e))instanceof bu)return e._internalPath;if(typeof e=="string")return Cv(n,e);throw Lh("Field path arguments must be of type string or ",n,!1,void 0,t)}const PO=new RegExp("[~\\*/\\[\\]]");function Cv(n,e,t){if(e.search(PO)>=0)throw Lh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new bu(...e.split("."))._internalPath}catch{throw Lh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Lh(n,e,t,i,o){const c=i&&!i.isEmpty(),d=o!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${i}`),d&&(p+=` in document ${o}`),p+=")"),new pe(ie.INVALID_ARGUMENT,f+n+p)}function dj(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,t,i,o,c){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new on(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new LO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ff("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class LO extends Vh{data(){return super.data()}}function ff(n,e){return typeof e=="string"?Cv(n,e):e instanceof bu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hj(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new pe(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Sv{}class Iv extends Sv{}function Ee(n,e,...t){let i=[];e instanceof Sv&&i.push(e),i=i.concat(t),function(c){const d=c.filter(p=>p instanceof Rv).length,f=c.filter(p=>p instanceof mf).length;if(d>1||d>0&&f>0)throw new pe(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const o of i)n=o._apply(n);return n}class mf extends Iv{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new mf(e,t,i)}_apply(e){const t=this._parse(e);return fj(e._query,t),new Pa(e.firestore,e.converter,mg(e._query,t))}_parse(e){const t=Nu(e.firestore);return function(c,d,f,p,g,y,N){let j;if(g.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new pe(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){sE(N,y);const b=[];for(const A of N)b.push(nE(p,c,A));j={arrayValue:{values:b}}}else j=nE(p,c,N)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||sE(N,y),j=kO(f,d,N,y==="in"||y==="not-in");return kt.create(g,y,j)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Se(n,e,t){const i=e,o=ff("where",n);return mf._create(o,i,t)}class Rv extends Sv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Rv(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Es.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,c){let d=o;const f=c.getFlattenedFilters();for(const p of f)fj(d,p),d=mg(d,p)}(e._query,t),new Pa(e.firestore,e.converter,mg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Dv extends Iv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Dv(e,t)}_apply(e){const t=function(o,c,d){if(o.startAt!==null)throw new pe(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new pe(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jc(c,d)}(e._query,this._field,this._direction);return new Pa(e.firestore,e.converter,function(o,c){const d=o.explicitOrderBy.concat([c]);return new fl(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function jn(n,e="asc"){const t=e,i=ff("orderBy",n);return Dv._create(i,t)}class Mv extends Iv{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new Mv(e,t,i)}_apply(e){return new Pa(e.firestore,e.converter,Sh(e._query,this._limit,this._limitType))}}function VO(n){return Mv._create("limit",n,"F")}function nE(n,e,t){if(typeof(t=yt(t))=="string"){if(t==="")throw new pe(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!d0(e)&&t.indexOf("/")!==-1)throw new pe(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(ft.fromString(t));if(!be.isDocumentKey(i))throw new pe(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return g_(n,new be(i))}if(t instanceof on)return g_(n,t._key);throw new pe(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cf(t)}.`)}function sE(n,e){if(!Array.isArray(n)||n.length===0)throw new pe(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function fj(n,e){const t=function(o,c){for(const d of o)for(const f of d.getFlattenedFilters())if(c.indexOf(f.op)>=0)return f.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new pe(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new pe(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class mj{convertValue(e,t="none"){switch(wi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return St(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ai(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw _e(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Li(e,(o,c)=>{i[o]=this.convertValue(c,t)}),i}convertVectorValue(e){var t,i,o;const c=(o=(i=(t=e.fields)===null||t===void 0?void 0:t[wh].arrayValue)===null||i===void 0?void 0:i.values)===null||o===void 0?void 0:o.map(d=>St(d.doubleValue));return new Ev(c)}convertGeoPoint(e){return new _v(St(e.latitude),St(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Wh(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Xc(e));default:return null}}convertTimestamp(e){const t=ji(e);return new qt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=ft.fromString(e);Je(P0(i),9688,{name:e});const o=new Wc(i.get(1),i.get(3)),c=new be(i.popFirst(5));return o.isEqual(t)||Ma(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ov(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class UO extends mj{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class kv extends Vh{constructor(e,t,i,o,c,d){super(e,t,i,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new mh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(ff("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class mh extends kv{data(e={}){return super.data(e)}}class pj{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new zo(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new mh(this._firestore,this._userDataWriter,i.key,i,new zo(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new pe(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map(f=>{const p=new mh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new zo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}})}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(f=>c||f.type!==3).map(f=>{const p=new mh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new zo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,y=-1;return f.type!==0&&(g=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),y=d.indexOf(f.doc.key)),{type:FO(f.type),doc:p,oldIndex:g,newIndex:y}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function FO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _e(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ui(n){n=Tn(n,on);const e=Tn(n.firestore,Ws);return AO(xu(e),n._key).then(t=>gj(e,n,t))}class pf extends mj{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}function mt(n){n=Tn(n,Pa);const e=Tn(n.firestore,Ws),t=xu(e),i=new pf(e);return hj(n._query),wO(t,n._query).then(o=>new pj(e,i,n,o))}function gf(n,e,t){n=Tn(n,on);const i=Tn(n.firestore,Ws),o=Ov(n.converter,e,t);return yf(i,[jv(Nu(i),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,rn.none())])}function Ts(n,e,t,...i){n=Tn(n,on);const o=Tn(n.firestore,Ws),c=Nu(o);let d;return d=typeof(e=yt(e))=="string"||e instanceof bu?lj(c,"updateDoc",n._key,e,t,i):oj(c,"updateDoc",n._key,e),yf(o,[d.toMutation(n._key,rn.exists(!0))])}function vf(n){return yf(Tn(n.firestore,Ws),[new sf(n._key,rn.none())])}function pl(n,e){const t=Tn(n.firestore,Ws),i=et(n),o=Ov(n.converter,e);return yf(t,[jv(Nu(n.firestore),"addDoc",i._key,o,n.converter!==null,{}).toMutation(i._key,rn.exists(!1))]).then(()=>i)}function qr(n,...e){var t,i,o;n=yt(n);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||tE(e[d])||(c=e[d],d++);const f={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(tE(e[d])){const N=e[d];e[d]=(t=N.next)===null||t===void 0?void 0:t.bind(N),e[d+1]=(i=N.error)===null||i===void 0?void 0:i.bind(N),e[d+2]=(o=N.complete)===null||o===void 0?void 0:o.bind(N)}let p,g,y;if(n instanceof on)g=Tn(n.firestore,Ws),y=Zh(n._key.path),p={next:N=>{e[d]&&e[d](gj(g,n,N))},error:e[d+1],complete:e[d+2]};else{const N=Tn(n,Pa);g=Tn(N.firestore,Ws),y=N._query;const j=new pf(g);p={next:w=>{e[d]&&e[d](new pj(g,j,N,w))},error:e[d+1],complete:e[d+2]},hj(n._query)}return function(j,w,b,A){const E=new bv(A),D=new vv(w,E,b);return j.asyncQueue.enqueueAndForget(async()=>mv(await Ph(j),D)),()=>{E.xu(),j.asyncQueue.enqueueAndForget(async()=>pv(await Ph(j),D))}}(xu(g),y,f,p)}function yf(n,e){return function(i,o){const c=new Qs;return i.asyncQueue.enqueueAndForget(async()=>dO(await TO(i),o,c)),c.promise}(xu(n),e)}function gj(n,e,t){const i=t.docs.get(e._key),o=new pf(n);return new kv(n,o,e._key,i,new zo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qO={maxAttempts:5};function Mc(n,e){if((n=yt(n)).firestore!==e)throw new pe(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Nu(e)}get(e){const t=Mc(e,this._firestore),i=new UO(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return _e(24041);const c=o[0];if(c.isFoundDocument())return new Vh(this._firestore,i,c.key,c,t.converter);if(c.isNoDocument())return new Vh(this._firestore,i,t._key,null,t.converter);throw _e(18433,{doc:c})})}set(e,t,i){const o=Mc(e,this._firestore),c=Ov(o.converter,t,i),d=jv(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,i);return this._transaction.set(o._key,d),this}update(e,t,i,...o){const c=Mc(e,this._firestore);let d;return d=typeof(t=yt(t))=="string"||t instanceof bu?lj(this._dataReader,"Transaction.update",c._key,t,i,o):oj(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,d),this}delete(e){const t=Mc(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO extends zO{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Mc(e,this._firestore),i=new pf(this._firestore);return super.get(e).then(o=>new kv(this._firestore,i,t._key,o._document,new zo(!1,!1),t.converter))}}function Pv(n,e,t){n=Tn(n,Ws);const i=Object.assign(Object.assign({},qO),t);return function(c){if(c.maxAttempts<1)throw new pe(ie.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(c,d,f){const p=new Qs;return c.asyncQueue.enqueueAndForget(async()=>{const g=await jO(c);new NO(c.asyncQueue,g,f,d,p).Wu()}),p.promise}(xu(n),o=>e(new HO(n,o)),i)}function Ue(){return new Av("serverTimestamp")}(function(e,t=!0){(function(o){ul=o})(Vr),ls(new $n("firestore",(i,{instanceIdentifier:o,options:c})=>{const d=i.getProvider("app").getImmediate(),f=new Ws(new P1(i.getProvider("auth-internal")),new U1(d,i.getProvider("app-check-internal")),function(g,y){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new pe(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wc(g.options.projectId,y)}(d,o),d);return c=Object.assign({useFetchStreams:t},c),f._setSettings(c),f},"PUBLIC").setMultipleInstances(!0)),pn(a_,i_,e),pn(a_,i_,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj="firebasestorage.googleapis.com",BO="storageBucket",GO=2*60*1e3,$O=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js extends us{constructor(e,t,i=0){super(qp(e),`Firebase Storage: ${t} (${qp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Js.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Zs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Zs||(Zs={}));function qp(n){return"storage/"+n}function YO(){const n="An unknown error occurred, please check the error payload for server response.";return new Js(Zs.UNKNOWN,n)}function QO(){return new Js(Zs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function KO(){return new Js(Zs.CANCELED,"User canceled the upload/download.")}function XO(n){return new Js(Zs.INVALID_URL,"Invalid URL '"+n+"'.")}function WO(n){return new Js(Zs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function aE(n){return new Js(Zs.INVALID_ARGUMENT,n)}function yj(){return new Js(Zs.APP_DELETED,"The Firebase app was deleted.")}function ZO(n){return new Js(Zs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Ns.makeFromUrl(e,t)}catch{return new Ns(e,"")}if(i.path==="")return i;throw WO(e)}static makeFromUrl(e,t){let i=null;const o="([A-Za-z0-9.\\-_]+)";function c(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const d="(/(.*))?$",f=new RegExp("^gs://"+o+d,"i"),p={bucket:1,path:3};function g(P){P.path_=decodeURIComponent(P.path)}const y="v[A-Za-z0-9_]+",N=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",w=new RegExp(`^https?://${N}/${y}/b/${o}/o${j}`,"i"),b={bucket:1,path:3},A=t===vj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,E="([^?#]*)",D=new RegExp(`^https?://${A}/${o}/${E}`,"i"),U=[{regex:f,indices:p,postModify:c},{regex:w,indices:b,postModify:g},{regex:D,indices:{bucket:1,path:2},postModify:g}];for(let P=0;P<U.length;P++){const F=U[P],$=F.regex.exec(e);if($){const L=$[F.indices.bucket];let S=$[F.indices.path];S||(S=""),i=new Ns(L,S),F.postModify(i);break}}if(i==null)throw XO(e);return i}}class JO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ek(n,e,t){let i=1,o=null,c=null,d=!1,f=0;function p(){return f===2}let g=!1;function y(...E){g||(g=!0,e.apply(null,E))}function N(E){o=setTimeout(()=>{o=null,n(w,p())},E)}function j(){c&&clearTimeout(c)}function w(E,...D){if(g){j();return}if(E){j(),y.call(null,E,...D);return}if(p()||d){j(),y.call(null,E,...D);return}i<64&&(i*=2);let U;f===1?(f=2,U=0):U=(i+Math.random())*1e3,N(U)}let b=!1;function A(E){b||(b=!0,j(),!g&&(o!==null?(E||(f=2),clearTimeout(o),N(0)):E||(f=1)))}return N(0),c=setTimeout(()=>{d=!0,A(!0)},t),A}function tk(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nk(n){return n!==void 0}function iE(n,e,t,i){if(i<e)throw aE(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw aE(`Invalid value for '${n}'. Expected ${t} or less.`)}function sk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const o=e(i)+"="+e(n[i]);t=t+o+"&"}return t=t.slice(0,-1),t}var Uh;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Uh||(Uh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ak(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(e,t,i,o,c,d,f,p,g,y,N,j=!0,w=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=f,this.errorCallback_=p,this.timeout_=g,this.progressCallback_=y,this.connectionFactory_=N,this.retry=j,this.isUsingEmulator=w,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,A)=>{this.resolve_=b,this.reject_=A,this.start_()})}start_(){const e=(i,o)=>{if(o){i(!1,new nh(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=f=>{const p=f.loaded,g=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,g)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const f=c.getErrorCode()===Uh.NO_ERROR,p=c.getStatus();if(!f||ak(p,this.additionalRetryCodes_)&&this.retry){const y=c.getErrorCode()===Uh.ABORT;i(!1,new nh(!1,null,y));return}const g=this.successCodes_.indexOf(p)!==-1;i(!0,new nh(g,c))})},t=(i,o)=>{const c=this.resolve_,d=this.reject_,f=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(f,f.getResponse());nk(p)?c(p):c()}catch(p){d(p)}else if(f!==null){const p=YO();p.serverResponse=f.getErrorText(),this.errorCallback_?d(this.errorCallback_(f,p)):d(p)}else if(o.canceled){const p=this.appDelete_?yj():KO();d(p)}else{const p=QO();d(p)}};this.canceled_?t(!1,new nh(!1,null,!0)):this.backoffId_=ek(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&tk(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class nh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function rk(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function ok(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function lk(n,e){e&&(n["X-Firebase-GMPID"]=e)}function ck(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function uk(n,e,t,i,o,c,d=!0,f=!1){const p=sk(n.urlParams),g=n.url+p,y=Object.assign({},n.headers);return lk(y,e),rk(y,t),ok(y,c),ck(y,i),new ik(g,n.method,y,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,f)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function hk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,t){this._service=e,t instanceof Ns?this._location=t:this._location=Ns.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Fh(e,t)}get root(){const e=new Ns(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return hk(this._location.path)}get storage(){return this._service}get parent(){const e=dk(this._location.path);if(e===null)return null;const t=new Ns(this._location.bucket,e);return new Fh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw ZO(e)}}function rE(n,e){const t=e?.[BO];return t==null?null:Ns.makeFromBucketSpec(t,n)}function fk(n,e,t,i={}){n.host=`${e}:${t}`;const o=Lr(e);o&&(Rg(`https://${n.host}/b`),Dg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=i;c&&(n._overrideAuthToken=typeof c=="string"?c:JE(c,n.app.options.projectId))}class mk{constructor(e,t,i,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=vj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=GO,this._maxUploadRetryTime=$O,this._requests=new Set,o!=null?this._bucket=Ns.makeFromBucketSpec(o,this._host):this._bucket=rE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ns.makeFromBucketSpec(this._url,e):this._bucket=rE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){iE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){iE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(In(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Fh(this,e)}_makeRequest(e,t,i,o,c=!0){if(this._deleted)return new JO(yj());{const d=uk(e,this._appId,i,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,o).getPromise()}}const oE="@firebase/storage",lE="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xj="storage";function pk(n=cu(),e){n=yt(n);const i=ka(n,xj).getImmediate({identifier:e}),o=XE("storage");return o&&gk(i,...o),i}function gk(n,e,t,i={}){fk(n,e,t,i)}function vk(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new mk(t,i,o,e,Vr)}function yk(){ls(new $n(xj,vk,"PUBLIC").setMultipleInstances(!0)),pn(oE,lE,""),pn(oE,lE,"esm2017")}yk();const bj="@firebase/installations",Lv="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj=1e4,_j=`w:${Lv}`,Ej="FIS_v2",xk="https://firebaseinstallations.googleapis.com/v1",bk=60*60*1e3,Nk="installations",_k="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Or=new Mi(Nk,_k,Ek);function Tj(n){return n instanceof us&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jj({projectId:n}){return`${xk}/projects/${n}/installations`}function Aj(n){return{token:n.token,requestStatus:2,expiresIn:jk(n.expiresIn),creationTime:Date.now()}}async function wj(n,e){const i=(await e.json()).error;return Or.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function Cj({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function Tk(n,{refreshToken:e}){const t=Cj(n);return t.append("Authorization",Ak(e)),t}async function Sj(n){const e=await n();return e.status>=500&&e.status<600?n():e}function jk(n){return Number(n.replace("s","000"))}function Ak(n){return`${Ej} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wk({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=jj(n),o=Cj(n),c=e.getImmediate({optional:!0});if(c){const g=await c.getHeartbeatsHeader();g&&o.append("x-firebase-client",g)}const d={fid:t,authVersion:Ej,appId:n.appId,sdkVersion:_j},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await Sj(()=>fetch(i,f));if(p.ok){const g=await p.json();return{fid:g.fid||t,registrationStatus:2,refreshToken:g.refreshToken,authToken:Aj(g.authToken)}}else throw await wj("Create Installation",p)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ij(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ck(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk=/^[cdef][\w-]{21}$/,Tg="";function Ik(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=Rk(n);return Sk.test(t)?t:Tg}catch{return Tg}}function Rk(n){return Ck(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj=new Map;function Dj(n,e){const t=xf(n);Mj(t,e),Dk(t,e)}function Mj(n,e){const t=Rj.get(n);if(t)for(const i of t)i(e)}function Dk(n,e){const t=Mk();t&&t.postMessage({key:n,fid:e}),Ok()}let wr=null;function Mk(){return!wr&&"BroadcastChannel"in self&&(wr=new BroadcastChannel("[Firebase] FID Change"),wr.onmessage=n=>{Mj(n.data.key,n.data.fid)}),wr}function Ok(){Rj.size===0&&wr&&(wr.close(),wr=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk="firebase-installations-database",Pk=1,kr="firebase-installations-store";let zp=null;function Vv(){return zp||(zp=nT(kk,Pk,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(kr)}}})),zp}async function qh(n,e){const t=xf(n),o=(await Vv()).transaction(kr,"readwrite"),c=o.objectStore(kr),d=await c.get(t);return await c.put(e,t),await o.done,(!d||d.fid!==e.fid)&&Dj(n,e.fid),e}async function Oj(n){const e=xf(n),i=(await Vv()).transaction(kr,"readwrite");await i.objectStore(kr).delete(e),await i.done}async function bf(n,e){const t=xf(n),o=(await Vv()).transaction(kr,"readwrite"),c=o.objectStore(kr),d=await c.get(t),f=e(d);return f===void 0?await c.delete(t):await c.put(f,t),await o.done,f&&(!d||d.fid!==f.fid)&&Dj(n,f.fid),f}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uv(n){let e;const t=await bf(n.appConfig,i=>{const o=Lk(i),c=Vk(n,o);return e=c.registrationPromise,c.installationEntry});return t.fid===Tg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function Lk(n){const e=n||{fid:Ik(),registrationStatus:0};return kj(e)}function Vk(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject(Or.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=Uk(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Fk(n)}:{installationEntry:e}}async function Uk(n,e){try{const t=await wk(n,e);return qh(n.appConfig,t)}catch(t){throw Tj(t)&&t.customData.serverCode===409?await Oj(n.appConfig):await qh(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Fk(n){let e=await cE(n.appConfig);for(;e.registrationStatus===1;)await Ij(100),e=await cE(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await Uv(n);return i||t}return e}function cE(n){return bf(n,e=>{if(!e)throw Or.create("installation-not-found");return kj(e)})}function kj(n){return qk(n)?{fid:n.fid,registrationStatus:0}:n}function qk(n){return n.registrationStatus===1&&n.registrationTime+Nj<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zk({appConfig:n,heartbeatServiceProvider:e},t){const i=Hk(n,t),o=Tk(n,t),c=e.getImmediate({optional:!0});if(c){const g=await c.getHeartbeatsHeader();g&&o.append("x-firebase-client",g)}const d={installation:{sdkVersion:_j,appId:n.appId}},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await Sj(()=>fetch(i,f));if(p.ok){const g=await p.json();return Aj(g)}else throw await wj("Generate Auth Token",p)}function Hk(n,{fid:e}){return`${jj(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fv(n,e=!1){let t;const i=await bf(n.appConfig,c=>{if(!Pj(c))throw Or.create("not-registered");const d=c.authToken;if(!e&&$k(d))return c;if(d.requestStatus===1)return t=Bk(n,e),c;{if(!navigator.onLine)throw Or.create("app-offline");const f=Qk(c);return t=Gk(n,f),f}});return t?await t:i.authToken}async function Bk(n,e){let t=await uE(n.appConfig);for(;t.authToken.requestStatus===1;)await Ij(100),t=await uE(n.appConfig);const i=t.authToken;return i.requestStatus===0?Fv(n,e):i}function uE(n){return bf(n,e=>{if(!Pj(e))throw Or.create("not-registered");const t=e.authToken;return Kk(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Gk(n,e){try{const t=await zk(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return await qh(n.appConfig,i),t}catch(t){if(Tj(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await Oj(n.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await qh(n.appConfig,i)}throw t}}function Pj(n){return n!==void 0&&n.registrationStatus===2}function $k(n){return n.requestStatus===2&&!Yk(n)}function Yk(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+bk}function Qk(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function Kk(n){return n.requestStatus===1&&n.requestTime+Nj<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xk(n){const e=n,{installationEntry:t,registrationPromise:i}=await Uv(e);return i?i.catch(console.error):Fv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wk(n,e=!1){const t=n;return await Zk(t),(await Fv(t,e)).token}async function Zk(n){const{registrationPromise:e}=await Uv(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jk(n){if(!n||!n.options)throw Hp("App Configuration");if(!n.name)throw Hp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Hp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Hp(n){return Or.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lj="installations",eP="installations-internal",tP=n=>{const e=n.getProvider("app").getImmediate(),t=Jk(e),i=ka(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},nP=n=>{const e=n.getProvider("app").getImmediate(),t=ka(e,Lj).getImmediate();return{getId:()=>Xk(t),getToken:o=>Wk(t,o)}};function sP(){ls(new $n(Lj,tP,"PUBLIC")),ls(new $n(eP,nP,"PRIVATE"))}sP();pn(bj,Lv);pn(bj,Lv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh="analytics",aP="firebase_id",iP="origin",rP=60*1e3,oP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",qv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new lu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Gn=new Mi("analytics","Analytics",lP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cP(n){if(!n.startsWith(qv)){const e=Gn.create("invalid-gtag-resource",{gtagURL:n});return Rn.warn(e.message),""}return n}function Vj(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function uP(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function dP(n,e){const t=uP("firebase-js-sdk-policy",{createScriptURL:cP}),i=document.createElement("script"),o=`${qv}?l=${n}&id=${e}`;i.src=t?t?.createScriptURL(o):o,i.async=!0,document.head.appendChild(i)}function hP(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function fP(n,e,t,i,o,c){const d=i[o];try{if(d)await e[d];else{const p=(await Vj(t)).find(g=>g.measurementId===o);p&&await e[p.appId]}}catch(f){Rn.error(f)}n("config",o,c)}async function mP(n,e,t,i,o){try{let c=[];if(o&&o.send_to){let d=o.send_to;Array.isArray(d)||(d=[d]);const f=await Vj(t);for(const p of d){const g=f.find(N=>N.measurementId===p),y=g&&e[g.appId];if(y)c.push(y);else{c=[];break}}}c.length===0&&(c=Object.values(e)),await Promise.all(c),n("event",i,o||{})}catch(c){Rn.error(c)}}function pP(n,e,t,i){async function o(c,...d){try{if(c==="event"){const[f,p]=d;await mP(n,e,t,f,p)}else if(c==="config"){const[f,p]=d;await fP(n,e,t,i,f,p)}else if(c==="consent"){const[f,p]=d;n("consent",f,p)}else if(c==="get"){const[f,p,g]=d;n("get",f,p,g)}else if(c==="set"){const[f]=d;n("set",f)}else n(c,...d)}catch(f){Rn.error(f)}}return o}function gP(n,e,t,i,o){let c=function(...d){window[i].push(arguments)};return window[o]&&typeof window[o]=="function"&&(c=window[o]),window[o]=pP(c,n,e,t),{gtagCore:c,wrappedGtag:window[o]}}function vP(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(qv)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP=30,xP=1e3;class bP{constructor(e={},t=xP){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Uj=new bP;function NP(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function _P(n){var e;const{appId:t,apiKey:i}=n,o={method:"GET",headers:NP(i)},c=oP.replace("{app-id}",t),d=await fetch(c,o);if(d.status!==200&&d.status!==304){let f="";try{const p=await d.json();!((e=p.error)===null||e===void 0)&&e.message&&(f=p.error.message)}catch{}throw Gn.create("config-fetch-failed",{httpStatus:d.status,responseMessage:f})}return d.json()}async function EP(n,e=Uj,t){const{appId:i,apiKey:o,measurementId:c}=n.options;if(!i)throw Gn.create("no-app-id");if(!o){if(c)return{measurementId:c,appId:i};throw Gn.create("no-api-key")}const d=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},f=new AP;return setTimeout(async()=>{f.abort()},rP),Fj({appId:i,apiKey:o,measurementId:c},d,f,e)}async function Fj(n,{throttleEndTimeMillis:e,backoffCount:t},i,o=Uj){var c;const{appId:d,measurementId:f}=n;try{await TP(i,e)}catch(p){if(f)return Rn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:d,measurementId:f};throw p}try{const p=await _P(n);return o.deleteThrottleMetadata(d),p}catch(p){const g=p;if(!jP(g)){if(o.deleteThrottleMetadata(d),f)return Rn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:d,measurementId:f};throw p}const y=Number((c=g?.customData)===null||c===void 0?void 0:c.httpStatus)===503?SN(t,o.intervalMillis,yP):SN(t,o.intervalMillis),N={throttleEndTimeMillis:Date.now()+y,backoffCount:t+1};return o.setThrottleMetadata(d,N),Rn.debug(`Calling attemptFetch again in ${y} millis`),Fj(n,N,i,o)}}function TP(n,e){return new Promise((t,i)=>{const o=Math.max(e-Date.now(),0),c=setTimeout(t,o);n.addEventListener(()=>{clearTimeout(c),i(Gn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function jP(n){if(!(n instanceof us)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class AP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function wP(n,e,t,i,o){if(o&&o.global){n("event",t,i);return}else{const c=await e,d=Object.assign(Object.assign({},i),{send_to:c});n("event",t,d)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CP(){if(Gh())try{await $h()}catch(n){return Rn.warn(Gn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Rn.warn(Gn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function SP(n,e,t,i,o,c,d){var f;const p=EP(n);p.then(w=>{t[w.measurementId]=w.appId,n.options.measurementId&&w.measurementId!==n.options.measurementId&&Rn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${w.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(w=>Rn.error(w)),e.push(p);const g=CP().then(w=>{if(w)return i.getId()}),[y,N]=await Promise.all([p,g]);vP(c)||dP(c,y.measurementId),o("js",new Date);const j=(f=d?.config)!==null&&f!==void 0?f:{};return j[iP]="firebase",j.update=!0,N!=null&&(j[aP]=N),o("config",y.measurementId,j),y.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e){this.app=e}_delete(){return delete qc[this.app.options.appId],Promise.resolve()}}let qc={},dE=[];const hE={};let Bp="dataLayer",RP="gtag",fE,qj,mE=!1;function DP(){const n=[];if(Mg()&&n.push("This is a browser extension environment."),Og()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,o)=>`(${o+1}) ${i}`).join(" "),t=Gn.create("invalid-analytics-context",{errorInfo:e});Rn.warn(t.message)}}function MP(n,e,t){DP();const i=n.options.appId;if(!i)throw Gn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Rn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Gn.create("no-api-key");if(qc[i]!=null)throw Gn.create("already-exists",{id:i});if(!mE){hP(Bp);const{wrappedGtag:c,gtagCore:d}=gP(qc,dE,hE,Bp,RP);qj=c,fE=d,mE=!0}return qc[i]=SP(n,dE,hE,e,fE,Bp,t),new IP(n)}function OP(n=cu()){n=yt(n);const e=ka(n,zh);return e.isInitialized()?e.getImmediate():kP(n)}function kP(n,e={}){const t=ka(n,zh);if(t.isInitialized()){const o=t.getImmediate();if(Ei(e,t.getOptions()))return o;throw Gn.create("already-initialized")}return t.initialize({options:e})}async function PP(){if(Mg()||!Og()||!Gh())return!1;try{return await $h()}catch{return!1}}function LP(n,e,t,i){n=yt(n),wP(qj,qc[n.app.options.appId],e,t,i).catch(o=>Rn.error(o))}const pE="@firebase/analytics",gE="0.10.16";function VP(){ls(new $n(zh,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return MP(i,o,t)},"PUBLIC")),ls(new $n("analytics-internal",n,"PRIVATE")),pn(pE,gE),pn(pE,gE,"esm2017");function n(e){try{const t=e.getProvider(zh).getImmediate();return{logEvent:(i,o,c)=>LP(t,i,o,c)}}catch(t){throw Gn.create("interop-component-reg-failed",{reason:t})}}}VP();var jg,vE,Nf=function(){var n=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(n&&n.responseStart>0&&n.responseStart<performance.now())return n},zj=function(n){if(document.readyState==="loading")return"loading";var e=Nf();if(e){if(n<e.domInteractive)return"loading";if(e.domContentLoadedEventStart===0||n<e.domContentLoadedEventStart)return"dom-interactive";if(e.domComplete===0||n<e.domComplete)return"dom-content-loaded"}return"complete"},UP=function(n){var e=n.nodeName;return n.nodeType===1?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},zv=function(n,e){var t="";try{for(;n&&n.nodeType!==9;){var i=n,o=i.id?"#"+i.id:UP(i)+(i.classList&&i.classList.value&&i.classList.value.trim()&&i.classList.value.trim().length?"."+i.classList.value.trim().replace(/\s+/g,"."):"");if(t.length+o.length>(e||100)-1)return t||o;if(t=t?o+">"+t:o,i.id)break;n=i.parentNode}}catch{}return t},Hj=-1,FP=function(){return Hj},Eu=function(n){addEventListener("pageshow",function(e){e.persisted&&(Hj=e.timeStamp,n(e))},!0)},Hv=function(){var n=Nf();return n&&n.activationStart||0},Ii=function(n,e){var t=Nf(),i="navigate";return FP()>=0?i="back-forward-cache":t&&(document.prerendering||Hv()>0?i="prerender":document.wasDiscarded?i="restore":t.type&&(i=t.type.replace(/_/g,"-"))),{name:n,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},gl=function(n,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(n)){var i=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return i.observe(Object.assign({type:n,buffered:!0},t||{})),i}}catch{}},Ri=function(n,e,t,i){var o,c;return function(d){e.value>=0&&(d||i)&&((c=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=c,e.rating=function(f,p){return f>p[1]?"poor":f>p[0]?"needs-improvement":"good"}(e.value,t),n(e))}},Bv=function(n){requestAnimationFrame(function(){return requestAnimationFrame(function(){return n()})})},_f=function(n){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&n()})},Gv=function(n){var e=!1;return function(){e||(n(),e=!0)}},Ho=-1,yE=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},Hh=function(n){document.visibilityState==="hidden"&&Ho>-1&&(Ho=n.type==="visibilitychange"?n.timeStamp:0,qP())},xE=function(){addEventListener("visibilitychange",Hh,!0),addEventListener("prerenderingchange",Hh,!0)},qP=function(){removeEventListener("visibilitychange",Hh,!0),removeEventListener("prerenderingchange",Hh,!0)},Bj=function(){return Ho<0&&(Ho=yE(),xE(),Eu(function(){setTimeout(function(){Ho=yE(),xE()},0)})),{get firstHiddenTime(){return Ho}}},$v=function(n){document.prerendering?addEventListener("prerenderingchange",function(){return n()},!0):n()},bE=[1800,3e3],zP=function(n,e){e=e||{},$v(function(){var t,i=Bj(),o=Ii("FCP"),c=gl("paint",function(d){d.forEach(function(f){f.name==="first-contentful-paint"&&(c.disconnect(),f.startTime<i.firstHiddenTime&&(o.value=Math.max(f.startTime-Hv(),0),o.entries.push(f),t(!0)))})});c&&(t=Ri(n,o,bE,e.reportAllChanges),Eu(function(d){o=Ii("FCP"),t=Ri(n,o,bE,e.reportAllChanges),Bv(function(){o.value=performance.now()-d.timeStamp,t(!0)})}))})},NE=[.1,.25],HP=function(n,e){(function(t,i){i=i||{},zP(Gv(function(){var o,c=Ii("CLS",0),d=0,f=[],p=function(y){y.forEach(function(N){if(!N.hadRecentInput){var j=f[0],w=f[f.length-1];d&&N.startTime-w.startTime<1e3&&N.startTime-j.startTime<5e3?(d+=N.value,f.push(N)):(d=N.value,f=[N])}}),d>c.value&&(c.value=d,c.entries=f,o())},g=gl("layout-shift",p);g&&(o=Ri(t,c,NE,i.reportAllChanges),_f(function(){p(g.takeRecords()),o(!0)}),Eu(function(){d=0,c=Ii("CLS",0),o=Ri(t,c,NE,i.reportAllChanges),Bv(function(){return o()})}),setTimeout(o,0))}))})(function(t){var i=function(o){var c,d={};if(o.entries.length){var f=o.entries.reduce(function(g,y){return g&&g.value>y.value?g:y});if(f&&f.sources&&f.sources.length){var p=(c=f.sources).find(function(g){return g.node&&g.node.nodeType===1})||c[0];p&&(d={largestShiftTarget:zv(p.node),largestShiftTime:f.startTime,largestShiftValue:f.value,largestShiftSource:p,largestShiftEntry:f,loadState:zj(f.startTime)})}}return Object.assign(o,{attribution:d})}(t);n(i)},e)},Gj=0,Gp=1/0,sh=0,BP=function(n){n.forEach(function(e){e.interactionId&&(Gp=Math.min(Gp,e.interactionId),sh=Math.max(sh,e.interactionId),Gj=sh?(sh-Gp)/7+1:0)})},$j=function(){return jg?Gj:performance.interactionCount||0},GP=function(){"interactionCount"in performance||jg||(jg=gl("event",BP,{type:"event",buffered:!0,durationThreshold:0}))},ys=[],zc=new Map,Yj=0,$P=function(){var n=Math.min(ys.length-1,Math.floor(($j()-Yj)/50));return ys[n]},Qj=[],YP=function(n){if(Qj.forEach(function(o){return o(n)}),n.interactionId||n.entryType==="first-input"){var e=ys[ys.length-1],t=zc.get(n.interactionId);if(t||ys.length<10||n.duration>e.latency){if(t)n.duration>t.latency?(t.entries=[n],t.latency=n.duration):n.duration===t.latency&&n.startTime===t.entries[0].startTime&&t.entries.push(n);else{var i={id:n.interactionId,latency:n.duration,entries:[n]};zc.set(i.id,i),ys.push(i)}ys.sort(function(o,c){return c.latency-o.latency}),ys.length>10&&ys.splice(10).forEach(function(o){return zc.delete(o.id)})}}},Yv=function(n){var e=self.requestIdleCallback||self.setTimeout,t=-1;return n=Gv(n),document.visibilityState==="hidden"?n():(t=e(n),_f(n)),t},_E=[200,500],QP=function(n,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},$v(function(){var t;GP();var i,o=Ii("INP"),c=function(f){Yv(function(){f.forEach(YP);var p=$P();p&&p.latency!==o.value&&(o.value=p.latency,o.entries=p.entries,i())})},d=gl("event",c,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});i=Ri(n,o,_E,e.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),_f(function(){c(d.takeRecords()),i(!0)}),Eu(function(){Yj=$j(),ys.length=0,zc.clear(),o=Ii("INP"),i=Ri(n,o,_E,e.reportAllChanges)}))}))},Xo=[],vi=[],Ag=0,Qv=new WeakMap,Wo=new Map,wg=-1,KP=function(n){Xo=Xo.concat(n),Kj()},Kj=function(){wg<0&&(wg=Yv(XP))},XP=function(){Wo.size>10&&Wo.forEach(function(d,f){zc.has(f)||Wo.delete(f)});var n=ys.map(function(d){return Qv.get(d.entries[0])}),e=vi.length-50;vi=vi.filter(function(d,f){return f>=e||n.includes(d)});for(var t=new Set,i=0;i<vi.length;i++){var o=vi[i];Xj(o.startTime,o.processingEnd).forEach(function(d){t.add(d)})}var c=Xo.length-1-50;Xo=Xo.filter(function(d,f){return d.startTime>Ag&&f>c||t.has(d)}),wg=-1};Qj.push(function(n){n.interactionId&&n.target&&!Wo.has(n.interactionId)&&Wo.set(n.interactionId,n.target)},function(n){var e,t=n.startTime+n.duration;Ag=Math.max(Ag,n.processingEnd);for(var i=vi.length-1;i>=0;i--){var o=vi[i];if(Math.abs(t-o.renderTime)<=8){(e=o).startTime=Math.min(n.startTime,e.startTime),e.processingStart=Math.min(n.processingStart,e.processingStart),e.processingEnd=Math.max(n.processingEnd,e.processingEnd),e.entries.push(n);break}}e||(e={startTime:n.startTime,processingStart:n.processingStart,processingEnd:n.processingEnd,renderTime:t,entries:[n]},vi.push(e)),(n.interactionId||n.entryType==="first-input")&&Qv.set(n,e),Kj()});var Xj=function(n,e){for(var t,i=[],o=0;t=Xo[o];o++)if(!(t.startTime+t.duration<n)){if(t.startTime>e)break;i.push(t)}return i},WP=function(n,e){vE||(vE=gl("long-animation-frame",KP)),QP(function(t){var i=function(o){var c=o.entries[0],d=Qv.get(c),f=c.processingStart,p=d.processingEnd,g=d.entries.sort(function(E,D){return E.processingStart-D.processingStart}),y=Xj(c.startTime,p),N=o.entries.find(function(E){return E.target}),j=N&&N.target||Wo.get(c.interactionId),w=[c.startTime+c.duration,p].concat(y.map(function(E){return E.startTime+E.duration})),b=Math.max.apply(Math,w),A={interactionTarget:zv(j),interactionTargetElement:j,interactionType:c.name.startsWith("key")?"keyboard":"pointer",interactionTime:c.startTime,nextPaintTime:b,processedEventEntries:g,longAnimationFrameEntries:y,inputDelay:f-c.startTime,processingDuration:p-f,presentationDelay:Math.max(b-p,0),loadState:zj(c.startTime)};return Object.assign(o,{attribution:A})}(t);n(i)},e)},EE=[2500,4e3],$p={},ZP=function(n,e){(function(t,i){i=i||{},$v(function(){var o,c=Bj(),d=Ii("LCP"),f=function(y){i.reportAllChanges||(y=y.slice(-1)),y.forEach(function(N){N.startTime<c.firstHiddenTime&&(d.value=Math.max(N.startTime-Hv(),0),d.entries=[N],o())})},p=gl("largest-contentful-paint",f);if(p){o=Ri(t,d,EE,i.reportAllChanges);var g=Gv(function(){$p[d.id]||(f(p.takeRecords()),p.disconnect(),$p[d.id]=!0,o(!0))});["keydown","click"].forEach(function(y){addEventListener(y,function(){return Yv(g)},{once:!0,capture:!0})}),_f(g),Eu(function(y){d=Ii("LCP"),o=Ri(t,d,EE,i.reportAllChanges),Bv(function(){d.value=performance.now()-y.timeStamp,$p[d.id]=!0,o(!0)})})}})})(function(t){var i=function(o){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:o.value};if(o.entries.length){var d=Nf();if(d){var f=d.activationStart||0,p=o.entries[o.entries.length-1],g=p.url&&performance.getEntriesByType("resource").filter(function(b){return b.name===p.url})[0],y=Math.max(0,d.responseStart-f),N=Math.max(y,g?(g.requestStart||g.startTime)-f:0),j=Math.max(N,g?g.responseEnd-f:0),w=Math.max(j,p.startTime-f);c={element:zv(p.element),timeToFirstByte:y,resourceLoadDelay:N-y,resourceLoadDuration:j-N,elementRenderDelay:w-j,navigationEntry:d,lcpEntry:p},p.url&&(c.url=p.url),g&&(c.lcpResourceEntry=g)}}return Object.assign(o,{attribution:c})}(t);n(i)},e)};const TE="@firebase/performance",Cg="0.7.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj=Cg,JP="FB-PERF-TRACE-START",e2="FB-PERF-TRACE-STOP",Sg="FB-PERF-TRACE-MEASURE",Zj="_wt_",Jj="_fp",eA="_fcp",tA="_fid",nA="_lcp",t2="lcp_element",sA="_inp",n2="inp_interactionTarget",aA="_cls",s2="cls_largestShiftTarget",iA="@firebase/performance/config",rA="@firebase/performance/configexpire",a2="performance",oA="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},mn=new Mi(a2,oA,i2);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di=new lu(oA);Di.logLevel=$e.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yp,lA;class Ht{constructor(e){if(this.window=e,!e)throw mn.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=ZP,this.onINP=WP,this.onCLS=HP}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,t,i){!this.performance||!this.performance.measure||this.performance.measure(e,t,i)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!Og()?(Di.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):Gh()?!0:(Di.info("IndexedDB is not supported by current browser"),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(o=>{for(const c of o.getEntries())t(c)}).observe({entryTypes:[e]})}static getInstance(){return Yp===void 0&&(Yp=new Ht(lA)),Yp}}function r2(n){lA=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cA;function o2(n){const e=n.getId();return e.then(t=>{cA=t}),e}function Kv(){return cA}function l2(n){const e=n.getToken();return e.then(t=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jE(n,e){const t=n.length-e.length;if(t<0||t>1)throw mn.create("invalid String merger input");const i=[];for(let o=0;o<n.length;o++)i.push(n.charAt(o)),e.length>o&&i.push(e.charAt(o));return i.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qp;class Hn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=jE("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=jE("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Qp===void 0&&(Qp=new Hn),Qp}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hc;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.VISIBLE=1]="VISIBLE",n[n.HIDDEN=2]="HIDDEN"})(Hc||(Hc={}));const c2=["firebase_","google_","ga_"],u2=new RegExp("^[a-zA-Z]\\w*$"),d2=40,h2=100;function f2(){const n=Ht.getInstance().navigator;return n?.serviceWorker?n.serviceWorker.controller?2:3:1}function m2(){switch(Ht.getInstance().document.visibilityState){case"visible":return Hc.VISIBLE;case"hidden":return Hc.HIDDEN;default:return Hc.UNKNOWN}}function p2(){const e=Ht.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function g2(n){return n.length===0||n.length>d2?!1:!c2.some(t=>n.startsWith(t))&&!!n.match(u2)}function v2(n){return n.length!==0&&n.length<=h2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uA(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.appId;if(!t)throw mn.create("no app id");return t}function y2(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.projectId;if(!t)throw mn.create("no project id");return t}function x2(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.apiKey;if(!t)throw mn.create("no api key");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2="0.0.1",vs={loggingEnabled:!0},N2="FIREBASE_INSTALLATIONS_AUTH";function _2(n,e){const t=E2();return t?(AE(t),Promise.resolve()):A2(n,e).then(AE).then(i=>T2(i),()=>{})}function E2(){const n=Ht.getInstance().localStorage;if(!n)return;const e=n.getItem(rA);if(!e||!w2(e))return;const t=n.getItem(iA);if(t)try{return JSON.parse(t)}catch{return}}function T2(n){const e=Ht.getInstance().localStorage;!n||!e||(e.setItem(iA,JSON.stringify(n)),e.setItem(rA,String(Date.now()+Hn.getInstance().configTimeToLive*60*60*1e3)))}const j2="Could not fetch config, will use default configs";function A2(n,e){return l2(n.installations).then(t=>{const i=y2(n.app),o=x2(n.app),c=`https://firebaseremoteconfig.googleapis.com/v1/projects/${i}/namespaces/fireperf:fetch?key=${o}`,d=new Request(c,{method:"POST",headers:{Authorization:`${N2} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:uA(n.app),app_version:Wj,sdk_version:b2})});return fetch(d).then(f=>{if(f.ok)return f.json();throw mn.create("RC response not ok")})}).catch(()=>{Di.info(j2)})}function AE(n){if(!n)return n;const e=Hn.getInstance(),t=n.entries||{};return t.fpr_enabled!==void 0?e.loggingEnabled=String(t.fpr_enabled)==="true":e.loggingEnabled=vs.loggingEnabled,t.fpr_log_source?e.logSource=Number(t.fpr_log_source):vs.logSource&&(e.logSource=vs.logSource),t.fpr_log_endpoint_url?e.logEndPointUrl=t.fpr_log_endpoint_url:vs.logEndPointUrl&&(e.logEndPointUrl=vs.logEndPointUrl),t.fpr_log_transport_key?e.transportKey=t.fpr_log_transport_key:vs.transportKey&&(e.transportKey=vs.transportKey),t.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(t.fpr_vc_network_request_sampling_rate):vs.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=vs.networkRequestsSamplingRate),t.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(t.fpr_vc_trace_sampling_rate):vs.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=vs.tracesSamplingRate),e.logTraceAfterSampling=wE(e.tracesSamplingRate),e.logNetworkAfterSampling=wE(e.networkRequestsSamplingRate),n}function w2(n){return Number(n)>Date.now()}function wE(n){return Math.random()<=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xv=1,Kp;function dA(n){return Xv=2,Kp=Kp||S2(n),Kp}function C2(){return Xv===3}function S2(n){return I2().then(()=>o2(n.installations)).then(e=>_2(n,e)).then(()=>CE(),()=>CE())}function I2(){const n=Ht.getInstance().document;return new Promise(e=>{if(n&&n.readyState!=="complete"){const t=()=>{n.readyState==="complete"&&(n.removeEventListener("readystatechange",t),e())};n.addEventListener("readystatechange",t)}else e()})}function CE(){Xv=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA=10*1e3,R2=5.5*1e3,D2=1e3,fA=3;let ph=fA,Cr=[],SE=!1;function M2(){SE||(Wv(R2),SE=!0)}function Wv(n){setTimeout(()=>{ph<=0||(Cr.length>0&&mA(),Wv(hA))},n)}function mA(){const n=Cr.splice(0,D2),e=n.map(i=>({source_extension_json_proto3:i.message,event_time_ms:String(i.eventTime)})),t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Hn.getInstance().logSource,log_event:e};O2(t).then(()=>{ph=fA}).catch(()=>{Cr=[...n,...Cr],ph--,Di.info(`Tries left: ${ph}.`),Wv(hA)})}function O2(n){const e=Hn.getInstance().getFlTransportFullUrl(),t=JSON.stringify(n);return navigator.sendBeacon&&navigator.sendBeacon(e,t)?Promise.resolve():fetch(e,{method:"POST",body:t,keepalive:!0}).then()}function k2(n){if(!n.eventTime||!n.message)throw mn.create("invalid cc log");Cr=[...Cr,n]}function P2(n){return(...e)=>{const t=n(...e);k2({message:t,eventTime:Date.now()})}}function L2(){for(;Cr.length>0;)mA()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bc;function pA(n,e){Bc||(Bc={send:P2(F2),flush:L2}),Bc.send(n,e)}function ah(n){const e=Hn.getInstance();!e.instrumentationEnabled&&n.isAuto||!e.dataCollectionEnabled&&!n.isAuto||Ht.getInstance().requiredApisAvailable()&&(C2()?Xp(n):dA(n.performanceController).then(()=>Xp(n),()=>Xp(n)))}function V2(){Bc&&Bc.flush()}function Xp(n){if(!Kv())return;const e=Hn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||pA(n,1)}function U2(n){const e=Hn.getInstance();if(!e.instrumentationEnabled)return;const t=n.url,i=e.logEndPointUrl.split("?")[0],o=e.flTransportEndpointUrl.split("?")[0];t===i||t===o||!e.loggingEnabled||!e.logNetworkAfterSampling||pA(n,0)}function F2(n,e){return e===0?q2(n):z2(n)}function q2(n){const e={url:n.url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},t={application_info:gA(n.performanceController.app),network_request_metric:e};return JSON.stringify(t)}function z2(n){const e={name:n.name,is_auto:n.isAuto,client_start_time_us:n.startTimeUs,duration_us:n.durationUs};Object.keys(n.counters).length!==0&&(e.counters=n.counters);const t=n.getAttributes();Object.keys(t).length!==0&&(e.custom_attributes=t);const i={application_info:gA(n.performanceController.app),trace_metric:e};return JSON.stringify(i)}function gA(n){return{google_app_id:uA(n),app_instance_id:Kv(),web_app_info:{sdk_version:Wj,page_url:Ht.getInstance().getUrl(),service_worker_status:f2(),visibility_state:m2(),effective_connection_type:p2()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(n,e){const t=e;if(!t||t.responseStart===void 0)return;const i=Ht.getInstance().getTimeOrigin(),o=Math.floor((t.startTime+i)*1e3),c=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,d=Math.floor((t.responseEnd-t.startTime)*1e3),f=t.name&&t.name.split("?")[0],p={performanceController:n,url:f,responsePayloadBytes:t.transferSize,startTimeUs:o,timeToResponseInitiatedUs:c,timeToResponseCompletedUs:d};U2(p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H2=100,B2="_",G2=[Jj,eA,tA,nA,aA,sA];function $2(n,e){return n.length===0||n.length>H2?!1:e&&e.startsWith(Zj)&&G2.indexOf(n)>-1||!n.startsWith(B2)}function Y2(n){const e=Math.floor(n);return e<n&&Di.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,t,i=!1,o){this.performanceController=e,this.name=t,this.isAuto=i,this.state=1,this.customAttributes={},this.counters={},this.api=Ht.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${JP}-${this.randomId}-${this.name}`,this.traceStopMark=`${e2}-${this.randomId}-${this.name}`,this.traceMeasure=o||`${Sg}-${this.randomId}-${this.name}`,o&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw mn.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw mn.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),ah(this)}record(e,t,i){if(e<=0)throw mn.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw mn.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(t*1e3),this.startTimeUs=Math.floor(e*1e3),i&&i.attributes&&(this.customAttributes=Object.assign({},i.attributes)),i&&i.metrics)for(const o of Object.keys(i.metrics))isNaN(Number(i.metrics[o]))||(this.counters[o]=Math.floor(Number(i.metrics[o])));ah(this)}incrementMetric(e,t=1){this.counters[e]===void 0?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if($2(e,this.name))this.counters[e]=Y2(t??0);else throw mn.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const i=g2(e),o=v2(t);if(i&&o){this.customAttributes[e]=t;return}if(!i)throw mn.create("invalid attribute name",{attributeName:e});if(!o)throw mn.create("invalid attribute value",{attributeValue:t})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(t.duration*1e3),this.startTimeUs=Math.floor((t.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,t,i,o,c){const d=Ht.getInstance().getUrl();if(!d)return;const f=new su(e,Zj+d,!0),p=Math.floor(Ht.getInstance().getTimeOrigin()*1e3);f.setStartTime(p),t&&t[0]&&(f.setDuration(Math.floor(t[0].duration*1e3)),f.putMetric("domInteractive",Math.floor(t[0].domInteractive*1e3)),f.putMetric("domContentLoadedEventEnd",Math.floor(t[0].domContentLoadedEventEnd*1e3)),f.putMetric("loadEventEnd",Math.floor(t[0].loadEventEnd*1e3)));const g="first-paint",y="first-contentful-paint";if(i){const N=i.find(w=>w.name===g);N&&N.startTime&&f.putMetric(Jj,Math.floor(N.startTime*1e3));const j=i.find(w=>w.name===y);j&&j.startTime&&f.putMetric(eA,Math.floor(j.startTime*1e3)),c&&f.putMetric(tA,Math.floor(c*1e3))}this.addWebVitalMetric(f,nA,t2,o.lcp),this.addWebVitalMetric(f,aA,s2,o.cls),this.addWebVitalMetric(f,sA,n2,o.inp),ah(f),V2()}static addWebVitalMetric(e,t,i,o){o&&(e.putMetric(t,Math.floor(o.value*1e3)),o.elementAttribution&&e.putAttribute(i,o.elementAttribution))}static createUserTimingTrace(e,t){const i=new su(e,t,!1,t);ah(i)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gh={},RE=!1,vA;function DE(n){Kv()&&(setTimeout(()=>K2(n),0),setTimeout(()=>Q2(n),0),setTimeout(()=>X2(n),0))}function Q2(n){const e=Ht.getInstance(),t=e.getEntriesByType("resource");for(const i of t)IE(n,i);e.setupObserver("resource",i=>IE(n,i))}function K2(n){const e=Ht.getInstance();"onpagehide"in window?e.document.addEventListener("pagehide",()=>Wp(n)):e.document.addEventListener("unload",()=>Wp(n)),e.document.addEventListener("visibilitychange",()=>{e.document.visibilityState==="hidden"&&Wp(n)}),e.onFirstInputDelay&&e.onFirstInputDelay(t=>{vA=t}),e.onLCP(t=>{var i;gh.lcp={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.element}}),e.onCLS(t=>{var i;gh.cls={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.largestShiftTarget}}),e.onINP(t=>{var i;gh.inp={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.interactionTarget}})}function X2(n){const e=Ht.getInstance(),t=e.getEntriesByType("measure");for(const i of t)ME(n,i);e.setupObserver("measure",i=>ME(n,i))}function ME(n,e){const t=e.name;t.substring(0,Sg.length)!==Sg&&su.createUserTimingTrace(n,t)}function Wp(n){if(!RE){RE=!0;const e=Ht.getInstance(),t=e.getEntriesByType("navigation"),i=e.getEntriesByType("paint");setTimeout(()=>{su.createOobTrace(n,t,i,gh,vA)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(e?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),e?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),Ht.getInstance().requiredApisAvailable()?$h().then(t=>{t&&(M2(),dA(this).then(()=>DE(this),()=>DE(this)),this.initialized=!0)}).catch(t=>{Di.info(`Environment doesn't support IndexedDB: ${t}`)}):Di.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Hn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Hn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Hn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Hn.getInstance().dataCollectionEnabled}}const Z2="[DEFAULT]";function J2(n=cu()){return n=yt(n),ka(n,"performance").getImmediate()}const eL=(n,{options:e})=>{const t=n.getProvider("app").getImmediate(),i=n.getProvider("installations-internal").getImmediate();if(t.name!==Z2)throw mn.create("FB not default");if(typeof window>"u")throw mn.create("no window");r2(window);const o=new W2(t,i);return o._init(e),o};function tL(){ls(new $n("performance",eL,"PUBLIC")),pn(TE,Cg),pn(TE,Cg,"esm2017")}tL();const nL={apiKey:"AIzaSyCbU834quCY8hjSffRwljJLgZrcxK8i2F4",authDomain:"liquidacionapp-62962.firebaseapp.com",projectId:"liquidacionapp-62962",storageBucket:"liquidacionapp-62962.firebasestorage.app",messagingSenderId:"851382130132",appId:"1:851382130132:web:eaba38fab449f14fb5b241",measurementId:void 0},au=sT(nL),Gc=I1(au),fe=IO(au);pk(au);let sL=null,aL=null;try{PP().then(n=>{n&&(sL=OP(au))}).catch(()=>{console.warn("Firebase Analytics no está soportado en este entorno")}),typeof window<"u"&&(aL=J2(au))}catch(n){console.warn("Error al inicializar Firebase Analytics/Performance:",n)}const xs={ADMIN:"admin",CONTADOR:"contador",CLIENTE:"cliente"},ht={MANAGE_INVENTORY:"canManageInventory",CREATE_MOVEMENTS:"canCreateMovements",VIEW_ALL_MOVEMENTS:"canViewAllMovements",MANAGE_VEHICLES:"canManageVehicles",MANAGE_MAINTENANCE:"canManageMaintenance",MANAGE_SUPPLIERS:"canManageSuppliers",VIEW_REPORTS:"canViewReports",EXPORT_REPORTS:"canExportReports",MODIFY_SETTINGS:"canModifySettings"},iL="contacto.evert@gmail.com",yA=n=>{switch(n){case xs.ADMIN:return{[ht.MANAGE_INVENTORY]:!0,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!0,[ht.MANAGE_VEHICLES]:!0,[ht.MANAGE_MAINTENANCE]:!0,[ht.MANAGE_SUPPLIERS]:!0,[ht.VIEW_REPORTS]:!0,[ht.EXPORT_REPORTS]:!0,[ht.MODIFY_SETTINGS]:!0};case xs.CONTADOR:return{[ht.MANAGE_INVENTORY]:!0,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!0,[ht.MANAGE_VEHICLES]:!1,[ht.MANAGE_MAINTENANCE]:!0,[ht.MANAGE_SUPPLIERS]:!1,[ht.VIEW_REPORTS]:!0,[ht.EXPORT_REPORTS]:!0,[ht.MODIFY_SETTINGS]:!1};case xs.CLIENTE:default:return{[ht.MANAGE_INVENTORY]:!1,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!1,[ht.MANAGE_VEHICLES]:!1,[ht.MANAGE_MAINTENANCE]:!1,[ht.MANAGE_SUPPLIERS]:!1,[ht.VIEW_REPORTS]:!1,[ht.EXPORT_REPORTS]:!1,[ht.MODIFY_SETTINGS]:!1}}},rL=n=>n===iL?xs.ADMIN:xs.CLIENTE,al=()=>"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/invitations",oL=()=>{const n="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let e="";for(let t=0;t<8;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},lL=async(n,e)=>{try{const t=await Ef(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden crear invitaciones"};let i,o=!1,c=0;for(;!o&&c<10;){i=oL();const p=Ee(Oe(fe,al()),Se("code","==",i));(await mt(p)).empty&&(o=!0),c++}if(!o)return{success:!1,error:"No se pudo generar un código único"};const d=et(Oe(fe,al())),f={code:i,targetEmail:n.email.toLowerCase(),targetRole:n.role||xs.CLIENTE,targetName:n.name||"",status:"pending",appContext:"combustibles",expiresAt:new Date(Date.now()+7*24*60*60*1e3),createdAt:Ue(),createdBy:e,usedAt:null,usedBy:null};return await gf(d,f),console.log("🎫 Invitación creada:",{code:i,email:n.email,role:n.role}),{success:!0,invitation:{id:d.id,code:i,...f}}}catch(t){return console.error("Error creating invitation:",t),{success:!1,error:t.message}}},xA=async n=>{try{const e=Ee(Oe(fe,al()),Se("code","==",n.toUpperCase()),Se("status","==","pending")),t=await mt(e);if(t.empty)return{success:!1,error:"Código de invitación inválido o expirado"};const i=t.docs[0],o=i.data(),c=new Date,d=o.expiresAt.toDate();return c>d?{success:!1,error:"Código de invitación expirado"}:{success:!0,invitation:{id:i.id,...o}}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},cL=async(n,e)=>{try{const t=et(fe,al(),n);return await Ts(t,{status:"used",usedAt:Ue(),usedBy:e}),{success:!0}}catch(t){return console.error("Error marking invitation as used:",t),{success:!1,error:t.message}}},uL=async n=>{try{const e=await Ef(n);if(!e.success||e.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden ver invitaciones"};const t=Ee(Oe(fe,al())),i=await mt(t),o=[];return i.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,d)=>{const f=c.createdAt?.toDate()||new Date(0);return(d.createdAt?.toDate()||new Date(0))-f}),{success:!0,invitations:o}}catch(e){return console.error("Error getting invitations:",e),{success:!1,error:e.message}}},dL=async(n,e)=>{try{const t=await Ef(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden cancelar invitaciones"};const i=et(fe,al(),n);return await Ts(i,{status:"cancelled",cancelledAt:Ue(),cancelledBy:e}),{success:!0}}catch(t){return console.error("Error cancelling invitation:",t),{success:!1,error:t.message}}},hL=n=>yA(n.targetRole),bA=async(n,e={})=>{const t=et(fe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const i=await Ui(t);if(i.exists())return{success:!0,userData:i.data(),isNewUser:!1};{const o=rL(n.email),c={uid:n.uid,email:n.email,displayName:n.displayName||"",photoURL:n.photoURL||"",role:o,emailVerified:n.emailVerified,combustiblesPermissions:yA(o),createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...e};return await gf(t,c),{success:!0,userData:c,isNewUser:!0}}}catch(i){return console.error("Error creating/updating user profile:",i),{success:!1,error:i.message}}},OE=async(n,e,t={})=>{const i=et(fe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const o=await Ui(i);if(o.exists())return{success:!0,userData:o.data(),isNewUser:!1};const c=await xA(e);if(!c.success)return c;const d=c.invitation;if(d.targetEmail!==n.email.toLowerCase())return{success:!1,error:"El código de invitación no corresponde a este email"};const f={uid:n.uid,email:n.email,displayName:n.displayName||d.targetName||"",photoURL:n.photoURL||"",role:d.targetRole,emailVerified:n.emailVerified,combustiblesPermissions:hL(d),invitationUsed:d.id,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...t};return await gf(i,f),await cL(d.id,n.uid),console.log("👤 Usuario creado con invitación:",{email:n.email,role:d.targetRole,invitationCode:d.code}),{success:!0,userData:f,isNewUser:!0}}catch(o){return console.error("Error creating user profile with invitation:",o),{success:!1,error:o.message}}},Ef=async n=>{try{const e=et(fe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n),t=await Ui(e);return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"Usuario no encontrado"}}catch(e){return console.error("Error fetching user profile:",e),{success:!1,error:e.message}}},_n={DIESEL:"diesel",GASOLINE:"gasoline",ACPM:"acpm",LUBRICANTS:"lubricants",TWO_STROKE:"two_stroke",MIXED:"mixed"},il={[_n.DIESEL]:{name:"Diésel",description:"Combustible para maquinaria pesada",unit:"galones",category:"Combustible",color:"#fbbf24",icon:"🚛",density:.85,priceUnit:"COP/galón"},[_n.GASOLINE]:{name:"Gasolina",description:"Combustible para vehículos livianos",unit:"galones",category:"Combustible",color:"#ef4444",icon:"⛽",density:.75,priceUnit:"COP/galón"},[_n.ACPM]:{name:"ACPM",description:"Aceite Combustible Para Motor",unit:"galones",category:"Combustible",color:"#8b5cf6",icon:"🚜",density:.85,priceUnit:"COP/galón"},[_n.LUBRICANTS]:{name:"Lubricantes",description:"Aceites y lubricantes para mantenimiento",unit:"litros",category:"Mantenimiento",color:"#06b6d4",icon:"🛢️",density:.9,priceUnit:"COP/litro"},[_n.TWO_STROKE]:{name:"Mezcla 2T",description:"Mezcla para motores de 2 tiempos (motosierras)",unit:"litros",category:"Especializado",color:"#10b981",icon:"🪚",density:.78,priceUnit:"COP/litro"},[_n.MIXED]:{name:"Mixto",description:"Compatible con múltiples tipos de combustible",unit:"galones",category:"Flexible",color:"#64748b",icon:"🔄",density:.8,priceUnit:"COP/galón"}},Nn={CRITICAL:"critical",LOW:"low",MEDIUM:"medium",HIGH:"high",FULL:"full"},Bo={[Nn.CRITICAL]:{label:"Crítico",color:"#dc2626",icon:"🚨",threshold:.1},[Nn.LOW]:{label:"Bajo",color:"#ea580c",icon:"⚠️",threshold:.25},[Nn.MEDIUM]:{label:"Medio",color:"#ca8a04",icon:"📊",threshold:.5},[Nn.HIGH]:{label:"Alto",color:"#16a34a",icon:"✅",threshold:.75},[Nn.FULL]:{label:"Completo",color:"#059669",icon:"🟢",threshold:1}},NA=(n,e)=>{if(e===0)return Nn.CRITICAL;const t=n/e;return t<Bo[Nn.CRITICAL].threshold?Nn.CRITICAL:t<Bo[Nn.LOW].threshold?Nn.LOW:t<Bo[Nn.MEDIUM].threshold?Nn.MEDIUM:t<Bo[Nn.HIGH].threshold?Nn.HIGH:Nn.FULL},fL=(n,e=[])=>{if(!n||!n.fuelType||!n.quantity)return{isValid:!1,error:"Datos de movimiento incompletos",availableStock:0,requiredStock:0};const{fuelType:t,quantity:i,type:o,sourceLocation:c}=n,d=parseFloat(i)||0;if(o!=="outbound"&&o!=="transfer")return{isValid:!0,message:"Movimiento no requiere validación de stock",availableStock:0,requiredStock:d};const f=e.filter(y=>y.fuelType===t&&y.location?.toLowerCase()===c?.toLowerCase()&&y.status==="active").reduce((y,N)=>y+(parseFloat(N.currentStock)||0),0),p=f>=d,g=f-d;return console.log(`Validación de stock - Tipo: ${t}, Ubicación: ${c}`,{itemsEncontrados:e.filter(y=>y.fuelType===t&&y.location?.toLowerCase()===c?.toLowerCase()&&y.status==="active").length,disponible:f,requerido:d,valido:f>=d}),{isValid:p,availableStock:f,requiredStock:d,remainingStock:g,fuelType:t,location:c,error:p?null:`Stock insuficiente. Disponible: ${f}, Requerido: ${d}`,warning:g<f*.2&&g>=0?"Stock quedará bajo después del movimiento":null}},Dn=n=>typeof n!="number"||isNaN(n)?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),ke=(n,e=2)=>typeof n!="number"||isNaN(n)?"0":new Intl.NumberFormat("es-CO",{minimumFractionDigits:e,maximumFractionDigits:e}).format(n),Er=(n,e=1)=>typeof n!="number"||isNaN(n)?"0%":`${(n*100).toFixed(e)}%`,iu=(n,e,t=2)=>{const i=parseFloat(n)||0,o=parseFloat(e)||0;return parseFloat((i+o).toFixed(t))},ru=(n,e,t=2)=>{const i=parseFloat(n)||0,o=parseFloat(e)||0;return parseFloat((i-o).toFixed(t))},rl=(n,e=2)=>{const t=parseFloat(n)||0;return parseFloat(t.toFixed(e))},Pr=["principal","campamento austria","campamento ilusion","bodega austria","bodega ilusion","campo operativo","estación móvil"],Gs=n=>n?n.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"",zr="combustibles_movements",rs="combustibles_inventory",he={ENTRADA:"entrada",SALIDA:"salida",TRANSFERENCIA:"transferencia",AJUSTE:"ajuste"},Qe={PENDIENTE:"pendiente",COMPLETADO:"completado",CANCELADO:"cancelado"},_A=async n=>{try{pL(n);const e={...n,createdAt:Ue(),updatedAt:Ue(),status:Qe.COMPLETADO,approvedAt:Ue(),totalValue:wA(n),effectiveDate:n.effectiveDate||Ue()},t=await Pv(fe,async i=>{const o=et(Oe(fe,zr));return i.set(o,e),await CA(i,e,o.id),o.id});return console.log("✅ Movimiento creado exitosamente:",t),t}catch(e){throw console.error("❌ Error al crear movimiento:",e),new Error(`Error al crear movimiento: ${e.message}`)}},EA=async(n={})=>{try{let e=Oe(fe,zr);n.type&&(e=Ee(e,Se("type","==",n.type))),n.status&&(e=Ee(e,Se("status","==",n.status))),n.fuelType&&(e=Ee(e,Se("fuelType","==",n.fuelType))),n.vehicleId&&(e=Ee(e,Se("vehicleId","==",n.vehicleId))),e=Ee(e,jn("createdAt","desc"));const t=await mt(e),i=[];return t.forEach(o=>{i.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,effectiveDate:o.data().effectiveDate?.toDate?.()||o.data().effectiveDate})}),i}catch(e){throw console.error("❌ Error al obtener movimientos:",e),new Error(`Error al obtener movimientos: ${e.message}`)}},Zv=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=et(fe,zr,n),t=await Ui(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate?.()||t.data().createdAt,updatedAt:t.data().updatedAt?.toDate?.()||t.data().updatedAt,effectiveDate:t.data().effectiveDate?.toDate?.()||t.data().effectiveDate}:null}catch(e){throw console.error("❌ Error al obtener movimiento:",e),new Error(`Error al obtener movimiento: ${e.message}`)}},TA=async(n,e)=>{try{if(!n)throw new Error("ID de movimiento requerido");const t={...e,updatedAt:Ue(),...e.quantity||e.unitPrice?{totalValue:wA(e)}:{}},i=et(fe,zr,n);await Ts(i,t),console.log("✅ Movimiento actualizado exitosamente")}catch(t){throw console.error("❌ Error al actualizar movimiento:",t),new Error(`Error al actualizar movimiento: ${t.message}`)}},mL=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=await Zv(n);if(!e)throw new Error("Movimiento no encontrado");await Pv(fe,async t=>{const i=et(fe,zr,n);e.status===Qe.COMPLETADO&&await gL(t,e),t.delete(i)}),console.log("✅ Movimiento eliminado y cambios de inventario revertidos exitosamente")}catch(e){throw console.error("❌ Error al eliminar movimiento:",e),new Error(`Error al eliminar movimiento: ${e.message}`)}},Jv=(n,e={})=>{try{let t=Oe(fe,zr);return e.type&&(t=Ee(t,Se("type","==",e.type))),e.status&&(t=Ee(t,Se("status","==",e.status))),t=Ee(t,jn("createdAt","desc")),qr(t,i=>{const o=[];i.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,effectiveDate:c.data().effectiveDate?.toDate?.()||c.data().effectiveDate})}),n(o)},i=>{console.error("❌ Error en suscripción de movimientos:",i),n([],i)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},jA=async n=>{try{const e=await Zv(n);if(!e)throw new Error("Movimiento no encontrado");if(e.status!==Qe.PENDIENTE)throw new Error("Solo se pueden aprobar movimientos pendientes");await Pv(fe,async t=>{const i=et(fe,zr,n);t.update(i,{status:Qe.COMPLETADO,approvedAt:Ue(),updatedAt:Ue()}),await CA(t,e,n)}),console.log("✅ Movimiento aprobado exitosamente")}catch(e){throw console.error("❌ Error al aprobar movimiento:",e),new Error(`Error al aprobar movimiento: ${e.message}`)}},AA=async(n={})=>{try{const e=await EA(n),t={totalMovements:e.length,byType:{},byStatus:{},byFuelType:{},totalValue:0,totalQuantity:0,averageValue:0,thisMonth:0,lastMonth:0,thisWeek:0},i=new Date,o=new Date(i.getFullYear(),i.getMonth(),1),c=new Date(i.getFullYear(),i.getMonth()-1,1),d=new Date(i.setDate(i.getDate()-i.getDay()));return e.forEach(f=>{t.byType[f.type]=(t.byType[f.type]||0)+1,t.byStatus[f.status]=(t.byStatus[f.status]||0)+1,t.byFuelType[f.fuelType]=(t.byFuelType[f.fuelType]||0)+1,t.totalValue+=f.totalValue||0,t.totalQuantity+=f.quantity||0;const p=new Date(f.createdAt);p>=o&&t.thisMonth++,p>=c&&p<o&&t.lastMonth++,p>=d&&t.thisWeek++}),t.averageValue=t.totalMovements>0?t.totalValue/t.totalMovements:0,t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},kE=n=>n?Pr.includes(n.toLowerCase()):!1,pL=n=>{const e=["type","fuelType","quantity","unitPrice"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!Object.values(he).includes(n.type))throw new Error("Tipo de movimiento inválido");if(n.quantity<=0)throw new Error("La cantidad debe ser mayor a cero");if(n.unitPrice<0)throw new Error("El precio unitario no puede ser negativo");if(n.type===he.SALIDA&&!n.vehicleId)throw new Error("Las salidas deben tener un vehículo asociado");if(n.type===he.TRANSFERENCIA&&!n.destinationLocation)throw new Error("Las transferencias deben tener una ubicación destino");if(n.location&&!kE(n.location))throw new Error(`Ubicación origen inválida: ${n.location}. Ubicaciones válidas: ${Pr.join(", ")}`);if(n.destinationLocation&&!kE(n.destinationLocation))throw new Error(`Ubicación destino inválida: ${n.destinationLocation}. Ubicaciones válidas: ${Pr.join(", ")}`);if(n.type===he.TRANSFERENCIA){const t=(n.location||"principal").toLowerCase(),i=n.destinationLocation.toLowerCase();if(t===i)throw new Error("La ubicación origen y destino no pueden ser la misma en una transferencia")}},wA=n=>(n.quantity||0)*(n.unitPrice||0),CA=async(n,e,t)=>{try{let i=e.location||"principal";e.type===he.ENTRADA&&(i=e.destinationLocation||"principal");const o=Ee(Oe(fe,rs),Se("fuelType","==",e.fuelType),Se("location","==",i)),c=await mt(o);if(c.empty){if(e.type!==he.ENTRADA)throw new Error(`No se encontró inventario para ${e.fuelType} en ${i} para realizar un movimiento de ${e.type}.`);console.log(`📦 Creando inventario automático para ${e.fuelType} en ${i}`);const d=et(Oe(fe,rs)),f={fuelType:e.fuelType,location:i,name:e.fuelType,capacity:1e4,currentStock:rl(e.quantity,2),minStock:1500,unitPrice:e.unitPrice||0,createdAt:Ue(),updatedAt:Ue(),isActive:!0,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:Ue()}};n.set(d,f)}else{const d=c.docs[0],f=d.data(),p=et(fe,rs,d.id);let g=f.currentStock;switch(e.type){case he.ENTRADA:g=iu(g,e.quantity);break;case he.SALIDA:if(g=ru(g,e.quantity),g<0)throw new Error("Stock insuficiente para realizar la salida");break;case he.AJUSTE:g=iu(g,e.quantity),g<0&&(g=0);break;case he.TRANSFERENCIA:if(g=ru(g,e.quantity),g<0)throw new Error("Stock insuficiente para realizar la transferencia");await vL(n,e,t);break}g=rl(g,2),n.update(p,{currentStock:g,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:Ue()},updatedAt:Ue()})}e.type===he.SALIDA&&e.vehicleId&&e.currentHours&&await LE(n,e.vehicleId,e.currentHours),e.type===he.SALIDA&&e.vehicleId&&e.currentHours&&await LE(n,e.vehicleId,e.currentHours)}catch(i){throw console.error("❌ Error al actualizar inventario:",i),i}},gL=async(n,e)=>{try{console.log("🔄 Revirtiendo cambios de inventario para movimiento:",e.id);let t;switch(e.type){case he.ENTRADA:t=e.destinationLocation||"principal";break;case he.SALIDA:case he.AJUSTE:t=e.location||"principal";break;case he.TRANSFERENCIA:t=e.location||"principal";break;default:t=e.location||e.destinationLocation||"principal"}console.log(`🔍 Buscando inventario: ${e.fuelType} en ${t}`);const i=Ee(Oe(fe,rs),Se("fuelType","==",e.fuelType),Se("location","==",t)),o=await mt(i);if(o.empty){console.warn(`⚠️ No se encontró inventario para ${e.fuelType} en ${t}`);const p=Ee(Oe(fe,rs),Se("fuelType","==",e.fuelType)),g=await mt(p);if(g.empty)throw console.error(`❌ No existe inventario para ${e.fuelType} en ninguna ubicación`),new Error(`No se puede revertir: no existe inventario para ${e.fuelType} en ninguna ubicación. Movimiento huérfano detectado.`);console.log(`🔄 Usando inventario fallback en ${g.docs[0].data().location}`);const y=g.docs[0],N=y.data(),j=et(fe,rs,y.id);await PE(n,j,N,e);return}const c=o.docs[0],d=c.data(),f=et(fe,rs,c.id);await PE(n,f,d,e)}catch(t){throw console.error("❌ Error al revertir cambios de inventario:",t),new Error(`Error al revertir inventario: ${t.message}`)}},PE=async(n,e,t,i)=>{try{let o=t.currentStock;switch(i.type){case he.ENTRADA:o=ru(o,i.quantity),o<0&&(console.warn("⚠️ Advertencia: La reversión resulta en stock negativo, ajustando a 0"),o=0);break;case he.SALIDA:o=iu(o,i.quantity);break;case he.AJUSTE:o=ru(o,i.quantity),o<0&&(console.warn("⚠️ Advertencia: La reversión de ajuste resulta en stock negativo, ajustando a 0"),o=0);break;case he.TRANSFERENCIA:o=iu(o,i.quantity),await yL(n,i);break;default:throw new Error(`Tipo de movimiento no soportado para reversión: ${i.type}`)}o=rl(o,2),n.update(e,{currentStock:o,lastMovement:{movementId:null,type:"reversion",quantity:i.quantity,originalType:i.type,date:Ue(),note:`Reversión de movimiento ${i.id} - Ubicación original: ${i.location||i.destinationLocation||"no especificada"}`},updatedAt:Ue()}),console.log(`✅ Inventario revertido exitosamente. Stock anterior: ${t.currentStock}, Nuevo stock: ${o}`)}catch(o){throw console.error("❌ Error en procesamiento de reversión:",o),o}},vL=async(n,e,t)=>{try{if(!e.destinationLocation)throw new Error("Ubicación destino requerida para transferencias");console.log(`🔄 Transfiriendo ${e.quantity} ${e.fuelType} a ${e.destinationLocation}`);const i=Ee(Oe(fe,rs),Se("fuelType","==",e.fuelType),Se("location","==",e.destinationLocation)),o=await mt(i);if(o.empty){console.log(`📦 Creando inventario automático en destino: ${e.fuelType} en ${e.destinationLocation}`);const c=et(Oe(fe,rs)),d={fuelType:e.fuelType,location:e.destinationLocation,name:e.fuelType,capacity:1e4,currentStock:rl(e.quantity,2),minStock:1500,unitPrice:e.unitPrice||0,createdAt:Ue(),updatedAt:Ue(),isActive:!0,lastMovement:{movementId:t,type:"transferencia_entrada",quantity:e.quantity,date:Ue(),originLocation:e.location}};n.set(c,d)}else{const c=o.docs[0],d=c.data(),f=et(fe,rs,c.id),p=rl(iu(d.currentStock,e.quantity),2);n.update(f,{currentStock:p,lastMovement:{movementId:t,type:"transferencia_entrada",quantity:e.quantity,date:Ue(),originLocation:e.location},updatedAt:Ue()})}console.log("✅ Transferencia al destino completada exitosamente")}catch(i){throw console.error("❌ Error al transferir a destino:",i),new Error(`Error en transferencia a destino: ${i.message}`)}},yL=async(n,e)=>{try{if(!e.destinationLocation){console.warn("⚠️ No hay ubicación destino para revertir");return}console.log(`🔄 Revirtiendo transferencia en destino: ${e.destinationLocation}`);const t=Ee(Oe(fe,rs),Se("fuelType","==",e.fuelType),Se("location","==",e.destinationLocation)),i=await mt(t);if(i.empty){console.warn(`⚠️ No se encontró inventario destino para revertir: ${e.fuelType} en ${e.destinationLocation}`);return}const o=i.docs[0],c=o.data(),d=et(fe,rs,o.id);let f=ru(c.currentStock,e.quantity);f<0&&(console.warn("⚠️ Advertencia: La reversión en destino resulta en stock negativo, ajustando a 0"),f=0),f=rl(f,2),n.update(d,{currentStock:f,lastMovement:{movementId:null,type:"reversion_transferencia",quantity:e.quantity,date:Ue(),note:`Reversión de transferencia desde ${e.location}`},updatedAt:Ue()}),console.log("✅ Reversión en destino completada exitosamente")}catch(t){throw console.error("❌ Error al revertir transferencia en destino:",t),new Error(`Error al revertir destino: ${t.message}`)}},LE=async(n,e,t)=>{try{console.log(`🕒 Actualizando horómetro del vehículo ${e} a ${t} horas`);const i=Ee(Oe(fe,"combustibles_vehicles"),Se("vehicleId","==",e)),o=await mt(i);if(o.empty){console.warn(`⚠️ Vehículo ${e} no encontrado para actualizar horómetro`);return}const c=o.docs[0],d=c.data(),f=et(fe,"combustibles_vehicles",c.id),p=parseFloat(d.currentHours)||0,g=parseFloat(t);g<p&&console.warn(`⚠️ Nueva lectura horómetro (${g}) menor a la anterior (${p}). Actualizando de todas formas.`);const y=d.hourMeterHistory||[];y.push({previousHours:p,newHours:g,difference:g-p,updatedAt:new Date,updatedBy:"movement_service",source:"fuel_consumption"}),n.update(f,{currentHours:g,hourMeterHistory:y,lastHourMeterUpdate:Ue(),updatedAt:Ue()}),console.log(`✅ Horómetro actualizado: ${e} - ${p}h → ${g}h`)}catch(i){console.error("❌ Error al actualizar horómetro del vehículo:",i),console.warn("⚠️ Continuando con el movimiento sin actualización de horómetro")}},VE={createMovement:_A,getAllMovements:EA,getMovement:Zv,updateMovement:TA,deleteMovement:mL,subscribeToMovements:Jv,approveMovement:jA,getMovementsStats:AA,MOVEMENT_TYPES:he,MOVEMENT_STATUS:Qe},ol="combustibles_inventory",xL=async(n,e)=>{try{const t=il[n.fuelType];if(!t)return{success:!1,error:"Tipo de combustible no válido"};const i=Ee(Oe(fe,ol),Se("fuelType","==",n.fuelType),Se("location","==",n.location.toLowerCase()));if(!(await mt(i)).empty)return{success:!1,error:`Ya existe ${t.name} en ${n.location}`};const c={fuelType:n.fuelType,name:t.name,description:n.description||t.description,currentStock:Number(n.currentStock)||0,maxCapacity:Number(n.maxCapacity),minThreshold:Number(n.minThreshold)||n.maxCapacity*.15,unit:t.unit,location:n.location.toLowerCase(),pricePerUnit:Number(n.pricePerUnit)||0,supplier:n.supplier||"",status:n.status||"active",createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await pl(Oe(fe,ol),c)).id,...c},message:`${t.name} agregado al inventario exitosamente`}}catch(t){return console.error("Error creating inventory item:",t),{success:!1,error:t.message}}},SA=async()=>{try{const n=Ee(Oe(fe,ol),jn("fuelType","asc")),e=await mt(n),t=[];return e.forEach(i=>{const o=i.data();t.push({id:i.id,...o,stockLevel:NA(o.currentStock,o.maxCapacity),stockPercentage:Math.round(o.currentStock/o.maxCapacity*100),needsRestock:o.currentStock<=o.minThreshold})}),{success:!0,data:t}}catch(n){return console.error("Error fetching inventory items:",n),{success:!1,error:n.message}}},bL=async(n,e,t)=>{try{const i=et(fe,ol,n);if(!(await Ui(i)).exists())return{success:!1,error:"Item no encontrado"};const c={...e,lastUpdated:new Date,updatedBy:t};return delete c.id,delete c.createdAt,delete c.createdBy,await Ts(i,c),{success:!0,message:"Item actualizado exitosamente",data:{id:n,...c}}}catch(i){return console.error("Error updating inventory item:",i),{success:!1,error:i.message}}},NL=async n=>{try{const e=et(fe,ol,n);return(await Ui(e)).exists()?(await vf(e),{success:!0,message:"Item eliminado exitosamente"}):{success:!1,error:"Item no encontrado"}}catch(e){return console.error("Error deleting inventory item:",e),{success:!1,error:e.message}}},IA=n=>{const e=Ee(Oe(fe,ol),jn("fuelType","asc"));return qr(e,t=>{const i=[];t.forEach(o=>{const c=o.data();i.push({id:o.id,...c,stockLevel:NA(c.currentStock,c.maxCapacity),stockPercentage:Math.round(c.currentStock/c.maxCapacity*100),needsRestock:c.currentStock<=c.minThreshold})}),n(i)},t=>{console.error("Error in inventory subscription:",t),n(null,t)})},_L=async()=>{try{const n=await SA();if(!n.success)return n;const e=n.data,t={totalItems:e.length,activeItems:e.filter(i=>i.status==="active").length,lowStockItems:e.filter(i=>i.needsRestock).length,totalValue:e.reduce((i,o)=>i+o.currentStock*o.pricePerUnit,0),averageStockLevel:e.length>0?Math.round(e.reduce((i,o)=>i+o.stockPercentage,0)/e.length):0,byFuelType:{}};return e.forEach(i=>{t.byFuelType[i.fuelType]||(t.byFuelType[i.fuelType]={count:0,totalStock:0,totalCapacity:0,totalValue:0}),t.byFuelType[i.fuelType].count++,t.byFuelType[i.fuelType].totalStock+=i.currentStock,t.byFuelType[i.fuelType].totalCapacity+=i.maxCapacity,t.byFuelType[i.fuelType].totalValue+=i.currentStock*i.pricePerUnit}),{success:!0,data:t}}catch(n){return console.error("Error calculating inventory stats:",n),{success:!1,error:n.message}}},os=[{id:"maquinaria_pesada",name:"Maquinaria Pesada",description:"Excavadoras, bulldozers, cargadores, grúas",icon:"🏗️",color:"#FF6B35",fuelTypes:["Diesel","ACPM"],fields:["enginePower","operatingWeight","bucketCapacity"]},{id:"transporte",name:"Transporte",description:"Camiones, camionetas, volquetas",icon:"🚛",color:"#2E86AB",fuelTypes:["Diesel","ACPM","Gasolina"],fields:["plateNumber","loadCapacity","enginePower"]},{id:"herramientas_motorizadas",name:"Herramientas Motorizadas",description:"Motosierras, guadañas, fumigadoras",icon:"🔧",color:"#A23B72",fuelTypes:["Gasolina","Mixto"],fields:["enginePower","weight"]},{id:"equipos_bombeo",name:"Equipos de Bombeo",description:"Motobombas, hidrolavadoras, plantas eléctricas",icon:"💧",color:"#F18F01",fuelTypes:["Diesel","Gasolina"],fields:["flow","pressure","enginePower"]},{id:"vehiculos_ligeros",name:"Vehículos Ligeros",description:"Motocicletas, cuatrimotos, vehículos de apoyo",icon:"🏍️",color:"#C73E1D",fuelTypes:["Gasolina"],fields:["plateNumber","enginePower"]},{id:"agricola",name:"Agrícola/Forestal",description:"Tractores, asperjadoras, equipos forestales",icon:"🚜",color:"#2F7D32",fuelTypes:["Diesel","ACPM"],fields:["enginePower","hasHourMeter","implementType"]},{id:"otros",name:"Otros",description:"Equipos especializados y otros vehículos",icon:"⚙️",color:"#616161",fuelTypes:["Diesel","Gasolina","ACPM","Mixto"],fields:["enginePower"]}],Ve={ACTIVO:"activo",MANTENIMIENTO:"mantenimiento",INACTIVO:"inactivo",REPARACION:"reparacion",FUERA_DE_SERVICIO:"fuera_de_servicio"},RA={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},UE=[{key:"plateNumber",label:"Número de Placa",type:"text",icon:"🏷️"},{key:"enginePower",label:"Potencia del Motor (HP)",type:"number",icon:"⚡"},{key:"fuelCapacity",label:"Capacidad de Combustible (Litros)",type:"number",icon:"⛽"},{key:"operatingWeight",label:"Peso Operativo (Toneladas)",type:"number",icon:"⚖️"},{key:"loadCapacity",label:"Capacidad de Carga (Toneladas)",type:"number",icon:"📦"},{key:"bucketCapacity",label:"Capacidad de Balde (m³)",type:"number",icon:"🪣"},{key:"hasHourMeter",label:"Tiene Horómetro",type:"boolean",icon:"⏰"},{key:"currentHours",label:"Horas Actuales",type:"number",icon:"🕐",dependsOn:"hasHourMeter"},{key:"implementType",label:"Tipo de Implemento",type:"text",icon:"🔧"},{key:"flow",label:"Caudal (L/min)",type:"number",icon:"💧"},{key:"pressure",label:"Presión (PSI)",type:"number",icon:"💨"},{key:"weight",label:"Peso (Kg)",type:"number",icon:"⚖️"}],FE=(n,e=[])=>{const t=e.find(i=>i.id===n);return t||os.find(i=>i.id===n)||null},DA=(n=[])=>{const e=os.map(i=>i.id),t=n.filter(i=>!e.includes(i.id));return[...os,...t]},MA=n=>{const e=[];return(!n.id||typeof n.id!="string")&&e.push("ID de categoría requerido y debe ser texto"),(!n.name||typeof n.name!="string")&&e.push("Nombre de categoría requerido y debe ser texto"),n.name&&n.name.length<2&&e.push("Nombre debe tener al menos 2 caracteres"),n.fuelTypes&&!Array.isArray(n.fuelTypes)&&e.push("Tipos de combustible debe ser un array"),n.fields&&!Array.isArray(n.fields)&&e.push("Campos debe ser un array"),{isValid:e.length===0,errors:e}},OA=(n,e=[])=>{const t=n.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"");let i=t,o=1;for(;e.some(c=>c.id===i);)i=`${t}_${o}`,o++;return i},vl="combustibles_vehicles",vt={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},kA=async n=>{try{if(EL(n),await ty(n.vehicleId))throw new Error(`El código de vehículo '${n.vehicleId}' ya existe`);const t={...n,createdAt:Ue(),updatedAt:Ue(),status:n.status||Ve.ACTIVO,totalFuelConsumed:0,totalHoursWorked:0,totalMovements:0,lastMovementDate:null,estimatedConsumptionPerHour:VA(n)},i=await pl(Oe(fe,vl),t);return console.log("✅ Vehículo creado exitosamente:",i.id),i.id}catch(e){throw console.error("❌ Error al crear vehículo:",e),new Error(`Error al crear vehículo: ${e.message}`)}},ey=async(n={})=>{try{let e=Oe(fe,vl);n.type&&(e=Ee(e,Se("type","==",n.type))),n.status&&(e=Ee(e,Se("status","==",n.status))),n.fuelType&&(e=Ee(e,Se("fuelType","==",n.fuelType))),n.location&&(e=Ee(e,Se("currentLocation","==",n.location))),e=Ee(e,jn("vehicleId","asc"));const t=await mt(e),i=[];return t.forEach(o=>{i.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,lastMovementDate:o.data().lastMovementDate?.toDate?.()||o.data().lastMovementDate,lastMaintenanceDate:o.data().lastMaintenanceDate?.toDate?.()||o.data().lastMaintenanceDate})}),i}catch(e){throw console.error("❌ Error al obtener vehículos:",e),new Error(`Error al obtener vehículos: ${e.message}`)}},ty=async n=>{try{const e=Ee(Oe(fe,vl),Se("vehicleId","==",n)),t=await mt(e);if(t.empty)return null;const i=t.docs[0];return{id:i.id,...i.data(),createdAt:i.data().createdAt?.toDate?.()||i.data().createdAt,updatedAt:i.data().updatedAt?.toDate?.()||i.data().updatedAt,lastMovementDate:i.data().lastMovementDate?.toDate?.()||i.data().lastMovementDate,lastMaintenanceDate:i.data().lastMaintenanceDate?.toDate?.()||i.data().lastMaintenanceDate}}catch(e){throw console.error("❌ Error al buscar vehículo por código:",e),new Error(`Error al buscar vehículo: ${e.message}`)}},PA=async(n,e)=>{try{if(!n)throw new Error("ID de vehículo requerido");if(e.vehicleId){const o=await ty(e.vehicleId);if(o&&o.id!==n)throw new Error(`El código de vehículo '${e.vehicleId}' ya existe`)}const t={...e,updatedAt:Ue(),...e.enginePower||e.type?{estimatedConsumptionPerHour:VA(e)}:{}},i=et(fe,vl,n);await Ts(i,t),console.log("✅ Vehículo actualizado exitosamente")}catch(t){throw console.error("❌ Error al actualizar vehículo:",t),new Error(`Error al actualizar vehículo: ${t.message}`)}},ny=(n,e={})=>{try{let t=Oe(fe,vl);const i=[];e.category&&i.push(Se("category","==",e.category)),e.status&&i.push(Se("status","==",e.status)),e.fuelType&&i.push(Se("fuelType","==",e.fuelType)),e.currentLocation&&i.push(Se("currentLocation","==",e.currentLocation)),i.forEach(c=>{t=Ee(t,c)}),t=Ee(t,jn("updatedAt","desc"));let o=null;return qr(t,c=>{const d=Date.now();if(o&&d-o<500)return;o=d;const f=[],p={added:[],modified:[],removed:[]};c.docChanges().forEach(g=>{const y={id:g.doc.id,...g.doc.data(),createdAt:g.doc.data().createdAt?.toDate?.()||g.doc.data().createdAt,updatedAt:g.doc.data().updatedAt?.toDate?.()||g.doc.data().updatedAt,lastMovementDate:g.doc.data().lastMovementDate?.toDate?.()||g.doc.data().lastMovementDate,lastMaintenanceDate:g.doc.data().lastMaintenanceDate?.toDate?.()||g.doc.data().lastMaintenanceDate,lastHourMeterDate:g.doc.data().lastHourMeterDate?.toDate?.()||g.doc.data().lastHourMeterDate};g.type==="added"?p.added.push(y):g.type==="modified"?p.modified.push(y):g.type==="removed"&&p.removed.push({id:g.doc.id})}),c.forEach(g=>{f.push({id:g.id,...g.data(),createdAt:g.data().createdAt?.toDate?.()||g.data().createdAt,updatedAt:g.data().updatedAt?.toDate?.()||g.data().updatedAt,lastMovementDate:g.data().lastMovementDate?.toDate?.()||g.data().lastMovementDate,lastMaintenanceDate:g.data().lastMaintenanceDate?.toDate?.()||g.data().lastMaintenanceDate,lastHourMeterDate:g.data().lastHourMeterDate?.toDate?.()||g.data().lastHourMeterDate})}),n(f,null,p)},c=>{console.error("❌ Error en suscripción de vehículos:",c),n([],c)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},LA=async(n={})=>{try{const e=await ey(n),t={totalVehicles:e.length,byType:{},byStatus:{},byFuelType:{},totalFuelConsumed:0,totalHoursWorked:0,averageConsumption:0,mostActiveVehicle:null,leastActiveVehicle:null};let i=0,o=1/0;return e.forEach(c=>{t.byType[c.type]=(t.byType[c.type]||0)+1,t.byStatus[c.status]=(t.byStatus[c.status]||0)+1,t.byFuelType[c.fuelType]=(t.byFuelType[c.fuelType]||0)+1,t.totalFuelConsumed+=c.totalFuelConsumed||0,t.totalHoursWorked+=c.totalHoursWorked||0;const d=c.totalMovements||0;d>i&&(i=d,t.mostActiveVehicle=c),d<o&&d>0&&(o=d,t.leastActiveVehicle=c)}),t.totalHoursWorked>0&&(t.averageConsumption=t.totalFuelConsumed/t.totalHoursWorked),t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},EL=n=>{const e=["vehicleId","name","type","fuelType"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!n.type||n.type.trim().length===0)throw new Error("Tipo de vehículo requerido");if(!Object.values(vt).includes(n.fuelType))throw new Error("Tipo de combustible inválido");if(n.status&&!Object.values(Ve).includes(n.status))throw new Error("Estado de vehículo inválido");if(n.enginePower&&n.enginePower<=0)throw new Error("La potencia del motor debe ser mayor a cero");if(n.fuelCapacity&&n.fuelCapacity<=0)throw new Error("La capacidad de combustible debe ser mayor a cero")},VA=n=>{const{type:e,enginePower:t,fuelType:i}=n,o={excavadora:.04,bulldozer:.05,cargador:.035,camion:.03,camioneta:.03,grua:.045,motosierra:.02,tractor:.025,volqueta:.035,motobomba:.035,fumigadora:.025,guadana:.02,motocicleta:.015,planta_electrica:.08,otros:.03},c={[vt.DIESEL]:1,[vt.GASOLINA]:1.2,[vt.ACPM]:.95,[vt.MIXTO]:1.1},d=o[e]||.03,f=c[i]||1;return d*(t||100)*f},TL=async n=>{try{const e=Ee(Oe(fe,vl),Se("category","==",n));return(await mt(e)).size}catch(e){return console.error("❌ Error al contar vehículos por categoría:",e),0}},UA=Object.freeze(Object.defineProperty({__proto__:null,FUEL_COMPATIBILITY:vt,FUEL_TYPES:RA,VEHICLE_STATUS:Ve,countVehiclesByCategory:TL,createVehicle:kA,getAllVehicles:ey,getVehicleByCode:ty,getVehiclesStats:LA,subscribeToVehicles:ny,updateVehicle:PA},Symbol.toStringTag,{value:"Module"})),$s="combustibles_suppliers",jL=async(n,e)=>{try{const t=Ee(Oe(fe,$s),Se("name","==",n.name.trim()));if(!(await mt(t)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${n.name}"`};if(n.taxId){const d=Ee(Oe(fe,$s),Se("taxId","==",n.taxId.trim()));if(!(await mt(d)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${n.taxId}"`}}const o={name:n.name.trim(),taxId:n.taxId?.trim()||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson?.trim()||"",phone:n.phone?.trim()||"",email:n.email?.trim()||"",address:n.address?.trim()||"",city:n.city?.trim()||"",state:n.state?.trim()||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:Number(n.creditLimit)||0,priceList:n.priceList||{},rating:Number(n.rating)||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1,totalOrders:0,totalPurchased:0,lastOrderDate:null,averageDeliveryTime:0,createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await pl(Oe(fe,$s),o)).id,...o},message:`Proveedor "${o.name}" creado exitosamente`}}catch(t){return console.error("Error creating supplier:",t),{success:!1,error:t.message}}},FA=async()=>{try{const n=Ee(Oe(fe,$s),jn("name","asc"));return{success:!0,data:(await mt(n)).docs.map(i=>({id:i.id,...i.data()}))}}catch(n){return console.error("Error getting suppliers:",n),{success:!1,error:n.message}}},qA=n=>{const e=Ee(Oe(fe,$s),jn("name","asc"));return qr(e,t=>{const i=t.docs.map(o=>({id:o.id,...o.data()}));n(i)})},AL=async(n,e,t)=>{try{const i=await Ui(et(fe,$s,n));if(!i.exists())return{success:!1,error:"Proveedor no encontrado"};if(e.name&&e.name.trim()!==i.data().name){const c=Ee(Oe(fe,$s),Se("name","==",e.name.trim()));if(!(await mt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${e.name}"`}}if(e.taxId&&e.taxId.trim()!==i.data().taxId){const c=Ee(Oe(fe,$s),Se("taxId","==",e.taxId.trim()));if(!(await mt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${e.taxId}"`}}const o={...e,lastUpdated:new Date,updatedBy:t};return o.name&&(o.name=o.name.trim()),o.taxId&&(o.taxId=o.taxId.trim()),o.contactPerson&&(o.contactPerson=o.contactPerson.trim()),o.phone&&(o.phone=o.phone.trim()),o.email&&(o.email=o.email.trim()),await Ts(et(fe,$s,n),o),{success:!0,message:"Proveedor actualizado exitosamente"}}catch(i){return console.error("Error updating supplier:",i),{success:!1,error:i.message}}},wL=async(n,e)=>{try{return await Ts(et(fe,$s,n),{status:"inactive",lastUpdated:new Date,updatedBy:e}),{success:!0,message:"Proveedor desactivado exitosamente"}}catch(t){return console.error("Error deleting supplier:",t),{success:!1,error:t.message}}},CL=async()=>{try{const n=await FA();if(!n.success)return n;const e=n.data,t={total:e.length,active:e.filter(i=>i.status==="active").length,inactive:e.filter(i=>i.status==="inactive").length,suspended:e.filter(i=>i.status==="suspended").length,preferred:e.filter(i=>i.isPreferred).length,averageRating:e.length>0?e.reduce((i,o)=>i+(o.rating||0),0)/e.length:0,byCategory:{},byType:{}};return e.forEach(i=>{const o=i.category||"sin_categoria";t.byCategory[o]=(t.byCategory[o]||0)+1}),e.forEach(i=>{const o=i.type||"sin_tipo";t.byType[o]=(t.byType[o]||0)+1}),{success:!0,data:t}}catch(n){return console.error("Error getting suppliers stats:",n),{success:!1,error:n.message}}},zA=G.createContext(),js=()=>{const n=G.useContext(zA);if(n===void 0)throw new Error("useCombustibles must be used within a CombustiblesProvider");return n},SL=({children:n})=>{const[e,t]=G.useState(null),[i,o]=G.useState(null),[c,d]=G.useState(!0),[f,p]=G.useState(null),[g,y]=G.useState([]),[N,j]=G.useState([]),[w,b]=G.useState([]),[A,E]=G.useState([]);G.useEffect(()=>{const O=yR(Gc,async C=>{try{if(d(!0),C){t(C);let R=await Ef(C.uid);R.success||(R=await bA(C,{provider:"existing_account",appContext:"combustibles"})),R.success?o(R.userData):p("Error cargando perfil de usuario")}else t(null),o(null),y([]),j([]),b([]),E([])}catch(R){console.error("Error en autenticación:",R),p("Error de autenticación")}finally{d(!1)}});return()=>O()},[]),G.useEffect(()=>{if(e){const O=IA(y),C=ny(b,ye=>p(ye.message)),R=qA(E),V=VE.subscribeToMovements(j,ye=>p(ye.message));return()=>{O(),C(),R(),V()}}},[e]);const k={user:e,userProfile:i,loading:c,error:f,hasPermission:O=>i?.combustiblesPermissions?.[O]||!1,isAdmin:()=>i?.role==="admin",isCounterOrAbove:()=>i?.role==="admin"||i?.role==="contador",inventory:g,movements:N,vehicles:w,suppliers:A,setInventory:y,setMovements:j,setVehicles:b,setSuppliers:E,deleteMovement:async O=>{try{return await VE.deleteMovement(O),{success:!0}}catch(C){return console.error("Error al eliminar el movimiento en el contexto:",C),p(C.message),{success:!1,error:C.message}}},refreshInventory:async()=>{console.log("Refrescando inventario...")},refreshMovements:async()=>{console.log("Refrescando movimientos...")},refreshVehicles:async()=>{console.log("Refrescando vehículos...")},refreshSuppliers:async()=>{console.log("Refrescando proveedores...")}};return a.jsx(zA.Provider,{value:k,children:n})},IL=({children:n,currentView:e,onViewChange:t})=>{const{userProfile:i,isAdmin:o,isCounterOrAbove:c}=js(),[d,f]=G.useState(!1),p=[{id:"dashboard",name:"Dashboard",icon:"📊",description:"Vista general",requiredPermission:null},{id:"inventory",name:"Inventario",icon:"🛢️",description:"Gestión de stock",requiredPermission:"canManageInventory"},{id:"movements",name:"Movimientos",icon:"📈",description:"Entradas y salidas",requiredPermission:"canCreateMovements"},{id:"vehicles",name:"Vehículos",icon:"🚜",description:"Maquinaria forestal",requiredPermission:null},{id:"maintenance",name:"Mantenimiento",icon:"🔧",description:"Cambios de aceite y baterías",requiredPermission:null},{id:"products",name:"Productos",icon:"🛢️",description:"Tipos de combustibles",requiredPermission:null},{id:"suppliers",name:"Proveedores",icon:"🏪",description:"Gestión de proveedores",requiredPermission:"canManageSuppliers"},{id:"reports",name:"Reportes",icon:"📋",description:"Análisis y reportes",requiredPermission:"canViewReports"},{id:"admin",name:"Administración",icon:"⚙️",description:"Gestión de usuarios",requiredPermission:"admin"}],g=w=>{t(w),f(!1)},y=w=>w?w==="admin"?o():i?.combustiblesPermissions?.[w]||!1:!0,N=p.filter(w=>y(w.requiredPermission)),j=async()=>{try{await xR(Gc)}catch(w){console.error("Error al cerrar sesión:",w)}};return a.jsxs("div",{className:"dashboard-layout",children:[a.jsx("header",{className:"dashboard-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"sidebar-toggle",onClick:()=>f(!d),children:"☰"}),a.jsxs("div",{className:"header-title",children:[a.jsx("h1",{children:"⛽ Gestión de Combustibles"}),a.jsx("span",{className:"subtitle",children:"Forestech Colombia"})]}),a.jsxs("div",{className:"header-user",children:[a.jsxs("div",{className:"user-info",children:[a.jsx("span",{className:"user-name",children:i?.displayName||i?.email}),a.jsx("span",{className:"user-role",children:i?.role})]}),a.jsx("div",{className:"user-avatar",children:i?.photoURL?a.jsx("img",{src:i.photoURL,alt:"Avatar"}):a.jsx("div",{className:"avatar-placeholder",children:(i?.displayName||i?.email||"U").charAt(0).toUpperCase()})}),a.jsx("button",{className:"logout-button",onClick:j,title:"Cerrar sesión",children:"🚪"})]})]})}),a.jsxs("div",{className:"dashboard-body",children:[a.jsxs("aside",{className:`dashboard-sidebar ${d?"open":""}`,children:[a.jsx("nav",{className:"sidebar-nav",children:N.map(w=>a.jsxs("button",{className:`nav-item ${e===w.id?"active":""}`,onClick:()=>g(w.id),children:[a.jsx("span",{className:"nav-icon",children:w.icon}),a.jsxs("div",{className:"nav-content",children:[a.jsx("span",{className:"nav-name",children:w.name}),a.jsx("span",{className:"nav-description",children:w.description})]})]},w.id))}),a.jsx("div",{className:"sidebar-footer",children:a.jsxs("div",{className:"user-permissions",children:[a.jsx("h4",{children:"Permisos Activos:"}),a.jsxs("div",{className:"permission-list",children:[o()&&a.jsx("span",{className:"permission admin",children:"👑 Administrador"}),c()&&a.jsx("span",{className:"permission counter",children:"📊 Gestión Operativa"}),y("canManageInventory")&&a.jsx("span",{className:"permission",children:"🛢️ Inventario"}),y("canManageVehicles")&&a.jsx("span",{className:"permission",children:"🚜 Vehículos"})]})]})})]}),a.jsx("main",{className:"dashboard-main",children:a.jsx("div",{className:"main-content",children:n})})]}),d&&a.jsx("div",{className:"sidebar-overlay",onClick:()=>f(!1)})]})},RL=(n=[])=>{if(!Array.isArray(n)||n.length===0){console.warn("📋 Inventario vacío o no válido");return}console.group("📋 Estado Actual del Inventario"),console.log(`Total de items: ${n.length}`);const e=n.reduce((o,c)=>o+(parseFloat(c.currentStock)||0),0);console.log(`Stock total: ${e.toFixed(2)} galones`);const t=n.filter(o=>typeof o.currentStock>"u"||isNaN(parseFloat(o.currentStock))||o.currentStock!==o.quantity&&typeof o.quantity<"u");t.length>0&&(console.warn(`⚠️ ${t.length} items con posibles problemas de datos:`),t.forEach(o=>{console.warn(`- ${o.fuelType||o.name||"Item sin nombre"}: currentStock=${o.currentStock}, quantity=${o.quantity}`)}));const i={};n.forEach(o=>{const c=o.fuelType||"Desconocido";i[c]||(i[c]=0),i[c]+=parseFloat(o.currentStock)||0}),console.log("Stock por tipo de combustible:"),Object.entries(i).forEach(([o,c])=>{console.log(`- ${o}: ${c.toFixed(2)} gal`)}),console.groupEnd()},DL=(n=[])=>{if(!Array.isArray(n)||n.length===0)return[];const e={},t=[];return n.forEach(i=>{const o=`${i.fuelType||""}:${i.location||""}`;e[o]?(e[o].push(i),e[o].length===2?t.push(...e[o]):e[o].length>2&&t.push(i)):e[o]=[i]}),t},qE=()=>{const{inventory:n,movements:e,vehicles:t,loading:i,error:o}=js();G.useEffect(()=>{if(!i&&n.length>0){console.log("🔍 Ejecutando diagnóstico del inventario..."),RL(n);const g=DL(n);g.length>0&&(console.warn(`⚠️ Se detectaron ${g.length} posibles items duplicados:`),console.table(g.map(y=>({id:y.id,tipo:y.fuelType,ubicacion:y.location,stock:y.currentStock}))))}},[i,n]);const c=g=>g?g.toDate&&typeof g.toDate=="function"?g.toDate():g.seconds?new Date(g.seconds*1e3):g instanceof Date?g:new Date(g):new Date,d=G.useMemo(()=>{const g=t.filter(b=>b.status==="activo").length,y=e.filter(b=>b.status==="pendiente").length;console.log("Inventario en DashboardMain:",n.map(b=>({id:b.id,fuelType:b.fuelType,currentStock:b.currentStock,pricePerUnit:b.pricePerUnit||b.unitPrice})));const N=n.filter(b=>b.isActive!==!1).reduce((b,A)=>{const E=parseFloat(A.currentStock)||0;return console.log(`Sumando stock de ${A.fuelType}: ${E} gal`),b+E},0),j=n.filter(b=>b.isActive!==!1).reduce((b,A)=>{const E=parseFloat(A.currentStock)||0,D=parseFloat(A.pricePerUnit||A.unitPrice)||0;return b+E*D},0),w=n.filter(b=>{const A=parseFloat(b.currentStock)||0,E=parseFloat(b.minStock)||parseFloat(b.minThreshold)||20;return b.isActive!==!1&&A<=E}).length;return{totalFuel:N,totalValue:j,lowStockAlerts:w,activeInventoryItems:n.filter(b=>b.isActive!==!1).length,activeVehicles:g,pendingMovements:y,totalMaintenance:0,overdueMaintenance:0}},[n,t,e]),f=G.useMemo(()=>e.sort((g,y)=>c(y.createdAt).getTime()-c(g.createdAt).getTime()).slice(0,5),[e]),p=g=>{const y=g.quantity||0,N=g.fuelType||"N/A";switch(g.type){case"entrada":return`Entrada de ${y} gal de ${N}.`;case"salida":return`Salida de ${y} gal para vehículo ${g.vehicleId||"N/A"}.`;case"transferencia":return`Transferencia de ${y} gal.`;case"ajuste":return`Ajuste de inventario: ${y} gal de ${N}.`;default:return"Movimiento registrado."}};return i?a.jsxs("div",{className:"dashboard-main",children:[a.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),a.jsx("p",{className:"dashboard-subtitle",children:"Cargando datos en tiempo real..."}),a.jsx("div",{className:"loading-spinner-container",children:a.jsx("div",{className:"loading-spinner"})})]}):o?a.jsxs("div",{className:"dashboard-main",children:[a.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),a.jsxs("div",{className:"error-message",children:[a.jsxs("p",{children:["⚠️ ",o]}),a.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})]}):a.jsxs("div",{className:"dashboard-main",children:[a.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),a.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del estado de combustibles y maquinaria."}),a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon fuel-icon",children:"🛢️"}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Combustible Total"}),a.jsxs("h2",{children:[ke(d.totalFuel)," gal"]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon value-icon",children:"💰"}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Valor Inventario"}),a.jsx("h2",{children:Dn(d.totalValue)})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon vehicle-icon",children:"🚜"}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Vehículos Activos"}),a.jsx("h2",{children:ke(d.activeVehicles)})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon movement-icon",children:"🔄"}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Movimientos Pendientes"}),a.jsx("h2",{children:ke(d.pendingMovements)})]})]}),a.jsxs("div",{className:`stat-card ${d.lowStockAlerts>0?"alert":""}`,children:[a.jsx("div",{className:"stat-icon alert-icon",children:"⚠️"}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Alertas de Stock"}),a.jsx("h2",{children:ke(d.lowStockAlerts)})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon maintenance-icon",children:"🔧"}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Mantenimientos"}),a.jsx("h2",{children:ke(d.totalMaintenance)})]})]}),a.jsxs("div",{className:`stat-card ${d.overdueMaintenance>0?"alert":""}`,children:[a.jsx("div",{className:"stat-icon maintenance-alert-icon",children:"⏰"}),a.jsxs("div",{className:"stat-info",children:[a.jsx("p",{children:"Mantenimientos Vencidos"}),a.jsx("h2",{children:ke(d.overdueMaintenance)})]})]})]}),a.jsxs("div",{className:"dashboard-content",children:[a.jsxs("div",{className:"dashboard-widget",children:[a.jsx("h3",{children:"Actividad Reciente"}),f.length>0?a.jsx("ul",{children:f.map(g=>a.jsxs("li",{children:[a.jsx("span",{className:`movement-type-badge ${g.type}`,children:g.type}),p(g),a.jsx("span",{className:"movement-date",children:c(g.createdAt).toLocaleDateString()})]},g.id))}):a.jsx("p",{children:"No hay movimientos recientes."})]}),a.jsxs("div",{className:"dashboard-widget",children:[a.jsx("h3",{children:"📦 Stock por Producto"}),n.length>0?a.jsx("div",{className:"products-summary",children:n.map(g=>{const y=parseFloat(g.currentStock)||0,N=parseFloat(g.minStock||g.minThreshold)||20;return a.jsxs("div",{className:"product-summary-item",children:[a.jsx("div",{className:"product-icon",children:"⛽"}),a.jsxs("div",{className:"product-info",children:[a.jsx("span",{className:"product-name",children:g.fuelType||g.name}),a.jsxs("div",{className:"product-stats",children:[a.jsxs("span",{className:"stock-value",children:[ke(y)," gal"]}),a.jsx("span",{className:`stock-status ${y<=N?"low":"normal"}`,children:y<=N?"🟡 Stock bajo":"🟢 Normal"})]})]})]},g.id)})}):a.jsx("div",{className:"no-products",children:a.jsx("p",{children:"No hay inventario registrado."})})]})]})]})},ML=({items:n,onEdit:e,onDelete:t,canManage:i})=>{const[o,c]=G.useState("name"),[d,f]=G.useState("asc"),p=b=>new Intl.NumberFormat("es-CO").format(b),g=b=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(b),y=b=>{if(!b)return"N/A";const A=new Date;let E;if(b&&typeof b=="object")if(b.seconds)E=new Date(b.seconds*1e3);else if(b.toDate&&typeof b.toDate=="function")E=b.toDate();else if(b instanceof Date)E=b;else return"N/A";else if(typeof b=="string"||typeof b=="number")E=new Date(b);else return"N/A";if(isNaN(E.getTime()))return"N/A";const D=A-E,q=Math.floor(D/(1e3*60*60)),U=Math.floor(q/24);return U>0?`${U}d`:q>0?`${q}h`:"ahora"},N=b=>{o===b?f(d==="asc"?"desc":"asc"):(c(b),f("asc"))},j=[...n].sort((b,A)=>{let E=b[o],D=A[o];if(o==="lastUpdated"){const q=U=>{if(!U)return new Date(0);if(U&&typeof U=="object"){if(U.seconds)return new Date(U.seconds*1e3);if(U.toDate&&typeof U.toDate=="function")return U.toDate();if(U instanceof Date)return U}return new Date(U)};E=q(E),D=q(D)}return E<D?d==="asc"?-1:1:E>D?d==="asc"?1:-1:0}),w=b=>o!==b?"↕️":d==="asc"?"↑":"↓";return a.jsxs("div",{className:"inventory-table-container",children:[a.jsx("div",{className:"table-wrapper",children:a.jsxs("table",{className:"inventory-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{onClick:()=>N("name"),className:"sortable",children:["Combustible ",w("name")]}),a.jsxs("th",{onClick:()=>N("location"),className:"sortable",children:["Ubicación ",w("location")]}),a.jsxs("th",{onClick:()=>N("currentStock"),className:"sortable",children:["Stock Actual ",w("currentStock")]}),a.jsxs("th",{onClick:()=>N("stockPercentage"),className:"sortable",children:["Nivel ",w("stockPercentage")]}),a.jsxs("th",{onClick:()=>N("pricePerUnit"),className:"sortable",children:["Precio ",w("pricePerUnit")]}),a.jsx("th",{children:"Valor Total"}),a.jsxs("th",{onClick:()=>N("status"),className:"sortable",children:["Estado ",w("status")]}),a.jsxs("th",{onClick:()=>N("lastUpdated"),className:"sortable",children:["Actualizado ",w("lastUpdated")]}),i&&a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:j.map(b=>{const A=il[b.fuelType],E=Bo[b.stockLevel],D=parseFloat(b.currentStock)||0,q=parseFloat(b.pricePerUnit)||0,U=parseFloat(b.maxCapacity)||0,P=parseFloat(b.stockPercentage)||0,F=D*q;return a.jsxs("tr",{className:b.needsRestock?"needs-restock":"",children:[a.jsx("td",{className:"fuel-cell",children:a.jsxs("div",{className:"fuel-info",children:[a.jsx("span",{className:"fuel-icon",style:{color:A?.color},children:A?.icon}),a.jsxs("div",{children:[a.jsx("div",{className:"fuel-name",children:A?.name}),a.jsx("div",{className:"fuel-type",children:b.fuelType})]})]})}),a.jsx("td",{children:b.location}),a.jsxs("td",{className:"stock-cell",children:[a.jsxs("div",{className:"stock-info",children:[a.jsx("span",{className:"stock-amount",children:p(D)}),a.jsxs("span",{className:"stock-unit",children:["/ ",p(U)," ",b.unit||"gal"]})]}),b.needsRestock&&a.jsx("div",{className:"restock-indicator",children:"⚠️ Bajo mínimo"})]}),a.jsx("td",{className:"level-cell",children:a.jsxs("div",{className:"level-info",children:[a.jsxs("div",{className:"level-badge",style:{backgroundColor:E?.color,color:"white"},children:[P,"%"]}),a.jsx("div",{className:"level-bar",children:a.jsx("div",{className:"level-fill",style:{width:`${P}%`,backgroundColor:E?.color}})})]})}),a.jsx("td",{className:"price-cell",children:a.jsxs("div",{className:"price-info",children:[a.jsx("span",{className:"price-amount",children:g(q)}),a.jsxs("span",{className:"price-unit",children:["/ ",b.unit||"gal"]})]})}),a.jsx("td",{className:"value-cell",children:a.jsx("span",{className:"total-value",children:g(F)})}),a.jsx("td",{className:"status-cell",children:a.jsxs("span",{className:`status-badge ${b.status}`,children:[a.jsx("span",{className:"status-dot"}),b.status==="active"?"Activo":b.status==="inactive"?"Inactivo":b.status==="maintenance"?"Mantenimiento":b.status]})}),a.jsx("td",{className:"updated-cell",children:a.jsx("span",{className:"time-ago",children:y(b.lastUpdated)})}),i&&a.jsx("td",{className:"actions-cell",children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(b),title:"Editar",children:"✏️"}),a.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(b),title:"Eliminar",children:"🗑️"})]})})]},b.id)})})]})}),a.jsxs("div",{className:"table-footer",children:[a.jsxs("div",{className:"table-info",children:[j.length," items ordenados por ",o,"(",d==="asc"?"ascendente":"descendente",")"]}),a.jsxs("div",{className:"table-legend",children:[a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot critical"}),"Crítico"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot low"}),"Bajo"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot normal"}),"Normal"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},OL=({items:n,onEdit:e,onDelete:t,canManage:i})=>{const o=f=>new Intl.NumberFormat("es-CO").format(f),c=f=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(f),d=f=>{if(!f)return"sin fecha";try{const p=new Date;let g;f.seconds?g=new Date(f.seconds*1e3):f.toDate&&typeof f.toDate=="function"?g=f.toDate():g=new Date(f);const y=p-g,N=Math.floor(y/(1e3*60*60)),j=Math.floor(N/24);return j>0?`hace ${j} día${j>1?"s":""}`:N>0?`hace ${N} hora${N>1?"s":""}`:"hace unos minutos"}catch(p){return console.warn("Error al calcular tiempo transcurrido:",p),"fecha inválida"}};return a.jsx("div",{className:"inventory-cards-grid",children:n.map(f=>{const p=il[f.fuelType],g=Bo[f.stockLevel],y=parseFloat(f.currentStock)||0,N=parseFloat(f.pricePerUnit)||parseFloat(f.unitPrice)||0,j=parseFloat(f.maxCapacity)||parseFloat(f.capacity)||0,w=parseFloat(f.stockPercentage)||0,b=y*N;return a.jsxs("div",{className:"inventory-card",children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("div",{className:"fuel-info",children:[a.jsx("span",{className:"fuel-icon",style:{color:p?.color},children:p?.icon}),a.jsxs("div",{className:"fuel-details",children:[a.jsx("h3",{children:p?.name}),a.jsx("p",{className:"location",children:f.location})]})]}),a.jsx("div",{className:"stock-status",children:a.jsxs("span",{className:"status-badge",style:{backgroundColor:g?.color,color:"white"},children:[g?.icon," ",g?.label]})})]}),a.jsxs("div",{className:"stock-progress",children:[a.jsxs("div",{className:"progress-header",children:[a.jsxs("span",{className:"stock-text",children:[o(y)," / ",o(j)," ",f.unit||"gal"]}),a.jsxs("span",{className:"percentage",children:[w,"%"]})]}),a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill",style:{width:`${w}%`,backgroundColor:g?.color}})}),f.needsRestock&&a.jsxs("div",{className:"restock-warning",children:["⚠️ Bajo nivel mínimo (",o(f.minThreshold||f.minStock||0)," ",f.unit||"gal",")"]})]}),a.jsxs("div",{className:"card-metrics",children:[a.jsxs("div",{className:"metric",children:[a.jsxs("span",{className:"metric-label",children:["Precio por ",f.unit||"gal",":"]}),a.jsx("span",{className:"metric-value",children:c(N)})]}),a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Valor total:"}),a.jsx("span",{className:"metric-value",children:c(b)})]}),f.supplier&&a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Proveedor:"}),a.jsx("span",{className:"metric-value",children:f.supplier})]})]}),a.jsxs("div",{className:"card-footer",children:[a.jsxs("div",{className:"status-info",children:[a.jsx("span",{className:`status-dot ${f.status}`}),a.jsx("span",{className:"status-text",children:f.status==="active"?"Activo":f.status==="inactive"?"Inactivo":f.status==="maintenance"?"Mantenimiento":f.status})]}),a.jsxs("div",{className:"last-update",children:["Actualizado ",d(f.updatedAt||f.lastUpdated)]})]}),i&&a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>e(f),title:"Editar combustible",children:"✏️ Editar"}),a.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>t(f),title:"Eliminar combustible",children:"🗑️ Eliminar"})]}),f.description&&f.description!==p?.description&&a.jsx("div",{className:"card-description",children:a.jsx("p",{children:f.description})})]},f.id)})})},kL=({item:n,onClose:e,onSuccess:t})=>{const{userProfile:i}=js(),o=!!n,[c,d]=G.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[f,p]=G.useState({}),[g,y]=G.useState(!1);G.useEffect(()=>{o&&n&&d({fuelType:n.fuelType||"",location:n.location||"",currentStock:n.currentStock||"",maxCapacity:n.maxCapacity||"",minThreshold:n.minThreshold||"",pricePerUnit:n.pricePerUnit||"",supplier:n.supplier||"",description:n.description||"",status:n.status||"active"})},[o,n]),G.useEffect(()=>{if(c.maxCapacity&&!c.minThreshold){const A=Math.round(Number(c.maxCapacity)*.15);d(E=>({...E,minThreshold:A}))}},[c.maxCapacity]);const N=A=>{const{name:E,value:D}=A.target;d(q=>({...q,[E]:D})),f[E]&&p(q=>({...q,[E]:null}))},j=()=>{const A={};c.fuelType||(A.fuelType="Tipo de combustible es requerido"),c.location||(A.location="Ubicación es requerida"),c.maxCapacity||(A.maxCapacity="Capacidad máxima es requerida");const E=Number(c.currentStock),D=Number(c.maxCapacity),q=Number(c.minThreshold),U=Number(c.pricePerUnit);return c.currentStock&&(isNaN(E)||E<0)&&(A.currentStock="Stock actual debe ser un número válido mayor o igual a 0"),c.maxCapacity&&(isNaN(D)||D<=0)&&(A.maxCapacity="Capacidad máxima debe ser un número válido mayor a 0"),c.minThreshold&&(isNaN(q)||q<0)&&(A.minThreshold="Umbral mínimo debe ser un número válido mayor o igual a 0"),c.pricePerUnit&&(isNaN(U)||U<0)&&(A.pricePerUnit="Precio debe ser un número válido mayor o igual a 0"),E>D&&(A.currentStock="Stock actual no puede ser mayor a la capacidad máxima"),q>D&&(A.minThreshold="Umbral mínimo no puede ser mayor a la capacidad máxima"),p(A),Object.keys(A).length===0},w=async A=>{if(A.preventDefault(),!!j()){y(!0);try{let E;o?E=await bL(n.id,{location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},i.uid):E=await xL({fuelType:c.fuelType,location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},i.uid),E.success?(alert(E.message),t()):alert(`Error: ${E.error}`)}catch(E){console.error("Error saving inventory item:",E),alert("Error inesperado al guardar el item")}finally{y(!1)}}},b=il[c.fuelType];return a.jsx("div",{className:"modal-overlay",onClick:e,children:a.jsxs("div",{className:"modal-content inventory-modal",onClick:A=>A.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:o?"✏️ Editar Combustible":"➕ Agregar Nuevo Combustible"}),a.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),a.jsxs("form",{onSubmit:w,className:"modal-form",children:[a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",b&&a.jsxs("span",{className:"fuel-preview",children:[b.icon," ",b.name]})]}),a.jsxs("select",{id:"fuelType",name:"fuelType",value:c.fuelType,onChange:N,disabled:o,className:f.fuelType?"error":"",required:!0,children:[a.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(_n).map(([A,E])=>{const D=il[E];return a.jsxs("option",{value:E,children:[D.icon," ",D.name," (",D.unit,")"]},A)})]}),f.fuelType&&a.jsx("span",{className:"error-text",children:f.fuelType})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"location",children:"Ubicación / Tanque *"}),a.jsx("input",{type:"text",id:"location",name:"location",value:c.location,onChange:N,placeholder:"ej. Tanque Principal, Depósito A, Bodega Norte",className:f.location?"error":"",required:!0}),f.location&&a.jsx("span",{className:"error-text",children:f.location})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",b&&`(${b.unit})`]}),a.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:c.currentStock,onChange:N,placeholder:"0",min:"0",step:"0.01",className:f.currentStock?"error":""}),f.currentStock&&a.jsx("span",{className:"error-text",children:f.currentStock})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad Máxima * ",b&&`(${b.unit})`]}),a.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:c.maxCapacity,onChange:N,placeholder:"1000",min:"1",step:"0.01",className:f.maxCapacity?"error":"",required:!0}),f.maxCapacity&&a.jsx("span",{className:"error-text",children:f.maxCapacity})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"minThreshold",children:["Umbral Mínimo ",b&&`(${b.unit})`,a.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),a.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:c.minThreshold,onChange:N,placeholder:"Auto: 15% de capacidad máxima",min:"0",step:"0.01",className:f.minThreshold?"error":""}),f.minThreshold&&a.jsx("span",{className:"error-text",children:f.minThreshold}),c.maxCapacity&&a.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(c.maxCapacity)*.15)," ",b?.unit||"unidades"]})]}),a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",b?.unit||"Unidad"]}),a.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:c.pricePerUnit,onChange:N,placeholder:"12000",min:"0",step:"0.01",className:f.pricePerUnit?"error":""}),f.pricePerUnit&&a.jsx("span",{className:"error-text",children:f.pricePerUnit})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),a.jsx("input",{type:"text",id:"supplier",name:"supplier",value:c.supplier,onChange:N,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"status",children:"Estado"}),a.jsxs("select",{id:"status",name:"status",value:c.status,onChange:N,children:[a.jsx("option",{value:"active",children:"Activo"}),a.jsx("option",{value:"inactive",children:"Inactivo"}),a.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),a.jsxs("div",{className:"form-group full-width",children:[a.jsx("label",{htmlFor:"description",children:"Descripción / Notas"}),a.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:N,placeholder:"Información adicional sobre este combustible...",rows:"3"})]})]}),b&&c.maxCapacity&&a.jsxs("div",{className:"form-preview",children:[a.jsx("h4",{children:"📊 Vista Previa"}),a.jsxs("div",{className:"preview-card",children:[a.jsxs("div",{className:"preview-header",children:[a.jsxs("span",{style:{color:b.color},children:[b.icon," ",b.name]}),a.jsx("span",{children:c.location})]}),a.jsxs("div",{className:"preview-capacity",children:[c.currentStock||0," / ",c.maxCapacity," ",b.unit,c.currentStock&&c.maxCapacity&&a.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(c.currentStock)/Number(c.maxCapacity)*100),"%)"]})]}),c.pricePerUnit&&a.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(c.currentStock)||0)*Number(c.pricePerUnit))]})]})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:g,children:g?"Guardando...":o?"Actualizar":"Crear"})]})]})]})})},PL=({stats:n})=>a.jsxs("div",{className:"inventory-stats",children:[a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card primary",children:[a.jsx("div",{className:"stat-icon",children:"💰"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:"Valor Total"}),a.jsx("div",{className:"stat-value",children:Dn(n.totalValue)}),a.jsxs("div",{className:"stat-subtitle",children:[ke(n.totalItems)," tipos de combustible"]})]})]}),a.jsxs("div",{className:"stat-card success",children:[a.jsx("div",{className:"stat-icon",children:"✅"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:"Items Activos"}),a.jsx("div",{className:"stat-value",children:n.activeItems}),a.jsxs("div",{className:"stat-subtitle",children:[Math.round(n.activeItems/n.totalItems*100),"% del total"]})]})]}),a.jsxs("div",{className:`stat-card ${n.lowStockItems>0?"warning":"info"}`,children:[a.jsx("div",{className:"stat-icon",children:n.lowStockItems>0?"⚠️":"📊"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:"Stock Bajo"}),a.jsx("div",{className:"stat-value",children:n.lowStockItems}),a.jsx("div",{className:"stat-subtitle",children:n.lowStockItems>0?"Requieren atención":"Niveles normales"})]})]}),a.jsxs("div",{className:"stat-card info",children:[a.jsx("div",{className:"stat-icon",children:"📈"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:"Nivel Promedio"}),a.jsxs("div",{className:"stat-value",children:[n.averageStockLevel,"%"]}),a.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),a.jsxs("div",{className:"fuel-type-summary",children:[a.jsx("h4",{children:"📊 Resumen por Tipo de Combustible"}),a.jsx("div",{className:"fuel-types-grid",children:Object.entries(n.byFuelType).map(([e,t])=>{const i=il[e],o=t.totalCapacity>0?Math.round(t.totalStock/t.totalCapacity*100):0;return a.jsxs("div",{className:"fuel-type-card",children:[a.jsxs("div",{className:"fuel-header",children:[a.jsx("span",{className:"fuel-icon",style:{color:i?.color||"#6b7280"},children:i?.icon||"⛽"}),a.jsxs("div",{className:"fuel-info",children:[a.jsx("h5",{children:i?.name||e}),a.jsxs("span",{className:"fuel-count",children:[t.count," ubicaciones"]})]})]}),a.jsxs("div",{className:"fuel-metrics",children:[a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Stock Total:"}),a.jsxs("span",{className:"metric-value",children:[ke(t.totalStock)," ",i?.unit||"unidades"]})]}),a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Capacidad:"}),a.jsxs("span",{className:"metric-value",children:[ke(t.totalCapacity)," ",i?.unit||"unidades"]})]}),a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Utilización:"}),a.jsxs("span",{className:`metric-value ${o<25?"low":o>75?"high":"normal"}`,children:[o,"%"]})]}),a.jsxs("div",{className:"metric",children:[a.jsx("span",{className:"metric-label",children:"Valor:"}),a.jsx("span",{className:"metric-value",children:Dn(t.totalValue)})]})]}),a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill",style:{width:`${o}%`,backgroundColor:i?.color||"#6b7280"}})})]},e)})}),Object.keys(n.byFuelType).length===0&&a.jsx("div",{className:"empty-fuel-types",children:a.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),LL=()=>{const{hasPermission:n}=js(),[e,t]=G.useState([]),[i,o]=G.useState(null),[c,d]=G.useState(!0),[f,p]=G.useState(null),[g,y]=G.useState("cards"),[N,j]=G.useState(!1),[w,b]=G.useState(null),[A,E]=G.useState("all"),[D,q]=G.useState("");G.useEffect(()=>{let S=null;return(()=>{S=IA((O,C)=>{if(C){console.error("Error in inventory subscription:",C),p("Error cargando inventario en tiempo real");return}t(O||[]),d(!1)})})(),()=>{S&&S()}},[]),G.useEffect(()=>{(async()=>{const k=await _L();k.success&&o(k.data)})()},[e]);const U=e.filter(S=>{if(A==="active"&&S.status!=="active"||A==="low-stock"&&!S.needsRestock)return!1;if(D){const k=D.toLowerCase();return S.name.toLowerCase().includes(k)||S.location.toLowerCase().includes(k)||S.fuelType.toLowerCase().includes(k)}return!0}),P=S=>{if(!n("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}b(S),j(!0)},F=async S=>{if(!n("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`¿Estás seguro de eliminar ${S.name} de ${S.location}?

Esta acción no se puede deshacer.`))return;d(!0);const O=await NL(S.id);O.success?alert("Item eliminado exitosamente"):(p(O.error),alert(`Error al eliminar: ${O.error}`)),d(!1)},$=()=>{j(!1),b(null)},L=()=>{$()};return c&&e.length===0?a.jsxs("div",{className:"inventory-loading",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando inventario..."})]}):a.jsxs("div",{className:"inventory-main",children:[a.jsxs("div",{className:"inventory-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h2",{children:"🛢️ Gestión de Inventario"}),a.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),a.jsx("div",{className:"inventory-info",children:a.jsxs("span",{className:"info-text",children:["💡 Los combustibles se agregan automáticamente desde la pestaña ",a.jsx("strong",{children:"Movimientos"})]})})]}),i&&a.jsx(PL,{stats:i}),a.jsxs("div",{className:"inventory-controls",children:[a.jsxs("div",{className:"search-filters",children:[a.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicación o tipo...",value:D,onChange:S=>q(S.target.value),className:"search-input"}),a.jsxs("select",{value:A,onChange:S=>E(S.target.value),className:"filter-select",children:[a.jsx("option",{value:"all",children:"Todos los items"}),a.jsx("option",{value:"active",children:"Solo activos"}),a.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),a.jsxs("div",{className:"view-toggle",children:[a.jsx("button",{className:`toggle-btn ${g==="cards"?"active":""}`,onClick:()=>y("cards"),children:"📱 Cards"}),a.jsx("button",{className:`toggle-btn ${g==="table"?"active":""}`,onClick:()=>y("table"),children:"📊 Tabla"})]})]}),f&&a.jsxs("div",{className:"error-banner",children:[a.jsxs("span",{children:["⚠️ ",f]}),a.jsx("button",{onClick:()=>p(null),children:"✕"})]}),a.jsx("div",{className:"inventory-content",children:U.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:"📦"}),a.jsx("h3",{children:"No hay items de inventario"}),a.jsx("p",{children:D||A!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaña Movimientos para crear una ENTRADA de combustible"})]}):a.jsx(a.Fragment,{children:g==="cards"?a.jsx(OL,{items:U,onEdit:P,onDelete:F,canManage:n("canManageInventory")}):a.jsx(ML,{items:U,onEdit:P,onDelete:F,canManage:n("canManageInventory")})})}),U.length>0&&a.jsx("div",{className:"results-footer",children:a.jsxs("p",{children:["Mostrando ",U.length," de ",e.length," items",D&&` · Filtro: "${D}"`,A!=="all"&&` · Estado: ${A}`]})}),N&&a.jsx(kL,{item:w,onClose:$,onSuccess:L})]})},VL=({stats:n,filters:e})=>{if(!n)return null;const t=(d,f)=>f===0?d>0?100:0:((d-f)/f*100).toFixed(1),i=d=>{switch(d){case he.ENTRADA:return"#10b981";case he.SALIDA:return"#ef4444";case he.TRANSFERENCIA:return"#3b82f6";case he.AJUSTE:return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case he.ENTRADA:return"📥";case he.SALIDA:return"📤";case he.TRANSFERENCIA:return"🔄";case he.AJUSTE:return"⚖️";default:return"📋"}},c=t(n.thisMonth,n.lastMonth);return a.jsxs("div",{className:"movements-stats",children:[a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card primary",children:[a.jsx("div",{className:"stat-icon",children:"📊"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:ke(n.totalMovements)}),a.jsx("div",{className:"stat-label",children:"Total Movimientos"}),a.jsxs("div",{className:"stat-trend",children:[a.jsxs("span",{className:`trend ${c>=0?"positive":"negative"}`,children:[c>=0?"📈":"📉"," ",Math.abs(c),"%"]}),a.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:"💰"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:Dn(n.totalValue)}),a.jsx("div",{className:"stat-label",children:"Valor Total"}),a.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Dn(n.averageValue)]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:"⛽"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:ke(n.totalQuantity)}),a.jsx("div",{className:"stat-label",children:"Galones Total"}),a.jsxs("div",{className:"stat-secondary",children:["Promedio: ",ke(n.totalQuantity/(n.totalMovements||1))," gal/mov"]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:"📅"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:ke(n.thisWeek)}),a.jsx("div",{className:"stat-label",children:"Esta Semana"}),a.jsxs("div",{className:"stat-secondary",children:[ke(n.thisMonth)," este mes"]})]})]})]}),a.jsxs("div",{className:"stats-breakdown",children:[a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:"📋 Por Tipo de Movimiento"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1);return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:o(d)}),a.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),a.jsx("div",{className:"breakdown-value",children:f}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:i(d)}})}),a.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:"⚡ Por Estado"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),g=N=>{switch(N){case Qe.COMPLETADO:return"#10b981";case Qe.PENDIENTE:return"#f59e0b";case Qe.CANCELADO:return"#ef4444";default:return"#6b7280"}},y=N=>{switch(N){case Qe.COMPLETADO:return"✅";case Qe.PENDIENTE:return"⏳";case Qe.CANCELADO:return"❌";default:return"❓"}};return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:y(d)}),a.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),a.jsx("div",{className:"breakdown-value",children:f}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:g(d)}})}),a.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),g=y=>{switch(y?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}};return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:g(d)}),a.jsx("span",{className:"breakdown-label",children:d})]}),a.jsx("div",{className:"breakdown-value",children:f}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:"#059669"}})}),a.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]})]}),(e.type||e.status||e.fuelType||e.vehicleId)&&a.jsxs("div",{className:"active-filters",children:[a.jsx("h4",{children:"🔍 Filtros Activos"}),a.jsxs("div",{className:"filters-list",children:[e.type&&a.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&a.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&a.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.vehicleId&&a.jsxs("span",{className:"filter-tag",children:["Vehículo: ",e.vehicleId]})]})]})]})},UL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:i,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const[p,g]=G.useState(!1),y=[{value:"Diesel",label:"Diesel 🚛"},{value:"Gasolina",label:"Gasolina 🚗"},{value:"ACPM",label:"ACPM 🚚"},{value:"Lubricante",label:"Lubricante 🛢️"}],N=[{value:"all",label:"Todos los períodos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este año"}],j=Object.values(n).filter(A=>A&&A!==""&&A!=="all").length,w=(A,E)=>{e({[A]:E})},b=A=>{e(A)};return a.jsxs("div",{className:"movements-filters",children:[a.jsxs("div",{className:"filters-main",children:[a.jsx("div",{className:"search-section",children:a.jsxs("div",{className:"search-box",children:[a.jsx("span",{className:"search-icon",children:"🔍"}),a.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehículo, referencia...",value:i,onChange:A=>o(A.target.value),className:"search-input"}),i&&a.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),a.jsxs("div",{className:"filters-controls",children:[a.jsxs("div",{className:"quick-filters",children:[a.jsx("button",{className:`quick-filter ${n.type===he.ENTRADA?"active":""}`,onClick:()=>b({type:he.ENTRADA}),children:"📥 Entradas"}),a.jsx("button",{className:`quick-filter ${n.type===he.SALIDA?"active":""}`,onClick:()=>b({type:he.SALIDA}),children:"📤 Salidas"}),a.jsx("button",{className:`quick-filter ${n.status===Qe.PENDIENTE?"active":""}`,onClick:()=>b({status:Qe.PENDIENTE}),children:"⏳ Pendientes"})]}),a.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>g(!p),children:["🎛️ Filtros",j>0&&a.jsx("span",{className:"filters-count",children:j})]}),a.jsxs("div",{className:"view-modes",children:[a.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),a.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&a.jsxs("div",{className:"filters-advanced",children:[a.jsxs("div",{className:"filters-grid",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Tipo de Movimiento"}),a.jsxs("select",{value:n.type,onChange:A=>w("type",A.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los tipos"}),a.jsx("option",{value:he.ENTRADA,children:"📥 Entrada"}),a.jsx("option",{value:he.SALIDA,children:"📤 Salida"}),a.jsx("option",{value:he.TRANSFERENCIA,children:"🔄 Transferencia"}),a.jsx("option",{value:he.AJUSTE,children:"⚖️ Ajuste"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Estado"}),a.jsxs("select",{value:n.status,onChange:A=>w("status",A.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los estados"}),a.jsx("option",{value:Qe.PENDIENTE,children:"⏳ Pendiente"}),a.jsx("option",{value:Qe.COMPLETADO,children:"✅ Completado"}),a.jsx("option",{value:Qe.CANCELADO,children:"❌ Cancelado"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Tipo de Combustible"}),a.jsxs("select",{value:n.fuelType,onChange:A=>w("fuelType",A.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los combustibles"}),y.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Período"}),a.jsx("select",{value:n.dateRange,onChange:A=>w("dateRange",A.target.value),className:"filter-select",children:N.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Vehículo/Equipo"}),a.jsx("input",{type:"text",placeholder:"ID del vehículo...",value:n.vehicleId,onChange:A=>w("vehicleId",A.target.value),className:"filter-input"})]})]}),a.jsxs("div",{className:"filters-actions",children:[a.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:j===0,children:"🗑️ Limpiar Filtros"}),a.jsxs("div",{className:"filters-info",children:[a.jsxs("span",{className:"results-count",children:[f," resultado",f!==1?"s":""]}),j>0&&a.jsxs("span",{className:"active-filters-text",children:["(",j," filtro",j!==1?"s":""," activo",j!==1?"s":"",")"]})]})]})]}),a.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:a.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},FL=({movements:n,onEdit:e,onView:t,onApprove:i,onReject:o,onDelete:c,userRole:d})=>{const f=A=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(A),p=A=>A?(A instanceof Date?A:new Date(A)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Sin fecha",g=A=>{if(!A)return"";const E=new Date,D=A instanceof Date?A:new Date(A),q=Math.abs(E-D),U=Math.ceil(q/(1e3*60*60*24));return U===1?"hace 1 día":U<7?`hace ${U} días`:U<30?`hace ${Math.ceil(U/7)} semanas`:U<365?`hace ${Math.ceil(U/30)} meses`:`hace ${Math.ceil(U/365)} años`},y=A=>{switch(A){case he.ENTRADA:return"movement-entrada";case he.SALIDA:return"movement-salida";case he.TRANSFERENCIA:return"movement-transferencia";case he.AJUSTE:return"movement-ajuste";default:return"movement-default"}},N=A=>{switch(A){case Qe.COMPLETADO:return"status-completado";case Qe.PENDIENTE:return"status-pendiente";case Qe.CANCELADO:return"status-cancelado";default:return"status-default"}},j=A=>{switch(A){case he.ENTRADA:return"📥";case he.SALIDA:return"📤";case he.TRANSFERENCIA:return"🔄";case he.AJUSTE:return"⚖️";default:return"📋"}},w=A=>{switch(A?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},b=A=>{switch(A){case Qe.COMPLETADO:return"✅";case Qe.PENDIENTE:return"⏳";case Qe.CANCELADO:return"❌";default:return"❓"}};return a.jsx("div",{className:"movements-cards",children:n.map(A=>a.jsxs("div",{className:`movement-card ${y(A.type)}`,children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("div",{className:"movement-type",children:[a.jsx("span",{className:"type-icon",children:j(A.type)}),a.jsx("span",{className:"type-label",children:A.type.charAt(0).toUpperCase()+A.type.slice(1)})]}),a.jsxs("div",{className:`status-badge ${N(A.status)}`,children:[a.jsx("span",{className:"status-icon",children:b(A.status)}),a.jsx("span",{className:"status-label",children:A.status.charAt(0).toUpperCase()+A.status.slice(1)})]})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"fuel-info",children:[a.jsx("span",{className:"fuel-icon",children:w(A.fuelType)}),a.jsx("span",{className:"fuel-type",children:A.fuelType}),a.jsxs("span",{className:"quantity",children:[A.quantity," galones"]})]}),a.jsxs("div",{className:"value-info",children:[a.jsx("div",{className:"total-value",children:f(A.totalValue)}),a.jsxs("div",{className:"unit-price",children:[f(A.unitPrice),"/galón"]})]}),A.vehicleId&&a.jsxs("div",{className:"vehicle-info",children:[a.jsx("span",{className:"vehicle-icon",children:"🚜"}),a.jsxs("span",{className:"vehicle-id",children:["Vehículo: ",A.vehicleId]})]}),A.location&&a.jsxs("div",{className:"location-info",children:[a.jsx("span",{className:"location-icon",children:"📍"}),a.jsx("span",{className:"location",children:A.location})]}),A.description&&a.jsx("div",{className:"description",children:a.jsx("p",{children:A.description})}),A.reference&&a.jsxs("div",{className:"reference",children:[a.jsx("span",{className:"reference-label",children:"Ref:"}),a.jsx("span",{className:"reference-value",children:A.reference})]})]}),a.jsxs("div",{className:"card-footer",children:[a.jsxs("div",{className:"date-info",children:[a.jsx("div",{className:"created-date",children:p(A.createdAt)}),a.jsx("div",{className:"relative-time",children:g(A.createdAt)})]}),a.jsxs("div",{className:"card-actions",children:[d==="admin"&&A.status===Qe.PENDIENTE&&a.jsxs("div",{className:"admin-actions",children:[a.jsx("button",{className:"btn-approve",onClick:()=>i(A.id),title:"Aprobar movimiento",children:"✓ Aprobar"}),a.jsx("button",{className:"btn-reject",onClick:()=>o(A.id),title:"Rechazar movimiento",children:"✗ Rechazar"})]}),a.jsxs("div",{className:"user-actions",children:[a.jsx("button",{className:"btn-view",onClick:()=>t(A),title:"Ver detalles",children:"👁️ Ver"}),e&&A.status===Qe.PENDIENTE&&a.jsx("button",{className:"btn-edit",onClick:()=>e(A),title:"Editar movimiento",children:"✏️ Editar"}),d==="admin"&&a.jsx("button",{className:"btn-delete",onClick:()=>{window.confirm("¿Estás seguro de que deseas eliminar este movimiento? Esta acción no se puede deshacer.")&&c(A.id)},title:"Eliminar movimiento",children:"🗑️ Eliminar"})]})]})]}),A.status===Qe.PENDIENTE&&a.jsx("div",{className:"urgency-indicator",children:a.jsx("div",{className:"urgency-pulse"})}),A.type===he.AJUSTE&&a.jsx("div",{className:"adjustment-badge",children:a.jsx("span",{children:"Ajuste"})}),A.type===he.TRANSFERENCIA&&A.destinationLocation&&a.jsxs("div",{className:"transfer-info",children:[a.jsx("span",{className:"transfer-arrow",children:"→"}),a.jsx("span",{className:"destination",children:A.destinationLocation})]})]},A.id))})},qL=({movements:n,onEdit:e,onView:t,onApprove:i,onReject:o,onDelete:c,userRole:d})=>{const[f,p]=G.useState("createdAt"),[g,y]=G.useState("desc"),N=P=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(P),j=P=>P?(P instanceof Date?P:new Date(P)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",w=P=>{switch(P){case he.ENTRADA:return"📥";case he.SALIDA:return"📤";case he.TRANSFERENCIA:return"🔄";case he.AJUSTE:return"⚖️";default:return"📋"}},b=P=>{switch(P?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},A=P=>{switch(P){case Qe.COMPLETADO:return"✅";case Qe.PENDIENTE:return"⏳";case Qe.CANCELADO:return"❌";default:return"❓"}},E=P=>{switch(P){case Qe.COMPLETADO:return"status-completado";case Qe.PENDIENTE:return"status-pendiente";case Qe.CANCELADO:return"status-cancelado";default:return"status-default"}},D=P=>{f===P?y(g==="asc"?"desc":"asc"):(p(P),y("asc"))},q=[...n].sort((P,F)=>{let $=P[f],L=F[f];return(f.includes("Date")||f.includes("At"))&&($=new Date($),L=new Date(L)),typeof $=="number"&&typeof L=="number"?g==="asc"?$-L:L-$:typeof $=="string"&&typeof L=="string"?g==="asc"?$.localeCompare(L):L.localeCompare($):$ instanceof Date&&L instanceof Date?g==="asc"?$-L:L-$:0}),U=P=>f!==P?"↕️":g==="asc"?"↑":"↓";return a.jsxs("div",{className:"movements-table-container",children:[a.jsx("div",{className:"table-wrapper",children:a.jsxs("table",{className:"movements-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{className:"sortable",onClick:()=>D("type"),children:["Tipo ",U("type")]}),a.jsxs("th",{className:"sortable",onClick:()=>D("fuelType"),children:["Combustible ",U("fuelType")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>D("quantity"),children:["Cantidad ",U("quantity")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>D("unitPrice"),children:["Precio/Gal ",U("unitPrice")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>D("totalValue"),children:["Valor Total ",U("totalValue")]}),a.jsx("th",{children:"Vehículo"}),a.jsx("th",{children:"Ubicación"}),a.jsxs("th",{className:"sortable",onClick:()=>D("status"),children:["Estado ",U("status")]}),a.jsxs("th",{className:"sortable",onClick:()=>D("createdAt"),children:["Fecha ",U("createdAt")]}),a.jsx("th",{className:"actions-column",children:"Acciones"})]})}),a.jsx("tbody",{children:q.map(P=>a.jsxs("tr",{className:`movement-row ${P.status===Qe.PENDIENTE?"pending-row":""}`,children:[a.jsx("td",{className:"type-cell",children:a.jsxs("div",{className:"type-content",children:[a.jsx("span",{className:"type-icon",children:w(P.type)}),a.jsx("span",{className:"type-text",children:P.type.charAt(0).toUpperCase()+P.type.slice(1)})]})}),a.jsx("td",{className:"fuel-cell",children:a.jsxs("div",{className:"fuel-content",children:[a.jsx("span",{className:"fuel-icon",children:b(P.fuelType)}),a.jsx("span",{className:"fuel-text",children:P.fuelType})]})}),a.jsxs("td",{className:"quantity-cell text-right",children:[a.jsx("span",{className:"quantity-value",children:P.quantity}),a.jsx("span",{className:"quantity-unit",children:"gal"})]}),a.jsx("td",{className:"price-cell text-right",children:N(P.unitPrice)}),a.jsx("td",{className:"value-cell text-right",children:a.jsx("strong",{children:N(P.totalValue)})}),a.jsx("td",{className:"vehicle-cell",children:P.vehicleId?a.jsxs("span",{className:"vehicle-id",children:["🚜 ",P.vehicleId]}):a.jsx("span",{className:"no-vehicle",children:"-"})}),a.jsx("td",{className:"location-cell",children:a.jsxs("span",{className:"location-text",children:["📍 ",P.location||"Principal"]})}),a.jsx("td",{className:"status-cell",children:a.jsxs("div",{className:`status-badge ${E(P.status)}`,children:[a.jsx("span",{className:"status-icon",children:A(P.status)}),a.jsx("span",{className:"status-text",children:P.status.charAt(0).toUpperCase()+P.status.slice(1)})]})}),a.jsx("td",{className:"date-cell",children:a.jsxs("div",{className:"date-content",children:[a.jsx("span",{className:"date-value",children:j(P.createdAt)}),P.reference&&a.jsxs("span",{className:"reference-small",children:["#",P.reference]})]})}),a.jsx("td",{className:"actions-cell",children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"btn-action btn-view",onClick:()=>t(P),title:"Ver detalles",children:"👁️"}),d==="admin"&&P.status===Qe.PENDIENTE&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"btn-action btn-approve",onClick:()=>i(P.id),title:"Aprobar movimiento",children:"✓"}),a.jsx("button",{className:"btn-action btn-reject",onClick:()=>o(P.id),title:"Rechazar movimiento",children:"✗"})]}),e&&P.status===Qe.PENDIENTE&&a.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(P),title:"Editar movimiento",children:"✏️"}),d==="admin"&&a.jsx("button",{className:"btn-action btn-delete",onClick:()=>{window.confirm("¿Estás seguro de que deseas eliminar este movimiento? Esta acción no se puede deshacer.")&&c(P.id)},title:"Eliminar movimiento",children:"🗑️"})]})})]},P.id))})]})}),a.jsxs("div",{className:"table-info",children:[a.jsxs("div",{className:"table-summary",children:[a.jsxs("span",{className:"total-rows",children:[n.length," movimiento",n.length!==1?"s":""]}),f&&a.jsxs("span",{className:"sort-info",children:["Ordenado por ",f," (",g==="asc"?"ascendente":"descendente",")"]})]}),a.jsxs("div",{className:"table-legend",children:[a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:"⏳"})," Pendiente"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:"✅"})," Completado"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:"❌"})," Cancelado"]})]})]})]})},zL=({movements:n,viewMode:e,onEdit:t,onView:i,onApprove:o,onReject:c,onDelete:d,userRole:f})=>e==="table"?a.jsx(qL,{movements:n,onEdit:t,onView:i,onApprove:o,onReject:c,onDelete:d,userRole:f}):a.jsx(FL,{movements:n,onEdit:t,onView:i,onApprove:o,onReject:c,onDelete:d,userRole:f}),Aa={ACPM:"ACPM",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},HA={[Aa.ACPM]:{name:"ACPM",displayName:"ACPM 🚛",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"🚛",description:"Combustible diesel para vehículos pesados"},[Aa.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina 🚗",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"🚗",description:"Gasolina corriente para vehículos livianos"},[Aa.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidráulico 🔧",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"🔧",description:"Aceite hidráulico para sistemas de maquinaria"},[Aa.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 🛢️",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"🛢️",description:"Aceite multigrado para motores"},[Aa.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja 🟥",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"🟥",description:"Grasa lubricante multipropósito"},[Aa.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ⚙️",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"⚙️",description:"Aceite para transmisiones y diferenciales"},[Aa.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Líquido para Frenos 🛑",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"🛑",description:"Líquido de frenos DOT 3/4"},[Aa.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga 🌿",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"🌿",description:"Mezcla de combustible para equipos menores"},[Aa.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 🚜",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"🚜",description:"Aceite especializado para tractores"}},Hs={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},zE=()=>Object.values(HA),HE="combustibles_products",HL=async()=>{try{console.log("🔄 Verificando productos existentes...");const n=Ee(Oe(fe,HE),VO(1));if(!(await mt(n)).empty){console.log("✅ Productos ya existen en Firebase");return}console.log("📦 Creando productos predefinidos...");const t=Object.values(HA).map(async o=>{const c={name:o.name,displayName:o.displayName,category:o.category,unit:o.unit,defaultPrice:o.defaultPrice,color:o.color,icon:o.icon,description:o.description,isActive:!0,createdAt:new Date,updatedAt:new Date,createdBy:"system-initialization"},d=et(Oe(fe,HE));return await gf(d,c),console.log(`✅ Producto creado: ${o.displayName}`),{id:d.id,...c}}),i=await Promise.all(t);return console.log(`🎉 ${i.length} productos inicializados correctamente`),i}catch(n){throw console.error("❌ Error inicializando productos:",n),n}},BL=async()=>{try{await HL()}catch(n){console.error("❌ Error en inicialización automática:",n)}},ll="combustibles_products",Zp=async n=>{try{const e={...n,createdAt:Ue(),updatedAt:Ue()},t=await pl(Oe(fe,ll),e);return console.log("Product created with ID:",t.id),t.id}catch(e){throw console.error("Error creating product:",e),e}},GL=async(n,e)=>{try{const t=et(fe,ll,n);await Ts(t,{...e,updatedAt:Ue()}),console.log("Product updated successfully")}catch(t){throw console.error("Error updating product:",t),t}},$L=async n=>{try{await vf(et(fe,ll,n)),console.log("Product deleted successfully")}catch(e){throw console.error("Error deleting product:",e),e}},YL=async()=>{try{await BL(),console.log("🔍 Obteniendo productos activos...");const n=Ee(Oe(fe,ll),Se("isActive","==",!0),jn("name")),t=(await mt(n)).docs.map(i=>({id:i.id,...i.data()}));return console.log(`✅ Productos activos obtenidos: ${t.length}`),t}catch(n){if(console.error("❌ Error obteniendo productos activos:",n),n.code==="failed-precondition"||n.message.includes("index")){console.warn("⚠️ Índice no disponible, usando consulta alternativa...");try{const e=Ee(Oe(fe,ll),Se("isActive","==",!0)),o=(await mt(e)).docs.map(c=>({id:c.id,...c.data()})).sort((c,d)=>(c.name||"").localeCompare(d.name||""));return console.log(`✅ Productos activos obtenidos (ordenamiento en cliente): ${o.length}`),o}catch(e){throw console.error("❌ Error en consulta alternativa:",e),e}}throw n}},QL=(n,e)=>{try{const t=Ee(Oe(fe,ll),jn("name"));return qr(t,i=>{const o=i.docs.map(c=>({id:c.id,...c.data()}));n(o)},i=>{console.error("Error in products subscription:",i),e(i)})}catch(t){return console.error("Error setting up products subscription:",t),e(t),()=>{}}},KL=({formData:n,updateFormData:e,setError:t})=>{const i=[{type:he.ENTRADA,icon:"📥",title:"Entrada",description:"Compra o reabastecimiento de combustible",color:"entrada",details:"Registra combustible que llega desde proveedores"},{type:he.SALIDA,icon:"📤",title:"Salida",description:"Consumo de combustible por vehículos",color:"salida",details:"Asigna combustible a vehículos y equipos"},{type:he.TRANSFERENCIA,icon:"🔄",title:"Transferencia",description:"Movimiento entre ubicaciones",color:"transferencia",details:"Traslada combustible entre tanques o sitios"},{type:he.AJUSTE,icon:"⚖️",title:"Ajuste",description:"Corrección de inventario",color:"ajuste",details:"Ajusta stock por mermas, pérdidas o calibraciones"}],o=c=>{e("type",c),t("")};return a.jsx("div",{className:"wizard-step step-movement-type",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:"🍀 ¿Qué tipo de operación realizarás?"}),a.jsx("p",{children:"Selecciona el tipo de movimiento que necesitas registrar:"})]}),a.jsx("div",{className:"movement-options",children:i.map(c=>a.jsxs("div",{className:`movement-option ${n.type===c.type?"selected":""} ${c.color}`,onClick:()=>o(c.type),children:[a.jsx("div",{className:"option-icon",children:c.icon}),a.jsxs("div",{className:"option-content",children:[a.jsx("h4",{children:c.title}),a.jsx("p",{className:"option-description",children:c.description}),a.jsx("small",{className:"option-details",children:c.details})]}),a.jsx("div",{className:"option-selector",children:n.type===c.type&&a.jsx("span",{className:"check-icon",children:"✅"})})]},c.type))}),n.type&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card",children:[a.jsx("span",{className:"confirmation-icon",children:i.find(c=>c.type===n.type)?.icon}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:"Seleccionado:"})," ",i.find(c=>c.type===n.type)?.title,a.jsx("br",{}),a.jsx("small",{children:i.find(c=>c.type===n.type)?.description})]})]})})]})})},XL=({formData:n,updateFormData:e,systemData:t,setError:i})=>{const[o,c]=G.useState(!1),[d,f]=G.useState(null),{products:p}=t;G.useEffect(()=>{if(n.fuelType&&p.length>0){const y=p.find(N=>N.name===n.fuelType||N.displayName===n.fuelType);f(y),y&&y.defaultPrice&&!n.unitPrice&&e("unitPrice",y.defaultPrice.toString())}},[n.fuelType,n.unitPrice,p,e]);const g=async(y,N)=>{c(!0),i("");try{await new Promise(j=>setTimeout(j,800)),e("fuelType",y),f(N),N.defaultPrice&&e("unitPrice",N.defaultPrice.toString()),console.log("🔄 Combustible seleccionado:",y,"Precio:",N.defaultPrice)}catch(j){console.error("Error al cargar combustible:",j),i("Error al cargar información del combustible")}finally{c(!1)}};return p.length===0?a.jsx("div",{className:"wizard-step step-fuel-type",children:a.jsx("div",{className:"step-content",children:a.jsxs("div",{className:"loading-state",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"🔄 Cargando productos disponibles..."})]})})}):a.jsx("div",{className:"wizard-step step-fuel-type",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:"⛽ ¿Qué combustible vas a mover?"}),a.jsx("p",{children:"Selecciona el producto del inventario:"})]}),o&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"📡 Solicitando precios actualizados..."})]}),a.jsx("div",{className:"fuel-options",children:p.map(y=>a.jsxs("div",{className:`fuel-option ${n.fuelType===y.name?"selected":""} ${o?"disabled":""}`,onClick:()=>!o&&g(y.name,y),children:[a.jsx("div",{className:"fuel-icon",children:y.icon||"🛢️"}),a.jsxs("div",{className:"fuel-content",children:[a.jsx("h4",{children:y.displayName||y.name}),a.jsx("p",{className:"fuel-description",children:y.description||"Combustible"}),y.defaultPrice&&a.jsxs("div",{className:"fuel-price",children:[a.jsx("span",{className:"price-label",children:"Precio actual:"}),a.jsxs("span",{className:"price-value",children:["$",y.defaultPrice.toLocaleString("es-CO")," COP/gal"]})]}),y.category&&a.jsx("small",{className:"fuel-category",children:y.category})]}),a.jsx("div",{className:"fuel-selector",children:n.fuelType===y.name&&a.jsx("span",{className:"check-icon",children:"✅"})})]},y.id))}),d&&n.fuelType&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card fuel-confirmation",children:[a.jsxs("div",{className:"confirmation-header",children:[a.jsx("span",{className:"confirmation-icon",children:d.icon||"🛢️"}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:d.displayName||d.name}),a.jsx("br",{}),a.jsx("small",{children:d.description||"Combustible seleccionado"})]})]}),d.defaultPrice&&a.jsxs("div",{className:"price-confirmation",children:[a.jsxs("div",{className:"price-info",children:[a.jsx("span",{className:"price-label",children:"💰 Precio por galón:"}),a.jsxs("span",{className:"price-amount",children:["$",d.defaultPrice.toLocaleString("es-CO")," COP"]})]}),a.jsx("small",{className:"price-note",children:"✨ Precio aplicado automáticamente (puedes modificarlo más adelante)"})]})]})})]})})},WL=({formData:n,updateFormData:e,systemData:t,setError:i})=>{const[o,c]=G.useState(!1),[d,f]=G.useState({}),[p,g]=G.useState(!1),{suppliers:y,inventory:N}=t,j=n.type===he.ENTRADA;G.useEffect(()=>{(async()=>{if(!j&&n.fuelType&&N.length>0){g(!0),await new Promise(E=>setTimeout(E,600));const A={};Pr.forEach(E=>{const D=N.filter(F=>F.fuelType===n.fuelType&&F.location?.toLowerCase()===E.toLowerCase()&&F.status==="active").reduce((F,$)=>F+(parseFloat($.currentStock)||0),0),q=N.filter(F=>F.fuelType===n.fuelType&&F.location?.toLowerCase()===E.toLowerCase()&&F.status==="active").reduce((F,$)=>F+(parseFloat($.maxCapacity)||0),0);let U="available",P=`${D.toFixed(1)} gal disponibles`;D===0?(U="empty",P="Sin stock disponible"):D<q*.2&&(U="low",P=`${D.toFixed(1)} gal (stock bajo)`),A[E]={available:D,maxCapacity:q,status:U,message:P,percentage:q>0?D/q*100:0}}),f(A),g(!1),console.log("🔍 Stock validado por ubicación:",A)}})()},[n.fuelType,j,N]);const w=async b=>{c(!0),i("");try{await new Promise(A=>setTimeout(A,400)),e("location",b),console.log("📍 Ubicación seleccionada:",b)}catch(A){console.error("Error al validar ubicación:",A),i("Error al validar la ubicación")}finally{c(!1)}};if(j){const b=y.filter(A=>A.status==="active");return a.jsx("div",{className:"wizard-step step-location",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:"🏪 ¿De qué proveedor viene el combustible?"}),a.jsx("p",{children:"Selecciona el proveedor de origen:"})]}),o&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"🔄 Validando proveedor..."})]}),a.jsx("div",{className:"supplier-options",children:b.map(A=>a.jsxs("div",{className:`supplier-option ${n.location===A.name?"selected":""} ${o?"disabled":""}`,onClick:()=>!o&&w(A.name),children:[a.jsx("div",{className:"supplier-icon",children:"🏪"}),a.jsxs("div",{className:"supplier-content",children:[a.jsx("h4",{children:A.name}),a.jsx("p",{className:"supplier-location",children:A.city}),A.phone&&a.jsxs("small",{className:"supplier-contact",children:["📞 ",A.phone]})]}),a.jsx("div",{className:"supplier-selector",children:n.location===A.name&&a.jsx("span",{className:"check-icon",children:"✅"})})]},A.id))}),n.location&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card",children:[a.jsx("span",{className:"confirmation-icon",children:"🏪"}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:"Proveedor:"})," ",n.location,a.jsx("br",{}),a.jsx("small",{children:"Origen del combustible confirmado"})]})]})})]})})}return a.jsx("div",{className:"wizard-step step-location",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:"📍 ¿De qué ubicación sale el combustible?"}),a.jsx("p",{children:"Selecciona la ubicación de origen:"})]}),p&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"🔍 Verificando stock disponible..."})]}),a.jsx("div",{className:"location-options",children:Pr.map(b=>{const A=d[b],E=!A||A.status!=="empty";return a.jsxs("div",{className:`location-option ${n.location===b?"selected":""} 
                           ${A?.status||"unknown"} ${!E||o?"disabled":""}`,onClick:()=>E&&!o&&w(b),children:[a.jsx("div",{className:"location-icon",children:"📍"}),a.jsxs("div",{className:"location-content",children:[a.jsx("h4",{children:Gs(b)}),A&&a.jsxs("div",{className:"stock-info",children:[a.jsx("p",{className:"stock-message",children:A.message}),A.available>0&&a.jsx("div",{className:"stock-bar-mini",children:a.jsx("div",{className:"stock-fill-mini",style:{width:`${Math.min(100,A.percentage)}%`}})})]}),p&&a.jsx("small",{className:"validating-text",children:"🔄 Verificando..."})]}),a.jsxs("div",{className:"location-selector",children:[A?.status==="empty"&&a.jsx("span",{className:"warning-icon",children:"🚫"}),A?.status==="low"&&a.jsx("span",{className:"warning-icon",children:"⚠️"}),A?.status==="available"&&a.jsx("span",{className:"success-icon",children:"✅"}),n.location===b&&a.jsx("span",{className:"check-icon",children:"✅"})]})]},b)})}),n.location&&d[n.location]&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card location-confirmation",children:[a.jsxs("div",{className:"confirmation-header",children:[a.jsx("span",{className:"confirmation-icon",children:"📍"}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:Gs(n.location)}),a.jsx("br",{}),a.jsx("small",{children:"Ubicación de origen confirmada"})]})]}),a.jsxs("div",{className:"stock-confirmation",children:[a.jsxs("div",{className:"stock-detail",children:[a.jsx("span",{className:"stock-label",children:"📊 Stock disponible:"}),a.jsxs("span",{className:"stock-value",children:[d[n.location].available.toFixed(1)," gal"]})]}),a.jsx("div",{className:"capacity-bar",children:a.jsx("div",{className:"capacity-fill",style:{width:`${d[n.location].percentage}%`}})}),a.jsxs("small",{className:"capacity-text",children:[d[n.location].percentage.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},ZL=({formData:n,updateFormData:e,systemData:t,setError:i})=>{const[o,c]=G.useState(!1),[d,f]=G.useState(null),[p,g]=G.useState(""),{inventory:y}=t,N=n.type===he.SALIDA||n.type===he.TRANSFERENCIA;G.useEffect(()=>{(async()=>{if(N&&n.fuelType&&n.location&&y.length>0){c(!0),await new Promise(S=>setTimeout(S,500));const A=y.filter(S=>S.fuelType===n.fuelType&&S.location?.toLowerCase()===n.location?.toLowerCase()&&S.status==="active").reduce((S,k)=>S+(parseFloat(k.currentStock)||0),0),E=y.filter(S=>S.fuelType===n.fuelType&&S.location?.toLowerCase()===n.location?.toLowerCase()&&S.status==="active").reduce((S,k)=>S+(parseFloat(k.maxCapacity)||0),0),D=parseFloat(n.quantity)||0,q=A-D,U=E>0?A/E*100:0;let P="available",F="✅",$="Stock Suficiente",L="Hay suficiente combustible disponible.";if(D>0&&(A<D?(P="critical",F="🚫",$="Stock Insuficiente",L=`Faltan ${(D-A).toFixed(2)} galones.`):q<A*.2?(P="warning",F="⚠️",$="Stock Quedará Bajo",L=`Después del movimiento quedarán ${q.toFixed(2)} galones.`):L=`Después del movimiento quedarán ${q.toFixed(2)} galones disponibles.`),f({available:A,required:D,remaining:Math.max(0,q),maxCapacity:E,capacityPercentage:U,status:P,icon:F,title:$,message:L,isValid:A>=D}),D>0){const S={type:n.type===he.SALIDA?"outbound":"transfer",fuelType:n.fuelType,quantity:n.quantity,sourceLocation:n.location},k=fL(S,y);k.isValid?k.warning?g(`⚠️ ${k.warning}`):g(""):g(`🚫 ${k.error}`)}c(!1)}})()},[n.quantity,n.fuelType,n.location,n.type,N,y]);const j=b=>{const A=parseFloat(b);(b===""||!isNaN(A)&&A>=0)&&(e("quantity",b),i(""))},w=()=>{if(!d||!d.available)return[];const b=d.available;return[{label:"25%",value:(b*.25).toFixed(1)},{label:"50%",value:(b*.5).toFixed(1)},{label:"75%",value:(b*.75).toFixed(1)},{label:"Todo",value:b.toFixed(1)}]};return a.jsx("div",{className:"wizard-step step-quantity",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:"📊 ¿Cuántos galones necesitas?"}),a.jsx("p",{children:"Especifica la cantidad de combustible:"})]}),a.jsxs("div",{className:"quantity-input-section",children:[a.jsxs("div",{className:"quantity-input-wrapper",children:[a.jsx("label",{htmlFor:"quantity",children:"Cantidad (galones)"}),a.jsxs("div",{className:"quantity-input-container",children:[a.jsx("input",{id:"quantity",type:"number",step:"0.1",min:"0",value:n.quantity,onChange:b=>j(b.target.value),placeholder:"0.0",className:`quantity-input ${p?"error":""}`}),a.jsx("span",{className:"quantity-unit",children:"gal"})]})]}),d&&d.available>0&&a.jsxs("div",{className:"quantity-suggestions",children:[a.jsx("label",{children:"Cantidades sugeridas:"}),a.jsx("div",{className:"suggestion-buttons",children:w().map((b,A)=>a.jsxs("button",{type:"button",className:"suggestion-btn",onClick:()=>j(b.value),children:[b.label,a.jsx("br",{}),a.jsxs("small",{children:[b.value," gal"]})]},A))})]})]}),o&&a.jsxs("div",{className:"calculating-indicator",children:[a.jsx("div",{className:"loading-spinner small"}),a.jsx("span",{children:"⚙️ Calculando disponibilidad..."})]}),d&&N&&!o&&a.jsxs("div",{className:`stock-info-container ${d.status}`,children:[a.jsxs("div",{className:"stock-info-header",children:[a.jsx("div",{className:"stock-info-icon",children:d.icon}),a.jsx("h4",{className:"stock-info-title",children:d.title})]}),a.jsxs("div",{className:"stock-info-details",children:[a.jsxs("div",{className:"stock-detail-item",children:[a.jsx("span",{className:"stock-detail-label",children:"Stock Disponible"}),a.jsxs("span",{className:"stock-detail-value",children:[d.available.toFixed(2)," gal"]})]}),d.required>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"stock-detail-item",children:[a.jsx("span",{className:"stock-detail-label",children:"Cantidad Solicitada"}),a.jsxs("span",{className:"stock-detail-value",children:[d.required.toFixed(2)," gal"]})]}),a.jsxs("div",{className:"stock-detail-item",children:[a.jsx("span",{className:"stock-detail-label",children:"Stock Restante"}),a.jsxs("span",{className:"stock-detail-value",children:[d.remaining.toFixed(2)," gal"]})]})]})]}),d.maxCapacity>0&&a.jsxs("div",{className:"stock-bar-container",children:[a.jsxs("div",{className:"stock-bar",children:[a.jsx("div",{className:"stock-bar-current",style:{width:`${Math.min(100,d.capacityPercentage)}%`}}),d.required>0&&d.isValid&&a.jsx("div",{className:"stock-bar-after",style:{width:`${Math.min(100,d.remaining/d.maxCapacity*100)}%`}})]}),a.jsxs("div",{className:"stock-bar-labels",children:[a.jsxs("span",{children:["Actual: ",d.capacityPercentage.toFixed(1),"%"]}),d.required>0&&d.isValid&&a.jsxs("span",{children:["Después: ",(d.remaining/d.maxCapacity*100).toFixed(1),"%"]})]})]}),a.jsx("div",{className:"stock-info-message",children:d.message})]}),p&&a.jsx("div",{className:"validation-warning",children:p}),!N&&n.quantity&&parseFloat(n.quantity)>0&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card",children:[a.jsx("span",{className:"confirmation-icon",children:"📊"}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:"Cantidad:"})," ",parseFloat(n.quantity).toFixed(2)," galones",a.jsx("br",{}),a.jsxs("small",{children:["Se añadirá al inventario de ",n.location]})]})]})})]})})},JL=({formData:n,updateFormData:e,systemData:t,setError:i})=>{const[o,c]=G.useState(!1),[d,f]=G.useState(null),[p,g]=G.useState(!1),[y,N]=G.useState(""),{vehicles:j}=t;G.useEffect(()=>{if(n.vehicleId&&j.length>0){const E=j.find(q=>q.vehicleId===n.vehicleId);f(E);const D=w(E);g(D)}},[n.vehicleId,j]);const w=E=>{if(!E)return!1;const D=E.vehicleId?.toUpperCase(),q=D&&(D.includes("TR1")||D.includes("TR2")||D.includes("TR3")||D==="TR1"||D==="TR2"||D==="TR3"),U=E.category==="tractor"||E.type?.toLowerCase().includes("tractor");return q||U},b=async E=>{c(!0),i("");try{await new Promise(q=>setTimeout(q,600)),e("vehicleId",E.vehicleId),f(E);const D=w(E);g(D),!D&&n.currentHours&&e("currentHours",""),console.log("🚜 Vehículo seleccionado:",E.vehicleId,"Es tractor:",D)}catch(D){console.error("Error al validar vehículo:",D),i("Error al validar el vehículo")}finally{c(!1)}},A=E=>{const D=parseFloat(E);(E===""||!isNaN(D)&&D>=0)&&(e("currentHours",E),d?.currentHours&&D<parseFloat(d.currentHours)?N(`La lectura debe ser mayor a la anterior: ${d.currentHours} hrs`):N(""))};return n.type!==he.SALIDA?null:j.length===0?a.jsx("div",{className:"wizard-step step-vehicle",children:a.jsx("div",{className:"step-content",children:a.jsxs("div",{className:"loading-state",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"🔄 Cargando vehículos disponibles..."})]})})}):a.jsx("div",{className:"wizard-step step-vehicle",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:"🚜 ¿A qué vehículo/equipo va el combustible?"}),a.jsx("p",{children:"Selecciona el vehículo que recibirá el combustible:"})]}),o&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"🔄 Validando vehículo..."})]}),a.jsx("div",{className:"vehicle-options",children:j.map(E=>{const D=w(E);return a.jsxs("div",{className:`vehicle-option ${n.vehicleId===E.vehicleId?"selected":""} 
                           ${D?"tractor":""} ${o?"disabled":""}`,onClick:()=>!o&&b(E),children:[a.jsx("div",{className:"vehicle-icon",children:D?"🚜":"🚚"}),a.jsxs("div",{className:"vehicle-content",children:[a.jsxs("h4",{children:[E.vehicleId," - ",E.name]}),a.jsx("p",{className:"vehicle-type",children:E.type}),E.currentHours&&D&&a.jsxs("small",{className:"vehicle-hours",children:["⏱️ Horómetro: ",E.currentHours," hrs"]}),E.status&&a.jsx("span",{className:`vehicle-status ${E.status}`,children:E.status==="active"?"✅ Activo":"⚠️ "+E.status})]}),a.jsxs("div",{className:"vehicle-selector",children:[D&&a.jsx("span",{className:"tractor-badge",children:"TRACTOR"}),n.vehicleId===E.vehicleId&&a.jsx("span",{className:"check-icon",children:"✅"})]})]},E.id)})}),p&&d&&a.jsxs("div",{className:"hour-meter-section",children:[a.jsxs("div",{className:"hour-meter-header",children:[a.jsx("h4",{children:"⏱️ Lectura del Horómetro"}),a.jsx("p",{children:"Los tractores requieren registro de horómetro:"})]}),a.jsxs("div",{className:"hour-meter-input-wrapper",children:[a.jsx("label",{htmlFor:"currentHours",children:"Horas actuales *"}),a.jsxs("div",{className:"hour-meter-input-container",children:[a.jsx("input",{id:"currentHours",type:"number",step:"0.1",min:"0",value:n.currentHours,onChange:E=>A(E.target.value),placeholder:"0.0",className:`hour-meter-input ${y?"error":""}`}),a.jsx("span",{className:"hour-meter-unit",children:"hrs"})]}),d.currentHours&&a.jsxs("small",{className:"hour-meter-hint",children:["💡 Última lectura: ",d.currentHours," horas"]}),y&&a.jsx("div",{className:"field-error",children:y})]})]}),d&&n.vehicleId&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card vehicle-confirmation",children:[a.jsxs("div",{className:"confirmation-header",children:[a.jsx("span",{className:"confirmation-icon",children:w(d)?"🚜":"🚚"}),a.jsxs("div",{className:"confirmation-text",children:[a.jsxs("strong",{children:[d.vehicleId," - ",d.name]}),a.jsx("br",{}),a.jsx("small",{children:d.type})]})]}),a.jsxs("div",{className:"vehicle-details",children:[a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"📋 Tipo:"}),a.jsx("span",{className:"detail-value",children:d.type})]}),d.category&&a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"🏷️ Categoría:"}),a.jsx("span",{className:"detail-value",children:d.category})]}),p&&n.currentHours&&a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"⏱️ Horómetro:"}),a.jsxs("span",{className:"detail-value",children:[n.currentHours," hrs"]})]})]}),w(d)&&!n.currentHours&&a.jsx("div",{className:"warning-message",children:"⚠️ Se requiere lectura del horómetro para tractores"})]})})]})})},eV=({formData:n,updateFormData:e,systemData:t,setError:i})=>{const[o,c]=G.useState(!1),[d,f]=G.useState({}),[p,g]=G.useState(!1),{inventory:y}=t;G.useEffect(()=>{(async()=>{if(n.fuelType&&n.quantity&&y.length>0){g(!0),await new Promise(E=>setTimeout(E,700));const b=parseFloat(n.quantity)||0,A={};Pr.filter(E=>E!==n.location).forEach(E=>{const D=y.filter(k=>k.fuelType===n.fuelType&&k.location?.toLowerCase()===E.toLowerCase()&&k.status==="active").reduce((k,O)=>k+(parseFloat(O.currentStock)||0),0),q=y.filter(k=>k.fuelType===n.fuelType&&k.location?.toLowerCase()===E.toLowerCase()&&k.status==="active").reduce((k,O)=>k+(parseFloat(O.maxCapacity)||0),0),U=q-D,P=D+b,F=q>0?P/q*100:0;let $="available",L=`Capacidad: ${U.toFixed(1)} gal libres`,S=U>=b;q===0?($="no_capacity",L="Sin tanques configurados",S=!1):U<b?($="insufficient",L=`Insuficiente: faltan ${(b-U).toFixed(1)} gal`,S=!1):F>90&&($="warning",L=`Quedará al ${F.toFixed(1)}% (casi lleno)`),A[E]={currentStock:D,maxCapacity:q,availableCapacity:U,afterTransfer:P,occupancyAfter:F,status:$,message:L,canAcceptTransfer:S}}),f(A),g(!1),console.log("🔍 Capacidad validada por destino:",A)}})()},[n.fuelType,n.quantity,n.location,y]);const N=async w=>{if(!d[w]?.canAcceptTransfer){i("Esta ubicación no puede recibir la cantidad solicitada");return}c(!0),i("");try{await new Promise(A=>setTimeout(A,500)),e("destinationLocation",w),console.log("🎯 Destino seleccionado:",w)}catch(A){console.error("Error al validar destino:",A),i("Error al validar el destino")}finally{c(!1)}};if(n.type!==he.TRANSFERENCIA)return null;const j=Pr.filter(w=>w!==n.location);return a.jsx("div",{className:"wizard-step step-destination",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:"🎯 ¿Hacia qué ubicación se transfiere?"}),a.jsx("p",{children:"Selecciona la ubicación de destino:"})]}),p&&a.jsxs("div",{className:"loading-overlay",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"🔍 Verificando capacidad disponible..."})]}),a.jsx("div",{className:"destination-options",children:j.map(w=>{const b=d[w],A=!b||b.canAcceptTransfer;return a.jsxs("div",{className:`destination-option ${n.destinationLocation===w?"selected":""} 
                           ${b?.status||"unknown"} ${!A||o?"disabled":""}`,onClick:()=>A&&!o&&N(w),children:[a.jsx("div",{className:"destination-icon",children:"🎯"}),a.jsxs("div",{className:"destination-content",children:[a.jsx("h4",{children:Gs(w)}),b&&a.jsxs("div",{className:"capacity-info",children:[a.jsx("p",{className:"capacity-message",children:b.message}),b.maxCapacity>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"capacity-bar-mini",children:[a.jsx("div",{className:"capacity-current-mini",style:{width:`${Math.min(100,b.currentStock/b.maxCapacity*100)}%`}}),b.canAcceptTransfer&&a.jsx("div",{className:"capacity-after-mini",style:{width:`${Math.min(100,b.occupancyAfter)}%`,left:`${Math.min(100,b.currentStock/b.maxCapacity*100)}%`}})]}),a.jsxs("small",{className:"capacity-details",children:["Actual: ",b.currentStock.toFixed(1),"/",b.maxCapacity.toFixed(1)," gal"]})]})]}),p&&a.jsx("small",{className:"validating-text",children:"🔄 Verificando capacidad..."})]}),a.jsxs("div",{className:"destination-selector",children:[b?.status==="insufficient"&&a.jsx("span",{className:"warning-icon",children:"🚫"}),b?.status==="no_capacity"&&a.jsx("span",{className:"warning-icon",children:"❌"}),b?.status==="warning"&&a.jsx("span",{className:"warning-icon",children:"⚠️"}),b?.status==="available"&&a.jsx("span",{className:"success-icon",children:"✅"}),n.destinationLocation===w&&a.jsx("span",{className:"check-icon",children:"✅"})]})]},w)})}),n.location&&n.quantity&&a.jsx("div",{className:"transfer-summary",children:a.jsxs("div",{className:"transfer-flow",children:[a.jsxs("div",{className:"transfer-origin",children:[a.jsx("span",{className:"transfer-icon",children:"📍"}),a.jsxs("div",{className:"transfer-info",children:[a.jsx("strong",{children:Gs(n.location)}),a.jsx("small",{children:"Origen"})]})]}),a.jsxs("div",{className:"transfer-arrow",children:[a.jsx("span",{children:"→"}),a.jsxs("small",{children:[parseFloat(n.quantity).toFixed(1)," gal"]})]}),a.jsxs("div",{className:"transfer-destination",children:[a.jsx("span",{className:"transfer-icon",children:"🎯"}),a.jsxs("div",{className:"transfer-info",children:[a.jsx("strong",{children:n.destinationLocation?Gs(n.destinationLocation):"Seleccionar destino"}),a.jsx("small",{children:"Destino"})]})]})]})}),n.destinationLocation&&d[n.destinationLocation]&&a.jsx("div",{className:"selection-confirmation",children:a.jsxs("div",{className:"confirmation-card destination-confirmation",children:[a.jsxs("div",{className:"confirmation-header",children:[a.jsx("span",{className:"confirmation-icon",children:"🎯"}),a.jsxs("div",{className:"confirmation-text",children:[a.jsx("strong",{children:Gs(n.destinationLocation)}),a.jsx("br",{}),a.jsx("small",{children:"Ubicación de destino confirmada"})]})]}),a.jsxs("div",{className:"capacity-confirmation",children:[a.jsxs("div",{className:"capacity-detail",children:[a.jsx("span",{className:"capacity-label",children:"📊 Después de transferir:"}),a.jsxs("span",{className:"capacity-value",children:[d[n.destinationLocation].afterTransfer.toFixed(1)," gal"]})]}),a.jsx("div",{className:"occupancy-bar",children:a.jsx("div",{className:"occupancy-fill",style:{width:`${d[n.destinationLocation].occupancyAfter}%`}})}),a.jsxs("small",{className:"occupancy-text",children:[d[n.destinationLocation].occupancyAfter.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},tV=({formData:n,updateFormData:e,systemData:t,error:i,setError:o})=>{const[c,d]=G.useState(!1),[f,p]=G.useState(!1),{products:g}=t;G.useEffect(()=>{if(n.fuelType&&!n.unitPrice&&g.length>0){const D=g.find(q=>q.name===n.fuelType||q.displayName===n.fuelType);D&&D.defaultPrice&&(e("unitPrice",D.defaultPrice.toString()),p(!0))}},[n.fuelType,n.unitPrice,g,e]);const y=async D=>{const q=parseFloat(D);(D===""||!isNaN(q)&&q>=0)&&(d(!0),await new Promise(U=>setTimeout(U,300)),e("unitPrice",D),p(D!==""),o(""),d(!1))},N=D=>{e("effectiveDate",D)},j=D=>{e("reference",D)},w=D=>{e("description",D)},b=(parseFloat(n.quantity)||0)*(parseFloat(n.unitPrice)||0),A=D=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(D),E=()=>g.find(D=>D.name===n.fuelType||D.displayName===n.fuelType);return a.jsx("div",{className:"wizard-step step-details",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:"📋 Información adicional del movimiento"}),a.jsx("p",{children:"Completa los detalles restantes:"})]}),a.jsxs("div",{className:"detail-section",children:[a.jsx("div",{className:"detail-header",children:a.jsx("h4",{children:"💰 Precio Unitario"})}),a.jsxs("div",{className:"price-input-wrapper",children:[a.jsx("label",{htmlFor:"unitPrice",children:"Precio por galón (COP) *"}),a.jsxs("div",{className:"price-input-container",children:[a.jsx("span",{className:"currency-symbol",children:"$"}),a.jsx("input",{id:"unitPrice",type:"number",step:"1",min:"0",value:n.unitPrice,onChange:D=>y(D.target.value),placeholder:"0",className:`price-input ${i?"error":""}`}),a.jsx("span",{className:"currency-unit",children:"COP"})]}),c&&a.jsxs("div",{className:"calculating-price",children:[a.jsx("div",{className:"loading-spinner small"}),a.jsx("span",{children:"💰 Validando precio..."})]}),E()?.defaultPrice&&a.jsxs("small",{className:"price-suggestion",children:["💡 Precio sugerido: $",E().defaultPrice.toLocaleString("es-CO")," COP"]})]})]}),n.quantity&&n.unitPrice&&f&&a.jsx("div",{className:"total-value-section",children:a.jsxs("div",{className:"total-value-card",children:[a.jsx("div",{className:"total-icon",children:"📊"}),a.jsxs("div",{className:"total-content",children:[a.jsx("h4",{children:"Valor Total Calculado"}),a.jsxs("div",{className:"total-calculation",children:[a.jsxs("span",{className:"calculation-details",children:[parseFloat(n.quantity).toFixed(2)," gal × $",parseFloat(n.unitPrice).toLocaleString("es-CO")," COP"]}),a.jsx("div",{className:"total-amount",children:A(b)})]})]})]})}),a.jsxs("div",{className:"detail-section",children:[a.jsx("div",{className:"detail-header",children:a.jsx("h4",{children:"📅 Fecha y Hora Efectiva"})}),a.jsxs("div",{className:"date-input-wrapper",children:[a.jsx("label",{htmlFor:"effectiveDate",children:"¿Cuándo ocurrió este movimiento?"}),a.jsx("input",{id:"effectiveDate",type:"datetime-local",value:n.effectiveDate,onChange:D=>N(D.target.value),className:"date-input"}),a.jsx("small",{className:"date-hint",children:"💡 Por defecto se usa la fecha y hora actual"})]})]}),a.jsxs("div",{className:"detail-section",children:[a.jsx("div",{className:"detail-header",children:a.jsx("h4",{children:"📄 Referencia"})}),a.jsxs("div",{className:"reference-input-wrapper",children:[a.jsx("label",{htmlFor:"reference",children:"Número de factura, orden o referencia (opcional)"}),a.jsx("input",{id:"reference",type:"text",value:n.reference,onChange:D=>j(D.target.value),placeholder:"Ej: Factura #12345, Orden #ORD-001",className:"reference-input",maxLength:"100"}),a.jsx("small",{className:"reference-hint",children:"📝 Ayuda a identificar el movimiento en reportes"})]})]}),a.jsxs("div",{className:"detail-section",children:[a.jsx("div",{className:"detail-header",children:a.jsx("h4",{children:"📝 Descripción"})}),a.jsxs("div",{className:"description-input-wrapper",children:[a.jsx("label",{htmlFor:"description",children:"Detalles adicionales del movimiento (opcional)"}),a.jsx("textarea",{id:"description",value:n.description,onChange:D=>w(D.target.value),placeholder:"Ej: Combustible para operación en sector norte, mantenimiento programado, etc.",className:"description-input",rows:"3",maxLength:"500"}),a.jsxs("div",{className:"description-counter",children:[n.description.length,"/500 caracteres"]})]})]}),f&&a.jsx("div",{className:"details-summary",children:a.jsxs("div",{className:"summary-card",children:[a.jsx("h4",{children:"📋 Resumen de Detalles"}),a.jsxs("div",{className:"summary-items",children:[a.jsxs("div",{className:"summary-item",children:[a.jsx("span",{className:"summary-label",children:"💰 Precio unitario:"}),a.jsxs("span",{className:"summary-value",children:["$",parseFloat(n.unitPrice).toLocaleString("es-CO")," COP/gal"]})]}),b>0&&a.jsxs("div",{className:"summary-item",children:[a.jsx("span",{className:"summary-label",children:"📊 Valor total:"}),a.jsx("span",{className:"summary-value total",children:A(b)})]}),a.jsxs("div",{className:"summary-item",children:[a.jsx("span",{className:"summary-label",children:"📅 Fecha:"}),a.jsx("span",{className:"summary-value",children:new Date(n.effectiveDate).toLocaleString("es-CO")})]}),n.reference&&a.jsxs("div",{className:"summary-item",children:[a.jsx("span",{className:"summary-label",children:"📄 Referencia:"}),a.jsx("span",{className:"summary-value",children:n.reference})]}),n.description&&a.jsxs("div",{className:"summary-item",children:[a.jsx("span",{className:"summary-label",children:"📝 Descripción:"}),a.jsx("span",{className:"summary-value description",children:n.description.length>50?n.description.substring(0,50)+"...":n.description})]})]})]})})]})})},nV=({formData:n,systemData:e,onSubmit:t,isLoading:i,error:o,setError:c})=>{const[d,f]=G.useState(!1),{vehicles:p,products:g,suppliers:y}=e,N=$=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format($),j=()=>({[he.ENTRADA]:{icon:"📥",title:"Entrada",color:"entrada"},[he.SALIDA]:{icon:"📤",title:"Salida",color:"salida"},[he.TRANSFERENCIA]:{icon:"🔄",title:"Transferencia",color:"transferencia"},[he.AJUSTE]:{icon:"⚖️",title:"Ajuste",color:"ajuste"}})[n.type]||{icon:"❓",title:"Desconocido",color:"unknown"},w=()=>g.find($=>$.name===n.fuelType||$.displayName===n.fuelType),b=()=>p.find($=>$.vehicleId===n.vehicleId),A=()=>y.find($=>$.name===n.location),E=(parseFloat(n.quantity)||0)*(parseFloat(n.unitPrice)||0),D=j(),q=w(),U=b(),P=A(),F=()=>{if(!d){c("Debes confirmar que la información es correcta");return}t()};return a.jsx("div",{className:"wizard-step step-summary",children:a.jsxs("div",{className:"step-content",children:[a.jsxs("div",{className:"step-question",children:[a.jsx("h3",{children:"✅ Confirma tu movimiento"}),a.jsx("p",{children:"Revisa toda la información antes de crear el movimiento:"})]}),a.jsxs("div",{className:"summary-main",children:[a.jsxs("div",{className:`summary-header ${D.color}`,children:[a.jsx("div",{className:"summary-icon",children:D.icon}),a.jsxs("div",{className:"summary-title",children:[a.jsxs("h4",{children:[D.title," de Combustible"]}),a.jsxs("p",{children:[parseFloat(n.quantity).toFixed(2)," galones de ",q?.displayName||n.fuelType]})]}),a.jsx("div",{className:"summary-value",children:N(E)})]}),a.jsxs("div",{className:"summary-details",children:[a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:"⛽"}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Combustible:"}),a.jsxs("span",{className:"detail-value",children:[q?.icon," ",q?.displayName||n.fuelType]})]})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:"📊"}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Cantidad:"}),a.jsxs("span",{className:"detail-value",children:[parseFloat(n.quantity).toFixed(2)," gal × $",parseFloat(n.unitPrice).toLocaleString("es-CO")," COP"]})]})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:n.type===he.ENTRADA?"🏪":"📍"}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:n.type===he.ENTRADA?"Proveedor:":"Origen:"}),a.jsx("span",{className:"detail-value",children:n.type===he.ENTRADA?P?`${P.name} - ${P.city}`:n.location:Gs(n.location)})]})]}),n.type===he.SALIDA&&U&&a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:"🚜"}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Vehículo:"}),a.jsxs("span",{className:"detail-value",children:[U.vehicleId," - ",U.name," (",U.type,")"]})]})]}),n.currentHours&&a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:"⏱️"}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Horómetro:"}),a.jsxs("span",{className:"detail-value",children:[n.currentHours," horas"]})]})]}),n.type===he.TRANSFERENCIA&&n.destinationLocation&&a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:"🎯"}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Destino:"}),a.jsx("span",{className:"detail-value",children:Gs(n.destinationLocation)})]})]}),a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:"📅"}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Fecha:"}),a.jsx("span",{className:"detail-value",children:new Date(n.effectiveDate).toLocaleString("es-CO")})]})]}),n.reference&&a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:"📄"}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Referencia:"}),a.jsx("span",{className:"detail-value",children:n.reference})]})]}),n.description&&a.jsxs("div",{className:"detail-row",children:[a.jsx("div",{className:"detail-icon",children:"📝"}),a.jsxs("div",{className:"detail-content",children:[a.jsx("span",{className:"detail-label",children:"Descripción:"}),a.jsx("span",{className:"detail-value description",children:n.description})]})]})]})]}),n.type===he.TRANSFERENCIA&&a.jsxs("div",{className:"transfer-flow-summary",children:[a.jsx("div",{className:"flow-header",children:"🔄 Flujo de Transferencia"}),a.jsxs("div",{className:"flow-diagram",children:[a.jsxs("div",{className:"flow-location origin",children:[a.jsx("div",{className:"flow-icon",children:"📍"}),a.jsxs("div",{className:"flow-text",children:[a.jsx("strong",{children:Gs(n.location)}),a.jsx("small",{children:"Origen"})]})]}),a.jsxs("div",{className:"flow-arrow",children:[a.jsx("div",{className:"arrow-line"}),a.jsx("div",{className:"arrow-head",children:"→"}),a.jsxs("div",{className:"flow-quantity",children:[parseFloat(n.quantity).toFixed(1)," gal"]})]}),a.jsxs("div",{className:"flow-location destination",children:[a.jsx("div",{className:"flow-icon",children:"🎯"}),a.jsxs("div",{className:"flow-text",children:[a.jsx("strong",{children:Gs(n.destinationLocation)}),a.jsx("small",{children:"Destino"})]})]})]})]}),a.jsxs("div",{className:"confirmation-section",children:[a.jsxs("div",{className:"confirmation-checkbox",children:[a.jsx("input",{type:"checkbox",id:"confirmMovement",checked:d,onChange:$=>f($.target.checked)}),a.jsx("label",{htmlFor:"confirmMovement",children:"✅ Confirmo que toda la información es correcta y autorizo crear este movimiento"})]}),a.jsx("div",{className:"confirmation-warning",children:"⚠️ Una vez creado, el movimiento actualizará automáticamente el inventario"})]}),o&&a.jsxs("div",{className:"summary-error",children:[a.jsx("span",{className:"error-icon",children:"⚠️"}),o]}),a.jsxs("div",{className:"final-actions",children:[a.jsx("button",{type:"button",className:`btn-final-confirm ${!d||i?"disabled":""}`,onClick:F,disabled:!d||i,children:i?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"loading-spinner small"}),"💾 Creando movimiento..."]}):a.jsx(a.Fragment,{children:"🚀 Crear Movimiento"})}),a.jsx("small",{className:"final-note",children:"El movimiento se guardará inmediatamente y actualizará el inventario"})]})]})})},sV=({isOpen:n,onClose:e,onSuccess:t})=>{const[i,o]=G.useState(1),[c,d]=G.useState(!1),[f,p]=G.useState(""),[g,y]=G.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""}),[N,j]=G.useState({vehicles:[],inventory:[],suppliers:[],products:[],loadingData:!0}),w={1:{title:"Tipo de Movimiento",description:"¿Qué operación realizarás?"},2:{title:"Combustible",description:"¿Qué producto vas a mover?"},3:{title:"Ubicación Origen",description:"¿De dónde proviene?"},4:{title:"Cantidad",description:"¿Cuánto necesitas?"},5:{title:"Vehículo/Equipo",description:"¿A qué destino?"},6:{title:"Ubicación Destino",description:"¿Hacia dónde va?"},7:{title:"Detalles",description:"Información adicional"},8:{title:"Confirmación",description:"Revisa y confirma"}};G.useEffect(()=>((async()=>{if(n){document.body.style.overflow="hidden",j(S=>({...S,loadingData:!0}));try{console.log("🔄 Cargando datos del sistema para wizard...");const[S,k,O,C]=await Promise.all([ey(),SA(),FA(),YL()]);j({vehicles:S||[],inventory:k.success?k.data:[],suppliers:O.success?O.data:[],products:C||[],loadingData:!1}),console.log("✅ Datos cargados para wizard")}catch(S){console.error("❌ Error al cargar datos del sistema:",S),j(k=>({...k,loadingData:!1}))}}else document.body.style.overflow="unset"})(),()=>{document.body.style.overflow="unset"}),[n]);const b=()=>!g.type||g.type===he.TRANSFERENCIA?8:g.type===he.SALIDA?7:6,A=(L,S)=>{y(k=>({...k,[L]:S})),p("")},E=()=>{switch(i){case 1:return!!g.type;case 2:return!!g.fuelType;case 3:return g.type===he.ENTRADA,!!g.location;case 4:return g.quantity&&parseFloat(g.quantity)>0;case 5:return g.type===he.SALIDA?!!g.vehicleId:!0;case 6:return g.type===he.TRANSFERENCIA?!!g.destinationLocation:!0;case 7:return!!g.unitPrice&&parseFloat(g.unitPrice)>=0;case 8:return!0;default:return!1}},D=()=>{if(E()){const L=b();let S=i+1;i===4&&g.type!==he.SALIDA&&(S=g.type===he.TRANSFERENCIA?6:7),i===5&&g.type!==he.TRANSFERENCIA&&(S=7),S<=L&&o(S)}else p("Por favor completa este paso antes de continuar")},q=()=>{if(i>1){let L=i-1;i===7&&g.type!==he.TRANSFERENCIA&&g.type!==he.SALIDA&&(L=4),i===6&&g.type!==he.SALIDA&&(L=4),o(L)}},U=async()=>{d(!0),p("");try{const L={...g,quantity:parseFloat(g.quantity),unitPrice:parseFloat(g.unitPrice),effectiveDate:new Date(g.effectiveDate)};await _A(L),t(),o(1),y({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""})}catch(L){console.error("Error al crear movimiento:",L),p(L.message||"Error al crear el movimiento")}finally{d(!1)}},P=()=>{const L={formData:g,updateFormData:A,systemData:N,error:f,setError:p};switch(i){case 1:return a.jsx(KL,{...L});case 2:return a.jsx(XL,{...L});case 3:return a.jsx(WL,{...L});case 4:return a.jsx(ZL,{...L});case 5:return a.jsx(JL,{...L});case 6:return a.jsx(eV,{...L});case 7:return a.jsx(tV,{...L});case 8:return a.jsx(nV,{...L,onSubmit:U,isLoading:c});default:return a.jsx("div",{children:"Paso no encontrado"})}};if(!n)return null;const F=b(),$=i/F*100;return a.jsx("div",{className:"modal-overlay wizard-overlay",onClick:e,children:a.jsxs("div",{className:"modal-content wizard-modal",onClick:L=>L.stopPropagation(),children:[a.jsxs("div",{className:"wizard-header",children:[a.jsxs("div",{className:"wizard-title",children:[a.jsx("h3",{children:"🧙‍♂️ Asistente de Movimientos"}),a.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),a.jsxs("div",{className:"wizard-progress",children:[a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill",style:{width:`${$}%`}})}),a.jsxs("div",{className:"progress-text",children:["Paso ",i," de ",F]})]}),a.jsxs("div",{className:"step-info",children:[a.jsx("h4",{children:w[i]?.title}),a.jsx("p",{children:w[i]?.description})]})]}),a.jsx("div",{className:"wizard-body",children:N.loadingData?a.jsxs("div",{className:"wizard-loading",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"🔄 Cargando datos del sistema..."})]}):P()}),f&&a.jsxs("div",{className:"wizard-error",children:[a.jsx("span",{className:"error-icon",children:"⚠️"}),f]}),a.jsx("div",{className:"wizard-footer",children:a.jsxs("div",{className:"wizard-navigation",children:[a.jsx("button",{className:"btn-wizard btn-previous",onClick:q,disabled:i===1,children:"← Anterior"}),i<F?a.jsx("button",{className:"btn-wizard btn-next",onClick:D,disabled:!E(),children:"Siguiente →"}):a.jsx("button",{className:"btn-wizard btn-finish",onClick:U,disabled:c||!E(),children:c?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"loading-spinner small"}),"Creando..."]}):"✅ Confirmar Movimiento"})]})})]})})},aV=()=>{const{user:n,userProfile:e,deleteMovement:t}=js(),[i,o]=G.useState([]),[c,d]=G.useState(null),[f,p]=G.useState(!0),[g,y]=G.useState(null),[N,j]=G.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[w,b]=G.useState("cards"),[A,E]=G.useState(""),[D,q]=G.useState(!1),[U,P]=G.useState(null),[F,$]=G.useState("view");G.useEffect(()=>{if(!n)return;p(!0);const te=Jv((le,Me)=>{if(Me){console.error("Error en suscripción de movimientos:",Me),y("Error al cargar movimientos"),p(!1);return}o(le),y(null),p(!1)},N);return()=>te()},[n,N]),G.useEffect(()=>{n&&(async()=>{try{const le=await AA(N);d(le)}catch(le){console.error("Error al cargar estadísticas:",le)}})()},[n,i,N]);const L=i.filter(te=>{if(!A)return!0;const le=A.toLowerCase();return te.fuelType?.toLowerCase().includes(le)||te.type?.toLowerCase().includes(le)||te.location?.toLowerCase().includes(le)||te.vehicleId?.toLowerCase().includes(le)||te.description?.toLowerCase().includes(le)||te.reference?.toLowerCase().includes(le)}),S=()=>{q(!0)},k=te=>{P(te),$("view"),alert(`📋 Detalles del movimiento:

Tipo: ${te.type}
Combustible: ${te.fuelType}
Cantidad: ${te.quantity} gal
Fecha: ${new Date(te.createdAt).toLocaleDateString("es-CO")}`)},O=()=>{q(!1)},C=te=>{j(le=>({...le,...te}))},R=()=>{j({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),E("")},V=async te=>{if(window.confirm("¿Estás seguro de que quieres aprobar este movimiento? Esta acción actualizará el inventario."))try{await jA(te),alert("Movimiento aprobado y stock actualizado.")}catch(le){console.error("Error al aprobar movimiento:",le),alert(`Error al aprobar movimiento: ${le.message}`)}},ye=async te=>{if(window.confirm("¿Estás seguro de que quieres rechazar este movimiento?"))try{await TA(te,{status:Qe.CANCELADO}),alert("Movimiento rechazado.")}catch(le){console.error("Error al rechazar movimiento:",le),alert(`Error al rechazar movimiento: ${le.message}`)}},Ie=async te=>{try{const le=await t(te);if(le.success)alert("Movimiento eliminado exitosamente.");else throw new Error(le.error)}catch(le){console.error("Error al eliminar movimiento:",le),alert(`Error al eliminar movimiento: ${le.message}`)}},Y=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente";return e?.role,f?a.jsx("div",{className:"movements-main",children:a.jsxs("div",{className:"loading-container",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando movimientos..."})]})}):g?a.jsx("div",{className:"movements-main",children:a.jsxs("div",{className:"error-container",children:[a.jsx("div",{className:"error-icon",children:"⚠️"}),a.jsx("h3",{children:"Error al cargar movimientos"}),a.jsx("p",{children:g}),a.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):a.jsxs("div",{className:"movements-main",children:[a.jsxs("div",{className:"movements-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h2",{children:"📊 Movimientos de Combustibles"}),a.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),Y&&a.jsx("div",{className:"create-movement-options",children:a.jsx("button",{className:"btn-create-movement primary",onClick:S,children:"➕ Nuevo Movimiento"})})]}),c&&a.jsx(VL,{stats:c,filters:N}),a.jsx(UL,{filters:N,onFilterChange:C,onClearFilters:R,searchTerm:A,onSearchChange:E,viewMode:w,onViewModeChange:b,totalResults:L.length}),L.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:"📋"}),a.jsx("h3",{children:i.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),a.jsx("p",{children:i.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de búsqueda"}),i.length===0&&Y&&a.jsx("div",{className:"create-first-options",children:a.jsx("button",{className:"btn-create-first primary",onClick:S,children:"➕ Crear Primer Movimiento"})})]}):a.jsx(zL,{movements:L,viewMode:w,onEdit:null,onView:k,onApprove:V,onReject:ye,onDelete:Ie,userRole:e?.role}),D&&a.jsx(sV,{isOpen:D,onClose:O,onSuccess:()=>{O()}})]})},iV=({stats:n,filters:e})=>{if(!n)return null;const t=N=>`${ke(N)} gal`,i=N=>`${ke(N)} hrs`,o=N=>`${N.toFixed(2)} gal/hr`,c=N=>{let j=0;for(let b=0;b<N.length;b++)j=(j<<5)-j+N.charCodeAt(b)&4294967295;const w=["#059669","#dc2626","#2563eb","#7c3aed","#ea580c","#16a34a","#ca8a04","#9333ea"];return w[Math.abs(j)%w.length]},d=N=>{if(!N)return"🚗";const j=N.toLowerCase();return j.includes("excavadora")?"🚚":j.includes("bulldozer")?"🚜":j.includes("cargador")?"🏗️":j.includes("camion")?"🚛":j.includes("grua")?"🏗️":j.includes("motosierra")?"🪚":j.includes("tractor")?"🚜":j.includes("volqueta")?"🚛":"🚗"},f=N=>{switch(N){case Ve.ACTIVO:return"#10b981";case Ve.MANTENIMIENTO:return"#f59e0b";case Ve.INACTIVO:return"#6b7280";case Ve.REPARACION:return"#ef4444";default:return"#6b7280"}},p=N=>{switch(N){case Ve.ACTIVO:return"✅";case Ve.MANTENIMIENTO:return"🔧";case Ve.INACTIVO:return"⏸️";case Ve.REPARACION:return"🔴";default:return"❓"}},g=N=>{switch(N){case vt.DIESEL:return"🚛";case vt.GASOLINA:return"🚗";case vt.ACPM:return"🚚";case vt.MIXTO:return"⛽";default:return"⛽"}},y=n.totalVehicles>0?((n.byStatus[Ve.ACTIVO]||0)/n.totalVehicles*100).toFixed(1):0;return a.jsxs("div",{className:"vehicles-stats",children:[a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card primary",children:[a.jsx("div",{className:"stat-icon",children:"🚜"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:ke(n.totalVehicles)}),a.jsx("div",{className:"stat-label",children:"Total Vehículos"}),a.jsx("div",{className:"stat-trend",children:a.jsxs("span",{className:`trend ${y>=80?"positive":"warning"}`,children:[y>=80?"📈":"⚠️"," ",y,"% activos"]})})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:"⛽"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:t(n.totalFuelConsumed)}),a.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),a.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(n.averageConsumption||0)]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:"⏰"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:i(n.totalHoursWorked)}),a.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),a.jsxs("div",{className:"stat-secondary",children:["Promedio: ",i(n.totalHoursWorked/(n.totalVehicles||1))]})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:"🏆"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:n.mostActiveVehicle?n.mostActiveVehicle.vehicleId:"N/A"}),a.jsx("div",{className:"stat-label",children:"Más Activo"}),a.jsx("div",{className:"stat-secondary",children:n.mostActiveVehicle?`${n.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),a.jsxs("div",{className:"stats-breakdown",children:[a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:"🚜 Por Tipo de Vehículo"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([N,j])=>{const w=(j/n.totalVehicles*100).toFixed(1);return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:d(N)}),a.jsx("span",{className:"breakdown-label",children:N.charAt(0).toUpperCase()+N.slice(1)})]}),a.jsx("div",{className:"breakdown-value",children:j}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${w}%`,backgroundColor:c(N)}})}),a.jsxs("div",{className:"breakdown-percentage",children:[w,"%"]})]},N)})})]}),a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:"⚡ Por Estado"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([N,j])=>{const w=(j/n.totalVehicles*100).toFixed(1);return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:p(N)}),a.jsx("span",{className:"breakdown-label",children:N.charAt(0).toUpperCase()+N.slice(1)})]}),a.jsx("div",{className:"breakdown-value",children:j}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${w}%`,backgroundColor:f(N)}})}),a.jsxs("div",{className:"breakdown-percentage",children:[w,"%"]})]},N)})})]}),a.jsxs("div",{className:"breakdown-section",children:[a.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([N,j])=>{const w=(j/n.totalVehicles*100).toFixed(1);return a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:g(N)}),a.jsx("span",{className:"breakdown-label",children:N})]}),a.jsx("div",{className:"breakdown-value",children:j}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${w}%`,backgroundColor:"#059669"}})}),a.jsxs("div",{className:"breakdown-percentage",children:[w,"%"]})]},N)})})]})]}),(n.totalFuelConsumed>0||n.totalHoursWorked>0)&&a.jsxs("div",{className:"performance-metrics",children:[a.jsx("h4",{children:"📊 Métricas de Rendimiento"}),a.jsxs("div",{className:"metrics-grid",children:[a.jsxs("div",{className:"metric-card",children:[a.jsx("div",{className:"metric-icon",children:"⚡"}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),a.jsxs("div",{className:"metric-value",children:[y,"%"]}),a.jsxs("div",{className:"metric-description",children:[n.byStatus[Ve.ACTIVO]||0," de ",n.totalVehicles," activos"]})]})]}),n.averageConsumption>0&&a.jsxs("div",{className:"metric-card",children:[a.jsx("div",{className:"metric-icon",children:"📈"}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),a.jsx("div",{className:"metric-value",children:o(n.averageConsumption)}),a.jsx("div",{className:"metric-description",children:"Por vehículo por hora trabajada"})]})]}),n.mostActiveVehicle&&a.jsxs("div",{className:"metric-card",children:[a.jsx("div",{className:"metric-icon",children:"🏆"}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-label",children:"Mayor Utilización"}),a.jsx("div",{className:"metric-value",children:n.mostActiveVehicle.vehicleId}),a.jsxs("div",{className:"metric-description",children:[t(n.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),n.leastActiveVehicle&&a.jsxs("div",{className:"metric-card",children:[a.jsx("div",{className:"metric-icon",children:"📉"}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-label",children:"Menor Utilización"}),a.jsx("div",{className:"metric-value",children:n.leastActiveVehicle.vehicleId}),a.jsxs("div",{className:"metric-description",children:[t(n.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(e.type||e.status||e.fuelType||e.location)&&a.jsxs("div",{className:"active-filters",children:[a.jsx("h4",{children:"🔍 Filtros Activos"}),a.jsxs("div",{className:"filters-list",children:[e.type&&a.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&a.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&a.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.location&&a.jsxs("span",{className:"filter-tag",children:["Ubicación: ",e.location]})]})]})]})},rV=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:i,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const[p,g]=G.useState(!1),y=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mecánico","Proyecto A","Proyecto B","En Reparación","Otros"],N=Object.values(n).filter(b=>b&&b!==""&&b!=="all").length,j=(b,A)=>{e({[b]:A})},w=b=>{e(b)};return a.jsxs("div",{className:"vehicles-filters",children:[a.jsxs("div",{className:"filters-main",children:[a.jsx("div",{className:"search-section",children:a.jsxs("div",{className:"search-box",children:[a.jsx("span",{className:"search-icon",children:"🔍"}),a.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicación...",value:i,onChange:b=>o(b.target.value),className:"search-input"}),i&&a.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),a.jsxs("div",{className:"filters-controls",children:[a.jsxs("div",{className:"quick-filters",children:[a.jsx("button",{className:`quick-filter ${n.status==="activo"?"active":""}`,onClick:()=>w({status:"activo"}),children:"✅ Activos"}),a.jsx("button",{className:`quick-filter ${n.status==="mantenimiento"?"active":""}`,onClick:()=>w({status:"mantenimiento"}),children:"🔧 Mantenimiento"}),a.jsx("button",{className:`quick-filter ${n.type==="excavadora"?"active":""}`,onClick:()=>w({type:"excavadora"}),children:"🚚 Excavadoras"}),a.jsx("button",{className:`quick-filter ${n.type==="tractor"?"active":""}`,onClick:()=>w({type:"tractor"}),children:"🚜 Tractores"})]}),a.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>g(!p),children:["🎛️ Filtros",N>0&&a.jsx("span",{className:"filters-count",children:N})]}),a.jsxs("div",{className:"view-modes",children:[a.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),a.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&a.jsxs("div",{className:"filters-advanced",children:[a.jsxs("div",{className:"filters-grid",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Tipo de Vehículo"}),a.jsxs("select",{value:n.type,onChange:b=>j("type",b.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los tipos"}),a.jsx("option",{value:"excavadora",children:"🚚 Excavadora"}),a.jsx("option",{value:"bulldozer",children:"🚜 Bulldozer"}),a.jsx("option",{value:"cargador",children:"🏗️ Cargador"}),a.jsx("option",{value:"camion",children:"🚛 Camión"}),a.jsx("option",{value:"grua",children:"🏗️ Grúa"}),a.jsx("option",{value:"motosierra",children:"🪚 Motosierra"}),a.jsx("option",{value:"tractor",children:"🚜 Tractor"}),a.jsx("option",{value:"volqueta",children:"🚛 Volqueta"}),a.jsx("option",{value:"otros",children:"🚗 Otros"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Estado"}),a.jsxs("select",{value:n.status,onChange:b=>j("status",b.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los estados"}),a.jsx("option",{value:Ve.ACTIVO,children:"✅ Activo"}),a.jsx("option",{value:Ve.MANTENIMIENTO,children:"🔧 Mantenimiento"}),a.jsx("option",{value:Ve.INACTIVO,children:"⏸️ Inactivo"}),a.jsx("option",{value:Ve.REPARACION,children:"🔴 Reparación"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Tipo de Combustible"}),a.jsxs("select",{value:n.fuelType,onChange:b=>j("fuelType",b.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todos los combustibles"}),a.jsx("option",{value:vt.DIESEL,children:"🚛 Diesel"}),a.jsx("option",{value:vt.GASOLINA,children:"🚗 Gasolina"}),a.jsx("option",{value:vt.ACPM,children:"🚚 ACPM"}),a.jsx("option",{value:vt.MIXTO,children:"⛽ Mixto"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Ubicación Actual"}),a.jsxs("select",{value:n.location,onChange:b=>j("location",b.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"Todas las ubicaciones"}),y.map(b=>a.jsxs("option",{value:b,children:["📍 ",b]},b))]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Mantenimiento"}),a.jsxs("select",{value:n.maintenance,onChange:b=>j("maintenance",b.target.value),className:"filter-select",children:[a.jsx("option",{value:"all",children:"Todos"}),a.jsx("option",{value:"due",children:"Mantenimiento debido"}),a.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),a.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),a.jsxs("div",{className:"filters-actions",children:[a.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:N===0,children:"🗑️ Limpiar Filtros"}),a.jsxs("div",{className:"filters-info",children:[a.jsxs("span",{className:"results-count",children:[f," resultado",f!==1?"s":""]}),N>0&&a.jsxs("span",{className:"active-filters-text",children:["(",N," filtro",N!==1?"s":""," activo",N!==1?"s":"",")"]})]})]})]}),N>0&&a.jsx("div",{className:"active-filters-summary",children:a.jsxs("div",{className:"summary-content",children:[a.jsx("span",{className:"summary-label",children:"Filtros activos:"}),a.jsxs("div",{className:"summary-tags",children:[n.type&&a.jsxs("span",{className:"summary-tag",onClick:()=>j("type",""),children:["Tipo: ",n.type," ✕"]}),n.status&&a.jsxs("span",{className:"summary-tag",onClick:()=>j("status",""),children:["Estado: ",n.status," ✕"]}),n.fuelType&&a.jsxs("span",{className:"summary-tag",onClick:()=>j("fuelType",""),children:["Combustible: ",n.fuelType," ✕"]}),n.location&&a.jsxs("span",{className:"summary-tag",onClick:()=>j("location",""),children:["Ubicación: ",n.location," ✕"]}),n.maintenance!=="all"&&a.jsxs("span",{className:"summary-tag",onClick:()=>j("maintenance","all"),children:["Mantenimiento: ",n.maintenance," ✕"]})]})]})}),a.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:a.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},oV=({vehicles:n,onEdit:e,onView:t,onMaintenance:i})=>{const o=E=>new Intl.NumberFormat("es-CO").format(E),c=E=>`${o(E)} gal`,d=E=>`${o(E)} hrs`,f=E=>E?(E instanceof Date?E:new Date(E)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",p=E=>{if(!E)return"";const D=new Date,q=E instanceof Date?E:new Date(E),U=Math.abs(D-q),P=Math.ceil(U/(1e3*60*60*24));return P===1?"hace 1 día":P<7?`hace ${P} días`:P<30?`hace ${Math.ceil(P/7)} semanas`:P<365?`hace ${Math.ceil(P/30)} meses`:`hace ${Math.ceil(P/365)} años`},g=E=>{if(!E)return"vehicle-default";const D=E.toLowerCase();return D.includes("excavadora")?"vehicle-excavadora":D.includes("bulldozer")?"vehicle-bulldozer":D.includes("cargador")?"vehicle-cargador":D.includes("camion")?"vehicle-camion":D.includes("grua")?"vehicle-grua":D.includes("motosierra")?"vehicle-motosierra":D.includes("tractor")?"vehicle-tractor":D.includes("volqueta")?"vehicle-volqueta":"vehicle-default"},y=E=>{switch(E){case Ve.ACTIVO:return"status-activo";case Ve.MANTENIMIENTO:return"status-mantenimiento";case Ve.INACTIVO:return"status-inactivo";case Ve.REPARACION:return"status-reparacion";default:return"status-default"}},N=E=>{if(!E)return"🚗";const D=E.toLowerCase();return D.includes("excavadora")?"🚚":D.includes("bulldozer")?"🚜":D.includes("cargador")?"🏗️":D.includes("camion")?"🚛":D.includes("grua")?"🏗️":D.includes("motosierra")?"🪚":D.includes("tractor")?"🚜":D.includes("volqueta")?"🚛":"🚗"},j=E=>{switch(E){case vt.DIESEL:return"🚛";case vt.GASOLINA:return"🚗";case vt.ACPM:return"🚚";case vt.MIXTO:return"⛽";default:return"⛽"}},w=E=>{switch(E){case Ve.ACTIVO:return"✅";case Ve.MANTENIMIENTO:return"🔧";case Ve.INACTIVO:return"⏸️";case Ve.REPARACION:return"🔴";default:return"❓"}},b=E=>!E.totalHoursWorked||E.totalHoursWorked===0?E.estimatedConsumptionPerHour||0:E.totalFuelConsumed/E.totalHoursWorked,A=E=>E.lastMaintenanceDate?Math.floor((new Date-new Date(E.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return a.jsx("div",{className:"vehicles-cards",children:n.map(E=>a.jsxs("div",{className:`vehicle-card ${g(E.type)}`,children:[a.jsx("div",{className:"card-header",children:a.jsxs("div",{className:"vehicle-info",children:[a.jsxs("div",{className:"vehicle-id-section",children:[a.jsx("span",{className:"vehicle-icon",children:N(E.type)}),a.jsxs("div",{className:"vehicle-details",children:[a.jsx("span",{className:"vehicle-id",children:E.vehicleId}),a.jsx("span",{className:"vehicle-name",children:E.name})]})]}),a.jsxs("div",{className:`status-badge ${y(E.status)}`,children:[a.jsx("span",{className:"status-icon",children:w(E.status)}),a.jsx("span",{className:"status-label",children:E.status.charAt(0).toUpperCase()+E.status.slice(1)})]})]})}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"basic-info",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Tipo:"}),a.jsxs("span",{className:"info-value",children:[N(E.type)," ",E.type.charAt(0).toUpperCase()+E.type.slice(1)]})]}),E.brand&&E.model&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),a.jsxs("span",{className:"info-value",children:[E.brand," ",E.model]})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Combustible:"}),a.jsxs("span",{className:"info-value",children:[j(E.fuelType)," ",E.fuelType]})]}),E.currentLocation&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Ubicación:"}),a.jsxs("span",{className:"info-value",children:["📍 ",E.currentLocation]})]})]}),a.jsxs("div",{className:"consumption-metrics",children:[a.jsxs("div",{className:"metric-item",children:[a.jsx("div",{className:"metric-icon",children:"⛽"}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-value",children:c(E.totalFuelConsumed||0)}),a.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),a.jsxs("div",{className:"metric-item",children:[a.jsx("div",{className:"metric-icon",children:"⏰"}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-value",children:d(E.totalHoursWorked||0)}),a.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),a.jsxs("div",{className:"metric-item",children:[a.jsx("div",{className:"metric-icon",children:"📊"}),a.jsxs("div",{className:"metric-content",children:[a.jsxs("div",{className:"metric-value",children:[b(E).toFixed(1)," gal/hr"]}),a.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),a.jsxs("div",{className:"metric-item",children:[a.jsx("div",{className:"metric-icon",children:"🔄"}),a.jsxs("div",{className:"metric-content",children:[a.jsx("div",{className:"metric-value",children:E.totalMovements||0}),a.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(E.enginePower||E.fuelCapacity||E.year)&&a.jsxs("div",{className:"technical-specs",children:[E.enginePower&&a.jsxs("div",{className:"spec-item",children:[a.jsx("span",{className:"spec-icon",children:"⚡"}),a.jsxs("span",{className:"spec-value",children:[E.enginePower," HP"]})]}),E.fuelCapacity&&a.jsxs("div",{className:"spec-item",children:[a.jsx("span",{className:"spec-icon",children:"🛢️"}),a.jsxs("span",{className:"spec-value",children:[E.fuelCapacity," gal"]})]}),E.year&&a.jsxs("div",{className:"spec-item",children:[a.jsx("span",{className:"spec-icon",children:"📅"}),a.jsx("span",{className:"spec-value",children:E.year})]})]}),E.description&&a.jsx("div",{className:"description",children:a.jsx("p",{children:E.description})})]}),a.jsxs("div",{className:"card-footer",children:[a.jsxs("div",{className:"date-info",children:[E.lastMovementDate&&a.jsxs("div",{className:"date-item",children:[a.jsx("span",{className:"date-label",children:"Último movimiento:"}),a.jsx("span",{className:"date-value",children:f(E.lastMovementDate)}),a.jsx("span",{className:"date-relative",children:p(E.lastMovementDate)})]}),E.lastMaintenanceDate&&a.jsxs("div",{className:"date-item",children:[a.jsx("span",{className:"date-label",children:"Último mantenimiento:"}),a.jsx("span",{className:"date-value",children:f(E.lastMaintenanceDate)}),a.jsx("span",{className:"date-relative",children:p(E.lastMaintenanceDate)})]})]}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"btn-view",onClick:()=>t(E),title:"Ver detalles",children:"👁️"}),e&&E.status!==Ve.REPARACION&&a.jsx("button",{className:"btn-edit",onClick:()=>e(E),title:"Editar vehículo",children:"✏️"}),i&&a.jsx("button",{className:"btn-maintenance",onClick:()=>i(E),title:"Registrar mantenimiento",children:"🔧"})]})]}),E.status===Ve.MANTENIMIENTO&&a.jsx("div",{className:"maintenance-indicator",children:a.jsx("div",{className:"maintenance-pulse"})}),A(E)&&E.status===Ve.ACTIVO&&a.jsx("div",{className:"maintenance-due-badge",children:a.jsx("span",{children:"Mantenimiento Debido"})}),E.status===Ve.REPARACION&&a.jsx("div",{className:"repair-badge",children:a.jsx("span",{children:"En Reparación"})}),E.totalHoursWorked>0&&a.jsxs("div",{className:"efficiency-indicator",children:[a.jsx("div",{className:"efficiency-bar",children:a.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(E.totalHoursWorked/2e3*100,100)}%`}})}),a.jsxs("span",{className:"efficiency-label",children:[(E.totalHoursWorked/2e3*100).toFixed(1),"% utilización anual"]})]})]},E.id))})},lV=({vehicles:n,onEdit:e,onView:t,onMaintenance:i})=>{const[o,c]=G.useState("vehicleId"),[d,f]=G.useState("asc"),p=F=>new Intl.NumberFormat("es-CO").format(F),g=F=>`${p(F)} gal`,y=F=>`${p(F)} hrs`,N=F=>F?(F instanceof Date?F:new Date(F)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",j=F=>{if(!F)return"🚗";const $=F.toLowerCase();return $.includes("excavadora")?"🚚":$.includes("bulldozer")?"🚜":$.includes("cargador")?"🏗️":$.includes("camion")?"🚛":$.includes("grua")?"🏗️":$.includes("motosierra")?"🪚":$.includes("tractor")?"🚜":$.includes("volqueta")?"🚛":"🚗"},w=F=>{switch(F){case vt.DIESEL:return"🚛";case vt.GASOLINA:return"🚗";case vt.ACPM:return"🚚";case vt.MIXTO:return"⛽";default:return"⛽"}},b=F=>{switch(F){case Ve.ACTIVO:return"✅";case Ve.MANTENIMIENTO:return"🔧";case Ve.INACTIVO:return"⏸️";case Ve.REPARACION:return"🔴";default:return"❓"}},A=F=>{switch(F){case Ve.ACTIVO:return"status-activo";case Ve.MANTENIMIENTO:return"status-mantenimiento";case Ve.INACTIVO:return"status-inactivo";case Ve.REPARACION:return"status-reparacion";default:return"status-default"}},E=F=>{o===F?f(d==="asc"?"desc":"asc"):(c(F),f("asc"))},D=[...n].sort((F,$)=>{let L=F[o],S=$[o];return(o.includes("Date")||o.includes("At"))&&(L=new Date(L||0),S=new Date(S||0)),typeof L=="number"&&typeof S=="number"?d==="asc"?L-S:S-L:typeof L=="string"&&typeof S=="string"?d==="asc"?L.localeCompare(S):S.localeCompare(L):L instanceof Date&&S instanceof Date?d==="asc"?L-S:S-L:!L&&!S?0:L?S?0:d==="asc"?-1:1:d==="asc"?1:-1}),q=F=>o!==F?"↕️":d==="asc"?"↑":"↓",U=F=>!F.totalHoursWorked||F.totalHoursWorked===0?F.estimatedConsumptionPerHour||0:F.totalFuelConsumed/F.totalHoursWorked,P=F=>F.lastMaintenanceDate?Math.floor((new Date-new Date(F.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return a.jsxs("div",{className:"vehicles-table-container",children:[a.jsx("div",{className:"table-wrapper",children:a.jsxs("table",{className:"vehicles-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{className:"sortable",onClick:()=>E("vehicleId"),children:["ID Vehículo ",q("vehicleId")]}),a.jsxs("th",{className:"sortable",onClick:()=>E("name"),children:["Nombre ",q("name")]}),a.jsxs("th",{className:"sortable",onClick:()=>E("type"),children:["Tipo ",q("type")]}),a.jsx("th",{children:"Marca/Modelo"}),a.jsxs("th",{className:"sortable",onClick:()=>E("fuelType"),children:["Combustible ",q("fuelType")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>E("totalFuelConsumed"),children:["Consumido ",q("totalFuelConsumed")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>E("totalHoursWorked"),children:["Horas ",q("totalHoursWorked")]}),a.jsx("th",{className:"text-right",children:"Consumo/Hr"}),a.jsx("th",{children:"Ubicación"}),a.jsxs("th",{className:"sortable",onClick:()=>E("status"),children:["Estado ",q("status")]}),a.jsxs("th",{className:"sortable",onClick:()=>E("lastMovementDate"),children:["Último Mov. ",q("lastMovementDate")]}),a.jsx("th",{className:"actions-column",children:"Acciones"})]})}),a.jsx("tbody",{children:D.map(F=>a.jsxs("tr",{className:`vehicle-row ${F.status===Ve.MANTENIMIENTO?"maintenance-row":""} ${P(F)?"needs-maintenance":""}`,children:[a.jsx("td",{className:"vehicle-id-cell",children:a.jsxs("div",{className:"id-content",children:[a.jsx("span",{className:"vehicle-icon",children:j(F.type)}),a.jsx("span",{className:"vehicle-id",children:F.vehicleId})]})}),a.jsx("td",{className:"name-cell",children:a.jsx("span",{className:"vehicle-name",children:F.name})}),a.jsx("td",{className:"type-cell",children:a.jsx("span",{className:"type-text",children:F.type.charAt(0).toUpperCase()+F.type.slice(1)})}),a.jsx("td",{className:"brand-model-cell",children:F.brand&&F.model?a.jsxs("span",{className:"brand-model",children:[F.brand," ",F.model]}):a.jsx("span",{className:"no-data",children:"-"})}),a.jsx("td",{className:"fuel-cell",children:a.jsxs("div",{className:"fuel-content",children:[a.jsx("span",{className:"fuel-icon",children:w(F.fuelType)}),a.jsx("span",{className:"fuel-text",children:F.fuelType})]})}),a.jsx("td",{className:"consumption-cell text-right",children:a.jsx("span",{className:"consumption-value",children:g(F.totalFuelConsumed||0)})}),a.jsx("td",{className:"hours-cell text-right",children:a.jsx("span",{className:"hours-value",children:y(F.totalHoursWorked||0)})}),a.jsx("td",{className:"rate-cell text-right",children:a.jsxs("span",{className:"rate-value",children:[U(F).toFixed(1)," gal/hr"]})}),a.jsx("td",{className:"location-cell",children:a.jsxs("span",{className:"location-text",children:["📍 ",F.currentLocation||"Sin ubicación"]})}),a.jsx("td",{className:"status-cell",children:a.jsxs("div",{className:`status-badge ${A(F.status)}`,children:[a.jsx("span",{className:"status-icon",children:b(F.status)}),a.jsx("span",{className:"status-text",children:F.status.charAt(0).toUpperCase()+F.status.slice(1)})]})}),a.jsx("td",{className:"date-cell",children:a.jsxs("div",{className:"date-content",children:[a.jsx("span",{className:"date-value",children:N(F.lastMovementDate)}),P(F)&&a.jsx("span",{className:"maintenance-warning",children:"⚠️"})]})}),a.jsx("td",{className:"actions-cell",children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"btn-action btn-view",onClick:()=>t(F),title:"Ver detalles",children:"👁️"}),e&&F.status!==Ve.REPARACION&&a.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(F),title:"Editar vehículo",children:"✏️"}),i&&a.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>i(F),title:"Registrar mantenimiento",children:"🔧"})]})})]},F.id))})]})}),a.jsxs("div",{className:"table-info",children:[a.jsxs("div",{className:"table-summary",children:[a.jsxs("span",{className:"total-rows",children:[n.length," vehículo",n.length!==1?"s":""]}),o&&a.jsxs("span",{className:"sort-info",children:["Ordenado por ",o," (",d==="asc"?"ascendente":"descendente",")"]})]}),a.jsxs("div",{className:"table-legend",children:[a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:"✅"})," Activo"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:"🔧"})," Mantenimiento"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:"⏸️"})," Inactivo"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:"🔴"})," Reparación"]}),a.jsxs("span",{className:"legend-item",children:[a.jsx("span",{className:"legend-icon",children:"⚠️"})," Mantto. Debido"]})]})]})]})},cV=({vehicles:n,viewMode:e,onEdit:t,onView:i,onMaintenance:o})=>e==="table"?a.jsx(lV,{vehicles:n,onEdit:t,onView:i,onMaintenance:o}):a.jsx(oV,{vehicles:n,onEdit:t,onView:i,onMaintenance:o}),uV="modulepreload",dV=function(n){return"/combustibles/"+n},BE={},sy=function(e,t,i){let o=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(N=>Promise.resolve(N).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};var d=g;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");o=g(t.map(y=>{if(y=dV(y),y in BE)return;BE[y]=!0;const N=y.endsWith(".css"),j=N?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${j}`))return;const w=document.createElement("link");if(w.rel=N?"stylesheet":uV,N||(w.as="script"),w.crossOrigin="",w.href=y,p&&w.setAttribute("nonce",p),document.head.appendChild(w),N)return new Promise((b,A)=>{w.addEventListener("load",b),w.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${y}`)))})}))}function c(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return o.then(f=>{for(const p of f||[])p.status==="rejected"&&c(p.reason);return e().catch(c)})},Tu="combustibles_vehicle_categories",hV=async n=>{try{const e=MA(n);if(!e.isValid)throw new Error(`Datos inválidos: ${e.errors.join(", ")}`);const t=await BA();if(t.some(d=>d.id===n.id||d.name.toLowerCase()===n.name.toLowerCase()))throw new Error("Ya existe una categoría con ese nombre o ID");n.id||(n.id=OA(n.name,t));const o={...n,createdAt:Ue(),updatedAt:Ue(),isCustom:!0,vehicleCount:0},c=await pl(Oe(fe,Tu),o);return console.log("✅ Categoría creada:",n.name),{id:c.id,...o,createdAt:new Date,updatedAt:new Date}}catch(e){throw console.error("❌ Error al crear categoría:",e),new Error(`Error al crear categoría: ${e.message}`)}},BA=async()=>{try{const n=Ee(Oe(fe,Tu),jn("name","asc")),e=await mt(n),t=[];return e.forEach(i=>{t.push({id:i.id,...i.data(),createdAt:i.data().createdAt?.toDate?.()||i.data().createdAt,updatedAt:i.data().updatedAt?.toDate?.()||i.data().updatedAt})}),t}catch(n){throw console.error("❌ Error al obtener categorías personalizadas:",n),new Error(`Error al obtener categorías: ${n.message}`)}},ay=async()=>{try{const n=await BA();return DA(n)}catch(n){return console.error("❌ Error al obtener todas las categorías:",n),os}},fV=async(n,e)=>{try{if(!n)throw new Error("ID de categoría requerido");if(os.some(d=>d.id===n))throw new Error("No se pueden modificar las categorías predeterminadas");if(e.name||e.fuelTypes||e.fields){const d=MA({...e,id:n});if(!d.isValid)throw new Error(`Datos inválidos: ${d.errors.join(", ")}`)}const i={...e,updatedAt:Ue()},o=et(fe,Tu,n);await Ts(o,i),console.log("✅ Categoría actualizada:",n);const c=await Ui(o);return{id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt}}catch(t){throw console.error("❌ Error al actualizar categoría:",t),new Error(`Error al actualizar categoría: ${t.message}`)}},mV=async n=>{try{if(!n)throw new Error("ID de categoría requerido");if(os.some(c=>c.id===n))throw new Error("No se pueden eliminar las categorías predeterminadas");const{countVehiclesByCategory:t}=await sy(async()=>{const{countVehiclesByCategory:c}=await Promise.resolve().then(()=>UA);return{countVehiclesByCategory:c}},void 0),i=await t(n);if(i>0)throw new Error(`No se puede eliminar la categoría porque tiene ${i} vehículo(s) asignado(s)`);const o=et(fe,Tu,n);return await vf(o),console.log("✅ Categoría eliminada:",n),!0}catch(e){throw console.error("❌ Error al eliminar categoría:",e),new Error(`Error al eliminar categoría: ${e.message}`)}},pV=n=>{try{const e=Ee(Oe(fe,Tu),jn("name","asc"));return qr(e,t=>{const i=[];t.forEach(c=>{i.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt})});const o=DA(i);n(o)},t=>{console.error("❌ Error en suscripción a categorías:",t),n(os)})}catch(e){return console.error("❌ Error al suscribirse a categorías:",e),n(os),()=>{}}},GE=async()=>{try{const{getAllVehicles:n}=await sy(async()=>{const{getAllVehicles:i}=await Promise.resolve().then(()=>UA);return{getAllVehicles:i}},void 0),e=await n();return(await ay()).map(i=>{const o=e.filter(c=>c.category===i.id);return{...i,vehicleCount:o.length,activeVehicles:o.filter(c=>c.status==="activo").length,totalFuelCapacity:o.reduce((c,d)=>c+(d.fuelCapacity||0),0),avgEnginepower:o.length>0?o.reduce((c,d)=>c+(d.enginePower||0),0)/o.length:0}}).sort((i,o)=>o.vehicleCount-i.vehicleCount)}catch(n){return console.error("❌ Error al obtener estadísticas de categorías:",n),[]}},GA=({onClose:n,onCategoryCreated:e})=>{const[t,i]=G.useState([]),[o,c]=G.useState([]),[d,f]=G.useState(!0),[p,g]=G.useState(!1),[y,N]=G.useState(null),[j,w]=G.useState(!1),[b,A]=G.useState(""),[E,D]=G.useState({name:"",description:"",icon:"🚗",color:"#2E86AB",fuelTypes:[],fields:[]});G.useEffect(()=>{q();const C=pV(R=>{i(R),U()});return()=>C&&C()},[]);const q=async()=>{try{f(!0);const[C,R]=await Promise.all([ay(),GE()]);i(C),c(R)}catch(C){console.error("Error cargando categorías:",C),A("Error al cargar categorías")}finally{f(!1)}},U=async()=>{try{const C=await GE();c(C)}catch(C){console.error("Error cargando estadísticas:",C)}},P=()=>{N(null),D({name:"",description:"",icon:"🚗",color:"#2E86AB",fuelTypes:[],fields:[]}),w(!0)},F=C=>{if(os.some(R=>R.id===C.id)){A("No se pueden editar las categorías predeterminadas");return}N(C),D({name:C.name||"",description:C.description||"",icon:C.icon||"🚗",color:C.color||"#2E86AB",fuelTypes:C.fuelTypes||[],fields:C.fields||[]}),w(!0)},$=async C=>{if(os.some(V=>V.id===C.id)){A("No se pueden eliminar las categorías predeterminadas");return}if(window.confirm(`¿Está seguro de eliminar la categoría "${C.name}"?

Esta acción no se puede deshacer.`))try{g(!0),await mV(C.id),A("")}catch(V){console.error("Error eliminando categoría:",V),A(V.message)}finally{g(!1)}},L=async C=>{if(C.preventDefault(),!E.name.trim()){A("El nombre de la categoría es requerido");return}try{g(!0),A("");const R={...E,name:E.name.trim(),description:E.description.trim()};if(y)await fV(y.id,R);else{R.id=OA(R.name,t);const V=await hV(R);e&&e(V)}w(!1)}catch(R){console.error("Error guardando categoría:",R),A(R.message)}finally{g(!1)}},S=C=>{D(R=>({...R,fields:R.fields.includes(C)?R.fields.filter(V=>V!==C):[...R.fields,C]}))},k=C=>{D(R=>({...R,fuelTypes:R.fuelTypes.includes(C)?R.fuelTypes.filter(V=>V!==C):[...R.fuelTypes,C]}))},O=C=>o.find(R=>R.id===C)||{vehicleCount:0,activeVehicles:0};return d?a.jsx("div",{className:"categories-manager",children:a.jsxs("div",{className:"loading",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Cargando categorías..."})]})}):a.jsxs("div",{className:"categories-manager",children:[a.jsxs("div",{className:"categories-header",children:[a.jsx("h3",{children:"📋 Gestión de Categorías"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"btn-primary",onClick:P,disabled:p,children:"➕ Nueva Categoría"}),a.jsx("button",{className:"btn-secondary",onClick:n,children:"✕ Cerrar"})]})]}),b&&a.jsxs("div",{className:"error-message",children:[a.jsxs("span",{children:["⚠️ ",b]}),a.jsx("button",{onClick:()=>A(""),children:"✕"})]}),a.jsx("div",{className:"categories-grid",children:t.map(C=>{const R=os.some(ye=>ye.id===C.id),V=O(C.id);return a.jsxs("div",{className:`category-card ${R?"default":"custom"}`,style:{"--category-color":C.color},children:[a.jsxs("div",{className:"category-header",children:[a.jsx("div",{className:"category-icon",style:{color:C.color},children:C.icon}),a.jsxs("div",{className:"category-info",children:[a.jsx("h4",{children:C.name}),a.jsx("p",{children:C.description})]}),R&&a.jsx("span",{className:"default-badge",children:"Predeterminada"})]}),a.jsxs("div",{className:"category-stats",children:[a.jsxs("div",{className:"stat",children:[a.jsx("span",{className:"stat-value",children:V.vehicleCount}),a.jsx("span",{className:"stat-label",children:"Vehículos"})]}),a.jsxs("div",{className:"stat",children:[a.jsx("span",{className:"stat-value",children:V.activeVehicles}),a.jsx("span",{className:"stat-label",children:"Activos"})]})]}),a.jsxs("div",{className:"category-details",children:[a.jsxs("div",{className:"fuel-types",children:[a.jsx("strong",{children:"Combustibles:"}),a.jsx("div",{className:"fuel-list",children:(C.fuelTypes||[]).map(ye=>a.jsx("span",{className:"fuel-tag",children:ye},ye))})]}),a.jsxs("div",{className:"fields",children:[a.jsx("strong",{children:"Campos:"}),a.jsxs("div",{className:"fields-list",children:[(C.fields||[]).slice(0,3).map(ye=>{const Ie=UE.find(Y=>Y.key===ye);return Ie?a.jsxs("span",{className:"field-tag",children:[Ie.icon," ",Ie.label]},ye):null}),(C.fields||[]).length>3&&a.jsxs("span",{className:"more-fields",children:["+",(C.fields||[]).length-3," más"]})]})]})]}),a.jsxs("div",{className:"category-actions",children:[a.jsx("button",{className:"btn-edit",onClick:()=>F(C),disabled:R||p,title:R?"No se pueden editar categorías predeterminadas":"Editar categoría",children:"✏️ Editar"}),a.jsx("button",{className:"btn-delete",onClick:()=>$(C),disabled:R||p||V.vehicleCount>0,title:R?"No se pueden eliminar categorías predeterminadas":V.vehicleCount>0?"No se puede eliminar una categoría con vehículos asignados":"Eliminar categoría",children:"🗑️ Eliminar"})]})]},C.id)})}),j&&a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"modal-content",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:y?"✏️ Editar Categoría":"➕ Nueva Categoría"}),a.jsx("button",{onClick:()=>w(!1),children:"✕"})]}),a.jsxs("form",{onSubmit:L,className:"category-form",children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Información Básica"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Nombre *"}),a.jsx("input",{type:"text",value:E.name,onChange:C=>D(R=>({...R,name:C.target.value})),placeholder:"Ej: Maquinaria Pesada",required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Icono"}),a.jsx("input",{type:"text",value:E.icon,onChange:C=>D(R=>({...R,icon:C.target.value})),placeholder:"🚗",className:"icon-input"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Descripción"}),a.jsx("textarea",{value:E.description,onChange:C=>D(R=>({...R,description:C.target.value})),placeholder:"Describe el tipo de vehículos que incluye esta categoría",rows:"2"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Color"}),a.jsx("input",{type:"color",value:E.color,onChange:C=>D(R=>({...R,color:C.target.value})),className:"color-input"})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Tipos de Combustible Compatibles"}),a.jsx("div",{className:"fuel-types-grid",children:Object.values(RA).map(C=>a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:E.fuelTypes.includes(C),onChange:()=>k(C)}),a.jsx("span",{children:C})]},C))})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Campos Específicos"}),a.jsx("p",{className:"section-description",children:"Selecciona los campos que serán relevantes para esta categoría"}),a.jsx("div",{className:"fields-grid",children:UE.map(C=>a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:E.fields.includes(C.key),onChange:()=>S(C.key)}),a.jsxs("span",{children:[C.icon," ",C.label]})]},C.key))})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{children:"Vista Previa"}),a.jsx("div",{className:"category-preview",style:{"--category-color":E.color},children:a.jsxs("div",{className:"category-header",children:[a.jsx("div",{className:"category-icon",style:{color:E.color},children:E.icon}),a.jsxs("div",{className:"category-info",children:[a.jsx("h4",{children:E.name||"Nombre de la categoría"}),a.jsx("p",{children:E.description||"Descripción de la categoría"})]})]})})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>w(!1),disabled:p,children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn-primary",disabled:p||!E.name.trim(),children:p?"Guardando...":y?"Actualizar":"Crear"})]})]})]})})]})},gV=({isOpen:n,onClose:e,vehicle:t,onSave:i,mode:o="create"})=>{const[c,d]=G.useState([]),[f,p]=G.useState(null),[g,y]=G.useState(!1),[N,j]=G.useState(!1),[w,b]=G.useState(!1),[A,E]=G.useState({}),D=()=>({vehicleId:t?.vehicleId||"",name:t?.name||"",category:t?.category||"",brand:t?.brand||"",model:t?.model||"",year:t?.year||new Date().getFullYear(),fuelType:t?.fuelType||vt.DIESEL,status:t?.status||Ve.ACTIVO,currentLocation:t?.currentLocation||"",description:t?.description||"",plateNumber:t?.plateNumber||"",enginePower:t?.enginePower||"",fuelCapacity:t?.fuelCapacity||"",operatingWeight:t?.operatingWeight||"",loadCapacity:t?.loadCapacity||"",bucketCapacity:t?.bucketCapacity||"",hasHourMeter:t?.hasHourMeter||!1,currentHours:t?.currentHours||"",implementType:t?.implementType||"",flow:t?.flow||"",pressure:t?.pressure||"",weight:t?.weight||"",lastMaintenanceDate:t?.lastMaintenanceDate?new Date(t.lastMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:t?.purchaseDate?new Date(t.purchaseDate).toISOString().split("T")[0]:""}),[q,U]=G.useState(D());G.useEffect(()=>(n?(P(),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n]),G.useEffect(()=>{if(t&&c.length>0){const C=FE(t.category,c);p(C),U(D())}},[t,c]);const P=async()=>{try{b(!0);const C=await ay();if(d(C),o==="create"&&C.length>0){const R=C[0];p(R),U(V=>({...V,category:R.id}))}}catch(C){console.error("Error cargando categorías:",C)}finally{b(!1)}},F=C=>{const R=FE(C,c);p(R),U(V=>{const ye=o==="create"&&V.name&&R?L(V.name,R):V.vehicleId;return{...V,category:C,vehicleId:ye,fuelType:R?.fuelTypes?.includes(V.fuelType)?V.fuelType:R?.fuelTypes?.[0]||vt.DIESEL}}),E({})},$=(C,R)=>{if(U(V=>({...V,[C]:R})),A[C]&&E(V=>({...V,[C]:null})),C==="name"&&o==="create"){const V=L(R,f);U(ye=>({...ye,vehicleId:V}))}if(C==="category"&&o==="create"&&q.name){const V=f;if(V){const ye=L(q.name,V);U(Ie=>({...Ie,vehicleId:ye}))}}},L=(C,R)=>{if(!C||!R)return"";const V=R.name.split(" ").map(te=>te.charAt(0).toUpperCase()).join("").substring(0,3),ye=C.replace(/[^a-zA-Z0-9]/g,"").substring(0,4).toUpperCase(),Y=Date.now().toString().slice(-3);return`${V}${ye}${Y}`},S=()=>{const C={};return q.vehicleId?.trim()||(C.vehicleId="Código del vehículo es requerido"),q.name?.trim()||(C.name="Nombre del vehículo es requerido"),q.category||(C.category="Categoría es requerida"),q.fuelType||(C.fuelType="Tipo de combustible es requerido"),f&&q.fuelType&&(f.fuelTypes?.includes(q.fuelType)||(C.fuelType=`Este combustible no es compatible con la categoría ${f.name}`)),["enginePower","fuelCapacity","operatingWeight","loadCapacity","bucketCapacity","flow","pressure","weight"].forEach(V=>{q[V]&&(isNaN(q[V])||Number(q[V])<0)&&(C[V]="Debe ser un número válido mayor o igual a 0")}),q.year&&(q.year<1900||q.year>new Date().getFullYear()+1)&&(C.year=`Año debe estar entre 1900 y ${new Date().getFullYear()+1}`),q.hasHourMeter&&q.currentHours&&(isNaN(q.currentHours)||Number(q.currentHours)<0)&&(C.currentHours="Horas actuales debe ser un número válido mayor o igual a 0"),E(C),Object.keys(C).length===0},k=async C=>{if(C.preventDefault(),!!S())try{b(!0);const R={...q,type:f?.name||q.category||"Otro",enginePower:q.enginePower?Number(q.enginePower):null,fuelCapacity:q.fuelCapacity?Number(q.fuelCapacity):null,operatingWeight:q.operatingWeight?Number(q.operatingWeight):null,loadCapacity:q.loadCapacity?Number(q.loadCapacity):null,bucketCapacity:q.bucketCapacity?Number(q.bucketCapacity):null,currentHours:q.currentHours?Number(q.currentHours):null,flow:q.flow?Number(q.flow):null,pressure:q.pressure?Number(q.pressure):null,weight:q.weight?Number(q.weight):null,year:Number(q.year),lastMaintenanceDate:q.lastMaintenanceDate?new Date(q.lastMaintenanceDate):null,purchaseDate:q.purchaseDate?new Date(q.purchaseDate):null,categoryName:f?.name,categoryIcon:f?.icon,categoryColor:f?.color};await i(R),e()}catch(R){console.error("Error guardando vehículo:",R),E({submit:R.message})}finally{b(!1)}},O=()=>f&&f.fuelTypes||Object.values(vt);return n?a.jsxs("div",{className:"modal-overlay",children:[a.jsxs("div",{className:"modal-container",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:o==="create"?"🚗 Nuevo Vehículo":"✏️ Editar Vehículo"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>y(!0),disabled:w,children:"📋 Gestionar Categorías"}),a.jsx("button",{type:"button",className:"btn-close",onClick:e,children:"✕"})]})]}),a.jsxs("form",{onSubmit:k,className:"modal-body",children:[A.submit&&a.jsxs("div",{className:"error-banner",children:["⚠️ ",A.submit]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"📂 Categoría del Vehículo"}),w?a.jsxs("div",{className:"loading-categories",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{children:"Cargando categorías..."})]}):a.jsxs("div",{className:"categories-selector",children:[a.jsxs("select",{value:q.category,onChange:C=>F(C.target.value),className:`category-select ${A.category?"error":""}`,children:[a.jsx("option",{value:"",children:"Seleccionar categoría del vehículo..."}),c.map(C=>a.jsxs("option",{value:C.id,children:[C.icon," ",C.name,os.some(R=>R.id===C.id)&&" (Predeterminada)"]},C.id))]}),f&&a.jsx(vV,{category:f,isExpanded:N,onToggle:()=>j(!N)})]}),A.category&&a.jsx("span",{className:"field-error",children:A.category})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"📝 Información Básica"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"vehicleId",className:"form-label",children:"🏷️ Código del Vehículo *"}),a.jsx("input",{type:"text",id:"vehicleId",value:q.vehicleId,className:`form-input ${A.vehicleId?"error":""} ${o==="create"?"readonly":""}`,placeholder:"Se genera automáticamente",readOnly:o==="create",onChange:o==="edit"?C=>$("vehicleId",C.target.value):void 0,required:!0}),A.vehicleId&&a.jsx("span",{className:"field-error",children:A.vehicleId})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"name",className:"form-label",children:"📛 Nombre del Vehículo *"}),a.jsx("input",{type:"text",id:"name",value:q.name,onChange:C=>$("name",C.target.value),className:`form-input ${A.name?"error":""}`,placeholder:"Ej: Excavadora Principal, Tractor TR1",required:!0}),A.name&&a.jsx("span",{className:"field-error",children:A.name})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"brand",className:"form-label",children:"🏭 Marca"}),a.jsx("input",{type:"text",id:"brand",value:q.brand,onChange:C=>$("brand",C.target.value),className:"form-input",placeholder:"Ej: Caterpillar, John Deere"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"year",className:"form-label",children:"📅 Año"}),a.jsx("input",{type:"number",id:"year",value:q.year,onChange:C=>$("year",C.target.value),className:`form-input ${A.year?"error":""}`,min:"1900",max:new Date().getFullYear()+1}),A.year&&a.jsx("span",{className:"field-error",children:A.year})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"fuelType",className:"form-label",children:"⛽ Tipo de Combustible *"}),a.jsx("select",{id:"fuelType",value:q.fuelType,onChange:C=>$("fuelType",C.target.value),className:`form-input ${A.fuelType?"error":""}`,required:!0,children:O().map(C=>a.jsx("option",{value:C,children:C},C))}),A.fuelType&&a.jsx("span",{className:"field-error",children:A.fuelType})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"status",className:"form-label",children:"🚦 Estado"}),a.jsx("select",{id:"status",value:q.status,onChange:C=>$("status",C.target.value),className:"form-input",children:Object.entries(Ve).map(([C,R])=>a.jsx("option",{value:R,children:R.charAt(0).toUpperCase()+R.slice(1)},C))})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"currentLocation",className:"form-label",children:"📍 Ubicación Actual"}),a.jsx("input",{type:"text",id:"currentLocation",value:q.currentLocation,onChange:C=>$("currentLocation",C.target.value),className:"form-input",placeholder:"Ej: Sector Norte, Patio Principal"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"description",className:"form-label",children:"📄 Descripción"}),a.jsx("textarea",{id:"description",value:q.description,onChange:C=>$("description",C.target.value),className:"form-input",rows:"3",placeholder:"Descripción adicional del vehículo, características especiales, etc."})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"📅 Fechas Importantes"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"purchaseDate",className:"form-label",children:"💰 Fecha de Compra"}),a.jsx("input",{type:"date",id:"purchaseDate",value:q.purchaseDate,onChange:C=>$("purchaseDate",C.target.value),className:"form-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"lastMaintenanceDate",className:"form-label",children:"🔧 Último Mantenimiento"}),a.jsx("input",{type:"date",id:"lastMaintenanceDate",value:q.lastMaintenanceDate,onChange:C=>$("lastMaintenanceDate",C.target.value),className:"form-input"})]})]})]}),f&&a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"👁️ Vista Previa"}),a.jsx("div",{className:"vehicle-preview",style:{"--category-color":f.color},children:a.jsxs("div",{className:"preview-header",children:[a.jsx("div",{className:"preview-icon",style:{color:f.color},children:f.icon}),a.jsxs("div",{className:"preview-info",children:[a.jsx("h4",{children:q.name||"Nombre del vehículo"}),a.jsxs("p",{children:[q.vehicleId||"Código del vehículo"," • ",f.name]}),a.jsxs("p",{children:[q.brand," ",q.year]})]})]})})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:w,children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn-primary",disabled:w||!f,children:w?"Guardando...":o==="create"?"Crear Vehículo":"Actualizar Vehículo"})]})]})]}),g&&a.jsx(GA,{onClose:()=>y(!1),onCategoryCreated:C=>{d(R=>[...R,C]),y(!1)}})]}):null},vV=({category:n,isExpanded:e,onToggle:t})=>n?a.jsxs("div",{className:"category-info-panel",children:[a.jsxs("div",{className:"category-compact",children:[a.jsxs("div",{className:"category-summary",children:[a.jsx("span",{className:"category-icon",style:{color:n.color},children:n.icon}),a.jsxs("div",{className:"category-basic-info",children:[a.jsx("span",{className:"category-name",children:n.name}),a.jsx("span",{className:"category-short-desc",children:n.description?.length>50?n.description.substring(0,50)+"...":n.description})]})]}),a.jsx("button",{type:"button",className:"category-toggle-btn",onClick:t,"aria-label":e?"Contraer información":"Expandir información",children:e?"▲":"▼"})]}),e&&a.jsxs("div",{className:"category-expanded",children:[a.jsxs("div",{className:"category-detail-section",children:[a.jsx("h4",{children:"📋 Descripción Completa"}),a.jsx("p",{children:n.description})]}),n.fuelTypes&&n.fuelTypes.length>0&&a.jsxs("div",{className:"category-detail-section",children:[a.jsx("h4",{children:"⛽ Combustibles Compatibles"}),a.jsx("div",{className:"fuel-types-list",children:n.fuelTypes.map(i=>a.jsx("span",{className:"fuel-type-badge",children:i},i))})]}),n.fields&&n.fields.length>0&&a.jsxs("div",{className:"category-detail-section",children:[a.jsx("h4",{children:"🔧 Campos Específicos"}),a.jsx("div",{className:"fields-list",children:n.fields.map(i=>a.jsx("span",{className:"field-badge",children:i},i))})]}),n.isCustom&&a.jsx("div",{className:"category-detail-section",children:a.jsx("span",{className:"custom-badge",children:"✨ Categoría Personalizada"})})]})]}):null,Po={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},fi={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},Lo={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},yV=({isOpen:n,onClose:e,vehicle:t,maintenance:i,onSave:o,mode:c="create",userRole:d})=>{const f=()=>({vehicleId:t?.vehicleId||"",vehicleName:t?.name||"",type:i?.type||Po.PREVENTIVO,title:i?.title||"",description:i?.description||"",priority:i?.priority||Lo.MEDIA,status:i?.status||fi.PROGRAMADO,scheduledDate:i?.scheduledDate?new Date(i.scheduledDate).toISOString().split("T")[0]:"",startDate:i?.startDate?new Date(i.startDate).toISOString().split("T")[0]:"",completedDate:i?.completedDate?new Date(i.completedDate).toISOString().split("T")[0]:"",estimatedHours:i?.estimatedHours||0,actualHours:i?.actualHours||0,estimatedCost:i?.estimatedCost||0,actualCost:i?.actualCost||0,technician:i?.technician||"",workshop:i?.workshop||"",parts:i?.parts||[],notes:i?.notes||"",nextMaintenanceKm:i?.nextMaintenanceKm||0,nextMaintenanceHours:i?.nextMaintenanceHours||0,nextMaintenanceDate:i?.nextMaintenanceDate?new Date(i.nextMaintenanceDate).toISOString().split("T")[0]:""}),[p,g]=G.useState(f()),[y,N]=G.useState({}),[j,w]=G.useState(!1),[b,A]=G.useState({name:"",quantity:1,cost:0});G.useEffect(()=>{n&&(g(f()),N({}))},[n,i,t]);const E=R=>{const{name:V,value:ye,type:Ie}=R.target,Y=Ie==="number"?parseFloat(ye)||0:ye;g(te=>({...te,[V]:Y})),y[V]&&N(te=>({...te,[V]:null}))},D=R=>{const{name:V,value:ye,type:Ie}=R.target,Y=Ie==="number"?parseFloat(ye)||0:ye;A(te=>({...te,[V]:Y}))},q=()=>{if(!b.name.trim())return;const R={id:Date.now().toString(),name:b.name.trim(),quantity:b.quantity,cost:b.cost,total:b.quantity*b.cost};g(V=>({...V,parts:[...V.parts,R]})),A({name:"",quantity:1,cost:0})},U=R=>{g(V=>({...V,parts:V.parts.filter(ye=>ye.id!==R)}))},P=()=>{const R={};if(p.title.trim()||(R.title="El título del mantenimiento es obligatorio"),p.description.trim()||(R.description="La descripción es obligatoria"),p.scheduledDate||(R.scheduledDate="La fecha programada es obligatoria"),p.startDate&&p.completedDate){const V=new Date(p.startDate);new Date(p.completedDate)<V&&(R.completedDate="La fecha de finalización debe ser posterior al inicio")}return p.scheduledDate&&p.startDate&&(new Date(p.scheduledDate),new Date(p.startDate)),p.estimatedHours<0&&(R.estimatedHours="Las horas estimadas no pueden ser negativas"),p.actualHours<0&&(R.actualHours="Las horas reales no pueden ser negativas"),p.estimatedCost<0&&(R.estimatedCost="El costo estimado no puede ser negativo"),p.actualCost<0&&(R.actualCost="El costo real no puede ser negativo"),p.status===fi.COMPLETADO&&!p.completedDate&&(R.completedDate="La fecha de finalización es obligatoria para mantenimientos completados"),p.status===fi.EN_PROCESO&&!p.startDate&&(R.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),N(R),Object.keys(R).length===0},F=async R=>{if(R.preventDefault(),!!P()){w(!0);try{const V=p.parts.reduce((te,le)=>te+le.total,0),ye=p.estimatedCost+V,Ie=p.actualCost+V,Y={...p,vehicleId:t.id,vehicleName:t.name,totalPartsCost:V,totalEstimatedCost:ye,totalActualCost:Ie,scheduledDate:p.scheduledDate||null,startDate:p.startDate||null,completedDate:p.completedDate||null,nextMaintenanceDate:p.nextMaintenanceDate||null,createdAt:i?.createdAt||new Date,updatedAt:new Date};await o(Y),e()}catch(V){console.error("Error guardando mantenimiento:",V),N({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{w(!1)}}},$=R=>{switch(R){case Po.PREVENTIVO:return"🔧";case Po.CORRECTIVO:return"🛠️";case Po.PREDICTIVO:return"📊";case Po.EMERGENCIA:return"🚨";default:return"⚙️"}},L=R=>{switch(R){case Lo.BAJA:return"priority-low";case Lo.MEDIA:return"priority-medium";case Lo.ALTA:return"priority-high";case Lo.CRITICA:return"priority-critical";default:return"priority-medium"}},S=R=>{switch(R){case fi.PROGRAMADO:return"status-scheduled";case fi.EN_PROCESO:return"status-in-progress";case fi.COMPLETADO:return"status-completed";case fi.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},k=()=>p.parts.reduce((R,V)=>R+V.total,0),O=c==="view",C=d==="admin"||d==="supervisor";return n?a.jsx("div",{className:"modal-overlay",onClick:e,children:a.jsxs("div",{className:"modal-content maintenance-modal",onClick:R=>R.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("div",{className:"modal-title",children:[a.jsx("span",{className:"title-icon",children:c==="create"?"➕":c==="edit"?"✏️":"👁️"}),a.jsxs("div",{className:"title-text",children:[a.jsxs("h3",{children:[c==="create"&&"Registrar Mantenimiento",c==="edit"&&"Editar Mantenimiento",c==="view"&&"Detalles del Mantenimiento"]}),a.jsxs("p",{children:["Vehículo: ",t?.vehicleId," - ",t?.name]})]})]}),a.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),a.jsxs("form",{onSubmit:F,className:"modal-form",children:[a.jsxs("div",{className:"form-content",children:[y.general&&a.jsxs("div",{className:"error-message general-error",children:["⚠️ ",y.general]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:"📋 Información del Mantenimiento"}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),a.jsx("select",{id:"type",name:"type",value:p.type,onChange:E,disabled:O||c==="edit"&&!C,children:Object.values(Po).map(R=>a.jsxs("option",{value:R,children:[$(R)," ",R.charAt(0).toUpperCase()+R.slice(1)]},R))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"priority",children:"Prioridad"}),a.jsx("select",{id:"priority",name:"priority",value:p.priority,onChange:E,className:L(p.priority),disabled:O||c==="edit"&&!C,children:Object.values(Lo).map(R=>a.jsx("option",{value:R,children:R.charAt(0).toUpperCase()+R.slice(1)},R))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"status",children:"Estado"}),a.jsx("select",{id:"status",name:"status",value:p.status,onChange:E,className:S(p.status),disabled:O||c==="edit"&&!C,children:Object.values(fi).map(R=>a.jsx("option",{value:R,children:R.charAt(0).toUpperCase()+R.slice(1).replace("_"," ")},R))})]}),a.jsxs("div",{className:"form-group full-width",children:[a.jsx("label",{htmlFor:"title",children:"Título del Mantenimiento *"}),a.jsx("input",{type:"text",id:"title",name:"title",value:p.title,onChange:E,placeholder:"Ej: Cambio de aceite y filtros",className:y.title?"error":"",disabled:O||c==="edit"&&!C,maxLength:100}),y.title&&a.jsx("span",{className:"error-text",children:y.title})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:"📅 Programación"}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),a.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:p.scheduledDate,onChange:E,className:y.scheduledDate?"error":"",disabled:O||c==="edit"&&!C}),y.scheduledDate&&a.jsx("span",{className:"error-text",children:y.scheduledDate})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),a.jsx("input",{type:"date",id:"startDate",name:"startDate",value:p.startDate,onChange:E,className:y.startDate?"error":"",disabled:O||c==="edit"&&!C}),y.startDate&&a.jsx("span",{className:"error-text",children:y.startDate})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalización"}),a.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:p.completedDate,onChange:E,className:y.completedDate?"error":"",disabled:O||c==="edit"&&!C}),y.completedDate&&a.jsx("span",{className:"error-text",children:y.completedDate})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),a.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:p.nextMaintenanceDate,onChange:E,disabled:O||c==="edit"&&!C})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:"💰 Recursos y Costos"}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"technician",children:"Técnico Responsable"}),a.jsx("input",{type:"text",id:"technician",name:"technician",value:p.technician,onChange:E,placeholder:"Nombre del técnico",disabled:O||c==="edit"&&!C,maxLength:100})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicación"}),a.jsx("input",{type:"text",id:"workshop",name:"workshop",value:p.workshop,onChange:E,placeholder:"Taller donde se realiza",disabled:O||c==="edit"&&!C,maxLength:100})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),a.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:p.estimatedHours,onChange:E,min:"0",step:"0.5",className:y.estimatedHours?"error":"",disabled:O||c==="edit"&&!C}),y.estimatedHours&&a.jsx("span",{className:"error-text",children:y.estimatedHours})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),a.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:p.actualHours,onChange:E,min:"0",step:"0.5",className:y.actualHours?"error":"",disabled:O||c==="edit"&&!C}),y.actualHours&&a.jsx("span",{className:"error-text",children:y.actualHours})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),a.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:p.estimatedCost,onChange:E,min:"0",step:"1000",className:y.estimatedCost?"error":"",disabled:O||c==="edit"&&!C}),y.estimatedCost&&a.jsx("span",{className:"error-text",children:y.estimatedCost})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),a.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:p.actualCost,onChange:E,min:"0",step:"1000",className:y.actualCost?"error":"",disabled:O||c==="edit"&&!C}),y.actualCost&&a.jsx("span",{className:"error-text",children:y.actualCost})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:"🔧 Partes y Repuestos"}),!O&&C&&a.jsx("div",{className:"parts-form",children:a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),a.jsx("input",{type:"text",id:"partName",name:"name",value:b.name,onChange:D,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),a.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:b.quantity,onChange:D,min:"1",step:"1"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),a.jsx("input",{type:"number",id:"partCost",name:"cost",value:b.cost,onChange:D,min:"0",step:"1000"})]}),a.jsx("div",{className:"form-group",children:a.jsx("button",{type:"button",className:"btn-add-part",onClick:q,disabled:!b.name.trim(),children:"➕ Agregar"})})]})}),p.parts.length>0&&a.jsx("div",{className:"parts-list",children:a.jsxs("table",{className:"parts-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Parte"}),a.jsx("th",{children:"Cantidad"}),a.jsx("th",{children:"Costo Unit."}),a.jsx("th",{children:"Total"}),!O&&C&&a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:p.parts.map(R=>a.jsxs("tr",{children:[a.jsx("td",{children:R.name}),a.jsx("td",{children:R.quantity}),a.jsxs("td",{children:["$",R.cost.toLocaleString("es-CO")]}),a.jsxs("td",{children:["$",R.total.toLocaleString("es-CO")]}),!O&&C&&a.jsx("td",{children:a.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>U(R.id),title:"Eliminar parte",children:"🗑️"})})]},R.id))}),a.jsx("tfoot",{children:a.jsxs("tr",{className:"total-row",children:[a.jsx("td",{colSpan:"3",children:a.jsx("strong",{children:"Total Partes:"})}),a.jsx("td",{children:a.jsxs("strong",{children:["$",k().toLocaleString("es-CO")]})}),!O&&C&&a.jsx("td",{})]})})]})})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:"🔄 Próximo Mantenimiento"}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Próximo Mantenimiento (Km)"}),a.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:p.nextMaintenanceKm,onChange:E,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:O||c==="edit"&&!C})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Próximo Mantenimiento (Horas)"}),a.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:p.nextMaintenanceHours,onChange:E,min:"0",step:"100",placeholder:"0 = No aplica",disabled:O||c==="edit"&&!C})]})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"description",children:"Descripción del Trabajo *"}),a.jsx("textarea",{id:"description",name:"description",value:p.description,onChange:E,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:y.description?"error":"",disabled:O||c==="edit"&&!C}),y.description&&a.jsx("span",{className:"error-text",children:y.description})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),a.jsx("textarea",{id:"notes",name:"notes",value:p.notes,onChange:E,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:O||c==="edit"&&!C}),a.jsxs("span",{className:"char-count",children:[p.notes.length,"/500 caracteres"]})]})]}),a.jsxs("div",{className:"cost-summary",children:[a.jsx("h4",{children:"💰 Resumen de Costos"}),a.jsxs("div",{className:"cost-grid",children:[a.jsxs("div",{className:"cost-item",children:[a.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),a.jsxs("span",{className:"cost-value",children:["$",p.actualCost.toLocaleString("es-CO")]})]}),a.jsxs("div",{className:"cost-item",children:[a.jsx("span",{className:"cost-label",children:"Partes:"}),a.jsxs("span",{className:"cost-value",children:["$",k().toLocaleString("es-CO")]})]}),a.jsxs("div",{className:"cost-item total-cost",children:[a.jsx("span",{className:"cost-label",children:"Total:"}),a.jsxs("span",{className:"cost-value",children:["$",(p.actualCost+k()).toLocaleString("es-CO")]})]})]})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:j,children:c==="view"?"Cerrar":"Cancelar"}),!O&&C&&a.jsx("button",{type:"submit",className:"btn-primary",disabled:j,children:j?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):a.jsx(a.Fragment,{children:c==="create"?"➕ Registrar Mantenimiento":"💾 Guardar Cambios"})})]})]})]})}):null},xV=()=>{const{user:n,userProfile:e}=js(),[t,i]=G.useState([]),[o,c]=G.useState(null),[d,f]=G.useState(!0),[p,g]=G.useState(null),[y,N]=G.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[j,w]=G.useState("cards"),[b,A]=G.useState(""),[E,D]=G.useState(!1),[q,U]=G.useState(!1),[P,F]=G.useState(!1),[$,L]=G.useState(null),[S,k]=G.useState("create");G.useEffect(()=>{if(!n)return;f(!0);const ee=ny((ce,ue)=>{if(ue){console.error("Error en suscripción de vehículos:",ue),g("Error al cargar vehículos"),f(!1);return}i(ce),g(null),f(!1)},y);return()=>ee()},[n,y]),G.useEffect(()=>{n&&(async()=>{try{const ce=await LA(y);c(ce)}catch(ce){console.error("Error al cargar estadísticas:",ce)}})()},[n,t,y]);const O=t.filter(ee=>{if(!b)return!0;const ce=b.toLowerCase();return ee.vehicleId?.toLowerCase().includes(ce)||ee.name?.toLowerCase().includes(ce)||ee.type?.toLowerCase().includes(ce)||ee.brand?.toLowerCase().includes(ce)||ee.model?.toLowerCase().includes(ce)||ee.currentLocation?.toLowerCase().includes(ce)||ee.description?.toLowerCase().includes(ce)}),C=()=>{L(null),k("create"),D(!0)},R=ee=>{L(ee),k("edit"),D(!0)},V=ee=>{L(ee),k("view"),D(!0)},ye=ee=>{L(ee),U(!0)},Ie=()=>{D(!1),U(!1),L(null)},Y=ee=>{N(ce=>({...ce,...ee}))},te=()=>{N({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),A("")},le=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",Me=e?.role==="admin",H=e?.role==="admin"||e?.role==="contador";return d?a.jsx("div",{className:"vehicles-main",children:a.jsxs("div",{className:"loading-container",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando vehículos..."})]})}):p?a.jsx("div",{className:"vehicles-main",children:a.jsxs("div",{className:"error-container",children:[a.jsx("div",{className:"error-icon",children:"⚠️"}),a.jsx("h3",{children:"Error al cargar vehículos"}),a.jsx("p",{children:p}),a.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):a.jsxs("div",{className:"vehicles-main",children:[a.jsxs("div",{className:"vehicles-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h2",{children:"🚜 Gestión de Vehículos"}),a.jsx("p",{children:"Administra la maquinaria y vehículos forestales"})]}),le&&a.jsx("button",{className:"btn-create-vehicle",onClick:C,children:"➕ Nuevo Vehículo"})]}),o&&a.jsx(iV,{stats:o,filters:y}),a.jsx(rV,{filters:y,onFilterChange:Y,onClearFilters:te,searchTerm:b,onSearchChange:A,viewMode:j,onViewModeChange:w,totalResults:O.length}),O.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:"🚜"}),a.jsx("h3",{children:t.length===0?"No hay vehículos registrados":"No se encontraron vehículos"}),a.jsx("p",{children:t.length===0?"Comienza registrando tu primer vehículo o maquinaria forestal":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&le&&a.jsx("button",{className:"btn-create-first",onClick:C,children:"➕ Registrar Primer Vehículo"})]}):a.jsx(cV,{vehicles:O,viewMode:j,onEdit:Me?R:null,onView:V,onMaintenance:H?ye:null,userRole:n?.role}),E&&a.jsx(gV,{isOpen:E,onClose:Ie,vehicle:$,mode:S,onSave:async ee=>{S==="create"?await kA(ee):await PA($.id,ee),Ie()},userRole:e?.role}),P&&a.jsx(GA,{onClose:()=>F(!1),onCategoryCreated:()=>{}}),q&&a.jsx(yV,{isOpen:q,onClose:Ie,vehicle:$,onSuccess:()=>{Ie()}})]})},ju="combustibles_maintenance",$A="combustibles_vehicles",me={OIL_CHANGE:"oil_change",BATTERY_CHANGE:"battery_change",FILTER_CHANGE:"filter_change",GENERAL_MAINTENANCE:"general_maintenance"},Pe={COMPLETED:"completado",PENDING:"pendiente",CANCELLED:"cancelado"},Go={NEW:"nueva",USED:"usada",REPAIRED:"reparada"},iy={OIL_CHANGE_HOURS:250,BATTERY_LIFETIME_MONTHS:24},YA=async n=>{try{NV(n);const e={...n,createdAt:Ue(),updatedAt:Ue(),status:n.status||Pe.COMPLETED,createdBy:n.createdBy||"system"};n.type===me.OIL_CHANGE&&(e.nextChangeHours=Tf(n.currentHours)),n.type===me.BATTERY_CHANGE&&(e.nextBatteryChange=JA(n.date));const t=await pl(Oe(fe,ju),e);return n.vehicleId&&n.currentHours&&await ew(n.vehicleId,n.currentHours),console.log("✅ Mantenimiento creado exitosamente:",t.id),t.id}catch(e){throw console.error("❌ Error al crear mantenimiento:",e),new Error(`Error al crear mantenimiento: ${e.message}`)}},QA=async(n={})=>{try{let e=Oe(fe,ju);n.type&&(e=Ee(e,Se("type","==",n.type))),n.vehicleId&&(e=Ee(e,Se("vehicleId","==",n.vehicleId))),n.status&&(e=Ee(e,Se("status","==",n.status))),n.dateFrom&&(e=Ee(e,Se("date",">=",new Date(n.dateFrom)))),n.dateTo&&(e=Ee(e,Se("date","<=",new Date(n.dateTo)))),e=Ee(e,jn("date","desc"));const t=await mt(e),i=[];return t.forEach(o=>{i.push({id:o.id,...o.data()})}),i}catch(e){throw console.error("❌ Error al obtener mantenimientos:",e),new Error(`Error al obtener mantenimientos: ${e.message}`)}},KA=async(n,e)=>{try{_V(e);const t=et(fe,ju,n),i={...e,updatedAt:Ue()};e.currentHours&&e.type===me.OIL_CHANGE&&(i.nextChangeHours=Tf(e.currentHours)),await Ts(t,i),e.vehicleId&&e.currentHours&&await ew(e.vehicleId,e.currentHours),console.log("✅ Mantenimiento actualizado exitosamente:",n)}catch(t){throw console.error("❌ Error al actualizar mantenimiento:",t),new Error(`Error al actualizar mantenimiento: ${t.message}`)}},bV=async n=>{try{const e=et(fe,ju,n);await vf(e),console.log("✅ Mantenimiento eliminado exitosamente:",n)}catch(e){throw console.error("❌ Error al eliminar mantenimiento:",e),new Error(`Error al eliminar mantenimiento: ${e.message}`)}},XA=async(n={})=>{try{const e=await QA(n),t={total:e.length,byType:{},byStatus:{},byVehicle:{},totalCost:0,averageCost:0,upcomingCount:0,overdueCount:0};let i=0;return e.forEach(o=>{t.byType[o.type]=(t.byType[o.type]||0)+1,t.byStatus[o.status]=(t.byStatus[o.status]||0)+1,t.byVehicle[o.vehicleId]=(t.byVehicle[o.vehicleId]||0)+1,o.cost&&(i+=parseFloat(o.cost)),o.nextChangeDate&&(new Date(o.nextChangeDate)>new Date?t.upcomingCount++:t.overdueCount++)}),t.totalCost=i,t.averageCost=t.total>0?i/t.total:0,t}catch(e){throw console.error("❌ Error al obtener estadísticas de mantenimiento:",e),new Error(`Error al obtener estadísticas de mantenimiento: ${e.message}`)}},WA=(n,e={})=>{try{let t=Oe(fe,ju);return e.type&&(t=Ee(t,Se("type","==",e.type))),e.vehicleId&&(t=Ee(t,Se("vehicleId","==",e.vehicleId))),e.status&&(t=Ee(t,Se("status","==",e.status))),t=Ee(t,jn("date","desc")),qr(t,o=>{const c=[];o.forEach(d=>{c.push({id:d.id,...d.data()})}),n(c,null)},o=>{console.error("❌ Error en suscripción de mantenimientos:",o),n([],o)})}catch(t){return console.error("❌ Error al suscribirse a mantenimientos:",t),n([],t),()=>{}}},ZA=async()=>{try{const n=Ee(Oe(fe,$A),Se("status","in",["activo","mantenimiento"]),jn("name","asc")),e=await mt(n),t=[];return e.forEach(i=>{t.push({id:i.id,...i.data()})}),t}catch(n){throw console.error("❌ Error al obtener vehículos para mantenimiento:",n),new Error(`Error al obtener vehículos para mantenimiento: ${n.message}`)}},Tf=n=>parseInt(n)+iy.OIL_CHANGE_HOURS,JA=n=>{const e=new Date(n);return e.setMonth(e.getMonth()+iy.BATTERY_LIFETIME_MONTHS),e},ew=async(n,e)=>{try{const t=Ee(Oe(fe,$A),Se("vehicleId","==",n)),i=await mt(t);if(!i.empty){const o=i.docs[0],c=o.data();if(c.hasHourMeter&&c.type==="tractor"){const d=parseInt(c.currentHours)||0,f=parseInt(e)||0;f>d&&(await Ts(o.ref,{currentHours:f,lastHourMeterDate:Ue(),updatedAt:Ue()}),console.log(`✅ Horómetro actualizado para ${n}: ${d} → ${f}`))}}}catch(t){console.error("❌ Error al actualizar horómetro del vehículo:",t)}},NV=n=>{const e=[];if(n.type||e.push("El tipo de mantenimiento es obligatorio"),n.vehicleId||e.push("El vehículo es obligatorio"),n.date||e.push("La fecha es obligatoria"),n.type===me.OIL_CHANGE&&((!n.quantity||n.quantity<=0)&&e.push("La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!n.currentHours||n.currentHours<0)&&e.push("La lectura del horómetro es obligatoria")),n.type===me.BATTERY_CHANGE&&(n.batteryType||e.push("El tipo de batería es obligatorio"),(!n.cost||n.cost<=0)&&e.push("El costo de la batería es obligatorio")),e.length>0)throw new Error(e.join(", "))},_V=n=>{const e=[];if(n.type&&!Object.values(me).includes(n.type)&&e.push("Tipo de mantenimiento inválido"),n.status&&!Object.values(Pe).includes(n.status)&&e.push("Estado de mantenimiento inválido"),n.batteryStatus&&!Object.values(Go).includes(n.batteryStatus)&&e.push("Estado de batería inválido"),e.length>0)throw new Error(e.join(", "))},EV=Object.freeze(Object.defineProperty({__proto__:null,BATTERY_STATUS:Go,MAINTENANCE_CONSTANTS:iy,MAINTENANCE_STATUS:Pe,MAINTENANCE_TYPES:me,calculateNextBatteryChange:JA,calculateNextOilChange:Tf,createMaintenanceRecord:YA,deleteMaintenanceRecord:bV,getAllMaintenanceRecords:QA,getMaintenanceStats:XA,getVehiclesForMaintenance:ZA,subscribeToMaintenance:WA,updateMaintenanceRecord:KA},Symbol.toStringTag,{value:"Module"})),TV=({stats:n})=>{if(!n)return null;const e=c=>{switch(c){case me.OIL_CHANGE:return"🛢️";case me.BATTERY_CHANGE:return"🔋";case me.FILTER_CHANGE:return"🔧";case me.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},t=c=>{switch(c){case me.OIL_CHANGE:return"Cambios de Aceite";case me.BATTERY_CHANGE:return"Cambios de Batería";case me.FILTER_CHANGE:return"Cambios de Filtros";case me.GENERAL_MAINTENANCE:return"Mantenimientos Generales";default:return c}},i=c=>{switch(c){case Pe.COMPLETED:return"#10b981";case Pe.PENDING:return"#f59e0b";case Pe.CANCELLED:return"#ef4444";default:return"#6b7280"}},o=c=>{switch(c){case Pe.COMPLETED:return"Completados";case Pe.PENDING:return"Pendientes";case Pe.CANCELLED:return"Cancelados";default:return c}};return a.jsxs("div",{className:"maintenance-stats",children:[a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card primary",children:[a.jsx("div",{className:"stat-icon",children:"🔧"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:ke(n.total)}),a.jsx("p",{children:"Total Mantenimientos"})]})]}),a.jsxs("div",{className:"stat-card success",children:[a.jsx("div",{className:"stat-icon",children:"💰"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:Dn(n.totalCost)}),a.jsx("p",{children:"Costo Total"})]})]}),a.jsxs("div",{className:"stat-card warning",children:[a.jsx("div",{className:"stat-icon",children:"⏰"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:ke(n.upcomingCount)}),a.jsx("p",{children:"Próximos"})]})]}),a.jsxs("div",{className:"stat-card danger",children:[a.jsx("div",{className:"stat-icon",children:"⚠️"}),a.jsxs("div",{className:"stat-content",children:[a.jsx("h3",{children:ke(n.overdueCount)}),a.jsx("p",{children:"Vencidos"})]})]})]}),Object.keys(n.byType).length>0&&a.jsxs("div",{className:"stats-breakdown",children:[a.jsx("h3",{children:"📊 Desglose por Tipo"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([c,d])=>a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"breakdown-icon",children:e(c)}),a.jsx("span",{className:"breakdown-label",children:t(c)})]}),a.jsx("div",{className:"breakdown-value",children:ke(d)}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:"#3b82f6"}})}),a.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),Object.keys(n.byStatus).length>0&&a.jsxs("div",{className:"stats-breakdown",children:[a.jsx("h3",{children:"📈 Desglose por Estado"}),a.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([c,d])=>a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-header",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:i(c)}}),a.jsx("span",{className:"breakdown-label",children:o(c)})]}),a.jsx("div",{className:"breakdown-value",children:ke(d)}),a.jsx("div",{className:"breakdown-bar",children:a.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:i(c)}})}),a.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),a.jsxs("div",{className:"stats-insights",children:[a.jsx("h3",{children:"💡 Insights"}),a.jsxs("div",{className:"insights-grid",children:[a.jsxs("div",{className:"insight-item",children:[a.jsx("span",{className:"insight-label",children:"Costo Promedio:"}),a.jsx("span",{className:"insight-value",children:Dn(n.averageCost)})]}),n.overdueCount>0&&a.jsxs("div",{className:"insight-item alert",children:[a.jsx("span",{className:"insight-label",children:"⚠️ Mantenimientos Vencidos:"}),a.jsxs("span",{className:"insight-value",children:[ke(n.overdueCount)," requieren atención"]})]}),n.upcomingCount>0&&a.jsxs("div",{className:"insight-item info",children:[a.jsx("span",{className:"insight-label",children:"⏰ Próximos Mantenimientos:"}),a.jsxs("span",{className:"insight-value",children:[ke(n.upcomingCount)," programados"]})]})]})]})]})},jV=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:i,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const p=w=>{switch(w){case me.OIL_CHANGE:return"Cambio de Aceite";case me.BATTERY_CHANGE:return"Cambio de Batería";case me.FILTER_CHANGE:return"Cambio de Filtros";case me.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return w}},g=w=>{switch(w){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return w}},y=(w,b)=>{e({[w]:b})},N=w=>{e(w)},j=()=>Object.values(n).some(w=>w!=="")||i;return a.jsx("div",{className:"maintenance-filters",children:a.jsxs("div",{className:"filters-main",children:[a.jsx("div",{className:"search-section",children:a.jsxs("div",{className:"search-box",children:[a.jsx("span",{className:"search-icon",children:"🔍"}),a.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar mantenimientos...",value:i,onChange:w=>o(w.target.value)}),i&&a.jsx("button",{className:"search-clear",onClick:()=>o(""),children:"×"})]})}),a.jsxs("div",{className:"filters-controls",children:[a.jsxs("div",{className:"quick-filters",children:[a.jsx("button",{className:`quick-filter ${j()?"":"active"}`,onClick:()=>t(),children:"Todos"}),a.jsx("button",{className:`quick-filter ${n.type===me.OIL_CHANGE?"active":""}`,onClick:()=>N({type:me.OIL_CHANGE}),children:"🛢️ Aceite"}),a.jsx("button",{className:`quick-filter ${n.type===me.BATTERY_CHANGE?"active":""}`,onClick:()=>N({type:me.BATTERY_CHANGE}),children:"🔋 Baterías"}),a.jsx("button",{className:`quick-filter ${n.status===Pe.PENDING?"active":""}`,onClick:()=>N({status:Pe.PENDING}),children:"⏰ Pendientes"})]}),a.jsxs("button",{className:`btn-advanced-filters ${j()?"active":""}`,onClick:()=>document.querySelector(".filters-advanced").classList.toggle("show"),children:["🔧 Filtros Avanzados",j()&&a.jsx("span",{className:"filters-count",children:Object.values(n).filter(w=>w!=="").length})]}),a.jsxs("div",{className:"view-modes",children:[a.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),children:"📋 Cards"}),a.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),children:"📊 Tabla"})]})]}),a.jsxs("div",{className:"filters-advanced",children:[a.jsxs("div",{className:"filters-grid",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Tipo de Mantenimiento"}),a.jsxs("select",{value:n.type,onChange:w=>y("type",w.target.value),children:[a.jsx("option",{value:"",children:"Todos los tipos"}),a.jsx("option",{value:me.OIL_CHANGE,children:p(me.OIL_CHANGE)}),a.jsx("option",{value:me.BATTERY_CHANGE,children:p(me.BATTERY_CHANGE)}),a.jsx("option",{value:me.FILTER_CHANGE,children:p(me.FILTER_CHANGE)}),a.jsx("option",{value:me.GENERAL_MAINTENANCE,children:p(me.GENERAL_MAINTENANCE)})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Estado"}),a.jsxs("select",{value:n.status,onChange:w=>y("status",w.target.value),children:[a.jsx("option",{value:"",children:"Todos los estados"}),a.jsx("option",{value:Pe.COMPLETED,children:g(Pe.COMPLETED)}),a.jsx("option",{value:Pe.PENDING,children:g(Pe.PENDING)}),a.jsx("option",{value:Pe.CANCELLED,children:g(Pe.CANCELLED)})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Fecha Desde"}),a.jsx("input",{type:"date",value:n.dateFrom,onChange:w=>y("dateFrom",w.target.value)})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{children:"Fecha Hasta"}),a.jsx("input",{type:"date",value:n.dateTo,onChange:w=>y("dateTo",w.target.value)})]})]}),a.jsx("div",{className:"filters-actions",children:a.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:!j(),children:"🗑️ Limpiar Filtros"})})]}),a.jsxs("div",{className:"filters-info",children:[a.jsxs("div",{className:"results-count",children:[f," mantenimiento",f!==1?"s":""," encontrado",f!==1?"s":""]}),j()&&a.jsxs("div",{className:"active-filters",children:[a.jsx("span",{className:"filters-label",children:"Filtros activos:"}),a.jsxs("div",{className:"filter-tags",children:[n.type&&a.jsxs("span",{className:"filter-tag",children:["Tipo: ",p(n.type),a.jsx("button",{onClick:()=>y("type",""),children:"×"})]}),n.status&&a.jsxs("span",{className:"filter-tag",children:["Estado: ",g(n.status),a.jsx("button",{onClick:()=>y("status",""),children:"×"})]}),n.dateFrom&&a.jsxs("span",{className:"filter-tag",children:["Desde: ",n.dateFrom,a.jsx("button",{onClick:()=>y("dateFrom",""),children:"×"})]}),n.dateTo&&a.jsxs("span",{className:"filter-tag",children:["Hasta: ",n.dateTo,a.jsx("button",{onClick:()=>y("dateTo",""),children:"×"})]}),i&&a.jsxs("span",{className:"filter-tag",children:['Búsqueda: "',i,'"',a.jsx("button",{onClick:()=>o(""),children:"×"})]})]})]})]})]})})},AV=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:i,userRole:o})=>{const c=b=>b?new Date(b).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"N/A",d=b=>{if(!b)return"";const A=new Date,E=new Date(b),D=Math.abs(A-E),q=Math.ceil(D/(1e3*60*60*24));return q===0?"Hoy":q===1?"Ayer":q<7?`Hace ${q} días`:q<30?`Hace ${Math.floor(q/7)} semanas`:`Hace ${Math.floor(q/30)} meses`},f=b=>{switch(b){case me.OIL_CHANGE:return"maintenance-oil-change";case me.BATTERY_CHANGE:return"maintenance-battery-change";case me.FILTER_CHANGE:return"maintenance-filter-change";case me.GENERAL_MAINTENANCE:return"maintenance-general";default:return"maintenance-general"}},p=b=>{switch(b){case Pe.COMPLETED:return"status-completado";case Pe.PENDING:return"status-pendiente";case Pe.CANCELLED:return"status-cancelado";default:return"status-unknown"}},g=b=>{switch(b){case me.OIL_CHANGE:return"🛢️";case me.BATTERY_CHANGE:return"🔋";case me.FILTER_CHANGE:return"🔧";case me.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},y=b=>{switch(b){case me.OIL_CHANGE:return"Cambio de Aceite";case me.BATTERY_CHANGE:return"Cambio de Batería";case me.FILTER_CHANGE:return"Cambio de Filtros";case me.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return b}},N=b=>{switch(b){case Pe.COMPLETED:return"✅";case Pe.PENDING:return"⏰";case Pe.CANCELLED:return"❌";default:return"❓"}},j=b=>{switch(b){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return b}},w=o==="admin"||o==="supervisor";return a.jsx("div",{className:"maintenance-cards",children:n.map(b=>a.jsxs("div",{className:`maintenance-card ${f(b.type)}`,children:[a.jsxs("div",{className:"card-header",children:[a.jsxs("div",{className:"maintenance-type",children:[a.jsx("span",{className:"type-icon",children:g(b.type)}),a.jsx("span",{className:"type-label",children:y(b.type)})]}),a.jsxs("div",{className:`status-badge ${p(b.status)}`,children:[N(b.status)," ",j(b.status)]})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"vehicle-info",children:[a.jsx("span",{className:"vehicle-icon",children:"🚜"}),a.jsxs("div",{className:"vehicle-details",children:[a.jsx("div",{className:"vehicle-name",children:b.vehicleName}),a.jsx("div",{className:"vehicle-id",children:b.vehicleId})]})]}),a.jsxs("div",{className:"date-info",children:[a.jsx("div",{className:"created-date",children:c(b.date)}),a.jsx("div",{className:"relative-time",children:d(b.date)})]}),b.type===me.OIL_CHANGE&&a.jsxs("div",{className:"oil-change-info",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Cantidad:"}),a.jsxs("span",{className:"info-value",children:[ke(b.quantity)," galones"]})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Horómetro:"}),a.jsxs("span",{className:"info-value",children:[ke(b.currentHours)," horas"]})]}),b.nextChangeHours&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Próximo cambio:"}),a.jsxs("span",{className:"info-value",children:[ke(b.nextChangeHours)," horas"]})]}),b.filters&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Filtros:"}),a.jsx("span",{className:"info-value",children:b.filters})]})]}),b.type===me.BATTERY_CHANGE&&a.jsxs("div",{className:"battery-change-info",children:[a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Tipo:"}),a.jsx("span",{className:"info-value",children:b.batteryType})]}),b.brand&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Marca:"}),a.jsx("span",{className:"info-value",children:b.brand})]}),b.model&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Modelo:"}),a.jsx("span",{className:"info-value",children:b.model})]}),a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Estado:"}),a.jsx("span",{className:"info-value",children:b.batteryStatus})]}),b.cost&&a.jsxs("div",{className:"info-row",children:[a.jsx("span",{className:"info-label",children:"Costo:"}),a.jsx("span",{className:"info-value",children:Dn(b.cost)})]})]}),b.notes&&a.jsxs("div",{className:"notes-section",children:[a.jsx("span",{className:"notes-label",children:"Notas:"}),a.jsx("p",{className:"notes-text",children:b.notes})]})]}),a.jsx("div",{className:"card-footer",children:a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{className:"btn-view",onClick:()=>t(b),title:"Ver detalles",children:"👁️ Ver"}),w&&e&&a.jsx("button",{className:"btn-edit",onClick:()=>e(b),title:"Editar",children:"✏️ Editar"}),w&&i&&a.jsx("button",{className:"btn-delete",onClick:()=>i(b.id),title:"Eliminar",children:"🗑️ Eliminar"})]})})]},b.id))})},wV=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:i,userRole:o})=>{const[c,d]=G.useState("date"),[f,p]=G.useState("desc"),g=U=>U?new Date(U).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",y=U=>{switch(U){case me.OIL_CHANGE:return"🛢️";case me.BATTERY_CHANGE:return"🔋";case me.FILTER_CHANGE:return"🔧";case me.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},N=U=>{switch(U){case me.OIL_CHANGE:return"Cambio de Aceite";case me.BATTERY_CHANGE:return"Cambio de Batería";case me.FILTER_CHANGE:return"Cambio de Filtros";case me.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return U}},j=U=>{switch(U){case Pe.COMPLETED:return"✅";case Pe.PENDING:return"⏰";case Pe.CANCELLED:return"❌";default:return"❓"}},w=U=>{switch(U){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return U}},b=U=>{switch(U){case Pe.COMPLETED:return"status-completado";case Pe.PENDING:return"status-pendiente";case Pe.CANCELLED:return"status-cancelado";default:return"status-unknown"}},A=U=>{c===U?p(f==="asc"?"desc":"asc"):(d(U),p("asc"))},E=U=>c!==U?"↕️":f==="asc"?"↑":"↓",D=[...n].sort((U,P)=>{let F=U[c],$=P[c];return c==="date"&&(F=new Date(F),$=new Date($)),["quantity","currentHours","nextChangeHours","cost"].includes(c)&&(F=parseFloat(F)||0,$=parseFloat($)||0),typeof F=="string"&&(F=F.toLowerCase(),$=$.toLowerCase()),f==="asc"?F>$?1:-1:F<$?1:-1}),q=o==="admin"||o==="supervisor";return a.jsxs("div",{className:"maintenance-table-container",children:[a.jsx("div",{className:"table-wrapper",children:a.jsxs("table",{className:"maintenance-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{className:"sortable",onClick:()=>A("type"),children:["Tipo ",E("type")]}),a.jsxs("th",{className:"sortable",onClick:()=>A("vehicleName"),children:["Vehículo ",E("vehicleName")]}),a.jsxs("th",{className:"sortable",onClick:()=>A("date"),children:["Fecha ",E("date")]}),a.jsx("th",{children:"Detalles"}),a.jsxs("th",{className:"sortable",onClick:()=>A("status"),children:["Estado ",E("status")]}),a.jsxs("th",{className:"sortable text-right",onClick:()=>A("cost"),children:["Costo ",E("cost")]}),a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:D.map(U=>a.jsxs("tr",{className:"maintenance-row",children:[a.jsx("td",{className:"type-cell",children:a.jsxs("div",{className:"type-content",children:[a.jsx("span",{className:"type-icon",children:y(U.type)}),a.jsx("span",{className:"type-name",children:N(U.type)})]})}),a.jsx("td",{className:"vehicle-cell",children:a.jsxs("div",{className:"vehicle-info",children:[a.jsx("div",{className:"vehicle-name",children:U.vehicleName}),a.jsx("div",{className:"vehicle-id",children:U.vehicleId})]})}),a.jsx("td",{className:"date-cell",children:a.jsx("div",{className:"date-content",children:a.jsx("div",{className:"date-value",children:g(U.date)})})}),a.jsxs("td",{className:"details-cell",children:[U.type===me.OIL_CHANGE&&a.jsxs("div",{className:"oil-details",children:[a.jsxs("div",{children:["Qty: ",ke(U.quantity)," gal"]}),a.jsxs("div",{children:["Hrs: ",ke(U.currentHours)]}),U.filters&&a.jsxs("div",{children:["Filtros: ",U.filters]})]}),U.type===me.BATTERY_CHANGE&&a.jsxs("div",{className:"battery-details",children:[a.jsx("div",{children:U.batteryType}),U.brand&&a.jsx("div",{children:U.brand}),a.jsxs("div",{children:["Estado: ",U.batteryStatus]})]}),U.notes&&a.jsx("div",{className:"notes-small",children:U.notes})]}),a.jsx("td",{className:"status-cell",children:a.jsxs("div",{className:`status-badge ${b(U.status)}`,children:[j(U.status)," ",w(U.status)]})}),a.jsx("td",{className:"cost-cell text-right",children:U.cost?Dn(U.cost):"N/A"}),a.jsx("td",{className:"actions-cell",children:a.jsxs("div",{className:"action-buttons",children:[a.jsx("button",{className:"btn-action btn-view",onClick:()=>t(U),title:"Ver detalles",children:"👁️"}),q&&e&&a.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(U),title:"Editar",children:"✏️"}),q&&i&&a.jsx("button",{className:"btn-action btn-delete",onClick:()=>i(U.id),title:"Eliminar",children:"🗑️"})]})})]},U.id))})]})}),a.jsxs("div",{className:"table-info",children:[a.jsx("div",{className:"table-summary",children:a.jsxs("span",{className:"total-rows",children:[n.length," mantenimiento",n.length!==1?"s":""," en total"]})}),a.jsxs("div",{className:"table-legend",children:[a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot oil-change"}),a.jsx("span",{children:"Cambio de Aceite"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot battery-change"}),a.jsx("span",{children:"Cambio de Batería"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot filter-change"}),a.jsx("span",{children:"Cambio de Filtros"})]}),a.jsxs("div",{className:"legend-item",children:[a.jsx("span",{className:"legend-dot general"}),a.jsx("span",{children:"Mantenimiento General"})]})]})]})]})},CV=({maintenanceRecords:n,viewMode:e,onEdit:t,onView:i,onDelete:o,userRole:c})=>!n||n.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:"🔧"}),a.jsx("h3",{children:"No hay mantenimientos registrados"}),a.jsx("p",{children:"Comienza creando el primer mantenimiento para tu flota de vehículos."})]}):a.jsx("div",{className:"maintenance-list",children:e==="cards"?a.jsx(AV,{maintenanceRecords:n,onEdit:t,onView:i,onDelete:o,userRole:c}):a.jsx(wV,{maintenanceRecords:n,onEdit:t,onView:i,onDelete:o,userRole:c})}),SV=({isOpen:n,onClose:e,onSuccess:t,maintenance:i,mode:o="create",userRole:c})=>{const d=()=>({type:i?.type||me.OIL_CHANGE,vehicleId:i?.vehicleId||"",vehicleName:i?.vehicleName||"",date:i?.date?new Date(i.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:i?.status||Pe.COMPLETED,quantity:i?.quantity||0,currentHours:i?.currentHours||0,nextChangeHours:i?.nextChangeHours||0,filters:i?.filters||"",batteryType:i?.batteryType||"",brand:i?.brand||"",model:i?.model||"",batteryStatus:i?.batteryStatus||Go.NEW,notes:i?.notes||"",cost:i?.cost||0}),[f,p]=G.useState(d()),[g,y]=G.useState({}),[N,j]=G.useState(!1),[w,b]=G.useState([]);G.useEffect(()=>{n&&(async()=>{try{const $=await ZA();b($)}catch($){console.error("Error al cargar vehículos:",$)}})()},[n]),G.useEffect(()=>{n&&(p(d()),y({}))},[n,i,w]),G.useEffect(()=>{if(f.type===me.OIL_CHANGE&&f.currentHours>0){const F=Tf(f.currentHours);p($=>({...$,nextChangeHours:F}))}},[f.currentHours,f.type]);const A=(F,$)=>{const L=typeof $=="number"?parseFloat($)||0:$;p(S=>({...S,[F]:L})),g[F]&&y(S=>({...S,[F]:null}))},E=F=>{const $=w.find(L=>L.vehicleId===F);p(L=>({...L,vehicleId:F,vehicleName:$?$.name:""})),$&&$.hasHourMeter&&$.currentHours&&p(L=>({...L,currentHours:$.currentHours}))},D=()=>{const F={};return f.type||(F.type="El tipo de mantenimiento es obligatorio"),f.vehicleId||(F.vehicleId="El vehículo es obligatorio"),f.date||(F.date="La fecha es obligatoria"),f.type===me.OIL_CHANGE&&((!f.quantity||f.quantity<=0)&&(F.quantity="La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!f.currentHours||f.currentHours<0)&&(F.currentHours="La lectura del horómetro es obligatoria")),f.type===me.BATTERY_CHANGE&&(f.batteryType||(F.batteryType="El tipo de batería es obligatorio"),(!f.cost||f.cost<=0)&&(F.cost="El costo de la batería es obligatorio")),y(F),Object.keys(F).length===0},q=async F=>{if(F.preventDefault(),!!D()){j(!0);try{const $={...f,date:new Date(f.date),createdBy:c||"user"};o==="create"?(await YA($),console.log("✅ Mantenimiento creado exitosamente")):o==="edit"&&(await KA(i.id,$),console.log("✅ Mantenimiento actualizado exitosamente")),t()}catch($){console.error("❌ Error al guardar mantenimiento:",$),alert("Error al guardar mantenimiento: "+$.message)}finally{j(!1)}}},U=()=>{switch(o){case"create":return"Crear Mantenimiento";case"edit":return"Editar Mantenimiento";case"view":return"Ver Mantenimiento";default:return"Mantenimiento"}},P=F=>{switch(F){case me.OIL_CHANGE:return"🛢️";case me.BATTERY_CHANGE:return"🔋";case me.FILTER_CHANGE:return"🔧";case me.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}};return n?a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"modal-content maintenance-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h2",{children:U()}),a.jsx("button",{className:"modal-close",onClick:e,children:"×"})]}),a.jsx("div",{className:"modal-body",children:a.jsxs("form",{onSubmit:q,className:"maintenance-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Tipo de Mantenimiento *"}),a.jsxs("select",{value:f.type,onChange:F=>A("type",F.target.value),disabled:o==="view",children:[a.jsxs("option",{value:me.OIL_CHANGE,children:[P(me.OIL_CHANGE)," Cambio de Aceite"]}),a.jsxs("option",{value:me.BATTERY_CHANGE,children:[P(me.BATTERY_CHANGE)," Cambio de Batería"]}),a.jsxs("option",{value:me.FILTER_CHANGE,children:[P(me.FILTER_CHANGE)," Cambio de Filtros"]}),a.jsxs("option",{value:me.GENERAL_MAINTENANCE,children:[P(me.GENERAL_MAINTENANCE)," Mantenimiento General"]})]}),g.type&&a.jsx("span",{className:"error-text",children:g.type})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Vehículo *"}),a.jsxs("select",{value:f.vehicleId,onChange:F=>E(F.target.value),disabled:o==="view",children:[a.jsx("option",{value:"",children:"Seleccionar vehículo"}),w.map(F=>a.jsxs("option",{value:F.vehicleId,children:[F.vehicleId," - ",F.name," (",F.type,")"]},F.vehicleId))]}),g.vehicleId&&a.jsx("span",{className:"error-text",children:g.vehicleId})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Fecha *"}),a.jsx("input",{type:"date",value:f.date,onChange:F=>A("date",F.target.value),disabled:o==="view"}),g.date&&a.jsx("span",{className:"error-text",children:g.date})]}),f.type===me.OIL_CHANGE&&a.jsxs("div",{className:"maintenance-section",children:[a.jsx("h3",{children:"🛢️ Información del Cambio de Aceite"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Cantidad (galones) *"}),a.jsx("input",{type:"number",step:"0.1",value:f.quantity,onChange:F=>A("quantity",F.target.value),disabled:o==="view"}),g.quantity&&a.jsx("span",{className:"error-text",children:g.quantity})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Horómetro Actual *"}),a.jsx("input",{type:"number",value:f.currentHours,onChange:F=>A("currentHours",F.target.value),disabled:o==="view"}),g.currentHours&&a.jsx("span",{className:"error-text",children:g.currentHours})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Próximo Cambio (horas)"}),a.jsx("input",{type:"number",value:f.nextChangeHours,disabled:!0,className:"readonly-input"}),a.jsx("small",{children:"Calculado automáticamente: actual + 250 horas"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Filtros o Extras"}),a.jsx("textarea",{value:f.filters,onChange:F=>A("filters",F.target.value),disabled:o==="view",placeholder:"Especificar filtros cambiados o extras..."})]})]}),f.type===me.BATTERY_CHANGE&&a.jsxs("div",{className:"maintenance-section",children:[a.jsx("h3",{children:"🔋 Información del Cambio de Batería"}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Tipo de Batería *"}),a.jsx("input",{type:"text",value:f.batteryType,onChange:F=>A("batteryType",F.target.value),disabled:o==="view",placeholder:"Ej: 12V 60Ah"}),g.batteryType&&a.jsx("span",{className:"error-text",children:g.batteryType})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Estado *"}),a.jsxs("select",{value:f.batteryStatus,onChange:F=>A("batteryStatus",F.target.value),disabled:o==="view",children:[a.jsx("option",{value:Go.NEW,children:"Nueva"}),a.jsx("option",{value:Go.USED,children:"Usada"}),a.jsx("option",{value:Go.REPAIRED,children:"Reparada"})]})]})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Marca"}),a.jsx("input",{type:"text",value:f.brand,onChange:F=>A("brand",F.target.value),disabled:o==="view",placeholder:"Ej: Bosch, Exide"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Modelo"}),a.jsx("input",{type:"text",value:f.model,onChange:F=>A("model",F.target.value),disabled:o==="view",placeholder:"Ej: S4 005"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Costo *"}),a.jsx("input",{type:"number",step:"1000",value:f.cost,onChange:F=>A("cost",F.target.value),disabled:o==="view",placeholder:"0"}),g.cost&&a.jsx("span",{className:"error-text",children:g.cost})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Notas Adicionales"}),a.jsx("textarea",{value:f.notes,onChange:F=>A("notes",F.target.value),disabled:o==="view",placeholder:"Observaciones adicionales...",rows:"3"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Estado"}),a.jsxs("select",{value:f.status,onChange:F=>A("status",F.target.value),disabled:o==="view",children:[a.jsx("option",{value:Pe.COMPLETED,children:"Completado"}),a.jsx("option",{value:Pe.PENDING,children:"Pendiente"}),a.jsx("option",{value:Pe.CANCELLED,children:"Cancelado"})]})]})]})}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:N,children:"Cancelar"}),o!=="view"&&a.jsx("button",{type:"submit",className:"btn btn-primary",onClick:q,disabled:N,children:N?"Guardando...":o==="create"?"Crear":"Actualizar"})]})]})}):null},IV=()=>{const{user:n,userProfile:e}=js(),[t,i]=G.useState([]),[o,c]=G.useState(null),[d,f]=G.useState(!0),[p,g]=G.useState(null),[y,N]=G.useState({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),[j,w]=G.useState("cards"),[b,A]=G.useState(""),[E,D]=G.useState(!1),[q,U]=G.useState(null),[P,F]=G.useState("create");G.useEffect(()=>{if(!n)return;f(!0);const Y=WA((te,le)=>{if(le){console.error("Error en suscripción de mantenimientos:",le),g("Error al cargar mantenimientos"),f(!1);return}i(te),g(null),f(!1)},y);return()=>Y()},[n,y]),G.useEffect(()=>{n&&(async()=>{try{const te=await XA(y);c(te)}catch(te){console.error("Error al cargar estadísticas:",te)}})()},[n,t,y]);const $=t.filter(Y=>{if(!b)return!0;const te=b.toLowerCase();return Y.vehicleName?.toLowerCase().includes(te)||Y.type?.toLowerCase().includes(te)||Y.status?.toLowerCase().includes(te)||Y.notes?.toLowerCase().includes(te)}),L=e?.combustiblesPermissions?.canManageMaintenance||!1,S=()=>{U(null),F("create"),D(!0)},k=Y=>{U(Y),F("edit"),D(!0)},O=Y=>{U(Y),F("view"),D(!0)},C=()=>{D(!1),U(null)},R=()=>{D(!1),U(null)},V=Y=>{N(te=>({...te,...Y}))},ye=()=>{N({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),A("")},Ie=async Y=>{if(!L){alert("No tienes permisos para eliminar mantenimientos");return}if(window.confirm("¿Estás seguro de que quieres eliminar este mantenimiento?"))try{const{deleteMaintenanceRecord:te}=await sy(async()=>{const{deleteMaintenanceRecord:le}=await Promise.resolve().then(()=>EV);return{deleteMaintenanceRecord:le}},void 0);await te(Y),console.log("✅ Mantenimiento eliminado exitosamente")}catch(te){console.error("❌ Error al eliminar mantenimiento:",te),alert("Error al eliminar mantenimiento: "+te.message)}};return n?a.jsxs("div",{className:"maintenance-main",children:[a.jsxs("div",{className:"maintenance-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h2",{children:"🔧 Mantenimiento de Vehículos"}),a.jsx("p",{children:"Gestión de cambios de aceite, filtros y baterías"})]}),a.jsx("div",{className:"header-actions",children:L&&a.jsx("button",{className:"btn-create-maintenance",onClick:S,children:"➕ Crear Mantenimiento"})})]}),d&&a.jsxs("div",{className:"maintenance-loading",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando mantenimientos..."})]}),p&&a.jsxs("div",{className:"error-banner",children:[a.jsxs("span",{children:["❌ ",p]}),a.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]}),o&&a.jsx(TV,{stats:o}),a.jsx(jV,{filters:y,onFilterChange:V,onClearFilters:ye,searchTerm:b,onSearchChange:A,viewMode:j,onViewModeChange:w,totalResults:$.length}),!d&&!p&&a.jsx(CV,{maintenanceRecords:$,viewMode:j,onEdit:L?k:null,onView:O,onDelete:L?Ie:null,userRole:e?.role}),E&&a.jsx(SV,{isOpen:E,onClose:C,onSuccess:R,maintenance:q,mode:P,userRole:e?.role})]}):a.jsx("div",{className:"maintenance-main",children:a.jsxs("div",{className:"auth-required",children:[a.jsx("h2",{children:"🔐 Autenticación Requerida"}),a.jsx("p",{children:"Debes iniciar sesión para acceder al módulo de mantenimiento."})]})})},RV=({isOpen:n,onClose:e,product:t,mode:i="create",onSave:o,userRole:c})=>{const[d,f]=G.useState({name:"",displayName:"",category:Hs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),[p,g]=G.useState({}),[y,N]=G.useState(!1),j=[{value:"gal",label:"Galones (gal)"},{value:"L",label:"Litros (L)"},{value:"kg",label:"Kilogramos (kg)"},{value:"und",label:"Unidades (und)"}],w={[Hs.COMBUSTIBLE]:["🛢️","🚛","🚗","⛽","🌿"],[Hs.ACEITE]:["🛢️","⚙️","🔧","🚜","🏭"],[Hs.LUBRICANTE]:["🟥","🟡","🔵","⚫","🟤"],[Hs.FLUIDO]:["🛑","💧","🔴","🟢","🔵"]},b=["#FF6B35","#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#E91E63","#795548","#607D8B","#3F51B5"];G.useEffect(()=>{f(t&&(i==="edit"||i==="view")?{name:t.name||"",displayName:t.displayName||"",category:t.category||Hs.COMBUSTIBLE,unit:t.unit||"gal",defaultPrice:t.defaultPrice||0,color:t.color||"#FF6B35",icon:t.icon||"🛢️",description:t.description||"",isActive:t.isActive!==void 0?t.isActive:!0,currentStock:t.currentStock||0,minThreshold:t.minThreshold||10,maxCapacity:t.maxCapacity||1e3}:{name:"",displayName:"",category:Hs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),g({})},[t,i,n]);const A=U=>{const{name:P,value:F,type:$,checked:L}=U.target;f(S=>({...S,[P]:$==="checkbox"?L:F})),p[P]&&g(S=>({...S,[P]:""}))},E=()=>{const U={};return d.name.trim()||(U.name="El nombre es requerido"),d.displayName.trim()||(U.displayName="El nombre de visualización es requerido"),d.category||(U.category="La categoría es requerida"),d.unit||(U.unit="La unidad es requerida"),d.defaultPrice<0&&(U.defaultPrice="El precio debe ser mayor o igual a 0"),d.currentStock<0&&(U.currentStock="El stock debe ser mayor o igual a 0"),d.minThreshold<0&&(U.minThreshold="El umbral mínimo debe ser mayor o igual a 0"),d.maxCapacity<=0&&(U.maxCapacity="La capacidad máxima debe ser mayor a 0"),d.minThreshold>=d.maxCapacity&&(U.minThreshold="El umbral mínimo debe ser menor que la capacidad máxima"),g(U),Object.keys(U).length===0},D=async U=>{if(U.preventDefault(),!!E()){N(!0);try{await o({...d,defaultPrice:parseFloat(d.defaultPrice),currentStock:parseFloat(d.currentStock),minThreshold:parseFloat(d.minThreshold),maxCapacity:parseFloat(d.maxCapacity)}),e()}catch(P){console.error("Error saving product:",P),g({submit:"Error al guardar el producto"})}finally{N(!1)}}};if(!n)return null;const q=["admin","supervisor"].includes(c)&&i!=="view";return a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"modal-content product-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h2",{children:[i==="create"&&"➕ Crear Producto",i==="edit"&&"✏️ Editar Producto",i==="view"&&"👁️ Ver Producto"]}),a.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),a.jsxs("form",{onSubmit:D,className:"modal-body",children:[a.jsx("div",{className:"product-preview",children:a.jsxs("div",{className:"preview-card",children:[a.jsx("div",{className:"preview-icon",style:{color:d.color},children:d.icon}),a.jsxs("div",{className:"preview-info",children:[a.jsx("h3",{children:d.displayName||"Nombre del producto"}),a.jsx("p",{className:"preview-category",children:d.category}),a.jsx("p",{className:"preview-description",children:d.description}),a.jsxs("div",{className:"preview-price",children:["$",new Intl.NumberFormat("es-CO").format(d.defaultPrice)," / ",d.unit]})]})]})}),a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"📝 Información Básica"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Nombre Interno *"}),a.jsx("input",{type:"text",name:"name",value:d.name,onChange:A,disabled:!q,placeholder:"Ej: ACPM, GASOLINA"}),p.name&&a.jsx("span",{className:"error",children:p.name})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Nombre de Visualización *"}),a.jsx("input",{type:"text",name:"displayName",value:d.displayName,onChange:A,disabled:!q,placeholder:"Ej: ACPM 🚛, Gasolina 🚗"}),p.displayName&&a.jsx("span",{className:"error",children:p.displayName})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Categoría *"}),a.jsx("select",{name:"category",value:d.category,onChange:A,disabled:!q,children:Object.values(Hs).map(U=>a.jsx("option",{value:U,children:U},U))}),p.category&&a.jsx("span",{className:"error",children:p.category})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Descripción"}),a.jsx("textarea",{name:"description",value:d.description,onChange:A,disabled:!q,placeholder:"Descripción del producto...",rows:"3"})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"⚙️ Configuración"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Unidad de Medida *"}),a.jsx("select",{name:"unit",value:d.unit,onChange:A,disabled:!q,children:j.map(U=>a.jsx("option",{value:U.value,children:U.label},U.value))}),p.unit&&a.jsx("span",{className:"error",children:p.unit})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Precio por Defecto"}),a.jsx("input",{type:"number",name:"defaultPrice",value:d.defaultPrice,onChange:A,disabled:!q,min:"0",step:"0.01"}),p.defaultPrice&&a.jsx("span",{className:"error",children:p.defaultPrice})]}),a.jsx("div",{className:"form-group",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",name:"isActive",checked:d.isActive,onChange:A,disabled:!q}),"Producto Activo"]})})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"📊 Stock y Umbrales"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Stock Actual"}),a.jsx("input",{type:"number",name:"currentStock",value:d.currentStock,onChange:A,disabled:!q,min:"0",step:"0.01"}),p.currentStock&&a.jsx("span",{className:"error",children:p.currentStock})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Umbral Mínimo"}),a.jsx("input",{type:"number",name:"minThreshold",value:d.minThreshold,onChange:A,disabled:!q,min:"0",step:"0.01"}),p.minThreshold&&a.jsx("span",{className:"error",children:p.minThreshold})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Capacidad Máxima"}),a.jsx("input",{type:"number",name:"maxCapacity",value:d.maxCapacity,onChange:A,disabled:!q,min:"1",step:"0.01"}),p.maxCapacity&&a.jsx("span",{className:"error",children:p.maxCapacity})]})]}),a.jsxs("div",{className:"form-section",children:[a.jsx("h3",{children:"🎨 Apariencia"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Icono"}),a.jsx("div",{className:"icon-selector",children:w[d.category]?.map(U=>a.jsx("button",{type:"button",className:`icon-option ${d.icon===U?"selected":""}`,onClick:()=>f(P=>({...P,icon:U})),disabled:!q,children:U},U))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Color"}),a.jsx("div",{className:"color-selector",children:b.map(U=>a.jsx("button",{type:"button",className:`color-option ${d.color===U?"selected":""}`,style:{backgroundColor:U},onClick:()=>f(P=>({...P,color:U})),disabled:!q},U))})]})]})]}),p.submit&&a.jsx("div",{className:"error-message",children:p.submit})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:y,children:i==="view"?"Cerrar":"Cancelar"}),q&&a.jsx("button",{type:"submit",className:"btn-primary",onClick:D,disabled:y,children:y?"Guardando...":"Guardar"})]})]})})},DV=({products:n})=>{const[e,t]=G.useState([]),[i,o]=G.useState(!0);G.useEffect(()=>{const b=Jv(A=>{t(A),o(!1)},A=>{console.error("Error loading movements for stats:",A),o(!1)});return()=>b()},[]);const c=()=>n.map(A=>{const E=e.filter($=>$.fuelType===A.name||$.fuelType===A.displayName),D=E.filter($=>$.type==="entrada"),q=E.filter($=>$.type==="salida"),U=D.reduce(($,L)=>$+(L.quantity||0),0),P=q.reduce(($,L)=>$+(L.quantity||0),0),F=(A.currentStock||0)*(A.defaultPrice||0);return{...A,totalEntries:U,totalExits:P,totalValue:F,entriesCount:D.length,exitsCount:q.length,stockStatus:d(A)}}),d=b=>{const A=b.currentStock||0,E=b.minThreshold||0,D=b.maxCapacity||1e3;return A===0?"empty":A<=E?"low":A>=D*.9?"high":"normal"},f=b=>{const A={};return Object.values(Hs).forEach(E=>{const D=b.filter(q=>q.category===E);A[E]={totalProducts:D.length,totalStock:D.reduce((q,U)=>q+(U.currentStock||0),0),totalValue:D.reduce((q,U)=>q+U.totalValue,0),totalEntries:D.reduce((q,U)=>q+U.totalEntries,0),totalExits:D.reduce((q,U)=>q+U.totalExits,0),lowStockCount:D.filter(q=>q.stockStatus==="low"||q.stockStatus==="empty").length}}),A};if(i)return a.jsxs("div",{className:"products-stats loading",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando estadísticas..."})]});const p=c(),g=f(p),y=n.length,N=n.filter(b=>b.isActive).length,j=p.reduce((b,A)=>b+A.totalValue,0),w=p.filter(b=>b.stockStatus==="low"||b.stockStatus==="empty").length;return a.jsxs("div",{className:"products-stats",children:[a.jsx("h2",{children:"📊 Estadísticas de Productos"}),a.jsxs("div",{className:"stats-general",children:[a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:"📦"}),a.jsxs("div",{className:"stat-info",children:[a.jsx("h3",{children:ke(y)}),a.jsx("p",{children:"Total Productos"})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:"✅"}),a.jsxs("div",{className:"stat-info",children:[a.jsx("h3",{children:ke(N)}),a.jsx("p",{children:"Productos Activos"})]})]}),a.jsxs("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-icon",children:"💰"}),a.jsxs("div",{className:"stat-info",children:[a.jsx("h3",{children:Dn(j)}),a.jsx("p",{children:"Valor Total Stock"})]})]}),a.jsxs("div",{className:`stat-card ${w>0?"alert":""}`,children:[a.jsx("div",{className:"stat-icon",children:"⚠️"}),a.jsxs("div",{className:"stat-info",children:[a.jsx("h3",{children:ke(w)}),a.jsx("p",{children:"Stock Bajo"})]})]})]}),a.jsxs("div",{className:"stats-categories",children:[a.jsx("h3",{children:"📈 Por Categoría"}),a.jsx("div",{className:"categories-grid",children:Object.entries(g).map(([b,A])=>a.jsxs("div",{className:"category-card",children:[a.jsx("h4",{children:b}),a.jsxs("div",{className:"category-stats",children:[a.jsxs("div",{className:"stat-row",children:[a.jsx("span",{children:"Productos:"}),a.jsx("span",{children:ke(A.totalProducts)})]}),a.jsxs("div",{className:"stat-row",children:[a.jsx("span",{children:"Stock Total:"}),a.jsxs("span",{children:[ke(A.totalStock)," unidades"]})]}),a.jsxs("div",{className:"stat-row",children:[a.jsx("span",{children:"Valor:"}),a.jsx("span",{children:Dn(A.totalValue)})]}),a.jsxs("div",{className:"stat-row",children:[a.jsx("span",{children:"Entradas:"}),a.jsx("span",{className:"positive",children:ke(A.totalEntries)})]}),a.jsxs("div",{className:"stat-row",children:[a.jsx("span",{children:"Salidas:"}),a.jsx("span",{className:"negative",children:ke(A.totalExits)})]}),A.lowStockCount>0&&a.jsxs("div",{className:"stat-row alert",children:[a.jsx("span",{children:"Stock Bajo:"}),a.jsx("span",{children:ke(A.lowStockCount)})]})]})]},b))})]}),a.jsxs("div",{className:"stats-top-products",children:[a.jsx("h3",{children:"🏆 Top Productos por Stock"}),a.jsx("div",{className:"top-products-list",children:p.sort((b,A)=>(A.currentStock||0)-(b.currentStock||0)).slice(0,5).map((b,A)=>a.jsxs("div",{className:"top-product-item",children:[a.jsxs("div",{className:"rank",children:["#",A+1]}),a.jsx("div",{className:"product-icon",style:{color:b.color},children:b.icon}),a.jsxs("div",{className:"product-info",children:[a.jsx("span",{className:"product-name",children:b.displayName}),a.jsxs("span",{className:"product-stock",children:[ke(b.currentStock||0)," ",b.unit]})]}),a.jsx("div",{className:"product-value",children:Dn(b.totalValue)})]},b.id))})]}),w>0&&a.jsxs("div",{className:"stats-alerts",children:[a.jsx("h3",{children:"⚠️ Alertas de Stock"}),a.jsx("div",{className:"alerts-list",children:p.filter(b=>b.stockStatus==="low"||b.stockStatus==="empty").map(b=>a.jsxs("div",{className:`alert-item ${b.stockStatus}`,children:[a.jsx("div",{className:"alert-icon",children:b.stockStatus==="empty"?"🔴":"🟡"}),a.jsxs("div",{className:"alert-info",children:[a.jsx("span",{className:"alert-product",children:b.displayName}),a.jsxs("span",{className:"alert-stock",children:["Stock: ",ke(b.currentStock||0)," ",b.unit,b.stockStatus==="empty"&&" - ¡SIN STOCK!",b.stockStatus==="low"&&` - Mínimo: ${b.minThreshold}`]})]})]},b.id))})]})]})},MV=({userProfile:n})=>{const[e,t]=G.useState([]),[i,o]=G.useState(!0),[c,d]=G.useState(null),[f,p]=G.useState(!1),[g,y]=G.useState(null),[N,j]=G.useState("create"),[w,b]=G.useState(""),[A,E]=G.useState(""),[D,q]=G.useState(!0),U=["admin","supervisor"].includes(n?.role);G.useEffect(()=>{o(!0);const O=QL(C=>{t(C),o(!1),d(null)},C=>{console.error("Error loading products:",C),d("Error cargando productos"),o(!1)});return()=>O()},[]),G.useEffect(()=>{(async()=>{if(console.log("🔍 Debug - Inicializando productos:",{productsLength:e.length,loading:i,canManageProducts:U}),e.length===0&&!i&&U)try{console.log("🚀 Creando productos predefinidos...");const C=zE();console.log("📦 Productos predefinidos:",C);for(const R of C)console.log("➕ Creando producto:",R.name),await Zp({name:R.name,displayName:R.displayName,category:R.category,unit:R.unit,defaultPrice:R.defaultPrice,color:R.color,icon:R.icon,description:R.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});console.log("✅ Productos predefinidos creados exitosamente")}catch(C){console.error("❌ Error inicializando productos:",C)}else console.log("ℹ️ No se inicializan productos:",{reason:e.length>0?"Ya existen productos":i?"Está cargando":U?"Otra razón":"Sin permisos"})})()},[e.length,i,U]);const P=()=>{y(null),j("create"),p(!0)},F=O=>{y(O),j("edit"),p(!0)},$=O=>{y(O),j("view"),p(!0)},L=async O=>{if(window.confirm("¿Estás seguro de que deseas eliminar este producto?"))try{await $L(O)}catch(C){console.error("Error deleting product:",C),alert("Error al eliminar el producto")}},S=async O=>{try{N==="create"?await Zp(O):N==="edit"&&await GL(g.id,O),p(!1)}catch(C){throw console.error("Error saving product:",C),C}},k=e.filter(O=>{const C=O.displayName?.toLowerCase().includes(w.toLowerCase())||O.name?.toLowerCase().includes(w.toLowerCase()),R=!A||O.category===A;return C&&R});return i?a.jsx("div",{className:"products-main",children:a.jsxs("div",{className:"loading-container",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando productos..."})]})}):c?a.jsx("div",{className:"products-main",children:a.jsxs("div",{className:"error-container",children:[a.jsxs("p",{children:["⚠️ ",c]}),a.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})}):a.jsxs("div",{className:"products-main",children:[a.jsxs("div",{className:"products-header",children:[a.jsxs("div",{className:"header-title",children:[a.jsx("h1",{children:"🛢️ Gestión de Productos"}),a.jsx("p",{children:"Administra los tipos de combustibles y productos disponibles"})]}),U&&a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"btn-primary",onClick:P,children:"➕ Agregar Producto"}),a.jsx("button",{className:"btn-secondary",onClick:async()=>{try{console.log("🧪 Forzando creación de productos predefinidos...");const O=zE();for(const C of O)await Zp({name:C.name,displayName:C.displayName,category:C.category,unit:C.unit,defaultPrice:C.defaultPrice,color:C.color,icon:C.icon,description:C.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});alert("Productos predefinidos creados exitosamente")}catch(O){console.error("Error:",O),alert("Error creando productos: "+O.message)}},style:{marginLeft:"10px"},children:"🧪 Crear Predefinidos"})]})]}),D&&a.jsx(DV,{products:e}),a.jsxs("div",{className:"products-filters",children:[a.jsx("div",{className:"filter-group",children:a.jsx("input",{type:"text",placeholder:"🔍 Buscar productos...",value:w,onChange:O=>b(O.target.value),className:"search-input"})}),a.jsx("div",{className:"filter-group",children:a.jsxs("select",{value:A,onChange:O=>E(O.target.value),className:"filter-select",children:[a.jsx("option",{value:"",children:"🏷️ Todas las categorías"}),Object.values(Hs).map(O=>a.jsx("option",{value:O,children:O},O))]})}),a.jsx("div",{className:"filter-group",children:a.jsx("button",{className:`toggle-btn ${D?"active":""}`,onClick:()=>q(!D),children:"📊 Estadísticas"})})]}),a.jsx("div",{className:"products-grid",children:k.map(O=>a.jsxs("div",{className:"product-card",children:[a.jsx("div",{className:"product-icon",style:{color:O.color},children:O.icon}),a.jsxs("div",{className:"product-info",children:[a.jsx("h3",{children:O.displayName}),a.jsx("p",{className:"product-category",children:O.category}),a.jsx("p",{className:"product-description",children:O.description}),a.jsxs("div",{className:"product-stats",children:[a.jsxs("div",{className:"stat",children:[a.jsx("span",{className:"stat-label",children:"Stock:"}),a.jsxs("span",{className:"stat-value",children:[O.currentStock||0," ",O.unit]})]}),a.jsxs("div",{className:"stat",children:[a.jsx("span",{className:"stat-label",children:"Precio:"}),a.jsxs("span",{className:"stat-value",children:["$",new Intl.NumberFormat("es-CO").format(O.defaultPrice||0)]})]})]}),a.jsx("div",{className:`product-status ${O.isActive?"active":"inactive"}`,children:O.isActive?"✅ Activo":"❌ Inactivo"})]}),a.jsxs("div",{className:"product-actions",children:[a.jsx("button",{className:"btn-secondary",onClick:()=>$(O),children:"👁️ Ver"}),U&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"btn-primary",onClick:()=>F(O),children:"✏️ Editar"}),a.jsx("button",{className:"btn-danger",onClick:()=>L(O.id),children:"🗑️ Eliminar"})]})]})]},O.id))}),k.length===0&&a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:"📦"}),a.jsx("h3",{children:"No hay productos"}),a.jsx("p",{children:w||A?"No se encontraron productos con los filtros aplicados.":"Aún no hay productos registrados."}),U&&!w&&!A&&a.jsx("button",{className:"btn-primary",onClick:P,children:"➕ Crear primer producto"})]}),a.jsx(RV,{isOpen:f,onClose:()=>p(!1),product:g,mode:N,onSave:S,userRole:n?.role})]})},OV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:i,hasDeletePermission:o})=>{const[c,d]=G.useState("name"),[f,p]=G.useState("asc"),g=D=>{c===D?p(f==="asc"?"desc":"asc"):(d(D),p("asc"))},y=[...n].sort((D,q)=>{let U=D[c],P=q[c];switch(c){case"rating":U=U||0,P=P||0;break;case"totalOrders":case"totalPurchased":U=U||0,P=P||0;break;case"createdAt":case"lastOrderDate":U=U?U.toDate?U.toDate():new Date(U):new Date(0),P=P?P.toDate?P.toDate():new Date(P):new Date(0);break;default:U=(U||"").toString().toLowerCase(),P=(P||"").toString().toLowerCase()}return U<P?f==="asc"?-1:1:U>P?f==="asc"?1:-1:0}),N=D=>{switch(D){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},j=D=>{switch(D){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},w=D=>D?(D.toDate?D.toDate():new Date(D)).toLocaleDateString("es-CO"):"-",b=D=>{const q=[];for(let U=1;U<=5;U++)q.push(a.jsx("span",{className:`star ${U<=D?"filled":""}`,children:"★"},U));return a.jsx("div",{className:"rating-stars",children:q})},A=D=>!D||D.length===0?a.jsx("span",{className:"no-data",children:"-"}):a.jsxs("div",{className:"fuel-types-cell",children:[D.slice(0,2).map(q=>a.jsx("span",{className:"fuel-badge-sm",children:_n[q]||q},q)),D.length>2&&a.jsxs("span",{className:"fuel-badge-sm more",title:D.slice(2).map(q=>_n[q]||q).join(", "),children:["+",D.length-2]})]}),E=D=>c!==D?"icon-chevrons-up-down":f==="asc"?"icon-chevron-up":"icon-chevron-down";return a.jsxs("div",{className:"suppliers-table-container",children:[a.jsxs("div",{className:"table-wrapper",children:[a.jsxs("table",{className:"suppliers-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{className:`sortable ${c==="name"?"active":""}`,onClick:()=>g("name"),children:[a.jsx("span",{children:"Proveedor"}),a.jsx("i",{className:E("name")})]}),a.jsxs("th",{className:`sortable ${c==="status"?"active":""}`,onClick:()=>g("status"),children:[a.jsx("span",{children:"Estado"}),a.jsx("i",{className:E("status")})]}),a.jsxs("th",{className:`sortable ${c==="category"?"active":""}`,onClick:()=>g("category"),children:[a.jsx("span",{children:"Categoría"}),a.jsx("i",{className:E("category")})]}),a.jsx("th",{children:a.jsx("span",{children:"Combustibles"})}),a.jsx("th",{children:a.jsx("span",{children:"Contacto"})}),a.jsxs("th",{className:`sortable ${c==="rating"?"active":""}`,onClick:()=>g("rating"),children:[a.jsx("span",{children:"Rating"}),a.jsx("i",{className:E("rating")})]}),a.jsxs("th",{className:`sortable ${c==="totalOrders"?"active":""}`,onClick:()=>g("totalOrders"),children:[a.jsx("span",{children:"Órdenes"}),a.jsx("i",{className:E("totalOrders")})]}),a.jsxs("th",{className:`sortable ${c==="totalPurchased"?"active":""}`,onClick:()=>g("totalPurchased"),children:[a.jsx("span",{children:"Total Comprado"}),a.jsx("i",{className:E("totalPurchased")})]}),a.jsxs("th",{className:`sortable ${c==="createdAt"?"active":""}`,onClick:()=>g("createdAt"),children:[a.jsx("span",{children:"Creado"}),a.jsx("i",{className:E("createdAt")})]}),a.jsx("th",{className:"actions-column",children:a.jsx("span",{children:"Acciones"})})]})}),a.jsx("tbody",{children:y.map(D=>a.jsxs("tr",{className:`supplier-row ${D.status}`,children:[a.jsx("td",{className:"supplier-info-cell",children:a.jsxs("div",{className:"supplier-main-info",children:[a.jsxs("div",{className:"supplier-name",children:[D.name,D.isPreferred&&a.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:a.jsx("i",{className:"icon-star"})})]}),D.taxId&&a.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",D.taxId]}),D.type&&a.jsx("div",{className:"supplier-type",children:D.type.charAt(0).toUpperCase()+D.type.slice(1)})]})}),a.jsx("td",{className:"status-cell",children:a.jsxs("div",{className:"status-display",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:N(D.status)}}),a.jsx("span",{className:"status-label",children:j(D.status)})]})}),a.jsx("td",{className:"category-cell",children:a.jsx("span",{className:"category-label",children:D.category?.charAt(0).toUpperCase()+D.category?.slice(1)||"-"})}),a.jsx("td",{className:"fuel-types-cell",children:A(D.fuelTypes)}),a.jsx("td",{className:"contact-cell",children:a.jsxs("div",{className:"contact-info",children:[D.contactPerson&&a.jsxs("div",{className:"contact-person",children:[a.jsx("i",{className:"icon-user"}),a.jsx("span",{children:D.contactPerson})]}),D.phone&&a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-phone"}),a.jsx("a",{href:`tel:${D.phone}`,children:D.phone})]}),D.email&&a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-mail"}),a.jsx("a",{href:`mailto:${D.email}`,children:D.email})]}),D.city&&a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-map-pin"}),a.jsx("span",{children:D.city})]})]})}),a.jsx("td",{className:"rating-cell",children:a.jsxs("div",{className:"rating-display",children:[b(D.rating||0),a.jsx("span",{className:"rating-value",children:(D.rating||0).toFixed(1)})]})}),a.jsx("td",{className:"orders-cell",children:a.jsx("span",{className:"orders-count",children:D.totalOrders||0})}),a.jsx("td",{className:"purchased-cell",children:a.jsx("span",{className:"purchased-amount",children:Dn(D.totalPurchased||0)})}),a.jsx("td",{className:"date-cell",children:a.jsx("span",{className:"date-value",children:w(D.createdAt)})}),a.jsx("td",{className:"actions-cell",children:a.jsxs("div",{className:"action-buttons",children:[i&&a.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(D),title:"Editar proveedor",children:a.jsx("i",{className:"icon-edit"})}),o&&D.status==="active"&&a.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(D.id,D.name),title:"Desactivar proveedor",children:a.jsx("i",{className:"icon-x-circle"})}),a.jsxs("div",{className:"quick-actions",children:[D.phone&&a.jsx("a",{href:`tel:${D.phone}`,className:"quick-action-btn",title:"Llamar",children:a.jsx("i",{className:"icon-phone"})}),D.email&&a.jsx("a",{href:`mailto:${D.email}`,className:"quick-action-btn",title:"Enviar email",children:a.jsx("i",{className:"icon-mail"})})]})]})})]},D.id))})]}),y.length===0&&a.jsxs("div",{className:"table-empty-state",children:[a.jsx("i",{className:"icon-truck"}),a.jsx("p",{children:"No hay proveedores para mostrar"})]})]}),a.jsxs("div",{className:"table-footer",children:[a.jsx("div",{className:"table-info",children:a.jsxs("span",{children:["Mostrando ",y.length," proveedor",y.length!==1?"es":""]})}),a.jsx("div",{className:"table-actions",children:a.jsxs("span",{className:"sort-info",children:["Ordenado por: ",c==="name"?"Nombre":c==="status"?"Estado":c==="category"?"Categoría":c==="rating"?"Rating":c==="totalOrders"?"Órdenes":c==="totalPurchased"?"Total Comprado":c==="createdAt"?"Fecha de Creación":c," (",f==="asc"?"Ascendente":"Descendente",")"]})})]})]})},kV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:i,hasDeletePermission:o})=>{const c=w=>{switch(w){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},d=w=>{switch(w){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},f=w=>{switch(w){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},p=w=>{switch(w){case"proveedor":return"Proveedor";case"distribuidor":return"Distribuidor";case"mayorista":return"Mayorista";default:return"Sin especificar"}},g=w=>w?(w.toDate?w.toDate():new Date(w)).toLocaleDateString("es-CO"):"No disponible",y=w=>{const b=[];for(let A=1;A<=5;A++)b.push(a.jsx("span",{className:`star ${A<=w?"filled":""}`,children:"★"},A));return a.jsx("div",{className:"rating-stars",children:b})},N=w=>!w||w.length===0?a.jsx("span",{className:"no-fuels",children:"Sin combustibles especificados"}):a.jsxs("div",{className:"fuel-types",children:[w.slice(0,3).map(b=>a.jsx("span",{className:"fuel-badge",title:_n[b],children:_n[b]||b},b)),w.length>3&&a.jsxs("span",{className:"fuel-badge more",title:`+${w.length-3} más`,children:["+",w.length-3]})]}),j=w=>{const b=[];return w.phone&&b.push(a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-phone"}),a.jsx("span",{children:w.phone})]},"phone")),w.email&&b.push(a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-mail"}),a.jsx("span",{children:w.email})]},"email")),w.city&&b.push(a.jsxs("div",{className:"contact-item",children:[a.jsx("i",{className:"icon-map-pin"}),a.jsx("span",{children:w.city})]},"city")),b.length>0?b:a.jsxs("div",{className:"contact-item no-contact",children:[a.jsx("i",{className:"icon-info-circle"}),a.jsx("span",{children:"Sin información de contacto"})]})};return a.jsx("div",{className:"suppliers-cards",children:n.map(w=>a.jsxs("div",{className:`supplier-card ${w.status}`,children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"header-left",children:a.jsxs("div",{className:"supplier-info",children:[a.jsxs("h3",{className:"supplier-name",children:[w.name,w.isPreferred&&a.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:a.jsx("i",{className:"icon-star"})})]}),w.taxId&&a.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",w.taxId]})]})}),a.jsx("div",{className:"header-right",children:a.jsxs("div",{className:"supplier-status",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:c(w.status)}}),a.jsx("span",{className:"status-label",children:d(w.status)})]})})]}),a.jsxs("div",{className:"card-content",children:[a.jsxs("div",{className:"supplier-meta",children:[a.jsxs("div",{className:"meta-item",children:[a.jsx("span",{className:"meta-icon",children:f(w.category)}),a.jsx("span",{className:"meta-label",children:w.category?.charAt(0).toUpperCase()+w.category?.slice(1)||"Sin categoría"})]}),a.jsxs("div",{className:"meta-item",children:[a.jsx("i",{className:"icon-building meta-icon"}),a.jsx("span",{className:"meta-label",children:p(w.type)})]})]}),w.contactPerson&&a.jsxs("div",{className:"contact-person",children:[a.jsx("i",{className:"icon-user"}),a.jsx("span",{children:w.contactPerson})]}),a.jsx("div",{className:"contact-info",children:j(w)}),a.jsxs("div",{className:"fuel-types-section",children:[a.jsx("div",{className:"section-label",children:"Combustibles Suministrados:"}),N(w.fuelTypes)]}),a.jsxs("div",{className:"rating-section",children:[a.jsxs("div",{className:"rating-display",children:[y(w.rating||0),a.jsxs("span",{className:"rating-value",children:[(w.rating||0).toFixed(1),"/5"]})]}),w.evaluationNotes&&a.jsxs("div",{className:"evaluation-notes",title:w.evaluationNotes,children:[a.jsx("i",{className:"icon-message-square"}),a.jsx("span",{children:"Con evaluación"})]})]}),w.paymentTerms&&a.jsxs("div",{className:"payment-terms",children:[a.jsx("i",{className:"icon-credit-card"}),a.jsxs("span",{children:["Términos: ",w.paymentTerms==="contado"?"Contado":w.paymentTerms==="30dias"?"30 días":w.paymentTerms==="60dias"?"60 días":w.paymentTerms==="90dias"?"90 días":w.paymentTerms]})]}),a.jsxs("div",{className:"supplier-stats",children:[a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-label",children:"Órdenes:"}),a.jsx("span",{className:"stat-value",children:w.totalOrders||0})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-label",children:"Total Comprado:"}),a.jsx("span",{className:"stat-value",children:Dn(w.totalPurchased||0)})]}),w.lastOrderDate&&a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-label",children:"Última Orden:"}),a.jsx("span",{className:"stat-value",children:g(w.lastOrderDate)})]})]})]}),a.jsxs("div",{className:"card-footer",children:[a.jsx("div",{className:"footer-info",children:a.jsxs("span",{className:"created-date",children:["Creado: ",g(w.createdAt)]})}),a.jsxs("div",{className:"card-actions",children:[i&&a.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(w),title:"Editar proveedor",children:[a.jsx("i",{className:"icon-edit"}),"Editar"]}),o&&w.status==="active"&&a.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>t(w.id,w.name),title:"Desactivar proveedor",children:[a.jsx("i",{className:"icon-x-circle"}),"Desactivar"]}),a.jsxs("div",{className:"quick-actions",children:[w.phone&&a.jsx("a",{href:`tel:${w.phone}`,className:"quick-action-btn",title:"Llamar",children:a.jsx("i",{className:"icon-phone"})}),w.email&&a.jsx("a",{href:`mailto:${w.email}`,className:"quick-action-btn",title:"Enviar email",children:a.jsx("i",{className:"icon-mail"})})]})]})]})]},w.id))})},PV=({supplier:n,onClose:e,onSuccess:t,onError:i})=>{const{userProfile:o}=js(),c=!!n,[d,f]=G.useState({name:"",taxId:"",type:"proveedor",category:"combustibles",contactPerson:"",phone:"",email:"",address:"",city:"",state:"Colombia",fuelTypes:[],paymentTerms:"contado",creditLimit:"",priceList:{},rating:5,evaluationNotes:"",status:"active",isPreferred:!1}),[p,g]=G.useState(!1),[y,N]=G.useState({}),[j,w]=G.useState("basic");G.useEffect(()=>{c&&n&&f({name:n.name||"",taxId:n.taxId||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson||"",phone:n.phone||"",email:n.email||"",address:n.address||"",city:n.city||"",state:n.state||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:n.creditLimit||"",priceList:n.priceList||{},rating:n.rating||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1})},[c,n]);const b=(P,F)=>{f($=>({...$,[P]:F})),y[P]&&N($=>({...$,[P]:null}))},A=P=>{f(F=>({...F,fuelTypes:F.fuelTypes.includes(P)?F.fuelTypes.filter($=>$!==P):[...F.fuelTypes,P]}))},E=(P,F)=>{f($=>({...$,priceList:{...$.priceList,[P]:parseFloat(F)||0}}))},D=()=>{const P={};return d.name.trim()||(P.name="El nombre del proveedor es requerido"),d.category||(P.category="La categoría es requerida"),d.type||(P.type="El tipo de proveedor es requerido"),d.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)&&(P.email="El formato del email no es válido"),d.phone&&!/^[\d\s\-+()]+$/.test(d.phone)&&(P.phone="El formato del teléfono no es válido"),d.creditLimit&&(isNaN(d.creditLimit)||parseFloat(d.creditLimit)<0)&&(P.creditLimit="El límite de crédito debe ser un número positivo"),(d.rating<1||d.rating>5)&&(P.rating="El rating debe estar entre 1 y 5"),d.fuelTypes.forEach(F=>{d.priceList[F]&&(isNaN(d.priceList[F])||parseFloat(d.priceList[F])<0)&&(P[`price_${F}`]=`El precio de ${_n[F]} debe ser un número positivo`)}),N(P),Object.keys(P).length===0},q=async P=>{if(P.preventDefault(),!!D()){g(!0);try{const F={...d,creditLimit:parseFloat(d.creditLimit)||0,rating:parseFloat(d.rating)||5,priceList:Object.fromEntries(Object.entries(d.priceList).filter(([L,S])=>d.fuelTypes.includes(L)&&S>0))};let $;c?$=await AL(n.id,F,o?.email):$=await jL(F,o?.email),$.success?t():i($.error||"Error al guardar proveedor")}catch(F){console.error("Error saving supplier:",F),i("Error inesperado al guardar proveedor")}finally{g(!1)}}},U=[{id:"basic",label:"Información Básica",icon:"icon-info"},{id:"contact",label:"Contacto",icon:"icon-phone"},{id:"products",label:"Productos",icon:"icon-package"},{id:"commercial",label:"Comercial",icon:"icon-credit-card"}];return a.jsx("div",{className:"modal-overlay",onClick:e,children:a.jsxs("div",{className:"modal-container large",onClick:P=>P.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h2",{children:[a.jsx("i",{className:"icon-truck"}),c?"Editar Proveedor":"Nuevo Proveedor"]}),a.jsx("button",{className:"modal-close",onClick:e,children:a.jsx("i",{className:"icon-x"})})]}),a.jsxs("form",{onSubmit:q,children:[a.jsx("div",{className:"modal-tabs",children:U.map(P=>a.jsxs("button",{type:"button",className:`tab-button ${j===P.id?"active":""}`,onClick:()=>w(P.id),children:[a.jsx("i",{className:P.icon}),P.label]},P.id))}),a.jsxs("div",{className:"modal-body",children:[j==="basic"&&a.jsx("div",{className:"tab-content",children:a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"required",children:"Nombre del Proveedor"}),a.jsx("input",{type:"text",value:d.name,onChange:P=>b("name",P.target.value),placeholder:"Ingresa el nombre del proveedor",className:y.name?"error":""}),y.name&&a.jsx("span",{className:"error-message",children:y.name})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"NIT / Documento"}),a.jsx("input",{type:"text",value:d.taxId,onChange:P=>b("taxId",P.target.value),placeholder:"123456789-0",className:y.taxId?"error":""}),y.taxId&&a.jsx("span",{className:"error-message",children:y.taxId})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"required",children:"Tipo de Proveedor"}),a.jsxs("select",{value:d.type,onChange:P=>b("type",P.target.value),className:y.type?"error":"",children:[a.jsx("option",{value:"proveedor",children:"Proveedor"}),a.jsx("option",{value:"distribuidor",children:"Distribuidor"}),a.jsx("option",{value:"mayorista",children:"Mayorista"})]}),y.type&&a.jsx("span",{className:"error-message",children:y.type})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"required",children:"Categoría"}),a.jsxs("select",{value:d.category,onChange:P=>b("category",P.target.value),className:y.category?"error":"",children:[a.jsx("option",{value:"combustibles",children:"Combustibles"}),a.jsx("option",{value:"lubricantes",children:"Lubricantes"}),a.jsx("option",{value:"aditivos",children:"Aditivos"})]}),y.category&&a.jsx("span",{className:"error-message",children:y.category})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Estado"}),a.jsxs("select",{value:d.status,onChange:P=>b("status",P.target.value),children:[a.jsx("option",{value:"active",children:"Activo"}),a.jsx("option",{value:"inactive",children:"Inactivo"}),a.jsx("option",{value:"suspended",children:"Suspendido"})]})]}),a.jsx("div",{className:"form-group checkbox",children:a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:d.isPreferred,onChange:P=>b("isPreferred",P.target.checked)}),a.jsx("span",{className:"checkbox-mark"}),"Proveedor Preferido"]})})]})}),j==="contact"&&a.jsx("div",{className:"tab-content",children:a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Persona de Contacto"}),a.jsx("input",{type:"text",value:d.contactPerson,onChange:P=>b("contactPerson",P.target.value),placeholder:"Nombre del contacto principal"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Teléfono"}),a.jsx("input",{type:"tel",value:d.phone,onChange:P=>b("phone",P.target.value),placeholder:"+57 300 123 4567",className:y.phone?"error":""}),y.phone&&a.jsx("span",{className:"error-message",children:y.phone})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Email"}),a.jsx("input",{type:"email",value:d.email,onChange:P=>b("email",P.target.value),placeholder:"contacto@proveedor.com",className:y.email?"error":""}),y.email&&a.jsx("span",{className:"error-message",children:y.email})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Ciudad"}),a.jsx("input",{type:"text",value:d.city,onChange:P=>b("city",P.target.value),placeholder:"Bogotá"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Estado/País"}),a.jsx("input",{type:"text",value:d.state,onChange:P=>b("state",P.target.value),placeholder:"Colombia"})]}),a.jsxs("div",{className:"form-group full-width",children:[a.jsx("label",{children:"Dirección"}),a.jsx("textarea",{value:d.address,onChange:P=>b("address",P.target.value),placeholder:"Dirección completa del proveedor",rows:"3"})]})]})}),j==="products"&&a.jsxs("div",{className:"tab-content",children:[a.jsxs("div",{className:"section",children:[a.jsx("h3",{children:"Tipos de Combustible que Suministra"}),a.jsx("div",{className:"fuel-types-grid",children:Object.entries(_n).map(([P,F])=>a.jsx("div",{className:"fuel-type-item",children:a.jsxs("label",{className:"checkbox-label",children:[a.jsx("input",{type:"checkbox",checked:d.fuelTypes.includes(P),onChange:()=>A(P)}),a.jsx("span",{className:"checkbox-mark"}),F]})},P))})]}),d.fuelTypes.length>0&&a.jsxs("div",{className:"section",children:[a.jsx("h3",{children:"Precios por Litro (Opcional)"}),a.jsx("div",{className:"prices-grid",children:d.fuelTypes.map(P=>a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:_n[P]}),a.jsxs("div",{className:"input-with-currency",children:[a.jsx("span",{className:"currency-symbol",children:"$"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:d.priceList[P]||"",onChange:F=>E(P,F.target.value),placeholder:"0.00",className:y[`price_${P}`]?"error":""})]}),y[`price_${P}`]&&a.jsx("span",{className:"error-message",children:y[`price_${P}`]})]},P))})]})]}),j==="commercial"&&a.jsx("div",{className:"tab-content",children:a.jsxs("div",{className:"form-grid",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Términos de Pago"}),a.jsxs("select",{value:d.paymentTerms,onChange:P=>b("paymentTerms",P.target.value),children:[a.jsx("option",{value:"contado",children:"Contado"}),a.jsx("option",{value:"30dias",children:"30 días"}),a.jsx("option",{value:"60dias",children:"60 días"}),a.jsx("option",{value:"90dias",children:"90 días"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Límite de Crédito"}),a.jsxs("div",{className:"input-with-currency",children:[a.jsx("span",{className:"currency-symbol",children:"$"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:d.creditLimit,onChange:P=>b("creditLimit",P.target.value),placeholder:"0.00",className:y.creditLimit?"error":""})]}),y.creditLimit&&a.jsx("span",{className:"error-message",children:y.creditLimit})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Rating"}),a.jsxs("div",{className:"rating-input",children:[a.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:d.rating,onChange:P=>b("rating",parseFloat(P.target.value)),className:y.rating?"error":""}),a.jsxs("div",{className:"rating-display",children:[a.jsx("span",{className:"rating-value",children:d.rating.toFixed(1)}),a.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(P=>a.jsx("span",{className:`star ${P<=Math.round(d.rating)?"filled":""}`,children:"★"},P))})]})]}),y.rating&&a.jsx("span",{className:"error-message",children:y.rating})]}),a.jsxs("div",{className:"form-group full-width",children:[a.jsx("label",{children:"Notas de Evaluación"}),a.jsx("textarea",{value:d.evaluationNotes,onChange:P=>b("evaluationNotes",P.target.value),placeholder:"Comentarios sobre el desempeño del proveedor...",rows:"4"})]})]})})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:p,children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"loading-spinner small"}),c?"Actualizando...":"Creando..."]}):a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"icon-save"}),c?"Actualizar Proveedor":"Crear Proveedor"]})})]})]})]})})},LV=({stats:n,suppliersCount:e,totalSuppliers:t})=>{if(!n)return null;const i=d=>{switch(d){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},c=d=>{switch(d){case"proveedor":return"🏪";case"distribuidor":return"🚛";case"mayorista":return"🏭";default:return"🏢"}};return a.jsxs("div",{className:"suppliers-stats",children:[a.jsxs("div",{className:"stats-grid",children:[a.jsxs("div",{className:"stat-card primary",children:[a.jsx("div",{className:"stat-icon",children:a.jsx("i",{className:"icon-truck"})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:ke(n.total)}),a.jsx("div",{className:"stat-label",children:"Total Proveedores"}),t!==e&&a.jsxs("div",{className:"stat-sublabel",children:[ke(e)," mostrados"]})]})]}),a.jsxs("div",{className:"stat-card success",children:[a.jsx("div",{className:"stat-icon",children:a.jsx("i",{className:"icon-check-circle"})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:ke(n.active)}),a.jsx("div",{className:"stat-label",children:"Activos"}),a.jsx("div",{className:"stat-sublabel",children:Er(n.total>0?n.active/n.total:0)})]})]}),a.jsxs("div",{className:"stat-card warning",children:[a.jsx("div",{className:"stat-icon",children:a.jsx("i",{className:"icon-star"})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:ke(n.preferred)}),a.jsx("div",{className:"stat-label",children:"Preferidos"}),a.jsx("div",{className:"stat-sublabel",children:Er(n.active>0?n.preferred/n.active:0)})]})]}),a.jsxs("div",{className:"stat-card info",children:[a.jsx("div",{className:"stat-icon",children:a.jsx("i",{className:"icon-award"})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("div",{className:"stat-value",children:n.averageRating.toFixed(1)}),a.jsx("div",{className:"stat-label",children:"Rating Promedio"}),a.jsx("div",{className:"stat-sublabel",children:a.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(d=>a.jsx("span",{className:`star ${d<=Math.round(n.averageRating)?"filled":""}`,children:"★"},d))})})]})]})]}),a.jsxs("div",{className:"stats-details",children:[a.jsxs("div",{className:"stats-section",children:[a.jsx("h3",{children:"Estado de Proveedores"}),a.jsxs("div",{className:"stats-breakdown",children:[a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-label",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:i("active")}}),"Activos"]}),a.jsx("div",{className:"breakdown-value",children:n.active}),a.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?n.active/n.total:0)})]}),n.inactive>0&&a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-label",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:i("inactive")}}),"Inactivos"]}),a.jsx("div",{className:"breakdown-value",children:n.inactive}),a.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?n.inactive/n.total:0)})]}),n.suspended>0&&a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-label",children:[a.jsx("span",{className:"status-dot",style:{backgroundColor:i("suspended")}}),"Suspendidos"]}),a.jsx("div",{className:"breakdown-value",children:n.suspended}),a.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?n.suspended/n.total:0)})]})]})]}),Object.keys(n.byCategory).length>0&&a.jsxs("div",{className:"stats-section",children:[a.jsx("h3",{children:"Por Categoría"}),a.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byCategory).sort(([,d],[,f])=>f-d).map(([d,f])=>a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-label",children:[a.jsx("span",{className:"category-icon",children:o(d)}),d.charAt(0).toUpperCase()+d.slice(1).replace("_"," ")]}),a.jsx("div",{className:"breakdown-value",children:f}),a.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?f/n.total:0)})]},d))})]}),Object.keys(n.byType).length>0&&a.jsxs("div",{className:"stats-section",children:[a.jsx("h3",{children:"Por Tipo"}),a.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byType).sort(([,d],[,f])=>f-d).map(([d,f])=>a.jsxs("div",{className:"breakdown-item",children:[a.jsxs("div",{className:"breakdown-label",children:[a.jsx("span",{className:"type-icon",children:c(d)}),d.charAt(0).toUpperCase()+d.slice(1)]}),a.jsx("div",{className:"breakdown-value",children:f}),a.jsx("div",{className:"breakdown-percentage",children:Er(n.total>0?f/n.total:0)})]},d))})]})]}),a.jsxs("div",{className:"stats-insights",children:[a.jsx("h3",{children:"Información Rápida"}),a.jsxs("div",{className:"insights-grid",children:[a.jsxs("div",{className:"insight-item",children:[a.jsx("div",{className:"insight-label",children:"Nivel de Satisfacción"}),a.jsx("div",{className:"insight-value",children:n.averageRating>=4.5?"Excelente":n.averageRating>=4?"Muy Bueno":n.averageRating>=3.5?"Bueno":n.averageRating>=3?"Regular":"Necesita Mejora"})]}),a.jsxs("div",{className:"insight-item",children:[a.jsx("div",{className:"insight-label",children:"Estado General"}),a.jsx("div",{className:"insight-value",children:n.active/n.total>=.9?"Excelente":n.active/n.total>=.8?"Bueno":n.active/n.total>=.7?"Regular":"Revisar"})]}),a.jsxs("div",{className:"insight-item",children:[a.jsx("div",{className:"insight-label",children:"Proveedores Preferidos"}),a.jsx("div",{className:"insight-value",children:n.preferred===0?"Ninguno":n.preferred/n.active>=.3?"Suficientes":n.preferred/n.active>=.2?"Buenos":"Pocos"})]}),a.jsxs("div",{className:"insight-item",children:[a.jsx("div",{className:"insight-label",children:"Diversificación"}),a.jsx("div",{className:"insight-value",children:Object.keys(n.byCategory).length>=3?"Alta":Object.keys(n.byCategory).length>=2?"Media":"Baja"})]})]})]})]})},VV=({searchTerm:n,setSearchTerm:e,filterStatus:t,setFilterStatus:i,filterCategory:o,setFilterCategory:c,filterFuelType:d,setFilterFuelType:f,viewMode:p,setViewMode:g,onClearFilters:y,resultsCount:N})=>{const j=[{value:"all",label:"Todos los Estados",icon:"list"},{value:"active",label:"Activos",icon:"check-circle"},{value:"inactive",label:"Inactivos",icon:"x-circle"},{value:"suspended",label:"Suspendidos",icon:"alert-circle"},{value:"preferred",label:"Preferidos",icon:"star"}],w=[{value:"all",label:"Todas las Categorías",icon:"grid"},{value:"combustibles",label:"Combustibles",icon:"fuel"},{value:"lubricantes",label:"Lubricantes",icon:"droplets"},{value:"aditivos",label:"Aditivos",icon:"flask"}],b=[{value:"all",label:"Todos los Combustibles",icon:"fuel"},...Object.entries(_n).map(([E,D])=>({value:E,label:D,icon:"droplet"}))],A=n||t!=="all"||o!=="all"||d!=="all";return a.jsxs("div",{className:"suppliers-filters",children:[a.jsxs("div",{className:"filters-top",children:[a.jsx("div",{className:"search-container",children:a.jsxs("div",{className:"search-input-wrapper",children:[a.jsx("i",{className:"icon-search search-icon"}),a.jsx("input",{type:"text",placeholder:"Buscar por nombre, NIT, contacto, ciudad...",value:n,onChange:E=>e(E.target.value),className:"search-input"}),n&&a.jsx("button",{className:"search-clear",onClick:()=>e(""),title:"Limpiar búsqueda",children:a.jsx("i",{className:"icon-x"})})]})}),a.jsxs("div",{className:"view-controls",children:[a.jsxs("div",{className:"view-mode-toggle",children:[a.jsx("button",{className:`view-btn ${p==="cards"?"active":""}`,onClick:()=>g("cards"),title:"Vista de tarjetas",children:a.jsx("i",{className:"icon-grid"})}),a.jsx("button",{className:`view-btn ${p==="table"?"active":""}`,onClick:()=>g("table"),title:"Vista de tabla",children:a.jsx("i",{className:"icon-list"})})]}),A&&a.jsxs("button",{className:"btn btn-secondary clear-filters",onClick:y,title:"Limpiar todos los filtros",children:[a.jsx("i",{className:"icon-filter-x"}),"Limpiar"]})]})]}),a.jsxs("div",{className:"filters-dropdowns",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{className:"filter-label",children:"Estado"}),a.jsxs("div",{className:"select-wrapper",children:[a.jsx("select",{value:t,onChange:E=>i(E.target.value),className:"filter-select",children:j.map(E=>a.jsx("option",{value:E.value,children:E.label},E.value))}),a.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{className:"filter-label",children:"Categoría"}),a.jsxs("div",{className:"select-wrapper",children:[a.jsx("select",{value:o,onChange:E=>c(E.target.value),className:"filter-select",children:w.map(E=>a.jsx("option",{value:E.value,children:E.label},E.value))}),a.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),a.jsxs("div",{className:"select-wrapper",children:[a.jsx("select",{value:d,onChange:E=>f(E.target.value),className:"filter-select",children:b.map(E=>a.jsx("option",{value:E.value,children:E.label},E.value))}),a.jsx("i",{className:"icon-chevron-down select-arrow"})]})]})]}),a.jsxs("div",{className:"filters-summary",children:[a.jsxs("div",{className:"results-count",children:[a.jsx("i",{className:"icon-info-circle"}),a.jsx("span",{children:N===0?"No se encontraron proveedores":`Mostrando ${N} proveedor${N!==1?"es":""}`})]}),A&&a.jsxs("div",{className:"active-filters",children:[a.jsx("span",{className:"filters-label",children:"Filtros activos:"}),a.jsxs("div",{className:"filter-tags",children:[n&&a.jsxs("span",{className:"filter-tag",children:[a.jsx("i",{className:"icon-search"}),n,a.jsx("button",{onClick:()=>e(""),children:a.jsx("i",{className:"icon-x"})})]}),t!=="all"&&a.jsxs("span",{className:"filter-tag",children:[a.jsx("i",{className:"icon-filter"}),j.find(E=>E.value===t)?.label,a.jsx("button",{onClick:()=>i("all"),children:a.jsx("i",{className:"icon-x"})})]}),o!=="all"&&a.jsxs("span",{className:"filter-tag",children:[a.jsx("i",{className:"icon-tag"}),w.find(E=>E.value===o)?.label,a.jsx("button",{onClick:()=>c("all"),children:a.jsx("i",{className:"icon-x"})})]}),d!=="all"&&a.jsxs("span",{className:"filter-tag",children:[a.jsx("i",{className:"icon-droplet"}),b.find(E=>E.value===d)?.label,a.jsx("button",{onClick:()=>f("all"),children:a.jsx("i",{className:"icon-x"})})]})]})]})]}),a.jsxs("div",{className:"quick-filters",children:[a.jsx("span",{className:"quick-filters-label",children:"Acceso rápido:"}),a.jsxs("div",{className:"quick-filter-buttons",children:[a.jsxs("button",{className:`quick-filter-btn ${t==="preferred"?"active":""}`,onClick:()=>i(t==="preferred"?"all":"preferred"),children:[a.jsx("i",{className:"icon-star"}),"Preferidos"]}),a.jsxs("button",{className:`quick-filter-btn ${t==="active"?"active":""}`,onClick:()=>i(t==="active"?"all":"active"),children:[a.jsx("i",{className:"icon-check-circle"}),"Activos"]}),a.jsxs("button",{className:`quick-filter-btn ${o==="combustibles"?"active":""}`,onClick:()=>c(o==="combustibles"?"all":"combustibles"),children:[a.jsx("i",{className:"icon-fuel"}),"Combustibles"]}),a.jsxs("button",{className:`quick-filter-btn ${d==="diesel"?"active":""}`,onClick:()=>f(d==="diesel"?"all":"diesel"),children:[a.jsx("i",{className:"icon-droplet"}),"Diésel"]})]})]})]})},UV=()=>{const{hasPermission:n,userProfile:e}=js(),[t,i]=G.useState([]),[o,c]=G.useState(null),[d,f]=G.useState(!0),[p,g]=G.useState(null),[y,N]=G.useState("cards"),[j,w]=G.useState(!1),[b,A]=G.useState(null),[E,D]=G.useState("all"),[q,U]=G.useState("all"),[P,F]=G.useState("all"),[$,L]=G.useState("");G.useEffect(()=>{let Y=null;return(()=>{Y=qA(le=>{i(le||[]),f(!1)})})(),()=>{Y&&Y()}},[]),G.useEffect(()=>{const Y=async()=>{const te=await CL();te.success&&c(te.data)};t.length>0&&Y()},[t]);const S=t.filter(Y=>{const te=!$||Y.name?.toLowerCase().includes($.toLowerCase())||Y.taxId?.toLowerCase().includes($.toLowerCase())||Y.contactPerson?.toLowerCase().includes($.toLowerCase())||Y.city?.toLowerCase().includes($.toLowerCase()),le=E==="all"||(E==="preferred"?Y.isPreferred:Y.status===E),Me=q==="all"||Y.category===q,H=P==="all"||Y.fuelTypes&&Y.fuelTypes.includes(P);return te&&le&&Me&&H}),k=()=>{if(!n("canManageSuppliers")){g("No tienes permisos para agregar proveedores");return}A(null),w(!0)},O=Y=>{if(!n("canManageSuppliers")){g("No tienes permisos para editar proveedores");return}A(Y),w(!0)},C=async(Y,te)=>{if(!n("canManageSuppliers")){g("No tienes permisos para eliminar proveedores");return}if(window.confirm(`¿Estás seguro de que deseas desactivar el proveedor "${te}"?

Esta acción se puede revertir cambiando su estado a activo.`))try{const le=await wL(Y,e?.email);le.success?g(null):g(le.error||"Error al desactivar proveedor")}catch(le){console.error("Error deleting supplier:",le),g("Error inesperado al eliminar proveedor")}},R=()=>{w(!1),A(null),g(null)},V=()=>{w(!1),A(null),g(null)},ye=()=>{D("all"),U("all"),F("all"),L("")},Ie=()=>{if(!n("canExportReports")){g("No tienes permisos para exportar datos");return}try{const Y=S.map(ee=>({Nombre:ee.name,"NIT/Documento":ee.taxId,Tipo:ee.type,Categoría:ee.category,"Persona de Contacto":ee.contactPerson,Teléfono:ee.phone,Email:ee.email,Ciudad:ee.city,Combustibles:ee.fuelTypes?.join(", "),Rating:ee.rating,Estado:ee.status,Preferido:ee.isPreferred?"Sí":"No","Fecha Creación":ee.createdAt?.toDate?.()?.toLocaleDateString()||"N/A"})),te=[Object.keys(Y[0]).join(","),...Y.map(ee=>Object.values(ee).map(ce=>`"${ce||""}"`).join(","))].join(`
`),le=new Blob([te],{type:"text/csv;charset=utf-8;"}),Me=document.createElement("a"),H=URL.createObjectURL(le);Me.setAttribute("href",H),Me.setAttribute("download",`proveedores_${new Date().toISOString().split("T")[0]}.csv`),Me.style.visibility="hidden",document.body.appendChild(Me),Me.click(),document.body.removeChild(Me)}catch(Y){console.error("Error exporting suppliers:",Y),g("Error al exportar proveedores")}};return d?a.jsx("div",{className:"suppliers-main",children:a.jsxs("div",{className:"loading-container",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Cargando proveedores..."})]})}):a.jsxs("div",{className:"suppliers-main",children:[a.jsxs("div",{className:"suppliers-header",children:[a.jsxs("div",{className:"header-content",children:[a.jsx("h1",{children:"Gestión de Proveedores"}),a.jsx("p",{className:"header-subtitle",children:"Administra los proveedores de combustibles y materiales"})]}),a.jsxs("div",{className:"header-actions",children:[n("canManageSuppliers")&&a.jsxs("button",{className:"btn btn-primary",onClick:k,children:[a.jsx("i",{className:"icon-plus"}),"Agregar Proveedor"]}),n("canExportReports")&&a.jsxs("button",{className:"btn btn-secondary",onClick:Ie,disabled:S.length===0,children:[a.jsx("i",{className:"icon-download"}),"Exportar"]})]})]}),p&&a.jsxs("div",{className:"alert alert-error",children:[a.jsx("i",{className:"icon-alert-circle"}),a.jsx("span",{children:p}),a.jsx("button",{onClick:()=>g(null),className:"alert-close",children:a.jsx("i",{className:"icon-x"})})]}),o&&a.jsx(LV,{stats:o,suppliersCount:S.length,totalSuppliers:t.length}),a.jsx(VV,{searchTerm:$,setSearchTerm:L,filterStatus:E,setFilterStatus:D,filterCategory:q,setFilterCategory:U,filterFuelType:P,setFilterFuelType:F,viewMode:y,setViewMode:N,onClearFilters:ye,resultsCount:S.length}),S.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:a.jsx("i",{className:"icon-truck"})}),a.jsx("h3",{children:"No hay proveedores"}),a.jsx("p",{children:t.length===0?"Comienza agregando tu primer proveedor de combustibles.":"No se encontraron proveedores que coincidan con los filtros aplicados."}),t.length===0&&n("canManageSuppliers")&&a.jsxs("button",{className:"btn btn-primary",onClick:k,children:[a.jsx("i",{className:"icon-plus"}),"Agregar Primer Proveedor"]}),t.length>0&&a.jsxs("button",{className:"btn btn-secondary",onClick:ye,children:[a.jsx("i",{className:"icon-filter-x"}),"Limpiar Filtros"]})]}):a.jsx("div",{className:"suppliers-content",children:y==="cards"?a.jsx(kV,{suppliers:S,onEdit:O,onDelete:C,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")}):a.jsx(OV,{suppliers:S,onEdit:O,onDelete:C,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")})}),j&&a.jsx(PV,{supplier:b,onClose:R,onSuccess:V,onError:g})]})},FV=()=>{const{user:n,userProfile:e}=js(),[t,i]=G.useState("invitations"),[o,c]=G.useState([]),[d,f]=G.useState(!1),[p,g]=G.useState(!1),[y,N]=G.useState(!1),[j,w]=G.useState({email:"",name:"",role:xs.CLIENTE});G.useEffect(()=>{n&&e?.role==="admin"&&b()},[n,e]);const b=async()=>{f(!0);try{const P=await uL(n.uid);P.success?c(P.invitations):console.error("Error loading invitations:",P.error)}catch(P){console.error("Error loading invitations:",P)}finally{f(!1)}},A=async P=>{P.preventDefault(),N(!0);try{const F=await lL(j,n.uid);F.success?(w({email:"",name:"",role:xs.CLIENTE}),g(!1),await b(),alert(`Invitación creada exitosamente!
Código: ${F.invitation.code}`)):alert(`Error: ${F.error}`)}catch(F){console.error("Error creating invitation:",F),alert("Error creando invitación")}finally{N(!1)}},E=async P=>{if(confirm("¿Estás seguro de cancelar esta invitación?"))try{const F=await dL(P,n.uid);F.success?(await b(),alert("Invitación cancelada exitosamente")):alert(`Error: ${F.error}`)}catch(F){console.error("Error cancelling invitation:",F),alert("Error cancelando invitación")}},D=P=>({pending:{text:"Pendiente",class:"status-pending"},used:{text:"Usada",class:"status-used"},cancelled:{text:"Cancelada",class:"status-cancelled"},expired:{text:"Expirada",class:"status-expired"}})[P]||{text:P,class:"status-unknown"},q=P=>({admin:"Administrador",contador:"Contador",cliente:"Cliente"})[P]||P,U=P=>P?(P.toDate?P.toDate():new Date(P)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e?.role!=="admin"?a.jsxs("div",{className:"admin-unauthorized",children:[a.jsx("h2",{children:"⛔ Acceso Denegado"}),a.jsx("p",{children:"Solo los administradores pueden acceder a esta sección."})]}):a.jsxs("div",{className:"admin-main",children:[a.jsxs("div",{className:"admin-header",children:[a.jsx("h1",{children:"⚙️ Administración del Sistema"}),a.jsx("p",{children:"Gestión de usuarios y configuraciones"})]}),a.jsxs("div",{className:"admin-tabs",children:[a.jsx("button",{className:`tab-button ${t==="invitations"?"active":""}`,onClick:()=>i("invitations"),children:"🎫 Invitaciones"}),a.jsx("button",{className:`tab-button ${t==="users"?"active":""}`,onClick:()=>i("users"),children:"👥 Usuarios"}),a.jsx("button",{className:`tab-button ${t==="settings"?"active":""}`,onClick:()=>i("settings"),children:"⚙️ Configuración"})]}),a.jsxs("div",{className:"admin-content",children:[t==="invitations"&&a.jsxs("div",{className:"invitations-section",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h2",{children:"Gestión de Invitaciones"}),a.jsx("button",{className:"create-button",onClick:()=>g(!0),children:"+ Crear Invitación"})]}),d?a.jsx("div",{className:"loading",children:"Cargando invitaciones..."}):a.jsxs("div",{className:"invitations-table",children:[a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Código"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Nombre"}),a.jsx("th",{children:"Rol"}),a.jsx("th",{children:"Estado"}),a.jsx("th",{children:"Creada"}),a.jsx("th",{children:"Expira"}),a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:o.map(P=>{const F=D(P.status);return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("code",{className:"invitation-code",children:P.code})}),a.jsx("td",{children:P.targetEmail}),a.jsx("td",{children:P.targetName||"-"}),a.jsx("td",{children:q(P.targetRole)}),a.jsx("td",{children:a.jsx("span",{className:`status-badge ${F.class}`,children:F.text})}),a.jsx("td",{children:U(P.createdAt)}),a.jsx("td",{children:U(P.expiresAt)}),a.jsx("td",{children:P.status==="pending"&&a.jsx("button",{className:"cancel-button",onClick:()=>E(P.id),children:"Cancelar"})})]},P.id)})})]}),o.length===0&&a.jsx("div",{className:"empty-state",children:a.jsx("p",{children:"No hay invitaciones creadas"})})]})]}),t==="users"&&a.jsxs("div",{className:"users-section",children:[a.jsx("h2",{children:"👥 Usuarios del Sistema"}),a.jsxs("div",{className:"coming-soon",children:[a.jsx("span",{children:"🚧 En desarrollo"}),a.jsx("p",{children:"Próximamente: Lista de usuarios registrados, edición de permisos, y estadísticas."})]})]}),t==="settings"&&a.jsxs("div",{className:"settings-section",children:[a.jsx("h2",{children:"⚙️ Configuración del Sistema"}),a.jsxs("div",{className:"coming-soon",children:[a.jsx("span",{children:"🚧 En desarrollo"}),a.jsx("p",{children:"Próximamente: Configuraciones generales, notificaciones, y parámetros del sistema."})]})]})]}),p&&a.jsx("div",{className:"modal-overlay",onClick:()=>g(!1),children:a.jsxs("div",{className:"modal-content",onClick:P=>P.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsx("h3",{children:"Crear Nueva Invitación"}),a.jsx("button",{className:"modal-close",onClick:()=>g(!1),children:"×"})]}),a.jsxs("form",{onSubmit:A,className:"invitation-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email del usuario:"}),a.jsx("input",{id:"email",type:"email",required:!0,value:j.email,onChange:P=>w({...j,email:P.target.value}),placeholder:"usuario@ejemplo.com"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"name",children:"Nombre (opcional):"}),a.jsx("input",{id:"name",type:"text",value:j.name,onChange:P=>w({...j,name:P.target.value}),placeholder:"Nombre del usuario"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"role",children:"Rol:"}),a.jsxs("select",{id:"role",value:j.role,onChange:P=>w({...j,role:P.target.value}),children:[a.jsx("option",{value:xs.CLIENTE,children:"Cliente"}),a.jsx("option",{value:xs.CONTADOR,children:"Contador"}),a.jsx("option",{value:xs.ADMIN,children:"Administrador"})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{type:"button",className:"cancel-button",onClick:()=>g(!1),children:"Cancelar"}),a.jsx("button",{type:"submit",className:"create-button",disabled:y,children:y?"Creando...":"Crear Invitación"})]})]})]})})]})},qV=()=>a.jsxs("div",{className:"module-placeholder",children:[a.jsx("h2",{children:"📋 Módulo de Reportes"}),a.jsx("p",{children:"Análisis y reportes de combustibles"}),a.jsxs("div",{className:"coming-soon",children:[a.jsx("span",{children:"🚧 En desarrollo"}),a.jsx("p",{children:"Próximamente: Reportes personalizables, gráficos interactivos, y exportación."})]})]}),zV=()=>{const[n,e]=G.useState("dashboard"),t=()=>{switch(n){case"dashboard":return a.jsx(qE,{});case"inventory":return a.jsx(LL,{});case"movements":return a.jsx(aV,{});case"vehicles":return a.jsx(xV,{});case"maintenance":return a.jsx(IV,{});case"products":return a.jsx(MV,{});case"suppliers":return a.jsx(UV,{});case"reports":return a.jsx(qV,{});case"admin":return a.jsx(FV,{});default:return a.jsx(qE,{})}};return a.jsx(IL,{currentView:n,onViewChange:e,children:t()})},HV=()=>{const[n,e]=G.useState("login"),[t,i]=G.useState(!1),[o,c]=G.useState(""),[d,f]=G.useState(""),[p,g]=G.useState(""),[y,N]=G.useState(""),[j,w]=G.useState({email:"",password:"",confirmPassword:"",invitationCode:""}),[b,A]=G.useState(""),[E,D]=G.useState(null),q=async k=>{k.preventDefault(),i(!0),c("");try{await pR(Gc,p,y)}catch(O){console.error("Error en login:",O),c($(O.code))}finally{i(!1)}},U=async()=>{i(!0),c("");try{const k=new wa,O=await UR(Gc,k);E?await OE(O.user,E.code):await bA(O.user)}catch(k){console.error("Error en login con Google:",k),c("Error al iniciar sesión con Google")}finally{i(!1)}},P=async k=>{k.preventDefault(),i(!0),c(""),f("");try{const O=await xA(b);O.success?(D(O.invitation),f(`Invitación válida para: ${O.invitation.targetEmail}`),e("register"),w({...j,email:O.invitation.targetEmail,invitationCode:b})):c(O.error)}catch(O){console.error("Error validando invitación:",O),c("Error validando código de invitación")}finally{i(!1)}},F=async k=>{if(k.preventDefault(),i(!0),c(""),j.password!==j.confirmPassword){c("Las contraseñas no coinciden"),i(!1);return}if(j.password.length<6){c("La contraseña debe tener al menos 6 caracteres"),i(!1);return}try{const O=await mR(Gc,j.email,j.password),C=await OE(O.user,j.invitationCode);C.success?f("¡Registro exitoso! Bienvenido al sistema."):c(C.error)}catch(O){console.error("Error en registro:",O),c($(O.code))}finally{i(!1)}},$=k=>{switch(k){case"auth/invalid-email":return"El formato del email es inválido";case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contraseña incorrecta";case"auth/invalid-credential":return"Email o contraseña incorrectos";case"auth/email-already-in-use":return"Este email ya está registrado";case"auth/weak-password":return"La contraseña es muy débil";default:return"Error de autenticación. Inténtalo de nuevo."}},L=()=>{c(""),f(""),g(""),N(""),A(""),D(null),w({email:"",password:"",confirmPassword:"",invitationCode:""})},S=()=>{switch(n){case"login":return a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:q,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email:"}),a.jsx("input",{id:"email",type:"email",value:p,onChange:k=>g(k.target.value),required:!0,disabled:t,placeholder:"tu-email@ejemplo.com"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Contraseña:"}),a.jsx("input",{id:"password",type:"password",value:y,onChange:k=>N(k.target.value),required:!0,disabled:t,placeholder:"Tu contraseña"})]}),a.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Iniciando sesión...":"Iniciar Sesión"})]}),a.jsx("div",{className:"auth-divider",children:a.jsx("span",{children:"o"})}),a.jsxs("button",{onClick:U,className:"auth-button google",disabled:t,children:[a.jsx("span",{children:"🔗"}),"Continuar con Google"]}),a.jsx("div",{className:"auth-actions",children:a.jsx("button",{className:"link-button",onClick:()=>{L(),e("invite")},children:"¿Tienes un código de invitación? Regístrate aquí"})})]});case"invite":return a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:P,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"inviteCode",children:"Código de invitación:"}),a.jsx("input",{id:"inviteCode",type:"text",value:b,onChange:k=>A(k.target.value.toUpperCase()),required:!0,disabled:t,placeholder:"XXXXXXXX",maxLength:8,style:{textTransform:"uppercase",fontFamily:"monospace"}}),a.jsx("small",{children:"Ingresa el código de 8 caracteres que recibiste"})]}),a.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Validando...":"Validar Código"})]}),a.jsx("div",{className:"auth-actions",children:a.jsx("button",{className:"link-button",onClick:()=>{L(),e("login")},children:"Volver al inicio de sesión"})})]});case"register":return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"invitation-info",children:a.jsxs("div",{className:"success-message",children:["✅ Código válido para: ",E?.targetEmail]})}),a.jsxs("form",{onSubmit:F,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"registerEmail",children:"Email:"}),a.jsx("input",{id:"registerEmail",type:"email",value:j.email,disabled:!0,className:"disabled-input"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"registerPassword",children:"Contraseña:"}),a.jsx("input",{id:"registerPassword",type:"password",value:j.password,onChange:k=>w({...j,password:k.target.value}),required:!0,disabled:t,placeholder:"Mínimo 6 caracteres",minLength:6})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar contraseña:"}),a.jsx("input",{id:"confirmPassword",type:"password",value:j.confirmPassword,onChange:k=>w({...j,confirmPassword:k.target.value}),required:!0,disabled:t,placeholder:"Repite tu contraseña"})]}),a.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Registrando...":"Crear Cuenta"})]}),a.jsx("div",{className:"auth-divider",children:a.jsx("span",{children:"o"})}),a.jsxs("button",{onClick:U,className:"auth-button google",disabled:t,children:[a.jsx("span",{children:"🔗"}),"Registrarse con Google"]}),a.jsx("div",{className:"auth-actions",children:a.jsx("button",{className:"link-button",onClick:()=>{L(),e("invite")},children:"Usar otro código de invitación"})})]});default:return null}};return a.jsx("div",{className:"auth-container",children:a.jsxs("div",{className:"auth-card",children:[a.jsxs("div",{className:"auth-header",children:[a.jsx("h1",{children:"⛽ Combustibles"}),a.jsx("h2",{children:"Forestech Colombia"}),a.jsxs("p",{children:[n==="login"&&"Sistema de gestión de combustibles",n==="invite"&&"Validar código de invitación",n==="register"&&"Crear nueva cuenta"]})]}),a.jsxs("div",{className:"auth-form",children:[o&&a.jsx("div",{className:"error-message",children:o}),d&&a.jsx("div",{className:"success-message",children:d}),S(),a.jsx("div",{className:"auth-footer",children:a.jsx("p",{children:a.jsxs("small",{children:["Solo usuarios autorizados pueden acceder al sistema.",a.jsx("br",{}),n==="login"?"Contacta al administrador para obtener un código de invitación.":"Si no tienes código, contacta al administrador."]})})})]})]})})};function BV(){return a.jsx(SL,{children:a.jsx(GV,{})})}function GV(){const{user:n,loading:e}=js();return e?a.jsx("div",{className:"loading-container",children:a.jsxs("div",{className:"loader",children:[a.jsx("div",{className:"spinner"}),a.jsx("p",{children:"Cargando..."})]})}):a.jsxs("div",{className:"App",children:[!n&&a.jsx(HV,{}),n&&a.jsx(zV,{})]})}OC.createRoot(document.getElementById("root")).render(a.jsx(G.StrictMode,{children:a.jsx(BV,{})}));
