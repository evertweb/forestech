(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var Ap={exports:{}},jc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var px;function TC(){if(px)return jc;px=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var f in o)f!=="key"&&(c[f]=o[f])}else c=o;return o=c.ref,{$$typeof:n,type:a,key:d,ref:o!==void 0?o:null,props:c}}return jc.Fragment=e,jc.jsx=t,jc.jsxs=t,jc}var gx;function AC(){return gx||(gx=1,Ap.exports=TC()),Ap.exports}var i=AC(),jp={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vx;function jC(){if(vx)return Le;vx=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),_=Symbol.iterator;function N(z){return z===null||typeof z!="object"?null:(z=_&&z[_]||z["@@iterator"],typeof z=="function"?z:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,R={};function A(z,ee,le){this.props=z,this.context=ee,this.refs=R,this.updater=le||j}A.prototype.isReactComponent={},A.prototype.setState=function(z,ee){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,ee,"setState")},A.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function O(){}O.prototype=A.prototype;function q(z,ee,le){this.props=z,this.context=ee,this.refs=R,this.updater=le||j}var U=q.prototype=new O;U.constructor=q,x(U,A.prototype),U.isPureReactComponent=!0;var P=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},$=Object.prototype.hasOwnProperty;function V(z,ee,le,ce,xe,Be){return le=Be.ref,{$$typeof:n,type:z,key:ee,ref:le!==void 0?le:null,props:Be}}function S(z,ee){return V(z.type,ee,void 0,void 0,void 0,z.props)}function L(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function M(z){var ee={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(le){return ee[le]})}var w=/\/+/g;function C(z,ee){return typeof z=="object"&&z!==null&&z.key!=null?M(""+z.key):ee.toString(36)}function D(){}function me(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(D,D):(z.status="pending",z.then(function(ee){z.status==="pending"&&(z.status="fulfilled",z.value=ee)},function(ee){z.status==="pending"&&(z.status="rejected",z.reason=ee)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function De(z,ee,le,ce,xe){var Be=typeof z;(Be==="undefined"||Be==="boolean")&&(z=null);var Ie=!1;if(z===null)Ie=!0;else switch(Be){case"bigint":case"string":case"number":Ie=!0;break;case"object":switch(z.$$typeof){case n:case e:Ie=!0;break;case y:return Ie=z._init,De(Ie(z._payload),ee,le,ce,xe)}}if(Ie)return xe=xe(z),Ie=ce===""?"."+C(z,0):ce,P(xe)?(le="",Ie!=null&&(le=Ie.replace(w,"$&/")+"/"),De(xe,ee,le,"",function(js){return js})):xe!=null&&(L(xe)&&(xe=S(xe,le+(xe.key==null||z&&z.key===xe.key?"":(""+xe.key).replace(w,"$&/")+"/")+Ie)),ee.push(xe)),1;Ie=0;var Ht=ce===""?".":ce+":";if(P(z))for(var mt=0;mt<z.length;mt++)ce=z[mt],Be=Ht+C(ce,mt),Ie+=De(ce,ee,le,Be,xe);else if(mt=N(z),typeof mt=="function")for(z=mt.call(z),mt=0;!(ce=z.next()).done;)ce=ce.value,Be=Ht+C(ce,mt++),Ie+=De(ce,ee,le,Be,xe);else if(Be==="object"){if(typeof z.then=="function")return De(me(z),ee,le,ce,xe);throw ee=String(z),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return Ie}function Q(z,ee,le){if(z==null)return z;var ce=[],xe=0;return De(z,ce,"","",function(Be){return ee.call(le,Be,xe++)}),ce}function ne(z){if(z._status===-1){var ee=z._result;ee=ee(),ee.then(function(le){(z._status===0||z._status===-1)&&(z._status=1,z._result=le)},function(le){(z._status===0||z._status===-1)&&(z._status=2,z._result=le)}),z._status===-1&&(z._status=0,z._result=ee)}if(z._status===1)return z._result.default;throw z._result}var he=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)};function Oe(){}return Le.Children={map:Q,forEach:function(z,ee,le){Q(z,function(){ee.apply(this,arguments)},le)},count:function(z){var ee=0;return Q(z,function(){ee++}),ee},toArray:function(z){return Q(z,function(ee){return ee})||[]},only:function(z){if(!L(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},Le.Component=A,Le.Fragment=t,Le.Profiler=o,Le.PureComponent=q,Le.StrictMode=a,Le.Suspense=p,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Le.__COMPILER_RUNTIME={__proto__:null,c:function(z){return F.H.useMemoCache(z)}},Le.cache=function(z){return function(){return z.apply(null,arguments)}},Le.cloneElement=function(z,ee,le){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var ce=x({},z.props),xe=z.key,Be=void 0;if(ee!=null)for(Ie in ee.ref!==void 0&&(Be=void 0),ee.key!==void 0&&(xe=""+ee.key),ee)!$.call(ee,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&ee.ref===void 0||(ce[Ie]=ee[Ie]);var Ie=arguments.length-2;if(Ie===1)ce.children=le;else if(1<Ie){for(var Ht=Array(Ie),mt=0;mt<Ie;mt++)Ht[mt]=arguments[mt+2];ce.children=Ht}return V(z.type,xe,void 0,void 0,Be,ce)},Le.createContext=function(z){return z={$$typeof:d,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:c,_context:z},z},Le.createElement=function(z,ee,le){var ce,xe={},Be=null;if(ee!=null)for(ce in ee.key!==void 0&&(Be=""+ee.key),ee)$.call(ee,ce)&&ce!=="key"&&ce!=="__self"&&ce!=="__source"&&(xe[ce]=ee[ce]);var Ie=arguments.length-2;if(Ie===1)xe.children=le;else if(1<Ie){for(var Ht=Array(Ie),mt=0;mt<Ie;mt++)Ht[mt]=arguments[mt+2];xe.children=Ht}if(z&&z.defaultProps)for(ce in Ie=z.defaultProps,Ie)xe[ce]===void 0&&(xe[ce]=Ie[ce]);return V(z,Be,void 0,void 0,null,xe)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(z){return{$$typeof:f,render:z}},Le.isValidElement=L,Le.lazy=function(z){return{$$typeof:y,_payload:{_status:-1,_result:z},_init:ne}},Le.memo=function(z,ee){return{$$typeof:g,type:z,compare:ee===void 0?null:ee}},Le.startTransition=function(z){var ee=F.T,le={};F.T=le;try{var ce=z(),xe=F.S;xe!==null&&xe(le,ce),typeof ce=="object"&&ce!==null&&typeof ce.then=="function"&&ce.then(Oe,he)}catch(Be){he(Be)}finally{F.T=ee}},Le.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Le.use=function(z){return F.H.use(z)},Le.useActionState=function(z,ee,le){return F.H.useActionState(z,ee,le)},Le.useCallback=function(z,ee){return F.H.useCallback(z,ee)},Le.useContext=function(z){return F.H.useContext(z)},Le.useDebugValue=function(){},Le.useDeferredValue=function(z,ee){return F.H.useDeferredValue(z,ee)},Le.useEffect=function(z,ee,le){var ce=F.H;if(typeof le=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ce.useEffect(z,ee)},Le.useId=function(){return F.H.useId()},Le.useImperativeHandle=function(z,ee,le){return F.H.useImperativeHandle(z,ee,le)},Le.useInsertionEffect=function(z,ee){return F.H.useInsertionEffect(z,ee)},Le.useLayoutEffect=function(z,ee){return F.H.useLayoutEffect(z,ee)},Le.useMemo=function(z,ee){return F.H.useMemo(z,ee)},Le.useOptimistic=function(z,ee){return F.H.useOptimistic(z,ee)},Le.useReducer=function(z,ee,le){return F.H.useReducer(z,ee,le)},Le.useRef=function(z){return F.H.useRef(z)},Le.useState=function(z){return F.H.useState(z)},Le.useSyncExternalStore=function(z,ee,le){return F.H.useSyncExternalStore(z,ee,le)},Le.useTransition=function(){return F.H.useTransition()},Le.version="19.1.0",Le}var yx;function Ig(){return yx||(yx=1,jp.exports=jC()),jp.exports}var H=Ig(),wp={exports:{}},wc={},Cp={exports:{}},Sp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bx;function wC(){return bx||(bx=1,function(n){function e(Q,ne){var he=Q.length;Q.push(ne);e:for(;0<he;){var Oe=he-1>>>1,z=Q[Oe];if(0<o(z,ne))Q[Oe]=ne,Q[he]=z,he=Oe;else break e}}function t(Q){return Q.length===0?null:Q[0]}function a(Q){if(Q.length===0)return null;var ne=Q[0],he=Q.pop();if(he!==ne){Q[0]=he;e:for(var Oe=0,z=Q.length,ee=z>>>1;Oe<ee;){var le=2*(Oe+1)-1,ce=Q[le],xe=le+1,Be=Q[xe];if(0>o(ce,he))xe<z&&0>o(Be,ce)?(Q[Oe]=Be,Q[xe]=he,Oe=xe):(Q[Oe]=ce,Q[le]=he,Oe=le);else if(xe<z&&0>o(Be,he))Q[Oe]=Be,Q[xe]=he,Oe=xe;else break e}}return ne}function o(Q,ne){var he=Q.sortIndex-ne.sortIndex;return he!==0?he:Q.id-ne.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var p=[],g=[],y=1,_=null,N=3,j=!1,x=!1,R=!1,A=!1,O=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;function P(Q){for(var ne=t(g);ne!==null;){if(ne.callback===null)a(g);else if(ne.startTime<=Q)a(g),ne.sortIndex=ne.expirationTime,e(p,ne);else break;ne=t(g)}}function F(Q){if(R=!1,P(Q),!x)if(t(p)!==null)x=!0,$||($=!0,C());else{var ne=t(g);ne!==null&&De(F,ne.startTime-Q)}}var $=!1,V=-1,S=5,L=-1;function M(){return A?!0:!(n.unstable_now()-L<S)}function w(){if(A=!1,$){var Q=n.unstable_now();L=Q;var ne=!0;try{e:{x=!1,R&&(R=!1,q(V),V=-1),j=!0;var he=N;try{t:{for(P(Q),_=t(p);_!==null&&!(_.expirationTime>Q&&M());){var Oe=_.callback;if(typeof Oe=="function"){_.callback=null,N=_.priorityLevel;var z=Oe(_.expirationTime<=Q);if(Q=n.unstable_now(),typeof z=="function"){_.callback=z,P(Q),ne=!0;break t}_===t(p)&&a(p),P(Q)}else a(p);_=t(p)}if(_!==null)ne=!0;else{var ee=t(g);ee!==null&&De(F,ee.startTime-Q),ne=!1}}break e}finally{_=null,N=he,j=!1}ne=void 0}}finally{ne?C():$=!1}}}var C;if(typeof U=="function")C=function(){U(w)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,me=D.port2;D.port1.onmessage=w,C=function(){me.postMessage(null)}}else C=function(){O(w,0)};function De(Q,ne){V=O(function(){Q(n.unstable_now())},ne)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return N},n.unstable_next=function(Q){switch(N){case 1:case 2:case 3:var ne=3;break;default:ne=N}var he=N;N=ne;try{return Q()}finally{N=he}},n.unstable_requestPaint=function(){A=!0},n.unstable_runWithPriority=function(Q,ne){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var he=N;N=Q;try{return ne()}finally{N=he}},n.unstable_scheduleCallback=function(Q,ne,he){var Oe=n.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Oe+he:Oe):he=Oe,Q){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=he+z,Q={id:y++,callback:ne,priorityLevel:Q,startTime:he,expirationTime:z,sortIndex:-1},he>Oe?(Q.sortIndex=he,e(g,Q),t(p)===null&&Q===t(g)&&(R?(q(V),V=-1):R=!0,De(F,he-Oe))):(Q.sortIndex=z,e(p,Q),x||j||(x=!0,$||($=!0,C()))),Q},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(Q){var ne=N;return function(){var he=N;N=ne;try{return Q.apply(this,arguments)}finally{N=he}}}}(Sp)),Sp}var _x;function CC(){return _x||(_x=1,Cp.exports=wC()),Cp.exports}var Ip={exports:{}},dn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xx;function SC(){if(xx)return dn;xx=1;var n=Ig();function e(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)g+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,g,y){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:_==null?null:""+_,children:p,containerInfo:g,implementation:y}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,dn.createPortal=function(p,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return c(p,g,null,y)},dn.flushSync=function(p){var g=d.T,y=a.p;try{if(d.T=null,a.p=2,p)return p()}finally{d.T=g,a.p=y,a.d.f()}},dn.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,a.d.C(p,g))},dn.prefetchDNS=function(p){typeof p=="string"&&a.d.D(p)},dn.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var y=g.as,_=f(y,g.crossOrigin),N=typeof g.integrity=="string"?g.integrity:void 0,j=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;y==="style"?a.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:_,integrity:N,fetchPriority:j}):y==="script"&&a.d.X(p,{crossOrigin:_,integrity:N,fetchPriority:j,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},dn.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var y=f(g.as,g.crossOrigin);a.d.M(p,{crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&a.d.M(p)},dn.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var y=g.as,_=f(y,g.crossOrigin);a.d.L(p,y,{crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},dn.preloadModule=function(p,g){if(typeof p=="string")if(g){var y=f(g.as,g.crossOrigin);a.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else a.d.m(p)},dn.requestFormReset=function(p){a.d.r(p)},dn.unstable_batchedUpdates=function(p,g){return p(g)},dn.useFormState=function(p,g,y){return d.H.useFormState(p,g,y)},dn.useFormStatus=function(){return d.H.useHostTransitionStatus()},dn.version="19.1.0",dn}var Nx;function IC(){if(Nx)return Ip.exports;Nx=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ip.exports=SC(),Ip.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ex;function RC(){if(Ex)return wc;Ex=1;var n=CC(),e=Ig(),t=IC();function a(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var r=s,l=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(l=r.return),s=r.return;while(s)}return r.tag===3?l:null}function d(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function f(s){if(c(s)!==s)throw Error(a(188))}function p(s){var r=s.alternate;if(!r){if(r=c(s),r===null)throw Error(a(188));return r!==s?null:s}for(var l=s,u=r;;){var m=l.return;if(m===null)break;var v=m.alternate;if(v===null){if(u=m.return,u!==null){l=u;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===l)return f(m),s;if(v===u)return f(m),r;v=v.sibling}throw Error(a(188))}if(l.return!==u.return)l=m,u=v;else{for(var T=!1,I=m.child;I;){if(I===l){T=!0,l=m,u=v;break}if(I===u){T=!0,u=m,l=v;break}I=I.sibling}if(!T){for(I=v.child;I;){if(I===l){T=!0,l=v,u=m;break}if(I===u){T=!0,u=v,l=m;break}I=I.sibling}if(!T)throw Error(a(189))}}if(l.alternate!==u)throw Error(a(190))}if(l.tag!==3)throw Error(a(188));return l.stateNode.current===l?s:r}function g(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=g(s),r!==null)return r;s=s.sibling}return null}var y=Object.assign,_=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),q=Symbol.for("react.consumer"),U=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),w=Symbol.iterator;function C(s){return s===null||typeof s!="object"?null:(s=w&&s[w]||s["@@iterator"],typeof s=="function"?s:null)}var D=Symbol.for("react.client.reference");function me(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===D?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case x:return"Fragment";case A:return"Profiler";case R:return"StrictMode";case F:return"Suspense";case $:return"SuspenseList";case L:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case j:return"Portal";case U:return(s.displayName||"Context")+".Provider";case q:return(s._context.displayName||"Context")+".Consumer";case P:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case V:return r=s.displayName||null,r!==null?r:me(s.type)||"Memo";case S:r=s._payload,s=s._init;try{return me(s(r))}catch{}}return null}var De=Array.isArray,Q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he={pending:!1,data:null,method:null,action:null},Oe=[],z=-1;function ee(s){return{current:s}}function le(s){0>z||(s.current=Oe[z],Oe[z]=null,z--)}function ce(s,r){z++,Oe[z]=s.current,s.current=r}var xe=ee(null),Be=ee(null),Ie=ee(null),Ht=ee(null);function mt(s,r){switch(ce(Ie,r),ce(Be,s),ce(xe,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?z_(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=z_(r),s=H_(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}le(xe),ce(xe,s)}function js(){le(xe),le(Be),le(Ie)}function La(s){s.memoizedState!==null&&ce(Ht,s);var r=xe.current,l=H_(r,s.type);r!==l&&(ce(Be,s),ce(xe,l))}function ea(s){Be.current===s&&(le(xe),le(Be)),Ht.current===s&&(le(Ht),xc._currentValue=he)}var qi=Object.prototype.hasOwnProperty,Bi=n.unstable_scheduleCallback,zi=n.unstable_cancelCallback,yl=n.unstable_shouldYield,ju=n.unstable_requestPaint,Yn=n.unstable_now,Af=n.unstable_getCurrentPriorityLevel,bl=n.unstable_ImmediatePriority,zr=n.unstable_UserBlockingPriority,Hi=n.unstable_NormalPriority,jf=n.unstable_LowPriority,Hr=n.unstable_IdlePriority,_l=n.log,wu=n.unstable_setDisableYieldValue,Et=null,st=null;function Mn(s){if(typeof _l=="function"&&wu(s),st&&typeof st.setStrictMode=="function")try{st.setStrictMode(Et,s)}catch{}}var cn=Math.clz32?Math.clz32:Gi,Cu=Math.log,wf=Math.LN2;function Gi(s){return s>>>=0,s===0?32:31-(Cu(s)/wf|0)|0}var $i=256,Yi=4194304;function hs(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Gr(s,r,l){var u=s.pendingLanes;if(u===0)return 0;var m=0,v=s.suspendedLanes,T=s.pingedLanes;s=s.warmLanes;var I=u&134217727;return I!==0?(u=I&~v,u!==0?m=hs(u):(T&=I,T!==0?m=hs(T):l||(l=I&~s,l!==0&&(m=hs(l))))):(I=u&~v,I!==0?m=hs(I):T!==0?m=hs(T):l||(l=u&~s,l!==0&&(m=hs(l)))),m===0?0:r!==0&&r!==m&&(r&v)===0&&(v=m&-m,l=r&-r,v>=l||v===32&&(l&4194048)!==0)?r:m}function Qi(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function xl(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nl(){var s=$i;return $i<<=1,($i&4194048)===0&&($i=256),s}function El(){var s=Yi;return Yi<<=1,(Yi&62914560)===0&&(Yi=4194304),s}function ta(s){for(var r=[],l=0;31>l;l++)r.push(s);return r}function na(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Tl(s,r,l,u,m,v){var T=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var I=s.entanglements,B=s.expirationTimes,W=s.hiddenUpdates;for(l=T&~l;0<l;){var se=31-cn(l),re=1<<se;I[se]=0,B[se]=-1;var Z=W[se];if(Z!==null)for(W[se]=null,se=0;se<Z.length;se++){var J=Z[se];J!==null&&(J.lane&=-536870913)}l&=~re}u!==0&&ws(s,u,0),v!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=v&~(T&~r))}function ws(s,r,l){s.pendingLanes|=r,s.suspendedLanes&=~r;var u=31-cn(r);s.entangledLanes|=r,s.entanglements[u]=s.entanglements[u]|1073741824|l&4194090}function Al(s,r){var l=s.entangledLanes|=r;for(s=s.entanglements;l;){var u=31-cn(l),m=1<<u;m&r|s[u]&r&&(s[u]|=r),l&=~m}}function Va(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function $r(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ua(){var s=ne.p;return s!==0?s:(s=window.event,s===void 0?32:cx(s.type))}function Su(s,r){var l=ne.p;try{return ne.p=s,r()}finally{ne.p=l}}var bt=Math.random().toString(36).slice(2),Pt="__reactFiber$"+bt,It="__reactProps$"+bt,Qn="__reactContainer$"+bt,jl="__reactEvents$"+bt,Cf="__reactListeners$"+bt,Fa="__reactHandles$"+bt,Iu="__reactResources$"+bt,Ki="__reactMarker$"+bt;function qa(s){delete s[Pt],delete s[It],delete s[jl],delete s[Cf],delete s[Fa]}function sa(s){var r=s[Pt];if(r)return r;for(var l=s.parentNode;l;){if(r=l[Qn]||l[Pt]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(s=Q_(s);s!==null;){if(l=s[Pt])return l;s=Q_(s)}return r}s=l,l=s.parentNode}return null}function Cs(s){if(s=s[Pt]||s[Qn]){var r=s.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return s}return null}function Ss(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(a(33))}function vn(s){var r=s[Iu];return r||(r=s[Iu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function jt(s){s[Ki]=!0}var wl=new Set,Yr={};function fs(s,r){aa(s,r),aa(s+"Capture",r)}function aa(s,r){for(Yr[s]=r,s=0;s<r.length;s++)wl.add(r[s])}var Ru=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Du={},Xi={};function Mu(s){return qi.call(Xi,s)?!0:qi.call(Du,s)?!1:Ru.test(s)?Xi[s]=!0:(Du[s]=!0,!1)}function Ba(s,r,l){if(Mu(r))if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+l)}}function Is(s,r,l){if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+l)}}function Zt(s,r,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(r,l,""+u)}}var Wi,Ou;function ia(s){if(Wi===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);Wi=r&&r[1]||"",Ou=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Wi+s+Ou}var Qr=!1;function Kr(s,r){if(!s||Qr)return"";Qr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(J){var Z=J}Reflect.construct(s,[],re)}else{try{re.call()}catch(J){Z=J}s.call(re.prototype)}}else{try{throw Error()}catch(J){Z=J}(re=s())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(J){if(J&&Z&&typeof J.stack=="string")return[J.stack,Z.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=u.DetermineComponentFrameRoot(),T=v[0],I=v[1];if(T&&I){var B=T.split(`
`),W=I.split(`
`);for(m=u=0;u<B.length&&!B[u].includes("DetermineComponentFrameRoot");)u++;for(;m<W.length&&!W[m].includes("DetermineComponentFrameRoot");)m++;if(u===B.length||m===W.length)for(u=B.length-1,m=W.length-1;1<=u&&0<=m&&B[u]!==W[m];)m--;for(;1<=u&&0<=m;u--,m--)if(B[u]!==W[m]){if(u!==1||m!==1)do if(u--,m--,0>m||B[u]!==W[m]){var se=`
`+B[u].replace(" at new "," at ");return s.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",s.displayName)),se}while(1<=u&&0<=m);break}}}finally{Qr=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?ia(l):""}function Cl(s){switch(s.tag){case 26:case 27:case 5:return ia(s.type);case 16:return ia("Lazy");case 13:return ia("Suspense");case 19:return ia("SuspenseList");case 0:case 15:return Kr(s.type,!1);case 11:return Kr(s.type.render,!1);case 1:return Kr(s.type,!0);case 31:return ia("Activity");default:return""}}function Xr(s){try{var r="";do r+=Cl(s),s=s.return;while(s);return r}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function yn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Sl(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Sf(s){var r=Sl(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,r),u=""+s[r];if(!s.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,v=l.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return m.call(this)},set:function(T){u=""+T,v.call(this,T)}}),Object.defineProperty(s,r,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function Wr(s){s._valueTracker||(s._valueTracker=Sf(s))}function Il(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var l=r.getValue(),u="";return s&&(u=Sl(s)?s.checked?"true":"false":s.value),s=u,s!==l?(r.setValue(s),!0):!1}function Zi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var If=/[\n"\\]/g;function Rt(s){return s.replace(If,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function On(s,r,l,u,m,v,T,I){s.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?s.type=T:s.removeAttribute("type"),r!=null?T==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+yn(r)):s.value!==""+yn(r)&&(s.value=""+yn(r)):T!=="submit"&&T!=="reset"||s.removeAttribute("value"),r!=null?za(s,T,yn(r)):l!=null?za(s,T,yn(l)):u!=null&&s.removeAttribute("value"),m==null&&v!=null&&(s.defaultChecked=!!v),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+yn(I):s.removeAttribute("name")}function Ji(s,r,l,u,m,v,T,I){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),r!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||r!=null))return;l=l!=null?""+yn(l):"",r=r!=null?""+yn(r):l,I||r===s.value||(s.value=r),s.defaultValue=r}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=I?s.checked:!!u,s.defaultChecked=!!u,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(s.name=T)}function za(s,r,l){r==="number"&&Zi(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function ra(s,r,l,u){if(s=s.options,r){r={};for(var m=0;m<l.length;m++)r["$"+l[m]]=!0;for(l=0;l<s.length;l++)m=r.hasOwnProperty("$"+s[l].value),s[l].selected!==m&&(s[l].selected=m),m&&u&&(s[l].defaultSelected=!0)}else{for(l=""+yn(l),r=null,m=0;m<s.length;m++){if(s[m].value===l){s[m].selected=!0,u&&(s[m].defaultSelected=!0);return}r!==null||s[m].disabled||(r=s[m])}r!==null&&(r.selected=!0)}}function rt(s,r,l){if(r!=null&&(r=""+yn(r),r!==s.value&&(s.value=r),l==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=l!=null?""+yn(l):""}function er(s,r,l,u){if(r==null){if(u!=null){if(l!=null)throw Error(a(92));if(De(u)){if(1<u.length)throw Error(a(93));u=u[0]}l=u}l==null&&(l=""),r=l}l=yn(r),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u)}function Kn(s,r){if(r){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=r;return}}s.textContent=r}var tr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ku(s,r,l){var u=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":u?s.setProperty(r,l):typeof l!="number"||l===0||tr.has(r)?r==="float"?s.cssFloat=l:s[r]=(""+l).trim():s[r]=l+"px"}function Rl(s,r,l){if(r!=null&&typeof r!="object")throw Error(a(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var m in r)u=r[m],r.hasOwnProperty(m)&&l[m]!==u&&ku(s,m,u)}else for(var v in r)r.hasOwnProperty(v)&&ku(s,v,r[v])}function Dl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Df=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zr(s){return Df.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var oa=null;function Xn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var la=null,ca=null;function Ml(s){var r=Cs(s);if(r&&(s=r.stateNode)){var l=s[It]||null;e:switch(s=r.stateNode,r.type){case"input":if(On(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Rt(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var u=l[r];if(u!==s&&u.form===s.form){var m=u[It]||null;if(!m)throw Error(a(90));On(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(r=0;r<l.length;r++)u=l[r],u.form===s.form&&Il(u)}break e;case"textarea":rt(s,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&ra(s,!!l.multiple,r,!1)}}}var Rs=!1;function Pu(s,r,l){if(Rs)return s(r,l);Rs=!0;try{var u=s(r);return u}finally{if(Rs=!1,(la!==null||ca!==null)&&(Sd(),la&&(r=la,s=ca,ca=la=null,Ml(r),s)))for(r=0;r<s.length;r++)Ml(s[r])}}function nr(s,r){var l=s.stateNode;if(l===null)return null;var u=l[It]||null;if(u===null)return null;l=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(a(231,r,typeof l));return l}var ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wn=!1;if(ms)try{var sr={};Object.defineProperty(sr,"passive",{get:function(){Wn=!0}}),window.addEventListener("test",sr,sr),window.removeEventListener("test",sr,sr)}catch{Wn=!1}var Ds=null,Ha=null,ua=null;function Ol(){if(ua)return ua;var s,r=Ha,l=r.length,u,m="value"in Ds?Ds.value:Ds.textContent,v=m.length;for(s=0;s<l&&r[s]===m[s];s++);var T=l-s;for(u=1;u<=T&&r[l-u]===m[v-u];u++);return ua=m.slice(s,1<u?1-u:void 0)}function Ms(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function Os(){return!0}function kl(){return!1}function Gt(s){function r(l,u,m,v,T){this._reactName=l,this._targetInst=m,this.type=u,this.nativeEvent=v,this.target=T,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(l=s[I],this[I]=l?l(v):v[I]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Os:kl,this.isPropagationStopped=kl,this}return y(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Os)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Os)},persist:function(){},isPersistent:Os}),r}var nt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jr=Gt(nt),ar=y({},nt,{view:0,detail:0}),Lu=Gt(ar),eo,to,ks,ir=y({},ar,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ks&&(ks&&s.type==="mousemove"?(eo=s.screenX-ks.screenX,to=s.screenY-ks.screenY):to=eo=0,ks=s),eo)},movementY:function(s){return"movementY"in s?s.movementY:to}}),Zn=Gt(ir),Vu=y({},ir,{dataTransfer:0}),Mf=Gt(Vu),rr=y({},ar,{relatedTarget:0}),no=Gt(rr),Pl=y({},nt,{animationName:0,elapsedTime:0,pseudoElement:0}),so=Gt(Pl),Uu=y({},nt,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ao=Gt(Uu),Of=y({},nt,{data:0}),Ll=Gt(Of),or={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vl(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=qu[s])?!!r[s]:!1}function lr(){return Vl}var Bu=y({},ar,{key:function(s){if(s.key){var r=or[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Ms(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Fu[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lr,charCode:function(s){return s.type==="keypress"?Ms(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ms(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),io=Gt(Bu),zu=y({},ir,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ul=Gt(zu),da=y({},ar,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lr}),Hu=Gt(da),Gu=y({},nt,{propertyName:0,elapsedTime:0,pseudoElement:0}),$u=Gt(Gu),Yu=y({},ir,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ro=Gt(Yu),bn=y({},nt,{newState:0,oldState:0}),Qu=Gt(bn),Ku=[9,13,27,32],Ps=ms&&"CompositionEvent"in window,h=null;ms&&"documentMode"in document&&(h=document.documentMode);var b=ms&&"TextEvent"in window&&!h,E=ms&&(!Ps||h&&8<h&&11>=h),k=" ",K=!1;function te(s,r){switch(s){case"keyup":return Ku.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function de(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Qe=!1;function Lt(s,r){switch(s){case"compositionend":return de(r);case"keypress":return r.which!==32?null:(K=!0,k);case"textInput":return s=r.data,s===k&&K?null:s;default:return null}}function Ke(s,r){if(Qe)return s==="compositionend"||!Ps&&te(s,r)?(s=Ol(),ua=Ha=Ds=null,Qe=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return E&&r.locale!=="ko"?null:r.data;default:return null}}var $t={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vt(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!$t[s.type]:r==="textarea"}function ha(s,r,l,u){la?ca?ca.push(u):ca=[u]:la=u,r=kd(r,"onChange"),0<r.length&&(l=new Jr("onChange","change",null,l,u),s.push({event:l,listeners:r}))}var Jt=null,Ls=null;function Fl(s){V_(s,0)}function Xu(s){var r=Ss(s);if(Il(r))return s}function iy(s,r){if(s==="change")return r}var ry=!1;if(ms){var kf;if(ms){var Pf="oninput"in document;if(!Pf){var oy=document.createElement("div");oy.setAttribute("oninput","return;"),Pf=typeof oy.oninput=="function"}kf=Pf}else kf=!1;ry=kf&&(!document.documentMode||9<document.documentMode)}function ly(){Jt&&(Jt.detachEvent("onpropertychange",cy),Ls=Jt=null)}function cy(s){if(s.propertyName==="value"&&Xu(Ls)){var r=[];ha(r,Ls,s,Xn(s)),Pu(Fl,r)}}function ew(s,r,l){s==="focusin"?(ly(),Jt=r,Ls=l,Jt.attachEvent("onpropertychange",cy)):s==="focusout"&&ly()}function tw(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Xu(Ls)}function nw(s,r){if(s==="click")return Xu(r)}function sw(s,r){if(s==="input"||s==="change")return Xu(r)}function aw(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var kn=typeof Object.is=="function"?Object.is:aw;function ql(s,r){if(kn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var l=Object.keys(s),u=Object.keys(r);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var m=l[u];if(!qi.call(r,m)||!kn(s[m],r[m]))return!1}return!0}function uy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function dy(s,r){var l=uy(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=r&&u>=r)return{node:l,offset:r-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=uy(l)}}function hy(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?hy(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function fy(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Zi(s.document);r instanceof s.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)s=r.contentWindow;else break;r=Zi(s.document)}return r}function Lf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var iw=ms&&"documentMode"in document&&11>=document.documentMode,oo=null,Vf=null,Bl=null,Uf=!1;function my(s,r,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Uf||oo==null||oo!==Zi(u)||(u=oo,"selectionStart"in u&&Lf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Bl&&ql(Bl,u)||(Bl=u,u=kd(Vf,"onSelect"),0<u.length&&(r=new Jr("onSelect","select",null,r,l),s.push({event:r,listeners:u}),r.target=oo)))}function cr(s,r){var l={};return l[s.toLowerCase()]=r.toLowerCase(),l["Webkit"+s]="webkit"+r,l["Moz"+s]="moz"+r,l}var lo={animationend:cr("Animation","AnimationEnd"),animationiteration:cr("Animation","AnimationIteration"),animationstart:cr("Animation","AnimationStart"),transitionrun:cr("Transition","TransitionRun"),transitionstart:cr("Transition","TransitionStart"),transitioncancel:cr("Transition","TransitionCancel"),transitionend:cr("Transition","TransitionEnd")},Ff={},py={};ms&&(py=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function ur(s){if(Ff[s])return Ff[s];if(!lo[s])return s;var r=lo[s],l;for(l in r)if(r.hasOwnProperty(l)&&l in py)return Ff[s]=r[l];return s}var gy=ur("animationend"),vy=ur("animationiteration"),yy=ur("animationstart"),rw=ur("transitionrun"),ow=ur("transitionstart"),lw=ur("transitioncancel"),by=ur("transitionend"),_y=new Map,qf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");qf.push("scrollEnd");function ps(s,r){_y.set(s,r),fs(r,[s])}var xy=new WeakMap;function Jn(s,r){if(typeof s=="object"&&s!==null){var l=xy.get(s);return l!==void 0?l:(r={value:s,source:r,stack:Xr(r)},xy.set(s,r),r)}return{value:s,source:r,stack:Xr(r)}}var es=[],co=0,Bf=0;function Wu(){for(var s=co,r=Bf=co=0;r<s;){var l=es[r];es[r++]=null;var u=es[r];es[r++]=null;var m=es[r];es[r++]=null;var v=es[r];if(es[r++]=null,u!==null&&m!==null){var T=u.pending;T===null?m.next=m:(m.next=T.next,T.next=m),u.pending=m}v!==0&&Ny(l,m,v)}}function Zu(s,r,l,u){es[co++]=s,es[co++]=r,es[co++]=l,es[co++]=u,Bf|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function zf(s,r,l,u){return Zu(s,r,l,u),Ju(s)}function uo(s,r){return Zu(s,null,null,r),Ju(s)}function Ny(s,r,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var m=!1,v=s.return;v!==null;)v.childLanes|=l,u=v.alternate,u!==null&&(u.childLanes|=l),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(m=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,m&&r!==null&&(m=31-cn(l),s=v.hiddenUpdates,u=s[m],u===null?s[m]=[r]:u.push(r),r.lane=l|536870912),v):null}function Ju(s){if(50<fc)throw fc=0,Km=null,Error(a(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var ho={};function cw(s,r,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(s,r,l,u){return new cw(s,r,l,u)}function Hf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function fa(s,r){var l=s.alternate;return l===null?(l=Pn(s.tag,r,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=r,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,r=s.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Ey(s,r){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,r=l.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function ed(s,r,l,u,m,v){var T=0;if(u=s,typeof s=="function")Hf(s)&&(T=1);else if(typeof s=="string")T=dC(s,l,xe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case L:return s=Pn(31,l,r,m),s.elementType=L,s.lanes=v,s;case x:return dr(l.children,m,v,r);case R:T=8,m|=24;break;case A:return s=Pn(12,l,r,m|2),s.elementType=A,s.lanes=v,s;case F:return s=Pn(13,l,r,m),s.elementType=F,s.lanes=v,s;case $:return s=Pn(19,l,r,m),s.elementType=$,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case O:case U:T=10;break e;case q:T=9;break e;case P:T=11;break e;case V:T=14;break e;case S:T=16,u=null;break e}T=29,l=Error(a(130,s===null?"null":typeof s,"")),u=null}return r=Pn(T,l,r,m),r.elementType=s,r.type=u,r.lanes=v,r}function dr(s,r,l,u){return s=Pn(7,s,u,r),s.lanes=l,s}function Gf(s,r,l){return s=Pn(6,s,null,r),s.lanes=l,s}function $f(s,r,l){return r=Pn(4,s.children!==null?s.children:[],s.key,r),r.lanes=l,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var fo=[],mo=0,td=null,nd=0,ts=[],ns=0,hr=null,ma=1,pa="";function fr(s,r){fo[mo++]=nd,fo[mo++]=td,td=s,nd=r}function Ty(s,r,l){ts[ns++]=ma,ts[ns++]=pa,ts[ns++]=hr,hr=s;var u=ma;s=pa;var m=32-cn(u)-1;u&=~(1<<m),l+=1;var v=32-cn(r)+m;if(30<v){var T=m-m%5;v=(u&(1<<T)-1).toString(32),u>>=T,m-=T,ma=1<<32-cn(r)+m|l<<m|u,pa=v+s}else ma=1<<v|l<<m|u,pa=s}function Yf(s){s.return!==null&&(fr(s,1),Ty(s,1,0))}function Qf(s){for(;s===td;)td=fo[--mo],fo[mo]=null,nd=fo[--mo],fo[mo]=null;for(;s===hr;)hr=ts[--ns],ts[ns]=null,pa=ts[--ns],ts[ns]=null,ma=ts[--ns],ts[ns]=null}var _n=null,Tt=null,tt=!1,mr=null,Vs=!1,Kf=Error(a(519));function pr(s){var r=Error(a(418,""));throw Gl(Jn(r,s)),Kf}function Ay(s){var r=s.stateNode,l=s.type,u=s.memoizedProps;switch(r[Pt]=s,r[It]=u,l){case"dialog":Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":case"embed":Ge("load",r);break;case"video":case"audio":for(l=0;l<pc.length;l++)Ge(pc[l],r);break;case"source":Ge("error",r);break;case"img":case"image":case"link":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"input":Ge("invalid",r),Ji(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Wr(r);break;case"select":Ge("invalid",r);break;case"textarea":Ge("invalid",r),er(r,u.value,u.defaultValue,u.children),Wr(r)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||u.suppressHydrationWarning===!0||B_(r.textContent,l)?(u.popover!=null&&(Ge("beforetoggle",r),Ge("toggle",r)),u.onScroll!=null&&Ge("scroll",r),u.onScrollEnd!=null&&Ge("scrollend",r),u.onClick!=null&&(r.onclick=Pd),r=!0):r=!1,r||pr(s)}function jy(s){for(_n=s.return;_n;)switch(_n.tag){case 5:case 13:Vs=!1;return;case 27:case 3:Vs=!0;return;default:_n=_n.return}}function zl(s){if(s!==_n)return!1;if(!tt)return jy(s),tt=!0,!1;var r=s.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||dp(s.type,s.memoizedProps)),l=!l),l&&Tt&&pr(s),jy(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,r=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(r===0){Tt=vs(s.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++;s=s.nextSibling}Tt=null}}else r===27?(r=Tt,ri(s.type)?(s=pp,pp=null,Tt=s):Tt=r):Tt=_n?vs(s.stateNode.nextSibling):null;return!0}function Hl(){Tt=_n=null,tt=!1}function wy(){var s=mr;return s!==null&&(Cn===null?Cn=s:Cn.push.apply(Cn,s),mr=null),s}function Gl(s){mr===null?mr=[s]:mr.push(s)}var Xf=ee(null),gr=null,ga=null;function Ga(s,r,l){ce(Xf,r._currentValue),r._currentValue=l}function va(s){s._currentValue=Xf.current,le(Xf)}function Wf(s,r,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),s===l)break;s=s.return}}function Zf(s,r,l,u){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var v=m.dependencies;if(v!==null){var T=m.child;v=v.firstContext;e:for(;v!==null;){var I=v;v=m;for(var B=0;B<r.length;B++)if(I.context===r[B]){v.lanes|=l,I=v.alternate,I!==null&&(I.lanes|=l),Wf(v.return,l,s),u||(T=null);break e}v=I.next}}else if(m.tag===18){if(T=m.return,T===null)throw Error(a(341));T.lanes|=l,v=T.alternate,v!==null&&(v.lanes|=l),Wf(T,l,s),T=null}else T=m.child;if(T!==null)T.return=m;else for(T=m;T!==null;){if(T===s){T=null;break}if(m=T.sibling,m!==null){m.return=T.return,T=m;break}T=T.return}m=T}}function $l(s,r,l,u){s=null;for(var m=r,v=!1;m!==null;){if(!v){if((m.flags&524288)!==0)v=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var T=m.alternate;if(T===null)throw Error(a(387));if(T=T.memoizedProps,T!==null){var I=m.type;kn(m.pendingProps.value,T.value)||(s!==null?s.push(I):s=[I])}}else if(m===Ht.current){if(T=m.alternate,T===null)throw Error(a(387));T.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(xc):s=[xc])}m=m.return}s!==null&&Zf(r,s,l,u),r.flags|=262144}function sd(s){for(s=s.firstContext;s!==null;){if(!kn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function vr(s){gr=s,ga=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function un(s){return Cy(gr,s)}function ad(s,r){return gr===null&&vr(s),Cy(s,r)}function Cy(s,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},ga===null){if(s===null)throw Error(a(308));ga=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else ga=ga.next=r;return l}var uw=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){r.aborted=!0,s.forEach(function(l){return l()})}},dw=n.unstable_scheduleCallback,hw=n.unstable_NormalPriority,Ut={$$typeof:U,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jf(){return{controller:new uw,data:new Map,refCount:0}}function Yl(s){s.refCount--,s.refCount===0&&dw(hw,function(){s.controller.abort()})}var Ql=null,em=0,po=0,go=null;function fw(s,r){if(Ql===null){var l=Ql=[];em=0,po=np(),go={status:"pending",value:void 0,then:function(u){l.push(u)}}}return em++,r.then(Sy,Sy),r}function Sy(){if(--em===0&&Ql!==null){go!==null&&(go.status="fulfilled");var s=Ql;Ql=null,po=0,go=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function mw(s,r){var l=[],u={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return s.then(function(){u.status="fulfilled",u.value=r;for(var m=0;m<l.length;m++)(0,l[m])(r)},function(m){for(u.status="rejected",u.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),u}var Iy=Q.S;Q.S=function(s,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&fw(s,r),Iy!==null&&Iy(s,r)};var yr=ee(null);function tm(){var s=yr.current;return s!==null?s:pt.pooledCache}function id(s,r){r===null?ce(yr,yr.current):ce(yr,r.pool)}function Ry(){var s=tm();return s===null?null:{parent:Ut._currentValue,pool:s}}var Kl=Error(a(460)),Dy=Error(a(474)),rd=Error(a(542)),nm={then:function(){}};function My(s){return s=s.status,s==="fulfilled"||s==="rejected"}function od(){}function Oy(s,r,l){switch(l=s[l],l===void 0?s.push(r):l!==r&&(r.then(od,od),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Py(s),s;default:if(typeof r.status=="string")r.then(od,od);else{if(s=pt,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=r,s.status="pending",s.then(function(u){if(r.status==="pending"){var m=r;m.status="fulfilled",m.value=u}},function(u){if(r.status==="pending"){var m=r;m.status="rejected",m.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Py(s),s}throw Xl=r,Kl}}var Xl=null;function ky(){if(Xl===null)throw Error(a(459));var s=Xl;return Xl=null,s}function Py(s){if(s===Kl||s===rd)throw Error(a(483))}var $a=!1;function sm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function am(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ya(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Qa(s,r,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(at&2)!==0){var m=u.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),u.pending=r,r=Ju(s),Ny(s,null,l),r}return Zu(s,u,r,l),Ju(s)}function Wl(s,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,Al(s,l)}}function im(s,r){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var m=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var T={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?m=v=T:v=v.next=T,l=l.next}while(l!==null);v===null?m=v=r:v=v.next=r}else m=v=r;l={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=r:s.next=r,l.lastBaseUpdate=r}var rm=!1;function Zl(){if(rm){var s=go;if(s!==null)throw s}}function Jl(s,r,l,u){rm=!1;var m=s.updateQueue;$a=!1;var v=m.firstBaseUpdate,T=m.lastBaseUpdate,I=m.shared.pending;if(I!==null){m.shared.pending=null;var B=I,W=B.next;B.next=null,T===null?v=W:T.next=W,T=B;var se=s.alternate;se!==null&&(se=se.updateQueue,I=se.lastBaseUpdate,I!==T&&(I===null?se.firstBaseUpdate=W:I.next=W,se.lastBaseUpdate=B))}if(v!==null){var re=m.baseState;T=0,se=W=B=null,I=v;do{var Z=I.lane&-536870913,J=Z!==I.lane;if(J?(Xe&Z)===Z:(u&Z)===Z){Z!==0&&Z===po&&(rm=!0),se!==null&&(se=se.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var Ce=s,Te=I;Z=r;var ct=l;switch(Te.tag){case 1:if(Ce=Te.payload,typeof Ce=="function"){re=Ce.call(ct,re,Z);break e}re=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=Te.payload,Z=typeof Ce=="function"?Ce.call(ct,re,Z):Ce,Z==null)break e;re=y({},re,Z);break e;case 2:$a=!0}}Z=I.callback,Z!==null&&(s.flags|=64,J&&(s.flags|=8192),J=m.callbacks,J===null?m.callbacks=[Z]:J.push(Z))}else J={lane:Z,tag:I.tag,payload:I.payload,callback:I.callback,next:null},se===null?(W=se=J,B=re):se=se.next=J,T|=Z;if(I=I.next,I===null){if(I=m.shared.pending,I===null)break;J=I,I=J.next,J.next=null,m.lastBaseUpdate=J,m.shared.pending=null}}while(!0);se===null&&(B=re),m.baseState=B,m.firstBaseUpdate=W,m.lastBaseUpdate=se,v===null&&(m.shared.lanes=0),ni|=T,s.lanes=T,s.memoizedState=re}}function Ly(s,r){if(typeof s!="function")throw Error(a(191,s));s.call(r)}function Vy(s,r){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)Ly(l[s],r)}var vo=ee(null),ld=ee(0);function Uy(s,r){s=Ta,ce(ld,s),ce(vo,r),Ta=s|r.baseLanes}function om(){ce(ld,Ta),ce(vo,vo.current)}function lm(){Ta=ld.current,le(vo),le(ld)}var Ka=0,Fe=null,ot=null,Dt=null,cd=!1,yo=!1,br=!1,ud=0,ec=0,bo=null,pw=0;function wt(){throw Error(a(321))}function cm(s,r){if(r===null)return!1;for(var l=0;l<r.length&&l<s.length;l++)if(!kn(s[l],r[l]))return!1;return!0}function um(s,r,l,u,m,v){return Ka=v,Fe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Q.H=s===null||s.memoizedState===null?Nb:Eb,br=!1,v=l(u,m),br=!1,yo&&(v=qy(r,l,u,m)),Fy(s),v}function Fy(s){Q.H=gd;var r=ot!==null&&ot.next!==null;if(Ka=0,Dt=ot=Fe=null,cd=!1,ec=0,bo=null,r)throw Error(a(300));s===null||Yt||(s=s.dependencies,s!==null&&sd(s)&&(Yt=!0))}function qy(s,r,l,u){Fe=s;var m=0;do{if(yo&&(bo=null),ec=0,yo=!1,25<=m)throw Error(a(301));if(m+=1,Dt=ot=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}Q.H=Nw,v=r(l,u)}while(yo);return v}function gw(){var s=Q.H,r=s.useState()[0];return r=typeof r.then=="function"?tc(r):r,s=s.useState()[0],(ot!==null?ot.memoizedState:null)!==s&&(Fe.flags|=1024),r}function dm(){var s=ud!==0;return ud=0,s}function hm(s,r,l){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~l}function fm(s){if(cd){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}cd=!1}Ka=0,Dt=ot=Fe=null,yo=!1,ec=ud=0,bo=null}function jn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?Fe.memoizedState=Dt=s:Dt=Dt.next=s,Dt}function Mt(){if(ot===null){var s=Fe.alternate;s=s!==null?s.memoizedState:null}else s=ot.next;var r=Dt===null?Fe.memoizedState:Dt.next;if(r!==null)Dt=r,ot=s;else{if(s===null)throw Fe.alternate===null?Error(a(467)):Error(a(310));ot=s,s={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},Dt===null?Fe.memoizedState=Dt=s:Dt=Dt.next=s}return Dt}function mm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function tc(s){var r=ec;return ec+=1,bo===null&&(bo=[]),s=Oy(bo,s,r),r=Fe,(Dt===null?r.memoizedState:Dt.next)===null&&(r=r.alternate,Q.H=r===null||r.memoizedState===null?Nb:Eb),s}function dd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return tc(s);if(s.$$typeof===U)return un(s)}throw Error(a(438,String(s)))}function pm(s){var r=null,l=Fe.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var u=Fe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(m){return m.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=mm(),Fe.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(s),u=0;u<s;u++)l[u]=M;return r.index++,l}function ya(s,r){return typeof r=="function"?r(s):r}function hd(s){var r=Mt();return gm(r,ot,s)}function gm(s,r,l){var u=s.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=l;var m=s.baseQueue,v=u.pending;if(v!==null){if(m!==null){var T=m.next;m.next=v.next,v.next=T}r.baseQueue=m=v,u.pending=null}if(v=s.baseState,m===null)s.memoizedState=v;else{r=m.next;var I=T=null,B=null,W=r,se=!1;do{var re=W.lane&-536870913;if(re!==W.lane?(Xe&re)===re:(Ka&re)===re){var Z=W.revertLane;if(Z===0)B!==null&&(B=B.next={lane:0,revertLane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),re===po&&(se=!0);else if((Ka&Z)===Z){W=W.next,Z===po&&(se=!0);continue}else re={lane:0,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},B===null?(I=B=re,T=v):B=B.next=re,Fe.lanes|=Z,ni|=Z;re=W.action,br&&l(v,re),v=W.hasEagerState?W.eagerState:l(v,re)}else Z={lane:re,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},B===null?(I=B=Z,T=v):B=B.next=Z,Fe.lanes|=re,ni|=re;W=W.next}while(W!==null&&W!==r);if(B===null?T=v:B.next=I,!kn(v,s.memoizedState)&&(Yt=!0,se&&(l=go,l!==null)))throw l;s.memoizedState=v,s.baseState=T,s.baseQueue=B,u.lastRenderedState=v}return m===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function vm(s){var r=Mt(),l=r.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=s;var u=l.dispatch,m=l.pending,v=r.memoizedState;if(m!==null){l.pending=null;var T=m=m.next;do v=s(v,T.action),T=T.next;while(T!==m);kn(v,r.memoizedState)||(Yt=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),l.lastRenderedState=v}return[v,u]}function By(s,r,l){var u=Fe,m=Mt(),v=tt;if(v){if(l===void 0)throw Error(a(407));l=l()}else l=r();var T=!kn((ot||m).memoizedState,l);T&&(m.memoizedState=l,Yt=!0),m=m.queue;var I=Gy.bind(null,u,m,s);if(nc(2048,8,I,[s]),m.getSnapshot!==r||T||Dt!==null&&Dt.memoizedState.tag&1){if(u.flags|=2048,_o(9,fd(),Hy.bind(null,u,m,l,r),null),pt===null)throw Error(a(349));v||(Ka&124)!==0||zy(u,r,l)}return l}function zy(s,r,l){s.flags|=16384,s={getSnapshot:r,value:l},r=Fe.updateQueue,r===null?(r=mm(),Fe.updateQueue=r,r.stores=[s]):(l=r.stores,l===null?r.stores=[s]:l.push(s))}function Hy(s,r,l,u){r.value=l,r.getSnapshot=u,$y(r)&&Yy(s)}function Gy(s,r,l){return l(function(){$y(r)&&Yy(s)})}function $y(s){var r=s.getSnapshot;s=s.value;try{var l=r();return!kn(s,l)}catch{return!0}}function Yy(s){var r=uo(s,2);r!==null&&qn(r,s,2)}function ym(s){var r=jn();if(typeof s=="function"){var l=s;if(s=l(),br){Mn(!0);try{l()}finally{Mn(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:s},r}function Qy(s,r,l,u){return s.baseState=l,gm(s,ot,typeof u=="function"?u:ya)}function vw(s,r,l,u,m){if(pd(s))throw Error(a(485));if(s=r.action,s!==null){var v={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){v.listeners.push(T)}};Q.T!==null?l(!0):v.isTransition=!1,u(v),l=r.pending,l===null?(v.next=r.pending=v,Ky(r,v)):(v.next=l.next,r.pending=l.next=v)}}function Ky(s,r){var l=r.action,u=r.payload,m=s.state;if(r.isTransition){var v=Q.T,T={};Q.T=T;try{var I=l(m,u),B=Q.S;B!==null&&B(T,I),Xy(s,r,I)}catch(W){bm(s,r,W)}finally{Q.T=v}}else try{v=l(m,u),Xy(s,r,v)}catch(W){bm(s,r,W)}}function Xy(s,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Wy(s,r,u)},function(u){return bm(s,r,u)}):Wy(s,r,l)}function Wy(s,r,l){r.status="fulfilled",r.value=l,Zy(r),s.state=l,r=s.pending,r!==null&&(l=r.next,l===r?s.pending=null:(l=l.next,r.next=l,Ky(s,l)))}function bm(s,r,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=l,Zy(r),r=r.next;while(r!==u)}s.action=null}function Zy(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function Jy(s,r){return r}function eb(s,r){if(tt){var l=pt.formState;if(l!==null){e:{var u=Fe;if(tt){if(Tt){t:{for(var m=Tt,v=Vs;m.nodeType!==8;){if(!v){m=null;break t}if(m=vs(m.nextSibling),m===null){m=null;break t}}v=m.data,m=v==="F!"||v==="F"?m:null}if(m){Tt=vs(m.nextSibling),u=m.data==="F!";break e}}pr(u)}u=!1}u&&(r=l[0])}}return l=jn(),l.memoizedState=l.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jy,lastRenderedState:r},l.queue=u,l=bb.bind(null,Fe,u),u.dispatch=l,u=ym(!1),v=Tm.bind(null,Fe,!1,u.queue),u=jn(),m={state:r,dispatch:null,action:s,pending:null},u.queue=m,l=vw.bind(null,Fe,m,v,l),m.dispatch=l,u.memoizedState=s,[r,l,!1]}function tb(s){var r=Mt();return nb(r,ot,s)}function nb(s,r,l){if(r=gm(s,r,Jy)[0],s=hd(ya)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=tc(r)}catch(T){throw T===Kl?rd:T}else u=r;r=Mt();var m=r.queue,v=m.dispatch;return l!==r.memoizedState&&(Fe.flags|=2048,_o(9,fd(),yw.bind(null,m,l),null)),[u,v,s]}function yw(s,r){s.action=r}function sb(s){var r=Mt(),l=ot;if(l!==null)return nb(r,l,s);Mt(),r=r.memoizedState,l=Mt();var u=l.queue.dispatch;return l.memoizedState=s,[r,u,!1]}function _o(s,r,l,u){return s={tag:s,create:l,deps:u,inst:r,next:null},r=Fe.updateQueue,r===null&&(r=mm(),Fe.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,r.lastEffect=s),s}function fd(){return{destroy:void 0,resource:void 0}}function ab(){return Mt().memoizedState}function md(s,r,l,u){var m=jn();u=u===void 0?null:u,Fe.flags|=s,m.memoizedState=_o(1|r,fd(),l,u)}function nc(s,r,l,u){var m=Mt();u=u===void 0?null:u;var v=m.memoizedState.inst;ot!==null&&u!==null&&cm(u,ot.memoizedState.deps)?m.memoizedState=_o(r,v,l,u):(Fe.flags|=s,m.memoizedState=_o(1|r,v,l,u))}function ib(s,r){md(8390656,8,s,r)}function rb(s,r){nc(2048,8,s,r)}function ob(s,r){return nc(4,2,s,r)}function lb(s,r){return nc(4,4,s,r)}function cb(s,r){if(typeof r=="function"){s=s();var l=r(s);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function ub(s,r,l){l=l!=null?l.concat([s]):null,nc(4,4,cb.bind(null,r,s),l)}function _m(){}function db(s,r){var l=Mt();r=r===void 0?null:r;var u=l.memoizedState;return r!==null&&cm(r,u[1])?u[0]:(l.memoizedState=[s,r],s)}function hb(s,r){var l=Mt();r=r===void 0?null:r;var u=l.memoizedState;if(r!==null&&cm(r,u[1]))return u[0];if(u=s(),br){Mn(!0);try{s()}finally{Mn(!1)}}return l.memoizedState=[u,r],u}function xm(s,r,l){return l===void 0||(Ka&1073741824)!==0?s.memoizedState=r:(s.memoizedState=l,s=p_(),Fe.lanes|=s,ni|=s,l)}function fb(s,r,l,u){return kn(l,r)?l:vo.current!==null?(s=xm(s,l,u),kn(s,r)||(Yt=!0),s):(Ka&42)===0?(Yt=!0,s.memoizedState=l):(s=p_(),Fe.lanes|=s,ni|=s,r)}function mb(s,r,l,u,m){var v=ne.p;ne.p=v!==0&&8>v?v:8;var T=Q.T,I={};Q.T=I,Tm(s,!1,r,l);try{var B=m(),W=Q.S;if(W!==null&&W(I,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var se=mw(B,u);sc(s,r,se,Fn(s))}else sc(s,r,u,Fn(s))}catch(re){sc(s,r,{then:function(){},status:"rejected",reason:re},Fn())}finally{ne.p=v,Q.T=T}}function bw(){}function Nm(s,r,l,u){if(s.tag!==5)throw Error(a(476));var m=pb(s).queue;mb(s,m,r,he,l===null?bw:function(){return gb(s),l(u)})}function pb(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:he,baseState:he,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:he},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:l},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function gb(s){var r=pb(s).next.queue;sc(s,r,{},Fn())}function Em(){return un(xc)}function vb(){return Mt().memoizedState}function yb(){return Mt().memoizedState}function _w(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var l=Fn();s=Ya(l);var u=Qa(r,s,l);u!==null&&(qn(u,r,l),Wl(u,r,l)),r={cache:Jf()},s.payload=r;return}r=r.return}}function xw(s,r,l){var u=Fn();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},pd(s)?_b(r,l):(l=zf(s,r,l,u),l!==null&&(qn(l,s,u),xb(l,r,u)))}function bb(s,r,l){var u=Fn();sc(s,r,l,u)}function sc(s,r,l,u){var m={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(pd(s))_b(r,m);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var T=r.lastRenderedState,I=v(T,l);if(m.hasEagerState=!0,m.eagerState=I,kn(I,T))return Zu(s,r,m,0),pt===null&&Wu(),!1}catch{}finally{}if(l=zf(s,r,m,u),l!==null)return qn(l,s,u),xb(l,r,u),!0}return!1}function Tm(s,r,l,u){if(u={lane:2,revertLane:np(),action:u,hasEagerState:!1,eagerState:null,next:null},pd(s)){if(r)throw Error(a(479))}else r=zf(s,l,u,2),r!==null&&qn(r,s,2)}function pd(s){var r=s.alternate;return s===Fe||r!==null&&r===Fe}function _b(s,r){yo=cd=!0;var l=s.pending;l===null?r.next=r:(r.next=l.next,l.next=r),s.pending=r}function xb(s,r,l){if((l&4194048)!==0){var u=r.lanes;u&=s.pendingLanes,l|=u,r.lanes=l,Al(s,l)}}var gd={readContext:un,use:dd,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useLayoutEffect:wt,useInsertionEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useSyncExternalStore:wt,useId:wt,useHostTransitionStatus:wt,useFormState:wt,useActionState:wt,useOptimistic:wt,useMemoCache:wt,useCacheRefresh:wt},Nb={readContext:un,use:dd,useCallback:function(s,r){return jn().memoizedState=[s,r===void 0?null:r],s},useContext:un,useEffect:ib,useImperativeHandle:function(s,r,l){l=l!=null?l.concat([s]):null,md(4194308,4,cb.bind(null,r,s),l)},useLayoutEffect:function(s,r){return md(4194308,4,s,r)},useInsertionEffect:function(s,r){md(4,2,s,r)},useMemo:function(s,r){var l=jn();r=r===void 0?null:r;var u=s();if(br){Mn(!0);try{s()}finally{Mn(!1)}}return l.memoizedState=[u,r],u},useReducer:function(s,r,l){var u=jn();if(l!==void 0){var m=l(r);if(br){Mn(!0);try{l(r)}finally{Mn(!1)}}}else m=r;return u.memoizedState=u.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},u.queue=s,s=s.dispatch=xw.bind(null,Fe,s),[u.memoizedState,s]},useRef:function(s){var r=jn();return s={current:s},r.memoizedState=s},useState:function(s){s=ym(s);var r=s.queue,l=bb.bind(null,Fe,r);return r.dispatch=l,[s.memoizedState,l]},useDebugValue:_m,useDeferredValue:function(s,r){var l=jn();return xm(l,s,r)},useTransition:function(){var s=ym(!1);return s=mb.bind(null,Fe,s.queue,!0,!1),jn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,l){var u=Fe,m=jn();if(tt){if(l===void 0)throw Error(a(407));l=l()}else{if(l=r(),pt===null)throw Error(a(349));(Xe&124)!==0||zy(u,r,l)}m.memoizedState=l;var v={value:l,getSnapshot:r};return m.queue=v,ib(Gy.bind(null,u,v,s),[s]),u.flags|=2048,_o(9,fd(),Hy.bind(null,u,v,l,r),null),l},useId:function(){var s=jn(),r=pt.identifierPrefix;if(tt){var l=pa,u=ma;l=(u&~(1<<32-cn(u)-1)).toString(32)+l,r="«"+r+"R"+l,l=ud++,0<l&&(r+="H"+l.toString(32)),r+="»"}else l=pw++,r="«"+r+"r"+l.toString(32)+"»";return s.memoizedState=r},useHostTransitionStatus:Em,useFormState:eb,useActionState:eb,useOptimistic:function(s){var r=jn();r.memoizedState=r.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=Tm.bind(null,Fe,!0,l),l.dispatch=r,[s,r]},useMemoCache:pm,useCacheRefresh:function(){return jn().memoizedState=_w.bind(null,Fe)}},Eb={readContext:un,use:dd,useCallback:db,useContext:un,useEffect:rb,useImperativeHandle:ub,useInsertionEffect:ob,useLayoutEffect:lb,useMemo:hb,useReducer:hd,useRef:ab,useState:function(){return hd(ya)},useDebugValue:_m,useDeferredValue:function(s,r){var l=Mt();return fb(l,ot.memoizedState,s,r)},useTransition:function(){var s=hd(ya)[0],r=Mt().memoizedState;return[typeof s=="boolean"?s:tc(s),r]},useSyncExternalStore:By,useId:vb,useHostTransitionStatus:Em,useFormState:tb,useActionState:tb,useOptimistic:function(s,r){var l=Mt();return Qy(l,ot,s,r)},useMemoCache:pm,useCacheRefresh:yb},Nw={readContext:un,use:dd,useCallback:db,useContext:un,useEffect:rb,useImperativeHandle:ub,useInsertionEffect:ob,useLayoutEffect:lb,useMemo:hb,useReducer:vm,useRef:ab,useState:function(){return vm(ya)},useDebugValue:_m,useDeferredValue:function(s,r){var l=Mt();return ot===null?xm(l,s,r):fb(l,ot.memoizedState,s,r)},useTransition:function(){var s=vm(ya)[0],r=Mt().memoizedState;return[typeof s=="boolean"?s:tc(s),r]},useSyncExternalStore:By,useId:vb,useHostTransitionStatus:Em,useFormState:sb,useActionState:sb,useOptimistic:function(s,r){var l=Mt();return ot!==null?Qy(l,ot,s,r):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:pm,useCacheRefresh:yb},xo=null,ac=0;function vd(s){var r=ac;return ac+=1,xo===null&&(xo=[]),Oy(xo,s,r)}function ic(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function yd(s,r){throw r.$$typeof===_?Error(a(525)):(s=Object.prototype.toString.call(r),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Tb(s){var r=s._init;return r(s._payload)}function Ab(s){function r(Y,G){if(s){var X=Y.deletions;X===null?(Y.deletions=[G],Y.flags|=16):X.push(G)}}function l(Y,G){if(!s)return null;for(;G!==null;)r(Y,G),G=G.sibling;return null}function u(Y){for(var G=new Map;Y!==null;)Y.key!==null?G.set(Y.key,Y):G.set(Y.index,Y),Y=Y.sibling;return G}function m(Y,G){return Y=fa(Y,G),Y.index=0,Y.sibling=null,Y}function v(Y,G,X){return Y.index=X,s?(X=Y.alternate,X!==null?(X=X.index,X<G?(Y.flags|=67108866,G):X):(Y.flags|=67108866,G)):(Y.flags|=1048576,G)}function T(Y){return s&&Y.alternate===null&&(Y.flags|=67108866),Y}function I(Y,G,X,ae){return G===null||G.tag!==6?(G=Gf(X,Y.mode,ae),G.return=Y,G):(G=m(G,X),G.return=Y,G)}function B(Y,G,X,ae){var ye=X.type;return ye===x?se(Y,G,X.props.children,ae,X.key):G!==null&&(G.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===S&&Tb(ye)===G.type)?(G=m(G,X.props),ic(G,X),G.return=Y,G):(G=ed(X.type,X.key,X.props,null,Y.mode,ae),ic(G,X),G.return=Y,G)}function W(Y,G,X,ae){return G===null||G.tag!==4||G.stateNode.containerInfo!==X.containerInfo||G.stateNode.implementation!==X.implementation?(G=$f(X,Y.mode,ae),G.return=Y,G):(G=m(G,X.children||[]),G.return=Y,G)}function se(Y,G,X,ae,ye){return G===null||G.tag!==7?(G=dr(X,Y.mode,ae,ye),G.return=Y,G):(G=m(G,X),G.return=Y,G)}function re(Y,G,X){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Gf(""+G,Y.mode,X),G.return=Y,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case N:return X=ed(G.type,G.key,G.props,null,Y.mode,X),ic(X,G),X.return=Y,X;case j:return G=$f(G,Y.mode,X),G.return=Y,G;case S:var ae=G._init;return G=ae(G._payload),re(Y,G,X)}if(De(G)||C(G))return G=dr(G,Y.mode,X,null),G.return=Y,G;if(typeof G.then=="function")return re(Y,vd(G),X);if(G.$$typeof===U)return re(Y,ad(Y,G),X);yd(Y,G)}return null}function Z(Y,G,X,ae){var ye=G!==null?G.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return ye!==null?null:I(Y,G,""+X,ae);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case N:return X.key===ye?B(Y,G,X,ae):null;case j:return X.key===ye?W(Y,G,X,ae):null;case S:return ye=X._init,X=ye(X._payload),Z(Y,G,X,ae)}if(De(X)||C(X))return ye!==null?null:se(Y,G,X,ae,null);if(typeof X.then=="function")return Z(Y,G,vd(X),ae);if(X.$$typeof===U)return Z(Y,G,ad(Y,X),ae);yd(Y,X)}return null}function J(Y,G,X,ae,ye){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Y=Y.get(X)||null,I(G,Y,""+ae,ye);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case N:return Y=Y.get(ae.key===null?X:ae.key)||null,B(G,Y,ae,ye);case j:return Y=Y.get(ae.key===null?X:ae.key)||null,W(G,Y,ae,ye);case S:var ze=ae._init;return ae=ze(ae._payload),J(Y,G,X,ae,ye)}if(De(ae)||C(ae))return Y=Y.get(X)||null,se(G,Y,ae,ye,null);if(typeof ae.then=="function")return J(Y,G,X,vd(ae),ye);if(ae.$$typeof===U)return J(Y,G,X,ad(G,ae),ye);yd(G,ae)}return null}function Ce(Y,G,X,ae){for(var ye=null,ze=null,be=G,Ae=G=0,Kt=null;be!==null&&Ae<X.length;Ae++){be.index>Ae?(Kt=be,be=null):Kt=be.sibling;var et=Z(Y,be,X[Ae],ae);if(et===null){be===null&&(be=Kt);break}s&&be&&et.alternate===null&&r(Y,be),G=v(et,G,Ae),ze===null?ye=et:ze.sibling=et,ze=et,be=Kt}if(Ae===X.length)return l(Y,be),tt&&fr(Y,Ae),ye;if(be===null){for(;Ae<X.length;Ae++)be=re(Y,X[Ae],ae),be!==null&&(G=v(be,G,Ae),ze===null?ye=be:ze.sibling=be,ze=be);return tt&&fr(Y,Ae),ye}for(be=u(be);Ae<X.length;Ae++)Kt=J(be,Y,Ae,X[Ae],ae),Kt!==null&&(s&&Kt.alternate!==null&&be.delete(Kt.key===null?Ae:Kt.key),G=v(Kt,G,Ae),ze===null?ye=Kt:ze.sibling=Kt,ze=Kt);return s&&be.forEach(function(di){return r(Y,di)}),tt&&fr(Y,Ae),ye}function Te(Y,G,X,ae){if(X==null)throw Error(a(151));for(var ye=null,ze=null,be=G,Ae=G=0,Kt=null,et=X.next();be!==null&&!et.done;Ae++,et=X.next()){be.index>Ae?(Kt=be,be=null):Kt=be.sibling;var di=Z(Y,be,et.value,ae);if(di===null){be===null&&(be=Kt);break}s&&be&&di.alternate===null&&r(Y,be),G=v(di,G,Ae),ze===null?ye=di:ze.sibling=di,ze=di,be=Kt}if(et.done)return l(Y,be),tt&&fr(Y,Ae),ye;if(be===null){for(;!et.done;Ae++,et=X.next())et=re(Y,et.value,ae),et!==null&&(G=v(et,G,Ae),ze===null?ye=et:ze.sibling=et,ze=et);return tt&&fr(Y,Ae),ye}for(be=u(be);!et.done;Ae++,et=X.next())et=J(be,Y,Ae,et.value,ae),et!==null&&(s&&et.alternate!==null&&be.delete(et.key===null?Ae:et.key),G=v(et,G,Ae),ze===null?ye=et:ze.sibling=et,ze=et);return s&&be.forEach(function(EC){return r(Y,EC)}),tt&&fr(Y,Ae),ye}function ct(Y,G,X,ae){if(typeof X=="object"&&X!==null&&X.type===x&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case N:e:{for(var ye=X.key;G!==null;){if(G.key===ye){if(ye=X.type,ye===x){if(G.tag===7){l(Y,G.sibling),ae=m(G,X.props.children),ae.return=Y,Y=ae;break e}}else if(G.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===S&&Tb(ye)===G.type){l(Y,G.sibling),ae=m(G,X.props),ic(ae,X),ae.return=Y,Y=ae;break e}l(Y,G);break}else r(Y,G);G=G.sibling}X.type===x?(ae=dr(X.props.children,Y.mode,ae,X.key),ae.return=Y,Y=ae):(ae=ed(X.type,X.key,X.props,null,Y.mode,ae),ic(ae,X),ae.return=Y,Y=ae)}return T(Y);case j:e:{for(ye=X.key;G!==null;){if(G.key===ye)if(G.tag===4&&G.stateNode.containerInfo===X.containerInfo&&G.stateNode.implementation===X.implementation){l(Y,G.sibling),ae=m(G,X.children||[]),ae.return=Y,Y=ae;break e}else{l(Y,G);break}else r(Y,G);G=G.sibling}ae=$f(X,Y.mode,ae),ae.return=Y,Y=ae}return T(Y);case S:return ye=X._init,X=ye(X._payload),ct(Y,G,X,ae)}if(De(X))return Ce(Y,G,X,ae);if(C(X)){if(ye=C(X),typeof ye!="function")throw Error(a(150));return X=ye.call(X),Te(Y,G,X,ae)}if(typeof X.then=="function")return ct(Y,G,vd(X),ae);if(X.$$typeof===U)return ct(Y,G,ad(Y,X),ae);yd(Y,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,G!==null&&G.tag===6?(l(Y,G.sibling),ae=m(G,X),ae.return=Y,Y=ae):(l(Y,G),ae=Gf(X,Y.mode,ae),ae.return=Y,Y=ae),T(Y)):l(Y,G)}return function(Y,G,X,ae){try{ac=0;var ye=ct(Y,G,X,ae);return xo=null,ye}catch(be){if(be===Kl||be===rd)throw be;var ze=Pn(29,be,null,Y.mode);return ze.lanes=ae,ze.return=Y,ze}finally{}}}var No=Ab(!0),jb=Ab(!1),ss=ee(null),Us=null;function Xa(s){var r=s.alternate;ce(Ft,Ft.current&1),ce(ss,s),Us===null&&(r===null||vo.current!==null||r.memoizedState!==null)&&(Us=s)}function wb(s){if(s.tag===22){if(ce(Ft,Ft.current),ce(ss,s),Us===null){var r=s.alternate;r!==null&&r.memoizedState!==null&&(Us=s)}}else Wa()}function Wa(){ce(Ft,Ft.current),ce(ss,ss.current)}function ba(s){le(ss),Us===s&&(Us=null),le(Ft)}var Ft=ee(0);function bd(s){for(var r=s;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||mp(l)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function Am(s,r,l,u){r=s.memoizedState,l=l(u,r),l=l==null?r:y({},r,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var jm={enqueueSetState:function(s,r,l){s=s._reactInternals;var u=Fn(),m=Ya(u);m.payload=r,l!=null&&(m.callback=l),r=Qa(s,m,u),r!==null&&(qn(r,s,u),Wl(r,s,u))},enqueueReplaceState:function(s,r,l){s=s._reactInternals;var u=Fn(),m=Ya(u);m.tag=1,m.payload=r,l!=null&&(m.callback=l),r=Qa(s,m,u),r!==null&&(qn(r,s,u),Wl(r,s,u))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var l=Fn(),u=Ya(l);u.tag=2,r!=null&&(u.callback=r),r=Qa(s,u,l),r!==null&&(qn(r,s,l),Wl(r,s,l))}};function Cb(s,r,l,u,m,v,T){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,v,T):r.prototype&&r.prototype.isPureReactComponent?!ql(l,u)||!ql(m,v):!0}function Sb(s,r,l,u){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,u),r.state!==s&&jm.enqueueReplaceState(r,r.state,null)}function _r(s,r){var l=r;if("ref"in r){l={};for(var u in r)u!=="ref"&&(l[u]=r[u])}if(s=s.defaultProps){l===r&&(l=y({},l));for(var m in s)l[m]===void 0&&(l[m]=s[m])}return l}var _d=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Ib(s){_d(s)}function Rb(s){console.error(s)}function Db(s){_d(s)}function xd(s,r){try{var l=s.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function Mb(s,r,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function wm(s,r,l){return l=Ya(l),l.tag=3,l.payload={element:null},l.callback=function(){xd(s,r)},l}function Ob(s){return s=Ya(s),s.tag=3,s}function kb(s,r,l,u){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var v=u.value;s.payload=function(){return m(v)},s.callback=function(){Mb(r,l,u)}}var T=l.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(s.callback=function(){Mb(r,l,u),typeof m!="function"&&(si===null?si=new Set([this]):si.add(this));var I=u.stack;this.componentDidCatch(u.value,{componentStack:I!==null?I:""})})}function Ew(s,r,l,u,m){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=l.alternate,r!==null&&$l(r,l,m,!0),l=ss.current,l!==null){switch(l.tag){case 13:return Us===null?Wm():l.alternate===null&&At===0&&(At=3),l.flags&=-257,l.flags|=65536,l.lanes=m,u===nm?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([u]):r.add(u),Jm(s,u,m)),!1;case 22:return l.flags|=65536,u===nm?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([u]):l.add(u)),Jm(s,u,m)),!1}throw Error(a(435,l.tag))}return Jm(s,u,m),Wm(),!1}if(tt)return r=ss.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=m,u!==Kf&&(s=Error(a(422),{cause:u}),Gl(Jn(s,l)))):(u!==Kf&&(r=Error(a(423),{cause:u}),Gl(Jn(r,l))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,u=Jn(u,l),m=wm(s.stateNode,u,m),im(s,m),At!==4&&(At=2)),!1;var v=Error(a(520),{cause:u});if(v=Jn(v,l),hc===null?hc=[v]:hc.push(v),At!==4&&(At=2),r===null)return!0;u=Jn(u,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,s=m&-m,l.lanes|=s,s=wm(l.stateNode,u,s),im(l,s),!1;case 1:if(r=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(si===null||!si.has(v))))return l.flags|=65536,m&=-m,l.lanes|=m,m=Ob(m),kb(m,s,l,u),im(l,m),!1}l=l.return}while(l!==null);return!1}var Pb=Error(a(461)),Yt=!1;function en(s,r,l,u){r.child=s===null?jb(r,null,l,u):No(r,s.child,l,u)}function Lb(s,r,l,u,m){l=l.render;var v=r.ref;if("ref"in u){var T={};for(var I in u)I!=="ref"&&(T[I]=u[I])}else T=u;return vr(r),u=um(s,r,l,T,v,m),I=dm(),s!==null&&!Yt?(hm(s,r,m),_a(s,r,m)):(tt&&I&&Yf(r),r.flags|=1,en(s,r,u,m),r.child)}function Vb(s,r,l,u,m){if(s===null){var v=l.type;return typeof v=="function"&&!Hf(v)&&v.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=v,Ub(s,r,v,u,m)):(s=ed(l.type,null,u,r,r.mode,m),s.ref=r.ref,s.return=r,r.child=s)}if(v=s.child,!km(s,m)){var T=v.memoizedProps;if(l=l.compare,l=l!==null?l:ql,l(T,u)&&s.ref===r.ref)return _a(s,r,m)}return r.flags|=1,s=fa(v,u),s.ref=r.ref,s.return=r,r.child=s}function Ub(s,r,l,u,m){if(s!==null){var v=s.memoizedProps;if(ql(v,u)&&s.ref===r.ref)if(Yt=!1,r.pendingProps=u=v,km(s,m))(s.flags&131072)!==0&&(Yt=!0);else return r.lanes=s.lanes,_a(s,r,m)}return Cm(s,r,l,u,m)}function Fb(s,r,l){var u=r.pendingProps,m=u.children,v=s!==null?s.memoizedState:null;if(u.mode==="hidden"){if((r.flags&128)!==0){if(u=v!==null?v.baseLanes|l:l,s!==null){for(m=r.child=s.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;r.childLanes=v&~u}else r.childLanes=0,r.child=null;return qb(s,r,u,l)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&id(r,v!==null?v.cachePool:null),v!==null?Uy(r,v):om(),wb(r);else return r.lanes=r.childLanes=536870912,qb(s,r,v!==null?v.baseLanes|l:l,l)}else v!==null?(id(r,v.cachePool),Uy(r,v),Wa(),r.memoizedState=null):(s!==null&&id(r,null),om(),Wa());return en(s,r,m,l),r.child}function qb(s,r,l,u){var m=tm();return m=m===null?null:{parent:Ut._currentValue,pool:m},r.memoizedState={baseLanes:l,cachePool:m},s!==null&&id(r,null),om(),wb(r),s!==null&&$l(s,r,u,!0),null}function Nd(s,r){var l=r.ref;if(l===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(a(284));(s===null||s.ref!==l)&&(r.flags|=4194816)}}function Cm(s,r,l,u,m){return vr(r),l=um(s,r,l,u,void 0,m),u=dm(),s!==null&&!Yt?(hm(s,r,m),_a(s,r,m)):(tt&&u&&Yf(r),r.flags|=1,en(s,r,l,m),r.child)}function Bb(s,r,l,u,m,v){return vr(r),r.updateQueue=null,l=qy(r,u,l,m),Fy(s),u=dm(),s!==null&&!Yt?(hm(s,r,v),_a(s,r,v)):(tt&&u&&Yf(r),r.flags|=1,en(s,r,l,v),r.child)}function zb(s,r,l,u,m){if(vr(r),r.stateNode===null){var v=ho,T=l.contextType;typeof T=="object"&&T!==null&&(v=un(T)),v=new l(u,v),r.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=jm,r.stateNode=v,v._reactInternals=r,v=r.stateNode,v.props=u,v.state=r.memoizedState,v.refs={},sm(r),T=l.contextType,v.context=typeof T=="object"&&T!==null?un(T):ho,v.state=r.memoizedState,T=l.getDerivedStateFromProps,typeof T=="function"&&(Am(r,l,T,u),v.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(T=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),T!==v.state&&jm.enqueueReplaceState(v,v.state,null),Jl(r,u,v,m),Zl(),v.state=r.memoizedState),typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(s===null){v=r.stateNode;var I=r.memoizedProps,B=_r(l,I);v.props=B;var W=v.context,se=l.contextType;T=ho,typeof se=="object"&&se!==null&&(T=un(se));var re=l.getDerivedStateFromProps;se=typeof re=="function"||typeof v.getSnapshotBeforeUpdate=="function",I=r.pendingProps!==I,se||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(I||W!==T)&&Sb(r,v,u,T),$a=!1;var Z=r.memoizedState;v.state=Z,Jl(r,u,v,m),Zl(),W=r.memoizedState,I||Z!==W||$a?(typeof re=="function"&&(Am(r,l,re,u),W=r.memoizedState),(B=$a||Cb(r,l,B,u,Z,W,T))?(se||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=W),v.props=u,v.state=W,v.context=T,u=B):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{v=r.stateNode,am(s,r),T=r.memoizedProps,se=_r(l,T),v.props=se,re=r.pendingProps,Z=v.context,W=l.contextType,B=ho,typeof W=="object"&&W!==null&&(B=un(W)),I=l.getDerivedStateFromProps,(W=typeof I=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(T!==re||Z!==B)&&Sb(r,v,u,B),$a=!1,Z=r.memoizedState,v.state=Z,Jl(r,u,v,m),Zl();var J=r.memoizedState;T!==re||Z!==J||$a||s!==null&&s.dependencies!==null&&sd(s.dependencies)?(typeof I=="function"&&(Am(r,l,I,u),J=r.memoizedState),(se=$a||Cb(r,l,se,u,Z,J,B)||s!==null&&s.dependencies!==null&&sd(s.dependencies))?(W||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,J,B),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,J,B)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=J),v.props=u,v.state=J,v.context=B,u=se):(typeof v.componentDidUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(r.flags|=1024),u=!1)}return v=u,Nd(s,r),u=(r.flags&128)!==0,v||u?(v=r.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:v.render(),r.flags|=1,s!==null&&u?(r.child=No(r,s.child,null,m),r.child=No(r,null,l,m)):en(s,r,l,m),r.memoizedState=v.state,s=r.child):s=_a(s,r,m),s}function Hb(s,r,l,u){return Hl(),r.flags|=256,en(s,r,l,u),r.child}var Sm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Im(s){return{baseLanes:s,cachePool:Ry()}}function Rm(s,r,l){return s=s!==null?s.childLanes&~l:0,r&&(s|=as),s}function Gb(s,r,l){var u=r.pendingProps,m=!1,v=(r.flags&128)!==0,T;if((T=v)||(T=s!==null&&s.memoizedState===null?!1:(Ft.current&2)!==0),T&&(m=!0,r.flags&=-129),T=(r.flags&32)!==0,r.flags&=-33,s===null){if(tt){if(m?Xa(r):Wa(),tt){var I=Tt,B;if(B=I){e:{for(B=I,I=Vs;B.nodeType!==8;){if(!I){I=null;break e}if(B=vs(B.nextSibling),B===null){I=null;break e}}I=B}I!==null?(r.memoizedState={dehydrated:I,treeContext:hr!==null?{id:ma,overflow:pa}:null,retryLane:536870912,hydrationErrors:null},B=Pn(18,null,null,0),B.stateNode=I,B.return=r,r.child=B,_n=r,Tt=null,B=!0):B=!1}B||pr(r)}if(I=r.memoizedState,I!==null&&(I=I.dehydrated,I!==null))return mp(I)?r.lanes=32:r.lanes=536870912,null;ba(r)}return I=u.children,u=u.fallback,m?(Wa(),m=r.mode,I=Ed({mode:"hidden",children:I},m),u=dr(u,m,l,null),I.return=r,u.return=r,I.sibling=u,r.child=I,m=r.child,m.memoizedState=Im(l),m.childLanes=Rm(s,T,l),r.memoizedState=Sm,u):(Xa(r),Dm(r,I))}if(B=s.memoizedState,B!==null&&(I=B.dehydrated,I!==null)){if(v)r.flags&256?(Xa(r),r.flags&=-257,r=Mm(s,r,l)):r.memoizedState!==null?(Wa(),r.child=s.child,r.flags|=128,r=null):(Wa(),m=u.fallback,I=r.mode,u=Ed({mode:"visible",children:u.children},I),m=dr(m,I,l,null),m.flags|=2,u.return=r,m.return=r,u.sibling=m,r.child=u,No(r,s.child,null,l),u=r.child,u.memoizedState=Im(l),u.childLanes=Rm(s,T,l),r.memoizedState=Sm,r=m);else if(Xa(r),mp(I)){if(T=I.nextSibling&&I.nextSibling.dataset,T)var W=T.dgst;T=W,u=Error(a(419)),u.stack="",u.digest=T,Gl({value:u,source:null,stack:null}),r=Mm(s,r,l)}else if(Yt||$l(s,r,l,!1),T=(l&s.childLanes)!==0,Yt||T){if(T=pt,T!==null&&(u=l&-l,u=(u&42)!==0?1:Va(u),u=(u&(T.suspendedLanes|l))!==0?0:u,u!==0&&u!==B.retryLane))throw B.retryLane=u,uo(s,u),qn(T,s,u),Pb;I.data==="$?"||Wm(),r=Mm(s,r,l)}else I.data==="$?"?(r.flags|=192,r.child=s.child,r=null):(s=B.treeContext,Tt=vs(I.nextSibling),_n=r,tt=!0,mr=null,Vs=!1,s!==null&&(ts[ns++]=ma,ts[ns++]=pa,ts[ns++]=hr,ma=s.id,pa=s.overflow,hr=r),r=Dm(r,u.children),r.flags|=4096);return r}return m?(Wa(),m=u.fallback,I=r.mode,B=s.child,W=B.sibling,u=fa(B,{mode:"hidden",children:u.children}),u.subtreeFlags=B.subtreeFlags&65011712,W!==null?m=fa(W,m):(m=dr(m,I,l,null),m.flags|=2),m.return=r,u.return=r,u.sibling=m,r.child=u,u=m,m=r.child,I=s.child.memoizedState,I===null?I=Im(l):(B=I.cachePool,B!==null?(W=Ut._currentValue,B=B.parent!==W?{parent:W,pool:W}:B):B=Ry(),I={baseLanes:I.baseLanes|l,cachePool:B}),m.memoizedState=I,m.childLanes=Rm(s,T,l),r.memoizedState=Sm,u):(Xa(r),l=s.child,s=l.sibling,l=fa(l,{mode:"visible",children:u.children}),l.return=r,l.sibling=null,s!==null&&(T=r.deletions,T===null?(r.deletions=[s],r.flags|=16):T.push(s)),r.child=l,r.memoizedState=null,l)}function Dm(s,r){return r=Ed({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Ed(s,r){return s=Pn(22,s,null,r),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Mm(s,r,l){return No(r,s.child,null,l),s=Dm(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function $b(s,r,l){s.lanes|=r;var u=s.alternate;u!==null&&(u.lanes|=r),Wf(s.return,r,l)}function Om(s,r,l,u,m){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:m}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=l,v.tailMode=m)}function Yb(s,r,l){var u=r.pendingProps,m=u.revealOrder,v=u.tail;if(en(s,r,u.children,l),u=Ft.current,(u&2)!==0)u=u&1|2,r.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&$b(s,l,r);else if(s.tag===19)$b(s,l,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}u&=1}switch(ce(Ft,u),m){case"forwards":for(l=r.child,m=null;l!==null;)s=l.alternate,s!==null&&bd(s)===null&&(m=l),l=l.sibling;l=m,l===null?(m=r.child,r.child=null):(m=l.sibling,l.sibling=null),Om(r,!1,m,l,v);break;case"backwards":for(l=null,m=r.child,r.child=null;m!==null;){if(s=m.alternate,s!==null&&bd(s)===null){r.child=m;break}s=m.sibling,m.sibling=l,l=m,m=s}Om(r,!0,l,null,v);break;case"together":Om(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function _a(s,r,l){if(s!==null&&(r.dependencies=s.dependencies),ni|=r.lanes,(l&r.childLanes)===0)if(s!==null){if($l(s,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(a(153));if(r.child!==null){for(s=r.child,l=fa(s,s.pendingProps),r.child=l,l.return=r;s.sibling!==null;)s=s.sibling,l=l.sibling=fa(s,s.pendingProps),l.return=r;l.sibling=null}return r.child}function km(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&sd(s)))}function Tw(s,r,l){switch(r.tag){case 3:mt(r,r.stateNode.containerInfo),Ga(r,Ut,s.memoizedState.cache),Hl();break;case 27:case 5:La(r);break;case 4:mt(r,r.stateNode.containerInfo);break;case 10:Ga(r,r.type,r.memoizedProps.value);break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(Xa(r),r.flags|=128,null):(l&r.child.childLanes)!==0?Gb(s,r,l):(Xa(r),s=_a(s,r,l),s!==null?s.sibling:null);Xa(r);break;case 19:var m=(s.flags&128)!==0;if(u=(l&r.childLanes)!==0,u||($l(s,r,l,!1),u=(l&r.childLanes)!==0),m){if(u)return Yb(s,r,l);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ce(Ft,Ft.current),u)break;return null;case 22:case 23:return r.lanes=0,Fb(s,r,l);case 24:Ga(r,Ut,s.memoizedState.cache)}return _a(s,r,l)}function Qb(s,r,l){if(s!==null)if(s.memoizedProps!==r.pendingProps)Yt=!0;else{if(!km(s,l)&&(r.flags&128)===0)return Yt=!1,Tw(s,r,l);Yt=(s.flags&131072)!==0}else Yt=!1,tt&&(r.flags&1048576)!==0&&Ty(r,nd,r.index);switch(r.lanes=0,r.tag){case 16:e:{s=r.pendingProps;var u=r.elementType,m=u._init;if(u=m(u._payload),r.type=u,typeof u=="function")Hf(u)?(s=_r(u,s),r.tag=1,r=zb(null,r,u,s,l)):(r.tag=0,r=Cm(null,r,u,s,l));else{if(u!=null){if(m=u.$$typeof,m===P){r.tag=11,r=Lb(null,r,u,s,l);break e}else if(m===V){r.tag=14,r=Vb(null,r,u,s,l);break e}}throw r=me(u)||u,Error(a(306,r,""))}}return r;case 0:return Cm(s,r,r.type,r.pendingProps,l);case 1:return u=r.type,m=_r(u,r.pendingProps),zb(s,r,u,m,l);case 3:e:{if(mt(r,r.stateNode.containerInfo),s===null)throw Error(a(387));u=r.pendingProps;var v=r.memoizedState;m=v.element,am(s,r),Jl(r,u,null,l);var T=r.memoizedState;if(u=T.cache,Ga(r,Ut,u),u!==v.cache&&Zf(r,[Ut],l,!0),Zl(),u=T.element,v.isDehydrated)if(v={element:u,isDehydrated:!1,cache:T.cache},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){r=Hb(s,r,u,l);break e}else if(u!==m){m=Jn(Error(a(424)),r),Gl(m),r=Hb(s,r,u,l);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Tt=vs(s.firstChild),_n=r,tt=!0,mr=null,Vs=!0,l=jb(r,null,u,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Hl(),u===m){r=_a(s,r,l);break e}en(s,r,u,l)}r=r.child}return r;case 26:return Nd(s,r),s===null?(l=Z_(r.type,null,r.pendingProps,null))?r.memoizedState=l:tt||(l=r.type,s=r.pendingProps,u=Ld(Ie.current).createElement(l),u[Pt]=r,u[It]=s,nn(u,l,s),jt(u),r.stateNode=u):r.memoizedState=Z_(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return La(r),s===null&&tt&&(u=r.stateNode=K_(r.type,r.pendingProps,Ie.current),_n=r,Vs=!0,m=Tt,ri(r.type)?(pp=m,Tt=vs(u.firstChild)):Tt=m),en(s,r,r.pendingProps.children,l),Nd(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&tt&&((m=u=Tt)&&(u=Zw(u,r.type,r.pendingProps,Vs),u!==null?(r.stateNode=u,_n=r,Tt=vs(u.firstChild),Vs=!1,m=!0):m=!1),m||pr(r)),La(r),m=r.type,v=r.pendingProps,T=s!==null?s.memoizedProps:null,u=v.children,dp(m,v)?u=null:T!==null&&dp(m,T)&&(r.flags|=32),r.memoizedState!==null&&(m=um(s,r,gw,null,null,l),xc._currentValue=m),Nd(s,r),en(s,r,u,l),r.child;case 6:return s===null&&tt&&((s=l=Tt)&&(l=Jw(l,r.pendingProps,Vs),l!==null?(r.stateNode=l,_n=r,Tt=null,s=!0):s=!1),s||pr(r)),null;case 13:return Gb(s,r,l);case 4:return mt(r,r.stateNode.containerInfo),u=r.pendingProps,s===null?r.child=No(r,null,u,l):en(s,r,u,l),r.child;case 11:return Lb(s,r,r.type,r.pendingProps,l);case 7:return en(s,r,r.pendingProps,l),r.child;case 8:return en(s,r,r.pendingProps.children,l),r.child;case 12:return en(s,r,r.pendingProps.children,l),r.child;case 10:return u=r.pendingProps,Ga(r,r.type,u.value),en(s,r,u.children,l),r.child;case 9:return m=r.type._context,u=r.pendingProps.children,vr(r),m=un(m),u=u(m),r.flags|=1,en(s,r,u,l),r.child;case 14:return Vb(s,r,r.type,r.pendingProps,l);case 15:return Ub(s,r,r.type,r.pendingProps,l);case 19:return Yb(s,r,l);case 31:return u=r.pendingProps,l=r.mode,u={mode:u.mode,children:u.children},s===null?(l=Ed(u,l),l.ref=r.ref,r.child=l,l.return=r,r=l):(l=fa(s.child,u),l.ref=r.ref,r.child=l,l.return=r,r=l),r;case 22:return Fb(s,r,l);case 24:return vr(r),u=un(Ut),s===null?(m=tm(),m===null&&(m=pt,v=Jf(),m.pooledCache=v,v.refCount++,v!==null&&(m.pooledCacheLanes|=l),m=v),r.memoizedState={parent:u,cache:m},sm(r),Ga(r,Ut,m)):((s.lanes&l)!==0&&(am(s,r),Jl(r,null,null,l),Zl()),m=s.memoizedState,v=r.memoizedState,m.parent!==u?(m={parent:u,cache:u},r.memoizedState=m,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=m),Ga(r,Ut,u)):(u=v.cache,Ga(r,Ut,u),u!==m.cache&&Zf(r,[Ut],l,!0))),en(s,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(a(156,r.tag))}function xa(s){s.flags|=4}function Kb(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!sx(r)){if(r=ss.current,r!==null&&((Xe&4194048)===Xe?Us!==null:(Xe&62914560)!==Xe&&(Xe&536870912)===0||r!==Us))throw Xl=nm,Dy;s.flags|=8192}}function Td(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?El():536870912,s.lanes|=r,jo|=r)}function rc(s,r){if(!tt)switch(s.tailMode){case"hidden":r=s.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function xt(s){var r=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(r)for(var m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=u,s.childLanes=l,r}function Aw(s,r,l){var u=r.pendingProps;switch(Qf(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(r),null;case 1:return xt(r),null;case 3:return l=r.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),va(Ut),js(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(zl(r)?xa(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,wy())),xt(r),null;case 26:return l=r.memoizedState,s===null?(xa(r),l!==null?(xt(r),Kb(r,l)):(xt(r),r.flags&=-16777217)):l?l!==s.memoizedState?(xa(r),xt(r),Kb(r,l)):(xt(r),r.flags&=-16777217):(s.memoizedProps!==u&&xa(r),xt(r),r.flags&=-16777217),null;case 27:ea(r),l=Ie.current;var m=r.type;if(s!==null&&r.stateNode!=null)s.memoizedProps!==u&&xa(r);else{if(!u){if(r.stateNode===null)throw Error(a(166));return xt(r),null}s=xe.current,zl(r)?Ay(r):(s=K_(m,u,l),r.stateNode=s,xa(r))}return xt(r),null;case 5:if(ea(r),l=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&xa(r);else{if(!u){if(r.stateNode===null)throw Error(a(166));return xt(r),null}if(s=xe.current,zl(r))Ay(r);else{switch(m=Ld(Ie.current),s){case 1:s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=m.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof u.is=="string"?m.createElement("select",{is:u.is}):m.createElement("select"),u.multiple?s.multiple=!0:u.size&&(s.size=u.size);break;default:s=typeof u.is=="string"?m.createElement(l,{is:u.is}):m.createElement(l)}}s[Pt]=r,s[It]=u;e:for(m=r.child;m!==null;){if(m.tag===5||m.tag===6)s.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===r)break e;for(;m.sibling===null;){if(m.return===null||m.return===r)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}r.stateNode=s;e:switch(nn(s,l,u),l){case"button":case"input":case"select":case"textarea":s=!!u.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&xa(r)}}return xt(r),r.flags&=-16777217,null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==u&&xa(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(a(166));if(s=Ie.current,zl(r)){if(s=r.stateNode,l=r.memoizedProps,u=null,m=_n,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}s[Pt]=r,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||B_(s.nodeValue,l)),s||pr(r)}else s=Ld(s).createTextNode(u),s[Pt]=r,r.stateNode=s}return xt(r),null;case 13:if(u=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=zl(r),u!==null&&u.dehydrated!==null){if(s===null){if(!m)throw Error(a(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(a(317));m[Pt]=r}else Hl(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;xt(r),m=!1}else m=wy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return r.flags&256?(ba(r),r):(ba(r),null)}if(ba(r),(r.flags&128)!==0)return r.lanes=l,r;if(l=u!==null,s=s!==null&&s.memoizedState!==null,l){u=r.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool);var v=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),v!==m&&(u.flags|=2048)}return l!==s&&l&&(r.child.flags|=8192),Td(r,r.updateQueue),xt(r),null;case 4:return js(),s===null&&rp(r.stateNode.containerInfo),xt(r),null;case 10:return va(r.type),xt(r),null;case 19:if(le(Ft),m=r.memoizedState,m===null)return xt(r),null;if(u=(r.flags&128)!==0,v=m.rendering,v===null)if(u)rc(m,!1);else{if(At!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(v=bd(s),v!==null){for(r.flags|=128,rc(m,!1),s=v.updateQueue,r.updateQueue=s,Td(r,s),r.subtreeFlags=0,s=l,l=r.child;l!==null;)Ey(l,s),l=l.sibling;return ce(Ft,Ft.current&1|2),r.child}s=s.sibling}m.tail!==null&&Yn()>wd&&(r.flags|=128,u=!0,rc(m,!1),r.lanes=4194304)}else{if(!u)if(s=bd(v),s!==null){if(r.flags|=128,u=!0,s=s.updateQueue,r.updateQueue=s,Td(r,s),rc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!tt)return xt(r),null}else 2*Yn()-m.renderingStartTime>wd&&l!==536870912&&(r.flags|=128,u=!0,rc(m,!1),r.lanes=4194304);m.isBackwards?(v.sibling=r.child,r.child=v):(s=m.last,s!==null?s.sibling=v:r.child=v,m.last=v)}return m.tail!==null?(r=m.tail,m.rendering=r,m.tail=r.sibling,m.renderingStartTime=Yn(),r.sibling=null,s=Ft.current,ce(Ft,u?s&1|2:s&1),r):(xt(r),null);case 22:case 23:return ba(r),lm(),u=r.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(l&536870912)!==0&&(r.flags&128)===0&&(xt(r),r.subtreeFlags&6&&(r.flags|=8192)):xt(r),l=r.updateQueue,l!==null&&Td(r,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==l&&(r.flags|=2048),s!==null&&le(yr),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),va(Ut),xt(r),null;case 25:return null;case 30:return null}throw Error(a(156,r.tag))}function jw(s,r){switch(Qf(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return va(Ut),js(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return ea(r),null;case 13:if(ba(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(a(340));Hl()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return le(Ft),null;case 4:return js(),null;case 10:return va(r.type),null;case 22:case 23:return ba(r),lm(),s!==null&&le(yr),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return va(Ut),null;case 25:return null;default:return null}}function Xb(s,r){switch(Qf(r),r.tag){case 3:va(Ut),js();break;case 26:case 27:case 5:ea(r);break;case 4:js();break;case 13:ba(r);break;case 19:le(Ft);break;case 10:va(r.type);break;case 22:case 23:ba(r),lm(),s!==null&&le(yr);break;case 24:va(Ut)}}function oc(s,r){try{var l=r.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var m=u.next;l=m;do{if((l.tag&s)===s){u=void 0;var v=l.create,T=l.inst;u=v(),T.destroy=u}l=l.next}while(l!==m)}}catch(I){ut(r,r.return,I)}}function Za(s,r,l){try{var u=r.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var v=m.next;u=v;do{if((u.tag&s)===s){var T=u.inst,I=T.destroy;if(I!==void 0){T.destroy=void 0,m=r;var B=l,W=I;try{W()}catch(se){ut(m,B,se)}}}u=u.next}while(u!==v)}}catch(se){ut(r,r.return,se)}}function Wb(s){var r=s.updateQueue;if(r!==null){var l=s.stateNode;try{Vy(r,l)}catch(u){ut(s,s.return,u)}}}function Zb(s,r,l){l.props=_r(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){ut(s,r,u)}}function lc(s,r){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(m){ut(s,r,m)}}function Fs(s,r){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(m){ut(s,r,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){ut(s,r,m)}else l.current=null}function Jb(s){var r=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(m){ut(s,s.return,m)}}function Pm(s,r,l){try{var u=s.stateNode;Yw(u,s.type,l,r),u[It]=r}catch(m){ut(s,s.return,m)}}function e_(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ri(s.type)||s.tag===4}function Lm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||e_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ri(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vm(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(s),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Pd));else if(u!==4&&(u===27&&ri(s.type)&&(l=s.stateNode,r=null),s=s.child,s!==null))for(Vm(s,r,l),s=s.sibling;s!==null;)Vm(s,r,l),s=s.sibling}function Ad(s,r,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?l.insertBefore(s,r):l.appendChild(s);else if(u!==4&&(u===27&&ri(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(Ad(s,r,l),s=s.sibling;s!==null;)Ad(s,r,l),s=s.sibling}function t_(s){var r=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,m=r.attributes;m.length;)r.removeAttributeNode(m[0]);nn(r,u,l),r[Pt]=s,r[It]=l}catch(v){ut(s,s.return,v)}}var Na=!1,Ct=!1,Um=!1,n_=typeof WeakSet=="function"?WeakSet:Set,Qt=null;function ww(s,r){if(s=s.containerInfo,cp=zd,s=fy(s),Lf(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var m=u.anchorOffset,v=u.focusNode;u=u.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var T=0,I=-1,B=-1,W=0,se=0,re=s,Z=null;t:for(;;){for(var J;re!==l||m!==0&&re.nodeType!==3||(I=T+m),re!==v||u!==0&&re.nodeType!==3||(B=T+u),re.nodeType===3&&(T+=re.nodeValue.length),(J=re.firstChild)!==null;)Z=re,re=J;for(;;){if(re===s)break t;if(Z===l&&++W===m&&(I=T),Z===v&&++se===u&&(B=T),(J=re.nextSibling)!==null)break;re=Z,Z=re.parentNode}re=J}l=I===-1||B===-1?null:{start:I,end:B}}else l=null}l=l||{start:0,end:0}}else l=null;for(up={focusedElem:s,selectionRange:l},zd=!1,Qt=r;Qt!==null;)if(r=Qt,s=r.child,(r.subtreeFlags&1024)!==0&&s!==null)s.return=r,Qt=s;else for(;Qt!==null;){switch(r=Qt,v=r.alternate,s=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,l=r,m=v.memoizedProps,v=v.memoizedState,u=l.stateNode;try{var Ce=_r(l.type,m,l.elementType===l.type);s=u.getSnapshotBeforeUpdate(Ce,v),u.__reactInternalSnapshotBeforeUpdate=s}catch(Te){ut(l,l.return,Te)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,l=s.nodeType,l===9)fp(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":fp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=r.sibling,s!==null){s.return=r.return,Qt=s;break}Qt=r.return}}function s_(s,r,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Ja(s,l),u&4&&oc(5,l);break;case 1:if(Ja(s,l),u&4)if(s=l.stateNode,r===null)try{s.componentDidMount()}catch(T){ut(l,l.return,T)}else{var m=_r(l.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(m,r,s.__reactInternalSnapshotBeforeUpdate)}catch(T){ut(l,l.return,T)}}u&64&&Wb(l),u&512&&lc(l,l.return);break;case 3:if(Ja(s,l),u&64&&(s=l.updateQueue,s!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Vy(s,r)}catch(T){ut(l,l.return,T)}}break;case 27:r===null&&u&4&&t_(l);case 26:case 5:Ja(s,l),r===null&&u&4&&Jb(l),u&512&&lc(l,l.return);break;case 12:Ja(s,l);break;case 13:Ja(s,l),u&4&&r_(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=Pw.bind(null,l),eC(s,l))));break;case 22:if(u=l.memoizedState!==null||Na,!u){r=r!==null&&r.memoizedState!==null||Ct,m=Na;var v=Ct;Na=u,(Ct=r)&&!v?ei(s,l,(l.subtreeFlags&8772)!==0):Ja(s,l),Na=m,Ct=v}break;case 30:break;default:Ja(s,l)}}function a_(s){var r=s.alternate;r!==null&&(s.alternate=null,a_(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&qa(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var _t=null,wn=!1;function Ea(s,r,l){for(l=l.child;l!==null;)i_(s,r,l),l=l.sibling}function i_(s,r,l){if(st&&typeof st.onCommitFiberUnmount=="function")try{st.onCommitFiberUnmount(Et,l)}catch{}switch(l.tag){case 26:Ct||Fs(l,r),Ea(s,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ct||Fs(l,r);var u=_t,m=wn;ri(l.type)&&(_t=l.stateNode,wn=!1),Ea(s,r,l),vc(l.stateNode),_t=u,wn=m;break;case 5:Ct||Fs(l,r);case 6:if(u=_t,m=wn,_t=null,Ea(s,r,l),_t=u,wn=m,_t!==null)if(wn)try{(_t.nodeType===9?_t.body:_t.nodeName==="HTML"?_t.ownerDocument.body:_t).removeChild(l.stateNode)}catch(v){ut(l,r,v)}else try{_t.removeChild(l.stateNode)}catch(v){ut(l,r,v)}break;case 18:_t!==null&&(wn?(s=_t,Y_(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Ac(s)):Y_(_t,l.stateNode));break;case 4:u=_t,m=wn,_t=l.stateNode.containerInfo,wn=!0,Ea(s,r,l),_t=u,wn=m;break;case 0:case 11:case 14:case 15:Ct||Za(2,l,r),Ct||Za(4,l,r),Ea(s,r,l);break;case 1:Ct||(Fs(l,r),u=l.stateNode,typeof u.componentWillUnmount=="function"&&Zb(l,r,u)),Ea(s,r,l);break;case 21:Ea(s,r,l);break;case 22:Ct=(u=Ct)||l.memoizedState!==null,Ea(s,r,l),Ct=u;break;default:Ea(s,r,l)}}function r_(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ac(s)}catch(l){ut(r,r.return,l)}}function Cw(s){switch(s.tag){case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new n_),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new n_),r;default:throw Error(a(435,s.tag))}}function Fm(s,r){var l=Cw(s);r.forEach(function(u){var m=Lw.bind(null,s,u);l.has(u)||(l.add(u),u.then(m,m))})}function Ln(s,r){var l=r.deletions;if(l!==null)for(var u=0;u<l.length;u++){var m=l[u],v=s,T=r,I=T;e:for(;I!==null;){switch(I.tag){case 27:if(ri(I.type)){_t=I.stateNode,wn=!1;break e}break;case 5:_t=I.stateNode,wn=!1;break e;case 3:case 4:_t=I.stateNode.containerInfo,wn=!0;break e}I=I.return}if(_t===null)throw Error(a(160));i_(v,T,m),_t=null,wn=!1,v=m.alternate,v!==null&&(v.return=null),m.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)o_(r,s),r=r.sibling}var gs=null;function o_(s,r){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ln(r,s),Vn(s),u&4&&(Za(3,s,s.return),oc(3,s),Za(5,s,s.return));break;case 1:Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),u&64&&Na&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var m=gs;if(Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),u&4){var v=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":v=m.getElementsByTagName("title")[0],(!v||v[Ki]||v[Pt]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=m.createElement(u),m.head.insertBefore(v,m.querySelector("head > title"))),nn(v,u,l),v[Pt]=s,jt(v),u=v;break e;case"link":var T=tx("link","href",m).get(u+(l.href||""));if(T){for(var I=0;I<T.length;I++)if(v=T[I],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){T.splice(I,1);break t}}v=m.createElement(u),nn(v,u,l),m.head.appendChild(v);break;case"meta":if(T=tx("meta","content",m).get(u+(l.content||""))){for(I=0;I<T.length;I++)if(v=T[I],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){T.splice(I,1);break t}}v=m.createElement(u),nn(v,u,l),m.head.appendChild(v);break;default:throw Error(a(468,u))}v[Pt]=s,jt(v),u=v}s.stateNode=u}else nx(m,s.type,s.stateNode);else s.stateNode=ex(m,u,s.memoizedProps);else v!==u?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,u===null?nx(m,s.type,s.stateNode):ex(m,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Pm(s,s.memoizedProps,l.memoizedProps)}break;case 27:Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),l!==null&&u&4&&Pm(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Ln(r,s),Vn(s),u&512&&(Ct||l===null||Fs(l,l.return)),s.flags&32){m=s.stateNode;try{Kn(m,"")}catch(J){ut(s,s.return,J)}}u&4&&s.stateNode!=null&&(m=s.memoizedProps,Pm(s,m,l!==null?l.memoizedProps:m)),u&1024&&(Um=!0);break;case 6:if(Ln(r,s),Vn(s),u&4){if(s.stateNode===null)throw Error(a(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(J){ut(s,s.return,J)}}break;case 3:if(Fd=null,m=gs,gs=Vd(r.containerInfo),Ln(r,s),gs=m,Vn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Ac(r.containerInfo)}catch(J){ut(s,s.return,J)}Um&&(Um=!1,l_(s));break;case 4:u=gs,gs=Vd(s.stateNode.containerInfo),Ln(r,s),Vn(s),gs=u;break;case 12:Ln(r,s),Vn(s);break;case 13:Ln(r,s),Vn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&($m=Yn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Fm(s,u)));break;case 22:m=s.memoizedState!==null;var B=l!==null&&l.memoizedState!==null,W=Na,se=Ct;if(Na=W||m,Ct=se||B,Ln(r,s),Ct=se,Na=W,Vn(s),u&8192)e:for(r=s.stateNode,r._visibility=m?r._visibility&-2:r._visibility|1,m&&(l===null||B||Na||Ct||xr(s)),l=null,r=s;;){if(r.tag===5||r.tag===26){if(l===null){B=l=r;try{if(v=B.stateNode,m)T=v.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{I=B.stateNode;var re=B.memoizedProps.style,Z=re!=null&&re.hasOwnProperty("display")?re.display:null;I.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(J){ut(B,B.return,J)}}}else if(r.tag===6){if(l===null){B=r;try{B.stateNode.nodeValue=m?"":B.memoizedProps}catch(J){ut(B,B.return,J)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Fm(s,l))));break;case 19:Ln(r,s),Vn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Fm(s,u)));break;case 30:break;case 21:break;default:Ln(r,s),Vn(s)}}function Vn(s){var r=s.flags;if(r&2){try{for(var l,u=s.return;u!==null;){if(e_(u)){l=u;break}u=u.return}if(l==null)throw Error(a(160));switch(l.tag){case 27:var m=l.stateNode,v=Lm(s);Ad(s,v,m);break;case 5:var T=l.stateNode;l.flags&32&&(Kn(T,""),l.flags&=-33);var I=Lm(s);Ad(s,I,T);break;case 3:case 4:var B=l.stateNode.containerInfo,W=Lm(s);Vm(s,W,B);break;default:throw Error(a(161))}}catch(se){ut(s,s.return,se)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function l_(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;l_(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function Ja(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)s_(s,r.alternate,r),r=r.sibling}function xr(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:Za(4,r,r.return),xr(r);break;case 1:Fs(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&Zb(r,r.return,l),xr(r);break;case 27:vc(r.stateNode);case 26:case 5:Fs(r,r.return),xr(r);break;case 22:r.memoizedState===null&&xr(r);break;case 30:xr(r);break;default:xr(r)}s=s.sibling}}function ei(s,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,m=s,v=r,T=v.flags;switch(v.tag){case 0:case 11:case 15:ei(m,v,l),oc(4,v);break;case 1:if(ei(m,v,l),u=v,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(W){ut(u,u.return,W)}if(u=v,m=u.updateQueue,m!==null){var I=u.stateNode;try{var B=m.shared.hiddenCallbacks;if(B!==null)for(m.shared.hiddenCallbacks=null,m=0;m<B.length;m++)Ly(B[m],I)}catch(W){ut(u,u.return,W)}}l&&T&64&&Wb(v),lc(v,v.return);break;case 27:t_(v);case 26:case 5:ei(m,v,l),l&&u===null&&T&4&&Jb(v),lc(v,v.return);break;case 12:ei(m,v,l);break;case 13:ei(m,v,l),l&&T&4&&r_(m,v);break;case 22:v.memoizedState===null&&ei(m,v,l),lc(v,v.return);break;case 30:break;default:ei(m,v,l)}r=r.sibling}}function qm(s,r){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Yl(l))}function Bm(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Yl(s))}function qs(s,r,l,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)c_(s,r,l,u),r=r.sibling}function c_(s,r,l,u){var m=r.flags;switch(r.tag){case 0:case 11:case 15:qs(s,r,l,u),m&2048&&oc(9,r);break;case 1:qs(s,r,l,u);break;case 3:qs(s,r,l,u),m&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Yl(s)));break;case 12:if(m&2048){qs(s,r,l,u),s=r.stateNode;try{var v=r.memoizedProps,T=v.id,I=v.onPostCommit;typeof I=="function"&&I(T,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(B){ut(r,r.return,B)}}else qs(s,r,l,u);break;case 13:qs(s,r,l,u);break;case 23:break;case 22:v=r.stateNode,T=r.alternate,r.memoizedState!==null?v._visibility&2?qs(s,r,l,u):cc(s,r):v._visibility&2?qs(s,r,l,u):(v._visibility|=2,Eo(s,r,l,u,(r.subtreeFlags&10256)!==0)),m&2048&&qm(T,r);break;case 24:qs(s,r,l,u),m&2048&&Bm(r.alternate,r);break;default:qs(s,r,l,u)}}function Eo(s,r,l,u,m){for(m=m&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var v=s,T=r,I=l,B=u,W=T.flags;switch(T.tag){case 0:case 11:case 15:Eo(v,T,I,B,m),oc(8,T);break;case 23:break;case 22:var se=T.stateNode;T.memoizedState!==null?se._visibility&2?Eo(v,T,I,B,m):cc(v,T):(se._visibility|=2,Eo(v,T,I,B,m)),m&&W&2048&&qm(T.alternate,T);break;case 24:Eo(v,T,I,B,m),m&&W&2048&&Bm(T.alternate,T);break;default:Eo(v,T,I,B,m)}r=r.sibling}}function cc(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=s,u=r,m=u.flags;switch(u.tag){case 22:cc(l,u),m&2048&&qm(u.alternate,u);break;case 24:cc(l,u),m&2048&&Bm(u.alternate,u);break;default:cc(l,u)}r=r.sibling}}var uc=8192;function To(s){if(s.subtreeFlags&uc)for(s=s.child;s!==null;)u_(s),s=s.sibling}function u_(s){switch(s.tag){case 26:To(s),s.flags&uc&&s.memoizedState!==null&&fC(gs,s.memoizedState,s.memoizedProps);break;case 5:To(s);break;case 3:case 4:var r=gs;gs=Vd(s.stateNode.containerInfo),To(s),gs=r;break;case 22:s.memoizedState===null&&(r=s.alternate,r!==null&&r.memoizedState!==null?(r=uc,uc=16777216,To(s),uc=r):To(s));break;default:To(s)}}function d_(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function dc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Qt=u,f_(u,s)}d_(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)h_(s),s=s.sibling}function h_(s){switch(s.tag){case 0:case 11:case 15:dc(s),s.flags&2048&&Za(9,s,s.return);break;case 3:dc(s);break;case 12:dc(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,jd(s)):dc(s);break;default:dc(s)}}function jd(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Qt=u,f_(u,s)}d_(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:Za(8,r,r.return),jd(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,jd(r));break;default:jd(r)}s=s.sibling}}function f_(s,r){for(;Qt!==null;){var l=Qt;switch(l.tag){case 0:case 11:case 15:Za(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Yl(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Qt=u;else e:for(l=s;Qt!==null;){u=Qt;var m=u.sibling,v=u.return;if(a_(u),u===l){Qt=null;break e}if(m!==null){m.return=v,Qt=m;break e}Qt=v}}}var Sw={getCacheForType:function(s){var r=un(Ut),l=r.data.get(s);return l===void 0&&(l=s(),r.data.set(s,l)),l}},Iw=typeof WeakMap=="function"?WeakMap:Map,at=0,pt=null,He=null,Xe=0,it=0,Un=null,ti=!1,Ao=!1,zm=!1,Ta=0,At=0,ni=0,Nr=0,Hm=0,as=0,jo=0,hc=null,Cn=null,Gm=!1,$m=0,wd=1/0,Cd=null,si=null,tn=0,ai=null,wo=null,Co=0,Ym=0,Qm=null,m_=null,fc=0,Km=null;function Fn(){if((at&2)!==0&&Xe!==0)return Xe&-Xe;if(Q.T!==null){var s=po;return s!==0?s:np()}return Ua()}function p_(){as===0&&(as=(Xe&536870912)===0||tt?Nl():536870912);var s=ss.current;return s!==null&&(s.flags|=32),as}function qn(s,r,l){(s===pt&&(it===2||it===9)||s.cancelPendingCommit!==null)&&(So(s,0),ii(s,Xe,as,!1)),na(s,l),((at&2)===0||s!==pt)&&(s===pt&&((at&2)===0&&(Nr|=l),At===4&&ii(s,Xe,as,!1)),Bs(s))}function g_(s,r,l){if((at&6)!==0)throw Error(a(327));var u=!l&&(r&124)===0&&(r&s.expiredLanes)===0||Qi(s,r),m=u?Mw(s,r):Zm(s,r,!0),v=u;do{if(m===0){Ao&&!u&&ii(s,r,0,!1);break}else{if(l=s.current.alternate,v&&!Rw(l)){m=Zm(s,r,!1),v=!1;continue}if(m===2){if(v=r,s.errorRecoveryDisabledLanes&v)var T=0;else T=s.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){r=T;e:{var I=s;m=hc;var B=I.current.memoizedState.isDehydrated;if(B&&(So(I,T).flags|=256),T=Zm(I,T,!1),T!==2){if(zm&&!B){I.errorRecoveryDisabledLanes|=v,Nr|=v,m=4;break e}v=Cn,Cn=m,v!==null&&(Cn===null?Cn=v:Cn.push.apply(Cn,v))}m=T}if(v=!1,m!==2)continue}}if(m===1){So(s,0),ii(s,r,0,!0);break}e:{switch(u=s,v=m,v){case 0:case 1:throw Error(a(345));case 4:if((r&4194048)!==r)break;case 6:ii(u,r,as,!ti);break e;case 2:Cn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((r&62914560)===r&&(m=$m+300-Yn(),10<m)){if(ii(u,r,as,!ti),Gr(u,0,!0)!==0)break e;u.timeoutHandle=G_(v_.bind(null,u,l,Cn,Cd,Gm,r,as,Nr,jo,ti,v,2,-0,0),m);break e}v_(u,l,Cn,Cd,Gm,r,as,Nr,jo,ti,v,0,-0,0)}}break}while(!0);Bs(s)}function v_(s,r,l,u,m,v,T,I,B,W,se,re,Z,J){if(s.timeoutHandle=-1,re=r.subtreeFlags,(re&8192||(re&16785408)===16785408)&&(_c={stylesheets:null,count:0,unsuspend:hC},u_(r),re=mC(),re!==null)){s.cancelPendingCommit=re(T_.bind(null,s,r,v,l,u,m,T,I,B,se,1,Z,J)),ii(s,v,T,!W);return}T_(s,r,v,l,u,m,T,I,B)}function Rw(s){for(var r=s;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var m=l[u],v=m.getSnapshot;m=m.value;try{if(!kn(v(),m))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function ii(s,r,l,u){r&=~Hm,r&=~Nr,s.suspendedLanes|=r,s.pingedLanes&=~r,u&&(s.warmLanes|=r),u=s.expirationTimes;for(var m=r;0<m;){var v=31-cn(m),T=1<<v;u[v]=-1,m&=~T}l!==0&&ws(s,l,r)}function Sd(){return(at&6)===0?(mc(0),!1):!0}function Xm(){if(He!==null){if(it===0)var s=He.return;else s=He,ga=gr=null,fm(s),xo=null,ac=0,s=He;for(;s!==null;)Xb(s.alternate,s),s=s.return;He=null}}function So(s,r){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,Kw(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Xm(),pt=s,He=l=fa(s.current,null),Xe=r,it=0,Un=null,ti=!1,Ao=Qi(s,r),zm=!1,jo=as=Hm=Nr=ni=At=0,Cn=hc=null,Gm=!1,(r&8)!==0&&(r|=r&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=r;0<u;){var m=31-cn(u),v=1<<m;r|=s[m],u&=~v}return Ta=r,Wu(),l}function y_(s,r){Fe=null,Q.H=gd,r===Kl||r===rd?(r=ky(),it=3):r===Dy?(r=ky(),it=4):it=r===Pb?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Un=r,He===null&&(At=1,xd(s,Jn(r,s.current)))}function b_(){var s=Q.H;return Q.H=gd,s===null?gd:s}function __(){var s=Q.A;return Q.A=Sw,s}function Wm(){At=4,ti||(Xe&4194048)!==Xe&&ss.current!==null||(Ao=!0),(ni&134217727)===0&&(Nr&134217727)===0||pt===null||ii(pt,Xe,as,!1)}function Zm(s,r,l){var u=at;at|=2;var m=b_(),v=__();(pt!==s||Xe!==r)&&(Cd=null,So(s,r)),r=!1;var T=At;e:do try{if(it!==0&&He!==null){var I=He,B=Un;switch(it){case 8:Xm(),T=6;break e;case 3:case 2:case 9:case 6:ss.current===null&&(r=!0);var W=it;if(it=0,Un=null,Io(s,I,B,W),l&&Ao){T=0;break e}break;default:W=it,it=0,Un=null,Io(s,I,B,W)}}Dw(),T=At;break}catch(se){y_(s,se)}while(!0);return r&&s.shellSuspendCounter++,ga=gr=null,at=u,Q.H=m,Q.A=v,He===null&&(pt=null,Xe=0,Wu()),T}function Dw(){for(;He!==null;)x_(He)}function Mw(s,r){var l=at;at|=2;var u=b_(),m=__();pt!==s||Xe!==r?(Cd=null,wd=Yn()+500,So(s,r)):Ao=Qi(s,r);e:do try{if(it!==0&&He!==null){r=He;var v=Un;t:switch(it){case 1:it=0,Un=null,Io(s,r,v,1);break;case 2:case 9:if(My(v)){it=0,Un=null,N_(r);break}r=function(){it!==2&&it!==9||pt!==s||(it=7),Bs(s)},v.then(r,r);break e;case 3:it=7;break e;case 4:it=5;break e;case 7:My(v)?(it=0,Un=null,N_(r)):(it=0,Un=null,Io(s,r,v,7));break;case 5:var T=null;switch(He.tag){case 26:T=He.memoizedState;case 5:case 27:var I=He;if(!T||sx(T)){it=0,Un=null;var B=I.sibling;if(B!==null)He=B;else{var W=I.return;W!==null?(He=W,Id(W)):He=null}break t}}it=0,Un=null,Io(s,r,v,5);break;case 6:it=0,Un=null,Io(s,r,v,6);break;case 8:Xm(),At=6;break e;default:throw Error(a(462))}}Ow();break}catch(se){y_(s,se)}while(!0);return ga=gr=null,Q.H=u,Q.A=m,at=l,He!==null?0:(pt=null,Xe=0,Wu(),At)}function Ow(){for(;He!==null&&!yl();)x_(He)}function x_(s){var r=Qb(s.alternate,s,Ta);s.memoizedProps=s.pendingProps,r===null?Id(s):He=r}function N_(s){var r=s,l=r.alternate;switch(r.tag){case 15:case 0:r=Bb(l,r,r.pendingProps,r.type,void 0,Xe);break;case 11:r=Bb(l,r,r.pendingProps,r.type.render,r.ref,Xe);break;case 5:fm(r);default:Xb(l,r),r=He=Ey(r,Ta),r=Qb(l,r,Ta)}s.memoizedProps=s.pendingProps,r===null?Id(s):He=r}function Io(s,r,l,u){ga=gr=null,fm(r),xo=null,ac=0;var m=r.return;try{if(Ew(s,m,r,l,Xe)){At=1,xd(s,Jn(l,s.current)),He=null;return}}catch(v){if(m!==null)throw He=m,v;At=1,xd(s,Jn(l,s.current)),He=null;return}r.flags&32768?(tt||u===1?s=!0:Ao||(Xe&536870912)!==0?s=!1:(ti=s=!0,(u===2||u===9||u===3||u===6)&&(u=ss.current,u!==null&&u.tag===13&&(u.flags|=16384))),E_(r,s)):Id(r)}function Id(s){var r=s;do{if((r.flags&32768)!==0){E_(r,ti);return}s=r.return;var l=Aw(r.alternate,r,Ta);if(l!==null){He=l;return}if(r=r.sibling,r!==null){He=r;return}He=r=s}while(r!==null);At===0&&(At=5)}function E_(s,r){do{var l=jw(s.alternate,s);if(l!==null){l.flags&=32767,He=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(s=s.sibling,s!==null)){He=s;return}He=s=l}while(s!==null);At=6,He=null}function T_(s,r,l,u,m,v,T,I,B){s.cancelPendingCommit=null;do Rd();while(tn!==0);if((at&6)!==0)throw Error(a(327));if(r!==null){if(r===s.current)throw Error(a(177));if(v=r.lanes|r.childLanes,v|=Bf,Tl(s,l,v,T,I,B),s===pt&&(He=pt=null,Xe=0),wo=r,ai=s,Co=l,Ym=v,Qm=m,m_=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Vw(Hi,function(){return S_(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=Q.T,Q.T=null,m=ne.p,ne.p=2,T=at,at|=4;try{ww(s,r,l)}finally{at=T,ne.p=m,Q.T=u}}tn=1,A_(),j_(),w_()}}function A_(){if(tn===1){tn=0;var s=ai,r=wo,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=Q.T,Q.T=null;var u=ne.p;ne.p=2;var m=at;at|=4;try{o_(r,s);var v=up,T=fy(s.containerInfo),I=v.focusedElem,B=v.selectionRange;if(T!==I&&I&&I.ownerDocument&&hy(I.ownerDocument.documentElement,I)){if(B!==null&&Lf(I)){var W=B.start,se=B.end;if(se===void 0&&(se=W),"selectionStart"in I)I.selectionStart=W,I.selectionEnd=Math.min(se,I.value.length);else{var re=I.ownerDocument||document,Z=re&&re.defaultView||window;if(Z.getSelection){var J=Z.getSelection(),Ce=I.textContent.length,Te=Math.min(B.start,Ce),ct=B.end===void 0?Te:Math.min(B.end,Ce);!J.extend&&Te>ct&&(T=ct,ct=Te,Te=T);var Y=dy(I,Te),G=dy(I,ct);if(Y&&G&&(J.rangeCount!==1||J.anchorNode!==Y.node||J.anchorOffset!==Y.offset||J.focusNode!==G.node||J.focusOffset!==G.offset)){var X=re.createRange();X.setStart(Y.node,Y.offset),J.removeAllRanges(),Te>ct?(J.addRange(X),J.extend(G.node,G.offset)):(X.setEnd(G.node,G.offset),J.addRange(X))}}}}for(re=[],J=I;J=J.parentNode;)J.nodeType===1&&re.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<re.length;I++){var ae=re[I];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}zd=!!cp,up=cp=null}finally{at=m,ne.p=u,Q.T=l}}s.current=r,tn=2}}function j_(){if(tn===2){tn=0;var s=ai,r=wo,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=Q.T,Q.T=null;var u=ne.p;ne.p=2;var m=at;at|=4;try{s_(s,r.alternate,r)}finally{at=m,ne.p=u,Q.T=l}}tn=3}}function w_(){if(tn===4||tn===3){tn=0,ju();var s=ai,r=wo,l=Co,u=m_;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?tn=5:(tn=0,wo=ai=null,C_(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(si=null),$r(l),r=r.stateNode,st&&typeof st.onCommitFiberRoot=="function")try{st.onCommitFiberRoot(Et,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=Q.T,m=ne.p,ne.p=2,Q.T=null;try{for(var v=s.onRecoverableError,T=0;T<u.length;T++){var I=u[T];v(I.value,{componentStack:I.stack})}}finally{Q.T=r,ne.p=m}}(Co&3)!==0&&Rd(),Bs(s),m=s.pendingLanes,(l&4194090)!==0&&(m&42)!==0?s===Km?fc++:(fc=0,Km=s):fc=0,mc(0)}}function C_(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Yl(r)))}function Rd(s){return A_(),j_(),w_(),S_()}function S_(){if(tn!==5)return!1;var s=ai,r=Ym;Ym=0;var l=$r(Co),u=Q.T,m=ne.p;try{ne.p=32>l?32:l,Q.T=null,l=Qm,Qm=null;var v=ai,T=Co;if(tn=0,wo=ai=null,Co=0,(at&6)!==0)throw Error(a(331));var I=at;if(at|=4,h_(v.current),c_(v,v.current,T,l),at=I,mc(0,!1),st&&typeof st.onPostCommitFiberRoot=="function")try{st.onPostCommitFiberRoot(Et,v)}catch{}return!0}finally{ne.p=m,Q.T=u,C_(s,r)}}function I_(s,r,l){r=Jn(l,r),r=wm(s.stateNode,r,2),s=Qa(s,r,2),s!==null&&(na(s,2),Bs(s))}function ut(s,r,l){if(s.tag===3)I_(s,s,l);else for(;r!==null;){if(r.tag===3){I_(r,s,l);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(si===null||!si.has(u))){s=Jn(l,s),l=Ob(2),u=Qa(r,l,2),u!==null&&(kb(l,u,r,s),na(u,2),Bs(u));break}}r=r.return}}function Jm(s,r,l){var u=s.pingCache;if(u===null){u=s.pingCache=new Iw;var m=new Set;u.set(r,m)}else m=u.get(r),m===void 0&&(m=new Set,u.set(r,m));m.has(l)||(zm=!0,m.add(l),s=kw.bind(null,s,r,l),r.then(s,s))}function kw(s,r,l){var u=s.pingCache;u!==null&&u.delete(r),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,pt===s&&(Xe&l)===l&&(At===4||At===3&&(Xe&62914560)===Xe&&300>Yn()-$m?(at&2)===0&&So(s,0):Hm|=l,jo===Xe&&(jo=0)),Bs(s)}function R_(s,r){r===0&&(r=El()),s=uo(s,r),s!==null&&(na(s,r),Bs(s))}function Pw(s){var r=s.memoizedState,l=0;r!==null&&(l=r.retryLane),R_(s,l)}function Lw(s,r){var l=0;switch(s.tag){case 13:var u=s.stateNode,m=s.memoizedState;m!==null&&(l=m.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(r),R_(s,l)}function Vw(s,r){return Bi(s,r)}var Dd=null,Ro=null,ep=!1,Md=!1,tp=!1,Er=0;function Bs(s){s!==Ro&&s.next===null&&(Ro===null?Dd=Ro=s:Ro=Ro.next=s),Md=!0,ep||(ep=!0,Fw())}function mc(s,r){if(!tp&&Md){tp=!0;do for(var l=!1,u=Dd;u!==null;){if(s!==0){var m=u.pendingLanes;if(m===0)var v=0;else{var T=u.suspendedLanes,I=u.pingedLanes;v=(1<<31-cn(42|s)+1)-1,v&=m&~(T&~I),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,k_(u,v))}else v=Xe,v=Gr(u,u===pt?v:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(v&3)===0||Qi(u,v)||(l=!0,k_(u,v));u=u.next}while(l);tp=!1}}function Uw(){D_()}function D_(){Md=ep=!1;var s=0;Er!==0&&(Qw()&&(s=Er),Er=0);for(var r=Yn(),l=null,u=Dd;u!==null;){var m=u.next,v=M_(u,r);v===0?(u.next=null,l===null?Dd=m:l.next=m,m===null&&(Ro=l)):(l=u,(s!==0||(v&3)!==0)&&(Md=!0)),u=m}mc(s)}function M_(s,r){for(var l=s.suspendedLanes,u=s.pingedLanes,m=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var T=31-cn(v),I=1<<T,B=m[T];B===-1?((I&l)===0||(I&u)!==0)&&(m[T]=xl(I,r)):B<=r&&(s.expiredLanes|=I),v&=~I}if(r=pt,l=Xe,l=Gr(s,s===r?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===r&&(it===2||it===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&zi(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Qi(s,l)){if(r=l&-l,r===s.callbackPriority)return r;switch(u!==null&&zi(u),$r(l)){case 2:case 8:l=zr;break;case 32:l=Hi;break;case 268435456:l=Hr;break;default:l=Hi}return u=O_.bind(null,s),l=Bi(l,u),s.callbackPriority=r,s.callbackNode=l,r}return u!==null&&u!==null&&zi(u),s.callbackPriority=2,s.callbackNode=null,2}function O_(s,r){if(tn!==0&&tn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Rd()&&s.callbackNode!==l)return null;var u=Xe;return u=Gr(s,s===pt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(g_(s,u,r),M_(s,Yn()),s.callbackNode!=null&&s.callbackNode===l?O_.bind(null,s):null)}function k_(s,r){if(Rd())return null;g_(s,r,!0)}function Fw(){Xw(function(){(at&6)!==0?Bi(bl,Uw):D_()})}function np(){return Er===0&&(Er=Nl()),Er}function P_(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Zr(""+s)}function L_(s,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,s.id&&l.setAttribute("form",s.id),r.parentNode.insertBefore(l,r),s=new FormData(s),l.parentNode.removeChild(l),s}function qw(s,r,l,u,m){if(r==="submit"&&l&&l.stateNode===m){var v=P_((m[It]||null).action),T=u.submitter;T&&(r=(r=T[It]||null)?P_(r.formAction):T.getAttribute("formAction"),r!==null&&(v=r,T=null));var I=new Jr("action","action",null,u,m);s.push({event:I,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Er!==0){var B=T?L_(m,T):new FormData(m);Nm(l,{pending:!0,data:B,method:m.method,action:v},null,B)}}else typeof v=="function"&&(I.preventDefault(),B=T?L_(m,T):new FormData(m),Nm(l,{pending:!0,data:B,method:m.method,action:v},v,B))},currentTarget:m}]})}}for(var sp=0;sp<qf.length;sp++){var ap=qf[sp],Bw=ap.toLowerCase(),zw=ap[0].toUpperCase()+ap.slice(1);ps(Bw,"on"+zw)}ps(gy,"onAnimationEnd"),ps(vy,"onAnimationIteration"),ps(yy,"onAnimationStart"),ps("dblclick","onDoubleClick"),ps("focusin","onFocus"),ps("focusout","onBlur"),ps(rw,"onTransitionRun"),ps(ow,"onTransitionStart"),ps(lw,"onTransitionCancel"),ps(by,"onTransitionEnd"),aa("onMouseEnter",["mouseout","mouseover"]),aa("onMouseLeave",["mouseout","mouseover"]),aa("onPointerEnter",["pointerout","pointerover"]),aa("onPointerLeave",["pointerout","pointerover"]),fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fs("onBeforeInput",["compositionend","keypress","textInput","paste"]),fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(pc));function V_(s,r){r=(r&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],m=u.event;u=u.listeners;e:{var v=void 0;if(r)for(var T=u.length-1;0<=T;T--){var I=u[T],B=I.instance,W=I.currentTarget;if(I=I.listener,B!==v&&m.isPropagationStopped())break e;v=I,m.currentTarget=W;try{v(m)}catch(se){_d(se)}m.currentTarget=null,v=B}else for(T=0;T<u.length;T++){if(I=u[T],B=I.instance,W=I.currentTarget,I=I.listener,B!==v&&m.isPropagationStopped())break e;v=I,m.currentTarget=W;try{v(m)}catch(se){_d(se)}m.currentTarget=null,v=B}}}}function Ge(s,r){var l=r[jl];l===void 0&&(l=r[jl]=new Set);var u=s+"__bubble";l.has(u)||(U_(r,s,2,!1),l.add(u))}function ip(s,r,l){var u=0;r&&(u|=4),U_(l,s,u,r)}var Od="_reactListening"+Math.random().toString(36).slice(2);function rp(s){if(!s[Od]){s[Od]=!0,wl.forEach(function(l){l!=="selectionchange"&&(Hw.has(l)||ip(l,!1,s),ip(l,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Od]||(r[Od]=!0,ip("selectionchange",!1,r))}}function U_(s,r,l,u){switch(cx(r)){case 2:var m=vC;break;case 8:m=yC;break;default:m=_p}l=m.bind(null,r,l,s),m=void 0,!Wn||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),u?m!==void 0?s.addEventListener(r,l,{capture:!0,passive:m}):s.addEventListener(r,l,!0):m!==void 0?s.addEventListener(r,l,{passive:m}):s.addEventListener(r,l,!1)}function op(s,r,l,u,m){var v=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var T=u.tag;if(T===3||T===4){var I=u.stateNode.containerInfo;if(I===m)break;if(T===4)for(T=u.return;T!==null;){var B=T.tag;if((B===3||B===4)&&T.stateNode.containerInfo===m)return;T=T.return}for(;I!==null;){if(T=sa(I),T===null)return;if(B=T.tag,B===5||B===6||B===26||B===27){u=v=T;continue e}I=I.parentNode}}u=u.return}Pu(function(){var W=v,se=Xn(l),re=[];e:{var Z=_y.get(s);if(Z!==void 0){var J=Jr,Ce=s;switch(s){case"keypress":if(Ms(l)===0)break e;case"keydown":case"keyup":J=io;break;case"focusin":Ce="focus",J=no;break;case"focusout":Ce="blur",J=no;break;case"beforeblur":case"afterblur":J=no;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=Zn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=Mf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=Hu;break;case gy:case vy:case yy:J=so;break;case by:J=$u;break;case"scroll":case"scrollend":J=Lu;break;case"wheel":J=ro;break;case"copy":case"cut":case"paste":J=ao;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=Ul;break;case"toggle":case"beforetoggle":J=Qu}var Te=(r&4)!==0,ct=!Te&&(s==="scroll"||s==="scrollend"),Y=Te?Z!==null?Z+"Capture":null:Z;Te=[];for(var G=W,X;G!==null;){var ae=G;if(X=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||X===null||Y===null||(ae=nr(G,Y),ae!=null&&Te.push(gc(G,ae,X))),ct)break;G=G.return}0<Te.length&&(Z=new J(Z,Ce,null,l,se),re.push({event:Z,listeners:Te}))}}if((r&7)===0){e:{if(Z=s==="mouseover"||s==="pointerover",J=s==="mouseout"||s==="pointerout",Z&&l!==oa&&(Ce=l.relatedTarget||l.fromElement)&&(sa(Ce)||Ce[Qn]))break e;if((J||Z)&&(Z=se.window===se?se:(Z=se.ownerDocument)?Z.defaultView||Z.parentWindow:window,J?(Ce=l.relatedTarget||l.toElement,J=W,Ce=Ce?sa(Ce):null,Ce!==null&&(ct=c(Ce),Te=Ce.tag,Ce!==ct||Te!==5&&Te!==27&&Te!==6)&&(Ce=null)):(J=null,Ce=W),J!==Ce)){if(Te=Zn,ae="onMouseLeave",Y="onMouseEnter",G="mouse",(s==="pointerout"||s==="pointerover")&&(Te=Ul,ae="onPointerLeave",Y="onPointerEnter",G="pointer"),ct=J==null?Z:Ss(J),X=Ce==null?Z:Ss(Ce),Z=new Te(ae,G+"leave",J,l,se),Z.target=ct,Z.relatedTarget=X,ae=null,sa(se)===W&&(Te=new Te(Y,G+"enter",Ce,l,se),Te.target=X,Te.relatedTarget=ct,ae=Te),ct=ae,J&&Ce)t:{for(Te=J,Y=Ce,G=0,X=Te;X;X=Do(X))G++;for(X=0,ae=Y;ae;ae=Do(ae))X++;for(;0<G-X;)Te=Do(Te),G--;for(;0<X-G;)Y=Do(Y),X--;for(;G--;){if(Te===Y||Y!==null&&Te===Y.alternate)break t;Te=Do(Te),Y=Do(Y)}Te=null}else Te=null;J!==null&&F_(re,Z,J,Te,!1),Ce!==null&&ct!==null&&F_(re,ct,Ce,Te,!0)}}e:{if(Z=W?Ss(W):window,J=Z.nodeName&&Z.nodeName.toLowerCase(),J==="select"||J==="input"&&Z.type==="file")var ye=iy;else if(Vt(Z))if(ry)ye=sw;else{ye=tw;var ze=ew}else J=Z.nodeName,!J||J.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?W&&Dl(W.elementType)&&(ye=iy):ye=nw;if(ye&&(ye=ye(s,W))){ha(re,ye,l,se);break e}ze&&ze(s,Z,W),s==="focusout"&&W&&Z.type==="number"&&W.memoizedProps.value!=null&&za(Z,"number",Z.value)}switch(ze=W?Ss(W):window,s){case"focusin":(Vt(ze)||ze.contentEditable==="true")&&(oo=ze,Vf=W,Bl=null);break;case"focusout":Bl=Vf=oo=null;break;case"mousedown":Uf=!0;break;case"contextmenu":case"mouseup":case"dragend":Uf=!1,my(re,l,se);break;case"selectionchange":if(iw)break;case"keydown":case"keyup":my(re,l,se)}var be;if(Ps)e:{switch(s){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else Qe?te(s,l)&&(Ae="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Ae="onCompositionStart");Ae&&(E&&l.locale!=="ko"&&(Qe||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&Qe&&(be=Ol()):(Ds=se,Ha="value"in Ds?Ds.value:Ds.textContent,Qe=!0)),ze=kd(W,Ae),0<ze.length&&(Ae=new Ll(Ae,s,null,l,se),re.push({event:Ae,listeners:ze}),be?Ae.data=be:(be=de(l),be!==null&&(Ae.data=be)))),(be=b?Lt(s,l):Ke(s,l))&&(Ae=kd(W,"onBeforeInput"),0<Ae.length&&(ze=new Ll("onBeforeInput","beforeinput",null,l,se),re.push({event:ze,listeners:Ae}),ze.data=be)),qw(re,s,W,l,se)}V_(re,r)})}function gc(s,r,l){return{instance:s,listener:r,currentTarget:l}}function kd(s,r){for(var l=r+"Capture",u=[];s!==null;){var m=s,v=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||v===null||(m=nr(s,l),m!=null&&u.unshift(gc(s,m,v)),m=nr(s,r),m!=null&&u.push(gc(s,m,v))),s.tag===3)return u;s=s.return}return[]}function Do(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function F_(s,r,l,u,m){for(var v=r._reactName,T=[];l!==null&&l!==u;){var I=l,B=I.alternate,W=I.stateNode;if(I=I.tag,B!==null&&B===u)break;I!==5&&I!==26&&I!==27||W===null||(B=W,m?(W=nr(l,v),W!=null&&T.unshift(gc(l,W,B))):m||(W=nr(l,v),W!=null&&T.push(gc(l,W,B)))),l=l.return}T.length!==0&&s.push({event:r,listeners:T})}var Gw=/\r\n?/g,$w=/\u0000|\uFFFD/g;function q_(s){return(typeof s=="string"?s:""+s).replace(Gw,`
`).replace($w,"")}function B_(s,r){return r=q_(r),q_(s)===r}function Pd(){}function lt(s,r,l,u,m,v){switch(l){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||Kn(s,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&Kn(s,""+u);break;case"className":Is(s,"class",u);break;case"tabIndex":Is(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Is(s,l,u);break;case"style":Rl(s,u,v);break;case"data":if(r!=="object"){Is(s,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Zr(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(r!=="input"&&lt(s,r,"name",m.name,m,null),lt(s,r,"formEncType",m.formEncType,m,null),lt(s,r,"formMethod",m.formMethod,m,null),lt(s,r,"formTarget",m.formTarget,m,null)):(lt(s,r,"encType",m.encType,m,null),lt(s,r,"method",m.method,m,null),lt(s,r,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Zr(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=Pd);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Zr(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":Ge("beforetoggle",s),Ge("toggle",s),Ba(s,"popover",u);break;case"xlinkActuate":Zt(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Zt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Zt(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Zt(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Zt(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Zt(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Zt(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ba(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Rf.get(l)||l,Ba(s,l,u))}}function lp(s,r,l,u,m,v){switch(l){case"style":Rl(s,u,v);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"children":typeof u=="string"?Kn(s,u):(typeof u=="number"||typeof u=="bigint")&&Kn(s,""+u);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"onClick":u!=null&&(s.onclick=Pd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yr.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),r=l.slice(2,m?l.length-7:void 0),v=s[It]||null,v=v!=null?v[l]:null,typeof v=="function"&&s.removeEventListener(r,v,m),typeof u=="function")){typeof v!="function"&&v!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(r,u,m);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):Ba(s,l,u)}}}function nn(s,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",s),Ge("load",s);var u=!1,m=!1,v;for(v in l)if(l.hasOwnProperty(v)){var T=l[v];if(T!=null)switch(v){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:lt(s,r,v,T,l,null)}}m&&lt(s,r,"srcSet",l.srcSet,l,null),u&&lt(s,r,"src",l.src,l,null);return;case"input":Ge("invalid",s);var I=v=T=m=null,B=null,W=null;for(u in l)if(l.hasOwnProperty(u)){var se=l[u];if(se!=null)switch(u){case"name":m=se;break;case"type":T=se;break;case"checked":B=se;break;case"defaultChecked":W=se;break;case"value":v=se;break;case"defaultValue":I=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(a(137,r));break;default:lt(s,r,u,se,l,null)}}Ji(s,v,I,B,W,T,m,!1),Wr(s);return;case"select":Ge("invalid",s),u=T=v=null;for(m in l)if(l.hasOwnProperty(m)&&(I=l[m],I!=null))switch(m){case"value":v=I;break;case"defaultValue":T=I;break;case"multiple":u=I;default:lt(s,r,m,I,l,null)}r=v,l=T,s.multiple=!!u,r!=null?ra(s,!!u,r,!1):l!=null&&ra(s,!!u,l,!0);return;case"textarea":Ge("invalid",s),v=m=u=null;for(T in l)if(l.hasOwnProperty(T)&&(I=l[T],I!=null))switch(T){case"value":u=I;break;case"defaultValue":m=I;break;case"children":v=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(a(91));break;default:lt(s,r,T,I,l,null)}er(s,u,m,v),Wr(s);return;case"option":for(B in l)if(l.hasOwnProperty(B)&&(u=l[B],u!=null))switch(B){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:lt(s,r,B,u,l,null)}return;case"dialog":Ge("beforetoggle",s),Ge("toggle",s),Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":Ge("load",s);break;case"video":case"audio":for(u=0;u<pc.length;u++)Ge(pc[u],s);break;case"image":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"embed":case"source":case"link":Ge("error",s),Ge("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in l)if(l.hasOwnProperty(W)&&(u=l[W],u!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:lt(s,r,W,u,l,null)}return;default:if(Dl(r)){for(se in l)l.hasOwnProperty(se)&&(u=l[se],u!==void 0&&lp(s,r,se,u,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(u=l[I],u!=null&&lt(s,r,I,u,l,null))}function Yw(s,r,l,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,v=null,T=null,I=null,B=null,W=null,se=null;for(J in l){var re=l[J];if(l.hasOwnProperty(J)&&re!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":B=re;default:u.hasOwnProperty(J)||lt(s,r,J,null,u,re)}}for(var Z in u){var J=u[Z];if(re=l[Z],u.hasOwnProperty(Z)&&(J!=null||re!=null))switch(Z){case"type":v=J;break;case"name":m=J;break;case"checked":W=J;break;case"defaultChecked":se=J;break;case"value":T=J;break;case"defaultValue":I=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(a(137,r));break;default:J!==re&&lt(s,r,Z,J,u,re)}}On(s,T,I,B,W,se,v,m);return;case"select":J=T=I=Z=null;for(v in l)if(B=l[v],l.hasOwnProperty(v)&&B!=null)switch(v){case"value":break;case"multiple":J=B;default:u.hasOwnProperty(v)||lt(s,r,v,null,u,B)}for(m in u)if(v=u[m],B=l[m],u.hasOwnProperty(m)&&(v!=null||B!=null))switch(m){case"value":Z=v;break;case"defaultValue":I=v;break;case"multiple":T=v;default:v!==B&&lt(s,r,m,v,u,B)}r=I,l=T,u=J,Z!=null?ra(s,!!l,Z,!1):!!u!=!!l&&(r!=null?ra(s,!!l,r,!0):ra(s,!!l,l?[]:"",!1));return;case"textarea":J=Z=null;for(I in l)if(m=l[I],l.hasOwnProperty(I)&&m!=null&&!u.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:lt(s,r,I,null,u,m)}for(T in u)if(m=u[T],v=l[T],u.hasOwnProperty(T)&&(m!=null||v!=null))switch(T){case"value":Z=m;break;case"defaultValue":J=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(a(91));break;default:m!==v&&lt(s,r,T,m,u,v)}rt(s,Z,J);return;case"option":for(var Ce in l)if(Z=l[Ce],l.hasOwnProperty(Ce)&&Z!=null&&!u.hasOwnProperty(Ce))switch(Ce){case"selected":s.selected=!1;break;default:lt(s,r,Ce,null,u,Z)}for(B in u)if(Z=u[B],J=l[B],u.hasOwnProperty(B)&&Z!==J&&(Z!=null||J!=null))switch(B){case"selected":s.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:lt(s,r,B,Z,u,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Te in l)Z=l[Te],l.hasOwnProperty(Te)&&Z!=null&&!u.hasOwnProperty(Te)&&lt(s,r,Te,null,u,Z);for(W in u)if(Z=u[W],J=l[W],u.hasOwnProperty(W)&&Z!==J&&(Z!=null||J!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(a(137,r));break;default:lt(s,r,W,Z,u,J)}return;default:if(Dl(r)){for(var ct in l)Z=l[ct],l.hasOwnProperty(ct)&&Z!==void 0&&!u.hasOwnProperty(ct)&&lp(s,r,ct,void 0,u,Z);for(se in u)Z=u[se],J=l[se],!u.hasOwnProperty(se)||Z===J||Z===void 0&&J===void 0||lp(s,r,se,Z,u,J);return}}for(var Y in l)Z=l[Y],l.hasOwnProperty(Y)&&Z!=null&&!u.hasOwnProperty(Y)&&lt(s,r,Y,null,u,Z);for(re in u)Z=u[re],J=l[re],!u.hasOwnProperty(re)||Z===J||Z==null&&J==null||lt(s,r,re,Z,u,J)}var cp=null,up=null;function Ld(s){return s.nodeType===9?s:s.ownerDocument}function z_(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function H_(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function dp(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var hp=null;function Qw(){var s=window.event;return s&&s.type==="popstate"?s===hp?!1:(hp=s,!0):(hp=null,!1)}var G_=typeof setTimeout=="function"?setTimeout:void 0,Kw=typeof clearTimeout=="function"?clearTimeout:void 0,$_=typeof Promise=="function"?Promise:void 0,Xw=typeof queueMicrotask=="function"?queueMicrotask:typeof $_<"u"?function(s){return $_.resolve(null).then(s).catch(Ww)}:G_;function Ww(s){setTimeout(function(){throw s})}function ri(s){return s==="head"}function Y_(s,r){var l=r,u=0,m=0;do{var v=l.nextSibling;if(s.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<u&&8>u){l=u;var T=s.ownerDocument;if(l&1&&vc(T.documentElement),l&2&&vc(T.body),l&4)for(l=T.head,vc(l),T=l.firstChild;T;){var I=T.nextSibling,B=T.nodeName;T[Ki]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&T.rel.toLowerCase()==="stylesheet"||l.removeChild(T),T=I}}if(m===0){s.removeChild(v),Ac(r);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:u=l.charCodeAt(0)-48;else u=0;l=v}while(l);Ac(r)}function fp(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":fp(l),qa(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function Zw(s,r,l,u){for(;s.nodeType===1;){var m=l;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Ki])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var v=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=vs(s.nextSibling),s===null)break}return null}function Jw(s,r,l){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=vs(s.nextSibling),s===null))return null;return s}function mp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function eC(s,r){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")r();else{var u=function(){r(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function vs(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return s}var pp=null;function Q_(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return s;r--}else l==="/$"&&r++}s=s.previousSibling}return null}function K_(s,r,l){switch(r=Ld(l),s){case"html":if(s=r.documentElement,!s)throw Error(a(452));return s;case"head":if(s=r.head,!s)throw Error(a(453));return s;case"body":if(s=r.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function vc(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);qa(s)}var is=new Map,X_=new Set;function Vd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Aa=ne.d;ne.d={f:tC,r:nC,D:sC,C:aC,L:iC,m:rC,X:lC,S:oC,M:cC};function tC(){var s=Aa.f(),r=Sd();return s||r}function nC(s){var r=Cs(s);r!==null&&r.tag===5&&r.type==="form"?gb(r):Aa.r(s)}var Mo=typeof document>"u"?null:document;function W_(s,r,l){var u=Mo;if(u&&typeof r=="string"&&r){var m=Rt(r);m='link[rel="'+s+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),X_.has(m)||(X_.add(m),s={rel:s,crossOrigin:l,href:r},u.querySelector(m)===null&&(r=u.createElement("link"),nn(r,"link",s),jt(r),u.head.appendChild(r)))}}function sC(s){Aa.D(s),W_("dns-prefetch",s,null)}function aC(s,r){Aa.C(s,r),W_("preconnect",s,r)}function iC(s,r,l){Aa.L(s,r,l);var u=Mo;if(u&&s&&r){var m='link[rel="preload"][as="'+Rt(r)+'"]';r==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+Rt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+Rt(l.imageSizes)+'"]')):m+='[href="'+Rt(s)+'"]';var v=m;switch(r){case"style":v=Oo(s);break;case"script":v=ko(s)}is.has(v)||(s=y({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:s,as:r},l),is.set(v,s),u.querySelector(m)!==null||r==="style"&&u.querySelector(yc(v))||r==="script"&&u.querySelector(bc(v))||(r=u.createElement("link"),nn(r,"link",s),jt(r),u.head.appendChild(r)))}}function rC(s,r){Aa.m(s,r);var l=Mo;if(l&&s){var u=r&&typeof r.as=="string"?r.as:"script",m='link[rel="modulepreload"][as="'+Rt(u)+'"][href="'+Rt(s)+'"]',v=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ko(s)}if(!is.has(v)&&(s=y({rel:"modulepreload",href:s},r),is.set(v,s),l.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(bc(v)))return}u=l.createElement("link"),nn(u,"link",s),jt(u),l.head.appendChild(u)}}}function oC(s,r,l){Aa.S(s,r,l);var u=Mo;if(u&&s){var m=vn(u).hoistableStyles,v=Oo(s);r=r||"default";var T=m.get(v);if(!T){var I={loading:0,preload:null};if(T=u.querySelector(yc(v)))I.loading=5;else{s=y({rel:"stylesheet",href:s,"data-precedence":r},l),(l=is.get(v))&&gp(s,l);var B=T=u.createElement("link");jt(B),nn(B,"link",s),B._p=new Promise(function(W,se){B.onload=W,B.onerror=se}),B.addEventListener("load",function(){I.loading|=1}),B.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Ud(T,r,u)}T={type:"stylesheet",instance:T,count:1,state:I},m.set(v,T)}}}function lC(s,r){Aa.X(s,r);var l=Mo;if(l&&s){var u=vn(l).hoistableScripts,m=ko(s),v=u.get(m);v||(v=l.querySelector(bc(m)),v||(s=y({src:s,async:!0},r),(r=is.get(m))&&vp(s,r),v=l.createElement("script"),jt(v),nn(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(m,v))}}function cC(s,r){Aa.M(s,r);var l=Mo;if(l&&s){var u=vn(l).hoistableScripts,m=ko(s),v=u.get(m);v||(v=l.querySelector(bc(m)),v||(s=y({src:s,async:!0,type:"module"},r),(r=is.get(m))&&vp(s,r),v=l.createElement("script"),jt(v),nn(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(m,v))}}function Z_(s,r,l,u){var m=(m=Ie.current)?Vd(m):null;if(!m)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=Oo(l.href),l=vn(m).hoistableStyles,u=l.get(r),u||(u={type:"style",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Oo(l.href);var v=vn(m).hoistableStyles,T=v.get(s);if(T||(m=m.ownerDocument||m,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,T),(v=m.querySelector(yc(s)))&&!v._p&&(T.instance=v,T.state.loading=5),is.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},is.set(s,l),v||uC(m,s,l,T.state))),r&&u===null)throw Error(a(528,""));return T}if(r&&u!==null)throw Error(a(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ko(l),l=vn(m).hoistableScripts,u=l.get(r),u||(u={type:"script",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Oo(s){return'href="'+Rt(s)+'"'}function yc(s){return'link[rel="stylesheet"]['+s+"]"}function J_(s){return y({},s,{"data-precedence":s.precedence,precedence:null})}function uC(s,r,l,u){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=s.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),nn(r,"link",l),jt(r),s.head.appendChild(r))}function ko(s){return'[src="'+Rt(s)+'"]'}function bc(s){return"script[async]"+s}function ex(s,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var u=s.querySelector('style[data-href~="'+Rt(l.href)+'"]');if(u)return r.instance=u,jt(u),u;var m=y({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),jt(u),nn(u,"style",m),Ud(u,l.precedence,s),r.instance=u;case"stylesheet":m=Oo(l.href);var v=s.querySelector(yc(m));if(v)return r.state.loading|=4,r.instance=v,jt(v),v;u=J_(l),(m=is.get(m))&&gp(u,m),v=(s.ownerDocument||s).createElement("link"),jt(v);var T=v;return T._p=new Promise(function(I,B){T.onload=I,T.onerror=B}),nn(v,"link",u),r.state.loading|=4,Ud(v,l.precedence,s),r.instance=v;case"script":return v=ko(l.src),(m=s.querySelector(bc(v)))?(r.instance=m,jt(m),m):(u=l,(m=is.get(v))&&(u=y({},l),vp(u,m)),s=s.ownerDocument||s,m=s.createElement("script"),jt(m),nn(m,"link",u),s.head.appendChild(m),r.instance=m);case"void":return null;default:throw Error(a(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Ud(u,l.precedence,s));return r.instance}function Ud(s,r,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,v=m,T=0;T<u.length;T++){var I=u[T];if(I.dataset.precedence===r)v=I;else if(v!==m)break}v?v.parentNode.insertBefore(s,v.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(s,r.firstChild))}function gp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function vp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var Fd=null;function tx(s,r,l){if(Fd===null){var u=new Map,m=Fd=new Map;m.set(l,u)}else m=Fd,u=m.get(l),u||(u=new Map,m.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),m=0;m<l.length;m++){var v=l[m];if(!(v[Ki]||v[Pt]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var T=v.getAttribute(r)||"";T=s+T;var I=u.get(T);I?I.push(v):u.set(T,[v])}}return u}function nx(s,r,l){s=s.ownerDocument||s,s.head.insertBefore(l,r==="title"?s.querySelector("head > title"):null)}function dC(s,r,l){if(l===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function sx(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var _c=null;function hC(){}function fC(s,r,l){if(_c===null)throw Error(a(475));var u=_c;if(r.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var m=Oo(l.href),v=s.querySelector(yc(m));if(v){s=v._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(u.count++,u=qd.bind(u),s.then(u,u)),r.state.loading|=4,r.instance=v,jt(v);return}v=s.ownerDocument||s,l=J_(l),(m=is.get(m))&&gp(l,m),v=v.createElement("link"),jt(v);var T=v;T._p=new Promise(function(I,B){T.onload=I,T.onerror=B}),nn(v,"link",l),r.instance=v}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(r,s),(s=r.state.preload)&&(r.state.loading&3)===0&&(u.count++,r=qd.bind(u),s.addEventListener("load",r),s.addEventListener("error",r))}}function mC(){if(_c===null)throw Error(a(475));var s=_c;return s.stylesheets&&s.count===0&&yp(s,s.stylesheets),0<s.count?function(r){var l=setTimeout(function(){if(s.stylesheets&&yp(s,s.stylesheets),s.unsuspend){var u=s.unsuspend;s.unsuspend=null,u()}},6e4);return s.unsuspend=r,function(){s.unsuspend=null,clearTimeout(l)}}:null}function qd(){if(this.count--,this.count===0){if(this.stylesheets)yp(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Bd=null;function yp(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Bd=new Map,r.forEach(pC,s),Bd=null,qd.call(s))}function pC(s,r){if(!(r.state.loading&4)){var l=Bd.get(s);if(l)var u=l.get(null);else{l=new Map,Bd.set(s,l);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<m.length;v++){var T=m[v];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(l.set(T.dataset.precedence,T),u=T)}u&&l.set(null,u)}m=r.instance,T=m.getAttribute("data-precedence"),v=l.get(T)||u,v===u&&l.set(null,m),l.set(T,m),this.count++,u=qd.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),v?v.parentNode.insertBefore(m,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),r.state.loading|=4}}var xc={$$typeof:U,Provider:null,Consumer:null,_currentValue:he,_currentValue2:he,_threadCount:0};function gC(s,r,l,u,m,v,T,I){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ta(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ta(0),this.hiddenUpdates=ta(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=v,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function ax(s,r,l,u,m,v,T,I,B,W,se,re){return s=new gC(s,r,l,T,I,B,W,re),r=1,v===!0&&(r|=24),v=Pn(3,null,null,r),s.current=v,v.stateNode=s,r=Jf(),r.refCount++,s.pooledCache=r,r.refCount++,v.memoizedState={element:u,isDehydrated:l,cache:r},sm(v),s}function ix(s){return s?(s=ho,s):ho}function rx(s,r,l,u,m,v){m=ix(m),u.context===null?u.context=m:u.pendingContext=m,u=Ya(r),u.payload={element:l},v=v===void 0?null:v,v!==null&&(u.callback=v),l=Qa(s,u,r),l!==null&&(qn(l,s,r),Wl(l,s,r))}function ox(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<r?l:r}}function bp(s,r){ox(s,r),(s=s.alternate)&&ox(s,r)}function lx(s){if(s.tag===13){var r=uo(s,67108864);r!==null&&qn(r,s,67108864),bp(s,67108864)}}var zd=!0;function vC(s,r,l,u){var m=Q.T;Q.T=null;var v=ne.p;try{ne.p=2,_p(s,r,l,u)}finally{ne.p=v,Q.T=m}}function yC(s,r,l,u){var m=Q.T;Q.T=null;var v=ne.p;try{ne.p=8,_p(s,r,l,u)}finally{ne.p=v,Q.T=m}}function _p(s,r,l,u){if(zd){var m=xp(u);if(m===null)op(s,r,u,Hd,l),ux(s,u);else if(_C(m,s,r,l,u))u.stopPropagation();else if(ux(s,u),r&4&&-1<bC.indexOf(s)){for(;m!==null;){var v=Cs(m);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var T=hs(v.pendingLanes);if(T!==0){var I=v;for(I.pendingLanes|=2,I.entangledLanes|=2;T;){var B=1<<31-cn(T);I.entanglements[1]|=B,T&=~B}Bs(v),(at&6)===0&&(wd=Yn()+500,mc(0))}}break;case 13:I=uo(v,2),I!==null&&qn(I,v,2),Sd(),bp(v,2)}if(v=xp(u),v===null&&op(s,r,u,Hd,l),v===m)break;m=v}m!==null&&u.stopPropagation()}else op(s,r,u,null,l)}}function xp(s){return s=Xn(s),Np(s)}var Hd=null;function Np(s){if(Hd=null,s=sa(s),s!==null){var r=c(s);if(r===null)s=null;else{var l=r.tag;if(l===13){if(s=d(r),s!==null)return s;s=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return Hd=s,null}function cx(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Af()){case bl:return 2;case zr:return 8;case Hi:case jf:return 32;case Hr:return 268435456;default:return 32}default:return 32}}var Ep=!1,oi=null,li=null,ci=null,Nc=new Map,Ec=new Map,ui=[],bC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ux(s,r){switch(s){case"focusin":case"focusout":oi=null;break;case"dragenter":case"dragleave":li=null;break;case"mouseover":case"mouseout":ci=null;break;case"pointerover":case"pointerout":Nc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ec.delete(r.pointerId)}}function Tc(s,r,l,u,m,v){return s===null||s.nativeEvent!==v?(s={blockedOn:r,domEventName:l,eventSystemFlags:u,nativeEvent:v,targetContainers:[m]},r!==null&&(r=Cs(r),r!==null&&lx(r)),s):(s.eventSystemFlags|=u,r=s.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),s)}function _C(s,r,l,u,m){switch(r){case"focusin":return oi=Tc(oi,s,r,l,u,m),!0;case"dragenter":return li=Tc(li,s,r,l,u,m),!0;case"mouseover":return ci=Tc(ci,s,r,l,u,m),!0;case"pointerover":var v=m.pointerId;return Nc.set(v,Tc(Nc.get(v)||null,s,r,l,u,m)),!0;case"gotpointercapture":return v=m.pointerId,Ec.set(v,Tc(Ec.get(v)||null,s,r,l,u,m)),!0}return!1}function dx(s){var r=sa(s.target);if(r!==null){var l=c(r);if(l!==null){if(r=l.tag,r===13){if(r=d(l),r!==null){s.blockedOn=r,Su(s.priority,function(){if(l.tag===13){var u=Fn();u=Va(u);var m=uo(l,u);m!==null&&qn(m,l,u),bp(l,u)}});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Gd(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var l=xp(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);oa=u,l.target.dispatchEvent(u),oa=null}else return r=Cs(l),r!==null&&lx(r),s.blockedOn=l,!1;r.shift()}return!0}function hx(s,r,l){Gd(s)&&l.delete(r)}function xC(){Ep=!1,oi!==null&&Gd(oi)&&(oi=null),li!==null&&Gd(li)&&(li=null),ci!==null&&Gd(ci)&&(ci=null),Nc.forEach(hx),Ec.forEach(hx)}function $d(s,r){s.blockedOn===r&&(s.blockedOn=null,Ep||(Ep=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,xC)))}var Yd=null;function fx(s){Yd!==s&&(Yd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Yd===s&&(Yd=null);for(var r=0;r<s.length;r+=3){var l=s[r],u=s[r+1],m=s[r+2];if(typeof u!="function"){if(Np(u||l)===null)continue;break}var v=Cs(l);v!==null&&(s.splice(r,3),r-=3,Nm(v,{pending:!0,data:m,method:l.method,action:u},u,m))}}))}function Ac(s){function r(B){return $d(B,s)}oi!==null&&$d(oi,s),li!==null&&$d(li,s),ci!==null&&$d(ci,s),Nc.forEach(r),Ec.forEach(r);for(var l=0;l<ui.length;l++){var u=ui[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<ui.length&&(l=ui[0],l.blockedOn===null);)dx(l),l.blockedOn===null&&ui.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var m=l[u],v=l[u+1],T=m[It]||null;if(typeof v=="function")T||fx(l);else if(T){var I=null;if(v&&v.hasAttribute("formAction")){if(m=v,T=v[It]||null)I=T.formAction;else if(Np(m)!==null)continue}else I=T.action;typeof I=="function"?l[u+1]=I:(l.splice(u,3),u-=3),fx(l)}}}function Tp(s){this._internalRoot=s}Qd.prototype.render=Tp.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(a(409));var l=r.current,u=Fn();rx(l,u,s,r,null,null)},Qd.prototype.unmount=Tp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;rx(s.current,2,null,s,null,null),Sd(),r[Qn]=null}};function Qd(s){this._internalRoot=s}Qd.prototype.unstable_scheduleHydration=function(s){if(s){var r=Ua();s={blockedOn:null,target:s,priority:r};for(var l=0;l<ui.length&&r!==0&&r<ui[l].priority;l++);ui.splice(l,0,s),l===0&&dx(s)}};var mx=e.version;if(mx!=="19.1.0")throw Error(a(527,mx,"19.1.0"));ne.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=p(r),s=s!==null?g(s):null,s=s===null?null:s.stateNode,s};var NC={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kd.isDisabled&&Kd.supportsFiber)try{Et=Kd.inject(NC),st=Kd}catch{}}return wc.createRoot=function(s,r){if(!o(s))throw Error(a(299));var l=!1,u="",m=Ib,v=Rb,T=Db,I=null;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(T=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(I=r.unstable_transitionCallbacks)),r=ax(s,1,!1,null,null,l,u,m,v,T,I,null),s[Qn]=r.current,rp(s),new Tp(r)},wc.hydrateRoot=function(s,r,l){if(!o(s))throw Error(a(299));var u=!1,m="",v=Ib,T=Rb,I=Db,B=null,W=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(T=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(B=l.unstable_transitionCallbacks),l.formState!==void 0&&(W=l.formState)),r=ax(s,1,!0,r,l??null,u,m,v,T,I,B,W),r.context=ix(null),l=r.current,u=Fn(),u=Va(u),m=Ya(u),m.callback=null,Qa(l,m,u),l=u,r.current.lanes=l,na(r,l),Bs(r),s[Qn]=r.current,rp(s),new Qd(r)},wc.version="19.1.0",wc}var Tx;function DC(){if(Tx)return wp.exports;Tx=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),wp.exports=RC(),wp.exports}var MC=DC();const OC=()=>{};var Ax={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E=function(n){const e=[];let t=0;for(let a=0;a<n.length;a++){let o=n.charCodeAt(a);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&a+1<n.length&&(n.charCodeAt(a+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++a)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},kC=function(n){const e=[];let t=0,a=0;for(;t<n.length;){const o=n[t++];if(o<128)e[a++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[a++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],f=n[t++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|f&63)-65536;e[a++]=String.fromCharCode(55296+(p>>10)),e[a++]=String.fromCharCode(56320+(p&1023))}else{const c=n[t++],d=n[t++];e[a++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},YE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,f=d?n[o+1]:0,p=o+2<n.length,g=p?n[o+2]:0,y=c>>2,_=(c&3)<<4|f>>4;let N=(f&15)<<2|g>>6,j=g&63;p||(j=64,d||(N=64)),a.push(t[y],t[_],t[N],t[j])}return a.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray($E(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):kC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],f=o<n.length?t[n.charAt(o)]:0;++o;const g=o<n.length?t[n.charAt(o)]:64;++o;const _=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||f==null||g==null||_==null)throw new PC;const N=c<<2|f>>4;if(a.push(N),g!==64){const j=f<<4&240|g>>2;if(a.push(j),_!==64){const x=g<<6&192|_;a.push(x)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class PC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const LC=function(n){const e=$E(n);return YE.encodeByteArray(e,!0)},vh=function(n){return LC(n).replace(/\./g,"")},QE=function(n){try{return YE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=()=>VC().__FIREBASE_DEFAULTS__,FC=()=>{if(typeof process>"u"||typeof Ax>"u")return;const n=Ax.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},qC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&QE(n[1]);return e&&JSON.parse(e)},Hh=()=>{try{return OC()||UC()||FC()||qC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},KE=n=>{var e,t;return(t=(e=Hh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},XE=n=>{const e=KE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},WE=()=>{var n;return(n=Hh())===null||n===void 0?void 0:n.config},ZE=n=>{var e;return(e=Hh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lr(n){return n.endsWith(".cloudworkstations.dev")}async function Rg(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${a}`,aud:a,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},n);return[vh(JSON.stringify(t)),vh(JSON.stringify(d)),""].join(".")}const Oc={};function zC(){const n={prod:[],emulator:[]};for(const e of Object.keys(Oc))Oc[e]?n.emulator.push(e):n.prod.push(e);return n}function HC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let jx=!1;function Dg(n,e){if(typeof window>"u"||typeof document>"u"||!Lr(window.location.host)||Oc[n]===e||Oc[n]||jx)return;Oc[n]=e;function t(N){return`__firebase__banner__${N}`}const a="__firebase__banner",c=zC().prod.length>0;function d(){const N=document.getElementById(a);N&&N.remove()}function f(N){N.style.display="flex",N.style.background="#7faaf0",N.style.position="fixed",N.style.bottom="5px",N.style.left="5px",N.style.padding=".5em",N.style.borderRadius="5px",N.style.alignItems="center"}function p(N,j){N.setAttribute("width","24"),N.setAttribute("id",j),N.setAttribute("height","24"),N.setAttribute("viewBox","0 0 24 24"),N.setAttribute("fill","none"),N.style.marginLeft="-6px"}function g(){const N=document.createElement("span");return N.style.cursor="pointer",N.style.marginLeft="16px",N.style.fontSize="24px",N.innerHTML=" &times;",N.onclick=()=>{jx=!0,d()},N}function y(N,j){N.setAttribute("id",j),N.innerText="Learn more",N.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",N.setAttribute("target","__blank"),N.style.paddingLeft="5px",N.style.textDecoration="underline"}function _(){const N=HC(a),j=t("text"),x=document.getElementById(j)||document.createElement("span"),R=t("learnmore"),A=document.getElementById(R)||document.createElement("a"),O=t("preprendIcon"),q=document.getElementById(O)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(N.created){const U=N.element;f(U),y(A,R);const P=g();p(q,O),U.append(q,x,A,P),document.body.appendChild(U)}c?(x.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",j)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function GC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gn())}function $C(){var n;const e=(n=Hh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function YC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Mg(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function QC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function KC(){const n=gn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function XC(){return!$C()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Gh(){try{return typeof indexedDB=="object"}catch{return!1}}function $h(){return new Promise((n,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(a);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(a),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}function Og(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC="FirebaseError";class us extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=WC,Object.setPrototypeOf(this,us.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oi.prototype.create)}}class Oi{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?ZC(c,a):"Error",f=`${this.serviceName}: ${d} (${o}).`;return new us(o,f,a)}}function ZC(n,e){return n.replace(JC,(t,a)=>{const o=e[a];return o!=null?String(o):`<${a}?>`})}const JC=/\{\$([^}]+)}/g;function eS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ti(n,e){if(n===e)return!0;const t=Object.keys(n),a=Object.keys(e);for(const o of t){if(!a.includes(o))return!1;const c=n[o],d=e[o];if(wx(c)&&wx(d)){if(!Ti(c,d))return!1}else if(c!==d)return!1}for(const o of a)if(!t.includes(o))return!1;return!0}function wx(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(n){const e=[];for(const[t,a]of Object.entries(n))Array.isArray(a)?a.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function Cc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[o,c]=a.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Sc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function tS(n,e){const t=new nS(n,e);return t.subscribe.bind(t)}class nS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let o;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");sS(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:a},o.next===void 0&&(o.next=Rp),o.error===void 0&&(o.error=Rp),o.complete===void 0&&(o.complete=Rp);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Rp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS=1e3,iS=2,rS=4*60*60*1e3,oS=.5;function Cx(n,e=aS,t=iS){const a=e*Math.pow(t,n),o=Math.round(oS*a*(Math.random()-.5)*2);return Math.min(rS,a+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(n){return n&&n._delegate?n._delegate:n}class $n{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ar="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new BC;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&a.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const a=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(a)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:a})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(uS(e))try{this.getOrInitializeService({instanceIdentifier:Ar})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});a.resolve(c)}catch{}}}}clearInstance(e=Ar){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ar){return this.instances.has(e)}getOptions(e=Ar){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[c,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(c);a===f&&d.resolve(o)}return o}onInit(e,t){var a;const o=this.normalizeInstanceIdentifier(t),c=(a=this.onInitCallbacks.get(o))!==null&&a!==void 0?a:new Set;c.add(e),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&e(d,o),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const o of a)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:cS(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=Ar){return this.component?this.component.multipleInstances?e:Ar:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function cS(n){return n===Ar?void 0:n}function uS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new lS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})($e||($e={}));const hS={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},fS=$e.INFO,mS={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},pS=(n,e,...t)=>{if(e<n.logLevel)return;const a=new Date().toISOString(),o=mS[e];if(o)console[o](`[${a}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lu{constructor(e){this.name=e,this._logLevel=fS,this._logHandler=pS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const gS=(n,e)=>e.some(t=>n instanceof t);let Sx,Ix;function vS(){return Sx||(Sx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yS(){return Ix||(Ix=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const eT=new WeakMap,Jp=new WeakMap,tT=new WeakMap,Dp=new WeakMap,kg=new WeakMap;function bS(n){const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(bi(n.result)),o()},d=()=>{a(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&eT.set(t,n)}).catch(()=>{}),kg.set(e,n),e}function _S(n){if(Jp.has(n))return;const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{a(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});Jp.set(n,e)}let eg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Jp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||tT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function xS(n){eg=n(eg)}function NS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=n.call(Mp(this),e,...t);return tT.set(a,e.sort?e.sort():[e]),bi(a)}:yS().includes(n)?function(...e){return n.apply(Mp(this),e),bi(eT.get(this))}:function(...e){return bi(n.apply(Mp(this),e))}}function ES(n){return typeof n=="function"?NS(n):(n instanceof IDBTransaction&&_S(n),gS(n,vS())?new Proxy(n,eg):n)}function bi(n){if(n instanceof IDBRequest)return bS(n);if(Dp.has(n))return Dp.get(n);const e=ES(n);return e!==n&&(Dp.set(n,e),kg.set(e,n)),e}const Mp=n=>kg.get(n);function nT(n,e,{blocked:t,upgrade:a,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),f=bi(d);return a&&d.addEventListener("upgradeneeded",p=>{a(bi(d.result),p.oldVersion,p.newVersion,bi(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),f.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),f}const TS=["get","getKey","getAll","getAllKeys","count"],AS=["put","add","delete","clear"],Op=new Map;function Rx(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Op.get(e))return Op.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,o=AS.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(o||TS.includes(t)))return;const c=async function(d,...f){const p=this.transaction(d,o?"readwrite":"readonly");let g=p.store;return a&&(g=g.index(f.shift())),(await Promise.all([g[t](...f),o&&p.done]))[0]};return Op.set(e,c),c}xS(n=>({...n,get:(e,t,a)=>Rx(e,t)||n.get(e,t,a),has:(e,t)=>!!Rx(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(wS(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function wS(n){const e=n.getComponent();return e?.type==="VERSION"}const tg="@firebase/app",Dx="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=new lu("@firebase/app"),CS="@firebase/app-compat",SS="@firebase/analytics-compat",IS="@firebase/analytics",RS="@firebase/app-check-compat",DS="@firebase/app-check",MS="@firebase/auth",OS="@firebase/auth-compat",kS="@firebase/database",PS="@firebase/data-connect",LS="@firebase/database-compat",VS="@firebase/functions",US="@firebase/functions-compat",FS="@firebase/installations",qS="@firebase/installations-compat",BS="@firebase/messaging",zS="@firebase/messaging-compat",HS="@firebase/performance",GS="@firebase/performance-compat",$S="@firebase/remote-config",YS="@firebase/remote-config-compat",QS="@firebase/storage",KS="@firebase/storage-compat",XS="@firebase/firestore",WS="@firebase/ai",ZS="@firebase/firestore-compat",JS="firebase",eI="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng="[DEFAULT]",tI={[tg]:"fire-core",[CS]:"fire-core-compat",[IS]:"fire-analytics",[SS]:"fire-analytics-compat",[DS]:"fire-app-check",[RS]:"fire-app-check-compat",[MS]:"fire-auth",[OS]:"fire-auth-compat",[kS]:"fire-rtdb",[PS]:"fire-data-connect",[LS]:"fire-rtdb-compat",[VS]:"fire-fn",[US]:"fire-fn-compat",[FS]:"fire-iid",[qS]:"fire-iid-compat",[BS]:"fire-fcm",[zS]:"fire-fcm-compat",[HS]:"fire-perf",[GS]:"fire-perf-compat",[$S]:"fire-rc",[YS]:"fire-rc-compat",[QS]:"fire-gcs",[KS]:"fire-gcs-compat",[XS]:"fire-fst",[ZS]:"fire-fst-compat",[WS]:"fire-vertex","fire-js":"fire-js",[JS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yh=new Map,nI=new Map,sg=new Map;function Mx(n,e){try{n.container.addComponent(e)}catch(t){Ra.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ls(n){const e=n.name;if(sg.has(e))return Ra.debug(`There were multiple attempts to register component ${e}.`),!1;sg.set(e,n);for(const t of yh.values())Mx(t,n);for(const t of nI.values())Mx(t,n);return!0}function ka(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function In(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_i=new Oi("app","Firebase",sI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e,t,a){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _i.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vr=eI;function sT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const a=Object.assign({name:ng,automaticDataCollectionEnabled:!0},e),o=a.name;if(typeof o!="string"||!o)throw _i.create("bad-app-name",{appName:String(o)});if(t||(t=WE()),!t)throw _i.create("no-options");const c=yh.get(o);if(c){if(Ti(t,c.options)&&Ti(a,c.config))return c;throw _i.create("duplicate-app",{appName:o})}const d=new dS(o);for(const p of sg.values())d.addComponent(p);const f=new aI(t,a,d);return yh.set(o,f),f}function cu(n=ng){const e=yh.get(n);if(!e&&n===ng&&WE())return sT();if(!e)throw _i.create("no-app",{appName:n});return e}function pn(n,e,t){var a;let o=(a=tI[n])!==null&&a!==void 0?a:n;t&&(o+=`-${t}`);const c=o.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const f=[`Unable to register library "${o}" with version "${e}":`];c&&f.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ra.warn(f.join(" "));return}ls(new $n(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI="firebase-heartbeat-database",rI=1,$c="firebase-heartbeat-store";let kp=null;function aT(){return kp||(kp=nT(iI,rI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore($c)}catch(t){console.warn(t)}}}}).catch(n=>{throw _i.create("idb-open",{originalErrorMessage:n.message})})),kp}async function oI(n){try{const t=(await aT()).transaction($c),a=await t.objectStore($c).get(iT(n));return await t.done,a}catch(e){if(e instanceof us)Ra.warn(e.message);else{const t=_i.create("idb-get",{originalErrorMessage:e?.message});Ra.warn(t.message)}}}async function Ox(n,e){try{const a=(await aT()).transaction($c,"readwrite");await a.objectStore($c).put(e,iT(n)),await a.done}catch(t){if(t instanceof us)Ra.warn(t.message);else{const a=_i.create("idb-set",{originalErrorMessage:t?.message});Ra.warn(a.message)}}}function iT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI=1024,cI=30;class uI{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new hI(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=kx();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>cI){const d=fI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){Ra.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=kx(),{heartbeatsToSend:a,unsentEntries:o}=dI(this._heartbeatsCache.heartbeats),c=vh(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Ra.warn(t),""}}}function kx(){return new Date().toISOString().substring(0,10)}function dI(n,e=lI){const t=[];let a=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),Px(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Px(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class hI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Gh()?$h().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await oI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return Ox(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return Ox(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function Px(n){return vh(JSON.stringify({version:2,heartbeats:n})).length}function fI(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let a=1;a<n.length;a++)n[a].date<t&&(t=n[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mI(n){ls(new $n("platform-logger",e=>new jS(e),"PRIVATE")),ls(new $n("heartbeat",e=>new uI(e),"PRIVATE")),pn(tg,Dx,n),pn(tg,Dx,"esm2017"),pn("fire-js","")}mI("");function Pg(n,e){var t={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&e.indexOf(a)<0&&(t[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(n);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(n,a[o])&&(t[a[o]]=n[a[o]]);return t}function rT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const pI=rT,oT=new Oi("auth","Firebase",rT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh=new lu("@firebase/auth");function gI(n,...e){bh.logLevel<=$e.WARN&&bh.warn(`Auth (${Vr}): ${n}`,...e)}function ih(n,...e){bh.logLevel<=$e.ERROR&&bh.error(`Auth (${Vr}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(n,...e){throw Vg(n,...e)}function Es(n,...e){return Vg(n,...e)}function Lg(n,e,t){const a=Object.assign(Object.assign({},pI()),{[e]:t});return new Oi("auth","Firebase",a).create(e,{appName:n.name})}function Ia(n){return Lg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function vI(n,e,t){const a=t;if(!(e instanceof a))throw a.name!==e.constructor.name&&cs(n,"argument-error"),Lg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Vg(n,...e){if(typeof n!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=n.name),n._errorFactory.create(t,...a)}return oT.create(n,...e)}function we(n,e,...t){if(!n)throw Vg(e,...t)}function Ca(n){const e="INTERNAL ASSERTION FAILED: "+n;throw ih(e),new Error(e)}function Da(n,e){n||Ca(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ag(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function yI(){return Lx()==="http:"||Lx()==="https:"}function Lx(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(yI()||Mg()||"connection"in navigator)?navigator.onLine:!0}function _I(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Da(t>e,"Short delay should be less than long delay!"),this.isMobile=GC()||QC()}get(){return bI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(n,e){Da(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ca("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ca("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ca("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],EI=new uu(3e4,6e4);function ki(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Pi(n,e,t,a,o={}){return cT(n,o,async()=>{let c={},d={};a&&(e==="GET"?d=a:c={body:JSON.stringify(a)});const f=ou(Object.assign({key:n.config.apiKey},d)).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const g=Object.assign({method:e,headers:p},c);return YC()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&Lr(n.emulatorConfig.host)&&(g.credentials="include"),lT.fetch()(await uT(n,n.config.apiHost,t,f),g)})}async function cT(n,e,t){n._canInitEmulator=!1;const a=Object.assign(Object.assign({},xI),e);try{const o=new AI(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw Xd(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const f=c.ok?d.errorMessage:d.error.message,[p,g]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xd(n,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw Xd(n,"email-already-in-use",d);if(p==="USER_DISABLED")throw Xd(n,"user-disabled",d);const y=a[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw Lg(n,y,g);cs(n,y)}}catch(o){if(o instanceof us)throw o;cs(n,"network-request-failed",{message:String(o)})}}async function du(n,e,t,a,o={}){const c=await Pi(n,e,t,a,o);return"mfaPendingCredential"in c&&cs(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function uT(n,e,t,a){const o=`${e}${t}?${a}`,c=n,d=c.config.emulator?Ug(n.config,o):`${n.config.apiScheme}://${o}`;return NI.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function TI(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class AI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(Es(this.auth,"network-request-failed")),EI.get())})}}function Xd(n,e,t){const a={appName:n.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const o=Es(n,e,a);return o.customData._tokenResponse=t,o}function Vx(n){return n!==void 0&&n.enterprise!==void 0}class jI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return TI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function wI(n,e){return Pi(n,"GET","/v2/recaptchaConfig",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CI(n,e){return Pi(n,"POST","/v1/accounts:delete",e)}async function _h(n,e){return Pi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function SI(n,e=!1){const t=yt(n),a=await t.getIdToken(e),o=Fg(a);we(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:a,authTime:kc(Pp(o.auth_time)),issuedAtTime:kc(Pp(o.iat)),expirationTime:kc(Pp(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Pp(n){return Number(n)*1e3}function Fg(n){const[e,t,a]=n.split(".");if(e===void 0||t===void 0||a===void 0)return ih("JWT malformed, contained fewer than 3 sections"),null;try{const o=QE(t);return o?JSON.parse(o):(ih("Failed to decode base64 JWT payload"),null)}catch(o){return ih("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Ux(n){const e=Fg(n);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yc(n,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof us&&II(a)&&n.auth.currentUser===n&&await n.auth.signOut(),a}}function II({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const a=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),a}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=kc(this.lastLoginAt),this.creationTime=kc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xh(n){var e;const t=n.auth,a=await n.getIdToken(),o=await Yc(n,_h(t,{idToken:a}));we(o?.users.length,t,"internal-error");const c=o.users[0];n._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?dT(c.providerUserInfo):[],f=MI(n.providerData,d),p=n.isAnonymous,g=!(n.email&&c.passwordHash)&&!f?.length,y=p?g:!1,_={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:f,metadata:new ig(c.createdAt,c.lastLoginAt),isAnonymous:y};Object.assign(n,_)}async function DI(n){const e=yt(n);await xh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function MI(n,e){return[...n.filter(a=>!e.some(o=>o.providerId===a.providerId)),...e]}function dT(n){return n.map(e=>{var{providerId:t}=e,a=Pg(e,["providerId"]);return{providerId:t,uid:a.rawId||"",displayName:a.displayName||null,email:a.email||null,phoneNumber:a.phoneNumber||null,photoURL:a.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OI(n,e){const t=await cT(n,{},async()=>{const a=ou({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await uT(n,o,"/v1/token",`key=${c}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:a};return n.emulatorConfig&&Lr(n.emulatorConfig.host)&&(p.credentials="include"),lT.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function kI(n,e){return Pi(n,"POST","/v2/accounts:revokeToken",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ux(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){we(e.length!==0,"internal-error");const t=Ux(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(we(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:o,expiresIn:c}=await OI(e,t);this.updateTokensAndExpiration(a,o,Number(c))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:o,expirationTime:c}=t,d=new $o;return a&&(we(typeof a=="string","internal-error",{appName:e}),d.refreshToken=a),o&&(we(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(we(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $o,this.toJSON())}_performRefresh(){return Ca("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(n,e){we(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class xs{constructor(e){var{uid:t,auth:a,stsTokenManager:o}=e,c=Pg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new RI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=a,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new ig(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await Yc(this,this.stsTokenManager.getToken(this.auth,e));return we(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return SI(this,e)}reload(){return DI(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new xs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await xh(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(In(this.auth.app))return Promise.reject(Ia(this.auth));const e=await this.getIdToken();return await Yc(this,CI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var a,o,c,d,f,p,g,y;const _=(a=t.displayName)!==null&&a!==void 0?a:void 0,N=(o=t.email)!==null&&o!==void 0?o:void 0,j=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,x=(d=t.photoURL)!==null&&d!==void 0?d:void 0,R=(f=t.tenantId)!==null&&f!==void 0?f:void 0,A=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,O=(g=t.createdAt)!==null&&g!==void 0?g:void 0,q=(y=t.lastLoginAt)!==null&&y!==void 0?y:void 0,{uid:U,emailVerified:P,isAnonymous:F,providerData:$,stsTokenManager:V}=t;we(U&&V,e,"internal-error");const S=$o.fromJSON(this.name,V);we(typeof U=="string",e,"internal-error"),hi(_,e.name),hi(N,e.name),we(typeof P=="boolean",e,"internal-error"),we(typeof F=="boolean",e,"internal-error"),hi(j,e.name),hi(x,e.name),hi(R,e.name),hi(A,e.name),hi(O,e.name),hi(q,e.name);const L=new xs({uid:U,auth:e,email:N,emailVerified:P,displayName:_,isAnonymous:F,photoURL:x,phoneNumber:j,tenantId:R,stsTokenManager:S,createdAt:O,lastLoginAt:q});return $&&Array.isArray($)&&(L.providerData=$.map(M=>Object.assign({},M))),A&&(L._redirectEventId=A),L}static async _fromIdTokenResponse(e,t,a=!1){const o=new $o;o.updateFromServerResponse(t);const c=new xs({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:a});return await xh(c),c}static async _fromGetAccountInfoResponse(e,t,a){const o=t.users[0];we(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?dT(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,f=new $o;f.updateFromIdToken(a);const p=new xs({uid:o.localId,auth:e,stsTokenManager:f,isAnonymous:d}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new ig(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,g),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx=new Map;function Sa(n){Da(n instanceof Function,"Expected a class definition");let e=Fx.get(n);return e?(Da(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Fx.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}hT.type="NONE";const qx=hT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rh(n,e,t){return`firebase:${n}:${e}:${t}`}class Yo{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:o,name:c}=this.auth;this.fullUserKey=rh(this.userKey,o.apiKey,c),this.fullPersistenceKey=rh("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await _h(this.auth,{idToken:e}).catch(()=>{});return t?xs._fromGetAccountInfoResponse(this.auth,t,e):null}return xs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new Yo(Sa(qx),e,a);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let c=o[0]||Sa(qx);const d=rh(a,e.config.apiKey,e.name);let f=null;for(const g of t)try{const y=await g._get(d);if(y){let _;if(typeof y=="string"){const N=await _h(e,{idToken:y}).catch(()=>{});if(!N)break;_=await xs._fromGetAccountInfoResponse(e,N,y)}else _=xs._fromJSON(e,y);g!==c&&(f=_),c=g;break}}catch{}const p=o.filter(g=>g._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new Yo(c,e,a):(c=p[0],f&&await c._set(d,f.toJSON()),await Promise.all(t.map(async g=>{if(g!==c)try{await g._remove(d)}catch{}})),new Yo(c,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(yT(e))return"Blackberry";if(bT(e))return"Webos";if(mT(e))return"Safari";if((e.includes("chrome/")||pT(e))&&!e.includes("edge/"))return"Chrome";if(vT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=n.match(t);if(a?.length===2)return a[1]}return"Other"}function fT(n=gn()){return/firefox\//i.test(n)}function mT(n=gn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pT(n=gn()){return/crios\//i.test(n)}function gT(n=gn()){return/iemobile/i.test(n)}function vT(n=gn()){return/android/i.test(n)}function yT(n=gn()){return/blackberry/i.test(n)}function bT(n=gn()){return/webos/i.test(n)}function qg(n=gn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function PI(n=gn()){var e;return qg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function LI(){return KC()&&document.documentMode===10}function _T(n=gn()){return qg(n)||vT(n)||bT(n)||yT(n)||/windows phone/i.test(n)||gT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xT(n,e=[]){let t;switch(n){case"Browser":t=Bx(gn());break;case"Worker":t=`${Bx(gn())}-${n}`;break;default:t=n}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Vr}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=c=>new Promise((d,f)=>{try{const p=e(c);d(p)}catch(p){f(p)}});a.onAbort=t,this.queue.push(a);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UI(n,e={}){return Pi(n,"GET","/v2/passwordPolicy",ki(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI=6;class qI{constructor(e){var t,a,o,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:FI,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(a=e.allowedNonAlphanumericCharacters)===null||a===void 0?void 0:a.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,a,o,c,d,f;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(a=p.meetsMaxPasswordLength)!==null&&a!==void 0?a:!0),p.isValid&&(p.isValid=(o=p.containsLowercaseLetter)!==null&&o!==void 0?o:!0),p.isValid&&(p.isValid=(c=p.containsUppercaseLetter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(d=p.containsNumericCharacter)!==null&&d!==void 0?d:!0),p.isValid&&(p.isValid=(f=p.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),p}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let o=0;o<e.length;o++)a=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(e,t,a,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zx(this),this.idTokenSubscription=new zx(this),this.beforeStateQueue=new VI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=oT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Sa(t)),this._initializationPromise=this.queue(async()=>{var a,o,c;if(!this._deleted&&(this.persistenceManager=await Yo.create(this,e),(a=this._resolvePersistenceManagerAvailable)===null||a===void 0||a.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await _h(this,{idToken:e}),a=await xs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(In(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const a=await this.assertedPersistence.getCurrentUser();let o=a,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=o?._redirectEventId,p=await this.tryRedirectSignIn(e);(!d||d===f)&&p?.user&&(o=p.user,c=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(o)}catch(d){o=a,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await xh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_I()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(In(this.app))return Promise.reject(Ia(this));const t=e?yt(e):null;return t&&we(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return In(this.app)?Promise.reject(Ia(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return In(this.app)?Promise.reject(Ia(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await UI(this),t=new qI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Oi("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await kI(this,a)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Sa(e)||this._popupRedirectResolver;we(t,this,"argument-error"),this.redirectPersistenceManager=await Yo.create(this,[Sa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,a;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((a=this.redirectUser)===null||a===void 0?void 0:a._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const a=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==a&&(this.lastNotifiedUid=a,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(we(f,this,"internal-error"),f.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,a,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const a=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());a&&(t["X-Firebase-Client"]=a);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(In(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&gI(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Li(n){return yt(n)}class zx{constructor(e){this.auth=e,this.observer=null,this.addObserver=tS(t=>this.observer=t)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zI(n){Yh=n}function NT(n){return Yh.loadJS(n)}function HI(){return Yh.recaptchaEnterpriseScript}function GI(){return Yh.gapiScript}function $I(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class YI{constructor(){this.enterprise=new QI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class QI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const KI="recaptcha-enterprise",ET="NO_RECAPTCHA";class XI{constructor(e){this.type=KI,this.auth=Li(e)}async verify(e="verify",t=!1){async function a(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,f)=>{wI(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const g=new jI(p);return c.tenantId==null?c._agentRecaptchaConfig=g:c._tenantRecaptchaConfigs[c.tenantId]=g,d(g.siteKey)}}).catch(p=>{f(p)})})}function o(c,d,f){const p=window.grecaptcha;Vx(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(g=>{d(g)}).catch(()=>{d(ET)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new YI().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{a(this.auth).then(f=>{if(!t&&Vx(window.grecaptcha))o(f,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=HI();p.length!==0&&(p+=f),NT(p).then(()=>{o(f,c,d)}).catch(g=>{d(g)})}}).catch(f=>{d(f)})})}}async function Hx(n,e,t,a=!1,o=!1){const c=new XI(n);let d;if(o)d=ET;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,g=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return a?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function rg(n,e,t,a,o){var c;if(!((c=n._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Hx(n,e,t,t==="getOobCode");return a(n,d)}else return a(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Hx(n,e,t,t==="getOobCode");return a(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WI(n,e){const t=ka(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Ti(c,e??{}))return o;cs(o,"already-initialized")}return t.initialize({options:e})}function ZI(n,e){const t=e?.persistence||[],a=(Array.isArray(t)?t:[t]).map(Sa);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(a,e?.popupRedirectResolver)}function JI(n,e,t){const a=Li(n);we(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const o=!1,c=TT(e),{host:d,port:f}=eR(e),p=f===null?"":`:${f}`,g={url:`${c}//${d}${p}/`},y=Object.freeze({host:d,port:f,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!a._canInitEmulator){we(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),we(Ti(g,a.config.emulator)&&Ti(y,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=g,a.emulatorConfig=y,a.settings.appVerificationDisabledForTesting=!0,Lr(d)?(Rg(`${c}//${d}${p}`),Dg("Auth",!0)):tR()}function TT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function eR(n){const e=TT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(a);if(o){const c=o[1];return{host:c,port:Gx(a.substr(c.length+1))}}else{const[c,d]=a.split(":");return{host:c,port:Gx(d)}}}function Gx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function tR(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ca("not implemented")}_getIdTokenResponse(e){return Ca("not implemented")}_linkToIdToken(e,t){return Ca("not implemented")}_getReauthenticationResolver(e){return Ca("not implemented")}}async function nR(n,e){return Pi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sR(n,e){return du(n,"POST","/v1/accounts:signInWithPassword",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aR(n,e){return du(n,"POST","/v1/accounts:signInWithEmailLink",ki(n,e))}async function iR(n,e){return du(n,"POST","/v1/accounts:signInWithEmailLink",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc extends Bg{constructor(e,t,a,o=null){super("password",a),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Qc(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new Qc(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rg(e,t,"signInWithPassword",sR);case"emailLink":return aR(e,{email:this._email,oobCode:this._password});default:cs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return rg(e,a,"signUpPassword",nR);case"emailLink":return iR(e,{idToken:t,email:this._email,oobCode:this._password});default:cs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qo(n,e){return du(n,"POST","/v1/accounts:signInWithIdp",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR="http://localhost";class Ir extends Bg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ir(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):cs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:o}=t,c=Pg(t,["providerId","signInMethod"]);if(!a||!o)return null;const d=new Ir(a,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Qo(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,Qo(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qo(e,t)}buildRequest(){const e={requestUri:rR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ou(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oR(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function lR(n){const e=Cc(Sc(n)).link,t=e?Cc(Sc(e)).deep_link_id:null,a=Cc(Sc(n)).deep_link_id;return(a?Cc(Sc(a)).link:null)||a||t||e||n}class zg{constructor(e){var t,a,o,c,d,f;const p=Cc(Sc(e)),g=(t=p.apiKey)!==null&&t!==void 0?t:null,y=(a=p.oobCode)!==null&&a!==void 0?a:null,_=oR((o=p.mode)!==null&&o!==void 0?o:null);we(g&&y&&_,"argument-error"),this.apiKey=g,this.operation=_,this.code=y,this.continueUrl=(c=p.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=p.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=p.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=lR(e);try{return new zg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(){this.providerId=cl.PROVIDER_ID}static credential(e,t){return Qc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=zg.parseLink(t);return we(a,"argument-error"),Qc._fromEmailAndCode(e,a.code,a.tenantId)}}cl.PROVIDER_ID="password";cl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";cl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu extends Hg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends hu{constructor(){super("facebook.com")}static credential(e){return Ir._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.FACEBOOK_SIGN_IN_METHOD="facebook.com";mi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa extends hu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ir._fromParams({providerId:wa.PROVIDER_ID,signInMethod:wa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wa.credentialFromTaggedObject(e)}static credentialFromError(e){return wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return wa.credential(t,a)}catch{return null}}}wa.GOOGLE_SIGN_IN_METHOD="google.com";wa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends hu{constructor(){super("github.com")}static credential(e){return Ir._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pi.credential(e.oauthAccessToken)}catch{return null}}}pi.GITHUB_SIGN_IN_METHOD="github.com";pi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends hu{constructor(){super("twitter.com")}static credential(e,t){return Ir._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return gi.credential(t,a)}catch{return null}}}gi.TWITTER_SIGN_IN_METHOD="twitter.com";gi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cR(n,e){return du(n,"POST","/v1/accounts:signUp",ki(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,o=!1){const c=await xs._fromIdTokenResponse(e,a,o),d=$x(a);return new Rr({user:c,providerId:d,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const o=$x(a);return new Rr({user:e,providerId:o,_tokenResponse:a,operationType:t})}}function $x(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh extends us{constructor(e,t,a,o){var c;super(t.code,t.message),this.operationType=a,this.user=o,Object.setPrototypeOf(this,Nh.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,o){return new Nh(e,t,a,o)}}function AT(n,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?Nh._fromErrorAndOperation(n,c,e,a):c})}async function uR(n,e,t=!1){const a=await Yc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Rr._forOperation(n,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dR(n,e,t=!1){const{auth:a}=n;if(In(a.app))return Promise.reject(Ia(a));const o="reauthenticate";try{const c=await Yc(n,AT(a,o,e,n),t);we(c.idToken,a,"internal-error");const d=Fg(c.idToken);we(d,a,"internal-error");const{sub:f}=d;return we(n.uid===f,a,"user-mismatch"),Rr._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&cs(a,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jT(n,e,t=!1){if(In(n.app))return Promise.reject(Ia(n));const a="signIn",o=await AT(n,a,e),c=await Rr._fromIdTokenResponse(n,a,o);return t||await n._updateCurrentUser(c.user),c}async function hR(n,e){return jT(Li(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wT(n){const e=Li(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function fR(n,e,t){if(In(n.app))return Promise.reject(Ia(n));const a=Li(n),d=await rg(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",cR).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&wT(n),p}),f=await Rr._fromIdTokenResponse(a,"signIn",d);return await a._updateCurrentUser(f.user),f}function mR(n,e,t){return In(n.app)?Promise.reject(Ia(n)):hR(yt(n),cl.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&wT(n),a})}function pR(n,e,t,a){return yt(n).onIdTokenChanged(e,t,a)}function gR(n,e,t){return yt(n).beforeAuthStateChanged(e,t)}function vR(n,e,t,a){return yt(n).onAuthStateChanged(e,t,a)}function yR(n){return yt(n).signOut()}const Eh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Eh,"1"),this.storage.removeItem(Eh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR=1e3,_R=10;class ST extends CT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_T(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),o=this.localCache[t];a!==o&&e(t,o,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,p)=>{this.notifyListeners(d,p)});return}const a=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(a);!t&&this.localCache[a]===d||this.notifyListeners(a,d)},c=this.storage.getItem(a);LI()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,_R):o()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},bR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ST.type="LOCAL";const xR=ST;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT extends CT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}IT.type="SESSION";const RT=IT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const a=new Qh(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:o});const f=Array.from(d).map(async g=>g(t.origin,c)),p=await NR(f);t.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(n="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((f,p)=>{const g=Gg("",20);o.port1.start();const y=setTimeout(()=>{p(new Error("unsupported_event"))},a);d={messageChannel:o,onMessage(_){const N=_;if(N.data.eventId===g)switch(N.data.status){case"ack":clearTimeout(y),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),f(N.data.response);break;default:clearTimeout(y),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(){return window}function TR(n){Ys().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(){return typeof Ys().WorkerGlobalScope<"u"&&typeof Ys().importScripts=="function"}async function AR(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jR(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function wR(){return DT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT="firebaseLocalStorageDb",CR=1,Th="firebaseLocalStorage",OT="fbase_key";class fu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Kh(n,e){return n.transaction([Th],e?"readwrite":"readonly").objectStore(Th)}function SR(){const n=indexedDB.deleteDatabase(MT);return new fu(n).toPromise()}function og(){const n=indexedDB.open(MT,CR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const a=n.result;try{a.createObjectStore(Th,{keyPath:OT})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const a=n.result;a.objectStoreNames.contains(Th)?e(a):(a.close(),await SR(),e(await og()))})})}async function Yx(n,e,t){const a=Kh(n,!0).put({[OT]:e,value:t});return new fu(a).toPromise()}async function IR(n,e){const t=Kh(n,!1).get(e),a=await new fu(t).toPromise();return a===void 0?null:a.value}function Qx(n,e){const t=Kh(n,!0).delete(e);return new fu(t).toPromise()}const RR=800,DR=3;class kT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await og(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>DR)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return DT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qh._getInstance(wR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await AR(),!this.activeServiceWorker)return;this.sender=new ER(this.activeServiceWorker);const a=await this.sender._send("ping",{},800);a&&!((e=a[0])===null||e===void 0)&&e.fulfilled&&!((t=a[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await og();return await Yx(e,Eh,"1"),await Qx(e,Eh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>Yx(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>IR(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Qx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Kh(o,!1).getAll();return new fu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)a.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!a.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),RR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}kT.type="LOCAL";const MR=kT;new uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n,e){return e?Sa(e):(we(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g extends Bg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function OR(n){return jT(n.auth,new $g(n),n.bypassAuthState)}function kR(n){const{auth:e,user:t}=n;return we(t,e,"internal-error"),dR(t,new $g(n),n.bypassAuthState)}async function PR(n){const{auth:e,user:t}=n;return we(t,e,"internal-error"),uR(t,new $g(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e,t,a,o,c=!1){this.auth=e,this.resolver=a,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:o,tenantId:c,error:d,type:f}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:a,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OR;case"linkViaPopup":case"linkViaRedirect":return PR;case"reauthViaPopup":case"reauthViaRedirect":return kR;default:cs(this.auth,"internal-error")}}resolve(e){Da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR=new uu(2e3,1e4);async function VR(n,e,t){if(In(n.app))return Promise.reject(Es(n,"operation-not-supported-in-this-environment"));const a=Li(n);vI(n,e,Hg);const o=PT(a,t);return new jr(a,"signInViaPopup",e,o).executeNotNull()}class jr extends LT{constructor(e,t,a,o,c){super(e,t,o,c),this.provider=a,this.authWindow=null,this.pollId=null,jr.currentPopupAction&&jr.currentPopupAction.cancel(),jr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){Da(this.filter.length===1,"Popup operations only handle one event");const e=Gg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Es(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Es(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,jr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,a;if(!((a=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||a===void 0)&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Es(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,LR.get())};e()}}jr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR="pendingRedirect",oh=new Map;class FR extends LT{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=oh.get(this.auth._key());if(!e){try{const a=await qR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}oh.set(this.auth._key(),e)}return this.bypassAuthState||oh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qR(n,e){const t=HR(e),a=zR(n);if(!await a._isAvailable())return!1;const o=await a._get(t)==="true";return await a._remove(t),o}function BR(n,e){oh.set(n._key(),e)}function zR(n){return Sa(n._redirectPersistence)}function HR(n){return rh(UR,n.config.apiKey,n.name)}async function GR(n,e,t=!1){if(In(n.app))return Promise.reject(Ia(n));const a=Li(n),o=PT(a,e),d=await new FR(a,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await a._persistUserIfCurrent(d.user),await a._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R=10*60*1e3;class YR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!QR(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var a;if(e.error&&!VT(e)){const o=((a=e.error.code)===null||a===void 0?void 0:a.split("auth/")[1])||"internal-error";t.onError(Es(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=$R&&this.cachedEventUids.clear(),this.cachedEventUids.has(Kx(e))}saveEventToCache(e){this.cachedEventUids.add(Kx(e)),this.lastProcessedEventTime=Date.now()}}function Kx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function VT({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function QR(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return VT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KR(n,e={}){return Pi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,WR=/^https?/;async function ZR(n){if(n.config.emulator)return;const{authorizedDomains:e}=await KR(n);for(const t of e)try{if(JR(t))return}catch{}cs(n,"unauthorized-domain")}function JR(n){const e=ag(),{protocol:t,hostname:a}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&a===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===a}if(!WR.test(t))return!1;if(XR.test(n))return a===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1=new uu(3e4,6e4);function Xx(){const n=Ys().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function t1(n){return new Promise((e,t)=>{var a,o,c;function d(){Xx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Xx(),t(Es(n,"network-request-failed"))},timeout:e1.get()})}if(!((o=(a=Ys().gapi)===null||a===void 0?void 0:a.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((c=Ys().gapi)===null||c===void 0)&&c.load)d();else{const f=$I("iframefcb");return Ys()[f]=()=>{gapi.load?d():t(Es(n,"network-request-failed"))},NT(`${GI()}?onload=${f}`).catch(p=>t(p))}}).catch(e=>{throw lh=null,e})}let lh=null;function n1(n){return lh=lh||t1(n),lh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1=new uu(5e3,15e3),a1="__/auth/iframe",i1="emulator/auth/iframe",r1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},o1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function l1(n){const e=n.config;we(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ug(e,i1):`https://${n.config.authDomain}/${a1}`,a={apiKey:e.apiKey,appName:n.name,v:Vr},o=o1.get(n.config.apiHost);o&&(a.eid=o);const c=n._getFrameworks();return c.length&&(a.fw=c.join(",")),`${t}?${ou(a).slice(1)}`}async function c1(n){const e=await n1(n),t=Ys().gapi;return we(t,n,"internal-error"),e.open({where:document.body,url:l1(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:r1,dontclear:!0},a=>new Promise(async(o,c)=>{await a.restyle({setHideOnLeave:!1});const d=Es(n,"network-request-failed"),f=Ys().setTimeout(()=>{c(d)},s1.get());function p(){Ys().clearTimeout(f),o(a)}a.ping(p).then(p,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},d1=500,h1=600,f1="_blank",m1="http://localhost";class Wx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function p1(n,e,t,a=d1,o=h1){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-a)/2,0).toString();let f="";const p=Object.assign(Object.assign({},u1),{width:a.toString(),height:o.toString(),top:c,left:d}),g=gn().toLowerCase();t&&(f=pT(g)?f1:t),fT(g)&&(e=e||m1,p.scrollbars="yes");const y=Object.entries(p).reduce((N,[j,x])=>`${N}${j}=${x},`,"");if(PI(g)&&f!=="_self")return g1(e||"",f),new Wx(null);const _=window.open(e||"",f,y);we(_,n,"popup-blocked");try{_.focus()}catch{}return new Wx(_)}function g1(n,e){const t=document.createElement("a");t.href=n,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1="__/auth/handler",y1="emulator/auth/handler",b1=encodeURIComponent("fac");async function Zx(n,e,t,a,o,c){we(n.config.authDomain,n,"auth-domain-config-required"),we(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:a,v:Vr,eventId:o};if(e instanceof Hg){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",eS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,_]of Object.entries({}))d[y]=_}if(e instanceof hu){const y=e.getScopes().filter(_=>_!=="");y.length>0&&(d.scopes=y.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const y of Object.keys(f))f[y]===void 0&&delete f[y];const p=await n._getAppCheckToken(),g=p?`#${b1}=${encodeURIComponent(p)}`:"";return`${_1(n)}?${ou(f).slice(1)}${g}`}function _1({config:n}){return n.emulator?Ug(n,y1):`https://${n.authDomain}/${v1}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="webStorageSupport";class x1{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=RT,this._completeRedirectFn=GR,this._overrideRedirectResult=BR}async _openPopup(e,t,a,o){var c;Da((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await Zx(e,t,a,ag(),o);return p1(e,d,Gg())}async _openRedirect(e,t,a,o){await this._originValidation(e);const c=await Zx(e,t,a,ag(),o);return TR(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Da(c,"If manager is not set, promise should be"),c)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await c1(e),a=new YR(e);return t.register("authEvent",o=>(we(o?.authEvent,e,"invalid-auth-event"),{status:a.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Lp,{type:Lp},o=>{var c;const d=(c=o?.[0])===null||c===void 0?void 0:c[Lp];d!==void 0&&t(!!d),cs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ZR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return _T()||mT()||qg()}}const N1=x1;var Jx="@firebase/auth",eN="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e(a?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T1(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function A1(n){ls(new $n("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=a.options;we(d&&!d.includes(":"),"invalid-api-key",{appName:a.name});const p={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xT(n)},g=new BI(a,o,c,p);return ZI(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),ls(new $n("auth-internal",e=>{const t=Li(e.getProvider("auth").getImmediate());return(a=>new E1(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pn(Jx,eN,T1(n)),pn(Jx,eN,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1=5*60,w1=ZE("authIdTokenMaxAge")||j1;let tN=null;const C1=n=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>w1)return;const o=t?.token;tN!==o&&(tN=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function S1(n=cu()){const e=ka(n,"auth");if(e.isInitialized())return e.getImmediate();const t=WI(n,{popupRedirectResolver:N1,persistence:[MR,xR,RT]}),a=ZE("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(a,location.origin);if(location.origin===c.origin){const d=C1(c.toString());gR(t,d,()=>d(t.currentUser)),pR(t,f=>d(f))}}const o=KE("auth");return o&&JI(t,`http://${o}`),t}function I1(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}zI({loadJS(n){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",n),a.onload=e,a.onerror=o=>{const c=Es("internal-error");c.customData=o,t(c)},a.type="text/javascript",a.charset="UTF-8",I1().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});A1("Browser");var R1="firebase",D1="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn(R1,D1,"app");var nN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xi,UT;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(V,S){function L(){}L.prototype=S.prototype,V.D=S.prototype,V.prototype=new L,V.prototype.constructor=V,V.C=function(M,w,C){for(var D=Array(arguments.length-2),me=2;me<arguments.length;me++)D[me-2]=arguments[me];return S.prototype[w].apply(M,D)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(a,t),a.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(V,S,L){L||(L=0);var M=Array(16);if(typeof S=="string")for(var w=0;16>w;++w)M[w]=S.charCodeAt(L++)|S.charCodeAt(L++)<<8|S.charCodeAt(L++)<<16|S.charCodeAt(L++)<<24;else for(w=0;16>w;++w)M[w]=S[L++]|S[L++]<<8|S[L++]<<16|S[L++]<<24;S=V.g[0],L=V.g[1],w=V.g[2];var C=V.g[3],D=S+(C^L&(w^C))+M[0]+3614090360&4294967295;S=L+(D<<7&4294967295|D>>>25),D=C+(w^S&(L^w))+M[1]+3905402710&4294967295,C=S+(D<<12&4294967295|D>>>20),D=w+(L^C&(S^L))+M[2]+606105819&4294967295,w=C+(D<<17&4294967295|D>>>15),D=L+(S^w&(C^S))+M[3]+3250441966&4294967295,L=w+(D<<22&4294967295|D>>>10),D=S+(C^L&(w^C))+M[4]+4118548399&4294967295,S=L+(D<<7&4294967295|D>>>25),D=C+(w^S&(L^w))+M[5]+1200080426&4294967295,C=S+(D<<12&4294967295|D>>>20),D=w+(L^C&(S^L))+M[6]+2821735955&4294967295,w=C+(D<<17&4294967295|D>>>15),D=L+(S^w&(C^S))+M[7]+4249261313&4294967295,L=w+(D<<22&4294967295|D>>>10),D=S+(C^L&(w^C))+M[8]+1770035416&4294967295,S=L+(D<<7&4294967295|D>>>25),D=C+(w^S&(L^w))+M[9]+2336552879&4294967295,C=S+(D<<12&4294967295|D>>>20),D=w+(L^C&(S^L))+M[10]+4294925233&4294967295,w=C+(D<<17&4294967295|D>>>15),D=L+(S^w&(C^S))+M[11]+2304563134&4294967295,L=w+(D<<22&4294967295|D>>>10),D=S+(C^L&(w^C))+M[12]+1804603682&4294967295,S=L+(D<<7&4294967295|D>>>25),D=C+(w^S&(L^w))+M[13]+4254626195&4294967295,C=S+(D<<12&4294967295|D>>>20),D=w+(L^C&(S^L))+M[14]+2792965006&4294967295,w=C+(D<<17&4294967295|D>>>15),D=L+(S^w&(C^S))+M[15]+1236535329&4294967295,L=w+(D<<22&4294967295|D>>>10),D=S+(w^C&(L^w))+M[1]+4129170786&4294967295,S=L+(D<<5&4294967295|D>>>27),D=C+(L^w&(S^L))+M[6]+3225465664&4294967295,C=S+(D<<9&4294967295|D>>>23),D=w+(S^L&(C^S))+M[11]+643717713&4294967295,w=C+(D<<14&4294967295|D>>>18),D=L+(C^S&(w^C))+M[0]+3921069994&4294967295,L=w+(D<<20&4294967295|D>>>12),D=S+(w^C&(L^w))+M[5]+3593408605&4294967295,S=L+(D<<5&4294967295|D>>>27),D=C+(L^w&(S^L))+M[10]+38016083&4294967295,C=S+(D<<9&4294967295|D>>>23),D=w+(S^L&(C^S))+M[15]+3634488961&4294967295,w=C+(D<<14&4294967295|D>>>18),D=L+(C^S&(w^C))+M[4]+3889429448&4294967295,L=w+(D<<20&4294967295|D>>>12),D=S+(w^C&(L^w))+M[9]+568446438&4294967295,S=L+(D<<5&4294967295|D>>>27),D=C+(L^w&(S^L))+M[14]+3275163606&4294967295,C=S+(D<<9&4294967295|D>>>23),D=w+(S^L&(C^S))+M[3]+4107603335&4294967295,w=C+(D<<14&4294967295|D>>>18),D=L+(C^S&(w^C))+M[8]+1163531501&4294967295,L=w+(D<<20&4294967295|D>>>12),D=S+(w^C&(L^w))+M[13]+2850285829&4294967295,S=L+(D<<5&4294967295|D>>>27),D=C+(L^w&(S^L))+M[2]+4243563512&4294967295,C=S+(D<<9&4294967295|D>>>23),D=w+(S^L&(C^S))+M[7]+1735328473&4294967295,w=C+(D<<14&4294967295|D>>>18),D=L+(C^S&(w^C))+M[12]+2368359562&4294967295,L=w+(D<<20&4294967295|D>>>12),D=S+(L^w^C)+M[5]+4294588738&4294967295,S=L+(D<<4&4294967295|D>>>28),D=C+(S^L^w)+M[8]+2272392833&4294967295,C=S+(D<<11&4294967295|D>>>21),D=w+(C^S^L)+M[11]+1839030562&4294967295,w=C+(D<<16&4294967295|D>>>16),D=L+(w^C^S)+M[14]+4259657740&4294967295,L=w+(D<<23&4294967295|D>>>9),D=S+(L^w^C)+M[1]+2763975236&4294967295,S=L+(D<<4&4294967295|D>>>28),D=C+(S^L^w)+M[4]+1272893353&4294967295,C=S+(D<<11&4294967295|D>>>21),D=w+(C^S^L)+M[7]+4139469664&4294967295,w=C+(D<<16&4294967295|D>>>16),D=L+(w^C^S)+M[10]+3200236656&4294967295,L=w+(D<<23&4294967295|D>>>9),D=S+(L^w^C)+M[13]+681279174&4294967295,S=L+(D<<4&4294967295|D>>>28),D=C+(S^L^w)+M[0]+3936430074&4294967295,C=S+(D<<11&4294967295|D>>>21),D=w+(C^S^L)+M[3]+3572445317&4294967295,w=C+(D<<16&4294967295|D>>>16),D=L+(w^C^S)+M[6]+76029189&4294967295,L=w+(D<<23&4294967295|D>>>9),D=S+(L^w^C)+M[9]+3654602809&4294967295,S=L+(D<<4&4294967295|D>>>28),D=C+(S^L^w)+M[12]+3873151461&4294967295,C=S+(D<<11&4294967295|D>>>21),D=w+(C^S^L)+M[15]+530742520&4294967295,w=C+(D<<16&4294967295|D>>>16),D=L+(w^C^S)+M[2]+3299628645&4294967295,L=w+(D<<23&4294967295|D>>>9),D=S+(w^(L|~C))+M[0]+4096336452&4294967295,S=L+(D<<6&4294967295|D>>>26),D=C+(L^(S|~w))+M[7]+1126891415&4294967295,C=S+(D<<10&4294967295|D>>>22),D=w+(S^(C|~L))+M[14]+2878612391&4294967295,w=C+(D<<15&4294967295|D>>>17),D=L+(C^(w|~S))+M[5]+4237533241&4294967295,L=w+(D<<21&4294967295|D>>>11),D=S+(w^(L|~C))+M[12]+1700485571&4294967295,S=L+(D<<6&4294967295|D>>>26),D=C+(L^(S|~w))+M[3]+2399980690&4294967295,C=S+(D<<10&4294967295|D>>>22),D=w+(S^(C|~L))+M[10]+4293915773&4294967295,w=C+(D<<15&4294967295|D>>>17),D=L+(C^(w|~S))+M[1]+2240044497&4294967295,L=w+(D<<21&4294967295|D>>>11),D=S+(w^(L|~C))+M[8]+1873313359&4294967295,S=L+(D<<6&4294967295|D>>>26),D=C+(L^(S|~w))+M[15]+4264355552&4294967295,C=S+(D<<10&4294967295|D>>>22),D=w+(S^(C|~L))+M[6]+2734768916&4294967295,w=C+(D<<15&4294967295|D>>>17),D=L+(C^(w|~S))+M[13]+1309151649&4294967295,L=w+(D<<21&4294967295|D>>>11),D=S+(w^(L|~C))+M[4]+4149444226&4294967295,S=L+(D<<6&4294967295|D>>>26),D=C+(L^(S|~w))+M[11]+3174756917&4294967295,C=S+(D<<10&4294967295|D>>>22),D=w+(S^(C|~L))+M[2]+718787259&4294967295,w=C+(D<<15&4294967295|D>>>17),D=L+(C^(w|~S))+M[9]+3951481745&4294967295,V.g[0]=V.g[0]+S&4294967295,V.g[1]=V.g[1]+(w+(D<<21&4294967295|D>>>11))&4294967295,V.g[2]=V.g[2]+w&4294967295,V.g[3]=V.g[3]+C&4294967295}a.prototype.u=function(V,S){S===void 0&&(S=V.length);for(var L=S-this.blockSize,M=this.B,w=this.h,C=0;C<S;){if(w==0)for(;C<=L;)o(this,V,C),C+=this.blockSize;if(typeof V=="string"){for(;C<S;)if(M[w++]=V.charCodeAt(C++),w==this.blockSize){o(this,M),w=0;break}}else for(;C<S;)if(M[w++]=V[C++],w==this.blockSize){o(this,M),w=0;break}}this.h=w,this.o+=S},a.prototype.v=function(){var V=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);V[0]=128;for(var S=1;S<V.length-8;++S)V[S]=0;var L=8*this.o;for(S=V.length-8;S<V.length;++S)V[S]=L&255,L/=256;for(this.u(V),V=Array(16),S=L=0;4>S;++S)for(var M=0;32>M;M+=8)V[L++]=this.g[S]>>>M&255;return V};function c(V,S){var L=f;return Object.prototype.hasOwnProperty.call(L,V)?L[V]:L[V]=S(V)}function d(V,S){this.h=S;for(var L=[],M=!0,w=V.length-1;0<=w;w--){var C=V[w]|0;M&&C==S||(L[w]=C,M=!1)}this.g=L}var f={};function p(V){return-128<=V&&128>V?c(V,function(S){return new d([S|0],0>S?-1:0)}):new d([V|0],0>V?-1:0)}function g(V){if(isNaN(V)||!isFinite(V))return _;if(0>V)return A(g(-V));for(var S=[],L=1,M=0;V>=L;M++)S[M]=V/L|0,L*=4294967296;return new d(S,0)}function y(V,S){if(V.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(V.charAt(0)=="-")return A(y(V.substring(1),S));if(0<=V.indexOf("-"))throw Error('number format error: interior "-" character');for(var L=g(Math.pow(S,8)),M=_,w=0;w<V.length;w+=8){var C=Math.min(8,V.length-w),D=parseInt(V.substring(w,w+C),S);8>C?(C=g(Math.pow(S,C)),M=M.j(C).add(g(D))):(M=M.j(L),M=M.add(g(D)))}return M}var _=p(0),N=p(1),j=p(16777216);n=d.prototype,n.m=function(){if(R(this))return-A(this).m();for(var V=0,S=1,L=0;L<this.g.length;L++){var M=this.i(L);V+=(0<=M?M:4294967296+M)*S,S*=4294967296}return V},n.toString=function(V){if(V=V||10,2>V||36<V)throw Error("radix out of range: "+V);if(x(this))return"0";if(R(this))return"-"+A(this).toString(V);for(var S=g(Math.pow(V,6)),L=this,M="";;){var w=P(L,S).g;L=O(L,w.j(S));var C=((0<L.g.length?L.g[0]:L.h)>>>0).toString(V);if(L=w,x(L))return C+M;for(;6>C.length;)C="0"+C;M=C+M}},n.i=function(V){return 0>V?0:V<this.g.length?this.g[V]:this.h};function x(V){if(V.h!=0)return!1;for(var S=0;S<V.g.length;S++)if(V.g[S]!=0)return!1;return!0}function R(V){return V.h==-1}n.l=function(V){return V=O(this,V),R(V)?-1:x(V)?0:1};function A(V){for(var S=V.g.length,L=[],M=0;M<S;M++)L[M]=~V.g[M];return new d(L,~V.h).add(N)}n.abs=function(){return R(this)?A(this):this},n.add=function(V){for(var S=Math.max(this.g.length,V.g.length),L=[],M=0,w=0;w<=S;w++){var C=M+(this.i(w)&65535)+(V.i(w)&65535),D=(C>>>16)+(this.i(w)>>>16)+(V.i(w)>>>16);M=D>>>16,C&=65535,D&=65535,L[w]=D<<16|C}return new d(L,L[L.length-1]&-2147483648?-1:0)};function O(V,S){return V.add(A(S))}n.j=function(V){if(x(this)||x(V))return _;if(R(this))return R(V)?A(this).j(A(V)):A(A(this).j(V));if(R(V))return A(this.j(A(V)));if(0>this.l(j)&&0>V.l(j))return g(this.m()*V.m());for(var S=this.g.length+V.g.length,L=[],M=0;M<2*S;M++)L[M]=0;for(M=0;M<this.g.length;M++)for(var w=0;w<V.g.length;w++){var C=this.i(M)>>>16,D=this.i(M)&65535,me=V.i(w)>>>16,De=V.i(w)&65535;L[2*M+2*w]+=D*De,q(L,2*M+2*w),L[2*M+2*w+1]+=C*De,q(L,2*M+2*w+1),L[2*M+2*w+1]+=D*me,q(L,2*M+2*w+1),L[2*M+2*w+2]+=C*me,q(L,2*M+2*w+2)}for(M=0;M<S;M++)L[M]=L[2*M+1]<<16|L[2*M];for(M=S;M<2*S;M++)L[M]=0;return new d(L,0)};function q(V,S){for(;(V[S]&65535)!=V[S];)V[S+1]+=V[S]>>>16,V[S]&=65535,S++}function U(V,S){this.g=V,this.h=S}function P(V,S){if(x(S))throw Error("division by zero");if(x(V))return new U(_,_);if(R(V))return S=P(A(V),S),new U(A(S.g),A(S.h));if(R(S))return S=P(V,A(S)),new U(A(S.g),S.h);if(30<V.g.length){if(R(V)||R(S))throw Error("slowDivide_ only works with positive integers.");for(var L=N,M=S;0>=M.l(V);)L=F(L),M=F(M);var w=$(L,1),C=$(M,1);for(M=$(M,2),L=$(L,2);!x(M);){var D=C.add(M);0>=D.l(V)&&(w=w.add(L),C=D),M=$(M,1),L=$(L,1)}return S=O(V,w.j(S)),new U(w,S)}for(w=_;0<=V.l(S);){for(L=Math.max(1,Math.floor(V.m()/S.m())),M=Math.ceil(Math.log(L)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),C=g(L),D=C.j(S);R(D)||0<D.l(V);)L-=M,C=g(L),D=C.j(S);x(C)&&(C=N),w=w.add(C),V=O(V,D)}return new U(w,V)}n.A=function(V){return P(this,V).h},n.and=function(V){for(var S=Math.max(this.g.length,V.g.length),L=[],M=0;M<S;M++)L[M]=this.i(M)&V.i(M);return new d(L,this.h&V.h)},n.or=function(V){for(var S=Math.max(this.g.length,V.g.length),L=[],M=0;M<S;M++)L[M]=this.i(M)|V.i(M);return new d(L,this.h|V.h)},n.xor=function(V){for(var S=Math.max(this.g.length,V.g.length),L=[],M=0;M<S;M++)L[M]=this.i(M)^V.i(M);return new d(L,this.h^V.h)};function F(V){for(var S=V.g.length+1,L=[],M=0;M<S;M++)L[M]=V.i(M)<<1|V.i(M-1)>>>31;return new d(L,V.h)}function $(V,S){var L=S>>5;S%=32;for(var M=V.g.length-L,w=[],C=0;C<M;C++)w[C]=0<S?V.i(C+L)>>>S|V.i(C+L+1)<<32-S:V.i(C+L);return new d(w,V.h)}a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,UT=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=g,d.fromString=y,xi=d}).apply(typeof nN<"u"?nN:typeof self<"u"?self:typeof window<"u"?window:{});var Wd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var FT,Ic,qT,ch,lg,BT,zT,HT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,b,E){return h==Array.prototype||h==Object.prototype||(h[b]=E.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wd=="object"&&Wd];for(var b=0;b<h.length;++b){var E=h[b];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var a=t(this);function o(h,b){if(b)e:{var E=a;h=h.split(".");for(var k=0;k<h.length-1;k++){var K=h[k];if(!(K in E))break e;E=E[K]}h=h[h.length-1],k=E[h],b=b(k),b!=k&&b!=null&&e(E,h,{configurable:!0,writable:!0,value:b})}}function c(h,b){h instanceof String&&(h+="");var E=0,k=!1,K={next:function(){if(!k&&E<h.length){var te=E++;return{value:b(te,h[te]),done:!1}}return k=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}o("Array.prototype.values",function(h){return h||function(){return c(this,function(b,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function p(h){var b=typeof h;return b=b!="object"?b:h?Array.isArray(h)?"array":b:"null",b=="array"||b=="object"&&typeof h.length=="number"}function g(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function y(h,b,E){return h.call.apply(h.bind,arguments)}function _(h,b,E){if(!h)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,k),h.apply(b,K)}}return function(){return h.apply(b,arguments)}}function N(h,b,E){return N=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:_,N.apply(null,arguments)}function j(h,b){var E=Array.prototype.slice.call(arguments,1);return function(){var k=E.slice();return k.push.apply(k,arguments),h.apply(this,k)}}function x(h,b){function E(){}E.prototype=b.prototype,h.aa=b.prototype,h.prototype=new E,h.prototype.constructor=h,h.Qb=function(k,K,te){for(var de=Array(arguments.length-2),Qe=2;Qe<arguments.length;Qe++)de[Qe-2]=arguments[Qe];return b.prototype[K].apply(k,de)}}function R(h){const b=h.length;if(0<b){const E=Array(b);for(let k=0;k<b;k++)E[k]=h[k];return E}return[]}function A(h,b){for(let E=1;E<arguments.length;E++){const k=arguments[E];if(p(k)){const K=h.length||0,te=k.length||0;h.length=K+te;for(let de=0;de<te;de++)h[K+de]=k[de]}else h.push(k)}}class O{constructor(b,E){this.i=b,this.j=E,this.h=0,this.g=null}get(){let b;return 0<this.h?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function q(h){return/^[\s\xa0]*$/.test(h)}function U(){var h=f.navigator;return h&&(h=h.userAgent)?h:""}function P(h){return P[" "](h),h}P[" "]=function(){};var F=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function $(h,b,E){for(const k in h)b.call(E,h[k],k,h)}function V(h,b){for(const E in h)b.call(void 0,h[E],E,h)}function S(h){const b={};for(const E in h)b[E]=h[E];return b}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(h,b){let E,k;for(let K=1;K<arguments.length;K++){k=arguments[K];for(E in k)h[E]=k[E];for(let te=0;te<L.length;te++)E=L[te],Object.prototype.hasOwnProperty.call(k,E)&&(h[E]=k[E])}}function w(h){var b=1;h=h.split(":");const E=[];for(;0<b&&h.length;)E.push(h.shift()),b--;return h.length&&E.push(h.join(":")),E}function C(h){f.setTimeout(()=>{throw h},0)}function D(){var h=Oe;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class me{constructor(){this.h=this.g=null}add(b,E){const k=De.get();k.set(b,E),this.h?this.h.next=k:this.g=k,this.h=k}}var De=new O(()=>new Q,h=>h.reset());class Q{constructor(){this.next=this.g=this.h=null}set(b,E){this.h=b,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let ne,he=!1,Oe=new me,z=()=>{const h=f.Promise.resolve(void 0);ne=()=>{h.then(ee)}};var ee=()=>{for(var h;h=D();){try{h.h.call(h.g)}catch(E){C(E)}var b=De;b.j(h),100>b.h&&(b.h++,h.next=b.g,b.g=h)}he=!1};function le(){this.s=this.s,this.C=this.C}le.prototype.s=!1,le.prototype.ma=function(){this.s||(this.s=!0,this.N())},le.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ce(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}ce.prototype.h=function(){this.defaultPrevented=!0};var xe=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};f.addEventListener("test",E,b),f.removeEventListener("test",E,b)}catch{}return h}();function Be(h,b){if(ce.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var E=this.type=h.type,k=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget){if(F){e:{try{P(b.nodeName);var K=!0;break e}catch{}K=!1}K||(b=null)}}else E=="mouseover"?b=h.fromElement:E=="mouseout"&&(b=h.toElement);this.relatedTarget=b,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Ie[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Be.aa.h.call(this)}}x(Be,ce);var Ie={2:"touch",3:"pen",4:"mouse"};Be.prototype.h=function(){Be.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Ht="closure_listenable_"+(1e6*Math.random()|0),mt=0;function js(h,b,E,k,K){this.listener=h,this.proxy=null,this.src=b,this.type=E,this.capture=!!k,this.ha=K,this.key=++mt,this.da=this.fa=!1}function La(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function ea(h){this.src=h,this.g={},this.h=0}ea.prototype.add=function(h,b,E,k,K){var te=h.toString();h=this.g[te],h||(h=this.g[te]=[],this.h++);var de=Bi(h,b,k,K);return-1<de?(b=h[de],E||(b.fa=!1)):(b=new js(b,this.src,te,!!k,K),b.fa=E,h.push(b)),b};function qi(h,b){var E=b.type;if(E in h.g){var k=h.g[E],K=Array.prototype.indexOf.call(k,b,void 0),te;(te=0<=K)&&Array.prototype.splice.call(k,K,1),te&&(La(b),h.g[E].length==0&&(delete h.g[E],h.h--))}}function Bi(h,b,E,k){for(var K=0;K<h.length;++K){var te=h[K];if(!te.da&&te.listener==b&&te.capture==!!E&&te.ha==k)return K}return-1}var zi="closure_lm_"+(1e6*Math.random()|0),yl={};function ju(h,b,E,k,K){if(Array.isArray(b)){for(var te=0;te<b.length;te++)ju(h,b[te],E,k,K);return null}return E=wu(E),h&&h[Ht]?h.K(b,E,g(k)?!!k.capture:!1,K):Yn(h,b,E,!1,k,K)}function Yn(h,b,E,k,K,te){if(!b)throw Error("Invalid event type");var de=g(K)?!!K.capture:!!K,Qe=Hr(h);if(Qe||(h[zi]=Qe=new ea(h)),E=Qe.add(b,E,k,de,te),E.proxy)return E;if(k=Af(),E.proxy=k,k.src=h,k.listener=E,h.addEventListener)xe||(K=de),K===void 0&&(K=!1),h.addEventListener(b.toString(),k,K);else if(h.attachEvent)h.attachEvent(Hi(b.toString()),k);else if(h.addListener&&h.removeListener)h.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Af(){function h(E){return b.call(h.src,h.listener,E)}const b=jf;return h}function bl(h,b,E,k,K){if(Array.isArray(b))for(var te=0;te<b.length;te++)bl(h,b[te],E,k,K);else k=g(k)?!!k.capture:!!k,E=wu(E),h&&h[Ht]?(h=h.i,b=String(b).toString(),b in h.g&&(te=h.g[b],E=Bi(te,E,k,K),-1<E&&(La(te[E]),Array.prototype.splice.call(te,E,1),te.length==0&&(delete h.g[b],h.h--)))):h&&(h=Hr(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Bi(b,E,k,K)),(E=-1<h?b[h]:null)&&zr(E))}function zr(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[Ht])qi(b.i,h);else{var E=h.type,k=h.proxy;b.removeEventListener?b.removeEventListener(E,k,h.capture):b.detachEvent?b.detachEvent(Hi(E),k):b.addListener&&b.removeListener&&b.removeListener(k),(E=Hr(b))?(qi(E,h),E.h==0&&(E.src=null,b[zi]=null)):La(h)}}}function Hi(h){return h in yl?yl[h]:yl[h]="on"+h}function jf(h,b){if(h.da)h=!0;else{b=new Be(b,this);var E=h.listener,k=h.ha||h.src;h.fa&&zr(h),h=E.call(k,b)}return h}function Hr(h){return h=h[zi],h instanceof ea?h:null}var _l="__closure_events_fn_"+(1e9*Math.random()>>>0);function wu(h){return typeof h=="function"?h:(h[_l]||(h[_l]=function(b){return h.handleEvent(b)}),h[_l])}function Et(){le.call(this),this.i=new ea(this),this.M=this,this.F=null}x(Et,le),Et.prototype[Ht]=!0,Et.prototype.removeEventListener=function(h,b,E,k){bl(this,h,b,E,k)};function st(h,b){var E,k=h.F;if(k)for(E=[];k;k=k.F)E.push(k);if(h=h.M,k=b.type||b,typeof b=="string")b=new ce(b,h);else if(b instanceof ce)b.target=b.target||h;else{var K=b;b=new ce(k,h),M(b,K)}if(K=!0,E)for(var te=E.length-1;0<=te;te--){var de=b.g=E[te];K=Mn(de,k,!0,b)&&K}if(de=b.g=h,K=Mn(de,k,!0,b)&&K,K=Mn(de,k,!1,b)&&K,E)for(te=0;te<E.length;te++)de=b.g=E[te],K=Mn(de,k,!1,b)&&K}Et.prototype.N=function(){if(Et.aa.N.call(this),this.i){var h=this.i,b;for(b in h.g){for(var E=h.g[b],k=0;k<E.length;k++)La(E[k]);delete h.g[b],h.h--}}this.F=null},Et.prototype.K=function(h,b,E,k){return this.i.add(String(h),b,!1,E,k)},Et.prototype.L=function(h,b,E,k){return this.i.add(String(h),b,!0,E,k)};function Mn(h,b,E,k){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();for(var K=!0,te=0;te<b.length;++te){var de=b[te];if(de&&!de.da&&de.capture==E){var Qe=de.listener,Lt=de.ha||de.src;de.fa&&qi(h.i,de),K=Qe.call(Lt,k)!==!1&&K}}return K&&!k.defaultPrevented}function cn(h,b,E){if(typeof h=="function")E&&(h=N(h,E));else if(h&&typeof h.handleEvent=="function")h=N(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:f.setTimeout(h,b||0)}function Cu(h){h.g=cn(()=>{h.g=null,h.i&&(h.i=!1,Cu(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class wf extends le{constructor(b,E){super(),this.m=b,this.l=E,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Cu(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gi(h){le.call(this),this.h=h,this.g={}}x(Gi,le);var $i=[];function Yi(h){$(h.g,function(b,E){this.g.hasOwnProperty(E)&&zr(b)},h),h.g={}}Gi.prototype.N=function(){Gi.aa.N.call(this),Yi(this)},Gi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hs=f.JSON.stringify,Gr=f.JSON.parse,Qi=class{stringify(h){return f.JSON.stringify(h,void 0)}parse(h){return f.JSON.parse(h,void 0)}};function xl(){}xl.prototype.h=null;function Nl(h){return h.h||(h.h=h.i())}function El(){}var ta={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function na(){ce.call(this,"d")}x(na,ce);function Tl(){ce.call(this,"c")}x(Tl,ce);var ws={},Al=null;function Va(){return Al=Al||new Et}ws.La="serverreachability";function $r(h){ce.call(this,ws.La,h)}x($r,ce);function Ua(h){const b=Va();st(b,new $r(b))}ws.STAT_EVENT="statevent";function Su(h,b){ce.call(this,ws.STAT_EVENT,h),this.stat=b}x(Su,ce);function bt(h){const b=Va();st(b,new Su(b,h))}ws.Ma="timingevent";function Pt(h,b){ce.call(this,ws.Ma,h),this.size=b}x(Pt,ce);function It(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){h()},b)}function Qn(){this.g=!0}Qn.prototype.xa=function(){this.g=!1};function jl(h,b,E,k,K,te){h.info(function(){if(h.g)if(te)for(var de="",Qe=te.split("&"),Lt=0;Lt<Qe.length;Lt++){var Ke=Qe[Lt].split("=");if(1<Ke.length){var $t=Ke[0];Ke=Ke[1];var Vt=$t.split("_");de=2<=Vt.length&&Vt[1]=="type"?de+($t+"="+Ke+"&"):de+($t+"=redacted&")}}else de=null;else de=te;return"XMLHTTP REQ ("+k+") [attempt "+K+"]: "+b+`
`+E+`
`+de})}function Cf(h,b,E,k,K,te,de){h.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+K+"]: "+b+`
`+E+`
`+te+" "+de})}function Fa(h,b,E,k){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+Ki(h,E)+(k?" "+k:"")})}function Iu(h,b){h.info(function(){return"TIMEOUT: "+b})}Qn.prototype.info=function(){};function Ki(h,b){if(!h.g)return b;if(!b)return null;try{var E=JSON.parse(b);if(E){for(h=0;h<E.length;h++)if(Array.isArray(E[h])){var k=E[h];if(!(2>k.length)){var K=k[1];if(Array.isArray(K)&&!(1>K.length)){var te=K[0];if(te!="noop"&&te!="stop"&&te!="close")for(var de=1;de<K.length;de++)K[de]=""}}}}return hs(E)}catch{return b}}var qa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},sa={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Cs;function Ss(){}x(Ss,xl),Ss.prototype.g=function(){return new XMLHttpRequest},Ss.prototype.i=function(){return{}},Cs=new Ss;function vn(h,b,E,k){this.j=h,this.i=b,this.l=E,this.R=k||1,this.U=new Gi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new jt}function jt(){this.i=null,this.g="",this.h=!1}var wl={},Yr={};function fs(h,b,E){h.L=1,h.v=er(On(b)),h.m=E,h.P=!0,aa(h,null)}function aa(h,b){h.F=Date.now(),Xi(h),h.A=On(h.v);var E=h.A,k=h.R;Array.isArray(k)||(k=[String(k)]),Ml(E.i,"t",k),h.C=0,E=h.j.J,h.h=new jt,h.g=$u(h.j,E?b:null,!h.m),0<h.O&&(h.M=new wf(N(h.Y,h,h.g),h.O)),b=h.U,E=h.g,k=h.ca;var K="readystatechange";Array.isArray(K)||(K&&($i[0]=K.toString()),K=$i);for(var te=0;te<K.length;te++){var de=ju(E,K[te],k||b.handleEvent,!1,b.h||b);if(!de)break;b.g[de.key]=de}b=h.H?S(h.H):{},h.m?(h.u||(h.u="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,b)):(h.u="GET",h.g.ea(h.A,h.u,null,b)),Ua(),jl(h.i,h.u,h.A,h.l,h.R,h.m)}vn.prototype.ca=function(h){h=h.target;const b=this.M;b&&Zn(h)==3?b.j():this.Y(h)},vn.prototype.Y=function(h){try{if(h==this.g)e:{const Vt=Zn(this.g);var b=this.g.Ba();const ha=this.g.Z();if(!(3>Vt)&&(Vt!=3||this.g&&(this.h.h||this.g.oa()||Vu(this.g)))){this.J||Vt!=4||b==7||(b==8||0>=ha?Ua(3):Ua(2)),Ba(this);var E=this.g.Z();this.X=E;t:if(Ru(this)){var k=Vu(this.g);h="";var K=k.length,te=Zn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zt(this),Is(this);var de="";break t}this.h.i=new f.TextDecoder}for(b=0;b<K;b++)this.h.h=!0,h+=this.h.i.decode(k[b],{stream:!(te&&b==K-1)});k.length=0,this.h.g+=h,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=E==200,Cf(this.i,this.u,this.A,this.l,this.R,Vt,E),this.o){if(this.T&&!this.K){t:{if(this.g){var Qe,Lt=this.g;if((Qe=Lt.g?Lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(Qe)){var Ke=Qe;break t}}Ke=null}if(E=Ke)Fa(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wi(this,E);else{this.o=!1,this.s=3,bt(12),Zt(this),Is(this);break e}}if(this.P){E=!0;let Jt;for(;!this.J&&this.C<de.length;)if(Jt=Du(this,de),Jt==Yr){Vt==4&&(this.s=4,bt(14),E=!1),Fa(this.i,this.l,null,"[Incomplete Response]");break}else if(Jt==wl){this.s=4,bt(15),Fa(this.i,this.l,de,"[Invalid Chunk]"),E=!1;break}else Fa(this.i,this.l,Jt,null),Wi(this,Jt);if(Ru(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vt!=4||de.length!=0||this.h.h||(this.s=1,bt(16),E=!1),this.o=this.o&&E,!E)Fa(this.i,this.l,de,"[Invalid Chunked Response]"),Zt(this),Is(this);else if(0<de.length&&!this.W){this.W=!0;var $t=this.j;$t.g==this&&$t.ba&&!$t.M&&($t.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),lr($t),$t.M=!0,bt(11))}}else Fa(this.i,this.l,de,null),Wi(this,de);Vt==4&&Zt(this),this.o&&!this.J&&(Vt==4?zu(this.j,this):(this.o=!1,Xi(this)))}else Mf(this.g),E==400&&0<de.indexOf("Unknown SID")?(this.s=3,bt(12)):(this.s=0,bt(13)),Zt(this),Is(this)}}}catch{}finally{}};function Ru(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Du(h,b){var E=h.C,k=b.indexOf(`
`,E);return k==-1?Yr:(E=Number(b.substring(E,k)),isNaN(E)?wl:(k+=1,k+E>b.length?Yr:(b=b.slice(k,k+E),h.C=k+E,b)))}vn.prototype.cancel=function(){this.J=!0,Zt(this)};function Xi(h){h.S=Date.now()+h.I,Mu(h,h.I)}function Mu(h,b){if(h.B!=null)throw Error("WatchDog timer not null");h.B=It(N(h.ba,h),b)}function Ba(h){h.B&&(f.clearTimeout(h.B),h.B=null)}vn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Iu(this.i,this.A),this.L!=2&&(Ua(),bt(17)),Zt(this),this.s=2,Is(this)):Mu(this,this.S-h)};function Is(h){h.j.G==0||h.J||zu(h.j,h)}function Zt(h){Ba(h);var b=h.M;b&&typeof b.ma=="function"&&b.ma(),h.M=null,Yi(h.U),h.g&&(b=h.g,h.g=null,b.abort(),b.ma())}function Wi(h,b){try{var E=h.j;if(E.G!=0&&(E.g==h||Cl(E.h,h))){if(!h.K&&Cl(E.h,h)&&E.G==3){try{var k=E.Da.g.parse(b)}catch{k=null}if(Array.isArray(k)&&k.length==3){var K=k;if(K[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<h.F)io(E),so(E);else break e;Vl(E),bt(18)}}else E.za=K[1],0<E.za-E.T&&37500>K[2]&&E.F&&E.v==0&&!E.C&&(E.C=It(N(E.Za,E),6e3));if(1>=Kr(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else da(E,11)}else if((h.K||E.g==h)&&io(E),!q(b))for(K=E.Da.g.parse(b),b=0;b<K.length;b++){let Ke=K[b];if(E.T=Ke[0],Ke=Ke[1],E.G==2)if(Ke[0]=="c"){E.K=Ke[1],E.ia=Ke[2];const $t=Ke[3];$t!=null&&(E.la=$t,E.j.info("VER="+E.la));const Vt=Ke[4];Vt!=null&&(E.Aa=Vt,E.j.info("SVER="+E.Aa));const ha=Ke[5];ha!=null&&typeof ha=="number"&&0<ha&&(k=1.5*ha,E.L=k,E.j.info("backChannelRequestTimeoutMs_="+k)),k=E;const Jt=h.g;if(Jt){const Ls=Jt.g?Jt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ls){var te=k.h;te.g||Ls.indexOf("spdy")==-1&&Ls.indexOf("quic")==-1&&Ls.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Xr(te,te.h),te.h=null))}if(k.D){const Fl=Jt.g?Jt.g.getResponseHeader("X-HTTP-Session-Id"):null;Fl&&(k.ya=Fl,rt(k.I,k.D,Fl))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-h.F,E.j.info("Handshake RTT: "+E.R+"ms")),k=E;var de=h;if(k.qa=Gu(k,k.J?k.ia:null,k.W),de.K){yn(k.h,de);var Qe=de,Lt=k.L;Lt&&(Qe.I=Lt),Qe.B&&(Ba(Qe),Xi(Qe)),k.g=de}else qu(k);0<E.i.length&&ao(E)}else Ke[0]!="stop"&&Ke[0]!="close"||da(E,7);else E.G==3&&(Ke[0]=="stop"||Ke[0]=="close"?Ke[0]=="stop"?da(E,7):Pl(E):Ke[0]!="noop"&&E.l&&E.l.ta(Ke),E.v=0)}}Ua(4)}catch{}}var Ou=class{constructor(h,b){this.g=h,this.map=b}};function ia(h){this.l=h||10,f.PerformanceNavigationTiming?(h=f.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Kr(h){return h.h?1:h.g?h.g.size:0}function Cl(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Xr(h,b){h.g?h.g.add(b):h.h=b}function yn(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}ia.prototype.cancel=function(){if(this.i=Sl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Sl(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const E of h.g.values())b=b.concat(E.D);return b}return R(h.i)}function Sf(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var b=[],E=h.length,k=0;k<E;k++)b.push(h[k]);return b}b=[],E=0;for(k in h)b[E++]=h[k];return b}function Wr(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var b=[];h=h.length;for(var E=0;E<h;E++)b.push(E);return b}b=[],E=0;for(const k in h)b[E++]=k;return b}}}function Il(h,b){if(h.forEach&&typeof h.forEach=="function")h.forEach(b,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,b,void 0);else for(var E=Wr(h),k=Sf(h),K=k.length,te=0;te<K;te++)b.call(void 0,k[te],E&&E[te],h)}var Zi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function If(h,b){if(h){h=h.split("&");for(var E=0;E<h.length;E++){var k=h[E].indexOf("="),K=null;if(0<=k){var te=h[E].substring(0,k);K=h[E].substring(k+1)}else te=h[E];b(te,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Rt(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Rt){this.h=h.h,Ji(this,h.j),this.o=h.o,this.g=h.g,za(this,h.s),this.l=h.l;var b=h.i,E=new oa;E.i=b.i,b.g&&(E.g=new Map(b.g),E.h=b.h),ra(this,E),this.m=h.m}else h&&(b=String(h).match(Zi))?(this.h=!1,Ji(this,b[1]||"",!0),this.o=Kn(b[2]||""),this.g=Kn(b[3]||"",!0),za(this,b[4]),this.l=Kn(b[5]||"",!0),ra(this,b[6]||"",!0),this.m=Kn(b[7]||"")):(this.h=!1,this.i=new oa(null,this.h))}Rt.prototype.toString=function(){var h=[],b=this.j;b&&h.push(tr(b,Rl,!0),":");var E=this.g;return(E||b=="file")&&(h.push("//"),(b=this.o)&&h.push(tr(b,Rl,!0),"@"),h.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&h.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(tr(E,E.charAt(0)=="/"?Rf:Dl,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",tr(E,Zr)),h.join("")};function On(h){return new Rt(h)}function Ji(h,b,E){h.j=E?Kn(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function za(h,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);h.s=b}else h.s=null}function ra(h,b,E){b instanceof oa?(h.i=b,Pu(h.i,h.h)):(E||(b=tr(b,Df)),h.i=new oa(b,h.h))}function rt(h,b,E){h.i.set(b,E)}function er(h){return rt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Kn(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function tr(h,b,E){return typeof h=="string"?(h=encodeURI(h).replace(b,ku),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function ku(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Rl=/[#\/\?@]/g,Dl=/[#\?:]/g,Rf=/[#\?]/g,Df=/[#\?@]/g,Zr=/#/g;function oa(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Xn(h){h.g||(h.g=new Map,h.h=0,h.i&&If(h.i,function(b,E){h.add(decodeURIComponent(b.replace(/\+/g," ")),E)}))}n=oa.prototype,n.add=function(h,b){Xn(this),this.i=null,h=Rs(this,h);var E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(b),this.h+=1,this};function la(h,b){Xn(h),b=Rs(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function ca(h,b){return Xn(h),b=Rs(h,b),h.g.has(b)}n.forEach=function(h,b){Xn(this),this.g.forEach(function(E,k){E.forEach(function(K){h.call(b,K,k,this)},this)},this)},n.na=function(){Xn(this);const h=Array.from(this.g.values()),b=Array.from(this.g.keys()),E=[];for(let k=0;k<b.length;k++){const K=h[k];for(let te=0;te<K.length;te++)E.push(b[k])}return E},n.V=function(h){Xn(this);let b=[];if(typeof h=="string")ca(this,h)&&(b=b.concat(this.g.get(Rs(this,h))));else{h=Array.from(this.g.values());for(let E=0;E<h.length;E++)b=b.concat(h[E])}return b},n.set=function(h,b){return Xn(this),this.i=null,h=Rs(this,h),ca(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=this.V(h),0<h.length?String(h[0]):b):b};function Ml(h,b,E){la(h,b),0<E.length&&(h.i=null,h.g.set(Rs(h,b),R(E)),h.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(var E=0;E<b.length;E++){var k=b[E];const te=encodeURIComponent(String(k)),de=this.V(k);for(k=0;k<de.length;k++){var K=te;de[k]!==""&&(K+="="+encodeURIComponent(String(de[k]))),h.push(K)}}return this.i=h.join("&")};function Rs(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function Pu(h,b){b&&!h.j&&(Xn(h),h.i=null,h.g.forEach(function(E,k){var K=k.toLowerCase();k!=K&&(la(this,k),Ml(this,K,E))},h)),h.j=b}function nr(h,b){const E=new Qn;if(f.Image){const k=new Image;k.onload=j(Wn,E,"TestLoadImage: loaded",!0,b,k),k.onerror=j(Wn,E,"TestLoadImage: error",!1,b,k),k.onabort=j(Wn,E,"TestLoadImage: abort",!1,b,k),k.ontimeout=j(Wn,E,"TestLoadImage: timeout",!1,b,k),f.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=h}else b(!1)}function ms(h,b){const E=new Qn,k=new AbortController,K=setTimeout(()=>{k.abort(),Wn(E,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:k.signal}).then(te=>{clearTimeout(K),te.ok?Wn(E,"TestPingServer: ok",!0,b):Wn(E,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(K),Wn(E,"TestPingServer: error",!1,b)})}function Wn(h,b,E,k,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),k(E)}catch{}}function sr(){this.g=new Qi}function Ds(h,b,E){const k=E||"";try{Il(h,function(K,te){let de=K;g(K)&&(de=hs(K)),b.push(k+te+"="+encodeURIComponent(de))})}catch(K){throw b.push(k+"type="+encodeURIComponent("_badmap")),K}}function Ha(h){this.l=h.Ub||null,this.j=h.eb||!1}x(Ha,xl),Ha.prototype.g=function(){return new ua(this.l,this.j)},Ha.prototype.i=function(h){return function(){return h}}({});function ua(h,b){Et.call(this),this.D=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(ua,Et),n=ua.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=b,this.readyState=1,Os(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const b={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(b.body=h),(this.D||f).fetch(new Request(this.A,b)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ms(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Os(this)),this.g&&(this.readyState=3,Os(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ol(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ol(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.v.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Ms(this):Os(this),this.readyState==3&&Ol(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Ms(this))},n.Qa=function(h){this.g&&(this.response=h,Ms(this))},n.ga=function(){this.g&&Ms(this)};function Ms(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Os(h)}n.setRequestHeader=function(h,b){this.u.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var E=b.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=b.next();return h.join(`\r
`)};function Os(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(ua.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function kl(h){let b="";return $(h,function(E,k){b+=k,b+=":",b+=E,b+=`\r
`}),b}function Gt(h,b,E){e:{for(k in E){var k=!1;break e}k=!0}k||(E=kl(E),typeof h=="string"?E!=null&&encodeURIComponent(String(E)):rt(h,b,E))}function nt(h){Et.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(nt,Et);var Jr=/^https?$/i,ar=["POST","PUT"];n=nt.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,b,E,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Cs.g(),this.v=this.o?Nl(this.o):Nl(Cs),this.g.onreadystatechange=N(this.Ea,this);try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(te){Lu(this,te);return}if(h=E||"",E=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var K in k)E.set(K,k[K]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const te of k.keys())E.set(te,k.get(te));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(E.keys()).find(te=>te.toLowerCase()=="content-type"),K=f.FormData&&h instanceof f.FormData,!(0<=Array.prototype.indexOf.call(ar,b,void 0))||k||K||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,de]of E)this.g.setRequestHeader(te,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ir(this),this.u=!0,this.g.send(h),this.u=!1}catch(te){Lu(this,te)}};function Lu(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.m=5,eo(h),ks(h)}function eo(h){h.A||(h.A=!0,st(h,"complete"),st(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,st(this,"complete"),st(this,"abort"),ks(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ks(this,!0)),nt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?to(this):this.bb())},n.bb=function(){to(this)};function to(h){if(h.h&&typeof d<"u"&&(!h.v[1]||Zn(h)!=4||h.Z()!=2)){if(h.u&&Zn(h)==4)cn(h.Ea,0,h);else if(st(h,"readystatechange"),Zn(h)==4){h.h=!1;try{const de=h.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var E;if(!(E=b)){var k;if(k=de===0){var K=String(h.D).match(Zi)[1]||null;!K&&f.self&&f.self.location&&(K=f.self.location.protocol.slice(0,-1)),k=!Jr.test(K?K.toLowerCase():"")}E=k}if(E)st(h,"complete"),st(h,"success");else{h.m=6;try{var te=2<Zn(h)?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.Z()+"]",eo(h)}}finally{ks(h)}}}}function ks(h,b){if(h.g){ir(h);const E=h.g,k=h.v[0]?()=>{}:null;h.g=null,h.v=null,b||st(h,"ready");try{E.onreadystatechange=k}catch{}}}function ir(h){h.I&&(f.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function Zn(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<Zn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),Gr(b)}};function Vu(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Mf(h){const b={};h=(h.g&&2<=Zn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<h.length;k++){if(q(h[k]))continue;var E=w(h[k]);const K=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const te=b[K]||[];b[K]=te,te.push(E)}V(b,function(k){return k.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function rr(h,b,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||b}function no(h){this.Aa=0,this.i=[],this.j=new Qn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rr("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rr("baseRetryDelayMs",5e3,h),this.cb=rr("retryDelaySeedMs",1e4,h),this.Wa=rr("forwardChannelMaxRetries",2,h),this.wa=rr("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ia(h&&h.concurrentRequestLimit),this.Da=new sr,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=no.prototype,n.la=8,n.G=1,n.connect=function(h,b,E,k){bt(0),this.W=h,this.H=b||{},E&&k!==void 0&&(this.H.OSID=E,this.H.OAID=k),this.F=this.X,this.I=Gu(this,null,this.W),ao(this)};function Pl(h){if(Uu(h),h.G==3){var b=h.U++,E=On(h.I);if(rt(E,"SID",h.K),rt(E,"RID",b),rt(E,"TYPE","terminate"),or(h,E),b=new vn(h,h.j,b),b.L=2,b.v=er(On(E)),E=!1,f.navigator&&f.navigator.sendBeacon)try{E=f.navigator.sendBeacon(b.v.toString(),"")}catch{}!E&&f.Image&&(new Image().src=b.v,E=!0),E||(b.g=$u(b.j,null),b.g.ea(b.v)),b.F=Date.now(),Xi(b)}Hu(h)}function so(h){h.g&&(lr(h),h.g.cancel(),h.g=null)}function Uu(h){so(h),h.u&&(f.clearTimeout(h.u),h.u=null),io(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&f.clearTimeout(h.s),h.s=null)}function ao(h){if(!Qr(h.h)&&!h.s){h.s=!0;var b=h.Ga;ne||z(),he||(ne(),he=!0),Oe.add(b,h),h.B=0}}function Of(h,b){return Kr(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=b.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=It(N(h.Ga,h,b),Ul(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const K=new vn(this,this.j,h);let te=this.o;if(this.S&&(te?(te=S(te),M(te,this.S)):te=this.S),this.m!==null||this.O||(K.H=te,te=null),this.P)e:{for(var b=0,E=0;E<this.i.length;E++){t:{var k=this.i[E];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(b+=k,4096<b){b=E;break e}if(b===4096||E===this.i.length-1){b=E+1;break e}}b=1e3}else b=1e3;b=Fu(this,K,b),E=On(this.I),rt(E,"RID",h),rt(E,"CVER",22),this.D&&rt(E,"X-HTTP-Session-Id",this.D),or(this,E),te&&(this.O?b="headers="+encodeURIComponent(String(kl(te)))+"&"+b:this.m&&Gt(E,this.m,te)),Xr(this.h,K),this.Ua&&rt(E,"TYPE","init"),this.P?(rt(E,"$req",b),rt(E,"SID","null"),K.T=!0,fs(K,E,null)):fs(K,E,b),this.G=2}}else this.G==3&&(h?Ll(this,h):this.i.length==0||Qr(this.h)||Ll(this))};function Ll(h,b){var E;b?E=b.l:E=h.U++;const k=On(h.I);rt(k,"SID",h.K),rt(k,"RID",E),rt(k,"AID",h.T),or(h,k),h.m&&h.o&&Gt(k,h.m,h.o),E=new vn(h,h.j,E,h.B+1),h.m===null&&(E.H=h.o),b&&(h.i=b.D.concat(h.i)),b=Fu(h,E,1e3),E.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Xr(h.h,E),fs(E,k,b)}function or(h,b){h.H&&$(h.H,function(E,k){rt(b,k,E)}),h.l&&Il({},function(E,k){rt(b,k,E)})}function Fu(h,b,E){E=Math.min(h.i.length,E);var k=h.l?N(h.l.Na,h.l,h):null;e:{var K=h.i;let te=-1;for(;;){const de=["count="+E];te==-1?0<E?(te=K[0].g,de.push("ofs="+te)):te=0:de.push("ofs="+te);let Qe=!0;for(let Lt=0;Lt<E;Lt++){let Ke=K[Lt].g;const $t=K[Lt].map;if(Ke-=te,0>Ke)te=Math.max(0,K[Lt].g-100),Qe=!1;else try{Ds($t,de,"req"+Ke+"_")}catch{k&&k($t)}}if(Qe){k=de.join("&");break e}}}return h=h.i.splice(0,E),b.D=h,k}function qu(h){if(!h.g&&!h.u){h.Y=1;var b=h.Fa;ne||z(),he||(ne(),he=!0),Oe.add(b,h),h.v=0}}function Vl(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=It(N(h.Fa,h),Ul(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,Bu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=It(N(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bt(10),so(this),Bu(this))};function lr(h){h.A!=null&&(f.clearTimeout(h.A),h.A=null)}function Bu(h){h.g=new vn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var b=On(h.qa);rt(b,"RID","rpc"),rt(b,"SID",h.K),rt(b,"AID",h.T),rt(b,"CI",h.F?"0":"1"),!h.F&&h.ja&&rt(b,"TO",h.ja),rt(b,"TYPE","xmlhttp"),or(h,b),h.m&&h.o&&Gt(b,h.m,h.o),h.L&&(h.g.I=h.L);var E=h.g;h=h.ia,E.L=1,E.v=er(On(b)),E.m=null,E.P=!0,aa(E,h)}n.Za=function(){this.C!=null&&(this.C=null,so(this),Vl(this),bt(19))};function io(h){h.C!=null&&(f.clearTimeout(h.C),h.C=null)}function zu(h,b){var E=null;if(h.g==b){io(h),lr(h),h.g=null;var k=2}else if(Cl(h.h,b))E=b.D,yn(h.h,b),k=1;else return;if(h.G!=0){if(b.o)if(k==1){E=b.m?b.m.length:0,b=Date.now()-b.F;var K=h.B;k=Va(),st(k,new Pt(k,E)),ao(h)}else qu(h);else if(K=b.s,K==3||K==0&&0<b.X||!(k==1&&Of(h,b)||k==2&&Vl(h)))switch(E&&0<E.length&&(b=h.h,b.i=b.i.concat(E)),K){case 1:da(h,5);break;case 4:da(h,10);break;case 3:da(h,6);break;default:da(h,2)}}}function Ul(h,b){let E=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(E*=2),E*b}function da(h,b){if(h.j.info("Error code "+b),b==2){var E=N(h.fb,h),k=h.Xa;const K=!k;k=new Rt(k||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||Ji(k,"https"),er(k),K?nr(k.toString(),E):ms(k.toString(),E)}else bt(2);h.G=0,h.l&&h.l.sa(b),Hu(h),Uu(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function Hu(h){if(h.G=0,h.ka=[],h.l){const b=Sl(h.h);(b.length!=0||h.i.length!=0)&&(A(h.ka,b),A(h.ka,h.i),h.h.i.length=0,R(h.i),h.i.length=0),h.l.ra()}}function Gu(h,b,E){var k=E instanceof Rt?On(E):new Rt(E);if(k.g!="")b&&(k.g=b+"."+k.g),za(k,k.s);else{var K=f.location;k=K.protocol,b=b?b+"."+K.hostname:K.hostname,K=+K.port;var te=new Rt(null);k&&Ji(te,k),b&&(te.g=b),K&&za(te,K),E&&(te.l=E),k=te}return E=h.D,b=h.ya,E&&b&&rt(k,E,b),rt(k,"VER",h.la),or(h,k),k}function $u(h,b,E){if(b&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Ca&&!h.pa?new nt(new Ha({eb:E})):new nt(h.pa),b.Ha(h.J),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yu(){}n=Yu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ro(){}ro.prototype.g=function(h,b){return new bn(h,b)};function bn(h,b){Et.call(this),this.g=new no(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.va&&(h?h["X-WebChannel-Client-Profile"]=b.va:h={"X-WebChannel-Client-Profile":b.va}),this.g.S=h,(h=b&&b.Sb)&&!q(h)&&(this.g.m=h),this.v=b&&b.supportsCrossDomainXhr||!1,this.u=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!q(b)&&(this.g.D=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new Ps(this)}x(bn,Et),bn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},bn.prototype.close=function(){Pl(this.g)},bn.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.u&&(E={},E.__data__=hs(h),h=E);b.i.push(new Ou(b.Ya++,h)),b.G==3&&ao(b)},bn.prototype.N=function(){this.g.l=null,delete this.j,Pl(this.g),delete this.g,bn.aa.N.call(this)};function Qu(h){na.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const E in b){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}x(Qu,na);function Ku(){Tl.call(this),this.status=1}x(Ku,Tl);function Ps(h){this.g=h}x(Ps,Yu),Ps.prototype.ua=function(){st(this.g,"a")},Ps.prototype.ta=function(h){st(this.g,new Qu(h))},Ps.prototype.sa=function(h){st(this.g,new Ku)},Ps.prototype.ra=function(){st(this.g,"b")},ro.prototype.createWebChannel=ro.prototype.g,bn.prototype.send=bn.prototype.o,bn.prototype.open=bn.prototype.m,bn.prototype.close=bn.prototype.close,HT=function(){return new ro},zT=function(){return Va()},BT=ws,lg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qa.NO_ERROR=0,qa.TIMEOUT=8,qa.HTTP_ERROR=6,ch=qa,sa.COMPLETE="complete",qT=sa,El.EventType=ta,ta.OPEN="a",ta.CLOSE="b",ta.ERROR="c",ta.MESSAGE="d",Et.prototype.listen=Et.prototype.K,Ic=El,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,FT=nt}).apply(typeof Wd<"u"?Wd:typeof self<"u"?self:typeof window<"u"?window:{});const sN="@firebase/firestore",aN="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ul="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr=new lu("@firebase/firestore");function Vo(){return Dr.logLevel}function ve(n,...e){if(Dr.logLevel<=$e.DEBUG){const t=e.map(Yg);Dr.debug(`Firestore (${ul}): ${n}`,...t)}}function Ma(n,...e){if(Dr.logLevel<=$e.ERROR){const t=e.map(Yg);Dr.error(`Firestore (${ul}): ${n}`,...t)}}function Zo(n,...e){if(Dr.logLevel<=$e.WARN){const t=e.map(Yg);Dr.warn(`Firestore (${ul}): ${n}`,...t)}}function Yg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(n,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,GT(n,a,t)}function GT(n,e,t){let a=`FIRESTORE (${ul}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw Ma(a),new Error(a)}function Ze(n,e,t,a){let o="Unexpected state";typeof t=="string"?o=t:a=t,n||GT(e,o,a)}function Re(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ge extends us{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class M1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(fn.UNAUTHENTICATED))}shutdown(){}}class O1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class k1{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0,42304);let a=this.i;const o=p=>this.i!==a?(a=this.i,t(p)):Promise.resolve();let c=new Qs;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Qs,e.enqueueRetryable(()=>o(this.currentUser))};const d=()=>{const p=c;e.enqueueRetryable(async()=>{await p.promise,await o(this.currentUser)})},f=p=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit(p=>f(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Qs)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(a=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Ze(typeof a.accessToken=="string",31837,{l:a}),new $T(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new fn(e)}}class P1{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class L1{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new P1(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(fn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class iN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class V1{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,In(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ze(this.o===void 0,3512);const a=c=>{c.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,ve("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>a(c))};const o=c=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>o(c)),setTimeout(()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new iN(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new iN(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U1(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<n;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YT(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const o=U1(40);for(let c=0;c<o.length;++c)a.length<20&&o[c]<t&&(a+=e.charAt(o[c]%62))}return a}}function qe(n,e){return n<e?-1:n>e?1:0}function cg(n,e){let t=0;for(;t<n.length&&t<e.length;){const a=n.codePointAt(t),o=e.codePointAt(t);if(a!==o){if(a<128&&o<128)return qe(a,o);{const c=YT(),d=F1(c.encode(rN(n,t)),c.encode(rN(e,t)));return d!==0?d:qe(a,o)}}t+=a>65535?2:1}return qe(n.length,e.length)}function rN(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function F1(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return qe(n[t],e[t]);return qe(n.length,e.length)}function Jo(n,e,t){return n.length===e.length&&n.every((a,o)=>t(a,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oN=-62135596800,lN=1e6;class qt{static now(){return qt.fromMillis(Date.now())}static fromDate(e){return qt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*lN);return new qt(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ge(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ge(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<oN)throw new ge(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ge(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/lN}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-oN;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{static fromTimestamp(e){return new je(e)}static min(){return new je(new qt(0,0))}static max(){return new je(new qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cN="__name__";class Hs{constructor(e,t,a){t===void 0?t=0:t>e.length&&Ne(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&Ne(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return Hs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Hs?e.forEach(a=>{t.push(a)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let o=0;o<a;o++){const c=Hs.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return qe(e.length,t.length)}static compareSegments(e,t){const a=Hs.isNumericId(e),o=Hs.isNumericId(t);return a&&!o?-1:!a&&o?1:a&&o?Hs.extractNumericId(e).compare(Hs.extractNumericId(t)):cg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return xi.fromString(e.substring(4,e.length-2))}}class ht extends Hs{construct(e,t,a){return new ht(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new ge(ie.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter(o=>o.length>0))}return new ht(t)}static emptyPath(){return new ht([])}}const q1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class an extends Hs{construct(e,t,a){return new an(e,t,a)}static isValidIdentifier(e){return q1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),an.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cN}static keyField(){return new an([cN])}static fromServerFormat(e){const t=[];let a="",o=0;const c=()=>{if(a.length===0)throw new ge(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let d=!1;for(;o<e.length;){const f=e[o];if(f==="\\"){if(o+1===e.length)throw new ge(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new ge(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=p,o+=2}else f==="`"?(d=!d,o++):f!=="."||d?(a+=f,o++):(c(),o++)}if(c(),d)throw new ge(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new an(t)}static emptyPath(){return new an([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.path=e}static fromPath(e){return new _e(ht.fromString(e))}static fromName(e){return new _e(ht.fromString(e).popFirst(5))}static empty(){return new _e(ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ht.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _e(new ht(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=-1;function B1(n,e){const t=n.toTimestamp().seconds,a=n.toTimestamp().nanoseconds+1,o=je.fromTimestamp(a===1e9?new qt(t+1,0):new qt(t,a));return new Ai(o,_e.empty(),e)}function z1(n){return new Ai(n.readTime,n.key,Kc)}class Ai{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new Ai(je.min(),_e.empty(),Kc)}static max(){return new Ai(je.max(),_e.empty(),Kc)}}function H1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=_e.comparator(n.documentKey,e.documentKey),t!==0?t:qe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dl(n){if(n.code!==ie.FAILED_PRECONDITION||n.message!==G1)throw n;ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe((a,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(a,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(a,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):oe.reject(t)}static resolve(e){return new oe((t,a)=>{t(e)})}static reject(e){return new oe((t,a)=>{a(e)})}static waitFor(e){return new oe((t,a)=>{let o=0,c=0,d=!1;e.forEach(f=>{++o,f.next(()=>{++c,d&&c===o&&t()},p=>a(p))}),d=!0,c===o&&t()})}static or(e){let t=oe.resolve(!1);for(const a of e)t=t.next(o=>o?oe.resolve(o):a());return t}static forEach(e,t){const a=[];return e.forEach((o,c)=>{a.push(t.call(this,o,c))}),this.waitFor(a)}static mapArray(e,t){return new oe((a,o)=>{const c=e.length,d=new Array(c);let f=0;for(let p=0;p<c;p++){const g=p;t(e[g]).next(y=>{d[g]=y,++f,f===c&&a(d)},y=>o(y))}})}static doWhile(e,t){return new oe((a,o)=>{const c=()=>{e()===!0?t().next(()=>{c()},o):a()};c()})}}function Y1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function hl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ue(a),this.ce=a=>t.writeSequenceNumber(a))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Xh.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg=-1;function mu(n){return n==null}function Ah(n){return n===0&&1/n==-1/0}function Q1(n){return typeof n=="number"&&Number.isInteger(n)&&!Ah(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT="";function K1(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=uN(e)),e=X1(n.get(t),e);return uN(e)}function X1(n,e){let t=e;const a=n.length;for(let o=0;o<a;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case KT:t+="";break;default:t+=c}}return t}function uN(n){return n+KT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dN(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Vi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function XT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,t){this.comparator=e,this.root=t||sn.EMPTY}insert(e,t){return new Nt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,sn.BLACK,null,null))}remove(e){return new Nt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const o=this.comparator(e,a.key);if(o===0)return t+a.left.size;o<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,a)=>(e(t,a),!1))}toString(){const e=[];return this.inorderTraversal((t,a)=>(e.push(`${t}:${a}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zd(this.root,e,this.comparator,!0)}}class Zd{constructor(e,t,a,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?a(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sn{constructor(e,t,a,o,c){this.key=e,this.value=t,this.color=a??sn.RED,this.left=o??sn.EMPTY,this.right=c??sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,o,c){return new sn(e??this.key,t??this.value,a??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let o=this;const c=a(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,a),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,a)),o.fixUp()}removeMin(){if(this.left.isEmpty())return sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return sn.EMPTY;a=o.right.min(),o=o.copy(a.key,a.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ne(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ne(27949);return e+(this.isRed()?0:1)}}sn.EMPTY=null,sn.RED=!0,sn.BLACK=!1;sn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ne(57766)}get value(){throw Ne(16141)}get color(){throw Ne(16727)}get left(){throw Ne(29726)}get right(){throw Ne(36894)}copy(e,t,a,o,c){return this}insert(e,t,a){return new sn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.comparator=e,this.data=new Nt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,a)=>(e(t),!1))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const o=a.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new hN(this.data.getIterator())}getIteratorFrom(e){return new hN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(a=>{t=t.add(a)}),t}isEqual(e){if(!(e instanceof Bt)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Bt(this.comparator);return t.data=e,t}}class hN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.fields=e,e.sort(an.comparator)}static empty(){return new Bn([])}unionWith(e){let t=new Bt(an.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new Bn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jo(this.fields,e.fields,(t,a)=>t.isEqual(a))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new WT("Invalid base64 string: "+c):c}}(e);return new ln(t)}static fromUint8Array(e){const t=function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c}(e);return new ln(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const a=new Uint8Array(t.length);for(let o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return a}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ln.EMPTY_BYTE_STRING=new ln("");const W1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ji(n){if(Ze(!!n,39018),typeof n=="string"){let e=0;const t=W1.exec(n);if(Ze(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const a=new Date(n);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:St(n.seconds),nanos:St(n.nanos)}}function St(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wi(n){return typeof n=="string"?ln.fromBase64String(n):ln.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT="server_timestamp",JT="__type__",e0="__previous_value__",t0="__local_write_time__";function Kg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[JT])===null||t===void 0?void 0:t.stringValue)===ZT}function Wh(n){const e=n.mapValue.fields[e0];return Kg(e)?Wh(e):e}function Xc(n){const e=ji(n.mapValue.fields[t0].timestampValue);return new qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(e,t,a,o,c,d,f,p,g,y){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=g,this.isUsingEmulator=y}}const jh="(default)";class Wc{constructor(e,t){this.projectId=e,this.database=t||jh}static empty(){return new Wc("","")}get isDefaultDatabase(){return this.database===jh}isEqual(e){return e instanceof Wc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0="__type__",J1="__max__",Jd={mapValue:{}},s0="__vector__",wh="value";function Ci(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Kg(n)?4:tD(n)?9007199254740991:eD(n)?10:11:Ne(28295,{value:n})}function Xs(n,e){if(n===e)return!0;const t=Ci(n);if(t!==Ci(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Xc(n).isEqual(Xc(e));case 3:return function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=ji(o.timestampValue),f=ji(c.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,c){return wi(o.bytesValue).isEqual(wi(c.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,c){return St(o.geoPointValue.latitude)===St(c.geoPointValue.latitude)&&St(o.geoPointValue.longitude)===St(c.geoPointValue.longitude)}(n,e);case 2:return function(o,c){if("integerValue"in o&&"integerValue"in c)return St(o.integerValue)===St(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=St(o.doubleValue),f=St(c.doubleValue);return d===f?Ah(d)===Ah(f):isNaN(d)&&isNaN(f)}return!1}(n,e);case 9:return Jo(n.arrayValue.values||[],e.arrayValue.values||[],Xs);case 10:case 11:return function(o,c){const d=o.mapValue.fields||{},f=c.mapValue.fields||{};if(dN(d)!==dN(f))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(f[p]===void 0||!Xs(d[p],f[p])))return!1;return!0}(n,e);default:return Ne(52216,{left:n})}}function Zc(n,e){return(n.values||[]).find(t=>Xs(t,e))!==void 0}function el(n,e){if(n===e)return 0;const t=Ci(n),a=Ci(e);if(t!==a)return qe(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return qe(n.booleanValue,e.booleanValue);case 2:return function(c,d){const f=St(c.integerValue||c.doubleValue),p=St(d.integerValue||d.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1}(n,e);case 3:return fN(n.timestampValue,e.timestampValue);case 4:return fN(Xc(n),Xc(e));case 5:return cg(n.stringValue,e.stringValue);case 6:return function(c,d){const f=wi(c),p=wi(d);return f.compareTo(p)}(n.bytesValue,e.bytesValue);case 7:return function(c,d){const f=c.split("/"),p=d.split("/");for(let g=0;g<f.length&&g<p.length;g++){const y=qe(f[g],p[g]);if(y!==0)return y}return qe(f.length,p.length)}(n.referenceValue,e.referenceValue);case 8:return function(c,d){const f=qe(St(c.latitude),St(d.latitude));return f!==0?f:qe(St(c.longitude),St(d.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return mN(n.arrayValue,e.arrayValue);case 10:return function(c,d){var f,p,g,y;const _=c.fields||{},N=d.fields||{},j=(f=_[wh])===null||f===void 0?void 0:f.arrayValue,x=(p=N[wh])===null||p===void 0?void 0:p.arrayValue,R=qe(((g=j?.values)===null||g===void 0?void 0:g.length)||0,((y=x?.values)===null||y===void 0?void 0:y.length)||0);return R!==0?R:mN(j,x)}(n.mapValue,e.mapValue);case 11:return function(c,d){if(c===Jd.mapValue&&d===Jd.mapValue)return 0;if(c===Jd.mapValue)return 1;if(d===Jd.mapValue)return-1;const f=c.fields||{},p=Object.keys(f),g=d.fields||{},y=Object.keys(g);p.sort(),y.sort();for(let _=0;_<p.length&&_<y.length;++_){const N=cg(p[_],y[_]);if(N!==0)return N;const j=el(f[p[_]],g[y[_]]);if(j!==0)return j}return qe(p.length,y.length)}(n.mapValue,e.mapValue);default:throw Ne(23264,{Pe:t})}}function fN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return qe(n,e);const t=ji(n),a=ji(e),o=qe(t.seconds,a.seconds);return o!==0?o:qe(t.nanos,a.nanos)}function mN(n,e){const t=n.values||[],a=e.values||[];for(let o=0;o<t.length&&o<a.length;++o){const c=el(t[o],a[o]);if(c)return c}return qe(t.length,a.length)}function tl(n){return ug(n)}function ug(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const a=ji(t);return`time(${a.seconds},${a.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return wi(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return _e.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let a="[",o=!0;for(const c of t.values||[])o?o=!1:a+=",",a+=ug(c);return a+"]"}(n.arrayValue):"mapValue"in n?function(t){const a=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of a)c?c=!1:o+=",",o+=`${d}:${ug(t.fields[d])}`;return o+"}"}(n.mapValue):Ne(61005,{value:n})}function uh(n){switch(Ci(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Wh(n);return e?16+uh(e):16;case 5:return 2*n.stringValue.length;case 6:return wi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(a){return(a.values||[]).reduce((o,c)=>o+uh(c),0)}(n.arrayValue);case 10:case 11:return function(a){let o=0;return Vi(a.fields,(c,d)=>{o+=c.length+uh(d)}),o}(n.mapValue);default:throw Ne(13486,{value:n})}}function pN(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function dg(n){return!!n&&"integerValue"in n}function Xg(n){return!!n&&"arrayValue"in n}function gN(n){return!!n&&"nullValue"in n}function vN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function dh(n){return!!n&&"mapValue"in n}function eD(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[n0])===null||t===void 0?void 0:t.stringValue)===s0}function Pc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Vi(n.mapValue.fields,(t,a)=>e.mapValue.fields[t]=Pc(a)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Pc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function tD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===J1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.value=e}static empty(){return new En({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!dh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pc(t)}setAll(e){let t=an.emptyPath(),a={},o=[];e.forEach((d,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,a,o),a={},o=[],t=f.popLast()}d?a[f.lastSegment()]=Pc(d):o.push(f.lastSegment())});const c=this.getFieldsMap(t);this.applyChanges(c,a,o)}delete(e){const t=this.field(e.popLast());dh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let o=t.mapValue.fields[e.get(a)];dh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,a){Vi(t,(o,c)=>e[o]=c);for(const o of a)delete e[o]}clone(){return new En(Pc(this.value))}}function a0(n){const e=[];return Vi(n.fields,(t,a)=>{const o=new an([t]);if(dh(a)){const c=a0(a.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)}),new Bn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,t,a,o,c,d,f){this.key=e,this.documentType=t,this.version=a,this.readTime=o,this.createTime=c,this.data=d,this.documentState=f}static newInvalidDocument(e){return new Wt(e,0,je.min(),je.min(),je.min(),En.empty(),0)}static newFoundDocument(e,t,a,o){return new Wt(e,1,t,je.min(),a,o,0)}static newNoDocument(e,t){return new Wt(e,2,t,je.min(),je.min(),En.empty(),0)}static newUnknownDocument(e,t){return new Wt(e,3,t,je.min(),je.min(),En.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=En.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=En.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,t){this.position=e,this.inclusive=t}}function yN(n,e,t){let a=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?a=_e.comparator(_e.fromName(d.referenceValue),t.key):a=el(d,t.data.field(c.field)),c.dir==="desc"&&(a*=-1),a!==0)break}return a}function bN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Xs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,t="asc"){this.field=e,this.dir=t}}function nD(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{}class kt extends i0{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new aD(e,t,a):t==="array-contains"?new oD(e,a):t==="in"?new lD(e,a):t==="not-in"?new cD(e,a):t==="array-contains-any"?new uD(e,a):new kt(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new iD(e,a):new rD(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(el(t,this.value)):t!==null&&Ci(this.value)===Ci(t)&&this.matchesComparison(el(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ts extends i0{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Ts(e,t)}matches(e){return r0(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function r0(n){return n.op==="and"}function o0(n){return sD(n)&&r0(n)}function sD(n){for(const e of n.filters)if(e instanceof Ts)return!1;return!0}function hg(n){if(n instanceof kt)return n.field.canonicalString()+n.op.toString()+tl(n.value);if(o0(n))return n.filters.map(e=>hg(e)).join(",");{const e=n.filters.map(t=>hg(t)).join(",");return`${n.op}(${e})`}}function l0(n,e){return n instanceof kt?function(a,o){return o instanceof kt&&a.op===o.op&&a.field.isEqual(o.field)&&Xs(a.value,o.value)}(n,e):n instanceof Ts?function(a,o){return o instanceof Ts&&a.op===o.op&&a.filters.length===o.filters.length?a.filters.reduce((c,d,f)=>c&&l0(d,o.filters[f]),!0):!1}(n,e):void Ne(19439)}function c0(n){return n instanceof kt?function(t){return`${t.field.canonicalString()} ${t.op} ${tl(t.value)}`}(n):n instanceof Ts?function(t){return t.op.toString()+" {"+t.getFilters().map(c0).join(" ,")+"}"}(n):"Filter"}class aD extends kt{constructor(e,t,a){super(e,t,a),this.key=_e.fromName(a.referenceValue)}matches(e){const t=_e.comparator(e.key,this.key);return this.matchesComparison(t)}}class iD extends kt{constructor(e,t){super(e,"in",t),this.keys=u0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class rD extends kt{constructor(e,t){super(e,"not-in",t),this.keys=u0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function u0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(a=>_e.fromName(a.referenceValue))}class oD extends kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Xg(t)&&Zc(t.arrayValue,this.value)}}class lD extends kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Zc(this.value.arrayValue,t)}}class cD extends kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Zc(this.value.arrayValue,t)}}class uD extends kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Xg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(a=>Zc(this.value.arrayValue,a))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(e,t=null,a=[],o=[],c=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=o,this.limit=c,this.startAt=d,this.endAt=f,this.Ie=null}}function _N(n,e=null,t=[],a=[],o=null,c=null,d=null){return new dD(n,e,t,a,o,c,d)}function Wg(n){const e=Re(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(a=>hg(a)).join(","),t+="|ob:",t+=e.orderBy.map(a=>function(c){return c.field.canonicalString()+c.dir}(a)).join(","),mu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(a=>tl(a)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(a=>tl(a)).join(",")),e.Ie=t}return e.Ie}function Zg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!nD(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!l0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!bN(n.startAt,e.startAt)&&bN(n.endAt,e.endAt)}function fg(n){return _e.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,t=null,a=[],o=[],c=null,d="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=o,this.limit=c,this.limitType=d,this.startAt=f,this.endAt=p,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function hD(n,e,t,a,o,c,d,f){return new fl(n,e,t,a,o,c,d,f)}function Zh(n){return new fl(n)}function xN(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function d0(n){return n.collectionGroup!==null}function Lc(n){const e=Re(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ee.push(c),t.add(c.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new Bt(an.comparator);return d.filters.forEach(p=>{p.getFlattenedFilters().forEach(g=>{g.isInequality()&&(f=f.add(g.field))})}),f})(e).forEach(c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ee.push(new Jc(c,a))}),t.has(an.keyField().canonicalString())||e.Ee.push(new Jc(an.keyField(),a))}return e.Ee}function Ks(n){const e=Re(n);return e.de||(e.de=fD(e,Lc(n))),e.de}function fD(n,e){if(n.limitType==="F")return _N(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const c=o.dir==="desc"?"asc":"desc";return new Jc(o.field,c)});const t=n.endAt?new Ch(n.endAt.position,n.endAt.inclusive):null,a=n.startAt?new Ch(n.startAt.position,n.startAt.inclusive):null;return _N(n.path,n.collectionGroup,e,n.filters,n.limit,t,a)}}function mg(n,e){const t=n.filters.concat([e]);return new fl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Sh(n,e,t){return new fl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Jh(n,e){return Zg(Ks(n),Ks(e))&&n.limitType===e.limitType}function h0(n){return`${Wg(Ks(n))}|lt:${n.limitType}`}function Uo(n){return`Query(target=${function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map(o=>c0(o)).join(", ")}]`),mu(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map(o=>function(d){return`${d.field.canonicalString()} (${d.dir})`}(o)).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map(o=>tl(o)).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map(o=>tl(o)).join(",")),`Target(${a})`}(Ks(n))}; limitType=${n.limitType})`}function ef(n,e){return e.isFoundDocument()&&function(a,o){const c=o.key.path;return a.collectionGroup!==null?o.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):_e.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)}(n,e)&&function(a,o){for(const c of Lc(a))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0}(n,e)&&function(a,o){for(const c of a.filters)if(!c.matches(o))return!1;return!0}(n,e)&&function(a,o){return!(a.startAt&&!function(d,f,p){const g=yN(d,f,p);return d.inclusive?g<=0:g<0}(a.startAt,Lc(a),o)||a.endAt&&!function(d,f,p){const g=yN(d,f,p);return d.inclusive?g>=0:g>0}(a.endAt,Lc(a),o))}(n,e)}function mD(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function f0(n){return(e,t)=>{let a=!1;for(const o of Lc(n)){const c=pD(o,e,t);if(c!==0)return c;a=a||o.field.isKeyField()}return 0}}function pD(n,e,t){const a=n.field.isKeyField()?_e.comparator(e.key,t.key):function(c,d,f){const p=d.data.field(c),g=f.data.field(c);return p!==null&&g!==null?el(p,g):Ne(42886)}(n.field,e,t);switch(n.dir){case"asc":return a;case"desc":return-1*a;default:return Ne(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[o,c]of a)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),o=this.inner[a];if(o===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return a.length===1?delete this.inner[t]:a.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Vi(this.inner,(t,a)=>{for(const[o,c]of a)e(o,c)})}isEmpty(){return XT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD=new Nt(_e.comparator);function Oa(){return gD}const m0=new Nt(_e.comparator);function Rc(...n){let e=m0;for(const t of n)e=e.insert(t.key,t);return e}function p0(n){let e=m0;return n.forEach((t,a)=>e=e.insert(t,a.overlayedDocument)),e}function wr(){return Vc()}function g0(){return Vc()}function Vc(){return new Ur(n=>n.toString(),(n,e)=>n.isEqual(e))}const vD=new Nt(_e.comparator),yD=new Bt(_e.comparator);function Ye(...n){let e=yD;for(const t of n)e=e.add(t);return e}const bD=new Bt(qe);function _D(){return bD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ah(e)?"-0":e}}function v0(n){return{integerValue:""+n}}function xD(n,e){return Q1(e)?v0(e):Jg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(){this._=void 0}}function ND(n,e,t){return n instanceof eu?function(o,c){const d={fields:{[JT]:{stringValue:ZT},[t0]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Kg(c)&&(c=Wh(c)),c&&(d.fields[e0]=c),{mapValue:d}}(t,e):n instanceof tu?b0(n,e):n instanceof nu?_0(n,e):function(o,c){const d=y0(o,c),f=NN(d)+NN(o.Re);return dg(d)&&dg(o.Re)?v0(f):Jg(o.serializer,f)}(n,e)}function ED(n,e,t){return n instanceof tu?b0(n,e):n instanceof nu?_0(n,e):t}function y0(n,e){return n instanceof Ih?function(a){return dg(a)||function(c){return!!c&&"doubleValue"in c}(a)}(e)?e:{integerValue:0}:null}class eu extends tf{}class tu extends tf{constructor(e){super(),this.elements=e}}function b0(n,e){const t=x0(e);for(const a of n.elements)t.some(o=>Xs(o,a))||t.push(a);return{arrayValue:{values:t}}}class nu extends tf{constructor(e){super(),this.elements=e}}function _0(n,e){let t=x0(e);for(const a of n.elements)t=t.filter(o=>!Xs(o,a));return{arrayValue:{values:t}}}class Ih extends tf{constructor(e,t){super(),this.serializer=e,this.Re=t}}function NN(n){return St(n.integerValue||n.doubleValue)}function x0(n){return Xg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e,t){this.field=e,this.transform=t}}function AD(n,e){return n.field.isEqual(e.field)&&function(a,o){return a instanceof tu&&o instanceof tu||a instanceof nu&&o instanceof nu?Jo(a.elements,o.elements,Xs):a instanceof Ih&&o instanceof Ih?Xs(a.Re,o.Re):a instanceof eu&&o instanceof eu}(n.transform,e.transform)}class jD{constructor(e,t){this.version=e,this.transformResults=t}}class rn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class nf{}function N0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new sf(n.key,rn.none()):new pu(n.key,n.data,rn.none());{const t=n.data,a=En.empty();let o=new Bt(an.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?a.delete(c):a.set(c,d),o=o.add(c)}return new Ui(n.key,a,new Bn(o.toArray()),rn.none())}}function wD(n,e,t){n instanceof pu?function(o,c,d){const f=o.value.clone(),p=TN(o.fieldTransforms,c,d.transformResults);f.setAll(p),c.convertToFoundDocument(d.version,f).setHasCommittedMutations()}(n,e,t):n instanceof Ui?function(o,c,d){if(!hh(o.precondition,c))return void c.convertToUnknownDocument(d.version);const f=TN(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(E0(o)),p.setAll(f),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()}(n,e,t):function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()}(0,e,t)}function Uc(n,e,t,a){return n instanceof pu?function(c,d,f,p){if(!hh(c.precondition,d))return f;const g=c.value.clone(),y=AN(c.fieldTransforms,p,d);return g.setAll(y),d.convertToFoundDocument(d.version,g).setHasLocalMutations(),null}(n,e,t,a):n instanceof Ui?function(c,d,f,p){if(!hh(c.precondition,d))return f;const g=AN(c.fieldTransforms,p,d),y=d.data;return y.setAll(E0(c)),y.setAll(g),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),f===null?null:f.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(_=>_.field))}(n,e,t,a):function(c,d,f){return hh(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f}(n,e,t)}function CD(n,e){let t=null;for(const a of n.fieldTransforms){const o=e.data.field(a.field),c=y0(a.transform,o||null);c!=null&&(t===null&&(t=En.empty()),t.set(a.field,c))}return t||null}function EN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(a,o){return a===void 0&&o===void 0||!(!a||!o)&&Jo(a,o,(c,d)=>AD(c,d))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class pu extends nf{constructor(e,t,a,o=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Ui extends nf{constructor(e,t,a,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function E0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const a=n.data.field(t);e.set(t,a)}}),e}function TN(n,e,t){const a=new Map;Ze(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,f=e.data.field(c.field);a.set(c.field,ED(d,f,t[o]))}return a}function AN(n,e,t){const a=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);a.set(o.field,ND(c,d,e))}return a}class sf extends nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class T0 extends nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e,t,a,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=o}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&wD(c,e,a[o])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=Uc(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=Uc(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=g0();return this.mutations.forEach(o=>{const c=e.get(o.key),d=c.overlayedDocument;let f=this.applyToLocalView(d,c.mutatedFields);f=t.has(o.key)?null:f;const p=N0(d,f);p!==null&&a.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(je.min())}),a}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ye())}isEqual(e){return this.batchId===e.batchId&&Jo(this.mutations,e.mutations,(t,a)=>EN(t,a))&&Jo(this.baseMutations,e.baseMutations,(t,a)=>EN(t,a))}}class ev{constructor(e,t,a,o){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=o}static from(e,t,a){Ze(e.mutations.length===a.length,58842,{fe:e.mutations.length,ge:a.length});let o=function(){return vD}();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,a[d].version);return new ev(e,t,a,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot,We;function A0(n){switch(n){case ie.OK:return Ne(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return Ne(15467,{code:n})}}function j0(n){if(n===void 0)return Ma("GRPC error has no .code"),ie.UNKNOWN;switch(n){case Ot.OK:return ie.OK;case Ot.CANCELLED:return ie.CANCELLED;case Ot.UNKNOWN:return ie.UNKNOWN;case Ot.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case Ot.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case Ot.INTERNAL:return ie.INTERNAL;case Ot.UNAVAILABLE:return ie.UNAVAILABLE;case Ot.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case Ot.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case Ot.NOT_FOUND:return ie.NOT_FOUND;case Ot.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case Ot.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case Ot.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case Ot.ABORTED:return ie.ABORTED;case Ot.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case Ot.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case Ot.DATA_LOSS:return ie.DATA_LOSS;default:return Ne(39323,{code:n})}}(We=Ot||(Ot={}))[We.OK=0]="OK",We[We.CANCELLED=1]="CANCELLED",We[We.UNKNOWN=2]="UNKNOWN",We[We.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",We[We.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",We[We.NOT_FOUND=5]="NOT_FOUND",We[We.ALREADY_EXISTS=6]="ALREADY_EXISTS",We[We.PERMISSION_DENIED=7]="PERMISSION_DENIED",We[We.UNAUTHENTICATED=16]="UNAUTHENTICATED",We[We.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",We[We.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",We[We.ABORTED=10]="ABORTED",We[We.OUT_OF_RANGE=11]="OUT_OF_RANGE",We[We.UNIMPLEMENTED=12]="UNIMPLEMENTED",We[We.INTERNAL=13]="INTERNAL",We[We.UNAVAILABLE=14]="UNAVAILABLE",We[We.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD=new xi([4294967295,4294967295],0);function jN(n){const e=YT().encode(n),t=new UT;return t.update(e),new Uint8Array(t.digest())}function wN(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new xi([t,a],0),new xi([o,c],0)]}class tv{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new Dc(`Invalid padding: ${t}`);if(a<0)throw new Dc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new Dc(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new Dc(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=xi.fromNumber(this.pe)}we(e,t,a){let o=e.add(t.multiply(xi.fromNumber(a)));return o.compare(DD)===1&&(o=new xi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=jN(e),[a,o]=wN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);if(!this.be(d))return!1}return!0}static create(e,t,a){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new tv(c,o,t);return a.forEach(f=>d.insert(f)),d}insert(e){if(this.pe===0)return;const t=jN(e),[a,o]=wN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);this.Se(d)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class Dc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,t,a,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const o=new Map;return o.set(e,gu.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new af(je.min(),o,new Nt(qe),Oa(),Ye())}}class gu{constructor(e,t,a,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new gu(a,t,Ye(),Ye(),Ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,t,a,o){this.De=e,this.removedTargetIds=t,this.key=a,this.ve=o}}class w0{constructor(e,t){this.targetId=e,this.Ce=t}}class C0{constructor(e,t,a=ln.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=o}}class CN{constructor(){this.Fe=0,this.Me=SN(),this.xe=ln.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Ye(),t=Ye(),a=Ye();return this.Me.forEach((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:a=a.add(o);break;default:Ne(38017,{changeType:c})}}),new gu(this.xe,this.Oe,e,t,a)}Qe(){this.Ne=!1,this.Me=SN()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Ze(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class MD{constructor(e){this.ze=e,this.je=new Map,this.He=Oa(),this.Je=eh(),this.Ye=eh(),this.Ze=new Nt(qe)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const a=this.rt(t);switch(e.state){case 0:this.it(t)&&a.ke(e.resumeToken);break;case 1:a.We(),a.Be||a.Qe(),a.ke(e.resumeToken);break;case 2:a.We(),a.Be||this.removeTarget(t);break;case 3:this.it(t)&&(a.Ge(),a.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),a.ke(e.resumeToken));break;default:Ne(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((a,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,a=e.Ce.count,o=this._t(t);if(o){const c=o.target;if(fg(c))if(a===0){const d=new _e(c.path);this.tt(t,d,Wt.newNoDocument(d,je.min()))}else Ze(a===1,20013,{expectedCount:a});else{const d=this.ut(t);if(d!==a){const f=this.ct(e),p=f?this.lt(f,e,d):1;if(p!==0){this.st(t);const g=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:o=0},hashCount:c=0}=t;let d,f;try{d=wi(a).toUint8Array()}catch(p){if(p instanceof WT)return Zo("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new tv(d,o,c)}catch(p){return Zo(p instanceof Dc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.pe===0?null:f}lt(e,t,a){return t.Ce.count===a-this.Tt(e,t.targetId)?0:2}Tt(e,t){const a=this.ze.getRemoteKeysForTarget(t);let o=0;return a.forEach(c=>{const d=this.ze.Pt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(f)||(this.tt(t,c,null),o++)}),o}It(e){const t=new Map;this.je.forEach((c,d)=>{const f=this._t(d);if(f){if(c.current&&fg(f.target)){const p=new _e(f.target.path);this.Et(p).has(d)||this.dt(d,p)||this.tt(d,p,Wt.newNoDocument(p,e))}c.Le&&(t.set(d,c.qe()),c.Qe())}});let a=Ye();this.Ye.forEach((c,d)=>{let f=!0;d.forEachWhile(p=>{const g=this._t(p);return!g||g.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)}),f&&(a=a.add(c))}),this.He.forEach((c,d)=>d.setReadTime(e));const o=new af(e,t,this.Ze,this.He,a);return this.He=Oa(),this.Je=eh(),this.Ye=eh(),this.Ze=new Nt(qe),o}et(e,t){if(!this.it(e))return;const a=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,a),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,a){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),a&&(this.He=this.He.insert(t,a))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new CN,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Bt(qe),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Bt(qe),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||ve("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new CN),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function eh(){return new Nt(_e.comparator)}function SN(){return new Nt(_e.comparator)}const OD={asc:"ASCENDING",desc:"DESCENDING"},kD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},PD={and:"AND",or:"OR"};class LD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function pg(n,e){return n.useProto3Json||mu(e)?e:{value:e}}function Rh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function S0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function VD(n,e){return Rh(n,e.toTimestamp())}function Hn(n){return Ze(!!n,49232),je.fromTimestamp(function(t){const a=ji(t);return new qt(a.seconds,a.nanos)}(n))}function nv(n,e){return gg(n,e).canonicalString()}function gg(n,e){const t=function(o){return new ht(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function I0(n){const e=ht.fromString(n);return Ze(P0(e),10190,{key:e.toString()}),e}function Dh(n,e){return nv(n.databaseId,e.path)}function Fc(n,e){const t=I0(e);if(t.get(1)!==n.databaseId.projectId)throw new ge(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ge(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new _e(D0(t))}function R0(n,e){return nv(n.databaseId,e)}function UD(n){const e=I0(n);return e.length===4?ht.emptyPath():D0(e)}function vg(n){return new ht(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function D0(n){return Ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function IN(n,e,t){return{name:Dh(n,e),fields:t.value.mapValue.fields}}function FD(n,e){return"found"in e?function(a,o){Ze(!!o.found,43571),o.found.name,o.found.updateTime;const c=Fc(a,o.found.name),d=Hn(o.found.updateTime),f=o.found.createTime?Hn(o.found.createTime):je.min(),p=new En({mapValue:{fields:o.found.fields}});return Wt.newFoundDocument(c,d,f,p)}(n,e):"missing"in e?function(a,o){Ze(!!o.missing,3894),Ze(!!o.readTime,22933);const c=Fc(a,o.missing),d=Hn(o.readTime);return Wt.newNoDocument(c,d)}(n,e):Ne(7234,{result:e})}function qD(n,e){let t;if("targetChange"in e){e.targetChange;const a=function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:Ne(39313,{state:g})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=function(g,y){return g.useProto3Json?(Ze(y===void 0||typeof y=="string",58123),ln.fromBase64String(y||"")):(Ze(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),ln.fromUint8Array(y||new Uint8Array))}(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&function(g){const y=g.code===void 0?ie.UNKNOWN:j0(g.code);return new ge(y,g.message||"")}(d);t=new C0(a,o,c,f||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const o=Fc(n,a.document.name),c=Hn(a.document.updateTime),d=a.document.createTime?Hn(a.document.createTime):je.min(),f=new En({mapValue:{fields:a.document.fields}}),p=Wt.newFoundDocument(o,c,d,f),g=a.targetIds||[],y=a.removedTargetIds||[];t=new fh(g,y,p.key,p)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const o=Fc(n,a.document),c=a.readTime?Hn(a.readTime):je.min(),d=Wt.newNoDocument(o,c),f=a.removedTargetIds||[];t=new fh([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const o=Fc(n,a.document),c=a.removedTargetIds||[];t=new fh([],c,o,null)}else{if(!("filter"in e))return Ne(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:o=0,unchangedNames:c}=a,d=new RD(o,c),f=a.targetId;t=new w0(f,d)}}return t}function M0(n,e){let t;if(e instanceof pu)t={update:IN(n,e.key,e.value)};else if(e instanceof sf)t={delete:Dh(n,e.key)};else if(e instanceof Ui)t={update:IN(n,e.key,e.data),updateMask:XD(e.fieldMask)};else{if(!(e instanceof T0))return Ne(16599,{ft:e.type});t={verify:Dh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(a=>function(c,d){const f=d.transform;if(f instanceof eu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof tu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof nu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Ih)return{fieldPath:d.field.canonicalString(),increment:f.Re};throw Ne(20930,{transform:d.transform})}(0,a))),e.precondition.isNone||(t.currentDocument=function(o,c){return c.updateTime!==void 0?{updateTime:VD(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:Ne(27497)}(n,e.precondition)),t}function BD(n,e){return n&&n.length>0?(Ze(e!==void 0,14353),n.map(t=>function(o,c){let d=o.updateTime?Hn(o.updateTime):Hn(c);return d.isEqual(je.min())&&(d=Hn(c)),new jD(d,o.transformResults||[])}(t,e))):[]}function zD(n,e){return{documents:[R0(n,e.path)]}}function HD(n,e){const t={structuredQuery:{}},a=e.path;let o;e.collectionGroup!==null?(o=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=R0(n,o);const c=function(g){if(g.length!==0)return k0(Ts.create(g,"and"))}(e.filters);c&&(t.structuredQuery.where=c);const d=function(g){if(g.length!==0)return g.map(y=>function(N){return{field:Fo(N.field),direction:YD(N.dir)}}(y))}(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=pg(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=function(g){return{before:g.inclusive,values:g.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(g){return{before:!g.inclusive,values:g.position}}(e.endAt)),{gt:t,parent:o}}function GD(n){let e=UD(n.parent);const t=n.structuredQuery,a=t.from?t.from.length:0;let o=null;if(a>0){Ze(a===1,65062);const y=t.from[0];y.allDescendants?o=y.collectionId:e=e.child(y.collectionId)}let c=[];t.where&&(c=function(_){const N=O0(_);return N instanceof Ts&&o0(N)?N.getFilters():[N]}(t.where));let d=[];t.orderBy&&(d=function(_){return _.map(N=>function(x){return new Jc(qo(x.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(N))}(t.orderBy));let f=null;t.limit&&(f=function(_){let N;return N=typeof _=="object"?_.value:_,mu(N)?null:N}(t.limit));let p=null;t.startAt&&(p=function(_){const N=!!_.before,j=_.values||[];return new Ch(j,N)}(t.startAt));let g=null;return t.endAt&&(g=function(_){const N=!_.before,j=_.values||[];return new Ch(j,N)}(t.endAt)),hD(e,o,d,c,f,"F",p,g)}function $D(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ne(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function O0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=qo(t.unaryFilter.field);return kt.create(a,"==",{doubleValue:NaN});case"IS_NULL":const o=qo(t.unaryFilter.field);return kt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=qo(t.unaryFilter.field);return kt.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=qo(t.unaryFilter.field);return kt.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ne(61313);default:return Ne(60726)}}(n):n.fieldFilter!==void 0?function(t){return kt.create(qo(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ne(58110);default:return Ne(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ts.create(t.compositeFilter.filters.map(a=>O0(a)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ne(1026)}}(t.compositeFilter.op))}(n):Ne(30097,{filter:n})}function YD(n){return OD[n]}function QD(n){return kD[n]}function KD(n){return PD[n]}function Fo(n){return{fieldPath:n.canonicalString()}}function qo(n){return an.fromServerFormat(n.fieldPath)}function k0(n){return n instanceof kt?function(t){if(t.op==="=="){if(vN(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NAN"}};if(gN(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(vN(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NOT_NAN"}};if(gN(t.value))return{unaryFilter:{field:Fo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fo(t.field),op:QD(t.op),value:t.value}}}(n):n instanceof Ts?function(t){const a=t.getFilters().map(o=>k0(o));return a.length===1?a[0]:{compositeFilter:{op:KD(t.op),filters:a}}}(n):Ne(54877,{filter:n})}function XD(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function P0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,t,a,o,c=je.min(),d=je.min(),f=ln.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e){this.wt=e}}function ZD(n){const e=GD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Sh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(){this.Cn=new eM}addToCollectionParentIndex(e,t){return this.Cn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(Ai.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(Ai.min())}updateCollectionGroup(e,t,a){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class eM{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t]||new Bt(ht.comparator),c=!o.has(a);return this.index[t]=o.add(a),c}has(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t];return o&&o.has(a)}getEntries(e){return(this.index[e]||new Bt(ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},L0=41943040;class Sn{static withCacheSize(e){return new Sn(e,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sn.DEFAULT_COLLECTION_PERCENTILE=10,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sn.DEFAULT=new Sn(L0,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sn.DISABLED=new Sn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new nl(0)}static lr(){return new nl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DN="LruGarbageCollector",tM=1048576;function MN([n,e],[t,a]){const o=qe(n,t);return o===0?qe(e,a):o}class nM{constructor(e){this.Er=e,this.buffer=new Bt(MN),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();MN(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class sM{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){ve(DN,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){hl(t)?ve(DN,"Ignoring IndexedDB error during garbage collection: ",t):await dl(t)}await this.mr(3e5)})}}class aM{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(a=>Math.floor(t/100*a))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(Xh.le);const a=new nM(t);return this.gr.forEachTarget(e,o=>a.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>a.Rr(o))).next(()=>a.maxValue)}removeTargets(e,t,a){return this.gr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(RN)):this.getCacheSize(e).next(a=>a<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),RN):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let a,o,c,d,f,p,g;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_=>(_>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),o=this.params.maximumSequenceNumbersToCollect):o=_,d=Date.now(),this.nthSequenceNumber(e,o))).next(_=>(a=_,f=Date.now(),this.removeTargets(e,a,t))).next(_=>(c=_,p=Date.now(),this.removeOrphanedDocuments(e,a))).next(_=>(g=Date.now(),Vo()<=$e.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-y}ms
	Determined least recently used ${o} in `+(f-d)+`ms
	Removed ${c} targets in `+(p-f)+`ms
	Removed ${_} documents in `+(g-p)+`ms
Total Duration: ${g-y}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:_})))}}function iM(n,e){return new aM(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(){this.changes=new Ur(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Wt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?oe.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lM{constructor(e,t,a,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=o}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(a=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(a!==null&&Uc(a.mutation,o,Bn.empty(),qt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.getLocalViewOfDocuments(e,a,Ye()).next(()=>a))}getLocalViewOfDocuments(e,t,a=Ye()){const o=wr();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,a).next(c=>{let d=Rc();return c.forEach((f,p)=>{d=d.insert(f,p.overlayedDocument)}),d}))}getOverlayedDocuments(e,t){const a=wr();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,Ye()))}populateOverlays(e,t,a){const o=[];return a.forEach(c=>{t.has(c)||o.push(c)}),this.documentOverlayCache.getOverlays(e,o).next(c=>{c.forEach((d,f)=>{t.set(d,f)})})}computeViews(e,t,a,o){let c=Oa();const d=Vc(),f=function(){return Vc()}();return t.forEach((p,g)=>{const y=a.get(g.key);o.has(g.key)&&(y===void 0||y.mutation instanceof Ui)?c=c.insert(g.key,g):y!==void 0?(d.set(g.key,y.mutation.getFieldMask()),Uc(y.mutation,g,y.mutation.getFieldMask(),qt.now())):d.set(g.key,Bn.empty())}),this.recalculateAndSaveOverlays(e,c).next(p=>(p.forEach((g,y)=>d.set(g,y)),t.forEach((g,y)=>{var _;return f.set(g,new oM(y,(_=d.get(g))!==null&&_!==void 0?_:null))}),f))}recalculateAndSaveOverlays(e,t){const a=Vc();let o=new Nt((d,f)=>d-f),c=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(d=>{for(const f of d)f.keys().forEach(p=>{const g=t.get(p);if(g===null)return;let y=a.get(p)||Bn.empty();y=f.applyToLocalView(g,y),a.set(p,y);const _=(o.get(f.batchId)||Ye()).add(p);o=o.insert(f.batchId,_)})}).next(()=>{const d=[],f=o.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),g=p.key,y=p.value,_=g0();y.forEach(N=>{if(!c.has(N)){const j=N0(t.get(N),a.get(N));j!==null&&_.set(N,j),c=c.add(N)}}),d.push(this.documentOverlayCache.saveOverlays(e,g,_))}return oe.waitFor(d)}).next(()=>a)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.recalculateAndSaveOverlays(e,a))}getDocumentsMatchingQuery(e,t,a,o){return function(d){return _e.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):d0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,o):this.getDocumentsMatchingCollectionQuery(e,t,a,o)}getNextDocuments(e,t,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,o).next(c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,o-c.size):oe.resolve(wr());let f=Kc,p=c;return d.next(g=>oe.forEach(g,(y,_)=>(f<_.largestBatchId&&(f=_.largestBatchId),c.get(y)?oe.resolve():this.remoteDocumentCache.getEntry(e,y).next(N=>{p=p.insert(y,N)}))).next(()=>this.populateOverlays(e,g,c)).next(()=>this.computeViews(e,p,g,Ye())).next(y=>({batchId:f,changes:p0(y)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _e(t)).next(a=>{let o=Rc();return a.isFoundDocument()&&(o=o.insert(a.key,a)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,a,o){const c=t.collectionGroup;let d=Rc();return this.indexManager.getCollectionParents(e,c).next(f=>oe.forEach(f,p=>{const g=function(_,N){return new fl(N,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,g,a,o).next(y=>{y.forEach((_,N)=>{d=d.insert(_,N)})})}).next(()=>d))}getDocumentsMatchingCollectionQuery(e,t,a,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next(d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,c,o))).next(d=>{c.forEach((p,g)=>{const y=g.getKey();d.get(y)===null&&(d=d.insert(y,Wt.newInvalidDocument(y)))});let f=Rc();return d.forEach((p,g)=>{const y=c.get(p);y!==void 0&&Uc(y.mutation,g,Bn.empty(),qt.now()),ef(t,g)&&(f=f.insert(p,g))}),f})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return oe.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:Hn(o.createTime)}}(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:ZD(o.bundledQuery),readTime:Hn(o.readTime)}}(t)),oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(){this.overlays=new Nt(_e.comparator),this.Qr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const a=wr();return oe.forEach(t,o=>this.getOverlay(e,o).next(c=>{c!==null&&a.set(o,c)})).next(()=>a)}saveOverlays(e,t,a){return a.forEach((o,c)=>{this.St(e,t,c)}),oe.resolve()}removeOverlaysForBatchId(e,t,a){const o=this.Qr.get(a);return o!==void 0&&(o.forEach(c=>this.overlays=this.overlays.remove(c)),this.Qr.delete(a)),oe.resolve()}getOverlaysForCollection(e,t,a){const o=wr(),c=t.length+1,d=new _e(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const p=f.getNext().value,g=p.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===c&&p.largestBatchId>a&&o.set(p.getKey(),p)}return oe.resolve(o)}getOverlaysForCollectionGroup(e,t,a,o){let c=new Nt((g,y)=>g-y);const d=this.overlays.getIterator();for(;d.hasNext();){const g=d.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>a){let y=c.get(g.largestBatchId);y===null&&(y=wr(),c=c.insert(g.largestBatchId,y)),y.set(g.getKey(),g)}}const f=wr(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((g,y)=>f.set(g,y)),!(f.size()>=o)););return oe.resolve(f)}St(e,t,a){const o=this.overlays.get(a.key);if(o!==null){const d=this.Qr.get(o.largestBatchId).delete(a.key);this.Qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(a.key,new ID(t,a));let c=this.Qr.get(t);c===void 0&&(c=Ye(),this.Qr.set(t,c)),this.Qr.set(t,c.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(){this.sessionToken=ln.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(){this.$r=new Bt(Xt.Ur),this.Kr=new Bt(Xt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const a=new Xt(e,t);this.$r=this.$r.add(a),this.Kr=this.Kr.add(a)}Gr(e,t){e.forEach(a=>this.addReference(a,t))}removeReference(e,t){this.zr(new Xt(e,t))}jr(e,t){e.forEach(a=>this.removeReference(a,t))}Hr(e){const t=new _e(new ht([])),a=new Xt(t,e),o=new Xt(t,e+1),c=[];return this.Kr.forEachInRange([a,o],d=>{this.zr(d),c.push(d.key)}),c}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new _e(new ht([])),a=new Xt(t,e),o=new Xt(t,e+1);let c=Ye();return this.Kr.forEachInRange([a,o],d=>{c=c.add(d.key)}),c}containsKey(e){const t=new Xt(e,0),a=this.$r.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class Xt{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return _e.comparator(e.key,t.key)||qe(e.Zr,t.Zr)}static Wr(e,t){return qe(e.Zr,t.Zr)||_e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Bt(Xt.Ur)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,o){const c=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new SD(c,t,a,o);this.mutationQueue.push(d);for(const f of o)this.Xr=this.Xr.add(new Xt(f.key,c)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return oe.resolve(d)}lookupMutationBatch(e,t){return oe.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,o=this.ti(a),c=o<0?0:o;return oe.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?Qg:this.nr-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new Xt(t,0),o=new Xt(t,Number.POSITIVE_INFINITY),c=[];return this.Xr.forEachInRange([a,o],d=>{const f=this.ei(d.Zr);c.push(f)}),oe.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new Bt(qe);return t.forEach(o=>{const c=new Xt(o,0),d=new Xt(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([c,d],f=>{a=a.add(f.Zr)})}),oe.resolve(this.ni(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,o=a.length+1;let c=a;_e.isDocumentKey(c)||(c=c.child(""));const d=new Xt(new _e(c),0);let f=new Bt(qe);return this.Xr.forEachWhile(p=>{const g=p.key.path;return!!a.isPrefixOf(g)&&(g.length===o&&(f=f.add(p.Zr)),!0)},d),oe.resolve(this.ni(f))}ni(e){const t=[];return e.forEach(a=>{const o=this.ei(a);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Ze(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Xr;return oe.forEach(t.mutations,o=>{const c=new Xt(o.key,t.batchId);return a=a.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=a})}sr(e){}containsKey(e,t){const a=new Xt(t,0),o=this.Xr.firstAfterOrEqual(a);return oe.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e){this.ii=e,this.docs=function(){return new Nt(_e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,o=this.docs.get(a),c=o?o.size:0,d=this.ii(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return oe.resolve(a?a.document.mutableCopy():Wt.newInvalidDocument(t))}getEntries(e,t){let a=Oa();return t.forEach(o=>{const c=this.docs.get(o);a=a.insert(o,c?c.document.mutableCopy():Wt.newInvalidDocument(o))}),oe.resolve(a)}getDocumentsMatchingQuery(e,t,a,o){let c=Oa();const d=t.path,f=new _e(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:g,value:{document:y}}=p.getNext();if(!d.isPrefixOf(g.path))break;g.path.length>d.length+1||H1(z1(y),a)<=0||(o.has(y.key)||ef(t,y))&&(c=c.insert(y.key,y.mutableCopy()))}return oe.resolve(c)}getAllFromCollectionGroup(e,t,a,o){Ne(9500)}si(e,t){return oe.forEach(this.docs,a=>t(a))}newChangeBuffer(e){return new mM(this)}getSize(e){return oe.resolve(this.size)}}class mM extends rM{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((a,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(a)}),oe.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e){this.persistence=e,this.oi=new Ur(t=>Wg(t),Zg),this.lastRemoteSnapshotVersion=je.min(),this.highestTargetId=0,this._i=0,this.ai=new sv,this.targetCount=0,this.ui=nl.cr()}forEachTarget(e,t){return this.oi.forEach((a,o)=>t(o)),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this._i&&(this._i=t),oe.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new nl(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.Tr(t),oe.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,a){let o=0;const c=[];return this.oi.forEach((d,f)=>{f.sequenceNumber<=t&&a.get(f.targetId)===null&&(this.oi.delete(d),c.push(this.removeMatchingKeysForTargetId(e,f.targetId)),o++)}),oe.waitFor(c).next(()=>o)}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const a=this.oi.get(t)||null;return oe.resolve(a)}addMatchingKeys(e,t,a){return this.ai.Gr(t,a),oe.resolve()}removeMatchingKeys(e,t,a){this.ai.jr(t,a);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach(d=>{c.push(o.markPotentiallyOrphaned(e,d))}),oe.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const a=this.ai.Yr(t);return oe.resolve(a)}containsKey(e,t){return oe.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e,t){this.ci={},this.overlays={},this.li=new Xh(0),this.hi=!1,this.hi=!0,this.Pi=new dM,this.referenceDelegate=e(this),this.Ti=new pM(this),this.indexManager=new JD,this.remoteDocumentCache=function(o){return new fM(o)}(a=>this.referenceDelegate.Ii(a)),this.serializer=new WD(t),this.Ei=new cM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new uM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ci[e.toKey()];return a||(a=new hM(t,this.referenceDelegate),this.ci[e.toKey()]=a),a}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,a){ve("MemoryPersistence","Starting transaction:",e);const o=new gM(this.li.next());return this.referenceDelegate.di(),a(o).next(c=>this.referenceDelegate.Ai(o).next(()=>c)).toPromise().then(c=>(o.raiseOnCommittedEvent(),c))}Ri(e,t){return oe.or(Object.values(this.ci).map(a=>()=>a.containsKey(e,t)))}}class gM extends $1{constructor(e){super(),this.currentSequenceNumber=e}}class av{constructor(e){this.persistence=e,this.Vi=new sv,this.mi=null}static fi(e){return new av(e)}get gi(){if(this.mi)return this.mi;throw Ne(60996)}addReference(e,t,a){return this.Vi.addReference(a,t),this.gi.delete(a.toString()),oe.resolve()}removeReference(e,t,a){return this.Vi.removeReference(a,t),this.gi.add(a.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(c=>this.gi.add(c.toString()))}).next(()=>a.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.gi,a=>{const o=_e.fromPath(a);return this.pi(e,o).next(c=>{c||t.removeEntry(o,je.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(a=>{a?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return oe.or([()=>oe.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Mh{constructor(e,t){this.persistence=e,this.yi=new Ur(a=>K1(a.path),(a,o)=>a.isEqual(o)),this.garbageCollector=iM(this,t)}static fi(e,t){return new Mh(e,t)}di(){}Ai(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(a=>t.next(o=>a+o))}br(e){let t=0;return this.yr(e,a=>{t++}).next(()=>t)}yr(e,t){return oe.forEach(this.yi,(a,o)=>this.Dr(e,a,o).next(c=>c?oe.resolve():t(o)))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.si(e,d=>this.Dr(e,d,t).next(f=>{f||(a++,c.removeEntry(d,je.min()))})).next(()=>c.apply(e)).next(()=>a)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),oe.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=uh(e.data.value)),t}Dr(e,t,a){return oe.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return oe.resolve(o!==void 0&&o>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,t,a,o){this.targetId=e,this.fromCache=t,this.ds=a,this.As=o}static Rs(e,t){let a=Ye(),o=Ye();for(const c of t.docChanges)switch(c.type){case 0:a=a.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new iv(e,t.fromCache,a,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return XC()?8:Y1(gn())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,a,o){const c={result:null};return this.ws(e,t).next(d=>{c.result=d}).next(()=>{if(!c.result)return this.bs(e,t,o,a).next(d=>{c.result=d})}).next(()=>{if(c.result)return;const d=new vM;return this.Ss(e,t,d).next(f=>{if(c.result=f,this.fs)return this.Ds(e,t,d,f.size)})}).next(()=>c.result)}Ds(e,t,a,o){return a.documentReadCount<this.gs?(Vo()<=$e.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",Uo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),oe.resolve()):(Vo()<=$e.DEBUG&&ve("QueryEngine","Query:",Uo(t),"scans",a.documentReadCount,"local documents and returns",o,"documents as results."),a.documentReadCount>this.ps*o?(Vo()<=$e.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",Uo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ks(t))):oe.resolve())}ws(e,t){if(xN(t))return oe.resolve(null);let a=Ks(t);return this.indexManager.getIndexType(e,a).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Sh(t,null,"F"),a=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next(c=>{const d=Ye(...c);return this.ys.getDocuments(e,d).next(f=>this.indexManager.getMinOffset(e,a).next(p=>{const g=this.vs(t,f);return this.Cs(t,g,d,p.readTime)?this.ws(e,Sh(t,null,"F")):this.Fs(e,g,t,p)}))})))}bs(e,t,a,o){return xN(t)||o.isEqual(je.min())?oe.resolve(null):this.ys.getDocuments(e,a).next(c=>{const d=this.vs(t,c);return this.Cs(t,d,a,o)?oe.resolve(null):(Vo()<=$e.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Uo(t)),this.Fs(e,d,t,B1(o,Kc)).next(f=>f))})}vs(e,t){let a=new Bt(f0(e));return t.forEach((o,c)=>{ef(e,c)&&(a=a.add(c))}),a}Cs(e,t,a,o){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,a){return Vo()<=$e.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",Uo(t)),this.ys.getDocumentsMatchingQuery(e,t,Ai.min(),a)}Fs(e,t,a,o){return this.ys.getDocumentsMatchingQuery(e,a,o).next(c=>(t.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv="LocalStore",bM=3e8;class _M{constructor(e,t,a,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new Nt(qe),this.Os=new Ur(c=>Wg(c),Zg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(a)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lM(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function xM(n,e,t,a){return new _M(n,e,t,a)}async function U0(n,e){const t=Re(n);return await t.persistence.runTransaction("Handle user change","readonly",a=>{let o;return t.mutationQueue.getAllMutationBatches(a).next(c=>(o=c,t.Ls(e),t.mutationQueue.getAllMutationBatches(a))).next(c=>{const d=[],f=[];let p=Ye();for(const g of o){d.push(g.batchId);for(const y of g.mutations)p=p.add(y.key)}for(const g of c){f.push(g.batchId);for(const y of g.mutations)p=p.add(y.key)}return t.localDocuments.getDocuments(a,p).next(g=>({ks:g,removedBatchIds:d,addedBatchIds:f}))})})}function NM(n,e){const t=Re(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const o=e.batch.keys(),c=t.Bs.newChangeBuffer({trackRemovals:!0});return function(f,p,g,y){const _=g.batch,N=_.keys();let j=oe.resolve();return N.forEach(x=>{j=j.next(()=>y.getEntry(p,x)).next(R=>{const A=g.docVersions.get(x);Ze(A!==null,48541),R.version.compareTo(A)<0&&(_.applyToRemoteDocument(R,g),R.isValidDocument()&&(R.setReadTime(g.commitVersion),y.addEntry(R)))})}),j.next(()=>f.mutationQueue.removeMutationBatch(p,_))}(t,a,e,c).next(()=>c.apply(a)).next(()=>t.mutationQueue.performConsistencyCheck(a)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(a,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,function(f){let p=Ye();for(let g=0;g<f.mutationResults.length;++g)f.mutationResults[g].transformResults.length>0&&(p=p.add(f.batch.mutations[g].key));return p}(e))).next(()=>t.localDocuments.getDocuments(a,o))})}function F0(n){const e=Re(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function EM(n,e){const t=Re(n),a=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const f=[];e.targetChanges.forEach((y,_)=>{const N=o.get(_);if(!N)return;f.push(t.Ti.removeMatchingKeys(c,y.removedDocuments,_).next(()=>t.Ti.addMatchingKeys(c,y.addedDocuments,_)));let j=N.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(_)!==null?j=j.withResumeToken(ln.EMPTY_BYTE_STRING,je.min()).withLastLimboFreeSnapshotVersion(je.min()):y.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(y.resumeToken,a)),o=o.insert(_,j),function(R,A,O){return R.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=bM?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(N,j,y)&&f.push(t.Ti.updateTargetData(c,j))});let p=Oa(),g=Ye();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(c,y))}),f.push(TM(c,d,e.documentUpdates).next(y=>{p=y.qs,g=y.Qs})),!a.isEqual(je.min())){const y=t.Ti.getLastRemoteSnapshotVersion(c).next(_=>t.Ti.setTargetsMetadata(c,c.currentSequenceNumber,a));f.push(y)}return oe.waitFor(f).next(()=>d.apply(c)).next(()=>t.localDocuments.getLocalViewOfDocuments(c,p,g)).next(()=>p)}).then(c=>(t.xs=o,c))}function TM(n,e,t){let a=Ye(),o=Ye();return t.forEach(c=>a=a.add(c)),e.getEntries(n,a).next(c=>{let d=Oa();return t.forEach((f,p)=>{const g=c.get(f);p.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(f)),p.isNoDocument()&&p.version.isEqual(je.min())?(e.removeEntry(f,p.readTime),d=d.insert(f,p)):!g.isValidDocument()||p.version.compareTo(g.version)>0||p.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(p),d=d.insert(f,p)):ve(rv,"Ignoring outdated watch update for ",f,". Current version:",g.version," Watch version:",p.version)}),{qs:d,Qs:o}})}function AM(n,e){const t=Re(n);return t.persistence.runTransaction("Get next mutation batch","readonly",a=>(e===void 0&&(e=Qg),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e)))}function jM(n,e){const t=Re(n);return t.persistence.runTransaction("Allocate target","readwrite",a=>{let o;return t.Ti.getTargetData(a,e).next(c=>c?(o=c,oe.resolve(o)):t.Ti.allocateTargetId(a).next(d=>(o=new yi(e,d,"TargetPurposeListen",a.currentSequenceNumber),t.Ti.addTargetData(a,o).next(()=>o))))}).then(a=>{const o=t.xs.get(a.targetId);return(o===null||a.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(a.targetId,a),t.Os.set(e,a.targetId)),a})}async function yg(n,e,t){const a=Re(n),o=a.xs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",c,d=>a.persistence.referenceDelegate.removeTarget(d,o))}catch(d){if(!hl(d))throw d;ve(rv,`Failed to update sequence numbers for target ${e}: ${d}`)}a.xs=a.xs.remove(e),a.Os.delete(o.target)}function ON(n,e,t){const a=Re(n);let o=je.min(),c=Ye();return a.persistence.runTransaction("Execute query","readwrite",d=>function(p,g,y){const _=Re(p),N=_.Os.get(y);return N!==void 0?oe.resolve(_.xs.get(N)):_.Ti.getTargetData(g,y)}(a,d,Ks(e)).next(f=>{if(f)return o=f.lastLimboFreeSnapshotVersion,a.Ti.getMatchingKeysForTargetId(d,f.targetId).next(p=>{c=p})}).next(()=>a.Ms.getDocumentsMatchingQuery(d,e,t?o:je.min(),t?c:Ye())).next(f=>(wM(a,mD(e),f),{documents:f,$s:c})))}function wM(n,e,t){let a=n.Ns.get(e)||je.min();t.forEach((o,c)=>{c.readTime.compareTo(a)>0&&(a=c.readTime)}),n.Ns.set(e,a)}class kN{constructor(){this.activeTargetIds=_D()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class CM{constructor(){this.xo=new kN,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,a){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new kN,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN="ConnectivityMonitor";class LN{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){ve(PN,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){ve(PN,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let th=null;function bg(){return th===null?th=function(){return 268435456+Math.round(2147483648*Math.random())}():th++,"0x"+th.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp="RestConnection",IM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class RM{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${a}/databases/${o}`,this.Go=this.databaseId.database===jh?`project_id=${a}`:`project_id=${a}&database_id=${o}`}zo(e,t,a,o,c){const d=bg(),f=this.jo(e,t.toUriEncodedString());ve(Vp,`Sending RPC '${e}' ${d}:`,f,a);const p={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(p,o,c);const{host:g}=new URL(f),y=Lr(g);return this.Jo(e,f,p,a,y).then(_=>(ve(Vp,`Received RPC '${e}' ${d}: `,_),_),_=>{throw Zo(Vp,`RPC '${e}' ${d} failed with error: `,_,"url: ",f,"request:",a),_})}Yo(e,t,a,o,c,d){return this.zo(e,t,a,o,c)}Ho(e,t,a){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ul}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,c)=>e[c]=o),a&&a.headers.forEach((o,c)=>e[c]=o)}jo(e,t){const a=IM[e];return`${this.Ko}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hn="WebChannelConnection";class MM extends RM{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,o,c){const d=bg();return new Promise((f,p)=>{const g=new FT;g.setWithCredentials(!0),g.listenOnce(qT.COMPLETE,()=>{try{switch(g.getLastErrorCode()){case ch.NO_ERROR:const _=g.getResponseJson();ve(hn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(_)),f(_);break;case ch.TIMEOUT:ve(hn,`RPC '${e}' ${d} timed out`),p(new ge(ie.DEADLINE_EXCEEDED,"Request time out"));break;case ch.HTTP_ERROR:const N=g.getStatus();if(ve(hn,`RPC '${e}' ${d} failed with status:`,N,"response text:",g.getResponseText()),N>0){let j=g.getResponseJson();Array.isArray(j)&&(j=j[0]);const x=j?.error;if(x&&x.status&&x.message){const R=function(O){const q=O.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(q)>=0?q:ie.UNKNOWN}(x.status);p(new ge(R,x.message))}else p(new ge(ie.UNKNOWN,"Server responded with status "+g.getStatus()))}else p(new ge(ie.UNAVAILABLE,"Connection failed."));break;default:Ne(9055,{h_:e,streamId:d,P_:g.getLastErrorCode(),T_:g.getLastError()})}}finally{ve(hn,`RPC '${e}' ${d} completed.`)}});const y=JSON.stringify(o);ve(hn,`RPC '${e}' ${d} sending request:`,o),g.send(t,"POST",y,a,15)})}I_(e,t,a){const o=bg(),c=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=HT(),f=zT(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Ho(p.initMessageHeaders,t,a),p.encodeInitMessageHeaders=!0;const y=c.join("");ve(hn,`Creating RPC '${e}' stream ${o}: ${y}`,p);const _=d.createWebChannel(y,p);this.E_(_);let N=!1,j=!1;const x=new DM({Zo:A=>{j?ve(hn,`Not sending because RPC '${e}' stream ${o} is closed:`,A):(N||(ve(hn,`Opening RPC '${e}' stream ${o} transport.`),_.open(),N=!0),ve(hn,`RPC '${e}' stream ${o} sending:`,A),_.send(A))},Xo:()=>_.close()}),R=(A,O,q)=>{A.listen(O,U=>{try{q(U)}catch(P){setTimeout(()=>{throw P},0)}})};return R(_,Ic.EventType.OPEN,()=>{j||(ve(hn,`RPC '${e}' stream ${o} transport opened.`),x.__())}),R(_,Ic.EventType.CLOSE,()=>{j||(j=!0,ve(hn,`RPC '${e}' stream ${o} transport closed`),x.u_(),this.d_(_))}),R(_,Ic.EventType.ERROR,A=>{j||(j=!0,Zo(hn,`RPC '${e}' stream ${o} transport errored. Name:`,A.name,"Message:",A.message),x.u_(new ge(ie.UNAVAILABLE,"The operation could not be completed")))}),R(_,Ic.EventType.MESSAGE,A=>{var O;if(!j){const q=A.data[0];Ze(!!q,16349);const U=q,P=U?.error||((O=U[0])===null||O===void 0?void 0:O.error);if(P){ve(hn,`RPC '${e}' stream ${o} received error:`,P);const F=P.status;let $=function(L){const M=Ot[L];if(M!==void 0)return j0(M)}(F),V=P.message;$===void 0&&($=ie.INTERNAL,V="Unknown error status: "+F+" with message "+P.message),j=!0,x.u_(new ge($,V)),_.close()}else ve(hn,`RPC '${e}' stream ${o} received:`,q),x.c_(q)}}),R(f,BT.STAT_EVENT,A=>{A.stat===lg.PROXY?ve(hn,`RPC '${e}' stream ${o} detected buffering proxy`):A.stat===lg.NOPROXY&&ve(hn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{x.a_()},0),x}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function Up(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(n){return new LD(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,t,a=1e3,o=1.5,c=6e4){this.xi=e,this.timerId=t,this.A_=a,this.R_=o,this.V_=c,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),a=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-a);o>0&&ve("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN="PersistentStream";class q0{constructor(e,t,a,o,c,d,f,p){this.xi=e,this.S_=a,this.D_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new ov(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(Ma(t.toString()),Ma("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,o])=>{this.v_===t&&this.z_(a,o)},a=>{e(()=>{const o=new ge(ie.UNKNOWN,"Fetching auth token failed: "+a.message);return this.j_(o)})})}z_(e,t){const a=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{a(()=>this.listener.e_())}),this.stream.n_(()=>{a(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{a(()=>this.j_(o))}),this.stream.onMessage(o=>{a(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return ve(VN,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(ve(VN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class OM extends q0{constructor(e,t,a,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=qD(this.serializer,e),a=function(c){if(!("targetChange"in c))return je.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?je.min():d.readTime?Hn(d.readTime):je.min()}(e);return this.listener.Y_(t,a)}Z_(e){const t={};t.database=vg(this.serializer),t.addTarget=function(c,d){let f;const p=d.target;if(f=fg(p)?{documents:zD(c,p)}:{query:HD(c,p).gt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=S0(c,d.resumeToken);const g=pg(c,d.expectedCount);g!==null&&(f.expectedCount=g)}else if(d.snapshotVersion.compareTo(je.min())>0){f.readTime=Rh(c,d.snapshotVersion.toTimestamp());const g=pg(c,d.expectedCount);g!==null&&(f.expectedCount=g)}return f}(this.serializer,e);const a=$D(this.serializer,e);a&&(t.labels=a),this.Q_(t)}X_(e){const t={};t.database=vg(this.serializer),t.removeTarget=e,this.Q_(t)}}class kM extends q0{constructor(e,t,a,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=BD(e.writeResults,e.commitTime),a=Hn(e.commitTime);return this.listener.ra(a,t)}ia(){const e={};e.database=vg(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(a=>M0(this.serializer,a))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{}class LM extends PM{constructor(e,t,a,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new ge(ie.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,a,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.zo(e,gg(t,a),o,c,d)).catch(c=>{throw c.name==="FirebaseError"?(c.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new ge(ie.UNKNOWN,c.toString())})}Yo(e,t,a,o,c){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,f])=>this.connection.Yo(e,gg(t,a),o,d,f,c)).catch(d=>{throw d.name==="FirebaseError"?(d.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new ge(ie.UNKNOWN,d.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class VM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Ma(t),this.ua=!1):ve("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="RemoteStore";class UM{constructor(e,t,a,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=c,this.Ra.No(d=>{a.enqueueAndForget(async()=>{Fr(this)&&(ve(Mr,"Restarting streams for network reachability change."),await async function(p){const g=Re(p);g.da.add(4),await vu(g),g.Va.set("Unknown"),g.da.delete(4),await of(g)}(this))})}),this.Va=new VM(a,o)}}async function of(n){if(Fr(n))for(const e of n.Aa)await e(!0)}async function vu(n){for(const e of n.Aa)await e(!1)}function B0(n,e){const t=Re(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),dv(t)?uv(t):ml(t).N_()&&cv(t,e))}function lv(n,e){const t=Re(n),a=ml(t);t.Ea.delete(e),a.N_()&&z0(t,e),t.Ea.size===0&&(a.N_()?a.k_():Fr(t)&&t.Va.set("Unknown"))}function cv(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(je.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ml(n).Z_(e)}function z0(n,e){n.ma.Ke(e),ml(n).X_(e)}function uv(n){n.ma=new MD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),ml(n).start(),n.Va.ca()}function dv(n){return Fr(n)&&!ml(n).O_()&&n.Ea.size>0}function Fr(n){return Re(n).da.size===0}function H0(n){n.ma=void 0}async function FM(n){n.Va.set("Online")}async function qM(n){n.Ea.forEach((e,t)=>{cv(n,e)})}async function BM(n,e){H0(n),dv(n)?(n.Va.Pa(e),uv(n)):n.Va.set("Unknown")}async function zM(n,e,t){if(n.Va.set("Online"),e instanceof C0&&e.state===2&&e.cause)try{await async function(o,c){const d=c.cause;for(const f of c.targetIds)o.Ea.has(f)&&(await o.remoteSyncer.rejectListen(f,d),o.Ea.delete(f),o.ma.removeTarget(f))}(n,e)}catch(a){ve(Mr,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await Oh(n,a)}else if(e instanceof fh?n.ma.Xe(e):e instanceof w0?n.ma.ot(e):n.ma.nt(e),!t.isEqual(je.min()))try{const a=await F0(n.localStore);t.compareTo(a)>=0&&await function(c,d){const f=c.ma.It(d);return f.targetChanges.forEach((p,g)=>{if(p.resumeToken.approximateByteSize()>0){const y=c.Ea.get(g);y&&c.Ea.set(g,y.withResumeToken(p.resumeToken,d))}}),f.targetMismatches.forEach((p,g)=>{const y=c.Ea.get(p);if(!y)return;c.Ea.set(p,y.withResumeToken(ln.EMPTY_BYTE_STRING,y.snapshotVersion)),z0(c,p);const _=new yi(y.target,p,g,y.sequenceNumber);cv(c,_)}),c.remoteSyncer.applyRemoteEvent(f)}(n,t)}catch(a){ve(Mr,"Failed to raise snapshot:",a),await Oh(n,a)}}async function Oh(n,e,t){if(!hl(e))throw e;n.da.add(1),await vu(n),n.Va.set("Offline"),t||(t=()=>F0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ve(Mr,"Retrying IndexedDB access"),await t(),n.da.delete(1),await of(n)})}function G0(n,e){return e().catch(t=>Oh(n,t,e))}async function lf(n){const e=Re(n),t=Si(e);let a=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Qg;for(;HM(e);)try{const o=await AM(e.localStore,a);if(o===null){e.Ia.length===0&&t.k_();break}a=o.batchId,GM(e,o)}catch(o){await Oh(e,o)}$0(e)&&Y0(e)}function HM(n){return Fr(n)&&n.Ia.length<10}function GM(n,e){n.Ia.push(e);const t=Si(n);t.N_()&&t.ea&&t.ta(e.mutations)}function $0(n){return Fr(n)&&!Si(n).O_()&&n.Ia.length>0}function Y0(n){Si(n).start()}async function $M(n){Si(n).ia()}async function YM(n){const e=Si(n);for(const t of n.Ia)e.ta(t.mutations)}async function QM(n,e,t){const a=n.Ia.shift(),o=ev.from(a,e,t);await G0(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await lf(n)}async function KM(n,e){e&&Si(n).ea&&await async function(a,o){if(function(d){return A0(d)&&d!==ie.ABORTED}(o.code)){const c=a.Ia.shift();Si(a).L_(),await G0(a,()=>a.remoteSyncer.rejectFailedWrite(c.batchId,o)),await lf(a)}}(n,e),$0(n)&&Y0(n)}async function UN(n,e){const t=Re(n);t.asyncQueue.verifyOperationInProgress(),ve(Mr,"RemoteStore received new credentials");const a=Fr(t);t.da.add(3),await vu(t),a&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await of(t)}async function XM(n,e){const t=Re(n);e?(t.da.delete(2),await of(t)):e||(t.da.add(2),await vu(t),t.Va.set("Unknown"))}function ml(n){return n.fa||(n.fa=function(t,a,o){const c=Re(t);return c.oa(),new OM(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:FM.bind(null,n),n_:qM.bind(null,n),i_:BM.bind(null,n),Y_:zM.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),dv(n)?uv(n):n.Va.set("Unknown")):(await n.fa.stop(),H0(n))})),n.fa}function Si(n){return n.ga||(n.ga=function(t,a,o){const c=Re(t);return c.oa(),new kM(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:$M.bind(null,n),i_:KM.bind(null,n),na:YM.bind(null,n),ra:QM.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await lf(n)):(await n.ga.stop(),n.Ia.length>0&&(ve(Mr,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e,t,a,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=o,this.removalCallback=c,this.deferred=new Qs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,o,c){const d=Date.now()+a,f=new hv(e,t,d,o,c);return f.start(a),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ge(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fv(n,e){if(Ma("AsyncQueue",`${e}: ${n}`),hl(n))return new ge(ie.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{static emptySet(e){return new Ko(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||_e.comparator(t.key,a.key):(t,a)=>_e.comparator(t.key,a.key),this.keyedMap=Rc(),this.sortedSet=new Nt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,a)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ko)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new Ko;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(){this.pa=new Nt(_e.comparator)}track(e){const t=e.doc.key,a=this.pa.get(t);a?e.type!==0&&a.type===3?this.pa=this.pa.insert(t,e):e.type===3&&a.type!==1?this.pa=this.pa.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.pa=this.pa.remove(t):e.type===1&&a.type===2?this.pa=this.pa.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Ne(63341,{Vt:e,ya:a}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,a)=>{e.push(a)}),e}}class sl{constructor(e,t,a,o,c,d,f,p,g){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=g}static fromInitialDocuments(e,t,a,o,c){const d=[];return t.forEach(f=>{d.push({type:0,doc:f})}),new sl(e,t,Ko.emptySet(t),d,a,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==a[o].type||!t[o].doc.isEqual(a[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WM{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class ZM{constructor(){this.queries=qN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const o=Re(t),c=o.queries;o.queries=qN(),c.forEach((d,f)=>{for(const p of f.Sa)p.onError(a)})})(this,new ge(ie.ABORTED,"Firestore shutting down"))}}function qN(){return new Ur(n=>h0(n),Jh)}async function mv(n,e){const t=Re(n);let a=3;const o=e.query;let c=t.queries.get(o);c?!c.Da()&&e.va()&&(a=2):(c=new WM,a=e.va()?0:1);try{switch(a){case 0:c.ba=await t.onListen(o,!0);break;case 1:c.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const f=fv(d,`Initialization of query '${Uo(e.query)}' failed`);return void e.onError(f)}t.queries.set(o,c),c.Sa.push(e),e.Fa(t.onlineState),c.ba&&e.Ma(c.ba)&&gv(t)}async function pv(n,e){const t=Re(n),a=e.query;let o=3;const c=t.queries.get(a);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.va()?0:1:!c.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function JM(n,e){const t=Re(n);let a=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const f of d.Sa)f.Ma(o)&&(a=!0);d.ba=o}}a&&gv(t)}function eO(n,e,t){const a=Re(n),o=a.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);a.queries.delete(e)}function gv(n){n.Ca.forEach(e=>{e.next()})}var _g,BN;(BN=_g||(_g={})).xa="default",BN.Cache="cache";class vv{constructor(e,t,a){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=a||{}}Ma(e){if(!this.options.includeMetadataChanges){const a=[];for(const o of e.docChanges)o.type!==3&&a.push(o);e=new sl(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const a=t!=="Offline";return(!this.options.Qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=sl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==_g.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e){this.key=e}}class K0{constructor(e){this.key=e}}class tO{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ye(),this.mutatedKeys=Ye(),this.Za=f0(e),this.Xa=new Ko(this.Za)}get eu(){return this.Ha}tu(e,t){const a=t?t.nu:new FN,o=t?t.Xa:this.Xa;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,f=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((y,_)=>{const N=o.get(y),j=ef(this.query,_)?_:null,x=!!N&&this.mutatedKeys.has(N.key),R=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let A=!1;N&&j?N.data.isEqual(j.data)?x!==R&&(a.track({type:3,doc:j}),A=!0):this.ru(N,j)||(a.track({type:2,doc:j}),A=!0,(p&&this.Za(j,p)>0||g&&this.Za(j,g)<0)&&(f=!0)):!N&&j?(a.track({type:0,doc:j}),A=!0):N&&!j&&(a.track({type:1,doc:N}),A=!0,(p||g)&&(f=!0)),A&&(j?(d=d.add(j),c=R?c.add(y):c.delete(y)):(d=d.delete(y),c=c.delete(y)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const y=this.query.limitType==="F"?d.last():d.first();d=d.delete(y.key),c=c.delete(y.key),a.track({type:1,doc:y})}return{Xa:d,nu:a,Cs:f,mutatedKeys:c}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,o){const c=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const d=e.nu.wa();d.sort((y,_)=>function(j,x){const R=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ne(20277,{Vt:A})}};return R(j)-R(x)}(y.type,_.type)||this.Za(y.doc,_.doc)),this.iu(a),o=o!=null&&o;const f=t&&!o?this.su():[],p=this.Ya.size===0&&this.current&&!o?1:0,g=p!==this.Ja;return this.Ja=p,d.length!==0||g?{snapshot:new sl(this.query,e.Xa,c,d,e.mutatedKeys,p===0,g,!1,!!a&&a.resumeToken.approximateByteSize()>0),ou:f}:{ou:f}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new FN,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Ye(),this.Xa.forEach(a=>{this._u(a.key)&&(this.Ya=this.Ya.add(a.key))});const t=[];return e.forEach(a=>{this.Ya.has(a)||t.push(new K0(a))}),this.Ya.forEach(a=>{e.has(a)||t.push(new Q0(a))}),t}au(e){this.Ha=e.$s,this.Ya=Ye();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return sl.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const yv="SyncEngine";class nO{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class sO{constructor(e){this.key=e,this.cu=!1}}class aO{constructor(e,t,a,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.lu={},this.hu=new Ur(f=>h0(f),Jh),this.Pu=new Map,this.Tu=new Set,this.Iu=new Nt(_e.comparator),this.Eu=new Map,this.du=new sv,this.Au={},this.Ru=new Map,this.Vu=nl.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function iO(n,e,t=!0){const a=tA(n);let o;const c=a.hu.get(e);return c?(a.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.uu()):o=await X0(a,e,t,!0),o}async function rO(n,e){const t=tA(n);await X0(t,e,!0,!1)}async function X0(n,e,t,a){const o=await jM(n.localStore,Ks(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let f;return a&&(f=await oO(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&B0(n.remoteStore,o),f}async function oO(n,e,t,a,o){n.fu=(_,N,j)=>async function(R,A,O,q){let U=A.view.tu(O);U.Cs&&(U=await ON(R.localStore,A.query,!1).then(({documents:V})=>A.view.tu(V,U)));const P=q&&q.targetChanges.get(A.targetId),F=q&&q.targetMismatches.get(A.targetId)!=null,$=A.view.applyChanges(U,R.isPrimaryClient,P,F);return HN(R,A.targetId,$.ou),$.snapshot}(n,_,N,j);const c=await ON(n.localStore,e,!0),d=new tO(e,c.$s),f=d.tu(c.documents),p=gu.createSynthesizedTargetChangeForCurrentChange(t,a&&n.onlineState!=="Offline",o),g=d.applyChanges(f,n.isPrimaryClient,p);HN(n,t,g.ou);const y=new nO(e,t,d);return n.hu.set(e,y),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),g.snapshot}async function lO(n,e,t){const a=Re(n),o=a.hu.get(e),c=a.Pu.get(o.targetId);if(c.length>1)return a.Pu.set(o.targetId,c.filter(d=>!Jh(d,e))),void a.hu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(o.targetId),a.sharedClientState.isActiveQueryTarget(o.targetId)||await yg(a.localStore,o.targetId,!1).then(()=>{a.sharedClientState.clearQueryState(o.targetId),t&&lv(a.remoteStore,o.targetId),xg(a,o.targetId)}).catch(dl)):(xg(a,o.targetId),await yg(a.localStore,o.targetId,!0))}async function cO(n,e){const t=Re(n),a=t.hu.get(e),o=t.Pu.get(a.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),lv(t.remoteStore,a.targetId))}async function uO(n,e,t){const a=vO(n);try{const o=await function(d,f){const p=Re(d),g=qt.now(),y=f.reduce((j,x)=>j.add(x.key),Ye());let _,N;return p.persistence.runTransaction("Locally write mutations","readwrite",j=>{let x=Oa(),R=Ye();return p.Bs.getEntries(j,y).next(A=>{x=A,x.forEach((O,q)=>{q.isValidDocument()||(R=R.add(O))})}).next(()=>p.localDocuments.getOverlayedDocuments(j,x)).next(A=>{_=A;const O=[];for(const q of f){const U=CD(q,_.get(q.key).overlayedDocument);U!=null&&O.push(new Ui(q.key,U,a0(U.value.mapValue),rn.exists(!0)))}return p.mutationQueue.addMutationBatch(j,g,O,f)}).next(A=>{N=A;const O=A.applyToLocalDocumentSet(_,R);return p.documentOverlayCache.saveOverlays(j,A.batchId,O)})}).then(()=>({batchId:N.batchId,changes:p0(_)}))}(a.localStore,e);a.sharedClientState.addPendingMutation(o.batchId),function(d,f,p){let g=d.Au[d.currentUser.toKey()];g||(g=new Nt(qe)),g=g.insert(f,p),d.Au[d.currentUser.toKey()]=g}(a,o.batchId,t),await yu(a,o.changes),await lf(a.remoteStore)}catch(o){const c=fv(o,"Failed to persist write");t.reject(c)}}async function W0(n,e){const t=Re(n);try{const a=await EM(t.localStore,e);e.targetChanges.forEach((o,c)=>{const d=t.Eu.get(c);d&&(Ze(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.cu=!0:o.modifiedDocuments.size>0?Ze(d.cu,14607):o.removedDocuments.size>0&&(Ze(d.cu,42227),d.cu=!1))}),await yu(t,a,e)}catch(a){await dl(a)}}function zN(n,e,t){const a=Re(n);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const o=[];a.hu.forEach((c,d)=>{const f=d.view.Fa(e);f.snapshot&&o.push(f.snapshot)}),function(d,f){const p=Re(d);p.onlineState=f;let g=!1;p.queries.forEach((y,_)=>{for(const N of _.Sa)N.Fa(f)&&(g=!0)}),g&&gv(p)}(a.eventManager,e),o.length&&a.lu.Y_(o),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function dO(n,e,t){const a=Re(n);a.sharedClientState.updateQueryState(e,"rejected",t);const o=a.Eu.get(e),c=o&&o.key;if(c){let d=new Nt(_e.comparator);d=d.insert(c,Wt.newNoDocument(c,je.min()));const f=Ye().add(c),p=new af(je.min(),new Map,new Nt(qe),d,f);await W0(a,p),a.Iu=a.Iu.remove(c),a.Eu.delete(e),bv(a)}else await yg(a.localStore,e,!1).then(()=>xg(a,e,t)).catch(dl)}async function hO(n,e){const t=Re(n),a=e.batch.batchId;try{const o=await NM(t.localStore,e);J0(t,a,null),Z0(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await yu(t,o)}catch(o){await dl(o)}}async function fO(n,e,t){const a=Re(n);try{const o=await function(d,f){const p=Re(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let y;return p.mutationQueue.lookupMutationBatch(g,f).next(_=>(Ze(_!==null,37113),y=_.keys(),p.mutationQueue.removeMutationBatch(g,_))).next(()=>p.mutationQueue.performConsistencyCheck(g)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(g,y,f)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,y)).next(()=>p.localDocuments.getDocuments(g,y))})}(a.localStore,e);J0(a,e,t),Z0(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await yu(a,o)}catch(o){await dl(o)}}function Z0(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function J0(n,e,t){const a=Re(n);let o=a.Au[a.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),a.Au[a.currentUser.toKey()]=o}}function xg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const a of n.Pu.get(e))n.hu.delete(a),t&&n.lu.gu(a,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(a=>{n.du.containsKey(a)||eA(n,a)})}function eA(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(lv(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),bv(n))}function HN(n,e,t){for(const a of t)a instanceof Q0?(n.du.addReference(a.key,e),mO(n,a)):a instanceof K0?(ve(yv,"Document no longer in limbo: "+a.key),n.du.removeReference(a.key,e),n.du.containsKey(a.key)||eA(n,a.key)):Ne(19791,{pu:a})}function mO(n,e){const t=e.key,a=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(a)||(ve(yv,"New document in limbo: "+t),n.Tu.add(a),bv(n))}function bv(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new _e(ht.fromString(e)),a=n.Vu.next();n.Eu.set(a,new sO(t)),n.Iu=n.Iu.insert(t,a),B0(n.remoteStore,new yi(Ks(Zh(t.path)),a,"TargetPurposeLimboResolution",Xh.le))}}async function yu(n,e,t){const a=Re(n),o=[],c=[],d=[];a.hu.isEmpty()||(a.hu.forEach((f,p)=>{d.push(a.fu(p,e,t).then(g=>{var y;if((g||t)&&a.isPrimaryClient){const _=g?!g.fromCache:(y=t?.targetChanges.get(p.targetId))===null||y===void 0?void 0:y.current;a.sharedClientState.updateQueryState(p.targetId,_?"current":"not-current")}if(g){o.push(g);const _=iv.Rs(p.targetId,g);c.push(_)}}))}),await Promise.all(d),a.lu.Y_(o),await async function(p,g){const y=Re(p);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>oe.forEach(g,N=>oe.forEach(N.ds,j=>y.persistence.referenceDelegate.addReference(_,N.targetId,j)).next(()=>oe.forEach(N.As,j=>y.persistence.referenceDelegate.removeReference(_,N.targetId,j)))))}catch(_){if(!hl(_))throw _;ve(rv,"Failed to update sequence numbers: "+_)}for(const _ of g){const N=_.targetId;if(!_.fromCache){const j=y.xs.get(N),x=j.snapshotVersion,R=j.withLastLimboFreeSnapshotVersion(x);y.xs=y.xs.insert(N,R)}}}(a.localStore,c))}async function pO(n,e){const t=Re(n);if(!t.currentUser.isEqual(e)){ve(yv,"User change. New user:",e.toKey());const a=await U0(t.localStore,e);t.currentUser=e,function(c,d){c.Ru.forEach(f=>{f.forEach(p=>{p.reject(new ge(ie.CANCELLED,d))})}),c.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await yu(t,a.ks)}}function gO(n,e){const t=Re(n),a=t.Eu.get(e);if(a&&a.cu)return Ye().add(a.key);{let o=Ye();const c=t.Pu.get(e);if(!c)return o;for(const d of c){const f=t.hu.get(d);o=o.unionWith(f.view.eu)}return o}}function tA(n){const e=Re(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=W0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dO.bind(null,e),e.lu.Y_=JM.bind(null,e.eventManager),e.lu.gu=eO.bind(null,e.eventManager),e}function vO(n){const e=Re(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fO.bind(null,e),e}class kh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rf(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return xM(this.persistence,new yM,e.initialUser,this.serializer)}Su(e){return new V0(av.fi,this.serializer)}bu(e){return new CM}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}kh.provider={build:()=>new kh};class yO extends kh{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Ze(this.persistence.referenceDelegate instanceof Mh,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new sM(a,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?Sn.withCacheSize(this.cacheSizeBytes):Sn.DEFAULT;return new V0(a=>Mh.fi(a,t),this.serializer)}}class Ng{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>zN(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=pO.bind(null,this.syncEngine),await XM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ZM}()}createDatastore(e){const t=rf(e.databaseInfo.databaseId),a=function(c){return new MM(c)}(e.databaseInfo);return function(c,d,f,p){return new LM(c,d,f,p)}(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return function(a,o,c,d,f){return new UM(a,o,c,d,f)}(this.localStore,this.datastore,e.asyncQueue,t=>zN(this.syncEngine,t,0),function(){return LN.C()?new LN:new SM}())}createSyncEngine(e,t){return function(o,c,d,f,p,g,y){const _=new aO(o,c,d,f,p,g);return y&&(_.mu=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const c=Re(o);ve(Mr,"RemoteStore shutting down."),c.da.add(5),await vu(c),c.Ra.shutdown(),c.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Ng.provider={build:()=>new Ng};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Ma("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ge(ie.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,c){const d=Re(o),f={documents:c.map(_=>Dh(d.serializer,_))},p=await d.Yo("BatchGetDocuments",d.serializer.databaseId,ht.emptyPath(),f,c.length),g=new Map;p.forEach(_=>{const N=FD(d.serializer,_);g.set(N.key.toString(),N)});const y=[];return c.forEach(_=>{const N=g.get(_.toString());Ze(!!N,55234,{key:_}),y.push(N)}),y}(this.datastore,e);return t.forEach(a=>this.recordVersion(a)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(a){this.lastTransactionError=a}this.writtenDocs.add(e.toString())}delete(e){this.write(new sf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,a)=>{const o=_e.fromPath(a);this.mutations.push(new T0(o,this.precondition(o)))}),await async function(a,o){const c=Re(a),d={writes:o.map(f=>M0(c.serializer,f))};await c.zo("Commit",c.serializer.databaseId,ht.emptyPath(),d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ne(50498,{Uu:e.constructor.name});t=je.min()}const a=this.readVersions.get(e.key.toString());if(a){if(!t.isEqual(a))throw new ge(ie.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(je.min())?rn.exists(!1):rn.updateTime(t):rn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(je.min()))throw new ge(ie.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rn.updateTime(t)}return rn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e,t,a,o,c){this.asyncQueue=e,this.datastore=t,this.options=a,this.updateFunction=o,this.deferred=c,this.Ku=a.maxAttempts,this.x_=new ov(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new bO(this.datastore),t=this.zu(e);t&&t.then(a=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(a)}).catch(o=>{this.ju(o)}))}).catch(a=>{this.ju(a)})})}zu(e){try{const t=this.updateFunction(e);return!mu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!A0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii="FirestoreClient";class xO{constructor(e,t,a,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=o,this.user=fn.UNAUTHENTICATED,this.clientId=QT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(a,async d=>{ve(Ii,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(a,d=>(ve(Ii,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=fv(t,"Failed to shutdown persistence");e.reject(a)}}),e.promise}}async function Fp(n,e){n.asyncQueue.verifyOperationInProgress(),ve(Ii,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let a=t.initialUser;n.setCredentialChangeListener(async o=>{a.isEqual(o)||(await U0(e.localStore,o),a=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function GN(n,e){n.asyncQueue.verifyOperationInProgress();const t=await NO(n);ve(Ii,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(a=>UN(e.remoteStore,a)),n.setAppCheckTokenChangeListener((a,o)=>UN(e.remoteStore,o)),n._onlineComponents=e}async function NO(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ve(Ii,"Using user provided OfflineComponentProvider");try{await Fp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===ie.FAILED_PRECONDITION||o.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Zo("Error using user provided cache. Falling back to memory cache: "+t),await Fp(n,new kh)}}else ve(Ii,"Using default OfflineComponentProvider"),await Fp(n,new yO(void 0));return n._offlineComponents}async function xv(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ve(Ii,"Using user provided OnlineComponentProvider"),await GN(n,n._uninitializedComponentsProvider._online)):(ve(Ii,"Using default OnlineComponentProvider"),await GN(n,new Ng))),n._onlineComponents}function EO(n){return xv(n).then(e=>e.syncEngine)}function TO(n){return xv(n).then(e=>e.datastore)}async function Ph(n){const e=await xv(n),t=e.eventManager;return t.onListen=iO.bind(null,e.syncEngine),t.onUnlisten=lO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=rO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=cO.bind(null,e.syncEngine),t}function AO(n,e,t={}){const a=new Qs;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,g){const y=new _v({next:N=>{y.xu(),d.enqueueAndForget(()=>pv(c,_));const j=N.docs.has(f);!j&&N.fromCache?g.reject(new ge(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):j&&N.fromCache&&p&&p.source==="server"?g.reject(new ge(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(N)},error:N=>g.reject(N)}),_=new vv(Zh(f.path),y,{includeMetadataChanges:!0,Qa:!0});return mv(c,_)}(await Ph(n),n.asyncQueue,e,t,a)),a.promise}function jO(n,e,t={}){const a=new Qs;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,g){const y=new _v({next:N=>{y.xu(),d.enqueueAndForget(()=>pv(c,_)),N.fromCache&&p.source==="server"?g.reject(new ge(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(N)},error:N=>g.reject(N)}),_=new vv(f,y,{includeMetadataChanges:!0,Qa:!0});return mv(c,_)}(await Ph(n),n.asyncQueue,e,t,a)),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(n,e,t){if(!t)throw new ge(ie.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function wO(n,e,t,a){if(e===!0&&a===!0)throw new ge(ie.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function YN(n){if(!_e.isDocumentKey(n))throw new ge(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function QN(n){if(_e.isDocumentKey(n))throw new ge(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function cf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(a){return a.constructor?a.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ne(12329,{type:typeof n})}function Tn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ge(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=cf(n);throw new ge(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA="firestore.googleapis.com",KN=!0;class XN{constructor(e){var t,a;if(e.host===void 0){if(e.ssl!==void 0)throw new ge(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=aA,this.ssl=KN}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:KN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=L0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<tM)throw new ge(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}wO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nA((a=e.experimentalLongPollingOptions)!==null&&a!==void 0?a:{}),function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new ge(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new ge(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new ge(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(a,o){return a.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class uf{constructor(e,t,a,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new XN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ge(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ge(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new XN(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(a){if(!a)return new M1;switch(a.type){case"firstParty":return new L1(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new ge(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const a=$N.get(t);a&&(ve("ComponentProvider","Removing Datastore"),$N.delete(t),a.terminate())}(this),Promise.resolve()}}function CO(n,e,t,a={}){var o;n=Tn(n,uf);const c=Lr(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),p=`${e}:${t}`;c&&(Rg(`https://${p}`),Dg("Firestore",!0)),d.host!==aA&&d.host!==p&&Zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g=Object.assign(Object.assign({},d),{host:p,ssl:c,emulatorOptions:a});if(!Ti(g,f)&&(n._setSettings(g),a.mockUserToken)){let y,_;if(typeof a.mockUserToken=="string")y=a.mockUserToken,_=fn.MOCK_USER;else{y=JE(a.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const N=a.mockUserToken.sub||a.mockUserToken.user_id;if(!N)throw new ge(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new fn(N)}n._authCredentials=new O1(new $T(y,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Pa(this.firestore,e,this._query)}}class on{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ni(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new on(this.firestore,e,this._key)}}class Ni extends Pa{constructor(e,t,a){super(e,t,Zh(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new on(this.firestore,null,new _e(e))}withConverter(e){return new Ni(this.firestore,e,this._path)}}function Me(n,e,...t){if(n=yt(n),sA("collection","path",e),n instanceof uf){const a=ht.fromString(e,...t);return QN(a),new Ni(n,null,a)}{if(!(n instanceof on||n instanceof Ni))throw new ge(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ht.fromString(e,...t));return QN(a),new Ni(n.firestore,null,a)}}function Je(n,e,...t){if(n=yt(n),arguments.length===1&&(e=QT.newId()),sA("doc","path",e),n instanceof uf){const a=ht.fromString(e,...t);return YN(a),new on(n,null,new _e(a))}{if(!(n instanceof on||n instanceof Ni))throw new ge(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ht.fromString(e,...t));return YN(a),new on(n.firestore,n instanceof Ni?n.converter:null,new _e(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WN="AsyncQueue";class ZN{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new ov(this,"async_queue_retry"),this.rc=()=>{const a=Up();a&&ve(WN,"Visibility state changed to "+a.visibilityState),this.x_.b_()},this.sc=e;const t=Up();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Up();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Qs;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!hl(e))throw e;ve(WN,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(a=>{throw this.Xu=a,this.ec=!1,Ma("INTERNAL UNHANDLED ERROR: ",JN(a)),a}).then(a=>(this.ec=!1,a))));return this.sc=t,t}enqueueAfterDelay(e,t,a){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=hv.createAndSchedule(this,e,t,a,c=>this.uc(c));return this.Zu.push(o),o}oc(){this.Xu&&Ne(47125,{cc:JN(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,a)=>t.targetTimeMs-a.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function JN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eE(n){return function(t,a){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of a)if(c in o&&typeof o[c]=="function")return!0;return!1}(n,["next","error","complete"])}class Ws extends uf{constructor(e,t,a,o){super(e,t,a,o),this.type="firestore",this._queue=new ZN,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ZN(e),this._firestoreClient=void 0,await e}}}function SO(n,e){const t=typeof n=="object"?n:cu(),a=typeof n=="string"?n:jh,o=ka(t,"firestore").getImmediate({identifier:a});if(!o._initialized){const c=XE("firestore");c&&CO(o,...c)}return o}function bu(n){if(n._terminated)throw new ge(ie.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||IO(n),n._firestoreClient}function IO(n){var e,t,a;const o=n._freezeSettings(),c=function(f,p,g,y){return new Z1(f,p,g,y.host,y.ssl,y.experimentalForceLongPolling,y.experimentalAutoDetectLongPolling,nA(y.experimentalLongPollingOptions),y.useFetchStreams,y.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((a=o.localCache)===null||a===void 0)&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new xO(n._authCredentials,n._appCheckCredentials,n._queue,c,n._componentsProvider&&function(f){const p=f?._online.build();return{_offline:f?._offline.build(p),_online:p}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Or(ln.fromBase64String(e))}catch(t){throw new ge(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Or(ln.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ge(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new an(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ge(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ge(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(a,o){if(a.length!==o.length)return!1;for(let c=0;c<a.length;++c)if(a[c]!==o[c])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RO=/^__.*__$/;class DO{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new Ui(e,this.data,this.fieldMask,t,this.fieldTransforms):new pu(e,this.data,t,this.fieldTransforms)}}class iA{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return new Ui(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function rA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ne(40011,{Ic:n})}}class Tv{constructor(e,t,a,o,c,d){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=o,c===void 0&&this.Ec(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Tv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Vc(e),o}mc(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Lh(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(rA(this.Ic)&&RO.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class MO{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||rf(e)}bc(e,t,a,o=!1){return new Tv({Ic:e,methodName:t,wc:a,path:an.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xu(n){const e=n._freezeSettings(),t=rf(n._databaseId);return new MO(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Av(n,e,t,a,o,c={}){const d=n.bc(c.merge||c.mergeFields?2:0,e,t,o);wv("Data must be an object, but it was:",d,a);const f=cA(a,d);let p,g;if(c.merge)p=new Bn(d.fieldMask),g=d.fieldTransforms;else if(c.mergeFields){const y=[];for(const _ of c.mergeFields){const N=Eg(e,_,t);if(!d.contains(N))throw new ge(ie.INVALID_ARGUMENT,`Field '${N}' is specified in your field mask but missing from your input data.`);dA(y,N)||y.push(N)}p=new Bn(y),g=d.fieldTransforms.filter(_=>p.covers(_.field))}else p=null,g=d.fieldTransforms;return new DO(new En(f),p,g)}class hf extends df{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof hf}}class jv extends df{_toFieldTransform(e){return new TD(e.path,new eu)}isEqual(e){return e instanceof jv}}function oA(n,e,t,a){const o=n.bc(1,e,t);wv("Data must be an object, but it was:",o,a);const c=[],d=En.empty();Vi(a,(p,g)=>{const y=Cv(e,p,t);g=yt(g);const _=o.mc(y);if(g instanceof hf)c.push(y);else{const N=Nu(g,_);N!=null&&(c.push(y),d.set(y,N))}});const f=new Bn(c);return new iA(d,f,o.fieldTransforms)}function lA(n,e,t,a,o,c){const d=n.bc(1,e,t),f=[Eg(e,a,t)],p=[o];if(c.length%2!=0)throw new ge(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let N=0;N<c.length;N+=2)f.push(Eg(e,c[N])),p.push(c[N+1]);const g=[],y=En.empty();for(let N=f.length-1;N>=0;--N)if(!dA(g,f[N])){const j=f[N];let x=p[N];x=yt(x);const R=d.mc(j);if(x instanceof hf)g.push(j);else{const A=Nu(x,R);A!=null&&(g.push(j),y.set(j,A))}}const _=new Bn(g);return new iA(y,_,d.fieldTransforms)}function OO(n,e,t,a=!1){return Nu(t,n.bc(a?4:3,e))}function Nu(n,e){if(uA(n=yt(n)))return wv("Unsupported field value:",e,n),cA(n,e);if(n instanceof df)return function(a,o){if(!rA(o.Ic))throw o.gc(`${a._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${a._methodName}() is not currently supported inside arrays`);const c=a._toFieldTransform(o);c&&o.fieldTransforms.push(c)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(a,o){const c=[];let d=0;for(const f of a){let p=Nu(f,o.fc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}}(n,e)}return function(a,o){if((a=yt(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return xD(o.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const c=qt.fromDate(a);return{timestampValue:Rh(o.serializer,c)}}if(a instanceof qt){const c=new qt(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:Rh(o.serializer,c)}}if(a instanceof Nv)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof Or)return{bytesValue:S0(o.serializer,a._byteString)};if(a instanceof on){const c=o.databaseId,d=a.firestore._databaseId;if(!d.isEqual(c))throw o.gc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:nv(a.firestore._databaseId||o.databaseId,a._key.path)}}if(a instanceof Ev)return function(d,f){return{mapValue:{fields:{[n0]:{stringValue:s0},[wh]:{arrayValue:{values:d.toArray().map(g=>{if(typeof g!="number")throw f.gc("VectorValues must only contain numeric values.");return Jg(f.serializer,g)})}}}}}}(a,o);throw o.gc(`Unsupported field value: ${cf(a)}`)}(n,e)}function cA(n,e){const t={};return XT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vi(n,(a,o)=>{const c=Nu(o,e.Ac(a));c!=null&&(t[a]=c)}),{mapValue:{fields:t}}}function uA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qt||n instanceof Nv||n instanceof Or||n instanceof on||n instanceof df||n instanceof Ev)}function wv(n,e,t){if(!uA(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const a=cf(t);throw a==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+a)}}function Eg(n,e,t){if((e=yt(e))instanceof _u)return e._internalPath;if(typeof e=="string")return Cv(n,e);throw Lh("Field path arguments must be of type string or ",n,!1,void 0,t)}const kO=new RegExp("[~\\*/\\[\\]]");function Cv(n,e,t){if(e.search(kO)>=0)throw Lh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new _u(...e.split("."))._internalPath}catch{throw Lh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Lh(n,e,t,a,o){const c=a&&!a.isEmpty(),d=o!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${a}`),d&&(p+=` in document ${o}`),p+=")"),new ge(ie.INVALID_ARGUMENT,f+n+p)}function dA(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,t,a,o,c){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new on(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new PO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ff("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class PO extends Vh{data(){return super.data()}}function ff(n,e){return typeof e=="string"?Cv(n,e):e instanceof _u?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ge(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Sv{}class Iv extends Sv{}function Ee(n,e,...t){let a=[];e instanceof Sv&&a.push(e),a=a.concat(t),function(c){const d=c.filter(p=>p instanceof Rv).length,f=c.filter(p=>p instanceof mf).length;if(d>1||d>0&&f>0)throw new ge(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a);for(const o of a)n=o._apply(n);return n}class mf extends Iv{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new mf(e,t,a)}_apply(e){const t=this._parse(e);return fA(e._query,t),new Pa(e.firestore,e.converter,mg(e._query,t))}_parse(e){const t=xu(e.firestore);return function(c,d,f,p,g,y,_){let N;if(g.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new ge(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){nE(_,y);const x=[];for(const R of _)x.push(tE(p,c,R));N={arrayValue:{values:x}}}else N=tE(p,c,_)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||nE(_,y),N=OO(f,d,_,y==="in"||y==="not-in");return kt.create(g,y,N)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Se(n,e,t){const a=e,o=ff("where",n);return mf._create(o,a,t)}class Rv extends Sv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Rv(e,t)}_parse(e){const t=this._queryConstraints.map(a=>a._parse(e)).filter(a=>a.getFilters().length>0);return t.length===1?t[0]:Ts.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,c){let d=o;const f=c.getFlattenedFilters();for(const p of f)fA(d,p),d=mg(d,p)}(e._query,t),new Pa(e.firestore,e.converter,mg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Dv extends Iv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Dv(e,t)}_apply(e){const t=function(o,c,d){if(o.startAt!==null)throw new ge(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new ge(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jc(c,d)}(e._query,this._field,this._direction);return new Pa(e.firestore,e.converter,function(o,c){const d=o.explicitOrderBy.concat([c]);return new fl(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function An(n,e="asc"){const t=e,a=ff("orderBy",n);return Dv._create(a,t)}class Mv extends Iv{constructor(e,t,a){super(),this.type=e,this._limit=t,this._limitType=a}static _create(e,t,a){return new Mv(e,t,a)}_apply(e){return new Pa(e.firestore,e.converter,Sh(e._query,this._limit,this._limitType))}}function LO(n){return Mv._create("limit",n,"F")}function tE(n,e,t){if(typeof(t=yt(t))=="string"){if(t==="")throw new ge(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!d0(e)&&t.indexOf("/")!==-1)throw new ge(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(ht.fromString(t));if(!_e.isDocumentKey(a))throw new ge(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return pN(n,new _e(a))}if(t instanceof on)return pN(n,t._key);throw new ge(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cf(t)}.`)}function nE(n,e){if(!Array.isArray(n)||n.length===0)throw new ge(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function fA(n,e){const t=function(o,c){for(const d of o)for(const f of d.getFlattenedFilters())if(c.indexOf(f.op)>=0)return f.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ge(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ge(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class mA{convertValue(e,t="none"){switch(Ci(e)){case 0:return null;case 1:return e.booleanValue;case 2:return St(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(wi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ne(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return Vi(e,(o,c)=>{a[o]=this.convertValue(c,t)}),a}convertVectorValue(e){var t,a,o;const c=(o=(a=(t=e.fields)===null||t===void 0?void 0:t[wh].arrayValue)===null||a===void 0?void 0:a.values)===null||o===void 0?void 0:o.map(d=>St(d.doubleValue));return new Ev(c)}convertGeoPoint(e){return new Nv(St(e.latitude),St(e.longitude))}convertArray(e,t){return(e.values||[]).map(a=>this.convertValue(a,t))}convertServerTimestamp(e,t){switch(t){case"previous":const a=Wh(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp(Xc(e));default:return null}}convertTimestamp(e){const t=ji(e);return new qt(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=ht.fromString(e);Ze(P0(a),9688,{name:e});const o=new Wc(a.get(1),a.get(3)),c=new _e(a.popFirst(5));return o.isEqual(t)||Ma(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ov(n,e,t){let a;return a=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,a}class VO extends mA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Or(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class kv extends Vh{constructor(e,t,a,o,c,d){super(e,t,a,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new mh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(ff("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}}class mh extends kv{data(e={}){return super.data(e)}}class pA{constructor(e,t,a,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Bo(o.hasPendingWrites,o.fromCache),this.query=a}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(a=>{e.call(t,new mh(this._firestore,this._userDataWriter,a.key,a,new Bo(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ge(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map(f=>{const p=new mh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Bo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}})}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(f=>c||f.type!==3).map(f=>{const p=new mh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Bo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,y=-1;return f.type!==0&&(g=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),y=d.indexOf(f.doc.key)),{type:UO(f.type),doc:p,oldIndex:g,newIndex:y}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function UO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ne(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(n){n=Tn(n,on);const e=Tn(n.firestore,Ws);return AO(bu(e),n._key).then(t=>gA(e,n,t))}class pf extends mA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Or(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}function ft(n){n=Tn(n,Pa);const e=Tn(n.firestore,Ws),t=bu(e),a=new pf(e);return hA(n._query),jO(t,n._query).then(o=>new pA(e,a,n,o))}function gf(n,e,t){n=Tn(n,on);const a=Tn(n.firestore,Ws),o=Ov(n.converter,e,t);return yf(a,[Av(xu(a),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,rn.none())])}function As(n,e,t,...a){n=Tn(n,on);const o=Tn(n.firestore,Ws),c=xu(o);let d;return d=typeof(e=yt(e))=="string"||e instanceof _u?lA(c,"updateDoc",n._key,e,t,a):oA(c,"updateDoc",n._key,e),yf(o,[d.toMutation(n._key,rn.exists(!0))])}function vf(n){return yf(Tn(n.firestore,Ws),[new sf(n._key,rn.none())])}function pl(n,e){const t=Tn(n.firestore,Ws),a=Je(n),o=Ov(n.converter,e);return yf(t,[Av(xu(n.firestore),"addDoc",a._key,o,n.converter!==null,{}).toMutation(a._key,rn.exists(!1))]).then(()=>a)}function qr(n,...e){var t,a,o;n=yt(n);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||eE(e[d])||(c=e[d],d++);const f={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(eE(e[d])){const _=e[d];e[d]=(t=_.next)===null||t===void 0?void 0:t.bind(_),e[d+1]=(a=_.error)===null||a===void 0?void 0:a.bind(_),e[d+2]=(o=_.complete)===null||o===void 0?void 0:o.bind(_)}let p,g,y;if(n instanceof on)g=Tn(n.firestore,Ws),y=Zh(n._key.path),p={next:_=>{e[d]&&e[d](gA(g,n,_))},error:e[d+1],complete:e[d+2]};else{const _=Tn(n,Pa);g=Tn(_.firestore,Ws),y=_._query;const N=new pf(g);p={next:j=>{e[d]&&e[d](new pA(g,N,_,j))},error:e[d+1],complete:e[d+2]},hA(n._query)}return function(N,j,x,R){const A=new _v(R),O=new vv(j,A,x);return N.asyncQueue.enqueueAndForget(async()=>mv(await Ph(N),O)),()=>{A.xu(),N.asyncQueue.enqueueAndForget(async()=>pv(await Ph(N),O))}}(bu(g),y,f,p)}function yf(n,e){return function(a,o){const c=new Qs;return a.asyncQueue.enqueueAndForget(async()=>uO(await EO(a),o,c)),c.promise}(bu(n),e)}function gA(n,e,t){const a=t.docs.get(e._key),o=new pf(n);return new kv(n,o,e._key,a,new Bo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FO={maxAttempts:5};function Mc(n,e){if((n=yt(n)).firestore!==e)throw new ge(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=xu(e)}get(e){const t=Mc(e,this._firestore),a=new VO(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return Ne(24041);const c=o[0];if(c.isFoundDocument())return new Vh(this._firestore,a,c.key,c,t.converter);if(c.isNoDocument())return new Vh(this._firestore,a,t._key,null,t.converter);throw Ne(18433,{doc:c})})}set(e,t,a){const o=Mc(e,this._firestore),c=Ov(o.converter,t,a),d=Av(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,a);return this._transaction.set(o._key,d),this}update(e,t,a,...o){const c=Mc(e,this._firestore);let d;return d=typeof(t=yt(t))=="string"||t instanceof _u?lA(this._dataReader,"Transaction.update",c._key,t,a,o):oA(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,d),this}delete(e){const t=Mc(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO extends qO{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Mc(e,this._firestore),a=new pf(this._firestore);return super.get(e).then(o=>new kv(this._firestore,a,t._key,o._document,new Bo(!1,!1),t.converter))}}function Pv(n,e,t){n=Tn(n,Ws);const a=Object.assign(Object.assign({},FO),t);return function(c){if(c.maxAttempts<1)throw new ge(ie.INVALID_ARGUMENT,"Max attempts must be at least 1")}(a),function(c,d,f){const p=new Qs;return c.asyncQueue.enqueueAndForget(async()=>{const g=await TO(c);new _O(c.asyncQueue,g,f,d,p).Wu()}),p.promise}(bu(n),o=>e(new BO(n,o)),a)}function Ue(){return new jv("serverTimestamp")}(function(e,t=!0){(function(o){ul=o})(Vr),ls(new $n("firestore",(a,{instanceIdentifier:o,options:c})=>{const d=a.getProvider("app").getImmediate(),f=new Ws(new k1(a.getProvider("auth-internal")),new V1(d,a.getProvider("app-check-internal")),function(g,y){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new ge(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wc(g.options.projectId,y)}(d,o),d);return c=Object.assign({useFetchStreams:t},c),f._setSettings(c),f},"PUBLIC").setMultipleInstances(!0)),pn(sN,aN,e),pn(sN,aN,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA="firebasestorage.googleapis.com",zO="storageBucket",HO=2*60*1e3,GO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js extends us{constructor(e,t,a=0){super(qp(e),`Firebase Storage: ${t} (${qp(e)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Js.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Zs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Zs||(Zs={}));function qp(n){return"storage/"+n}function $O(){const n="An unknown error occurred, please check the error payload for server response.";return new Js(Zs.UNKNOWN,n)}function YO(){return new Js(Zs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function QO(){return new Js(Zs.CANCELED,"User canceled the upload/download.")}function KO(n){return new Js(Zs.INVALID_URL,"Invalid URL '"+n+"'.")}function XO(n){return new Js(Zs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function sE(n){return new Js(Zs.INVALID_ARGUMENT,n)}function yA(){return new Js(Zs.APP_DELETED,"The Firebase app was deleted.")}function WO(n){return new Js(Zs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let a;try{a=Ns.makeFromUrl(e,t)}catch{return new Ns(e,"")}if(a.path==="")return a;throw XO(e)}static makeFromUrl(e,t){let a=null;const o="([A-Za-z0-9.\\-_]+)";function c(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const d="(/(.*))?$",f=new RegExp("^gs://"+o+d,"i"),p={bucket:1,path:3};function g(P){P.path_=decodeURIComponent(P.path)}const y="v[A-Za-z0-9_]+",_=t.replace(/[.]/g,"\\."),N="(/([^?#]*).*)?$",j=new RegExp(`^https?://${_}/${y}/b/${o}/o${N}`,"i"),x={bucket:1,path:3},R=t===vA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",O=new RegExp(`^https?://${R}/${o}/${A}`,"i"),U=[{regex:f,indices:p,postModify:c},{regex:j,indices:x,postModify:g},{regex:O,indices:{bucket:1,path:2},postModify:g}];for(let P=0;P<U.length;P++){const F=U[P],$=F.regex.exec(e);if($){const V=$[F.indices.bucket];let S=$[F.indices.path];S||(S=""),a=new Ns(V,S),F.postModify(a);break}}if(a==null)throw KO(e);return a}}class ZO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JO(n,e,t){let a=1,o=null,c=null,d=!1,f=0;function p(){return f===2}let g=!1;function y(...A){g||(g=!0,e.apply(null,A))}function _(A){o=setTimeout(()=>{o=null,n(j,p())},A)}function N(){c&&clearTimeout(c)}function j(A,...O){if(g){N();return}if(A){N(),y.call(null,A,...O);return}if(p()||d){N(),y.call(null,A,...O);return}a<64&&(a*=2);let U;f===1?(f=2,U=0):U=(a+Math.random())*1e3,_(U)}let x=!1;function R(A){x||(x=!0,N(),!g&&(o!==null?(A||(f=2),clearTimeout(o),_(0)):A||(f=1)))}return _(0),c=setTimeout(()=>{d=!0,R(!0)},t),R}function ek(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tk(n){return n!==void 0}function aE(n,e,t,a){if(a<e)throw sE(`Invalid value for '${n}'. Expected ${e} or greater.`);if(a>t)throw sE(`Invalid value for '${n}'. Expected ${t} or less.`)}function nk(n){const e=encodeURIComponent;let t="?";for(const a in n)if(n.hasOwnProperty(a)){const o=e(a)+"="+e(n[a]);t=t+o+"&"}return t=t.slice(0,-1),t}var Uh;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Uh||(Uh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sk(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,t,a,o,c,d,f,p,g,y,_,N=!0,j=!1){this.url_=e,this.method_=t,this.headers_=a,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=f,this.errorCallback_=p,this.timeout_=g,this.progressCallback_=y,this.connectionFactory_=_,this.retry=N,this.isUsingEmulator=j,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,R)=>{this.resolve_=x,this.reject_=R,this.start_()})}start_(){const e=(a,o)=>{if(o){a(!1,new nh(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=f=>{const p=f.loaded,g=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,g)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const f=c.getErrorCode()===Uh.NO_ERROR,p=c.getStatus();if(!f||sk(p,this.additionalRetryCodes_)&&this.retry){const y=c.getErrorCode()===Uh.ABORT;a(!1,new nh(!1,null,y));return}const g=this.successCodes_.indexOf(p)!==-1;a(!0,new nh(g,c))})},t=(a,o)=>{const c=this.resolve_,d=this.reject_,f=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(f,f.getResponse());tk(p)?c(p):c()}catch(p){d(p)}else if(f!==null){const p=$O();p.serverResponse=f.getErrorText(),this.errorCallback_?d(this.errorCallback_(f,p)):d(p)}else if(o.canceled){const p=this.appDelete_?yA():QO();d(p)}else{const p=YO();d(p)}};this.canceled_?t(!1,new nh(!1,null,!0)):this.backoffId_=JO(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&ek(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class nh{constructor(e,t,a){this.wasSuccessCode=e,this.connection=t,this.canceled=!!a}}function ik(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function rk(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function ok(n,e){e&&(n["X-Firebase-GMPID"]=e)}function lk(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function ck(n,e,t,a,o,c,d=!0,f=!1){const p=nk(n.urlParams),g=n.url+p,y=Object.assign({},n.headers);return ok(y,e),ik(y,t),rk(y,c),lk(y,a),new ak(g,n.method,y,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,f)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uk(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function dk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,t){this._service=e,t instanceof Ns?this._location=t:this._location=Ns.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Fh(e,t)}get root(){const e=new Ns(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return dk(this._location.path)}get storage(){return this._service}get parent(){const e=uk(this._location.path);if(e===null)return null;const t=new Ns(this._location.bucket,e);return new Fh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw WO(e)}}function iE(n,e){const t=e?.[zO];return t==null?null:Ns.makeFromBucketSpec(t,n)}function hk(n,e,t,a={}){n.host=`${e}:${t}`;const o=Lr(e);o&&(Rg(`https://${n.host}/b`),Dg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=a;c&&(n._overrideAuthToken=typeof c=="string"?c:JE(c,n.app.options.projectId))}class fk{constructor(e,t,a,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=a,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=vA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=HO,this._maxUploadRetryTime=GO,this._requests=new Set,o!=null?this._bucket=Ns.makeFromBucketSpec(o,this._host):this._bucket=iE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ns.makeFromBucketSpec(this._url,e):this._bucket=iE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){aE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){aE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(In(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Fh(this,e)}_makeRequest(e,t,a,o,c=!0){if(this._deleted)return new ZO(yA());{const d=ck(e,this._appId,a,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[a,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,a,o).getPromise()}}const rE="@firebase/storage",oE="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA="storage";function mk(n=cu(),e){n=yt(n);const a=ka(n,bA).getImmediate({identifier:e}),o=XE("storage");return o&&pk(a,...o),a}function pk(n,e,t,a={}){hk(n,e,t,a)}function gk(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new fk(t,a,o,e,Vr)}function vk(){ls(new $n(bA,gk,"PUBLIC").setMultipleInstances(!0)),pn(rE,oE,""),pn(rE,oE,"esm2017")}vk();const _A="@firebase/installations",Lv="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=1e4,NA=`w:${Lv}`,EA="FIS_v2",yk="https://firebaseinstallations.googleapis.com/v1",bk=60*60*1e3,_k="installations",xk="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},kr=new Oi(_k,xk,Nk);function TA(n){return n instanceof us&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AA({projectId:n}){return`${yk}/projects/${n}/installations`}function jA(n){return{token:n.token,requestStatus:2,expiresIn:Tk(n.expiresIn),creationTime:Date.now()}}async function wA(n,e){const a=(await e.json()).error;return kr.create("request-failed",{requestName:n,serverCode:a.code,serverMessage:a.message,serverStatus:a.status})}function CA({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function Ek(n,{refreshToken:e}){const t=CA(n);return t.append("Authorization",Ak(e)),t}async function SA(n){const e=await n();return e.status>=500&&e.status<600?n():e}function Tk(n){return Number(n.replace("s","000"))}function Ak(n){return`${EA} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jk({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const a=AA(n),o=CA(n),c=e.getImmediate({optional:!0});if(c){const g=await c.getHeartbeatsHeader();g&&o.append("x-firebase-client",g)}const d={fid:t,authVersion:EA,appId:n.appId,sdkVersion:NA},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await SA(()=>fetch(a,f));if(p.ok){const g=await p.json();return{fid:g.fid||t,registrationStatus:2,refreshToken:g.refreshToken,authToken:jA(g.authToken)}}else throw await wA("Create Installation",p)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IA(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck=/^[cdef][\w-]{21}$/,Tg="";function Sk(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=Ik(n);return Ck.test(t)?t:Tg}catch{return Tg}}function Ik(n){return wk(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RA=new Map;function DA(n,e){const t=bf(n);MA(t,e),Rk(t,e)}function MA(n,e){const t=RA.get(n);if(t)for(const a of t)a(e)}function Rk(n,e){const t=Dk();t&&t.postMessage({key:n,fid:e}),Mk()}let Cr=null;function Dk(){return!Cr&&"BroadcastChannel"in self&&(Cr=new BroadcastChannel("[Firebase] FID Change"),Cr.onmessage=n=>{MA(n.data.key,n.data.fid)}),Cr}function Mk(){RA.size===0&&Cr&&(Cr.close(),Cr=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ok="firebase-installations-database",kk=1,Pr="firebase-installations-store";let Bp=null;function Vv(){return Bp||(Bp=nT(Ok,kk,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Pr)}}})),Bp}async function qh(n,e){const t=bf(n),o=(await Vv()).transaction(Pr,"readwrite"),c=o.objectStore(Pr),d=await c.get(t);return await c.put(e,t),await o.done,(!d||d.fid!==e.fid)&&DA(n,e.fid),e}async function OA(n){const e=bf(n),a=(await Vv()).transaction(Pr,"readwrite");await a.objectStore(Pr).delete(e),await a.done}async function _f(n,e){const t=bf(n),o=(await Vv()).transaction(Pr,"readwrite"),c=o.objectStore(Pr),d=await c.get(t),f=e(d);return f===void 0?await c.delete(t):await c.put(f,t),await o.done,f&&(!d||d.fid!==f.fid)&&DA(n,f.fid),f}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uv(n){let e;const t=await _f(n.appConfig,a=>{const o=Pk(a),c=Lk(n,o);return e=c.registrationPromise,c.installationEntry});return t.fid===Tg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function Pk(n){const e=n||{fid:Sk(),registrationStatus:0};return kA(e)}function Lk(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject(kr.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},a=Vk(n,t);return{installationEntry:t,registrationPromise:a}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Uk(n)}:{installationEntry:e}}async function Vk(n,e){try{const t=await jk(n,e);return qh(n.appConfig,t)}catch(t){throw TA(t)&&t.customData.serverCode===409?await OA(n.appConfig):await qh(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Uk(n){let e=await lE(n.appConfig);for(;e.registrationStatus===1;)await IA(100),e=await lE(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:a}=await Uv(n);return a||t}return e}function lE(n){return _f(n,e=>{if(!e)throw kr.create("installation-not-found");return kA(e)})}function kA(n){return Fk(n)?{fid:n.fid,registrationStatus:0}:n}function Fk(n){return n.registrationStatus===1&&n.registrationTime+xA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qk({appConfig:n,heartbeatServiceProvider:e},t){const a=Bk(n,t),o=Ek(n,t),c=e.getImmediate({optional:!0});if(c){const g=await c.getHeartbeatsHeader();g&&o.append("x-firebase-client",g)}const d={installation:{sdkVersion:NA,appId:n.appId}},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await SA(()=>fetch(a,f));if(p.ok){const g=await p.json();return jA(g)}else throw await wA("Generate Auth Token",p)}function Bk(n,{fid:e}){return`${AA(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fv(n,e=!1){let t;const a=await _f(n.appConfig,c=>{if(!PA(c))throw kr.create("not-registered");const d=c.authToken;if(!e&&Gk(d))return c;if(d.requestStatus===1)return t=zk(n,e),c;{if(!navigator.onLine)throw kr.create("app-offline");const f=Yk(c);return t=Hk(n,f),f}});return t?await t:a.authToken}async function zk(n,e){let t=await cE(n.appConfig);for(;t.authToken.requestStatus===1;)await IA(100),t=await cE(n.appConfig);const a=t.authToken;return a.requestStatus===0?Fv(n,e):a}function cE(n){return _f(n,e=>{if(!PA(e))throw kr.create("not-registered");const t=e.authToken;return Qk(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Hk(n,e){try{const t=await qk(n,e),a=Object.assign(Object.assign({},e),{authToken:t});return await qh(n.appConfig,a),t}catch(t){if(TA(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await OA(n.appConfig);else{const a=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await qh(n.appConfig,a)}throw t}}function PA(n){return n!==void 0&&n.registrationStatus===2}function Gk(n){return n.requestStatus===2&&!$k(n)}function $k(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+bk}function Yk(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function Qk(n){return n.requestStatus===1&&n.requestTime+xA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kk(n){const e=n,{installationEntry:t,registrationPromise:a}=await Uv(e);return a?a.catch(console.error):Fv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xk(n,e=!1){const t=n;return await Wk(t),(await Fv(t,e)).token}async function Wk(n){const{registrationPromise:e}=await Uv(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(n){if(!n||!n.options)throw zp("App Configuration");if(!n.name)throw zp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw zp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function zp(n){return kr.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LA="installations",Jk="installations-internal",eP=n=>{const e=n.getProvider("app").getImmediate(),t=Zk(e),a=ka(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:a,_delete:()=>Promise.resolve()}},tP=n=>{const e=n.getProvider("app").getImmediate(),t=ka(e,LA).getImmediate();return{getId:()=>Kk(t),getToken:o=>Xk(t,o)}};function nP(){ls(new $n(LA,eP,"PUBLIC")),ls(new $n(Jk,tP,"PRIVATE"))}nP();pn(_A,Lv);pn(_A,Lv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bh="analytics",sP="firebase_id",aP="origin",iP=60*1e3,rP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",qv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new lu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Gn=new Oi("analytics","Analytics",oP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lP(n){if(!n.startsWith(qv)){const e=Gn.create("invalid-gtag-resource",{gtagURL:n});return Rn.warn(e.message),""}return n}function VA(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function cP(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function uP(n,e){const t=cP("firebase-js-sdk-policy",{createScriptURL:lP}),a=document.createElement("script"),o=`${qv}?l=${n}&id=${e}`;a.src=t?t?.createScriptURL(o):o,a.async=!0,document.head.appendChild(a)}function dP(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function hP(n,e,t,a,o,c){const d=a[o];try{if(d)await e[d];else{const p=(await VA(t)).find(g=>g.measurementId===o);p&&await e[p.appId]}}catch(f){Rn.error(f)}n("config",o,c)}async function fP(n,e,t,a,o){try{let c=[];if(o&&o.send_to){let d=o.send_to;Array.isArray(d)||(d=[d]);const f=await VA(t);for(const p of d){const g=f.find(_=>_.measurementId===p),y=g&&e[g.appId];if(y)c.push(y);else{c=[];break}}}c.length===0&&(c=Object.values(e)),await Promise.all(c),n("event",a,o||{})}catch(c){Rn.error(c)}}function mP(n,e,t,a){async function o(c,...d){try{if(c==="event"){const[f,p]=d;await fP(n,e,t,f,p)}else if(c==="config"){const[f,p]=d;await hP(n,e,t,a,f,p)}else if(c==="consent"){const[f,p]=d;n("consent",f,p)}else if(c==="get"){const[f,p,g]=d;n("get",f,p,g)}else if(c==="set"){const[f]=d;n("set",f)}else n(c,...d)}catch(f){Rn.error(f)}}return o}function pP(n,e,t,a,o){let c=function(...d){window[a].push(arguments)};return window[o]&&typeof window[o]=="function"&&(c=window[o]),window[o]=mP(c,n,e,t),{gtagCore:c,wrappedGtag:window[o]}}function gP(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(qv)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vP=30,yP=1e3;class bP{constructor(e={},t=yP){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const UA=new bP;function _P(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function xP(n){var e;const{appId:t,apiKey:a}=n,o={method:"GET",headers:_P(a)},c=rP.replace("{app-id}",t),d=await fetch(c,o);if(d.status!==200&&d.status!==304){let f="";try{const p=await d.json();!((e=p.error)===null||e===void 0)&&e.message&&(f=p.error.message)}catch{}throw Gn.create("config-fetch-failed",{httpStatus:d.status,responseMessage:f})}return d.json()}async function NP(n,e=UA,t){const{appId:a,apiKey:o,measurementId:c}=n.options;if(!a)throw Gn.create("no-app-id");if(!o){if(c)return{measurementId:c,appId:a};throw Gn.create("no-api-key")}const d=e.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},f=new AP;return setTimeout(async()=>{f.abort()},iP),FA({appId:a,apiKey:o,measurementId:c},d,f,e)}async function FA(n,{throttleEndTimeMillis:e,backoffCount:t},a,o=UA){var c;const{appId:d,measurementId:f}=n;try{await EP(a,e)}catch(p){if(f)return Rn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:d,measurementId:f};throw p}try{const p=await xP(n);return o.deleteThrottleMetadata(d),p}catch(p){const g=p;if(!TP(g)){if(o.deleteThrottleMetadata(d),f)return Rn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:d,measurementId:f};throw p}const y=Number((c=g?.customData)===null||c===void 0?void 0:c.httpStatus)===503?Cx(t,o.intervalMillis,vP):Cx(t,o.intervalMillis),_={throttleEndTimeMillis:Date.now()+y,backoffCount:t+1};return o.setThrottleMetadata(d,_),Rn.debug(`Calling attemptFetch again in ${y} millis`),FA(n,_,a,o)}}function EP(n,e){return new Promise((t,a)=>{const o=Math.max(e-Date.now(),0),c=setTimeout(t,o);n.addEventListener(()=>{clearTimeout(c),a(Gn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function TP(n){if(!(n instanceof us)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class AP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function jP(n,e,t,a,o){if(o&&o.global){n("event",t,a);return}else{const c=await e,d=Object.assign(Object.assign({},a),{send_to:c});n("event",t,d)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wP(){if(Gh())try{await $h()}catch(n){return Rn.warn(Gn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Rn.warn(Gn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function CP(n,e,t,a,o,c,d){var f;const p=NP(n);p.then(j=>{t[j.measurementId]=j.appId,n.options.measurementId&&j.measurementId!==n.options.measurementId&&Rn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${j.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(j=>Rn.error(j)),e.push(p);const g=wP().then(j=>{if(j)return a.getId()}),[y,_]=await Promise.all([p,g]);gP(c)||uP(c,y.measurementId),o("js",new Date);const N=(f=d?.config)!==null&&f!==void 0?f:{};return N[aP]="firebase",N.update=!0,_!=null&&(N[sP]=_),o("config",y.measurementId,N),y.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e){this.app=e}_delete(){return delete qc[this.app.options.appId],Promise.resolve()}}let qc={},uE=[];const dE={};let Hp="dataLayer",IP="gtag",hE,qA,fE=!1;function RP(){const n=[];if(Mg()&&n.push("This is a browser extension environment."),Og()||n.push("Cookies are not available."),n.length>0){const e=n.map((a,o)=>`(${o+1}) ${a}`).join(" "),t=Gn.create("invalid-analytics-context",{errorInfo:e});Rn.warn(t.message)}}function DP(n,e,t){RP();const a=n.options.appId;if(!a)throw Gn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Rn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Gn.create("no-api-key");if(qc[a]!=null)throw Gn.create("already-exists",{id:a});if(!fE){dP(Hp);const{wrappedGtag:c,gtagCore:d}=pP(qc,uE,dE,Hp,IP);qA=c,hE=d,fE=!0}return qc[a]=CP(n,uE,dE,e,hE,Hp,t),new SP(n)}function MP(n=cu()){n=yt(n);const e=ka(n,Bh);return e.isInitialized()?e.getImmediate():OP(n)}function OP(n,e={}){const t=ka(n,Bh);if(t.isInitialized()){const o=t.getImmediate();if(Ti(e,t.getOptions()))return o;throw Gn.create("already-initialized")}return t.initialize({options:e})}async function kP(){if(Mg()||!Og()||!Gh())return!1;try{return await $h()}catch{return!1}}function PP(n,e,t,a){n=yt(n),jP(qA,qc[n.app.options.appId],e,t,a).catch(o=>Rn.error(o))}const mE="@firebase/analytics",pE="0.10.16";function LP(){ls(new $n(Bh,(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return DP(a,o,t)},"PUBLIC")),ls(new $n("analytics-internal",n,"PRIVATE")),pn(mE,pE),pn(mE,pE,"esm2017");function n(e){try{const t=e.getProvider(Bh).getImmediate();return{logEvent:(a,o,c)=>PP(t,a,o,c)}}catch(t){throw Gn.create("interop-component-reg-failed",{reason:t})}}}LP();var Ag,gE,xf=function(){var n=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(n&&n.responseStart>0&&n.responseStart<performance.now())return n},BA=function(n){if(document.readyState==="loading")return"loading";var e=xf();if(e){if(n<e.domInteractive)return"loading";if(e.domContentLoadedEventStart===0||n<e.domContentLoadedEventStart)return"dom-interactive";if(e.domComplete===0||n<e.domComplete)return"dom-content-loaded"}return"complete"},VP=function(n){var e=n.nodeName;return n.nodeType===1?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},Bv=function(n,e){var t="";try{for(;n&&n.nodeType!==9;){var a=n,o=a.id?"#"+a.id:VP(a)+(a.classList&&a.classList.value&&a.classList.value.trim()&&a.classList.value.trim().length?"."+a.classList.value.trim().replace(/\s+/g,"."):"");if(t.length+o.length>(e||100)-1)return t||o;if(t=t?o+">"+t:o,a.id)break;n=a.parentNode}}catch{}return t},zA=-1,UP=function(){return zA},Eu=function(n){addEventListener("pageshow",function(e){e.persisted&&(zA=e.timeStamp,n(e))},!0)},zv=function(){var n=xf();return n&&n.activationStart||0},Ri=function(n,e){var t=xf(),a="navigate";return UP()>=0?a="back-forward-cache":t&&(document.prerendering||zv()>0?a="prerender":document.wasDiscarded?a="restore":t.type&&(a=t.type.replace(/_/g,"-"))),{name:n,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:a}},gl=function(n,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(n)){var a=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return a.observe(Object.assign({type:n,buffered:!0},t||{})),a}}catch{}},Di=function(n,e,t,a){var o,c;return function(d){e.value>=0&&(d||a)&&((c=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=c,e.rating=function(f,p){return f>p[1]?"poor":f>p[0]?"needs-improvement":"good"}(e.value,t),n(e))}},Hv=function(n){requestAnimationFrame(function(){return requestAnimationFrame(function(){return n()})})},Nf=function(n){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&n()})},Gv=function(n){var e=!1;return function(){e||(n(),e=!0)}},zo=-1,vE=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},zh=function(n){document.visibilityState==="hidden"&&zo>-1&&(zo=n.type==="visibilitychange"?n.timeStamp:0,FP())},yE=function(){addEventListener("visibilitychange",zh,!0),addEventListener("prerenderingchange",zh,!0)},FP=function(){removeEventListener("visibilitychange",zh,!0),removeEventListener("prerenderingchange",zh,!0)},HA=function(){return zo<0&&(zo=vE(),yE(),Eu(function(){setTimeout(function(){zo=vE(),yE()},0)})),{get firstHiddenTime(){return zo}}},$v=function(n){document.prerendering?addEventListener("prerenderingchange",function(){return n()},!0):n()},bE=[1800,3e3],qP=function(n,e){e=e||{},$v(function(){var t,a=HA(),o=Ri("FCP"),c=gl("paint",function(d){d.forEach(function(f){f.name==="first-contentful-paint"&&(c.disconnect(),f.startTime<a.firstHiddenTime&&(o.value=Math.max(f.startTime-zv(),0),o.entries.push(f),t(!0)))})});c&&(t=Di(n,o,bE,e.reportAllChanges),Eu(function(d){o=Ri("FCP"),t=Di(n,o,bE,e.reportAllChanges),Hv(function(){o.value=performance.now()-d.timeStamp,t(!0)})}))})},_E=[.1,.25],BP=function(n,e){(function(t,a){a=a||{},qP(Gv(function(){var o,c=Ri("CLS",0),d=0,f=[],p=function(y){y.forEach(function(_){if(!_.hadRecentInput){var N=f[0],j=f[f.length-1];d&&_.startTime-j.startTime<1e3&&_.startTime-N.startTime<5e3?(d+=_.value,f.push(_)):(d=_.value,f=[_])}}),d>c.value&&(c.value=d,c.entries=f,o())},g=gl("layout-shift",p);g&&(o=Di(t,c,_E,a.reportAllChanges),Nf(function(){p(g.takeRecords()),o(!0)}),Eu(function(){d=0,c=Ri("CLS",0),o=Di(t,c,_E,a.reportAllChanges),Hv(function(){return o()})}),setTimeout(o,0))}))})(function(t){var a=function(o){var c,d={};if(o.entries.length){var f=o.entries.reduce(function(g,y){return g&&g.value>y.value?g:y});if(f&&f.sources&&f.sources.length){var p=(c=f.sources).find(function(g){return g.node&&g.node.nodeType===1})||c[0];p&&(d={largestShiftTarget:Bv(p.node),largestShiftTime:f.startTime,largestShiftValue:f.value,largestShiftSource:p,largestShiftEntry:f,loadState:BA(f.startTime)})}}return Object.assign(o,{attribution:d})}(t);n(a)},e)},GA=0,Gp=1/0,sh=0,zP=function(n){n.forEach(function(e){e.interactionId&&(Gp=Math.min(Gp,e.interactionId),sh=Math.max(sh,e.interactionId),GA=sh?(sh-Gp)/7+1:0)})},$A=function(){return Ag?GA:performance.interactionCount||0},HP=function(){"interactionCount"in performance||Ag||(Ag=gl("event",zP,{type:"event",buffered:!0,durationThreshold:0}))},bs=[],Bc=new Map,YA=0,GP=function(){var n=Math.min(bs.length-1,Math.floor(($A()-YA)/50));return bs[n]},QA=[],$P=function(n){if(QA.forEach(function(o){return o(n)}),n.interactionId||n.entryType==="first-input"){var e=bs[bs.length-1],t=Bc.get(n.interactionId);if(t||bs.length<10||n.duration>e.latency){if(t)n.duration>t.latency?(t.entries=[n],t.latency=n.duration):n.duration===t.latency&&n.startTime===t.entries[0].startTime&&t.entries.push(n);else{var a={id:n.interactionId,latency:n.duration,entries:[n]};Bc.set(a.id,a),bs.push(a)}bs.sort(function(o,c){return c.latency-o.latency}),bs.length>10&&bs.splice(10).forEach(function(o){return Bc.delete(o.id)})}}},Yv=function(n){var e=self.requestIdleCallback||self.setTimeout,t=-1;return n=Gv(n),document.visibilityState==="hidden"?n():(t=e(n),Nf(n)),t},xE=[200,500],YP=function(n,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},$v(function(){var t;HP();var a,o=Ri("INP"),c=function(f){Yv(function(){f.forEach($P);var p=GP();p&&p.latency!==o.value&&(o.value=p.latency,o.entries=p.entries,a())})},d=gl("event",c,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});a=Di(n,o,xE,e.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),Nf(function(){c(d.takeRecords()),a(!0)}),Eu(function(){YA=$A(),bs.length=0,Bc.clear(),o=Ri("INP"),a=Di(n,o,xE,e.reportAllChanges)}))}))},Xo=[],vi=[],jg=0,Qv=new WeakMap,Wo=new Map,wg=-1,QP=function(n){Xo=Xo.concat(n),KA()},KA=function(){wg<0&&(wg=Yv(KP))},KP=function(){Wo.size>10&&Wo.forEach(function(d,f){Bc.has(f)||Wo.delete(f)});var n=bs.map(function(d){return Qv.get(d.entries[0])}),e=vi.length-50;vi=vi.filter(function(d,f){return f>=e||n.includes(d)});for(var t=new Set,a=0;a<vi.length;a++){var o=vi[a];XA(o.startTime,o.processingEnd).forEach(function(d){t.add(d)})}var c=Xo.length-1-50;Xo=Xo.filter(function(d,f){return d.startTime>jg&&f>c||t.has(d)}),wg=-1};QA.push(function(n){n.interactionId&&n.target&&!Wo.has(n.interactionId)&&Wo.set(n.interactionId,n.target)},function(n){var e,t=n.startTime+n.duration;jg=Math.max(jg,n.processingEnd);for(var a=vi.length-1;a>=0;a--){var o=vi[a];if(Math.abs(t-o.renderTime)<=8){(e=o).startTime=Math.min(n.startTime,e.startTime),e.processingStart=Math.min(n.processingStart,e.processingStart),e.processingEnd=Math.max(n.processingEnd,e.processingEnd),e.entries.push(n);break}}e||(e={startTime:n.startTime,processingStart:n.processingStart,processingEnd:n.processingEnd,renderTime:t,entries:[n]},vi.push(e)),(n.interactionId||n.entryType==="first-input")&&Qv.set(n,e),KA()});var XA=function(n,e){for(var t,a=[],o=0;t=Xo[o];o++)if(!(t.startTime+t.duration<n)){if(t.startTime>e)break;a.push(t)}return a},XP=function(n,e){gE||(gE=gl("long-animation-frame",QP)),YP(function(t){var a=function(o){var c=o.entries[0],d=Qv.get(c),f=c.processingStart,p=d.processingEnd,g=d.entries.sort(function(A,O){return A.processingStart-O.processingStart}),y=XA(c.startTime,p),_=o.entries.find(function(A){return A.target}),N=_&&_.target||Wo.get(c.interactionId),j=[c.startTime+c.duration,p].concat(y.map(function(A){return A.startTime+A.duration})),x=Math.max.apply(Math,j),R={interactionTarget:Bv(N),interactionTargetElement:N,interactionType:c.name.startsWith("key")?"keyboard":"pointer",interactionTime:c.startTime,nextPaintTime:x,processedEventEntries:g,longAnimationFrameEntries:y,inputDelay:f-c.startTime,processingDuration:p-f,presentationDelay:Math.max(x-p,0),loadState:BA(c.startTime)};return Object.assign(o,{attribution:R})}(t);n(a)},e)},NE=[2500,4e3],$p={},WP=function(n,e){(function(t,a){a=a||{},$v(function(){var o,c=HA(),d=Ri("LCP"),f=function(y){a.reportAllChanges||(y=y.slice(-1)),y.forEach(function(_){_.startTime<c.firstHiddenTime&&(d.value=Math.max(_.startTime-zv(),0),d.entries=[_],o())})},p=gl("largest-contentful-paint",f);if(p){o=Di(t,d,NE,a.reportAllChanges);var g=Gv(function(){$p[d.id]||(f(p.takeRecords()),p.disconnect(),$p[d.id]=!0,o(!0))});["keydown","click"].forEach(function(y){addEventListener(y,function(){return Yv(g)},{once:!0,capture:!0})}),Nf(g),Eu(function(y){d=Ri("LCP"),o=Di(t,d,NE,a.reportAllChanges),Hv(function(){d.value=performance.now()-y.timeStamp,$p[d.id]=!0,o(!0)})})}})})(function(t){var a=function(o){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:o.value};if(o.entries.length){var d=xf();if(d){var f=d.activationStart||0,p=o.entries[o.entries.length-1],g=p.url&&performance.getEntriesByType("resource").filter(function(x){return x.name===p.url})[0],y=Math.max(0,d.responseStart-f),_=Math.max(y,g?(g.requestStart||g.startTime)-f:0),N=Math.max(_,g?g.responseEnd-f:0),j=Math.max(N,p.startTime-f);c={element:Bv(p.element),timeToFirstByte:y,resourceLoadDelay:_-y,resourceLoadDuration:N-_,elementRenderDelay:j-N,navigationEntry:d,lcpEntry:p},p.url&&(c.url=p.url),g&&(c.lcpResourceEntry=g)}}return Object.assign(o,{attribution:c})}(t);n(a)},e)};const EE="@firebase/performance",Cg="0.7.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WA=Cg,ZP="FB-PERF-TRACE-START",JP="FB-PERF-TRACE-STOP",Sg="FB-PERF-TRACE-MEASURE",ZA="_wt_",JA="_fp",ej="_fcp",tj="_fid",nj="_lcp",e2="lcp_element",sj="_inp",t2="inp_interactionTarget",aj="_cls",n2="cls_largestShiftTarget",ij="@firebase/performance/config",rj="@firebase/performance/configexpire",s2="performance",oj="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},mn=new Oi(s2,oj,a2);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi=new lu(oj);Mi.logLevel=$e.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yp,lj;class zt{constructor(e){if(this.window=e,!e)throw mn.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=WP,this.onINP=XP,this.onCLS=BP}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,t,a){!this.performance||!this.performance.measure||this.performance.measure(e,t,a)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!Og()?(Mi.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):Gh()?!0:(Mi.info("IndexedDB is not supported by current browser"),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(o=>{for(const c of o.getEntries())t(c)}).observe({entryTypes:[e]})}static getInstance(){return Yp===void 0&&(Yp=new zt(lj)),Yp}}function i2(n){lj=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cj;function r2(n){const e=n.getId();return e.then(t=>{cj=t}),e}function Kv(){return cj}function o2(n){const e=n.getToken();return e.then(t=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(n,e){const t=n.length-e.length;if(t<0||t>1)throw mn.create("invalid String merger input");const a=[];for(let o=0;o<n.length;o++)a.push(n.charAt(o)),e.length>o&&a.push(e.charAt(o));return a.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qp;class zn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=TE("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=TE("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Qp===void 0&&(Qp=new zn),Qp}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zc;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.VISIBLE=1]="VISIBLE",n[n.HIDDEN=2]="HIDDEN"})(zc||(zc={}));const l2=["firebase_","google_","ga_"],c2=new RegExp("^[a-zA-Z]\\w*$"),u2=40,d2=100;function h2(){const n=zt.getInstance().navigator;return n?.serviceWorker?n.serviceWorker.controller?2:3:1}function f2(){switch(zt.getInstance().document.visibilityState){case"visible":return zc.VISIBLE;case"hidden":return zc.HIDDEN;default:return zc.UNKNOWN}}function m2(){const e=zt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function p2(n){return n.length===0||n.length>u2?!1:!l2.some(t=>n.startsWith(t))&&!!n.match(c2)}function g2(n){return n.length!==0&&n.length<=d2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uj(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.appId;if(!t)throw mn.create("no app id");return t}function v2(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.projectId;if(!t)throw mn.create("no project id");return t}function y2(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.apiKey;if(!t)throw mn.create("no api key");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2="0.0.1",ys={loggingEnabled:!0},_2="FIREBASE_INSTALLATIONS_AUTH";function x2(n,e){const t=N2();return t?(AE(t),Promise.resolve()):A2(n,e).then(AE).then(a=>E2(a),()=>{})}function N2(){const n=zt.getInstance().localStorage;if(!n)return;const e=n.getItem(rj);if(!e||!j2(e))return;const t=n.getItem(ij);if(t)try{return JSON.parse(t)}catch{return}}function E2(n){const e=zt.getInstance().localStorage;!n||!e||(e.setItem(ij,JSON.stringify(n)),e.setItem(rj,String(Date.now()+zn.getInstance().configTimeToLive*60*60*1e3)))}const T2="Could not fetch config, will use default configs";function A2(n,e){return o2(n.installations).then(t=>{const a=v2(n.app),o=y2(n.app),c=`https://firebaseremoteconfig.googleapis.com/v1/projects/${a}/namespaces/fireperf:fetch?key=${o}`,d=new Request(c,{method:"POST",headers:{Authorization:`${_2} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:uj(n.app),app_version:WA,sdk_version:b2})});return fetch(d).then(f=>{if(f.ok)return f.json();throw mn.create("RC response not ok")})}).catch(()=>{Mi.info(T2)})}function AE(n){if(!n)return n;const e=zn.getInstance(),t=n.entries||{};return t.fpr_enabled!==void 0?e.loggingEnabled=String(t.fpr_enabled)==="true":e.loggingEnabled=ys.loggingEnabled,t.fpr_log_source?e.logSource=Number(t.fpr_log_source):ys.logSource&&(e.logSource=ys.logSource),t.fpr_log_endpoint_url?e.logEndPointUrl=t.fpr_log_endpoint_url:ys.logEndPointUrl&&(e.logEndPointUrl=ys.logEndPointUrl),t.fpr_log_transport_key?e.transportKey=t.fpr_log_transport_key:ys.transportKey&&(e.transportKey=ys.transportKey),t.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(t.fpr_vc_network_request_sampling_rate):ys.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=ys.networkRequestsSamplingRate),t.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(t.fpr_vc_trace_sampling_rate):ys.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=ys.tracesSamplingRate),e.logTraceAfterSampling=jE(e.tracesSamplingRate),e.logNetworkAfterSampling=jE(e.networkRequestsSamplingRate),n}function j2(n){return Number(n)>Date.now()}function jE(n){return Math.random()<=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xv=1,Kp;function dj(n){return Xv=2,Kp=Kp||C2(n),Kp}function w2(){return Xv===3}function C2(n){return S2().then(()=>r2(n.installations)).then(e=>x2(n,e)).then(()=>wE(),()=>wE())}function S2(){const n=zt.getInstance().document;return new Promise(e=>{if(n&&n.readyState!=="complete"){const t=()=>{n.readyState==="complete"&&(n.removeEventListener("readystatechange",t),e())};n.addEventListener("readystatechange",t)}else e()})}function wE(){Xv=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj=10*1e3,I2=5.5*1e3,R2=1e3,fj=3;let ph=fj,Sr=[],CE=!1;function D2(){CE||(Wv(I2),CE=!0)}function Wv(n){setTimeout(()=>{ph<=0||(Sr.length>0&&mj(),Wv(hj))},n)}function mj(){const n=Sr.splice(0,R2),e=n.map(a=>({source_extension_json_proto3:a.message,event_time_ms:String(a.eventTime)})),t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:zn.getInstance().logSource,log_event:e};M2(t).then(()=>{ph=fj}).catch(()=>{Sr=[...n,...Sr],ph--,Mi.info(`Tries left: ${ph}.`),Wv(hj)})}function M2(n){const e=zn.getInstance().getFlTransportFullUrl(),t=JSON.stringify(n);return navigator.sendBeacon&&navigator.sendBeacon(e,t)?Promise.resolve():fetch(e,{method:"POST",body:t,keepalive:!0}).then()}function O2(n){if(!n.eventTime||!n.message)throw mn.create("invalid cc log");Sr=[...Sr,n]}function k2(n){return(...e)=>{const t=n(...e);O2({message:t,eventTime:Date.now()})}}function P2(){for(;Sr.length>0;)mj()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hc;function pj(n,e){Hc||(Hc={send:k2(U2),flush:P2}),Hc.send(n,e)}function ah(n){const e=zn.getInstance();!e.instrumentationEnabled&&n.isAuto||!e.dataCollectionEnabled&&!n.isAuto||zt.getInstance().requiredApisAvailable()&&(w2()?Xp(n):dj(n.performanceController).then(()=>Xp(n),()=>Xp(n)))}function L2(){Hc&&Hc.flush()}function Xp(n){if(!Kv())return;const e=zn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||pj(n,1)}function V2(n){const e=zn.getInstance();if(!e.instrumentationEnabled)return;const t=n.url,a=e.logEndPointUrl.split("?")[0],o=e.flTransportEndpointUrl.split("?")[0];t===a||t===o||!e.loggingEnabled||!e.logNetworkAfterSampling||pj(n,0)}function U2(n,e){return e===0?F2(n):q2(n)}function F2(n){const e={url:n.url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},t={application_info:gj(n.performanceController.app),network_request_metric:e};return JSON.stringify(t)}function q2(n){const e={name:n.name,is_auto:n.isAuto,client_start_time_us:n.startTimeUs,duration_us:n.durationUs};Object.keys(n.counters).length!==0&&(e.counters=n.counters);const t=n.getAttributes();Object.keys(t).length!==0&&(e.custom_attributes=t);const a={application_info:gj(n.performanceController.app),trace_metric:e};return JSON.stringify(a)}function gj(n){return{google_app_id:uj(n),app_instance_id:Kv(),web_app_info:{sdk_version:WA,page_url:zt.getInstance().getUrl(),service_worker_status:h2(),visibility_state:f2(),effective_connection_type:m2()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SE(n,e){const t=e;if(!t||t.responseStart===void 0)return;const a=zt.getInstance().getTimeOrigin(),o=Math.floor((t.startTime+a)*1e3),c=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,d=Math.floor((t.responseEnd-t.startTime)*1e3),f=t.name&&t.name.split("?")[0],p={performanceController:n,url:f,responsePayloadBytes:t.transferSize,startTimeUs:o,timeToResponseInitiatedUs:c,timeToResponseCompletedUs:d};V2(p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2=100,z2="_",H2=[JA,ej,tj,nj,aj,sj];function G2(n,e){return n.length===0||n.length>B2?!1:e&&e.startsWith(ZA)&&H2.indexOf(n)>-1||!n.startsWith(z2)}function $2(n){const e=Math.floor(n);return e<n&&Mi.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,t,a=!1,o){this.performanceController=e,this.name=t,this.isAuto=a,this.state=1,this.customAttributes={},this.counters={},this.api=zt.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${ZP}-${this.randomId}-${this.name}`,this.traceStopMark=`${JP}-${this.randomId}-${this.name}`,this.traceMeasure=o||`${Sg}-${this.randomId}-${this.name}`,o&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw mn.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw mn.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),ah(this)}record(e,t,a){if(e<=0)throw mn.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw mn.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(t*1e3),this.startTimeUs=Math.floor(e*1e3),a&&a.attributes&&(this.customAttributes=Object.assign({},a.attributes)),a&&a.metrics)for(const o of Object.keys(a.metrics))isNaN(Number(a.metrics[o]))||(this.counters[o]=Math.floor(Number(a.metrics[o])));ah(this)}incrementMetric(e,t=1){this.counters[e]===void 0?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(G2(e,this.name))this.counters[e]=$2(t??0);else throw mn.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const a=p2(e),o=g2(t);if(a&&o){this.customAttributes[e]=t;return}if(!a)throw mn.create("invalid attribute name",{attributeName:e});if(!o)throw mn.create("invalid attribute value",{attributeValue:t})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(t.duration*1e3),this.startTimeUs=Math.floor((t.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,t,a,o,c){const d=zt.getInstance().getUrl();if(!d)return;const f=new su(e,ZA+d,!0),p=Math.floor(zt.getInstance().getTimeOrigin()*1e3);f.setStartTime(p),t&&t[0]&&(f.setDuration(Math.floor(t[0].duration*1e3)),f.putMetric("domInteractive",Math.floor(t[0].domInteractive*1e3)),f.putMetric("domContentLoadedEventEnd",Math.floor(t[0].domContentLoadedEventEnd*1e3)),f.putMetric("loadEventEnd",Math.floor(t[0].loadEventEnd*1e3)));const g="first-paint",y="first-contentful-paint";if(a){const _=a.find(j=>j.name===g);_&&_.startTime&&f.putMetric(JA,Math.floor(_.startTime*1e3));const N=a.find(j=>j.name===y);N&&N.startTime&&f.putMetric(ej,Math.floor(N.startTime*1e3)),c&&f.putMetric(tj,Math.floor(c*1e3))}this.addWebVitalMetric(f,nj,e2,o.lcp),this.addWebVitalMetric(f,aj,n2,o.cls),this.addWebVitalMetric(f,sj,t2,o.inp),ah(f),L2()}static addWebVitalMetric(e,t,a,o){o&&(e.putMetric(t,Math.floor(o.value*1e3)),o.elementAttribution&&e.putAttribute(a,o.elementAttribution))}static createUserTimingTrace(e,t){const a=new su(e,t,!1,t);ah(a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gh={},IE=!1,vj;function RE(n){Kv()&&(setTimeout(()=>Q2(n),0),setTimeout(()=>Y2(n),0),setTimeout(()=>K2(n),0))}function Y2(n){const e=zt.getInstance(),t=e.getEntriesByType("resource");for(const a of t)SE(n,a);e.setupObserver("resource",a=>SE(n,a))}function Q2(n){const e=zt.getInstance();"onpagehide"in window?e.document.addEventListener("pagehide",()=>Wp(n)):e.document.addEventListener("unload",()=>Wp(n)),e.document.addEventListener("visibilitychange",()=>{e.document.visibilityState==="hidden"&&Wp(n)}),e.onFirstInputDelay&&e.onFirstInputDelay(t=>{vj=t}),e.onLCP(t=>{var a;gh.lcp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.element}}),e.onCLS(t=>{var a;gh.cls={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.largestShiftTarget}}),e.onINP(t=>{var a;gh.inp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.interactionTarget}})}function K2(n){const e=zt.getInstance(),t=e.getEntriesByType("measure");for(const a of t)DE(n,a);e.setupObserver("measure",a=>DE(n,a))}function DE(n,e){const t=e.name;t.substring(0,Sg.length)!==Sg&&su.createUserTimingTrace(n,t)}function Wp(n){if(!IE){IE=!0;const e=zt.getInstance(),t=e.getEntriesByType("navigation"),a=e.getEntriesByType("paint");setTimeout(()=>{su.createOobTrace(n,t,a,gh,vj)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(e?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),e?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),zt.getInstance().requiredApisAvailable()?$h().then(t=>{t&&(D2(),dj(this).then(()=>RE(this),()=>RE(this)),this.initialized=!0)}).catch(t=>{Mi.info(`Environment doesn't support IndexedDB: ${t}`)}):Mi.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){zn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return zn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){zn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return zn.getInstance().dataCollectionEnabled}}const W2="[DEFAULT]";function Z2(n=cu()){return n=yt(n),ka(n,"performance").getImmediate()}const J2=(n,{options:e})=>{const t=n.getProvider("app").getImmediate(),a=n.getProvider("installations-internal").getImmediate();if(t.name!==W2)throw mn.create("FB not default");if(typeof window>"u")throw mn.create("no window");i2(window);const o=new X2(t,a);return o._init(e),o};function eL(){ls(new $n("performance",J2,"PUBLIC")),pn(EE,Cg),pn(EE,Cg,"esm2017")}eL();const tL={apiKey:"AIzaSyCbU834quCY8hjSffRwljJLgZrcxK8i2F4",authDomain:"liquidacionapp-62962.firebaseapp.com",projectId:"liquidacionapp-62962",storageBucket:"liquidacionapp-62962.firebasestorage.app",messagingSenderId:"851382130132",appId:"1:851382130132:web:eaba38fab449f14fb5b241",measurementId:"G-MEASUREMENT_ID"},au=sT(tL),Gc=S1(au),fe=SO(au);mk(au);let nL=null,sL=null;try{kP().then(n=>{n&&(nL=MP(au))}).catch(()=>{console.warn("Firebase Analytics no está soportado en este entorno")}),typeof window<"u"&&(sL=Z2(au))}catch(n){console.warn("Error al inicializar Firebase Analytics/Performance:",n)}const _s={ADMIN:"admin",CONTADOR:"contador",CLIENTE:"cliente"},dt={MANAGE_INVENTORY:"canManageInventory",CREATE_MOVEMENTS:"canCreateMovements",VIEW_ALL_MOVEMENTS:"canViewAllMovements",MANAGE_VEHICLES:"canManageVehicles",MANAGE_MAINTENANCE:"canManageMaintenance",MANAGE_SUPPLIERS:"canManageSuppliers",VIEW_REPORTS:"canViewReports",EXPORT_REPORTS:"canExportReports",MODIFY_SETTINGS:"canModifySettings"},aL="contacto.evert@gmail.com",yj=n=>{switch(n){case _s.ADMIN:return{[dt.MANAGE_INVENTORY]:!0,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!0,[dt.MANAGE_VEHICLES]:!0,[dt.MANAGE_MAINTENANCE]:!0,[dt.MANAGE_SUPPLIERS]:!0,[dt.VIEW_REPORTS]:!0,[dt.EXPORT_REPORTS]:!0,[dt.MODIFY_SETTINGS]:!0};case _s.CONTADOR:return{[dt.MANAGE_INVENTORY]:!0,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!0,[dt.MANAGE_VEHICLES]:!1,[dt.MANAGE_MAINTENANCE]:!0,[dt.MANAGE_SUPPLIERS]:!1,[dt.VIEW_REPORTS]:!0,[dt.EXPORT_REPORTS]:!0,[dt.MODIFY_SETTINGS]:!1};case _s.CLIENTE:default:return{[dt.MANAGE_INVENTORY]:!1,[dt.CREATE_MOVEMENTS]:!0,[dt.VIEW_ALL_MOVEMENTS]:!1,[dt.MANAGE_VEHICLES]:!1,[dt.MANAGE_MAINTENANCE]:!1,[dt.MANAGE_SUPPLIERS]:!1,[dt.VIEW_REPORTS]:!1,[dt.EXPORT_REPORTS]:!1,[dt.MODIFY_SETTINGS]:!1}}},iL=n=>n===aL?_s.ADMIN:_s.CLIENTE,al=()=>"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/invitations",rL=()=>{const n="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let e="";for(let t=0;t<8;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},oL=async(n,e)=>{try{const t=await Ef(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden crear invitaciones"};let a,o=!1,c=0;for(;!o&&c<10;){a=rL();const p=Ee(Me(fe,al()),Se("code","==",a));(await ft(p)).empty&&(o=!0),c++}if(!o)return{success:!1,error:"No se pudo generar un código único"};const d=Je(Me(fe,al())),f={code:a,targetEmail:n.email.toLowerCase(),targetRole:n.role||_s.CLIENTE,targetName:n.name||"",status:"pending",appContext:"combustibles",expiresAt:new Date(Date.now()+7*24*60*60*1e3),createdAt:Ue(),createdBy:e,usedAt:null,usedBy:null};return await gf(d,f),console.log("🎫 Invitación creada:",{code:a,email:n.email,role:n.role}),{success:!0,invitation:{id:d.id,code:a,...f}}}catch(t){return console.error("Error creating invitation:",t),{success:!1,error:t.message}}},bj=async n=>{try{const e=Ee(Me(fe,al()),Se("code","==",n.toUpperCase()),Se("status","==","pending")),t=await ft(e);if(t.empty)return{success:!1,error:"Código de invitación inválido o expirado"};const a=t.docs[0],o=a.data(),c=new Date,d=o.expiresAt.toDate();return c>d?{success:!1,error:"Código de invitación expirado"}:{success:!0,invitation:{id:a.id,...o}}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},lL=async(n,e)=>{try{const t=Je(fe,al(),n);return await As(t,{status:"used",usedAt:Ue(),usedBy:e}),{success:!0}}catch(t){return console.error("Error marking invitation as used:",t),{success:!1,error:t.message}}},cL=async n=>{try{const e=await Ef(n);if(!e.success||e.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden ver invitaciones"};const t=Ee(Me(fe,al())),a=await ft(t),o=[];return a.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,d)=>{const f=c.createdAt?.toDate()||new Date(0);return(d.createdAt?.toDate()||new Date(0))-f}),{success:!0,invitations:o}}catch(e){return console.error("Error getting invitations:",e),{success:!1,error:e.message}}},uL=async(n,e)=>{try{const t=await Ef(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden cancelar invitaciones"};const a=Je(fe,al(),n);return await As(a,{status:"cancelled",cancelledAt:Ue(),cancelledBy:e}),{success:!0}}catch(t){return console.error("Error cancelling invitation:",t),{success:!1,error:t.message}}},dL=n=>yj(n.targetRole),_j=async(n,e={})=>{const t=Je(fe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const a=await Fi(t);if(a.exists())return{success:!0,userData:a.data(),isNewUser:!1};{const o=iL(n.email),c={uid:n.uid,email:n.email,displayName:n.displayName||"",photoURL:n.photoURL||"",role:o,emailVerified:n.emailVerified,combustiblesPermissions:yj(o),createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...e};return await gf(t,c),{success:!0,userData:c,isNewUser:!0}}}catch(a){return console.error("Error creating/updating user profile:",a),{success:!1,error:a.message}}},ME=async(n,e,t={})=>{const a=Je(fe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const o=await Fi(a);if(o.exists())return{success:!0,userData:o.data(),isNewUser:!1};const c=await bj(e);if(!c.success)return c;const d=c.invitation;if(d.targetEmail!==n.email.toLowerCase())return{success:!1,error:"El código de invitación no corresponde a este email"};const f={uid:n.uid,email:n.email,displayName:n.displayName||d.targetName||"",photoURL:n.photoURL||"",role:d.targetRole,emailVerified:n.emailVerified,combustiblesPermissions:dL(d),invitationUsed:d.id,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...t};return await gf(a,f),await lL(d.id,n.uid),console.log("👤 Usuario creado con invitación:",{email:n.email,role:d.targetRole,invitationCode:d.code}),{success:!0,userData:f,isNewUser:!0}}catch(o){return console.error("Error creating user profile with invitation:",o),{success:!1,error:o.message}}},Ef=async n=>{try{const e=Je(fe,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n),t=await Fi(e);return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"Usuario no encontrado"}}catch(e){return console.error("Error fetching user profile:",e),{success:!1,error:e.message}}},Nn={DIESEL:"diesel",GASOLINE:"gasoline",ACPM:"acpm",LUBRICANTS:"lubricants",TWO_STROKE:"two_stroke",MIXED:"mixed"},il={[Nn.DIESEL]:{name:"Diésel",description:"Combustible para maquinaria pesada",unit:"galones",category:"Combustible",color:"#fbbf24",icon:"🚛",density:.85,priceUnit:"COP/galón"},[Nn.GASOLINE]:{name:"Gasolina",description:"Combustible para vehículos livianos",unit:"galones",category:"Combustible",color:"#ef4444",icon:"⛽",density:.75,priceUnit:"COP/galón"},[Nn.ACPM]:{name:"ACPM",description:"Aceite Combustible Para Motor",unit:"galones",category:"Combustible",color:"#8b5cf6",icon:"🚜",density:.85,priceUnit:"COP/galón"},[Nn.LUBRICANTS]:{name:"Lubricantes",description:"Aceites y lubricantes para mantenimiento",unit:"litros",category:"Mantenimiento",color:"#06b6d4",icon:"🛢️",density:.9,priceUnit:"COP/litro"},[Nn.TWO_STROKE]:{name:"Mezcla 2T",description:"Mezcla para motores de 2 tiempos (motosierras)",unit:"litros",category:"Especializado",color:"#10b981",icon:"🪚",density:.78,priceUnit:"COP/litro"},[Nn.MIXED]:{name:"Mixto",description:"Compatible con múltiples tipos de combustible",unit:"galones",category:"Flexible",color:"#64748b",icon:"🔄",density:.8,priceUnit:"COP/galón"}},xn={CRITICAL:"critical",LOW:"low",MEDIUM:"medium",HIGH:"high",FULL:"full"},Ho={[xn.CRITICAL]:{label:"Crítico",color:"#dc2626",icon:"🚨",threshold:.1},[xn.LOW]:{label:"Bajo",color:"#ea580c",icon:"⚠️",threshold:.25},[xn.MEDIUM]:{label:"Medio",color:"#ca8a04",icon:"📊",threshold:.5},[xn.HIGH]:{label:"Alto",color:"#16a34a",icon:"✅",threshold:.75},[xn.FULL]:{label:"Completo",color:"#059669",icon:"🟢",threshold:1}},xj=(n,e)=>{if(e===0)return xn.CRITICAL;const t=n/e;return t<Ho[xn.CRITICAL].threshold?xn.CRITICAL:t<Ho[xn.LOW].threshold?xn.LOW:t<Ho[xn.MEDIUM].threshold?xn.MEDIUM:t<Ho[xn.HIGH].threshold?xn.HIGH:xn.FULL},hL=(n,e=[])=>{if(!n||!n.fuelType||!n.quantity)return{isValid:!1,error:"Datos de movimiento incompletos",availableStock:0,requiredStock:0};const{fuelType:t,quantity:a,type:o,sourceLocation:c}=n,d=parseFloat(a)||0;if(o!=="outbound"&&o!=="transfer")return{isValid:!0,message:"Movimiento no requiere validación de stock",availableStock:0,requiredStock:d};const f=e.filter(y=>y.fuelType===t&&y.location?.toLowerCase()===c?.toLowerCase()&&y.status==="active").reduce((y,_)=>y+(parseFloat(_.currentStock)||0),0),p=f>=d,g=f-d;return console.log(`Validación de stock - Tipo: ${t}, Ubicación: ${c}`,{itemsEncontrados:e.filter(y=>y.fuelType===t&&y.location?.toLowerCase()===c?.toLowerCase()&&y.status==="active").length,disponible:f,requerido:d,valido:f>=d}),{isValid:p,availableStock:f,requiredStock:d,remainingStock:g,fuelType:t,location:c,error:p?null:`Stock insuficiente. Disponible: ${f}, Requerido: ${d}`,warning:g<f*.2&&g>=0?"Stock quedará bajo después del movimiento":null}},Dn=n=>typeof n!="number"||isNaN(n)?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),ke=(n,e=2)=>typeof n!="number"||isNaN(n)?"0":new Intl.NumberFormat("es-CO",{minimumFractionDigits:e,maximumFractionDigits:e}).format(n),Tr=(n,e=1)=>typeof n!="number"||isNaN(n)?"0%":`${(n*100).toFixed(e)}%`,iu=(n,e,t=2)=>{const a=parseFloat(n)||0,o=parseFloat(e)||0;return parseFloat((a+o).toFixed(t))},ru=(n,e,t=2)=>{const a=parseFloat(n)||0,o=parseFloat(e)||0;return parseFloat((a-o).toFixed(t))},rl=(n,e=2)=>{const t=parseFloat(n)||0;return parseFloat(t.toFixed(e))},Ei=["principal","campamento austria","campamento ilusion","bodega austria","bodega ilusion","campo operativo","estación móvil"],fL=["bodega austria","bodega ilusion"],Gs=n=>n?n.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"",Br="combustibles_movements",rs="combustibles_inventory",ue={ENTRADA:"entrada",SALIDA:"salida",TRANSFERENCIA:"transferencia",AJUSTE:"ajuste"},gt={PENDIENTE:"pendiente",COMPLETADO:"completado",CANCELADO:"cancelado"},Nj=async n=>{try{pL(n);const e={...n,createdAt:Ue(),updatedAt:Ue(),status:gt.COMPLETADO,approvedAt:Ue(),totalValue:wj(n),effectiveDate:n.effectiveDate||Ue()},t=await Pv(fe,async a=>{const o=Je(Me(fe,Br));return a.set(o,e),await Cj(a,e,o.id),o.id});return console.log("✅ Movimiento creado exitosamente:",t),t}catch(e){throw console.error("❌ Error al crear movimiento:",e),new Error(`Error al crear movimiento: ${e.message}`)}},Ej=async(n={})=>{try{let e=Me(fe,Br);n.type&&(e=Ee(e,Se("type","==",n.type))),n.status&&(e=Ee(e,Se("status","==",n.status))),n.fuelType&&(e=Ee(e,Se("fuelType","==",n.fuelType))),n.vehicleId&&(e=Ee(e,Se("vehicleId","==",n.vehicleId))),e=Ee(e,An("createdAt","desc"));const t=await ft(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,effectiveDate:o.data().effectiveDate?.toDate?.()||o.data().effectiveDate})}),a}catch(e){throw console.error("❌ Error al obtener movimientos:",e),new Error(`Error al obtener movimientos: ${e.message}`)}},Zv=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=Je(fe,Br,n),t=await Fi(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate?.()||t.data().createdAt,updatedAt:t.data().updatedAt?.toDate?.()||t.data().updatedAt,effectiveDate:t.data().effectiveDate?.toDate?.()||t.data().effectiveDate}:null}catch(e){throw console.error("❌ Error al obtener movimiento:",e),new Error(`Error al obtener movimiento: ${e.message}`)}},Tj=async(n,e)=>{try{if(!n)throw new Error("ID de movimiento requerido");const t={...e,updatedAt:Ue(),...e.quantity||e.unitPrice?{totalValue:wj(e)}:{}},a=Je(fe,Br,n);await As(a,t),console.log("✅ Movimiento actualizado exitosamente")}catch(t){throw console.error("❌ Error al actualizar movimiento:",t),new Error(`Error al actualizar movimiento: ${t.message}`)}},mL=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=await Zv(n);if(!e)throw new Error("Movimiento no encontrado");await Pv(fe,async t=>{const a=Je(fe,Br,n);e.status===gt.COMPLETADO&&await gL(t,e),t.delete(a)}),console.log("✅ Movimiento eliminado y cambios de inventario revertidos exitosamente")}catch(e){throw console.error("❌ Error al eliminar movimiento:",e),new Error(`Error al eliminar movimiento: ${e.message}`)}},Jv=(n,e={})=>{try{let t=Me(fe,Br);return e.type&&(t=Ee(t,Se("type","==",e.type))),e.status&&(t=Ee(t,Se("status","==",e.status))),t=Ee(t,An("createdAt","desc")),qr(t,a=>{const o=[];a.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,effectiveDate:c.data().effectiveDate?.toDate?.()||c.data().effectiveDate})}),n(o)},a=>{console.error("❌ Error en suscripción de movimientos:",a),n([],a)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},Aj=async n=>{try{const e=await Zv(n);if(!e)throw new Error("Movimiento no encontrado");if(e.status!==gt.PENDIENTE)throw new Error("Solo se pueden aprobar movimientos pendientes");await Pv(fe,async t=>{const a=Je(fe,Br,n);t.update(a,{status:gt.COMPLETADO,approvedAt:Ue(),updatedAt:Ue()}),await Cj(t,e,n)}),console.log("✅ Movimiento aprobado exitosamente")}catch(e){throw console.error("❌ Error al aprobar movimiento:",e),new Error(`Error al aprobar movimiento: ${e.message}`)}},jj=async(n={})=>{try{const e=await Ej(n),t={totalMovements:e.length,byType:{},byStatus:{},byFuelType:{},totalValue:0,totalQuantity:0,averageValue:0,thisMonth:0,lastMonth:0,thisWeek:0},a=new Date,o=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()-1,1),d=new Date(a.setDate(a.getDate()-a.getDay()));return e.forEach(f=>{t.byType[f.type]=(t.byType[f.type]||0)+1,t.byStatus[f.status]=(t.byStatus[f.status]||0)+1,t.byFuelType[f.fuelType]=(t.byFuelType[f.fuelType]||0)+1,t.totalValue+=f.totalValue||0,t.totalQuantity+=f.quantity||0;const p=new Date(f.createdAt);p>=o&&t.thisMonth++,p>=c&&p<o&&t.lastMonth++,p>=d&&t.thisWeek++}),t.averageValue=t.totalMovements>0?t.totalValue/t.totalMovements:0,t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},OE=n=>n?Ei.includes(n.toLowerCase()):!1,pL=n=>{const e=["type","fuelType","quantity","unitPrice"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!Object.values(ue).includes(n.type))throw new Error("Tipo de movimiento inválido");if(n.quantity<=0)throw new Error("La cantidad debe ser mayor a cero");if(n.unitPrice<0)throw new Error("El precio unitario no puede ser negativo");if(n.type===ue.SALIDA&&!n.vehicleId)throw new Error("Las salidas deben tener un vehículo asociado");if(n.type===ue.TRANSFERENCIA&&!n.destinationLocation)throw new Error("Las transferencias deben tener una ubicación destino");if(n.type===ue.ENTRADA){if(!n.supplierName)throw new Error("Las entradas deben tener un proveedor");if(!n.destinationLocation)throw new Error("Las entradas deben tener una ubicación destino")}if(n.type!==ue.ENTRADA&&n.location&&!OE(n.location))throw new Error(`Ubicación origen inválida: ${n.location}. Ubicaciones válidas: ${Ei.join(", ")}`);if(n.destinationLocation&&!OE(n.destinationLocation))throw new Error(`Ubicación destino inválida: ${n.destinationLocation}. Ubicaciones válidas: ${Ei.join(", ")}`);if(n.type===ue.TRANSFERENCIA){const t=(n.location||"principal").toLowerCase(),a=n.destinationLocation.toLowerCase();if(t===a)throw new Error("La ubicación origen y destino no pueden ser la misma en una transferencia")}},wj=n=>(n.quantity||0)*(n.unitPrice||0),Cj=async(n,e,t)=>{try{let a=e.location||"principal";e.type===ue.ENTRADA&&(a=e.destinationLocation||"principal");const o=Ee(Me(fe,rs),Se("fuelType","==",e.fuelType),Se("location","==",a)),c=await ft(o);if(c.empty){if(e.type!==ue.ENTRADA)throw new Error(`No se encontró inventario para ${e.fuelType} en ${a} para realizar un movimiento de ${e.type}.`);console.log(`📦 Creando inventario automático para ${e.fuelType} en ${a}`);const d=Je(Me(fe,rs)),f={fuelType:e.fuelType,location:a,name:e.fuelType,maxCapacity:1e4,currentStock:rl(e.quantity,2),minThreshold:1500,pricePerUnit:e.unitPrice||0,createdAt:Ue(),updatedAt:Ue(),status:"active",lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:Ue()}};n.set(d,f)}else{const d=c.docs[0],f=d.data(),p=Je(fe,rs,d.id);let g=f.currentStock;switch(e.type){case ue.ENTRADA:g=iu(g,e.quantity);break;case ue.SALIDA:if(g=ru(g,e.quantity),g<0)throw new Error("Stock insuficiente para realizar la salida");break;case ue.AJUSTE:g=iu(g,e.quantity),g<0&&(g=0);break;case ue.TRANSFERENCIA:if(g=ru(g,e.quantity),g<0)throw new Error("Stock insuficiente para realizar la transferencia");await vL(n,e,t);break}g=rl(g,2),n.update(p,{currentStock:g,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:Ue()},updatedAt:Ue()})}e.type===ue.SALIDA&&e.vehicleId&&e.currentHours&&await PE(n,e.vehicleId,e.currentHours),e.type===ue.SALIDA&&e.vehicleId&&e.currentHours&&await PE(n,e.vehicleId,e.currentHours)}catch(a){throw console.error("❌ Error al actualizar inventario:",a),a}},gL=async(n,e)=>{try{console.log("🔄 Revirtiendo cambios de inventario para movimiento:",e.id);let t;switch(e.type){case ue.ENTRADA:t=e.destinationLocation||"principal";break;case ue.SALIDA:case ue.AJUSTE:t=e.location||"principal";break;case ue.TRANSFERENCIA:t=e.location||"principal";break;default:t=e.location||e.destinationLocation||"principal"}console.log(`🔍 Buscando inventario: ${e.fuelType} en ${t}`);const a=Ee(Me(fe,rs),Se("fuelType","==",e.fuelType),Se("location","==",t)),o=await ft(a);if(o.empty){console.warn(`⚠️ No se encontró inventario para ${e.fuelType} en ${t}`);const p=Ee(Me(fe,rs),Se("fuelType","==",e.fuelType)),g=await ft(p);if(g.empty)throw console.error(`❌ No existe inventario para ${e.fuelType} en ninguna ubicación`),new Error(`No se puede revertir: no existe inventario para ${e.fuelType} en ninguna ubicación. Movimiento huérfano detectado.`);console.log(`🔄 Usando inventario fallback en ${g.docs[0].data().location}`);const y=g.docs[0],_=y.data(),N=Je(fe,rs,y.id);await kE(n,N,_,e);return}const c=o.docs[0],d=c.data(),f=Je(fe,rs,c.id);await kE(n,f,d,e)}catch(t){throw console.error("❌ Error al revertir cambios de inventario:",t),new Error(`Error al revertir inventario: ${t.message}`)}},kE=async(n,e,t,a)=>{try{let o=t.currentStock;switch(a.type){case ue.ENTRADA:o=ru(o,a.quantity),o<0&&(console.warn("⚠️ Advertencia: La reversión resulta en stock negativo, ajustando a 0"),o=0);break;case ue.SALIDA:o=iu(o,a.quantity);break;case ue.AJUSTE:o=ru(o,a.quantity),o<0&&(console.warn("⚠️ Advertencia: La reversión de ajuste resulta en stock negativo, ajustando a 0"),o=0);break;case ue.TRANSFERENCIA:o=iu(o,a.quantity),await yL(n,a);break;default:throw new Error(`Tipo de movimiento no soportado para reversión: ${a.type}`)}o=rl(o,2),n.update(e,{currentStock:o,lastMovement:{movementId:null,type:"reversion",quantity:a.quantity,originalType:a.type,date:Ue(),note:`Reversión de movimiento ${a.id} - Ubicación original: ${a.location||a.destinationLocation||"no especificada"}`},updatedAt:Ue()}),console.log(`✅ Inventario revertido exitosamente. Stock anterior: ${t.currentStock}, Nuevo stock: ${o}`)}catch(o){throw console.error("❌ Error en procesamiento de reversión:",o),o}},vL=async(n,e,t)=>{try{if(!e.destinationLocation)throw new Error("Ubicación destino requerida para transferencias");console.log(`🔄 Transfiriendo ${e.quantity} ${e.fuelType} a ${e.destinationLocation}`);const a=Ee(Me(fe,rs),Se("fuelType","==",e.fuelType),Se("location","==",e.destinationLocation)),o=await ft(a);if(o.empty){console.log(`📦 Creando inventario automático en destino: ${e.fuelType} en ${e.destinationLocation}`);const c=Je(Me(fe,rs)),d={fuelType:e.fuelType,location:e.destinationLocation,name:e.fuelType,maxCapacity:1e4,currentStock:rl(e.quantity,2),minThreshold:1500,pricePerUnit:e.unitPrice||0,createdAt:Ue(),updatedAt:Ue(),status:"active",lastMovement:{movementId:t,type:"transferencia_entrada",quantity:e.quantity,date:Ue(),originLocation:e.location}};n.set(c,d)}else{const c=o.docs[0],d=c.data(),f=Je(fe,rs,c.id),p=rl(iu(d.currentStock,e.quantity),2);n.update(f,{currentStock:p,lastMovement:{movementId:t,type:"transferencia_entrada",quantity:e.quantity,date:Ue(),originLocation:e.location},updatedAt:Ue()})}console.log("✅ Transferencia al destino completada exitosamente")}catch(a){throw console.error("❌ Error al transferir a destino:",a),new Error(`Error en transferencia a destino: ${a.message}`)}},yL=async(n,e)=>{try{if(!e.destinationLocation){console.warn("⚠️ No hay ubicación destino para revertir");return}console.log(`🔄 Revirtiendo transferencia en destino: ${e.destinationLocation}`);const t=Ee(Me(fe,rs),Se("fuelType","==",e.fuelType),Se("location","==",e.destinationLocation)),a=await ft(t);if(a.empty){console.warn(`⚠️ No se encontró inventario destino para revertir: ${e.fuelType} en ${e.destinationLocation}`);return}const o=a.docs[0],c=o.data(),d=Je(fe,rs,o.id);let f=ru(c.currentStock,e.quantity);f<0&&(console.warn("⚠️ Advertencia: La reversión en destino resulta en stock negativo, ajustando a 0"),f=0),f=rl(f,2),n.update(d,{currentStock:f,lastMovement:{movementId:null,type:"reversion_transferencia",quantity:e.quantity,date:Ue(),note:`Reversión de transferencia desde ${e.location}`},updatedAt:Ue()}),console.log("✅ Reversión en destino completada exitosamente")}catch(t){throw console.error("❌ Error al revertir transferencia en destino:",t),new Error(`Error al revertir destino: ${t.message}`)}},PE=async(n,e,t)=>{try{console.log(`🕒 Actualizando horómetro del vehículo ${e} a ${t} horas`);const a=Ee(Me(fe,"combustibles_vehicles"),Se("vehicleId","==",e)),o=await ft(a);if(o.empty){console.warn(`⚠️ Vehículo ${e} no encontrado para actualizar horómetro`);return}const c=o.docs[0],d=c.data(),f=Je(fe,"combustibles_vehicles",c.id),p=parseFloat(d.currentHours)||0,g=parseFloat(t);g<p&&console.warn(`⚠️ Nueva lectura horómetro (${g}) menor a la anterior (${p}). Actualizando de todas formas.`);const y=d.hourMeterHistory||[];y.push({previousHours:p,newHours:g,difference:g-p,updatedAt:new Date,updatedBy:"movement_service",source:"fuel_consumption"}),n.update(f,{currentHours:g,hourMeterHistory:y,lastHourMeterUpdate:Ue(),updatedAt:Ue()}),console.log(`✅ Horómetro actualizado: ${e} - ${p}h → ${g}h`)}catch(a){console.error("❌ Error al actualizar horómetro del vehículo:",a),console.warn("⚠️ Continuando con el movimiento sin actualización de horómetro")}},LE={createMovement:Nj,getAllMovements:Ej,getMovement:Zv,updateMovement:Tj,deleteMovement:mL,subscribeToMovements:Jv,approveMovement:Aj,getMovementsStats:jj,MOVEMENT_TYPES:ue,MOVEMENT_STATUS:gt},ol="combustibles_inventory",bL=async(n,e)=>{try{const t=il[n.fuelType];if(!t)return{success:!1,error:"Tipo de combustible no válido"};const a=Ee(Me(fe,ol),Se("fuelType","==",n.fuelType),Se("location","==",n.location.toLowerCase()));if(!(await ft(a)).empty)return{success:!1,error:`Ya existe ${t.name} en ${n.location}`};const c={fuelType:n.fuelType,name:t.name,description:n.description||t.description,currentStock:Number(n.currentStock)||0,maxCapacity:Number(n.maxCapacity),minThreshold:Number(n.minThreshold)||n.maxCapacity*.15,unit:t.unit,location:n.location.toLowerCase(),pricePerUnit:Number(n.pricePerUnit)||0,supplier:n.supplier||"",status:n.status||"active",createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await pl(Me(fe,ol),c)).id,...c},message:`${t.name} agregado al inventario exitosamente`}}catch(t){return console.error("Error creating inventory item:",t),{success:!1,error:t.message}}},_L=async()=>{try{const n=Ee(Me(fe,ol),An("fuelType","asc")),e=await ft(n),t=[];return e.forEach(a=>{const o=a.data();t.push({id:a.id,...o,stockLevel:xj(o.currentStock,o.maxCapacity),stockPercentage:Math.round(o.currentStock/o.maxCapacity*100),needsRestock:o.currentStock<=o.minThreshold})}),{success:!0,data:t}}catch(n){return console.error("Error fetching inventory items:",n),{success:!1,error:n.message}}},xL=async(n,e,t)=>{try{const a=Je(fe,ol,n);if(!(await Fi(a)).exists())return{success:!1,error:"Item no encontrado"};const c={...e,lastUpdated:new Date,updatedBy:t};return delete c.id,delete c.createdAt,delete c.createdBy,await As(a,c),{success:!0,message:"Item actualizado exitosamente",data:{id:n,...c}}}catch(a){return console.error("Error updating inventory item:",a),{success:!1,error:a.message}}},NL=async n=>{try{const e=Je(fe,ol,n);return(await Fi(e)).exists()?(await vf(e),{success:!0,message:"Item eliminado exitosamente"}):{success:!1,error:"Item no encontrado"}}catch(e){return console.error("Error deleting inventory item:",e),{success:!1,error:e.message}}},Sj=n=>{const e=Ee(Me(fe,ol),An("fuelType","asc"));return qr(e,t=>{const a=[];t.forEach(o=>{const c=o.data();a.push({id:o.id,...c,stockLevel:xj(c.currentStock,c.maxCapacity),stockPercentage:Math.round(c.currentStock/c.maxCapacity*100),needsRestock:c.currentStock<=c.minThreshold})}),n(a)},t=>{console.error("Error in inventory subscription:",t),n(null,t)})},EL=async()=>{try{const n=await _L();if(!n.success)return n;const e=n.data,t={totalItems:e.length,activeItems:e.filter(a=>a.status==="active").length,lowStockItems:e.filter(a=>a.needsRestock).length,totalValue:e.reduce((a,o)=>a+o.currentStock*o.pricePerUnit,0),averageStockLevel:e.length>0?Math.round(e.reduce((a,o)=>a+o.stockPercentage,0)/e.length):0,byFuelType:{}};return e.forEach(a=>{t.byFuelType[a.fuelType]||(t.byFuelType[a.fuelType]={count:0,totalStock:0,totalCapacity:0,totalValue:0}),t.byFuelType[a.fuelType].count++,t.byFuelType[a.fuelType].totalStock+=a.currentStock,t.byFuelType[a.fuelType].totalCapacity+=a.maxCapacity,t.byFuelType[a.fuelType].totalValue+=a.currentStock*a.pricePerUnit}),{success:!0,data:t}}catch(n){return console.error("Error calculating inventory stats:",n),{success:!1,error:n.message}}},os=[{id:"maquinaria_pesada",name:"Maquinaria Pesada",description:"Excavadoras, bulldozers, cargadores, grúas",icon:"🏗️",color:"#FF6B35",fuelTypes:["Diesel","ACPM"],fields:["enginePower","operatingWeight","bucketCapacity"]},{id:"transporte",name:"Transporte",description:"Camiones, camionetas, volquetas",icon:"🚛",color:"#2E86AB",fuelTypes:["Diesel","ACPM","Gasolina"],fields:["plateNumber","loadCapacity","enginePower"]},{id:"herramientas_motorizadas",name:"Herramientas Motorizadas",description:"Motosierras, guadañas, fumigadoras",icon:"🔧",color:"#A23B72",fuelTypes:["Gasolina","Mixto"],fields:["enginePower","weight"]},{id:"equipos_bombeo",name:"Equipos de Bombeo",description:"Motobombas, hidrolavadoras, plantas eléctricas",icon:"💧",color:"#F18F01",fuelTypes:["Diesel","Gasolina"],fields:["flow","pressure","enginePower"]},{id:"vehiculos_ligeros",name:"Vehículos Ligeros",description:"Motocicletas, cuatrimotos, vehículos de apoyo",icon:"🏍️",color:"#C73E1D",fuelTypes:["Gasolina"],fields:["plateNumber","enginePower"]},{id:"agricola",name:"Agrícola/Forestal",description:"Tractores, asperjadoras, equipos forestales",icon:"🚜",color:"#2F7D32",fuelTypes:["Diesel","ACPM"],fields:["enginePower","hasHourMeter","implementType"]},{id:"otros",name:"Otros",description:"Equipos especializados y otros vehículos",icon:"⚙️",color:"#616161",fuelTypes:["Diesel","Gasolina","ACPM","Mixto"],fields:["enginePower"]}],Ve={ACTIVO:"activo",MANTENIMIENTO:"mantenimiento",INACTIVO:"inactivo",REPARACION:"reparacion",FUERA_DE_SERVICIO:"fuera_de_servicio"},Ij={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},VE=[{key:"plateNumber",label:"Número de Placa",type:"text",icon:"🏷️"},{key:"enginePower",label:"Potencia del Motor (HP)",type:"number",icon:"⚡"},{key:"fuelCapacity",label:"Capacidad de Combustible (Litros)",type:"number",icon:"⛽"},{key:"operatingWeight",label:"Peso Operativo (Toneladas)",type:"number",icon:"⚖️"},{key:"loadCapacity",label:"Capacidad de Carga (Toneladas)",type:"number",icon:"📦"},{key:"bucketCapacity",label:"Capacidad de Balde (m³)",type:"number",icon:"🪣"},{key:"hasHourMeter",label:"Tiene Horómetro",type:"boolean",icon:"⏰"},{key:"currentHours",label:"Horas Actuales",type:"number",icon:"🕐",dependsOn:"hasHourMeter"},{key:"implementType",label:"Tipo de Implemento",type:"text",icon:"🔧"},{key:"flow",label:"Caudal (L/min)",type:"number",icon:"💧"},{key:"pressure",label:"Presión (PSI)",type:"number",icon:"💨"},{key:"weight",label:"Peso (Kg)",type:"number",icon:"⚖️"}],UE=(n,e=[])=>{const t=e.find(a=>a.id===n);return t||os.find(a=>a.id===n)||null},Rj=(n=[])=>{const e=os.map(a=>a.id),t=n.filter(a=>!e.includes(a.id));return[...os,...t]},Dj=n=>{const e=[];return(!n.id||typeof n.id!="string")&&e.push("ID de categoría requerido y debe ser texto"),(!n.name||typeof n.name!="string")&&e.push("Nombre de categoría requerido y debe ser texto"),n.name&&n.name.length<2&&e.push("Nombre debe tener al menos 2 caracteres"),n.fuelTypes&&!Array.isArray(n.fuelTypes)&&e.push("Tipos de combustible debe ser un array"),n.fields&&!Array.isArray(n.fields)&&e.push("Campos debe ser un array"),{isValid:e.length===0,errors:e}},Mj=(n,e=[])=>{const t=n.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"");let a=t,o=1;for(;e.some(c=>c.id===a);)a=`${t}_${o}`,o++;return a},vl="combustibles_vehicles",vt={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},Oj=async n=>{try{if(TL(n),await ey(n.vehicleId))throw new Error(`El código de vehículo '${n.vehicleId}' ya existe`);const t={...n,createdAt:Ue(),updatedAt:Ue(),status:n.status||Ve.ACTIVO,totalFuelConsumed:0,totalHoursWorked:0,totalMovements:0,lastMovementDate:null,estimatedConsumptionPerHour:Vj(n)},a=await pl(Me(fe,vl),t);return console.log("✅ Vehículo creado exitosamente:",a.id),a.id}catch(e){throw console.error("❌ Error al crear vehículo:",e),new Error(`Error al crear vehículo: ${e.message}`)}},kj=async(n={})=>{try{let e=Me(fe,vl);n.type&&(e=Ee(e,Se("type","==",n.type))),n.status&&(e=Ee(e,Se("status","==",n.status))),n.fuelType&&(e=Ee(e,Se("fuelType","==",n.fuelType))),n.location&&(e=Ee(e,Se("currentLocation","==",n.location))),e=Ee(e,An("vehicleId","asc"));const t=await ft(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,lastMovementDate:o.data().lastMovementDate?.toDate?.()||o.data().lastMovementDate,lastMaintenanceDate:o.data().lastMaintenanceDate?.toDate?.()||o.data().lastMaintenanceDate})}),a}catch(e){throw console.error("❌ Error al obtener vehículos:",e),new Error(`Error al obtener vehículos: ${e.message}`)}},ey=async n=>{try{const e=Ee(Me(fe,vl),Se("vehicleId","==",n)),t=await ft(e);if(t.empty)return null;const a=t.docs[0];return{id:a.id,...a.data(),createdAt:a.data().createdAt?.toDate?.()||a.data().createdAt,updatedAt:a.data().updatedAt?.toDate?.()||a.data().updatedAt,lastMovementDate:a.data().lastMovementDate?.toDate?.()||a.data().lastMovementDate,lastMaintenanceDate:a.data().lastMaintenanceDate?.toDate?.()||a.data().lastMaintenanceDate}}catch(e){throw console.error("❌ Error al buscar vehículo por código:",e),new Error(`Error al buscar vehículo: ${e.message}`)}},Pj=async(n,e)=>{try{if(!n)throw new Error("ID de vehículo requerido");if(e.vehicleId){const o=await ey(e.vehicleId);if(o&&o.id!==n)throw new Error(`El código de vehículo '${e.vehicleId}' ya existe`)}const t={...e,updatedAt:Ue(),...e.enginePower||e.type?{estimatedConsumptionPerHour:Vj(e)}:{}},a=Je(fe,vl,n);await As(a,t),console.log("✅ Vehículo actualizado exitosamente")}catch(t){throw console.error("❌ Error al actualizar vehículo:",t),new Error(`Error al actualizar vehículo: ${t.message}`)}},ty=(n,e={})=>{try{let t=Me(fe,vl);const a=[];e.category&&a.push(Se("category","==",e.category)),e.status&&a.push(Se("status","==",e.status)),e.fuelType&&a.push(Se("fuelType","==",e.fuelType)),e.currentLocation&&a.push(Se("currentLocation","==",e.currentLocation)),a.forEach(c=>{t=Ee(t,c)}),t=Ee(t,An("updatedAt","desc"));let o=null;return qr(t,c=>{const d=Date.now();if(o&&d-o<500)return;o=d;const f=[],p={added:[],modified:[],removed:[]};c.docChanges().forEach(g=>{const y={id:g.doc.id,...g.doc.data(),createdAt:g.doc.data().createdAt?.toDate?.()||g.doc.data().createdAt,updatedAt:g.doc.data().updatedAt?.toDate?.()||g.doc.data().updatedAt,lastMovementDate:g.doc.data().lastMovementDate?.toDate?.()||g.doc.data().lastMovementDate,lastMaintenanceDate:g.doc.data().lastMaintenanceDate?.toDate?.()||g.doc.data().lastMaintenanceDate,lastHourMeterDate:g.doc.data().lastHourMeterDate?.toDate?.()||g.doc.data().lastHourMeterDate};g.type==="added"?p.added.push(y):g.type==="modified"?p.modified.push(y):g.type==="removed"&&p.removed.push({id:g.doc.id})}),c.forEach(g=>{f.push({id:g.id,...g.data(),createdAt:g.data().createdAt?.toDate?.()||g.data().createdAt,updatedAt:g.data().updatedAt?.toDate?.()||g.data().updatedAt,lastMovementDate:g.data().lastMovementDate?.toDate?.()||g.data().lastMovementDate,lastMaintenanceDate:g.data().lastMaintenanceDate?.toDate?.()||g.data().lastMaintenanceDate,lastHourMeterDate:g.data().lastHourMeterDate?.toDate?.()||g.data().lastHourMeterDate})}),n(f,null,p)},c=>{console.error("❌ Error en suscripción de vehículos:",c),n([],c)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},Lj=async(n={})=>{try{const e=await kj(n),t={totalVehicles:e.length,byType:{},byStatus:{},byFuelType:{},totalFuelConsumed:0,totalHoursWorked:0,averageConsumption:0,mostActiveVehicle:null,leastActiveVehicle:null};let a=0,o=1/0;return e.forEach(c=>{t.byType[c.type]=(t.byType[c.type]||0)+1,t.byStatus[c.status]=(t.byStatus[c.status]||0)+1,t.byFuelType[c.fuelType]=(t.byFuelType[c.fuelType]||0)+1,t.totalFuelConsumed+=c.totalFuelConsumed||0,t.totalHoursWorked+=c.totalHoursWorked||0;const d=c.totalMovements||0;d>a&&(a=d,t.mostActiveVehicle=c),d<o&&d>0&&(o=d,t.leastActiveVehicle=c)}),t.totalHoursWorked>0&&(t.averageConsumption=t.totalFuelConsumed/t.totalHoursWorked),t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},TL=n=>{const e=["vehicleId","name","type","fuelType"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!n.type||n.type.trim().length===0)throw new Error("Tipo de vehículo requerido");if(!Object.values(vt).includes(n.fuelType))throw new Error("Tipo de combustible inválido");if(n.status&&!Object.values(Ve).includes(n.status))throw new Error("Estado de vehículo inválido");if(n.enginePower&&n.enginePower<=0)throw new Error("La potencia del motor debe ser mayor a cero");if(n.fuelCapacity&&n.fuelCapacity<=0)throw new Error("La capacidad de combustible debe ser mayor a cero")},Vj=n=>{const{type:e,enginePower:t,fuelType:a}=n,o={excavadora:.04,bulldozer:.05,cargador:.035,camion:.03,camioneta:.03,grua:.045,motosierra:.02,tractor:.025,volqueta:.035,motobomba:.035,fumigadora:.025,guadana:.02,motocicleta:.015,planta_electrica:.08,otros:.03},c={[vt.DIESEL]:1,[vt.GASOLINA]:1.2,[vt.ACPM]:.95,[vt.MIXTO]:1.1},d=o[e]||.03,f=c[a]||1;return d*(t||100)*f},AL=async n=>{try{const e=Ee(Me(fe,vl),Se("category","==",n));return(await ft(e)).size}catch(e){return console.error("❌ Error al contar vehículos por categoría:",e),0}},Uj=Object.freeze(Object.defineProperty({__proto__:null,FUEL_COMPATIBILITY:vt,FUEL_TYPES:Ij,VEHICLE_STATUS:Ve,countVehiclesByCategory:AL,createVehicle:Oj,getAllVehicles:kj,getVehicleByCode:ey,getVehiclesStats:Lj,subscribeToVehicles:ty,updateVehicle:Pj},Symbol.toStringTag,{value:"Module"})),$s="combustibles_suppliers",jL=async(n,e)=>{try{const t=Ee(Me(fe,$s),Se("name","==",n.name.trim()));if(!(await ft(t)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${n.name}"`};if(n.taxId){const d=Ee(Me(fe,$s),Se("taxId","==",n.taxId.trim()));if(!(await ft(d)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${n.taxId}"`}}const o={name:n.name.trim(),taxId:n.taxId?.trim()||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson?.trim()||"",phone:n.phone?.trim()||"",email:n.email?.trim()||"",address:n.address?.trim()||"",city:n.city?.trim()||"",state:n.state?.trim()||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:Number(n.creditLimit)||0,priceList:n.priceList||{},rating:Number(n.rating)||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1,totalOrders:0,totalPurchased:0,lastOrderDate:null,averageDeliveryTime:0,createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await pl(Me(fe,$s),o)).id,...o},message:`Proveedor "${o.name}" creado exitosamente`}}catch(t){return console.error("Error creating supplier:",t),{success:!1,error:t.message}}},wL=async()=>{try{const n=Ee(Me(fe,$s),An("name","asc"));return{success:!0,data:(await ft(n)).docs.map(a=>({id:a.id,...a.data()}))}}catch(n){return console.error("Error getting suppliers:",n),{success:!1,error:n.message}}},Fj=n=>{const e=Ee(Me(fe,$s),An("name","asc"));return qr(e,t=>{const a=t.docs.map(o=>({id:o.id,...o.data()}));n(a)})},CL=async(n,e,t)=>{try{const a=await Fi(Je(fe,$s,n));if(!a.exists())return{success:!1,error:"Proveedor no encontrado"};if(e.name&&e.name.trim()!==a.data().name){const c=Ee(Me(fe,$s),Se("name","==",e.name.trim()));if(!(await ft(c)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${e.name}"`}}if(e.taxId&&e.taxId.trim()!==a.data().taxId){const c=Ee(Me(fe,$s),Se("taxId","==",e.taxId.trim()));if(!(await ft(c)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${e.taxId}"`}}const o={...e,lastUpdated:new Date,updatedBy:t};return o.name&&(o.name=o.name.trim()),o.taxId&&(o.taxId=o.taxId.trim()),o.contactPerson&&(o.contactPerson=o.contactPerson.trim()),o.phone&&(o.phone=o.phone.trim()),o.email&&(o.email=o.email.trim()),await As(Je(fe,$s,n),o),{success:!0,message:"Proveedor actualizado exitosamente"}}catch(a){return console.error("Error updating supplier:",a),{success:!1,error:a.message}}},SL=async(n,e)=>{try{return await As(Je(fe,$s,n),{status:"inactive",lastUpdated:new Date,updatedBy:e}),{success:!0,message:"Proveedor desactivado exitosamente"}}catch(t){return console.error("Error deleting supplier:",t),{success:!1,error:t.message}}},IL=async()=>{try{const n=await wL();if(!n.success)return n;const e=n.data,t={total:e.length,active:e.filter(a=>a.status==="active").length,inactive:e.filter(a=>a.status==="inactive").length,suspended:e.filter(a=>a.status==="suspended").length,preferred:e.filter(a=>a.isPreferred).length,averageRating:e.length>0?e.reduce((a,o)=>a+(o.rating||0),0)/e.length:0,byCategory:{},byType:{}};return e.forEach(a=>{const o=a.category||"sin_categoria";t.byCategory[o]=(t.byCategory[o]||0)+1}),e.forEach(a=>{const o=a.type||"sin_tipo";t.byType[o]=(t.byType[o]||0)+1}),{success:!0,data:t}}catch(n){return console.error("Error getting suppliers stats:",n),{success:!1,error:n.message}}},qj=H.createContext(),ds=()=>{const n=H.useContext(qj);if(n===void 0)throw new Error("useCombustibles must be used within a CombustiblesProvider");return n},RL=({children:n})=>{const[e,t]=H.useState(null),[a,o]=H.useState(null),[c,d]=H.useState(!0),[f,p]=H.useState(null),[g,y]=H.useState([]),[_,N]=H.useState([]),[j,x]=H.useState([]),[R,A]=H.useState([]);H.useEffect(()=>{const M=vR(Gc,async w=>{try{if(d(!0),w){t(w);let C=await Ef(w.uid);C.success||(C=await _j(w,{provider:"existing_account",appContext:"combustibles"})),C.success?o(C.userData):p("Error cargando perfil de usuario")}else t(null),o(null),y([]),N([]),x([]),A([])}catch(C){console.error("Error en autenticación:",C),p("Error de autenticación")}finally{d(!1)}});return()=>M()},[]),H.useEffect(()=>{if(e){const M=Sj(y),w=ty(x,me=>p(me.message)),C=Fj(A),D=LE.subscribeToMovements(N,me=>p(me.message));return()=>{M(),w(),C(),D()}}},[e]);const L={user:e,userProfile:a,loading:c,error:f,hasPermission:M=>a?.combustiblesPermissions?.[M]||!1,isAdmin:()=>a?.role==="admin",isCounterOrAbove:()=>a?.role==="admin"||a?.role==="contador",inventory:g,movements:_,vehicles:j,suppliers:R,setInventory:y,setMovements:N,setVehicles:x,setSuppliers:A,deleteMovement:async M=>{try{return await LE.deleteMovement(M),{success:!0}}catch(w){return console.error("Error al eliminar el movimiento en el contexto:",w),p(w.message),{success:!1,error:w.message}}},refreshInventory:async()=>{console.log("Refrescando inventario...")},refreshMovements:async()=>{console.log("Refrescando movimientos...")},refreshVehicles:async()=>{console.log("Refrescando vehículos...")},refreshSuppliers:async()=>{console.log("Refrescando proveedores...")}};return i.jsx(qj.Provider,{value:L,children:n})},DL=({children:n,currentView:e,onViewChange:t})=>{const{userProfile:a,isAdmin:o,isCounterOrAbove:c}=ds(),[d,f]=H.useState(!1),p=[{id:"dashboard",name:"Dashboard",icon:"📊",description:"Vista general",requiredPermission:null},{id:"inventory",name:"Inventario",icon:"🛢️",description:"Gestión de stock",requiredPermission:"canManageInventory"},{id:"movements",name:"Movimientos",icon:"📈",description:"Entradas y salidas",requiredPermission:"canCreateMovements"},{id:"vehicles",name:"Vehículos",icon:"🚜",description:"Maquinaria forestal",requiredPermission:null},{id:"maintenance",name:"Mantenimiento",icon:"🔧",description:"Cambios de aceite y baterías",requiredPermission:null},{id:"products",name:"Productos",icon:"🛢️",description:"Tipos de combustibles",requiredPermission:null},{id:"suppliers",name:"Proveedores",icon:"🏪",description:"Gestión de proveedores",requiredPermission:"canManageSuppliers"},{id:"reports",name:"Reportes",icon:"📋",description:"Análisis y reportes",requiredPermission:"canViewReports"},{id:"admin",name:"Administración",icon:"⚙️",description:"Gestión de usuarios",requiredPermission:"admin"}],g=j=>{t(j),f(!1)},y=j=>j?j==="admin"?o():a?.combustiblesPermissions?.[j]||!1:!0,_=p.filter(j=>y(j.requiredPermission)),N=async()=>{try{await yR(Gc)}catch(j){console.error("Error al cerrar sesión:",j)}};return i.jsxs("div",{className:"dashboard-layout",children:[i.jsx("header",{className:"dashboard-header",children:i.jsxs("div",{className:"header-content",children:[i.jsx("button",{className:"sidebar-toggle",onClick:()=>f(!d),children:"☰"}),i.jsxs("div",{className:"header-title",children:[i.jsx("h1",{children:"⛽ Gestión de Combustibles"}),i.jsx("span",{className:"subtitle",children:"Forestech Colombia"})]}),i.jsxs("div",{className:"header-user",children:[i.jsxs("div",{className:"user-info",children:[i.jsx("span",{className:"user-name",children:a?.displayName||a?.email}),i.jsx("span",{className:"user-role",children:a?.role})]}),i.jsx("div",{className:"user-avatar",children:a?.photoURL?i.jsx("img",{src:a.photoURL,alt:"Avatar"}):i.jsx("div",{className:"avatar-placeholder",children:(a?.displayName||a?.email||"U").charAt(0).toUpperCase()})}),i.jsx("button",{className:"logout-button",onClick:N,title:"Cerrar sesión",children:"🚪"})]})]})}),i.jsxs("div",{className:"dashboard-body",children:[i.jsxs("aside",{className:`dashboard-sidebar ${d?"open":""}`,children:[i.jsx("nav",{className:"sidebar-nav",children:_.map(j=>i.jsxs("button",{className:`nav-item ${e===j.id?"active":""}`,onClick:()=>g(j.id),children:[i.jsx("span",{className:"nav-icon",children:j.icon}),i.jsxs("div",{className:"nav-content",children:[i.jsx("span",{className:"nav-name",children:j.name}),i.jsx("span",{className:"nav-description",children:j.description})]})]},j.id))}),i.jsx("div",{className:"sidebar-footer",children:i.jsxs("div",{className:"user-permissions",children:[i.jsx("h4",{children:"Permisos Activos:"}),i.jsxs("div",{className:"permission-list",children:[o()&&i.jsx("span",{className:"permission admin",children:"👑 Administrador"}),c()&&i.jsx("span",{className:"permission counter",children:"📊 Gestión Operativa"}),y("canManageInventory")&&i.jsx("span",{className:"permission",children:"🛢️ Inventario"}),y("canManageVehicles")&&i.jsx("span",{className:"permission",children:"🚜 Vehículos"})]})]})})]}),i.jsx("main",{className:"dashboard-main",children:i.jsx("div",{className:"main-content",children:n})})]}),d&&i.jsx("div",{className:"sidebar-overlay",onClick:()=>f(!1)})]})},ML=(n=[])=>{if(!Array.isArray(n)||n.length===0){console.warn("📋 Inventario vacío o no válido");return}console.group("📋 Estado Actual del Inventario"),console.log(`Total de items: ${n.length}`);const e=n.reduce((o,c)=>o+(parseFloat(c.currentStock)||0),0);console.log(`Stock total: ${e.toFixed(2)} galones`);const t=n.filter(o=>typeof o.currentStock>"u"||isNaN(parseFloat(o.currentStock))||o.currentStock!==o.quantity&&typeof o.quantity<"u");t.length>0&&(console.warn(`⚠️ ${t.length} items con posibles problemas de datos:`),t.forEach(o=>{console.warn(`- ${o.fuelType||o.name||"Item sin nombre"}: currentStock=${o.currentStock}, quantity=${o.quantity}`)}));const a={};n.forEach(o=>{const c=o.fuelType||"Desconocido";a[c]||(a[c]=0),a[c]+=parseFloat(o.currentStock)||0}),console.log("Stock por tipo de combustible:"),Object.entries(a).forEach(([o,c])=>{console.log(`- ${o}: ${c.toFixed(2)} gal`)}),console.groupEnd()},OL=(n=[])=>{if(!Array.isArray(n)||n.length===0)return[];const e={},t=[];return n.forEach(a=>{const o=`${a.fuelType||""}:${a.location||""}`;e[o]?(e[o].push(a),e[o].length===2?t.push(...e[o]):e[o].length>2&&t.push(a)):e[o]=[a]}),t},FE=()=>{const{inventory:n,movements:e,vehicles:t,loading:a,error:o}=ds();H.useEffect(()=>{if(!a&&n.length>0){console.log("🔍 Ejecutando diagnóstico del inventario..."),ML(n);const g=OL(n);g.length>0&&(console.warn(`⚠️ Se detectaron ${g.length} posibles items duplicados:`),console.table(g.map(y=>({id:y.id,tipo:y.fuelType,ubicacion:y.location,stock:y.currentStock}))))}},[a,n]);const c=g=>g?g.toDate&&typeof g.toDate=="function"?g.toDate():g.seconds?new Date(g.seconds*1e3):g instanceof Date?g:new Date(g):new Date,d=H.useMemo(()=>{const g=t.filter(x=>x.status==="activo").length,y=e.filter(x=>x.status==="pendiente").length;console.log("Inventario en DashboardMain:",n.map(x=>({id:x.id,fuelType:x.fuelType,currentStock:x.currentStock,pricePerUnit:x.pricePerUnit||x.unitPrice})));const _=n.filter(x=>x.status==="active").reduce((x,R)=>{const A=parseFloat(R.currentStock)||0;return console.log(`Sumando stock de ${R.fuelType}: ${A} gal`),x+A},0),N=n.filter(x=>x.isActive!==!1).reduce((x,R)=>{const A=parseFloat(R.currentStock)||0,O=parseFloat(R.pricePerUnit||R.unitPrice)||0;return x+A*O},0),j=n.filter(x=>{const R=parseFloat(x.currentStock)||0,A=parseFloat(x.minStock)||parseFloat(x.minThreshold)||20;return x.isActive!==!1&&R<=A}).length;return{totalFuel:_,totalValue:N,lowStockAlerts:j,activeInventoryItems:n.filter(x=>x.isActive!==!1).length,activeVehicles:g,pendingMovements:y,totalMaintenance:0,overdueMaintenance:0}},[n,t,e]),f=H.useMemo(()=>e.sort((g,y)=>c(y.createdAt).getTime()-c(g.createdAt).getTime()).slice(0,5),[e]),p=g=>{const y=g.quantity||0,_=g.fuelType||"N/A";switch(g.type){case"entrada":return`Entrada de ${y} gal de ${_}.`;case"salida":return`Salida de ${y} gal para vehículo ${g.vehicleId||"N/A"}.`;case"transferencia":return`Transferencia de ${y} gal.`;case"ajuste":return`Ajuste de inventario: ${y} gal de ${_}.`;default:return"Movimiento registrado."}};return a?i.jsxs("div",{className:"dashboard-main",children:[i.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),i.jsx("p",{className:"dashboard-subtitle",children:"Cargando datos en tiempo real..."}),i.jsx("div",{className:"loading-spinner-container",children:i.jsx("div",{className:"loading-spinner"})})]}):o?i.jsxs("div",{className:"dashboard-main",children:[i.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),i.jsxs("div",{className:"error-message",children:[i.jsxs("p",{children:["⚠️ ",o]}),i.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})]}):i.jsxs("div",{className:"dashboard-main",children:[i.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),i.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del estado de combustibles y maquinaria."}),i.jsxs("div",{className:"stats-grid",children:[i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon fuel-icon",children:"🛢️"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("p",{children:"Combustible Total"}),i.jsxs("h2",{children:[ke(d.totalFuel)," gal"]})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon value-icon",children:"💰"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("p",{children:"Valor Inventario"}),i.jsx("h2",{children:Dn(d.totalValue)})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon vehicle-icon",children:"🚜"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("p",{children:"Vehículos Activos"}),i.jsx("h2",{children:ke(d.activeVehicles)})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon movement-icon",children:"🔄"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("p",{children:"Movimientos Pendientes"}),i.jsx("h2",{children:ke(d.pendingMovements)})]})]}),i.jsxs("div",{className:`stat-card ${d.lowStockAlerts>0?"alert":""}`,children:[i.jsx("div",{className:"stat-icon alert-icon",children:"⚠️"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("p",{children:"Alertas de Stock"}),i.jsx("h2",{children:ke(d.lowStockAlerts)})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon maintenance-icon",children:"🔧"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("p",{children:"Mantenimientos"}),i.jsx("h2",{children:ke(d.totalMaintenance)})]})]}),i.jsxs("div",{className:`stat-card ${d.overdueMaintenance>0?"alert":""}`,children:[i.jsx("div",{className:"stat-icon maintenance-alert-icon",children:"⏰"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("p",{children:"Mantenimientos Vencidos"}),i.jsx("h2",{children:ke(d.overdueMaintenance)})]})]})]}),i.jsxs("div",{className:"dashboard-content",children:[i.jsxs("div",{className:"dashboard-widget",children:[i.jsx("h3",{children:"Actividad Reciente"}),f.length>0?i.jsx("ul",{children:f.map(g=>i.jsxs("li",{children:[i.jsx("span",{className:`movement-type-badge ${g.type}`,children:g.type}),p(g),i.jsx("span",{className:"movement-date",children:c(g.createdAt).toLocaleDateString()})]},g.id))}):i.jsx("p",{children:"No hay movimientos recientes."})]}),i.jsxs("div",{className:"dashboard-widget",children:[i.jsx("h3",{children:"📦 Stock por Producto"}),n.length>0?i.jsx("div",{className:"products-summary",children:n.map(g=>{const y=parseFloat(g.currentStock)||0,_=parseFloat(g.minStock||g.minThreshold)||20;return i.jsxs("div",{className:"product-summary-item",children:[i.jsx("div",{className:"product-icon",children:"⛽"}),i.jsxs("div",{className:"product-info",children:[i.jsx("span",{className:"product-name",children:g.fuelType||g.name}),i.jsxs("div",{className:"product-stats",children:[i.jsxs("span",{className:"stock-value",children:[ke(y)," gal"]}),i.jsx("span",{className:`stock-status ${y<=_?"low":"normal"}`,children:y<=_?"🟡 Stock bajo":"🟢 Normal"})]})]})]},g.id)})}):i.jsx("div",{className:"no-products",children:i.jsx("p",{children:"No hay inventario registrado."})})]})]})]})},kL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const[o,c]=H.useState("name"),[d,f]=H.useState("asc"),p=x=>new Intl.NumberFormat("es-CO").format(x),g=x=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(x),y=x=>{if(!x)return"N/A";const R=new Date;let A;if(x&&typeof x=="object")if(x.seconds)A=new Date(x.seconds*1e3);else if(x.toDate&&typeof x.toDate=="function")A=x.toDate();else if(x instanceof Date)A=x;else return"N/A";else if(typeof x=="string"||typeof x=="number")A=new Date(x);else return"N/A";if(isNaN(A.getTime()))return"N/A";const O=R-A,q=Math.floor(O/(1e3*60*60)),U=Math.floor(q/24);return U>0?`${U}d`:q>0?`${q}h`:"ahora"},_=x=>{o===x?f(d==="asc"?"desc":"asc"):(c(x),f("asc"))},N=[...n].sort((x,R)=>{let A=x[o],O=R[o];if(o==="lastUpdated"){const q=U=>{if(!U)return new Date(0);if(U&&typeof U=="object"){if(U.seconds)return new Date(U.seconds*1e3);if(U.toDate&&typeof U.toDate=="function")return U.toDate();if(U instanceof Date)return U}return new Date(U)};A=q(A),O=q(O)}return A<O?d==="asc"?-1:1:A>O?d==="asc"?1:-1:0}),j=x=>o!==x?"↕️":d==="asc"?"↑":"↓";return i.jsxs("div",{className:"inventory-table-container",children:[i.jsx("div",{className:"table-wrapper",children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsxs("th",{onClick:()=>_("name"),className:"sortable",children:["Combustible ",j("name")]}),i.jsxs("th",{onClick:()=>_("location"),className:"sortable",children:["Ubicación ",j("location")]}),i.jsxs("th",{onClick:()=>_("currentStock"),className:"sortable",children:["Stock Actual ",j("currentStock")]}),i.jsxs("th",{onClick:()=>_("stockPercentage"),className:"sortable",children:["Nivel ",j("stockPercentage")]}),i.jsxs("th",{onClick:()=>_("pricePerUnit"),className:"sortable",children:["Precio ",j("pricePerUnit")]}),i.jsx("th",{children:"Valor Total"}),i.jsxs("th",{onClick:()=>_("status"),className:"sortable",children:["Estado ",j("status")]}),i.jsxs("th",{onClick:()=>_("lastUpdated"),className:"sortable",children:["Actualizado ",j("lastUpdated")]}),a&&i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:N.map(x=>{const R=il[x.fuelType],A=Ho[x.stockLevel],O=parseFloat(x.currentStock)||0,q=parseFloat(x.pricePerUnit)||0,U=parseFloat(x.maxCapacity)||0,P=parseFloat(x.stockPercentage)||0,F=O*q;return i.jsxs("tr",{className:x.needsRestock?"needs-restock":"",children:[i.jsx("td",{className:"fuel-cell",children:i.jsxs("div",{className:"fuel-info",children:[i.jsx("span",{className:"fuel-icon",style:{color:R?.color},children:R?.icon}),i.jsxs("div",{children:[i.jsx("div",{className:"fuel-name",children:R?.name}),i.jsx("div",{className:"fuel-type",children:x.fuelType})]})]})}),i.jsx("td",{children:x.location}),i.jsxs("td",{className:"stock-cell",children:[i.jsxs("div",{className:"stock-info",children:[i.jsx("span",{className:"stock-amount",children:p(O)}),i.jsxs("span",{className:"stock-unit",children:["/ ",p(U)," ",x.unit||"gal"]})]}),x.needsRestock&&i.jsx("div",{className:"restock-indicator",children:"⚠️ Bajo mínimo"})]}),i.jsx("td",{className:"level-cell",children:i.jsxs("div",{className:"level-info",children:[i.jsxs("div",{className:"level-badge",style:{backgroundColor:A?.color,color:"white"},children:[P,"%"]}),i.jsx("div",{className:"level-bar",children:i.jsx("div",{className:"level-fill",style:{width:`${P}%`,backgroundColor:A?.color}})})]})}),i.jsx("td",{className:"price-cell",children:i.jsxs("div",{className:"price-info",children:[i.jsx("span",{className:"price-amount",children:g(q)}),i.jsxs("span",{className:"price-unit",children:["/ ",x.unit||"gal"]})]})}),i.jsx("td",{className:"value-cell",children:i.jsx("span",{className:"total-value",children:g(F)})}),i.jsx("td",{className:"status-cell",children:i.jsxs("span",{className:`status-badge ${x.status}`,children:[i.jsx("span",{className:"status-dot"}),x.status==="active"?"Activo":x.status==="inactive"?"Inactivo":x.status==="maintenance"?"Mantenimiento":x.status]})}),i.jsx("td",{className:"updated-cell",children:i.jsx("span",{className:"time-ago",children:y(x.lastUpdated)})}),a&&i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"action-buttons",children:[i.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(x),title:"Editar",children:"✏️"}),i.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(x),title:"Eliminar",children:"🗑️"})]})})]},x.id)})})]})}),i.jsxs("div",{className:"table-footer",children:[i.jsxs("div",{className:"table-info",children:[N.length," items ordenados por ",o,"(",d==="asc"?"ascendente":"descendente",")"]}),i.jsxs("div",{className:"table-legend",children:[i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-dot critical"}),"Crítico"]}),i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-dot low"}),"Bajo"]}),i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-dot normal"}),"Normal"]}),i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},PL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const o=f=>new Intl.NumberFormat("es-CO").format(f),c=f=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(f),d=f=>{if(!f)return"sin fecha";try{const p=new Date;let g;f.seconds?g=new Date(f.seconds*1e3):f.toDate&&typeof f.toDate=="function"?g=f.toDate():g=new Date(f);const y=p-g,_=Math.floor(y/(1e3*60*60)),N=Math.floor(_/24);return N>0?`hace ${N} día${N>1?"s":""}`:_>0?`hace ${_} hora${_>1?"s":""}`:"hace unos minutos"}catch(p){return console.warn("Error al calcular tiempo transcurrido:",p),"fecha inválida"}};return i.jsx("div",{className:"inventory-cards-grid",children:n.map(f=>{const p=il[f.fuelType],g=Ho[f.stockLevel],y=parseFloat(f.currentStock)||0,_=parseFloat(f.pricePerUnit)||parseFloat(f.unitPrice)||0,N=parseFloat(f.maxCapacity)||parseFloat(f.capacity)||0,j=parseFloat(f.stockPercentage)||0,x=y*_;return i.jsxs("div",{className:"inventory-card",children:[i.jsxs("div",{className:"card-header",children:[i.jsxs("div",{className:"fuel-info",children:[i.jsx("span",{className:"fuel-icon",style:{color:p?.color},children:p?.icon}),i.jsxs("div",{className:"fuel-details",children:[i.jsx("h3",{children:p?.name}),i.jsx("p",{className:"location",children:f.location})]})]}),i.jsx("div",{className:"stock-status",children:i.jsxs("span",{className:"status-badge",style:{backgroundColor:g?.color,color:"white"},children:[g?.icon," ",g?.label]})})]}),i.jsxs("div",{className:"stock-progress",children:[i.jsxs("div",{className:"progress-header",children:[i.jsxs("span",{className:"stock-text",children:[o(y)," / ",o(N)," ",f.unit||"gal"]}),i.jsxs("span",{className:"percentage",children:[j,"%"]})]}),i.jsx("div",{className:"progress-bar",children:i.jsx("div",{className:"progress-fill",style:{width:`${j}%`,backgroundColor:g?.color}})}),f.needsRestock&&i.jsxs("div",{className:"restock-warning",children:["⚠️ Bajo nivel mínimo (",o(f.minThreshold||f.minStock||0)," ",f.unit||"gal",")"]})]}),i.jsxs("div",{className:"card-metrics",children:[i.jsxs("div",{className:"metric",children:[i.jsxs("span",{className:"metric-label",children:["Precio por ",f.unit||"gal",":"]}),i.jsx("span",{className:"metric-value",children:c(_)})]}),i.jsxs("div",{className:"metric",children:[i.jsx("span",{className:"metric-label",children:"Valor total:"}),i.jsx("span",{className:"metric-value",children:c(x)})]}),f.supplier&&i.jsxs("div",{className:"metric",children:[i.jsx("span",{className:"metric-label",children:"Proveedor:"}),i.jsx("span",{className:"metric-value",children:f.supplier})]})]}),i.jsxs("div",{className:"card-footer",children:[i.jsxs("div",{className:"status-info",children:[i.jsx("span",{className:`status-dot ${f.status}`}),i.jsx("span",{className:"status-text",children:f.status==="active"?"Activo":f.status==="inactive"?"Inactivo":f.status==="maintenance"?"Mantenimiento":f.status})]}),i.jsxs("div",{className:"last-update",children:["Actualizado ",d(f.updatedAt||f.lastUpdated)]})]}),a&&i.jsxs("div",{className:"card-actions",children:[i.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>e(f),title:"Editar combustible",children:"✏️ Editar"}),i.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>t(f),title:"Eliminar combustible",children:"🗑️ Eliminar"})]}),f.description&&f.description!==p?.description&&i.jsx("div",{className:"card-description",children:i.jsx("p",{children:f.description})})]},f.id)})})},LL=({item:n,onClose:e,onSuccess:t})=>{const{userProfile:a}=ds(),o=!!n,[c,d]=H.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[f,p]=H.useState({}),[g,y]=H.useState(!1);H.useEffect(()=>{o&&n&&d({fuelType:n.fuelType||"",location:n.location||"",currentStock:n.currentStock||"",maxCapacity:n.maxCapacity||"",minThreshold:n.minThreshold||"",pricePerUnit:n.pricePerUnit||"",supplier:n.supplier||"",description:n.description||"",status:n.status||"active"})},[o,n]),H.useEffect(()=>{if(c.maxCapacity&&!c.minThreshold){const R=Math.round(Number(c.maxCapacity)*.15);d(A=>({...A,minThreshold:R}))}},[c.maxCapacity,c.minThreshold]);const _=R=>{const{name:A,value:O}=R.target;d(q=>({...q,[A]:O})),f[A]&&p(q=>({...q,[A]:null}))},N=()=>{const R={};c.fuelType||(R.fuelType="Tipo de combustible es requerido"),c.location||(R.location="Ubicación es requerida"),c.maxCapacity||(R.maxCapacity="Capacidad máxima es requerida");const A=Number(c.currentStock),O=Number(c.maxCapacity),q=Number(c.minThreshold),U=Number(c.pricePerUnit);return c.currentStock&&(isNaN(A)||A<0)&&(R.currentStock="Stock actual debe ser un número válido mayor o igual a 0"),c.maxCapacity&&(isNaN(O)||O<=0)&&(R.maxCapacity="Capacidad máxima debe ser un número válido mayor a 0"),c.minThreshold&&(isNaN(q)||q<0)&&(R.minThreshold="Umbral mínimo debe ser un número válido mayor o igual a 0"),c.pricePerUnit&&(isNaN(U)||U<0)&&(R.pricePerUnit="Precio debe ser un número válido mayor o igual a 0"),A>O&&(R.currentStock="Stock actual no puede ser mayor a la capacidad máxima"),q>O&&(R.minThreshold="Umbral mínimo no puede ser mayor a la capacidad máxima"),p(R),Object.keys(R).length===0},j=async R=>{if(R.preventDefault(),!!N()){y(!0);try{let A;o?A=await xL(n.id,{location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid):A=await bL({fuelType:c.fuelType,location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid),A.success?(alert(A.message),t()):alert(`Error: ${A.error}`)}catch(A){console.error("Error saving inventory item:",A),alert("Error inesperado al guardar el item")}finally{y(!1)}}},x=il[c.fuelType];return i.jsx("div",{className:"modal-overlay",onClick:e,children:i.jsxs("div",{className:"modal-content inventory-modal",onClick:R=>R.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{children:o?"✏️ Editar Combustible":"➕ Agregar Nuevo Combustible"}),i.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),i.jsxs("form",{onSubmit:j,className:"modal-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",x&&i.jsxs("span",{className:"fuel-preview",children:[x.icon," ",x.name]})]}),i.jsxs("select",{id:"fuelType",name:"fuelType",value:c.fuelType,onChange:_,disabled:o,className:f.fuelType?"error":"",required:!0,children:[i.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(Nn).map(([R,A])=>{const O=il[A];return i.jsxs("option",{value:A,children:[O.icon," ",O.name," (",O.unit,")"]},R)})]}),f.fuelType&&i.jsx("span",{className:"error-text",children:f.fuelType})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"location",children:"Ubicación / Tanque *"}),i.jsx("input",{type:"text",id:"location",name:"location",value:c.location,onChange:_,placeholder:"ej. Tanque Principal, Depósito A, Bodega Norte",className:f.location?"error":"",required:!0}),f.location&&i.jsx("span",{className:"error-text",children:f.location})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",x&&`(${x.unit})`]}),i.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:c.currentStock,onChange:_,placeholder:"0",min:"0",step:"0.01",className:f.currentStock?"error":""}),f.currentStock&&i.jsx("span",{className:"error-text",children:f.currentStock})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad Máxima * ",x&&`(${x.unit})`]}),i.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:c.maxCapacity,onChange:_,placeholder:"1000",min:"1",step:"0.01",className:f.maxCapacity?"error":"",required:!0}),f.maxCapacity&&i.jsx("span",{className:"error-text",children:f.maxCapacity})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"minThreshold",children:["Umbral Mínimo ",x&&`(${x.unit})`,i.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),i.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:c.minThreshold,onChange:_,placeholder:"Auto: 15% de capacidad máxima",min:"0",step:"0.01",className:f.minThreshold?"error":""}),f.minThreshold&&i.jsx("span",{className:"error-text",children:f.minThreshold}),c.maxCapacity&&i.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(c.maxCapacity)*.15)," ",x?.unit||"unidades"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",x?.unit||"Unidad"]}),i.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:c.pricePerUnit,onChange:_,placeholder:"12000",min:"0",step:"0.01",className:f.pricePerUnit?"error":""}),f.pricePerUnit&&i.jsx("span",{className:"error-text",children:f.pricePerUnit})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),i.jsx("input",{type:"text",id:"supplier",name:"supplier",value:c.supplier,onChange:_,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Estado"}),i.jsxs("select",{id:"status",name:"status",value:c.status,onChange:_,children:[i.jsx("option",{value:"active",children:"Activo"}),i.jsx("option",{value:"inactive",children:"Inactivo"}),i.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"description",children:"Descripción / Notas"}),i.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:_,placeholder:"Información adicional sobre este combustible...",rows:"3"})]})]}),x&&c.maxCapacity&&i.jsxs("div",{className:"form-preview",children:[i.jsx("h4",{children:"📊 Vista Previa"}),i.jsxs("div",{className:"preview-card",children:[i.jsxs("div",{className:"preview-header",children:[i.jsxs("span",{style:{color:x.color},children:[x.icon," ",x.name]}),i.jsx("span",{children:c.location})]}),i.jsxs("div",{className:"preview-capacity",children:[c.currentStock||0," / ",c.maxCapacity," ",x.unit,c.currentStock&&c.maxCapacity&&i.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(c.currentStock)/Number(c.maxCapacity)*100),"%)"]})]}),c.pricePerUnit&&i.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(c.currentStock)||0)*Number(c.pricePerUnit))]})]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"btn btn-primary",disabled:g,children:g?"Guardando...":o?"Actualizar":"Crear"})]})]})]})})},VL=({stats:n})=>i.jsxs("div",{className:"inventory-stats",children:[i.jsxs("div",{className:"stats-grid",children:[i.jsxs("div",{className:"stat-card primary",children:[i.jsx("div",{className:"stat-icon",children:"💰"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("h3",{children:"Valor Total"}),i.jsx("div",{className:"stat-value",children:Dn(n.totalValue)}),i.jsxs("div",{className:"stat-subtitle",children:[ke(n.totalItems)," tipos de combustible"]})]})]}),i.jsxs("div",{className:"stat-card success",children:[i.jsx("div",{className:"stat-icon",children:"✅"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("h3",{children:"Items Activos"}),i.jsx("div",{className:"stat-value",children:n.activeItems}),i.jsxs("div",{className:"stat-subtitle",children:[Math.round(n.activeItems/n.totalItems*100),"% del total"]})]})]}),i.jsxs("div",{className:`stat-card ${n.lowStockItems>0?"warning":"info"}`,children:[i.jsx("div",{className:"stat-icon",children:n.lowStockItems>0?"⚠️":"📊"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("h3",{children:"Stock Bajo"}),i.jsx("div",{className:"stat-value",children:n.lowStockItems}),i.jsx("div",{className:"stat-subtitle",children:n.lowStockItems>0?"Requieren atención":"Niveles normales"})]})]}),i.jsxs("div",{className:"stat-card info",children:[i.jsx("div",{className:"stat-icon",children:"📈"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("h3",{children:"Nivel Promedio"}),i.jsxs("div",{className:"stat-value",children:[n.averageStockLevel,"%"]}),i.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),i.jsxs("div",{className:"fuel-type-summary",children:[i.jsx("h4",{children:"📊 Resumen por Tipo de Combustible"}),i.jsx("div",{className:"fuel-types-grid",children:Object.entries(n.byFuelType).map(([e,t])=>{const a=il[e],o=t.totalCapacity>0?Math.round(t.totalStock/t.totalCapacity*100):0;return i.jsxs("div",{className:"fuel-type-card",children:[i.jsxs("div",{className:"fuel-header",children:[i.jsx("span",{className:"fuel-icon",style:{color:a?.color||"#6b7280"},children:a?.icon||"⛽"}),i.jsxs("div",{className:"fuel-info",children:[i.jsx("h5",{children:a?.name||e}),i.jsxs("span",{className:"fuel-count",children:[t.count," ubicaciones"]})]})]}),i.jsxs("div",{className:"fuel-metrics",children:[i.jsxs("div",{className:"metric",children:[i.jsx("span",{className:"metric-label",children:"Stock Total:"}),i.jsxs("span",{className:"metric-value",children:[ke(t.totalStock)," ",a?.unit||"unidades"]})]}),i.jsxs("div",{className:"metric",children:[i.jsx("span",{className:"metric-label",children:"Capacidad:"}),i.jsxs("span",{className:"metric-value",children:[ke(t.totalCapacity)," ",a?.unit||"unidades"]})]}),i.jsxs("div",{className:"metric",children:[i.jsx("span",{className:"metric-label",children:"Utilización:"}),i.jsxs("span",{className:`metric-value ${o<25?"low":o>75?"high":"normal"}`,children:[o,"%"]})]}),i.jsxs("div",{className:"metric",children:[i.jsx("span",{className:"metric-label",children:"Valor:"}),i.jsx("span",{className:"metric-value",children:Dn(t.totalValue)})]})]}),i.jsx("div",{className:"progress-bar",children:i.jsx("div",{className:"progress-fill",style:{width:`${o}%`,backgroundColor:a?.color||"#6b7280"}})})]},e)})}),Object.keys(n.byFuelType).length===0&&i.jsx("div",{className:"empty-fuel-types",children:i.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),UL=()=>{const{hasPermission:n}=ds(),[e,t]=H.useState([]),[a,o]=H.useState(null),[c,d]=H.useState(!0),[f,p]=H.useState(null),[g,y]=H.useState("cards"),[_,N]=H.useState(!1),[j,x]=H.useState(null),[R,A]=H.useState("all"),[O,q]=H.useState("");H.useEffect(()=>{let S=null;return(()=>{S=Sj((M,w)=>{if(w){console.error("Error in inventory subscription:",w),p("Error cargando inventario en tiempo real");return}t(M||[]),d(!1)})})(),()=>{S&&S()}},[]),H.useEffect(()=>{(async()=>{const L=await EL();L.success&&o(L.data)})()},[e]);const U=e.filter(S=>{if(R==="active"&&S.status!=="active"||R==="low-stock"&&!S.needsRestock)return!1;if(O){const L=O.toLowerCase();return S.name.toLowerCase().includes(L)||S.location.toLowerCase().includes(L)||S.fuelType.toLowerCase().includes(L)}return!0}),P=S=>{if(!n("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}x(S),N(!0)},F=async S=>{if(!n("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`¿Estás seguro de eliminar ${S.name} de ${S.location}?

Esta acción no se puede deshacer.`))return;d(!0);const M=await NL(S.id);M.success?alert("Item eliminado exitosamente"):(p(M.error),alert(`Error al eliminar: ${M.error}`)),d(!1)},$=()=>{N(!1),x(null)},V=()=>{$()};return c&&e.length===0?i.jsxs("div",{className:"inventory-loading",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Cargando inventario..."})]}):i.jsxs("div",{className:"inventory-main",children:[i.jsxs("div",{className:"inventory-header",children:[i.jsxs("div",{className:"header-title",children:[i.jsx("h2",{children:"🛢️ Gestión de Inventario"}),i.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),i.jsx("div",{className:"inventory-info",children:i.jsxs("span",{className:"info-text",children:["💡 Los combustibles se agregan automáticamente desde la pestaña ",i.jsx("strong",{children:"Movimientos"})]})})]}),a&&i.jsx(VL,{stats:a}),i.jsxs("div",{className:"inventory-controls",children:[i.jsxs("div",{className:"search-filters",children:[i.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicación o tipo...",value:O,onChange:S=>q(S.target.value),className:"search-input"}),i.jsxs("select",{value:R,onChange:S=>A(S.target.value),className:"filter-select",children:[i.jsx("option",{value:"all",children:"Todos los items"}),i.jsx("option",{value:"active",children:"Solo activos"}),i.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),i.jsxs("div",{className:"view-toggle",children:[i.jsx("button",{className:`toggle-btn ${g==="cards"?"active":""}`,onClick:()=>y("cards"),children:"📱 Cards"}),i.jsx("button",{className:`toggle-btn ${g==="table"?"active":""}`,onClick:()=>y("table"),children:"📊 Tabla"})]})]}),f&&i.jsxs("div",{className:"error-banner",children:[i.jsxs("span",{children:["⚠️ ",f]}),i.jsx("button",{onClick:()=>p(null),children:"✕"})]}),i.jsx("div",{className:"inventory-content",children:U.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"empty-icon",children:"📦"}),i.jsx("h3",{children:"No hay items de inventario"}),i.jsx("p",{children:O||R!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaña Movimientos para crear una ENTRADA de combustible"})]}):i.jsx(i.Fragment,{children:g==="cards"?i.jsx(PL,{items:U,onEdit:P,onDelete:F,canManage:n("canManageInventory")}):i.jsx(kL,{items:U,onEdit:P,onDelete:F,canManage:n("canManageInventory")})})}),U.length>0&&i.jsx("div",{className:"results-footer",children:i.jsxs("p",{children:["Mostrando ",U.length," de ",e.length," items",O&&` · Filtro: "${O}"`,R!=="all"&&` · Estado: ${R}`]})}),_&&i.jsx(LL,{item:j,onClose:$,onSuccess:V})]})},FL=({stats:n,filters:e})=>{if(!n)return null;const t=(d,f)=>f===0?d>0?100:0:((d-f)/f*100).toFixed(1),a=d=>{switch(d){case ue.ENTRADA:return"#10b981";case ue.SALIDA:return"#ef4444";case ue.TRANSFERENCIA:return"#3b82f6";case ue.AJUSTE:return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case ue.ENTRADA:return"📥";case ue.SALIDA:return"📤";case ue.TRANSFERENCIA:return"🔄";case ue.AJUSTE:return"⚖️";default:return"📋"}},c=t(n.thisMonth,n.lastMonth);return i.jsxs("div",{className:"movements-stats",children:[i.jsxs("div",{className:"stats-grid",children:[i.jsxs("div",{className:"stat-card primary",children:[i.jsx("div",{className:"stat-icon",children:"📊"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:ke(n.totalMovements)}),i.jsx("div",{className:"stat-label",children:"Total Movimientos"}),i.jsxs("div",{className:"stat-trend",children:[i.jsxs("span",{className:`trend ${c>=0?"positive":"negative"}`,children:[c>=0?"📈":"📉"," ",Math.abs(c),"%"]}),i.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:"💰"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:Dn(n.totalValue)}),i.jsx("div",{className:"stat-label",children:"Valor Total"}),i.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Dn(n.averageValue)]})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:"⛽"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:ke(n.totalQuantity)}),i.jsx("div",{className:"stat-label",children:"Galones Total"}),i.jsxs("div",{className:"stat-secondary",children:["Promedio: ",ke(n.totalQuantity/(n.totalMovements||1))," gal/mov"]})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:"📅"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:ke(n.thisWeek)}),i.jsx("div",{className:"stat-label",children:"Esta Semana"}),i.jsxs("div",{className:"stat-secondary",children:[ke(n.thisMonth)," este mes"]})]})]})]}),i.jsxs("div",{className:"stats-breakdown",children:[i.jsxs("div",{className:"breakdown-section",children:[i.jsx("h4",{children:"📋 Por Tipo de Movimiento"}),i.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1);return i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-header",children:[i.jsx("span",{className:"breakdown-icon",children:o(d)}),i.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),i.jsx("div",{className:"breakdown-value",children:f}),i.jsx("div",{className:"breakdown-bar",children:i.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:a(d)}})}),i.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),i.jsxs("div",{className:"breakdown-section",children:[i.jsx("h4",{children:"⚡ Por Estado"}),i.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),g=_=>{switch(_){case gt.COMPLETADO:return"#10b981";case gt.PENDIENTE:return"#f59e0b";case gt.CANCELADO:return"#ef4444";default:return"#6b7280"}},y=_=>{switch(_){case gt.COMPLETADO:return"✅";case gt.PENDIENTE:return"⏳";case gt.CANCELADO:return"❌";default:return"❓"}};return i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-header",children:[i.jsx("span",{className:"breakdown-icon",children:y(d)}),i.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),i.jsx("div",{className:"breakdown-value",children:f}),i.jsx("div",{className:"breakdown-bar",children:i.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:g(d)}})}),i.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),i.jsxs("div",{className:"breakdown-section",children:[i.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),i.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),g=y=>{switch(y?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}};return i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-header",children:[i.jsx("span",{className:"breakdown-icon",children:g(d)}),i.jsx("span",{className:"breakdown-label",children:d})]}),i.jsx("div",{className:"breakdown-value",children:f}),i.jsx("div",{className:"breakdown-bar",children:i.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:"#059669"}})}),i.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]})]}),(e.type||e.status||e.fuelType||e.vehicleId)&&i.jsxs("div",{className:"active-filters",children:[i.jsx("h4",{children:"🔍 Filtros Activos"}),i.jsxs("div",{className:"filters-list",children:[e.type&&i.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&i.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&i.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.vehicleId&&i.jsxs("span",{className:"filter-tag",children:["Vehículo: ",e.vehicleId]})]})]})]})},qL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,totalResults:c})=>{const[d,f]=H.useState(!1),p=[{value:"Diesel",label:"Diesel 🚛"},{value:"Gasolina",label:"Gasolina 🚗"},{value:"ACPM",label:"ACPM 🚚"},{value:"Lubricante",label:"Lubricante 🛢️"}],g=[{value:"all",label:"Todos los períodos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este año"}],y=Object.values(n).filter(j=>j&&j!==""&&j!=="all").length,_=(j,x)=>{e({[j]:x})},N=j=>{e(j)};return i.jsxs("div",{className:"movements-filters",children:[i.jsxs("div",{className:"filters-main",children:[i.jsx("div",{className:"search-section",children:i.jsxs("div",{className:"search-box",children:[i.jsx("span",{className:"search-icon",children:"🔍"}),i.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehículo, referencia...",value:a,onChange:j=>o(j.target.value),className:"search-input"}),a&&i.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),i.jsxs("div",{className:"filters-controls",children:[i.jsxs("div",{className:"quick-filters",children:[i.jsx("button",{className:`quick-filter ${n.type===ue.ENTRADA?"active":""}`,onClick:()=>N({type:ue.ENTRADA}),children:"📥 Entradas"}),i.jsx("button",{className:`quick-filter ${n.type===ue.SALIDA?"active":""}`,onClick:()=>N({type:ue.SALIDA}),children:"📤 Salidas"}),i.jsx("button",{className:`quick-filter ${n.status===gt.PENDIENTE?"active":""}`,onClick:()=>N({status:gt.PENDIENTE}),children:"⏳ Pendientes"})]}),i.jsxs("button",{className:`btn-advanced-filters ${d?"active":""}`,onClick:()=>f(!d),children:["🎛️ Filtros",y>0&&i.jsx("span",{className:"filters-count",children:y})]}),i.jsx("div",{className:"view-indicator",children:i.jsx("span",{className:"view-info",children:"📋 Vista Tabla"})})]})]}),d&&i.jsxs("div",{className:"filters-advanced",children:[i.jsxs("div",{className:"filters-grid",children:[i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Tipo de Movimiento"}),i.jsxs("select",{value:n.type,onChange:j=>_("type",j.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"Todos los tipos"}),i.jsx("option",{value:ue.ENTRADA,children:"📥 Entrada"}),i.jsx("option",{value:ue.SALIDA,children:"📤 Salida"}),i.jsx("option",{value:ue.TRANSFERENCIA,children:"🔄 Transferencia"}),i.jsx("option",{value:ue.AJUSTE,children:"⚖️ Ajuste"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Estado"}),i.jsxs("select",{value:n.status,onChange:j=>_("status",j.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"Todos los estados"}),i.jsx("option",{value:gt.PENDIENTE,children:"⏳ Pendiente"}),i.jsx("option",{value:gt.COMPLETADO,children:"✅ Completado"}),i.jsx("option",{value:gt.CANCELADO,children:"❌ Cancelado"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Tipo de Combustible"}),i.jsxs("select",{value:n.fuelType,onChange:j=>_("fuelType",j.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"Todos los combustibles"}),p.map(j=>i.jsx("option",{value:j.value,children:j.label},j.value))]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Período"}),i.jsx("select",{value:n.dateRange,onChange:j=>_("dateRange",j.target.value),className:"filter-select",children:g.map(j=>i.jsx("option",{value:j.value,children:j.label},j.value))})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Vehículo/Equipo"}),i.jsx("input",{type:"text",placeholder:"ID del vehículo...",value:n.vehicleId,onChange:j=>_("vehicleId",j.target.value),className:"filter-input"})]})]}),i.jsxs("div",{className:"filters-actions",children:[i.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:y===0,children:"🗑️ Limpiar Filtros"}),i.jsxs("div",{className:"filters-info",children:[i.jsxs("span",{className:"results-count",children:[c," resultado",c!==1?"s":""]}),y>0&&i.jsxs("span",{className:"active-filters-text",children:["(",y," filtro",y!==1?"s":""," activo",y!==1?"s":"",")"]})]})]})]}),i.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:i.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},BL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,onDelete:c,userRole:d})=>{const[f,p]=H.useState("createdAt"),[g,y]=H.useState("desc"),_=P=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(P),N=P=>P?(P instanceof Date?P:new Date(P)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",j=P=>{switch(P){case ue.ENTRADA:return"📥";case ue.SALIDA:return"📤";case ue.TRANSFERENCIA:return"🔄";case ue.AJUSTE:return"⚖️";default:return"📋"}},x=P=>{switch(P?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},R=P=>{switch(P){case gt.COMPLETADO:return"✅";case gt.PENDIENTE:return"⏳";case gt.CANCELADO:return"❌";default:return"❓"}},A=P=>{switch(P){case gt.COMPLETADO:return"status-completado";case gt.PENDIENTE:return"status-pendiente";case gt.CANCELADO:return"status-cancelado";default:return"status-default"}},O=P=>{f===P?y(g==="asc"?"desc":"asc"):(p(P),y("asc"))},q=[...n].sort((P,F)=>{let $=P[f],V=F[f];return(f.includes("Date")||f.includes("At"))&&($=new Date($),V=new Date(V)),typeof $=="number"&&typeof V=="number"?g==="asc"?$-V:V-$:typeof $=="string"&&typeof V=="string"?g==="asc"?$.localeCompare(V):V.localeCompare($):$ instanceof Date&&V instanceof Date?g==="asc"?$-V:V-$:0}),U=P=>f!==P?"↕️":g==="asc"?"↑":"↓";return i.jsxs("div",{className:"movements-table-container",children:[i.jsx("div",{className:"table-wrapper",children:i.jsxs("table",{className:"movements-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsxs("th",{className:"sortable",onClick:()=>O("type"),children:["Tipo ",U("type")]}),i.jsxs("th",{className:"sortable",onClick:()=>O("fuelType"),children:["Combustible ",U("fuelType")]}),i.jsxs("th",{className:"sortable text-right",onClick:()=>O("quantity"),children:["Cantidad ",U("quantity")]}),i.jsxs("th",{className:"sortable text-right",onClick:()=>O("unitPrice"),children:["Precio/Gal ",U("unitPrice")]}),i.jsxs("th",{className:"sortable text-right",onClick:()=>O("totalValue"),children:["Valor Total ",U("totalValue")]}),i.jsx("th",{children:"Vehículo"}),i.jsx("th",{children:"Ubicación"}),i.jsxs("th",{className:"sortable",onClick:()=>O("status"),children:["Estado ",U("status")]}),i.jsxs("th",{className:"sortable",onClick:()=>O("createdAt"),children:["Fecha ",U("createdAt")]}),i.jsx("th",{className:"actions-column",children:"Acciones"})]})}),i.jsx("tbody",{children:q.map(P=>i.jsxs("tr",{className:`movement-row ${P.status===gt.PENDIENTE?"pending-row":""}`,children:[i.jsx("td",{className:"type-cell",children:i.jsxs("div",{className:"type-content",children:[i.jsx("span",{className:"type-icon",children:j(P.type)}),i.jsx("span",{className:"type-text",children:P.type.charAt(0).toUpperCase()+P.type.slice(1)})]})}),i.jsx("td",{className:"fuel-cell",children:i.jsxs("div",{className:"fuel-content",children:[i.jsx("span",{className:"fuel-icon",children:x(P.fuelType)}),i.jsx("span",{className:"fuel-text",children:P.fuelType})]})}),i.jsxs("td",{className:"quantity-cell text-right",children:[i.jsx("span",{className:"quantity-value",children:P.quantity}),i.jsx("span",{className:"quantity-unit",children:"gal"})]}),i.jsx("td",{className:"price-cell text-right",children:_(P.unitPrice)}),i.jsx("td",{className:"value-cell text-right",children:i.jsx("strong",{children:_(P.totalValue)})}),i.jsx("td",{className:"vehicle-cell",children:P.vehicleId?i.jsxs("span",{className:"vehicle-id",children:["🚜 ",P.vehicleId]}):i.jsx("span",{className:"no-vehicle",children:"-"})}),i.jsx("td",{className:"location-cell",children:i.jsxs("span",{className:"location-text",children:["📍 ",P.type===ue.ENTRADA?P.destinationLocation||"Sin ubicación":P.location||"Principal"]})}),i.jsx("td",{className:"status-cell",children:i.jsxs("div",{className:`status-badge ${A(P.status)}`,children:[i.jsx("span",{className:"status-icon",children:R(P.status)}),i.jsx("span",{className:"status-text",children:P.status.charAt(0).toUpperCase()+P.status.slice(1)})]})}),i.jsx("td",{className:"date-cell",children:i.jsxs("div",{className:"date-content",children:[i.jsx("span",{className:"date-value",children:N(P.createdAt)}),P.reference&&i.jsxs("span",{className:"reference-small",children:["#",P.reference]})]})}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"action-buttons",children:[i.jsx("button",{className:"btn-action btn-view",onClick:()=>t(P),title:"Ver detalles",children:"👁️"}),d==="admin"&&P.status===gt.PENDIENTE&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"btn-action btn-approve",onClick:()=>a(P.id),title:"Aprobar movimiento",children:"✓"}),i.jsx("button",{className:"btn-action btn-reject",onClick:()=>o(P.id),title:"Rechazar movimiento",children:"✗"})]}),e&&P.status===gt.PENDIENTE&&i.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(P),title:"Editar movimiento",children:"✏️"}),d==="admin"&&i.jsx("button",{className:"btn-action btn-delete",onClick:()=>{window.confirm("¿Estás seguro de que deseas eliminar este movimiento? Esta acción no se puede deshacer.")&&c(P.id)},title:"Eliminar movimiento",children:"🗑️"})]})})]},P.id))})]})}),i.jsxs("div",{className:"table-info",children:[i.jsxs("div",{className:"table-summary",children:[i.jsxs("span",{className:"total-rows",children:[n.length," movimiento",n.length!==1?"s":""]}),f&&i.jsxs("span",{className:"sort-info",children:["Ordenado por ",f," (",g==="asc"?"ascendente":"descendente",")"]})]}),i.jsxs("div",{className:"table-legend",children:[i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-icon",children:"⏳"})," Pendiente"]}),i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-icon",children:"✅"})," Completado"]}),i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-icon",children:"❌"})," Cancelado"]})]})]})]})},zL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,onDelete:c,userRole:d})=>i.jsx(BL,{movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,onDelete:c,userRole:d}),ja={ACPM:"ACPM",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},Bj={[ja.ACPM]:{name:"ACPM",displayName:"ACPM 🚛",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"🚛",description:"Combustible diesel para vehículos pesados"},[ja.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina 🚗",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"🚗",description:"Gasolina corriente para vehículos livianos"},[ja.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidráulico 🔧",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"🔧",description:"Aceite hidráulico para sistemas de maquinaria"},[ja.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 🛢️",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"🛢️",description:"Aceite multigrado para motores"},[ja.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja 🟥",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"🟥",description:"Grasa lubricante multipropósito"},[ja.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ⚙️",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"⚙️",description:"Aceite para transmisiones y diferenciales"},[ja.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Líquido para Frenos 🛑",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"🛑",description:"Líquido de frenos DOT 3/4"},[ja.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga 🌿",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"🌿",description:"Mezcla de combustible para equipos menores"},[ja.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 🚜",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"🚜",description:"Aceite especializado para tractores"}},zs={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},qE=()=>Object.values(Bj),BE="combustibles_products",HL=async()=>{try{console.log("🔄 Verificando productos existentes...");const n=Ee(Me(fe,BE),LO(1));if(!(await ft(n)).empty){console.log("✅ Productos ya existen en Firebase");return}console.log("📦 Creando productos predefinidos...");const t=Object.values(Bj).map(async o=>{const c={name:o.name,displayName:o.displayName,category:o.category,unit:o.unit,defaultPrice:o.defaultPrice,color:o.color,icon:o.icon,description:o.description,isActive:!0,createdAt:new Date,updatedAt:new Date,createdBy:"system-initialization"},d=Je(Me(fe,BE));return await gf(d,c),console.log(`✅ Producto creado: ${o.displayName}`),{id:d.id,...c}}),a=await Promise.all(t);return console.log(`🎉 ${a.length} productos inicializados correctamente`),a}catch(n){throw console.error("❌ Error inicializando productos:",n),n}},GL=async()=>{try{await HL()}catch(n){console.error("❌ Error en inicialización automática:",n)}},ll="combustibles_products",Zp=async n=>{try{const e={...n,createdAt:Ue(),updatedAt:Ue()},t=await pl(Me(fe,ll),e);return console.log("Product created with ID:",t.id),t.id}catch(e){throw console.error("Error creating product:",e),e}},$L=async(n,e)=>{try{const t=Je(fe,ll,n);await As(t,{...e,updatedAt:Ue()}),console.log("Product updated successfully")}catch(t){throw console.error("Error updating product:",t),t}},YL=async n=>{try{await vf(Je(fe,ll,n)),console.log("Product deleted successfully")}catch(e){throw console.error("Error deleting product:",e),e}},QL=async()=>{try{await GL(),console.log("🔍 Obteniendo productos activos...");const n=Ee(Me(fe,ll),Se("isActive","==",!0),An("name")),t=(await ft(n)).docs.map(a=>({id:a.id,...a.data()}));return console.log(`✅ Productos activos obtenidos: ${t.length}`),t}catch(n){if(console.error("❌ Error obteniendo productos activos:",n),n.code==="failed-precondition"||n.message.includes("index")){console.warn("⚠️ Índice no disponible, usando consulta alternativa...");try{const e=Ee(Me(fe,ll),Se("isActive","==",!0)),o=(await ft(e)).docs.map(c=>({id:c.id,...c.data()})).sort((c,d)=>(c.name||"").localeCompare(d.name||""));return console.log(`✅ Productos activos obtenidos (ordenamiento en cliente): ${o.length}`),o}catch(e){throw console.error("❌ Error en consulta alternativa:",e),e}}throw n}},KL=(n,e)=>{try{const t=Ee(Me(fe,ll),An("name"));return qr(t,a=>{const o=a.docs.map(c=>({id:c.id,...c.data()}));n(o)},a=>{console.error("Error in products subscription:",a),e(a)})}catch(t){return console.error("Error setting up products subscription:",t),e(t),()=>{}}},XL=({formData:n,updateFormData:e,setError:t})=>{const a=[{type:ue.ENTRADA,icon:"📥",title:"Entrada",description:"Compra o reabastecimiento de combustible",color:"entrada",details:"Registra combustible que llega desde proveedores"},{type:ue.SALIDA,icon:"📤",title:"Salida",description:"Consumo de combustible por vehículos",color:"salida",details:"Asigna combustible a vehículos y equipos"},{type:ue.TRANSFERENCIA,icon:"🔄",title:"Transferencia",description:"Movimiento entre ubicaciones",color:"transferencia",details:"Traslada combustible entre tanques o sitios"},{type:ue.AJUSTE,icon:"⚖️",title:"Ajuste",description:"Corrección de inventario",color:"ajuste",details:"Ajusta stock por mermas, pérdidas o calibraciones"}],o=c=>{e("type",c),t("")};return i.jsx("div",{className:`wizard-step step-movement-type ${isActive?"active":""}`,children:i.jsxs("div",{className:"typeform-layout",children:[i.jsxs("div",{className:"typeform-question",children:[i.jsx("h3",{children:"🍀 ¿Qué tipo de operación realizarás?"}),i.jsx("p",{children:"Selecciona el tipo de movimiento que necesitas registrar:"})]}),i.jsx("div",{className:"typeform-options",children:a.map(c=>i.jsxs("div",{className:`typeform-option ${n.type===c.type?"selected":""} ${c.color}`,onClick:()=>o(c.type),children:[i.jsx("div",{className:"typeform-option-icon",children:c.icon}),i.jsxs("div",{className:"typeform-option-content",children:[i.jsx("h4",{children:c.title}),i.jsx("p",{children:c.description})]}),i.jsx("div",{className:"typeform-option-selector",children:i.jsx("div",{className:"typeform-check",children:i.jsx("span",{className:"typeform-check-icon",children:"✓"})})})]},c.type))}),n.type&&i.jsx("div",{className:"selection-confirmation",children:i.jsxs("div",{className:"confirmation-card",children:[i.jsx("span",{className:"confirmation-icon",children:a.find(c=>c.type===n.type)?.icon}),i.jsxs("div",{className:"confirmation-text",children:[i.jsx("strong",{children:"Seleccionado:"})," ",a.find(c=>c.type===n.type)?.title,i.jsx("br",{}),i.jsx("small",{children:a.find(c=>c.type===n.type)?.description})]})]})})]})})},WL=({formData:n,updateFormData:e,systemData:t,setError:a})=>{const[o,c]=H.useState(!1),[d,f]=H.useState(null),{products:p}=t;H.useEffect(()=>{if(n.fuelType&&p.length>0){const y=p.find(_=>_.name===n.fuelType||_.displayName===n.fuelType);f(y),y&&y.defaultPrice&&!n.unitPrice&&e("unitPrice",y.defaultPrice.toString())}},[n.fuelType,n.unitPrice,p,e]);const g=async(y,_)=>{c(!0),a("");try{await new Promise(N=>setTimeout(N,800)),e("fuelType",y),f(_),_.defaultPrice&&e("unitPrice",_.defaultPrice.toString()),console.log("🔄 [Step2] Combustible seleccionado:",y,"Precio:",_.defaultPrice),console.log("🔍 [Step2] FormData después de actualización:",{fuelType:y,unitPrice:_.defaultPrice})}catch(N){console.error("Error al cargar combustible:",N),a("Error al cargar información del combustible")}finally{c(!1)}};return p.length===0?i.jsx("div",{className:`wizard-step step-fuel-type ${isActive?"active":""}`,children:i.jsx("div",{className:"typeform-layout",children:i.jsxs("div",{className:"loading-state",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"🔄 Cargando productos disponibles..."})]})})}):i.jsx("div",{className:`wizard-step step-fuel-type ${isActive?"active":""}`,children:i.jsxs("div",{className:"typeform-layout",children:[i.jsxs("div",{className:"typeform-question",children:[i.jsx("h3",{children:"⛽ ¿Qué combustible vas a mover?"}),i.jsx("p",{children:"Selecciona el producto del inventario:"})]}),o&&i.jsxs("div",{className:"loading-overlay",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"📡 Solicitando precios actualizados..."})]}),i.jsx("div",{className:"typeform-options",children:p.map(y=>i.jsxs("div",{className:`typeform-option ${n.fuelType===y.name?"selected":""} ${o?"disabled":""}`,onClick:()=>!o&&g(y.name,y),children:[i.jsx("div",{className:"typeform-option-icon",children:y.icon||"🛢️"}),i.jsxs("div",{className:"typeform-option-content",children:[i.jsx("h4",{children:y.displayName||y.name}),i.jsx("p",{children:y.description||"Combustible"}),y.defaultPrice&&i.jsxs("div",{className:"fuel-price",children:[i.jsx("span",{className:"price-label",children:"Precio actual:"}),i.jsxs("span",{className:"price-value",children:["$",y.defaultPrice.toLocaleString("es-CO")," COP/gal"]})]})]}),i.jsx("div",{className:"typeform-option-selector",children:i.jsx("div",{className:"typeform-check",children:i.jsx("span",{className:"typeform-check-icon",children:"✓"})})})]},y.id))}),d&&n.fuelType&&i.jsx("div",{className:"selection-confirmation",children:i.jsxs("div",{className:"confirmation-card fuel-confirmation",children:[i.jsxs("div",{className:"confirmation-header",children:[i.jsx("span",{className:"confirmation-icon",children:d.icon||"🛢️"}),i.jsxs("div",{className:"confirmation-text",children:[i.jsx("strong",{children:d.displayName||d.name}),i.jsx("br",{}),i.jsx("small",{children:d.description||"Combustible seleccionado"})]})]}),d.defaultPrice&&i.jsxs("div",{className:"price-confirmation",children:[i.jsxs("div",{className:"price-info",children:[i.jsx("span",{className:"price-label",children:"💰 Precio por galón:"}),i.jsxs("span",{className:"price-amount",children:["$",d.defaultPrice.toLocaleString("es-CO")," COP"]})]}),i.jsx("small",{className:"price-note",children:"✨ Precio aplicado automáticamente (puedes modificarlo más adelante)"})]})]})})]})})},ZL=({formData:n,updateFormData:e,systemData:t,setError:a})=>{const[o,c]=H.useState(!1),[d,f]=H.useState({}),[p,g]=H.useState(!1),{suppliers:y,inventory:_}=t,N=n.type===ue.ENTRADA;H.useEffect(()=>{(async()=>{if(!N&&n.fuelType&&_.length>0){g(!0),await new Promise(A=>setTimeout(A,600));const R={};console.log("🔍 DEBUG Step3 - Datos para validación:",{fuelType:n.fuelType,inventoryTotal:_.length,inventarioMuestra:_.slice(0,2),operationalLocations:Ei}),Ei.forEach(A=>{const O=_.filter($=>$.fuelType===n.fuelType&&$.location?.toLowerCase()===A.toLowerCase()&&$.status==="active");console.log(`🔍 DEBUG ${A}:`,{itemsEncontrados:O.length,detalles:O.map($=>({id:$.id,fuelType:$.fuelType,location:$.location,status:$.status,currentStock:$.currentStock,maxCapacity:$.maxCapacity}))});const q=O.reduce(($,V)=>$+(parseFloat(V.currentStock)||0),0),U=_.filter($=>$.fuelType===n.fuelType&&$.location?.toLowerCase()===A.toLowerCase()&&$.status==="active").reduce(($,V)=>$+(parseFloat(V.maxCapacity)||0),0);let P="available",F=`${q.toFixed(1)} gal disponibles`;q===0?(P="empty",F="Sin stock disponible"):q<U*.2&&(P="low",F=`${q.toFixed(1)} gal (stock bajo)`),R[A]={available:q,maxCapacity:U,status:P,message:F,percentage:U>0?q/U*100:0}}),f(R),g(!1),console.log("🔍 Stock validado por ubicación:",R)}})()},[n.fuelType,N,_]);const j=async x=>{c(!0),a("");try{await new Promise(R=>setTimeout(R,400)),e(N?"supplierName":"location",x),console.log("📍 Ubicación seleccionada:",x)}catch(R){console.error("Error al validar ubicación:",R),a("Error al validar la ubicación")}finally{c(!1)}};if(N){const x=y.filter(R=>R.status==="active");return i.jsx("div",{className:`wizard-step step-location ${isActive?"active":""}`,children:i.jsxs("div",{className:"typeform-layout",children:[i.jsxs("div",{className:"typeform-question",children:[i.jsx("h3",{children:"🏪 ¿De qué proveedor viene el combustible?"}),i.jsx("p",{children:"Selecciona el proveedor de origen:"})]}),o&&i.jsxs("div",{className:"loading-overlay",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"🔄 Validando proveedor..."})]}),i.jsx("div",{className:"typeform-options",children:x.map(R=>i.jsxs("div",{className:`typeform-option ${n.supplierName===R.name?"selected":""} ${o?"disabled":""}`,onClick:()=>!o&&j(R.name),children:[i.jsx("div",{className:"typeform-option-icon",children:"🏪"}),i.jsxs("div",{className:"typeform-option-content",children:[i.jsx("h4",{children:R.name}),i.jsx("p",{children:R.city})]}),i.jsx("div",{className:"typeform-option-selector",children:i.jsx("div",{className:"typeform-check",children:i.jsx("span",{className:"typeform-check-icon",children:"✓"})})})]},R.id))}),n.supplierName&&i.jsx("div",{className:"selection-confirmation",children:i.jsxs("div",{className:"confirmation-card",children:[i.jsx("span",{className:"confirmation-icon",children:"🏪"}),i.jsxs("div",{className:"confirmation-text",children:[i.jsx("strong",{children:"Proveedor:"})," ",n.supplierName,i.jsx("br",{}),i.jsx("small",{children:"Origen del combustible confirmado"})]})]})})]})})}return i.jsx("div",{className:`wizard-step step-location ${isActive?"active":""}`,children:i.jsxs("div",{className:"typeform-layout",children:[i.jsxs("div",{className:"typeform-question",children:[i.jsx("h3",{children:"📍 ¿De qué ubicación sale el combustible?"}),i.jsx("p",{children:"Selecciona la ubicación de origen:"})]}),p&&i.jsxs("div",{className:"loading-overlay",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"🔍 Verificando stock disponible..."})]}),i.jsx("div",{className:"typeform-options",children:Ei.map(x=>{const R=d[x],A=!R||R.status!=="empty";return i.jsxs("div",{className:`typeform-option ${n.location===x?"selected":""} 
                           ${R?.status||"unknown"} ${!A||o?"disabled":""}`,onClick:()=>A&&!o&&j(x),children:[i.jsx("div",{className:"typeform-option-icon",children:"📍"}),i.jsxs("div",{className:"typeform-option-content",children:[i.jsx("h4",{children:Gs(x)}),R&&i.jsxs("div",{className:"stock-info",children:[i.jsx("p",{className:"stock-message",children:R.message}),R.available>0&&i.jsx("div",{className:"stock-bar-mini",children:i.jsx("div",{className:"stock-fill-mini",style:{width:`${Math.min(100,R.percentage)}%`}})})]})]}),i.jsx("div",{className:"typeform-option-selector",children:i.jsx("div",{className:"typeform-check",children:i.jsx("span",{className:"typeform-check-icon",children:"✓"})})})]},x)})}),n.location&&d[n.location]&&i.jsx("div",{className:"selection-confirmation",children:i.jsxs("div",{className:"confirmation-card location-confirmation",children:[i.jsxs("div",{className:"confirmation-header",children:[i.jsx("span",{className:"confirmation-icon",children:"📍"}),i.jsxs("div",{className:"confirmation-text",children:[i.jsx("strong",{children:Gs(n.location)}),i.jsx("br",{}),i.jsx("small",{children:"Ubicación de origen confirmada"})]})]}),i.jsxs("div",{className:"stock-confirmation",children:[i.jsxs("div",{className:"stock-detail",children:[i.jsx("span",{className:"stock-label",children:"📊 Stock disponible:"}),i.jsxs("span",{className:"stock-value",children:[d[n.location].available.toFixed(1)," gal"]})]}),i.jsx("div",{className:"capacity-bar",children:i.jsx("div",{className:"capacity-fill",style:{width:`${d[n.location].percentage}%`}})}),i.jsxs("small",{className:"capacity-text",children:[d[n.location].percentage.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},JL=({formData:n,updateFormData:e,systemData:t,setError:a})=>{const[o,c]=H.useState(!1),[d,f]=H.useState(null),[p,g]=H.useState(""),{inventory:y}=t,_=n.type===ue.SALIDA||n.type===ue.TRANSFERENCIA;H.useEffect(()=>{(async()=>{if(_&&n.fuelType&&n.location&&y.length>0){c(!0),await new Promise(S=>setTimeout(S,500));const R=y.filter(S=>S.fuelType===n.fuelType&&S.location?.toLowerCase()===n.location?.toLowerCase()&&S.status==="active").reduce((S,L)=>S+(parseFloat(L.currentStock)||0),0),A=y.filter(S=>S.fuelType===n.fuelType&&S.location?.toLowerCase()===n.location?.toLowerCase()&&S.status==="active").reduce((S,L)=>S+(parseFloat(L.maxCapacity)||0),0),O=parseFloat(n.quantity)||0,q=R-O,U=A>0?R/A*100:0;let P="available",F="✅",$="Stock Suficiente",V="Hay suficiente combustible disponible.";if(O>0&&(R<O?(P="critical",F="🚫",$="Stock Insuficiente",V=`Faltan ${(O-R).toFixed(2)} galones.`):q<R*.2?(P="warning",F="⚠️",$="Stock Quedará Bajo",V=`Después del movimiento quedarán ${q.toFixed(2)} galones.`):V=`Después del movimiento quedarán ${q.toFixed(2)} galones disponibles.`),f({available:R,required:O,remaining:Math.max(0,q),maxCapacity:A,capacityPercentage:U,status:P,icon:F,title:$,message:V,isValid:R>=O}),O>0&&_){const S={type:n.type===ue.SALIDA?"outbound":"transfer",fuelType:n.fuelType,quantity:n.quantity,sourceLocation:n.location},L=hL(S,y);L.isValid?L.warning?g(`⚠️ ${L.warning}`):g(""):g(`🚫 ${L.error}`)}else _||g("");c(!1)}})()},[n.quantity,n.fuelType,n.location,n.type,_,y]);const N=x=>{const R=parseFloat(x);(x===""||!isNaN(R)&&R>=0)&&(e("quantity",x),a(""))},j=()=>{if(!d||!d.available)return[];const x=d.available;return[{label:"25%",value:(x*.25).toFixed(1)},{label:"50%",value:(x*.5).toFixed(1)},{label:"75%",value:(x*.75).toFixed(1)},{label:"Todo",value:x.toFixed(1)}]};return i.jsx("div",{className:`wizard-step step-quantity ${isActive?"active":""}`,children:i.jsxs("div",{className:"typeform-layout",children:[i.jsxs("div",{className:"typeform-question",children:[i.jsx("h3",{children:"📊 ¿Cuántos galones necesitas?"}),i.jsx("p",{children:"Especifica la cantidad de combustible:"})]}),i.jsxs("div",{className:"typeform-input-section",children:[i.jsx("input",{id:"quantity",type:"number",step:"0.1",min:"0",value:n.quantity,onChange:x=>N(x.target.value),placeholder:"0.0",className:`typeform-input ${p?"error":""}`}),i.jsx("span",{className:"typeform-unit",children:"galones"})]}),d&&d.available>0&&i.jsxs("div",{className:"quantity-suggestions",children:[i.jsx("label",{children:"Cantidades sugeridas:"}),i.jsx("div",{className:"suggestion-buttons",children:j().map((x,R)=>i.jsxs("button",{type:"button",className:"suggestion-btn",onClick:()=>N(x.value),children:[x.label,i.jsx("br",{}),i.jsxs("small",{children:[x.value," gal"]})]},R))})]}),o&&i.jsxs("div",{className:"calculating-indicator",children:[i.jsx("div",{className:"loading-spinner small"}),i.jsx("span",{children:"⚙️ Calculando disponibilidad..."})]}),d&&_&&!o&&i.jsxs("div",{className:`stock-info-container ${d.status}`,children:[i.jsxs("div",{className:"stock-info-header",children:[i.jsx("div",{className:"stock-info-icon",children:d.icon}),i.jsx("h4",{className:"stock-info-title",children:d.title})]}),i.jsx("div",{className:"stock-info-message",children:d.message})]}),p&&i.jsx("div",{className:"validation-warning",children:p}),n.quantity&&parseFloat(n.quantity)>0&&i.jsx("div",{className:"selection-confirmation",children:i.jsxs("div",{className:"confirmation-card",children:[i.jsx("span",{className:"confirmation-icon",children:"📊"}),i.jsxs("div",{className:"confirmation-text",children:[i.jsx("strong",{children:"Cantidad:"})," ",parseFloat(n.quantity).toFixed(2)," galones",i.jsx("br",{}),i.jsx("small",{children:_?`Se restará del inventario de ${n.location}`:`Se añadirá al inventario de ${n.destinationLocation||"ubicación no especificada"}`})]})]})})]})})},eV=({formData:n,updateFormData:e,systemData:t,setError:a})=>{const[o,c]=H.useState(!1),[d,f]=H.useState(null),[p,g]=H.useState(!1),[y,_]=H.useState(""),{vehicles:N}=t;H.useEffect(()=>{if(n.vehicleId&&N.length>0){const A=N.find(q=>q.vehicleId===n.vehicleId);f(A);const O=j(A);g(O)}},[n.vehicleId,N]);const j=A=>{if(!A)return!1;const O=A.vehicleId?.toUpperCase(),q=O&&(O.includes("TR1")||O.includes("TR2")||O.includes("TR3")||O==="TR1"||O==="TR2"||O==="TR3"),U=A.category==="tractor"||A.type?.toLowerCase().includes("tractor");return q||U},x=async A=>{c(!0),a("");try{await new Promise(q=>setTimeout(q,600)),e("vehicleId",A.vehicleId),f(A);const O=j(A);g(O),!O&&n.currentHours&&e("currentHours",""),console.log("🚜 [Step5] Vehículo seleccionado:",A.vehicleId,"Es tractor:",O),console.log("🔍 [Step5] FormData después de selección:",{vehicleId:A.vehicleId,type:n.type,fuelType:n.fuelType,location:n.location})}catch(O){console.error("Error al validar vehículo:",O),a("Error al validar el vehículo")}finally{c(!1)}},R=A=>{const O=parseFloat(A);(A===""||!isNaN(O)&&O>=0)&&(e("currentHours",A),d?.currentHours&&O<parseFloat(d.currentHours)?_(`La lectura debe ser mayor a la anterior: ${d.currentHours} hrs`):_(""))};return n.type!==ue.SALIDA?null:N.length===0?i.jsx("div",{className:`wizard-step step-vehicle ${isActive?"active":""}`,children:i.jsx("div",{className:"typeform-layout",children:i.jsxs("div",{className:"loading-state",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"🔄 Cargando vehículos disponibles..."})]})})}):i.jsx("div",{className:`wizard-step step-vehicle ${isActive?"active":""}`,children:i.jsxs("div",{className:"typeform-layout",children:[i.jsxs("div",{className:"typeform-question",children:[i.jsx("h3",{children:"🚜 ¿A qué vehículo/equipo va el combustible?"}),i.jsx("p",{children:"Selecciona el vehículo que recibirá el combustible:"})]}),o&&i.jsxs("div",{className:"loading-overlay",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"🔄 Validando vehículo..."})]}),i.jsx("div",{className:"typeform-options",children:N.map(A=>{const O=j(A);return i.jsxs("div",{className:`typeform-option ${n.vehicleId===A.vehicleId?"selected":""} 
                           ${O?"tractor":""} ${o?"disabled":""}`,onClick:()=>!o&&x(A),children:[i.jsx("div",{className:"typeform-option-icon",children:O?"🚜":"🚚"}),i.jsxs("div",{className:"typeform-option-content",children:[i.jsxs("h4",{children:[A.vehicleId," - ",A.name]}),i.jsx("p",{children:A.type}),A.currentHours&&O&&i.jsxs("small",{className:"vehicle-hours",children:["⏱️ Horómetro: ",A.currentHours," hrs"]})]}),i.jsx("div",{className:"typeform-option-selector",children:i.jsx("div",{className:"typeform-check",children:i.jsx("span",{className:"typeform-check-icon",children:"✓"})})})]},A.id)})}),p&&d&&i.jsxs("div",{className:"typeform-input-section",children:[i.jsx("label",{htmlFor:"currentHours",children:"Horas actuales *"}),i.jsx("input",{id:"currentHours",type:"number",step:"0.1",min:"0",value:n.currentHours,onChange:A=>R(A.target.value),placeholder:"0.0",className:`typeform-input ${y?"error":""}`}),i.jsx("span",{className:"typeform-unit",children:"horas"}),d.currentHours&&i.jsxs("small",{className:"hour-meter-hint",children:["💡 Última lectura: ",d.currentHours," horas"]}),y&&i.jsx("div",{className:"field-error",children:y})]}),d&&n.vehicleId&&i.jsx("div",{className:"selection-confirmation",children:i.jsxs("div",{className:"confirmation-card vehicle-confirmation",children:[i.jsxs("div",{className:"confirmation-header",children:[i.jsx("span",{className:"confirmation-icon",children:j(d)?"🚜":"🚚"}),i.jsxs("div",{className:"confirmation-text",children:[i.jsxs("strong",{children:[d.vehicleId," - ",d.name]}),i.jsx("br",{}),i.jsx("small",{children:d.type})]})]}),i.jsxs("div",{className:"vehicle-details",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("span",{className:"detail-label",children:"📋 Tipo:"}),i.jsx("span",{className:"detail-value",children:d.type})]}),d.category&&i.jsxs("div",{className:"detail-item",children:[i.jsx("span",{className:"detail-label",children:"🏷️ Categoría:"}),i.jsx("span",{className:"detail-value",children:d.category})]}),p&&n.currentHours&&i.jsxs("div",{className:"detail-item",children:[i.jsx("span",{className:"detail-label",children:"⏱️ Horómetro:"}),i.jsxs("span",{className:"detail-value",children:[n.currentHours," hrs"]})]})]}),j(d)&&!n.currentHours&&i.jsx("div",{className:"warning-message",children:"⚠️ Se requiere lectura del horómetro para tractores"})]})})]})})},zE=({formData:n,updateFormData:e,systemData:t,setError:a,isEntryDestination:o=!1})=>{const[c,d]=H.useState(!1),[f,p]=H.useState({}),[g,y]=H.useState(!1),{inventory:_}=t;H.useEffect(()=>{(async()=>{if(n.fuelType&&n.quantity&&_.length>0&&!o){y(!0),await new Promise(O=>setTimeout(O,700));const R=parseFloat(n.quantity)||0,A={};Ei.filter(O=>o?!0:O!==n.location).forEach(O=>{const q=_.filter(M=>M.fuelType===n.fuelType&&M.location?.toLowerCase()===O.toLowerCase()&&M.status==="active").reduce((M,w)=>M+(parseFloat(w.currentStock)||0),0),U=_.filter(M=>M.fuelType===n.fuelType&&M.location?.toLowerCase()===O.toLowerCase()&&M.status==="active").reduce((M,w)=>M+(parseFloat(w.maxCapacity)||0),0),P=U-q,F=q+R,$=U>0?F/U*100:0;let V="available",S=`Capacidad: ${P.toFixed(1)} gal libres`,L=P>=R;U===0?(V="no_capacity",S="Sin tanques configurados",L=!1):P<R?(V="insufficient",S=`Insuficiente: faltan ${(R-P).toFixed(1)} gal`,L=!1):$>90&&(V="warning",S=`Quedará al ${$.toFixed(1)}% (casi lleno)`),A[O]={currentStock:q,maxCapacity:U,availableCapacity:P,afterTransfer:F,occupancyAfter:$,status:V,message:S,canAcceptTransfer:L}}),p(A),y(!1),console.log("🔍 Capacidad validada por destino:",A)}})()},[n.fuelType,n.quantity,n.location,_,o]);const N=async x=>{const R=f[x];if(!o&&!R?.canAcceptTransfer){a("Esta ubicación no puede recibir la cantidad solicitada");return}d(!0),a("");try{await new Promise(A=>setTimeout(A,500)),e("destinationLocation",x),console.log("🎯 Destino seleccionado:",x)}catch(A){console.error("Error al validar destino:",A),a("Error al validar el destino")}finally{d(!1)}};if(!o&&n.type!==ue.TRANSFERENCIA)return null;const j=o?fL:Ei.filter(x=>x!==n.location);return i.jsx("div",{className:`wizard-step step-destination ${isActive?"active":""}`,children:i.jsxs("div",{className:"typeform-layout",children:[i.jsxs("div",{className:"typeform-question",children:[i.jsxs("h3",{children:["🎯 ",o?"¿A qué ubicación llegará el combustible?":"¿Hacia qué ubicación se transfiere?"]}),i.jsx("p",{children:"Selecciona la ubicación de destino:"})]}),g&&i.jsxs("div",{className:"loading-overlay",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"🔍 Verificando capacidad disponible..."})]}),i.jsx("div",{className:"typeform-options",children:j.map(x=>{const R=f[x],A=!R||R.canAcceptTransfer;return i.jsxs("div",{className:`typeform-option ${n.destinationLocation===x?"selected":""} 
                           ${R?.status||"unknown"} ${!A||c?"disabled":""}`,onClick:()=>A&&!c&&N(x),children:[i.jsx("div",{className:"typeform-option-icon",children:"🎯"}),i.jsxs("div",{className:"typeform-option-content",children:[i.jsx("h4",{children:Gs(x)}),R&&i.jsxs("div",{className:"capacity-info",children:[i.jsx("p",{className:"capacity-message",children:R.message}),R.maxCapacity>0&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"capacity-bar-mini",children:[i.jsx("div",{className:"capacity-current-mini",style:{width:`${Math.min(100,R.currentStock/R.maxCapacity*100)}%`}}),R.canAcceptTransfer&&i.jsx("div",{className:"capacity-after-mini",style:{width:`${Math.min(100,R.occupancyAfter)}%`,left:`${Math.min(100,R.currentStock/R.maxCapacity*100)}%`}})]}),i.jsxs("small",{className:"capacity-details",children:["Actual: ",R.currentStock.toFixed(1),"/",R.maxCapacity.toFixed(1)," gal"]})]})]})]}),i.jsx("div",{className:"typeform-option-selector",children:i.jsx("div",{className:"typeform-check",children:i.jsx("span",{className:"typeform-check-icon",children:"✓"})})})]},x)})}),n.location&&n.quantity&&i.jsx("div",{className:"transfer-summary",children:i.jsxs("div",{className:"transfer-flow",children:[i.jsxs("div",{className:"transfer-origin",children:[i.jsx("span",{className:"transfer-icon",children:"📍"}),i.jsxs("div",{className:"transfer-info",children:[i.jsx("strong",{children:Gs(n.location)}),i.jsx("small",{children:"Origen"})]})]}),i.jsxs("div",{className:"transfer-arrow",children:[i.jsx("span",{children:"→"}),i.jsxs("small",{children:[parseFloat(n.quantity).toFixed(1)," gal"]})]}),i.jsxs("div",{className:"transfer-destination",children:[i.jsx("span",{className:"transfer-icon",children:"🎯"}),i.jsxs("div",{className:"transfer-info",children:[i.jsx("strong",{children:n.destinationLocation?Gs(n.destinationLocation):"Seleccionar destino"}),i.jsx("small",{children:"Destino"})]})]})]})}),n.destinationLocation&&f[n.destinationLocation]&&i.jsx("div",{className:"selection-confirmation",children:i.jsxs("div",{className:"confirmation-card destination-confirmation",children:[i.jsxs("div",{className:"confirmation-header",children:[i.jsx("span",{className:"confirmation-icon",children:"🎯"}),i.jsxs("div",{className:"confirmation-text",children:[i.jsx("strong",{children:Gs(n.destinationLocation)}),i.jsx("br",{}),i.jsx("small",{children:"Ubicación de destino confirmada"})]})]}),i.jsxs("div",{className:"capacity-confirmation",children:[i.jsxs("div",{className:"capacity-detail",children:[i.jsx("span",{className:"capacity-label",children:"📊 Después de transferir:"}),i.jsxs("span",{className:"capacity-value",children:[f[n.destinationLocation].afterTransfer.toFixed(1)," gal"]})]}),i.jsx("div",{className:"occupancy-bar",children:i.jsx("div",{className:"occupancy-fill",style:{width:`${f[n.destinationLocation].occupancyAfter}%`}})}),i.jsxs("small",{className:"occupancy-text",children:[f[n.destinationLocation].occupancyAfter.toFixed(1),"% de capacidad ocupada"]})]})]})})]})})},tV=({formData:n,updateFormData:e,systemData:t,error:a,setError:o})=>{const[c,d]=H.useState(!1),[f,p]=H.useState(!1),{products:g}=t;H.useEffect(()=>{if(n.fuelType&&!n.unitPrice&&g.length>0){const O=g.find(q=>q.name===n.fuelType||q.displayName===n.fuelType);O&&O.defaultPrice&&(e("unitPrice",O.defaultPrice.toString()),p(!0))}},[n.fuelType,n.unitPrice,g,e]);const y=async O=>{const q=parseFloat(O);(O===""||!isNaN(q)&&q>=0)&&(d(!0),await new Promise(U=>setTimeout(U,300)),e("unitPrice",O),p(O!==""),o(""),d(!1))},_=O=>{e("effectiveDate",O)},N=O=>{e("reference",O)},j=O=>{e("description",O)},x=(parseFloat(n.quantity)||0)*(parseFloat(n.unitPrice)||0),R=O=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(O),A=()=>g.find(O=>O.name===n.fuelType||O.displayName===n.fuelType);return i.jsx("div",{className:`wizard-step step-details ${isActive?"active":""}`,children:i.jsxs("div",{className:"typeform-layout",children:[i.jsxs("div",{className:"typeform-question",children:[i.jsx("h3",{children:"📋 Información adicional del movimiento"}),i.jsx("p",{children:"Completa los detalles restantes:"})]}),i.jsxs("div",{className:"typeform-input-section",children:[i.jsx("label",{htmlFor:"unitPrice",children:"💰 Precio por galón (COP) *"}),i.jsx("input",{id:"unitPrice",type:"number",step:"1",min:"0",value:n.unitPrice,onChange:O=>y(O.target.value),placeholder:"0",className:`typeform-input ${a?"error":""}`}),i.jsx("span",{className:"typeform-unit",children:"COP"}),c&&i.jsxs("div",{className:"calculating-price",children:[i.jsx("div",{className:"loading-spinner small"}),i.jsx("span",{children:"💰 Validando precio..."})]}),A()?.defaultPrice&&i.jsxs("small",{className:"price-suggestion",children:["💡 Precio sugerido: $",A().defaultPrice.toLocaleString("es-CO")," COP"]})]}),n.quantity&&n.unitPrice&&f&&i.jsx("div",{className:"total-value-section",children:i.jsxs("div",{className:"total-value-card",children:[i.jsx("div",{className:"total-icon",children:"📊"}),i.jsxs("div",{className:"total-content",children:[i.jsx("h4",{children:"Valor Total Calculado"}),i.jsxs("div",{className:"total-calculation",children:[i.jsxs("span",{className:"calculation-details",children:[parseFloat(n.quantity).toFixed(2)," gal × $",parseFloat(n.unitPrice).toLocaleString("es-CO")," COP"]}),i.jsx("div",{className:"total-amount",children:R(x)})]})]})]})}),i.jsxs("div",{className:"typeform-input-section",children:[i.jsx("label",{htmlFor:"effectiveDate",children:"📅 ¿Cuándo ocurrió este movimiento?"}),i.jsx("input",{id:"effectiveDate",type:"datetime-local",value:n.effectiveDate,onChange:O=>_(O.target.value),className:"typeform-input"}),i.jsx("small",{className:"typeform-unit",children:"💡 Por defecto se usa la fecha y hora actual"})]}),i.jsxs("div",{className:"typeform-input-section",children:[i.jsx("label",{htmlFor:"reference",children:"📄 Número de factura, orden o referencia (opcional)"}),i.jsx("input",{id:"reference",type:"text",value:n.reference,onChange:O=>N(O.target.value),placeholder:"Ej: Factura #12345, Orden #ORD-001",className:"typeform-input",maxLength:"100"})]}),i.jsxs("div",{className:"typeform-input-section",children:[i.jsx("label",{htmlFor:"description",children:"📝 Detalles adicionales del movimiento (opcional)"}),i.jsx("textarea",{id:"description",value:n.description,onChange:O=>j(O.target.value),placeholder:"Ej: Combustible para operación en sector norte, mantenimiento programado, etc.",className:"typeform-input",rows:"3",maxLength:"500"}),i.jsxs("div",{className:"description-counter",children:[n.description.length,"/500 caracteres"]})]})]})})},nV=({formData:n,systemData:e,onSubmit:t,isLoading:a,error:o,setError:c})=>{const[d,f]=H.useState(!1),[p,g]=H.useState(""),{vehicles:y,products:_,suppliers:N}=e,j=S=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(S),x=()=>({[ue.ENTRADA]:{icon:"📥",title:"Entrada",color:"entrada"},[ue.SALIDA]:{icon:"��",title:"Salida",color:"salida"},[ue.TRANSFERENCIA]:{icon:"🔄",title:"Transferencia",color:"transferencia"},[ue.AJUSTE]:{icon:"⚖️",title:"Ajuste",color:"ajuste"}})[n.type]||{icon:"❓",title:"Desconocido",color:"unknown"},R=()=>_.find(S=>S.name===n.fuelType||S.displayName===n.fuelType),A=()=>y.find(S=>S.vehicleId===n.vehicleId),O=()=>{const S=n.type===ue.ENTRADA?n.supplierName:n.location;return N.find(L=>L.name===S)},q=(parseFloat(n.quantity)||0)*(parseFloat(n.unitPrice)||0),U=x(),P=R(),F=A(),$=O(),V=()=>{if(!d){c("Debes confirmar que la información es correcta");return}const S={...n,additionalComments:p.trim()};t(S)};return i.jsx("div",{className:"wizard-step step-summary",children:i.jsxs("div",{className:"typeform-layout",children:[i.jsxs("div",{className:"typeform-question",children:[i.jsx("h3",{children:"✅ Confirma tu movimiento"}),i.jsx("p",{children:"Revisa toda la información antes de crear el movimiento:"})]}),i.jsxs("div",{className:"summary-main",children:[i.jsxs("div",{className:`summary-header ${U.color}`,children:[i.jsx("div",{className:"summary-icon",children:U.icon}),i.jsxs("div",{className:"summary-title",children:[i.jsxs("h4",{children:[U.title," de Combustible"]}),i.jsxs("p",{children:[parseFloat(n.quantity).toFixed(2)," galones de ",P?.displayName||n.fuelType]})]}),i.jsx("div",{className:"summary-value",children:j(q)})]}),i.jsxs("div",{className:"summary-details",children:[i.jsxs("div",{className:"detail-row",children:[i.jsx("div",{className:"detail-icon",children:"⛽"}),i.jsxs("div",{className:"detail-content",children:[i.jsx("span",{className:"detail-label",children:"Combustible:"}),i.jsxs("span",{className:"detail-value",children:[P?.icon," ",P?.displayName||n.fuelType]})]})]}),i.jsxs("div",{className:"detail-row",children:[i.jsx("div",{className:"detail-icon",children:"📊"}),i.jsxs("div",{className:"detail-content",children:[i.jsx("span",{className:"detail-label",children:"Cantidad:"}),i.jsxs("span",{className:"detail-value",children:[parseFloat(n.quantity).toFixed(2)," gal × $",parseFloat(n.unitPrice).toLocaleString("es-CO")," COP"]})]})]}),i.jsxs("div",{className:"detail-row",children:[i.jsx("div",{className:"detail-icon",children:n.type===ue.ENTRADA?"🏪":"📍"}),i.jsxs("div",{className:"detail-content",children:[i.jsx("span",{className:"detail-label",children:n.type===ue.ENTRADA?"Proveedor:":"Origen:"}),i.jsx("span",{className:"detail-value",children:n.type===ue.ENTRADA?$?`${$.name} - ${$.city}`:n.location:Gs(n.location)})]})]}),n.type===ue.SALIDA&&F&&i.jsxs("div",{className:"detail-row",children:[i.jsx("div",{className:"detail-icon",children:"🚜"}),i.jsxs("div",{className:"detail-content",children:[i.jsx("span",{className:"detail-label",children:"Vehículo:"}),i.jsxs("span",{className:"detail-value",children:[F.vehicleId," - ",F.name," (",F.type,")"]})]})]}),n.currentHours&&i.jsxs("div",{className:"detail-row",children:[i.jsx("div",{className:"detail-icon",children:"⏱️"}),i.jsxs("div",{className:"detail-content",children:[i.jsx("span",{className:"detail-label",children:"Horómetro:"}),i.jsxs("span",{className:"detail-value",children:[n.currentHours," horas"]})]})]}),n.type===ue.TRANSFERENCIA&&n.destinationLocation&&i.jsxs("div",{className:"detail-row",children:[i.jsx("div",{className:"detail-icon",children:"🎯"}),i.jsxs("div",{className:"detail-content",children:[i.jsx("span",{className:"detail-label",children:"Destino:"}),i.jsx("span",{className:"detail-value",children:Gs(n.destinationLocation)})]})]}),i.jsxs("div",{className:"detail-row",children:[i.jsx("div",{className:"detail-icon",children:"📅"}),i.jsxs("div",{className:"detail-content",children:[i.jsx("span",{className:"detail-label",children:"Fecha:"}),i.jsx("span",{className:"detail-value",children:new Date(n.effectiveDate).toLocaleString("es-CO")})]})]}),n.reference&&i.jsxs("div",{className:"detail-row",children:[i.jsx("div",{className:"detail-icon",children:"📄"}),i.jsxs("div",{className:"detail-content",children:[i.jsx("span",{className:"detail-label",children:"Referencia:"}),i.jsx("span",{className:"detail-value",children:n.reference})]})]}),n.description&&i.jsxs("div",{className:"detail-row",children:[i.jsx("div",{className:"detail-icon",children:"📝"}),i.jsxs("div",{className:"detail-content",children:[i.jsx("span",{className:"detail-label",children:"Descripción:"}),i.jsx("span",{className:"detail-value description",children:n.description})]})]})]})]}),n.type===ue.TRANSFERENCIA&&i.jsxs("div",{className:"transfer-flow-summary",children:[i.jsx("div",{className:"flow-header",children:"🔄 Flujo de Transferencia"}),i.jsxs("div",{className:"flow-diagram",children:[i.jsxs("div",{className:"flow-location origin",children:[i.jsx("div",{className:"flow-icon",children:"📍"}),i.jsxs("div",{className:"flow-text",children:[i.jsx("strong",{children:Gs(n.location)}),i.jsx("small",{children:"Origen"})]})]}),i.jsxs("div",{className:"flow-arrow",children:[i.jsx("div",{className:"arrow-line"}),i.jsx("div",{className:"arrow-head",children:"→"}),i.jsxs("div",{className:"flow-quantity",children:[parseFloat(n.quantity).toFixed(1)," gal"]})]}),i.jsxs("div",{className:"flow-location destination",children:[i.jsx("div",{className:"flow-icon",children:"🎯"}),i.jsxs("div",{className:"flow-text",children:[i.jsx("strong",{children:Gs(n.destinationLocation)}),i.jsx("small",{children:"Destino"})]})]})]})]}),i.jsxs("div",{className:"additional-comments-section",children:[i.jsxs("div",{className:"comments-header",children:[i.jsx("h4",{children:"💬 Comentarios Adicionales"}),i.jsx("small",{children:"Opcional - Agrega información adicional sobre este movimiento"})]}),i.jsx("textarea",{className:"comments-textarea",value:p,onChange:S=>g(S.target.value),placeholder:"Ejemplo: Combustible entregado por transporte especial, requiere almacenamiento prioritario, etc.",rows:3,maxLength:500}),i.jsxs("div",{className:"comments-counter",children:[p.length,"/500 caracteres"]})]}),i.jsxs("div",{className:"confirmation-section",children:[i.jsxs("div",{className:"confirmation-checkbox",children:[i.jsx("input",{type:"checkbox",id:"confirmMovement",checked:d,onChange:S=>f(S.target.checked)}),i.jsx("label",{htmlFor:"confirmMovement",children:"✅ Confirmo que toda la información es correcta y autorizo crear este movimiento"})]}),i.jsx("div",{className:"confirmation-warning",children:"⚠️ Una vez creado, el movimiento actualizará automáticamente el inventario"})]}),o&&i.jsxs("div",{className:"summary-error",children:[i.jsx("span",{className:"error-icon",children:"⚠️"}),o]}),i.jsxs("div",{className:"final-actions",children:[i.jsx("button",{type:"button",className:`btn-final-confirm ${!d||a?"disabled":""}`,onClick:V,disabled:!d||a,children:a?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"loading-spinner small"}),"💾 Creando movimiento..."]}):i.jsx(i.Fragment,{children:"🚀 Crear Movimiento"})}),i.jsx("small",{className:"final-note",children:"El movimiento se guardará inmediatamente y actualizará el inventario"})]})]})})},sV=({isOpen:n,onClose:e,onSuccess:t})=>{const{inventory:a,vehicles:o,suppliers:c}=ds(),[d,f]=H.useState(1),[p,g]=H.useState(!1),[y,_]=H.useState(""),[N,j]=H.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""}),[x,R]=H.useState({vehicles:[],inventory:[],suppliers:[],products:[],loadingData:!0});N.type,ue.ENTRADA,H.useEffect(()=>((async()=>{if(n){document.body.style.overflow="hidden",R(D=>({...D,loadingData:!0}));try{console.log("🔄 Cargando productos y sincronizando datos en tiempo real...");const D=await QL();R({vehicles:o||[],inventory:a||[],suppliers:c||[],products:D||[],loadingData:!1}),console.log("✅ Datos sincronizados para wizard - inventario en tiempo real:",a?.length||0,"items")}catch(D){console.error("❌ Error al cargar datos del sistema:",D),R(me=>({...me,loadingData:!1}))}}else document.body.style.overflow="unset"})(),()=>{document.body.style.overflow="unset"}),[n,a,o,c]);const A=()=>{if(!N.type)return 8;let C;return N.type===ue.TRANSFERENCIA?C=8:N.type===ue.SALIDA||N.type===ue.ENTRADA?C=7:C=6,console.log("🔍 [TOTAL STEPS]",{type:N.type,totalSteps:C,currentStep:d}),C},O=(C,D)=>{j(me=>({...me,[C]:D})),_("")},q=H.useCallback(()=>{let C=!1;switch(d){case 1:C=!!N.type;break;case 2:C=!!N.fuelType,console.log("🔍 [STEP 2 VALIDATION]",{fuelType:N.fuelType,isValid:C,formData:N});break;case 3:N.type===ue.ENTRADA?C=!!N.supplierName:C=!!N.location;break;case"3b":C=!!N.destinationLocation;break;case 4:C=N.quantity&&parseFloat(N.quantity)>0,console.log("🔍 [DEBUG Step 4] Validación cantidad:",{step:d,quantity:N.quantity,parsedQuantity:parseFloat(N.quantity),isQuantityValid:!!N.quantity,isParsedValid:parseFloat(N.quantity)>0,finalValidation:C,formData:N});break;case 5:N.type===ue.SALIDA?C=!!N.vehicleId:C=!0;break;case 6:N.type===ue.TRANSFERENCIA?C=!!N.destinationLocation:C=!0;break;case 7:C=!!N.unitPrice&&parseFloat(N.unitPrice)>=0;break;case 8:C=!0;break;default:C=!1}return console.log("🔍 [DEBUG General] validateCurrentStep:",{currentStep:d,isValid:C,formDataKeys:Object.keys(N),formData:N}),C},[d,N]),U=H.useMemo(()=>q(),[q]),P=()=>{const C=q();if(console.log("🔍 [DEBUG nextStep] Intentando navegar:",{currentStep:d,isValid:C,formData:N,type:N.type}),C){const D=A();let me=d+1;d===3&&N.type===ue.ENTRADA?me="3b":d==="3b"?me=4:d===4&&N.type!==ue.SALIDA?N.type===ue.TRANSFERENCIA?me=6:(N.type,ue.ENTRADA,me=7):d===5&&N.type!==ue.TRANSFERENCIA&&(me=7),console.log("🔍 [DEBUG Navigation] Navegando:",{from:d,to:me,totalSteps:D}),(ne=>N.type===ue.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[ne]||ne:N.type===ue.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[ne]||ne:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[ne]||ne)(me)<=D&&f(me)}else console.log("❌ [DEBUG] Validación falló, no se puede navegar"),_("Por favor completa este paso antes de continuar")},F=()=>{if(d>1&&d!=="3b"){let C=d-1;d===4&&N.type===ue.ENTRADA?C="3b":(d===7&&N.type===ue.ENTRADA||d===7&&N.type!==ue.TRANSFERENCIA&&N.type!==ue.SALIDA||d===6&&N.type!==ue.SALIDA)&&(C=4),f(C)}else d==="3b"&&f(3)},$=async(C=null)=>{g(!0),_("");try{const D=C||N;console.log("🔍 [SUBMIT] Datos completos antes de crear movimiento:",D),console.log("🔍 [SUBMIT] FuelType específico:",D.fuelType),D.type===ue.SALIDA&&console.log("🔍 [SUBMIT SALIDA] Validando campos requeridos:",{type:D.type,fuelType:D.fuelType,vehicleId:D.vehicleId,location:D.location,quantity:D.quantity,unitPrice:D.unitPrice});const me={...D,quantity:parseFloat(D.quantity),unitPrice:parseFloat(D.unitPrice),effectiveDate:new Date(D.effectiveDate)};console.log("🔍 [SUBMIT] MovementData enviado a createMovement:",me),await Nj(me),t(),f(1),j({type:"",fuelType:"",quantity:"",unitPrice:"",location:"",supplierName:"",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16),currentHours:""})}catch(D){console.error("Error al crear movimiento:",D),_(D.message||"Error al crear el movimiento")}finally{g(!1)}},V=()=>{const C={formData:N,updateFormData:O,systemData:x,error:y,setError:_};switch(d){case 1:return i.jsx(XL,{...C});case 2:return i.jsx(WL,{...C});case 3:return i.jsx(ZL,{...C});case"3b":return i.jsx(zE,{...C,isEntryDestination:!0});case 4:return i.jsx(JL,{...C});case 5:return i.jsx(eV,{...C});case 6:return i.jsx(zE,{...C});case 7:return i.jsx(tV,{...C});case 8:return i.jsx(nV,{...C,onSubmit:$,isLoading:p});default:return i.jsx("div",{children:"Paso no encontrado"})}};if(!n)return null;const S=A(),M=(C=>N.type===ue.ENTRADA?{1:1,2:2,3:3,"3b":4,4:5,7:6,8:7}[C]||C:N.type===ue.SALIDA?{1:1,2:2,3:3,4:4,5:5,7:6,8:7}[C]||C:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8}[C]||C)(d),w=M/S*100;return console.log("🔍 [WIZARD DEBUG]",{type:N.type,currentStep:d,currentLogicalStep:M,totalSteps:S,progress:w,isLastStep:d>=S,formDataKeys:Object.keys(N).filter(C=>N[C]),fuelType:N.fuelType}),i.jsx("div",{className:"modal-overlay wizard-overlay",onClick:e,children:i.jsxs("div",{className:"modal-content wizard-modal typeform-mode",onClick:C=>C.stopPropagation(),children:[i.jsx("div",{className:"typeform-progress",children:i.jsx("div",{className:"typeform-progress-fill",style:{width:`${w}%`}})}),i.jsx("div",{className:"wizard-header typeform-mode",children:i.jsxs("div",{className:"wizard-title",children:[i.jsx("h3",{children:"🧙‍♂️ Asistente de Movimientos"}),i.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]})}),i.jsx("div",{className:"wizard-body typeform-mode",children:x.loadingData?i.jsxs("div",{className:"wizard-loading",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"🔄 Cargando datos del sistema..."})]}):i.jsx("div",{className:"wizard-step-container",children:V()})}),y&&i.jsxs("div",{className:"wizard-error",children:[i.jsx("span",{className:"error-icon",children:"⚠️"}),y]}),i.jsxs("div",{className:"typeform-navigation",children:[d>1&&i.jsx("button",{className:"typeform-nav-btn",onClick:F,disabled:isTransitioning,"aria-label":"Paso anterior",children:"←"}),M<S?i.jsx("button",{className:"typeform-nav-btn",onClick:P,disabled:!U||isTransitioning,"aria-label":"Siguiente paso",children:"→"}):i.jsx("button",{className:"typeform-nav-btn",onClick:$,disabled:p||!U||isTransitioning,"aria-label":"Confirmar movimiento",children:p?i.jsx("span",{className:"loading-spinner small"}):"✓"})]})]})})},aV=()=>{const{user:n,userProfile:e,deleteMovement:t}=ds(),[a,o]=H.useState([]),[c,d]=H.useState(null),[f,p]=H.useState(!0),[g,y]=H.useState(null),[_,N]=H.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[j,x]=H.useState(""),[R,A]=H.useState(!1);H.useEffect(()=>{if(!n)return;p(!0);const w=Jv((C,D)=>{if(D){console.error("Error en suscripción de movimientos:",D),y("Error al cargar movimientos"),p(!1);return}o(C),y(null),p(!1)},_);return()=>w()},[n,_]),H.useEffect(()=>{n&&(async()=>{try{const C=await jj(_);d(C)}catch(C){console.error("Error al cargar estadísticas:",C)}})()},[n,a,_]);const O=a.filter(w=>{if(!j)return!0;const C=j.toLowerCase();return w.fuelType?.toLowerCase().includes(C)||w.type?.toLowerCase().includes(C)||w.location?.toLowerCase().includes(C)||w.vehicleId?.toLowerCase().includes(C)||w.description?.toLowerCase().includes(C)||w.reference?.toLowerCase().includes(C)}),q=()=>{A(!0)},U=w=>{alert(`📋 Detalles del movimiento:

Tipo: ${w.type}
Combustible: ${w.fuelType}
Cantidad: ${w.quantity} gal
Fecha: ${new Date(w.createdAt).toLocaleDateString("es-CO")}`)},P=()=>{A(!1)},F=w=>{N(C=>({...C,...w}))},$=()=>{N({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),x("")},V=async w=>{if(window.confirm("¿Estás seguro de que quieres aprobar este movimiento? Esta acción actualizará el inventario."))try{await Aj(w),alert("Movimiento aprobado y stock actualizado.")}catch(C){console.error("Error al aprobar movimiento:",C),alert(`Error al aprobar movimiento: ${C.message}`)}},S=async w=>{if(window.confirm("¿Estás seguro de que quieres rechazar este movimiento?"))try{await Tj(w,{status:gt.CANCELADO}),alert("Movimiento rechazado.")}catch(C){console.error("Error al rechazar movimiento:",C),alert(`Error al rechazar movimiento: ${C.message}`)}},L=async w=>{try{const C=await t(w);if(C.success)alert("Movimiento eliminado exitosamente.");else throw new Error(C.error)}catch(C){console.error("Error al eliminar movimiento:",C),alert(`Error al eliminar movimiento: ${C.message}`)}},M=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente";return f?i.jsx("div",{className:"movements-main",children:i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Cargando movimientos..."})]})}):g?i.jsx("div",{className:"movements-main",children:i.jsxs("div",{className:"error-container",children:[i.jsx("div",{className:"error-icon",children:"⚠️"}),i.jsx("h3",{children:"Error al cargar movimientos"}),i.jsx("p",{children:g}),i.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):i.jsxs("div",{className:"movements-main",children:[i.jsxs("div",{className:"movements-header",children:[i.jsxs("div",{className:"header-title",children:[i.jsx("h2",{children:"📊 Movimientos de Combustibles"}),i.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),M&&i.jsx("div",{className:"create-movement-options",children:i.jsx("button",{className:"btn-create-movement primary",onClick:q,children:"➕ Nuevo Movimiento"})})]}),c&&i.jsx(FL,{stats:c,filters:_}),i.jsx(qL,{filters:_,onFilterChange:F,onClearFilters:$,searchTerm:j,onSearchChange:x,totalResults:O.length}),O.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"empty-icon",children:"📋"}),i.jsx("h3",{children:a.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),i.jsx("p",{children:a.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de búsqueda"}),a.length===0&&M&&i.jsx("div",{className:"create-first-options",children:i.jsx("button",{className:"btn-create-first primary",onClick:q,children:"➕ Crear Primer Movimiento"})})]}):i.jsx(zL,{movements:O,onEdit:null,onView:U,onApprove:V,onReject:S,onDelete:L,userRole:e?.role}),R&&i.jsx(sV,{isOpen:R,onClose:P,onSuccess:()=>{P()}})]})},iV=({stats:n,filters:e})=>{if(!n)return null;const t=_=>`${ke(_)} gal`,a=_=>`${ke(_)} hrs`,o=_=>`${_.toFixed(2)} gal/hr`,c=_=>{let N=0;for(let x=0;x<_.length;x++)N=(N<<5)-N+_.charCodeAt(x)&4294967295;const j=["#059669","#dc2626","#2563eb","#7c3aed","#ea580c","#16a34a","#ca8a04","#9333ea"];return j[Math.abs(N)%j.length]},d=_=>{if(!_)return"🚗";const N=_.toLowerCase();return N.includes("excavadora")?"🚚":N.includes("bulldozer")?"🚜":N.includes("cargador")?"🏗️":N.includes("camion")?"🚛":N.includes("grua")?"🏗️":N.includes("motosierra")?"🪚":N.includes("tractor")?"🚜":N.includes("volqueta")?"🚛":"🚗"},f=_=>{switch(_){case Ve.ACTIVO:return"#10b981";case Ve.MANTENIMIENTO:return"#f59e0b";case Ve.INACTIVO:return"#6b7280";case Ve.REPARACION:return"#ef4444";default:return"#6b7280"}},p=_=>{switch(_){case Ve.ACTIVO:return"✅";case Ve.MANTENIMIENTO:return"🔧";case Ve.INACTIVO:return"⏸️";case Ve.REPARACION:return"🔴";default:return"❓"}},g=_=>{switch(_){case vt.DIESEL:return"🚛";case vt.GASOLINA:return"🚗";case vt.ACPM:return"🚚";case vt.MIXTO:return"⛽";default:return"⛽"}},y=n.totalVehicles>0?((n.byStatus[Ve.ACTIVO]||0)/n.totalVehicles*100).toFixed(1):0;return i.jsxs("div",{className:"vehicles-stats",children:[i.jsxs("div",{className:"stats-grid",children:[i.jsxs("div",{className:"stat-card primary",children:[i.jsx("div",{className:"stat-icon",children:"🚜"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:ke(n.totalVehicles)}),i.jsx("div",{className:"stat-label",children:"Total Vehículos"}),i.jsx("div",{className:"stat-trend",children:i.jsxs("span",{className:`trend ${y>=80?"positive":"warning"}`,children:[y>=80?"📈":"⚠️"," ",y,"% activos"]})})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:"⛽"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:t(n.totalFuelConsumed)}),i.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),i.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(n.averageConsumption||0)]})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:"⏰"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:a(n.totalHoursWorked)}),i.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),i.jsxs("div",{className:"stat-secondary",children:["Promedio: ",a(n.totalHoursWorked/(n.totalVehicles||1))]})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:"🏆"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:n.mostActiveVehicle?n.mostActiveVehicle.vehicleId:"N/A"}),i.jsx("div",{className:"stat-label",children:"Más Activo"}),i.jsx("div",{className:"stat-secondary",children:n.mostActiveVehicle?`${n.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),i.jsxs("div",{className:"stats-breakdown",children:[i.jsxs("div",{className:"breakdown-section",children:[i.jsx("h4",{children:"🚜 Por Tipo de Vehículo"}),i.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([_,N])=>{const j=(N/n.totalVehicles*100).toFixed(1);return i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-header",children:[i.jsx("span",{className:"breakdown-icon",children:d(_)}),i.jsx("span",{className:"breakdown-label",children:_.charAt(0).toUpperCase()+_.slice(1)})]}),i.jsx("div",{className:"breakdown-value",children:N}),i.jsx("div",{className:"breakdown-bar",children:i.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:c(_)}})}),i.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},_)})})]}),i.jsxs("div",{className:"breakdown-section",children:[i.jsx("h4",{children:"⚡ Por Estado"}),i.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([_,N])=>{const j=(N/n.totalVehicles*100).toFixed(1);return i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-header",children:[i.jsx("span",{className:"breakdown-icon",children:p(_)}),i.jsx("span",{className:"breakdown-label",children:_.charAt(0).toUpperCase()+_.slice(1)})]}),i.jsx("div",{className:"breakdown-value",children:N}),i.jsx("div",{className:"breakdown-bar",children:i.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:f(_)}})}),i.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},_)})})]}),i.jsxs("div",{className:"breakdown-section",children:[i.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),i.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([_,N])=>{const j=(N/n.totalVehicles*100).toFixed(1);return i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-header",children:[i.jsx("span",{className:"breakdown-icon",children:g(_)}),i.jsx("span",{className:"breakdown-label",children:_})]}),i.jsx("div",{className:"breakdown-value",children:N}),i.jsx("div",{className:"breakdown-bar",children:i.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:"#059669"}})}),i.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},_)})})]})]}),(n.totalFuelConsumed>0||n.totalHoursWorked>0)&&i.jsxs("div",{className:"performance-metrics",children:[i.jsx("h4",{children:"📊 Métricas de Rendimiento"}),i.jsxs("div",{className:"metrics-grid",children:[i.jsxs("div",{className:"metric-card",children:[i.jsx("div",{className:"metric-icon",children:"⚡"}),i.jsxs("div",{className:"metric-content",children:[i.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),i.jsxs("div",{className:"metric-value",children:[y,"%"]}),i.jsxs("div",{className:"metric-description",children:[n.byStatus[Ve.ACTIVO]||0," de ",n.totalVehicles," activos"]})]})]}),n.averageConsumption>0&&i.jsxs("div",{className:"metric-card",children:[i.jsx("div",{className:"metric-icon",children:"📈"}),i.jsxs("div",{className:"metric-content",children:[i.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),i.jsx("div",{className:"metric-value",children:o(n.averageConsumption)}),i.jsx("div",{className:"metric-description",children:"Por vehículo por hora trabajada"})]})]}),n.mostActiveVehicle&&i.jsxs("div",{className:"metric-card",children:[i.jsx("div",{className:"metric-icon",children:"🏆"}),i.jsxs("div",{className:"metric-content",children:[i.jsx("div",{className:"metric-label",children:"Mayor Utilización"}),i.jsx("div",{className:"metric-value",children:n.mostActiveVehicle.vehicleId}),i.jsxs("div",{className:"metric-description",children:[t(n.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),n.leastActiveVehicle&&i.jsxs("div",{className:"metric-card",children:[i.jsx("div",{className:"metric-icon",children:"📉"}),i.jsxs("div",{className:"metric-content",children:[i.jsx("div",{className:"metric-label",children:"Menor Utilización"}),i.jsx("div",{className:"metric-value",children:n.leastActiveVehicle.vehicleId}),i.jsxs("div",{className:"metric-description",children:[t(n.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(e.type||e.status||e.fuelType||e.location)&&i.jsxs("div",{className:"active-filters",children:[i.jsx("h4",{children:"🔍 Filtros Activos"}),i.jsxs("div",{className:"filters-list",children:[e.type&&i.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&i.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&i.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.location&&i.jsxs("span",{className:"filter-tag",children:["Ubicación: ",e.location]})]})]})]})},rV=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const[p,g]=H.useState(!1),y=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mecánico","Proyecto A","Proyecto B","En Reparación","Otros"],_=Object.values(n).filter(x=>x&&x!==""&&x!=="all").length,N=(x,R)=>{e({[x]:R})},j=x=>{e(x)};return i.jsxs("div",{className:"vehicles-filters",children:[i.jsxs("div",{className:"filters-main",children:[i.jsx("div",{className:"search-section",children:i.jsxs("div",{className:"search-box",children:[i.jsx("span",{className:"search-icon",children:"🔍"}),i.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicación...",value:a,onChange:x=>o(x.target.value),className:"search-input"}),a&&i.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),i.jsxs("div",{className:"filters-controls",children:[i.jsxs("div",{className:"quick-filters",children:[i.jsx("button",{className:`quick-filter ${n.status==="activo"?"active":""}`,onClick:()=>j({status:"activo"}),children:"✅ Activos"}),i.jsx("button",{className:`quick-filter ${n.status==="mantenimiento"?"active":""}`,onClick:()=>j({status:"mantenimiento"}),children:"🔧 Mantenimiento"}),i.jsx("button",{className:`quick-filter ${n.type==="excavadora"?"active":""}`,onClick:()=>j({type:"excavadora"}),children:"🚚 Excavadoras"}),i.jsx("button",{className:`quick-filter ${n.type==="tractor"?"active":""}`,onClick:()=>j({type:"tractor"}),children:"🚜 Tractores"})]}),i.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>g(!p),children:["🎛️ Filtros",_>0&&i.jsx("span",{className:"filters-count",children:_})]}),i.jsxs("div",{className:"view-modes",children:[i.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),i.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&i.jsxs("div",{className:"filters-advanced",children:[i.jsxs("div",{className:"filters-grid",children:[i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Tipo de Vehículo"}),i.jsxs("select",{value:n.type,onChange:x=>N("type",x.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"Todos los tipos"}),i.jsx("option",{value:"excavadora",children:"🚚 Excavadora"}),i.jsx("option",{value:"bulldozer",children:"🚜 Bulldozer"}),i.jsx("option",{value:"cargador",children:"🏗️ Cargador"}),i.jsx("option",{value:"camion",children:"🚛 Camión"}),i.jsx("option",{value:"grua",children:"🏗️ Grúa"}),i.jsx("option",{value:"motosierra",children:"🪚 Motosierra"}),i.jsx("option",{value:"tractor",children:"🚜 Tractor"}),i.jsx("option",{value:"volqueta",children:"🚛 Volqueta"}),i.jsx("option",{value:"otros",children:"🚗 Otros"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Estado"}),i.jsxs("select",{value:n.status,onChange:x=>N("status",x.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"Todos los estados"}),i.jsx("option",{value:Ve.ACTIVO,children:"✅ Activo"}),i.jsx("option",{value:Ve.MANTENIMIENTO,children:"🔧 Mantenimiento"}),i.jsx("option",{value:Ve.INACTIVO,children:"⏸️ Inactivo"}),i.jsx("option",{value:Ve.REPARACION,children:"🔴 Reparación"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Tipo de Combustible"}),i.jsxs("select",{value:n.fuelType,onChange:x=>N("fuelType",x.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"Todos los combustibles"}),i.jsx("option",{value:vt.DIESEL,children:"🚛 Diesel"}),i.jsx("option",{value:vt.GASOLINA,children:"🚗 Gasolina"}),i.jsx("option",{value:vt.ACPM,children:"🚚 ACPM"}),i.jsx("option",{value:vt.MIXTO,children:"⛽ Mixto"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Ubicación Actual"}),i.jsxs("select",{value:n.location,onChange:x=>N("location",x.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"Todas las ubicaciones"}),y.map(x=>i.jsxs("option",{value:x,children:["📍 ",x]},x))]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Mantenimiento"}),i.jsxs("select",{value:n.maintenance,onChange:x=>N("maintenance",x.target.value),className:"filter-select",children:[i.jsx("option",{value:"all",children:"Todos"}),i.jsx("option",{value:"due",children:"Mantenimiento debido"}),i.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),i.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),i.jsxs("div",{className:"filters-actions",children:[i.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:_===0,children:"🗑️ Limpiar Filtros"}),i.jsxs("div",{className:"filters-info",children:[i.jsxs("span",{className:"results-count",children:[f," resultado",f!==1?"s":""]}),_>0&&i.jsxs("span",{className:"active-filters-text",children:["(",_," filtro",_!==1?"s":""," activo",_!==1?"s":"",")"]})]})]})]}),_>0&&i.jsx("div",{className:"active-filters-summary",children:i.jsxs("div",{className:"summary-content",children:[i.jsx("span",{className:"summary-label",children:"Filtros activos:"}),i.jsxs("div",{className:"summary-tags",children:[n.type&&i.jsxs("span",{className:"summary-tag",onClick:()=>N("type",""),children:["Tipo: ",n.type," ✕"]}),n.status&&i.jsxs("span",{className:"summary-tag",onClick:()=>N("status",""),children:["Estado: ",n.status," ✕"]}),n.fuelType&&i.jsxs("span",{className:"summary-tag",onClick:()=>N("fuelType",""),children:["Combustible: ",n.fuelType," ✕"]}),n.location&&i.jsxs("span",{className:"summary-tag",onClick:()=>N("location",""),children:["Ubicación: ",n.location," ✕"]}),n.maintenance!=="all"&&i.jsxs("span",{className:"summary-tag",onClick:()=>N("maintenance","all"),children:["Mantenimiento: ",n.maintenance," ✕"]})]})]})}),i.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:i.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},oV=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const o=A=>new Intl.NumberFormat("es-CO").format(A),c=A=>`${o(A)} gal`,d=A=>`${o(A)} hrs`,f=A=>A?(A instanceof Date?A:new Date(A)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",p=A=>{if(!A)return"";const O=new Date,q=A instanceof Date?A:new Date(A),U=Math.abs(O-q),P=Math.ceil(U/(1e3*60*60*24));return P===1?"hace 1 día":P<7?`hace ${P} días`:P<30?`hace ${Math.ceil(P/7)} semanas`:P<365?`hace ${Math.ceil(P/30)} meses`:`hace ${Math.ceil(P/365)} años`},g=A=>{if(!A)return"vehicle-default";const O=A.toLowerCase();return O.includes("excavadora")?"vehicle-excavadora":O.includes("bulldozer")?"vehicle-bulldozer":O.includes("cargador")?"vehicle-cargador":O.includes("camion")?"vehicle-camion":O.includes("grua")?"vehicle-grua":O.includes("motosierra")?"vehicle-motosierra":O.includes("tractor")?"vehicle-tractor":O.includes("volqueta")?"vehicle-volqueta":"vehicle-default"},y=A=>{switch(A){case Ve.ACTIVO:return"status-activo";case Ve.MANTENIMIENTO:return"status-mantenimiento";case Ve.INACTIVO:return"status-inactivo";case Ve.REPARACION:return"status-reparacion";default:return"status-default"}},_=A=>{if(!A)return"🚗";const O=A.toLowerCase();return O.includes("excavadora")?"🚚":O.includes("bulldozer")?"🚜":O.includes("cargador")?"🏗️":O.includes("camion")?"🚛":O.includes("grua")?"🏗️":O.includes("motosierra")?"🪚":O.includes("tractor")?"🚜":O.includes("volqueta")?"🚛":"🚗"},N=A=>{switch(A){case vt.DIESEL:return"🚛";case vt.GASOLINA:return"🚗";case vt.ACPM:return"🚚";case vt.MIXTO:return"⛽";default:return"⛽"}},j=A=>{switch(A){case Ve.ACTIVO:return"✅";case Ve.MANTENIMIENTO:return"🔧";case Ve.INACTIVO:return"⏸️";case Ve.REPARACION:return"🔴";default:return"❓"}},x=A=>!A.totalHoursWorked||A.totalHoursWorked===0?A.estimatedConsumptionPerHour||0:A.totalFuelConsumed/A.totalHoursWorked,R=A=>A.lastMaintenanceDate?Math.floor((new Date-new Date(A.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return i.jsx("div",{className:"vehicles-cards",children:n.map(A=>i.jsxs("div",{className:`vehicle-card ${g(A.type)}`,children:[i.jsx("div",{className:"card-header",children:i.jsxs("div",{className:"vehicle-info",children:[i.jsxs("div",{className:"vehicle-id-section",children:[i.jsx("span",{className:"vehicle-icon",children:_(A.type)}),i.jsxs("div",{className:"vehicle-details",children:[i.jsx("span",{className:"vehicle-id",children:A.vehicleId}),i.jsx("span",{className:"vehicle-name",children:A.name})]})]}),i.jsxs("div",{className:`status-badge ${y(A.status)}`,children:[i.jsx("span",{className:"status-icon",children:j(A.status)}),i.jsx("span",{className:"status-label",children:A.status.charAt(0).toUpperCase()+A.status.slice(1)})]})]})}),i.jsxs("div",{className:"card-content",children:[i.jsxs("div",{className:"basic-info",children:[i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Tipo:"}),i.jsxs("span",{className:"info-value",children:[_(A.type)," ",A.type.charAt(0).toUpperCase()+A.type.slice(1)]})]}),A.brand&&A.model&&i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),i.jsxs("span",{className:"info-value",children:[A.brand," ",A.model]})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Combustible:"}),i.jsxs("span",{className:"info-value",children:[N(A.fuelType)," ",A.fuelType]})]}),A.currentLocation&&i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Ubicación:"}),i.jsxs("span",{className:"info-value",children:["📍 ",A.currentLocation]})]})]}),i.jsxs("div",{className:"consumption-metrics",children:[i.jsxs("div",{className:"metric-item",children:[i.jsx("div",{className:"metric-icon",children:"⛽"}),i.jsxs("div",{className:"metric-content",children:[i.jsx("div",{className:"metric-value",children:c(A.totalFuelConsumed||0)}),i.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),i.jsxs("div",{className:"metric-item",children:[i.jsx("div",{className:"metric-icon",children:"⏰"}),i.jsxs("div",{className:"metric-content",children:[i.jsx("div",{className:"metric-value",children:d(A.totalHoursWorked||0)}),i.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),i.jsxs("div",{className:"metric-item",children:[i.jsx("div",{className:"metric-icon",children:"📊"}),i.jsxs("div",{className:"metric-content",children:[i.jsxs("div",{className:"metric-value",children:[x(A).toFixed(1)," gal/hr"]}),i.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),i.jsxs("div",{className:"metric-item",children:[i.jsx("div",{className:"metric-icon",children:"🔄"}),i.jsxs("div",{className:"metric-content",children:[i.jsx("div",{className:"metric-value",children:A.totalMovements||0}),i.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(A.enginePower||A.fuelCapacity||A.year)&&i.jsxs("div",{className:"technical-specs",children:[A.enginePower&&i.jsxs("div",{className:"spec-item",children:[i.jsx("span",{className:"spec-icon",children:"⚡"}),i.jsxs("span",{className:"spec-value",children:[A.enginePower," HP"]})]}),A.fuelCapacity&&i.jsxs("div",{className:"spec-item",children:[i.jsx("span",{className:"spec-icon",children:"🛢️"}),i.jsxs("span",{className:"spec-value",children:[A.fuelCapacity," gal"]})]}),A.year&&i.jsxs("div",{className:"spec-item",children:[i.jsx("span",{className:"spec-icon",children:"📅"}),i.jsx("span",{className:"spec-value",children:A.year})]})]}),A.description&&i.jsx("div",{className:"description",children:i.jsx("p",{children:A.description})})]}),i.jsxs("div",{className:"card-footer",children:[i.jsxs("div",{className:"date-info",children:[A.lastMovementDate&&i.jsxs("div",{className:"date-item",children:[i.jsx("span",{className:"date-label",children:"Último movimiento:"}),i.jsx("span",{className:"date-value",children:f(A.lastMovementDate)}),i.jsx("span",{className:"date-relative",children:p(A.lastMovementDate)})]}),A.lastMaintenanceDate&&i.jsxs("div",{className:"date-item",children:[i.jsx("span",{className:"date-label",children:"Último mantenimiento:"}),i.jsx("span",{className:"date-value",children:f(A.lastMaintenanceDate)}),i.jsx("span",{className:"date-relative",children:p(A.lastMaintenanceDate)})]})]}),i.jsxs("div",{className:"card-actions",children:[i.jsx("button",{className:"btn-view",onClick:()=>t(A),title:"Ver detalles",children:"👁️"}),e&&A.status!==Ve.REPARACION&&i.jsx("button",{className:"btn-edit",onClick:()=>e(A),title:"Editar vehículo",children:"✏️"}),a&&i.jsx("button",{className:"btn-maintenance",onClick:()=>a(A),title:"Registrar mantenimiento",children:"🔧"})]})]}),A.status===Ve.MANTENIMIENTO&&i.jsx("div",{className:"maintenance-indicator",children:i.jsx("div",{className:"maintenance-pulse"})}),R(A)&&A.status===Ve.ACTIVO&&i.jsx("div",{className:"maintenance-due-badge",children:i.jsx("span",{children:"Mantenimiento Debido"})}),A.status===Ve.REPARACION&&i.jsx("div",{className:"repair-badge",children:i.jsx("span",{children:"En Reparación"})}),A.totalHoursWorked>0&&i.jsxs("div",{className:"efficiency-indicator",children:[i.jsx("div",{className:"efficiency-bar",children:i.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(A.totalHoursWorked/2e3*100,100)}%`}})}),i.jsxs("span",{className:"efficiency-label",children:[(A.totalHoursWorked/2e3*100).toFixed(1),"% utilización anual"]})]})]},A.id))})},lV=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const[o,c]=H.useState("vehicleId"),[d,f]=H.useState("asc"),p=F=>new Intl.NumberFormat("es-CO").format(F),g=F=>`${p(F)} gal`,y=F=>`${p(F)} hrs`,_=F=>F?(F instanceof Date?F:new Date(F)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",N=F=>{if(!F)return"🚗";const $=F.toLowerCase();return $.includes("excavadora")?"🚚":$.includes("bulldozer")?"🚜":$.includes("cargador")?"🏗️":$.includes("camion")?"🚛":$.includes("grua")?"🏗️":$.includes("motosierra")?"🪚":$.includes("tractor")?"🚜":$.includes("volqueta")?"🚛":"🚗"},j=F=>{switch(F){case vt.DIESEL:return"🚛";case vt.GASOLINA:return"🚗";case vt.ACPM:return"🚚";case vt.MIXTO:return"⛽";default:return"⛽"}},x=F=>{switch(F){case Ve.ACTIVO:return"✅";case Ve.MANTENIMIENTO:return"🔧";case Ve.INACTIVO:return"⏸️";case Ve.REPARACION:return"🔴";default:return"❓"}},R=F=>{switch(F){case Ve.ACTIVO:return"status-activo";case Ve.MANTENIMIENTO:return"status-mantenimiento";case Ve.INACTIVO:return"status-inactivo";case Ve.REPARACION:return"status-reparacion";default:return"status-default"}},A=F=>{o===F?f(d==="asc"?"desc":"asc"):(c(F),f("asc"))},O=[...n].sort((F,$)=>{let V=F[o],S=$[o];return(o.includes("Date")||o.includes("At"))&&(V=new Date(V||0),S=new Date(S||0)),typeof V=="number"&&typeof S=="number"?d==="asc"?V-S:S-V:typeof V=="string"&&typeof S=="string"?d==="asc"?V.localeCompare(S):S.localeCompare(V):V instanceof Date&&S instanceof Date?d==="asc"?V-S:S-V:!V&&!S?0:V?S?0:d==="asc"?-1:1:d==="asc"?1:-1}),q=F=>o!==F?"↕️":d==="asc"?"↑":"↓",U=F=>!F.totalHoursWorked||F.totalHoursWorked===0?F.estimatedConsumptionPerHour||0:F.totalFuelConsumed/F.totalHoursWorked,P=F=>F.lastMaintenanceDate?Math.floor((new Date-new Date(F.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return i.jsxs("div",{className:"vehicles-table-container",children:[i.jsx("div",{className:"table-wrapper",children:i.jsxs("table",{className:"vehicles-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsxs("th",{className:"sortable",onClick:()=>A("vehicleId"),children:["ID Vehículo ",q("vehicleId")]}),i.jsxs("th",{className:"sortable",onClick:()=>A("name"),children:["Nombre ",q("name")]}),i.jsxs("th",{className:"sortable",onClick:()=>A("type"),children:["Tipo ",q("type")]}),i.jsx("th",{children:"Marca/Modelo"}),i.jsxs("th",{className:"sortable",onClick:()=>A("fuelType"),children:["Combustible ",q("fuelType")]}),i.jsxs("th",{className:"sortable text-right",onClick:()=>A("totalFuelConsumed"),children:["Consumido ",q("totalFuelConsumed")]}),i.jsxs("th",{className:"sortable text-right",onClick:()=>A("totalHoursWorked"),children:["Horas ",q("totalHoursWorked")]}),i.jsx("th",{className:"text-right",children:"Consumo/Hr"}),i.jsx("th",{children:"Ubicación"}),i.jsxs("th",{className:"sortable",onClick:()=>A("status"),children:["Estado ",q("status")]}),i.jsxs("th",{className:"sortable",onClick:()=>A("lastMovementDate"),children:["Último Mov. ",q("lastMovementDate")]}),i.jsx("th",{className:"actions-column",children:"Acciones"})]})}),i.jsx("tbody",{children:O.map(F=>i.jsxs("tr",{className:`vehicle-row ${F.status===Ve.MANTENIMIENTO?"maintenance-row":""} ${P(F)?"needs-maintenance":""}`,children:[i.jsx("td",{className:"vehicle-id-cell",children:i.jsxs("div",{className:"id-content",children:[i.jsx("span",{className:"vehicle-icon",children:N(F.type)}),i.jsx("span",{className:"vehicle-id",children:F.vehicleId})]})}),i.jsx("td",{className:"name-cell",children:i.jsx("span",{className:"vehicle-name",children:F.name})}),i.jsx("td",{className:"type-cell",children:i.jsx("span",{className:"type-text",children:F.type.charAt(0).toUpperCase()+F.type.slice(1)})}),i.jsx("td",{className:"brand-model-cell",children:F.brand&&F.model?i.jsxs("span",{className:"brand-model",children:[F.brand," ",F.model]}):i.jsx("span",{className:"no-data",children:"-"})}),i.jsx("td",{className:"fuel-cell",children:i.jsxs("div",{className:"fuel-content",children:[i.jsx("span",{className:"fuel-icon",children:j(F.fuelType)}),i.jsx("span",{className:"fuel-text",children:F.fuelType})]})}),i.jsx("td",{className:"consumption-cell text-right",children:i.jsx("span",{className:"consumption-value",children:g(F.totalFuelConsumed||0)})}),i.jsx("td",{className:"hours-cell text-right",children:i.jsx("span",{className:"hours-value",children:y(F.totalHoursWorked||0)})}),i.jsx("td",{className:"rate-cell text-right",children:i.jsxs("span",{className:"rate-value",children:[U(F).toFixed(1)," gal/hr"]})}),i.jsx("td",{className:"location-cell",children:i.jsxs("span",{className:"location-text",children:["📍 ",F.currentLocation||"Sin ubicación"]})}),i.jsx("td",{className:"status-cell",children:i.jsxs("div",{className:`status-badge ${R(F.status)}`,children:[i.jsx("span",{className:"status-icon",children:x(F.status)}),i.jsx("span",{className:"status-text",children:F.status.charAt(0).toUpperCase()+F.status.slice(1)})]})}),i.jsx("td",{className:"date-cell",children:i.jsxs("div",{className:"date-content",children:[i.jsx("span",{className:"date-value",children:_(F.lastMovementDate)}),P(F)&&i.jsx("span",{className:"maintenance-warning",children:"⚠️"})]})}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"action-buttons",children:[i.jsx("button",{className:"btn-action btn-view",onClick:()=>t(F),title:"Ver detalles",children:"👁️"}),e&&F.status!==Ve.REPARACION&&i.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(F),title:"Editar vehículo",children:"✏️"}),a&&i.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>a(F),title:"Registrar mantenimiento",children:"🔧"})]})})]},F.id))})]})}),i.jsxs("div",{className:"table-info",children:[i.jsxs("div",{className:"table-summary",children:[i.jsxs("span",{className:"total-rows",children:[n.length," vehículo",n.length!==1?"s":""]}),o&&i.jsxs("span",{className:"sort-info",children:["Ordenado por ",o," (",d==="asc"?"ascendente":"descendente",")"]})]}),i.jsxs("div",{className:"table-legend",children:[i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-icon",children:"✅"})," Activo"]}),i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-icon",children:"🔧"})," Mantenimiento"]}),i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-icon",children:"⏸️"})," Inactivo"]}),i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-icon",children:"🔴"})," Reparación"]}),i.jsxs("span",{className:"legend-item",children:[i.jsx("span",{className:"legend-icon",children:"⚠️"})," Mantto. Debido"]})]})]})]})},cV=({vehicles:n,viewMode:e,onEdit:t,onView:a,onMaintenance:o})=>e==="table"?i.jsx(lV,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}):i.jsx(oV,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}),uV="modulepreload",dV=function(n){return"/combustibles/"+n},HE={},ny=function(e,t,a){let o=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(_=>Promise.resolve(_).then(N=>({status:"fulfilled",value:N}),N=>({status:"rejected",reason:N}))))};var d=g;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");o=g(t.map(y=>{if(y=dV(y),y in HE)return;HE[y]=!0;const _=y.endsWith(".css"),N=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${N}`))return;const j=document.createElement("link");if(j.rel=_?"stylesheet":uV,_||(j.as="script"),j.crossOrigin="",j.href=y,p&&j.setAttribute("nonce",p),document.head.appendChild(j),_)return new Promise((x,R)=>{j.addEventListener("load",x),j.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${y}`)))})}))}function c(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return o.then(f=>{for(const p of f||[])p.status==="rejected"&&c(p.reason);return e().catch(c)})},Tu="combustibles_vehicle_categories",hV=async n=>{try{const e=Dj(n);if(!e.isValid)throw new Error(`Datos inválidos: ${e.errors.join(", ")}`);const t=await zj();if(t.some(d=>d.id===n.id||d.name.toLowerCase()===n.name.toLowerCase()))throw new Error("Ya existe una categoría con ese nombre o ID");n.id||(n.id=Mj(n.name,t));const o={...n,createdAt:Ue(),updatedAt:Ue(),isCustom:!0,vehicleCount:0},c=await pl(Me(fe,Tu),o);return console.log("✅ Categoría creada:",n.name),{id:c.id,...o,createdAt:new Date,updatedAt:new Date}}catch(e){throw console.error("❌ Error al crear categoría:",e),new Error(`Error al crear categoría: ${e.message}`)}},zj=async()=>{try{const n=Ee(Me(fe,Tu),An("name","asc")),e=await ft(n),t=[];return e.forEach(a=>{t.push({id:a.id,...a.data(),createdAt:a.data().createdAt?.toDate?.()||a.data().createdAt,updatedAt:a.data().updatedAt?.toDate?.()||a.data().updatedAt})}),t}catch(n){throw console.error("❌ Error al obtener categorías personalizadas:",n),new Error(`Error al obtener categorías: ${n.message}`)}},sy=async()=>{try{const n=await zj();return Rj(n)}catch(n){return console.error("❌ Error al obtener todas las categorías:",n),os}},fV=async(n,e)=>{try{if(!n)throw new Error("ID de categoría requerido");if(os.some(d=>d.id===n))throw new Error("No se pueden modificar las categorías predeterminadas");if(e.name||e.fuelTypes||e.fields){const d=Dj({...e,id:n});if(!d.isValid)throw new Error(`Datos inválidos: ${d.errors.join(", ")}`)}const a={...e,updatedAt:Ue()},o=Je(fe,Tu,n);await As(o,a),console.log("✅ Categoría actualizada:",n);const c=await Fi(o);return{id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt}}catch(t){throw console.error("❌ Error al actualizar categoría:",t),new Error(`Error al actualizar categoría: ${t.message}`)}},mV=async n=>{try{if(!n)throw new Error("ID de categoría requerido");if(os.some(c=>c.id===n))throw new Error("No se pueden eliminar las categorías predeterminadas");const{countVehiclesByCategory:t}=await ny(async()=>{const{countVehiclesByCategory:c}=await Promise.resolve().then(()=>Uj);return{countVehiclesByCategory:c}},void 0),a=await t(n);if(a>0)throw new Error(`No se puede eliminar la categoría porque tiene ${a} vehículo(s) asignado(s)`);const o=Je(fe,Tu,n);return await vf(o),console.log("✅ Categoría eliminada:",n),!0}catch(e){throw console.error("❌ Error al eliminar categoría:",e),new Error(`Error al eliminar categoría: ${e.message}`)}},pV=n=>{try{const e=Ee(Me(fe,Tu),An("name","asc"));return qr(e,t=>{const a=[];t.forEach(c=>{a.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt})});const o=Rj(a);n(o)},t=>{console.error("❌ Error en suscripción a categorías:",t),n(os)})}catch(e){return console.error("❌ Error al suscribirse a categorías:",e),n(os),()=>{}}},GE=async()=>{try{const{getAllVehicles:n}=await ny(async()=>{const{getAllVehicles:a}=await Promise.resolve().then(()=>Uj);return{getAllVehicles:a}},void 0),e=await n();return(await sy()).map(a=>{const o=e.filter(c=>c.category===a.id);return{...a,vehicleCount:o.length,activeVehicles:o.filter(c=>c.status==="activo").length,totalFuelCapacity:o.reduce((c,d)=>c+(d.fuelCapacity||0),0),avgEnginepower:o.length>0?o.reduce((c,d)=>c+(d.enginePower||0),0)/o.length:0}}).sort((a,o)=>o.vehicleCount-a.vehicleCount)}catch(n){return console.error("❌ Error al obtener estadísticas de categorías:",n),[]}},Hj=({onClose:n,onCategoryCreated:e})=>{const[t,a]=H.useState([]),[o,c]=H.useState([]),[d,f]=H.useState(!0),[p,g]=H.useState(!1),[y,_]=H.useState(null),[N,j]=H.useState(!1),[x,R]=H.useState(""),[A,O]=H.useState({name:"",description:"",icon:"🚗",color:"#2E86AB",fuelTypes:[],fields:[]});H.useEffect(()=>{q();const w=pV(C=>{a(C),U()});return()=>w&&w()},[]);const q=async()=>{try{f(!0);const[w,C]=await Promise.all([sy(),GE()]);a(w),c(C)}catch(w){console.error("Error cargando categorías:",w),R("Error al cargar categorías")}finally{f(!1)}},U=async()=>{try{const w=await GE();c(w)}catch(w){console.error("Error cargando estadísticas:",w)}},P=()=>{_(null),O({name:"",description:"",icon:"🚗",color:"#2E86AB",fuelTypes:[],fields:[]}),j(!0)},F=w=>{if(os.some(C=>C.id===w.id)){R("No se pueden editar las categorías predeterminadas");return}_(w),O({name:w.name||"",description:w.description||"",icon:w.icon||"🚗",color:w.color||"#2E86AB",fuelTypes:w.fuelTypes||[],fields:w.fields||[]}),j(!0)},$=async w=>{if(os.some(D=>D.id===w.id)){R("No se pueden eliminar las categorías predeterminadas");return}if(window.confirm(`¿Está seguro de eliminar la categoría "${w.name}"?

Esta acción no se puede deshacer.`))try{g(!0),await mV(w.id),R("")}catch(D){console.error("Error eliminando categoría:",D),R(D.message)}finally{g(!1)}},V=async w=>{if(w.preventDefault(),!A.name.trim()){R("El nombre de la categoría es requerido");return}try{g(!0),R("");const C={...A,name:A.name.trim(),description:A.description.trim()};if(y)await fV(y.id,C);else{C.id=Mj(C.name,t);const D=await hV(C);e&&e(D)}j(!1)}catch(C){console.error("Error guardando categoría:",C),R(C.message)}finally{g(!1)}},S=w=>{O(C=>({...C,fields:C.fields.includes(w)?C.fields.filter(D=>D!==w):[...C.fields,w]}))},L=w=>{O(C=>({...C,fuelTypes:C.fuelTypes.includes(w)?C.fuelTypes.filter(D=>D!==w):[...C.fuelTypes,w]}))},M=w=>o.find(C=>C.id===w)||{vehicleCount:0,activeVehicles:0};return d?i.jsx("div",{className:"categories-manager",children:i.jsxs("div",{className:"loading",children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{children:"Cargando categorías..."})]})}):i.jsxs("div",{className:"categories-manager",children:[i.jsxs("div",{className:"categories-header",children:[i.jsx("h3",{children:"📋 Gestión de Categorías"}),i.jsxs("div",{className:"header-actions",children:[i.jsx("button",{className:"btn-primary",onClick:P,disabled:p,children:"➕ Nueva Categoría"}),i.jsx("button",{className:"btn-secondary",onClick:n,children:"✕ Cerrar"})]})]}),x&&i.jsxs("div",{className:"error-message",children:[i.jsxs("span",{children:["⚠️ ",x]}),i.jsx("button",{onClick:()=>R(""),children:"✕"})]}),i.jsx("div",{className:"categories-grid",children:t.map(w=>{const C=os.some(me=>me.id===w.id),D=M(w.id);return i.jsxs("div",{className:`category-card ${C?"default":"custom"}`,style:{"--category-color":w.color},children:[i.jsxs("div",{className:"category-header",children:[i.jsx("div",{className:"category-icon",style:{color:w.color},children:w.icon}),i.jsxs("div",{className:"category-info",children:[i.jsx("h4",{children:w.name}),i.jsx("p",{children:w.description})]}),C&&i.jsx("span",{className:"default-badge",children:"Predeterminada"})]}),i.jsxs("div",{className:"category-stats",children:[i.jsxs("div",{className:"stat",children:[i.jsx("span",{className:"stat-value",children:D.vehicleCount}),i.jsx("span",{className:"stat-label",children:"Vehículos"})]}),i.jsxs("div",{className:"stat",children:[i.jsx("span",{className:"stat-value",children:D.activeVehicles}),i.jsx("span",{className:"stat-label",children:"Activos"})]})]}),i.jsxs("div",{className:"category-details",children:[i.jsxs("div",{className:"fuel-types",children:[i.jsx("strong",{children:"Combustibles:"}),i.jsx("div",{className:"fuel-list",children:(w.fuelTypes||[]).map(me=>i.jsx("span",{className:"fuel-tag",children:me},me))})]}),i.jsxs("div",{className:"fields",children:[i.jsx("strong",{children:"Campos:"}),i.jsxs("div",{className:"fields-list",children:[(w.fields||[]).slice(0,3).map(me=>{const De=VE.find(Q=>Q.key===me);return De?i.jsxs("span",{className:"field-tag",children:[De.icon," ",De.label]},me):null}),(w.fields||[]).length>3&&i.jsxs("span",{className:"more-fields",children:["+",(w.fields||[]).length-3," más"]})]})]})]}),i.jsxs("div",{className:"category-actions",children:[i.jsx("button",{className:"btn-edit",onClick:()=>F(w),disabled:C||p,title:C?"No se pueden editar categorías predeterminadas":"Editar categoría",children:"✏️ Editar"}),i.jsx("button",{className:"btn-delete",onClick:()=>$(w),disabled:C||p||D.vehicleCount>0,title:C?"No se pueden eliminar categorías predeterminadas":D.vehicleCount>0?"No se puede eliminar una categoría con vehículos asignados":"Eliminar categoría",children:"🗑️ Eliminar"})]})]},w.id)})}),N&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:y?"✏️ Editar Categoría":"➕ Nueva Categoría"}),i.jsx("button",{onClick:()=>j(!1),children:"✕"})]}),i.jsxs("form",{onSubmit:V,className:"category-form",children:[i.jsxs("div",{className:"form-section",children:[i.jsx("h4",{children:"Información Básica"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Nombre *"}),i.jsx("input",{type:"text",value:A.name,onChange:w=>O(C=>({...C,name:w.target.value})),placeholder:"Ej: Maquinaria Pesada",required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Icono"}),i.jsx("input",{type:"text",value:A.icon,onChange:w=>O(C=>({...C,icon:w.target.value})),placeholder:"🚗",className:"icon-input"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Descripción"}),i.jsx("textarea",{value:A.description,onChange:w=>O(C=>({...C,description:w.target.value})),placeholder:"Describe el tipo de vehículos que incluye esta categoría",rows:"2"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Color"}),i.jsx("input",{type:"color",value:A.color,onChange:w=>O(C=>({...C,color:w.target.value})),className:"color-input"})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h4",{children:"Tipos de Combustible Compatibles"}),i.jsx("div",{className:"fuel-types-grid",children:Object.values(Ij).map(w=>i.jsxs("label",{className:"checkbox-label",children:[i.jsx("input",{type:"checkbox",checked:A.fuelTypes.includes(w),onChange:()=>L(w)}),i.jsx("span",{children:w})]},w))})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h4",{children:"Campos Específicos"}),i.jsx("p",{className:"section-description",children:"Selecciona los campos que serán relevantes para esta categoría"}),i.jsx("div",{className:"fields-grid",children:VE.map(w=>i.jsxs("label",{className:"checkbox-label",children:[i.jsx("input",{type:"checkbox",checked:A.fields.includes(w.key),onChange:()=>S(w.key)}),i.jsxs("span",{children:[w.icon," ",w.label]})]},w.key))})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h4",{children:"Vista Previa"}),i.jsx("div",{className:"category-preview",style:{"--category-color":A.color},children:i.jsxs("div",{className:"category-header",children:[i.jsx("div",{className:"category-icon",style:{color:A.color},children:A.icon}),i.jsxs("div",{className:"category-info",children:[i.jsx("h4",{children:A.name||"Nombre de la categoría"}),i.jsx("p",{children:A.description||"Descripción de la categoría"})]})]})})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>j(!1),disabled:p,children:"Cancelar"}),i.jsx("button",{type:"submit",className:"btn-primary",disabled:p||!A.name.trim(),children:p?"Guardando...":y?"Actualizar":"Crear"})]})]})]})})]})},gV=({isOpen:n,onClose:e,vehicle:t,onSave:a,mode:o="create"})=>{const[c,d]=H.useState([]),[f,p]=H.useState(null),[g,y]=H.useState(!1),[_,N]=H.useState(!1),[j,x]=H.useState(!1),[R,A]=H.useState({}),O=H.useCallback(()=>({vehicleId:t?.vehicleId||"",name:t?.name||"",category:t?.category||"",brand:t?.brand||"",model:t?.model||"",year:t?.year||new Date().getFullYear(),fuelType:t?.fuelType||vt.DIESEL,status:t?.status||Ve.ACTIVO,currentLocation:t?.currentLocation||"",description:t?.description||"",plateNumber:t?.plateNumber||"",enginePower:t?.enginePower||"",fuelCapacity:t?.fuelCapacity||"",operatingWeight:t?.operatingWeight||"",loadCapacity:t?.loadCapacity||"",bucketCapacity:t?.bucketCapacity||"",hasHourMeter:t?.hasHourMeter||!1,currentHours:t?.currentHours||"",implementType:t?.implementType||"",flow:t?.flow||"",pressure:t?.pressure||"",weight:t?.weight||"",lastMaintenanceDate:t?.lastMaintenanceDate?new Date(t.lastMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:t?.purchaseDate?new Date(t.purchaseDate).toISOString().split("T")[0]:""}),[t]),[q,U]=H.useState(O()),P=H.useCallback(async()=>{try{x(!0);const w=await sy();if(d(w),o==="create"&&w.length>0){const C=w[0];p(C),U(D=>({...D,category:C.id}))}}catch(w){console.error("Error cargando categorías:",w)}finally{x(!1)}},[o]);H.useEffect(()=>(n?(P(),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n,P]),H.useEffect(()=>{if(t&&c.length>0){const w=UE(t.category,c);p(w),U(O())}},[t,c,O]);const F=w=>{const C=UE(w,c);p(C),U(D=>{const me=o==="create"&&D.name&&C?V(D.name,C):D.vehicleId;return{...D,category:w,vehicleId:me,fuelType:C?.fuelTypes?.includes(D.fuelType)?D.fuelType:C?.fuelTypes?.[0]||vt.DIESEL}}),A({})},$=(w,C)=>{if(U(D=>({...D,[w]:C})),R[w]&&A(D=>({...D,[w]:null})),w==="name"&&o==="create"){const D=V(C,f);U(me=>({...me,vehicleId:D}))}if(w==="category"&&o==="create"&&q.name){const D=f;if(D){const me=V(q.name,D);U(De=>({...De,vehicleId:me}))}}},V=(w,C)=>{if(!w||!C)return"";const D=C.name.split(" ").map(ne=>ne.charAt(0).toUpperCase()).join("").substring(0,3),me=w.replace(/[^a-zA-Z0-9]/g,"").substring(0,4).toUpperCase(),Q=Date.now().toString().slice(-3);return`${D}${me}${Q}`},S=()=>{const w={};return q.vehicleId?.trim()||(w.vehicleId="Código del vehículo es requerido"),q.name?.trim()||(w.name="Nombre del vehículo es requerido"),q.category||(w.category="Categoría es requerida"),q.fuelType||(w.fuelType="Tipo de combustible es requerido"),f&&q.fuelType&&(f.fuelTypes?.includes(q.fuelType)||(w.fuelType=`Este combustible no es compatible con la categoría ${f.name}`)),["enginePower","fuelCapacity","operatingWeight","loadCapacity","bucketCapacity","flow","pressure","weight"].forEach(D=>{q[D]&&(isNaN(q[D])||Number(q[D])<0)&&(w[D]="Debe ser un número válido mayor o igual a 0")}),q.year&&(q.year<1900||q.year>new Date().getFullYear()+1)&&(w.year=`Año debe estar entre 1900 y ${new Date().getFullYear()+1}`),q.hasHourMeter&&q.currentHours&&(isNaN(q.currentHours)||Number(q.currentHours)<0)&&(w.currentHours="Horas actuales debe ser un número válido mayor o igual a 0"),A(w),Object.keys(w).length===0},L=async w=>{if(w.preventDefault(),!!S())try{x(!0);const C={...q,type:f?.name||q.category||"Otro",enginePower:q.enginePower?Number(q.enginePower):null,fuelCapacity:q.fuelCapacity?Number(q.fuelCapacity):null,operatingWeight:q.operatingWeight?Number(q.operatingWeight):null,loadCapacity:q.loadCapacity?Number(q.loadCapacity):null,bucketCapacity:q.bucketCapacity?Number(q.bucketCapacity):null,currentHours:q.currentHours?Number(q.currentHours):null,flow:q.flow?Number(q.flow):null,pressure:q.pressure?Number(q.pressure):null,weight:q.weight?Number(q.weight):null,year:Number(q.year),lastMaintenanceDate:q.lastMaintenanceDate?new Date(q.lastMaintenanceDate):null,purchaseDate:q.purchaseDate?new Date(q.purchaseDate):null,categoryName:f?.name,categoryIcon:f?.icon,categoryColor:f?.color};await a(C),e()}catch(C){console.error("Error guardando vehículo:",C),A({submit:C.message})}finally{x(!1)}},M=()=>f&&f.fuelTypes||Object.values(vt);return n?i.jsxs("div",{className:"modal-overlay",children:[i.jsxs("div",{className:"modal-container",children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{children:o==="create"?"🚗 Nuevo Vehículo":"✏️ Editar Vehículo"}),i.jsxs("div",{className:"header-actions",children:[i.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>y(!0),disabled:j,children:"📋 Gestionar Categorías"}),i.jsx("button",{type:"button",className:"btn-close",onClick:e,children:"✕"})]})]}),i.jsxs("form",{onSubmit:L,className:"modal-body",children:[R.submit&&i.jsxs("div",{className:"error-banner",children:["⚠️ ",R.submit]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h3",{children:"📂 Categoría del Vehículo"}),j?i.jsxs("div",{className:"loading-categories",children:[i.jsx("div",{className:"spinner"}),i.jsx("span",{children:"Cargando categorías..."})]}):i.jsxs("div",{className:"categories-selector",children:[i.jsxs("select",{value:q.category,onChange:w=>F(w.target.value),className:`category-select ${R.category?"error":""}`,children:[i.jsx("option",{value:"",children:"Seleccionar categoría del vehículo..."}),c.map(w=>i.jsxs("option",{value:w.id,children:[w.icon," ",w.name,os.some(C=>C.id===w.id)&&" (Predeterminada)"]},w.id))]}),f&&i.jsx(vV,{category:f,isExpanded:_,onToggle:()=>N(!_)})]}),R.category&&i.jsx("span",{className:"field-error",children:R.category})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h3",{children:"📝 Información Básica"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"vehicleId",className:"form-label",children:"🏷️ Código del Vehículo *"}),i.jsx("input",{type:"text",id:"vehicleId",value:q.vehicleId,className:`form-input ${R.vehicleId?"error":""} ${o==="create"?"readonly":""}`,placeholder:"Se genera automáticamente",readOnly:o==="create",onChange:o==="edit"?w=>$("vehicleId",w.target.value):void 0,required:!0}),R.vehicleId&&i.jsx("span",{className:"field-error",children:R.vehicleId})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"📛 Nombre del Vehículo *"}),i.jsx("input",{type:"text",id:"name",value:q.name,onChange:w=>$("name",w.target.value),className:`form-input ${R.name?"error":""}`,placeholder:"Ej: Excavadora Principal, Tractor TR1",required:!0}),R.name&&i.jsx("span",{className:"field-error",children:R.name})]})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"brand",className:"form-label",children:"🏭 Marca"}),i.jsx("input",{type:"text",id:"brand",value:q.brand,onChange:w=>$("brand",w.target.value),className:"form-input",placeholder:"Ej: Caterpillar, John Deere"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"year",className:"form-label",children:"📅 Año"}),i.jsx("input",{type:"number",id:"year",value:q.year,onChange:w=>$("year",w.target.value),className:`form-input ${R.year?"error":""}`,min:"1900",max:new Date().getFullYear()+1}),R.year&&i.jsx("span",{className:"field-error",children:R.year})]})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"fuelType",className:"form-label",children:"⛽ Tipo de Combustible *"}),i.jsx("select",{id:"fuelType",value:q.fuelType,onChange:w=>$("fuelType",w.target.value),className:`form-input ${R.fuelType?"error":""}`,required:!0,children:M().map(w=>i.jsx("option",{value:w,children:w},w))}),R.fuelType&&i.jsx("span",{className:"field-error",children:R.fuelType})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",className:"form-label",children:"🚦 Estado"}),i.jsx("select",{id:"status",value:q.status,onChange:w=>$("status",w.target.value),className:"form-input",children:Object.entries(Ve).map(([w,C])=>i.jsx("option",{value:C,children:C.charAt(0).toUpperCase()+C.slice(1)},w))})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"currentLocation",className:"form-label",children:"📍 Ubicación Actual"}),i.jsx("input",{type:"text",id:"currentLocation",value:q.currentLocation,onChange:w=>$("currentLocation",w.target.value),className:"form-input",placeholder:"Ej: Sector Norte, Patio Principal"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"📄 Descripción"}),i.jsx("textarea",{id:"description",value:q.description,onChange:w=>$("description",w.target.value),className:"form-input",rows:"3",placeholder:"Descripción adicional del vehículo, características especiales, etc."})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h3",{children:"📅 Fechas Importantes"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"purchaseDate",className:"form-label",children:"💰 Fecha de Compra"}),i.jsx("input",{type:"date",id:"purchaseDate",value:q.purchaseDate,onChange:w=>$("purchaseDate",w.target.value),className:"form-input"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lastMaintenanceDate",className:"form-label",children:"🔧 Último Mantenimiento"}),i.jsx("input",{type:"date",id:"lastMaintenanceDate",value:q.lastMaintenanceDate,onChange:w=>$("lastMaintenanceDate",w.target.value),className:"form-input"})]})]})]}),f&&i.jsxs("div",{className:"form-section",children:[i.jsx("h3",{children:"👁️ Vista Previa"}),i.jsx("div",{className:"vehicle-preview",style:{"--category-color":f.color},children:i.jsxs("div",{className:"preview-header",children:[i.jsx("div",{className:"preview-icon",style:{color:f.color},children:f.icon}),i.jsxs("div",{className:"preview-info",children:[i.jsx("h4",{children:q.name||"Nombre del vehículo"}),i.jsxs("p",{children:[q.vehicleId||"Código del vehículo"," • ",f.name]}),i.jsxs("p",{children:[q.brand," ",q.year]})]})]})})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:j,children:"Cancelar"}),i.jsx("button",{type:"submit",className:"btn-primary",disabled:j||!f,children:j?"Guardando...":o==="create"?"Crear Vehículo":"Actualizar Vehículo"})]})]})]}),g&&i.jsx(Hj,{onClose:()=>y(!1),onCategoryCreated:w=>{d(C=>[...C,w]),y(!1)}})]}):null},vV=({category:n,isExpanded:e,onToggle:t})=>n?i.jsxs("div",{className:"category-info-panel",children:[i.jsxs("div",{className:"category-compact",children:[i.jsxs("div",{className:"category-summary",children:[i.jsx("span",{className:"category-icon",style:{color:n.color},children:n.icon}),i.jsxs("div",{className:"category-basic-info",children:[i.jsx("span",{className:"category-name",children:n.name}),i.jsx("span",{className:"category-short-desc",children:n.description?.length>50?n.description.substring(0,50)+"...":n.description})]})]}),i.jsx("button",{type:"button",className:"category-toggle-btn",onClick:t,"aria-label":e?"Contraer información":"Expandir información",children:e?"▲":"▼"})]}),e&&i.jsxs("div",{className:"category-expanded",children:[i.jsxs("div",{className:"category-detail-section",children:[i.jsx("h4",{children:"📋 Descripción Completa"}),i.jsx("p",{children:n.description})]}),n.fuelTypes&&n.fuelTypes.length>0&&i.jsxs("div",{className:"category-detail-section",children:[i.jsx("h4",{children:"⛽ Combustibles Compatibles"}),i.jsx("div",{className:"fuel-types-list",children:n.fuelTypes.map(a=>i.jsx("span",{className:"fuel-type-badge",children:a},a))})]}),n.fields&&n.fields.length>0&&i.jsxs("div",{className:"category-detail-section",children:[i.jsx("h4",{children:"🔧 Campos Específicos"}),i.jsx("div",{className:"fields-list",children:n.fields.map(a=>i.jsx("span",{className:"field-badge",children:a},a))})]}),n.isCustom&&i.jsx("div",{className:"category-detail-section",children:i.jsx("span",{className:"custom-badge",children:"✨ Categoría Personalizada"})})]})]}):null,Po={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},fi={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},Lo={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},yV=({isOpen:n,onClose:e,vehicle:t,maintenance:a,onSave:o,mode:c="create",userRole:d})=>{const f=H.useCallback(()=>({vehicleId:t?.vehicleId||"",vehicleName:t?.name||"",type:a?.type||Po.PREVENTIVO,title:a?.title||"",description:a?.description||"",priority:a?.priority||Lo.MEDIA,status:a?.status||fi.PROGRAMADO,scheduledDate:a?.scheduledDate?new Date(a.scheduledDate).toISOString().split("T")[0]:"",startDate:a?.startDate?new Date(a.startDate).toISOString().split("T")[0]:"",completedDate:a?.completedDate?new Date(a.completedDate).toISOString().split("T")[0]:"",estimatedHours:a?.estimatedHours||0,actualHours:a?.actualHours||0,estimatedCost:a?.estimatedCost||0,actualCost:a?.actualCost||0,technician:a?.technician||"",workshop:a?.workshop||"",parts:a?.parts||[],notes:a?.notes||"",nextMaintenanceKm:a?.nextMaintenanceKm||0,nextMaintenanceHours:a?.nextMaintenanceHours||0,nextMaintenanceDate:a?.nextMaintenanceDate?new Date(a.nextMaintenanceDate).toISOString().split("T")[0]:""}),[a,t]),[p,g]=H.useState(f()),[y,_]=H.useState({}),[N,j]=H.useState(!1),[x,R]=H.useState({name:"",quantity:1,cost:0});H.useEffect(()=>{n&&(g(f()),_({}))},[n,a,t,f]);const A=C=>{const{name:D,value:me,type:De}=C.target,Q=De==="number"?parseFloat(me)||0:me;g(ne=>({...ne,[D]:Q})),y[D]&&_(ne=>({...ne,[D]:null}))},O=C=>{const{name:D,value:me,type:De}=C.target,Q=De==="number"?parseFloat(me)||0:me;R(ne=>({...ne,[D]:Q}))},q=()=>{if(!x.name.trim())return;const C={id:Date.now().toString(),name:x.name.trim(),quantity:x.quantity,cost:x.cost,total:x.quantity*x.cost};g(D=>({...D,parts:[...D.parts,C]})),R({name:"",quantity:1,cost:0})},U=C=>{g(D=>({...D,parts:D.parts.filter(me=>me.id!==C)}))},P=()=>{const C={};if(p.title.trim()||(C.title="El título del mantenimiento es obligatorio"),p.description.trim()||(C.description="La descripción es obligatoria"),p.scheduledDate||(C.scheduledDate="La fecha programada es obligatoria"),p.startDate&&p.completedDate){const D=new Date(p.startDate);new Date(p.completedDate)<D&&(C.completedDate="La fecha de finalización debe ser posterior al inicio")}return p.scheduledDate&&p.startDate&&(new Date(p.scheduledDate),new Date(p.startDate)),p.estimatedHours<0&&(C.estimatedHours="Las horas estimadas no pueden ser negativas"),p.actualHours<0&&(C.actualHours="Las horas reales no pueden ser negativas"),p.estimatedCost<0&&(C.estimatedCost="El costo estimado no puede ser negativo"),p.actualCost<0&&(C.actualCost="El costo real no puede ser negativo"),p.status===fi.COMPLETADO&&!p.completedDate&&(C.completedDate="La fecha de finalización es obligatoria para mantenimientos completados"),p.status===fi.EN_PROCESO&&!p.startDate&&(C.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),_(C),Object.keys(C).length===0},F=async C=>{if(C.preventDefault(),!!P()){j(!0);try{const D=p.parts.reduce((ne,he)=>ne+he.total,0),me=p.estimatedCost+D,De=p.actualCost+D,Q={...p,vehicleId:t.id,vehicleName:t.name,totalPartsCost:D,totalEstimatedCost:me,totalActualCost:De,scheduledDate:p.scheduledDate||null,startDate:p.startDate||null,completedDate:p.completedDate||null,nextMaintenanceDate:p.nextMaintenanceDate||null,createdAt:a?.createdAt||new Date,updatedAt:new Date};await o(Q),e()}catch(D){console.error("Error guardando mantenimiento:",D),_({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{j(!1)}}},$=C=>{switch(C){case Po.PREVENTIVO:return"🔧";case Po.CORRECTIVO:return"🛠️";case Po.PREDICTIVO:return"📊";case Po.EMERGENCIA:return"🚨";default:return"⚙️"}},V=C=>{switch(C){case Lo.BAJA:return"priority-low";case Lo.MEDIA:return"priority-medium";case Lo.ALTA:return"priority-high";case Lo.CRITICA:return"priority-critical";default:return"priority-medium"}},S=C=>{switch(C){case fi.PROGRAMADO:return"status-scheduled";case fi.EN_PROCESO:return"status-in-progress";case fi.COMPLETADO:return"status-completed";case fi.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},L=()=>p.parts.reduce((C,D)=>C+D.total,0),M=c==="view",w=d==="admin"||d==="supervisor";return n?i.jsx("div",{className:"modal-overlay",onClick:e,children:i.jsxs("div",{className:"modal-content maintenance-modal",onClick:C=>C.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsxs("div",{className:"modal-title",children:[i.jsx("span",{className:"title-icon",children:c==="create"?"➕":c==="edit"?"✏️":"👁️"}),i.jsxs("div",{className:"title-text",children:[i.jsxs("h3",{children:[c==="create"&&"Registrar Mantenimiento",c==="edit"&&"Editar Mantenimiento",c==="view"&&"Detalles del Mantenimiento"]}),i.jsxs("p",{children:["Vehículo: ",t?.vehicleId," - ",t?.name]})]})]}),i.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),i.jsxs("form",{onSubmit:F,className:"modal-form",children:[i.jsxs("div",{className:"form-content",children:[y.general&&i.jsxs("div",{className:"error-message general-error",children:["⚠️ ",y.general]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h4",{className:"section-title",children:"📋 Información del Mantenimiento"}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),i.jsx("select",{id:"type",name:"type",value:p.type,onChange:A,disabled:M||c==="edit"&&!w,children:Object.values(Po).map(C=>i.jsxs("option",{value:C,children:[$(C)," ",C.charAt(0).toUpperCase()+C.slice(1)]},C))})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"priority",children:"Prioridad"}),i.jsx("select",{id:"priority",name:"priority",value:p.priority,onChange:A,className:V(p.priority),disabled:M||c==="edit"&&!w,children:Object.values(Lo).map(C=>i.jsx("option",{value:C,children:C.charAt(0).toUpperCase()+C.slice(1)},C))})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Estado"}),i.jsx("select",{id:"status",name:"status",value:p.status,onChange:A,className:S(p.status),disabled:M||c==="edit"&&!w,children:Object.values(fi).map(C=>i.jsx("option",{value:C,children:C.charAt(0).toUpperCase()+C.slice(1).replace("_"," ")},C))})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"title",children:"Título del Mantenimiento *"}),i.jsx("input",{type:"text",id:"title",name:"title",value:p.title,onChange:A,placeholder:"Ej: Cambio de aceite y filtros",className:y.title?"error":"",disabled:M||c==="edit"&&!w,maxLength:100}),y.title&&i.jsx("span",{className:"error-text",children:y.title})]})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h4",{className:"section-title",children:"📅 Programación"}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),i.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:p.scheduledDate,onChange:A,className:y.scheduledDate?"error":"",disabled:M||c==="edit"&&!w}),y.scheduledDate&&i.jsx("span",{className:"error-text",children:y.scheduledDate})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),i.jsx("input",{type:"date",id:"startDate",name:"startDate",value:p.startDate,onChange:A,className:y.startDate?"error":"",disabled:M||c==="edit"&&!w}),y.startDate&&i.jsx("span",{className:"error-text",children:y.startDate})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalización"}),i.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:p.completedDate,onChange:A,className:y.completedDate?"error":"",disabled:M||c==="edit"&&!w}),y.completedDate&&i.jsx("span",{className:"error-text",children:y.completedDate})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),i.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:p.nextMaintenanceDate,onChange:A,disabled:M||c==="edit"&&!w})]})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h4",{className:"section-title",children:"💰 Recursos y Costos"}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"technician",children:"Técnico Responsable"}),i.jsx("input",{type:"text",id:"technician",name:"technician",value:p.technician,onChange:A,placeholder:"Nombre del técnico",disabled:M||c==="edit"&&!w,maxLength:100})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicación"}),i.jsx("input",{type:"text",id:"workshop",name:"workshop",value:p.workshop,onChange:A,placeholder:"Taller donde se realiza",disabled:M||c==="edit"&&!w,maxLength:100})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),i.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:p.estimatedHours,onChange:A,min:"0",step:"0.5",className:y.estimatedHours?"error":"",disabled:M||c==="edit"&&!w}),y.estimatedHours&&i.jsx("span",{className:"error-text",children:y.estimatedHours})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),i.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:p.actualHours,onChange:A,min:"0",step:"0.5",className:y.actualHours?"error":"",disabled:M||c==="edit"&&!w}),y.actualHours&&i.jsx("span",{className:"error-text",children:y.actualHours})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),i.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:p.estimatedCost,onChange:A,min:"0",step:"1000",className:y.estimatedCost?"error":"",disabled:M||c==="edit"&&!w}),y.estimatedCost&&i.jsx("span",{className:"error-text",children:y.estimatedCost})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),i.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:p.actualCost,onChange:A,min:"0",step:"1000",className:y.actualCost?"error":"",disabled:M||c==="edit"&&!w}),y.actualCost&&i.jsx("span",{className:"error-text",children:y.actualCost})]})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h4",{className:"section-title",children:"🔧 Partes y Repuestos"}),!M&&w&&i.jsx("div",{className:"parts-form",children:i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),i.jsx("input",{type:"text",id:"partName",name:"name",value:x.name,onChange:O,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),i.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:x.quantity,onChange:O,min:"1",step:"1"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),i.jsx("input",{type:"number",id:"partCost",name:"cost",value:x.cost,onChange:O,min:"0",step:"1000"})]}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"button",className:"btn-add-part",onClick:q,disabled:!x.name.trim(),children:"➕ Agregar"})})]})}),p.parts.length>0&&i.jsx("div",{className:"parts-list",children:i.jsxs("table",{className:"parts-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parte"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Costo Unit."}),i.jsx("th",{children:"Total"}),!M&&w&&i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:p.parts.map(C=>i.jsxs("tr",{children:[i.jsx("td",{children:C.name}),i.jsx("td",{children:C.quantity}),i.jsxs("td",{children:["$",C.cost.toLocaleString("es-CO")]}),i.jsxs("td",{children:["$",C.total.toLocaleString("es-CO")]}),!M&&w&&i.jsx("td",{children:i.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>U(C.id),title:"Eliminar parte",children:"🗑️"})})]},C.id))}),i.jsx("tfoot",{children:i.jsxs("tr",{className:"total-row",children:[i.jsx("td",{colSpan:"3",children:i.jsx("strong",{children:"Total Partes:"})}),i.jsx("td",{children:i.jsxs("strong",{children:["$",L().toLocaleString("es-CO")]})}),!M&&w&&i.jsx("td",{})]})})]})})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h4",{className:"section-title",children:"🔄 Próximo Mantenimiento"}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Próximo Mantenimiento (Km)"}),i.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:p.nextMaintenanceKm,onChange:A,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:M||c==="edit"&&!w})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Próximo Mantenimiento (Horas)"}),i.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:p.nextMaintenanceHours,onChange:A,min:"0",step:"100",placeholder:"0 = No aplica",disabled:M||c==="edit"&&!w})]})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Descripción del Trabajo *"}),i.jsx("textarea",{id:"description",name:"description",value:p.description,onChange:A,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:y.description?"error":"",disabled:M||c==="edit"&&!w}),y.description&&i.jsx("span",{className:"error-text",children:y.description})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),i.jsx("textarea",{id:"notes",name:"notes",value:p.notes,onChange:A,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:M||c==="edit"&&!w}),i.jsxs("span",{className:"char-count",children:[p.notes.length,"/500 caracteres"]})]})]}),i.jsxs("div",{className:"cost-summary",children:[i.jsx("h4",{children:"💰 Resumen de Costos"}),i.jsxs("div",{className:"cost-grid",children:[i.jsxs("div",{className:"cost-item",children:[i.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),i.jsxs("span",{className:"cost-value",children:["$",p.actualCost.toLocaleString("es-CO")]})]}),i.jsxs("div",{className:"cost-item",children:[i.jsx("span",{className:"cost-label",children:"Partes:"}),i.jsxs("span",{className:"cost-value",children:["$",L().toLocaleString("es-CO")]})]}),i.jsxs("div",{className:"cost-item total-cost",children:[i.jsx("span",{className:"cost-label",children:"Total:"}),i.jsxs("span",{className:"cost-value",children:["$",(p.actualCost+L()).toLocaleString("es-CO")]})]})]})]})]}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:N,children:c==="view"?"Cerrar":"Cancelar"}),!M&&w&&i.jsx("button",{type:"submit",className:"btn-primary",disabled:N,children:N?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):i.jsx(i.Fragment,{children:c==="create"?"➕ Registrar Mantenimiento":"💾 Guardar Cambios"})})]})]})]})}):null},bV=()=>{const{user:n,userProfile:e}=ds(),[t,a]=H.useState([]),[o,c]=H.useState(null),[d,f]=H.useState(!0),[p,g]=H.useState(null),[y,_]=H.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[N,j]=H.useState("cards"),[x,R]=H.useState(""),[A,O]=H.useState(!1),[q,U]=H.useState(!1),[P,F]=H.useState(!1),[$,V]=H.useState(null),[S,L]=H.useState("create");H.useEffect(()=>{if(!n)return;f(!0);const ee=ty((le,ce)=>{if(ce){console.error("Error en suscripción de vehículos:",ce),g("Error al cargar vehículos"),f(!1);return}a(le),g(null),f(!1)},y);return()=>ee()},[n,y]),H.useEffect(()=>{n&&(async()=>{try{const le=await Lj(y);c(le)}catch(le){console.error("Error al cargar estadísticas:",le)}})()},[n,t,y]);const M=t.filter(ee=>{if(!x)return!0;const le=x.toLowerCase();return ee.vehicleId?.toLowerCase().includes(le)||ee.name?.toLowerCase().includes(le)||ee.type?.toLowerCase().includes(le)||ee.brand?.toLowerCase().includes(le)||ee.model?.toLowerCase().includes(le)||ee.currentLocation?.toLowerCase().includes(le)||ee.description?.toLowerCase().includes(le)}),w=()=>{V(null),L("create"),O(!0)},C=ee=>{V(ee),L("edit"),O(!0)},D=ee=>{V(ee),L("view"),O(!0)},me=ee=>{V(ee),U(!0)},De=()=>{O(!1),U(!1),V(null)},Q=ee=>{_(le=>({...le,...ee}))},ne=()=>{_({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),R("")},he=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",Oe=e?.role==="admin",z=e?.role==="admin"||e?.role==="contador";return d?i.jsx("div",{className:"vehicles-main",children:i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Cargando vehículos..."})]})}):p?i.jsx("div",{className:"vehicles-main",children:i.jsxs("div",{className:"error-container",children:[i.jsx("div",{className:"error-icon",children:"⚠️"}),i.jsx("h3",{children:"Error al cargar vehículos"}),i.jsx("p",{children:p}),i.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):i.jsxs("div",{className:"vehicles-main",children:[i.jsxs("div",{className:"vehicles-header",children:[i.jsxs("div",{className:"header-title",children:[i.jsx("h2",{children:"🚜 Gestión de Vehículos"}),i.jsx("p",{children:"Administra la maquinaria y vehículos forestales"})]}),he&&i.jsx("button",{className:"btn-create-vehicle",onClick:w,children:"➕ Nuevo Vehículo"})]}),o&&i.jsx(iV,{stats:o,filters:y}),i.jsx(rV,{filters:y,onFilterChange:Q,onClearFilters:ne,searchTerm:x,onSearchChange:R,viewMode:N,onViewModeChange:j,totalResults:M.length}),M.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"empty-icon",children:"🚜"}),i.jsx("h3",{children:t.length===0?"No hay vehículos registrados":"No se encontraron vehículos"}),i.jsx("p",{children:t.length===0?"Comienza registrando tu primer vehículo o maquinaria forestal":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&he&&i.jsx("button",{className:"btn-create-first",onClick:w,children:"➕ Registrar Primer Vehículo"})]}):i.jsx(cV,{vehicles:M,viewMode:N,onEdit:Oe?C:null,onView:D,onMaintenance:z?me:null,userRole:n?.role}),A&&i.jsx(gV,{isOpen:A,onClose:De,vehicle:$,mode:S,onSave:async ee=>{S==="create"?await Oj(ee):await Pj($.id,ee),De()},userRole:e?.role}),P&&i.jsx(Hj,{onClose:()=>F(!1),onCategoryCreated:()=>{}}),q&&i.jsx(yV,{isOpen:q,onClose:De,vehicle:$,onSuccess:()=>{De()}})]})},Au="combustibles_maintenance",Gj="combustibles_vehicles",pe={OIL_CHANGE:"oil_change",BATTERY_CHANGE:"battery_change",FILTER_CHANGE:"filter_change",GENERAL_MAINTENANCE:"general_maintenance"},Pe={COMPLETED:"completado",PENDING:"pendiente",CANCELLED:"cancelado"},Go={NEW:"nueva",USED:"usada",REPAIRED:"reparada"},ay={OIL_CHANGE_HOURS:250,BATTERY_LIFETIME_MONTHS:24},$j=async n=>{try{xV(n);const e={...n,createdAt:Ue(),updatedAt:Ue(),status:n.status||Pe.COMPLETED,createdBy:n.createdBy||"system"};n.type===pe.OIL_CHANGE&&(e.nextChangeHours=Tf(n.currentHours)),n.type===pe.BATTERY_CHANGE&&(e.nextBatteryChange=Zj(n.date));const t=await pl(Me(fe,Au),e);return n.vehicleId&&n.currentHours&&await Jj(n.vehicleId,n.currentHours),console.log("✅ Mantenimiento creado exitosamente:",t.id),t.id}catch(e){throw console.error("❌ Error al crear mantenimiento:",e),new Error(`Error al crear mantenimiento: ${e.message}`)}},Yj=async(n={})=>{try{let e=Me(fe,Au);n.type&&(e=Ee(e,Se("type","==",n.type))),n.vehicleId&&(e=Ee(e,Se("vehicleId","==",n.vehicleId))),n.status&&(e=Ee(e,Se("status","==",n.status))),n.dateFrom&&(e=Ee(e,Se("date",">=",new Date(n.dateFrom)))),n.dateTo&&(e=Ee(e,Se("date","<=",new Date(n.dateTo)))),e=Ee(e,An("date","desc"));const t=await ft(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data()})}),a}catch(e){throw console.error("❌ Error al obtener mantenimientos:",e),new Error(`Error al obtener mantenimientos: ${e.message}`)}},Qj=async(n,e)=>{try{NV(e);const t=Je(fe,Au,n),a={...e,updatedAt:Ue()};e.currentHours&&e.type===pe.OIL_CHANGE&&(a.nextChangeHours=Tf(e.currentHours)),await As(t,a),e.vehicleId&&e.currentHours&&await Jj(e.vehicleId,e.currentHours),console.log("✅ Mantenimiento actualizado exitosamente:",n)}catch(t){throw console.error("❌ Error al actualizar mantenimiento:",t),new Error(`Error al actualizar mantenimiento: ${t.message}`)}},_V=async n=>{try{const e=Je(fe,Au,n);await vf(e),console.log("✅ Mantenimiento eliminado exitosamente:",n)}catch(e){throw console.error("❌ Error al eliminar mantenimiento:",e),new Error(`Error al eliminar mantenimiento: ${e.message}`)}},Kj=async(n={})=>{try{const e=await Yj(n),t={total:e.length,byType:{},byStatus:{},byVehicle:{},totalCost:0,averageCost:0,upcomingCount:0,overdueCount:0};let a=0;return e.forEach(o=>{t.byType[o.type]=(t.byType[o.type]||0)+1,t.byStatus[o.status]=(t.byStatus[o.status]||0)+1,t.byVehicle[o.vehicleId]=(t.byVehicle[o.vehicleId]||0)+1,o.cost&&(a+=parseFloat(o.cost)),o.nextChangeDate&&(new Date(o.nextChangeDate)>new Date?t.upcomingCount++:t.overdueCount++)}),t.totalCost=a,t.averageCost=t.total>0?a/t.total:0,t}catch(e){throw console.error("❌ Error al obtener estadísticas de mantenimiento:",e),new Error(`Error al obtener estadísticas de mantenimiento: ${e.message}`)}},Xj=(n,e={})=>{try{let t=Me(fe,Au);return e.type&&(t=Ee(t,Se("type","==",e.type))),e.vehicleId&&(t=Ee(t,Se("vehicleId","==",e.vehicleId))),e.status&&(t=Ee(t,Se("status","==",e.status))),t=Ee(t,An("date","desc")),qr(t,o=>{const c=[];o.forEach(d=>{c.push({id:d.id,...d.data()})}),n(c,null)},o=>{console.error("❌ Error en suscripción de mantenimientos:",o),n([],o)})}catch(t){return console.error("❌ Error al suscribirse a mantenimientos:",t),n([],t),()=>{}}},Wj=async()=>{try{const n=Ee(Me(fe,Gj),Se("status","in",["activo","mantenimiento"]),An("name","asc")),e=await ft(n),t=[];return e.forEach(a=>{t.push({id:a.id,...a.data()})}),t}catch(n){throw console.error("❌ Error al obtener vehículos para mantenimiento:",n),new Error(`Error al obtener vehículos para mantenimiento: ${n.message}`)}},Tf=n=>parseInt(n)+ay.OIL_CHANGE_HOURS,Zj=n=>{const e=new Date(n);return e.setMonth(e.getMonth()+ay.BATTERY_LIFETIME_MONTHS),e},Jj=async(n,e)=>{try{const t=Ee(Me(fe,Gj),Se("vehicleId","==",n)),a=await ft(t);if(!a.empty){const o=a.docs[0],c=o.data();if(c.hasHourMeter&&c.type==="tractor"){const d=parseInt(c.currentHours)||0,f=parseInt(e)||0;f>d&&(await As(o.ref,{currentHours:f,lastHourMeterDate:Ue(),updatedAt:Ue()}),console.log(`✅ Horómetro actualizado para ${n}: ${d} → ${f}`))}}}catch(t){console.error("❌ Error al actualizar horómetro del vehículo:",t)}},xV=n=>{const e=[];if(n.type||e.push("El tipo de mantenimiento es obligatorio"),n.vehicleId||e.push("El vehículo es obligatorio"),n.date||e.push("La fecha es obligatoria"),n.type===pe.OIL_CHANGE&&((!n.quantity||n.quantity<=0)&&e.push("La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!n.currentHours||n.currentHours<0)&&e.push("La lectura del horómetro es obligatoria")),n.type===pe.BATTERY_CHANGE&&(n.batteryType||e.push("El tipo de batería es obligatorio"),(!n.cost||n.cost<=0)&&e.push("El costo de la batería es obligatorio")),e.length>0)throw new Error(e.join(", "))},NV=n=>{const e=[];if(n.type&&!Object.values(pe).includes(n.type)&&e.push("Tipo de mantenimiento inválido"),n.status&&!Object.values(Pe).includes(n.status)&&e.push("Estado de mantenimiento inválido"),n.batteryStatus&&!Object.values(Go).includes(n.batteryStatus)&&e.push("Estado de batería inválido"),e.length>0)throw new Error(e.join(", "))},EV=Object.freeze(Object.defineProperty({__proto__:null,BATTERY_STATUS:Go,MAINTENANCE_CONSTANTS:ay,MAINTENANCE_STATUS:Pe,MAINTENANCE_TYPES:pe,calculateNextBatteryChange:Zj,calculateNextOilChange:Tf,createMaintenanceRecord:$j,deleteMaintenanceRecord:_V,getAllMaintenanceRecords:Yj,getMaintenanceStats:Kj,getVehiclesForMaintenance:Wj,subscribeToMaintenance:Xj,updateMaintenanceRecord:Qj},Symbol.toStringTag,{value:"Module"})),TV=({stats:n})=>{if(!n)return null;const e=c=>{switch(c){case pe.OIL_CHANGE:return"🛢️";case pe.BATTERY_CHANGE:return"🔋";case pe.FILTER_CHANGE:return"🔧";case pe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},t=c=>{switch(c){case pe.OIL_CHANGE:return"Cambios de Aceite";case pe.BATTERY_CHANGE:return"Cambios de Batería";case pe.FILTER_CHANGE:return"Cambios de Filtros";case pe.GENERAL_MAINTENANCE:return"Mantenimientos Generales";default:return c}},a=c=>{switch(c){case Pe.COMPLETED:return"#10b981";case Pe.PENDING:return"#f59e0b";case Pe.CANCELLED:return"#ef4444";default:return"#6b7280"}},o=c=>{switch(c){case Pe.COMPLETED:return"Completados";case Pe.PENDING:return"Pendientes";case Pe.CANCELLED:return"Cancelados";default:return c}};return i.jsxs("div",{className:"maintenance-stats",children:[i.jsxs("div",{className:"stats-grid",children:[i.jsxs("div",{className:"stat-card primary",children:[i.jsx("div",{className:"stat-icon",children:"🔧"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("h3",{children:ke(n.total)}),i.jsx("p",{children:"Total Mantenimientos"})]})]}),i.jsxs("div",{className:"stat-card success",children:[i.jsx("div",{className:"stat-icon",children:"💰"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("h3",{children:Dn(n.totalCost)}),i.jsx("p",{children:"Costo Total"})]})]}),i.jsxs("div",{className:"stat-card warning",children:[i.jsx("div",{className:"stat-icon",children:"⏰"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("h3",{children:ke(n.upcomingCount)}),i.jsx("p",{children:"Próximos"})]})]}),i.jsxs("div",{className:"stat-card danger",children:[i.jsx("div",{className:"stat-icon",children:"⚠️"}),i.jsxs("div",{className:"stat-content",children:[i.jsx("h3",{children:ke(n.overdueCount)}),i.jsx("p",{children:"Vencidos"})]})]})]}),Object.keys(n.byType).length>0&&i.jsxs("div",{className:"stats-breakdown",children:[i.jsx("h3",{children:"📊 Desglose por Tipo"}),i.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([c,d])=>i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-header",children:[i.jsx("span",{className:"breakdown-icon",children:e(c)}),i.jsx("span",{className:"breakdown-label",children:t(c)})]}),i.jsx("div",{className:"breakdown-value",children:ke(d)}),i.jsx("div",{className:"breakdown-bar",children:i.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:"#3b82f6"}})}),i.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),Object.keys(n.byStatus).length>0&&i.jsxs("div",{className:"stats-breakdown",children:[i.jsx("h3",{children:"📈 Desglose por Estado"}),i.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([c,d])=>i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-header",children:[i.jsx("span",{className:"status-dot",style:{backgroundColor:a(c)}}),i.jsx("span",{className:"breakdown-label",children:o(c)})]}),i.jsx("div",{className:"breakdown-value",children:ke(d)}),i.jsx("div",{className:"breakdown-bar",children:i.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:a(c)}})}),i.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),i.jsxs("div",{className:"stats-insights",children:[i.jsx("h3",{children:"💡 Insights"}),i.jsxs("div",{className:"insights-grid",children:[i.jsxs("div",{className:"insight-item",children:[i.jsx("span",{className:"insight-label",children:"Costo Promedio:"}),i.jsx("span",{className:"insight-value",children:Dn(n.averageCost)})]}),n.overdueCount>0&&i.jsxs("div",{className:"insight-item alert",children:[i.jsx("span",{className:"insight-label",children:"⚠️ Mantenimientos Vencidos:"}),i.jsxs("span",{className:"insight-value",children:[ke(n.overdueCount)," requieren atención"]})]}),n.upcomingCount>0&&i.jsxs("div",{className:"insight-item info",children:[i.jsx("span",{className:"insight-label",children:"⏰ Próximos Mantenimientos:"}),i.jsxs("span",{className:"insight-value",children:[ke(n.upcomingCount)," programados"]})]})]})]})]})},AV=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const p=j=>{switch(j){case pe.OIL_CHANGE:return"Cambio de Aceite";case pe.BATTERY_CHANGE:return"Cambio de Batería";case pe.FILTER_CHANGE:return"Cambio de Filtros";case pe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return j}},g=j=>{switch(j){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return j}},y=(j,x)=>{e({[j]:x})},_=j=>{e(j)},N=()=>Object.values(n).some(j=>j!=="")||a;return i.jsx("div",{className:"maintenance-filters",children:i.jsxs("div",{className:"filters-main",children:[i.jsx("div",{className:"search-section",children:i.jsxs("div",{className:"search-box",children:[i.jsx("span",{className:"search-icon",children:"🔍"}),i.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar mantenimientos...",value:a,onChange:j=>o(j.target.value)}),a&&i.jsx("button",{className:"search-clear",onClick:()=>o(""),children:"×"})]})}),i.jsxs("div",{className:"filters-controls",children:[i.jsxs("div",{className:"quick-filters",children:[i.jsx("button",{className:`quick-filter ${N()?"":"active"}`,onClick:()=>t(),children:"Todos"}),i.jsx("button",{className:`quick-filter ${n.type===pe.OIL_CHANGE?"active":""}`,onClick:()=>_({type:pe.OIL_CHANGE}),children:"🛢️ Aceite"}),i.jsx("button",{className:`quick-filter ${n.type===pe.BATTERY_CHANGE?"active":""}`,onClick:()=>_({type:pe.BATTERY_CHANGE}),children:"🔋 Baterías"}),i.jsx("button",{className:`quick-filter ${n.status===Pe.PENDING?"active":""}`,onClick:()=>_({status:Pe.PENDING}),children:"⏰ Pendientes"})]}),i.jsxs("button",{className:`btn-advanced-filters ${N()?"active":""}`,onClick:()=>document.querySelector(".filters-advanced").classList.toggle("show"),children:["🔧 Filtros Avanzados",N()&&i.jsx("span",{className:"filters-count",children:Object.values(n).filter(j=>j!=="").length})]}),i.jsxs("div",{className:"view-modes",children:[i.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),children:"📋 Cards"}),i.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),children:"📊 Tabla"})]})]}),i.jsxs("div",{className:"filters-advanced",children:[i.jsxs("div",{className:"filters-grid",children:[i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Tipo de Mantenimiento"}),i.jsxs("select",{value:n.type,onChange:j=>y("type",j.target.value),children:[i.jsx("option",{value:"",children:"Todos los tipos"}),i.jsx("option",{value:pe.OIL_CHANGE,children:p(pe.OIL_CHANGE)}),i.jsx("option",{value:pe.BATTERY_CHANGE,children:p(pe.BATTERY_CHANGE)}),i.jsx("option",{value:pe.FILTER_CHANGE,children:p(pe.FILTER_CHANGE)}),i.jsx("option",{value:pe.GENERAL_MAINTENANCE,children:p(pe.GENERAL_MAINTENANCE)})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Estado"}),i.jsxs("select",{value:n.status,onChange:j=>y("status",j.target.value),children:[i.jsx("option",{value:"",children:"Todos los estados"}),i.jsx("option",{value:Pe.COMPLETED,children:g(Pe.COMPLETED)}),i.jsx("option",{value:Pe.PENDING,children:g(Pe.PENDING)}),i.jsx("option",{value:Pe.CANCELLED,children:g(Pe.CANCELLED)})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Fecha Desde"}),i.jsx("input",{type:"date",value:n.dateFrom,onChange:j=>y("dateFrom",j.target.value)})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Fecha Hasta"}),i.jsx("input",{type:"date",value:n.dateTo,onChange:j=>y("dateTo",j.target.value)})]})]}),i.jsx("div",{className:"filters-actions",children:i.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:!N(),children:"🗑️ Limpiar Filtros"})})]}),i.jsxs("div",{className:"filters-info",children:[i.jsxs("div",{className:"results-count",children:[f," mantenimiento",f!==1?"s":""," encontrado",f!==1?"s":""]}),N()&&i.jsxs("div",{className:"active-filters",children:[i.jsx("span",{className:"filters-label",children:"Filtros activos:"}),i.jsxs("div",{className:"filter-tags",children:[n.type&&i.jsxs("span",{className:"filter-tag",children:["Tipo: ",p(n.type),i.jsx("button",{onClick:()=>y("type",""),children:"×"})]}),n.status&&i.jsxs("span",{className:"filter-tag",children:["Estado: ",g(n.status),i.jsx("button",{onClick:()=>y("status",""),children:"×"})]}),n.dateFrom&&i.jsxs("span",{className:"filter-tag",children:["Desde: ",n.dateFrom,i.jsx("button",{onClick:()=>y("dateFrom",""),children:"×"})]}),n.dateTo&&i.jsxs("span",{className:"filter-tag",children:["Hasta: ",n.dateTo,i.jsx("button",{onClick:()=>y("dateTo",""),children:"×"})]}),a&&i.jsxs("span",{className:"filter-tag",children:['Búsqueda: "',a,'"',i.jsx("button",{onClick:()=>o(""),children:"×"})]})]})]})]})]})})},jV=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const c=x=>x?new Date(x).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"N/A",d=x=>{if(!x)return"";const R=new Date,A=new Date(x),O=Math.abs(R-A),q=Math.ceil(O/(1e3*60*60*24));return q===0?"Hoy":q===1?"Ayer":q<7?`Hace ${q} días`:q<30?`Hace ${Math.floor(q/7)} semanas`:`Hace ${Math.floor(q/30)} meses`},f=x=>{switch(x){case pe.OIL_CHANGE:return"maintenance-oil-change";case pe.BATTERY_CHANGE:return"maintenance-battery-change";case pe.FILTER_CHANGE:return"maintenance-filter-change";case pe.GENERAL_MAINTENANCE:return"maintenance-general";default:return"maintenance-general"}},p=x=>{switch(x){case Pe.COMPLETED:return"status-completado";case Pe.PENDING:return"status-pendiente";case Pe.CANCELLED:return"status-cancelado";default:return"status-unknown"}},g=x=>{switch(x){case pe.OIL_CHANGE:return"🛢️";case pe.BATTERY_CHANGE:return"🔋";case pe.FILTER_CHANGE:return"🔧";case pe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},y=x=>{switch(x){case pe.OIL_CHANGE:return"Cambio de Aceite";case pe.BATTERY_CHANGE:return"Cambio de Batería";case pe.FILTER_CHANGE:return"Cambio de Filtros";case pe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return x}},_=x=>{switch(x){case Pe.COMPLETED:return"✅";case Pe.PENDING:return"⏰";case Pe.CANCELLED:return"❌";default:return"❓"}},N=x=>{switch(x){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return x}},j=o==="admin"||o==="supervisor";return i.jsx("div",{className:"maintenance-cards",children:n.map(x=>i.jsxs("div",{className:`maintenance-card ${f(x.type)}`,children:[i.jsxs("div",{className:"card-header",children:[i.jsxs("div",{className:"maintenance-type",children:[i.jsx("span",{className:"type-icon",children:g(x.type)}),i.jsx("span",{className:"type-label",children:y(x.type)})]}),i.jsxs("div",{className:`status-badge ${p(x.status)}`,children:[_(x.status)," ",N(x.status)]})]}),i.jsxs("div",{className:"card-content",children:[i.jsxs("div",{className:"vehicle-info",children:[i.jsx("span",{className:"vehicle-icon",children:"🚜"}),i.jsxs("div",{className:"vehicle-details",children:[i.jsx("div",{className:"vehicle-name",children:x.vehicleName}),i.jsx("div",{className:"vehicle-id",children:x.vehicleId})]})]}),i.jsxs("div",{className:"date-info",children:[i.jsx("div",{className:"created-date",children:c(x.date)}),i.jsx("div",{className:"relative-time",children:d(x.date)})]}),x.type===pe.OIL_CHANGE&&i.jsxs("div",{className:"oil-change-info",children:[i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Cantidad:"}),i.jsxs("span",{className:"info-value",children:[ke(x.quantity)," galones"]})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Horómetro:"}),i.jsxs("span",{className:"info-value",children:[ke(x.currentHours)," horas"]})]}),x.nextChangeHours&&i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Próximo cambio:"}),i.jsxs("span",{className:"info-value",children:[ke(x.nextChangeHours)," horas"]})]}),x.filters&&i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Filtros:"}),i.jsx("span",{className:"info-value",children:x.filters})]})]}),x.type===pe.BATTERY_CHANGE&&i.jsxs("div",{className:"battery-change-info",children:[i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Tipo:"}),i.jsx("span",{className:"info-value",children:x.batteryType})]}),x.brand&&i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Marca:"}),i.jsx("span",{className:"info-value",children:x.brand})]}),x.model&&i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Modelo:"}),i.jsx("span",{className:"info-value",children:x.model})]}),i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Estado:"}),i.jsx("span",{className:"info-value",children:x.batteryStatus})]}),x.cost&&i.jsxs("div",{className:"info-row",children:[i.jsx("span",{className:"info-label",children:"Costo:"}),i.jsx("span",{className:"info-value",children:Dn(x.cost)})]})]}),x.notes&&i.jsxs("div",{className:"notes-section",children:[i.jsx("span",{className:"notes-label",children:"Notas:"}),i.jsx("p",{className:"notes-text",children:x.notes})]})]}),i.jsx("div",{className:"card-footer",children:i.jsxs("div",{className:"card-actions",children:[i.jsx("button",{className:"btn-view",onClick:()=>t(x),title:"Ver detalles",children:"👁️ Ver"}),j&&e&&i.jsx("button",{className:"btn-edit",onClick:()=>e(x),title:"Editar",children:"✏️ Editar"}),j&&a&&i.jsx("button",{className:"btn-delete",onClick:()=>a(x.id),title:"Eliminar",children:"🗑️ Eliminar"})]})})]},x.id))})},wV=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const[c,d]=H.useState("date"),[f,p]=H.useState("desc"),g=U=>U?new Date(U).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",y=U=>{switch(U){case pe.OIL_CHANGE:return"🛢️";case pe.BATTERY_CHANGE:return"🔋";case pe.FILTER_CHANGE:return"🔧";case pe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},_=U=>{switch(U){case pe.OIL_CHANGE:return"Cambio de Aceite";case pe.BATTERY_CHANGE:return"Cambio de Batería";case pe.FILTER_CHANGE:return"Cambio de Filtros";case pe.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return U}},N=U=>{switch(U){case Pe.COMPLETED:return"✅";case Pe.PENDING:return"⏰";case Pe.CANCELLED:return"❌";default:return"❓"}},j=U=>{switch(U){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return U}},x=U=>{switch(U){case Pe.COMPLETED:return"status-completado";case Pe.PENDING:return"status-pendiente";case Pe.CANCELLED:return"status-cancelado";default:return"status-unknown"}},R=U=>{c===U?p(f==="asc"?"desc":"asc"):(d(U),p("asc"))},A=U=>c!==U?"↕️":f==="asc"?"↑":"↓",O=[...n].sort((U,P)=>{let F=U[c],$=P[c];return c==="date"&&(F=new Date(F),$=new Date($)),["quantity","currentHours","nextChangeHours","cost"].includes(c)&&(F=parseFloat(F)||0,$=parseFloat($)||0),typeof F=="string"&&(F=F.toLowerCase(),$=$.toLowerCase()),f==="asc"?F>$?1:-1:F<$?1:-1}),q=o==="admin"||o==="supervisor";return i.jsxs("div",{className:"maintenance-table-container",children:[i.jsx("div",{className:"table-wrapper",children:i.jsxs("table",{className:"maintenance-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsxs("th",{className:"sortable",onClick:()=>R("type"),children:["Tipo ",A("type")]}),i.jsxs("th",{className:"sortable",onClick:()=>R("vehicleName"),children:["Vehículo ",A("vehicleName")]}),i.jsxs("th",{className:"sortable",onClick:()=>R("date"),children:["Fecha ",A("date")]}),i.jsx("th",{children:"Detalles"}),i.jsxs("th",{className:"sortable",onClick:()=>R("status"),children:["Estado ",A("status")]}),i.jsxs("th",{className:"sortable text-right",onClick:()=>R("cost"),children:["Costo ",A("cost")]}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:O.map(U=>i.jsxs("tr",{className:"maintenance-row",children:[i.jsx("td",{className:"type-cell",children:i.jsxs("div",{className:"type-content",children:[i.jsx("span",{className:"type-icon",children:y(U.type)}),i.jsx("span",{className:"type-name",children:_(U.type)})]})}),i.jsx("td",{className:"vehicle-cell",children:i.jsxs("div",{className:"vehicle-info",children:[i.jsx("div",{className:"vehicle-name",children:U.vehicleName}),i.jsx("div",{className:"vehicle-id",children:U.vehicleId})]})}),i.jsx("td",{className:"date-cell",children:i.jsx("div",{className:"date-content",children:i.jsx("div",{className:"date-value",children:g(U.date)})})}),i.jsxs("td",{className:"details-cell",children:[U.type===pe.OIL_CHANGE&&i.jsxs("div",{className:"oil-details",children:[i.jsxs("div",{children:["Qty: ",ke(U.quantity)," gal"]}),i.jsxs("div",{children:["Hrs: ",ke(U.currentHours)]}),U.filters&&i.jsxs("div",{children:["Filtros: ",U.filters]})]}),U.type===pe.BATTERY_CHANGE&&i.jsxs("div",{className:"battery-details",children:[i.jsx("div",{children:U.batteryType}),U.brand&&i.jsx("div",{children:U.brand}),i.jsxs("div",{children:["Estado: ",U.batteryStatus]})]}),U.notes&&i.jsx("div",{className:"notes-small",children:U.notes})]}),i.jsx("td",{className:"status-cell",children:i.jsxs("div",{className:`status-badge ${x(U.status)}`,children:[N(U.status)," ",j(U.status)]})}),i.jsx("td",{className:"cost-cell text-right",children:U.cost?Dn(U.cost):"N/A"}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"action-buttons",children:[i.jsx("button",{className:"btn-action btn-view",onClick:()=>t(U),title:"Ver detalles",children:"👁️"}),q&&e&&i.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(U),title:"Editar",children:"✏️"}),q&&a&&i.jsx("button",{className:"btn-action btn-delete",onClick:()=>a(U.id),title:"Eliminar",children:"🗑️"})]})})]},U.id))})]})}),i.jsxs("div",{className:"table-info",children:[i.jsx("div",{className:"table-summary",children:i.jsxs("span",{className:"total-rows",children:[n.length," mantenimiento",n.length!==1?"s":""," en total"]})}),i.jsxs("div",{className:"table-legend",children:[i.jsxs("div",{className:"legend-item",children:[i.jsx("span",{className:"legend-dot oil-change"}),i.jsx("span",{children:"Cambio de Aceite"})]}),i.jsxs("div",{className:"legend-item",children:[i.jsx("span",{className:"legend-dot battery-change"}),i.jsx("span",{children:"Cambio de Batería"})]}),i.jsxs("div",{className:"legend-item",children:[i.jsx("span",{className:"legend-dot filter-change"}),i.jsx("span",{children:"Cambio de Filtros"})]}),i.jsxs("div",{className:"legend-item",children:[i.jsx("span",{className:"legend-dot general"}),i.jsx("span",{children:"Mantenimiento General"})]})]})]})]})},CV=({maintenanceRecords:n,viewMode:e,onEdit:t,onView:a,onDelete:o,userRole:c})=>!n||n.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"empty-icon",children:"🔧"}),i.jsx("h3",{children:"No hay mantenimientos registrados"}),i.jsx("p",{children:"Comienza creando el primer mantenimiento para tu flota de vehículos."})]}):i.jsx("div",{className:"maintenance-list",children:e==="cards"?i.jsx(jV,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c}):i.jsx(wV,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c})}),SV=({isOpen:n,onClose:e,onSuccess:t,maintenance:a,mode:o="create",userRole:c})=>{const d=H.useCallback(()=>({type:a?.type||pe.OIL_CHANGE,vehicleId:a?.vehicleId||"",vehicleName:a?.vehicleName||"",date:a?.date?new Date(a.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:a?.status||Pe.COMPLETED,quantity:a?.quantity||0,currentHours:a?.currentHours||0,nextChangeHours:a?.nextChangeHours||0,filters:a?.filters||"",batteryType:a?.batteryType||"",brand:a?.brand||"",model:a?.model||"",batteryStatus:a?.batteryStatus||Go.NEW,notes:a?.notes||"",cost:a?.cost||0}),[a]),[f,p]=H.useState(d()),[g,y]=H.useState({}),[_,N]=H.useState(!1),[j,x]=H.useState([]);H.useEffect(()=>{n&&(async()=>{try{const $=await Wj();x($)}catch($){console.error("Error al cargar vehículos:",$)}})()},[n]),H.useEffect(()=>{n&&(p(d()),y({}))},[n,a,j,d]),H.useEffect(()=>{if(f.type===pe.OIL_CHANGE&&f.currentHours>0){const F=Tf(f.currentHours);p($=>({...$,nextChangeHours:F}))}},[f.currentHours,f.type]);const R=(F,$)=>{const V=typeof $=="number"?parseFloat($)||0:$;p(S=>({...S,[F]:V})),g[F]&&y(S=>({...S,[F]:null}))},A=F=>{const $=j.find(V=>V.vehicleId===F);p(V=>({...V,vehicleId:F,vehicleName:$?$.name:""})),$&&$.hasHourMeter&&$.currentHours&&p(V=>({...V,currentHours:$.currentHours}))},O=()=>{const F={};return f.type||(F.type="El tipo de mantenimiento es obligatorio"),f.vehicleId||(F.vehicleId="El vehículo es obligatorio"),f.date||(F.date="La fecha es obligatoria"),f.type===pe.OIL_CHANGE&&((!f.quantity||f.quantity<=0)&&(F.quantity="La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!f.currentHours||f.currentHours<0)&&(F.currentHours="La lectura del horómetro es obligatoria")),f.type===pe.BATTERY_CHANGE&&(f.batteryType||(F.batteryType="El tipo de batería es obligatorio"),(!f.cost||f.cost<=0)&&(F.cost="El costo de la batería es obligatorio")),y(F),Object.keys(F).length===0},q=async F=>{if(F.preventDefault(),!!O()){N(!0);try{const $={...f,date:new Date(f.date),createdBy:c||"user"};o==="create"?(await $j($),console.log("✅ Mantenimiento creado exitosamente")):o==="edit"&&(await Qj(a.id,$),console.log("✅ Mantenimiento actualizado exitosamente")),t()}catch($){console.error("❌ Error al guardar mantenimiento:",$),alert("Error al guardar mantenimiento: "+$.message)}finally{N(!1)}}},U=()=>{switch(o){case"create":return"Crear Mantenimiento";case"edit":return"Editar Mantenimiento";case"view":return"Ver Mantenimiento";default:return"Mantenimiento"}},P=F=>{switch(F){case pe.OIL_CHANGE:return"🛢️";case pe.BATTERY_CHANGE:return"🔋";case pe.FILTER_CHANGE:return"🔧";case pe.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}};return n?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content maintenance-modal",children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{children:U()}),i.jsx("button",{className:"modal-close",onClick:e,children:"×"})]}),i.jsx("div",{className:"modal-body",children:i.jsxs("form",{onSubmit:q,className:"maintenance-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Tipo de Mantenimiento *"}),i.jsxs("select",{value:f.type,onChange:F=>R("type",F.target.value),disabled:o==="view",children:[i.jsxs("option",{value:pe.OIL_CHANGE,children:[P(pe.OIL_CHANGE)," Cambio de Aceite"]}),i.jsxs("option",{value:pe.BATTERY_CHANGE,children:[P(pe.BATTERY_CHANGE)," Cambio de Batería"]}),i.jsxs("option",{value:pe.FILTER_CHANGE,children:[P(pe.FILTER_CHANGE)," Cambio de Filtros"]}),i.jsxs("option",{value:pe.GENERAL_MAINTENANCE,children:[P(pe.GENERAL_MAINTENANCE)," Mantenimiento General"]})]}),g.type&&i.jsx("span",{className:"error-text",children:g.type})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Vehículo *"}),i.jsxs("select",{value:f.vehicleId,onChange:F=>A(F.target.value),disabled:o==="view",children:[i.jsx("option",{value:"",children:"Seleccionar vehículo"}),j.map(F=>i.jsxs("option",{value:F.vehicleId,children:[F.vehicleId," - ",F.name," (",F.type,")"]},F.vehicleId))]}),g.vehicleId&&i.jsx("span",{className:"error-text",children:g.vehicleId})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Fecha *"}),i.jsx("input",{type:"date",value:f.date,onChange:F=>R("date",F.target.value),disabled:o==="view"}),g.date&&i.jsx("span",{className:"error-text",children:g.date})]}),f.type===pe.OIL_CHANGE&&i.jsxs("div",{className:"maintenance-section",children:[i.jsx("h3",{children:"🛢️ Información del Cambio de Aceite"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Cantidad (galones) *"}),i.jsx("input",{type:"number",step:"0.1",value:f.quantity,onChange:F=>R("quantity",F.target.value),disabled:o==="view"}),g.quantity&&i.jsx("span",{className:"error-text",children:g.quantity})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Horómetro Actual *"}),i.jsx("input",{type:"number",value:f.currentHours,onChange:F=>R("currentHours",F.target.value),disabled:o==="view"}),g.currentHours&&i.jsx("span",{className:"error-text",children:g.currentHours})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Próximo Cambio (horas)"}),i.jsx("input",{type:"number",value:f.nextChangeHours,disabled:!0,className:"readonly-input"}),i.jsx("small",{children:"Calculado automáticamente: actual + 250 horas"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Filtros o Extras"}),i.jsx("textarea",{value:f.filters,onChange:F=>R("filters",F.target.value),disabled:o==="view",placeholder:"Especificar filtros cambiados o extras..."})]})]}),f.type===pe.BATTERY_CHANGE&&i.jsxs("div",{className:"maintenance-section",children:[i.jsx("h3",{children:"🔋 Información del Cambio de Batería"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Tipo de Batería *"}),i.jsx("input",{type:"text",value:f.batteryType,onChange:F=>R("batteryType",F.target.value),disabled:o==="view",placeholder:"Ej: 12V 60Ah"}),g.batteryType&&i.jsx("span",{className:"error-text",children:g.batteryType})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Estado *"}),i.jsxs("select",{value:f.batteryStatus,onChange:F=>R("batteryStatus",F.target.value),disabled:o==="view",children:[i.jsx("option",{value:Go.NEW,children:"Nueva"}),i.jsx("option",{value:Go.USED,children:"Usada"}),i.jsx("option",{value:Go.REPAIRED,children:"Reparada"})]})]})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Marca"}),i.jsx("input",{type:"text",value:f.brand,onChange:F=>R("brand",F.target.value),disabled:o==="view",placeholder:"Ej: Bosch, Exide"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Modelo"}),i.jsx("input",{type:"text",value:f.model,onChange:F=>R("model",F.target.value),disabled:o==="view",placeholder:"Ej: S4 005"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Costo *"}),i.jsx("input",{type:"number",step:"1000",value:f.cost,onChange:F=>R("cost",F.target.value),disabled:o==="view",placeholder:"0"}),g.cost&&i.jsx("span",{className:"error-text",children:g.cost})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Notas Adicionales"}),i.jsx("textarea",{value:f.notes,onChange:F=>R("notes",F.target.value),disabled:o==="view",placeholder:"Observaciones adicionales...",rows:"3"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Estado"}),i.jsxs("select",{value:f.status,onChange:F=>R("status",F.target.value),disabled:o==="view",children:[i.jsx("option",{value:Pe.COMPLETED,children:"Completado"}),i.jsx("option",{value:Pe.PENDING,children:"Pendiente"}),i.jsx("option",{value:Pe.CANCELLED,children:"Cancelado"})]})]})]})}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:_,children:"Cancelar"}),o!=="view"&&i.jsx("button",{type:"submit",className:"btn btn-primary",onClick:q,disabled:_,children:_?"Guardando...":o==="create"?"Crear":"Actualizar"})]})]})}):null},IV=()=>{const{user:n,userProfile:e}=ds(),[t,a]=H.useState([]),[o,c]=H.useState(null),[d,f]=H.useState(!0),[p,g]=H.useState(null),[y,_]=H.useState({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),[N,j]=H.useState("cards"),[x,R]=H.useState(""),[A,O]=H.useState(!1),[q,U]=H.useState(null),[P,F]=H.useState("create");H.useEffect(()=>{if(!n)return;f(!0);const Q=Xj((ne,he)=>{if(he){console.error("Error en suscripción de mantenimientos:",he),g("Error al cargar mantenimientos"),f(!1);return}a(ne),g(null),f(!1)},y);return()=>Q()},[n,y]),H.useEffect(()=>{n&&(async()=>{try{const ne=await Kj(y);c(ne)}catch(ne){console.error("Error al cargar estadísticas:",ne)}})()},[n,t,y]);const $=t.filter(Q=>{if(!x)return!0;const ne=x.toLowerCase();return Q.vehicleName?.toLowerCase().includes(ne)||Q.type?.toLowerCase().includes(ne)||Q.status?.toLowerCase().includes(ne)||Q.notes?.toLowerCase().includes(ne)}),V=e?.combustiblesPermissions?.canManageMaintenance||!1,S=()=>{U(null),F("create"),O(!0)},L=Q=>{U(Q),F("edit"),O(!0)},M=Q=>{U(Q),F("view"),O(!0)},w=()=>{O(!1),U(null)},C=()=>{O(!1),U(null)},D=Q=>{_(ne=>({...ne,...Q}))},me=()=>{_({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),R("")},De=async Q=>{if(!V){alert("No tienes permisos para eliminar mantenimientos");return}if(window.confirm("¿Estás seguro de que quieres eliminar este mantenimiento?"))try{const{deleteMaintenanceRecord:ne}=await ny(async()=>{const{deleteMaintenanceRecord:he}=await Promise.resolve().then(()=>EV);return{deleteMaintenanceRecord:he}},void 0);await ne(Q),console.log("✅ Mantenimiento eliminado exitosamente")}catch(ne){console.error("❌ Error al eliminar mantenimiento:",ne),alert("Error al eliminar mantenimiento: "+ne.message)}};return n?i.jsxs("div",{className:"maintenance-main",children:[i.jsxs("div",{className:"maintenance-header",children:[i.jsxs("div",{className:"header-title",children:[i.jsx("h2",{children:"🔧 Mantenimiento de Vehículos"}),i.jsx("p",{children:"Gestión de cambios de aceite, filtros y baterías"})]}),i.jsx("div",{className:"header-actions",children:V&&i.jsx("button",{className:"btn-create-maintenance",onClick:S,children:"➕ Crear Mantenimiento"})})]}),d&&i.jsxs("div",{className:"maintenance-loading",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Cargando mantenimientos..."})]}),p&&i.jsxs("div",{className:"error-banner",children:[i.jsxs("span",{children:["❌ ",p]}),i.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]}),o&&i.jsx(TV,{stats:o}),i.jsx(AV,{filters:y,onFilterChange:D,onClearFilters:me,searchTerm:x,onSearchChange:R,viewMode:N,onViewModeChange:j,totalResults:$.length}),!d&&!p&&i.jsx(CV,{maintenanceRecords:$,viewMode:N,onEdit:V?L:null,onView:M,onDelete:V?De:null,userRole:e?.role}),A&&i.jsx(SV,{isOpen:A,onClose:w,onSuccess:C,maintenance:q,mode:P,userRole:e?.role})]}):i.jsx("div",{className:"maintenance-main",children:i.jsxs("div",{className:"auth-required",children:[i.jsx("h2",{children:"🔐 Autenticación Requerida"}),i.jsx("p",{children:"Debes iniciar sesión para acceder al módulo de mantenimiento."})]})})},RV=({isOpen:n,onClose:e,product:t,mode:a="create",onSave:o,userRole:c})=>{const[d,f]=H.useState({name:"",displayName:"",category:zs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),[p,g]=H.useState({}),[y,_]=H.useState(!1),N=[{value:"gal",label:"Galones (gal)"},{value:"L",label:"Litros (L)"},{value:"kg",label:"Kilogramos (kg)"},{value:"und",label:"Unidades (und)"}],j={[zs.COMBUSTIBLE]:["🛢️","🚛","🚗","⛽","🌿"],[zs.ACEITE]:["🛢️","⚙️","🔧","🚜","🏭"],[zs.LUBRICANTE]:["🟥","🟡","🔵","⚫","🟤"],[zs.FLUIDO]:["🛑","💧","🔴","🟢","🔵"]},x=["#FF6B35","#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#E91E63","#795548","#607D8B","#3F51B5"];H.useEffect(()=>{f(t&&(a==="edit"||a==="view")?{name:t.name||"",displayName:t.displayName||"",category:t.category||zs.COMBUSTIBLE,unit:t.unit||"gal",defaultPrice:t.defaultPrice||0,color:t.color||"#FF6B35",icon:t.icon||"🛢️",description:t.description||"",isActive:t.isActive!==void 0?t.isActive:!0,currentStock:t.currentStock||0,minThreshold:t.minThreshold||10,maxCapacity:t.maxCapacity||1e3}:{name:"",displayName:"",category:zs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),g({})},[t,a,n]);const R=U=>{const{name:P,value:F,type:$,checked:V}=U.target;f(S=>({...S,[P]:$==="checkbox"?V:F})),p[P]&&g(S=>({...S,[P]:""}))},A=()=>{const U={};return d.name.trim()||(U.name="El nombre es requerido"),d.displayName.trim()||(U.displayName="El nombre de visualización es requerido"),d.category||(U.category="La categoría es requerida"),d.unit||(U.unit="La unidad es requerida"),d.defaultPrice<0&&(U.defaultPrice="El precio debe ser mayor o igual a 0"),d.currentStock<0&&(U.currentStock="El stock debe ser mayor o igual a 0"),d.minThreshold<0&&(U.minThreshold="El umbral mínimo debe ser mayor o igual a 0"),d.maxCapacity<=0&&(U.maxCapacity="La capacidad máxima debe ser mayor a 0"),d.minThreshold>=d.maxCapacity&&(U.minThreshold="El umbral mínimo debe ser menor que la capacidad máxima"),g(U),Object.keys(U).length===0},O=async U=>{if(U.preventDefault(),!!A()){_(!0);try{await o({...d,defaultPrice:parseFloat(d.defaultPrice),currentStock:parseFloat(d.currentStock),minThreshold:parseFloat(d.minThreshold),maxCapacity:parseFloat(d.maxCapacity)}),e()}catch(P){console.error("Error saving product:",P),g({submit:"Error al guardar el producto"})}finally{_(!1)}}};if(!n)return null;const q=["admin","supervisor"].includes(c)&&a!=="view";return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content product-modal",children:[i.jsxs("div",{className:"modal-header",children:[i.jsxs("h2",{children:[a==="create"&&"➕ Crear Producto",a==="edit"&&"✏️ Editar Producto",a==="view"&&"👁️ Ver Producto"]}),i.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),i.jsxs("form",{onSubmit:O,className:"modal-body",children:[i.jsx("div",{className:"product-preview",children:i.jsxs("div",{className:"preview-card",children:[i.jsx("div",{className:"preview-icon",style:{color:d.color},children:d.icon}),i.jsxs("div",{className:"preview-info",children:[i.jsx("h3",{children:d.displayName||"Nombre del producto"}),i.jsx("p",{className:"preview-category",children:d.category}),i.jsx("p",{className:"preview-description",children:d.description}),i.jsxs("div",{className:"preview-price",children:["$",new Intl.NumberFormat("es-CO").format(d.defaultPrice)," / ",d.unit]})]})]})}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-section",children:[i.jsx("h3",{children:"📝 Información Básica"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Nombre Interno *"}),i.jsx("input",{type:"text",name:"name",value:d.name,onChange:R,disabled:!q,placeholder:"Ej: ACPM, GASOLINA"}),p.name&&i.jsx("span",{className:"error",children:p.name})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Nombre de Visualización *"}),i.jsx("input",{type:"text",name:"displayName",value:d.displayName,onChange:R,disabled:!q,placeholder:"Ej: ACPM 🚛, Gasolina 🚗"}),p.displayName&&i.jsx("span",{className:"error",children:p.displayName})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Categoría *"}),i.jsx("select",{name:"category",value:d.category,onChange:R,disabled:!q,children:Object.values(zs).map(U=>i.jsx("option",{value:U,children:U},U))}),p.category&&i.jsx("span",{className:"error",children:p.category})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Descripción"}),i.jsx("textarea",{name:"description",value:d.description,onChange:R,disabled:!q,placeholder:"Descripción del producto...",rows:"3"})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h3",{children:"⚙️ Configuración"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Unidad de Medida *"}),i.jsx("select",{name:"unit",value:d.unit,onChange:R,disabled:!q,children:N.map(U=>i.jsx("option",{value:U.value,children:U.label},U.value))}),p.unit&&i.jsx("span",{className:"error",children:p.unit})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Precio por Defecto"}),i.jsx("input",{type:"number",name:"defaultPrice",value:d.defaultPrice,onChange:R,disabled:!q,min:"0",step:"0.01"}),p.defaultPrice&&i.jsx("span",{className:"error",children:p.defaultPrice})]}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{children:[i.jsx("input",{type:"checkbox",name:"isActive",checked:d.isActive,onChange:R,disabled:!q}),"Producto Activo"]})})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h3",{children:"📊 Stock y Umbrales"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Stock Actual"}),i.jsx("input",{type:"number",name:"currentStock",value:d.currentStock,onChange:R,disabled:!q,min:"0",step:"0.01"}),p.currentStock&&i.jsx("span",{className:"error",children:p.currentStock})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Umbral Mínimo"}),i.jsx("input",{type:"number",name:"minThreshold",value:d.minThreshold,onChange:R,disabled:!q,min:"0",step:"0.01"}),p.minThreshold&&i.jsx("span",{className:"error",children:p.minThreshold})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Capacidad Máxima"}),i.jsx("input",{type:"number",name:"maxCapacity",value:d.maxCapacity,onChange:R,disabled:!q,min:"1",step:"0.01"}),p.maxCapacity&&i.jsx("span",{className:"error",children:p.maxCapacity})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("h3",{children:"🎨 Apariencia"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Icono"}),i.jsx("div",{className:"icon-selector",children:j[d.category]?.map(U=>i.jsx("button",{type:"button",className:`icon-option ${d.icon===U?"selected":""}`,onClick:()=>f(P=>({...P,icon:U})),disabled:!q,children:U},U))})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Color"}),i.jsx("div",{className:"color-selector",children:x.map(U=>i.jsx("button",{type:"button",className:`color-option ${d.color===U?"selected":""}`,style:{backgroundColor:U},onClick:()=>f(P=>({...P,color:U})),disabled:!q},U))})]})]})]}),p.submit&&i.jsx("div",{className:"error-message",children:p.submit})]}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:y,children:a==="view"?"Cerrar":"Cancelar"}),q&&i.jsx("button",{type:"submit",className:"btn-primary",onClick:O,disabled:y,children:y?"Guardando...":"Guardar"})]})]})})},DV=({products:n})=>{const[e,t]=H.useState([]),[a,o]=H.useState(!0);H.useEffect(()=>{const x=Jv(R=>{t(R),o(!1)},R=>{console.error("Error loading movements for stats:",R),o(!1)});return()=>x()},[]);const c=()=>n.map(R=>{const A=e.filter($=>$.fuelType===R.name||$.fuelType===R.displayName),O=A.filter($=>$.type==="entrada"),q=A.filter($=>$.type==="salida"),U=O.reduce(($,V)=>$+(V.quantity||0),0),P=q.reduce(($,V)=>$+(V.quantity||0),0),F=(R.currentStock||0)*(R.defaultPrice||0);return{...R,totalEntries:U,totalExits:P,totalValue:F,entriesCount:O.length,exitsCount:q.length,stockStatus:d(R)}}),d=x=>{const R=x.currentStock||0,A=x.minThreshold||0,O=x.maxCapacity||1e3;return R===0?"empty":R<=A?"low":R>=O*.9?"high":"normal"},f=x=>{const R={};return Object.values(zs).forEach(A=>{const O=x.filter(q=>q.category===A);R[A]={totalProducts:O.length,totalStock:O.reduce((q,U)=>q+(U.currentStock||0),0),totalValue:O.reduce((q,U)=>q+U.totalValue,0),totalEntries:O.reduce((q,U)=>q+U.totalEntries,0),totalExits:O.reduce((q,U)=>q+U.totalExits,0),lowStockCount:O.filter(q=>q.stockStatus==="low"||q.stockStatus==="empty").length}}),R};if(a)return i.jsxs("div",{className:"products-stats loading",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Cargando estadísticas..."})]});const p=c(),g=f(p),y=n.length,_=n.filter(x=>x.isActive).length,N=p.reduce((x,R)=>x+R.totalValue,0),j=p.filter(x=>x.stockStatus==="low"||x.stockStatus==="empty").length;return i.jsxs("div",{className:"products-stats",children:[i.jsx("h2",{children:"📊 Estadísticas de Productos"}),i.jsxs("div",{className:"stats-general",children:[i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:"📦"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("h3",{children:ke(y)}),i.jsx("p",{children:"Total Productos"})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:"✅"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("h3",{children:ke(_)}),i.jsx("p",{children:"Productos Activos"})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:"💰"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("h3",{children:Dn(N)}),i.jsx("p",{children:"Valor Total Stock"})]})]}),i.jsxs("div",{className:`stat-card ${j>0?"alert":""}`,children:[i.jsx("div",{className:"stat-icon",children:"⚠️"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("h3",{children:ke(j)}),i.jsx("p",{children:"Stock Bajo"})]})]})]}),i.jsxs("div",{className:"stats-categories",children:[i.jsx("h3",{children:"📈 Por Categoría"}),i.jsx("div",{className:"categories-grid",children:Object.entries(g).map(([x,R])=>i.jsxs("div",{className:"category-card",children:[i.jsx("h4",{children:x}),i.jsxs("div",{className:"category-stats",children:[i.jsxs("div",{className:"stat-row",children:[i.jsx("span",{children:"Productos:"}),i.jsx("span",{children:ke(R.totalProducts)})]}),i.jsxs("div",{className:"stat-row",children:[i.jsx("span",{children:"Stock Total:"}),i.jsxs("span",{children:[ke(R.totalStock)," unidades"]})]}),i.jsxs("div",{className:"stat-row",children:[i.jsx("span",{children:"Valor:"}),i.jsx("span",{children:Dn(R.totalValue)})]}),i.jsxs("div",{className:"stat-row",children:[i.jsx("span",{children:"Entradas:"}),i.jsx("span",{className:"positive",children:ke(R.totalEntries)})]}),i.jsxs("div",{className:"stat-row",children:[i.jsx("span",{children:"Salidas:"}),i.jsx("span",{className:"negative",children:ke(R.totalExits)})]}),R.lowStockCount>0&&i.jsxs("div",{className:"stat-row alert",children:[i.jsx("span",{children:"Stock Bajo:"}),i.jsx("span",{children:ke(R.lowStockCount)})]})]})]},x))})]}),i.jsxs("div",{className:"stats-top-products",children:[i.jsx("h3",{children:"🏆 Top Productos por Stock"}),i.jsx("div",{className:"top-products-list",children:p.sort((x,R)=>(R.currentStock||0)-(x.currentStock||0)).slice(0,5).map((x,R)=>i.jsxs("div",{className:"top-product-item",children:[i.jsxs("div",{className:"rank",children:["#",R+1]}),i.jsx("div",{className:"product-icon",style:{color:x.color},children:x.icon}),i.jsxs("div",{className:"product-info",children:[i.jsx("span",{className:"product-name",children:x.displayName}),i.jsxs("span",{className:"product-stock",children:[ke(x.currentStock||0)," ",x.unit]})]}),i.jsx("div",{className:"product-value",children:Dn(x.totalValue)})]},x.id))})]}),j>0&&i.jsxs("div",{className:"stats-alerts",children:[i.jsx("h3",{children:"⚠️ Alertas de Stock"}),i.jsx("div",{className:"alerts-list",children:p.filter(x=>x.stockStatus==="low"||x.stockStatus==="empty").map(x=>i.jsxs("div",{className:`alert-item ${x.stockStatus}`,children:[i.jsx("div",{className:"alert-icon",children:x.stockStatus==="empty"?"🔴":"🟡"}),i.jsxs("div",{className:"alert-info",children:[i.jsx("span",{className:"alert-product",children:x.displayName}),i.jsxs("span",{className:"alert-stock",children:["Stock: ",ke(x.currentStock||0)," ",x.unit,x.stockStatus==="empty"&&" - ¡SIN STOCK!",x.stockStatus==="low"&&` - Mínimo: ${x.minThreshold}`]})]})]},x.id))})]})]})},MV=({userProfile:n})=>{const[e,t]=H.useState([]),[a,o]=H.useState(!0),[c,d]=H.useState(null),[f,p]=H.useState(!1),[g,y]=H.useState(null),[_,N]=H.useState("create"),[j,x]=H.useState(""),[R,A]=H.useState(""),[O,q]=H.useState(!0),U=["admin","supervisor"].includes(n?.role);H.useEffect(()=>{o(!0);const M=KL(w=>{t(w),o(!1),d(null)},w=>{console.error("Error loading products:",w),d("Error cargando productos"),o(!1)});return()=>M()},[]),H.useEffect(()=>{(async()=>{if(console.log("🔍 Debug - Inicializando productos:",{productsLength:e.length,loading:a,canManageProducts:U}),e.length===0&&!a&&U)try{console.log("🚀 Creando productos predefinidos...");const w=qE();console.log("📦 Productos predefinidos:",w);for(const C of w)console.log("➕ Creando producto:",C.name),await Zp({name:C.name,displayName:C.displayName,category:C.category,unit:C.unit,defaultPrice:C.defaultPrice,color:C.color,icon:C.icon,description:C.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});console.log("✅ Productos predefinidos creados exitosamente")}catch(w){console.error("❌ Error inicializando productos:",w)}else console.log("ℹ️ No se inicializan productos:",{reason:e.length>0?"Ya existen productos":a?"Está cargando":U?"Otra razón":"Sin permisos"})})()},[e.length,a,U]);const P=()=>{y(null),N("create"),p(!0)},F=M=>{y(M),N("edit"),p(!0)},$=M=>{y(M),N("view"),p(!0)},V=async M=>{if(window.confirm("¿Estás seguro de que deseas eliminar este producto?"))try{await YL(M)}catch(w){console.error("Error deleting product:",w),alert("Error al eliminar el producto")}},S=async M=>{try{_==="create"?await Zp(M):_==="edit"&&await $L(g.id,M),p(!1)}catch(w){throw console.error("Error saving product:",w),w}},L=e.filter(M=>{const w=M.displayName?.toLowerCase().includes(j.toLowerCase())||M.name?.toLowerCase().includes(j.toLowerCase()),C=!R||M.category===R;return w&&C});return a?i.jsx("div",{className:"products-main",children:i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Cargando productos..."})]})}):c?i.jsx("div",{className:"products-main",children:i.jsxs("div",{className:"error-container",children:[i.jsxs("p",{children:["⚠️ ",c]}),i.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})}):i.jsxs("div",{className:"products-main",children:[i.jsxs("div",{className:"products-header",children:[i.jsxs("div",{className:"header-title",children:[i.jsx("h1",{children:"🛢️ Gestión de Productos"}),i.jsx("p",{children:"Administra los tipos de combustibles y productos disponibles"})]}),U&&i.jsxs("div",{className:"header-actions",children:[i.jsx("button",{className:"btn-primary",onClick:P,children:"➕ Agregar Producto"}),i.jsx("button",{className:"btn-secondary",onClick:async()=>{try{console.log("🧪 Forzando creación de productos predefinidos...");const M=qE();for(const w of M)await Zp({name:w.name,displayName:w.displayName,category:w.category,unit:w.unit,defaultPrice:w.defaultPrice,color:w.color,icon:w.icon,description:w.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});alert("Productos predefinidos creados exitosamente")}catch(M){console.error("Error:",M),alert("Error creando productos: "+M.message)}},style:{marginLeft:"10px"},children:"🧪 Crear Predefinidos"})]})]}),O&&i.jsx(DV,{products:e}),i.jsxs("div",{className:"products-filters",children:[i.jsx("div",{className:"filter-group",children:i.jsx("input",{type:"text",placeholder:"🔍 Buscar productos...",value:j,onChange:M=>x(M.target.value),className:"search-input"})}),i.jsx("div",{className:"filter-group",children:i.jsxs("select",{value:R,onChange:M=>A(M.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"🏷️ Todas las categorías"}),Object.values(zs).map(M=>i.jsx("option",{value:M,children:M},M))]})}),i.jsx("div",{className:"filter-group",children:i.jsx("button",{className:`toggle-btn ${O?"active":""}`,onClick:()=>q(!O),children:"📊 Estadísticas"})})]}),i.jsx("div",{className:"products-grid",children:L.map(M=>i.jsxs("div",{className:"product-card",children:[i.jsx("div",{className:"product-icon",style:{color:M.color},children:M.icon}),i.jsxs("div",{className:"product-info",children:[i.jsx("h3",{children:M.displayName}),i.jsx("p",{className:"product-category",children:M.category}),i.jsx("p",{className:"product-description",children:M.description}),i.jsxs("div",{className:"product-stats",children:[i.jsxs("div",{className:"stat",children:[i.jsx("span",{className:"stat-label",children:"Stock:"}),i.jsxs("span",{className:"stat-value",children:[M.currentStock||0," ",M.unit]})]}),i.jsxs("div",{className:"stat",children:[i.jsx("span",{className:"stat-label",children:"Precio:"}),i.jsxs("span",{className:"stat-value",children:["$",new Intl.NumberFormat("es-CO").format(M.defaultPrice||0)]})]})]}),i.jsx("div",{className:`product-status ${M.isActive?"active":"inactive"}`,children:M.isActive?"✅ Activo":"❌ Inactivo"})]}),i.jsxs("div",{className:"product-actions",children:[i.jsx("button",{className:"btn-secondary",onClick:()=>$(M),children:"👁️ Ver"}),U&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"btn-primary",onClick:()=>F(M),children:"✏️ Editar"}),i.jsx("button",{className:"btn-danger",onClick:()=>V(M.id),children:"🗑️ Eliminar"})]})]})]},M.id))}),L.length===0&&i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"empty-icon",children:"📦"}),i.jsx("h3",{children:"No hay productos"}),i.jsx("p",{children:j||R?"No se encontraron productos con los filtros aplicados.":"Aún no hay productos registrados."}),U&&!j&&!R&&i.jsx("button",{className:"btn-primary",onClick:P,children:"➕ Crear primer producto"})]}),i.jsx(RV,{isOpen:f,onClose:()=>p(!1),product:g,mode:_,onSave:S,userRole:n?.role})]})},OV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const[c,d]=H.useState("name"),[f,p]=H.useState("asc"),g=O=>{c===O?p(f==="asc"?"desc":"asc"):(d(O),p("asc"))},y=[...n].sort((O,q)=>{let U=O[c],P=q[c];switch(c){case"rating":U=U||0,P=P||0;break;case"totalOrders":case"totalPurchased":U=U||0,P=P||0;break;case"createdAt":case"lastOrderDate":U=U?U.toDate?U.toDate():new Date(U):new Date(0),P=P?P.toDate?P.toDate():new Date(P):new Date(0);break;default:U=(U||"").toString().toLowerCase(),P=(P||"").toString().toLowerCase()}return U<P?f==="asc"?-1:1:U>P?f==="asc"?1:-1:0}),_=O=>{switch(O){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},N=O=>{switch(O){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},j=O=>O?(O.toDate?O.toDate():new Date(O)).toLocaleDateString("es-CO"):"-",x=O=>{const q=[];for(let U=1;U<=5;U++)q.push(i.jsx("span",{className:`star ${U<=O?"filled":""}`,children:"★"},U));return i.jsx("div",{className:"rating-stars",children:q})},R=O=>!O||O.length===0?i.jsx("span",{className:"no-data",children:"-"}):i.jsxs("div",{className:"fuel-types-cell",children:[O.slice(0,2).map(q=>i.jsx("span",{className:"fuel-badge-sm",children:Nn[q]||q},q)),O.length>2&&i.jsxs("span",{className:"fuel-badge-sm more",title:O.slice(2).map(q=>Nn[q]||q).join(", "),children:["+",O.length-2]})]}),A=O=>c!==O?"icon-chevrons-up-down":f==="asc"?"icon-chevron-up":"icon-chevron-down";return i.jsxs("div",{className:"suppliers-table-container",children:[i.jsxs("div",{className:"table-wrapper",children:[i.jsxs("table",{className:"suppliers-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsxs("th",{className:`sortable ${c==="name"?"active":""}`,onClick:()=>g("name"),children:[i.jsx("span",{children:"Proveedor"}),i.jsx("i",{className:A("name")})]}),i.jsxs("th",{className:`sortable ${c==="status"?"active":""}`,onClick:()=>g("status"),children:[i.jsx("span",{children:"Estado"}),i.jsx("i",{className:A("status")})]}),i.jsxs("th",{className:`sortable ${c==="category"?"active":""}`,onClick:()=>g("category"),children:[i.jsx("span",{children:"Categoría"}),i.jsx("i",{className:A("category")})]}),i.jsx("th",{children:i.jsx("span",{children:"Combustibles"})}),i.jsx("th",{children:i.jsx("span",{children:"Contacto"})}),i.jsxs("th",{className:`sortable ${c==="rating"?"active":""}`,onClick:()=>g("rating"),children:[i.jsx("span",{children:"Rating"}),i.jsx("i",{className:A("rating")})]}),i.jsxs("th",{className:`sortable ${c==="totalOrders"?"active":""}`,onClick:()=>g("totalOrders"),children:[i.jsx("span",{children:"Órdenes"}),i.jsx("i",{className:A("totalOrders")})]}),i.jsxs("th",{className:`sortable ${c==="totalPurchased"?"active":""}`,onClick:()=>g("totalPurchased"),children:[i.jsx("span",{children:"Total Comprado"}),i.jsx("i",{className:A("totalPurchased")})]}),i.jsxs("th",{className:`sortable ${c==="createdAt"?"active":""}`,onClick:()=>g("createdAt"),children:[i.jsx("span",{children:"Creado"}),i.jsx("i",{className:A("createdAt")})]}),i.jsx("th",{className:"actions-column",children:i.jsx("span",{children:"Acciones"})})]})}),i.jsx("tbody",{children:y.map(O=>i.jsxs("tr",{className:`supplier-row ${O.status}`,children:[i.jsx("td",{className:"supplier-info-cell",children:i.jsxs("div",{className:"supplier-main-info",children:[i.jsxs("div",{className:"supplier-name",children:[O.name,O.isPreferred&&i.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:i.jsx("i",{className:"icon-star"})})]}),O.taxId&&i.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",O.taxId]}),O.type&&i.jsx("div",{className:"supplier-type",children:O.type.charAt(0).toUpperCase()+O.type.slice(1)})]})}),i.jsx("td",{className:"status-cell",children:i.jsxs("div",{className:"status-display",children:[i.jsx("span",{className:"status-dot",style:{backgroundColor:_(O.status)}}),i.jsx("span",{className:"status-label",children:N(O.status)})]})}),i.jsx("td",{className:"category-cell",children:i.jsx("span",{className:"category-label",children:O.category?.charAt(0).toUpperCase()+O.category?.slice(1)||"-"})}),i.jsx("td",{className:"fuel-types-cell",children:R(O.fuelTypes)}),i.jsx("td",{className:"contact-cell",children:i.jsxs("div",{className:"contact-info",children:[O.contactPerson&&i.jsxs("div",{className:"contact-person",children:[i.jsx("i",{className:"icon-user"}),i.jsx("span",{children:O.contactPerson})]}),O.phone&&i.jsxs("div",{className:"contact-item",children:[i.jsx("i",{className:"icon-phone"}),i.jsx("a",{href:`tel:${O.phone}`,children:O.phone})]}),O.email&&i.jsxs("div",{className:"contact-item",children:[i.jsx("i",{className:"icon-mail"}),i.jsx("a",{href:`mailto:${O.email}`,children:O.email})]}),O.city&&i.jsxs("div",{className:"contact-item",children:[i.jsx("i",{className:"icon-map-pin"}),i.jsx("span",{children:O.city})]})]})}),i.jsx("td",{className:"rating-cell",children:i.jsxs("div",{className:"rating-display",children:[x(O.rating||0),i.jsx("span",{className:"rating-value",children:(O.rating||0).toFixed(1)})]})}),i.jsx("td",{className:"orders-cell",children:i.jsx("span",{className:"orders-count",children:O.totalOrders||0})}),i.jsx("td",{className:"purchased-cell",children:i.jsx("span",{className:"purchased-amount",children:Dn(O.totalPurchased||0)})}),i.jsx("td",{className:"date-cell",children:i.jsx("span",{className:"date-value",children:j(O.createdAt)})}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"action-buttons",children:[a&&i.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(O),title:"Editar proveedor",children:i.jsx("i",{className:"icon-edit"})}),o&&O.status==="active"&&i.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(O.id,O.name),title:"Desactivar proveedor",children:i.jsx("i",{className:"icon-x-circle"})}),i.jsxs("div",{className:"quick-actions",children:[O.phone&&i.jsx("a",{href:`tel:${O.phone}`,className:"quick-action-btn",title:"Llamar",children:i.jsx("i",{className:"icon-phone"})}),O.email&&i.jsx("a",{href:`mailto:${O.email}`,className:"quick-action-btn",title:"Enviar email",children:i.jsx("i",{className:"icon-mail"})})]})]})})]},O.id))})]}),y.length===0&&i.jsxs("div",{className:"table-empty-state",children:[i.jsx("i",{className:"icon-truck"}),i.jsx("p",{children:"No hay proveedores para mostrar"})]})]}),i.jsxs("div",{className:"table-footer",children:[i.jsx("div",{className:"table-info",children:i.jsxs("span",{children:["Mostrando ",y.length," proveedor",y.length!==1?"es":""]})}),i.jsx("div",{className:"table-actions",children:i.jsxs("span",{className:"sort-info",children:["Ordenado por: ",c==="name"?"Nombre":c==="status"?"Estado":c==="category"?"Categoría":c==="rating"?"Rating":c==="totalOrders"?"Órdenes":c==="totalPurchased"?"Total Comprado":c==="createdAt"?"Fecha de Creación":c," (",f==="asc"?"Ascendente":"Descendente",")"]})})]})]})},kV=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const c=j=>{switch(j){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},d=j=>{switch(j){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},f=j=>{switch(j){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},p=j=>{switch(j){case"proveedor":return"Proveedor";case"distribuidor":return"Distribuidor";case"mayorista":return"Mayorista";default:return"Sin especificar"}},g=j=>j?(j.toDate?j.toDate():new Date(j)).toLocaleDateString("es-CO"):"No disponible",y=j=>{const x=[];for(let R=1;R<=5;R++)x.push(i.jsx("span",{className:`star ${R<=j?"filled":""}`,children:"★"},R));return i.jsx("div",{className:"rating-stars",children:x})},_=j=>!j||j.length===0?i.jsx("span",{className:"no-fuels",children:"Sin combustibles especificados"}):i.jsxs("div",{className:"fuel-types",children:[j.slice(0,3).map(x=>i.jsx("span",{className:"fuel-badge",title:Nn[x],children:Nn[x]||x},x)),j.length>3&&i.jsxs("span",{className:"fuel-badge more",title:`+${j.length-3} más`,children:["+",j.length-3]})]}),N=j=>{const x=[];return j.phone&&x.push(i.jsxs("div",{className:"contact-item",children:[i.jsx("i",{className:"icon-phone"}),i.jsx("span",{children:j.phone})]},"phone")),j.email&&x.push(i.jsxs("div",{className:"contact-item",children:[i.jsx("i",{className:"icon-mail"}),i.jsx("span",{children:j.email})]},"email")),j.city&&x.push(i.jsxs("div",{className:"contact-item",children:[i.jsx("i",{className:"icon-map-pin"}),i.jsx("span",{children:j.city})]},"city")),x.length>0?x:i.jsxs("div",{className:"contact-item no-contact",children:[i.jsx("i",{className:"icon-info-circle"}),i.jsx("span",{children:"Sin información de contacto"})]})};return i.jsx("div",{className:"suppliers-cards",children:n.map(j=>i.jsxs("div",{className:`supplier-card ${j.status}`,children:[i.jsxs("div",{className:"card-header",children:[i.jsx("div",{className:"header-left",children:i.jsxs("div",{className:"supplier-info",children:[i.jsxs("h3",{className:"supplier-name",children:[j.name,j.isPreferred&&i.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:i.jsx("i",{className:"icon-star"})})]}),j.taxId&&i.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",j.taxId]})]})}),i.jsx("div",{className:"header-right",children:i.jsxs("div",{className:"supplier-status",children:[i.jsx("span",{className:"status-dot",style:{backgroundColor:c(j.status)}}),i.jsx("span",{className:"status-label",children:d(j.status)})]})})]}),i.jsxs("div",{className:"card-content",children:[i.jsxs("div",{className:"supplier-meta",children:[i.jsxs("div",{className:"meta-item",children:[i.jsx("span",{className:"meta-icon",children:f(j.category)}),i.jsx("span",{className:"meta-label",children:j.category?.charAt(0).toUpperCase()+j.category?.slice(1)||"Sin categoría"})]}),i.jsxs("div",{className:"meta-item",children:[i.jsx("i",{className:"icon-building meta-icon"}),i.jsx("span",{className:"meta-label",children:p(j.type)})]})]}),j.contactPerson&&i.jsxs("div",{className:"contact-person",children:[i.jsx("i",{className:"icon-user"}),i.jsx("span",{children:j.contactPerson})]}),i.jsx("div",{className:"contact-info",children:N(j)}),i.jsxs("div",{className:"fuel-types-section",children:[i.jsx("div",{className:"section-label",children:"Combustibles Suministrados:"}),_(j.fuelTypes)]}),i.jsxs("div",{className:"rating-section",children:[i.jsxs("div",{className:"rating-display",children:[y(j.rating||0),i.jsxs("span",{className:"rating-value",children:[(j.rating||0).toFixed(1),"/5"]})]}),j.evaluationNotes&&i.jsxs("div",{className:"evaluation-notes",title:j.evaluationNotes,children:[i.jsx("i",{className:"icon-message-square"}),i.jsx("span",{children:"Con evaluación"})]})]}),j.paymentTerms&&i.jsxs("div",{className:"payment-terms",children:[i.jsx("i",{className:"icon-credit-card"}),i.jsxs("span",{children:["Términos: ",j.paymentTerms==="contado"?"Contado":j.paymentTerms==="30dias"?"30 días":j.paymentTerms==="60dias"?"60 días":j.paymentTerms==="90dias"?"90 días":j.paymentTerms]})]}),i.jsxs("div",{className:"supplier-stats",children:[i.jsxs("div",{className:"stat-item",children:[i.jsx("span",{className:"stat-label",children:"Órdenes:"}),i.jsx("span",{className:"stat-value",children:j.totalOrders||0})]}),i.jsxs("div",{className:"stat-item",children:[i.jsx("span",{className:"stat-label",children:"Total Comprado:"}),i.jsx("span",{className:"stat-value",children:Dn(j.totalPurchased||0)})]}),j.lastOrderDate&&i.jsxs("div",{className:"stat-item",children:[i.jsx("span",{className:"stat-label",children:"Última Orden:"}),i.jsx("span",{className:"stat-value",children:g(j.lastOrderDate)})]})]})]}),i.jsxs("div",{className:"card-footer",children:[i.jsx("div",{className:"footer-info",children:i.jsxs("span",{className:"created-date",children:["Creado: ",g(j.createdAt)]})}),i.jsxs("div",{className:"card-actions",children:[a&&i.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(j),title:"Editar proveedor",children:[i.jsx("i",{className:"icon-edit"}),"Editar"]}),o&&j.status==="active"&&i.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>t(j.id,j.name),title:"Desactivar proveedor",children:[i.jsx("i",{className:"icon-x-circle"}),"Desactivar"]}),i.jsxs("div",{className:"quick-actions",children:[j.phone&&i.jsx("a",{href:`tel:${j.phone}`,className:"quick-action-btn",title:"Llamar",children:i.jsx("i",{className:"icon-phone"})}),j.email&&i.jsx("a",{href:`mailto:${j.email}`,className:"quick-action-btn",title:"Enviar email",children:i.jsx("i",{className:"icon-mail"})})]})]})]})]},j.id))})},PV=({supplier:n,onClose:e,onSuccess:t,onError:a})=>{const{userProfile:o}=ds(),c=!!n,[d,f]=H.useState({name:"",taxId:"",type:"proveedor",category:"combustibles",contactPerson:"",phone:"",email:"",address:"",city:"",state:"Colombia",fuelTypes:[],paymentTerms:"contado",creditLimit:"",priceList:{},rating:5,evaluationNotes:"",status:"active",isPreferred:!1}),[p,g]=H.useState(!1),[y,_]=H.useState({}),[N,j]=H.useState("basic");H.useEffect(()=>{c&&n&&f({name:n.name||"",taxId:n.taxId||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson||"",phone:n.phone||"",email:n.email||"",address:n.address||"",city:n.city||"",state:n.state||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:n.creditLimit||"",priceList:n.priceList||{},rating:n.rating||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1})},[c,n]);const x=(P,F)=>{f($=>({...$,[P]:F})),y[P]&&_($=>({...$,[P]:null}))},R=P=>{f(F=>({...F,fuelTypes:F.fuelTypes.includes(P)?F.fuelTypes.filter($=>$!==P):[...F.fuelTypes,P]}))},A=(P,F)=>{f($=>({...$,priceList:{...$.priceList,[P]:parseFloat(F)||0}}))},O=()=>{const P={};return d.name.trim()||(P.name="El nombre del proveedor es requerido"),d.category||(P.category="La categoría es requerida"),d.type||(P.type="El tipo de proveedor es requerido"),d.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)&&(P.email="El formato del email no es válido"),d.phone&&!/^[\d\s\-+()]+$/.test(d.phone)&&(P.phone="El formato del teléfono no es válido"),d.creditLimit&&(isNaN(d.creditLimit)||parseFloat(d.creditLimit)<0)&&(P.creditLimit="El límite de crédito debe ser un número positivo"),(d.rating<1||d.rating>5)&&(P.rating="El rating debe estar entre 1 y 5"),d.fuelTypes.forEach(F=>{d.priceList[F]&&(isNaN(d.priceList[F])||parseFloat(d.priceList[F])<0)&&(P[`price_${F}`]=`El precio de ${Nn[F]} debe ser un número positivo`)}),_(P),Object.keys(P).length===0},q=async P=>{if(P.preventDefault(),!!O()){g(!0);try{const F={...d,creditLimit:parseFloat(d.creditLimit)||0,rating:parseFloat(d.rating)||5,priceList:Object.fromEntries(Object.entries(d.priceList).filter(([V,S])=>d.fuelTypes.includes(V)&&S>0))};let $;c?$=await CL(n.id,F,o?.email):$=await jL(F,o?.email),$.success?t():a($.error||"Error al guardar proveedor")}catch(F){console.error("Error saving supplier:",F),a("Error inesperado al guardar proveedor")}finally{g(!1)}}},U=[{id:"basic",label:"Información Básica",icon:"icon-info"},{id:"contact",label:"Contacto",icon:"icon-phone"},{id:"products",label:"Productos",icon:"icon-package"},{id:"commercial",label:"Comercial",icon:"icon-credit-card"}];return i.jsx("div",{className:"modal-overlay",onClick:e,children:i.jsxs("div",{className:"modal-container large",onClick:P=>P.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsxs("h2",{children:[i.jsx("i",{className:"icon-truck"}),c?"Editar Proveedor":"Nuevo Proveedor"]}),i.jsx("button",{className:"modal-close",onClick:e,children:i.jsx("i",{className:"icon-x"})})]}),i.jsxs("form",{onSubmit:q,children:[i.jsx("div",{className:"modal-tabs",children:U.map(P=>i.jsxs("button",{type:"button",className:`tab-button ${N===P.id?"active":""}`,onClick:()=>j(P.id),children:[i.jsx("i",{className:P.icon}),P.label]},P.id))}),i.jsxs("div",{className:"modal-body",children:[N==="basic"&&i.jsx("div",{className:"tab-content",children:i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"required",children:"Nombre del Proveedor"}),i.jsx("input",{type:"text",value:d.name,onChange:P=>x("name",P.target.value),placeholder:"Ingresa el nombre del proveedor",className:y.name?"error":""}),y.name&&i.jsx("span",{className:"error-message",children:y.name})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"NIT / Documento"}),i.jsx("input",{type:"text",value:d.taxId,onChange:P=>x("taxId",P.target.value),placeholder:"123456789-0",className:y.taxId?"error":""}),y.taxId&&i.jsx("span",{className:"error-message",children:y.taxId})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"required",children:"Tipo de Proveedor"}),i.jsxs("select",{value:d.type,onChange:P=>x("type",P.target.value),className:y.type?"error":"",children:[i.jsx("option",{value:"proveedor",children:"Proveedor"}),i.jsx("option",{value:"distribuidor",children:"Distribuidor"}),i.jsx("option",{value:"mayorista",children:"Mayorista"})]}),y.type&&i.jsx("span",{className:"error-message",children:y.type})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"required",children:"Categoría"}),i.jsxs("select",{value:d.category,onChange:P=>x("category",P.target.value),className:y.category?"error":"",children:[i.jsx("option",{value:"combustibles",children:"Combustibles"}),i.jsx("option",{value:"lubricantes",children:"Lubricantes"}),i.jsx("option",{value:"aditivos",children:"Aditivos"})]}),y.category&&i.jsx("span",{className:"error-message",children:y.category})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Estado"}),i.jsxs("select",{value:d.status,onChange:P=>x("status",P.target.value),children:[i.jsx("option",{value:"active",children:"Activo"}),i.jsx("option",{value:"inactive",children:"Inactivo"}),i.jsx("option",{value:"suspended",children:"Suspendido"})]})]}),i.jsx("div",{className:"form-group checkbox",children:i.jsxs("label",{className:"checkbox-label",children:[i.jsx("input",{type:"checkbox",checked:d.isPreferred,onChange:P=>x("isPreferred",P.target.checked)}),i.jsx("span",{className:"checkbox-mark"}),"Proveedor Preferido"]})})]})}),N==="contact"&&i.jsx("div",{className:"tab-content",children:i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Persona de Contacto"}),i.jsx("input",{type:"text",value:d.contactPerson,onChange:P=>x("contactPerson",P.target.value),placeholder:"Nombre del contacto principal"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Teléfono"}),i.jsx("input",{type:"tel",value:d.phone,onChange:P=>x("phone",P.target.value),placeholder:"+57 300 123 4567",className:y.phone?"error":""}),y.phone&&i.jsx("span",{className:"error-message",children:y.phone})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email"}),i.jsx("input",{type:"email",value:d.email,onChange:P=>x("email",P.target.value),placeholder:"contacto@proveedor.com",className:y.email?"error":""}),y.email&&i.jsx("span",{className:"error-message",children:y.email})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Ciudad"}),i.jsx("input",{type:"text",value:d.city,onChange:P=>x("city",P.target.value),placeholder:"Bogotá"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Estado/País"}),i.jsx("input",{type:"text",value:d.state,onChange:P=>x("state",P.target.value),placeholder:"Colombia"})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{children:"Dirección"}),i.jsx("textarea",{value:d.address,onChange:P=>x("address",P.target.value),placeholder:"Dirección completa del proveedor",rows:"3"})]})]})}),N==="products"&&i.jsxs("div",{className:"tab-content",children:[i.jsxs("div",{className:"section",children:[i.jsx("h3",{children:"Tipos de Combustible que Suministra"}),i.jsx("div",{className:"fuel-types-grid",children:Object.entries(Nn).map(([P,F])=>i.jsx("div",{className:"fuel-type-item",children:i.jsxs("label",{className:"checkbox-label",children:[i.jsx("input",{type:"checkbox",checked:d.fuelTypes.includes(P),onChange:()=>R(P)}),i.jsx("span",{className:"checkbox-mark"}),F]})},P))})]}),d.fuelTypes.length>0&&i.jsxs("div",{className:"section",children:[i.jsx("h3",{children:"Precios por Litro (Opcional)"}),i.jsx("div",{className:"prices-grid",children:d.fuelTypes.map(P=>i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:Nn[P]}),i.jsxs("div",{className:"input-with-currency",children:[i.jsx("span",{className:"currency-symbol",children:"$"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:d.priceList[P]||"",onChange:F=>A(P,F.target.value),placeholder:"0.00",className:y[`price_${P}`]?"error":""})]}),y[`price_${P}`]&&i.jsx("span",{className:"error-message",children:y[`price_${P}`]})]},P))})]})]}),N==="commercial"&&i.jsx("div",{className:"tab-content",children:i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Términos de Pago"}),i.jsxs("select",{value:d.paymentTerms,onChange:P=>x("paymentTerms",P.target.value),children:[i.jsx("option",{value:"contado",children:"Contado"}),i.jsx("option",{value:"30dias",children:"30 días"}),i.jsx("option",{value:"60dias",children:"60 días"}),i.jsx("option",{value:"90dias",children:"90 días"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Límite de Crédito"}),i.jsxs("div",{className:"input-with-currency",children:[i.jsx("span",{className:"currency-symbol",children:"$"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:d.creditLimit,onChange:P=>x("creditLimit",P.target.value),placeholder:"0.00",className:y.creditLimit?"error":""})]}),y.creditLimit&&i.jsx("span",{className:"error-message",children:y.creditLimit})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Rating"}),i.jsxs("div",{className:"rating-input",children:[i.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:d.rating,onChange:P=>x("rating",parseFloat(P.target.value)),className:y.rating?"error":""}),i.jsxs("div",{className:"rating-display",children:[i.jsx("span",{className:"rating-value",children:d.rating.toFixed(1)}),i.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(P=>i.jsx("span",{className:`star ${P<=Math.round(d.rating)?"filled":""}`,children:"★"},P))})]})]}),y.rating&&i.jsx("span",{className:"error-message",children:y.rating})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{children:"Notas de Evaluación"}),i.jsx("textarea",{value:d.evaluationNotes,onChange:P=>x("evaluationNotes",P.target.value),placeholder:"Comentarios sobre el desempeño del proveedor...",rows:"4"})]})]})})]}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:p,children:"Cancelar"}),i.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"loading-spinner small"}),c?"Actualizando...":"Creando..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"icon-save"}),c?"Actualizar Proveedor":"Crear Proveedor"]})})]})]})]})})},LV=({stats:n,suppliersCount:e,totalSuppliers:t})=>{if(!n)return null;const a=d=>{switch(d){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},c=d=>{switch(d){case"proveedor":return"🏪";case"distribuidor":return"🚛";case"mayorista":return"🏭";default:return"🏢"}};return i.jsxs("div",{className:"suppliers-stats",children:[i.jsxs("div",{className:"stats-grid",children:[i.jsxs("div",{className:"stat-card primary",children:[i.jsx("div",{className:"stat-icon",children:i.jsx("i",{className:"icon-truck"})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:ke(n.total)}),i.jsx("div",{className:"stat-label",children:"Total Proveedores"}),t!==e&&i.jsxs("div",{className:"stat-sublabel",children:[ke(e)," mostrados"]})]})]}),i.jsxs("div",{className:"stat-card success",children:[i.jsx("div",{className:"stat-icon",children:i.jsx("i",{className:"icon-check-circle"})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:ke(n.active)}),i.jsx("div",{className:"stat-label",children:"Activos"}),i.jsx("div",{className:"stat-sublabel",children:Tr(n.total>0?n.active/n.total:0)})]})]}),i.jsxs("div",{className:"stat-card warning",children:[i.jsx("div",{className:"stat-icon",children:i.jsx("i",{className:"icon-star"})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:ke(n.preferred)}),i.jsx("div",{className:"stat-label",children:"Preferidos"}),i.jsx("div",{className:"stat-sublabel",children:Tr(n.active>0?n.preferred/n.active:0)})]})]}),i.jsxs("div",{className:"stat-card info",children:[i.jsx("div",{className:"stat-icon",children:i.jsx("i",{className:"icon-award"})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:n.averageRating.toFixed(1)}),i.jsx("div",{className:"stat-label",children:"Rating Promedio"}),i.jsx("div",{className:"stat-sublabel",children:i.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(d=>i.jsx("span",{className:`star ${d<=Math.round(n.averageRating)?"filled":""}`,children:"★"},d))})})]})]})]}),i.jsxs("div",{className:"stats-details",children:[i.jsxs("div",{className:"stats-section",children:[i.jsx("h3",{children:"Estado de Proveedores"}),i.jsxs("div",{className:"stats-breakdown",children:[i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-label",children:[i.jsx("span",{className:"status-dot",style:{backgroundColor:a("active")}}),"Activos"]}),i.jsx("div",{className:"breakdown-value",children:n.active}),i.jsx("div",{className:"breakdown-percentage",children:Tr(n.total>0?n.active/n.total:0)})]}),n.inactive>0&&i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-label",children:[i.jsx("span",{className:"status-dot",style:{backgroundColor:a("inactive")}}),"Inactivos"]}),i.jsx("div",{className:"breakdown-value",children:n.inactive}),i.jsx("div",{className:"breakdown-percentage",children:Tr(n.total>0?n.inactive/n.total:0)})]}),n.suspended>0&&i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-label",children:[i.jsx("span",{className:"status-dot",style:{backgroundColor:a("suspended")}}),"Suspendidos"]}),i.jsx("div",{className:"breakdown-value",children:n.suspended}),i.jsx("div",{className:"breakdown-percentage",children:Tr(n.total>0?n.suspended/n.total:0)})]})]})]}),Object.keys(n.byCategory).length>0&&i.jsxs("div",{className:"stats-section",children:[i.jsx("h3",{children:"Por Categoría"}),i.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byCategory).sort(([,d],[,f])=>f-d).map(([d,f])=>i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-label",children:[i.jsx("span",{className:"category-icon",children:o(d)}),d.charAt(0).toUpperCase()+d.slice(1).replace("_"," ")]}),i.jsx("div",{className:"breakdown-value",children:f}),i.jsx("div",{className:"breakdown-percentage",children:Tr(n.total>0?f/n.total:0)})]},d))})]}),Object.keys(n.byType).length>0&&i.jsxs("div",{className:"stats-section",children:[i.jsx("h3",{children:"Por Tipo"}),i.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byType).sort(([,d],[,f])=>f-d).map(([d,f])=>i.jsxs("div",{className:"breakdown-item",children:[i.jsxs("div",{className:"breakdown-label",children:[i.jsx("span",{className:"type-icon",children:c(d)}),d.charAt(0).toUpperCase()+d.slice(1)]}),i.jsx("div",{className:"breakdown-value",children:f}),i.jsx("div",{className:"breakdown-percentage",children:Tr(n.total>0?f/n.total:0)})]},d))})]})]}),i.jsxs("div",{className:"stats-insights",children:[i.jsx("h3",{children:"Información Rápida"}),i.jsxs("div",{className:"insights-grid",children:[i.jsxs("div",{className:"insight-item",children:[i.jsx("div",{className:"insight-label",children:"Nivel de Satisfacción"}),i.jsx("div",{className:"insight-value",children:n.averageRating>=4.5?"Excelente":n.averageRating>=4?"Muy Bueno":n.averageRating>=3.5?"Bueno":n.averageRating>=3?"Regular":"Necesita Mejora"})]}),i.jsxs("div",{className:"insight-item",children:[i.jsx("div",{className:"insight-label",children:"Estado General"}),i.jsx("div",{className:"insight-value",children:n.active/n.total>=.9?"Excelente":n.active/n.total>=.8?"Bueno":n.active/n.total>=.7?"Regular":"Revisar"})]}),i.jsxs("div",{className:"insight-item",children:[i.jsx("div",{className:"insight-label",children:"Proveedores Preferidos"}),i.jsx("div",{className:"insight-value",children:n.preferred===0?"Ninguno":n.preferred/n.active>=.3?"Suficientes":n.preferred/n.active>=.2?"Buenos":"Pocos"})]}),i.jsxs("div",{className:"insight-item",children:[i.jsx("div",{className:"insight-label",children:"Diversificación"}),i.jsx("div",{className:"insight-value",children:Object.keys(n.byCategory).length>=3?"Alta":Object.keys(n.byCategory).length>=2?"Media":"Baja"})]})]})]})]})},VV=({searchTerm:n,setSearchTerm:e,filterStatus:t,setFilterStatus:a,filterCategory:o,setFilterCategory:c,filterFuelType:d,setFilterFuelType:f,viewMode:p,setViewMode:g,onClearFilters:y,resultsCount:_})=>{const N=[{value:"all",label:"Todos los Estados",icon:"list"},{value:"active",label:"Activos",icon:"check-circle"},{value:"inactive",label:"Inactivos",icon:"x-circle"},{value:"suspended",label:"Suspendidos",icon:"alert-circle"},{value:"preferred",label:"Preferidos",icon:"star"}],j=[{value:"all",label:"Todas las Categorías",icon:"grid"},{value:"combustibles",label:"Combustibles",icon:"fuel"},{value:"lubricantes",label:"Lubricantes",icon:"droplets"},{value:"aditivos",label:"Aditivos",icon:"flask"}],x=[{value:"all",label:"Todos los Combustibles",icon:"fuel"},...Object.entries(Nn).map(([A,O])=>({value:A,label:O,icon:"droplet"}))],R=n||t!=="all"||o!=="all"||d!=="all";return i.jsxs("div",{className:"suppliers-filters",children:[i.jsxs("div",{className:"filters-top",children:[i.jsx("div",{className:"search-container",children:i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("i",{className:"icon-search search-icon"}),i.jsx("input",{type:"text",placeholder:"Buscar por nombre, NIT, contacto, ciudad...",value:n,onChange:A=>e(A.target.value),className:"search-input"}),n&&i.jsx("button",{className:"search-clear",onClick:()=>e(""),title:"Limpiar búsqueda",children:i.jsx("i",{className:"icon-x"})})]})}),i.jsxs("div",{className:"view-controls",children:[i.jsxs("div",{className:"view-mode-toggle",children:[i.jsx("button",{className:`view-btn ${p==="cards"?"active":""}`,onClick:()=>g("cards"),title:"Vista de tarjetas",children:i.jsx("i",{className:"icon-grid"})}),i.jsx("button",{className:`view-btn ${p==="table"?"active":""}`,onClick:()=>g("table"),title:"Vista de tabla",children:i.jsx("i",{className:"icon-list"})})]}),R&&i.jsxs("button",{className:"btn btn-secondary clear-filters",onClick:y,title:"Limpiar todos los filtros",children:[i.jsx("i",{className:"icon-filter-x"}),"Limpiar"]})]})]}),i.jsxs("div",{className:"filters-dropdowns",children:[i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{className:"filter-label",children:"Estado"}),i.jsxs("div",{className:"select-wrapper",children:[i.jsx("select",{value:t,onChange:A=>a(A.target.value),className:"filter-select",children:N.map(A=>i.jsx("option",{value:A.value,children:A.label},A.value))}),i.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{className:"filter-label",children:"Categoría"}),i.jsxs("div",{className:"select-wrapper",children:[i.jsx("select",{value:o,onChange:A=>c(A.target.value),className:"filter-select",children:j.map(A=>i.jsx("option",{value:A.value,children:A.label},A.value))}),i.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),i.jsxs("div",{className:"select-wrapper",children:[i.jsx("select",{value:d,onChange:A=>f(A.target.value),className:"filter-select",children:x.map(A=>i.jsx("option",{value:A.value,children:A.label},A.value))}),i.jsx("i",{className:"icon-chevron-down select-arrow"})]})]})]}),i.jsxs("div",{className:"filters-summary",children:[i.jsxs("div",{className:"results-count",children:[i.jsx("i",{className:"icon-info-circle"}),i.jsx("span",{children:_===0?"No se encontraron proveedores":`Mostrando ${_} proveedor${_!==1?"es":""}`})]}),R&&i.jsxs("div",{className:"active-filters",children:[i.jsx("span",{className:"filters-label",children:"Filtros activos:"}),i.jsxs("div",{className:"filter-tags",children:[n&&i.jsxs("span",{className:"filter-tag",children:[i.jsx("i",{className:"icon-search"}),n,i.jsx("button",{onClick:()=>e(""),children:i.jsx("i",{className:"icon-x"})})]}),t!=="all"&&i.jsxs("span",{className:"filter-tag",children:[i.jsx("i",{className:"icon-filter"}),N.find(A=>A.value===t)?.label,i.jsx("button",{onClick:()=>a("all"),children:i.jsx("i",{className:"icon-x"})})]}),o!=="all"&&i.jsxs("span",{className:"filter-tag",children:[i.jsx("i",{className:"icon-tag"}),j.find(A=>A.value===o)?.label,i.jsx("button",{onClick:()=>c("all"),children:i.jsx("i",{className:"icon-x"})})]}),d!=="all"&&i.jsxs("span",{className:"filter-tag",children:[i.jsx("i",{className:"icon-droplet"}),x.find(A=>A.value===d)?.label,i.jsx("button",{onClick:()=>f("all"),children:i.jsx("i",{className:"icon-x"})})]})]})]})]}),i.jsxs("div",{className:"quick-filters",children:[i.jsx("span",{className:"quick-filters-label",children:"Acceso rápido:"}),i.jsxs("div",{className:"quick-filter-buttons",children:[i.jsxs("button",{className:`quick-filter-btn ${t==="preferred"?"active":""}`,onClick:()=>a(t==="preferred"?"all":"preferred"),children:[i.jsx("i",{className:"icon-star"}),"Preferidos"]}),i.jsxs("button",{className:`quick-filter-btn ${t==="active"?"active":""}`,onClick:()=>a(t==="active"?"all":"active"),children:[i.jsx("i",{className:"icon-check-circle"}),"Activos"]}),i.jsxs("button",{className:`quick-filter-btn ${o==="combustibles"?"active":""}`,onClick:()=>c(o==="combustibles"?"all":"combustibles"),children:[i.jsx("i",{className:"icon-fuel"}),"Combustibles"]}),i.jsxs("button",{className:`quick-filter-btn ${d==="diesel"?"active":""}`,onClick:()=>f(d==="diesel"?"all":"diesel"),children:[i.jsx("i",{className:"icon-droplet"}),"Diésel"]})]})]})]})},UV=()=>{const{hasPermission:n,userProfile:e}=ds(),[t,a]=H.useState([]),[o,c]=H.useState(null),[d,f]=H.useState(!0),[p,g]=H.useState(null),[y,_]=H.useState("cards"),[N,j]=H.useState(!1),[x,R]=H.useState(null),[A,O]=H.useState("all"),[q,U]=H.useState("all"),[P,F]=H.useState("all"),[$,V]=H.useState("");H.useEffect(()=>{let Q=null;return(()=>{Q=Fj(he=>{a(he||[]),f(!1)})})(),()=>{Q&&Q()}},[]),H.useEffect(()=>{const Q=async()=>{const ne=await IL();ne.success&&c(ne.data)};t.length>0&&Q()},[t]);const S=t.filter(Q=>{const ne=!$||Q.name?.toLowerCase().includes($.toLowerCase())||Q.taxId?.toLowerCase().includes($.toLowerCase())||Q.contactPerson?.toLowerCase().includes($.toLowerCase())||Q.city?.toLowerCase().includes($.toLowerCase()),he=A==="all"||(A==="preferred"?Q.isPreferred:Q.status===A),Oe=q==="all"||Q.category===q,z=P==="all"||Q.fuelTypes&&Q.fuelTypes.includes(P);return ne&&he&&Oe&&z}),L=()=>{if(!n("canManageSuppliers")){g("No tienes permisos para agregar proveedores");return}R(null),j(!0)},M=Q=>{if(!n("canManageSuppliers")){g("No tienes permisos para editar proveedores");return}R(Q),j(!0)},w=async(Q,ne)=>{if(!n("canManageSuppliers")){g("No tienes permisos para eliminar proveedores");return}if(window.confirm(`¿Estás seguro de que deseas desactivar el proveedor "${ne}"?

Esta acción se puede revertir cambiando su estado a activo.`))try{const he=await SL(Q,e?.email);he.success?g(null):g(he.error||"Error al desactivar proveedor")}catch(he){console.error("Error deleting supplier:",he),g("Error inesperado al eliminar proveedor")}},C=()=>{j(!1),R(null),g(null)},D=()=>{j(!1),R(null),g(null)},me=()=>{O("all"),U("all"),F("all"),V("")},De=()=>{if(!n("canExportReports")){g("No tienes permisos para exportar datos");return}try{const Q=S.map(ee=>({Nombre:ee.name,"NIT/Documento":ee.taxId,Tipo:ee.type,Categoría:ee.category,"Persona de Contacto":ee.contactPerson,Teléfono:ee.phone,Email:ee.email,Ciudad:ee.city,Combustibles:ee.fuelTypes?.join(", "),Rating:ee.rating,Estado:ee.status,Preferido:ee.isPreferred?"Sí":"No","Fecha Creación":ee.createdAt?.toDate?.()?.toLocaleDateString()||"N/A"})),ne=[Object.keys(Q[0]).join(","),...Q.map(ee=>Object.values(ee).map(le=>`"${le||""}"`).join(","))].join(`
`),he=new Blob([ne],{type:"text/csv;charset=utf-8;"}),Oe=document.createElement("a"),z=URL.createObjectURL(he);Oe.setAttribute("href",z),Oe.setAttribute("download",`proveedores_${new Date().toISOString().split("T")[0]}.csv`),Oe.style.visibility="hidden",document.body.appendChild(Oe),Oe.click(),document.body.removeChild(Oe)}catch(Q){console.error("Error exporting suppliers:",Q),g("Error al exportar proveedores")}};return d?i.jsx("div",{className:"suppliers-main",children:i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Cargando proveedores..."})]})}):i.jsxs("div",{className:"suppliers-main",children:[i.jsxs("div",{className:"suppliers-header",children:[i.jsxs("div",{className:"header-content",children:[i.jsx("h1",{children:"Gestión de Proveedores"}),i.jsx("p",{className:"header-subtitle",children:"Administra los proveedores de combustibles y materiales"})]}),i.jsxs("div",{className:"header-actions",children:[n("canManageSuppliers")&&i.jsxs("button",{className:"btn btn-primary",onClick:L,children:[i.jsx("i",{className:"icon-plus"}),"Agregar Proveedor"]}),n("canExportReports")&&i.jsxs("button",{className:"btn btn-secondary",onClick:De,disabled:S.length===0,children:[i.jsx("i",{className:"icon-download"}),"Exportar"]})]})]}),p&&i.jsxs("div",{className:"alert alert-error",children:[i.jsx("i",{className:"icon-alert-circle"}),i.jsx("span",{children:p}),i.jsx("button",{onClick:()=>g(null),className:"alert-close",children:i.jsx("i",{className:"icon-x"})})]}),o&&i.jsx(LV,{stats:o,suppliersCount:S.length,totalSuppliers:t.length}),i.jsx(VV,{searchTerm:$,setSearchTerm:V,filterStatus:A,setFilterStatus:O,filterCategory:q,setFilterCategory:U,filterFuelType:P,setFilterFuelType:F,viewMode:y,setViewMode:_,onClearFilters:me,resultsCount:S.length}),S.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"empty-icon",children:i.jsx("i",{className:"icon-truck"})}),i.jsx("h3",{children:"No hay proveedores"}),i.jsx("p",{children:t.length===0?"Comienza agregando tu primer proveedor de combustibles.":"No se encontraron proveedores que coincidan con los filtros aplicados."}),t.length===0&&n("canManageSuppliers")&&i.jsxs("button",{className:"btn btn-primary",onClick:L,children:[i.jsx("i",{className:"icon-plus"}),"Agregar Primer Proveedor"]}),t.length>0&&i.jsxs("button",{className:"btn btn-secondary",onClick:me,children:[i.jsx("i",{className:"icon-filter-x"}),"Limpiar Filtros"]})]}):i.jsx("div",{className:"suppliers-content",children:y==="cards"?i.jsx(kV,{suppliers:S,onEdit:M,onDelete:w,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")}):i.jsx(OV,{suppliers:S,onEdit:M,onDelete:w,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")})}),N&&i.jsx(PV,{supplier:x,onClose:C,onSuccess:D,onError:g})]})},FV=()=>{const{user:n,userProfile:e}=ds(),[t,a]=H.useState("invitations"),[o,c]=H.useState([]),[d,f]=H.useState(!1),[p,g]=H.useState(!1),[y,_]=H.useState(!1),[N,j]=H.useState({email:"",name:"",role:_s.CLIENTE});H.useEffect(()=>{n&&e?.role==="admin"&&x()},[n,e,x]);const x=H.useCallback(async()=>{if(n){f(!0);try{const P=await cL(n.uid);P.success?c(P.invitations):console.error("Error loading invitations:",P.error)}catch(P){console.error("Error loading invitations:",P)}finally{f(!1)}}},[n]),R=async P=>{P.preventDefault(),_(!0);try{const F=await oL(N,n.uid);F.success?(j({email:"",name:"",role:_s.CLIENTE}),g(!1),await x(),alert(`Invitación creada exitosamente!
Código: ${F.invitation.code}`)):alert(`Error: ${F.error}`)}catch(F){console.error("Error creating invitation:",F),alert("Error creando invitación")}finally{_(!1)}},A=async P=>{if(confirm("¿Estás seguro de cancelar esta invitación?"))try{const F=await uL(P,n.uid);F.success?(await x(),alert("Invitación cancelada exitosamente")):alert(`Error: ${F.error}`)}catch(F){console.error("Error cancelling invitation:",F),alert("Error cancelando invitación")}},O=P=>({pending:{text:"Pendiente",class:"status-pending"},used:{text:"Usada",class:"status-used"},cancelled:{text:"Cancelada",class:"status-cancelled"},expired:{text:"Expirada",class:"status-expired"}})[P]||{text:P,class:"status-unknown"},q=P=>({admin:"Administrador",contador:"Contador",cliente:"Cliente"})[P]||P,U=P=>P?(P.toDate?P.toDate():new Date(P)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e?.role!=="admin"?i.jsxs("div",{className:"admin-unauthorized",children:[i.jsx("h2",{children:"⛔ Acceso Denegado"}),i.jsx("p",{children:"Solo los administradores pueden acceder a esta sección."})]}):i.jsxs("div",{className:"admin-main",children:[i.jsxs("div",{className:"admin-header",children:[i.jsx("h1",{children:"⚙️ Administración del Sistema"}),i.jsx("p",{children:"Gestión de usuarios y configuraciones"})]}),i.jsxs("div",{className:"admin-tabs",children:[i.jsx("button",{className:`tab-button ${t==="invitations"?"active":""}`,onClick:()=>a("invitations"),children:"🎫 Invitaciones"}),i.jsx("button",{className:`tab-button ${t==="users"?"active":""}`,onClick:()=>a("users"),children:"👥 Usuarios"}),i.jsx("button",{className:`tab-button ${t==="settings"?"active":""}`,onClick:()=>a("settings"),children:"⚙️ Configuración"})]}),i.jsxs("div",{className:"admin-content",children:[t==="invitations"&&i.jsxs("div",{className:"invitations-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx("h2",{children:"Gestión de Invitaciones"}),i.jsx("button",{className:"create-button",onClick:()=>g(!0),children:"+ Crear Invitación"})]}),d?i.jsx("div",{className:"loading",children:"Cargando invitaciones..."}):i.jsxs("div",{className:"invitations-table",children:[i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Código"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Nombre"}),i.jsx("th",{children:"Rol"}),i.jsx("th",{children:"Estado"}),i.jsx("th",{children:"Creada"}),i.jsx("th",{children:"Expira"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(P=>{const F=O(P.status);return i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("code",{className:"invitation-code",children:P.code})}),i.jsx("td",{children:P.targetEmail}),i.jsx("td",{children:P.targetName||"-"}),i.jsx("td",{children:q(P.targetRole)}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${F.class}`,children:F.text})}),i.jsx("td",{children:U(P.createdAt)}),i.jsx("td",{children:U(P.expiresAt)}),i.jsx("td",{children:P.status==="pending"&&i.jsx("button",{className:"cancel-button",onClick:()=>A(P.id),children:"Cancelar"})})]},P.id)})})]}),o.length===0&&i.jsx("div",{className:"empty-state",children:i.jsx("p",{children:"No hay invitaciones creadas"})})]})]}),t==="users"&&i.jsxs("div",{className:"users-section",children:[i.jsx("h2",{children:"👥 Usuarios del Sistema"}),i.jsxs("div",{className:"coming-soon",children:[i.jsx("span",{children:"🚧 En desarrollo"}),i.jsx("p",{children:"Próximamente: Lista de usuarios registrados, edición de permisos, y estadísticas."})]})]}),t==="settings"&&i.jsxs("div",{className:"settings-section",children:[i.jsx("h2",{children:"⚙️ Configuración del Sistema"}),i.jsxs("div",{className:"coming-soon",children:[i.jsx("span",{children:"🚧 En desarrollo"}),i.jsx("p",{children:"Próximamente: Configuraciones generales, notificaciones, y parámetros del sistema."})]})]})]}),p&&i.jsx("div",{className:"modal-overlay",onClick:()=>g(!1),children:i.jsxs("div",{className:"modal-content",onClick:P=>P.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Crear Nueva Invitación"}),i.jsx("button",{className:"modal-close",onClick:()=>g(!1),children:"×"})]}),i.jsxs("form",{onSubmit:R,className:"invitation-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email del usuario:"}),i.jsx("input",{id:"email",type:"email",required:!0,value:N.email,onChange:P=>j({...N,email:P.target.value}),placeholder:"usuario@ejemplo.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Nombre (opcional):"}),i.jsx("input",{id:"name",type:"text",value:N.name,onChange:P=>j({...N,name:P.target.value}),placeholder:"Nombre del usuario"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Rol:"}),i.jsxs("select",{id:"role",value:N.role,onChange:P=>j({...N,role:P.target.value}),children:[i.jsx("option",{value:_s.CLIENTE,children:"Cliente"}),i.jsx("option",{value:_s.CONTADOR,children:"Contador"}),i.jsx("option",{value:_s.ADMIN,children:"Administrador"})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",className:"cancel-button",onClick:()=>g(!1),children:"Cancelar"}),i.jsx("button",{type:"submit",className:"create-button",disabled:y,children:y?"Creando...":"Crear Invitación"})]})]})]})})]})},qV=()=>i.jsxs("div",{className:"module-placeholder",children:[i.jsx("h2",{children:"📋 Módulo de Reportes"}),i.jsx("p",{children:"Análisis y reportes de combustibles"}),i.jsxs("div",{className:"coming-soon",children:[i.jsx("span",{children:"🚧 En desarrollo"}),i.jsx("p",{children:"Próximamente: Reportes personalizables, gráficos interactivos, y exportación."})]})]}),BV=()=>{const[n,e]=H.useState("dashboard"),t=()=>{switch(n){case"dashboard":return i.jsx(FE,{});case"inventory":return i.jsx(UL,{});case"movements":return i.jsx(aV,{});case"vehicles":return i.jsx(bV,{});case"maintenance":return i.jsx(IV,{});case"products":return i.jsx(MV,{});case"suppliers":return i.jsx(UV,{});case"reports":return i.jsx(qV,{});case"admin":return i.jsx(FV,{});default:return i.jsx(FE,{})}};return i.jsx(DL,{currentView:n,onViewChange:e,children:t()})},zV=()=>{const[n,e]=H.useState("login"),[t,a]=H.useState(!1),[o,c]=H.useState(""),[d,f]=H.useState(""),[p,g]=H.useState(""),[y,_]=H.useState(""),[N,j]=H.useState({email:"",password:"",confirmPassword:"",invitationCode:""}),[x,R]=H.useState(""),[A,O]=H.useState(null),q=async L=>{L.preventDefault(),a(!0),c("");try{await mR(Gc,p,y)}catch(M){console.error("Error en login:",M),c($(M.code))}finally{a(!1)}},U=async()=>{a(!0),c("");try{const L=new wa,M=await VR(Gc,L);A?await ME(M.user,A.code):await _j(M.user)}catch(L){console.error("Error en login con Google:",L),c("Error al iniciar sesión con Google")}finally{a(!1)}},P=async L=>{L.preventDefault(),a(!0),c(""),f("");try{const M=await bj(x);M.success?(O(M.invitation),f(`Invitación válida para: ${M.invitation.targetEmail}`),e("register"),j({...N,email:M.invitation.targetEmail,invitationCode:x})):c(M.error)}catch(M){console.error("Error validando invitación:",M),c("Error validando código de invitación")}finally{a(!1)}},F=async L=>{if(L.preventDefault(),a(!0),c(""),N.password!==N.confirmPassword){c("Las contraseñas no coinciden"),a(!1);return}if(N.password.length<6){c("La contraseña debe tener al menos 6 caracteres"),a(!1);return}try{const M=await fR(Gc,N.email,N.password),w=await ME(M.user,N.invitationCode);w.success?f("¡Registro exitoso! Bienvenido al sistema."):c(w.error)}catch(M){console.error("Error en registro:",M),c($(M.code))}finally{a(!1)}},$=L=>{switch(L){case"auth/invalid-email":return"El formato del email es inválido";case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contraseña incorrecta";case"auth/invalid-credential":return"Email o contraseña incorrectos";case"auth/email-already-in-use":return"Este email ya está registrado";case"auth/weak-password":return"La contraseña es muy débil";default:return"Error de autenticación. Inténtalo de nuevo."}},V=()=>{c(""),f(""),g(""),_(""),R(""),O(null),j({email:"",password:"",confirmPassword:"",invitationCode:""})},S=()=>{switch(n){case"login":return i.jsxs(i.Fragment,{children:[i.jsxs("form",{onSubmit:q,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{id:"email",type:"email",value:p,onChange:L=>g(L.target.value),required:!0,disabled:t,placeholder:"tu-email@ejemplo.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Contraseña:"}),i.jsx("input",{id:"password",type:"password",value:y,onChange:L=>_(L.target.value),required:!0,disabled:t,placeholder:"Tu contraseña"})]}),i.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Iniciando sesión...":"Iniciar Sesión"})]}),i.jsx("div",{className:"auth-divider",children:i.jsx("span",{children:"o"})}),i.jsxs("button",{onClick:U,className:"auth-button google",disabled:t,children:[i.jsx("span",{children:"🔗"}),"Continuar con Google"]}),i.jsx("div",{className:"auth-actions",children:i.jsx("button",{className:"link-button",onClick:()=>{V(),e("invite")},children:"¿Tienes un código de invitación? Regístrate aquí"})})]});case"invite":return i.jsxs(i.Fragment,{children:[i.jsxs("form",{onSubmit:P,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"inviteCode",children:"Código de invitación:"}),i.jsx("input",{id:"inviteCode",type:"text",value:x,onChange:L=>R(L.target.value.toUpperCase()),required:!0,disabled:t,placeholder:"XXXXXXXX",maxLength:8,style:{textTransform:"uppercase",fontFamily:"monospace"}}),i.jsx("small",{children:"Ingresa el código de 8 caracteres que recibiste"})]}),i.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Validando...":"Validar Código"})]}),i.jsx("div",{className:"auth-actions",children:i.jsx("button",{className:"link-button",onClick:()=>{V(),e("login")},children:"Volver al inicio de sesión"})})]});case"register":return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"invitation-info",children:i.jsxs("div",{className:"success-message",children:["✅ Código válido para: ",A?.targetEmail]})}),i.jsxs("form",{onSubmit:F,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"registerEmail",children:"Email:"}),i.jsx("input",{id:"registerEmail",type:"email",value:N.email,disabled:!0,className:"disabled-input"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"registerPassword",children:"Contraseña:"}),i.jsx("input",{id:"registerPassword",type:"password",value:N.password,onChange:L=>j({...N,password:L.target.value}),required:!0,disabled:t,placeholder:"Mínimo 6 caracteres",minLength:6})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar contraseña:"}),i.jsx("input",{id:"confirmPassword",type:"password",value:N.confirmPassword,onChange:L=>j({...N,confirmPassword:L.target.value}),required:!0,disabled:t,placeholder:"Repite tu contraseña"})]}),i.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Registrando...":"Crear Cuenta"})]}),i.jsx("div",{className:"auth-divider",children:i.jsx("span",{children:"o"})}),i.jsxs("button",{onClick:U,className:"auth-button google",disabled:t,children:[i.jsx("span",{children:"🔗"}),"Registrarse con Google"]}),i.jsx("div",{className:"auth-actions",children:i.jsx("button",{className:"link-button",onClick:()=>{V(),e("invite")},children:"Usar otro código de invitación"})})]});default:return null}};return i.jsx("div",{className:"auth-container",children:i.jsxs("div",{className:"auth-card",children:[i.jsxs("div",{className:"auth-header",children:[i.jsx("h1",{children:"⛽ Combustibles"}),i.jsx("h2",{children:"Forestech Colombia"}),i.jsxs("p",{children:[n==="login"&&"Sistema de gestión de combustibles",n==="invite"&&"Validar código de invitación",n==="register"&&"Crear nueva cuenta"]})]}),i.jsxs("div",{className:"auth-form",children:[o&&i.jsx("div",{className:"error-message",children:o}),d&&i.jsx("div",{className:"success-message",children:d}),S(),i.jsx("div",{className:"auth-footer",children:i.jsx("p",{children:i.jsxs("small",{children:["Solo usuarios autorizados pueden acceder al sistema.",i.jsx("br",{}),n==="login"?"Contacta al administrador para obtener un código de invitación.":"Si no tienes código, contacta al administrador."]})})})]})]})})};function HV(){return i.jsx(RL,{children:i.jsx(GV,{})})}function GV(){const{user:n,loading:e}=ds();return e?i.jsx("div",{className:"loading-container",children:i.jsxs("div",{className:"loader",children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{children:"Cargando..."})]})}):i.jsxs("div",{className:"App",children:[!n&&i.jsx(zV,{}),n&&i.jsx(BV,{})]})}MC.createRoot(document.getElementById("root")).render(i.jsx(H.StrictMode,{children:i.jsx(HV,{})}));
